import{f1 as d,as as w,au as H,e3 as C,ar as s,ea as y,eb as z,eP as K,X as f,e2 as m,H as _,d1 as L}from"./index-CjJDErFa.js";import{r as N,c as i,f as k}from"./vectorStacks-DdMm7uf7.js";function tt(r){const t=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],n=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],u=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(t,n,u))}function rt(r,t){const n=Math.sqrt(t[0]*t[0]+t[4]*t[4]+t[8]*t[8]),u=Math.sqrt(t[1]*t[1]+t[5]*t[5]+t[9]*t[9]),e=Math.sqrt(t[2]*t[2]+t[6]*t[6]+t[10]*t[10]);return d(r,n,u,e),r}function O(r,t,n){Math.abs(r[0])>Math.abs(r[1])?d(t,0,1,0):d(t,1,0,0),w(n,r,t),w(t,n,r),H(n,n),H(t,t)}function nt(r,t,n,u=f()){const e=C(r),a=C(t),o=s(r,t)/(e*a);if(o<.9999999999999999){const c=Math.acos(o),h=((1-n)*e+n*a)/Math.sin(c),$=h/e*Math.sin((1-n)*c),M=h/a*Math.sin(n*c);return y(D,r,$),y(E,t,M),z(u,D,E)}return K(u,r,t,n)}const D=f(),E=f();function F(r=q){return[r[0],r[1],r[2],r[3]]}function ut(r=q[0],t=q[1],n=q[2],u=q[3]){return G(r,t,n,u,N.get())}function Q(r,t){return G(t[0],t[1],t[2],t[3],r)}function et(r){return r}function G(r,t,n,u,e=F()){return e[0]=r,e[1]=t,e[2]=n,e[3]=u,e}function R(r,t,n){const u=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],e=Math.abs(u-1)>1e-5&&u>1e-12?1/Math.sqrt(u):1;return n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=-(n[0]*r[0]+n[1]*r[1]+n[2]*r[2]),n}function S(r,t,n,u=F()){const e=n[0]-t[0],a=n[1]-t[1],o=n[2]-t[2],c=r[0]-t[0],h=r[1]-t[1],$=r[2]-t[2],M=a*$-o*h,v=o*c-e*$,B=e*h-a*c,I=M*M+v*v+B*B,X=Math.abs(I-1)>1e-5&&I>1e-12?1/Math.sqrt(I):1;return u[0]=M*X,u[1]=v*X,u[2]=B*X,u[3]=-(u[0]*r[0]+u[1]*r[1]+u[2]*r[2]),u}function J(r,t,n,u=0,e=Math.floor(n*(1/3)),a=Math.floor(n*(2/3))){if(n<3)return!1;t(b,u);let o=e,c=!1;for(;o<n-1&&!c;)t(l,o),o++,c=!_(b,l);if(!c)return!1;for(o=Math.max(o,a),c=!1;o<n&&!c;)t(g,o),o++,m(x,b,l),H(x,x),m(A,l,g),H(A,A),c=!_(b,g)&&!_(l,g)&&Math.abs(s(x,A))<T;return c?(S(b,l,g,r),!0):(u!==0||e!==1||a!==2)&&J(r,t,n,0,1,2)}function ct(r,t,n=!0){const u=t.length/3;return J(r,(e,a)=>d(e,t[3*a+0],t[3*a+1],t[3*a+2]),n?u-1:u)}const T=.99619469809,b=f(),l=f(),g=f(),x=f(),A=f();function ot(r,t,n){return t!==r&&Q(r,t),r[3]=-s(r,n),r}function at(r,t){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t}function it(r,t,n,u){return w(g,t,r),R(n,g,u)}function st(r,t,n,u){return P(j(r,t,m(i.get(),n,t),V,u))}function ft(r,t,n){return t!=null&&P(j(r,t.origin,t.direction,W,n))}function ht(r,t,n){return P(j(r,t.origin,t.vector,0,n))}function Mt(r,t,n){return P(j(r,t.origin,t.vector,1,n))}function gt(r,t){return p(r,t)>=0}function $t(r,t){const n=s(r,t.ray.direction),u=-p(r,t.ray.origin);if(u<0&&n>=0)return!1;if(n>-1e-6&&n<1e-6)return u>0;if((u<0||n<0)&&!(u<0&&n<0))return!0;const e=u/n;return n>0?e<t.c1&&(t.c1=e):e>t.c0&&(t.c0=e),t.c0<=t.c1}function lt(r,t){const n=s(r,t.ray.direction),u=-p(r,t.ray.origin);if(n>-1e-6&&n<1e-6)return u>0;const e=u/n;return n>0?e<t.c1&&(t.c1=e):e>t.c0&&(t.c0=e),t.c0<=t.c1}function mt(r,t,n){const u=y(i.get(),r,-r[3]),e=U(r,m(i.get(),t,u),i.get());return z(n,e,u),n}function bt(r,t,n,u){const e=r,a=i.get(),o=i.get();O(e,a,o);const c=m(i.get(),n,t),h=k(a,c),$=k(o,c),M=k(e,c);return d(u,h,$,M)}function U(r,t,n){const u=y(i.get(),r,s(r,t));return m(n,t,u),n}function qt(r,t){return Math.abs(p(r,t))}function p(r,t){return s(r,t)+r[3]}function P(r){return r===0||r===1}function j(r,t,n,u,e){const a=s(r,n),o=p(r,t);if(a===0)return o>=0?2:3;let c=-o/a;return 1&u&&(c=L(c,0,1)),!(4&u)&&c<0||!(8&u)&&c>1?o>=0?2:3:(z(e,t,y(e,n,c)),o>=0?0:1)}const q=[0,0,1,0],V=12,W=8;export{ot as G,at as H,it as I,st as J,ft as K,ht as L,Mt as N,gt as O,$t as P,lt as Q,mt as R,J as S,bt as T,R as U,qt as W,p as X,j as Z,O as a,nt as b,ut as d,rt as g,F as j,et as k,tt as m,G as q,S as w,Q as y,ct as z};
