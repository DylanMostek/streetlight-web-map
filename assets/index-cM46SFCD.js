const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ElevationLayer-CdZNG2-p.js","assets/ArcGISCachedService-nFCCoJRS.js","assets/TileInfoTilemapCache-B-97R8Od.js","assets/TilemapCache-B-p28BpO.js","assets/memoryEstimations-Bg3AaHdI.js","assets/WorkerHandle-DxLRqFQ-.js","assets/portalLayers-2q0CTmdf.js","assets/associatedFeatureServiceUtils-D7YnNw0Y.js","assets/fetchService-Ba70jeln.js","assets/loadUtils-vyrBcq-3.js","assets/lazyLayerLoader-BLLKrYul.js","assets/arcgisLayers-ClJXkjMU.js","assets/layersCreator-JmLJf3d4.js","assets/ElevationQuery-Dvj2DDkD.js","assets/GeometryDescriptor-D6A07cjp.js","assets/projectOperator-Caj_rAr9.js","assets/operatorProject-DpR1vkAr.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/projectOperator-BFhjCY7-.js","assets/statsWorker-BECh1aT-.js","assets/utils-Dfftqq5N.js","assets/quantizationUtils-Bp7yavsE.js","assets/utils-CxGKn6kU.js","assets/utils-iuFoaEBw.js","assets/ClassBreaksDefinition-DZUiUCev.js","assets/geometryEngineWorker-BkMQzpX8.js","assets/geometryEngineJSON-B_JiqPb-.js","assets/geometryEngineBase-BQTefT4Y.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/CSVSourceWorker-Ppa3L8Wf.js","assets/date-DCujAECq.js","assets/OptimizedFeature-D0URDcFw.js","assets/FeatureStore-1eOrab5k.js","assets/featureConversionUtils-DNpHi6NW.js","assets/OptimizedFeatureSet-BR8EEvDc.js","assets/BoundsStore-DvdRFkrD.js","assets/PooledRBush-K8ZcosaW.js","assets/timeSupport-DcGyDJZ3.js","assets/queryUtils-DniAPi1G.js","assets/optimizedFeatureQueryEngineAdapter-CSxVtmG7.js","assets/QueryEngine-DkEIHoua.js","assets/WhereClauseCache-BtPiDZmc.js","assets/WhereClause-66E6Np7b.js","assets/QueryEngineCapabilities-DJC_YILC.js","assets/SnappingCandidate-DGkpYqI6.js","assets/FixedIntervalBinParameters-B3cRL5_X.js","assets/number-klz_nf74.js","assets/locationUtils-CTZ_AVsc.js","assets/clientSideDefaults-CJajXz4d.js","assets/EdgeProcessingWorker-BvZRfhaD.js","assets/workerHelper-DfVfY1jG.js","assets/InterleavedLayout-DhKNE0vP.js","assets/BufferView-B_RMoh30.js","assets/types-BKo2foNY.js","assets/VertexElementDescriptor-BLyltQyJ.js","assets/VertexAttributeLocations-BfZbt_DV.js","assets/edgeProcessing-DoPknbr3.js","assets/deduplicate-B5x3X54Y.js","assets/Indices-Db_0o9hj.js","assets/Normals-C5m2J-YE.js","assets/ElevationSamplerWorker-CnSj_yJw.js","assets/MeshLocalVertexSpace-CpQZbj3z.js","assets/vertexSpaceConversion-B3ltlAfv.js","assets/spatialReferenceEllipsoidUtils-Cu49jAPJ.js","assets/computeTranslationToOriginAndRotation-B2lzmbJy.js","assets/projectPointToVector-DDWIX2lR.js","assets/meshVertexSpaceUtils-C0D2uFdv.js","assets/vec3-nvVF0c-f.js","assets/vec4-DEGEL5Nf.js","assets/FeatureServiceSnappingSourceWorker-sOFtaox-.js","assets/symbologySnappingCandidates-Dy8-cC8C.js","assets/pbfQueryUtils-L91H0lgx.js","assets/pbf-DEz1S34q.js","assets/query-BvxIhgJR.js","assets/GeoJSONSourceWorker-KSWlLHc7.js","assets/geojson-BzjZx2CB.js","assets/sourceUtils-DEqbnSgM.js","assets/MemorySourceWorker-DVCu71sn.js","assets/objectIdUtils-BmFjqQA3.js","assets/PBFDecoderWorker-BFXqXBUw.js","assets/dehydratedFeatures--gMuiWqO.js","assets/FeaturePipelineWorker-DJCu2IwZ.js","assets/AttributeStore-Cdqrf_9X.js","assets/Utils-BlPVZxkX.js","assets/BoundingBox-58r5JPP_.js","assets/UpdateTracking2D-BwzvjQA4.js","assets/FeatureStoreQueryAdapter-BQKunnUc.js","assets/labelPoint-DBj5Gicr.js","assets/constants-BBnGEY1d.js","assets/streamLayerUtils-DFlbJ4P1.js","assets/MeshWriterRegistry-hNbgVxw8.js","assets/rasterizingUtils-DVTxHsjt.js","assets/CIMSymbolHelper-Vut0FuoF.js","assets/BidiEngine-BvER9tXK.js","assets/GeometryUtils-DB2Se9J1.js","assets/Rect-CUzevAry.js","assets/TexturedLineMeshWriter-Cgg98rlI.js","assets/TurboLine-ueQrV5OO.js","assets/grouping-Cs2bd0f3.js","assets/QueueProcessor-CspYquSw.js","assets/FeatureMetadata-D_NWUncR.js","assets/SourceChunkStore-CkFwyx_A.js","assets/parquet-DUMOaWLq.js","assets/operatorGeodeticDensify-BROL12hW.js","assets/geodeticCurveType-CirnHLSB.js","assets/normalizeUtilsSync-CuSnJgdQ.js","assets/FeatureIdInfo-CnZzX88z.js","assets/ogcFeatureUtils-ks-c0dFu.js","assets/CircularArray-CujHzHWW.js","assets/createConnection-DZg5sg91.js","assets/PointCloudWorker-D3mK8TSP.js","assets/quat-Bq0l2cgP.js","assets/quatf64-aQ5IuZRd.js","assets/vec3f32-WCVSSNPR.js","assets/PointCloudUniqueValueRenderer-Dl6ocC9R.js","assets/I3SBinaryReader-CRQ06KJj.js","assets/orientedBoundingBox-BTQfh_17.js","assets/plane-BSRddYh_.js","assets/vectorStacks-CU25yxJl.js","assets/RasterWorker-BLXf8m72.js","assets/PixelBlock-BEycT8dD.js","assets/RasterSymbolizer-BtpD6qer.js","assets/vectorFieldUtils-B71yNeQy.js","assets/colorUtils-BDoJuRhK.js","assets/rasterFunctionHelper-CO0X3ttX.js","assets/clipUtils-D043yBu3.js","assets/rasterProjectionHelper-BgqD9Zxq.js","assets/PolynomialTransform-f6X4WE61.js","assets/dataUtils-BsuYGfOA.js","assets/SceneLayerSnappingSourceWorker-BllAr-Kc.js","assets/lineSegment-CeOT0fL4.js","assets/sphere-J9Q3PghK.js","assets/Octree-Dt5yJJC-.js","assets/frustum-B0pvH006.js","assets/SceneLayerWorker-llzocICZ.js","assets/projectVectorToVector-DCirXeYs.js","assets/WFSSourceWorker-CCsesCMN.js","assets/wfsUtils-CA55GtzZ.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-DQKK_UnU.js","assets/constants-BHYAGdRm.js","assets/config-BOD8--da.js","assets/SourceLayerData-BA0DnnY7.js","assets/StyleRepository-Dj-8T9SR.js","assets/earcut-D9gy186-.js","assets/Feature3DPipelineWorker-DuKxClvm.js","assets/HUDMaterial.glsl-BUK24Rvu.js","assets/hydratedFeatures-BmTKvHT6.js","assets/OutputColorHighlightOID.glsl-B3lyU-_Y.js","assets/triangle-CDgAtryC.js","assets/renderState-CKc66y4x.js","assets/glsl-B5bJgrnA.js","assets/ShaderBuilder-DJeVCr0v.js","assets/placementUtils-C0fNct-b.js","assets/sdfPrimitives-xm74xrxb.js","assets/Texture-CIuqC9Wg.js","assets/videoUtils-C-CKQhlx.js","assets/requestImageUtils-2YGQ0nkL.js","assets/RealisticTree.glsl-Bl1eRmfw.js","assets/DefaultMaterial-DspZViCV.js","assets/VertexBuffer-Cv1218Lr.js","assets/BufferObject-B-POiJzG.js","assets/boundedPlane-B0iycZYw.js","assets/FlowWorker-C3WAwHkA.js","assets/ParquetSourceWorker-Nte-4xPF.js","assets/parquetUtils-DBKq8YP8.js","assets/PanoramicMeshWorker-DL-LiDyT.js","assets/Popup-Bd0TgebR.js","assets/throttle-dM9ovYsM.js","assets/unitFormatUtils-NFw_DCVT.js","assets/quantityUtils-Dz7vwbd6.js","assets/AttachmentInfo-CdHchV7N.js","assets/featureUtils-Dbxr6p8y.js","assets/utils-BOq09sN_.js","assets/cimSymbolUtils-BocKZASn.js","assets/executeQueryJSON-BL1icpXR.js","assets/shared-BeA2cnL5.js","assets/isImageryGraphicOrigin-Ccuhb4eK.js","assets/isImageryTileGraphicOrigin-ZR-gBf9D.js","assets/NetworkElement-Dmb8u2mi.js","assets/ReactiveSet-otPV4SpS.js","assets/symbolUtils-BD2lFH8X.js","assets/arcadeUtils-CGghaEMA.js","assets/arcade-CsXGNGtQ.js","assets/arcadeEnvironment-CR484grF.js","assets/Dictionary-DOTPpu2c.js","assets/ImmutableArray-BPVd6ESQ.js","assets/Feature-47Nlcjfp.js","assets/aiServices-CfUg-pLE.js","assets/unitConversion-BOu9J1fD.js","assets/rasterFieldUtils-acxOozU_.js","assets/batchExec-CKgRCHzU.js","assets/webStyleSymbolUtils-B093fbCp.js","assets/devEnvironmentUtils-8WtPGj6h.js","assets/webglDeps-BNJ663uh.js","assets/FramebufferObject-BV_vYuRt.js","assets/ProgramTemplate-B2Iy559H.js","assets/VertexArrayObject-DOXMWyv3.js","assets/mapViewDeps-BvkAy0z3.js","assets/FeatureCommandQueue-CNbwggeT.js","assets/GraphShaderModule-CGAJZJO3.js","assets/utils-COvpfWBV.js","assets/WGLContainer-DVe92Jxm.js","assets/Container-BoDNrR2F.js","assets/SDFHelper-CxNWzbEh.js","assets/OverrideHelper-sRayrMwn.js","assets/callExpressionWithFeature-CMvVvRbm.js","assets/GridShader-DbZmMViZ.js","assets/testSVGPremultipliedAlpha-DyLD0Sck.js","assets/SymbolFader-BjHyZoA7.js","assets/RenderingContext-CN7ogKsm.js","assets/CIMResourceManager-ECsEC2Cy.js","assets/utils-Res_3I6r.js","assets/utils-DDjZAYSk.js","assets/GraphicsView2D-DjuJQP77.js","assets/GraphicContainer-CayUJbwB.js","assets/AGraphicContainer-DYTCtVT3.js","assets/TechniqueInstance-DkXb7jDF.js","assets/TileContainer-CAH_tysj.js","assets/gridUtils-BBksAfMz.js","assets/geodesicUtils-CzaQYkyy.js","assets/TileLayerView2D-DKW7yj-s.js","assets/imageUtils-BJfUuPdV.js","assets/BitmapTechnique-AIRiVlim.js","assets/bitmapUtils-DCg0H3ey.js","assets/LayerView2D-RfG9Z_aX.js","assets/HighlightGraphicContainer-Fwwr0P11.js","assets/LayerView-DRJkQPQV.js","assets/RefreshableLayerView-wljxNQne.js","assets/MapServiceLayerViewHelper-xjIA6LQB.js","assets/floorFilterUtils-DKzVzLpH.js","assets/drapedUtils-BK3O45Ab.js","assets/sublayerUtils-BEQnBRaB.js","assets/popupUtils-7ZhZ7Lh1.js","assets/highlightOptionsUtils-CoDrXei1.js","assets/FeatureLayerView2D-CbM4ujea.js","assets/timeSupport-BsFftZ2f.js","assets/AttributeBinsFeatureSet-DEYbvdMN.js","assets/AttributeBinsQuery-BaTpEbYl.js","assets/constants-SxxbBSOD.js","assets/BaseDynamicLayerView2D-DgqOvmfz.js","assets/BitmapContainer-CfIlsI5I.js","assets/ExportStrategy-CLzEeRAq.js","assets/CatalogLayerView2D-CkDPMDuA.js","assets/CatalogDynamicGroupLayerView2D-WGDq3bjK.js","assets/CatalogFootprintLayerView2D-kip7PRyy.js","assets/GeoRSSLayerView2D-DmeYn9FN.js","assets/GraphicsLayerView2D-NF_kEgiI.js","assets/GroupLayerView2D-B957Ehx4.js","assets/ImageryLayerView2D-BnSyFVCo.js","assets/RasterVFDisplayObject-DUQa-oS8.js","assets/ImageryTileLayerView2D-B6aniczX.js","assets/datasetUtils-CGT2gvTv.js","assets/rasterUtils-DE3cUmsR.js","assets/RawBlockCache-BeAd0IzV.js","assets/KMLLayerView2D-Dx2os8Fk.js","assets/kmlUtils-DMPUSuZ3.js","assets/KnowledgeGraphLayerView2D-DvUAd8zE.js","assets/MapImageLayerView2D-BQLc3by9.js","assets/ExportImageParameters-CaV-Eyls.js","assets/MapNotesLayerView2D-DMWOMlaK.js","assets/MediaLayerView2D-7NaczYum.js","assets/mediaLayerUtils-VlrvmJvK.js","assets/OverlayContainer-CH9y7NOe.js","assets/OGCFeatureLayerView2D-BiBPedNa.js","assets/RouteLayerView2D-CETIdPtM.js","assets/Stop-BNcPcqG0.js","assets/networkEnums-BfjF1jDy.js","assets/StreamLayerView2D-CtzMQQ_B.js","assets/SubtypeGroupLayerView2D-HaKUiEBb.js","assets/VectorTileLayerView2D-NKrVBSV5.js","assets/VideoLayerView2D-D_BgKWXz.js","assets/GraphicsLayer-MAqg8Kty.js","assets/videoUtils-DFKzdYyU.js","assets/ControlPoint-CvLmqxb3.js","assets/WMSLayerView2D-Ci7ifXte.js","assets/ExportWMSImageParameters-C3F9iUZZ.js","assets/WMTSLayerView2D-CfX-2E2E.js","assets/ElevationProfileAnalysisView2D-YLTj2dlB.js","assets/createUtils-DUf3QKCC.js","assets/distanceOperator-CLvrlbTk.js","assets/Point2D-CE_8fSwp.js","assets/Distance2DCalculator-CXhBP-8I-2NfwBgzP.js","assets/ProjectionTransformation-DZjvHQpG.js","assets/Envelope2D-B-iKXdqf.js","assets/Transformation2D-DQXtCBWc.js","assets/OperatorDefinitions-DP7_WWTp.js","assets/apiConverter-DcYRsgDI.js","assets/jsonConverter-WZhSoFH4.js","assets/simplifyOperator-Dobmk_ko.js","assets/operatorSimplify-DTL5KCcp.js","assets/mapCollectionUtils-BGDIUiEE.js","assets/elevationInfoUtils-1lUS3ZcV.js","assets/getDefaultUnitForView-CT2BXPMj.js","assets/SketchViewModel-CE3DUVRy.js","assets/hitTestSelectUtils-CDgMG4iL.js","assets/geodeticLengthOperator-D_1BvEpR.js","assets/apng-DsRXW_zY.js","assets/index-BsUKe-uf.js","assets/index-vvcQC8uN.js","assets/guid-LcV_DAvu.js","assets/useT9n-BTaeW1Tr.js","assets/index-CQr3ub96.js","assets/index-BzVuEUWK.js","assets/dom-BsAgQ1tn.js","assets/observers-DUW7sOmc.js","assets/ref-BbLvQYvZ.js","assets/static-Cg8qbgEY.js","assets/form-D7JffakF.js","assets/interactive-qE2-EE0w.js","assets/label-BJxvMJjs.js","assets/component-DLyGJqOB.js","assets/useSetFocus-QTV9oE4J.js","assets/layersLoader-BTDb0Baa.js","assets/jsonContext-CImW4CuG.js","assets/featureLayerUtils-BY7Jqlzq.js","assets/originUtils-CSO82zsw.js","assets/utils-DPfEnxkB.js","assets/saveUtils-Dds94L8t.js","assets/FeatureLayerSource-ClstiKdw.js","assets/External-DDsBNPe3.js","assets/MeshTransform-C3D2Jeq4.js","assets/axisAngleDegrees-CbezztQ1.js","assets/editingSupport-umtYHrTl.js","assets/QueryTask-DirABQkF.js","assets/executeForIds-CAt4RKnY.js","assets/index-CbRaCHSA.js","assets/customElement-DVce4Bgg.js","assets/index-CymEwLOV.js","assets/floating-ui-CkcsSwek.js","assets/debounce-D0Dr7phT.js","assets/key-Cyh_1epf.js","assets/openCloseComponent-0668jmtz.js","assets/dynamicClasses-6uzzLOUQ.js","assets/index-Dl_JwbIw.js","assets/keyed-DEcu5U7S.js","assets/index-CaZkAYwq.js","assets/resources7-v6zOX8CA.js","assets/index-C_epJZpm.js","assets/_sortable-Dd8bfR5g.js","assets/customElement-D7rI-bqF.js","assets/FloatingArrow-BAiHkTo5.js","assets/index-WK9-ylyo.js","assets/index-CWDpJ1oW.js","assets/index-2w-W4M4G.js","assets/escapeRegExp-CkRNPaSc.js","assets/useCancelable-BJTetJvS.js","assets/utils2-Qk9lFOp2.js","assets/index-CLRmKLUp.js","assets/resources5-DhgIM17F.js","assets/index-DexyPALL.js","assets/index-Bj4nyfk-.js","assets/index-jkxNT087.js","assets/index-DXYKWOjo.js"])))=>i.map(i=>d[i]);
var aU=Object.getPrototypeOf;var lU=Reflect.get;var Q3=t=>{throw TypeError(t)};var k1=(t,e,r)=>e.has(t)||Q3("Cannot "+r);var je=(t,e,r)=>(k1(t,e,"read from private field"),r?r.call(t):e.get(t)),Ss=(t,e,r)=>e.has(t)?Q3("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),$s=(t,e,r,i)=>(k1(t,e,"write to private field"),i?i.call(t,r):e.set(t,r),r),fp=(t,e,r)=>(k1(t,e,"access private method"),r);var X3=(t,e,r)=>lU(aU(t),r,e);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();let Ca;const ar=globalThis;function k(t){return typeof Ca[t]=="function"?Ca[t]=Ca[t](ar):Ca[t]}Ca=ar.dojoConfig?.has||ar.esriConfig?.has?{...ar.dojoConfig?.has,...ar.esriConfig?.has}:{},k.add=(t,e,r,i)=>{(i||Ca[t]===void 0)&&(Ca[t]=e),r&&k(t)},k.cache=Ca,k.add("big-integer-warning-enabled",!0),k.add("esri-deprecation-warnings",!0),k.add("esri-tests-disable-screenshots",!1),k.add("esri-tests-use-full-window",!1),k.add("esri-tests-post-to-influx",!0),k.add("esri-cim-animations-enable-status","enabled"),k.add("esri-cim-animations-spotlight",!1),k.add("esri-cim-animations-freeze-time",!1),(()=>{k.add("host-webworker",ar.WorkerGlobalScope!==void 0&&self instanceof ar.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(k.add("host-browser",t),k.add("host-node",!(typeof ar.process!="object"||!ar.process.versions?.node||!ar.process.versions.v8)),k.add("dom",t),k("host-browser")){const e=navigator,r=e.userAgent,i=e.appVersion,s=parseFloat(i);if(k.add("wp",parseFloat(r.split("Windows Phone")[1])||void 0),k.add("msapp",parseFloat(r.split("MSAppHost/")[1])||void 0),k.add("khtml",i.includes("Konqueror")?s:void 0),k.add("edge",parseFloat(r.split("Edge/")[1])||void 0),k.add("opr",parseFloat(r.split("OPR/")[1])||void 0),k.add("webkit",!k("wp")&&!k("edge")&&parseFloat(r.split("WebKit/")[1])||void 0),k.add("chrome",!k("edge")&&!k("opr")&&parseFloat(r.split("Chrome/")[1])||void 0),k.add("android",!k("wp")&&parseFloat(r.split("Android ")[1])||void 0),k.add("safari",!i.includes("Safari")||k("wp")||k("chrome")||k("android")||k("edge")||k("opr")?void 0:parseFloat(i.split("Version/")[1])),k.add("mac",i.includes("Macintosh")),!k("wp")&&/(iPhone|iPod|iPad)/.test(r)){const n=RegExp.$1.replace(/P/,"p"),o=/OS ([\d_]+)/.test(r)?RegExp.$1:"1",l=parseFloat(o.replace(/_/,".").replaceAll("_",""));k.add(n,l),k.add("ios",l)}k("webkit")||(!r.includes("Gecko")||k("wp")||k("khtml")||k("edge")||k.add("mozilla",s),k("mozilla")&&k.add("ff",parseFloat(r.split("Firefox/")[1]||r.split("Minefield/")[1])||void 0))}})(),(()=>{if(ar.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),r=/iPhone/i.test(t);e&&k.add("esri-mobile",e),r&&k.add("esri-iPhone",r),k.add("esri-geolocation",!!navigator.geolocation)}k.add("esri-wasm","WebAssembly"in ar),k.add("esri-performance-mode-frames-between-render",20),k.add("esri-force-performance-mode",!1),k.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in ar,e=ar.crossOriginIsolated===!1;return t&&!e}),k.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),k.add("esri-atomics","Atomics"in ar),k.add("esri-workers","Worker"in ar),k.add("web-feat:cache","caches"in ar),k.add("esri-workers-arraybuffer-transfer",!k("safari")||Number(k("safari"))>=12),k.add("workers-pool-size",8),k.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),k.add("featurelayer-simplify-payload-size-factors",[1,1,4]),k.add("featurelayer-fast-triangulation-enabled",!0),k.add("featurelayer-animation-enabled",!0),k.add("featurelayer-snapshot-enabled",!0),k.add("featurelayer-snapshot-initial-tolerance",0),k.add("featurelayer-snapshot-point-min-threshold",8e4),k.add("featurelayer-snapshot-point-max-threshold",4e5),k.add("featurelayer-snapshot-multipoint-min-threshold",2e4),k.add("featurelayer-snapshot-multipoint-max-threshold",1e5),k.add("featurelayer-snapshot-polygon-min-threshold",2e3),k.add("featurelayer-snapshot-polygon-max-threshold",2e3),k.add("featurelayer-snapshot-polyline-min-threshold",2e3),k.add("featurelayer-snapshot-polyline-max-threshold",2e3),k.add("featurelayer-snapshot-max-vertex-count",25e4),k.add("featurelayer-snapshot-non-hosted-exceedslimit-enabled",!0),k.add("featurelayer-snapshot-concurrency",4),k.add("featurelayer-snapshot-coverage",.1),k.add("featurelayer-query-max-depth",4),k.add("featurelayer-query-pausing-enabled",!1),k.add("featurelayer-query-tile-concurrency",4),k.add("featurelayer-query-tile-max-features",6e5),k.add("featurelayer-advanced-symbols",!1),k.add("featurelayer-pbf",!0),k.add("featurelayer-pbf-statistics",!1),k.add("feature-layers-workers",!0),k.add("feature-polyline-generalization-factor",1),k.add("parquetlayer-full-query-feature-count",2e4),k.add("parquetlayer-hittest-max-feature-count",1),k.add("parquetlayer-persistence-enabled",!1),k.add("mapview-transitions-duration",200),k.add("mapview-essential-goto-duration",200),k.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),k.add("mapserver-pbf-version-support",10.81),k.add("mapservice-popup-identify-max-tolerance",20),k.add("request-queue-concurrency-hosted",16),k.add("request-queue-concurrency-non-hosted",4),k.add("curve-densification-coarse-segments",128),k.add("curve-densification-max-segments",2e3),k.add("curve-densification-min-segments",3),k.add("curve-densification-pixel-deviation",.5),k.add("view-readyState-waiting-delay",1e3),k.add("gradient-depth-bias",.01),k.add("gradient-depth-epsilon",1e-8),k.add("enable-feature:esri-compress-textures",!0),k("host-webworker")||k("host-browser")&&(k.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),k.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();function jwe(t){}function uU(t){return()=>t}function Vwe(t){return t}var di;let cU=(di=class{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*di._m}getInt(){return this._seed=(di._a*this._seed+di._c)%di._m,this._seed}getFloat(){return this.getInt()/(di._m-1)}getIntRange(e,r){return Math.round(this.getFloatRange(e,r))}getFloatRange(e,r){const i=r-e;return e+this.getInt()/di._m*i}},di._m=2147483647,di._a=48271,di._c=0,di);const dU=1.5,zwe=1/dU,Uwe=.5;function zA(t){return t}function hU(t,e=zA){if(!t||t.length===0)return;let r=t[0],i=e(r);for(let s=1;s<t.length;++s){const n=t[s],o=Number(e(n));o>i&&(i=o,r=n)}return r}function qwe(t,e=zA){return hU(t,r=>-e(r))}function Gwe(t,e){return e?t.filter((r,i,s)=>s.findIndex(e.bind(null,r))===i):Array.from(new Set(t))}function pU(t,e,r,i,s,n,o){if(t==null&&i==null)return!0;e=Math.max(0,e),s=Math.max(0,s),r=Math.max(0,r<0?(t?.length??0)+r:r),n=Math.max(0,n<0?(i?.length??0)+n:n);const l=r-e;if(t==null||i==null||l!==n-s)return!1;if(o){for(let u=0;u<l;u++)if(!o(t[e+u],i[s+u]))return!1}else for(let u=0;u<l;u++)if(t[e+u]!==i[s+u])return!1;return!0}function hw(t,e,r){return pU(t,0,t?.length??0,e,0,e?.length??0,r)}function Bwe(){return(t,e)=>{if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}}function eI(t,e,r){let i,s;return r?(i=e.filter(n=>!t.some(o=>r(o,n))),s=t.filter(n=>!e.some(o=>r(o,n)))):(i=e.filter(n=>!t.includes(n)),s=t.filter(n=>!e.includes(n))),{added:i,removed:s}}function Hwe(t){return t&&typeof t.length=="number"}function Wwe(t,e){const r=t.length;if(r===0)return[];const i=[];for(let s=0;s<r;s+=e)i.push(t.slice(s,s+e));return i}let UA=class{constructor(){this.last=0}};const qA=new UA;function f_(t,e,r,i){i=i||qA;const s=Math.max(0,i.last-10);for(let o=s;o<r;++o)if(t[o]===e)return i.last=o,o;const n=Math.min(s,r);for(let o=0;o<n;++o)if(t[o]===e)return i.last=o,o;return-1}function m_(t,e,r,i){const s=t.length,n=f_(t,e,s,i);if(n!==-1)return t[n]=t[s-1],t.pop(),e}const xs=new Set;function fU(t,e,r=t.length,i=e.length,s,n){if(i===0||r===0)return r;xs.clear();for(let l=0;l<i;++l)xs.add(e[l]);s=s||qA;const o=Math.max(0,s.last-10);for(let l=o;l<r;++l)if(xs.has(t[l])&&(n?.push(t[l]),xs.delete(t[l]),t[l]=t[r-1],--r,--l,xs.size===0||r===0))return xs.clear(),r;for(let l=0;l<o;++l)if(xs.has(t[l])&&(n?.push(t[l]),xs.delete(t[l]),t[l]=t[r-1],--r,--l,xs.size===0||r===0))return xs.clear(),r;return xs.clear(),r}function mU(t,e){let r=0;for(let i=0;i<t.length;++i){const s=t[i];e(s,i)&&(t[r]=s,r++)}return t.length=r,t}function Jwe(t,e,r){const i=t.length;if(e>=i)return t.slice();const s=GA(r),n=new Set,o=[];for(;o.length<e;){const l=Math.floor(s()*i);n.has(l)||(n.add(l),o.push(t[l]))}return o}function GA(t){return t?(tI.seed=t,()=>tI.getFloat()):Math.random}const tI=new cU;function Ywe(t,e){if(!t)return t;const r=GA(e);for(let i=t.length-1;i>0;i--){const s=Math.floor(r()*(i+1)),n=t[i];t[i]=t[s],t[s]=n}return t}function eT(t,e){const r=t.indexOf(e);return r!==-1?(t.splice(r,1),e):null}function ps(t,e){return t!=null}const Kwe=[];function Qwe(t){return t instanceof ArrayBuffer}function tT(t){return t?.constructor?.name==="Int8Array"}function BA(t){return t?.constructor?.name==="Uint8Array"}function HA(t){return t?.constructor?.name==="Uint8ClampedArray"}function rT(t){return t?.constructor?.name==="Int16Array"}function WA(t){return t?.constructor?.name==="Uint16Array"}function iT(t){return t?.constructor?.name==="Int32Array"}function ZA(t){return t?.constructor?.name==="Uint32Array"}function yU(t){return t?.constructor?.name==="Float16Array"}function pw(t){return t?.constructor?.name==="Float32Array"}function fw(t){return t?.constructor?.name==="Float64Array"}function gU(t){return"buffer"in t}const JA=1024;function Xwe(t){return fw(t)||pw(t)||iT(t)||rT(t)||tT(t)}function e1e(t){return fw(t)||pw(t)}function t1e(t){return fw(t)?179769e303:yU(t)?65504:pw(t)?3402823e32:ZA(t)?4294967295:WA(t)?65535:BA(t)||HA(t)?255:iT(t)?2147483647:rT(t)?32767:tT(t)?127:256}const r1e=-32768,i1e=-2147483648;function s1e(t){return t}function vU(t,e){let r;for(r in t)t.hasOwnProperty(r)&&t[r]===void 0&&delete t[r];return t}function E(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=QA(t);if(e!=null)return e;if(Ff(t))return t.clone();if(YA(t))return t.map(E);if(KA(t))throw new Error("Trying to clone an unclonable Accessor instance");const r={};for(const i of Object.getOwnPropertyNames(t))r[i]=E(t[i]);return r}function y_(t,e){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const r=QA(t);if(r!=null)return r;if(YA(t)){let s=!0;const n=t.map(o=>{const l=y_(o,e);return o!=null&&l==null&&(s=!1),l});return s?n:null}if(Ff(t))return t.clone(e);if(t instanceof File||t instanceof Blob)return t;if(KA(t))return null;const i=new(Object.getPrototypeOf(t)).constructor;for(const s of Object.getOwnPropertyNames(t)){const n=t[s],o=y_(n);if(n!=null&&o==null)return null;i[s]=o}return i}function Ff(t){return typeof t.clone=="function"}function YA(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function KA(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function rI(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function QA(t){if(tT(t)||BA(t)||HA(t)||rT(t)||WA(t)||iT(t)||ZA(t)||pw(t)||fw(t))return t.slice();if(t instanceof Date)return new Date(t);if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[r,i]of t)e.set(r,E(i));return e}if(t instanceof Set){const e=new Set;for(const r of t)e.add(E(r));return e}return null}function sT(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof t?.getTime=="function"&&typeof e?.getTime=="function"&&t.getTime()===e.getTime()||!1}function XA(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&hw(t,e):t instanceof Set?e instanceof Set&&bU(t,e):t instanceof Map?e instanceof Map&&_U(t,e):!!rI(t)&&rI(e)&&wU(t,e))}function wU(t,e){if(t===null||e===null)return!1;const r=Object.keys(t);if(e===null||Object.keys(e).length!==r.length)return!1;for(const i of r)if(t[i]!==e[i]||!Object.prototype.hasOwnProperty.call(e,i))return!1;return!0}function bU(t,e){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}function _U(t,e){if(t.size!==e.size)return!1;for(const[r,i]of t){const s=e.get(r);if(s!==i||s===void 0&&!e.has(r))return!1}return!0}function nT(t,e,r=!1){return tR(t,e,r)}function Ym(t,e){if(e!=null)return e[t]||eR(t.split("."),!1,e)}function Ht(t,e,r){const i=t.split("."),s=i.pop(),n=eR(i,!0,r);n&&s&&(n[s]=e)}function iI(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const r=e;if(t.length!==r.length)return!0;for(let i=0;i<t.length;i++)if(iI(t[i],r[i]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const r in t)if(iI(t[r],e[r]))return!0;return!1}return t!==e}function eR(t,e,r){let i=r;for(const s of t){if(i==null)return;if(!(s in i)){if(!e)return;i[s]={}}i=i[s]}return i}function tR(t,e,r){return e?Object.keys(e).reduce((i,s)=>{if(s==="__proto__")return i;let n=i[s],o=e[s];return n===o?i:n===void 0?(i[s]=E(o),i):(Array.isArray(o)||Array.isArray(i)?(n=n?Array.isArray(n)?i[s]=n.slice():i[s]=[n]:i[s]=[],o&&(Array.isArray(o)||(o=[o]),r?o.forEach(l=>{n.includes(l)||n.push(l)}):i[s]=o.slice())):o&&typeof o=="object"?i[s]=tR(n,o,r):i.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(i[s]=o),i)},t||{}):t}function n1e(t,e){for(const r of Object.entries(t))if(e===r[1])return r[0]}function mw(t,e){return Object.values(t).includes(e)}const _e={apiKey:void 0,apiKeys:{scopes:[]},applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(nT(_e,globalThis.esriConfig,!0),delete _e.has),!_e.assetsPath){{const t="4.34";_e.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}_e.defaultAssetsPath=_e.assetsPath}function a(t,e,r,i){var s=arguments.length,n=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(t,e,r,i);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(n=(s<3?o(n):s>3?o(e,r,n):o(e,r))||n);return s>3&&n&&Object.defineProperty(e,r,n),n}function o1e(t,e){return function(r,i){e(r,i,t)}}function a1e(t,e,r,i){function s(n){return n instanceof r?n:new r(function(o){o(n)})}return new(r||(r=Promise))(function(n,o){function l(p){try{d(i.next(p))}catch(f){o(f)}}function u(p){try{d(i.throw(p))}catch(f){o(f)}}function d(p){p.done?n(p.value):s(p.value).then(l,u)}d((i=i.apply(t,e||[])).next())})}function l1e(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var i,s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=e[Symbol.asyncDispose]}if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=e[Symbol.dispose],r&&(s=i)}if(typeof i!="function")throw new TypeError("Object not disposable.");s&&(i=function(){try{s.call(this)}catch(n){return Promise.reject(n)}}),t.stack.push({value:e,dispose:i,async:r})}else r&&t.stack.push({async:!0});return e}var SU=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var i=new Error(r);return i.name="SuppressedError",i.error=t,i.suppressed=e,i};function u1e(t){function e(n){t.error=t.hasError?new SU(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}var r,i=0;function s(){for(;r=t.stack.pop();)try{if(!r.async&&i===1)return i=0,t.stack.push(r),Promise.resolve().then(s);if(r.dispose){var n=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(n).then(s,function(o){return e(o),s()})}else i|=1}catch(o){e(o)}if(i===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return s()}const $U="modulepreload",xU=function(t){return"/streetlight-web-map/"+t},sI={},N=function(e,r,i){let s=Promise.resolve();if(r&&r.length>0){let u=function(d){return Promise.all(d.map(p=>Promise.resolve(p).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");s=u(r.map(d=>{if(d=xU(d),d in sI)return;sI[d]=!0;const p=d.endsWith(".css"),f=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${f}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":$U,p||(m.as="script"),m.crossOrigin="",m.href=d,l&&m.setAttribute("nonce",l),document.head.appendChild(m),p)return new Promise((y,g)=>{m.addEventListener("load",y),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function n(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&n(l.reason);return e().catch(n)})},TU=/\{([^}]+)\}/g;function nI(t){return t??""}function sl(t,e){return e?t.replaceAll(TU,typeof e=="object"?(r,i)=>nI(Ym(i,e)):(r,i)=>nI(e(i))):t}function c1e(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,r=>e?.includes(r)?r:`\\${r}`)}function rR(t){let e=0;for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return e}let oI;function d1e(t){return oI??=new DOMParser,oI.parseFromString(t||"","text/html").body.innerText||""}function h1e(t,e){return new RegExp(`{${e}}`,"ig").test(t)}function p1e(t,...e){let r=t[0];for(let i=0;i<e.length;++i)r+=e[i]+t[i+1];return r}const aI={info:0,warn:1,error:2,none:3};var It;let L=(It=class{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,It._loggers.set(this.module,this);const r=this.module.lastIndexOf(".");r!==-1&&(this._parent=It.getLogger(this.module.slice(0,r)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,It._loggers.get(e)||new It({module:e})}_log(e,r,...i){if(this._matchLevel(e)){if(r!=="always"&&!It._throttlingDisabled){const s=IU(i),n=this._loggedMessages[e].get(s);if(r==="once"&&n!=null||r==="oncePerTick"&&n&&n>=It._tickCounter)return;this._loggedMessages[e].set(s,It._tickCounter),It._scheduleTickCounterIncrement()}for(const s of _e.log.interceptors)if(s(e,this.module,...i))return;this._inheritedWriter()(e,this.module,...i)}}_parentWithMember(e,r){let i=this;for(;i!=null;){const s=i[e];if(s!=null)return s;i=i.parent}return r}_inheritedWriter(){return this._parentWithMember("writer",MU)}_matchLevel(e){const r=_e.log.level||"warn";return aI[this._parentWithMember("level",r)]<=aI[e]}static _scheduleTickCounterIncrement(){It._tickCounterScheduled||(It._tickCounterScheduled=!0,Promise.resolve().then(()=>{It._tickCounter++,It._tickCounterScheduled=!1}))}},It._loggers=new Map,It._tickCounter=0,It._tickCounterScheduled=!1,It._throttlingDisabled=!1,It);function MU(t,e,...r){console[t](`[${e}]`,...r)}function IU(...t){return rR(JSON.stringify(t,(r,i)=>typeof i!="object"||Array.isArray(i)?i:"[Object]"))}function EU(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,(r,i)=>i===""?"$":(Ym(i,e)??"").toString())}let iR=class{constructor(e,r,i=void 0){this.name=e,this.details=i,this.message=(r&&EU(r,i))??""}toString(){return"["+this.name+"]: "+this.message}},x=class sR extends iR{constructor(e,r,i){super(e,r,i)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,r)=>{if(r&&typeof r=="object"&&typeof r.toJSON=="function")return r;try{return E(r)}catch{return"[object]"}}))}}catch(e){throw L.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new sR(e.name,e.message,e.details)}};x.prototype.type="error";function gm(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}const OU=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,kU={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function lI(t){const e=t?.match(OU);if(!e)return null;const[,r,i,s]=e;if(!r)return null;let n=null,o=null,l=null;const{devext:u,qaext:d,www:p}=kU;if(i)if(n=r,s)switch(s.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:l}=u);break;case"qa":({customBaseUrl:o,portalHostname:l}=d);break;default:return null}else({customBaseUrl:o,portalHostname:l}=p);else switch(r.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:l}=u);break;case"qaext":({customBaseUrl:o,portalHostname:l}=d);break;case"www":({customBaseUrl:o,portalHostname:l}=p);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:l,urlKey:n}}function nR(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function oR(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,r=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,i=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):r.test(t)?t=t.replace(r,"https://devext.arcgis.com"):i.test(t)&&(t=t.replace(i,"https://qaext.arcgis.com")),t}function aR(t){const e=atob(t),r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r.buffer}function CU(t){const e=new Uint8Array(t);let r="";for(let i=0;i<e.length;i++)r+=String.fromCharCode(e[i]);return btoa(r)}const PU=()=>L.getLogger("esri.core.urlUtils"),jh=_e.request,uI="esri/config: esriConfig.request.proxyUrl is not set.",lR=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,uR=/^\s*http:/i,AU=/^\s*https:/i,RU=/^\s*file:/i,cR=/:\d+$/,LU=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,FU=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),NU=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let Sd=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let r=this.uri.match(FU);this.scheme=r[2]||(r[1]?"":null),this.authority=r[4]||(r[3]?"":null),this.path=r[5],this.query=r[7]||(r[6]?"":null),this.fragment=r[9]||(r[8]?"":null),this.authority!=null&&(r=this.authority.match(NU),this.user=r[3]||null,this.password=r[4]||null,this.host=r[6]||r[7],this.port=r[9]||null)}toString(){return this.uri}};const Oy={},DU=new Sd(_e.applicationUrl);let Or=DU;const jU=VU();let oT=jU;const aT=()=>Or,y1e=()=>oT;function VU(){const t=Or.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${Or.scheme}://${Or.host}${Or.port!=null?`:${Or.port}`:""}`}${e}`}function Lr(t){if(!t)return null;const e={path:null,query:null},r=new Sd(t),i=t.indexOf("?");return r.query===null?e.path=t:(e.path=t.slice(0,i),e.query=lT(r.query)),r.fragment&&(e.hash=r.fragment,r.query===null&&(e.path=e.path.slice(0,e.path.length-(r.fragment.length+1)))),e}function lT(t){const e=t.split("&"),r={};for(const i of e){if(!i)continue;const s=i.indexOf("=");let n,o;s<0?(n=decodeURIComponent(i),o=""):(n=decodeURIComponent(i.slice(0,s)),o=decodeURIComponent(i.slice(s+1)));let l=r[n];typeof l=="string"&&(l=r[n]=[l]),Array.isArray(l)?l.push(o):r[n]=o}return r}function vm(t,e){return t?Object.keys(t).map(r=>{const i=t[r];if(i==null)return"";const s=encodeURIComponent(r)+"=",n=e?.[r];return n?s+encodeURIComponent(n(i)):Array.isArray(i)?i.map(o=>gm(o)?s+encodeURIComponent(JSON.stringify(o)):s+encodeURIComponent(o)).join("&"):gm(i)?s+encodeURIComponent(JSON.stringify(i)):s+encodeURIComponent(i)}).filter(r=>r).join("&"):""}function dR(t=!1){let e,r=jh.proxyUrl;if(typeof t=="string"){e=WU(t);const i=yw(t);i&&(r=i.proxyUrl)}else e=!!t;if(!r)throw PU().warn(uI),new x("urlUtils:proxy-not-set",uI);return e&&v_()&&(r=pT(r)),Lr(r)}function g1e(t,e=!1){const r=yw(t);let i,s;if(r){const n=uT(r.proxyUrl);i=n.path,s=n.query?lT(n.query):null}else if(e){const n=dR(t);i=n.path,s=n.query}if(i){const n=Lr(t);t=i+"?"+n.path;const o=vm({...s,...n.query});o&&(t=`${t}?${o}`)}return t}const mp={path:"",query:""};function uT(t){const e=t.indexOf("?");return e!==-1?(mp.path=t.slice(0,e),mp.query=t.slice(e+1)):(mp.path=t,mp.query=null),mp}function hR(t){return t=(t=X0(t=XU(t=uT(t).path),!0)).toLowerCase()}function zU(t){const e={proxyUrl:t.proxyUrl,urlPrefix:hR(t.urlPrefix)},r=jh.proxyRules,i=e.urlPrefix;let s=r.length;for(let n=0;n<r.length;n++){const o=r[n].urlPrefix;if(i.startsWith(o)){if(i.length===o.length)return-1;s=n;break}o.startsWith(i)&&(s=n+1)}return r.splice(s,0,e),s}function yw(t){const e=jh.proxyRules,r=hR(t);for(let i=0;i<e.length;i++)if(r.startsWith(e[i].urlPrefix))return e[i]}function UU(t,e){if(!t||!e)return!1;t=Q0(t),e=Q0(e);const r=lI(t),i=lI(e);return r!=null&&i!=null?r.portalHostname===i.portalHostname:r==null&&i==null&&Cn(t,e,!0)}function pR(t,e){return t=Q0(t),e=Q0(e),X0(t)===X0(e)}function Q0(t){const e=(t=en(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function g_(t,e=jh.interceptors){const r=i=>i instanceof RegExp?i.test(t):typeof i=="string"?t.startsWith(i):i==null;if(e){for(const i of e)if(Array.isArray(i.urls)){if(i.urls.some(r))return i}else if(r(i.urls))return i}return null}function Cn(t,e,r=!1){if(!t||!e)return!1;const i=b_(t),s=b_(e);return!(!r&&i.scheme!==s.scheme)&&i.host!=null&&s.host!=null&&i.host.toLowerCase()===s.host.toLowerCase()&&i.port===s.port}function cT(t){if(typeof t=="string"){if(!gi(t))return!0;t=b_(t)}if(Cn(t,Or))return!0;const e=jh.trustedServers||[];for(let r=0;r<e.length;r++){const i=qU(e[r]);for(let s=0;s<i.length;s++)if(Cn(t,i[s]))return!0}return!1}function qU(t){return Oy[t]||(hT(t)||Fn(t)?Oy[t]=[new Sd(ls(t))]:Oy[t]=[new Sd(`http://${t}`),new Sd(`https://${t}`)]),Oy[t]}function ls(t,e=oT,r){return Fn(t)?r?.preserveProtocolRelative?t:Or.scheme==="http"&&Or.authority===Vi(t).slice(2)?`http:${t}`:`https:${t}`:hT(t)?t:Mu(t.startsWith("/")?KU(e):e,t)}function dT(t,e=oT,r){if(t==null||!gi(t))return t;const i=en(t),s=i.toLowerCase(),n=en(e).toLowerCase().replace(/\/+$/,""),o=r?en(r).toLowerCase().replace(/\/+$/,""):null;if(o&&!n.startsWith(o))return t;const l=(f,m,y)=>(y=f.indexOf(m,y))===-1?f.length:y;let u=l(s,"/",s.indexOf("//")+2),d=-1;for(;s.slice(0,u+1)===n.slice(0,u)+"/"&&(d=u+1,u!==s.length);)u=l(s,"/",u+1);if(d===-1||o&&d<o.length)return t;t=i.slice(d);const p=n.slice(d-1).replaceAll(/[^/]+/g,"").length;if(p>0)for(let f=0;f<p;f++)t=`../${t}`;else t=`./${t}`;return t}function en(t){return t=r7(t=t7(t=e7(t=ls(t=t.trim()))))}function Mu(...t){const e=t.filter(ps);if(!e?.length)return;const r=[];if(gi(e[0])){const s=e[0],n=s.indexOf("//");n!==-1&&(r.push(s.slice(0,n+1)),JU(e[0])&&(r[0]+="/"),e[0]=s.slice(n+2))}else e[0].startsWith("/")&&r.push("");const i=e.reduce((s,n)=>n?s.concat(n.split("/")):s,[]);for(let s=0;s<i.length;s++){const n=i[s];n===".."&&r.length>0&&r[r.length-1]!==".."?r.pop():(!n&&s===i.length-1||n&&(n!=="."||r.length===0))&&r.push(n)}return r.join("/")}function Vi(t,e=!1){if(t==null||Vh(t)||Uu(t))return null;let r=t.indexOf("://");if(r===-1&&Fn(t))r=2;else{if(r===-1)return null;r+=3}const i=t.indexOf("/",r);return i!==-1&&(t=t.slice(0,i)),e&&(t=X0(t,!0)),t}function gi(t){return Fn(t)||hT(t)}function Vh(t){return t!=null&&t.startsWith("blob:")}function Uu(t){return t!=null&&t.startsWith("data:")}function GU(t){const e=gh(t);return e?.isBase64?aR(e.data):null}function v1e(t){return CU(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const BU=/^data:(.*?)(;base64)?,(.*)$/;function gh(t){const e=t.match(BU);if(!e)return null;const[,r,i,s]=e;return{mediaType:r,isBase64:!!i,data:s}}function fR(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function HU(t){return(await fetch(t)).blob()}function w1e(t){const e=GU(t);if(!e)return null;const r=gh(t);return new Blob([e],{type:r.mediaType})}function Fn(t){return t!=null&&t.startsWith("/")&&t[1]==="/"}function hT(t){return t!=null&&lR.test(t)}function WU(t){return t!=null&&AU.test(t)||Or.scheme==="https"&&Fn(t)}function ZU(t){return t!=null&&uR.test(t)||Or.scheme==="http"&&Fn(t)}function JU(t){return t!=null&&RU.test(t)}function pT(t){return Fn(t)?`https:${t}`:t.replace(uR,"https:")}function YU(){return Or.scheme==="http"}function v_(){return Or.scheme==="https"}function X0(t,e=!1){return Fn(t)?t.slice(2):(t=t.replace(lR,""),e&&t.length>1&&t.startsWith("/")&&t[1]==="/"&&(t=t.slice(2)),t)}function KU(t){const e=t.indexOf("//"),r=t.indexOf("/",e+2);return r===-1?t:t.slice(0,r)}function QU(t){let e=0;if(gi(t)){const i=t.indexOf("//");i!==-1&&(e=i+2)}const r=t.lastIndexOf("/");return r<e?t:t.slice(0,r+1)}function b1e(t,e){if(!t)return"";const r=Lr(t).path.replace(/\/+$/,""),i=r.slice(r.lastIndexOf("/")+1);if(!e?.length)return i;const s=new RegExp(`\\.(${e.join("|")})$`,"i");return i.replace(s,"")}function XU(t){return t.endsWith("/")?t:`${t}/`}function mR(t){return t.replace(/\/+$/,"")}function e7(t){if(/^https?:\/\//i.test(t)){const e=uT(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function t7(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function r7(t){const e=jh.httpsDomains;if(!ZU(t))return t;const r=t.indexOf("/",7);let i;if(i=r===-1?t:t.slice(0,r),i=i.toLowerCase().slice(7),cR.test(i)){if(!i.endsWith(":80"))return t;i=i.slice(0,-3),t=t.replace(":80","")}return YU()&&i===Or.authority&&!LU.test(t)||(v_()&&i===Or.authority||e&&e.some(s=>i===s||i.endsWith(`.${s}`))||v_()&&!yw(t))&&(t=pT(t)),t}function w_(t,e,r){if(!(e&&r&&t&&gi(t)))return t;const i=t.indexOf("//"),s=t.indexOf("/",i+2),n=t.indexOf(":",i+2),o=Math.min(s<0?t.length:s,n<0?t.length:n);return t.slice(i+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,i+2)}${r}${t.slice(o)}`}function yR(t,e){const r=new URL(t);return r.host=e,r.port&&!cR.test(e)&&(r.port=""),r.toString()}function i7(t){return new URL(t).host}function b_(t){return typeof t=="string"?new Sd(ls(t)):(t.scheme||(t.scheme=Or.scheme),t)}function _1e(t){return n7.test(t)}function gR(t,e){const r=Lr(t),i=Object.keys(r.query||{});return i.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${i.join(", ")}.`),r.path}function s7(t,e,r){const i=Lr(t),s=i.query||{};return s[e]=String(r),`${i.path}?${vm(s)}`}function C1(t,e){if(!e)return t;const r=Lr(t),i=r.query||{};for(const[n,o]of Object.entries(e))o!=null&&(i[n]=o);const s=vm(i);return s?`${r.path}?${s}`:r.path}function vR(t){if(t==null)return null;const e=t.match(wR);return e?e[2]:null}function cI(t){if(t==null)return null;const e=t.match(wR);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function S1e(t){return typeof t=="string"?gh(t)??{data:t}:new Promise((e,r)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=()=>e(gh(i.result)),i.onerror=s=>r(s)})}const wR=/([^.]*)\.([^/]*)$/,n7=/(^data:image\/svg|\.svg$)/i,bR="20251114",_R="ec088c999de2dac6fb9478a47da1bad775545540";Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");const o7="4.34";let Se,fT=o7;function $1e(t){Se=t}function x1e(t){const e=Se?.findCredential(t);return e?.token?s7(t,"token",e.token):t}fT="4.34.8",k("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),k("host-webworker");function a7(t,e){for(const r of t.values())if(e(r))return!0;return!1}function T1e(t,e){for(const r of t.values())if(!e(r))return!1;return!0}function M1e(t,e){for(const r of t.values())if(e(r))return r;return null}function zh(t,e,r){const i=t.get(e);if(i!==void 0)return i;const s=r();return t.set(e,s),s}function I1e(t){const e=new Map;return r=>(e.has(r)||e.set(r,t(r)),e.get(r))}const l7={remove:()=>{}};function Te(t){return t?{remove(){t&&(t(),t=void 0)}}:l7}function SR(t){t.forEach(e=>e?.remove())}function E1e(t){SR(t),t.length=0}function qu(t){return Te(()=>SR(t))}function O1e(t){return Te(()=>t()?.remove())}function u7(t){return Te(()=>t?.abort())}function k1e(t){return Te(t!=null?()=>t.destroy():void 0)}function c7(t){return typeof t=="object"&&!!t&&"remove"in t&&typeof t.remove=="function"}function C1e(t){c7(t)&&t.remove()}function P1e(t){return{[Symbol.dispose](){t.remove()}}}function d7(t){return{setTimeout:(e,r)=>{const i=t.setTimeout(e,r);return Te(()=>t.clearTimeout(i))}}}const Uh=d7(globalThis);function gw(t){return h7(t)||$R(t)}function h7(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function $R(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function qh(t,e,r){if(!gw(t))throw new TypeError("target is not a Evented or EventTarget object");return $R(t)?p7(t,e,r):t.on(e,r)}function p7(t,e,r,i){if(Array.isArray(e)){const s=e.slice();for(const n of s)t.addEventListener(n,r,i);return Te(()=>{for(const n of s)t.removeEventListener(n,r,i)})}return t.addEventListener(e,r,i),Te(()=>t.removeEventListener(e,r,i))}function xR(t,e,r){if(!gw(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,r);const i=qh(t,e,s=>{i.remove(),r.call(t,s)});return i}function TR(t,e){if(t==null)throw new Error(e??"value is None")}function Ke(t){return t?.destroy(),null}function A1e(t){return t?.dispose(),null}function He(t){return t?.remove(),null}function jo(t){return t?.abort(),null}function R1e(t){return t?.release(),null}function f7(t,e,r){return t!=null&&e!=null?r!=null?r(t,e):t.equals(e):t===e}function ev(t,e){let r;return t.some((i,s)=>(r=e(i,s),r!=null)),r??void 0}function Fe(t="Aborted"){return new x("AbortError",t)}function We(t,e="Aborted"){if(Pr(t))throw Fe(e)}function Km(t){return t instanceof AbortSignal?t:t?.signal??void 0}function Pr(t){const e=Km(t);return e!=null&&e.aborted}function Mn(t){if(nr(t))throw t}function dI(t){if(!nr(t))throw t}function ys(t,e){const r=Km(t);if(r!=null){if(!r.aborted)return xR(r,"abort",()=>e());e()}}function mT(t,e){const r=Km(t);if(r!=null)return We(r),xR(r,"abort",()=>e(Fe()))}function MR(t,e){return Km(e)==null?t:new Promise((r,i)=>{let s=ys(e,()=>i(Fe()));const n=()=>{s=He(s)};t.then(n,n),t.then(r,i)})}function nr(t){return t?.name==="AbortError"}async function vh(t){try{return await t}catch(e){if(!nr(e))throw e;return}}async function tu(t){if(!t)return;if(typeof t.forEach!="function"){const r=Object.keys(t),i=r.map(o=>t[o]),s=await tu(i),n={};return r.map((o,l)=>n[o]=s[l]),n}const e=t;return Promise.allSettled(e).then(r=>Array.from(e,(i,s)=>{const n=r[s];return n.status==="fulfilled"?{promise:i,value:n.value}:{promise:i,error:n.reason}}))}async function m7(t){return(await Promise.allSettled(t)).filter(e=>e.status==="fulfilled").map(e=>e.value)}async function L1e(t){return(await Promise.allSettled(t)).filter(e=>e.status==="rejected").map(e=>e.reason)}function yT(t,e=void 0,r){const i=new AbortController;return ys(r,()=>i.abort()),new Promise((s,n)=>{let o=setTimeout(()=>{o=0,s(e)},t);ys(i,()=>{o&&(clearTimeout(o),n(Fe()))})})}function F1e(t,e,r,i){const s=r&&"abort"in r?r:null;i!=null||s||(i=r);let n=setTimeout(()=>{n=0,s?.abort()},e);const o=()=>i||new x("promiseUtils:timeout","The wrapped promise did not resolve within "+e+" ms");return t.then(l=>{if(n===0)throw o();return clearTimeout(n),l},l=>{throw clearTimeout(n),n===0?o():l})}function y7(t,e){const r=new AbortController,i=setTimeout(()=>r.abort(),e);return ys(t,()=>{r.abort(),clearTimeout(i)}),{...t,signal:r.signal}}function Ar(t){return t&&typeof t.then=="function"}function __(t){return Ar(t)?t:Promise.resolve(t)}function gT(t,e=-1){let r,i,s,n,o=null;const l=(...u)=>{if(r){i=u,n&&n.reject(Fe()),n=bi();const m=n.promise;if(o){const y=o;o=null,y.abort()}return m}if(s=n||bi(),n=null,e>0){const m=new AbortController;r=__(t(...u,m.signal));const y=r;yT(e).then(()=>{r===y&&(n?m.abort():o=m)})}else r=1,r=__(t(...u));const d=()=>{const m=i;i=s=r=o=null,m!=null&&l(...m)},p=r,f=s;return p.then(d,d),p.then(f.resolve,f.reject),f.promise};return l}function bi(){let t,e;const r=new Promise((s,n)=>{t=s,e=n}),i=s=>{t(s)};return i.resolve=s=>t(s),i.reject=s=>e(s),i.timeout=(s,n)=>Uh.setTimeout(()=>i.reject(n),s),i.promise=r,i}function N1e(t,e){e.then(t.resolve,t.reject)}async function hI(t){await Promise.resolve(),We(t)}function Gu(t,e){const r=e?.url?.path;if(t&&r&&(t=ls(t,r,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const i=dT(t,e.portalItem.itemUrl);i!=null&&i.startsWith(g7)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(i).path)}return(t=S_(t,e?.portal))&&ww.test(t)?vT(t):t}function Iu(t,e,r=0){if((t=t&&ww.test(t)?kR(t):t)==null)return t;!gi(t)&&e?.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let i=ls(t);if(e){const s=e.verifyItemRelativeUrls?.rootPath||e.url?.path;if(s){const n=S_(s,e.portal),o=S_(i,e.portal);i=dT(o,n,n),i!=null&&i!==o&&i!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(i)}}return i=OR(i,e?.portal),gi(i)&&(i=en(i)),e?.resources&&e?.portalItem&&!gi(i)&&!Uu(i)&&r===0&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(i),compress:!1}),i}function vw(t,e,r){return Gu(t,r)}function Eu(t,e,r,i){const s=Iu(t,i);s!==void 0&&(e[r]=s)}const ww=/\/items\/([^/]+)\/resources\/(.*)/,g7="./resources/";function IR(t){return(t?.match(ww)??null)?.[1]??null}function ER(t){const e=t?.match(ww)??null;if(e==null)return null;const r=e[2],i=r.lastIndexOf("/");if(i===-1){const{path:o,extension:l}=cI(r);return{prefix:null,filename:o,extension:l}}const{path:s,extension:n}=cI(r.slice(i+1));return{prefix:r.slice(0,i),filename:s,extension:n}}function OR(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?w_(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function S_(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const r=`${e.urlKey}.${e.customBaseUrl}`,i=aT();return Cn(i,`${i.scheme}://${r}`)?w_(t,e.portalHostname,r):w_(t,r,e.portalHostname)}function vT(t){if(!t)return t||null;let e=t;return e&&Se&&!Se.findCredential(e)&&(e=oR(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function kR(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Se&&!Se.findCredential(e)&&(e=oR(e)),e}const v7=Object.freeze(Object.defineProperty({__proto__:null,ensureMainOnlineDomain:OR,fromCDNUrl:kR,fromJSON:Gu,itemIdFromResourceUrl:IR,prefixAndFilenameFromResourceUrl:ER,read:vw,toCDNUrl:vT,toJSON:Iu,write:Eu},Symbol.toStringTag,{value:"Module"})),CR={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},PR=Object.values(CR),AR=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${PR.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),w7=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${PR.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),b7=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function D1e(t){return AR.test(t)}function nl(t){if(t==null)return null;const e=Lr(t),r=e?.path.match(AR)||e?.path.match(w7);if(!r)return null;const[,i,s,n,o]=r,l=s.indexOf("/");return{title:wT(l!==-1?s.slice(l+1):s),serverType:CR[n.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:i}}}function _7(t){const e=Lr(t).path.match(b7);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function wT(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function S7(t,e){const r=[];if(t){const i=nl(t);i!=null&&i.title&&r.push(i.title)}if(e){const i=wT(e);r.push(i)}if(r.length===2){if(r[0].toLowerCase().includes(r[1].toLowerCase()))return r[0];if(r[1].toLowerCase().includes(r[0].toLowerCase()))return r[1]}return r.join(" - ")}function tv(t){let e=Vi(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")||/^[a-z\d-]+\.svcs[a-z\d-]*\./.test(e)))}function $7(t,e){return t&&mR(gR(t,e))}function x7(t){let{url:e}=t;if(!e)return{url:e};e=gR(e,t.logger);const r=Lr(e),i=nl(r.path);let s;if(i!=null)i.sublayer!=null&&t.layer.layerId==null&&(s=i.sublayer),e=i.url.path;else if(t.nonStandardUrlAllowed){const n=_7(r.path);n!=null&&(e=n.serviceUrl,s=n.sublayerId)}return{url:mR(e),layerId:s}}function T7(t,e,r,i,s){Eu(e,i,"url",s),i.url&&t.layerId!=null&&(i.url=Mu(i.url,r,t.layerId.toString()))}function j1e(t){if(!t)return!1;const e=t.toLowerCase(),r=e.includes("/services/"),i=e.includes("/mapserver/wmsserver"),s=e.includes("/imageserver/wmsserver"),n=e.includes("/wmsserver");return r&&(i||s||n)}const M7=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function bT(t){if(!_T(t))return null;const e=i=>i instanceof RegExp?i.test(t):typeof i=="string"&&t.startsWith(i),r=_e.apiKeys;if(Array.isArray(r.scopes)){for(const i of r.scopes)if(Array.isArray(i.urls)){if(i.urls.some(e))return i.token}else if(e(i.urls))return i.token}return r.basemapStyles&&/^https?:\/\/(i?basemaps|basemapstyles)-api\.arcgis\.com\//i.test(t)?r.basemapStyles:_e.apiKey&&/^https?:\/\/.+\.arcgis\.com(\/|$)/i.test(t)?_e.apiKey:null}function $_(){return _e.apiKey!=null||_e.apiKeys.basemapStyles!=null}function RR(t,e){return e?_T(t):bT(t)!=null}function _T(t){const e=Vi(t,!0);return!!e&&!M7.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function I7(t,e,r=!1,i){return new Promise((s,n)=>{if(Pr(i))return void n(pI());let o=()=>{d(),n(new Error(`Unable to load ${e}`))},l=async()=>{const p=t;try{await p.decode()}catch{}d(),s(p)},u=()=>{if(!t)return;const p=t;d(),p.src="",n(pI())};const d=()=>{t&&(t.removeEventListener("error",o),t.removeEventListener("load",l),o=null,l=null,t=null,i?.removeEventListener("abort",u),u=null,r&&URL.revokeObjectURL(e))};i?.addEventListener("abort",u),t.addEventListener("error",o),t.addEventListener("load",l)})}function pI(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const LR="Timeout exceeded";function E7(){return new Error(LR)}function V1e(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===LR}function O7(t){_e.request.crossOriginNoCorsDomains||(_e.request.crossOriginNoCorsDomains={});const e=_e.request.crossOriginNoCorsDomains;for(let r of t)r=r.toLowerCase(),/^https?:\/\//.test(r)?e[Vi(r)??""]=0:(e[Vi("http://"+r)??""]=0,e[Vi("https://"+r)??""]=0)}function k7(t){const e=_e.request.crossOriginNoCorsDomains;if(e){let r=Vi(t);if(r)return r=r.toLowerCase(),!Cn(r,aT())&&e[r]<Date.now()-36e5}return!1}async function C7(t){const e=Lr(t);t=e.path,e.query?.f==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const r=_e.request.crossOriginNoCorsDomains,i=Vi(t);r&&i&&(r[i.toLowerCase()]=Date.now())}const x_=new Map;function P7(t,e){const r=e?.preferredHost;if(!r||Cn(t,`https://${r}`,!0))return;const i=nl(t);if(!i||i.serverType!=="FeatureServer"||nR(t))return;const s=i.url.path.toLowerCase();x_.has(s)||x_.set(s,r)}function fI(t){const e=nl(t)?.url.path.toLowerCase();if(!e)return t;const r=x_.get(e);return r?yR(t,r):t}async function Ae(t,e){t instanceof URL&&(t=t.toString()),e?.query instanceof URLSearchParams&&(e.query=lT(e.query.toString().replaceAll("+"," ")));const r=Uu(t),i=Vh(t);i||r||(t=en(t));const s={url:t,requestOptions:{...e}},n=y=>({data:y,getAllHeaders:wh,getHeader:wh,httpStatus:200,requestOptions:s.requestOptions,url:s.url}),o=g_(t,ns.internalInterceptors);if(o){const y=await yI(o,s);if(y!=null)return n(y)}let l=g_(t);if(l){const y=await yI(l,s);if(y!=null)return n(y);l.after||l.error||(l=null)}if(t=s.url,(e=s.requestOptions).responseType==="image"&&(k("host-webworker")||k("host-node")))throw tn("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),s);if(e.method==="head"){if(e.body)throw tn("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),s);if(r||i)throw tn("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),s)}if(await N7(),rv)return rv.execute(t,e);const u=new AbortController,d=ys(e,()=>u.abort()),p={controller:u,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:l,params:s,redoRequest:!1,useIdentity:ns.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},f=e.useRequestQueue?U7(p):M_(p),m=await f.finally(()=>d?.remove());return l?.after?.(m),m}let rv,FR=!1;const ns=_e.request,NR="FormData"in globalThis,A7=new Set([499,498,403,401]),R7=new Set(["COM_0056","COM_0057","SB_0008"]),L7=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],wh=()=>null,iv=Symbol();function F7(t){const e=Vi(t);e&&!Ae._corsServers.includes(e)&&Ae._corsServers.push(e)}function mI(t){const e=Vi(t);return!e||e.endsWith(".arcgis.com")||Ae._corsServers.includes(e)||cT(e)}function tn(t,e,r,i){let s;const n={url:r.url,requestOptions:r.requestOptions,getAllHeaders:wh,getHeader:wh,ssl:!1};if(e instanceof x)return e.details?(e.details=E(e.details),e.details.url=r.url,e.details.requestOptions=r.requestOptions):e.details=n,e;if(e){const o=i&&(()=>Array.from(i.headers)),l=i&&(p=>i.headers.get(p)),u=i?.status,d=e.message;d&&(s=d),o&&l&&(n.getAllHeaders=o,n.getHeader=l),n.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||u||0,n.subCode=e.subcode,n.messageCode=e.messageCode,typeof e.details=="string"?(n.messages=[e.details],s??=e.details):(n.messages=e.details,s??=n.messages?.[0]),n.raw=iv in e?e[iv]:e}return s??="Error",nr(e)?Fe():new x(t,s,n)}async function N7(){k("host-webworker")&&(!rv&&globalThis.invokeStaticMessage?rv=await N(()=>import("./request-KP0b1RkJ.js"),[]):FR=!0)}async function T_(){Se||await N(()=>import("./IdentityManager-DyLqGjR7.js"),[])}async function D7(t){const e=t.params.url,r=t.params.requestOptions,i=t.controller.signal,s=r.body;let n=null,o=null;if(NR&&"HTMLFormElement"in globalThis&&(s instanceof FormData?n=s:s instanceof HTMLFormElement&&(n=new FormData(s))),typeof s=="string"&&(o=s),t.fetchOptions={cache:r.cacheBust?"no-cache":"default",credentials:"same-origin",headers:r.headers||{},keepalive:r.keepAlive??!1,method:r.method==="head"?"HEAD":"GET",mode:"cors",priority:ns.priority,redirect:"follow",signal:i},(n||o)&&(t.fetchOptions.body=n||o),(FR||r.authMode==="anonymous")&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||r.query?.token||n?.get("token")),!t.hasToken){const l=bT(e);l&&(r.query??={},r.query.token=l,t.hasToken=!0)}if(t.useIdentity&&!t.hasToken&&!t.credential&&!t.credentialToken&&!DR(e)&&!Pr(i)){let l;r.authMode==="immediate"?(await T_(),l=await Se.getCredential(e,{signal:i})):r.authMode==="no-prompt"?(await T_(),l=await Se.getCredential(e,{prompt:!1,signal:i}).catch(()=>{})):Se&&(l=Se.findCredential(e)),l&&(t.credential=l,t.credentialToken=l.token,t.useSSL=!!l.ssl)}}function DR(t){return L7.some(e=>e.test(t))}async function j7(t){let e=t.params.url,r=fI(e);const i=t.params.requestOptions,s=t.fetchOptions??{},n=Vh(e)||Uu(e),o=i.responseType||"json",l=n?0:i.timeout!=null?i.timeout:ns.timeout;let u=!1;if(!n){t.useSSL&&(e=pT(e));let y={...i.query};t.credentialToken&&(y.token=t.credentialToken);let g=vm(y);k("esri-url-encodes-apostrophe")&&(g=g.replaceAll("'","%27"));const v=r.length+1+g.length;let _;u=i.method==="delete"||i.method==="post"||i.method==="put"||!!i.body||v>ns.maxUrlLength;const S=i.useProxy||!!yw(e);if(S){const M=dR(e);_=M.path,!u&&_.length+1+v>ns.maxUrlLength&&(u=!0),M.query&&(y={...M.query,...y})}if(s.method==="HEAD"&&(u||S)){if(u)throw v>ns.maxUrlLength?tn("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):tn("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(S)throw tn("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}u?(s.method=i.method==="delete"?"DELETE":i.method==="put"?"PUT":"POST",i.body?e=C1(e,y):(s.body=vm(y),s.headers||(s.headers={}),s.headers["Content-Type"]="application/x-www-form-urlencoded")):e=C1(e,y),S&&(t.useProxy=!0,e=`${_}?${e}`),y.token&&NR&&s.body instanceof FormData&&!nR(e)&&s.body.set("token",y.token),i.hasOwnProperty("withCredentials")?t.withCredentials=i.withCredentials:Cn(e,aT())||(cT(e)||Se&&Se.findServerInfo(e)?.webTierAuth)&&(t.withCredentials=!0),t.withCredentials&&(s.credentials="include",k7(e)&&await C7(u?C1(e,y):e)),r=fI(e)}let d,p,f=0,m=!1;l>0&&(f=setTimeout(()=>{m=!0,t.controller.abort()},l));try{if(i.responseType==="native-request-init")p=s,p.url=r,i.signal?p.signal=i.signal:delete p.signal;else if(i.responseType!=="image"||s.cache!=="default"||s.keepalive||s.method!=="GET"||u||V7(i.headers)||!n&&!t.useProxy&&ns.proxyUrl&&!mI(e)){if(Ae._beforeFetch&&await Ae._beforeFetch(e,s),d=await fetch(r,s),Ae._afterFetch&&await Ae._afterFetch(d),t.useProxy||F7(e),i.responseType==="native")p=d;else if(s.method!=="HEAD")if(d.ok){switch(o){case"array-buffer":p=await d.arrayBuffer();break;case"blob":case"image":p=await d.blob();break;default:p=await d.text()}if(f&&(clearTimeout(f),f=0),o==="json"||o==="xml"||o==="document")if(p)switch(o){case"json":p=JSON.parse(p);break;case"xml":p=gI(p,"application/xml");break;case"document":p=gI(p,"text/html")}else p=null;if(p){if(o==="array-buffer"||o==="blob"){const y=d.headers.get("Content-Type");if(y&&/application\/json|text\/plain/i.test(y)&&p[o==="blob"?"size":"byteLength"]<=750)try{const g=await new Response(p).json();g.error&&(p=g)}catch{}}o==="image"&&p instanceof Blob&&(p=await vI(URL.createObjectURL(p),t,!0))}}else{p=await d.text();try{p=JSON.parse(p)}catch{}}}else p=await vI(r,t)}catch(y){if(y.name==="AbortError")throw m?E7():Fe("Request canceled");if(!(!d&&y instanceof TypeError&&ns.proxyUrl)||i.body||i.method==="delete"||i.method==="head"||i.method==="post"||i.method==="put"||t.useProxy||mI(e))throw y;t.redoRequest=!0,zU({proxyUrl:ns.proxyUrl,urlPrefix:Vi(e)??""})}finally{f&&clearTimeout(f)}return[d,p]}async function yI(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let r,i;try{i=await t.before(e)}catch(s){r=tn("request:interceptor",s,e)}if((i instanceof Error||i instanceof x)&&(r=tn("request:interceptor",i,e)),r)throw t.error&&t.error(r),r;return i}}function V7(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function gI(t,e){let r;try{r=new DOMParser().parseFromString(t,e)}catch{}if(!r||r.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return r}Ae._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],Ae._beforeFetch=void 0,Ae._afterFetch=void 0;const z7=new Map;async function U7(t){const e=G7(t.params.url);if(!e)return M_(t);const{QueueProcessor:r}=await N(()=>import("./QueueProcessor-CspYquSw.js"),[]);return zh(z7,e.origin,()=>{const s=e.isHosted?k("request-queue-concurrency-hosted"):k("request-queue-concurrency-non-hosted");return new r({concurrency:s,process:n=>{if(Pr(n.params.requestOptions))throw tn("",Fe("Request canceled"),n.params);return M_(n)}})}).push(t)}async function M_(t){let e,r;await D7(t);try{do[e,r]=await j7(t);while(!await q7(t,e,r))}catch(n){const o=tn("request:server",n,t.params,e);throw o.details.ssl=t.useSSL,t.interceptor?.error&&t.interceptor.error(o),o}const i=t.params.url;if(r)if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(i)){if(!t.hasToken&&!t.credentialToken&&r.user?.username&&!cT(i)){const n=Vi(i,!0);n&&ns.trustedServers.push(n)}Array.isArray(r.authorizedCrossOriginNoCorsDomains)&&O7(r.authorizedCrossOriginNoCorsDomains)}else(t.params.requestOptions.responseType||"json")==="json"&&P7(i,r);const s=t.credential;if(s&&Se){let o=Se.findServerInfo(s.server)?.owningSystemUrl;if(o){o=o.replace(/\/?$/,"/sharing");const l=Se.findCredential(o,s.userId);l&&Se._getIdenticalSvcIdx(o,l)===-1&&l.resources.unshift(o)}}return{data:r,getAllHeaders:e?()=>Array.from(e.headers):wh,getHeader:e?n=>e.headers.get(n):wh,httpStatus:e?.status??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function q7(t,e,r){if(t.redoRequest)return t.redoRequest=!1,!1;const i=t.params.requestOptions;if(!e||i.responseType==="native"||i.responseType==="native-request-init")return!0;let s,n;if(r&&(r.error&&typeof r.error=="object"?s=r.error:r.status==="error"&&Array.isArray(r.messages)&&(s={...r},s[iv]=r,s.details=r.messages)),!s&&!e.ok)throw s=new Error(`Unable to load ${e.url} status: ${e.status}`),s[iv]=r,s;let o,l=null;s&&(n=Number(s.code),l=s.hasOwnProperty("subcode")?Number(s.subcode):null,o=s.messageCode,o=o?.toUpperCase());const u=i.authMode;if(n===403&&(l===4||s.message?.toLowerCase().includes("ssl")&&!s.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(u!=="no-prompt"||n===498)&&n!==void 0&&A7.has(n)&&!DR(t.params.url)&&(n!==403||(!o||!R7.has(o))&&(l==null||l===2&&t.credentialToken))){await T_();try{const d=await Se.getCredential(t.params.url,{error:tn("request:server",s,t.params),credential:t.credential,prompt:u!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=d,t.credentialToken=d.token,t.useSSL=t.useSSL||d.ssl,!1}catch(d){if(u==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;s=d}}if(s)throw s;return!0}function vI(t,e,r=!1){const i=e.controller.signal,s=new Image;return e.withCredentials?s.crossOrigin="use-credentials":s.crossOrigin="anonymous",s.alt="",s.fetchPriority=ns.priority,s.src=t,I7(s,t,r,i)}function G7(t){let e,r;return typeof t=="string"?(e=Vi(t,!0),r=tv(t)):(e=t.origin,r=tv(t.toString())),e==null?null:{origin:e,isHosted:r}}function B7(t){return t?.release&&typeof t.release=="function"}function H7(t){return t?.acquire&&typeof t.acquire=="function"}var Ba;let Gh=(Ba=class{constructor(e,r,i,s=1,n=0){this._creator=e,this._acquireFunction=r,this._releaseFunction=i,this.allocationSize=s,this._pool=new Array(n),this._initialSize=n;for(let o=0;o<n;o++)this._pool[o]=this._creator();this.allocationSize=Math.max(s,1)}destroy(){this.prune(0)}acquire(...e){let r;if(Ba.test.disabled)r=this._creator();else{if(this._pool.length===0){const i=this.allocationSize;for(let s=0;s<i;s++)this._pool[s]=this._creator()}r=this._pool.pop()}return this._acquireFunction?this._acquireFunction(r,...e):H7(r)&&r.acquire(...e),r}release(e){e&&!Ba.test.disabled&&(this._releaseFunction?this._releaseFunction(e):B7(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let r=e;r<this._pool.length;++r){const i=this._pool[r];this._dispose(i)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}},Ba.test={disabled:!!k("esri-tests-disable-memory-pools")},Ba);function W7(t){t.length=0}let Br=class{constructor(e=50,r=50){this._pool=new Gh(()=>[],void 0,W7,r,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return P1.acquire()}static release(e){return P1.release(e)}static prune(){P1.prune()}};const P1=new Br(100),wI=new WeakMap;function Z7(t,e,r=!1){const i=` DEPRECATED - ${e}`;if(!r)return void t.warn(i);let s=wI.get(t);s||(s=new Set,wI.set(t,s)),s.has(e)||(s.add(e),t.warn(i))}const sv="https://www.esriurl.com/";function jR(t,e,r,i={}){k("esri-deprecation-warnings")&&Vo(t,`This widget is deprecated. Use the ${e} component instead.`,{see:[`${e} component reference: ${sv}${r}/`,`Esri's move to web components: ${sv}components-transition-plan/`],replacement:`<${r}></${r}>`,warnOnce:!0,...i})}function J7(t,e,r,i={}){k("esri-deprecation-warnings")&&Vo(t,`This view model is deprecated. Use the ${e} component directly instead.`,{see:[`${e} component reference: ${sv}${r}/`,`Esri's move to web components: ${sv}components-transition-plan/`],replacement:`<${r}></${r}>`,warnOnce:!0,...i})}function U1e(t,e,r={}){k("esri-deprecation-warnings")&&Vo(t,`Module: ${e}`,r)}function VR(t,e,r={}){if(k("esri-deprecation-warnings")){const{moduleName:i}=r;Vo(t,`Function: ${(i?i+"::":"")+e+"()"}`,r)}}function I_(t,e,r={}){if(k("esri-deprecation-warnings")){const{moduleName:i}=r;Vo(t,`Property: ${(i?i+"::":"")+e}`,r)}}function Y7(t,e,r,i={}){if(k("esri-deprecation-warnings")){const{moduleName:s}=i;Vo(t,`'${(s?s+"::":"")+e}' value: ${r}`,i)}}function K7(t,e,r={}){k("esri-deprecation-warnings")&&Vo(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...r})}function Vo(t,e,r={}){if(k("esri-deprecation-warnings")){const{replacement:i,version:s,see:n,warnOnce:o}=r;let l=e;if(i&&(l+=`
	 Replacement: ${i}`),s&&(l+=`
	 Version: ${s}`),n)if(Array.isArray(n)){l+=`
	 See for more details:`;for(const u of n)l+=`
		${u}`}else l+=`
	 See ${n} for more details.`;Z7(t,l,o)}}function q1e(t){const e=[];return function*(){yield*e;let r,i=e.length;for(;!(r=t.next()).done;)for(e.push(r.value),yield r.value;++i<e.length;)yield e[i]}}function Q7(t,e){for(const r of t)if(r!=null&&e(r))return r}function nv(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let Bh=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(r=>{e+=r.length}),e}add(e,r){if(nv(e)){const i=this._getOrCreateGroup(r);for(const s of e)_I(s)&&i.push(s)}else _I(e)&&this._getOrCreateGroup(r).push(e);return this}forEach(e,r){if(typeof e=="function")this._groups.forEach(i=>i.forEach(e));else{const i=this._getGroup(e);i&&r&&i.forEach(r)}}has(e){return this._groups.has(ky(e))}remove(e){if(typeof e!="string"&&nv(e)){for(const r of e)this.remove(r);return this}return this.has(e)?(bI(this._getGroup(e)),this._groups.delete(ky(e)),this):this}removeAll(){return this._groups.forEach(bI),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const r=[];return this._groups.set(ky(e),r),r}_getGroup(e){return this._groups.get(ky(e))}};function ky(t){return t||"_default_"}function bI(t){for(const e of t)e instanceof Bh?e.removeAll():e.remove()}function _I(t){return t!=null&&(!!t.remove||t instanceof Bh)}const zR=Symbol("Accessor-beforeDestroy");function Xr(t){return t.__accessor__??null}function X7(t,e){return t?.metadata?.[e]!=null}function Cg(t,e,r){return r?ov(t,e,{policy:r,path:""}):ov(t,e,null)}function ov(t,e,r){return e?Object.keys(e).reduce((i,s)=>{const n=s;if(n==="__proto__")return i;let o=null,l="merge";if(r&&(o=r.path?`${r.path}.${s}`:s,l=r.policy(o)),l==="replace"||l==="replace-arrays"&&Array.isArray(i[n]))return i[n]=e[n],i;if(i[n]===void 0)return i[n]=E(e[n]),i;let u=i[n],d=e[n];if(u===d)return i;if(Array.isArray(d)||Array.isArray(i))u=u?Array.isArray(u)?i[n]=u.slice():i[n]=[u]:i[n]=[],d&&(Array.isArray(d)||(d=[d]),d.forEach(p=>{u.includes(p)||u.push(p)}));else if(d&&typeof d=="object")if(r){const p=r.path;r.path=o,i[n]=ov(u,d,r),r.path=p}else i[n]=ov(u,d,null);else i.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(i[n]=d);return i},t||{}):t}function UR(t){return Array.isArray(t)?t:t.split(".")}function SI(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function eq(t){if(Array.isArray(t)){const e=[];for(const r of t)e.push(...SI(r));return e}return SI(t)}function qR(t,e,r,i){const s=eq(e);if(s.length!==1){const n=s.map(o=>i(t,o,r));return qu(n)}return i(t,s[0],r)}function GR(t,e){const r=t.endsWith("?")?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const s=parseInt(r,10);if(!isNaN(s))return Array.isArray(e)?e[s]:e.at(s)}const i=Xr(e);return X7(i,r)?i.get(r):e[r]}function BR(t,e,r){if(t==null)return t;const i=GR(e[r],t);return!i&&r<e.length-1?void 0:r===e.length-1?i:BR(i,e,r+1)}function Qm(t,e,r=0){return typeof e!="string"||e.includes(".")?BR(t,UR(e),r):GR(e,t)}function Ys(t,e){return Qm(t,e)}function $I(t,e){return Qm(e,t)!==void 0}const Fi={INITIALIZING:0,CONSTRUCTING:1,CONSTRUCTED:2,DESTROYING:3,DESTROYED:4};function Hh(t){let e=t.constructor.__accessorMetadata__;const r=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!r){e=Object.create(e);for(const i in e)e[i]=E(e[i]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function Xm(t,e){const r=Hh(t);let i=r[e];return i||(i=r[e]={}),i}function tq(t,e){return Cg(t,e,iq)}const rq=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function iq(t){return rq.test(t)?"replace":"merge"}let sq=class{constructor(e,r){this._observers=e,this._observer=r}remove(){eT(this._observers,this._observer)}},HR=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return nq;this._observers==null&&(this._observers=[]);const r=this._observers;let i=!1,s=!1;const n=r.length;for(let o=0;o<n;++o){const l=r[o];if(l.destroyed)s=!0;else if(l===e){i=!0;break}}return i||(r.push(e),s&&this._removeDestroyedObservers()),new sq(r,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const r=e.length;let i=0;for(let s=0;s<r;++s){for(;s+i<r&&e[s+i].destroyed;)++i;if(i>0){if(!(s+i<r))break;e[s]=e[s+i]}}e.length=r-i}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const r of e)r.onCommitted();this._observers=null}}};const nq=Te(),it={Dirty:1,Overridden:2,Computing:4,NonNullable:8,HasDefaultValue:16,DepTrackingInitialized:32,AutoTracked:64,ExplicitlyTracking:128};let bw=class{constructor(e){this.accessed=void 0,this._handles=void 0,this._observer=e}destroy(){this.accessed?.clear(),this.clear()}onAccessed(e){this._observer!=null&&e!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(e))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach(e=>{this._handles.push(e.observe(this._observer))}),this.accessed.clear()))}clear(){if(this._handles!=null){for(let e=0;e<this._handles.length;++e)this._handles[e].remove();this._handles.length=0}}};const av=new bw,Up=[];let Nf=av;function le(t){Nf.onAccessed(t)}let Pg=!1,Ag=!1;function zo(t,e,r){if(Pg)return ST(t,e,r);let i=null;return WR(t),i=e.call(r),ZR(),i}function oq(t,e){return zo(av,t,e)}function ST(t,e,r){const i=Pg;Pg=!0,WR(t);let s=null;try{s=e.call(r)}catch(n){Ag&&L.getLogger("esri.core.accessorSupport.tracking").error(n)}return ZR(),Pg=i,s}function WR(t){Nf=t,Up.push(t)}function ZR(){const t=Up.length;if(t>1){const e=Up.pop();Nf=Up[t-2],e.onTrackingEnd()}else if(t===1){const e=Up.pop();Nf=av,e.onTrackingEnd()}else Nf=av}function JR(t,e){if(e.flags&it.DepTrackingInitialized)return;e.flags|=it.DepTrackingInitialized;const r=Ag;Ag=!1,e.flags&it.AutoTracked?ST(e.trackingTarget,e.metadata.get,t):YR(t,e),Ag=r}const aq=[];function YR(t,e){e.flags&it.ExplicitlyTracking||(e.flags|=it.ExplicitlyTracking,ST(e.trackingTarget,()=>{const r=e.metadata.dependsOn||aq;for(const i of r)if(typeof i!="string"||i.includes(".")){const s=UR(i);for(let n=0,o=t;n<s.length&&o!=null&&typeof o=="object";++n)o=xI(o,s[n],n!==s.length-1)}else xI(t,i,!1)}),e.flags&=-129)}function xI(t,e,r){const i=e.endsWith("?")?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const n=parseInt(i,10);if(!isNaN(n))return Array.isArray(t)?t[n]:t.at(n)}const s=Xr(t);if(s){const n=s.propertiesByName.get(i);n&&(le(n),JR(t,n))}return r?t[i]:void 0}let TI=class extends HR{constructor(e,r){super(),this.propertyName=e,this.metadata=r,this.trackingTarget=new bw(this),this.flags=0,this.flags=it.Dirty|(r.nonNullable?it.NonNullable:0)|(r.hasOwnProperty("value")?it.HasDefaultValue:0)|(r.get===void 0?it.DepTrackingInitialized:0)|(r.dependsOn===void 0?it.AutoTracked:0)}destroy(){this.flags&it.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(e){e.mutable&&le(this);const r=e.store,i=this.propertyName,s=this.flags,n=r.get(i);if(s&it.Computing||~s&it.Dirty&&r.has(i))return n;this.flags|=it.Computing;const o=e.host;let l;s&it.AutoTracked?l=zo(this.trackingTarget,this.metadata.get,o):(YR(o,this),l=this.metadata.get.call(o)),this.flags|=it.DepTrackingInitialized,r.set(i,l,1);const u=r.get(i);return u===n?this.flags&=-2:oq(this.commit,this),this.flags&=-5,u}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=-2,this.onCommitted()}onInvalidated(){~this.flags&it.Overridden&&(this.flags|=it.Dirty);const e=this._observers;if(e&&e.length>0)for(const r of e)r.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const r=e.slice();for(const i of r)i.onCommitted()}}};const E_=8;function Co(t){switch(t){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"link-chart":return 6;case"user":return 7;default:return null}}function wm(t){switch(t){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"link-chart";case 7:return"user"}}function lq(t){return wm(t)}let uq=class KR{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const r=new KR;return this._values.forEach((i,s)=>{e&&e.has(s)||r.set(s,E(i))}),r}get(e){return this._values.get(e)}originOf(){return 7}keys(){return[...this._values.keys()]}set(e,r){this._values.set(e,r)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}isAtOrigin(e,r){return this.has(e)}isBelowOrigin(e,r){return!this.has(e)}forEach(e){this._values.forEach(e)}};function Qu(t,e,r){return t!==void 0}function MI(t,e,r,i){return t!==void 0&&(!(r==null&&t.flags&it.NonNullable)||(i.lifecycle,!1))}let cq=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=Fi.INITIALIZING,this.store=new uq,this.mutable=!0,this._origin=7;const r=this.host.constructor.__accessorMetadata__;for(const i in r){const s=new TI(i,r[i]);this.propertiesByName.set(i,s)}this.metadata=r}initialize(){this.lifecycle=Fi.CONSTRUCTING}constructed(){this.lifecycle=Fi.CONSTRUCTED}destroy(){this.lifecycle=Fi.DESTROYED,this.propertiesByName.forEach(e=>e.destroy())}get initialized(){return this.lifecycle!==Fi.INITIALIZING}get(e){const r=this.propertiesByName.get(e);if(!Qu(r))return;if(r.metadata.get)return r.getComputed(this);this.mutable&&le(r);const i=this.store;return i.has(e)?i.get(e):r.metadata.value}originOf(e){const r=this.store.originOf(e);if(r===void 0){const i=this.propertiesByName.get(e);if(i!==void 0&&i.flags&it.HasDefaultValue)return"defaults"}return wm(r)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const r=this.propertiesByName.get(e);if(Qu(r))return this.store.has(e)?this.store.get(e):r.metadata.value}internalSet(e,r){const i=this.propertiesByName.get(e);Qu(i)&&this._internalSet(i,r)}getDependsInfo(e,r,i){const s=this.propertiesByName.get(r);if(!Qu(s))return"";const n=new bw,o=zo(n,()=>s.metadata.get?.call(e));let l=`${i}${e.declaredClass.split(".").pop()}.${r}: ${o}
`;const u=n.accessed??new Set;if(u.size===0)return l;i+="  ";for(const d of u)d instanceof TI&&(l+=`${i}${d.propertyName}: undefined
`);return l}setAtOrigin(e,r,i){const s=this.propertiesByName.get(e);if(Qu(s))return this._setAtOrigin(s,r,i)}isOverridden(e){const r=this.propertiesByName.get(e);return r!==void 0&&!!(r.flags&it.Overridden)}clearOrigin(e,r){const i=this.store,s=this.propertiesByName.get(e);if(!Qu(s))return;const n=i.isAtOrigin(e,r)&&!(s.flags&it.Overridden);i.delete(e,r),n&&s.notifyChange()}clearOverride(e){const r=this.propertiesByName.get(e);r&&r.flags&it.Overridden&&(r.flags&=-3,r.notifyChange())}override(e,r){const i=this.propertiesByName.get(e);if(!MI(i,e,r,this))return;const s=i.metadata.cast;if(s){const n=this._cast(s,r),{valid:o,value:l}=n;if(A1.release(n),!o)return;r=l}i.flags|=it.Overridden,this._internalSet(i,r)}set(e,r){const i=this.propertiesByName.get(e);if(!MI(i,e,r,this))return;const s=i.metadata.cast;if(s){const o=this._cast(s,r),{valid:l,value:u}=o;if(A1.release(o),!l)return;r=u}const n=i.metadata.set;n?n.call(this.host,r):this._internalSet(i,r)}setDefaultOrigin(e){this._origin=Co(e)}getDefaultOrigin(){return wm(this._origin)}notifyChange(e){const r=this.propertiesByName.get(e);r!==void 0&&r.notifyChange()}invalidate(e){const r=this.propertiesByName.get(e);r!==void 0&&r.invalidate()}commit(e){const r=this.propertiesByName.get(e);r!==void 0&&r.commit()}_internalSet(e,r){const i=this.lifecycle!==Fi.INITIALIZING?this._origin:0;this._setAtOrigin(e,r,i)}_setAtOrigin(e,r,i){const s=this.store,n=e.propertyName;if(s.isAtOrigin(n,i)&&sT(r,s.get(n))&&~e.flags&it.Overridden)return;const o=s.isBelowOrigin(n,i)||s.isAtOrigin(n,i);o&&e.invalidate(),s.set(n,r,i),o&&e.commit(),JR(this.host,e)}_cast(e,r){const i=A1.acquire();return i.valid=!0,i.value=r,e&&(i.value=e.call(this.host,r,i)),i}},dq=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const A1=new Gh(()=>new dq);function lv(t,e,r){if(t&&e)if(typeof e=="object")for(const i of Object.getOwnPropertyNames(e))lv(t,i,e[i]);else{if(e.includes(".")){const s=e.split("."),n=s.splice(-1,1)[0];return void lv(Ys(t,s),n,r)}const i=t.__accessor__;i!=null&&hq(e,i),t[e]=r}}function hq(t,e){if(k("esri-unknown-property-errors")&&!pq(t,e))throw new x("set:unknown-property",fq(t,e))}function pq(t,e){return e.metadata[t]!=null}function fq(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let mq;function yq(){return mq}let QR=class extends Gh{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const r=super.acquire(...e);return this._set.delete(r),r}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const Cy=[];function uv(t){Cy.push(t),Cy.length===1&&queueMicrotask(()=>{const e=Cy.slice();Cy.length=0;for(const r of e)r()})}let Df=class{constructor(e,r=30){this.name=e,this._counter=0,this._samples=new Array(r)}push(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}set(e){e!=null&&(this._samples[this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,r)=>e-r)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,r)=>e+r,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};const cv=(t,e,r,i)=>{let s=e,n=e;const o=r>>>1,l=t[s-1];for(;n<=o;){n=s<<1,n<r&&i(t[n-1],t[n])<0&&++n;const u=t[n-1];if(i(u,l)<=0)break;t[s-1]=u,s=n}t[s-1]=l},XR=(t,e)=>t<e?-1:t>e?1:0;function gq(t,e,r,i){r===void 0&&(r=t.length),i===void 0&&(i=XR);for(let n=r>>>1;n>e;n--)cv(t,n,r,i);const s=e+1;for(let n=r-1;n>e;n--){const o=t[e];t[e]=t[n],t[n]=o,cv(t,s,n,i)}}function*vq(t,e,r,i){r===void 0&&(r=t.length),i===void 0&&(i=XR);for(let n=r>>>1;n>e;n--)cv(t,n,r,i),yield;const s=e+1;for(let n=r-1;n>e;n--){const o=t[e];t[e]=t[n],t[n]=o,cv(t,s,n,i),yield}}const wq=1.5,bq=1.1;let eL=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new UA,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>II(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const r=new Array;for(let i=0;i<this._length;i++){const s=this.data[i];e(s)&&r.push(s)}return r}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,r){const i=this.data.indexOf(e,r);return i!==-1&&i<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let r=e;r<this._length;++r)this.data[r]=this._deallocator(this.data[r]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,r=e.length){for(let i=0;i<r;i++)this.data[this._length++]=e[i]}fill(e,r){for(let i=0;i<r;i++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,II(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const r=f_(this.data,e,this.length,this._hint);if(r!==-1)return this.data.splice(r,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(f_(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,r=e.length,i){this.length=fU(this.data,e,this.length,r,this._hint,i),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,r){if(e>=this.length||r>=this.length||e===r)return;const i=this.data[e];this.data[e]=this.data[r],this.data[r]=i}sort(e){gq(this.data,0,this.length,e)}iterableSort(e){return vq(this.data,0,this.length,e)}some(e,r){for(let i=0;i<this.length;++i)if(e.call(r,this.data[i],i,this.data))return!0;return!1}find(e,r){const{data:i,length:s}=this;for(let n=0;n<s;++n)if(e.call(r,i[n]))return i[n]}filterInPlace(e,r){let i=0;for(let s=0;s<this._length;++s){const n=this.data[s];e.call(r,n,s,this.data)&&(this.data[s]=this.data[i],this.data[i]=n,i++)}if(this._deallocator)for(let s=i;s<this._length;s++)this.data[s]=this._deallocator(this.data[s]);return this._length=i,this._shrink(),this}forAll(e,r){const{data:i,length:s}=this;for(let n=0;n<s;++n)e.call(r,i[n],n,i)}forEach(e,r){this.data.slice(0,this.length).forEach(e,r)}map(e,r){const i=new Array(this.length);for(let s=0;s<this.length;++s)i[s]=e.call(r,this.data[s],s,this.data);return i}reduce(e,r){let i=r;for(let s=0;s<this.length;++s)i=e(i,this.data[s],s,this.data);return i}has(e){const r=this.length,i=this.data;for(let s=0;s<r;++s)if(i[s]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function II(t){t.data.length>wq*t.length&&(t.data.length=Math.floor(t.length*bq))}function ebe(t){return t}function _q(t){return 1e3*t}function tbe(t){return t}function rbe(t){return .001*t}let Sq=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},$q=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},O_=0;const yp={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},k_=["prepare","preRender","render","postRender","update","finish"],C_=[],Ou=new eL;let xq=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1,tL()}};function Tq(){hu!=null&&(cancelAnimationFrame(hu),hu=requestAnimationFrame($T))}function tL(){hu==null&&(O_=performance.now(),hu=requestAnimationFrame($T))}const dv={frameTasks:Ou,willDispatch:!1,clearFrameTasks:Mq,dispatch:iL,executeFrameTasks:Iq,reschedule:Tq};function Wh(t){const e=new $q(t);return C_.push(e),dv.willDispatch||(dv.willDispatch=!0,uv(iL)),e}function bh(t){const e=new Sq(t);return Ou.push(e),tL(),new xq(e)}let hu=null;function Mq(t=!1){Ou.forAll(e=>{e.removed=!0}),t&&rL()}function $T(){const t=performance.now();hu=null,hu=Ou.some(r=>!r.paused&&!r.removed)?requestAnimationFrame($T):null,dv.executeFrameTasks(t)}function Iq(t){const e=t-O_;O_=t;const r=1e3/60,i=Math.max(0,e-r);yp.time=t,yp.frameDuration=r-i;for(let s=0;s<k_.length;s++){const n=performance.now(),o=k_[s];Ou.forAll(l=>{l.paused||l.removed||(s===0&&l.ticks++,l.phases[o]&&(yp.elapsedFrameTime=performance.now()-t,yp.deltaTime=l.ticks===0?0:e,l.phases[o]?.call(l,yp)))}),kq[s].push(performance.now()-n)}rL(),Cq.push(performance.now()-t)}const Py=new eL;function rL(){Ou.forAll(t=>{t.removed&&Py.push(t)}),Ou.removeUnorderedMany(Py.data,Py.length),Py.clear()}function iL(){for(;C_.length;){const t=C_.shift();t.isActive&&t.callback()}dv.willDispatch=!1}function Eq(t=1,e){const r=bi(),i=()=>{Pr(e)?r.reject(Fe()):t===0?r():(--t,uv(()=>i()))};return i(),r.promise}function Oq(t){return Eq(1,t)}async function sL(t){await Oq(t),await new Promise(e=>requestAnimationFrame(()=>{t?.aborted||e()}))}const kq=k_.map(t=>new Df(t)),Cq=new Df("total");function nL(t,e){for(const r of t.values())if(e(r))return!0;return!1}function hv(t,e){if(!e)return t;for(const r of e)r!=null&&t.add(r);return t}function EI(t,e){return e!=null&&t.add(e),t}function xT(t,e){const r=new Set;return hv(r,t),hv(r,e),r}function Pq(t,e){const r=new Set;for(const i of e)t.has(i)&&r.add(i);return r}function obe(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const r of t)if(!e.has(r))return!1;return!0}function abe(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}function Aq(t,e){const r=new Set(t);for(const i of e)r.delete(i);return r}function Rq(t,e){return Aq(xT(t,e),Pq(t,e))}let Lq=0;function Rg(){return++Lq}let _w=class extends bw{constructor(e){super(new Fq(e)),this._observer&&OI.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&OI.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}},Fq=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=Nq}};const OI=new FinalizationRegistry(t=>{t.deref()?.destroy()});function Nq(){}let $d=!1;const pv=[];function oL(t,e){let r=new _w(n),i=null,s=!1;function n(){if(!r||s)return;if($d)return void uL(n);const l=i;r.clear(),$d=!0,s=!0,i=zo(r,t),s=!1,$d=!1,e(i,l),cL()}function o(){r&&(r.destroy(),r=null,i=null)}return s=!0,i=zo(r,t),s=!1,Te(o)}function aL(t,e){let r=new _w(s),i=null;function s(){e(i,o)}function n(){r&&(r.destroy(),r=null),i=null}function o(){return r?(r.clear(),i=zo(r,t),i):null}return o(),Te(n)}function lL(t,e){let r=!1,i=!1;const s=!!e?.sync;let n=new _w(()=>{r||i||(i=!0,s?o():queueMicrotask(o))});function o(){i=!1,n&&!r&&($d?uL(o):(n.clear(),$d=!0,r=!0,zo(n,t),r=!1,$d=!1,cL()))}function l(){n&&(n.destroy(),n=null)}return r=!0,zo(n,t),r=!1,Te(l)}function uL(t){pv.includes(t)||pv.unshift(t)}function cL(){for(;pv.length;)pv.pop()()}var bu;let TT=(bu=class{constructor(){this.uid=Rg(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,r,i,s,n){return this.pool.acquire(0,e,r,i,s,n,sT)}static acquireTracked(e,r,i,s){return this.pool.acquire(1,e,r,i,null,null,s)}notify(e,r){this.type===0?this.callback.call(this.target,e,r,this.path,this.target):this.callback.call(null,e,r,void 0,void 0)}acquire(e,r,i,s,n,o,l){this.uid=Rg(),this.removed=!1,this.type=e,this.oldValue=r,this.callback=i,this.getValue=s,this.target=n,this.path=o,this.equals=l}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=Rg(),this.removed=!0}},bu.pool=new QR(()=>new bu),bu);const Lg=new Br,Lo=new Set;let fv;function mv(t){Lo.delete(t),Lo.add(t),dL()}function dL(){fv||(fv=Wh(Vq))}function Dq(t){if(t.removed)return;const e=t.oldValue,r=t.getValue();t.equals(e,r)||(t.oldValue=r,t.notify(r,e))}function jq(t){for(const e of Lo.values())e.target===t&&(e.removed=!0)}function Vq(){let t=10;for(;fv&&t--;){fv=null;const e=zq(),r=Lg.acquire();for(const i of e){const s=i.uid;Dq(i),s===i.uid&&i.removed&&r.push(i)}for(const i of Lo)i.removed&&(r.push(i),Lo.delete(i));for(const i of r)TT.pool.release(i);Lg.release(r),Lg.release(e),P_.forEach(i=>i())}}function zq(){const t=Lg.acquire();t.length=Lo.size;let e=0;for(const r of Lo)t[e]=r,++e;return Lo.clear(),t}const P_=new Set;function Uq(t){return P_.add(t),Te(()=>P_.delete(t))}function qq(t,e,r){let i=qR(t,e,r,(s,n,o)=>{let l,u,d=aL(()=>Qm(s,n),(p,f)=>{s.__accessor__?.lifecycle===Fi.DESTROYED||l&&l.uid!==u?i.remove():(l||(l=TT.acquireUntracked(p,o,f,s,n),u=l.uid),mv(l))});return Te(()=>{d.remove(),l&&(l.uid!==u||l.removed||(l.removed=!0,mv(l)),l=null),i=d=null})});return i}function Gq(t,e,r){const i=qR(t,e,r,(s,n,o)=>{let l=!1;return oL(()=>Qm(s,n),(u,d)=>{s.__accessor__.lifecycle!==Fi.DESTROYED?l||(l=!0,sT(d,u)||o.call(s,u,d,n,s),l=!1):i.remove()})});return i}function Bq(t,e,r,i=!1){return t.__accessor__&&t.__accessor__.lifecycle!==Fi.DESTROYED?i?Gq(t,e,r):qq(t,e,r):Te()}function Hq(t,e,r){let i,s,n=aL(t,(o,l)=>{i&&i.uid!==s?n.remove():(i||(i=TT.acquireTracked(o,e,l,r),s=i.uid),mv(i))});return Te(()=>{n.remove(),i&&(i.uid!==s||i.removed||(i.removed=!0,mv(i)),i=null),n=null})}function Wq(t,e,r){let i=!1;return oL(t,(s,n)=>{i||(i=!0,r(n,s)||e(s,n),i=!1)})}function Zq(t,e,r=!1,i=XA){return r?Wq(t,e,i):Hq(t,e,i)}function kI(t){return nL(Lo,e=>e.oldValue===t)}const pu=()=>L.getLogger("esri.core.accessorSupport.ensureTypes");function Jq(t){if(t==null)return t;const e=new Date(t);return isNaN(e.getTime())?(pu().error("Accessor#set",`Invalid date value: '${t}', falling back to current date`),new Date):e}function Yq(t){return t==null?t:!!t}function ey(t){return t==null?t:t.toString()}function Hr(t,e=0){return t==null?t:(t=parseFloat(t),isNaN(t)?e:t)}function MT(t){return t==null?t:Math.round(parseFloat(t))}function Kq(t){return null}function Qq(t,e){return r=>{let i=t(r);return e.step!=null&&(i=Math.round(i/e.step)*e.step),e.min!=null&&(i=Math.max(e.min,i)),e.max!=null&&(i=Math.min(e.max,i)),i}}function hL(t){return t?.constructor&&t.constructor.__accessorMetadata__!==void 0}function yv(t,e){return e!=null&&t&&!(e instanceof t)}function pL(t){return t&&"isCollection"in t}function CI(t){return t?.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function Xq(t,e){if(!e?.constructor||!pL(e.constructor))return A_(t,e)?e:new t(e);const r=CI(t.prototype.itemType),i=CI(e.constructor.prototype.itemType);return r?i?r===i?e:r.prototype.isPrototypeOf(i.prototype)?new t(e):(A_(t,e),e):new t(e):e}function A_(t,e){return!!hL(e)&&(pu().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+Sw(t)+"'"),!0)}function Zh(t,e){return e==null?e:pL(t)?Xq(t,e):yv(t,e)?A_(t,e)?e:new t(e):e}function Sw(t){return t?.prototype?.declaredClass||"unknown"}const eG=new WeakMap;function tG(t){switch(t){case Number:return e=>Hr(e);case xe:return MT;case Boolean:return Yq;case String:return ey;case Date:return Jq;case $w:return Kq;default:return zh(eG,t,()=>Zh.bind(null,t))}}function ct(t,e){const r=tG(t);return arguments.length===1?r:r(e)}function bm(t,e,r){return arguments.length===1?bm.bind(null,t):e&&(Array.isArray(e)?e.map(i=>t(i,r)):[t(e,r)])}function rG(t,e){return arguments.length===1?bm(r=>ct(t,r)):bm(r=>ct(t,r),e)}function fL(t,e,r){return e!==0&&Array.isArray(r)?r.map(i=>fL(t,e-1,i)):t(r)}function gv(t,e,r){if(arguments.length===2)return n=>gv(t,e,n);if(!r)return r;r=fL(t,e,r);let i=e,s=r;for(;i>0&&Array.isArray(s);)i--,s=s[0];if(s!==void 0)for(let n=0;n<i;n++)r=[r];return r}function iG(t,e,r){return arguments.length===2?gv(i=>ct(t,i),e):gv(i=>ct(t,i),e,r)}function mL(t){return!!Array.isArray(t)&&!t.some(e=>{const r=typeof e;return!(r==="string"||r==="number"||r==="function"&&t.length>1)})}function R_(t,e){if(arguments.length===2)return R_(t).call(null,e);const r=new Set,i=t.filter(l=>typeof l!="function"),s=t.filter(l=>typeof l=="function");for(const l of t)typeof l!="string"&&typeof l!="number"||r.add(l);let n=null,o=null;return(l,u)=>{if(l==null)return l;const d=typeof l,p=d==="string"||d==="number";return p&&(r.has(l)||s.some(f=>d==="string"&&f===String||d==="number"&&f===Number))||d==="object"&&s.some(f=>!yv(f,l))?l:(p&&i.length?(n||(n=i.map(f=>typeof f=="string"?`'${f}'`:`${f}`).join(", ")),pu().error("Accessor#set",`'${l}' is not a valid value for this property, only the following values are valid: ${n}`)):typeof l=="object"&&s.length?(o||(o=s.map(f=>Sw(f)).join(", ")),pu().error("Accessor#set",`'${l}' is not a valid value for this property, value must be one of ${o}`)):pu().error("Accessor#set",`'${l}' is not a valid value for this property`),u&&(u.valid=!1),null)}}function Nn(t,e){if(arguments.length===2)return Nn(t).call(null,e);const r={},i=[],s=[];for(const u in t.typeMap){const d=t.typeMap[u];r[u]=ct(d),i.push(Sw(d)),s.push(u)}const n=()=>`'${i.join("', '")}'`,o=()=>`'${s.join("', '")}'`,l=typeof t.key=="string"?u=>u[t.key]:t.key;return u=>{if(t.base&&!yv(t.base,u)||u==null)return u;const d=l(u)||t.defaultKeyValue,p=r[d];if(!p)return pu().error("Accessor#set",`Invalid property value, value needs to be one of ${n()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!yv(t.typeMap[d],u))return u;if(typeof t.key=="string"&&!hL(u)){const f={};for(const m in u)m!==t.key&&(f[m]=u[m]);return p(f)}return p(u)}}let xe=class{},$w=class{};const hbe={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function sG(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function yL(t){switch(t.type){case"native":return ct(t.value);case"array":return bm(yL(t.value));case"one-of":return nG(t);default:return null}}function nG(t){let e=null;return(r,i)=>F_(r,t)?r:(e==null&&(e=L_(t)),pu().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),i&&(i.valid=!1),null)}function L_(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case xe:return"integer";case Date:return"date";case $w:return"null";default:return Sw(t.value)}case"array":return`array of ${L_(t.value)}`;case"one-of":{const e=t.values.map(r=>L_(r));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function F_(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case xe:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case $w:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(r=>!F_(r,e.value));case"one-of":return e.values.some(r=>F_(t,r))}}function c(t={}){return(e,r)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${r}. Accessor does not support static properties.`);const i=Object.getOwnPropertyDescriptor(e,r),s=Xm(e,r);i&&(i.get||i.set?(s.get=i.get||s.get,s.set=i.set||s.set):"value"in i&&("value"in t&&L.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${r}" on "${e.constructor.name}" already defined in the metadata`,t),s.value=t.value=i.value)),t.readOnly!=null&&(s.readOnly=t.readOnly);const n=t.aliasOf;if(n){const u=typeof n=="string"?n:n.source,d=typeof n=="string"?null:n.overridable===!0;let p;s.dependsOn=[u],s.get=function(){let f=Ys(this,u);if(typeof f=="function"){p||(p=u.split(".").slice(0,-1).join("."));const m=Ys(this,p);m&&(f=f.bind(m))}return f},s.readOnly||(s.set=d?function(f){this._override(r,f)}:function(f){lv(this,u,f)})}const o=t.type,l=t.types;if(!s.cast){let u;o?u=oG(o):l&&(u=Array.isArray(l)?bm(Nn(l[0])):Nn(l)),t.cast=aG(t.cast,u)}tq(s,t),t.range&&(s.cast=Qq(s.cast,t.range))}}function IT(t,e,r){const i=Xm(t,r);i.json||(i.json={});let s=i.json;return e!==void 0&&(s.origins||(s.origins={}),s.origins[e]||(s.origins[e]={}),s=s.origins[e]),s}function oG(t){let e=0,r=t;if(sG(t))return yL(t);for(;Array.isArray(r)&&r.length===1&&typeof r[0]!="string"&&typeof r[0]!="number";)r=r[0],e++;const i=r;if(mL(i))return e===0?R_(i):gv(R_(i),e);if(e===1)return rG(i);if(e>1)return iG(i,e);const s=t;return s.from?s.from:ct(s)}function aG(t,e){if(t||e)return t?e?(r,i)=>e(t(r,i),i):t:e}function lG(t){if(t.json&&t.json.origins){const e=t.json.origins,r={"web-document":["web-scene","web-map"]};for(const i in r)if(e[i]){const s=e[i];r[i].forEach(n=>{e[n]=s}),delete e[i]}}}let qi=class extends iR{constructor(e,r,i){super(e,r,i)}};qi.prototype.type="warning";function gL(t){return!!t&&t.prototype?.declaredClass&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}function uG(t,e){return ET(t,"any",e?.origin)}function vv(t,e){return ET(t,"read",e?.origin)}function vL(t,e){return ET(t,"write",e?.origin)}function ET(t,e,r){let i=t?.json;if(i?.origins&&r){let s;s=r==="link-chart"?i.origins[r]&&(e==="any"||e in i.origins[r])?i.origins[r]:i.origins["web-map"]:i.origins[r],s&&(e==="any"||e in s)&&(i=s)}return i}const N_=()=>L.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function PI(t,e,r){t&&(!r&&!e.read||e.read?.reader||e.read?.enabled===!1||hG(t)&&Ht("read.reader",Jh(t),e))}function Jh(t){const e=t.ndimArray??0;if(e>1)return dG(t);if(e===1)return AI(t);if("type"in t&&bL(t.type)){const r=t.type.prototype?.itemType?.Type,i=AI(typeof r=="function"?{type:r}:{types:r});return(s,n,o)=>{const l=i(s,n,o);return l&&new t.type(l)}}return OT(t)}function OT(t){return"type"in t?cG(t.type):pG(t.types)}function cG(t){return t.prototype.read?(e,r,i)=>{if(e==null)return e;const s=typeof e;if(s!=="object")return void N_().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${s}'`);const n=new t;return n.read(e,i),n}:t.fromJSON}function wL(t,e,r,i){return i!==0&&Array.isArray(e)?e.map(s=>wL(t,s,r,i-1)):t(e,void 0,r)}function dG(t){const e=OT(t),r=wL.bind(null,e),i=t.ndimArray??0;return(s,n,o)=>{if(s==null)return s;s=r(s,o,i);let l=i,u=s;for(;l>0&&Array.isArray(u);)l--,u=u[0];if(u!==void 0)for(let d=0;d<l;d++)s=[s];return s}}function AI(t){const e=OT(t);return(r,i,s)=>{if(r==null)return r;if(Array.isArray(r)){const o=[];for(const l of r){const u=e(l,void 0,s);u!==void 0&&o.push(u)}return o}const n=e(r,void 0,s);return n!==void 0?[n]:void 0}}function bL(t){if(!gL(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?kT(e.Type):_L(e.Type))}function hG(t){return"types"in t?_L(t.types):kT(t.type)}function kT(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||bL(t))}function _L(t){for(const e in t.typeMap)if(!kT(t.typeMap[e]))return!1;return!0}function pG(t){let e=null;const r=t.errorContext??"type",i=t.validate;return(s,n,o)=>{if(s==null)return s;const l=typeof s;if(l!=="object")return void N_().error(`Expected JSON value of type 'object' to deserialize, but got '${l}'`);e||(e=mG(t));const u=t.key;if(typeof u!="string")return;const d=s[fG(u,e,o)],p=d?e[d]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!p){const m=`Type '${d||"unknown"}' is not supported`;return o?.messages&&s&&o.messages.push(new qi(`${r}:unsupported`,m,{definition:s,context:o})),void N_().error(m)}const f=new p;return f.read(s,o),i?i(f):f}}function fG(t,e,r){const i=Object.values(e)[0],s=Hh(i.prototype)[t],n=vv(s,r),o=n?.read?.source;return o&&typeof o=="string"?o:t}function mG(t){const e={};for(const r in t.typeMap){const i=t.typeMap[r],s=Hh(i.prototype);if(typeof t.key=="function")continue;const n=s[t.key];if(!n)continue;if(n.json?.type&&Array.isArray(n.json.type)&&n.json.type.length===1&&typeof n.json.type[0]=="string"){e[n.json.type[0]]=i;continue}const o=n.json?.write;if(!o?.writer){e[r]=i;continue}const l=o.target,u=typeof l=="string"?l:t.key,d={};o.writer(r,d,u),d[u]&&(e[d[u]]=i)}return e}function yG(t){if(t.json||(t.json={}),LI(t.json),FI(t.json),RI(t.json),t.json.origins)for(const e in t.json.origins)LI(t.json.origins[e]),FI(t.json.origins[e]),RI(t.json.origins[e]);return!0}function RI(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function LI(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function FI(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function NI(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const r=t?.ndimArray??0;t&&(r===1||"type"in t&&gL(t.type))?e.write.writer=wG:r>1?e.write.writer=bG(r):e.types?Array.isArray(e.types)?e.write.writer=vG(e.types[0]):e.write.writer=gG(e.types):e.write.writer=_m}function gG(t){return(e,r,i,s)=>e?SL(e,t,s)?_m(e,r,i,s):void 0:_m(e,r,i,s)}function SL(t,e,r){for(const i in e.typeMap)if(t instanceof e.typeMap[i])return!0;if(r?.messages){const i=e.errorContext??"type",s=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;r&&r.messages&&t&&r.messages.push(new x(`${i}:unsupported`,s,{definition:t,context:r})),L.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(s)}return!1}function vG(t){return(e,r,i,s)=>!e||!Array.isArray(e)?_m(e,r,i,s):_m(e.filter(n=>SL(n,t,s)),r,i,s)}function _m(t,e,r,i){Ht(r,wv(t,i),e)}function wv(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?bv(t):t}function bv(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function wG(t,e,r,i){let s;t===null?s=null:t&&typeof t.map=="function"?(s=t.map(n=>wv(n,i)),typeof s.toArray=="function"&&(s=s.toArray())):s=[wv(t,i)],Ht(r,s,e)}function $L(t,e,r){return r!==0&&Array.isArray(t)?t.map(i=>$L(i,e,r-1)):wv(t,e)}function bG(t){return(e,r,i,s)=>{let n;if(e===null)n=null;else{n=$L(e,s,t);let o=t,l=n;for(;o>0&&Array.isArray(l);)o--,l=l[0];if(l!==void 0)for(let u=0;u<o;u++)n=[n]}Ht(i,n,r)}}function _G(t){const e=SG(t);if(t.json.origins)for(const r in t.json.origins){const i=t.json.origins[r],s=i.types?$G(i):e;PI(s,i,!1),i.types&&!i.write&&t.json.write?.enabled&&(i.write={...t.json.write}),NI(s,i)}PI(e,t.json,!0),NI(e,t.json)}function SG(t){return t.json.types?D_(t.json):t.type?xL(t):D_(t)}function $G(t){return t.type?xL(t):D_(t)}function xL(t){if(!t.type)return;let e=0,r=t.type;for(;Array.isArray(r)&&!mL(r);)r=r[0],e++;return{type:r,ndimArray:e}}function D_(t){if(!t.types)return;let e=0,r=t.types;for(;Array.isArray(r);)r=r[0],e++;return{types:r,ndimArray:e}}function xG(t){yG(t)&&(lG(t),_G(t))}const R1=new Set,L1=new Set;function b(t){return e=>{t??="esri.core.Accessor",e.prototype.declaredClass=t,MG(e);const r=[],i=[];let s=e.prototype;for(;s;)s.hasOwnProperty("initialize")&&!R1.has(s.initialize)&&(R1.add(s.initialize),r.push(s.initialize)),s.hasOwnProperty("destroy")&&!L1.has(s.destroy)&&(L1.add(s.destroy),i.push(s.destroy)),s=Object.getPrototypeOf(s);R1.clear(),L1.clear();const n=class extends e{constructor(...l){if(super(...l),this.constructor===n&&typeof this.postscript=="function"){if(r.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let u=r.length-1;u>=0;u--)r[u].call(this)}}),i.length){let u=!1;const d=this[zR];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!u){this.__accessor__.lifecycle=Fi.DESTROYING,u=!0,d.call(this);for(let p=0;p<i.length;p++)i[p].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};n.__accessorMetadata__=Hh(e.prototype),n.prototype.declaredClass=t;const o=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(n,"name",{value:o,configurable:!0}),n}}function TG(t,e){return e.get==null?function(){const r=this.__accessor__,i=r.propertiesByName.get(t);if(i===void 0)return;r.mutable&&le(i);const s=r.store;return s.has(t)?s.get(t):i.metadata.value}:function(){const r=this.__accessor__,i=r.propertiesByName.get(t);if(i!==void 0)return i.getComputed(r)}}function MG(t){const e=t.prototype,r=Hh(e),i={};for(const s of Object.getOwnPropertyNames(r)){const n=r[s];xG(n),i[s]={enumerable:!0,configurable:!0,get:TG(s,n),set(o){const l=this.__accessor__;if(l!==void 0){if(l.mutable)return l.initialized&&n.readOnly?DI("read-only",s):l.lifecycle===Fi.CONSTRUCTED&&n.constructOnly?DI("construct-only",s):void l.set(s,o)}else Object.defineProperty(this,s,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(t.prototype,i)}const DI=(t,e)=>{L.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)};var jI,VI;function IG(t){if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor?.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const Zo=Symbol("Accessor-Handles"),F1=Symbol("Accessor-Initialized");var Ha;let X=(Ha=class{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:r,declaredClass:i,constructor:s}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const n=this;class o extends n{constructor(...u){super(...u),this.inherited=null,s&&s.apply(this,u)}}Hh(o.prototype);for(const l in e){const u=e[l];o.prototype[l]=typeof u=="function"?function(...d){const p=this.inherited;let f;this.inherited=function(...m){if(n.prototype[l])return n.prototype[l].apply(this,m)};try{f=u.apply(this,d)}catch(m){throw this.inherited=p,m}return this.inherited=p,f}:e[l]}for(const l in r){const u=IG(r[l]);c(u)(o.prototype,l)}return b(i)(o)}static freeze(e){return e instanceof Ha?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof Ha?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){if(this[jI]=null,this[VI]=!1,this.constructor===Ha)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const r=new cq(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:r}),e.length>0&&(r.ctorArgs=this.normalizeCtorArgs?.apply(this,e)??e[0])}postscript(){const e=this.__accessor__,r=e.ctorArgs;e.initialize(),r&&(this.set(r),e.ctorArgs=null),e.constructed(),this.initialize(),this[F1]=!0}initialize(){}[zR](){this[Zo]=Ke(this[Zo])}destroy(){this.destroyed||(jq(this),this.__accessor__.destroy(),yq()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[F1]}get destroyed(){return this.__accessor__?.lifecycle===Fi.DESTROYED||!1}get destroying(){return this.__accessor__?.lifecycle===Fi.DESTROYING||!1}commitProperty(e){Ys(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,r){return lv(this,e,r),this}watch(e,r,i){return VR(L.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://arcg.is/1vaqf42#watch",warnOnce:!0}),Bq(this,e,r,i)}addHandles(e,r){if(this.destroyed){const i=Array.isArray(e)?e:[e];for(const s of i)s.remove();return}(this[Zo]??=new Bh).add(e,r)}removeHandles(e){this[Zo]?.remove(e)}removeAllHandles(){this[Zo]?.removeAll()}removeHandlesReference(e){this[Zo]?.removeReference(e)}hasHandles(e){return this[Zo]?.has(e)===!0}_override(e,r){r===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,r)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,r){r==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,r)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,r){return this.__accessor__.internalSet(e,r),this}},jI=Zo,VI=F1,Ha);const xw=t=>{const e=t;class r extends e{constructor(){super(...arguments),this._listenersMap=null}clearEvents(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clearEvents()}emit(s,n){let o=this._listenersMap?.get(s);if(!o)return!1;let l=!1;for(const u of o.slice()){const d="deref"in u?u.deref():u;d?d?.call(this,n):l=!0}return l&&(o=o.filter(u=>!("deref"in u)||u.deref()!=null),this._listenersMap.set(s,o)),o.length>0}on(s,n){if(Array.isArray(s)){const l=s.map(u=>this.on(u,n));return qu(l)}if(s.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const o=this._listenersMap.get(s)||[];return o.push(n),this._listenersMap.set(s,o),Te(()=>{const l=this._listenersMap?.get(s),u=l?.indexOf(n)??-1;u>=0&&l.splice(u,1)})}once(s,n){const o=this.on(s,l=>{o.remove(),("deref"in n?n.deref():n)?.call(null,l)});return o}hasEventListener(s){const n=this._listenersMap?.get(s);return n!=null&&n.length>0}}return r},TL=xw(class{}),ML=TL,Yh=xw(X);function CT(t){return(e,r)=>{e[r]=t}}let ty=class extends HR{notify(){const e=this._observers;if(e&&e.length>0){const r=e.slice();for(const i of r)i.onInvalidated(),i.onCommitted()}}};var Jn;let EG=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},OG=class{constructor(e,r,i,s,n){this.target=e,this.added=r,this.removed=i,this.start=s,this.deleteCount=n}};const Zi=new Gh(()=>new EG,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1});function zI(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function N1(t){return t?t instanceof ga?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function D1(t){if(t?.length)return t[0]}function kG(t,e,r,i){const s=Math.min(t.length-r,e.length-i);let n=0;for(;n<s&&t[r+n]===e[i+n];)n++;return n}function IL(t,e,r,i){e&&e.forEach((s,n,o)=>{t.push(s),IL(t,r.call(i,s,n,o),r,i)})}const Jo=new Set,Yo=new Set,Ko=new Set,j1=new Map;let CG=0,ga=Jn=class extends Yh{static ofType(t){if(!t)return Jn;if(j1.has(t))return j1.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const i in t.typeMap){const s=t.typeMap[i].prototype.declaredClass;e?e+=` | ${s}`:e=s}let r=class extends Jn{};return a([CT({Type:t,ensureType:typeof t=="function"?ct(t):Nn(t)})],r.prototype,"itemType",void 0),r=a([b(`esri.core.Collection<${e}>`)],r),j1.set(t,r),r}static isCollection(t){return t!=null&&t instanceof Jn}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new ty,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:CG++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof Jn?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),super.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return le(this._observable),this._items}set items(t){this._emitBeforeChanges(1)||(this._splice(0,this.length,N1(t)),this._emitAfterChanges(1))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:super.hasEventListener(t))}on(t,e){if(this.destroyed)return Te();if(t==="change"){const r=this._chgListeners,i={removed:!1,callback:e};return r.push(i),this._notifications&&this._notifications.push({listeners:r.slice(),items:this._items.slice(),changes:[]}),Te(()=>{i.removed=!0,r.splice(r.indexOf(i),1)})}return super.on(t,e)}once(t,e){const r="deref"in e?()=>e.deref():()=>e,i=this.on(t,s=>{r()?.call(null,s),i.remove()});return i}add(t,e){if(le(this._observable),this._emitBeforeChanges(1))return this;const r=this.getNextIndex(e??null);return this._splice(r,0,[t]),this._emitAfterChanges(1),this}addMany(t,e=this._items.length){if(le(this._observable),!t?.length)return this;if(this._emitBeforeChanges(1))return this;const r=this.getNextIndex(e);return this._splice(r,0,N1(t)),this._emitAfterChanges(1),this}at(t){if(le(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(le(this._observable),!this.length||this._emitBeforeChanges(2))return[];const t=this._removeAllRaw();return this._emitAfterChanges(2),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return le(this._observable),this._createNewInstance({items:this._items.map(E)})}concat(...t){le(this._observable);const e=t.map(N1);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(le(this._observable),!this.length||this._emitBeforeChanges(2))return;const r=this._splice(0,this.length),i=r.length;for(let s=0;s<i;s++)t.call(e,r[s],s,r);this._emitAfterChanges(2)}destroyAll(){this.drain(zI)}destroyMany(t){const e=this.removeMany(t);return e.forEach(zI),e}every(t,e){return le(this._observable),this._items.every(t,e)}filter(t,e){le(this._observable);const r=arguments.length===2?this._items.filter(t,e):this._items.filter(t);return this._createNewInstance({items:r})}find(t,e){return le(this._observable),this._items.find(t,e)}findIndex(t,e){return le(this._observable),this._items.findIndex(t,e)}flatten(t,e){le(this._observable);const r=[];return IL(r,this,t,e),new Jn(r)}forEach(t,e){return le(this._observable),this._items.forEach(t,e)}getItemAt(t){return le(this._observable),this._items[t]}getNextIndex(t){le(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return le(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return le(this._observable),this._items.indexOf(t,e)}join(t=","){return le(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return le(this._observable),this._items.lastIndexOf(t,e)}map(t,e){le(this._observable);const r=this._items.map(t,e);return new Jn({items:r})}reorder(t,e=this.length-1){le(this._observable);const r=this.indexOf(t);if(r!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),r!==e){if(this._emitBeforeChanges(4))return t;this._splice(r,1),this._splice(e,0,[t]),this._emitAfterChanges(4)}return t}}pop(){if(le(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=D1(this._splice(this.length-1,1));return this._emitAfterChanges(2),t}push(...t){return le(this._observable),this._emitBeforeChanges(1)||(this._splice(this.length,0,t),this._emitAfterChanges(1)),this.length}reduce(t,e){le(this._observable);const r=this._items;return arguments.length===2?r.reduce(t,e):r.reduce(t)}reduceRight(t,e){le(this._observable);const r=this._items;return arguments.length===2?r.reduceRight(t,e):r.reduceRight(t)}remove(t){return le(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(le(this._observable),t<0||t>=this.length||this._emitBeforeChanges(2))return;const e=D1(this._splice(t,1));return this._emitAfterChanges(2),e}removeMany(t){if(le(this._observable),!t?.length||this._emitBeforeChanges(2))return[];const e=t instanceof Jn?t.toArray():t,r=this._items,i=[],s=e.length;for(let n=0;n<s;n++){const o=e[n],l=r.indexOf(o);if(l>-1){const u=1+kG(e,r,n+1,l+1),d=this._splice(l,u);d&&d.length>0&&i.push.apply(i,d),n+=u-1}}return this._emitAfterChanges(2),i}reverse(){if(le(this._observable),this._emitBeforeChanges(4))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(4),this}shift(){if(le(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=D1(this._splice(0,1));return this._emitAfterChanges(2),t}slice(t=0,e=this.length){return le(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return le(this._observable),this._items.some(t,e)}sort(t){if(le(this._observable),!this.length||this._emitBeforeChanges(4)||!this._requiresSort(t))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(4),this}_requiresSort(t=(e,r)=>e===r?0:e<r?-1:1){const e=this.length-1;for(let r=0;r<e;r++)if(t(this.items[r],this.items[r+1])>0)return!0;return!1}splice(t,e,...r){le(this._observable),arguments.length===1&&(e=this.length),e??=0;const i=(e?2:0)|(r.length?1:0);if(this._emitBeforeChanges(i))return[];const s=this._splice(t,e,r)||[];return this._emitAfterChanges(i),s}toArray(){return le(this._observable),this._items.slice()}toJSON(t){return le(this._observable),this.toArray().map(e=>gm(e)?e.toJSON(t):e)}toLocaleString(){return le(this._observable),this._items.toLocaleString()}toString(){return le(this._observable),this._items.toString()}unshift(...t){return le(this._observable),!t.length||this._emitBeforeChanges(1)||(this._splice(0,0,t),this._emitAfterChanges(1)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,r){const i=this._items,s=this.itemType;let n,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=Wh(()=>this._dispatchChange())),t<0&&(t+=this.length),e){if(o=i.splice(t,e),this.hasEventListener("before-remove")){const l=Zi.acquire();l.target=this,l.cancellable=!0;for(let u=0,d=o.length;u<d;u++)n=o[u],l.reset(n),this.emit("before-remove",l),l.defaultPrevented&&(o.splice(u,1),i.splice(t,0,n),t+=1,u-=1,d-=1);Zi.release(l)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const l=Zi.acquire();l.target=this,l.cancellable=!1;const u=o.length;for(let d=0;d<u;d++)l.reset(o[d]),this.emit("after-remove",l);Zi.release(l)}}if(r?.length){if(s){const p=[];for(const f of r){const m=s.ensureType(f);m==null&&f!=null||p.push(m)}r=p}const l=this.hasEventListener("before-add"),u=this.hasEventListener("after-add"),d=t===this.length;if(l||u){const p=Zi.acquire();p.target=this,p.cancellable=!0;const f=Zi.acquire();f.target=this,f.cancellable=!1;for(const m of r)l?(p.reset(m),this.emit("before-add",p),p.defaultPrevented||(d?i.push(m):i.splice(t++,0,m),this._set("length",i.length),u&&(f.reset(m),this.emit("after-add",f)))):(d?i.push(m):i.splice(t++,0,m),this._set("length",i.length),f.reset(m),this.emit("after-add",f));Zi.release(f),Zi.release(p)}else{if(d)for(const p of r)i.push(p);else i.splice(t,0,...r);this._set("length",i.length)}}if((r?.length||o?.length)&&this._notifyChangeEvent(r,o),this.hasEventListener("after-splice")){const l=new OG(this,r,o,t,e);this.emit("after-splice",l)}return o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const r=Zi.acquire();r.target=this,r.cancellable=!0,r.type=t,this.emit("before-changes",r),e=r.defaultPrevented,Zi.release(r)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Zi.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Zi.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const r=e.changes;Jo.clear(),Yo.clear(),Ko.clear();for(const{added:u,removed:d}of r){if(u)if(Ko.size===0&&Yo.size===0)for(const p of u)Jo.add(p);else for(const p of u)Yo.has(p)?(Ko.add(p),Yo.delete(p)):Ko.has(p)||Jo.add(p);if(d)if(Ko.size===0&&Jo.size===0)for(const p of d)Yo.add(p);else for(const p of d)Jo.has(p)?Jo.delete(p):(Ko.delete(p),Yo.add(p))}const i=Br.acquire();Jo.forEach(u=>{i.push(u)});const s=Br.acquire();Yo.forEach(u=>{s.push(u)});const n=this._items,o=e.items,l=Br.acquire();if(Ko.forEach(u=>{o.indexOf(u)!==n.indexOf(u)&&l.push(u)}),e.listeners&&(i.length||s.length||l.length)){const u={target:this,added:i,removed:s,moved:l},d=e.listeners.length;for(let p=0;p<d;p++){const f=e.listeners[p];f.removed||f.callback.call(this,u)}}Br.release(i),Br.release(s),Br.release(l)}Jo.clear(),Yo.clear(),Ko.clear()}};a([c()],ga.prototype,"_updating",void 0),a([c()],ga.prototype,"length",void 0),a([c()],ga.prototype,"items",null),a([c({readOnly:!0})],ga.prototype,"updating",null),ga=Jn=a([b("esri.core.Collection")],ga);const H=ga;function Pn(t,e,r=H){return e||(e=new r),e===t||e.destroyed||(e.removeAll(),PG(t)?e.addMany(t):t&&e.add(t)),e}function EL(t){return t}function PG(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}let AG=class OL{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const r=new OL;return this._values.forEach((i,s)=>{e&&e.has(s)||r.set(s,E(i.value),i.origin)}),r}get(e,r){r=this._normalizeOrigin(r);const i=this._values.get(e);return r==null||i?.origin===r?i?.value:void 0}originOf(e){return this._values.get(e)?.origin??7}keys(e){e=this._normalizeOrigin(e);const r=[...this._values.keys()];return e==null?r:r.filter(i=>this._values.get(i)?.origin===e)}set(e,r,i){if((i=this._normalizeOrigin(i))===0){const s=this._values.get(e);if(s?.origin!=null&&s.origin>i)return}this._values.set(e,new RG(r,i))}delete(e,r){(r=this._normalizeOrigin(r))!=null&&this._values.get(e)?.origin!==r||this._values.delete(e)}has(e,r){return(r=this._normalizeOrigin(r))!=null?this._values.get(e)?.origin===r:this._values.has(e)}isAtOrigin(e,r){return r=this._normalizeOrigin(r),this.has(e,r)&&this.originOf(e)===r}isBelowOrigin(e,r){return r=this._normalizeOrigin(r),!this.has(e)||this.originOf(e)<r}forEach(e){this._values.forEach(({value:r},i)=>e(r,i))}_normalizeOrigin(e){if(e!=null)return e===0?e:7}},RG=class{constructor(e,r){this.value=e,this.origin=r}};function kL(t,e,r){e.keys().forEach(s=>{r.set(s,e.get(s),0)});const i=t.metadata;Object.keys(i).forEach(s=>{t.internalGet(s)&&r.set(s,t.internalGet(s),0)})}function LG(t,e,r){if(!t?.read||t.read.enabled===!1||!t.read.source)return!1;const i=t.read.source;if(typeof i=="string"){if(i===e||i.includes(".")&&i.startsWith(e)&&$I(i,r))return!0}else for(const s of i)if(s===e||s.includes(".")&&s.startsWith(e)&&$I(s,r))return!0;return!1}function FG(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function NG(t,e,r,i,s){let n=vv(e[r],s);FG(n)&&(t[r]=!0);for(const o of Object.getOwnPropertyNames(e))n=vv(e[o],s),LG(n,r,i)&&(t[o]=!0)}function DG(t,e,r,i){const s=r.metadata,n=uG(s[e],i),o=n?.default;if(o===void 0)return;const l=typeof o=="function"?o.call(t,e,i):o;l!==void 0&&r.set(e,l)}const CL={origin:"service"};function PL(t,e,r=CL){if(!e||typeof e!="object")return;const i=Xr(t),s=i.metadata,n={};for(const o of Object.getOwnPropertyNames(e))NG(n,s,o,e,r);i.setDefaultOrigin(r.origin);for(const o of Object.getOwnPropertyNames(n)){const l=vv(s[o],r).read,u=l?.source;let d;d=u&&typeof u=="string"?Qm(e,u):e[o],l?.reader&&(d=l.reader.call(t,d,e,r)),d!==void 0&&i.set(o,d)}if(!r||!r.ignoreDefaults){i.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(s))n[o]||DG(t,o,i,r)}i.setDefaultOrigin("user")}function jG(t,e,r,i=CL){const s={...i,messages:[]};r(s),s.messages?.forEach(n=>{n.type!=="warning"||t.loaded?i?.messages&&i.messages.push(n):t.loadWarnings.push(n)})}function VG(t,e,r,i,s){const n={};return e.write?.writer?.call(t,i,n,r,s),n}function AL(t,e,r,i,s,n){if(!i?.write)return!1;const o=Ys(t,r);if(!s&&i.write.overridePolicy){const l=i.write.overridePolicy.call(t,o,r,n??void 0);l!==void 0&&(s=l)}if(s||(s=i.write),!s||s.enabled===!1||s.layerContainerTypes&&n?.layerContainerType&&!s.layerContainerTypes.includes(n.layerContainerType))return!1;if((o===null&&!s.allowNull&&!s.writerEnsuresNonNull||o===void 0)&&s.isRequired){const l=new x("web-document-write:property-required",`Missing value for required property '${r}' on '${t.declaredClass}'`,{propertyName:r,target:t});return l&&n?.messages?n.messages.push(l):l&&!n&&L.getLogger("esri.core.accessorSupport.write").error(l.name,l.message),!1}return!(o===void 0||o===null&&!s.allowNull&&!s.writerEnsuresNonNull||!s.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(r)===0)&&zG(t,r,n,i,o)||!s.ignoreOrigin&&n?.origin&&e.store.multipleOriginsSupported&&e.store.originOf(r)<Co(n.origin))}function zG(t,e,r,i,s){const n=i.default;if(n===void 0)return!1;if(i.defaultEquals!=null)return i.defaultEquals(s);if(typeof n=="function"){if(Array.isArray(s)){const o=n.call(t,e,r??void 0);return hw(o,s)}return!1}return n===s}function UG(t,e,r,i){const s=Xr(t),n=s.metadata,o=vL(n[e],i);return!!o&&AL(t,s,e,o,r,i)}function RL(t,e,r){if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return Cg(e,t.toJSON(r));const i=Xr(t),s=i.metadata;for(const n in s){const o=vL(s[n],r);if(!AL(t,i,n,o,void 0,r))continue;const l=Ys(t,n),u=VG(t,o,o.write&&typeof o.write.target=="string"?o.write.target:n,l,r);Object.keys(u).length>0&&(e=Cg(e,u),r?.resources?.pendingOperations?.length&&r.resources.pendingOperations.push(Promise.all(r.resources.pendingOperations).then(()=>Cg(e,u,()=>"replace-arrays"))),r?.writtenProperties&&r.writtenProperties.push({target:t,propName:n,oldOrigin:lq(i.store.originOf(n)),newOrigin:r.origin}))}return e}const ol=t=>{const e=t;let r=class extends e{constructor(...i){super(...i);const s=Xr(this),n=s.store,o=new AG;s.store=o,kL(s,n,o)}read(i,s){PL(this,i,s)}write(i,s){return RL(this,i??{},s)}toJSON(i){return this.write({},i)}static fromJSON(i,s){return qG.call(this,i,s)}};return r=a([b("esri.core.JSONSupport")],r),r.prototype.toJSON.isDefaultToJSON=!0,r};function qG(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const r=new this;return r.read(t,e),r}const F=ol(X);let GG=class{constructor(){this._resolver=bi(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=1,this._cleanUp()},()=>{this._status=2,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===1}isRejected(){return this._status===2}isFulfilled(){return this._status!==0}abort(){this._resolver.reject(Fe())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=bi(),r=[...this._resolvingPromises,e.promise],i=this._allPromise=Promise.all(r);i.then(()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve()},s=>{this.isFulfilled()||this._allPromise!==i||nr(s)||this._resolver.reject(s)}),e.resolve()}};const PT=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this._promiseProps=new GG,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(i,s){return this._promiseProps.promise.then(()=>this).then(i,s)}catch(i){return this.when(null,i)}addResolvingPromise(i){i&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in i?i.when():i)}addResolvingTask(i){i&&!this._promiseProps.isFulfilled()&&(this.addHandles(u7(i)),this._promiseProps.addResolvingPromise(i.promise))}};return r=a([b("esri.core.Promise")],r),r},AT=PT(X),BG="not-loaded",HG="loading",WG="failed",UI="loaded",LL=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(s=>{const n=this.load.bind(this);this.load=o=>{const l=new Promise((u,d)=>{const p=mT(o,d);this.destroyed&&d(new x("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(u,d).finally(()=>{p&&p.remove()})});if(this.loadStatus===BG){this._set("loadStatus",HG);const u=this._loadController=new AbortController;n({signal:u.signal})}return s(),l}})),this.when(()=>{this._set("loadStatus",UI),this._loadController=null},s=>{this.destroyed||(this._set("loadStatus",WG),this._set("loadError",s),this._loadController=null)})}destroy(){this._loadController&&(this._loadController=jo(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===UI}get loadWarnings(){return this._get("loadWarnings")}load(i){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new x("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return a([c({readOnly:!0})],r.prototype,"loaded",null),a([c({readOnly:!0})],r.prototype,"loadError",void 0),a([c({clonable:!1})],r.prototype,"loadStatus",void 0),a([c({type:[qi],readOnly:!0})],r.prototype,"loadWarnings",null),r=a([b("esri.core.Loadable")],r),r},ry=LL(AT);function j_(t){return!(!t||!t.load)}function wbe(t,e,r){return tu(t.map((i,s)=>e.apply(r,[i,s])))}async function ZG(t,e,r){return(await tu(t.map((i,s)=>e.apply(r,[i,s])))).map(i=>i.value)}function RT(t){return{ok:!0,value:t}}function LT(t){return{ok:!1,error:t}}function JG(t){return t!=null&&t.ok===!0?t.value:null}function YG(t){return t!=null&&t.ok===!1?t.error:null}async function Tw(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return RT(await t)}catch(e){return LT(e)}}async function KG(t){try{return RT(await t)}catch(e){return Mn(e),LT(e)}}function iy(t,e){return new sa(t,e)}let sa=class extends X{get value(){return JG(this._result)}get error(){return YG(this._result)}get finished(){return this._result!=null}constructor(e,r){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=jo(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:i}=this._abortController;this.promise=e(i),this.promise.then(s=>{this._result=RT(s),this._cleanup()},s=>{this._result=LT(s),this._cleanup()}),this._abortHandle=ys(r,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=He(this._abortHandle),this._abortController=null}};a([c()],sa.prototype,"value",null),a([c()],sa.prototype,"error",null),a([c()],sa.prototype,"finished",null),a([c()],sa.prototype,"promise",void 0),a([c()],sa.prototype,"_result",void 0),sa=a([b("esri.core.asyncUtils.ReactiveTask")],sa);async function FL(t,e){return await t.load(),QG(t,e)}async function QG(t,e){const r=[],i=(...n)=>{for(const o of n)o!=null&&(Array.isArray(o)?i(...o):H.isCollection(o)?o.forEach(l=>i(l)):j_(o)&&r.push(o))};e(i);let s=null;if(await ZG(r,async n=>{const o=await Tw(XG(n)?n.loadAll():n.load());o.ok!==!1||s||(s=o)}),s)throw s.error;return t}function XG(t){return"loadAll"in t&&typeof t.loadAll=="function"}function q(t,e,r){let i,s;return e===void 0?(s=t,i=[void 0]):typeof e!="string"?(s=t,i=[void 0],r=e):(s=e,i=Array.isArray(t)?t:[t]),(n,o)=>{const l=n.constructor.prototype;for(const u of i){const d=IT(n,u,s);d.write&&typeof d.write=="object"||(d.write={}),r&&(d.write.target=r),d.write.writer=l[o]}}}let $e=class{constructor(e,r={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=r,this.apiValues=[],this.jsonValues=[],this._apiToJSON=eB(e),this.apiValues=qI(this._apiToJSON),this.jsonValues=qI(this._jsonToAPI),this.read=i=>this.fromJSON(i),this.write=(i,s,n)=>{const o=this.toJSON(i);o!==void 0&&Ht(n,o,s)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const r=this._apiToJSON[e];return this._options.useNumericKeys?+r:r}return this._options.ignoreUnknown?null:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function eB(t){const e={};for(const r in t)e[t[r]]=r;return e}function qI(t){const e=[];for(const r in t)e.push(r);return e.sort(),e}function Ft(){return function(t,e){return new $e(t,{ignoreUnknown:!0,...e})}}let FT=class{constructor(e,r,i,s,n,o){this.semiMajorAxis=e,this.flattening=r,this.outerAtmosphereRimWidth=i,this.atmosphereHeight=s,this.scaleHeight=n;const l=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*l,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=o||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const dt=new FT(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),An=new FT(3396190,1/169.8944472236118,23e4,6e4,.111),Za=new FT(1737400,0,0,0,0);function ot(t){if(!_e.assetsPath)throw L.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new x("assets:path-not-set","config.assetsPath is not set");return Mu(_e.assetsPath,t)}let V1,I=null;function NL(){return!!I}function tB(){return!!k("esri-wasm")}function rB(){return V1||(V1=N(async()=>{const{default:t}=await import("./pe-wasm-B87Q3u4k.js");return{default:t}},[]).then(({default:t})=>t({locateFile:e=>ot(`esri/geometry/support/${e}`)})).then(t=>{qL(t)}),V1)}const Fg={geogToProj(t,e,r){I.ensureCache.prepare();const i=ku(r),s=r===i,n=I.ensureFloat64(i),o=I._pe_geog_to_proj(I.getPointer(t),e,n);return o&&Ja(r,e,n,s),o},projGeog(t,e,r,i){switch(i){case lt.PE_TRANSFORM_P_TO_G:return Fg.projToGeog(t,e,r);case lt.PE_TRANSFORM_G_TO_P:return Fg.geogToProj(t,e,r)}return 0},projToGeog:(t,e,r)=>Fg.projToGeogCenter(t,e,r,0),projToGeogCenter(t,e,r,i){I.ensureCache.prepare();const s=ku(r),n=r===s,o=I.ensureFloat64(s),l=I._pe_proj_to_geog_center(I.getPointer(t),e,o,i);return l&&Ja(r,e,o,n),l}};let lt=class Oe{static init(){Oe.PE_BUFFER_MAX=I.PeDefs.prototype.PE_BUFFER_MAX,Oe.PE_NAME_MAX=I.PeDefs.prototype.PE_NAME_MAX,Oe.PE_MGRS_MAX=I.PeDefs.prototype.PE_MGRS_MAX,Oe.PE_USNG_MAX=I.PeDefs.prototype.PE_USNG_MAX,Oe.PE_DD_MAX=I.PeDefs.prototype.PE_DD_MAX,Oe.PE_DDM_MAX=I.PeDefs.prototype.PE_DDM_MAX,Oe.PE_DMS_MAX=I.PeDefs.prototype.PE_DMS_MAX,Oe.PE_UTM_MAX=I.PeDefs.prototype.PE_UTM_MAX,Oe.PE_PARM_MAX=I.PeDefs.prototype.PE_PARM_MAX,Oe.PE_TYPE_NONE=I.PeDefs.prototype.PE_TYPE_NONE,Oe.PE_TYPE_GEOGCS=I.PeDefs.prototype.PE_TYPE_GEOGCS,Oe.PE_TYPE_PROJCS=I.PeDefs.prototype.PE_TYPE_PROJCS,Oe.PE_TYPE_GEOGTRAN=I.PeDefs.prototype.PE_TYPE_GEOGTRAN,Oe.PE_TYPE_COORDSYS=I.PeDefs.prototype.PE_TYPE_COORDSYS,Oe.PE_TYPE_UNIT=I.PeDefs.prototype.PE_TYPE_UNIT,Oe.PE_TYPE_LINUNIT=I.PeDefs.prototype.PE_TYPE_LINUNIT,Oe.PE_STR_OPTS_NONE=I.PeDefs.prototype.PE_STR_OPTS_NONE,Oe.PE_STR_AUTH_NONE=I.PeDefs.prototype.PE_STR_AUTH_NONE,Oe.PE_STR_AUTH_TOP=I.PeDefs.prototype.PE_STR_AUTH_TOP,Oe.PE_STR_NAME_CANON=I.PeDefs.prototype.PE_STR_NAME_CANON,Oe.PE_STR_FMT_WKT=I.PeDefs.prototype.PE_STR_FMT_WKT,Oe.PE_STR_FMT_WKT2=I.PeDefs.prototype.PE_STR_FMT_WKT2,Oe.PE_PARM_X0=I.PeDefs.prototype.PE_PARM_X0,Oe.PE_PARM_ND=I.PeDefs.prototype.PE_PARM_ND,Oe.PE_TRANSFORM_1_TO_2=I.PeDefs.prototype.PE_TRANSFORM_1_TO_2,Oe.PE_TRANSFORM_2_TO_1=I.PeDefs.prototype.PE_TRANSFORM_2_TO_1,Oe.PE_TRANSFORM_P_TO_G=I.PeDefs.prototype.PE_TRANSFORM_P_TO_G,Oe.PE_TRANSFORM_G_TO_P=I.PeDefs.prototype.PE_TRANSFORM_G_TO_P,Oe.PE_HORIZON_RECT=I.PeDefs.prototype.PE_HORIZON_RECT,Oe.PE_HORIZON_POLY=I.PeDefs.prototype.PE_HORIZON_POLY,Oe.PE_HORIZON_LINE=I.PeDefs.prototype.PE_HORIZON_LINE,Oe.PE_HORIZON_DELTA=I.PeDefs.prototype.PE_HORIZON_DELTA}},DL=null;const GI={},BI={},HI=t=>{const e=t.getType();switch(e){case lt.PE_TYPE_GEOGCS:t=I.castObject(t,I.PeGeogcs);break;case lt.PE_TYPE_PROJCS:t=I.castObject(t,I.PeProjcs);break;case lt.PE_TYPE_GEOGTRAN:t=I.castObject(t,I.PeGeogtran);break;default:e&lt.PE_TYPE_UNIT&&(t=I.castObject(t,I.PeUnit))}return t},wc={initialize(){I.PeFactory.prototype.initialize(null)},coordsys:t=>wc.factoryByType(lt.PE_TYPE_COORDSYS,t),factoryByType(t,e){let r=null,i=GI[t];if(i||(i={},GI[t]=i),i.hasOwnProperty(String(e))&&(r=i[e],I.compare(r,I.NULL)&&(r=null)),!r){const s=I.PeFactory.prototype.factoryByType(t,e);I.compare(s,I.NULL)||(r=HI(s),i[e]=r)}return r},fromString(t,e){let r=null,i=BI[t];if(i||(i={},BI[t]=i),i.hasOwnProperty(e)&&(r=i[e],I.compare(r,I.NULL)&&(r=null)),!r){const s=I.PeFactory.prototype.fromString(t,e);I.compare(s,I.NULL)||(r=HI(s),i[e]=r)}return r},geogcs:t=>wc.factoryByType(lt.PE_TYPE_GEOGCS,t),geogtran:t=>wc.factoryByType(lt.PE_TYPE_GEOGTRAN,t),getCode:t=>I.PeFactory.prototype.getCode(t),projcs:t=>wc.factoryByType(lt.PE_TYPE_PROJCS,t),unit:t=>wc.factoryByType(lt.PE_TYPE_UNIT,t)};let WI,jL=null;const NT={PE_GTLIST_OPTS_COMMON:0,init(){NT.PE_GTLIST_OPTS_COMMON=I.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,WI=I._pe_getPeGTlistExtendedEntrySize()},getGTlist(t,e,r,i,s,n){let o=null;const l=new I.PeInteger(n);try{const u=I.PeGTlistExtended.prototype.getGTlist(t,e,r,i,s,l);if((n=l.val)&&(o=[u],n>1)){const d=I.getPointer(u);for(let p=1;p<n;p++)o.push(I.wrapPointer(d+WI*p,I.PeGTlistExtendedEntry))}}finally{I.destroy(l)}return o}},iB={destroy(t){if(t?.length){for(const e of t)js(e),e.getEntries().forEach(r=>{js(r);const i=r.getGeogtran();js(i),i.getParameters().forEach(js),[i.getGeogcs1(),i.getGeogcs2()].forEach(s=>{js(s);const n=s.getDatum();js(n),js(n.getSpheroid()),js(s.getPrimem()),js(s.getUnit())})});I.PeGTlistExtendedEntry.prototype.Delete(t[0])}}},sB={geogToGeog(t,e,r,i,s){I.ensureCache.prepare();const n=ku(r),o=r===n,l=I.ensureFloat64(n);let u=0;i&&(u=I.ensureFloat64(i));const d=I._pe_geog_to_geog(I.getPointer(t),e,l,u,s);return d&&Ja(r,e,l,o),d}},nB={geodesicCoordinate(t,e,r,i,s,n,o,l){I.PeLineType.prototype.geodesic_coordinate(t,e,r,i,s,n,o,l)},geodeticCoordinate(t,e,r,i,s,n,o,l,u){I.PeLineType.prototype.geodetic_coordinate(t,e,r,i,s,n,o,l,u)},geodeticDistance(t,e,r,i,s,n,o,l,u,d){I.PeLineType.prototype.geodetic_distance(t,e,r,i,s,n,o,l,u,d)},greatEllipticDistance(t,e,r,i,s,n,o,l,u){I.PeLineType.prototype.great_elliptic_distance(t,e,r,i,s,n,o,l,u)}},oB={phiToEta:(t,e)=>I.PeMath.prototype.phi_to_eta(t,e),etaToPhi:(t,e)=>I.PeMath.prototype.eta_to_phi(t,e),phiToPhig:(t,e)=>I.PeMath.prototype.phi_to_phig(t,e),q:(t,e,r)=>I.PeMath.prototype.q(t,e,r),q90:(t,e)=>I.PeMath.prototype.q90(t,e)},z1=(t,e,r,i,s,n)=>{let o,l;switch(I.ensureCache.prepare(),t){case"dd":o=I._pe_geog_to_dd,l=lt.PE_DD_MAX;break;case"ddm":o=I._pe_geog_to_ddm,l=lt.PE_DDM_MAX;break;case"dms":o=I._pe_geog_to_dms,l=lt.PE_DMS_MAX}let u=0;e&&(u=I.getPointer(e));const d=ku(i),p=I.ensureFloat64(d),f=Mw(r,l),m=o(u,r,p,s,I.ensureInt32(f));if(m)for(let y=0;y<r;y++)n[y]=I.UTF8ToString(f[y]);return m},U1=(t,e,r,i,s)=>{let n;switch(I.ensureCache.prepare(),t){case"dd":n=I._pe_dd_to_geog;break;case"ddm":n=I._pe_ddm_to_geog;break;case"dms":n=I._pe_dms_to_geog}let o=0;e&&(o=I.getPointer(e));const l=i.map(f=>I.ensureString(f)),u=I.ensureInt32(l),d=I.ensureFloat64(new Array(2*r)),p=n(o,r,u,d);return p&&Ja(s,r,d),p},aB={geogToDms:(t,e,r,i,s)=>z1("dms",t,e,r,i,s),dmsToGeog:(t,e,r,i)=>U1("dms",t,e,r,i),geogToDdm:(t,e,r,i,s)=>z1("ddm",t,e,r,i,s),ddmToGeog:(t,e,r,i)=>U1("ddm",t,e,r,i),geogToDd:(t,e,r,i,s)=>z1("dd",t,e,r,i,s),ddToGeog:(t,e,r,i)=>U1("dd",t,e,r,i)};let VL=class bc{static init(){bc.PE_MGRS_STYLE_NEW=I.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,bc.PE_MGRS_STYLE_OLD=I.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,bc.PE_MGRS_STYLE_AUTO=I.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,bc.PE_MGRS_180_ZONE_1_PLUS=I.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,bc.PE_MGRS_ADD_SPACES=I.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}static geogToMgrsExtended(e,r,i,s,n,o,l){I.ensureCache.prepare();let u=0;e&&(u=I.getPointer(e));const d=ku(i),p=I.ensureFloat64(d),f=Mw(r,lt.PE_MGRS_MAX),m=I.ensureInt32(f),y=I._pe_geog_to_mgrs_extended(u,r,p,s,n,o,m);if(y)for(let g=0;g<r;g++)l[g]=I.UTF8ToString(f[g]);return y}static mgrsToGeogExtended(e,r,i,s,n){I.ensureCache.prepare();let o=0;e&&(o=I.getPointer(e));const l=i.map(f=>I.ensureString(f)),u=I.ensureInt32(l),d=I.ensureFloat64(new Array(2*r)),p=I._pe_mgrs_to_geog_extended(o,r,u,s,d);return p&&Ja(n,r,d),p}};const lB={geogToUsng(t,e,r,i,s,n,o){I.ensureCache.prepare();let l=0;t&&(l=I.getPointer(t));const u=ku(r),d=I.ensureFloat64(u),p=Mw(e,lt.PE_MGRS_MAX),f=I.ensureInt32(p),m=I._pe_geog_to_usng(l,e,d,i,s,n,f);if(m)for(let y=0;y<e;y++)o[y]=I.UTF8ToString(p[y]);return m},usngToGeog(t,e,r,i){I.ensureCache.prepare();let s=0;t&&(s=I.getPointer(t));const n=r.map(d=>I.ensureString(d)),o=I.ensureInt32(n),l=I.ensureFloat64(new Array(2*e)),u=I._pe_usng_to_geog(s,e,o,l);return u&&Ja(i,e,l),u}};let zL=class Ng{static init(){Ng.PE_UTM_OPTS_NONE=I.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,Ng.PE_UTM_OPTS_ADD_SPACES=I.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,Ng.PE_UTM_OPTS_NS=I.PeNotationUtm.prototype.PE_UTM_OPTS_NS}static geogToUtm(e,r,i,s,n){I.ensureCache.prepare();let o=0;e&&(o=I.getPointer(e));const l=ku(i),u=I.ensureFloat64(l),d=Mw(r,lt.PE_UTM_MAX),p=I.ensureInt32(d),f=I._pe_geog_to_utm(o,r,u,s,p);if(f)for(let m=0;m<r;m++)n[m]=I.UTF8ToString(d[m]);return f}static utmToGeog(e,r,i,s,n){I.ensureCache.prepare();let o=0;e&&(o=I.getPointer(e));const l=i.map(f=>I.ensureString(f)),u=I.ensureInt32(l),d=I.ensureFloat64(new Array(2*r)),p=I._pe_utm_to_geog(o,r,u,s,d);return p&&Ja(n,r,d),p}};var hi;let UL=(hi=class{static init(){hi.PE_PCSINFO_OPTION_NONE=I.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,hi.PE_PCSINFO_OPTION_DOMAIN=I.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,hi.PE_POLE_OUTSIDE_BOUNDARY=I.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,hi.PE_POLE_POINT=I.PePCSInfo.prototype.PE_POLE_POINT}static generate(e,r=hi.PE_PCSINFO_OPTION_DOMAIN){let i=null,s=null;return hi.cache.has(e)&&(s=hi.cache.get(e),s[r]&&(i=s[r])),i||(i=I.PePCSInfo.prototype.generate(e,r),s||(s=[],hi.cache.set(e,s)),s[r]=i),i}},hi.cache=new Map,hi);const uB={versionString:()=>I.PeVersion.prototype.version_string()};function qL(t){function e(n,o,l){n[o]=l(n[o])}I=t,lt.init(),NT.init(),VL.init(),zL.init(),UL.init(),DL=class extends I.PeDouble{constructor(n=NaN){super(n)}destroy(){I.destroy(this)}[Symbol.dispose](){this.destroy()}},jL=class extends I.PeGCSExtent{destroy(){I.destroy(this)}[Symbol.dispose](){this.destroy()}};const r=[I.PeAngunit,I.PeDatum,I.PeGeogcs,I.PeGeogtran,I.PeObject,I.PeParameter,I.PePrimem,I.PeProjcs,I.PeSpheroid,I.PeUnit];for(const n of r)e(n.prototype,"getName",o=>function(){return o.call(this,new Array(lt.PE_NAME_MAX))});for(const n of[I.PeGeogtran,I.PeProjcs])e(n.prototype,"getParameters",o=>function(){const l=new Array(lt.PE_PARM_MAX);let u=o.call(this);for(let d=0;d<l.length;d++){const p=I.getValue(u,"*");l[d]=p?I.wrapPointer(p,I.PeParameter):null,u+=Int32Array.BYTES_PER_ELEMENT}return l});e(I.PeHorizon.prototype,"getCoord",n=>function(o=!1){const l=this.getSize();if(!l)return null;const u=[];return Ja(u,l,n.call(this),o),u}),e(I.PeGTlistExtendedEntry.prototype,"getEntries",n=>{const o=I._pe_getPeGTlistExtendedGTsSize();return function(){let l=null;const u=n.call(this);if(!I.compare(u,I.NULL)){l=[u];const d=this.getSteps();if(d>1){const p=I.getPointer(u);for(let f=1;f<d;f++)l.push(I.wrapPointer(p+o*f,I.PeGTlistExtendedGTs))}}return l}});const i=I._pe_getPeHorizonSize(),s=n=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(n))return o.get(n);let l=null;const u=n.call(this);if(!I.compare(u,I.NULL)){l=[u];const d=u.getNump();if(d>1){const p=I.getPointer(u);for(let f=1;f<d;f++)l.push(I.wrapPointer(p+i*f,I.PeHorizon))}}return o.set(n,l),l};e(I.PeProjcs.prototype,"horizonGcsGenerate",s),e(I.PeProjcs.prototype,"horizonPcsGenerate",s),I.PeObject.prototype.toString=function(n=lt.PE_STR_OPTS_NONE){I.ensureCache.prepare();const o=I.getPointer(this),l=I.ensureInt8(new Array(lt.PE_BUFFER_MAX));return I.UTF8ToString(I._pe_object_to_string_ext(o,n,l))},I.PeGeogcs.prototype.destroy=function(){this.Delete(),js(this),this.ptr=0},I.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},I.PeProjcs.prototype.destroy=function(){this.Delete(),js(this),this.ptr=0},I.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function js(t){if(!t)return;const e=I.getClass(t);if(!e)return;const r=I.getCache(e);if(!r)return;const i=I.getPointer(t);i&&delete r[i]}function Mw(t,e){const r=[],i=new Array(e);for(let s=0;s<t;s++)r.push(I.ensureInt8(i));return r}function ku(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function Ja(t,e,r,i=!1){if(i)for(let s=0;s<2*e;s++)t[s]=I.getValue(r+s*Float64Array.BYTES_PER_ELEMENT,"double");else{const s=t.length===0;for(let n=0;n<e;n++)s&&(t[n]=new Array(2)),t[n][0]=I.getValue(r,"double"),t[n][1]=I.getValue(r+Float64Array.BYTES_PER_ELEMENT,"double"),r+=2*Float64Array.BYTES_PER_ELEMENT}}const $be=Object.freeze(Object.defineProperty({__proto__:null,PeCSTransformations:Fg,PeDefs:lt,get PeDouble(){return DL},PeFactory:wc,get PeGCSExtent(){return jL},PeGTTransformations:sB,PeGTlistExtended:NT,PeGTlistExtendedEntry:iB,PeLineType:nB,PeMath:oB,PeNotationDms:aB,PeNotationMgrs:VL,PeNotationUsng:lB,PeNotationUtm:zL,PePCSInfo:UL,PeVersion:uB,_init:qL,get _pe(){return I},isLoaded:NL,isSupported:tB,load:rB},Symbol.toStringTag,{value:"Module"}));let h;const w={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,10592:0,10594:0,10596:0,10598:0,10601:0,10603:0,10626:0,10632:0,10641:0,10665:0,10674:0,10744:0,10745:0,10759:0,10773:0,10802:0,10820:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,65061:2,65062:2,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1,103978:2,103979:0,103980:2,103981:0};for(h=2e3;h<=2045;h++)w[h]=0;for(h=2056;h<=2065;h++)w[h]=0;for(h=2067;h<=2135;h++)w[h]=0;for(h=2137;h<=2154;h++)w[h]=0;for(h=2161;h<=2170;h++)w[h]=0;for(h=2172;h<=2193;h++)w[h]=0;for(h=2195;h<=2198;h++)w[h]=0;for(h=2200;h<=2203;h++)w[h]=0;for(h=2205;h<=2217;h++)w[h]=0;for(h=2222;h<=2224;h++)w[h]=1;for(h=2225;h<=2250;h++)w[h]=2;for(h=2251;h<=2253;h++)w[h]=1;for(h=2257;h<=2264;h++)w[h]=2;for(h=2274;h<=2279;h++)w[h]=2;for(h=2280;h<=2282;h++)w[h]=1;for(h=2283;h<=2289;h++)w[h]=2;for(h=2290;h<=2292;h++)w[h]=0;for(h=2308;h<=2313;h++)w[h]=0;for(h=2315;h<=2491;h++)w[h]=0;for(h=2494;h<=2866;h++)w[h]=0;for(h=2867;h<=2869;h++)w[h]=1;for(h=2870;h<=2888;h++)w[h]=2;for(h=2891;h<=2895;h++)w[h]=2;for(h=2896;h<=2898;h++)w[h]=1;for(h=2902;h<=2908;h++)w[h]=2;for(h=2915;h<=2920;h++)w[h]=2;for(h=2921;h<=2923;h++)w[h]=1;for(h=2924;h<=2930;h++)w[h]=2;for(h=2931;h<=2962;h++)w[h]=0;for(h=2964;h<=2968;h++)w[h]=2;for(h=2969;h<=2973;h++)w[h]=0;for(h=2975;h<=2991;h++)w[h]=0;for(h=2995;h<=3051;h++)w[h]=0;for(h=3054;h<=3079;h++)w[h]=0;for(h=3081;h<=3088;h++)w[h]=0;for(h=3092;h<=3101;h++)w[h]=0;for(h=3106;h<=3138;h++)w[h]=0;for(h=3146;h<=3151;h++)w[h]=0;for(h=3153;h<=3166;h++)w[h]=0;for(h=3168;h<=3172;h++)w[h]=0;for(h=3174;h<=3203;h++)w[h]=0;for(h=3294;h<=3358;h++)w[h]=0;for(h=3367;h<=3403;h++)w[h]=0;for(h=3408;h<=3416;h++)w[h]=0;for(h=3417;h<=3438;h++)w[h]=2;for(h=3441;h<=3446;h++)w[h]=2;for(h=3447;h<=3450;h++)w[h]=0;for(h=3451;h<=3459;h++)w[h]=2;for(h=3460;h<=3478;h++)w[h]=0;for(h=3554;h<=3559;h++)w[h]=0;for(h=3560;h<=3570;h++)w[h]=2;for(h=3571;h<=3581;h++)w[h]=0;for(h=3594;h<=3597;h++)w[h]=0;for(h=3601;h<=3604;h++)w[h]=0;for(h=3637;h<=3639;h++)w[h]=0;for(h=3665;h<=3667;h++)w[h]=0;for(h=3693;h<=3695;h++)w[h]=0;for(h=3701;h<=3727;h++)w[h]=0;for(h=3728;h<=3739;h++)w[h]=2;for(h=3740;h<=3751;h++)w[h]=0;for(h=3753;h<=3760;h++)w[h]=2;for(h=3761;h<=3773;h++)w[h]=0;for(h=3775;h<=3777;h++)w[h]=0;for(h=3779;h<=3781;h++)w[h]=0;for(h=3783;h<=3785;h++)w[h]=0;for(h=3788;h<=3791;h++)w[h]=0;for(h=3797;h<=3802;h++)w[h]=0;for(h=3814;h<=3816;h++)w[h]=0;for(h=3825;h<=3829;h++)w[h]=0;for(h=3832;h<=3841;h++)w[h]=0;for(h=3844;h<=3852;h++)w[h]=0;for(h=3873;h<=3885;h++)w[h]=0;for(h=3890;h<=3893;h++)w[h]=0;for(h=3907;h<=3912;h++)w[h]=0;for(h=3942;h<=3950;h++)w[h]=0;for(h=3968;h<=3970;h++)w[h]=0;for(h=3973;h<=3976;h++)w[h]=0;for(h=3986;h<=3989;h++)w[h]=0;for(h=3994;h<=3997;h++)w[h]=0;for(h=4048;h<=4051;h++)w[h]=0;for(h=4056;h<=4063;h++)w[h]=0;for(h=4093;h<=4096;h++)w[h]=0;for(h=4390;h<=4398;h++)w[h]=0;for(h=4399;h<=4413;h++)w[h]=2;for(h=4418;h<=4433;h++)w[h]=2;for(h=4455;h<=4457;h++)w[h]=2;for(h=4484;h<=4489;h++)w[h]=0;for(h=4491;h<=4554;h++)w[h]=0;for(h=4568;h<=4589;h++)w[h]=0;for(h=4652;h<=4656;h++)w[h]=0;for(h=4766;h<=4800;h++)w[h]=0;for(h=5014;h<=5016;h++)w[h]=0;for(h=5069;h<=5072;h++)w[h]=0;for(h=5105;h<=5130;h++)w[h]=0;for(h=5167;h<=5188;h++)w[h]=0;for(h=5253;h<=5259;h++)w[h]=0;for(h=5269;h<=5275;h++)w[h]=0;for(h=5292;h<=5311;h++)w[h]=0;for(h=5329;h<=5331;h++)w[h]=0;for(h=5343;h<=5349;h++)w[h]=0;for(h=5355;h<=5357;h++)w[h]=0;for(h=5387;h<=5389;h++)w[h]=0;for(h=5459;h<=5463;h++)w[h]=0;for(h=5479;h<=5482;h++)w[h]=0;for(h=5518;h<=5520;h++)w[h]=0;for(h=5530;h<=5539;h++)w[h]=0;for(h=5550;h<=5552;h++)w[h]=0;for(h=5562;h<=5583;h++)w[h]=0;for(h=5623;h<=5625;h++)w[h]=2;for(h=5631;h<=5639;h++)w[h]=0;for(h=5649;h<=5653;h++)w[h]=0;for(h=5663;h<=5680;h++)w[h]=0;for(h=5682;h<=5685;h++)w[h]=0;for(h=5875;h<=5877;h++)w[h]=0;for(h=5896;h<=5899;h++)w[h]=0;for(h=5921;h<=5940;h++)w[h]=0;for(h=6050;h<=6125;h++)w[h]=0;for(h=6244;h<=6275;h++)w[h]=0;for(h=6328;h<=6348;h++)w[h]=0;for(h=6350;h<=6356;h++)w[h]=0;for(h=6366;h<=6372;h++)w[h]=0;for(h=6381;h<=6387;h++)w[h]=0;for(h=6393;h<=6404;h++)w[h]=0;for(h=6480;h<=6483;h++)w[h]=0;for(h=6511;h<=6514;h++)w[h]=0;for(h=6579;h<=6581;h++)w[h]=0;for(h=6619;h<=6624;h++)w[h]=0;for(h=6625;h<=6627;h++)w[h]=2;for(h=6628;h<=6632;h++)w[h]=0;for(h=6634;h<=6637;h++)w[h]=0;for(h=6669;h<=6692;h++)w[h]=0;for(h=6707;h<=6709;h++)w[h]=0;for(h=6720;h<=6723;h++)w[h]=0;for(h=6732;h<=6738;h++)w[h]=0;for(h=6931;h<=6933;h++)w[h]=0;for(h=6956;h<=6959;h++)w[h]=0;for(h=7005;h<=7007;h++)w[h]=0;for(h=7057;h<=7070;h++)w[h]=2;for(h=7074;h<=7082;h++)w[h]=0;for(h=7109;h<=7118;h++)w[h]=0;for(h=7119;h<=7127;h++)w[h]=1;for(h=7374;h<=7376;h++)w[h]=0;for(h=7528;h<=7586;h++)w[h]=0;for(h=7587;h<=7645;h++)w[h]=2;for(h=7692;h<=7696;h++)w[h]=0;for(h=7755;h<=7787;h++)w[h]=0;for(h=7791;h<=7795;h++)w[h]=0;for(h=7799;h<=7801;h++)w[h]=0;for(h=7803;h<=7805;h++)w[h]=0;for(h=7825;h<=7831;h++)w[h]=0;for(h=7845;h<=7859;h++)w[h]=0;for(h=8013;h<=8032;h++)w[h]=0;for(h=8065;h<=8068;h++)w[h]=1;for(h=8518;h<=8529;h++)w[h]=2;for(h=8533;h<=8536;h++)w[h]=2;for(h=8538;h<=8540;h++)w[h]=2;for(h=8677;h<=8679;h++)w[h]=0;for(h=8836;h<=8840;h++)w[h]=0;for(h=8857;h<=8859;h++)w[h]=0;for(h=8908;h<=8910;h++)w[h]=0;for(h=9154;h<=9159;h++)w[h]=0;for(h=9205;h<=9218;h++)w[h]=0;for(h=9271;h<=9273;h++)w[h]=0;for(h=9295;h<=9297;h++)w[h]=0;for(h=9356;h<=9360;h++)w[h]=0;for(h=9404;h<=9407;h++)w[h]=0;for(h=9476;h<=9482;h++)w[h]=0;for(h=9487;h<=9494;h++)w[h]=0;for(h=9697;h<=9699;h++)w[h]=0;for(h=9821;h<=9865;h++)w[h]=0;for(h=10285;h<=10291;h++)w[h]=0;for(h=10314;h<=10317;h++)w[h]=0;for(h=10448;h<=10465;h++)w[h]=0;for(h=10726;h<=10729;h++)w[h]=0;for(h=10731;h<=10733;h++)w[h]=0;for(h=11114;h<=11118;h++)w[h]=0;for(h=20004;h<=20032;h++)w[h]=0;for(h=20047;h<=20049;h++)w[h]=0;for(h=20062;h<=20092;h++)w[h]=0;for(h=20135;h<=20138;h++)w[h]=0;for(h=20248;h<=20258;h++)w[h]=0;for(h=20348;h<=20358;h++)w[h]=0;for(h=20436;h<=20440;h++)w[h]=0;for(h=20822;h<=20824;h++)w[h]=0;for(h=20904;h<=20932;h++)w[h]=0;for(h=20934;h<=20936;h++)w[h]=0;for(h=21004;h<=21032;h++)w[h]=0;for(h=21035;h<=21037;h++)w[h]=0;for(h=21095;h<=21097;h++)w[h]=0;for(h=21148;h<=21150;h++)w[h]=0;for(h=21207;h<=21264;h++)w[h]=0;for(h=21307;h<=21364;h++)w[h]=0;for(h=21413;h<=21423;h++)w[h]=0;for(h=21453;h<=21463;h++)w[h]=0;for(h=21473;h<=21483;h++)w[h]=0;for(h=21780;h<=21782;h++)w[h]=0;for(h=21891;h<=21894;h++)w[h]=0;for(h=21896;h<=21899;h++)w[h]=0;for(h=22171;h<=22177;h++)w[h]=0;for(h=22181;h<=22187;h++)w[h]=0;for(h=22191;h<=22197;h++)w[h]=0;for(h=22207;h<=22222;h++)w[h]=0;for(h=22229;h<=22232;h++)w[h]=0;for(h=22234;h<=22236;h++)w[h]=0;for(h=22243;h<=22250;h++)w[h]=0;for(h=22262;h<=22265;h++)w[h]=0;for(h=22307;h<=22322;h++)w[h]=0;for(h=22348;h<=22357;h++)w[h]=0;for(h=22407;h<=22422;h++)w[h]=0;for(h=22462;h<=22465;h++)w[h]=0;for(h=22521;h<=22525;h++)w[h]=0;for(h=22607;h<=22622;h++)w[h]=0;for(h=22641;h<=22646;h++)w[h]=0;for(h=22648;h<=22657;h++)w[h]=0;for(h=22707;h<=22722;h++)w[h]=0;for(h=22762;h<=22765;h++)w[h]=0;for(h=22807;h<=22822;h++)w[h]=0;for(h=22991;h<=22994;h++)w[h]=0;for(h=23028;h<=23038;h++)w[h]=0;for(h=23301;h<=23333;h++)w[h]=2;for(h=23830;h<=23853;h++)w[h]=0;for(h=23866;h<=23872;h++)w[h]=0;for(h=23877;h<=23884;h++)w[h]=0;for(h=23886;h<=23894;h++)w[h]=0;for(h=23946;h<=23948;h++)w[h]=0;for(h=24311;h<=24313;h++)w[h]=0;for(h=24342;h<=24347;h++)w[h]=0;for(h=24370;h<=24374;h++)w[h]=10;for(h=24375;h<=24381;h++)w[h]=0;for(h=24718;h<=24721;h++)w[h]=0;for(h=24817;h<=24821;h++)w[h]=0;for(h=24877;h<=24882;h++)w[h]=0;for(h=24891;h<=24893;h++)w[h]=0;for(h=25391;h<=25395;h++)w[h]=0;for(h=25828;h<=25838;h++)w[h]=0;for(h=26191;h<=26195;h++)w[h]=0;for(h=26391;h<=26393;h++)w[h]=0;for(h=26701;h<=26722;h++)w[h]=0;for(h=26729;h<=26799;h++)w[h]=2;for(h=26801;h<=26803;h++)w[h]=2;for(h=26811;h<=26813;h++)w[h]=2;for(h=26847;h<=26870;h++)w[h]=2;for(h=26891;h<=26899;h++)w[h]=0;for(h=26901;h<=26923;h++)w[h]=0;for(h=26929;h<=26946;h++)w[h]=0;for(h=26948;h<=26998;h++)w[h]=0;for(h=27037;h<=27040;h++)w[h]=0;for(h=27205;h<=27232;h++)w[h]=0;for(h=27258;h<=27260;h++)w[h]=0;for(h=27391;h<=27398;h++)w[h]=0;for(h=27561;h<=27564;h++)w[h]=0;for(h=27571;h<=27574;h++)w[h]=0;for(h=27581;h<=27584;h++)w[h]=0;for(h=27591;h<=27594;h++)w[h]=0;for(h=27700;h<=27707;h++)w[h]=0;for(h=28191;h<=28193;h++)w[h]=0;for(h=28348;h<=28358;h++)w[h]=0;for(h=28402;h<=28432;h++)w[h]=0;for(h=28462;h<=28492;h++)w[h]=0;for(h=29118;h<=29122;h++)w[h]=0;for(h=29168;h<=29172;h++)w[h]=0;for(h=29177;h<=29185;h++)w[h]=0;for(h=29187;h<=29195;h++)w[h]=0;for(h=29900;h<=29903;h++)w[h]=0;for(h=30161;h<=30179;h++)w[h]=0;for(h=30491;h<=30494;h++)w[h]=0;for(h=30729;h<=30732;h++)w[h]=0;for(h=31251;h<=31259;h++)w[h]=0;for(h=31265;h<=31268;h++)w[h]=0;for(h=31275;h<=31279;h++)w[h]=0;for(h=31281;h<=31297;h++)w[h]=0;for(h=31461;h<=31469;h++)w[h]=0;for(h=31491;h<=31495;h++)w[h]=0;for(h=31917;h<=31922;h++)w[h]=0;for(h=31965;h<=32e3;h++)w[h]=0;for(h=32001;h<=32003;h++)w[h]=2;for(h=32005;h<=32031;h++)w[h]=2;for(h=32033;h<=32060;h++)w[h]=2;for(h=32064;h<=32067;h++)w[h]=2;for(h=32074;h<=32077;h++)w[h]=2;for(h=32081;h<=32086;h++)w[h]=0;for(h=32107;h<=32130;h++)w[h]=0;for(h=32133;h<=32159;h++)w[h]=0;for(h=32164;h<=32167;h++)w[h]=2;for(h=32180;h<=32199;h++)w[h]=0;for(h=32201;h<=32260;h++)w[h]=0;for(h=32301;h<=32360;h++)w[h]=0;for(h=32401;h<=32460;h++)w[h]=0;for(h=32501;h<=32560;h++)w[h]=0;for(h=32601;h<=32662;h++)w[h]=0;for(h=32664;h<=32667;h++)w[h]=2;for(h=32701;h<=32761;h++)w[h]=0;for(h=53001;h<=53004;h++)w[h]=0;for(h=53008;h<=53019;h++)w[h]=0;for(h=53021;h<=53032;h++)w[h]=0;for(h=53034;h<=53037;h++)w[h]=0;for(h=53042;h<=53046;h++)w[h]=0;for(h=53074;h<=53080;h++)w[h]=0;for(h=54001;h<=54004;h++)w[h]=0;for(h=54008;h<=54019;h++)w[h]=0;for(h=54021;h<=54032;h++)w[h]=0;for(h=54034;h<=54037;h++)w[h]=0;for(h=54042;h<=54046;h++)w[h]=0;for(h=54048;h<=54053;h++)w[h]=0;for(h=54074;h<=54080;h++)w[h]=0;for(h=54090;h<=54096;h++)w[h]=0;for(h=54098;h<=54101;h++)w[h]=0;for(h=65161;h<=65163;h++)w[h]=0;for(h=102001;h<=102040;h++)w[h]=0;for(h=102042;h<=102063;h++)w[h]=0;for(h=102065;h<=102067;h++)w[h]=0;for(h=102070;h<=102117;h++)w[h]=0;for(h=102122;h<=102216;h++)w[h]=0;for(h=102221;h<=102377;h++)w[h]=0;for(h=102382;h<=102388;h++)w[h]=0;for(h=102389;h<=102398;h++)w[h]=2;for(h=102399;h<=102444;h++)w[h]=0;for(h=102445;h<=102447;h++)w[h]=2;for(h=102448;h<=102458;h++)w[h]=0;for(h=102459;h<=102468;h++)w[h]=2;for(h=102469;h<=102499;h++)w[h]=0;for(h=102500;h<=102519;h++)w[h]=1;for(h=102520;h<=102524;h++)w[h]=0;for(h=102525;h<=102529;h++)w[h]=2;for(h=102530;h<=102588;h++)w[h]=0;for(h=102590;h<=102598;h++)w[h]=0;for(h=102601;h<=102603;h++)w[h]=0;for(h=102605;h<=102628;h++)w[h]=0;for(h=102629;h<=102646;h++)w[h]=2;for(h=102648;h<=102700;h++)w[h]=2;for(h=102701;h<=102703;h++)w[h]=0;for(h=102707;h<=102730;h++)w[h]=2;for(h=102733;h<=102758;h++)w[h]=2;for(h=102767;h<=102900;h++)w[h]=0;for(h=102901;h<=102933;h++)w[h]=2;for(h=102934;h<=102950;h++)w[h]=13;for(h=102951;h<=102963;h++)w[h]=0;for(h=102965;h<=102969;h++)w[h]=0;for(h=102971;h<=102973;h++)w[h]=0;for(h=102975;h<=102989;h++)w[h]=0;for(h=102990;h<=102992;h++)w[h]=1;for(h=102997;h<=103002;h++)w[h]=0;for(h=103003;h<=103008;h++)w[h]=2;for(h=103009;h<=103011;h++)w[h]=0;for(h=103012;h<=103014;h++)w[h]=2;for(h=103019;h<=103021;h++)w[h]=0;for(h=103022;h<=103024;h++)w[h]=2;for(h=103029;h<=103031;h++)w[h]=0;for(h=103032;h<=103034;h++)w[h]=2;for(h=103065;h<=103068;h++)w[h]=0;for(h=103074;h<=103076;h++)w[h]=0;for(h=103077;h<=103079;h++)w[h]=1;for(h=103080;h<=103082;h++)w[h]=0;for(h=103083;h<=103085;h++)w[h]=2;for(h=103090;h<=103093;h++)w[h]=0;for(h=103097;h<=103099;h++)w[h]=0;for(h=103100;h<=103102;h++)w[h]=2;for(h=103107;h<=103109;h++)w[h]=0;for(h=103110;h<=103112;h++)w[h]=2;for(h=103113;h<=103116;h++)w[h]=0;for(h=103117;h<=103120;h++)w[h]=2;for(h=103153;h<=103157;h++)w[h]=0;for(h=103158;h<=103162;h++)w[h]=2;for(h=103163;h<=103165;h++)w[h]=0;for(h=103166;h<=103168;h++)w[h]=1;for(h=103169;h<=103171;h++)w[h]=2;for(h=103186;h<=103188;h++)w[h]=0;for(h=103189;h<=103191;h++)w[h]=2;for(h=103192;h<=103195;h++)w[h]=0;for(h=103196;h<=103199;h++)w[h]=2;for(h=103200;h<=103224;h++)w[h]=0;for(h=103225;h<=103227;h++)w[h]=1;for(h=103232;h<=103237;h++)w[h]=0;for(h=103238;h<=103243;h++)w[h]=2;for(h=103244;h<=103246;h++)w[h]=0;for(h=103247;h<=103249;h++)w[h]=2;for(h=103254;h<=103256;h++)w[h]=0;for(h=103257;h<=103259;h++)w[h]=2;for(h=103264;h<=103266;h++)w[h]=0;for(h=103267;h<=103269;h++)w[h]=2;for(h=103300;h<=103375;h++)w[h]=0;for(h=103381;h<=103383;h++)w[h]=0;for(h=103384;h<=103386;h++)w[h]=1;for(h=103387;h<=103389;h++)w[h]=0;for(h=103390;h<=103392;h++)w[h]=2;for(h=103397;h<=103399;h++)w[h]=0;for(h=103400;h<=103471;h++)w[h]=2;for(h=103476;h<=103478;h++)w[h]=0;for(h=103479;h<=103481;h++)w[h]=2;for(h=103486;h<=103488;h++)w[h]=0;for(h=103489;h<=103491;h++)w[h]=2;for(h=103492;h<=103495;h++)w[h]=0;for(h=103496;h<=103499;h++)w[h]=2;for(h=103528;h<=103543;h++)w[h]=0;for(h=103544;h<=103548;h++)w[h]=2;for(h=103549;h<=103551;h++)w[h]=0;for(h=103552;h<=103554;h++)w[h]=1;for(h=103555;h<=103557;h++)w[h]=2;for(h=103558;h<=103560;h++)w[h]=0;for(h=103571;h<=103573;h++)w[h]=0;for(h=103574;h<=103576;h++)w[h]=2;for(h=103577;h<=103580;h++)w[h]=0;for(h=103581;h<=103583;h++)w[h]=2;for(h=103595;h<=103694;h++)w[h]=0;for(h=103696;h<=103699;h++)w[h]=0;for(h=103700;h<=103793;h++)w[h]=2;for(h=103794;h<=103890;h++)w[h]=0;for(h=103891;h<=103896;h++)w[h]=2;for(h=103900;h<=103971;h++)w[h]=2;for(h=103972;h<=103977;h++)w[h]=0;for(h=112e3;h<=112101;h++)w[h]=0;const GL=[102100,102113,3857,3785,900913],cB=[104905,104971],dB=[104903],hB=[4326,...GL,...cB,...dB],Sm=[-20037508342788905e-9,20037508342788905e-9],V_=[-20037508342787e-6,20037508342787e-6],q1={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:Sm,origin:V_,dx:1e-5},BL={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Sm,origin:V_,dx:1e-5},102100:q1,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Sm,origin:V_,dx:1e-5},3857:q1,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:q1,104903:{wkTemplate:'GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400,0,AUTHORITY["ESRI","107903"]],AUTHORITY["ESRI","106903"]],PRIMEM["Reference_Meridian",0,AUTHORITY["ESRI","108900"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["ESRI","104903"]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function Wt(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const r=t.wkid,i=e.wkid;if(r!=null||i!=null){if(r===i||Dn(t)&&Dn(e))return!0;const o=t.latestWkid;if(o!=null&&i===o)return!0;const l=e.latestWkid;return l!=null&&r===l}let s,n;return t.wkt2&&e.wkt2?(s=t.wkt2,n=e.wkt2):t.wkt&&e.wkt&&(s=t.wkt,n=e.wkt),!(!s||!n)&&s.toUpperCase()===n.toUpperCase()}function Kr(t){const e=t?.wkid;return e!=null&&e>=2e3&&BL[e]||null}function _v(t){if(!t)return;const{wkid:e,vcsWkid:r}=t;if(e)return r?JSON.stringify({wkid:e,vcsWkid:r}):String(e);const i=t.wkt||t.wkt2;return JSON.stringify(i?r?{wkt:i,vcsWkid:r}:{wkt:i}:{})}function Kh(t){if(!Ni(t))return!1;const{wkid:e}=t;if(e)return w[e]==null;const r=t.wkt2||t.wkt;return!!r&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(r)}function pB(t){return!(HL(t)||WL(t))}function Cu(t){return t?.wkid===4326}function xbe(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function ZI(t){return t?.wkid===4490}function Dn(t){const e=t?.wkid;return e!=null&&e>=2e3&&GL.includes(e)}function fB(t){return t?.wkid===32662}function Iw(t){return t===104971||t===104905}function HL(t){return Iw(t?.wkid)}function Ew(t){return t===104903}function WL(t){return Ew(t?.wkid)}function mB(t){const e=t?.wkid;return e!=null&&e>=2e3&&hB.includes(e)}function Ni(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const ZL={wkid:4326,wkt:sl(BL[4326].wkTemplate,{Central_Meridian:"0.0"})},JL={wkid:102100,latestWkid:3857},yB={wkid:32662};function DT(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const gB=DT(dt),jT=DT(An),VT=DT(Za),vB={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${dt.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},wB=jT.wkt.toUpperCase(),bB=VT.wkt.toUpperCase();function _B(t){if(t!=null&&Ni(t)){const e=t.wkid,r=t.wkt2??t.wkt;if(Iw(e))return An;const i=r?.toUpperCase();if(r&&i===wB)return An;if(Ew(e)||i&&i===bB)return Za}return dt}function Tbe(t){return Iw(t)?An:Ew(t)?Za:dt}function Sv(t){return Wt(t,gB)}function Ya(t){return Sv(t)||Wt(t,jT)||Wt(t,VT)}const YL=39.37,SB=dt.radius*Math.PI/200,KL=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,_h=w,QL=/UNIT\[([^\]]+)]/i,$B=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),xB=Ft()({millimeter:"millimeters",centimeter:"centimeters",meter:"meters",meter_german:"german-meters",kilometer:"kilometers",decimeter:"decimeters",micrometer:"micrometers",nanometer:"nanometers","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",fathom:"fathoms",nautical_mile:"nautical-miles",chain_us:"us-chains",link_us:"us-links",mile_us:"us-miles",yard_clarke:"clarke-yards",chain_clarke:"clarke-chains",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",link_sears:"sears-links",yard_benoit_1895_a:"benoit-1895-a-yards",foot_benoit_1895_a:"benoit-1895-a-feet",chain_benoit_1895_a:"benoit-1895-a-chains",link_benoit_1895_a:"benoit-1895-a-links",yard_benoit_1895_b:"benoit-1895-b-yards",foot_benoit_1895_b:"benoit-1895-b-feet",chain_benoit_1895_b:"benoit-1895-b-chains",link_benoit_1895_b:"benoit-1895-b-links",foot_1865:"1865-feet",foot_indian:"indian-feet",foot_indian_1937:"indian-1937-feet",foot_indian_1962:"indian-1962-feet",foot_indian_1975:"indian-1975-feet",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",yard_indian_1962:"indian-1962-yards",yard_indian_1975:"indian-1975-yards",statute_mile:"statute-miles",foot_gold_coast:"gold-coast-feet",foot_british_1936:"british-1936-feet",yard:"yards",chain:"chains",link:"links",yard_sears_1922_truncated:"sears-1922-truncated-yards",foot_sears_1922_truncated:"sears-1922-truncated-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",link_sears_1922_truncated:"sears-1922-truncated-links",yard_us:"us-yards",inch:"inches",inch_us:"us-inches",rod:"rods",rod_us:"us-rods",nautical_mile_us:"us-nautical-miles",nautical_mile_uk:"uk-nautical-miles",smoot:"smoots",vara_tx:"tx-vara",point:"points"}),Ts=t=>t*t,Qo=t=>t*t*t,$m={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},meters:{inBaseUnits:1},feet:{inBaseUnits:.3048},"us-feet":{inBaseUnits:.3048006096012192},"clarke-feet":{inBaseUnits:.3047972654},fathoms:{inBaseUnits:1.8288},"nautical-miles":{inBaseUnits:1852},"german-meters":{inBaseUnits:1.0000135965},"us-chains":{inBaseUnits:20.11684023368047},"us-links":{inBaseUnits:.2011684023368047},"us-miles":{inBaseUnits:1609.347218694438},kilometers:{inBaseUnits:1e3},"clarke-yards":{inBaseUnits:.9143917962},"clarke-chains":{inBaseUnits:20.1166195164},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"sears-links":{inBaseUnits:.2011676512155263},"benoit-1895-a-yards":{inBaseUnits:.9143992},"benoit-1895-a-feet":{inBaseUnits:.3047997333333333},"benoit-1895-a-chains":{inBaseUnits:20.1167824},"benoit-1895-a-links":{inBaseUnits:.201167824},"benoit-1895-b-yards":{inBaseUnits:.9143992042898124},"benoit-1895-b-feet":{inBaseUnits:.3047997347632708},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"benoit-1895-b-links":{inBaseUnits:.2011678249437587},"1865-feet":{inBaseUnits:.3048008333333334},"indian-feet":{inBaseUnits:.3047995102481469},"indian-1937-feet":{inBaseUnits:.30479841},"indian-1962-feet":{inBaseUnits:.3047996},"indian-1975-feet":{inBaseUnits:.3047995},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"indian-1962-yards":{inBaseUnits:.9143988},"indian-1975-yards":{inBaseUnits:.9143985},miles:{inBaseUnits:1609.344},"statute-miles":{inBaseUnits:1609.344},"gold-coast-feet":{inBaseUnits:.3047997101815088},"british-1936-feet":{inBaseUnits:.3048007491},yards:{inBaseUnits:.9144},chains:{inBaseUnits:20.1168},links:{inBaseUnits:.201168},"sears-1922-truncated-yards":{inBaseUnits:.914398},"sears-1922-truncated-feet":{inBaseUnits:.3047993333333334},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"sears-1922-truncated-links":{inBaseUnits:.20116756},"us-yards":{inBaseUnits:.9144018288036576},decimeters:{inBaseUnits:.1},inches:{inBaseUnits:.0254},"us-inches":{inBaseUnits:.0254000508001016},rods:{inBaseUnits:5.0292},"us-rods":{inBaseUnits:5.029210058420118},"us-nautical-miles":{inBaseUnits:1853.248},"uk-nautical-miles":{inBaseUnits:1853.184},smoots:{inBaseUnits:1.7018},"tx-vara":{inBaseUnits:.8466683600033867},points:{inBaseUnits:.0003527777777777778},micrometers:{inBaseUnits:1e-6},nanometers:{inBaseUnits:1e-9},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:Ts(.001)},"square-centimeters":{inBaseUnits:Ts(.01)},"square-decimeters":{inBaseUnits:Ts(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:Ts(1e3)},"square-inches":{inBaseUnits:Ts(.0254)},"square-feet":{inBaseUnits:Ts(.3048)},"square-yards":{inBaseUnits:Ts(.9144)},"square-miles":{inBaseUnits:Ts(1609.344)},"square-nautical-miles":{inBaseUnits:Ts(1852)},"square-us-feet":{inBaseUnits:Ts(1200/3937)},acres:{inBaseUnits:.0015625*Ts(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*Qo(.001)},"cubic-centimeters":{inBaseUnits:1e3*Qo(.01)},"cubic-decimeters":{inBaseUnits:1e3*Qo(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*Qo(1e3)},"cubic-inches":{inBaseUnits:1e3*Qo(.0254)},"cubic-feet":{inBaseUnits:1e3*Qo(.3048)},"cubic-yards":{inBaseUnits:1e3*Qo(.9144)},"cubic-miles":{inBaseUnits:1e3*Qo(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},TB=(()=>{const t={};for(const e in $m)for(const r in $m[e].units)t[r]=e;return t})();function MB(t,e,r){return t*$m[r].units[e].inBaseUnits}function IB(t,e,r){return t/$m[r].units[e].inBaseUnits}const EB=["inches","feet","yards","miles","nautical-miles","us-feet","millimeters","centimeters","decimeters","meters","kilometers"],OB=["metric","imperial"],XL=[...OB,...EB],kB=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function z_(t){const e=TB[t];if(!e)throw new Error("unknown type");return e}function JI(t,e=null){return e=e||z_(t),$m[e].baseUnit===t}function gt(t,e,r){if(e===r)return t;const i=z_(e);if(i!==z_(r))throw new Error("incompatible units");const s=JI(e,i)?t:MB(t,e,i);return JI(r,i)?s:IB(s,r,i)}function Mbe(t,e,r,i=!1){if(!i&&Kh(e))throw new Error("Unable to convert from an angular unit to a linear unit.");const s=Bu(e);return s!==r&&(t=s?gt(t,s,r):gt(t*=Hi(e),"meters",r)),t}function Ibe(t,e,r,i=!1){if(!i&&Kh(r))throw new Error("Unable to convert from a linear unit to an angular unit.");const s=Bu(r);return e!==s&&(t=s?gt(t,e,s):gt(t,e,"meters")/Hi(r)),t}function CB(t){switch(t){case"metric":return"meters";case"imperial":return"feet";default:return t}}function Ebe(t){return CB(t)}function Obe(t){switch(t){case"metric":return"square-meters";case"imperial":return"square-feet";default:return t}}function kbe(t,e,r){switch(r){case"metric":return PB(t,e);case"imperial":return RB(t,e);default:return r}}function Cbe(t,e,r){switch(r){case"metric":return AB(t,e);case"imperial":return LB(t,e);default:return r}}function PB(t,e){const r=gt(t,e,"meters");return Math.abs(r)<3e3?"meters":"kilometers"}function AB(t,e){const r=gt(t,e,"meters");return Math.abs(r)<1e5?"meters":"kilometers"}function RB(t,e){const r=gt(t,e,"feet");return Math.abs(r)<1e3?"feet":"miles"}function LB(t,e){const r=gt(t,e,"feet");return Math.abs(r)<1e5?"feet":"miles"}function Pbe(t,e){const r=gt(t,e,"square-meters");return Math.abs(r)<3e6?"square-meters":"square-kilometers"}function Abe(t,e){const r=gt(t,e,"square-feet");return Math.abs(r)<1e6?"square-feet":"square-miles"}function FB(t,e,r){return gt(t,e,"meters")/(r*Math.PI/180)}function zT(t){return xB.fromJSON(t.toLowerCase())||null}function $v(t){if(t!=null&&!pB(t))return 1;const e=Hi(t);return e>1e5?1:e}function eF(t){return Hi(t)>=_B(t).metersPerDegree?"meters":Bu(t)}function Hi(t,e=dt.metersPerDegree){return NB(t,!0)??e}function NB(t,e=!1){const r=t?.wkid??null,i=t?.wkt2??t?.wkt??null;let s=null;if(r){if(Iw(r))return An.metersPerDegree;if(Ew(r))return Za.metersPerDegree;s=_h.values[_h[r]],!s&&e&&$B.has(r)&&(s=SB)}else i&&(iF(i)?s=YI(KL.exec(i),s):rF(i)&&(s=YI(QL.exec(i),s)));return s}function Rbe(t){return Kh(t)?1:Hi(t)}function YI(t,e){return t?.[1]?tF(t[1]):e}function tF(t){return parseFloat(t.split(",")[1])}function Bu(t){const e=t?.wkid??null,r=t?.wkt2??t?.wkt??null;let i=null;if(e)i=_h.units[_h[e]];else if(r){const s=iF(r)?KL:rF(r)?QL:null;if(s){const n=s.exec(r);n?.[1]&&(i=jB(n[1]))}}return i!=null?zT(i):null}function Lbe(t){const e=Bu(t);return e!=null&&XL.includes(e)?e:null}function Fbe(t){const e=eF(t);return e!=null&&XL.includes(e)?e:null}function Nbe(t){const e=Bu(t);return e==null?null:kB.get(e)}function rF(t){return/^GEOCCS/i.test(t)}function iF(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const DB=1e-7;function jB(t){let r=/[\\"']([^\\"']+)/.exec(t)?.[1];if(!r||!zT(r)){const i=tF(t);r=null;const s=_h.values;for(let n=0;n<s.length;++n)if(Math.abs(i-s[n])<DB){r=_h.units[n];break}}return r}function Dbe(t){const e=Bu(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"fathoms":case"nautical-miles":case"us-chains":case"us-links":case"us-miles":case"clarke-yards":case"clarke-chains":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"sears-links":case"benoit-1895-a-yards":case"benoit-1895-a-feet":case"benoit-1895-a-chains":case"benoit-1895-a-links":case"benoit-1895-b-yards":case"benoit-1895-b-feet":case"benoit-1895-b-chains":case"benoit-1895-b-links":case"1865-feet":case"indian-feet":case"indian-1937-feet":case"indian-1962-feet":case"indian-1975-feet":case"indian-yards":case"indian-1937-yards":case"indian-1962-yards":case"indian-1975-yards":case"statute-miles":case"gold-coast-feet":case"british-1936-feet":case"yards":case"chains":case"links":case"sears-1922-truncated-yards":case"sears-1922-truncated-feet":case"sears-1922-truncated-chains":case"sears-1922-truncated-links":case"us-yards":case"inches":case"us-inches":case"rods":case"us-rods":case"us-nautical-miles":case"uk-nautical-miles":case"smoots":case"tx-vara":case"points":return"imperial";case"millimeters":case"centimeters":case"meters":case"german-meters":case"kilometers":case"decimeters":case"micrometers":case"nanometers":case"50-kilometers":case"150-kilometers":return"metric"}return null}const VB={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},zB={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},UB={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},qB=Ft()(VB),GB=Ft()(zB),jbe=Ft()(UB);var ln,On;let Z=(On=class extends F{static fromJSON(e){if(!e)return null;if(e?.wkid===102100)return ln.WebMercator;if(e?.wkid===4326)return ln.WGS84;const r=new ln;return r.read(e),r}constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(e){return e&&typeof e=="object"?e:{[typeof e=="string"?"wkt":"wkid"]:e}}get isWGS84(){return Cu(this)}get isWebMercator(){return Dn(this)}get isGeographic(){return Kh(this)}get isWrappable(){return mB(this)}get metersPerUnit(){return Hi(this)}get unit(){return Bu(this)||(this.isGeographic?"degrees":null)}writeWkt(e,r){this.wkid||(r.wkt=e)}clone(){if(this===ln.WGS84)return new ln(ZL);if(this===ln.WebMercator)return new ln(JL);const e=new ln;return this.wkid!=null?(e.wkid=this.wkid,this.latestWkid!=null&&(e.latestWkid=this.latestWkid),this.vcsWkid!=null&&(e.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(e.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(e.wkt=this.wkt),this.wkt2!=null&&(e.wkt2=this.wkt2)),this.imageCoordinateSystem&&(e.imageCoordinateSystem=E(this.imageCoordinateSystem)),e}equals(e){if(e==null)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(this.imageCoordinateSystem==null||e.imageCoordinateSystem==null)return!1;const{id:r,referenceServiceName:i}=e.imageCoordinateSystem,{geodataXform:s}=e.imageCoordinateSystem,n=this.imageCoordinateSystem;return r==null||s?JSON.stringify(n)===JSON.stringify(e.imageCoordinateSystem):i?n.id===r&&n.referenceServiceName===i:n.id===r}return Wt(this,e)}toJSON(e){return this.write(void 0,e)}},ln=On,On.GCS_NAD_1927=null,On.WGS84=null,On.WebMercator=null,On.PlateCarree=null,On);a([c({readOnly:!0})],Z.prototype,"isWGS84",null),a([c({readOnly:!0})],Z.prototype,"isWebMercator",null),a([c({readOnly:!0})],Z.prototype,"isGeographic",null),a([c({readOnly:!0})],Z.prototype,"isWrappable",null),a([c({type:xe,json:{write:!0}})],Z.prototype,"latestWkid",void 0),a([c({readOnly:!0})],Z.prototype,"metersPerUnit",null),a([c({readOnly:!0})],Z.prototype,"unit",null),a([c({type:xe,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],Z.prototype,"wkid",void 0),a([c({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],Z.prototype,"wkt",void 0),a([q("wkt"),q("web-scene","wkt")],Z.prototype,"writeWkt",null),a([c({type:String,json:{write:!1}})],Z.prototype,"wkt2",void 0),a([c({type:xe,json:{write:!0}})],Z.prototype,"vcsWkid",void 0),a([c({type:xe,json:{write:!0}})],Z.prototype,"latestVcsWkid",void 0),a([c()],Z.prototype,"imageCoordinateSystem",void 0),Z=ln=a([b("esri.geometry.SpatialReference")],Z),Z.prototype.toJSON.isDefaultToJSON=!0,Z.GCS_NAD_1927=X.freeze(new Z({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),Z.WGS84=X.freeze(new Z(ZL)),Z.WebMercator=X.freeze(new Z(JL)),Z.PlateCarree=X.freeze(new Z(yB));function V(t,e,r){let i,s;return e===void 0||Array.isArray(e)?(s=t,r=e,i=[void 0]):(s=e,i=Array.isArray(t)?t:[t]),(n,o)=>{const l=n.constructor.prototype;i.forEach(u=>{const d=IT(n,u,s);d.read&&typeof d.read=="object"||(d.read={}),d.read.reader=l[o],r&&(d.read.source=(d.read.source||[]).concat(r))})}}let qt=class extends F{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Z.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,r){if(e instanceof Z)return e;if(e!=null){const i=new Z;return i.read(e,r),i}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,r){this.cache[e]=r}};a([c()],qt.prototype,"type",void 0),a([c({readOnly:!0})],qt.prototype,"cache",null),a([c({readOnly:!0})],qt.prototype,"extent",null),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],qt.prototype,"hasM",void 0),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],qt.prototype,"hasZ",void 0),a([c({type:Z,json:{write:!0},value:Z.WGS84})],qt.prototype,"spatialReference",void 0),a([V("spatialReference")],qt.prototype,"readSpatialReference",null),qt=a([b("esri.geometry.Geometry")],qt);const BB=Object.prototype.toString;function HB(t){const e="__accessorMetadata__"in t?ct(t):t;return function(...r){if(r.push(e),typeof r[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return WB.apply(this,r)}}function WB(t,e,r,i){Xm(t,e).cast=i}function ZB(t){return(e,r)=>{Xm(e,t).cast=e[r]}}function Ce(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&BB.call(t[0])==="[object Function]"?HB(t[0]):t.length===1&&typeof t[0]=="string"?ZB(t[0]):void 0}function Sh(t){if(t&&typeof t=="object"&&"type"in t&&t.type==="mesh")throw new x("internal:mesh","Mesh geometries are not supported for this operation")}function JB(t){t.forEach(Sh)}const YB=57.29577951308232,KB=.017453292519943;function KI(t){return t*YB}function QI(t){return t*KB}function zbe(t){return Math.PI/2-2*Math.atan(Math.exp(-t/dt.radius))}function U_(t){return t.wkid!=null||t.wkt!=null}const G1=[0,0];function xv(t,e,r,i,s){const n=t,o=s;if(o.spatialReference=r,"x"in n&&"x"in o)[o.x,o.y]=e(n.x,n.y,G1,i);else if("xmin"in n&&"xmin"in o)[o.xmin,o.ymin]=e(n.xmin,n.ymin,G1,i),[o.xmax,o.ymax]=e(n.xmax,n.ymax,G1,i);else if("paths"in n&&"paths"in o||"rings"in n&&"rings"in o){const l="paths"in n?n.paths:n.rings,u=[];let d;for(let p=0;p<l.length;p++){const f=l[p];d=[],u.push(d);for(let m=0;m<f.length;m++)d.push(e(f[m][0],f[m][1],[0,0],i)),f[m].length>2&&d[m].push(f[m][2]),f[m].length>3&&d[m].push(f[m][3])}"paths"in o?o.paths=u:o.rings=u}else if("points"in n&&"points"in o){const l=n.points,u=[];for(let d=0;d<l.length;d++)u[d]=e(l[d][0],l[d][1],[0,0],i),l[d].length>2&&u[d].push(l[d][2]),l[d].length>3&&u[d].push(l[d][3]);o.points=u}return s}function Dg(t,e){const r=t&&(U_(t)?t:t.spatialReference),i=e&&(U_(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!r||!i)&&(!!Wt(i,r)||Dn(i)&&Cu(r)||Dn(r)&&Cu(i))}function Ow(t,e){if(t==null)return null;const r=t.spatialReference,i=e&&(U_(e)?e:e.spatialReference);return Dg(r,i)?Wt(r,i)?E(t):Dn(i)?xv(t,ud,Z.WebMercator,!1,E(t)):Cu(i)?xv(t,kw,Z.WGS84,!1,E(t)):null:null}function ud(t,e,r=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const i=QI(e);return r[0]=QI(t)*dt.radius,r[1]=dt.halfSemiMajorAxis*Math.log((1+Math.sin(i))/(1-Math.sin(i))),r}function kw(t,e,r=[0,0],i=!1){if(t===Sm[0])r[0]=-180;else if(t===Sm[1])r[0]=180;else{const s=KI(t/dt.radius);r[0]=i?s:s-360*Math.floor((s+180)/360)}return r[1]=KI(Math.PI/2-2*Math.atan(Math.exp(-e/dt.radius))),r}function za(t,e=!1,r=E(t)){return Sh(t),Sh(r),xv(t,ud,Z.WebMercator,e,r)}function cd(t,e=!1,r=E(t)){return Sh(t),Sh(r),xv(t,kw,Z.WGS84,e,r)}function sF(t,e){const r=t.x-e.x,i=t.y-e.y,s=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(r*r+i*i+s*s)}function QB(t){return nF(t,oF)?.[0]??null}function XB(t){return nF(t,oF)?.[1]??null}function nF({x:t,y:e,spatialReference:r},i=[0,0]){if(r){if(Dn(r))return kw(t,e,i);if(Kh(r))return i[0]=t,i[1]=e,i}return null}const oF=[0,0];var jg;const B1=[0,0];function XI(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let ee=jg=class extends qt{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const r=t._get("spatialReference");e._set("spatialReference",X.isFrozen(r)?r:r.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,r,i,s){let n;if(Array.isArray(t))n=t,s=e,t=n[0],e=n[1],r=n[2],i=n[3];else if(t&&typeof t=="object"){if(n=t,t=n.x!=null?n.x:n.longitude,e=n.y!=null?n.y:n.latitude,r=n.z,i=n.m,(s=n.spatialReference)&&s.declaredClass!=="esri.geometry.SpatialReference"&&(s=new Z(s)),n.longitude!=null||n.latitude!=null){if(n.longitude==null)L.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(n.latitude==null)L.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!n.declaredClass&&s?.isWebMercator){const l=ud(n.longitude,n.latitude,B1);t=l[0],e=l[1]}}}else XI(r)?(s=r,r=null):XI(i)&&(s=i,i=null);const o={x:t,y:e};return o.x==null&&o.y!=null?L.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&L.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),s!=null&&(o.spatialReference=s),r!=null&&(o.z=r),i!=null&&(o.m=i),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return XB(this)}set latitude(t){const{spatialReference:e,x:r}=this;t!=null&&e&&(e.isWebMercator?this._set("y",ud(r,t,B1)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return QB(this)}set longitude(t){const{y:e,spatialReference:r}=this;t!=null&&r&&(r.isWebMercator?this._set("x",ud(t,e,B1)[0]):r.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,r){e[r]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new jg;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return jg.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:r,z:i,m:s,spatialReference:n}=this,{z:o,m:l}=t;let{x:u,y:d,spatialReference:p}=t;if(!n.equals(p))if(n.isWebMercator&&p.isWGS84)[u,d]=ud(u,d),p=n;else{if(!n.isWGS84||!p.isWebMercator)return!1;[u,d]=kw(u,d),p=n}return e===u&&r===d&&i===o&&s===l&&n.wkid===p.wkid}offset(t,e,r){return this.x+=t,this.y+=e,r!=null&&(this.z=(this.z??0)+r),this}normalize(){if(!this.spatialReference)return this;const t=Kr(this.spatialReference);if(!t)return this;let e=this.x;const[r,i]=t.valid,s=2*i;let n;return e>i?(n=Math.ceil(Math.abs(e-i)/s),e-=n*s):e<r&&(n=Math.ceil(Math.abs(e-r)/s),e+=n*s),this._set("x",e),this}distance(t){return sF(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};a([c({readOnly:!0})],ee.prototype,"cache",null),a([c({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],ee.prototype,"hasM",null),a([c({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],ee.prototype,"hasZ",null),a([c({type:Number})],ee.prototype,"latitude",null),a([c({type:Number})],ee.prototype,"longitude",null),a([c({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),Ce(t=>isNaN(t)?t:Hr(t))],ee.prototype,"x",void 0),a([q("x")],ee.prototype,"writeX",null),a([V("x")],ee.prototype,"readX",null),a([c({type:Number,json:{write:!0}})],ee.prototype,"y",void 0),a([c({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],ee.prototype,"z",void 0),a([c({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],ee.prototype,"m",void 0),ee=jg=a([b("esri.geometry.Point")],ee),ee.prototype.toJSON.isDefaultToJSON=!0;const H1=[0,0];function sy(t,e){return e!=null&&zr(t,e.x,e.y,e.z)}function Ube(t,e){if(!e.points?.length)return!1;for(const r of e.points)if(!$h(t,r))return!1;return!0}function eH(t,e){const{xmin:r,ymin:i,zmin:s,xmax:n,ymax:o,zmax:l}=e;return t.hasZ&&e.hasZ?zr(t,r,i,s)&&zr(t,r,o,s)&&zr(t,n,o,s)&&zr(t,n,i,s)&&zr(t,r,i,l)&&zr(t,r,o,l)&&zr(t,n,o,l)&&zr(t,n,i,l):zr(t,r,i)&&zr(t,r,o)&&zr(t,n,o)&&zr(t,n,i)}function $h(t,e){return zr(t,e[0],e[1])}function tH(t,e){return zr(t,e[0],e[1],e[2])}function zr(t,e,r,i){return e>=t.xmin&&e<=t.xmax&&r>=t.ymin&&r<=t.ymax&&(i==null||!t.hasZ||i>=t.zmin&&i<=t.zmax)}function UT(t,e){return H1[1]=e.y,H1[0]=e.x,rH(t,H1)}function rH(t,e){return qT(t.rings,e)}function qT(t,e){if(!t||t.length<1)return!1;if(iH(t))return eE(!1,t,e);let r=!1;for(let i=0,s=t.length;i<s;i++)r=eE(r,t[i],e);return r}function iH(t){return!Array.isArray(t[0][0])}function eE(t,e,r){const[i,s]=r;let n=t,o=0;for(let l=0,u=e.length;l<u;l++){o++,o===u&&(o=0);const[d,p]=e[l],[f,m]=e[o];(p<s&&m>=s||m<s&&p>=s)&&d+(s-p)/(m-p)*(f-d)<i&&(n=!n)}return n}function sH(t,e){return sy(t,e)}function nH(t,e){const r=t.hasZ&&e.hasZ;let i,s,n;if(t.xmin<=e.xmin){if(i=e.xmin,t.xmax<i)return!1}else if(i=t.xmin,e.xmax<i)return!1;if(t.ymin<=e.ymin){if(s=e.ymin,t.ymax<s)return!1}else if(s=t.ymin,e.ymax<s)return!1;if(r&&e.hasZ){if(t.zmin<=e.zmin){if(n=e.zmin,t.zmax<n)return!1}else if(n=t.zmin,e.zmax<n)return!1}return!0}function oH(t,e){const{points:r,hasZ:i}=e,s=i?tH:$h;for(const n of r)if(s(t,n))return!0;return!1}const Pu=[0,0],Au=[0,0],Ru=[0,0],Lu=[0,0],aH=[Pu,Au,Ru,Lu],aF=[[Ru,Pu],[Pu,Au],[Au,Lu],[Lu,Ru]];function lH(t,e){return uH(t,e.rings)}function uH(t,e){Pu[0]=t.xmin,Pu[1]=t.ymax,Au[0]=t.xmax,Au[1]=t.ymax,Ru[0]=t.xmin,Ru[1]=t.ymin,Lu[0]=t.xmax,Lu[1]=t.ymin;for(const r of aH)if(qT(e,r))return!0;for(const r of e){if(!r.length)continue;let i=r[0];if($h(t,i))return!0;for(let s=1;s<r.length;s++){const n=r[s];if($h(t,n)||lF(i,n,aF))return!0;i=n}}return!1}function cH(t,e){Pu[0]=t.xmin,Pu[1]=t.ymax,Au[0]=t.xmax,Au[1]=t.ymax,Ru[0]=t.xmin,Ru[1]=t.ymin,Lu[0]=t.xmax,Lu[1]=t.ymin;const r=e.paths;for(const i of r){if(!r.length)continue;let s=i[0];if($h(t,s))return!0;for(let n=1;n<i.length;n++){const o=i[n];if($h(t,o)||lF(s,o,aF))return!0;s=o}}return!1}const Kt=[0,0];function dH(t){for(let e=0;e<t.length;e++){const r=t[e];for(let s=0;s<r.length-1;s++){const n=r[s],o=r[s+1];for(let l=e+1;l<t.length;l++)for(let u=0;u<t[l].length-1;u++){const d=t[l][u],p=t[l][u+1];if(q_(n,o,d,p,Kt)&&!(Kt[0]===n[0]&&Kt[1]===n[1]||Kt[0]===d[0]&&Kt[1]===d[1]||Kt[0]===o[0]&&Kt[1]===o[1]||Kt[0]===p[0]&&Kt[1]===p[1]))return!0}}const i=r.length;if(!(i<=4))for(let s=0;s<i-3;s++){let n=i-1;s===0&&(n=i-2);const o=r[s],l=r[s+1];for(let u=s+2;u<n;u++){const d=r[u],p=r[u+1];if(q_(o,l,d,p,Kt)&&!(Kt[0]===o[0]&&Kt[1]===o[1]||Kt[0]===d[0]&&Kt[1]===d[1]||Kt[0]===l[0]&&Kt[1]===l[1]||Kt[0]===p[0]&&Kt[1]===p[1]))return!0}}}return!1}function lF(t,e,r){for(let i=0;i<r.length;i++)if(q_(t,e,r[i][0],r[i][1]))return!0;return!1}function q_(t,e,r,i,s){const[n,o]=t,[l,u]=e,[d,p]=r,[f,m]=i,y=f-d,g=n-d,v=l-n,_=m-p,S=o-p,M=u-o,C=_*v-y*M;if(C===0)return!1;const T=(y*S-_*g)/C,O=(v*S-M*g)/C;return T>=0&&T<=1&&O>=0&&O<=1&&(s&&(s[0]=n+T*(l-n),s[1]=o+T*(u-o)),!0)}function hH(t){switch(t){case"esriGeometryEnvelope":case"extent":return nH;case"esriGeometryMultipoint":case"multipoint":return oH;case"esriGeometryPoint":case"point":return sH;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return lH;case"esriGeometryPolyline":case"polyline":return cH}}var Cs;function pH(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function Xo(t,e,r){return e==null?r:r==null?e:t(e,r)}let he=Cs=class extends qt{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,r,i,s){return pH(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?Z.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:r,ymax:i,spatialReference:s??Z.WGS84}}static fromPoint(t){return new Cs({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new ee({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new Cs;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,r=t.spatialReference;return e&&r&&!e.equals(r)&&Dg(e,r)&&(t=e.isWebMercator?za(t):cd(t,!0)),t.type==="point"?sy(this,t):t.type==="extent"&&eH(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,r=t.spatialReference;return e&&r&&!e.equals(r)&&Dg(e,r)&&(t=e.isWebMercator?za(t):cd(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),r=this.width*e,i=this.height*e;if(this.xmin+=r,this.ymin+=i,this.xmax-=r,this.ymax-=i,this.hasZ){const s=(this.zmax-this.zmin)*e;this.zmin+=s,this.zmax-=s}if(this.hasM){const s=(this.mmax-this.mmin)*e;this.mmin+=s,this.mmax-=s}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,r=t.spatialReference;return e&&r&&!Wt(e,r)&&Dg(e,r)&&(t=e.isWebMercator?za(t):cd(t,!0)),hH(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,r){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,r!=null&&(this.zmin+=r,this.zmax+=r),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Xo(Math.min,this.zmin,t.zmin),this.zmax=Xo(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Xo(Math.min,this.mmin,t.mmin),this.mmax=Xo(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Xo(Math.max,this.zmin,t.zmin),this.zmax=Xo(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Xo(Math.max,this.mmin,t.mmin),this.mmax=Xo(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=Kr(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,r=this._getCM(t);if(r){const i=e.isWebMercator?cd(r):r;this.xmin-=r.x,this.xmax-=r.x,e.isWebMercator||(i.x=W1(i.x,t).x),this.spatialReference=new Z(sl((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:i.x}))}return this}_getCM(t){let e=null;const[r,i]=t.valid,s=this.xmin,n=this.xmax;return s>=r&&s<=i&&n>=r&&n<=i||(e=this.center),e}_normalize(t,e,r){const i=this.spatialReference;if(!i)return this;const s=r??Kr(i);if(s==null)return this;const n=this._getParts(s).map(u=>u.extent);if(n.length<2)return n[0]||this;if(n.length>2)return t?this._shiftCM(s):this.set({xmin:s.valid[0],xmax:s.valid[1]});if(t)return this._shiftCM(s);if(e)return n;let o=!0,l=!0;return n.forEach(u=>{u.hasZ||(o=!1),u.hasM||(l=!1)}),{rings:n.map(u=>{const d=[[u.xmin,u.ymin],[u.xmin,u.ymax],[u.xmax,u.ymax],[u.xmax,u.ymin],[u.xmin,u.ymin]];if(o){const p=(u.zmax-u.zmin)/2;for(let f=0;f<d.length;f++)d[f].push(p)}if(l){const p=(u.mmax-u.mmin)/2;for(let f=0;f<d.length;f++)d[f].push(p)}return d}),hasZ:o,hasM:l,spatialReference:i}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:s,ymax:n,spatialReference:o}=this,l=this.width,u=this.xmin,d=this.xmax;let p;t=t||Kr(o);const[f,m]=t.valid;p=W1(this.xmin,t);const y=p.x,g=p.frameId;p=W1(this.xmax,t);const v=p.x,_=p.frameId,S=y===v&&l>0;if(l>2*m){const M=new Cs(u<d?y:v,s,m,n,o),C=new Cs(f,s,u<d?v:y,n,o),T=new Cs(0,s,m,n,o),O=new Cs(f,s,0,n,o),P=[],D=[];M.contains(T)&&P.push(g),M.contains(O)&&D.push(g),C.contains(T)&&P.push(_),C.contains(O)&&D.push(_);for(let z=g+1;z<_;z++)P.push(z),D.push(z);e.push({extent:M,frameIds:[g]},{extent:C,frameIds:[_]},{extent:T,frameIds:P},{extent:O,frameIds:D})}else y>v||S?e.push({extent:new Cs(y,s,m,n,o),frameIds:[g]},{extent:new Cs(f,s,v,n,o),frameIds:[_]}):e.push({extent:new Cs(y,s,v,n,o),frameIds:[g]});this.cache._parts=e}const r=this.hasZ,i=this.hasM;if(r||i){const s={};r&&(s.zmin=this.zmin,s.zmax=this.zmax),i&&(s.mmin=this.mmin,s.mmax=this.mmax);for(let n=0;n<e.length;n++)e[n].extent.set(s)}return e}};function W1(t,e){const[r,i]=e.valid,s=2*i;let n,o=0;return t>i?(n=Math.ceil(Math.abs(t-i)/s),t-=n*s,o=n):t<r&&(n=Math.ceil(Math.abs(t-r)/s),t+=n*s,o=-n),{x:t,frameId:o}}a([c({readOnly:!0})],he.prototype,"cache",null),a([c({readOnly:!0})],he.prototype,"center",null),a([c({readOnly:!0})],he.prototype,"extent",null),a([c({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],he.prototype,"hasM",null),a([c({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],he.prototype,"hasZ",null),a([c({readOnly:!0})],he.prototype,"height",null),a([c({readOnly:!0})],he.prototype,"width",null),a([c({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],he.prototype,"xmin",void 0),a([c({type:Number,json:{write:!0}})],he.prototype,"ymin",void 0),a([c({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],he.prototype,"mmin",void 0),a([c({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],he.prototype,"zmin",void 0),a([c({type:Number,json:{write:!0}})],he.prototype,"xmax",void 0),a([c({type:Number,json:{write:!0}})],he.prototype,"ymax",void 0),a([c({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],he.prototype,"mmax",void 0),a([c({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],he.prototype,"zmax",void 0),he=Cs=a([b("esri.geometry.Extent")],he),he.prototype.toJSON.isDefaultToJSON=!0;let jf;const fH=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,G_=globalThis.document?.documentElement;function uF(){const t=G_?.getAttribute("lang"),e=globalThis.navigator?.language;return fH??t??e??"en"}function vi(){return jf===void 0&&(jf=uF()),jf}const mH=/^(?<language>[a-z]{2,3})(?:-(?<extlang>[a-z]{3}))?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function GT(t=vi()){return dF(t)?.language}function cF(t=vi()){const e=dF(t);return e?.language&&e?.extlang?t.replace(`${e.language}-`,""):t}function dF(t=vi()){return mH.exec(t)?.groups}const Vg=[];function hF(t){return Vg.push(t),Te(()=>{Vg.splice(Vg.indexOf(t),1)})}const zg=[];function BT(t){return zg.push(t),Te(()=>zg.splice(zg.indexOf(t),1))}function tE(){const t=uF();jf!==t&&([...zg].forEach(e=>e(t)),jf=t,[...Vg].forEach(e=>e(t)))}globalThis.addEventListener?.("languagechange",tE),G_&&new MutationObserver(()=>{tE()}).observe(G_,{attributeFilter:["lang"]});let Ay;function yH(t){return Ay&&!Ay.destroyed||(Ay=t()),Ay}var B_;const gH=new $e({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let vt=B_=class extends X{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new B_({categories:this.categories?E(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let r=[];this.categories&&(r=this.categories.map(o=>Array.isArray(o)?JSON.stringify(o):o));let i="";if(this.extent){const o=Ow(this.extent,Z.WGS84);o!=null&&(i=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let s=this.query;!this.disableExtraQuery&&t.extraQuery&&(s="("+s+")"+t.extraQuery);const n={categories:r,bbox:i,q:s,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(n.sortField=this.sortField.split(",").map(o=>gH.toJSON(o.trim())).join(","),n.sortOrder=this.sortOrder),{query:{...e,...n}}}};a([c()],vt.prototype,"categories",void 0),a([c()],vt.prototype,"disableExtraQuery",void 0),a([c({type:he})],vt.prototype,"extent",void 0),a([c()],vt.prototype,"filter",void 0),a([c()],vt.prototype,"num",void 0),a([c()],vt.prototype,"query",void 0),a([c()],vt.prototype,"sortField",void 0),a([c()],vt.prototype,"sortOrder",null),a([c()],vt.prototype,"start",void 0),vt=B_=a([b("esri.portal.PortalQueryParams")],vt);var H_;let mt=H_=class extends F{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e&&this.portal?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.portal?.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then(e=>{const r=e.categorySchema||[];return r.some(i=>i.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):r})}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new x("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new H_({sourceJSON:t});return e.read(t),e}queryItems(t,e){let r=ct(vt,t);const i=this.portal;return parseFloat(i.currentVersion)>5?(r=r||new vt,i.queryPortal(`/content/groups/${this.id}/search`,r,"PortalItem",e)):(r=r?r.clone():new vt,r.query="group:"+this.id+(r.query?" "+r.query:""),i.queryItems(r,e))}_fetchCategorySchemaSet(t,e){const r=this.portal;return r.fetchSelf(r.authMode,!0,e).then(i=>{const s=i.contentCategorySetsGroupQuery;if(s){const n=new vt({disableExtraQuery:!0,num:1,query:s});return r.queryGroups(n,e)}throw new x("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(i=>{if(i.total){const s=i.results[0],n=new vt({num:1,query:`typekeywords:"${t}"`});return s.queryItems(n,e)}throw new x("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(i=>i.total?i.results[0].fetchData("json",e).then(s=>{const n=s?.categorySchema;return n?.length?n:[]}):[])}};a([c()],mt.prototype,"access",void 0),a([c({type:Date})],mt.prototype,"created",void 0),a([c()],mt.prototype,"description",void 0),a([c()],mt.prototype,"id",void 0),a([c()],mt.prototype,"isInvitationOnly",void 0),a([c({type:Date})],mt.prototype,"modified",void 0),a([c()],mt.prototype,"owner",void 0),a([c()],mt.prototype,"portal",void 0),a([c()],mt.prototype,"snippet",void 0),a([c()],mt.prototype,"sortField",void 0),a([c()],mt.prototype,"sortOrder",void 0),a([c()],mt.prototype,"sourceJSON",void 0),a([c()],mt.prototype,"tags",void 0),a([c()],mt.prototype,"thumbnail",void 0),a([c({readOnly:!0})],mt.prototype,"thumbnailUrl",null),a([c()],mt.prototype,"title",void 0),a([c({readOnly:!0})],mt.prototype,"url",null),mt=H_=a([b("esri.portal.PortalGroup")],mt);let Tl=class extends X{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};a([c()],Tl.prototype,"nextQueryParams",void 0),a([c()],Tl.prototype,"queryParams",void 0),a([c()],Tl.prototype,"results",void 0),a([c()],Tl.prototype,"total",void 0),Tl=a([b("esri.portal.PortalQueryResult")],Tl);let Yn=class extends F{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.portal?.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new x("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};a([c({type:Date})],Yn.prototype,"created",void 0),a([c()],Yn.prototype,"id",void 0),a([c()],Yn.prototype,"portal",void 0),a([c()],Yn.prototype,"title",void 0),a([c({readOnly:!0})],Yn.prototype,"url",null),a([c()],Yn.prototype,"username",void 0),Yn=a([b("esri.portal.PortalFolder")],Yn);var W_;let Ve=W_=class extends F{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.id=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.id}`:null}get url(){const t=this.portal?.restUrl;return t?`${t}/community/users/${this.id}`:null}addItem(t){const e=t&&t.item,r=t?.data,i=t?.folder,s={method:"post"};e&&(s.query=e.createPostQuery(),r!=null&&(typeof r=="string"?s.query.text=r:typeof r=="object"&&(s.query.text=JSON.stringify(r))));let n=this.userContentUrl;return i&&(n+="/"+(typeof i=="string"?i:i.id)),this.portal.request(n+"/addItem",s).then(o=>(e.id=o.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}async deleteItem(t,e=!1){let r=this.userContentUrl;t.ownerFolder&&(r+="/"+t.ownerFolder);const i=e?{permanentDelete:!0}:{};await this.portal.request(r+`/items/${t.id}/delete`,{method:"post",query:i}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const r=this.userContentUrl+"/deleteItems",i=[],s=t.map(n=>n.id);if(s.length){const n={method:"post",query:{items:s.join(","),permanentDelete:e}},o=await this.portal.request(r,n);for(const l of o.results){const u=t.find(f=>l.itemId===f.id),d=l.success;let p=null;d?(u.id=null,u.portal=null):l.error&&(p=new x("portal:delete-item-failed",l.error.message,l.error)),i.push({item:u,success:d,error:p})}}return i}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let r;return r=e&&e.folders?e.folders.map(i=>{const s=Yn.fromJSON(i);return s.portal=this.portal,s}):[],r})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(r=>{const i=mt.fromJSON(r);return i.portal=this.portal,i}):[],e})}async fetchItems(t){t??={};let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:r}=await N(()=>Promise.resolve().then(()=>pF),void 0),i={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},s=await this.portal.request(e,{query:i});let n;return s?.items?(n=s.items.map(o=>{const l=r.fromJSON(o);return l.portal=this.portal,l}),await Promise.all(n.map(o=>o.load())),{items:n,nextStart:s.nextStart,total:s.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new mt({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new x("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const r=this.userContentUrl,i=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(r+`/items/${t.id}/restore`,{method:"post",query:i})}toJSON(){throw new x("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new W_({sourceJSON:t});return e.read(t),e}};a([c()],Ve.prototype,"access",void 0),a([c({type:Date})],Ve.prototype,"created",void 0),a([c()],Ve.prototype,"culture",void 0),a([c()],Ve.prototype,"description",void 0),a([c()],Ve.prototype,"email",void 0),a([c()],Ve.prototype,"favGroupId",void 0),a([c()],Ve.prototype,"fullName",void 0),a([c()],Ve.prototype,"id",void 0),a([c({type:Date})],Ve.prototype,"modified",void 0),a([c()],Ve.prototype,"orgId",void 0),a([c()],Ve.prototype,"portal",void 0),a([c()],Ve.prototype,"preferredView",void 0),a([c()],Ve.prototype,"privileges",void 0),a([c()],Ve.prototype,"region",void 0),a([c()],Ve.prototype,"role",void 0),a([c()],Ve.prototype,"roleId",void 0),a([c()],Ve.prototype,"sourceJSON",void 0),a([c()],Ve.prototype,"thumbnail",void 0),a([c({readOnly:!0})],Ve.prototype,"thumbnailUrl",null),a([c()],Ve.prototype,"units",void 0),a([c({readOnly:!0})],Ve.prototype,"userContentUrl",null),a([c({readOnly:!0})],Ve.prototype,"url",null),a([c()],Ve.prototype,"username",void 0),a([c()],Ve.prototype,"userLicenseTypeId",void 0),a([c()],Ve.prototype,"userType",void 0),Ve=W_=a([b("esri.portal.PortalUser")],Ve);var xi;let gp;const rE={PortalGroup:()=>Promise.resolve({default:mt}),PortalItem:()=>N(()=>Promise.resolve().then(()=>pF),void 0),PortalUser:()=>Promise.resolve({default:Ve})};var kn;let j=(kn=class extends ol(ry){constructor(e){super(e),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.g3DTilesGalleryGroupQuery=null,this.g3dTilesEnabled=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=_e.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e}destroy(){iE.unregister(this),this.defaultBasemap=Ke(this.defaultBasemap),this.defaultDevBasemap=Ke(this.defaultDevBasemap),this.defaultVectorBasemap=Ke(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=He(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const r of e)_e.request.trustedServers.includes(r)||_e.request.trustedServers.push(r);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){const e=this.user?.orgId,r=!e||this.canSearchPublic;return this.id&&!r?` AND orgid:${this.id}`:null}get hasAPIKey(){return RR(this.restUrl)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get loaded(){return super.loaded}get restUrl(){let e=this.url;if(e){const r=e.indexOf("/sharing");e=r>0?e.slice(0,r):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,r=this.thumbnail;return e&&r?this._normalizeSSL(e+"/portals/self/resources/"+r):null}readUrlKey(e){return e&&e.toLowerCase()}readUser(e){let r=null;return e&&(r=Ve.fromJSON(e),r.portal=this),r}load(e){const r=N(async()=>{const{default:i}=await Promise.resolve().then(()=>fJ);return{default:i}},void 0).then(({default:i})=>{We(e),gp=i}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,e)).then(i=>{if(!this.hasAPIKey&&Se){const s=Se;this.credential=s.findCredential(this.restUrl),this.credential||this.authMode!==xi.AUTH_MODE_AUTO&&this.authMode!==xi.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=s.on("credential-create",vH(new WeakRef(this))),iE.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(r),Promise.resolve(this)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),r=(await N(async()=>{const{default:i}=await import("./ElevationLayer-CdZNG2-p.js");return{default:i}},__vite__mapDeps([0,1,2,3,4,5]))).default;return e?e.map(i=>new r({id:i.id,url:i.url})):[]}async fetchBasemaps(e,r){const i=await this._fetchBasemaps(e,r);if(r?.include3d===!0&&this.use3dBasemaps!==!1){const s=await this._fetchBasemaps3D(e,r);i.unshift(...s)}return i}async fetchDefault3DBasemap(e){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const r=new vt;r.query=this.default3DBasemapQuery,r.disableExtraQuery=!0;const i=(await this.queryItems(r,e)).results.find(s=>s.type==="Web Scene");return i?new gp({portalItem:i}):null}fetchCategorySchema(e){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",e).then(r=>r.categorySchema):Pr(e)?Promise.reject(Fe()):Promise.resolve([])}async fetchClassificationSchema(e){return this.hasClassificationSchema?this.request(this.restUrl+"/portals/self/classification/classificationSchema",e).then(r=>r.classificationSchema):null}fetchFeaturedGroups(e){const r=this.featuredGroups,i=new vt({num:100,sortField:"title"});if(r?.length){const s=[];for(const n of r)s.push(`(title:"${n.title}" AND owner:${n.owner})`);return i.query=s.join(" OR "),this.queryGroups(i,e).then(n=>n.results)}return Pr(e)?Promise.reject(Fe()):Promise.resolve([])}fetchRegions(e){const r=this.user?.culture||this.culture||vi();return this.request(this.restUrl+"/portals/regions",{...e,query:{culture:r}})}fetchSettings(e){const r=this.user?.culture||this.culture||vi();return this.request(this.restUrl+"/portals/self/settings",{...e,query:{culture:r}})}static getDefault(){return yH(()=>new xi)}queryGroups(e,r){return this.queryPortal("/community/groups",e,"PortalGroup",r)}queryItems(e,r){return this.queryPortal("/search",e,"PortalItem",r)}queryUsers(e,r){return e.sortField||(e.sortField="username"),this.queryPortal("/community/users",e,"PortalUser",r)}fetchSelf(e=this.authMode,r=!1,i){const s=this.restUrl+"/portals/self",n={authMode:e,query:{culture:vi().toLowerCase()},withCredentials:!0,...i};return n.authMode==="auto"&&(n.authMode="no-prompt"),r&&(n.query.default=!0),this.request(s,n)}queryPortal(e,r,i,s){const n=ct(vt,r),o=l=>this.request(this.restUrl+e,{...n.toRequestOptions(this),...s}).then(u=>{const d=n.clone();return d.start=u.nextStart,new Tl({nextQueryParams:d,queryParams:n,total:u.total,results:xi._resultsToTypedArray(l,{portal:this},u,s)})}).then(u=>Promise.all(u.results.map(d=>typeof d.when=="function"?d.when():u)).then(()=>u,d=>(Mn(d),u)));return i&&rE[i]?rE[i]().then(({default:l})=>(We(s),o(l))):o()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new x("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")});if(this.authMode===xi.AUTH_MODE_ANONYMOUS||this.authMode===xi.AUTH_MODE_NO_PROMPT&&!Se)return Promise.reject(new x("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const e=r=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(r||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=r,this.fetchSelf("immediate"))):this.user&&this.credential===r?null:(this.credential=r,this.fetchSelf("immediate"))).then(i=>{i&&(this.sourceJSON=i,this.read(i))});return Se?Se.getCredential(this.restUrl,{prompt:this.authMode!==xi.AUTH_MODE_NO_PROMPT}).then(r=>e(r)):e(this.credential)}normalizeUrl(e){const r=this.credential?.token;return this._normalizeSSL(r?e+(e.includes("?")?"&":"?")+"token="+r:e)}requestToTypedArray(e,r,i){return this.request(e,r).then(s=>{const n=xi._resultsToTypedArray(i,{portal:this},s);return Promise.all(n.map(o=>typeof o.when=="function"?o.when():s)).then(()=>n,()=>n)})}request(e,r={}){const i={f:"json",...r.query},{authMode:s=this.authMode===xi.AUTH_MODE_ANONYMOUS||this.authMode===xi.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:n=null,cacheBust:o=!1,method:l="auto",responseType:u="json",signal:d}=r,p={authMode:s,body:n,cacheBust:o,method:l,query:i,responseType:u,timeout:0,signal:d};return r.withCredentials&&(p.withCredentials=!0),Ae(this._normalizeSSL(e),p).then(f=>f.data)}toJSON(){throw new x("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new xi({sourceJSON:e})}_getHelperService(e){const r=this.helperServices?.[e];if(!r)throw new x("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return r}async _fetchBasemaps(e,r){const i=new vt;i.query=e||($_()?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0;const s=await this.queryGroups(i,r);if(!s.total)return[];const n=s.results[0];i.num=100,i.query='type:"Web Map" -type:"Web Application"',i.sortField=n.sortField||"name",i.sortOrder=n.sortOrder||"desc";const o=await n.queryItems(i,r);return o.total?o.results.filter(l=>l.type==="Web Map").map(l=>new gp({portalItem:l})):[]}async _fetchBasemaps3D(e,r){const i=e||this.basemapGalleryGroupQuery3D;if(!i)return[];if($_())return[];const s=new vt({query:i,disableExtraQuery:!0}),n=await this.queryGroups(s,r);if(!n.total)return[];const o=n.results[0];s.num=100,s.query='type:"Web Scene"',s.sortField=o.sortField||"name",s.sortOrder=o.sortOrder||"desc";const l=await o.queryItems(s,r);return l.total?l.results.filter(u=>u.type==="Web Scene").map(u=>new gp({portalItem:u})):[]}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(e){if(e){const r=gp.fromJSON(e);return r.portalItem={portal:this},r}return null}static _resultsToTypedArray(e,r,i,s){let n;if(i){const o=s!=null?s.signal:null;n=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(e||r)&&(n=n.map(l=>{const u=Object.assign(e?e.fromJSON(l):l,r);return typeof u.load=="function"&&u.load(o),u}))}else n=[];return n}},xi=kn,kn.AUTH_MODE_ANONYMOUS="anonymous",kn.AUTH_MODE_AUTO="auto",kn.AUTH_MODE_IMMEDIATE="immediate",kn.AUTH_MODE_NO_PROMPT="no-prompt",kn);a([c()],j.prototype,"access",void 0),a([c()],j.prototype,"allSSL",void 0),a([c()],j.prototype,"authMode",void 0),a([c()],j.prototype,"authorizedCrossOriginDomains",void 0),a([V("authorizedCrossOriginDomains")],j.prototype,"readAuthorizedCrossOriginDomains",null),a([c()],j.prototype,"basemapGalleryGroupQuery",void 0),a([c({json:{name:"3DBasemapGalleryGroupQuery"}})],j.prototype,"basemapGalleryGroupQuery3D",void 0),a([c({json:{name:"g3DTilesGalleryGroupQuery"}})],j.prototype,"g3DTilesGalleryGroupQuery",void 0),a([c({json:{name:"g3dTilesEnabled"}})],j.prototype,"g3dTilesEnabled",void 0),a([c()],j.prototype,"bingKey",void 0),a([c()],j.prototype,"canListApps",void 0),a([c()],j.prototype,"canListData",void 0),a([c()],j.prototype,"canListPreProvisionedItems",void 0),a([c()],j.prototype,"canProvisionDirectPurchase",void 0),a([c()],j.prototype,"canSearchPublic",void 0),a([c()],j.prototype,"canShareBingPublic",void 0),a([c()],j.prototype,"canSharePublic",void 0),a([c()],j.prototype,"canSignInArcGIS",void 0),a([c()],j.prototype,"canSignInIDP",void 0),a([c()],j.prototype,"colorSetsGroupQuery",void 0),a([c()],j.prototype,"commentsEnabled",void 0),a([c({type:Date})],j.prototype,"created",void 0),a([c()],j.prototype,"credential",void 0),a([c()],j.prototype,"culture",void 0),a([c()],j.prototype,"currentVersion",void 0),a([c()],j.prototype,"customBaseUrl",void 0),a([c()],j.prototype,"default3DBasemapQuery",void 0),a([c()],j.prototype,"defaultBasemap",void 0),a([V("defaultBasemap")],j.prototype,"readDefaultBasemap",null),a([c()],j.prototype,"defaultDevBasemap",void 0),a([V("defaultDevBasemap")],j.prototype,"readDefaultDevBasemap",null),a([c({type:he})],j.prototype,"defaultExtent",void 0),a([c()],j.prototype,"defaultVectorBasemap",void 0),a([V("defaultVectorBasemap")],j.prototype,"readDefaultVectorBasemap",null),a([c()],j.prototype,"description",void 0),a([c()],j.prototype,"devBasemapGalleryGroupQuery",void 0),a([c()],j.prototype,"eueiEnabled",void 0),a([c({readOnly:!0})],j.prototype,"extraQuery",null),a([c()],j.prototype,"featuredGroups",void 0),a([c()],j.prototype,"featuredItemsGroupQuery",void 0),a([c()],j.prototype,"galleryTemplatesGroupQuery",void 0),a([c()],j.prototype,"layoutGroupQuery",void 0),a([c()],j.prototype,"livingAtlasGroupQuery",void 0),a([c({readOnly:!0})],j.prototype,"hasAPIKey",null),a([c()],j.prototype,"hasCategorySchema",void 0),a([c()],j.prototype,"hasClassificationSchema",void 0),a([c()],j.prototype,"helpBase",void 0),a([c()],j.prototype,"helperServices",void 0),a([c()],j.prototype,"helpMap",void 0),a([c()],j.prototype,"homePageFeaturedContent",void 0),a([c()],j.prototype,"homePageFeaturedContentCount",void 0),a([c()],j.prototype,"httpPort",void 0),a([c()],j.prototype,"httpsPort",void 0),a([c()],j.prototype,"id",void 0),a([c()],j.prototype,"ipCntryCode",void 0),a([c({readOnly:!0})],j.prototype,"isOrganization",null),a([c()],j.prototype,"isPortal",void 0),a([c()],j.prototype,"isReadOnly",void 0),a([c({readOnly:!0})],j.prototype,"itemPageUrl",null),a([c()],j.prototype,"layerTemplatesGroupQuery",void 0),a([c()],j.prototype,"maxTokenExpirationMinutes",void 0),a([c({type:Date})],j.prototype,"modified",void 0),a([c()],j.prototype,"name",void 0),a([c()],j.prototype,"portalHostname",void 0),a([c()],j.prototype,"portalMode",void 0),a([c()],j.prototype,"portalProperties",void 0),a([c()],j.prototype,"region",void 0),a([c()],j.prototype,"recycleBinEnabled",void 0),a([c({readOnly:!0})],j.prototype,"restUrl",null),a([c()],j.prototype,"rotatorPanels",void 0),a([c()],j.prototype,"showHomePageDescription",void 0),a([c()],j.prototype,"sourceJSON",void 0),a([c()],j.prototype,"staticImagesUrl",void 0),a([c({json:{name:"2DStylesGroupQuery"}})],j.prototype,"stylesGroupQuery2d",void 0),a([c({json:{name:"stylesGroupQuery"}})],j.prototype,"stylesGroupQuery3d",void 0),a([c()],j.prototype,"supportsHostedServices",void 0),a([c()],j.prototype,"symbolSetsGroupQuery",void 0),a([c()],j.prototype,"templatesGroupQuery",void 0),a([c()],j.prototype,"thumbnail",void 0),a([c({readOnly:!0})],j.prototype,"thumbnailUrl",null),a([c()],j.prototype,"units",void 0),a([c()],j.prototype,"url",void 0),a([c()],j.prototype,"urlKey",void 0),a([V("urlKey")],j.prototype,"readUrlKey",null),a([c()],j.prototype,"user",void 0),a([V("user")],j.prototype,"readUser",null),a([c()],j.prototype,"use3dBasemaps",void 0),a([c()],j.prototype,"useDefault3dBasemap",void 0),a([c()],j.prototype,"useStandardizedQuery",void 0),a([c()],j.prototype,"useVectorBasemaps",void 0),a([c()],j.prototype,"vectorBasemapGalleryGroupQuery",void 0),j=xi=a([b("esri.portal.Portal")],j);const iE=new FinalizationRegistry(t=>{t.remove()});function vH(t){const e=Se;return()=>{const r=t.deref();r&&e.findCredential(r.restUrl)&&r.signIn().catch(()=>{})}}let Kn=class extends X{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e?.portalItem&&e.path?{...e,path:sE(e.path,e.portalItem)}:e}set path(e){e!=null&&gi(e)?L.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return sE(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",r){const i=this.cdnUrl;if(i==null)throw new x("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(i,{responseType:e,query:{token:this.portalItem.apiKey,_ts:r?.cacheBust?Date.now():null},signal:r?.signal})}async update(e,r){const{addOrUpdateResources:i}=await N(()=>import("./resourceUtils-ISzE8cZD.js"),[]);return await i(this.portalItem,[{resource:this,content:e,compress:r?.compress,access:r?.access}],"update",r),this}hasPath(){return this.path!=null}};function sE(t,e){return t==null?t:(t=t.replace(/^\/+/,""),e!=null&&gi(t)&&(t=dT(t,e.itemUrl)),t?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}a([c()],Kn.prototype,"portalItem",void 0),a([c({type:String,value:null})],Kn.prototype,"path",null),a([Ce("path")],Kn.prototype,"_castPath",null),a([c({type:String,readOnly:!0})],Kn.prototype,"url",null),a([c({type:String,readOnly:!0})],Kn.prototype,"cdnUrl",null),a([c({type:String,readOnly:!0})],Kn.prototype,"itemRelativeUrl",null),Kn=a([b("esri.portal.PortalItemResource")],Kn);let ru=class extends X{constructor(e){super(e),this.created=null,this.rating=null}};a([c({type:Date})],ru.prototype,"created",void 0),a([c()],ru.prototype,"rating",void 0),ru=a([b("esri.portal.PortalRating")],ru);var Ml;const wH=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Knowledge Graph Layer","Map Service","Media Layer","Scene Service","Stream Service","Video Service","Vector Tile Service","WCS","WFS","WMS","WMTS"]),bH=new Set(["KML","GeoJson","CSV"]);let de=Ml=class extends ol(ry){static from(t){return Zh(Ml,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let r=t;return t==="Feature Service"||t==="Feature Collection"?r=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?r=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?r="Scene Layer":t==="Video Service"?r="Video Layer":t==="Scene Package"?r="Scene Layer Package":t==="Stream Service"?r="Feature Layer":t==="Geoprocessing Service"?r=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geoenrichment Service"?r="GeoEnrichment Service":t==="Geocoding Service"?r="Locator":t==="Microsoft Powerpoint"?r="Microsoft PowerPoint":t==="GeoJson"?r="GeoJSON":t==="Globe Service"?r="Globe Layer":t==="Vector Tile Service"?r="Tile Layer":t==="netCDF"?r="NetCDF":t==="Map Service"?r=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t?.toLowerCase().includes("add in")?r=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?r="Big Data File Share":t==="Compact Tile Package"?r="Tile Package (tpkx)":t==="Raster function template"?r="Raster Function Template":t==="OGCFeatureServer"?r="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?r="Instant App":t==="Insights Page"?r="Insights Report":t==="Excalibur Imagery Project"?r="Excalibur Project":t==="3DTiles Service"?r="3D tiles layer":t==="3DTiles Package"&&(r="3D tiles package"),r}readExtent(t){return t&&t.length?new he(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type?.toLowerCase()||"",e=this.typeKeywords||[],r="esri/images/portal/",i="16";let s,n=!1,o=!1,l=!1,u=!1,d=!1,p=!1,f=!1,m=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(n=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(o=e.includes("Table"),l=e.includes("Route Layer"),u=e.includes("Markup"),d=e.includes("Spatiotemporal"),p=e.includes("UtilityNetwork"),s=d&&o?"spatiotemporaltable":o?"table":l?"routelayer":u?"markup":d?"spatiotemporal":p?"utilitynetwork":n?"featureshosted":"features"):t==="map service"||t==="wms"||t==="wmts"?(d=e.includes("Spatiotemporal"),f=e.includes("Relational"),s=d||f?"mapimages":n||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages"):s=t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":t==="3dtiles service"?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":e.includes("GaussianSplat")?"gaussiansplatlayer":"3dtileslayer":"layers"):t==="web map"||t==="cityengine web scene"?s="maps":t==="web scene"?s=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?s="instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?s="apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?s="mapsgray":t==="service definition"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?s="datafiles":t==="360 vr experience"?s="360vr":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?s="appsgray":t==="arcgis pro add in"||t==="arcgis pro configuration"?s="addindesktop":t==="pdf"?s="pdf":t==="microsoft word"?s="word":t==="microsoft excel"?s="excel":t==="microsoft powerpoint"?s="ppt":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?s="datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?s="toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?s="layersgray":t==="analysis model"?s="analysismodel":t==="scene package"?s="scenepackage":t==="3dtiles package"?s="3dtileslayerpackage":t==="3dtiles service"?s="3dtileslayer":t==="mobile scene package"?s="mobilescenepackage":t==="tile package"||t==="compact tile package"?s="tilepackage":t==="task file"?s="taskfile":t==="report template"?s="report-template":t==="statistical data collection"?s="statisticaldatacollection":t==="insights workbook"?s="workbook":t==="insights model"?s="insightsmodel":t==="insights page"?s="insightspage":t==="insights theme"?s="insightstheme":t==="hub initiative"?s="hubinitiative":t==="hub page"?s="hubpage":t==="hub site application"?s="hubsite":t==="hub event"?s="hubevent":t==="hub project"?s="hubproject":t==="relational database connection"?s="relationaldatabaseconnection":t==="big data file share"?s="datastorecollection":t==="image collection"?s="imagecollection":t==="desktop style"?s="desktopstyle":t==="style"?s=e.includes("Dictionary")?"dictionarystyle":"style":t==="dashboard"?s="dashboard":t==="raster function template"?s="rasterprocessingtemplate":t==="vector tile package"?s="vectortilepackage":t==="ortho mapping project"?s="orthomappingproject":t==="ortho mapping template"?s="orthomappingtemplate":t==="solution"?s="solutions":t==="geopackage"?s="geopackage":t==="deep learning package"?s="deeplearningpackage":t==="real time analytic"?s="realtimeanalytics":t==="reality mapping project"?s="realitymappingproject":t==="big data analytic"?s="bigdataanalytics":t==="feed"?s="feed":t==="excalibur imagery project"?s="excaliburimageryproject":t==="notebook"?s="notebook":t==="storymap"?s="storymap":t==="survey123 add in"?s="survey123addin":t==="mission"?s="mission":t==="mission report"?s="missionreport":t==="mission template"?s="missiontemplate":t==="quickcapture project"?s="quickcaptureproject":t==="pro report"?s="proreport":t==="pro report template"?s="proreporttemplate":t==="urban model"?s="urbanmodel":t==="urban project"?s="urbanproject":t==="web experience"?s="experiencebuilder":t==="web experience template"?s="webexperiencetemplate":t==="experience builder widget"?s="experiencebuilderwidget":t==="experience builder widget package"?s="experiencebuilderwidgetpackage":t==="workflow"?s="workflow":t==="kernel gateway connection"?s="kernelgatewayconnection":t==="insights script"?s="insightsscript":t==="hub initiative template"?s="hubinitiativetemplate":t==="storymap theme"?s="storymaptheme":t==="knowledge graph"?s="knowledgegraph":t==="knowledge graph layer"?s="knowledgegraphlayer":t==="knowledge studio project"?s="knowledgestudio":t==="native application"?s="nativeapp":t==="native application installer"?s="nativeappinstaller":t==="web link chart"?s="linkchart":t==="knowledge graph web investigation"?s="investigation":t==="ogcfeatureserver"?s="features":t==="pro presentation"?s="propresentation":t==="pro project"?s="proproject":t==="insights workbook package"?s="insightsworkbookpackage":t==="apache parquet"?s="apacheparquet":t==="notebook code snippet library"?s="notebookcodesnippets":t==="suitability model"?s="suitabilitymodel":t==="esri classifier definition"?s="classifierdefinition":t==="esri classification schema"?s="classificationschema":t==="insights data engineering workbook"?s="dataengineeringworkbook":t==="insights data engineering model"?s="dataengineeringmodel":t==="deep learning studio project"?s="deeplearningproject":t==="discussion"?s="discussion":t==="allsource project"?s="allsourceproject":t==="api key"?s="apikey":t==="data pipeline"?s="datapipelines":t==="group layer"?(m=e.includes("Map"),s=m?"layergroup2d":"layergroup"):s=t==="media layer"?"onlinemedialayer":t==="form"?e.includes("Survey123")?"survey":"datafilesgray":t==="csv"?"csv":t==="image"?"image":t==="xr experience"?"xrexperience":"maps",s?ot(r+s+i+".png"):null}get isLayer(){return this.type!=null&&wH.has(this.type)}get itemCdnUrl(){return vT(this.itemUrl)}get itemPageUrl(){const t=this.portal?.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){const t=this.portal?.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get loaded(){return super.loaded}get thumbnailUrl(){const t=this.itemUrl,e=this.thumbnail;return t&&e?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`)??null:null}get userItemUrl(){const t=this.portal?.restUrl;if(!t)return null;const e=this.owner||this.portal?.user?.id;return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=j.getDefault()),r=e.load(t).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{}).then(i=>{this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(r),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}},r=t instanceof ru?t.rating:t;return r==null||isNaN(r)||typeof t!="number"||(e.query.rating=r),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new ru({rating:r,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:E(this.applicationProxies),avgRating:this.avgRating,categories:E(this.categories),classification:E(this.classification),created:E(this.created),culture:this.culture,description:this.description,extent:E(this.extent),groupCategories:E(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:E(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:E(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:E(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:E(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new Ml({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){const t=this.toJSON();for(const e of["tags","typeKeywords","categories"])t[e]=t[e]?.join(", ");for(const e of["extent","classification"]){const r=t[e];r&&(t[e]=JSON.stringify(r))}return t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new ru(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},Ml)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.applicationProxies&&!Object.hasOwn(t,"appProxies")&&(this.applicationProxies=null),this.sourceJSON=t,this.read(t),this))}update(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t?.data,r={method:"post"};r.query=this.createPostQuery();for(const i in r.query)r.query[i]===null&&(r.query[i]="");return r.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?r.query.text=e:typeof e=="object"&&(r.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,r).then(()=>this.reload())}):Promise.reject(new x("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new x("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:r}=this;await e.signIn();const{copyResources:i,folder:s,tags:n,title:o}=t||{},l={method:"post",query:{copyPrivateResources:i==="all",folder:typeof s=="string"?s:s?.id,includeResources:!!i,tags:n?.join(","),title:o}},{itemId:u}=await e.request(`${r}/copy`,l);return new Ml({id:u,portal:e})}updateThumbnail(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t.thumbnail,r=t.filename,i={method:"post"};if(typeof e=="string")Uu(e)?i.query={data:e}:i.query={url:ls(e)},r!=null&&(i.query.filename=r);else{const s=new FormData;r!=null?s.append("file",e,r):s.append("file",e),i.body=s}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,i).then(()=>this.reload())}):Promise.reject(new x("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:r}=await N(()=>import("./resourceUtils-ISzE8cZD.js"),[]);return r(this,t,e)}async addResource(t,e,r){const{addOrUpdateResources:i}=await N(()=>import("./resourceUtils-ISzE8cZD.js"),[]);return t.portalItem=this,await i(this,[{resource:t,content:e,compress:r?.compress,access:r?.access}],"add",r),t}async removeResource(t,e){const{removeResource:r}=await N(()=>import("./resourceUtils-ISzE8cZD.js"),[]);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new x("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return r(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await N(()=>import("./resourceUtils-ISzE8cZD.js"),[]);return e(this,t)}resourceFromPath(t){return new Kn({portalItem:this,path:t})}toJSON(){const t=this.extent,e={accessInformation:this.accessInformation,categories:E(this.categories),classification:E(this.classification),created:this.created?.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:E(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:E(this.typeKeywords),url:this.url};return vU(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new Ml({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};a([c({type:["private","shared","org","public"]})],de.prototype,"access",void 0),a([c()],de.prototype,"accessInformation",void 0),a([c({type:String})],de.prototype,"apiKey",void 0),a([c({json:{read:{source:"appProxies"}}})],de.prototype,"applicationProxies",void 0),a([c()],de.prototype,"avgRating",void 0),a([c()],de.prototype,"categories",void 0),a([c()],de.prototype,"classification",void 0),a([c({type:Date})],de.prototype,"created",void 0),a([c()],de.prototype,"culture",void 0),a([c()],de.prototype,"description",void 0),a([c({readOnly:!0})],de.prototype,"displayName",null),a([c({type:he})],de.prototype,"extent",void 0),a([V("extent")],de.prototype,"readExtent",null),a([c()],de.prototype,"groupCategories",void 0),a([c({readOnly:!0})],de.prototype,"iconUrl",null),a([c()],de.prototype,"id",void 0),a([c({readOnly:!0})],de.prototype,"isLayer",null),a([c({type:Boolean,readOnly:!0})],de.prototype,"isOrgItem",void 0),a([c()],de.prototype,"itemControl",void 0),a([c({readOnly:!0})],de.prototype,"itemPageUrl",null),a([c({readOnly:!0})],de.prototype,"itemUrl",null),a([c()],de.prototype,"licenseInfo",void 0),a([c({type:Date})],de.prototype,"modified",void 0),a([c()],de.prototype,"name",void 0),a([c()],de.prototype,"numComments",void 0),a([c()],de.prototype,"numRatings",void 0),a([c()],de.prototype,"numViews",void 0),a([c()],de.prototype,"owner",void 0),a([c()],de.prototype,"ownerFolder",void 0),a([c({type:j})],de.prototype,"portal",void 0),a([c()],de.prototype,"screenshots",void 0),a([c()],de.prototype,"size",void 0),a([c()],de.prototype,"snippet",void 0),a([c()],de.prototype,"sourceJSON",void 0),a([c({type:String})],de.prototype,"sourceUrl",void 0),a([c({type:String})],de.prototype,"spatialReference",void 0),a([c()],de.prototype,"tags",void 0),a([c()],de.prototype,"thumbnail",void 0),a([c({readOnly:!0})],de.prototype,"thumbnailUrl",null),a([c()],de.prototype,"title",void 0),a([c()],de.prototype,"type",void 0),a([c()],de.prototype,"typeKeywords",void 0),a([c({type:String,json:{read(t,e){if(bH.has(e.type)){const r=this.portal?.restUrl;t||=r&&this.id?`${r}/content/items/${this.id}/data`:null}return t}}})],de.prototype,"url",void 0),a([c({readOnly:!0})],de.prototype,"userItemUrl",null),de=Ml=a([b("esri.portal.PortalItem")],de);const pF=Object.freeze(Object.defineProperty({__proto__:null,get default(){return de}},Symbol.toStringTag,{value:"Module"})),fF={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,nn:"no",pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function _H(t){return t in fF}function nE(t){if(_H(t)){const e=fF[t];return e===!0?t:e}return null}const qp=[],xd=new Map;function oE(t){for(const e of xd.keys())gF(t.pattern,e)&&xd.delete(e)}function SH(t){return qp.includes(t)||(oE(t),qp.unshift(t)),Te(()=>{const e=qp.indexOf(t);e>-1&&(qp.splice(e,1),oE(t))})}async function mF(t){const e=vi();xd.has(t)||xd.set(t,$H(t,e));const r=xd.get(t);return r&&await xH.add(r),r}function yF(t){const e=GT(t);return e?nE(t)??nE(e):null}async function $H(t,e){const r=[];for(const i of qp)if(gF(i.pattern,t))try{return await i.fetchMessageBundle(t,e)}catch(s){r.push(s)}throw r.length?new x("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:r}):new x("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function gF(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}BT(()=>{xd.clear()});const xH=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=bi())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function TH(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,r=await mF("esri/t9n/basemaps");return r[t]||r[e]}const Z_={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return ot("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return ot("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return ot("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-hillshade",url:"https://services.arcgisonline.com/ArcGIS/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1},{id:"terrain-base",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/33064a20de0c48d2bb61efa8faca93a8/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Terrain Base"},{id:"terrain-reference",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/14fbc125ccc9488888b014db09f35f67/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Reference Reference",isReference:!0}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return ot("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/94329802cbfa44a18f423e6f1a0b875c/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return ot("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return ot("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return ot("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return ot("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return ot("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return ot("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return ot("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return ot("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return ot("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return ot("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return ot("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return ot("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Buildings_v1/SceneServer",itemId:"cd33b09dde0a419c986ca1a78a5fc06d",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return ot("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]}},rn="system",Ka="unknown",Qa="UTC",MH=Intl.DateTimeFormat().resolvedOptions().timeZone,aE=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class Hu extends Error{}class IH extends Hu{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class EH extends Hu{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class OH extends Hu{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class dd extends Hu{}class vF extends Hu{constructor(e){super(`Invalid unit ${e}`)}}class xr extends Hu{}class ea extends Hu{constructor(){super("Zone is an abstract class")}}const J="numeric",sn="short",zi="long",Tv={year:J,month:J,day:J},wF={year:J,month:sn,day:J},kH={year:J,month:sn,day:J,weekday:sn},bF={year:J,month:zi,day:J},_F={year:J,month:zi,day:J,weekday:zi},SF={hour:J,minute:J},$F={hour:J,minute:J,second:J},xF={hour:J,minute:J,second:J,timeZoneName:sn},TF={hour:J,minute:J,second:J,timeZoneName:zi},MF={hour:J,minute:J,hourCycle:"h23"},IF={hour:J,minute:J,second:J,hourCycle:"h23"},EF={hour:J,minute:J,second:J,hourCycle:"h23",timeZoneName:sn},OF={hour:J,minute:J,second:J,hourCycle:"h23",timeZoneName:zi},kF={year:J,month:J,day:J,hour:J,minute:J},CF={year:J,month:J,day:J,hour:J,minute:J,second:J},PF={year:J,month:sn,day:J,hour:J,minute:J},AF={year:J,month:sn,day:J,hour:J,minute:J,second:J},CH={year:J,month:sn,day:J,weekday:sn,hour:J,minute:J},RF={year:J,month:zi,day:J,hour:J,minute:J,timeZoneName:sn},LF={year:J,month:zi,day:J,hour:J,minute:J,second:J,timeZoneName:sn},FF={year:J,month:zi,day:J,weekday:zi,hour:J,minute:J,timeZoneName:zi},NF={year:J,month:zi,day:J,weekday:zi,hour:J,minute:J,second:J,timeZoneName:zi};class Wu{get type(){throw new ea}get name(){throw new ea}get ianaName(){return this.name}get isUniversal(){throw new ea}offsetName(e,r){throw new ea}formatOffset(e,r){throw new ea}offset(e){throw new ea}equals(e){throw new ea}get isValid(){throw new ea}}let Z1=null;class Cw extends Wu{static get instance(){return Z1===null&&(Z1=new Cw),Z1}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:r,locale:i}){return ZF(e,r,i)}formatOffset(e,r){return Vf(this.offset(e),r)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}const J_=new Map;function PH(t){let e=J_.get(t);return e===void 0&&(e=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),J_.set(t,e)),e}const AH={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function RH(t,e){const r=t.format(e).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(r),[,s,n,o,l,u,d,p]=i;return[o,s,n,l,u,d,p]}function LH(t,e){const r=t.formatToParts(e),i=[];for(let s=0;s<r.length;s++){const{type:n,value:o}=r[s],l=AH[n];n==="era"?i[l]=o:me(l)||(i[l]=parseInt(o,10))}return i}const J1=new Map;class _i extends Wu{static create(e){let r=J1.get(e);return r===void 0&&J1.set(e,r=new _i(e)),r}static resetCache(){J1.clear(),J_.clear()}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=_i.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:r,locale:i}){return ZF(e,r,i,this.name)}formatOffset(e,r){return Vf(this.offset(e),r)}offset(e){if(!this.valid)return NaN;const r=new Date(e);if(isNaN(r))return NaN;const i=PH(this.name);let[s,n,o,l,u,d,p]=i.formatToParts?LH(i,r):RH(i,r);l==="BC"&&(s=-Math.abs(s)+1);const m=Aw({year:s,month:n,day:o,hour:u===24?0:u,minute:d,second:p,millisecond:0});let y=+r;const g=y%1e3;return y-=g>=0?g:1e3+g,(m-y)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let lE={};function FH(t,e={}){const r=JSON.stringify([t,e]);let i=lE[r];return i||(i=new Intl.ListFormat(t,e),lE[r]=i),i}const Y_=new Map;function K_(t,e={}){const r=JSON.stringify([t,e]);let i=Y_.get(r);return i===void 0&&(i=new Intl.DateTimeFormat(t,e),Y_.set(r,i)),i}const Q_=new Map;function NH(t,e={}){const r=JSON.stringify([t,e]);let i=Q_.get(r);return i===void 0&&(i=new Intl.NumberFormat(t,e),Q_.set(r,i)),i}const X_=new Map;function DH(t,e={}){const{base:r,...i}=e,s=JSON.stringify([t,i]);let n=X_.get(s);return n===void 0&&(n=new Intl.RelativeTimeFormat(t,e),X_.set(s,n)),n}let Gp=null;function jH(){return Gp||(Gp=new Intl.DateTimeFormat().resolvedOptions().locale,Gp)}const eS=new Map;function DF(t){let e=eS.get(t);return e===void 0&&(e=new Intl.DateTimeFormat(t).resolvedOptions(),eS.set(t,e)),e}const tS=new Map;function VH(t){let e=tS.get(t);if(!e){const r=new Intl.Locale(t);e="getWeekInfo"in r?r.getWeekInfo():r.weekInfo,"minimalDays"in e||(e={...jF,...e}),tS.set(t,e)}return e}function zH(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const r=t.indexOf("-u-");if(r===-1)return[t];{let i,s;try{i=K_(t).resolvedOptions(),s=t}catch{const u=t.substring(0,r);i=K_(u).resolvedOptions(),s=u}const{numberingSystem:n,calendar:o}=i;return[s,n,o]}}function UH(t,e,r){return(r||e)&&(t.includes("-u-")||(t+="-u"),r&&(t+=`-ca-${r}`),e&&(t+=`-nu-${e}`)),t}function qH(t){const e=[];for(let r=1;r<=12;r++){const i=Y.utc(2009,r,1);e.push(t(i))}return e}function GH(t){const e=[];for(let r=1;r<=7;r++){const i=Y.utc(2016,11,13+r);e.push(t(i))}return e}function Ry(t,e,r,i){const s=t.listingMode();return s==="error"?null:s==="en"?r(e):i(e)}function BH(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||DF(t.locale).numberingSystem==="latn"}class HH{constructor(e,r,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;const{padTo:s,floor:n,...o}=i;if(!r||Object.keys(o).length>0){const l={useGrouping:!1,...i};i.padTo>0&&(l.minimumIntegerDigits=i.padTo),this.inf=NH(e,l)}}format(e){if(this.inf){const r=this.floor?Math.floor(e):e;return this.inf.format(r)}else{const r=this.floor?Math.floor(e):YT(e,3);return At(r,this.padTo)}}}class WH{constructor(e,r,i){this.opts=i,this.originalZone=void 0;let s;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),l=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&_i.create(l).valid?(s=l,this.dt=e):(s="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,s=e.zone.name):(s="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const n={...this.opts};n.timeZone=n.timeZone||s,this.dtf=K_(r,n)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(r=>{if(r.type==="timeZoneName"){const i=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...r,value:i}}else return r}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class ZH{constructor(e,r,i){this.opts={style:"long",...i},!r&&HF()&&(this.rtf=DH(e,i))}format(e,r){return this.rtf?this.rtf.format(e,r):yW(r,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,r){return this.rtf?this.rtf.formatToParts(e,r):[]}}const jF={firstDay:1,minimalDays:4,weekend:[6,7]};class ze{static fromOpts(e){return ze.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,r,i,s,n=!1){const o=e||wt.defaultLocale,l=o||(n?"en-US":jH()),u=r||wt.defaultNumberingSystem,d=i||wt.defaultOutputCalendar,p=iS(s)||wt.defaultWeekSettings;return new ze(l,u,d,p,o)}static resetCache(){Gp=null,Y_.clear(),Q_.clear(),X_.clear(),eS.clear(),tS.clear()}static fromObject({locale:e,numberingSystem:r,outputCalendar:i,weekSettings:s}={}){return ze.create(e,r,i,s)}constructor(e,r,i,s,n){const[o,l,u]=zH(e);this.locale=o,this.numberingSystem=r||l||null,this.outputCalendar=i||u||null,this.weekSettings=s,this.intl=UH(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=BH(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),r=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&r?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:ze.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,iS(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,r=!1){return Ry(this,e,KF,()=>{const i=this.intl==="ja"||this.intl.startsWith("ja-");r&=!i;const s=r?{month:e,day:"numeric"}:{month:e},n=r?"format":"standalone";if(!this.monthsCache[n][e]){const o=i?l=>this.dtFormatter(l,s).format():l=>this.extract(l,s,"month");this.monthsCache[n][e]=qH(o)}return this.monthsCache[n][e]})}weekdays(e,r=!1){return Ry(this,e,e5,()=>{const i=r?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},s=r?"format":"standalone";return this.weekdaysCache[s][e]||(this.weekdaysCache[s][e]=GH(n=>this.extract(n,i,"weekday"))),this.weekdaysCache[s][e]})}meridiems(){return Ry(this,void 0,()=>t5,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Y.utc(2016,11,13,9),Y.utc(2016,11,13,19)].map(r=>this.extract(r,e,"dayperiod"))}return this.meridiemCache})}eras(e){return Ry(this,e,r5,()=>{const r={era:e};return this.eraCache[e]||(this.eraCache[e]=[Y.utc(-40,1,1),Y.utc(2017,1,1)].map(i=>this.extract(i,r,"era"))),this.eraCache[e]})}extract(e,r,i){const s=this.dtFormatter(e,r),n=s.formatToParts(),o=n.find(l=>l.type.toLowerCase()===i);return o?o.value:null}numberFormatter(e={}){return new HH(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,r={}){return new WH(e,this.intl,r)}relFormatter(e={}){return new ZH(this.intl,this.isEnglish(),e)}listFormatter(e={}){return FH(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||DF(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:WF()?VH(this.locale):jF}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let Y1=null;class Lt extends Wu{static get utcInstance(){return Y1===null&&(Y1=new Lt(0)),Y1}static instance(e){return e===0?Lt.utcInstance:new Lt(e)}static parseSpecifier(e){if(e){const r=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r)return new Lt(Rw(r[1],r[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Vf(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Vf(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,r){return Vf(this.fixed,r)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class JH extends Wu{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Ma(t,e){if(me(t)||t===null)return e;if(t instanceof Wu)return t;if(tW(t)){const r=t.toLowerCase();return r==="default"?e:r==="local"||r==="system"?Cw.instance:r==="utc"||r==="gmt"?Lt.utcInstance:Lt.parseSpecifier(r)||_i.create(t)}else return Ua(t)?Lt.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new JH(t)}const HT={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},uE={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},YH=HT.hanidec.replace(/[\[|\]]/g,"").split("");function KH(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);if(t[r].search(HT.hanidec)!==-1)e+=YH.indexOf(t[r]);else for(const s in uE){const[n,o]=uE[s];i>=n&&i<=o&&(e+=i-n)}}return parseInt(e,10)}else return e}const rS=new Map;function QH(){rS.clear()}function Ms({numberingSystem:t},e=""){const r=t||"latn";let i=rS.get(r);i===void 0&&(i=new Map,rS.set(r,i));let s=i.get(e);return s===void 0&&(s=new RegExp(`${HT[r]}${e}`),i.set(e,s)),s}let cE=()=>Date.now(),dE="system",hE=null,pE=null,fE=null,mE=60,yE,gE=null;class wt{static get now(){return cE}static set now(e){cE=e}static set defaultZone(e){dE=e}static get defaultZone(){return Ma(dE,Cw.instance)}static get defaultLocale(){return hE}static set defaultLocale(e){hE=e}static get defaultNumberingSystem(){return pE}static set defaultNumberingSystem(e){pE=e}static get defaultOutputCalendar(){return fE}static set defaultOutputCalendar(e){fE=e}static get defaultWeekSettings(){return gE}static set defaultWeekSettings(e){gE=iS(e)}static get twoDigitCutoffYear(){return mE}static set twoDigitCutoffYear(e){mE=e%100}static get throwOnInvalid(){return yE}static set throwOnInvalid(e){yE=e}static resetCaches(){ze.resetCache(),_i.resetCache(),Y.resetCache(),QH()}}class Ks{constructor(e,r){this.reason=e,this.explanation=r}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const VF=[0,31,59,90,120,151,181,212,243,273,304,334],zF=[0,31,60,91,121,152,182,213,244,274,305,335];function cs(t,e){return new Ks("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function WT(t,e,r){const i=new Date(Date.UTC(t,e-1,r));t<100&&t>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);const s=i.getUTCDay();return s===0?7:s}function UF(t,e,r){return r+(ny(t)?zF:VF)[e-1]}function qF(t,e){const r=ny(t)?zF:VF,i=r.findIndex(n=>n<e),s=e-r[i];return{month:i+1,day:s}}function ZT(t,e){return(t-e+7)%7+1}function Mv(t,e=4,r=1){const{year:i,month:s,day:n}=t,o=UF(i,s,n),l=ZT(WT(i,s,n),r);let u=Math.floor((o-l+14-e)/7),d;return u<1?(d=i-1,u=xm(d,e,r)):u>xm(i,e,r)?(d=i+1,u=1):d=i,{weekYear:d,weekNumber:u,weekday:l,...Lw(t)}}function vE(t,e=4,r=1){const{weekYear:i,weekNumber:s,weekday:n}=t,o=ZT(WT(i,1,e),r),l=Td(i);let u=s*7+n-o-7+e,d;u<1?(d=i-1,u+=Td(d)):u>l?(d=i+1,u-=Td(i)):d=i;const{month:p,day:f}=qF(d,u);return{year:d,month:p,day:f,...Lw(t)}}function K1(t){const{year:e,month:r,day:i}=t,s=UF(e,r,i);return{year:e,ordinal:s,...Lw(t)}}function wE(t){const{year:e,ordinal:r}=t,{month:i,day:s}=qF(e,r);return{year:e,month:i,day:s,...Lw(t)}}function bE(t,e){if(!me(t.localWeekday)||!me(t.localWeekNumber)||!me(t.localWeekYear)){if(!me(t.weekday)||!me(t.weekNumber)||!me(t.weekYear))throw new dd("Cannot mix locale-based week fields with ISO-based week fields");return me(t.localWeekday)||(t.weekday=t.localWeekday),me(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),me(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function XH(t,e=4,r=1){const i=Pw(t.weekYear),s=ds(t.weekNumber,1,xm(t.weekYear,e,r)),n=ds(t.weekday,1,7);return i?s?n?!1:cs("weekday",t.weekday):cs("week",t.weekNumber):cs("weekYear",t.weekYear)}function eW(t){const e=Pw(t.year),r=ds(t.ordinal,1,Td(t.year));return e?r?!1:cs("ordinal",t.ordinal):cs("year",t.year)}function GF(t){const e=Pw(t.year),r=ds(t.month,1,12),i=ds(t.day,1,Iv(t.year,t.month));return e?r?i?!1:cs("day",t.day):cs("month",t.month):cs("year",t.year)}function BF(t){const{hour:e,minute:r,second:i,millisecond:s}=t,n=ds(e,0,23)||e===24&&r===0&&i===0&&s===0,o=ds(r,0,59),l=ds(i,0,59),u=ds(s,0,999);return n?o?l?u?!1:cs("millisecond",s):cs("second",i):cs("minute",r):cs("hour",e)}function me(t){return typeof t>"u"}function Ua(t){return typeof t=="number"}function Pw(t){return typeof t=="number"&&t%1===0}function tW(t){return typeof t=="string"}function rW(t){return Object.prototype.toString.call(t)==="[object Date]"}function HF(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function WF(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function iW(t){return Array.isArray(t)?t:[t]}function _E(t,e,r){if(t.length!==0)return t.reduce((i,s)=>{const n=[e(s),s];return i&&r(i[0],n[0])===i[0]?i:n},null)[1]}function sW(t,e){return e.reduce((r,i)=>(r[i]=t[i],r),{})}function xh(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function iS(t){if(t==null)return null;if(typeof t!="object")throw new xr("Week settings must be an object");if(!ds(t.firstDay,1,7)||!ds(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!ds(e,1,7)))throw new xr("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function ds(t,e,r){return Pw(t)&&t>=e&&t<=r}function nW(t,e){return t-e*Math.floor(t/e)}function At(t,e=2){const r=t<0;let i;return r?i="-"+(""+-t).padStart(e,"0"):i=(""+t).padStart(e,"0"),i}function va(t){if(!(me(t)||t===null||t===""))return parseInt(t,10)}function pl(t){if(!(me(t)||t===null||t===""))return parseFloat(t)}function JT(t){if(!(me(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function YT(t,e,r="round"){const i=10**e;switch(r){case"expand":return t>0?Math.ceil(t*i)/i:Math.floor(t*i)/i;case"trunc":return Math.trunc(t*i)/i;case"round":return Math.round(t*i)/i;case"floor":return Math.floor(t*i)/i;case"ceil":return Math.ceil(t*i)/i;default:throw new RangeError(`Value rounding ${r} is out of range`)}}function ny(t){return t%4===0&&(t%100!==0||t%400===0)}function Td(t){return ny(t)?366:365}function Iv(t,e){const r=nW(e-1,12)+1,i=t+(e-r)/12;return r===2?ny(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][r-1]}function Aw(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function SE(t,e,r){return-ZT(WT(t,1,e),r)+e-1}function xm(t,e=4,r=1){const i=SE(t,e,r),s=SE(t+1,e,r);return(Td(t)-i+s)/7}function sS(t){return t>99?t:t>wt.twoDigitCutoffYear?1900+t:2e3+t}function ZF(t,e,r,i=null){const s=new Date(t),n={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(n.timeZone=i);const o={timeZoneName:e,...n},l=new Intl.DateTimeFormat(r,o).formatToParts(s).find(u=>u.type.toLowerCase()==="timezonename");return l?l.value:null}function Rw(t,e){let r=parseInt(t,10);Number.isNaN(r)&&(r=0);const i=parseInt(e,10)||0,s=r<0||Object.is(r,-0)?-i:i;return r*60+s}function JF(t){const e=Number(t);if(typeof t=="boolean"||t===""||!Number.isFinite(e))throw new xr(`Invalid unit value ${t}`);return e}function Ev(t,e){const r={};for(const i in t)if(xh(t,i)){const s=t[i];if(s==null)continue;r[e(i)]=JF(s)}return r}function Vf(t,e){const r=Math.trunc(Math.abs(t/60)),i=Math.trunc(Math.abs(t%60)),s=t>=0?"+":"-";switch(e){case"short":return`${s}${At(r,2)}:${At(i,2)}`;case"narrow":return`${s}${r}${i>0?`:${i}`:""}`;case"techie":return`${s}${At(r,2)}${At(i,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function Lw(t){return sW(t,["hour","minute","second","millisecond"])}const oW=["January","February","March","April","May","June","July","August","September","October","November","December"],YF=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],aW=["J","F","M","A","M","J","J","A","S","O","N","D"];function KF(t){switch(t){case"narrow":return[...aW];case"short":return[...YF];case"long":return[...oW];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const QF=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],XF=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],lW=["M","T","W","T","F","S","S"];function e5(t){switch(t){case"narrow":return[...lW];case"short":return[...XF];case"long":return[...QF];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const t5=["AM","PM"],uW=["Before Christ","Anno Domini"],cW=["BC","AD"],dW=["B","A"];function r5(t){switch(t){case"narrow":return[...dW];case"short":return[...cW];case"long":return[...uW];default:return null}}function hW(t){return t5[t.hour<12?0:1]}function pW(t,e){return e5(e)[t.weekday-1]}function fW(t,e){return KF(e)[t.month-1]}function mW(t,e){return r5(e)[t.year<0?0:1]}function yW(t,e,r="always",i=!1){const s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},n=["hours","minutes","seconds"].indexOf(t)===-1;if(r==="auto"&&n){const f=t==="days";switch(e){case 1:return f?"tomorrow":`next ${s[t][0]}`;case-1:return f?"yesterday":`last ${s[t][0]}`;case 0:return f?"today":`this ${s[t][0]}`}}const o=Object.is(e,-0)||e<0,l=Math.abs(e),u=l===1,d=s[t],p=i?u?d[1]:d[2]||d[1]:u?s[t][0]:t;return o?`${l} ${p} ago`:`in ${l} ${p}`}function $E(t,e){let r="";for(const i of t)i.literal?r+=i.val:r+=e(i.val);return r}const gW={D:Tv,DD:wF,DDD:bF,DDDD:_F,t:SF,tt:$F,ttt:xF,tttt:TF,T:MF,TT:IF,TTT:EF,TTTT:OF,f:kF,ff:PF,fff:RF,ffff:FF,F:CF,FF:AF,FFF:LF,FFFF:NF};class kr{static create(e,r={}){return new kr(e,r)}static parseFormat(e){let r=null,i="",s=!1;const n=[];for(let o=0;o<e.length;o++){const l=e.charAt(o);l==="'"?((i.length>0||s)&&n.push({literal:s||/^\s+$/.test(i),val:i===""?"'":i}),r=null,i="",s=!s):s||l===r?i+=l:(i.length>0&&n.push({literal:/^\s+$/.test(i),val:i}),i=l,r=l)}return i.length>0&&n.push({literal:s||/^\s+$/.test(i),val:i}),n}static macroTokenToFormatOpts(e){return gW[e]}constructor(e,r){this.opts=r,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,r){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...r}).format()}dtFormatter(e,r={}){return this.loc.dtFormatter(e,{...this.opts,...r})}formatDateTime(e,r){return this.dtFormatter(e,r).format()}formatDateTimeParts(e,r){return this.dtFormatter(e,r).formatToParts()}formatInterval(e,r){return this.dtFormatter(e.start,r).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,r){return this.dtFormatter(e,r).resolvedOptions()}num(e,r=0,i=void 0){if(this.opts.forceSimple)return At(e,r);const s={...this.opts};return r>0&&(s.padTo=r),i&&(s.signDisplay=i),this.loc.numberFormatter(s).format(e)}formatDateTimeFromString(e,r){const i=this.loc.listingMode()==="en",s=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",n=(y,g)=>this.loc.extract(e,y,g),o=y=>e.isOffsetFixed&&e.offset===0&&y.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,y.format):"",l=()=>i?hW(e):n({hour:"numeric",hourCycle:"h12"},"dayperiod"),u=(y,g)=>i?fW(e,y):n(g?{month:y}:{month:y,day:"numeric"},"month"),d=(y,g)=>i?pW(e,y):n(g?{weekday:y}:{weekday:y,month:"long",day:"numeric"},"weekday"),p=y=>{const g=kr.macroTokenToFormatOpts(y);return g?this.formatWithSystemDefault(e,g):y},f=y=>i?mW(e,y):n({era:y},"era"),m=y=>{switch(y){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return l();case"d":return s?n({day:"numeric"},"day"):this.num(e.day);case"dd":return s?n({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return d("short",!0);case"cccc":return d("long",!0);case"ccccc":return d("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return d("short",!1);case"EEEE":return d("long",!1);case"EEEEE":return d("narrow",!1);case"L":return s?n({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return s?n({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return u("short",!0);case"LLLL":return u("long",!0);case"LLLLL":return u("narrow",!0);case"M":return s?n({month:"numeric"},"month"):this.num(e.month);case"MM":return s?n({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return u("short",!1);case"MMMM":return u("long",!1);case"MMMMM":return u("narrow",!1);case"y":return s?n({year:"numeric"},"year"):this.num(e.year);case"yy":return s?n({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return s?n({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return s?n({year:"numeric"},"year"):this.num(e.year,6);case"G":return f("short");case"GG":return f("long");case"GGGGG":return f("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return p(y)}};return $E(kr.parseFormat(r),m)}formatDurationFromString(e,r){const i=this.opts.signMode==="negativeLargestOnly"?-1:1,s=p=>{switch(p[0]){case"S":return"milliseconds";case"s":return"seconds";case"m":return"minutes";case"h":return"hours";case"d":return"days";case"w":return"weeks";case"M":return"months";case"y":return"years";default:return null}},n=(p,f)=>m=>{const y=s(m);if(y){const g=f.isNegativeDuration&&y!==f.largestUnit?i:1;let v;return this.opts.signMode==="negativeLargestOnly"&&y!==f.largestUnit?v="never":this.opts.signMode==="all"?v="always":v="auto",this.num(p.get(y)*g,m.length,v)}else return m},o=kr.parseFormat(r),l=o.reduce((p,{literal:f,val:m})=>f?p:p.concat(m),[]),u=e.shiftTo(...l.map(s).filter(p=>p)),d={isNegativeDuration:u<0,largestUnit:Object.keys(u.values)[0]};return $E(o,n(u,d))}}const i5=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Qh(...t){const e=t.reduce((r,i)=>r+i.source,"");return RegExp(`^${e}$`)}function Xh(...t){return e=>t.reduce(([r,i,s],n)=>{const[o,l,u]=n(e,s);return[{...r,...o},l||i,u]},[{},null,1]).slice(0,2)}function ep(t,...e){if(t==null)return[null,null];for(const[r,i]of e){const s=r.exec(t);if(s)return i(s)}return[null,null]}function s5(...t){return(e,r)=>{const i={};let s;for(s=0;s<t.length;s++)i[t[s]]=va(e[r+s]);return[i,null,r+s]}}const n5=/(?:([Zz])|([+-]\d\d)(?::?(\d\d))?)/,vW=`(?:${n5.source}?(?:\\[(${i5.source})\\])?)?`,KT=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,o5=RegExp(`${KT.source}${vW}`),QT=RegExp(`(?:[Tt]${o5.source})?`),wW=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,bW=/(\d{4})-?W(\d\d)(?:-?(\d))?/,_W=/(\d{4})-?(\d{3})/,SW=s5("weekYear","weekNumber","weekDay"),$W=s5("year","ordinal"),xW=/(\d{4})-(\d\d)-(\d\d)/,a5=RegExp(`${KT.source} ?(?:${n5.source}|(${i5.source}))?`),TW=RegExp(`(?: ${a5.source})?`);function Md(t,e,r){const i=t[e];return me(i)?r:va(i)}function MW(t,e){return[{year:Md(t,e),month:Md(t,e+1,1),day:Md(t,e+2,1)},null,e+3]}function tp(t,e){return[{hours:Md(t,e,0),minutes:Md(t,e+1,0),seconds:Md(t,e+2,0),milliseconds:JT(t[e+3])},null,e+4]}function oy(t,e){const r=!t[e]&&!t[e+1],i=Rw(t[e+1],t[e+2]),s=r?null:Lt.instance(i);return[{},s,e+3]}function ay(t,e){const r=t[e]?_i.create(t[e]):null;return[{},r,e+1]}const IW=RegExp(`^T?${KT.source}$`),EW=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function OW(t){const[e,r,i,s,n,o,l,u,d]=t,p=e[0]==="-",f=u&&u[0]==="-",m=(y,g=!1)=>y!==void 0&&(g||y&&p)?-y:y;return[{years:m(pl(r)),months:m(pl(i)),weeks:m(pl(s)),days:m(pl(n)),hours:m(pl(o)),minutes:m(pl(l)),seconds:m(pl(u),u==="-0"),milliseconds:m(JT(d),f)}]}const kW={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function XT(t,e,r,i,s,n,o){const l={year:e.length===2?sS(va(e)):va(e),month:YF.indexOf(r)+1,day:va(i),hour:va(s),minute:va(n)};return o&&(l.second=va(o)),t&&(l.weekday=t.length>3?QF.indexOf(t)+1:XF.indexOf(t)+1),l}const CW=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function PW(t){const[,e,r,i,s,n,o,l,u,d,p,f]=t,m=XT(e,s,i,r,n,o,l);let y;return u?y=kW[u]:d?y=0:y=Rw(p,f),[m,new Lt(y)]}function AW(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const RW=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,LW=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,FW=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function xE(t){const[,e,r,i,s,n,o,l]=t;return[XT(e,s,i,r,n,o,l),Lt.utcInstance]}function NW(t){const[,e,r,i,s,n,o,l]=t;return[XT(e,l,r,i,s,n,o),Lt.utcInstance]}const DW=Qh(wW,QT),jW=Qh(bW,QT),VW=Qh(_W,QT),zW=Qh(o5),l5=Xh(MW,tp,oy,ay),UW=Xh(SW,tp,oy,ay),qW=Xh($W,tp,oy,ay),GW=Xh(tp,oy,ay);function BW(t){return ep(t,[DW,l5],[jW,UW],[VW,qW],[zW,GW])}function HW(t){return ep(AW(t),[CW,PW])}function WW(t){return ep(t,[RW,xE],[LW,xE],[FW,NW])}function ZW(t){return ep(t,[EW,OW])}const JW=Xh(tp);function YW(t){return ep(t,[IW,JW])}const KW=Qh(xW,TW),QW=Qh(a5),XW=Xh(tp,oy,ay);function eZ(t){return ep(t,[KW,l5],[QW,XW])}const TE="Invalid Duration",u5={weeks:{days:7,hours:168,minutes:10080,seconds:10080*60,milliseconds:10080*60*1e3},days:{hours:24,minutes:1440,seconds:1440*60,milliseconds:1440*60*1e3},hours:{minutes:60,seconds:3600,milliseconds:3600*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},tZ={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:2184*60,seconds:2184*60*60,milliseconds:2184*60*60*1e3},months:{weeks:4,days:30,hours:720,minutes:720*60,seconds:720*60*60,milliseconds:720*60*60*1e3},...u5},Ji=146097/400,Xu=146097/4800,rZ={years:{quarters:4,months:12,weeks:Ji/7,days:Ji,hours:Ji*24,minutes:Ji*24*60,seconds:Ji*24*60*60,milliseconds:Ji*24*60*60*1e3},quarters:{months:3,weeks:Ji/28,days:Ji/4,hours:Ji*24/4,minutes:Ji*24*60/4,seconds:Ji*24*60*60/4,milliseconds:Ji*24*60*60*1e3/4},months:{weeks:Xu/7,days:Xu,hours:Xu*24,minutes:Xu*24*60,seconds:Xu*24*60*60,milliseconds:Xu*24*60*60*1e3},...u5},iu=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],iZ=iu.slice(0).reverse();function Un(t,e,r=!1){const i={values:r?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new ke(i)}function c5(t,e){let r=e.milliseconds??0;for(const i of iZ.slice(1))e[i]&&(r+=e[i]*t[i].milliseconds);return r}function ME(t,e){const r=c5(t,e)<0?-1:1;iu.reduceRight((i,s)=>{if(me(e[s]))return i;if(i){const n=e[i]*r,o=t[s][i],l=Math.floor(n/o);e[s]+=l*r,e[i]-=l*o*r}return s},null),iu.reduce((i,s)=>{if(me(e[s]))return i;if(i){const n=e[i]%1;e[i]-=n,e[s]+=n*t[i][s]}return s},null)}function IE(t){const e={};for(const[r,i]of Object.entries(t))i!==0&&(e[r]=i);return e}class ke{constructor(e){const r=e.conversionAccuracy==="longterm"||!1;let i=r?rZ:tZ;e.matrix&&(i=e.matrix),this.values=e.values,this.loc=e.loc||ze.create(),this.conversionAccuracy=r?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(e,r){return ke.fromObject({milliseconds:e},r)}static fromObject(e,r={}){if(e==null||typeof e!="object")throw new xr(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new ke({values:Ev(e,ke.normalizeUnit),loc:ze.fromObject(r),conversionAccuracy:r.conversionAccuracy,matrix:r.matrix})}static fromDurationLike(e){if(Ua(e))return ke.fromMillis(e);if(ke.isDuration(e))return e;if(typeof e=="object")return ke.fromObject(e);throw new xr(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,r){const[i]=ZW(e);return i?ke.fromObject(i,r):ke.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,r){const[i]=YW(e);return i?ke.fromObject(i,r):ke.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,r=null){if(!e)throw new xr("need to specify a reason the Duration is invalid");const i=e instanceof Ks?e:new Ks(e,r);if(wt.throwOnInvalid)throw new OH(i);return new ke({invalid:i})}static normalizeUnit(e){const r={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!r)throw new vF(e);return r}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,r={}){const i={...r,floor:r.round!==!1&&r.floor!==!1};return this.isValid?kr.create(this.loc,i).formatDurationFromString(this,e):TE}toHuman(e={}){if(!this.isValid)return TE;const r=e.showZeros!==!1,i=iu.map(s=>{const n=this.values[s];return me(n)||n===0&&!r?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:s.slice(0,-1)}).format(n)}).filter(s=>s);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=YT(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const r=this.toMillis();return r<0||r>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},Y.fromMillis(r,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?c5(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const r=ke.fromDurationLike(e),i={};for(const s of iu)(xh(r.values,s)||xh(this.values,s))&&(i[s]=r.get(s)+this.get(s));return Un(this,{values:i},!0)}minus(e){if(!this.isValid)return this;const r=ke.fromDurationLike(e);return this.plus(r.negate())}mapUnits(e){if(!this.isValid)return this;const r={};for(const i of Object.keys(this.values))r[i]=JF(e(this.values[i],i));return Un(this,{values:r},!0)}get(e){return this[ke.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const r={...this.values,...Ev(e,ke.normalizeUnit)};return Un(this,{values:r})}reconfigure({locale:e,numberingSystem:r,conversionAccuracy:i,matrix:s}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:r}),matrix:s,conversionAccuracy:i};return Un(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return ME(this.matrix,e),Un(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=IE(this.normalize().shiftToAll().toObject());return Un(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>ke.normalizeUnit(o));const r={},i={},s=this.toObject();let n;for(const o of iu)if(e.indexOf(o)>=0){n=o;let l=0;for(const d in i)l+=this.matrix[d][o]*i[d],i[d]=0;Ua(s[o])&&(l+=s[o]);const u=Math.trunc(l);r[o]=u,i[o]=(l*1e3-u*1e3)/1e3}else Ua(s[o])&&(i[o]=s[o]);for(const o in i)i[o]!==0&&(r[n]+=o===n?i[o]:i[o]/this.matrix[n][o]);return ME(this.matrix,r),Un(this,{values:r},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const r of Object.keys(this.values))e[r]=this.values[r]===0?0:-this.values[r];return Un(this,{values:e},!0)}removeZeros(){if(!this.isValid)return this;const e=IE(this.values);return Un(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function r(i,s){return i===void 0||i===0?s===void 0||s===0:i===s}for(const i of iu)if(!r(this.values[i],e.values[i]))return!1;return!0}}const ec="Invalid Interval";function sZ(t,e){return!t||!t.isValid?yt.invalid("missing or invalid start"):!e||!e.isValid?yt.invalid("missing or invalid end"):e<t?yt.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class yt{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,r=null){if(!e)throw new xr("need to specify a reason the Interval is invalid");const i=e instanceof Ks?e:new Ks(e,r);if(wt.throwOnInvalid)throw new EH(i);return new yt({invalid:i})}static fromDateTimes(e,r){const i=vp(e),s=vp(r),n=sZ(i,s);return n??new yt({start:i,end:s})}static after(e,r){const i=ke.fromDurationLike(r),s=vp(e);return yt.fromDateTimes(s,s.plus(i))}static before(e,r){const i=ke.fromDurationLike(r),s=vp(e);return yt.fromDateTimes(s.minus(i),s)}static fromISO(e,r){const[i,s]=(e||"").split("/",2);if(i&&s){let n,o;try{n=Y.fromISO(i,r),o=n.isValid}catch{o=!1}let l,u;try{l=Y.fromISO(s,r),u=l.isValid}catch{u=!1}if(o&&u)return yt.fromDateTimes(n,l);if(o){const d=ke.fromISO(s,r);if(d.isValid)return yt.after(n,d)}else if(u){const d=ke.fromISO(i,r);if(d.isValid)return yt.before(l,d)}}return yt.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",r){if(!this.isValid)return NaN;const i=this.start.startOf(e,r);let s;return r?.useLocaleWeeks?s=this.end.reconfigure({locale:i.locale}):s=this.end,s=s.startOf(e,r),Math.floor(s.diff(i,e).get(e))+(s.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:r}={}){return this.isValid?yt.fromDateTimes(e||this.s,r||this.e):this}splitAt(...e){if(!this.isValid)return[];const r=e.map(vp).filter(o=>this.contains(o)).sort((o,l)=>o.toMillis()-l.toMillis()),i=[];let{s}=this,n=0;for(;s<this.e;){const o=r[n]||this.e,l=+o>+this.e?this.e:o;i.push(yt.fromDateTimes(s,l)),s=l,n+=1}return i}splitBy(e){const r=ke.fromDurationLike(e);if(!this.isValid||!r.isValid||r.as("milliseconds")===0)return[];let{s:i}=this,s=1,n;const o=[];for(;i<this.e;){const l=this.start.plus(r.mapUnits(u=>u*s));n=+l>+this.e?this.e:l,o.push(yt.fromDateTimes(i,n)),i=n,s+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const r=this.s>e.s?this.s:e.s,i=this.e<e.e?this.e:e.e;return r>=i?null:yt.fromDateTimes(r,i)}union(e){if(!this.isValid)return this;const r=this.s<e.s?this.s:e.s,i=this.e>e.e?this.e:e.e;return yt.fromDateTimes(r,i)}static merge(e){const[r,i]=e.sort((s,n)=>s.s-n.s).reduce(([s,n],o)=>n?n.overlaps(o)||n.abutsStart(o)?[s,n.union(o)]:[s.concat([n]),o]:[s,o],[[],null]);return i&&r.push(i),r}static xor(e){let r=null,i=0;const s=[],n=e.map(u=>[{time:u.s,type:"s"},{time:u.e,type:"e"}]),o=Array.prototype.concat(...n),l=o.sort((u,d)=>u.time-d.time);for(const u of l)i+=u.type==="s"?1:-1,i===1?r=u.time:(r&&+r!=+u.time&&s.push(yt.fromDateTimes(r,u.time)),r=null);return yt.merge(s)}difference(...e){return yt.xor([this].concat(e)).map(r=>this.intersection(r)).filter(r=>r&&!r.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:ec}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=Tv,r={}){return this.isValid?kr.create(this.s.loc.clone(r),e).formatInterval(this):ec}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:ec}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:ec}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:ec}toFormat(e,{separator:r="  "}={}){return this.isValid?`${this.s.toFormat(e)}${r}${this.e.toFormat(e)}`:ec}toDuration(e,r){return this.isValid?this.e.diff(this.s,e,r):ke.invalid(this.invalidReason)}mapEndpoints(e){return yt.fromDateTimes(e(this.s),e(this.e))}}class Ly{static hasDST(e=wt.defaultZone){const r=Y.now().setZone(e).set({month:12});return!e.isUniversal&&r.offset!==r.set({month:6}).offset}static isValidIANAZone(e){return _i.isValidZone(e)}static normalizeZone(e){return Ma(e,wt.defaultZone)}static getStartOfWeek({locale:e=null,locObj:r=null}={}){return(r||ze.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:r=null}={}){return(r||ze.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:r=null}={}){return(r||ze.create(e)).getWeekendDays().slice()}static months(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null,outputCalendar:n="gregory"}={}){return(s||ze.create(r,i,n)).months(e)}static monthsFormat(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null,outputCalendar:n="gregory"}={}){return(s||ze.create(r,i,n)).months(e,!0)}static weekdays(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null}={}){return(s||ze.create(r,i,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null}={}){return(s||ze.create(r,i,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return ze.create(e).meridiems()}static eras(e="short",{locale:r=null}={}){return ze.create(r,null,"gregory").eras(e)}static features(){return{relative:HF(),localeWeek:WF()}}}function EE(t,e){const r=s=>s.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=r(e)-r(t);return Math.floor(ke.fromMillis(i).as("days"))}function nZ(t,e,r){const i=[["years",(u,d)=>d.year-u.year],["quarters",(u,d)=>d.quarter-u.quarter+(d.year-u.year)*4],["months",(u,d)=>d.month-u.month+(d.year-u.year)*12],["weeks",(u,d)=>{const p=EE(u,d);return(p-p%7)/7}],["days",EE]],s={},n=t;let o,l;for(const[u,d]of i)r.indexOf(u)>=0&&(o=u,s[u]=d(t,e),l=n.plus(s),l>e?(s[u]--,t=n.plus(s),t>e&&(l=t,s[u]--,t=n.plus(s))):t=l);return[t,s,l,o]}function oZ(t,e,r,i){let[s,n,o,l]=nZ(t,e,r);const u=e-s,d=r.filter(f=>["hours","minutes","seconds","milliseconds"].indexOf(f)>=0);d.length===0&&(o<e&&(o=s.plus({[l]:1})),o!==s&&(n[l]=(n[l]||0)+u/(o-s)));const p=ke.fromObject(n,i);return d.length>0?ke.fromMillis(u,i).shiftTo(...d).plus(p):p}const aZ="missing Intl.DateTimeFormat.formatToParts support";function Re(t,e=r=>r){return{regex:t,deser:([r])=>e(KH(r))}}const lZ="",d5=`[ ${lZ}]`,h5=new RegExp(d5,"g");function uZ(t){return t.replace(/\./g,"\\.?").replace(h5,d5)}function OE(t){return t.replace(/\./g,"").replace(h5," ").toLowerCase()}function Is(t,e){return t===null?null:{regex:RegExp(t.map(uZ).join("|")),deser:([r])=>t.findIndex(i=>OE(r)===OE(i))+e}}function kE(t,e){return{regex:t,deser:([,r,i])=>Rw(r,i),groups:e}}function Fy(t){return{regex:t,deser:([e])=>e}}function cZ(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function dZ(t,e){const r=Ms(e),i=Ms(e,"{2}"),s=Ms(e,"{3}"),n=Ms(e,"{4}"),o=Ms(e,"{6}"),l=Ms(e,"{1,2}"),u=Ms(e,"{1,3}"),d=Ms(e,"{1,6}"),p=Ms(e,"{1,9}"),f=Ms(e,"{2,4}"),m=Ms(e,"{4,6}"),y=_=>({regex:RegExp(cZ(_.val)),deser:([S])=>S,literal:!0}),v=(_=>{if(t.literal)return y(_);switch(_.val){case"G":return Is(e.eras("short"),0);case"GG":return Is(e.eras("long"),0);case"y":return Re(d);case"yy":return Re(f,sS);case"yyyy":return Re(n);case"yyyyy":return Re(m);case"yyyyyy":return Re(o);case"M":return Re(l);case"MM":return Re(i);case"MMM":return Is(e.months("short",!0),1);case"MMMM":return Is(e.months("long",!0),1);case"L":return Re(l);case"LL":return Re(i);case"LLL":return Is(e.months("short",!1),1);case"LLLL":return Is(e.months("long",!1),1);case"d":return Re(l);case"dd":return Re(i);case"o":return Re(u);case"ooo":return Re(s);case"HH":return Re(i);case"H":return Re(l);case"hh":return Re(i);case"h":return Re(l);case"mm":return Re(i);case"m":return Re(l);case"q":return Re(l);case"qq":return Re(i);case"s":return Re(l);case"ss":return Re(i);case"S":return Re(u);case"SSS":return Re(s);case"u":return Fy(p);case"uu":return Fy(l);case"uuu":return Re(r);case"a":return Is(e.meridiems(),0);case"kkkk":return Re(n);case"kk":return Re(f,sS);case"W":return Re(l);case"WW":return Re(i);case"E":case"c":return Re(r);case"EEE":return Is(e.weekdays("short",!1),1);case"EEEE":return Is(e.weekdays("long",!1),1);case"ccc":return Is(e.weekdays("short",!0),1);case"cccc":return Is(e.weekdays("long",!0),1);case"Z":case"ZZ":return kE(new RegExp(`([+-]${l.source})(?::(${i.source}))?`),2);case"ZZZ":return kE(new RegExp(`([+-]${l.source})(${i.source})?`),2);case"z":return Fy(/[a-z_+-/]{1,256}?/i);case" ":return Fy(/[^\S\n\r]/);default:return y(_)}})(t)||{invalidReason:aZ};return v.token=t,v}const hZ={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function pZ(t,e,r){const{type:i,value:s}=t;if(i==="literal"){const u=/^\s+$/.test(s);return{literal:!u,val:u?" ":s}}const n=e[i];let o=i;i==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=r.hour12?"hour12":"hour24");let l=hZ[o];if(typeof l=="object"&&(l=l[n]),l)return{literal:!1,val:l}}function fZ(t){return[`^${t.map(r=>r.regex).reduce((r,i)=>`${r}(${i.source})`,"")}$`,t]}function mZ(t,e,r){const i=t.match(e);if(i){const s={};let n=1;for(const o in r)if(xh(r,o)){const l=r[o],u=l.groups?l.groups+1:1;!l.literal&&l.token&&(s[l.token.val[0]]=l.deser(i.slice(n,n+u))),n+=u}return[i,s]}else return[i,{}]}function yZ(t){const e=n=>{switch(n){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let r=null,i;return me(t.z)||(r=_i.create(t.z)),me(t.Z)||(r||(r=new Lt(t.Z)),i=t.Z),me(t.q)||(t.M=(t.q-1)*3+1),me(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),me(t.u)||(t.S=JT(t.u)),[Object.keys(t).reduce((n,o)=>{const l=e(o);return l&&(n[l]=t[o]),n},{}),r,i]}let Q1=null;function gZ(){return Q1||(Q1=Y.fromMillis(1555555555555)),Q1}function vZ(t,e){if(t.literal)return t;const r=kr.macroTokenToFormatOpts(t.val),i=y5(r,e);return i==null||i.includes(void 0)?t:i}function p5(t,e){return Array.prototype.concat(...t.map(r=>vZ(r,e)))}class f5{constructor(e,r){if(this.locale=e,this.format=r,this.tokens=p5(kr.parseFormat(r),e),this.units=this.tokens.map(i=>dZ(i,e)),this.disqualifyingUnit=this.units.find(i=>i.invalidReason),!this.disqualifyingUnit){const[i,s]=fZ(this.units);this.regex=RegExp(i,"i"),this.handlers=s}}explainFromTokens(e){if(this.isValid){const[r,i]=mZ(e,this.regex,this.handlers),[s,n,o]=i?yZ(i):[null,null,void 0];if(xh(i,"a")&&xh(i,"H"))throw new dd("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:r,matches:i,result:s,zone:n,specificOffset:o}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function m5(t,e,r){return new f5(t,r).explainFromTokens(e)}function wZ(t,e,r){const{result:i,zone:s,specificOffset:n,invalidReason:o}=m5(t,e,r);return[i,s,n,o]}function y5(t,e){if(!t)return null;const i=kr.create(e,t).dtFormatter(gZ()),s=i.formatToParts(),n=i.resolvedOptions();return s.map(o=>pZ(o,t,n))}const X1="Invalid DateTime",CE=864e13;function Bp(t){return new Ks("unsupported zone",`the zone "${t.name}" is not supported`)}function eb(t){return t.weekData===null&&(t.weekData=Mv(t.c)),t.weekData}function tb(t){return t.localWeekData===null&&(t.localWeekData=Mv(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function fl(t,e){const r={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new Y({...r,...e,old:r})}function g5(t,e,r){let i=t-e*60*1e3;const s=r.offset(i);if(e===s)return[i,e];i-=(s-e)*60*1e3;const n=r.offset(i);return s===n?[i,s]:[t-Math.min(s,n)*60*1e3,Math.max(s,n)]}function Ny(t,e){t+=e*60*1e3;const r=new Date(t);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:r.getUTCHours(),minute:r.getUTCMinutes(),second:r.getUTCSeconds(),millisecond:r.getUTCMilliseconds()}}function Ug(t,e,r){return g5(Aw(t),e,r)}function PE(t,e){const r=t.o,i=t.c.year+Math.trunc(e.years),s=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,n={...t.c,year:i,month:s,day:Math.min(t.c.day,Iv(i,s))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=ke.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),l=Aw(n);let[u,d]=g5(l,r,t.zone);return o!==0&&(u+=o,d=t.zone.offset(u)),{ts:u,o:d}}function tc(t,e,r,i,s,n){const{setZone:o,zone:l}=r;if(t&&Object.keys(t).length!==0||e){const u=e||l,d=Y.fromObject(t,{...r,zone:u,specificOffset:n});return o?d:d.setZone(l)}else return Y.invalid(new Ks("unparsable",`the input "${s}" can't be parsed as ${i}`))}function Dy(t,e,r=!0){return t.isValid?kr.create(ze.create("en-US"),{allowZ:r,forceSimple:!0}).formatDateTimeFromString(t,e):null}function rb(t,e,r){const i=t.c.year>9999||t.c.year<0;let s="";if(i&&t.c.year>=0&&(s+="+"),s+=At(t.c.year,i?6:4),r==="year")return s;if(e){if(s+="-",s+=At(t.c.month),r==="month")return s;s+="-"}else if(s+=At(t.c.month),r==="month")return s;return s+=At(t.c.day),s}function AE(t,e,r,i,s,n,o){let l=!r||t.c.millisecond!==0||t.c.second!==0,u="";switch(o){case"day":case"month":case"year":break;default:if(u+=At(t.c.hour),o==="hour")break;if(e){if(u+=":",u+=At(t.c.minute),o==="minute")break;l&&(u+=":",u+=At(t.c.second))}else{if(u+=At(t.c.minute),o==="minute")break;l&&(u+=At(t.c.second))}if(o==="second")break;l&&(!i||t.c.millisecond!==0)&&(u+=".",u+=At(t.c.millisecond,3))}return s&&(t.isOffsetFixed&&t.offset===0&&!n?u+="Z":t.o<0?(u+="-",u+=At(Math.trunc(-t.o/60)),u+=":",u+=At(Math.trunc(-t.o%60))):(u+="+",u+=At(Math.trunc(t.o/60)),u+=":",u+=At(Math.trunc(t.o%60)))),n&&(u+="["+t.zone.ianaName+"]"),u}const v5={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},bZ={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},_Z={ordinal:1,hour:0,minute:0,second:0,millisecond:0},qg=["year","month","day","hour","minute","second","millisecond"],SZ=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],$Z=["year","ordinal","hour","minute","second","millisecond"];function Gg(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new vF(t);return e}function RE(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return Gg(t)}}function xZ(t){if(Hp===void 0&&(Hp=wt.now()),t.type!=="iana")return t.offset(Hp);const e=t.name;let r=nS.get(e);return r===void 0&&(r=t.offset(Hp),nS.set(e,r)),r}function LE(t,e){const r=Ma(e.zone,wt.defaultZone);if(!r.isValid)return Y.invalid(Bp(r));const i=ze.fromObject(e);let s,n;if(me(t.year))s=wt.now();else{for(const u of qg)me(t[u])&&(t[u]=v5[u]);const o=GF(t)||BF(t);if(o)return Y.invalid(o);const l=xZ(r);[s,n]=Ug(t,l,r)}return new Y({ts:s,zone:r,loc:i,o:n})}function FE(t,e,r){const i=me(r.round)?!0:r.round,s=me(r.rounding)?"trunc":r.rounding,n=(l,u)=>(l=YT(l,i||r.calendary?0:2,r.calendary?"round":s),e.loc.clone(r).relFormatter(r).format(l,u)),o=l=>r.calendary?e.hasSame(t,l)?0:e.startOf(l).diff(t.startOf(l),l).get(l):e.diff(t,l).get(l);if(r.unit)return n(o(r.unit),r.unit);for(const l of r.units){const u=o(l);if(Math.abs(u)>=1)return n(u,l)}return n(t>e?-0:0,r.units[r.units.length-1])}function NE(t){let e={},r;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],r=Array.from(t).slice(0,t.length-1)):r=Array.from(t),[e,r]}let Hp;const nS=new Map;class Y{constructor(e){const r=e.zone||wt.defaultZone;let i=e.invalid||(Number.isNaN(e.ts)?new Ks("invalid input"):null)||(r.isValid?null:Bp(r));this.ts=me(e.ts)?wt.now():e.ts;let s=null,n=null;if(!i)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(r))[s,n]=[e.old.c,e.old.o];else{const l=Ua(e.o)&&!e.old?e.o:r.offset(this.ts);s=Ny(this.ts,l),i=Number.isNaN(s.year)?new Ks("invalid input"):null,s=i?null:s,n=i?null:l}this._zone=r,this.loc=e.loc||ze.create(),this.invalid=i,this.weekData=null,this.localWeekData=null,this.c=s,this.o=n,this.isLuxonDateTime=!0}static now(){return new Y({})}static local(){const[e,r]=NE(arguments),[i,s,n,o,l,u,d]=r;return LE({year:i,month:s,day:n,hour:o,minute:l,second:u,millisecond:d},e)}static utc(){const[e,r]=NE(arguments),[i,s,n,o,l,u,d]=r;return e.zone=Lt.utcInstance,LE({year:i,month:s,day:n,hour:o,minute:l,second:u,millisecond:d},e)}static fromJSDate(e,r={}){const i=rW(e)?e.valueOf():NaN;if(Number.isNaN(i))return Y.invalid("invalid input");const s=Ma(r.zone,wt.defaultZone);return s.isValid?new Y({ts:i,zone:s,loc:ze.fromObject(r)}):Y.invalid(Bp(s))}static fromMillis(e,r={}){if(Ua(e))return e<-CE||e>CE?Y.invalid("Timestamp out of range"):new Y({ts:e,zone:Ma(r.zone,wt.defaultZone),loc:ze.fromObject(r)});throw new xr(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,r={}){if(Ua(e))return new Y({ts:e*1e3,zone:Ma(r.zone,wt.defaultZone),loc:ze.fromObject(r)});throw new xr("fromSeconds requires a numerical input")}static fromObject(e,r={}){e=e||{};const i=Ma(r.zone,wt.defaultZone);if(!i.isValid)return Y.invalid(Bp(i));const s=ze.fromObject(r),n=Ev(e,RE),{minDaysInFirstWeek:o,startOfWeek:l}=bE(n,s),u=wt.now(),d=me(r.specificOffset)?i.offset(u):r.specificOffset,p=!me(n.ordinal),f=!me(n.year),m=!me(n.month)||!me(n.day),y=f||m,g=n.weekYear||n.weekNumber;if((y||p)&&g)throw new dd("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(m&&p)throw new dd("Can't mix ordinal dates with month/day");const v=g||n.weekday&&!y;let _,S,M=Ny(u,d);v?(_=SZ,S=bZ,M=Mv(M,o,l)):p?(_=$Z,S=_Z,M=K1(M)):(_=qg,S=v5);let C=!1;for(const G of _){const Q=n[G];me(Q)?C?n[G]=S[G]:n[G]=M[G]:C=!0}const T=v?XH(n,o,l):p?eW(n):GF(n),O=T||BF(n);if(O)return Y.invalid(O);const P=v?vE(n,o,l):p?wE(n):n,[D,z]=Ug(P,d,i),B=new Y({ts:D,zone:i,o:z,loc:s});return n.weekday&&y&&e.weekday!==B.weekday?Y.invalid("mismatched weekday",`you can't specify both a weekday of ${n.weekday} and a date of ${B.toISO()}`):B.isValid?B:Y.invalid(B.invalid)}static fromISO(e,r={}){const[i,s]=BW(e);return tc(i,s,r,"ISO 8601",e)}static fromRFC2822(e,r={}){const[i,s]=HW(e);return tc(i,s,r,"RFC 2822",e)}static fromHTTP(e,r={}){const[i,s]=WW(e);return tc(i,s,r,"HTTP",r)}static fromFormat(e,r,i={}){if(me(e)||me(r))throw new xr("fromFormat requires an input string and a format");const{locale:s=null,numberingSystem:n=null}=i,o=ze.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0}),[l,u,d,p]=wZ(o,e,r);return p?Y.invalid(p):tc(l,u,i,`format ${r}`,e,d)}static fromString(e,r,i={}){return Y.fromFormat(e,r,i)}static fromSQL(e,r={}){const[i,s]=eZ(e);return tc(i,s,r,"SQL",e)}static invalid(e,r=null){if(!e)throw new xr("need to specify a reason the DateTime is invalid");const i=e instanceof Ks?e:new Ks(e,r);if(wt.throwOnInvalid)throw new IH(i);return new Y({invalid:i})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,r={}){const i=y5(e,ze.fromObject(r));return i?i.map(s=>s?s.val:null).join(""):null}static expandFormat(e,r={}){return p5(kr.parseFormat(e),ze.fromObject(r)).map(s=>s.val).join("")}static resetCache(){Hp=void 0,nS.clear()}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?eb(this).weekYear:NaN}get weekNumber(){return this.isValid?eb(this).weekNumber:NaN}get weekday(){return this.isValid?eb(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?tb(this).weekday:NaN}get localWeekNumber(){return this.isValid?tb(this).weekNumber:NaN}get localWeekYear(){return this.isValid?tb(this).weekYear:NaN}get ordinal(){return this.isValid?K1(this.c).ordinal:NaN}get monthShort(){return this.isValid?Ly.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Ly.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Ly.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Ly.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,r=6e4,i=Aw(this.c),s=this.zone.offset(i-e),n=this.zone.offset(i+e),o=this.zone.offset(i-s*r),l=this.zone.offset(i-n*r);if(o===l)return[this];const u=i-o*r,d=i-l*r,p=Ny(u,o),f=Ny(d,l);return p.hour===f.hour&&p.minute===f.minute&&p.second===f.second&&p.millisecond===f.millisecond?[fl(this,{ts:u}),fl(this,{ts:d})]:[this]}get isInLeapYear(){return ny(this.year)}get daysInMonth(){return Iv(this.year,this.month)}get daysInYear(){return this.isValid?Td(this.year):NaN}get weeksInWeekYear(){return this.isValid?xm(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?xm(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:r,numberingSystem:i,calendar:s}=kr.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:r,numberingSystem:i,outputCalendar:s}}toUTC(e=0,r={}){return this.setZone(Lt.instance(e),r)}toLocal(){return this.setZone(wt.defaultZone)}setZone(e,{keepLocalTime:r=!1,keepCalendarTime:i=!1}={}){if(e=Ma(e,wt.defaultZone),e.equals(this.zone))return this;if(e.isValid){let s=this.ts;if(r||i){const n=e.offset(this.ts),o=this.toObject();[s]=Ug(o,n,e)}return fl(this,{ts:s,zone:e})}else return Y.invalid(Bp(e))}reconfigure({locale:e,numberingSystem:r,outputCalendar:i}={}){const s=this.loc.clone({locale:e,numberingSystem:r,outputCalendar:i});return fl(this,{loc:s})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const r=Ev(e,RE),{minDaysInFirstWeek:i,startOfWeek:s}=bE(r,this.loc),n=!me(r.weekYear)||!me(r.weekNumber)||!me(r.weekday),o=!me(r.ordinal),l=!me(r.year),u=!me(r.month)||!me(r.day),d=l||u,p=r.weekYear||r.weekNumber;if((d||o)&&p)throw new dd("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(u&&o)throw new dd("Can't mix ordinal dates with month/day");let f;n?f=vE({...Mv(this.c,i,s),...r},i,s):me(r.ordinal)?(f={...this.toObject(),...r},me(r.day)&&(f.day=Math.min(Iv(f.year,f.month),f.day))):f=wE({...K1(this.c),...r});const[m,y]=Ug(f,this.o,this.zone);return fl(this,{ts:m,o:y})}plus(e){if(!this.isValid)return this;const r=ke.fromDurationLike(e);return fl(this,PE(this,r))}minus(e){if(!this.isValid)return this;const r=ke.fromDurationLike(e).negate();return fl(this,PE(this,r))}startOf(e,{useLocaleWeeks:r=!1}={}){if(!this.isValid)return this;const i={},s=ke.normalizeUnit(e);switch(s){case"years":i.month=1;case"quarters":case"months":i.day=1;case"weeks":case"days":i.hour=0;case"hours":i.minute=0;case"minutes":i.second=0;case"seconds":i.millisecond=0;break}if(s==="weeks")if(r){const n=this.loc.getStartOfWeek(),{weekday:o}=this;o<n&&(i.weekNumber=this.weekNumber-1),i.weekday=n}else i.weekday=1;if(s==="quarters"){const n=Math.ceil(this.month/3);i.month=(n-1)*3+1}return this.set(i)}endOf(e,r){return this.isValid?this.plus({[e]:1}).startOf(e,r).minus(1):this}toFormat(e,r={}){return this.isValid?kr.create(this.loc.redefaultToEN(r)).formatDateTimeFromString(this,e):X1}toLocaleString(e=Tv,r={}){return this.isValid?kr.create(this.loc.clone(r),e).formatDateTime(this):X1}toLocaleParts(e={}){return this.isValid?kr.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:r=!1,suppressMilliseconds:i=!1,includeOffset:s=!0,extendedZone:n=!1,precision:o="milliseconds"}={}){if(!this.isValid)return null;o=Gg(o);const l=e==="extended";let u=rb(this,l,o);return qg.indexOf(o)>=3&&(u+="T"),u+=AE(this,l,r,i,s,n,o),u}toISODate({format:e="extended",precision:r="day"}={}){return this.isValid?rb(this,e==="extended",Gg(r)):null}toISOWeekDate(){return Dy(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:r=!1,includeOffset:i=!0,includePrefix:s=!1,extendedZone:n=!1,format:o="extended",precision:l="milliseconds"}={}){return this.isValid?(l=Gg(l),(s&&qg.indexOf(l)>=3?"T":"")+AE(this,o==="extended",r,e,i,n,l)):null}toRFC2822(){return Dy(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Dy(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?rb(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:r=!1,includeOffsetSpace:i=!0}={}){let s="HH:mm:ss.SSS";return(r||e)&&(i&&(s+=" "),r?s+="z":e&&(s+="ZZ")),Dy(this,s,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():X1}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const r={...this.c};return e.includeConfig&&(r.outputCalendar=this.outputCalendar,r.numberingSystem=this.loc.numberingSystem,r.locale=this.loc.locale),r}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,r="milliseconds",i={}){if(!this.isValid||!e.isValid)return ke.invalid("created by diffing an invalid DateTime");const s={locale:this.locale,numberingSystem:this.numberingSystem,...i},n=iW(r).map(ke.normalizeUnit),o=e.valueOf()>this.valueOf(),l=o?this:e,u=o?e:this,d=oZ(l,u,n,s);return o?d.negate():d}diffNow(e="milliseconds",r={}){return this.diff(Y.now(),e,r)}until(e){return this.isValid?yt.fromDateTimes(this,e):this}hasSame(e,r,i){if(!this.isValid)return!1;const s=e.valueOf(),n=this.setZone(e.zone,{keepLocalTime:!0});return n.startOf(r,i)<=s&&s<=n.endOf(r,i)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const r=e.base||Y.fromObject({},{zone:this.zone}),i=e.padding?this<r?-e.padding:e.padding:0;let s=["years","months","days","hours","minutes","seconds"],n=e.unit;return Array.isArray(e.unit)&&(s=e.unit,n=void 0),FE(r,this.plus(i),{...e,numeric:"always",units:s,unit:n})}toRelativeCalendar(e={}){return this.isValid?FE(e.base||Y.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(Y.isDateTime))throw new xr("min requires all arguments be DateTimes");return _E(e,r=>r.valueOf(),Math.min)}static max(...e){if(!e.every(Y.isDateTime))throw new xr("max requires all arguments be DateTimes");return _E(e,r=>r.valueOf(),Math.max)}static fromFormatExplain(e,r,i={}){const{locale:s=null,numberingSystem:n=null}=i,o=ze.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0});return m5(o,e,r)}static fromStringExplain(e,r,i={}){return Y.fromFormatExplain(e,r,i)}static buildFormatParser(e,r={}){const{locale:i=null,numberingSystem:s=null}=r,n=ze.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});return new f5(n,e)}static fromFormatParser(e,r,i={}){if(me(e)||me(r))throw new xr("fromFormatParser requires an input string and a format parser");const{locale:s=null,numberingSystem:n=null}=i,o=ze.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0});if(!o.equals(r.locale))throw new xr(`fromFormatParser called with a locale of ${o}, but the format parser was created for ${r.locale}`);const{result:l,zone:u,specificOffset:d,invalidReason:p}=r.explainFromTokens(e);return p?Y.invalid(p):tc(l,u,i,`format ${r.format}`,e,d)}static get DATE_SHORT(){return Tv}static get DATE_MED(){return wF}static get DATE_MED_WITH_WEEKDAY(){return kH}static get DATE_FULL(){return bF}static get DATE_HUGE(){return _F}static get TIME_SIMPLE(){return SF}static get TIME_WITH_SECONDS(){return $F}static get TIME_WITH_SHORT_OFFSET(){return xF}static get TIME_WITH_LONG_OFFSET(){return TF}static get TIME_24_SIMPLE(){return MF}static get TIME_24_WITH_SECONDS(){return IF}static get TIME_24_WITH_SHORT_OFFSET(){return EF}static get TIME_24_WITH_LONG_OFFSET(){return OF}static get DATETIME_SHORT(){return kF}static get DATETIME_SHORT_WITH_SECONDS(){return CF}static get DATETIME_MED(){return PF}static get DATETIME_MED_WITH_SECONDS(){return AF}static get DATETIME_MED_WITH_WEEKDAY(){return CH}static get DATETIME_FULL(){return RF}static get DATETIME_FULL_WITH_SECONDS(){return LF}static get DATETIME_HUGE(){return FF}static get DATETIME_HUGE_WITH_SECONDS(){return NF}}function vp(t){if(Y.isDateTime(t))return t;if(t&&t.valueOf&&Ua(t.valueOf()))return Y.fromJSDate(t);if(t&&typeof t=="object")return Y.fromObject(t);throw new xr(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const TZ="shortOffset";function MZ(t){return"timeZoneIANA"in t}function IZ(t){return t.startsWith("UTC")}function Ov(t,e=!1){return{json:{read:{source:t,reader:(r,i)=>i[t]?Bg(i[t]):null},write:!!e&&{allowNull:!0,writer(r,i){i[t]=r?EZ(r):null}}}}}function Bg(t,e=rn){return t?MZ(t)?t.timeZoneIANA:OZ(t,e):e}function EZ(t){return{timeZoneIANA:t}}function OZ(t,e=rn){if(!t||!aE.has(t.timeZone))return e;const r=aE.get(t.timeZone);return IZ(t.timeZone)||t.respectsDaylightSaving?r:kZ(r)}function kZ(t){const e=Y.local().setZone(t),r=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return r===0?"Etc/UTC":`Etc/GMT${Lt.instance(-r).formatOffset(0,"narrow")}`}function Wbe(t,e,r,i,s){if(e&&s==="date")return{timeZone:Qa,timeZoneName:void 0};const n=i.hour,o=r===Ka;return{timeZone:o?s==="timestamp-offset"?void 0:t??Qa:r,timeZoneName:o&&n?TZ:void 0}}function CZ(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),r=new Set(Intl.supportedValuesOf("timeZone").map(i=>i.toLowerCase()));return t===rn||t===Ka||e.has(t.toLowerCase())||r.has(t.toLowerCase())}const PZ={dateStyle:void 0,year:void 0,month:void 0,day:void 0,weekday:void 0},AZ={timeStyle:void 0,hour12:void 0,hourCycle:void 0,hour:void 0,minute:void 0,second:void 0},w5={timeZone:Qa},on={year:"numeric",month:"numeric",day:"numeric"},wp={year:"numeric",month:"long",day:"numeric"},bp={year:"numeric",month:"short",day:"numeric"},_p={year:"numeric",month:"long",weekday:"long",day:"numeric"},wa={hour:"numeric",minute:"numeric"},Il={...wa,second:"numeric"},b5={hourCycle:"h23"},Sp={...wa,...b5},$p={...Il,...b5},_5={"short-date":on,"short-date-short-time":{...on,...wa},"short-date-short-time-24":{...on,...Sp},"short-date-long-time":{...on,...Il},"short-date-long-time-24":{...on,...$p},"short-date-le":on,"short-date-le-short-time":{...on,...wa},"short-date-le-short-time-24":{...on,...Sp},"short-date-le-long-time":{...on,...Il},"short-date-le-long-time-24":{...on,...$p},"long-month-day-year":wp,"long-month-day-year-short-time":{...wp,...wa},"long-month-day-year-short-time-24":{...wp,...Sp},"long-month-day-year-long-time":{...wp,...Il},"long-month-day-year-long-time-24":{...wp,...$p},"day-short-month-year":bp,"day-short-month-year-short-time":{...bp,...wa},"day-short-month-year-short-time-24":{...bp,...Sp},"day-short-month-year-long-time":{...bp,...Il},"day-short-month-year-long-time-24":{...bp,...$p},"long-date":_p,"long-date-short-time":{..._p,...wa},"long-date-short-time-24":{..._p,...Sp},"long-date-long-time":{..._p,...Il},"long-date-long-time-24":{..._p,...$p},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":wa,"long-time":Il},RZ=Ft()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),S5={ar:"ar-u-nu-latn-ca-gregory",nn:"no-NN"},LZ=new Intl.DateTimeFormat("bs",{month:"long"}).formatToParts(new Date(2025,2)),FZ=LZ.find(({type:t})=>t==="month")?.value.toLowerCase();function $5(){const t=GT();return(t&&S5[t])??cF()}FZ!=="mart"&&(S5.bs="sr-Latn-CS");let oS=new WeakMap;const Fw=_5["short-date-short-time"];function NZ(t){let e=oS.get(t);if(!e){const r=$5(),i=eM(t.timeZone??rn),s={...t,timeZone:i};e=new Intl.DateTimeFormat(r,s),oS.set(t,e)}return e}function Zbe(t){return _5[t]}function Jbe(t){const{dateStyle:e,timeStyle:r,hour12:i,year:s,month:n}=t,o={};return e?o.dateStyle=e:s&&(o.year=s,o.month=n||void 0),r&&!o.year&&(o.timeStyle=r,o.hour12=i==="auto"?void 0:i==="always"),o}function Xa(t,e=Fw){return NZ(e).format(t)}function Ybe(t,e=Fw){return Xa(new Date(t),{...e,...w5,...AZ})}function Kbe(t,e=Fw){return Xa(new Date(`1970-01-01T${t}Z`),{...e,...w5,...PZ})}function Qbe(t,e=Fw){if(e.timeZone)return Xa(new Date(t),e);const r=Y.fromISO(t,{setZone:!0}),i=r.offset===0?Qa:e.timeZone,s={...e,timeZone:i};return r.toLocaleString(s,{locale:$5()})}function eM(t){switch(t){case rn:return MH;case Ka:return Qa;default:return t}}BT(()=>{oS=new WeakMap});const DZ={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let Hg=new WeakMap,x5={};function aS(t){const e=t||x5;if(!Hg.has(e)){const r=GT(),i=r&&DZ[r]||cF();Hg.set(e,new Intl.NumberFormat(i,t))}return Hg.get(e)}function Xbe(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function e_e(t){const{minimumFractionDigits:e,maximumFractionDigits:r,useGrouping:i}=t;return{minimumFractionDigits:e,maximumFractionDigits:r,useGrouping:i==="auto"?"auto":i==="always"}}function kv(t,e){return Object.is(t,-0)&&(t=0),aS(e).format(t)}function t_e(t,e=vi()){if(!t)return null;let r=DE.get(e);if(!r){const i=aS().formatToParts(12345.6),s=[...aS({useGrouping:!1}).format(9876543210)].reverse(),n=new Map(s.map((f,m)=>[f,m])),o=new RegExp(`[${i.find(f=>f.type==="group")?.value}]`,"g"),l=new RegExp(`[${i.find(f=>f.type==="decimal")?.value}]`),u=new RegExp(`[${s.join("")}]`,"g"),d=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,p=/[-\u2212\u2013\u2014\u2015]/g;r=f=>{if((f=f.trim().replaceAll(o,"").replace(l,".").replace(u,y=>String(n.get(y))).replaceAll(d,"").replaceAll(p,"-"))==="")return null;const m=Number(f);return isNaN(m)?null:m},DE.set(e,r)}return r(t)}BT(()=>{Hg=new WeakMap,x5={}});const DE=new Map,T5=()=>L.getLogger("esri.intl.substitute");function tM(t,e,r={}){const{format:i={}}=r;return sl(t,s=>jZ(s,e,i))}function jZ(t,e,r){let i,s;const n=t.indexOf(":");if(n===-1?i=t.trim():(i=t.slice(0,n).trim(),s=t.slice(n+1).trim()),!i)return"";const o=Ym(i,e);if(o==null)return"";const l=(s?r?.[s]:null)??r?.[i];return l?VZ(o,l):s?zZ(o,s):rM(o)}function VZ(t,e){switch(e.type){case"date":return Xa(t,e.intlOptions);case"number":return kv(t,e.intlOptions);default:return T5().warn("missing format descriptor for key {key}"),rM(t)}}function zZ(t,e){switch(e.toLowerCase()){case"dateformat":return Xa(t);case"numberformat":return kv(t);default:return T5().warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?Xa(t):/^numberformat/i.test(e)?kv(t):rM(t)}}function rM(t){switch(typeof t){case"string":return t;case"number":return kv(t);case"boolean":return""+t;default:return t instanceof Date?Xa(t):""}}async function UZ(t,e,r,i){const s=e.exec(r);if(!s)throw new x("esri-intl:invalid-bundle",`Bundle id "${r}" is not compatible with the pattern "${e}"`);const n=s[1]?`${s[1]}/`:"",o=s[2],l=yF(i),u=`${n}${o}.json`,d=l?`${n}${o}_${l}.json`:u;let p;try{p=await jE(t(d))}catch(f){if(d===u)throw new x("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:f});try{p=await jE(t(u))}catch(m){throw new x("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:m})}}return p}async function jE(t){if(VE.fetchBundleAsset!=null)return VE.fetchBundleAsset(t);const e=await Ae(t,{responseType:"text"});return JSON.parse(e.data)}let qZ=class{constructor({base:e="",pattern:r,location:i=new URL(window.location.href)}){let s;s=typeof i=="string"?n=>new URL(n,new URL(i,window.location.href)).href:i instanceof URL?n=>new URL(n,i).href:i,this.pattern=typeof r=="string"?new RegExp(`^${r}`):r,this.getAssetUrl=s,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,r){return UZ(this.getAssetUrl,this.matcher,e,r)}};function GZ(t){return new qZ(t)}const VE={};SH(GZ({pattern:"esri/",location:ot}));let Qn=class extends X{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const e=this.language;let r=e==="local"||e==="global"?e:yF(e??vi())??"global";return r=r==="no"?"nb":r,r}};a([c()],Qn.prototype,"apiKey",void 0),a([c()],Qn.prototype,"id",void 0),a([c()],Qn.prototype,"language",void 0),a([c()],Qn.prototype,"places",void 0),a([c()],Qn.prototype,"serviceUrl",void 0),a([c()],Qn.prototype,"worldview",void 0),Qn=a([b("esri.support.BasemapStyle")],Qn);const BZ=Qn,M5=Symbol("BasemapInstance");function s_e(t){return t!=null&&typeof t=="object"&&M5 in t}function ne(t,e,r={}){return iM(t,e,r,I5)}function Gi(t,e,r={}){return iM(t,e,r,E5)}function iM(t,e,r={},i){let s=null;const n=r.once?(o,l)=>{i(o)&&(He(s),e(o,l))}:(o,l)=>{i(o)&&e(o,l)};if(s=Zq(t,n,r.sync,r.equals),r.initial){const o=t();n(o,o)}return s}function Fu(t,e,r,i={}){let s=null,n=null,o=null;function l(){s&&n&&(n.remove(),i.onListenerRemove?.(s),s=null,n=null)}function u(p){i.once&&i.once&&He(o),r(p)}const d=ne(t,(p,f)=>{l(),gw(p)&&(s=p,n=qh(p,e,u),i.onListenerAdd?.(p))},{sync:i.sync,initial:!0});return o=Te(()=>{d.remove(),l()}),o}function Nw(t,e){return HZ(t,E5,e)}function HZ(t,e,r){if(Pr(r))return Promise.reject(Fe());const i=t();if(e?.(i))return Promise.resolve(i);let s=null;function n(){s=He(s)}return new Promise((o,l)=>{s=qu([ys(r,()=>{n(),l(Fe())}),iM(t,u=>{n(),o(u)},{sync:!1,once:!0},e??I5)])})}function I5(t){return!0}function E5(t){return!!t}function n_e(t,e,r={}){let i=!1;const s=ne(t,(n,o)=>{i||e(n,o)},r);return{remove(){s.remove()},pause(){i=!0},resume(){i=!1}}}const jn={sync:!0},Ot={initial:!0},Tr={sync:!0,initial:!0};let O5=0;const Dw=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+O5++})}};return r=a([b("esri.core.Identifiable")],r),r},sM=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:O5++})}};return r=a([b("esri.core.Identifiable.NumericIdentifiable")],r),r};Dw(class{});async function WZ(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:r}=await N(async()=>{const{fromItem:i}=await import("./portalLayers-2q0CTmdf.js");return{fromItem:i}},__vite__mapDeps([6,7,8,9,10]));try{return await r(e)}catch(i){const s=e?.portalItem,n=s?.id||"unset",o=s?.portal?.url||_e.portalUrl;throw L.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+o+"', id: '"+n+"')",i),i}}const zE={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function ib(t,e,r,i=rn){const s=new _i(eM(i)),n=Y.fromJSDate(t,{zone:s}),o=r==="decades"||r==="centuries"?"year":C5(r);return r==="decades"&&(e*=10),r==="centuries"&&(e*=100),n.plus({[o]:e}).toJSDate()}function o_e(t,e,r="milliseconds"){const i=t.getTime(),s=k5(e,r,"milliseconds");return new Date(i+s)}function UE(t,e,r=rn){const i=new _i(eM(r)),s=Y.fromJSDate(t,{zone:i});if(e==="decades"||e==="centuries"){const o=s.startOf("year"),{year:l}=o,u=l-l%(e==="decades"?10:100);return o.set({year:u}).toJSDate()}const n=C5(e);return s.startOf(n).toJSDate()}function k5(t,e,r){return t===0?0:t*zE[e]/zE[r]}function a_e(t,e){return t&&e?t.intersection(e):t||e}function C5(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var Yi,qd;let Et=(qd=class extends F{static get allTime(){return qE}static get empty(){return ZZ}static fromArray(e){return new Yi({start:e[0]!=null?new Date(e[0]):e[0],end:e[1]!=null?new Date(e[1]):e[1]})}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,r){return r.end!=null?new Date(r.end):null}writeEnd(e,r){r.end=e?.getTime()??null}get isAllTime(){return this.equals(Yi.allTime)}get isEmpty(){return this.equals(Yi.empty)}readStart(e,r){return r.start!=null?new Date(r.start):null}writeStart(e,r){r.start=e?.getTime()??null}clone(){return new Yi({end:this.end,start:this.start})}equals(e){if(!e)return!1;const r=this.start?.getTime()??this.start,i=this.end?.getTime()??this.end,s=e.start?.getTime()??e.start,n=e.end?.getTime()??e.end;return r===s&&i===n}expandTo(e,r=rn){if(this.isEmpty||this.isAllTime)return this.clone();let i=this.start;i&&(i=UE(i,e,r));let s=this.end;if(s){const n=UE(s,e,r);s=s.getTime()===n.getTime()?n:ib(n,1,e,r)}return new Yi({start:i,end:s})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return Yi.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const r=this.start?.getTime()??-1/0,i=this.end?.getTime()??1/0,s=e.start?.getTime()??-1/0,n=e.end?.getTime()??1/0;let o,l;return s>=r&&s<=i?o=s:r>=s&&r<=n&&(o=r),i>=s&&i<=n?l=i:n>=r&&n<=i&&(l=n),o==null||l==null||isNaN(o)||isNaN(l)?Yi.empty:new Yi({start:o===-1/0?null:new Date(o),end:l===1/0?null:new Date(l)})}offset(e,r,i=rn){if(this.isEmpty||this.isAllTime)return this.clone();const s=new Yi,{start:n,end:o}=this;return n!=null&&(s.start=ib(n,e,r,i)),o!=null&&(s.end=ib(o,e,r,i)),s}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return qE.clone();const r=this.start!=null&&e.start!=null?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,i=this.end!=null&&e.end!=null?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new Yi({start:r,end:i})}},Yi=qd,qd);a([c({type:Date,json:{write:{allowNull:!0}}})],Et.prototype,"end",void 0),a([V("end")],Et.prototype,"readEnd",null),a([q("end")],Et.prototype,"writeEnd",null),a([c({readOnly:!0,json:{read:!1}})],Et.prototype,"isAllTime",null),a([c({readOnly:!0,json:{read:!1}})],Et.prototype,"isEmpty",null),a([c({type:Date,json:{write:{allowNull:!0}}})],Et.prototype,"start",void 0),a([V("start")],Et.prototype,"readStart",null),a([q("start")],Et.prototype,"writeStart",null),Et=Yi=a([b("esri.time.TimeExtent")],Et);const qE=new Et,ZZ=new Et({start:void 0,end:void 0});let JZ=0,tt=class extends xw(Dw(ry)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new he(-180,-90,180,90,Z.WGS84),this.id=Date.now().toString(16)+"-layer-"+JZ++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Z.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const r=typeof e=="string"?{url:e}:e;return(await N(async()=>{const{fromUrl:i}=await import("./arcgisLayers-ClJXkjMU.js");return{fromUrl:i}},__vite__mapDeps([11,7,8,10]))).fromUrl(r)}static fromPortalItem(e){return WZ(e)}initialize(){this.when().catch(e=>{nr(e)||L.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const{parent:e}=this;e&&(this.parent=null,e.removeChildLayer?.(this))}get effectiveVisible(){return this.visible&&(this.parent?.effectiveVisible??!0)}get hasAttributionData(){return this.attributionDataUrl!=null}get loaded(){return super.loaded}removeFromParent(){const{parent:e}=this;e&&(e.removeChildLayer?.(this),this.parent=null)}get parsedUrl(){return Lr(this.url)}createLayerView(e,r){return Promise.reject(new x("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await Ae(e,{query:{f:"json"},responseType:"json"})).data;throw new x("layer:no-attribution-data","Layer does not have attribution data")}};a([c({type:String})],tt.prototype,"attributionDataUrl",void 0),a([c({readOnly:!0})],tt.prototype,"effectiveVisible",null),a([c({type:he})],tt.prototype,"fullExtent",void 0),a([c({readOnly:!0})],tt.prototype,"hasAttributionData",null),a([c({type:String,clonable:!1})],tt.prototype,"id",void 0),a([c({type:Boolean,nonNullable:!0})],tt.prototype,"legendEnabled",void 0),a([c({type:["show","hide","hide-children"]})],tt.prototype,"listMode",void 0),a([c({type:Number,range:{min:0,max:1},nonNullable:!0})],tt.prototype,"opacity",void 0),a([c({clonable:!1})],tt.prototype,"parent",void 0),a([c({readOnly:!0})],tt.prototype,"parsedUrl",null),a([c({type:Boolean,readOnly:!0})],tt.prototype,"persistenceEnabled",void 0),a([c({type:Boolean})],tt.prototype,"popupEnabled",void 0),a([c({type:Boolean})],tt.prototype,"attributionVisible",void 0),a([c({type:Z})],tt.prototype,"spatialReference",void 0),a([c({type:String})],tt.prototype,"title",void 0),a([c({readOnly:!0,json:{read:!1}})],tt.prototype,"type",void 0),a([c()],tt.prototype,"url",void 0),a([c({type:Et})],tt.prototype,"visibilityTimeExtent",void 0),a([c({type:Boolean,nonNullable:!0})],tt.prototype,"visible",void 0),tt=a([b("esri.layers.Layer")],tt);const jy=new WeakMap;function P5(t){return!t.destroyed&&(jy.has(t)||t.addHandles([ne(()=>{const{parent:e}=t;return!!(e&&e instanceof tt)&&(e.type==="catalog-dynamic-group"||P5(e))},e=>jy.set(t,e),Tr),Te(()=>jy.delete(t))]),jy.get(t))}function YZ(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function u_e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="graphics"}function KZ(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="map-image"}function QZ(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph"&&"layers"in t}function c_e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph-sublayer"}function GE(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="subtype-group"&&"sublayers"in t}function _c(t){return t?.type==="subtype-sublayer"}const d_e={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function lS(t){const e=t?.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function h_e(t){return t.type==="integrated-mesh"||t.type==="integrated-mesh-3dtiles"}function jw(t){return t?.type==="feature"&&!t.url&&t.source?.type==="memory"}function p_e(t){const e=t?.type;return(e==="feature"||e==="subtype-group"||e==="oriented-imagery")&&t?.source?.type==="feature-layer"}function XZ(t){return t?.type==="feature"&&t.source?.type==="feature-layer"}function eJ(t){return YZ(t)&&XZ(t)}async function nM(t,e){const r=Se?.findServerInfo(t);if(r?.currentVersion!=null)return r.owningSystemUrl||null;const i=t.toLowerCase().indexOf("/rest/services");if(i===-1)return null;const s=`${t.slice(0,i)}/rest/info`,n=e!=null?e.signal:null,{data:o}=await Ae(s,{query:{f:"json"},responseType:"json",signal:n});return o?.owningSystemUrl||null}function A5(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function tJ(t){return A5(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function rJ(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"knowledge-graph-sublayer":return!0;default:return!1}}function iJ(t){return!!rJ(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}function sJ(t,e){return null}function f_e(t){return null}function uS(t){return!t||t.type==="Feature Service"&&!t.sourceUrl}function m_e(t,e){!e||!uS(t)||sJ(t.url)}const nJ=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wcs","wms","wmts"]),oJ=new Set(["integrated-mesh-3dtiles"]),R5=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","parquet","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","video","web-tile","wcs","wfs","wms","wmts"]),aJ=new Set([...R5,"link-chart"]);function lJ(t){switch(t.layerContainerType){case"basemap-base-layers":return nJ;case"basemap-ground-layers":return oJ;case"operational-layers":return t.origin==="link-chart"?aJ:R5;default:return null}}function uJ(t,e){if(e.restrictedWebMapWriting){const r=lJ(e);return r==null||r.has(t.type)&&!jw(t)}return!0}function cJ(t,e){if(e)if(jw(t)){const r=Ym("featureCollection.layers",e),i=r?.[0]?.layerDefinition;i&&BE(t,i)}else t.type!=="group"&&BE(t,e)}function BE(t,e){"maxScale"in t&&(e.maxScale=bv(t.maxScale)??void 0),"minScale"in t&&(e.minScale=bv(t.minScale)??void 0)}function dJ(t,e){if(cJ(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=bv(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(jw(t)){const r=e.featureCollection;r&&(r.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function sb(t,e,r){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return r?.messages&&r.messages.push(new x("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(jw(t)&&!t.isTable)e=t.resourceInfo;else if(uJ(t,r)){const i={};return t.write(i,r)?i:null}return e!=null&&dJ(t,e=E(e)),e}var HE,Sc,_u;let ti=(_u=class extends ol(ry){constructor(e){super(e),this[HE]=!0,this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.type="Basemap",this.id=Date.now().toString(16)+"-basemap-"+Sc.idCounter++,this.baseLayers=new H,this.referenceLayers=new H,this.groundLayers=new H;const r=l=>{const{parent:u}=l;u&&u!==this&&"remove"in u&&u.remove?.(l),l.parent=this,l.type!=="elevation"&&l.type!=="integrated-mesh-3dtiles"||L.getLogger(this).error(`Layer '${l.title}, id:${l.id}' of type '${l.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=l=>{const{parent:u}=l;u&&u!==this&&"remove"in u&&u.remove?.(l),l.parent=this},s=l=>{const u=l.item;return u.parent===this?(L.getLogger(this).error(`Layer '${u.title}, id:${u.id}' of type '${u.type}' already a ground layer, second add will be ignored.`),void l.preventDefault()):u.type!=="integrated-mesh-3dtiles"&&u.type!=="integrated-mesh"?(L.getLogger(this).error(`Layer '${u.title}, id:${u.id}' of type '${u.type}' is not supported as a ground layer and will therefore be ignored.`),void l.preventDefault()):void 0},n=l=>{l.parent=null},o=l=>{l.parent===this&&(l.parent=null)};this.addHandles([this.baseLayers.on("after-add",l=>r(l.item)),this.baseLayers.on("after-remove",l=>n(l.item)),this.referenceLayers.on("after-add",l=>r(l.item)),this.referenceLayers.on("after-remove",l=>n(l.item)),this.groundLayers.on("before-add",s),this.groundLayers.on("after-add",l=>i(l.item)),this.groundLayers.on("after-remove",l=>o(l.item))])}initialize(){this.when().catch(e=>{L.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const s of e)s.destroyed||s.destroy();const r=this.groundLayers.toArray();for(const s of r)s.destroyed||s.destroy();const i=this.referenceLayers.toArray();for(const s of i)s.destroyed||s.destroy();this.baseLayers.destroy(),this.groundLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=Ke(this.portalItem)}removeChildLayer(e){for(const r of[this.baseLayers,this.referenceLayers,this.groundLayers])r.remove(e)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",Pn(e,this._get("baseLayers")))}_writeBaseLayers(e,r,i){const s=[];e&&(i={...i,layerContainerType:"basemap-base-layers"},this.baseLayers.forEach(n=>{const o=sb(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);o!=null&&s.push(o)}),this.referenceLayers.forEach(n=>{const o=sb(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);o!=null&&(n.type!=="scene"&&(o.isReference=!0),s.push(o))})),r.baseMapLayers=s}set groundLayers(e){this._set("groundLayers",Pn(e,this._get("groundLayers")))}_writeGroundLayers(e,r,i){const s=[];e&&(i={...i,layerContainerType:"basemap-ground-layers"},this.groundLayers.forEach(n=>{const o=sb(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);o!=null&&s.push(o)}),s.length>0&&(r.groundLayers=s))}get loaded(){return super.loaded}set referenceLayers(e){this._set("referenceLayers",Pn(e,this._get("referenceLayers")))}writeTitle(e,r){r.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return FL(this,e=>{e(this.baseLayers,this.groundLayers,this.referenceLayers)})}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(r=>Ff(r)?r.clone():r),groundLayers:this.groundLayers.map(r=>Ff(r)?r.clone():r),referenceLayers:this.referenceLayers.map(r=>Ff(r)?r.clone():r)};return this.loaded&&(e.loadStatus="loaded"),new Sc({resourceInfo:this.resourceInfo}).set(e)}read(e,r){this.resourceInfo||this._set("resourceInfo",{data:e,context:r}),super.read(e,r)}write(e,r){return e=e||{},r?.origin||(r={origin:"web-map",...r}),super.write(e,r),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(i=>{const s=E(i);return s.url&&Fn(s.url)&&(s.url=`https:${s.url}`),s.templateUrl&&Fn(s.templateUrl)&&(s.templateUrl=`https:${s.templateUrl}`),s})),e}async _loadFromSource(e){const{resourceInfo:r,portalItem:i,style:s}=this;We(e);const n=[];if(r){const o=r.context?r.context.url:null;if(n.push(this._loadLayersFromJSON(r.data,o,e)),r.data.id&&!r.data.title){const l=r.data.id;n.push(TH(l).then(u=>{u&&this.read({title:u},r.context)}))}}else i?n.push(this._loadFromItem(i,e)):s&&n.push(this._loadFromStylesService(s,e));await Promise.all(n)}async _loadLayersFromJSON(e,r,i){const s=this.resourceInfo?.context,n=this.portalItem?.portal||s?.portal||null,o=pJ[s?.origin||""]??"web-map",{populateOperationalLayers:l}=await N(async()=>{const{populateOperationalLayers:d}=await import("./layersCreator-JmLJf3d4.js");return{populateOperationalLayers:d}},__vite__mapDeps([12,9,8,7,10,6])),u=[];if(We(i),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const d={context:{...s,origin:o,url:r,portal:n,layerContainerType:"basemap-base-layers"},defaultLayerType:"DefaultTileLayer"},p=y=>o==="web-scene"&&y.layerType==="ArcGISSceneServiceLayer"||y.isReference,f=l(this.baseLayers,e.baseMapLayers.filter(y=>!p(y)),d);u.push(f);const m=l(this.referenceLayers,e.baseMapLayers.filter(p),d);u.push(m)}if(e.groundLayers&&Array.isArray(e.groundLayers)){const d={context:{...s,origin:o,url:r,portal:n,layerContainerType:"basemap-ground-layers"},defaultLayerType:"IntegratedMesh3DTilesLayer"},p=l(this.groundLayers,e.groundLayers,d);u.push(p)}await Promise.allSettled(u)}async _loadFromItem(e,r){const i=await e.load(r),s=await i.fetchData("json",r),n=Lr(e.itemUrl??"");return this._set("resourceInfo",{data:s.baseMap??{},context:{origin:hJ[e.type||""]??"web-map",portal:e.portal||j.getDefault(),url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:s.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||j.getDefault(),url:n}),this._loadLayersFromJSON(this.resourceInfo.data,n,r)}async _loadFromStylesService(e,r){const i=e.serviceUrl.endsWith("/webmaps")?e.serviceUrl.slice(0,-8):e.serviceUrl,s=`${i}/styles/${e.id}/self`,n=`${i}/webmaps/${e.id}`,o=e.apiKey??_e.apiKeys.basemapStyles,[l,u]=await Promise.all([(await Ae(s,{query:{token:o},signal:r?.signal})).data,(await Ae(n,{query:{language:e.languageParameter,places:e.places,worldview:e.worldview,token:o},signal:r?.signal})).data]);this.thumbnailUrl??=l.thumbnailUrl;const d=Lr(n);if(this._set("resourceInfo",{data:u.baseMap??{},context:{origin:"web-map",url:d}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:u.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,d,r),o)for(const p of[...this.baseLayers,...this.groundLayers,...this.referenceLayers])"apiKey"in p&&(p.apiKey=o)}static fromId(e){const r=Z_[e];return r?r.itemId?new Sc({portalItem:{id:r.itemId,portal:{url:"https://www.arcgis.com"}}}):Sc.fromJSON(r,r.is3d?{origin:"web-scene",portal:new j({url:"https://www.arcgis.com"})}:{origin:"web-map"}):null}},HE=M5,Sc=_u,_u.idCounter=0,_u);a([c({json:{read:!1,write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,r,i){this._writeBaseLayers(t,e,i)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:H}},writer(t,e,r,i){this._writeBaseLayers(t,e,i)}}}}}})],ti.prototype,"baseLayers",null),a([c({json:{read:!1,write:{ignoreOrigin:!0,target:"groundLayers",writer(t,e,r,i){this._writeGroundLayers(t,e,i)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{groundLayers:{type:H}},writer(t,e,r,i){this._writeGroundLayers(t,e,i)}}}}}})],ti.prototype,"groundLayers",null),a([c({type:String,json:{origins:{"web-scene":{write:!0}}}})],ti.prototype,"id",void 0),a([c({type:de})],ti.prototype,"portalItem",void 0),a([c()],ti.prototype,"referenceLayers",null),a([c({readOnly:!0})],ti.prototype,"resourceInfo",void 0),a([c({type:Z})],ti.prototype,"spatialReference",void 0),a([c({type:BZ})],ti.prototype,"style",void 0),a([c()],ti.prototype,"thumbnailUrl",void 0),a([c({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],ti.prototype,"title",void 0),a([q("title")],ti.prototype,"writeTitle",null),ti=Sc=a([b("esri.Basemap")],ti);const hJ={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},pJ={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},zf=ti,fJ=Object.freeze(Object.defineProperty({__proto__:null,default:zf},Symbol.toStringTag,{value:"Module"})),Cv={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function L5(t){return!!Cv[t]||!!Cv[t.toLowerCase()]}function oM(t){return Cv[t]??Cv[t.toLowerCase()]}function mJ(t){return[...oM(t)]}function nb(t,e,r){r<0&&++r,r>1&&--r;const i=6*r;return i<1?t+(e-t)*i:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}function F5(t,e,r,i=1){const s=(t%360+360)%360/360,n=r<=.5?r*(e+1):r+e-r*e,o=2*r-n;return[Math.round(255*nb(o,n,s+1/3)),Math.round(255*nb(o,n,s)),Math.round(255*nb(o,n,s-1/3)),i]}function yJ(t){const e=t.length>5,r=e?8:4,i=(1<<r)-1,s=e?1:17,n=e?t.length===9:t.length===5;let o=+("0x"+t.slice(1));if(isNaN(o))return null;const l=[0,0,0,1];let u;return n&&(u=o&i,o>>=r,l[3]=s*u/255),u=o&i,o>>=r,l[2]=s*u,u=o&i,o>>=r,l[1]=s*u,u=o&i,o>>=r,l[0]=s*u,l}function N5(t){if(!t.startsWith("#")||isNaN(+`0x${t.slice(1)}`))return null;switch(t.length){case 4:case 5:{const e=parseInt(t.slice(1,2),16),r=parseInt(t.slice(2,3),16),i=parseInt(t.slice(3,4),16),s=t.length===4?15:parseInt(t.slice(4),16);return[e+16*e,r+16*r,i+16*i,(s+16*s)/255]}case 7:case 9:return[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16),(t.length===7?255:parseInt(t.slice(7),16))/255];default:return null}}function D5(t){const e=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(e){const r=e[2].split(/\s*,\s*/),i=e[1];if(i==="rgb"&&r.length===3||i==="rgba"&&r.length===4){if(r[0].endsWith("%")){const s=r.map(n=>2.56*parseFloat(n));return r.length===4&&(s[3]=parseFloat(r[3])),WE(s)}return WE(r.map(s=>parseFloat(s)))}if(i==="hsl"&&r.length===3||i==="hsla"&&r.length===4)return F5(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100,parseFloat(r[3]??"1"))}return null}function WE(t){return t[0]=Id(t[0]),t[1]=Id(t[1]),t[2]=Id(t[2]),t[3]=t.length===4?V5(t[3]):1,t}function j5(t){let e=L5(t)?oM(t):null;return e??=D5(t),e??=N5(t),e}function y_e(t){const e=j5(t);return e!=null?[e[0]/255,e[1]/255,e[2]/255,e[3]]:null}function V5(t){return z5(t,0,1)}function Id(t){return Math.round(z5(t,0,255))}function z5(t,e,r){return t=Number(t),isNaN(t)?r:t<e?e:t>r?r:t}const U5=2.2,gJ=1/U5;function g_e(t){return t**U5}function v_e(t){return t**gJ}const ZE=new Float32Array(1);function w_e(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function Bi(t,e,r){return Math.min(Math.max(t,e),r)}function b_e(t){return!(t&t-1)}function __e(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function Wp(t,e,r){return t+(e-t)*r}function S_e(t,e,r,i,s){return Wp(i,s,(t-e)/(r-e))}function ly(t){return t*Math.PI/180}function q5(t){return 180*t/Math.PI}function $_e(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function x_e(t){return Math.acos(Bi(t,-1,1))}function vJ(t){return Math.asin(Bi(t,-1,1))}function Ui(t,e,r=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=r}function G5(t,e,r=1e-6){return!Ui(t,e,r)&&t>e}function cS(t,e,r=1e-6){return!Ui(t,e,r)&&t<e}function wJ(t,e,r=1e-6){return Ui(t,e,r)||t>e}const Pv=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function dS(t){return Pv.setFloat64(0,t),Pv.getBigInt64(0)}function bJ(t){return Pv.setBigInt64(0,t),Pv.getFloat64(0)}const Wg=1000000n,_J=B5(1);function B5(t){const e=dS(t=Math.abs(t)),r=bJ(e<=Wg?Wg:e-Wg);return Math.abs(t-r)}function T_e(t,e,r=_J){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(r!=null&&B5(Math.min(Math.abs(t),Math.abs(e)))<r)return Math.abs(t-e)<=r;const i=dS(t),s=dS(e);return i<0!=s<0?!1:!((i<s?s-i:i-s)>Wg)}function H5(t,e,r=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;const i=Math.abs(t-e),s=Math.abs(t),n=Math.abs(e);if(t===0||e===0||s<1e-12&&n<1e-12){if(i>.01*r)return!1}else if(i/(s+n)>r)return!1;return!0}function M_e(t){return W5(Math.max(-JE,Math.min(t,JE)))}function W5(t){return ZE[0]=t,ZE[0]}function I_e(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],i=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(Ui(e,1)&&Ui(r,1)&&Ui(i,1))}function E_e(t,e){return(t%e+e)%e}const JE=W5(34028234663852886e22);function O_e(t,e,r){if(r===void 0||+r==0)return Math[t](e);if(e=+e,r=+r,isNaN(e)||typeof r!="number"||r%1!=0)return NaN;let i=e.toString().split("e");return i=(e=Math[t](+(i[0]+"e"+(i[1]?+i[1]-r:-r)))).toString().split("e"),+(i[0]+"e"+(i[1]?+i[1]+r:r))}function Vy(t){return Bi(MT(t),0,255)}function zy(t,e){const r=t.toString(16).padStart(2,"0");return e?r.slice(0,1):r}let ue=class Ki{static blendColors(e,r,i,s=new Ki){return s.r=Math.round(e.r+(r.r-e.r)*i),s.g=Math.round(e.g+(r.g-e.g)*i),s.b=Math.round(e.b+(r.b-e.b)*i),s.a=e.a+(r.a-e.a)*i,s._sanitize()}static fromRgb(e,r){const i=D5(e);return i?Ki.fromArray(i,r):null}static fromHex(e,r=new Ki){const i=N5(e);return i?Ki.fromArray(i,r):null}static fromArray(e,r=new Ki){return r._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(r.a)&&(r.a=1),r._sanitize()}static fromString(e,r){const i=j5(e);return i?Ki.fromArray(i,r):null}static fromJSON(e){return e!=null?new Ki([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e,r){return e==null?null:(r??=[0,0,0,0],r[0]=e.r/255,r[1]=e.g/255,r[2]=e.b/255,r[3]=e.a!=null?e.a:1,r)}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?Ki.fromString(e,this):Array.isArray(e)?Ki.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof Ki||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const r=e?.capitalize??!1,i=e?.digits??6,s=i===3||i===4,n=i===4||i===8,o=`#${zy(this.r,s)}${zy(this.g,s)}${zy(this.b,s)}${n?zy(Math.round(255*this.a),s):""}`;return r?o.toUpperCase():o}toCss(e=!1){const r=this.r+", "+this.g+", "+this.b;return e?`rgba(${r}, ${this.a})`:`rgb(${r})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=0){const r=Vy(this.r),i=Vy(this.g),s=Vy(this.b);return e===0||this.a!==1?[r,i,s,Vy(255*this.a)]:[r,i,s]}clone(){return new Ki(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Id(this.r),this.g=Id(this.g),this.b=Id(this.b),this.a=V5(this.a),this}_set(e,r,i,s){this.r=e,this.g=r,this.b=i,this.a=s}};ue.prototype.declaredClass="esri.Color";let Zs=class extends H{constructor(e){super(e),this.getCollections=null}initialize(){this.addHandles(lL(()=>this._refresh(),jn))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections?.();if(e==null)return void this.removeAll();let r=0;for(const i of e)i!=null&&(r=this._processCollection(r,i));this.splice(r)}_createNewInstance(e){return new H(e)}_processCollection(e,r){if(!r)return e;const i=this.itemFilterFunction??(s=>!!s);for(const s of r)if(s){if(i(s)){const n=this.indexOf(s,e);n>=0?n!==e&&this.reorder(s,e):this.add(s,e),++e}if(this.getChildrenFunction){const n=this.getChildrenFunction(s);if(Array.isArray(n))for(const o of n)e=this._processCollection(e,o);else e=this._processCollection(e,n)}}return e}};a([c()],Zs.prototype,"getCollections",void 0),a([c()],Zs.prototype,"getChildrenFunction",void 0),a([c()],Zs.prototype,"itemFilterFunction",void 0),Zs=a([b("esri.core.CollectionFlattener")],Zs);function se(t,e={}){const r=t instanceof $e?t:new $e(t,e),{alwaysWriteDefaults:i,default:s,ignoreUnknown:n=!0,name:o,nonNullable:l,readOnly:u=!1}=e;return c({type:n?r.apiValues:String,json:{type:r.jsonValues,default:s,name:o,read:!u&&{reader:r.read},write:{writer:r.write,alwaysWriteDefaults:i}},nonNullable:l,readOnly:u})}var hS;let Zg=hS=class extends F{constructor(t){super(t),this.type="none"}clone(){return new hS({type:this.type})}};a([se({none:"none",stayAbove:"stay-above"}),c({json:{write:{isRequired:!0}}})],Zg.prototype,"type",void 0),Zg=hS=a([b("esri.ground.NavigationConstraint")],Zg);const Z5=Symbol("GroundInstance");function C_e(t){return t!=null&&typeof t=="object"&&Z5 in t}function Vw(t){const e=MT(100*(1-t));return Math.max(0,Math.min(e,100))}function Tm(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var YE,pS,VA;let Qi=pS=(VA=class extends ol(ry){constructor(t){super(t),this[YE]=!0,this.parent=null,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new H;const e=i=>{const{parent:s}=i;s&&s!==this&&"remove"in s&&s.remove?.(i),i.parent=this,i.type!=="elevation"&&i.type!=="base-elevation"&&L.getLogger(this).error(`Layer '${i.title}, id:${i.id}' of type '${i.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},r=i=>{i.parent=null};this.addHandles([this.layers.on("after-add",i=>e(i.item)),this.layers.on("after-remove",i=>r(i.item))]),this.allLayers=new Zs({getCollections:()=>[this.layers,this.parent?.basemap?.groundLayers]})}removeChildLayer(t){this.layers.remove(t)}initialize(){this.when().catch(t=>{nr(t)||L.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}get integratedMeshGround(){const t=this.parent?.basemap?.groundLayers.at(0);return t?.replacesTerrain?t:null}destroy(){const t=this.layers.removeAll();for(const e of t)Ke(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}get loaded(){return super.loaded}get layers(){return this._get("layers")}set layers(t){this._set("layers",Pn(t,this._get("layers")))}writeLayers(t,e,r,i){const s=[];t&&(i={...i,layerContainerType:"ground"},t.forEach(n=>{if("write"in n){const o={};uU(n)().write(o,i)&&s.push(o)}else i?.messages&&i.messages.push(new x("layer:unsupported",`Layers (${n.title}, ${n.id}) of type '${n.declaredClass}' cannot be persisted in the ground`,{layer:n}))})),e.layers=s}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return FL(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e?.signal});const{queryAll:r}=await N(()=>import("./ElevationQuery-Dvj2DDkD.js"),__vite__mapDeps([13,14]));return We(e),r(this.layers.filter(KE).toArray(),t,e)}async createElevationSampler(t,e){await this.load({signal:e?.signal});const{createSampler:r}=await N(()=>import("./ElevationQuery-Dvj2DDkD.js"),__vite__mapDeps([13,14]));return We(e),r(this.layers.filter(KE).toArray(),t,e)}clone(){const t={opacity:this.opacity,surfaceColor:E(this.surfaceColor),navigationConstraint:E(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new pS({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,r){const i=e?.origin||"web-scene",s=e?.portal||null,n=e?.url||null,{populateOperationalLayers:o}=await N(async()=>{const{populateOperationalLayers:u}=await import("./layersCreator-JmLJf3d4.js");return{populateOperationalLayers:u}},__vite__mapDeps([12,9,8,7,10,6]));We(r);const l=[];if(t.layers&&Array.isArray(t.layers)){const u={context:{origin:i,url:n,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};l.push(o(this.layers,t.layers,u))}await Promise.allSettled(l)}},YE=Z5,VA);function KE(t){return t&&"createElevationSampler"in t}a([c()],Qi.prototype,"parent",void 0),a([c()],Qi.prototype,"integratedMeshGround",null),a([c({json:{read:!1,write:{isRequired:!0}}})],Qi.prototype,"layers",null),a([c()],Qi.prototype,"allLayers",void 0),a([q("layers")],Qi.prototype,"writeLayers",null),a([c({readOnly:!0})],Qi.prototype,"resourceInfo",void 0),a([c({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:xe,read:{reader:Tm,source:"transparency"},write:{writer:(t,e)=>{e.transparency=Vw(t)},target:"transparency"}}})],Qi.prototype,"opacity",void 0),a([c({type:ue,json:{type:[xe],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],Qi.prototype,"surfaceColor",void 0),a([c({type:Zg,json:{write:!0}})],Qi.prototype,"navigationConstraint",void 0),Qi=pS=a([b("esri.Ground")],Qi);const Av=Qi,SJ=Symbol("ClonableMixin"),pe=t=>{var s;var e;const r=t;let i=(s=class extends r{constructor(){super(...arguments),this[e]=!0}clone(n){const o=Xr(this);TR(o,"unable to clone instance of non-accessor class");const l=o.metadata,u=o.store,d={},p=new Map;for(const m in l){const y=l[m],g=u?.originOf(m),v=y.clonable;if(y.readOnly||v===!1||g!==7&&g!==0&&g!==5&&g!==4)continue;const _=this[m];let S=null;if(typeof v=="function")S=v(_,n);else if(v==="reference")S=_;else if(S=y_(_,n),_!=null&&S==null)continue;g===0?p.set(m,S):d[m]=S}const f=new(Object.getPrototypeOf(this)).constructor(d);if(p.size){const m=Xr(f)?.store;if(m)for(const[y,g]of p)m.set(y,g,0)}return f}},e=SJ,s);return i=a([b("esri.core.Clonable")],i),i},aM=pe(X),$J="randomUUID"in crypto;function rp(){if($J)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=r=>t[r].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function P_e(){return`{${rp().toUpperCase()}}`}function xJ(){return`{${rp()}}`}function TJ(t){const e=t.toUpperCase();return t.startsWith("{")?e:`{${e}}`}const rc={Base64:0,Hex:1,String:2,Raw:3},Ed=8,J5=(1<<Ed)-1;function Pa(t,e){const r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function MJ(t){const e=[];for(let r=0,i=t.length*Ed;r<i;r+=Ed)e[r>>5]|=(t.charCodeAt(r/Ed)&J5)<<r%32;return e}function IJ(t){const e=[];for(let r=0,i=32*t.length;r<i;r+=Ed)e.push(String.fromCharCode(t[r>>5]>>>r%32&J5));return e.join("")}function EJ(t){const e="0123456789abcdef",r=[];for(let i=0,s=4*t.length;i<s;i++)r.push(e.charAt(t[i>>2]>>i%4*8+4&15)+e.charAt(t[i>>2]>>i%4*8&15));return r.join("")}function OJ(t){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[];for(let s=0,n=4*t.length;s<n;s+=3){const o=(t[s>>2]>>s%4*8&255)<<16|(t[s+1>>2]>>(s+1)%4*8&255)<<8|t[s+2>>2]>>(s+2)%4*8&255;for(let l=0;l<4;l++)8*s+6*l>32*t.length?i.push("="):i.push(r.charAt(o>>6*(3-l)&63))}return i.join("")}function kJ(t,e){return t<<e|t>>>32-e}function zw(t,e,r,i,s,n){return Pa(kJ(Pa(Pa(e,t),Pa(i,n)),s),r)}function mr(t,e,r,i,s,n,o){return zw(e&r|~e&i,t,e,s,n,o)}function yr(t,e,r,i,s,n,o){return zw(e&i|r&~i,t,e,s,n,o)}function gr(t,e,r,i,s,n,o){return zw(e^r^i,t,e,s,n,o)}function vr(t,e,r,i,s,n,o){return zw(r^(e|~i),t,e,s,n,o)}function CJ(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let r=1732584193,i=-271733879,s=-1732584194,n=271733878;for(let o=0;o<t.length;o+=16){const l=r,u=i,d=s,p=n;r=mr(r,i,s,n,t[o],7,-680876936),n=mr(n,r,i,s,t[o+1],12,-389564586),s=mr(s,n,r,i,t[o+2],17,606105819),i=mr(i,s,n,r,t[o+3],22,-1044525330),r=mr(r,i,s,n,t[o+4],7,-176418897),n=mr(n,r,i,s,t[o+5],12,1200080426),s=mr(s,n,r,i,t[o+6],17,-1473231341),i=mr(i,s,n,r,t[o+7],22,-45705983),r=mr(r,i,s,n,t[o+8],7,1770035416),n=mr(n,r,i,s,t[o+9],12,-1958414417),s=mr(s,n,r,i,t[o+10],17,-42063),i=mr(i,s,n,r,t[o+11],22,-1990404162),r=mr(r,i,s,n,t[o+12],7,1804603682),n=mr(n,r,i,s,t[o+13],12,-40341101),s=mr(s,n,r,i,t[o+14],17,-1502002290),i=mr(i,s,n,r,t[o+15],22,1236535329),r=yr(r,i,s,n,t[o+1],5,-165796510),n=yr(n,r,i,s,t[o+6],9,-1069501632),s=yr(s,n,r,i,t[o+11],14,643717713),i=yr(i,s,n,r,t[o],20,-373897302),r=yr(r,i,s,n,t[o+5],5,-701558691),n=yr(n,r,i,s,t[o+10],9,38016083),s=yr(s,n,r,i,t[o+15],14,-660478335),i=yr(i,s,n,r,t[o+4],20,-405537848),r=yr(r,i,s,n,t[o+9],5,568446438),n=yr(n,r,i,s,t[o+14],9,-1019803690),s=yr(s,n,r,i,t[o+3],14,-187363961),i=yr(i,s,n,r,t[o+8],20,1163531501),r=yr(r,i,s,n,t[o+13],5,-1444681467),n=yr(n,r,i,s,t[o+2],9,-51403784),s=yr(s,n,r,i,t[o+7],14,1735328473),i=yr(i,s,n,r,t[o+12],20,-1926607734),r=gr(r,i,s,n,t[o+5],4,-378558),n=gr(n,r,i,s,t[o+8],11,-2022574463),s=gr(s,n,r,i,t[o+11],16,1839030562),i=gr(i,s,n,r,t[o+14],23,-35309556),r=gr(r,i,s,n,t[o+1],4,-1530992060),n=gr(n,r,i,s,t[o+4],11,1272893353),s=gr(s,n,r,i,t[o+7],16,-155497632),i=gr(i,s,n,r,t[o+10],23,-1094730640),r=gr(r,i,s,n,t[o+13],4,681279174),n=gr(n,r,i,s,t[o],11,-358537222),s=gr(s,n,r,i,t[o+3],16,-722521979),i=gr(i,s,n,r,t[o+6],23,76029189),r=gr(r,i,s,n,t[o+9],4,-640364487),n=gr(n,r,i,s,t[o+12],11,-421815835),s=gr(s,n,r,i,t[o+15],16,530742520),i=gr(i,s,n,r,t[o+2],23,-995338651),r=vr(r,i,s,n,t[o],6,-198630844),n=vr(n,r,i,s,t[o+7],10,1126891415),s=vr(s,n,r,i,t[o+14],15,-1416354905),i=vr(i,s,n,r,t[o+5],21,-57434055),r=vr(r,i,s,n,t[o+12],6,1700485571),n=vr(n,r,i,s,t[o+3],10,-1894986606),s=vr(s,n,r,i,t[o+10],15,-1051523),i=vr(i,s,n,r,t[o+1],21,-2054922799),r=vr(r,i,s,n,t[o+8],6,1873313359),n=vr(n,r,i,s,t[o+15],10,-30611744),s=vr(s,n,r,i,t[o+6],15,-1560198380),i=vr(i,s,n,r,t[o+13],21,1309151649),r=vr(r,i,s,n,t[o+4],6,-145523070),n=vr(n,r,i,s,t[o+11],10,-1120210379),s=vr(s,n,r,i,t[o+2],15,718787259),i=vr(i,s,n,r,t[o+9],21,-343485551),r=Pa(r,l),i=Pa(i,u),s=Pa(s,d),n=Pa(n,p)}return[r,i,s,n]}function lM(t,e=rc.Hex){const r=e||rc.Base64,i=CJ(MJ(t),t.length*Ed);switch(r){case rc.Raw:return i;case rc.Hex:return EJ(i);case rc.String:return IJ(i);case rc.Base64:return OJ(i)}}function PJ(t){return t&&"getAtOrigin"in t&&"originOf"in t}function fS(t){return uM[AJ(t)]||LJ}function AJ(t){return t.type==="json"?"application/json":t.type==="blob"?t.blob.type:RJ(t.url)}function RJ(t){const e=vR(t);return mS[e]||Y5}const uM={},Y5="text/plain",LJ=uM[Y5],mS={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const t in mS)uM[mS[t]]=t;function FJ(t){const e=t?.origins??[void 0];return(r,i)=>{const s=NJ(t,r,i);for(const n of e){const o=IT(r,n,i);for(const l in s)o[l]=s[l]}}}function NJ(t,e,r){if(t?.type==="resource")return DJ(t,e,r);switch(t?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:i,write:s}=v7;return{read:i,write:s}}}}function DJ(t,e,r){const i=Xm(e,r);return{type:String,read:(s,n,o)=>{const l=vw(s,n,o);return i.type===String?l:typeof i.type=="function"?new i.type({url:l}):void 0},write:{isRequired:i.json?.write?.isRequired,writer(s,n,o,l){if(!l?.resources)return typeof s=="string"?void(n[o]=Iu(s,l)):void(n[o]=s.write({},l));const u=zJ(s),d=Iu(u,{...l,verifyItemRelativeUrls:l?.verifyItemRelativeUrls?{writtenUrls:l.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},1),p=i.type!==String&&(!PJ(this)||l?.origin&&this.originIdOf(r)>Co(l.origin)),f={object:this,propertyName:r,value:s,targetUrl:d,dest:n,targetPropertyName:o,context:l,params:t};l?.portalItem&&d&&!gi(d)?p&&t?.contentAddressed?yS(f):p?jJ(f):VJ(f):l?.portalItem&&(d==null||IR(d)!=null||Vh(d)||p)?yS(f):n[o]=d}}}}function yS(t){const{targetUrl:e,params:r,value:i,context:s,dest:n,targetPropertyName:o}=t;if(!s.portalItem)return;const l=ER(e),u=Q5(i,e,s);if(r?.contentAddressed&&u.type!=="json")return void s.messages?.push(new x("persistable:contentAddressingUnsupported",`Property "${o}" is trying to serializing a resource with content of type ${u.type} with content addressing. Content addressing is only supported for json resources.`,{content:u}));const d=r?.contentAddressed&&u.type==="json"?lM(u.jsonString):l?.filename??rp(),p=Mu(r?.prefix??l?.prefix,d),f=`${p}.${fS(u)}`;if(r?.contentAddressed&&s.resources&&u.type==="json"){const g=s.resources.toKeep.find(({resource:v})=>v.path===f)??s.resources.toAdd.find(({resource:v})=>v.path===f);if(g)return void(n[o]=g.resource.itemRelativeUrl)}const m=s.portalItem.resourceFromPath(f);Vh(e)&&s.resources&&s.resources.pendingOperations.push(HU(e).then(g=>{m.path=`${p}.${fS({type:"blob",blob:g})}`,n[o]=m.itemRelativeUrl}).catch(()=>{}));const y=r?.compress??!1;s.resources&&K5({...t,resource:m,content:u,compress:y,updates:s.resources.toAdd}),n[o]=m.itemRelativeUrl}function jJ(t){const{context:e,targetUrl:r,params:i,value:s,dest:n,targetPropertyName:o}=t;if(!e.portalItem)return;const l=e.portalItem.resourceFromPath(r),u=Q5(s,r,e),d=fS(u),p=vR(l.path),f=i?.compress??!1;d===p?(e.resources&&K5({...t,resource:l,content:u,compress:f,updates:e.resources.toUpdate}),n[o]=r):yS(t)}function VJ({context:t,targetUrl:e,dest:r,targetPropertyName:i}){t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(e),compress:!1}),r[i]=e)}function K5({object:t,propertyName:e,updates:r,resource:i,content:s,compress:n}){const o=l=>{UJ(t,e,l)};r.push({resource:i,content:s,compress:n,finish:o})}function Q5(t,e,r){return typeof t=="string"?{type:"url",url:e}:{type:"json",jsonString:JSON.stringify(t.toJSON(r))}}function zJ(t){return t==null?null:typeof t=="string"?t:t.url}function UJ(t,e,r){typeof t[e]=="string"?t[e]=r.url:t[e].url=r.url}let Jg=class extends pe(F){constructor(e){super(e),this.color=null}};a([c({type:ue,json:{type:[xe],write:!0}})],Jg.prototype,"color",void 0),Jg=a([b("esri.effects.FocusAreaOutline")],Jg);const qJ=Jg;function R_e(t){const e=[];for(t.reset();t.nextPath();){const r=[];for(;t.nextPoint();)r.push([t.x,t.y]);e.push(r)}return t.reset(),e}function GJ(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}function L_e(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,r=t.hasM;if(t.type==="point")return r&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:r?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice();if(t.type==="polyline")return t.paths.slice();if(t.type==="multipoint")return t.points.map(i=>[i]);if(t.type==="extent"){const i=t.clone().normalize();if(!i)return null;let s=!1,n=!1;return i.forEach(o=>{o.hasZ&&(s=!0),o.hasM&&(n=!0)}),i.map(o=>{const l=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(s&&o.hasZ){const u=.5*(o.zmax-o.zmin);for(let d=0;d<l.length;d++)l[d].push(u)}if(n&&o.hasM){const u=.5*(o.mmax-o.mmin);for(let d=0;d<l.length;d++)l[d].push(u)}return l})}return null}function Uw(t,e){const r=e[0]-t[0],i=e[1]-t[1];if(t.length>2&&e.length>2){const s=t[2]-e[2];return Math.sqrt(r*r+i*i+s*s)}return Math.sqrt(r*r+i*i)}function X5(t,e,r){const i=t[0]+r*(e[0]-t[0]),s=t[1]+r*(e[1]-t[1]);return t.length>2&&e.length>2?[i,s,t[2]+r*(e[2]-t[2])]:[i,s]}function BJ(t,e,r,i){return HJ(t,e,r[i],r[i+1])}function HJ(t,e,r,i){const[s,n]=e,[o,l]=r,[u,d]=i,p=u-o,f=d-l,m=p*p+f*f,y=(s-o)*p+(n-l)*f,g=Math.min(1,Math.max(0,y/m));return t[0]=o+p*g,t[1]=l+f*g,t}function F_e(t,e,r,i,s,n){let o=r,l=i,u=s-o,d=n-l;if(u!==0||d!==0){const p=((t-o)*u+(e-l)*d)/(u*u+d*d);p>1?(o=s,l=n):p>0&&(o+=u*p,l+=d*p)}return u=t-o,d=e-l,u*u+d*d}function eN(t,e){return X5(t,e,.5)}function N_e(t){const e=t.length;let r=0;for(let i=0;i<e-1;++i)r+=Uw(t[i],t[i+1]);return r}function D_e(t,e){if(e<=0)return t[0];const r=t.length;let i=0;for(let s=0;s<r-1;++s){const n=Uw(t[s],t[s+1]);if(e-i<n){const o=(e-i)/n;return X5(t[s],t[s+1],o)}i+=n}return t[r-1]}function tN(t,e=0,r=1){let i=0;const s=t.length;let n=t[0];for(let o=1;o<s;o++){const l=t[o];i+=(l[e]-n[e])*(l[r]+n[r]),n=l}if(rN(t)){const o=t[0];i+=(o[e]-n[e])*(o[r]+n[r])}return i>=0}function rN(t){const e=t.length;return e>0&&!hw(t[0],t[e-1])}function j_e(t){"rings"in t&&(WJ(t),ZJ(t))}function WJ(t){if("rings"in t)for(const e of t.rings)rN(e)&&e.push(e[0].slice())}function ZJ(t){if(!("rings"in t)||t.rings.length===0||tN(t.rings[0]))return!1;for(const e of t.rings)e.reverse();return!0}function V_e(t){return t.type!=="polygon"&&t.type!=="polyline"||JJ(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function JJ(t,e){const r=Kr(e);if(!r)return;const i=r.valid[0],s=r.valid[1],n=s-i;for(const o of t){let l=1/0,u=-1/0;for(const p of o){const f=YJ(p[0],i,s);l=Math.min(l,f),u=Math.max(u,f),p[0]=f}const d=u-l;n-d<d&&o.forEach(p=>{p[0]<0&&(p[0]+=n)})}}function YJ(t,e,r){const i=r-e;return t<e?r-(e-t)%i:t>r?e+(t-e)%i:t}function z_e(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[r,i]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return r.length===i.length&&r.every((s,n)=>s.length===i[n].length)}function U_e(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function KJ(t){return QJ(t.rings,t.hasZ??!1)}function iN(t){const e=KJ(t);if(!e)return null;const{hasZ:r,spatialReference:i}=t,[s,n,o]=e;return isNaN(s)||isNaN(n)||r&&isNaN(o)?null:{x:s,y:n,z:r?o:void 0,spatialReference:i}}function QJ(t,e){if(!t?.length)return null;const r=[],i=[],s=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let n=0,o=t.length;n<o;n++){const l=sN(t[n],e,s);l&&i.push(l)}if(i.sort((n,o)=>{let l=n[2]-o[2];return l===0&&e&&(l=n[4]-o[4]),l}),i.length&&(r[0]=i[0][0],r[1]=i[0][1],e&&(r[2]=i[0][3]),(r[0]<s[0]||r[0]>s[1]||r[1]<s[2]||r[1]>s[3]||e&&(r[2]<s[4]||r[2]>s[5]))&&(r.length=0)),!r.length){const n=t[0]&&t[0].length?XJ(t[0],e):null;if(!n)return null;r[0]=n[0],r[1]=n[1],e&&n.length>2&&(r[2]=n[2])}return r}function sN(t,e,r){let i=0,s=0,n=0,o=0,l=0;const u=t.length?t[0][0]:0,d=t.length?t[0][1]:0,p=t.length&&e?t[0][2]:0;for(let m=0;m<t.length;m++){const y=t[m],g=t[(m+1)%t.length],[v,_,S]=y,M=v-u,C=_-d,[T,O,P]=g,D=T-u,z=O-d,B=M*z-D*C;if(o+=B,i+=(M+D)*B,s+=(C+z)*B,e&&y.length>2&&g.length>2){const G=S-p,Q=P-p,oe=M*Q-D*G;n+=(G+Q)*oe,l+=oe}v<r[0]&&(r[0]=v),v>r[1]&&(r[1]=v),_<r[2]&&(r[2]=_),_>r[3]&&(r[3]=_),e&&(S<r[4]&&(r[4]=S),S>r[5]&&(r[5]=S))}if(o>0&&(o*=-1),l>0&&(l*=-1),!o)return null;o*=.5,l*=.5;const f=[i/(6*o)+u,s/(6*o)+d,o];return e&&(r[4]===r[5]||l===0?(f[3]=(r[4]+r[5])/2,f[4]=0):(f[3]=n/(6*l)+p,f[4]=l)),f}function q_e(t,e){let r=0,i=0,s=0;t.nextPoint();const n=t.pathSize?t.x:0,o=t.pathSize?t.y:0;for(let l=0;l<t.pathSize;l++){t.seekInPath(l);const u=[t.x,t.y];t.seekInPath((l+1)%t.pathSize);const d=[t.x,t.y],[p,f]=u,m=p-n,y=f-o,[g,v]=d,_=g-n,S=v-o,M=m*S-_*y;s+=M,r+=(m+_)*M,i+=(y+S)*M,p<e[0]&&(e[0]=p),p>e[1]&&(e[1]=p),f<e[2]&&(e[2]=f),f>e[3]&&(e[3]=f)}return s>0&&(s*=-1),s?(s*=.5,[r/(6*s)+n,i/(6*s)+o,s]):null}function XJ(t,e){const r=e?[0,0,0]:[0,0],i=e?[0,0,0]:[0,0];let s=0,n=0,o=0,l=0;for(let u=0,d=t.length;u<d-1;u++){const p=t[u],f=t[u+1];if(p&&f){r[0]=p[0],r[1]=p[1],i[0]=f[0],i[1]=f[1],e&&p.length>2&&f.length>2&&(r[2]=p[2],i[2]=f[2]);const m=Uw(r,i);if(m){s+=m;const y=eN(p,f);n+=m*y[0],o+=m*y[1],e&&y.length>2&&(l+=m*y[2])}}}return s>0?e?[n/s,o/s,l/s]:[n/s,o/s]:t.length?t[0]:null}function eY(t){const{hasZ:e,totalSize:r}=t;if(r===0)return null;const i=[],s=[],n=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const o=sN(GJ(t),t.hasZ,n);o&&s.push(o)}if(s.sort((o,l)=>{let u=o[2]-l[2];return u===0&&e&&(u=o[4]-l[4]),u}),s.length&&(i[0]=s[0][0],i[1]=s[0][1],e&&(i[2]=s[0][3]),(i[0]<n[0]||i[0]>n[1]||i[1]<n[2]||i[1]>n[3]||e&&(i[2]<n[4]||i[2]>n[5]))&&(i.length=0)),!i.length){t.reset(),t.nextPath();const o=t.pathSize?tY(t):null;if(!o)return null;i[0]=o[0],i[1]=o[1],e&&o.length>2&&(i[2]=o[2])}return i}function tY(t){const{hasZ:e}=t,r=e?[0,0,0]:[0,0],i=e?[0,0,0]:[0,0];let s=0,n=0,o=0,l=0;if(t.nextPoint()){let u=t.x,d=t.y,p=t.z;for(;t.nextPoint();){const f=t.x,m=t.y,y=t.z;r[0]=u,r[1]=d,i[0]=f,i[1]=m,e&&(r[2]=p,i[2]=y);const g=Uw(r,i);if(g){s+=g;const v=eN(r,i);n+=g*v[0],o+=g*v[1],e&&v.length>2&&(l+=g*v[2])}u=f,d=m,p=y}}return s>0?e?[n/s,o/s,l/s]:[n/s,o/s]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const rY=1e-6;function G_e(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<rY){const s=eY(t);return s?[s[0],s[1]]:null}const r=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const i=[t.x,t.y];for(t.reset();t.nextPath();)sY(r,i,t);return r[0]*=1/e,r[1]*=1/e,r[0]+=i[0],r[1]+=i[1],r}const iY=1/3;function sY(t,e,r){if(!t||!r||r.pathSize<3)return null;r.nextPoint();const i=r.x,s=r.y;r.nextPoint();let n,o=r.x-i,l=r.y-s,u=0,d=0;for(;r.nextPoint();)u=r.x-i,d=r.y-s,n=.5*iY*(u*l-d*o),t[0]+=n*(o+u),t[1]+=n*(l+d),o=u,l=d;const p=r.getCurrentRingArea(),f=[i,s];return f[0]-=e[0],f[1]-=e[1],f[0]*=p,f[1]*=p,t[0]+=f[0],t[1]+=f[1],t}function yi(t=cY){return[t[0],t[1],t[2],t[3]]}function nN(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function nY(t,e,r,i,s=yi()){return s[0]=t,s[1]=e,s[2]=r,s[3]=i,s}function B_e(t,e=yi()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function oY(t,e,r=new he){return r.xmin=t[0],r.ymin=t[1],r.xmax=t[2],r.ymax=t[3],r.spatialReference=e,r}function us(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function aY(t,e){e<t[0]&&(t[0]=e),e>t[2]&&(t[2]=e)}function lY(t,e){e<t[1]&&(t[1]=e),e>t[3]&&(t[3]=e)}function H_e(t,e,r){if(e!=null)if("length"in e)vS(e)?(r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r[2]=Math.max(t[2],e[2]),r[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r[2]=Math.max(t[2],e[0]),r[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":r[0]=Math.min(t[0],e.xmin),r[1]=Math.min(t[1],e.ymin),r[2]=Math.max(t[2],e.xmax),r[3]=Math.max(t[3],e.ymax);break;case"point":r[0]=Math.min(t[0],e.x),r[1]=Math.min(t[1],e.y),r[2]=Math.max(t[2],e.x),r[3]=Math.max(t[3],e.y)}else nN(r,t)}function W_e(t,e,r=t){const i=e.length;let s=t[0],n=t[1],o=t[2],l=t[3];for(let u=0;u<i;u++){const d=e[u];s=Math.min(s,d[0]),n=Math.min(n,d[1]),o=Math.max(o,d[0]),l=Math.max(l,d[1])}return r[0]=s,r[1]=n,r[2]=o,r[3]=l,r}function Z_e(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function cM(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function dM(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function J_e(t){return cM(t)*dM(t)}function Y_e(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function K_e(t){const e=cM(t),r=dM(t);return Math.sqrt(e*e+r*r)}function Q_e(t,e){return!!t&&gS(t,e.x,e.y)}function gS(t,e,r){return e>=t[0]&&r>=t[1]&&e<=t[2]&&r<=t[3]}function X_e(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function eSe(t,e,r){return Math.max(e[0],t[0])-r<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])-r<=Math.min(e[3],t[3])}function uY(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function tSe(t,e,r,i){return i??=t,i[0]=t[0]+e,i[1]=t[1]+r,i[2]=t[2]+e,i[3]=t[3]+r,i}function rSe(t){return t?nN(t,QE):yi(QE)}function vS(t){return t!=null&&t.length===4}function iSe(t,e){return vS(t)&&vS(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const QE=[1/0,1/0,-1/0,-1/0],cY=[0,0,0,0];let hM=1e-6;function Qr(){return hM}function dY(t){hM=t}const qw=Math.random,hY=Math.PI/180,pY=180/Math.PI;function pM(t){return t*hY}function fY(t){return t*pY}function mY(t,e){return Math.abs(t-e)<=hM*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:qw,equals:mY,getEpsilon:Qr,setEpsilon:dY,toDegree:fY,toRadian:pM},Symbol.toStringTag,{value:"Module"}));function Od(t,e){return t[0]=e[0],t[1]=e[1],t}function sr(t,e,r){return t[0]=e,t[1]=r,t}function oN(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function Mm(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function aN(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function lN(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function yY(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function gY(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function vY(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function wY(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function bY(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function uy(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function _Y(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t}function Gw(t,e){const r=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(r*r+i*i)}function Im(t,e){const r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i}function Rv(t){const e=t[0],r=t[1];return Math.sqrt(e*e+r*r)}function uN(t){const e=t[0],r=t[1];return e*e+r*r}function cN(t,e){return t[0]=-e[0],t[1]=-e[1],t}function SY(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function wS(t,e){const r=e[0],i=e[1];let s=r*r+i*i;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s),t}function dN(t,e){return t[0]*e[0]+t[1]*e[1]}function hN(t,e,r){const i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t}function $Y(t,e,r,i){const s=e[0],n=e[1];return t[0]=s+i*(r[0]-s),t[1]=n+i*(r[1]-n),t}function xY(t,e=1){const r=2*qw()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function TY(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[2]*s,t[1]=r[1]*i+r[3]*s,t}function In(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[2]*s+r[4],t[1]=r[1]*i+r[3]*s+r[5],t}function Yg(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[3]*s+r[6],t[1]=r[1]*i+r[4]*s+r[7],t}function MY(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[4]*s+r[12],t[1]=r[1]*i+r[5]*s+r[13],t}function IY(t,e,r,i){const s=e[0]-r[0],n=e[1]-r[1],o=Math.sin(i),l=Math.cos(i);return t[0]=s*l-n*o+r[0],t[1]=s*o+n*l+r[1],t}function EY(t,e){const r=t[0],i=t[1],s=e[0],n=e[1];let o=r*r+i*i;o>0&&(o=1/Math.sqrt(o));let l=s*s+n*n;l>0&&(l=1/Math.sqrt(l));const u=(r*s+i*n)*o*l;return u>1?0:u<-1?Math.PI:Math.acos(u)}function OY(t){return"vec2("+t[0]+", "+t[1]+")"}function kY(t,e){return t[0]===e[0]&&t[1]===e[1]}function CY(t,e){const r=t[0],i=t[1],s=e[0],n=e[1],o=Qr();return Math.abs(r-s)<=o*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-n)<=o*Math.max(1,Math.abs(i),Math.abs(n))}function PY(t,e,r,i,s){let n=e[0]-r[0],o=e[1]-r[1];const l=(i[0]*n+i[1]*o)*(s-1);return n=i[0]*l,o=i[1]*l,t[0]=e[0]+n,t[1]=e[1]+o,t}const AY=Rv,fM=Mm,RY=aN,LY=lN,FY=Gw,NY=Im,DY=uN;Object.freeze(Object.defineProperty({__proto__:null,add:oN,angle:EY,ceil:yY,copy:Od,cross:hN,dist:FY,distance:Gw,div:LY,divide:lN,dot:dN,equals:CY,exactEquals:kY,floor:gY,inverse:SY,len:AY,length:Rv,lerp:$Y,max:wY,min:vY,mul:RY,multiply:aN,negate:cN,normalize:wS,projectAndScale:PY,random:xY,rotate:IY,round:bY,scale:uy,scaleAndAdd:_Y,set:sr,sqrDist:NY,sqrLen:DY,squaredDistance:Im,squaredLength:uN,str:OY,sub:fM,subtract:Mm,transformMat2:TY,transformMat2d:In,transformMat3:Yg,transformMat4:MY},Symbol.toStringTag,{value:"Module"}));function xo(t,e,r,i){return t[0]=e[0]*(1-i)+r[0]*i,t[1]=e[1]*(1-i)+r[1]*i,t}function Yr(t,e){return Im(t,e)}function sSe(t,e,r){const i=Yr(e,r);if(i===0)return Yr(e,t);const s=(e[0]-t[0])*(r[1]-t[1])-(e[1]-t[1])*(r[0]-t[0]);return s*s/i}function jY(t,e,r,i,s){const[n,o]=e,[l,u]=r,[d,p]=i,[f,m]=s,y=(n-l)*(p-m)-(o-u)*(d-f);if(y===0)return null;const g=(n*u-o*l)*(d-f)-(n-l)*(d*m-p*f),v=(n*u-o*l)*(p-m)-(o-u)*(d*m-p*f);return t[0]=g/y,t[1]=v/y,t}const Qs=2*Math.PI;function fu(t,e){const r=Math.atan2(t,e);return r<0?r+Qs:r}function pN(t){return Math.abs(t)%Qs}function XE(t){const e=pN(t);return e<Math.PI?e:Qs-e}function Bw(t,e){return{min:Math.min(t,e),max:Math.max(t,e)}}function fN(t,e,r,i){if(Ui(pN(t-e),0))return r?[t,t]:[t,i?t-Qs:t+Qs];const[s,n]=i?[t-Qs,t]:[t,t+Qs];return[t,cy({min:s,max:n},e)]}function cy({min:t,max:e},r){let i;return i=e-r,i>=Qs?(i-=i%Qs,r+i):(i=r-t,i>=Qs?(i-=i%Qs,r-i):r)}function VY(t,e){const r=cy(t,e);return r>t.min&&r<t.max?r:XE(r-t.min)<XE(r-t.max)?t.min:t.max}function mN(t,e,r,i=10){return e.map(s=>{let n=s;for(let o=0;o<i;o++){const[l,u,d,p,f,m]=r(n),y=t[0]-l,g=t[1]-u,v=-d,_=-p;n+=-(2*y*v+2*g*_)/(2*v*v+2*y*-f+2*_*_+2*g*-m||1e-6)}return n})}const zY=[0,0];function yN(t){const e=1-t,r=e*e,i=t*t;return[r*e,3*t*r,3*i*e,i*t]}function bS(t,e,r,i,s){const[n,o,l,u]=yN(s);return[t[0]*n+e[0]*o+r[0]*l+i[0]*u,t[1]*n+e[1]*o+r[1]*l+i[1]*u]}function eO(t,e,r,i,s){const[n,o,l,u]=yN(s);return t*n+e*o+r*l+i*u}function nSe(t,e,r){const i=t,[s,n,o]=e.b;return bS(i,n,o,s,r)}function UY(t,e,r){const i=t,[s,n,o]=e.b,l=xo([0,0],i,n,r),u=xo(zY,n,o,r),d=xo([0,0],o,s,r),p=xo([0,0],l,u,r),f=xo([0,0],u,d,r);return[{b:[xo([],p,f,r),l,p]},{b:[[...s],f,d]}]}function oSe(t,e,r){const i=t,[s,n,o]=e.b,l=mN(r,[.1,.5,.9],f=>{const m=1-f,[y,g]=bS(i,n,o,s,f);return[y,g,3*m*m*(n[0]-i[0])+6*m*f*(o[0]-n[0])+3*f*f*(s[0]-o[0]),3*m*m*(n[1]-i[1])+6*m*f*(o[1]-n[1])+3*f*f*(s[1]-o[1]),6*m*(o[0]-2*n[0]+i[0])+6*f*(s[0]-2*o[0]+n[0]),6*m*(o[1]-2*n[1]+i[1])+6*f*(s[1]-2*o[1]+n[1])]}).map(f=>Math.min(1,Math.max(0,f)));l.push(0,1);let u=1/0;const d=l.map(f=>{const m=bS(i,n,o,s,f),[y,g]=m,v=r[0]-y,_=r[1]-g,S=Math.sqrt(v*v+_*_);return u=Math.min(S,u),{t:f,curvePoint:m,distance:S}}),p=[];for(const f of d){const{t:m,distance:y}=f;H5(y,u)&&!p.some(({t:g})=>Ui(g,m))&&p.push(f)}return p}function qY(t,e,r){const i=e,[s,n,o]=r.b;if(us(t,i),us(t,s),gS(t,n[0],n[1])&&gS(t,o[0],o[1]))return t;for(const l of tO(i[0],n[0],o[0],s[0]))l>0&&l<1&&aY(t,eO(i[0],n[0],o[0],s[0],l));for(const l of tO(i[1],n[1],o[1],s[1]))l>0&&l<1&&lY(t,eO(i[1],n[1],o[1],s[1],l));return t}function tO(t,e,r,i){const s=3*(3*(e-r)-t+i),n=6*(t-2*e+r),o=3*(e-t);if(s===0)return n!==0?[-o/n]:[];const l=Math.sqrt(n*n-4*s*o);return[(-n+l)/(2*s),(-n-l)/(2*s)]}function aSe(t,e,r){let s=0,n=[e];for(let o=0;o<16;o++){let l=t;const u=[];for(const p of n)u.push(...UY(l,p,.5)),l=p.b[0];n=u,l=t,s=0;let d=0;for(const p of n){const[f,m,y]=p.b,g=Math.sqrt(Yr(l,f));s+=(g+(Math.sqrt(Yr(l,m))+Math.sqrt(Yr(m,y))+Math.sqrt(Yr(y,f))))/2,d+=g,l=f}if(s-d<r)return s}return s}function GY(t,e,r){const[i,s]=t,[n,o]=e,[l,u]=r,[d,p]=[n-i,o-s];let f=d*(l-i)+p*(u-s);f/=d**2+p**2,f=Bi(f,0,1);const m=xo([0,0],t,e,f);return{t:f,curvePoint:m,distance:Math.sqrt(Yr(m,r))}}let gN=class{constructor(e,r,i,s,n,o){this.cx=e,this.cy=r,this.radius=i,this.thetaStart=s,this.thetaEnd=n,this.isInvalid=o}get startPoint(){const{cx:e,cy:r,radius:i,thetaStart:s}=this;return[e+i*Math.cos(s),r+i*Math.sin(s)]}get endPoint(){const{cx:e,cy:r,radius:i,thetaEnd:s}=this;return[e+i*Math.cos(s),r+i*Math.sin(s)]}};function Lv(t,e){const{cx:r,cy:i,radius:s}=t;return[r+s*Math.cos(e),i+s*Math.sin(e)]}function Kg(t,e){if(t.isInvalid)return xo([0,0],t.startPoint,t.endPoint,e);const{thetaStart:r,thetaEnd:i}=t;return Lv(t,r*(1-e)+i*e)}function uSe(t,e){if(t.isInvalid)return GY(t.startPoint,t.endPoint,e);const{cx:r,cy:i,thetaStart:s,thetaEnd:n}=t,[o,l]=e,u=VY(Bw(s,n),Math.atan2(l-i,o-r)),d=Lv(t,u);return{t:(u-s)/(n-s),curvePoint:d,distance:Math.sqrt(Yr(e,d))}}function rO(t,e){if(e.isInvalid)return us(t,e.startPoint),us(t,e.endPoint),t;const{cx:r,cy:i,radius:s,thetaStart:n,thetaEnd:o}=e;us(t,Lv(e,n)),us(t,Lv(e,o));const l=Bw(n,o),u=Math.PI/2;let d=0;for(const p of[[r+s,i],[r,i+s],[r-s,i],[r,i-s]])d=cy(l,d),d>l.min&&d<l.max&&us(t,p),d+=u;return t}function cSe(t){if(t.isInvalid)return 2*t.radius;const{radius:e,thetaStart:r,thetaEnd:i}=t;return e*Math.abs(i-r)}function BY(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function HY(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function kd(t,e,r,i,s,n,o,l,u,d){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=n,t[5]=o,t[6]=l,t[7]=u,t[8]=d,t}function vN(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function wN(t,e){if(t===e){const r=e[1],i=e[2],s=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=i,t[7]=s}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function bN(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],l=e[5],u=e[6],d=e[7],p=e[8],f=p*o-l*d,m=-p*n+l*u,y=d*n-o*u;let g=r*f+i*m+s*y;return g?(g=1/g,t[0]=f*g,t[1]=(-p*i+s*d)*g,t[2]=(l*i-s*o)*g,t[3]=m*g,t[4]=(p*r-s*u)*g,t[5]=(-l*r+s*n)*g,t[6]=y*g,t[7]=(-d*r+i*u)*g,t[8]=(o*r-i*n)*g,t):null}function WY(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],l=e[5],u=e[6],d=e[7],p=e[8];return t[0]=o*p-l*d,t[1]=s*d-i*p,t[2]=i*l-s*o,t[3]=l*u-n*p,t[4]=r*p-s*u,t[5]=s*n-r*l,t[6]=n*d-o*u,t[7]=i*u-r*d,t[8]=r*o-i*n,t}function Qg(t){const e=t[0],r=t[1],i=t[2],s=t[3],n=t[4],o=t[5],l=t[6],u=t[7],d=t[8];return e*(d*n-o*u)+r*(-d*s+o*l)+i*(u*s-n*l)}function Em(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=e[6],p=e[7],f=e[8],m=r[0],y=r[1],g=r[2],v=r[3],_=r[4],S=r[5],M=r[6],C=r[7],T=r[8];return t[0]=m*i+y*o+g*d,t[1]=m*s+y*l+g*p,t[2]=m*n+y*u+g*f,t[3]=v*i+_*o+S*d,t[4]=v*s+_*l+S*p,t[5]=v*n+_*u+S*f,t[6]=M*i+C*o+T*d,t[7]=M*s+C*l+T*p,t[8]=M*n+C*u+T*f,t}function _S(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=e[6],p=e[7],f=e[8],m=r[0],y=r[1];return t[0]=i,t[1]=s,t[2]=n,t[3]=o,t[4]=l,t[5]=u,t[6]=m*i+y*o+d,t[7]=m*s+y*l+p,t[8]=m*n+y*u+f,t}function _N(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=e[6],p=e[7],f=e[8],m=Math.sin(r),y=Math.cos(r);return t[0]=y*i+m*o,t[1]=y*s+m*l,t[2]=y*n+m*u,t[3]=y*o-m*i,t[4]=y*l-m*s,t[5]=y*u-m*n,t[6]=d,t[7]=p,t[8]=f,t}function ZY(t,e,r){const i=r[0],s=r[1],n=r[2];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=n*e[6],t[7]=n*e[7],t[8]=n*e[8],t}function JY(t,e,r){const i=r[0],s=r[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t}function YY(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function KY(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=-r,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function QY(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function XY(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function eK(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=r+r,l=i+i,u=s+s,d=r*o,p=i*o,f=i*l,m=s*o,y=s*l,g=s*u,v=n*o,_=n*l,S=n*u;return t[0]=1-f-g,t[3]=p-S,t[6]=m+_,t[1]=p+S,t[4]=1-d-g,t[7]=y-v,t[2]=m-_,t[5]=y+v,t[8]=1-d-f,t}function tK(t,e){const r=e[0],i=e[1],s=e[2],n=e[4],o=e[5],l=e[6],u=e[8],d=e[9],p=e[10],f=p*o-l*d,m=-p*n+l*u,y=d*n-o*u,g=r*f+i*m+s*y;if(!g)return null;const v=1/g;return t[0]=f*v,t[1]=(-p*i+s*d)*v,t[2]=(l*i-s*o)*v,t[3]=m*v,t[4]=(p*r-s*u)*v,t[5]=(-l*r+s*n)*v,t[6]=y*v,t[7]=(-d*r+i*u)*v,t[8]=(o*r-i*n)*v,t}function rK(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],l=e[5],u=e[6],d=e[7],p=e[8],f=e[9],m=e[10],y=e[11],g=e[12],v=e[13],_=e[14],S=e[15],M=r*l-i*o,C=r*u-s*o,T=r*d-n*o,O=i*u-s*l,P=i*d-n*l,D=s*d-n*u,z=p*v-f*g,B=p*_-m*g,G=p*S-y*g,Q=f*_-m*v,oe=f*S-y*v,Pe=m*S-y*_;let fe=M*Pe-C*oe+T*Q+O*G-P*B+D*z;return fe?(fe=1/fe,t[0]=(l*Pe-u*oe+d*Q)*fe,t[1]=(u*G-o*Pe-d*B)*fe,t[2]=(o*oe-l*G+d*z)*fe,t[3]=(s*oe-i*Pe-n*Q)*fe,t[4]=(r*Pe-s*G+n*B)*fe,t[5]=(i*G-r*oe-n*z)*fe,t[6]=(v*D-_*P+S*O)*fe,t[7]=(_*T-g*D-S*C)*fe,t[8]=(g*P-v*T+S*M)*fe,t):null}function iK(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function sK(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function nK(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function oK(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function SN(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function aK(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function lK(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t}function uK(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function cK(t,e){const r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],l=t[5],u=t[6],d=t[7],p=t[8],f=e[0],m=e[1],y=e[2],g=e[3],v=e[4],_=e[5],S=e[6],M=e[7],C=e[8],T=Qr();return Math.abs(r-f)<=T*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-m)<=T*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-y)<=T*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(n-g)<=T*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(o-v)<=T*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(l-_)<=T*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(u-S)<=T*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(d-M)<=T*Math.max(1,Math.abs(d),Math.abs(M))&&Math.abs(p-C)<=T*Math.max(1,Math.abs(p),Math.abs(C))}function dK(t){const e=Qr(),r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],l=t[5],u=t[6],d=t[7],p=t[8];return Math.abs(1-(r*r+n*n+u*u))<=e&&Math.abs(1-(i*i+o*o+d*d))<=e&&Math.abs(1-(s*s+l*l+p*p))<=e}const hK=Em,pK=SN;Object.freeze(Object.defineProperty({__proto__:null,add:oK,adjoint:WY,copy:HY,determinant:Qg,equals:cK,exactEquals:uK,frob:nK,fromMat2d:XY,fromMat4:BY,fromQuat:eK,fromRotation:KY,fromScaling:QY,fromTranslation:YY,identity:vN,invert:bN,isOrthoNormal:dK,mul:hK,multiply:Em,multiplyScalar:aK,multiplyScalarAndAdd:lK,normalFromMat4:rK,normalFromMat4Legacy:tK,projection:iK,rotate:_N,scale:ZY,scaleByVec2:JY,set:kd,str:sK,sub:pK,subtract:SN,translate:_S,transpose:wN},Symbol.toStringTag,{value:"Module"}));function Zu(){return[1,0,0,0,1,0,0,0,1]}function fK(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function mK(t,e,r,i,s,n,o,l,u){return[t,e,r,i,s,n,o,l,u]}const yK=Zu();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:yK,clone:fK,create:Zu,fromValues:mK},Symbol.toStringTag,{value:"Module"}));const ic=Zu();function gK(t,e,r){const[i,s]=t,[n,o]=e,[l,u]=r;kd(ic,i,n,l,s,o,u,1,1,1);const d=Qg(ic),p=4*d/(Yr(t,e)+Yr(e,r)+Yr(r,t));if(!isFinite(p)||Math.abs(p)<1e-8)return null;const f=i**2+s**2,m=n**2+o**2,y=l**2+u**2;kd(ic,f,m,y,s,o,u,1,1,1);const g=Qg(ic);return kd(ic,f,m,y,i,n,l,1,1,1),[g/d*.5,Qg(ic)/d*-.5]}function $N(t,e){const[r,i]=e.c,s=gK(t,i,r),n=s==null,o=s??xo([],t,r,.5),[l,u]=t,[d,p]=i,[f,m]=r,[y,g]=o,v=l-y,_=u-g,S=Math.sqrt(v*v+_*_),M=fu(u-g,l-y),C=fu(p-g,d-y);let T=fu(m-g,f-y);return(C-M)*(T-C)<0&&(T+=2*Math.sign(M-T)*Math.PI),new gN(y,g,S,M,T,n)}function dSe(t,e,r){const i=Kg(t,r/2),s=Kg(t,r),n=Kg(t,(r+1)/2);return[{c:[s,i]},{c:[[...e.c[0]],n]}]}function hSe(t,e){const[r]=e.c,{cx:i,cy:s,thetaStart:n,thetaEnd:o,radius:l,isInvalid:u}=$N(t,e);return{a:[r,[i,s],Math.abs(o-n)<Math.PI?1:0,n>o?1:0,u?n:0,l,u?0:1]}}function pSe(t){return"curveRings"in t&&!!t.curveRings?.length||"curvePaths"in t&&!!t.curvePaths?.length}function fSe(t){return"curveRings"in t?t.curveRings:t.curvePaths}function mM(t){return"b"in t}function yM(t){return"c"in t}function Hw(t){return Array.isArray(t)}function mSe(t){return"a"in t}function xN(t){return"a"in t&&t.a.length===4}function vK(t){return"a"in t&&t.a.length===7}function ob(t){return Hw(t)?t:mM(t)?t.b[0]:yM(t)?t.c[0]:t.a[0]}function wK(t){if(mM(t)){const[e,r,i]=t.b;return{b:[[...e],[...r],[...i]]}}if(yM(t)){const[e,r]=t.c;return{c:[[...e],[...r]]}}if(Hw(t))return[...t];if(xN(t)){const[e,r,i,s]=t.a;return{a:[[...e],[...r],i,s]}}if(vK(t)){const[e,r,i,s,n,o,l]=t.a;return{a:[[...e],[...r],i,s,n,o,l]}}return t}function bK(t,e){const[r,i,s,n]=e.a,[o,l]=t,[u,d]=r,[p,f]=i,m=o-p,y=l-f,g=Math.sqrt(m*m+y*y),v=u-p,_=d-f,S=Math.sqrt(v*v+_*_),M=g===0||S===0||!H5(g,S),C=g,[T,O]=fN(fu(l-f,o-p),Math.atan2(d-f,u-p),s,n);return new gN(p,f,C,T,O,M)}function ySe(t,e,r){const{cx:i,cy:s,thetaStart:n,thetaEnd:o}=t,[l,u,d,p]=e.a,f=n*(1-r)+o*r;return[{a:[Kg(t,r),[i,s],Math.abs(f-n)<Math.PI?1:0,p]},{a:[[...l],[i,s],Math.abs(o-f)<Math.PI?1:0,p]}]}let _K=class{constructor(e,r,i,s,n,o,l,u,d){this.cx=e,this.cy=r,this.a=i,this.b=s,this.cosR=n,this.sinR=o,this.u1=l,this.u2=u,this.isInvalid=d}};function gM(t,e){const[r,i,s,n,o,l,u]=e.a,[d,p]=t,[f,m]=r,[y,g]=i,v=l*u,_=Math.cos(o),S=Math.sin(o),[M,C]=fN(fu(1/v*(p-g)*_-1/v*(d-y)*S,1/l*(p-g)*S+1/l*(d-y)*_),Math.atan2(1/v*(m-g)*_-1/v*(f-y)*S,1/l*(m-g)*S+1/l*(f-y)*_),s,n);return new _K(y,g,l,v,_,S,M,C,l===0||v===0)}function Om(t,e){const{a:r,b:i,cosR:s,sinR:n,cx:o,cy:l}=t,u=Math.cos(e),d=Math.sin(e);return[r*u*s-i*d*n+o,r*u*n+i*d*s+l]}function $c(t,e){const{u1:r,u2:i}=t;return Om(t,r*(1-e)+i*e)}function vSe(t,e,r){if(r<0||r>1)return[];if(r===0||r===1)return[wK(e)];const[i,[s,n],o,l,u,d,p]=e.a,{u1:f,u2:m}=t,y=f*(1-r)+m*r;return[{a:[[...$c(t,r)],[s,n],Math.abs(y-f)<Math.PI?1:0,l,u,d,p]},{a:[[...i],[s,n],Math.abs(m-y)<Math.PI?1:0,l,u,d,p]}]}function wSe(t,e){const{a:r,b:i,cosR:s,sinR:n,u1:o,u2:l}=t,u=Math.PI/6,d=mN(e,[1*u,2*u,4*u,5*u,7*u,8*u,10*u,11*u],v=>{const _=Math.cos(v),S=Math.sin(v),[M,C]=Om(t,v);return[M,C,-r*s*S-i*n*_,-r*n*S+i*s*_,-r*s*_+i*n*S,-r*n*_-i*s*S]}),p=Bw(o,l),f=new Set(d.map(v=>cy(p,v)).filter(v=>v>p.min&&v<p.max));f.add(o),f.add(l);let m,y,g=1/0;for(const v of f){const _=Om(t,v),[S,M]=_,C=e[0]-S,T=e[1]-M,O=C*C+T*T;O<g&&(m=(v-o)/(l-o),y=_,g=O)}return{t:m,curvePoint:y,distance:Math.sqrt(g)}}function SK(t,e,r){const i=gM(e,r),{a:s,b:n,u1:o,u2:l,cosR:u,sinR:d,isInvalid:p}=i,f=r.a[0];if(us(t,e),us(t,f),p)return t;const m=Math.atan2(-n*d,s*u),y=m+Math.PI,g=Math.atan2(n*u,s*d),v=g+Math.PI,_=Bw(o,l);for(const S of[m,y,g,v].map(M=>cy(_,M)))S>_.min&&S<_.max&&us(t,Om(i,S));return t}function bSe(t,e,r){const[i,s,n,o,l,u,d]=e.a,p=gM(t,e),{u1:f,u2:m,isInvalid:y}=p,g=m-f;if(y)return Math.sqrt(Yr(t,i));const v=14,_=[0,0];let S=0,M=[$c(p,0),$c(p,.25),$c(p,.5),$c(p,.75),$c(p,1)];for(let C=0;C<v;C++){const T=M.length-1,O=g/(2*T),P=[];for(let z=0;z<T;z++)P.push(M[z]),P.push(Om(p,f+(2*z+1)*O));P.push(M[M.length-1]),M=P,S=0;let D=0;for(let z=1;z<M.length;z++){const B=M[z-1],G=M[z];if(S+=Math.sqrt(Yr(B,G)),z>1){const Q=M[z-2],oe=jY(_,Q,B,s,G);D+=oe?Math.sqrt(Yr(B,oe)):Math.abs(G[0]-B[0])+Math.abs(G[1]-B[1])}else D+=S}if(D-S<r)return S}return S}const iO=Zu(),Uy=Zu(),sO=Zu(),ta=Zu();function _Se(t,e,r){const[i,s,n,o,l,u,d]=e.a,p=gM(t,e),{cosR:f,sinR:m,a:y,b:g,cx:v,cy:_}=p,S=Yg([0,0],i,r),M=Yg([0,0],s,r),C=r[0]*r[4]<0?1-o:o;{const T=y*y*m*m+g*g*f*f,O=2*(g*g-y*y)*m*f,P=y*y*f*f+g*g*m*m,D=-2*T*v-O*_,z=-O*v-2*P*_;kd(iO,T,O/2,D/2,O/2,P,z/2,D/2,z/2,T*v*v+O*v*_+P*_*_-y*y*g*g)}if(bN(Uy,r),Uy==null){const T=Yg([0,0],t,r);return{a:[S,M,n,o,fu(S[1],S[0]),Math.sqrt(Yr(S,T))/2,0]}}wN(sO,Uy),Em(ta,Em(ta,sO,iO),Uy);{const T=ta[0],O=2*ta[1],P=ta[4],D=2*ta[2],z=2*ta[5],B=O*O-4*T*P,G=2*(T*z*z+P*D*D-O*D*z+B*ta[8]),Q=Math.sqrt((T-P)**2+O*O),oe=-Math.sqrt(G*(T+P+Q))/B,Pe=-Math.sqrt(G*(T+P-Q))/B;return{a:[S,M,n,C,.5*fu(-O,P-T),oe,Pe/oe]}}}function $K(t,e,r){if(Hw(r))return us(t,e),us(t,r),t;if(mM(r))return qY(t,e,r);if(yM(r)){const i=$N(e,r);return rO(t,i)}if(xN(r)){const i=bK(e,r);return rO(t,i)}return SK(t,e,r)}function TN(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function MN(t){return t.points!==void 0}function IN(t){return t.x!==void 0&&t.y!==void 0}function EN(t){return t.paths!==void 0}function ON(t){return t.rings!==void 0}function kN(t){function e(r,i){return r==null?i:i==null?r:t(r,i)}return e}const Aa=kN(Math.min),Ra=kN(Math.max);function SSe(t,e){return EN(e)?Th(t,e.curvePaths??e.paths,!1,!1)??t:ON(e)?Th(t,e.curveRings??e.rings,!1,!1)??t:MN(e)?vM(t,e.points,!1,!1,!1,!1):TN(e)?CN(t,e):(IN(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function $Se(t){let e,r,i,s;for(t.reset(),e=i=1/0,r=s=-1/0;t.nextPath();){const n=xK(t);e=Math.min(n[0],e),i=Math.min(n[1],i),r=Math.max(n[2],r),s=Math.max(n[3],s)}return yi([e,i,r,s])}function xK(t){let e,r,i,s;for(e=i=1/0,r=s=-1/0;t.nextPoint();)e=Math.min(t.x,e),i=Math.min(t.y,i),r=Math.max(t.x,r),s=Math.max(t.y,s);return yi([e,i,r,s])}function xSe(t,e){return EN(e)?Th(t,e.curvePaths??e.paths,!0,!1)??t:ON(e)?Th(t,e.curveRings??e.rings,!0,!1)??t:MN(e)?vM(t,e.points,!0,!1,!0,!1):TN(e)?CN(t,e,!0,!1,!0,!1):(IN(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function Th(t,e,r,i){const s=r?3:2;if(!e.length||!e[0].length)return null;let n,o,l,u,[d,p]=ob(e[0][0]),f=d,m=p;for(let y=0;y<e.length;y++){const g=e[y];for(let v=0;v<g.length;v++){const _=ob(g[v]),[S,M]=_;if(d=Aa(d,S),p=Aa(p,M),f=Ra(f,S),m=Ra(m,M),r&&_.length>2){const P=_[2];n=Aa(n,P),o=Ra(o,P)}if(i&&_.length>s){const P=_[s];l=Aa(n,P),u=Ra(o,P)}const C=g[v];if(Hw(C)||v<1)continue;const T=ob(g[v-1]),O=nY(d,p,f,m);[d,p,f,m]=$K(O,T,C)}}return r?i?(t[0]=d,t[1]=p,t[2]=n,t[3]=l,t[4]=f,t[5]=m,t[6]=o,t[7]=u,t.length=8,t):(t[0]=d,t[1]=p,t[2]=n,t[3]=f,t[4]=m,t[5]=o,t.length=6,t):i?(t[0]=d,t[1]=p,t[2]=l,t[3]=f,t[4]=m,t[5]=u,t.length=6,t):(t[0]=d,t[1]=p,t[2]=f,t[3]=m,t.length=4,t)}function CN(t,e,r,i,s,n){const o=e.xmin,l=e.xmax,u=e.ymin,d=e.ymax;let p=e.zmin,f=e.zmax,m=e.mmin,y=e.mmax;return s?(p=p||0,f=f||0,n?(m=m||0,y=y||0,t[0]=o,t[1]=u,t[2]=p,t[3]=m,t[4]=l,t[5]=d,t[6]=f,t[7]=y,t):(t[0]=o,t[1]=u,t[2]=p,t[3]=l,t[4]=d,t[5]=f,t)):n?(m=m||0,y=y||0,t[0]=o,t[1]=u,t[2]=m,t[3]=l,t[4]=d,t[5]=y,t):(t[0]=o,t[1]=u,t[2]=l,t[3]=d,t)}function vM(t,e,r,i,s,n){const o=r?3:2,l=i&&n,u=r&&s;if(!e.length||!e[0].length)return null;let d,p,f,m,[y,g]=e[0],[v,_]=e[0];for(let S=0;S<e.length;S++){const M=e[S],[C,T]=M;if(y=Aa(y,C),g=Aa(g,T),v=Ra(v,C),_=Ra(_,T),u&&M.length>2){const O=M[2];d=Aa(d,O),p=Ra(p,O)}if(l&&M.length>o){const O=M[o];f=Aa(d,O),m=Ra(p,O)}}return s?(d=d||0,p=p||0,n?(f=f||0,m=m||0,t[0]=y,t[1]=g,t[2]=d,t[3]=f,t[4]=v,t[5]=_,t[6]=p,t[7]=m,t):(t[0]=y,t[1]=g,t[2]=d,t[3]=v,t[4]=_,t[5]=p,t)):n?(f=f||0,m=m||0,t[0]=y,t[1]=g,t[2]=f,t[3]=v,t[4]=_,t[5]=m,t):(t[0]=y,t[1]=g,t[2]=v,t[3]=_,t)}function TK(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function MK(t){return t.points!==void 0}function IK(t){return t.x!==void 0&&t.y!==void 0}function EK(t){return t.paths!==void 0}function OK(t){return t.rings!==void 0}const wM=[];function PN(t,e,r,i){return{xmin:t,ymin:e,xmax:r,ymax:i}}function AN(t,e,r,i,s,n){return{xmin:t,ymin:e,zmin:r,xmax:i,ymax:s,zmax:n}}function RN(t,e,r,i,s,n){return{xmin:t,ymin:e,mmin:r,xmax:i,ymax:s,mmax:n}}function LN(t,e,r,i,s,n,o,l){return{xmin:t,ymin:e,zmin:r,mmin:i,xmax:s,ymax:n,zmax:o,mmax:l}}function bM(t,e=!1,r=!1){return e?r?LN(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):AN(t[0],t[1],t[2],t[3],t[4],t[5]):r?RN(t[0],t[1],t[2],t[3],t[4],t[5]):PN(t[0],t[1],t[2],t[3])}function TSe(t){return t?TK(t)?t:IK(t)?kK(t):OK(t)?NN(t):EK(t)?DN(t):MK(t)?FN(t):null:null}function FN(t){const{hasZ:e,hasM:r,points:i}=t,s=vM(wM,i,e??!1,r??!1,e??!1,r??!1);return s?bM(s,e,r):null}function kK(t){const{x:e,y:r,z:i,m:s}=t,n=s!=null;return i!=null?n?LN(e,r,i,s,e,r,i,s):AN(e,r,i,e,r,i):n?RN(e,r,s,e,r,s):PN(e,r,e,r)}function NN(t){const{hasZ:e,hasM:r,rings:i,curveRings:s}=t,n=Th(wM,s??i,e??!1,r??!1);return n?bM(n,e,r):null}function DN(t){const{hasZ:e,hasM:r,paths:i,curvePaths:s}=t,n=Th(wM,s??i,e??!1,r??!1);return n?bM(n,e,r):null}function Mh(t,e,r=!1){let{hasM:i,hasZ:s}=t;Array.isArray(e)?e.length!==4||i||s?e.length===3&&r&&!i?(s=!0,i=!1):e.length===3&&i&&s&&(i=!1,s=!1):(i=!0,s=!0):(s=!s&&e.hasZ&&(!i||e.hasM),i=!i&&e.hasM&&(!s||e.hasZ)),t.hasZ=s,t.hasM=i}var Xg;function nO(t){return!Array.isArray(t[0])}function CK(t){return typeof t[0]?.[0]=="number"}function PK(t){if(!t)return;let{rings:e,hasM:r,hasZ:i,spatialReference:s}=t;switch(e??=[],CK(e)&&(e=[e]),e[0]?.[0]?.length){case 4:i??=!0,r??=!0;break;case 3:i??=r!==!0,r??=!i;break;default:i??=!1,r??=!1}return s??=Z.WGS84,{...t,hasM:r,hasZ:i,rings:e,spatialReference:s}}let Be=Xg=class extends qt{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:r}=t;let i=!1,s=!1;for(const o of e)o.hasZ&&(i=!0),o.hasM&&(s=!0);const n={rings:e.map(o=>{const l=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(i&&o.hasZ){const u=o.zmin+.5*(o.zmax-o.zmin);for(let d=0;d<l.length;d++)l[d].push(u)}if(s&&o.hasM){const u=o.mmin+.5*(o.mmax-o.mmin);for(let d=0;d<l.length;d++)l[d].push(u)}return l}),spatialReference:r};return i&&(n.hasZ=!0),s&&(n.hasM=!0),new Xg(n)}constructor(t){super(PK(t)),this.curveRings=void 0,this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("curveRings"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("rings"),this.commitProperty("spatialReference"),{}}get centroid(){I_(L.getLogger(this),"centroid",{replacement:"Please use centroidOperator.execute() instead.",version:"4.34",warnOnce:!0});const t=iN(this);return t?ee.fromJSON(t):null}writeCurveRings(t,e){e.curveRings=E(t)}get extent(){const t=NN(this),{spatialReference:e}=this;return t?new he({...t,spatialReference:e}):null}get isSelfIntersecting(){return I_(L.getLogger(this),"isSelfIntersecting",{replacement:"Please use simplifyOperator.isSimple() instead.",version:"4.33",warnOnce:!0}),dH(this.rings)}writeRings(t,e){e.rings=E(this.rings)}addRing(t){if(!t)return;const e=this.rings,r=e.length;if(nO(t)){const i=[];for(let s=0,n=t.length;s<n;s++)i[s]=t[s].toArray();e[r]=i}else e[r]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new Xg;return t.spatialReference=this.spatialReference,t.rings=E(this.rings),t.curveRings=E(this.curveRings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,r=t.spatialReference;if(e!=null!=(r!=null)||e!=null&&r!=null&&!e.equals(r)||this.rings.length!==t.rings.length)return!1;const i=([s,n,o,l],[u,d,p,f])=>s===u&&n===d&&(o==null&&p==null||o===p)&&(l==null&&f==null||l===f);for(let s=0;s<this.rings.length;s++){const n=this.rings[s],o=t.rings[s];if(!hw(n,o,i))return!1}return!0}contains(t){if(!t)return!1;const e=Ow(t,this.spatialReference);return UT(this,e??t)}isClockwise(t){const e=nO(t)?t.map(r=>this.hasZ?this.hasM?[r.x,r.y,r.z,r.m]:[r.x,r.y,r.z]:[r.x,r.y]):t;return tN(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const r=this.rings[t][e],i=this.hasZ,s=this.hasM;return i&&!s?new ee(r[0],r[1],r[2],void 0,this.spatialReference):s&&!i?new ee(r[0],r[1],void 0,r[2],this.spatialReference):i&&s?new ee(r[0],r[1],r[2],r[3],this.spatialReference):new ee(r[0],r[1],this.spatialReference)}insertPoint(t,e,r){return this._validateInputs(t,e,!0)?(Mh(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[t].splice(e,0,r),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const r=new ee(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),r}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],r=this.spatialReference,i=e.map(s=>new ee(s,r));return this.notifyChange("rings"),i}setPoint(t,e,r){return this._validateInputs(t,e)?(Mh(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[t][e]=r,this.notifyChange("rings"),this):this}_validateInputs(t,e,r=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const i=this.rings[t];if(r&&(e<0||e>i.length)||!r&&(e<0||e>=i.length))return!1}return!0}toJSON(t){return this.write({},t)}};a([c({readOnly:!0})],Be.prototype,"cache",null),a([c({readOnly:!0})],Be.prototype,"centroid",null),a([c({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],Be.prototype,"curveRings",void 0),a([q("curveRings")],Be.prototype,"writeCurveRings",null),a([c({readOnly:!0})],Be.prototype,"extent",null),a([c({readOnly:!0})],Be.prototype,"isSelfIntersecting",null),a([c({type:[[[Number]]],json:{write:{isRequired:!0}}})],Be.prototype,"rings",void 0),a([q("rings")],Be.prototype,"writeRings",null),Be=Xg=a([b("esri.geometry.Polygon")],Be),Be.prototype.toJSON.isDefaultToJSON=!0;function al(){return[0,0,0]}function AK(t){return[t[0],t[1],t[2]]}function ip(t,e,r){return[t,e,r]}function RK(t,e,r){return[t,e,r]}function LK(t,e=al()){const r=Math.min(3,t.length);for(let i=0;i<r;++i)e[i]=t[i];return e}function jN(){return al()}function VN(){return ip(1,1,1)}function zN(){return ip(1,0,0)}function UN(){return ip(0,1,0)}function qN(){return ip(0,0,1)}const FK=jN(),NK=VN(),DK=zN(),jK=UN(),VK=qN();Object.freeze(Object.defineProperty({__proto__:null,ONES:NK,UNIT_X:DK,UNIT_Y:jK,UNIT_Z:VK,ZEROS:FK,clone:AK,create:al,freeze:RK,fromArray:LK,fromValues:ip,ones:VN,unitX:zN,unitY:UN,unitZ:qN,zeros:jN},Symbol.toStringTag,{value:"Module"}));var SS;function zK(t){if(!t)return;let{points:e,hasM:r,hasZ:i,spatialReference:s}=t;switch(e??=[],e?.at(0)?.length){case 4:i??=!0,r??=!0;break;case 3:i??=r!==!0,r??=!i;break;default:i??=!1,r??=!1}return s??=Z.WGS84,{...t,hasM:r,hasZ:i,points:e,spatialReference:s}}let zs=SS=class extends qt{constructor(t){super(zK(t)),this.points=[],this.type="multipoint"}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=FN(this);return t?new he({...t,spatialReference:this.spatialReference}):null}writePoints(t,e){e.points=E(this.points)}clone(){const{points:t,spatialReference:e,hasM:r,hasZ:i}=this;return new SS({points:E(t),spatialReference:e.clone(),hasM:r,hasZ:i})}addPoint(t){return Mh(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],r={x:e[0],y:e[1],spatialReference:this.spatialReference};let i=2;return this.hasZ&&(r.z=e[2],i=3),this.hasM&&(r.m=e[i]),new ee(r)}removePoint(t){if(!this._validateInputs(t))return null;const e=new ee(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(Mh(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};a([c({readOnly:!0})],zs.prototype,"cache",null),a([c({readOnly:!0})],zs.prototype,"extent",null),a([c({type:[[Number]],json:{write:{isRequired:!0}}})],zs.prototype,"points",void 0),a([q("points")],zs.prototype,"writePoints",null),zs=SS=a([b("esri.geometry.Multipoint")],zs),zs.prototype.toJSON.isDefaultToJSON=!0;var $S;function UK(t){return!Array.isArray(t[0])}function qK(t){return typeof t[0]?.[0]=="number"}function GK(t){if(!t)return;let{paths:e,hasM:r,hasZ:i,spatialReference:s}=t;switch(e??=[],qK(e)&&(e=[e]),e[0]?.[0]?.length){case 4:i??=!0,r??=!0;break;case 3:i??=r!==!0,r??=!i;break;default:i??=!1,r??=!1}return s??=Z.WGS84,{...t,hasM:r,hasZ:i,paths:e,spatialReference:s}}let Rt=$S=class extends qt{constructor(t){super(GK(t)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(t,e){e.curvePaths=E(t)}get extent(){const t=DN(this),{spatialReference:e}=this;return t?new he({...t,spatialReference:e}):null}writePaths(t,e){e.paths=E(this.paths)}addPath(t){if(!t)return;const e=this.paths,r=e.length;if(UK(t)){const i=[];for(let s=0,n=t.length;s<n;s++)i[s]=t[s].toArray();e[r]=i}else e[r]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new $S;return t.spatialReference=this.spatialReference,t.paths=E(this.paths),t.curvePaths=E(this.curvePaths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const r=this.paths[t][e],i=this.hasZ,s=this.hasM;return i&&!s?new ee(r[0],r[1],r[2],void 0,this.spatialReference):s&&!i?new ee(r[0],r[1],void 0,r[2],this.spatialReference):i&&s?new ee(r[0],r[1],r[2],r[3],this.spatialReference):new ee(r[0],r[1],this.spatialReference)}insertPoint(t,e,r){return this._validateInputs(t,e,!0)?(Mh(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t].splice(e,0,r),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],r=this.spatialReference,i=e.map(s=>new ee(s,r));return this.notifyChange("paths"),i}removePoint(t,e){if(!this._validateInputs(t,e))return null;const r=new ee(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),r}setPoint(t,e,r){return this._validateInputs(t,e)?(Mh(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t][e]=r,this.notifyChange("paths"),this):this}_validateInputs(t,e,r=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const i=this.paths[t];if(r&&(e<0||e>i.length)||!r&&(e<0||e>=i.length))return!1}return!0}toJSON(t){return this.write({},t)}};a([c({readOnly:!0})],Rt.prototype,"cache",null),a([c({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],Rt.prototype,"curvePaths",void 0),a([q("curvePaths")],Rt.prototype,"writeCurvePaths",null),a([c({readOnly:!0})],Rt.prototype,"extent",null),a([c({type:[[[Number]]],json:{write:{isRequired:!0}}})],Rt.prototype,"paths",void 0),a([q("paths")],Rt.prototype,"writePaths",null),Rt=$S=a([b("esri.geometry.Polyline")],Rt),Rt.prototype.toJSON.isDefaultToJSON=!0;var xS;let xc=xS=class extends X{constructor(t){super(t),this.isInverse=!1,this.wkt=null,this.wkid=null}getInverse(){return new xS({isInverse:!this.isInverse,wkid:this.wkid,wkt:this.wkt})}};a([c()],xc.prototype,"isInverse",void 0),a([c()],xc.prototype,"wkt",void 0),a([c()],xc.prototype,"wkid",void 0),xc=xS=a([b("esri.geometry.operators.support.GeographicTransformationStep")],xc);var TS;let Uf=TS=class extends X{constructor(t){super(t),this.steps=[]}getInverse(){const t=new TS;for(let e=this.steps.length-1;e>=0;e--){const r=this.steps[e];t.steps.push(r.getInverse())}return t}};a([c({type:[xc],nonNullable:!0})],Uf.prototype,"steps",void 0),Uf=TS=a([b("esri.geometry.operators.support.GeographicTransformation")],Uf);const MSe=Math.PI/180,ISe=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,ra=dt.radius,Es=dt.eccentricitySquared,BK={a1:ra*Es,a2:ra*Es*ra*Es,a3:ra*Es*Es/2,a4:ra*Es*ra*Es*2.5,a5:ra*Es+ra*Es*Es/2,a6:1-Es},ESe={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:dt.radius,f:dt.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:Za.radius,f:Za.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:An.radius,f:An.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:An.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}},HK={2:{5:Xe,7:null,9:null,10:Xe,1:Gf,6:null,8:null,0:null,3:Cd,11:Pd,2:Xe,4:Ld},5:{5:Xe,7:null,9:null,10:Xe,1:Gf,6:null,8:null,0:null,3:Cd,11:Pd,2:Xe,4:Ld},7:{5:null,7:Xe,9:null,10:Xe,1:null,6:lO,8:null,0:null,3:null,11:null,2:null,4:null},9:{5:null,7:null,9:Xe,10:Xe,1:null,6:null,8:aO,0:null,3:null,11:null,2:null,4:null},3:{5:qf,7:null,9:null,10:qf,1:ZK,6:null,8:null,0:null,3:Xe,11:KK,2:qf,4:JK},4:{5:Fd,7:null,9:null,10:Fd,1:oQ,6:null,8:null,0:null,3:aQ,11:QK,2:Fd,4:Xe},1:{5:Rd,7:null,9:null,10:Rd,1:Xe,6:null,8:null,0:null,3:iQ,11:XK,2:Rd,4:sQ},6:{5:null,7:cO,9:null,10:cO,1:null,6:Xe,8:null,0:null,3:null,11:null,2:null,4:null},8:{5:null,7:null,9:uO,10:uO,1:null,6:null,8:Xe,0:null,3:null,11:null,2:null,4:null},0:{5:null,7:null,9:null,10:null,1:null,6:null,8:null,0:Xe,3:null,11:null,2:null,4:null},10:{5:Xe,7:Xe,9:Xe,10:Xe,1:Gf,6:lO,8:aO,0:null,3:Cd,11:Pd,2:Xe,4:Ld},11:{5:Ad,7:null,9:null,10:Ad,1:eQ,6:null,8:null,0:null,3:tQ,11:Xe,2:Ad,4:rQ}};function GN(t,e){return WK(t,e)?.projector}function WK(t,e){if(t==null||e==null)return null;if(qn.source.spatialReference===t&&qn.dest.spatialReference===e)return qn;const r=oO(t,qn.source),i=oO(e,qn.dest);return r===0&&i===0?Wt(t,e)?qn.projector=Xe:qn.projector=null:qn.projector=HK[r][i],qn}function oO(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=Hi(t,1)),Sv(t)?e.spatialReferenceId=1:Cu(t)?e.spatialReferenceId=2:Dn(t)?e.spatialReferenceId=3:fB(t)?e.spatialReferenceId=11:t.wkt===vB.wkt?e.spatialReferenceId=4:t.wkid===4490?e.spatialReferenceId=5:t.wkt===jT.wkt?e.spatialReferenceId=6:t.wkt===VT.wkt?e.spatialReferenceId=8:HL(t)?e.spatialReferenceId=7:WL(t)?e.spatialReferenceId=9:e.spatialReferenceId=0):0}function Xe(t,e,r,i){t!==r&&(r[i++]=t[e++],r[i++]=t[e++],r[i]=t[e])}function qf(t,e,r,i){r[i]=Eh*(t[e]/mu),r[i+1]=Eh*(BN-2*Math.atan(Math.exp(-t[e+1]/mu))),r[i+2]=t[e+2]}function ZK(t,e,r,i){const s=t[e]/mu,n=BN-2*Math.atan(Math.exp(-t[e+1]/mu)),o=mu+t[e+2],l=Math.cos(n)*o;r[i]=Math.cos(s)*l,r[i+1]=Math.sin(s)*l,r[i+2]=Math.sin(n)*o}function JK(t,e,r,i){qf(t,e,r,i),Ld(r,i,r,i)}function YK(t,e,r,i,s){const n=.4999999*Math.PI,o=Bi(Ih*t[e+1],-n,n),l=Math.sin(o);r[i++]=Ih*t[e]*s.radius,r[i++]=s.halfSemiMajorAxis*Math.log((1+l)/(1-l)),r[i]=t[e+2]}function Cd(t,e,r,i){YK(t,e,r,i,dt)}function Pd(t,e,r,i){r[i]=t[e]*dO,r[i+1]=t[e+1]*dO,r[i+2]=t[e+2]}function Ad(t,e,r,i){r[i]=t[e]*hO,r[i+1]=t[e+1]*hO,r[i+2]=t[e+2]}function KK(t,e,r,i){qf(t,e,r,i),Pd(r,i,r,i)}function QK(t,e,r,i){Fd(t,e,r,i),Pd(r,i,r,i)}function XK(t,e,r,i){Rd(t,e,r,i),Pd(r,i,r,i)}function eQ(t,e,r,i){Ad(t,e,r,i),Gf(r,i,r,i)}function tQ(t,e,r,i){Ad(t,e,r,i),Cd(r,i,r,i)}function rQ(t,e,r,i){Ad(t,e,r,i),Ld(r,i,r,i)}function _M(t,e,r,i,s){const n=s+t[e+2],o=Ih*t[e+1],l=Ih*t[e],u=Math.cos(o)*n;r[i]=Math.cos(l)*u,r[i+1]=Math.sin(l)*u,r[i+2]=Math.sin(o)*n}function aO(t,e,r,i){_M(t,e,r,i,Za.radius)}function lO(t,e,r,i){_M(t,e,r,i,An.radius)}function Gf(t,e,r,i){_M(t,e,r,i,dt.radius)}function SM(t,e,r,i,s){const n=t[e],o=t[e+1],l=t[e+2],u=Math.sqrt(n*n+o*o+l*l),d=vJ(l/(u===0?1:u)),p=Math.atan2(o,n);r[i++]=Eh*p,r[i++]=Eh*d,r[i]=u-s}function uO(t,e,r,i){SM(t,e,r,i,Za.radius)}function cO(t,e,r,i){SM(t,e,r,i,An.radius)}function Rd(t,e,r,i){SM(t,e,r,i,dt.radius)}function iQ(t,e,r,i){Rd(t,e,r,i),Cd(r,i,r,i)}function sQ(t,e,r,i){Rd(t,e,r,i),Ld(r,i,r,i)}function nQ(t,e,r,i,s){const n=Ih*t[e],o=Ih*t[e+1],l=t[e+2],u=Math.sin(o),d=Math.cos(o),p=s.radius/Math.sqrt(1-s.eccentricitySquared*u*u);r[i++]=(p+l)*d*Math.cos(n),r[i++]=(p+l)*d*Math.sin(n),r[i++]=(p*(1-s.eccentricitySquared)+l)*u}function Ld(t,e,r,i){nQ(t,e,r,i,dt)}function Fd(t,e,r,i){const s=BK,n=t[e],o=t[e+1],l=t[e+2];let u,d,p,f,m,y,g,v,_,S,M,C,T,O,P,D,z,B,G,Q,oe;u=Math.abs(l),d=n*n+o*o,p=Math.sqrt(d),f=d+l*l,m=Math.sqrt(f),Q=Math.atan2(o,n),y=l*l/f,g=d/f,O=s.a2/m,P=s.a3-s.a4/m,g>.3?(v=u/m*(1+g*(s.a1+O+y*P)/m),G=Math.asin(v),S=v*v,_=Math.sqrt(1-S)):(_=p/m*(1-y*(s.a5-O-g*P)/m),G=Math.acos(_),S=1-_*_,v=Math.sqrt(S)),M=1-dt.eccentricitySquared*S,C=dt.radius/Math.sqrt(M),T=s.a6*C,O=p-C*_,P=u-T*v,z=_*O+v*P,D=_*P-v*O,B=D/(T/M+z),G+=B,oe=z+D*B/2,l<0&&(G=-G),r[i++]=Eh*Q,r[i++]=Eh*G,r[i]=oe}function oQ(t,e,r,i){Fd(t,e,r,i),Gf(r,i,r,i)}function aQ(t,e,r,i){Fd(t,e,r,i),Cd(r,i,r,i)}const qn={source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:Xe},Ih=ly(1),Eh=q5(1),BN=.5*Math.PI,mu=dt.radius,dO=mu*Math.PI/180,hO=180/(mu*Math.PI);function dy(t,e,r,i,s,n,o=Math.floor(t.length/3)){const l=GN(e,s);if(l==null)return!1;if(l===Xe){if(t===i&&r===n)return!0;const d=r+3*o;for(let p=r,f=n;p<d;p++,f++)i[f]=t[p];return!0}const u=r+3*o;for(let d=r,p=n;d<u;d+=3,p+=3)l(t,d,i,p);return!0}const OSe=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:dy},Symbol.toStringTag,{value:"Module"}));function pO(t,e,r,i,s,n){return qy[0]=t,qy[1]=e,qy[2]=r,dy(qy,i,0,s,n,0)}const qy=al();function HN(t,e,r){if(e==null||r==null||r.vcsWkid||Wt(e,r)||Ya(e)||Ya(r))return null;const i=$v(e)/$v(r);if(i===1)return null;switch(t){case"point":case"esriGeometryPoint":return s=>lQ(s,i);case"polyline":case"esriGeometryPolyline":return s=>cQ(s,i);case"polygon":case"esriGeometryPolygon":return s=>uQ(s,i);case"multipoint":case"esriGeometryMultipoint":return s=>dQ(s,i);case"extent":case"esriGeometryEnvelope":return s=>hQ(s,i);default:return null}}function lQ(t,e){t?.z!=null&&(t.z*=e)}function uQ(t,e){if(t)for(const r of t.rings)for(const i of r)i.length>2&&(i[2]*=e)}function cQ(t,e){if(t)for(const r of t.paths)for(const i of r)i.length>2&&(i[2]*=e)}function dQ(t,e){if(t)for(const r of t.points)r.length>2&&(r[2]*=e)}function hQ(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}let Bf=null,km=null,Cm=null,Oh=null,MS={};const $M=new ty;function qo(){return!!(km?.isLoaded()&&Cm?.isLoaded()&&Oh?.isLoaded())}function WN(){return!!qo()||(le($M),el(),!1)}function ZN(t,e){return!t||!e||nn(t,e)||WN()}function pQ(t,e){return!nn(t,e)&&!qo()}async function el(t){Bf==null&&(Bf=Promise.all([N(()=>import("./projectOperator-Caj_rAr9.js"),__vite__mapDeps([15,16,17])).then(e=>(km=e,km.load())),N(()=>import("./projectOperator-BFhjCY7-.js"),__vite__mapDeps([18,16,17])).then(e=>(Cm=e,Cm.load())),N(()=>import("./geographicTransformationUtils-kPLd9AvB.js"),[]).then(e=>(Oh=e,Oh.load()))])),await Bf,We(t),$M.notify()}function ll(t,e,r){return Array.isArray(t)?t.length===0?[]:(JB(t),IS(t,t[0].spatialReference,e,r)):(Sh(t),IS([t],t.spatialReference,e,r)[0])}function IS(t,e,r,i){if(e==null||r==null)return t;if(nn(e,r,i))return t.map(s=>e0(s,e,r));if(i?.geographicTransformation==null&&Sv(e))return t.map(s=>e0(s,e,Z.WGS84)).map(s=>Pm(s,r));if(i?.geographicTransformation==null&&Sv(r))return t.map(s=>Pm(s,Z.WGS84)).map(s=>e0(s,Z.WGS84,r));if(!qo())throw new YN;if(!i?.geographicTransformation){if(i?.extendedParams)i={...i,geographicTransformation:Oh.getTransformation(e,r,i.areaOfInterestExtent)||new Uf};else if(!i?.areaOfInterestExtent){const s=fQ(e,r);let n=MS[s];n||(n=Oh.getTransformation(e,r)||new Uf,MS[s]=n),i={geographicTransformation:n}}}return t[0].spatialReference||(t[0].spatialReference=e),t[0]instanceof qt?km.executeMany(t,r,i):Cm.executeMany(t,r,i)}function fQ(t,e){return[t.wkid?.toString()??"-1",t.wkt?.toString()??"",t.wkt2?.toString()??"",e.wkid?.toString()??"-1",e.wkt?.toString()??"",e.wkt2?.toString()??""].join()}function mQ(t,e){const r=JN([t],e);return r.pending!=null?{pending:r.pending,geometry:null}:r.geometries!=null?{pending:null,geometry:r.geometries[0]}:{pending:null,geometry:null}}function JN(t,e){if(!qo()){for(const r of t)if(r!=null&&!Wt(r.spatialReference,e)&&Ni(r.spatialReference)&&Ni(e)&&!nn(r.spatialReference,e))return le($M),{pending:el(),geometries:null}}return{pending:null,geometries:t.map(r=>r==null?null:Wt(r.spatialReference,e)?r:Ni(r.spatialReference)&&Ni(e)?Pm(r,e):null)}}let YN=class extends x{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function yQ(){Bf=null,km=null,Cm=null,Oh=null,MS={}}const gQ={get loadPromise(){return Bf}};function Pm(t,e){try{const r=ll(t,e);if(r==null)return null;"xmin"in t&&"xmin"in r&&(r.zmin=t.zmin,r.zmax=t.zmax);const i=HN(r.type,t.spatialReference,e);return i?.(r),r}catch(r){if(!(r instanceof YN))throw r;return null}}async function KN(t,e,r){const i=t.spatialReference;return i!=null&&e!=null&&await xM(i,e,null,r),Pm(t,e)}function nn(t,e,r){return!(r?.areaOfInterestExtent||r?.extendedParams||r?.geographicTransformation)&&(!!Wt(t,e)||Ni(t)&&Ni(e)&&!!GN(t,e))}function vQ(t,e){if(Wt(t,e))return!0;if(!Ni(t)||!Ni(e))return!1;const r=Cu(t)||Dn(t)||ZI(t),i=Cu(e)||Dn(e)||ZI(e);return r&&i}async function xM(t,e,r,i){if(qo())return hI(i);if(Array.isArray(t)){for(const{source:s,dest:n,options:o}of t)if(s&&n&&!nn(s,n,o))return el(i)}else if(t&&e&&!nn(t,e,r))return el(i);return hI(i)}function e0(t,e,r){return t?"x"in t?QN(t,e,new ee,r,0):"xmin"in t?iD(t,e,new he,r,0):"rings"in t?rD(t,e,new Be,r,0):"paths"in t?eD(t,e,new Rt,r,0):"points"in t?XN(t,e,new zs,r,0):null:null}function wQ(t,e,r=e.spatialReference,i=0){return r!=null&&t.spatialReference!=null&&QN(t,t.spatialReference,e,r,i)!=null}function QN(t,e,r,i,s){Mr[0]=t.x,Mr[1]=t.y;const n=t.z;return Mr[2]=n!==void 0?n:s,dy(Mr,e,0,Mr,i,0)?(r.x=Mr[0],r.y=Mr[1],r.spatialReference=i,n!==void 0||Ya(i)?(r.z=Mr[2],r.hasZ=!0):(r.z=void 0,r.hasZ=!1),t.m===void 0?(r.m=void 0,r.hasM=!1):(r.m=t.m,r.hasM=!0),r):null}function bQ(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&XN(t,t.spatialReference,e,r,i)!=null}function XN(t,e,r,i,s){const{points:n,hasZ:o,hasM:l}=t,u=[],d=n.length,p=[];for(const m of n)p.push(m[0],m[1],o?m[2]:s);if(!dy(p,e,0,p,i,0,d))return null;const f=o||Ya(i);for(let m=0;m<d;++m){const y=3*m,g=p[y],v=p[y+1];f&&l?u.push([g,v,p[y+2],n[m][3]]):f?u.push([g,v,p[y+2]]):l?u.push([g,v,n[m][2]]):u.push([g,v])}return r.points=u,r.spatialReference=i,r.hasZ=o,r.hasM=l,r}function _Q(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&eD(t,t.spatialReference,e,r,i)!=null}function eD(t,e,r,i,s){const{paths:n,hasZ:o,hasM:l}=t,u=[];if(!sD(n,o??!1,l??!1,e,u,i,s))return null;const d=o||Ya(i);return r.paths=u,r.spatialReference=i,r.hasZ=d,r.hasM=l,r}function tD(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&rD(t,t.spatialReference,e,r,i)!=null}function rD(t,e,r,i,s){const{rings:n,hasZ:o,hasM:l}=t,u=[];if(!sD(n,o??!1,l??!1,e,u,i,s))return null;const d=o||Ya(i);return r.rings=u,r.spatialReference=i,r.hasZ=d,r.hasM=l,r}function SQ(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&iD(t,t.spatialReference,e,r,i)!=null}function iD(t,e,r,i,s){const{xmin:n,ymin:o,xmax:l,ymax:u,hasZ:d,hasM:p}=t,f=d?t.zmin:s;if(!pO(n,o,f,e,Mr,i))return null;const m=d||Ya(i);r.xmin=Mr[0],r.ymin=Mr[1],m&&(r.zmin=Mr[2]);const y=d?t.zmax:s;return pO(l,u,y,e,Mr,i)?(r.xmax=Mr[0],r.ymax=Mr[1],m&&(r.zmax=Mr[2]),p&&(r.mmin=t.mmin,r.mmax=t.mmax),r.spatialReference=i,r):null}function sD(t,e,r,i,s,n,o=0){const l=new Array;for(const p of t)for(const f of p)l.push(f[0],f[1],e?f[2]:o);if(!dy(l,i,0,l,n,0))return!1;let u=0;s.length=0;const d=e||Ya(n);for(const p of t){const f=new Array;for(const m of p)d&&r?f.push([l[u++],l[u++],l[u++],m[3]]):d?f.push([l[u++],l[u++],l[u++]]):r?(f.push([l[u++],l[u++],m[2]]),u++):(f.push([l[u++],l[u++]]),u++);s.push(f)}return!0}const Mr=al(),CSe=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:nn,initializeProjection:xM,isEqualBaseGCS:vQ,isLoaded:qo,isLoadedOrLoad:WN,isLoadedOrLoadFor:ZN,load:el,project:ll,projectExtent:SQ,projectMany:IS,projectMultipoint:bQ,projectOrLoad:mQ,projectOrLoadMany:JN,projectPoint:wQ,projectPolygon:tD,projectPolyline:_Q,projectWithZConversion:KN,projectWithoutEngine:e0,requiresLoad:pQ,test:gQ,tryProjectWithZConversion:Pm,unload:yQ},Symbol.toStringTag,{value:"Module"}));var t0;let ES=t0=class extends ol(H.ofType(Be)){constructor(t){super(t)}clone(){return new t0(this.items.map(t=>t.clone()))}write(t,e){return this.toJSON(e)}toJSON(t){const e=t?.layer?.spatialReference;return e?this.toArray().map(r=>{if(!e.equals(r.spatialReference)){if(!nn(r.spatialReference,e))return t?.messages?.push(new qi("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:t.layer.spatialReference,context:t})),null;const s=new Be;tD(r,s,e),r=s}const i=r.toJSON(t);return delete i.spatialReference,i}).filter(r=>r!=null):this.toArray().map(r=>r.toJSON(t))}static fromJSON(t,e){const r=new t0;return t.forEach(i=>r.add(Be.fromJSON(i,e))),r}};ES=t0=a([b("esri.layers.support.PolygonCollection")],ES);const Hf=ES;let Xn=class extends ol(aM){constructor(e){super(e),this.id=`focusarea-${rp()}`,this.title=null,this.enabled=!0,this.outline=null,this.geometries=new Hf}readGeometries(e,r,i){Array.isArray(e)?this.geometries=Hf.fromJSON(e,i):i.origin!=="web-scene"&&i.origin!=="portal-item"||i.hooks?.onAfterLoad?.(()=>this._loadGeometries(Gu(e,i),i))}async _loadGeometries(e,r){const i=await Ae(e,{responseType:"json"});this.geometries=Hf.fromJSON(i.data,r)}};a([c({type:String,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),c()],Xn.prototype,"id",void 0),a([c({type:String,json:{write:!0}})],Xn.prototype,"title",void 0),a([c({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],Xn.prototype,"enabled",void 0),a([c({type:qJ,json:{write:!0}})],Xn.prototype,"outline",void 0),a([c({type:Hf,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new Hf(t.items.map(e=>e.clone()))}),FJ({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],Xn.prototype,"geometries",void 0),a([V(["web-scene","portal-item","service"],"geometries")],Xn.prototype,"readGeometries",null),Xn=a([b("esri.effects.FocusArea")],Xn);const $Q=Xn;let Zp=class extends ol(aM){constructor(e){super(e),this.areas=new H,this.style="bright"}};a([c({type:H.ofType($Q),nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new H(t.items.map(e=>e.clone()))})],Zp.prototype,"areas",void 0),a([c({type:["bright","dark"],nonNullable:!0,json:{write:!0}})],Zp.prototype,"style",void 0),Zp=a([b("esri.effects.FocusAreas")],Zp);const nD=Zp;function xQ(t){return typeof t=="object"&&t!=null&&"loaded"in t&&t.loaded===!0&&"type"in t}function TQ(t){return!(!xQ(t)||!tJ(t)?.operations?.supportsEditing||"editingEnabled"in t&&!iJ(t)||P5(t))}const MQ=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,IQ="screenUtils.toPt: input not recognized!",oD=96;function EQ(t){return t?t/72*oD:0}function gs(t){return t?72*t/oD:0}function Me(t){if(typeof t=="string"){const e=t.match(MQ);if(e){const r=Number(e[1]),i=e[3]&&e[3].toLowerCase(),s=t.startsWith("-"),n=i==="px"?gs(r):r;return s?-n:n}return console.warn(IQ),null}return t}function Bt(t=0,e=0){return{x:t,y:e}}function RSe(t){return t?Bt(t.x,t.y):null}function LSe(t=0,e=0){return[t,e]}function FSe(t=0,e=0,r=0){return[t,e,r]}function NSe(t){return t}function DSe(t){return t}function jSe(t){return t}function VSe(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function Ww(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function OQ(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function kQ(t,e,r,i,s,n,o,l,u,d,p,f,m,y,g,v){const _=new Float32Array(16);return _[0]=t,_[1]=e,_[2]=r,_[3]=i,_[4]=s,_[5]=n,_[6]=o,_[7]=l,_[8]=u,_[9]=d,_[10]=p,_[11]=f,_[12]=m,_[13]=y,_[14]=g,_[15]=v,_}const CQ=Ww();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:CQ,clone:OQ,create:Ww,fromValues:kQ},Symbol.toStringTag,{value:"Module"}));function aD(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ul(t,e,r,i,s,n,o,l,u,d,p,f,m,y,g,v,_){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=n,t[5]=o,t[6]=l,t[7]=u,t[8]=d,t[9]=p,t[10]=f,t[11]=m,t[12]=y,t[13]=g,t[14]=v,t[15]=_,t}function Zw(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function cl(t,e){if(t===e){const r=e[1],i=e[2],s=e[3],n=e[6],o=e[7],l=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=n,t[11]=e[14],t[12]=s,t[13]=o,t[14]=l}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function PQ(t,e){return lD(t,e)||Zw(t),t}function lD(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],l=e[5],u=e[6],d=e[7],p=e[8],f=e[9],m=e[10],y=e[11],g=e[12],v=e[13],_=e[14],S=e[15],M=r*l-i*o,C=r*u-s*o,T=r*d-n*o,O=i*u-s*l,P=i*d-n*l,D=s*d-n*u,z=p*v-f*g,B=p*_-m*g,G=p*S-y*g,Q=f*_-m*v,oe=f*S-y*v,Pe=m*S-y*_;let fe=M*Pe-C*oe+T*Q+O*G-P*B+D*z;return fe?(fe=1/fe,t[0]=(l*Pe-u*oe+d*Q)*fe,t[1]=(s*oe-i*Pe-n*Q)*fe,t[2]=(v*D-_*P+S*O)*fe,t[3]=(m*P-f*D-y*O)*fe,t[4]=(u*G-o*Pe-d*B)*fe,t[5]=(r*Pe-s*G+n*B)*fe,t[6]=(_*T-g*D-S*C)*fe,t[7]=(p*D-m*T+y*C)*fe,t[8]=(o*oe-l*G+d*z)*fe,t[9]=(i*G-r*oe-n*z)*fe,t[10]=(g*P-v*T+S*M)*fe,t[11]=(f*T-p*P-y*M)*fe,t[12]=(l*B-o*Q-u*z)*fe,t[13]=(r*Q-i*B+s*z)*fe,t[14]=(v*C-g*O-_*M)*fe,t[15]=(p*O-f*C+m*M)*fe,t):null}function AQ(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],l=e[5],u=e[6],d=e[7],p=e[8],f=e[9],m=e[10],y=e[11],g=e[12],v=e[13],_=e[14],S=e[15];return t[0]=l*(m*S-y*_)-f*(u*S-d*_)+v*(u*y-d*m),t[1]=-(i*(m*S-y*_)-f*(s*S-n*_)+v*(s*y-n*m)),t[2]=i*(u*S-d*_)-l*(s*S-n*_)+v*(s*d-n*u),t[3]=-(i*(u*y-d*m)-l*(s*y-n*m)+f*(s*d-n*u)),t[4]=-(o*(m*S-y*_)-p*(u*S-d*_)+g*(u*y-d*m)),t[5]=r*(m*S-y*_)-p*(s*S-n*_)+g*(s*y-n*m),t[6]=-(r*(u*S-d*_)-o*(s*S-n*_)+g*(s*d-n*u)),t[7]=r*(u*y-d*m)-o*(s*y-n*m)+p*(s*d-n*u),t[8]=o*(f*S-y*v)-p*(l*S-d*v)+g*(l*y-d*f),t[9]=-(r*(f*S-y*v)-p*(i*S-n*v)+g*(i*y-n*f)),t[10]=r*(l*S-d*v)-o*(i*S-n*v)+g*(i*d-n*l),t[11]=-(r*(l*y-d*f)-o*(i*y-n*f)+p*(i*d-n*l)),t[12]=-(o*(f*_-m*v)-p*(l*_-u*v)+g*(l*m-u*f)),t[13]=r*(f*_-m*v)-p*(i*_-s*v)+g*(i*m-s*f),t[14]=-(r*(l*_-u*v)-o*(i*_-s*v)+g*(i*u-s*l)),t[15]=r*(l*m-u*f)-o*(i*m-s*f)+p*(i*u-s*l),t}function RQ(t){const e=t[0],r=t[1],i=t[2],s=t[3],n=t[4],o=t[5],l=t[6],u=t[7],d=t[8],p=t[9],f=t[10],m=t[11],y=t[12],g=t[13],v=t[14],_=t[15];return(e*o-r*n)*(f*_-m*v)-(e*l-i*n)*(p*_-m*g)+(e*u-s*n)*(p*v-f*g)+(r*l-i*o)*(d*_-m*y)-(r*u-s*o)*(d*v-f*y)+(i*u-s*l)*(d*g-p*y)}function uD(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=e[6],p=e[7],f=e[8],m=e[9],y=e[10],g=e[11],v=e[12],_=e[13],S=e[14],M=e[15];let C=r[0],T=r[1],O=r[2],P=r[3];return t[0]=C*i+T*l+O*f+P*v,t[1]=C*s+T*u+O*m+P*_,t[2]=C*n+T*d+O*y+P*S,t[3]=C*o+T*p+O*g+P*M,C=r[4],T=r[5],O=r[6],P=r[7],t[4]=C*i+T*l+O*f+P*v,t[5]=C*s+T*u+O*m+P*_,t[6]=C*n+T*d+O*y+P*S,t[7]=C*o+T*p+O*g+P*M,C=r[8],T=r[9],O=r[10],P=r[11],t[8]=C*i+T*l+O*f+P*v,t[9]=C*s+T*u+O*m+P*_,t[10]=C*n+T*d+O*y+P*S,t[11]=C*o+T*p+O*g+P*M,C=r[12],T=r[13],O=r[14],P=r[15],t[12]=C*i+T*l+O*f+P*v,t[13]=C*s+T*u+O*m+P*_,t[14]=C*n+T*d+O*y+P*S,t[15]=C*o+T*p+O*g+P*M,t}function LQ(t,e,r){const i=r[0],s=r[1],n=r[2];if(e===t)t[12]=e[0]*i+e[4]*s+e[8]*n+e[12],t[13]=e[1]*i+e[5]*s+e[9]*n+e[13],t[14]=e[2]*i+e[6]*s+e[10]*n+e[14],t[15]=e[3]*i+e[7]*s+e[11]*n+e[15];else{const o=e[0],l=e[1],u=e[2],d=e[3],p=e[4],f=e[5],m=e[6],y=e[7],g=e[8],v=e[9],_=e[10],S=e[11];t[0]=o,t[1]=l,t[2]=u,t[3]=d,t[4]=p,t[5]=f,t[6]=m,t[7]=y,t[8]=g,t[9]=v,t[10]=_,t[11]=S,t[12]=o*i+p*s+g*n+e[12],t[13]=l*i+f*s+v*n+e[13],t[14]=u*i+m*s+_*n+e[14],t[15]=d*i+y*s+S*n+e[15]}return t}function FQ(t,e,r){const i=r[0],s=r[1],n=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function NQ(t,e,r,i){let s=i[0],n=i[1],o=i[2],l=Math.sqrt(s*s+n*n+o*o);if(l<=Qr())return void aD(t,e);l=1/l,s*=l,n*=l,o*=l;const u=Math.sin(r),d=Math.cos(r),p=1-d,f=e[0],m=e[1],y=e[2],g=e[3],v=e[4],_=e[5],S=e[6],M=e[7],C=e[8],T=e[9],O=e[10],P=e[11],D=s*s*p+d,z=n*s*p+o*u,B=o*s*p-n*u,G=s*n*p-o*u,Q=n*n*p+d,oe=o*n*p+s*u,Pe=s*o*p+n*u,fe=n*o*p-s*u,Nt=o*o*p+d;t[0]=f*D+v*z+C*B,t[1]=m*D+_*z+T*B,t[2]=y*D+S*z+O*B,t[3]=g*D+M*z+P*B,t[4]=f*G+v*Q+C*oe,t[5]=m*G+_*Q+T*oe,t[6]=y*G+S*Q+O*oe,t[7]=g*G+M*Q+P*oe,t[8]=f*Pe+v*fe+C*Nt,t[9]=m*Pe+_*fe+T*Nt,t[10]=y*Pe+S*fe+O*Nt,t[11]=g*Pe+M*fe+P*Nt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15])}function DQ(t,e,r){const i=Math.sin(r),s=Math.cos(r),n=e[4],o=e[5],l=e[6],u=e[7],d=e[8],p=e[9],f=e[10],m=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=n*s+d*i,t[5]=o*s+p*i,t[6]=l*s+f*i,t[7]=u*s+m*i,t[8]=d*s-n*i,t[9]=p*s-o*i,t[10]=f*s-l*i,t[11]=m*s-u*i,t}function jQ(t,e,r){const i=Math.sin(r),s=Math.cos(r),n=e[0],o=e[1],l=e[2],u=e[3],d=e[8],p=e[9],f=e[10],m=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*s-d*i,t[1]=o*s-p*i,t[2]=l*s-f*i,t[3]=u*s-m*i,t[8]=n*i+d*s,t[9]=o*i+p*s,t[10]=l*i+f*s,t[11]=u*i+m*s,t}function VQ(t,e,r){const i=Math.sin(r),s=Math.cos(r),n=e[0],o=e[1],l=e[2],u=e[3],d=e[4],p=e[5],f=e[6],m=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*s+d*i,t[1]=o*s+p*i,t[2]=l*s+f*i,t[3]=u*s+m*i,t[4]=d*s-n*i,t[5]=p*s-o*i,t[6]=f*s-l*i,t[7]=m*s-u*i,t}function zQ(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function UQ(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function qQ(t,e,r){if(e===0)return Zw(t);let i=r[0],s=r[1],n=r[2],o=Math.sqrt(i*i+s*s+n*n);if(o<=Qr())return null;o=1/o,i*=o,s*=o,n*=o;const l=Math.sin(e),u=Math.cos(e),d=1-u;return t[0]=i*i*d+u,t[1]=s*i*d+n*l,t[2]=n*i*d-s*l,t[3]=0,t[4]=i*s*d-n*l,t[5]=s*s*d+u,t[6]=n*s*d+i*l,t[7]=0,t[8]=i*n*d+s*l,t[9]=s*n*d-i*l,t[10]=n*n*d+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function GQ(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function BQ(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function HQ(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function cD(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=i+i,u=s+s,d=n+n,p=i*l,f=i*u,m=i*d,y=s*u,g=s*d,v=n*d,_=o*l,S=o*u,M=o*d;return t[0]=1-(y+v),t[1]=f+M,t[2]=m-S,t[3]=0,t[4]=f-M,t[5]=1-(p+v),t[6]=g+_,t[7]=0,t[8]=m+S,t[9]=g-_,t[10]=1-(p+y),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function WQ(t,e){const r=ZQ,i=-e[0],s=-e[1],n=-e[2],o=e[3],l=e[4],u=e[5],d=e[6],p=e[7],f=i*i+s*s+n*n+o*o;return f>0?(r[0]=2*(l*o+p*i+u*n-d*s)/f,r[1]=2*(u*o+p*s+d*i-l*n)/f,r[2]=2*(d*o+p*n+l*s-u*i)/f):(r[0]=2*(l*o+p*i+u*n-d*s),r[1]=2*(u*o+p*s+d*i-l*n),r[2]=2*(d*o+p*n+l*s-u*i)),cD(t,e,r),t}const ZQ=al();function JQ(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function YQ(t,e){const r=e[0],i=e[1],s=e[2],n=e[4],o=e[5],l=e[6],u=e[8],d=e[9],p=e[10];return t[0]=Math.sqrt(r*r+i*i+s*s),t[1]=Math.sqrt(n*n+o*o+l*l),t[2]=Math.sqrt(u*u+d*d+p*p),t}function KQ(t,e){const r=e[0]+e[5]+e[10];let i=0;return r>0?(i=2*Math.sqrt(r+1),t[3]=.25*i,t[0]=(e[6]-e[9])/i,t[1]=(e[8]-e[2])/i,t[2]=(e[1]-e[4])/i):e[0]>e[5]&&e[0]>e[10]?(i=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/i,t[0]=.25*i,t[1]=(e[1]+e[4])/i,t[2]=(e[8]+e[2])/i):e[5]>e[10]?(i=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/i,t[0]=(e[1]+e[4])/i,t[1]=.25*i,t[2]=(e[6]+e[9])/i):(i=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/i,t[0]=(e[8]+e[2])/i,t[1]=(e[6]+e[9])/i,t[2]=.25*i),t}function QQ(t,e,r,i){const s=e[0],n=e[1],o=e[2],l=e[3],u=s+s,d=n+n,p=o+o,f=s*u,m=s*d,y=s*p,g=n*d,v=n*p,_=o*p,S=l*u,M=l*d,C=l*p,T=i[0],O=i[1],P=i[2];return t[0]=(1-(g+_))*T,t[1]=(m+C)*T,t[2]=(y-M)*T,t[3]=0,t[4]=(m-C)*O,t[5]=(1-(f+_))*O,t[6]=(v+S)*O,t[7]=0,t[8]=(y+M)*P,t[9]=(v-S)*P,t[10]=(1-(f+g))*P,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function XQ(t,e,r,i,s){const n=e[0],o=e[1],l=e[2],u=e[3],d=n+n,p=o+o,f=l+l,m=n*d,y=n*p,g=n*f,v=o*p,_=o*f,S=l*f,M=u*d,C=u*p,T=u*f,O=i[0],P=i[1],D=i[2],z=s[0],B=s[1],G=s[2],Q=(1-(v+S))*O,oe=(y+T)*O,Pe=(g-C)*O,fe=(y-T)*P,Nt=(1-(m+S))*P,Si=(_+M)*P,or=(g+C)*D,Ne=(_-M)*D,bs=(1-(m+v))*D;return t[0]=Q,t[1]=oe,t[2]=Pe,t[3]=0,t[4]=fe,t[5]=Nt,t[6]=Si,t[7]=0,t[8]=or,t[9]=Ne,t[10]=bs,t[11]=0,t[12]=r[0]+z-(Q*z+fe*B+or*G),t[13]=r[1]+B-(oe*z+Nt*B+Ne*G),t[14]=r[2]+G-(Pe*z+Si*B+bs*G),t[15]=1,t}function eX(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=r+r,l=i+i,u=s+s,d=r*o,p=i*o,f=i*l,m=s*o,y=s*l,g=s*u,v=n*o,_=n*l,S=n*u;return t[0]=1-f-g,t[1]=p+S,t[2]=m-_,t[3]=0,t[4]=p-S,t[5]=1-d-g,t[6]=y+v,t[7]=0,t[8]=m+_,t[9]=y-v,t[10]=1-d-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function tX(t,e,r,i,s,n,o){const l=1/(r-e),u=1/(s-i),d=1/(n-o);return t[0]=2*n*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*n*u,t[6]=0,t[7]=0,t[8]=(r+e)*l,t[9]=(s+i)*u,t[10]=(o+n)*d,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*n*2*d,t[15]=0,t}function rX(t,e,r,i,s){const n=1/Math.tan(e/2);let o;return t[0]=n/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(o=1/(i-s),t[10]=(s+i)*o,t[14]=2*s*i*o):(t[10]=-1,t[14]=-2*i),t}function iX(t,e,r,i){const s=Math.tan(e.upDegrees*Math.PI/180),n=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),l=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+l),d=2/(s+n);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=-(o-l)*u*.5,t[9]=(s-n)*d*.5,t[10]=i/(r-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*r/(r-i),t[15]=0,t}function sX(t,e,r,i,s,n,o){const l=1/(e-r),u=1/(i-s),d=1/(n-o);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*d,t[11]=0,t[12]=(e+r)*l,t[13]=(s+i)*u,t[14]=(o+n)*d,t[15]=1,t}function nX(t,e,r,i){const s=e[0],n=e[1],o=e[2];let l=s-r[0],u=n-r[1],d=o-r[2];const p=Qr();if(Math.abs(l)<p&&Math.abs(u)<p&&Math.abs(d)<p)return void Zw(t);let f=1/Math.sqrt(l*l+u*u+d*d);l*=f,u*=f,d*=f;const m=i[0],y=i[1],g=i[2];let v=y*d-g*u,_=g*l-m*d,S=m*u-y*l;f=Math.sqrt(v*v+_*_+S*S),f?(f=1/f,v*=f,_*=f,S*=f):(v=0,_=0,S=0);let M=u*S-d*_,C=d*v-l*S,T=l*_-u*v;f=Math.sqrt(M*M+C*C+T*T),f?(f=1/f,M*=f,C*=f,T*=f):(M=0,C=0,T=0),t[0]=v,t[1]=M,t[2]=l,t[3]=0,t[4]=_,t[5]=C,t[6]=u,t[7]=0,t[8]=S,t[9]=T,t[10]=d,t[11]=0,t[12]=-(v*s+_*n+S*o),t[13]=-(M*s+C*n+T*o),t[14]=-(l*s+u*n+d*o),t[15]=1}function oX(t,e,r,i){const s=e[0],n=e[1],o=e[2],l=i[0],u=i[1],d=i[2];let p=s-r[0],f=n-r[1],m=o-r[2],y=p*p+f*f+m*m;y>0&&(y=1/Math.sqrt(y),p*=y,f*=y,m*=y);let g=u*m-d*f,v=d*p-l*m,_=l*f-u*p;return y=g*g+v*v+_*_,y>0&&(y=1/Math.sqrt(y),g*=y,v*=y,_*=y),t[0]=g,t[1]=v,t[2]=_,t[3]=0,t[4]=f*_-m*v,t[5]=m*g-p*_,t[6]=p*v-f*g,t[7]=0,t[8]=p,t[9]=f,t[10]=m,t[11]=0,t[12]=s,t[13]=n,t[14]=o,t[15]=1,t}function aX(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function lX(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function uX(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function dD(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function cX(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function dX(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t[9]=e[9]+r[9]*i,t[10]=e[10]+r[10]*i,t[11]=e[11]+r[11]*i,t[12]=e[12]+r[12]*i,t[13]=e[13]+r[13]*i,t[14]=e[14]+r[14]*i,t[15]=e[15]+r[15]*i,t}function hX(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function pX(t,e){if(t===e)return!0;const r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],l=t[5],u=t[6],d=t[7],p=t[8],f=t[9],m=t[10],y=t[11],g=t[12],v=t[13],_=t[14],S=t[15],M=e[0],C=e[1],T=e[2],O=e[3],P=e[4],D=e[5],z=e[6],B=e[7],G=e[8],Q=e[9],oe=e[10],Pe=e[11],fe=e[12],Nt=e[13],Si=e[14],or=e[15],Ne=Qr();return Math.abs(r-M)<=Ne*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(i-C)<=Ne*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(s-T)<=Ne*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(n-O)<=Ne*Math.max(1,Math.abs(n),Math.abs(O))&&Math.abs(o-P)<=Ne*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(l-D)<=Ne*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(u-z)<=Ne*Math.max(1,Math.abs(u),Math.abs(z))&&Math.abs(d-B)<=Ne*Math.max(1,Math.abs(d),Math.abs(B))&&Math.abs(p-G)<=Ne*Math.max(1,Math.abs(p),Math.abs(G))&&Math.abs(f-Q)<=Ne*Math.max(1,Math.abs(f),Math.abs(Q))&&Math.abs(m-oe)<=Ne*Math.max(1,Math.abs(m),Math.abs(oe))&&Math.abs(y-Pe)<=Ne*Math.max(1,Math.abs(y),Math.abs(Pe))&&Math.abs(g-fe)<=Ne*Math.max(1,Math.abs(g),Math.abs(fe))&&Math.abs(v-Nt)<=Ne*Math.max(1,Math.abs(v),Math.abs(Nt))&&Math.abs(_-Si)<=Ne*Math.max(1,Math.abs(_),Math.abs(Si))&&Math.abs(S-or)<=Ne*Math.max(1,Math.abs(S),Math.abs(or))}function fX(t){const e=Qr(),r=t[0],i=t[1],s=t[2],n=t[4],o=t[5],l=t[6],u=t[8],d=t[9],p=t[10];return Math.abs(1-(r*r+n*n+u*u))<=e&&Math.abs(1-(i*i+o*o+d*d))<=e&&Math.abs(1-(s*s+l*l+p*p))<=e}function mX(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const yX=uD,gX=dD;Object.freeze(Object.defineProperty({__proto__:null,add:uX,adjoint:AQ,copy:aD,determinant:RQ,equals:pX,exactEquals:hX,frob:lX,fromQuat:eX,fromQuat2:WQ,fromRotation:qQ,fromRotationTranslation:cD,fromRotationTranslationScale:QQ,fromRotationTranslationScaleOrigin:XQ,fromScaling:UQ,fromTranslation:zQ,fromXRotation:GQ,fromYRotation:BQ,fromZRotation:HQ,frustum:tX,getRotation:KQ,getScale:YQ,getTranslation:JQ,hasIdentityRotation:mX,identity:Zw,invert:lD,invertOrIdentity:PQ,isOrthoNormal:fX,lookAt:nX,mul:yX,multiply:uD,multiplyScalar:cX,multiplyScalarAndAdd:dX,ortho:sX,perspective:rX,perspectiveFromFieldOfView:iX,rotate:NQ,rotateX:DQ,rotateY:jQ,rotateZ:VQ,scale:FQ,set:ul,str:aX,sub:gX,subtract:dD,targetTo:oX,translate:LQ,transpose:cl},Symbol.toStringTag,{value:"Module"}));const vX=(t,e)=>{const r=ul(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return cl(r,r)},wX=(t,e)=>{const r=ul(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return cl(r,r)},bX=(t,e)=>{const r=1-e,i=ul(t,.2126+.7874*r,.7152-.7152*r,.0722-.0722*r,0,.2126-.2126*r,.7152+.2848*r,.0722-.0722*r,0,.2126-.2126*r,.7152-.7152*r,.0722+.9278*r,0,0,0,0,1);return cl(i,i)},_X=(t,e)=>{const r=Math.sin(e*Math.PI/180),i=Math.cos(e*Math.PI/180),s=ul(t,.213+.787*i-.213*r,.715-.715*i-.715*r,.072-.072*i+.928*r,0,.213-.213*i+.143*r,.715+.285*i+.14*r,.072-.072*i-.283*r,0,.213-.213*i-.787*r,.715-.715*i+.715*r,.072+.928*i+.072*r,0,0,0,0,1);return cl(s,s)},SX=(t,e)=>{const r=1-2*e,i=ul(t,r,0,0,e,0,r,0,e,0,0,r,e,0,0,0,1);return cl(i,i)},$X=(t,e)=>{const r=ul(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return cl(r,r)},xX=(t,e)=>{const r=1-e,i=ul(t,.393+.607*r,.769-.769*r,.189-.189*r,0,.349-.349*r,.686+.314*r,.168-.168*r,0,.272-.272*r,.534-.534*r,.131+.869*r,0,0,0,0,1);return cl(i,i)};let hD=class pD{constructor(e,r,i){this.strength=e,this.radius=r,this.threshold=i,this.type="bloom"}interpolate(e,r,i){this.strength=pi(e.strength,r.strength,i),this.radius=pi(e.radius,r.radius,i),this.threshold=pi(e.threshold,r.threshold,i)}clone(){return new pD(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:Wf(this.radius),strength:this.strength,threshold:this.threshold}}},fD=class mD{constructor(e){this.radius=e,this.type="blur"}interpolate(e,r,i){this.radius=Math.round(pi(e.radius,r.radius,i))}clone(){return new mD(this.radius)}toJSON(){return{type:"blur",radius:Wf(this.radius)}}},OS=class yD{constructor(e,r){this.type=e,this.amount=r,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,r,i){this.amount=pi(e.amount,r.amount,i),this._updateMatrix()}clone(){return new yD(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const e=this._colorMatrix||Ww();switch(this.type){case"brightness":this._colorMatrix=vX(e,this.amount);break;case"contrast":this._colorMatrix=wX(e,this.amount);break;case"grayscale":this._colorMatrix=bX(e,this.amount);break;case"invert":this._colorMatrix=SX(e,this.amount);break;case"saturate":this._colorMatrix=$X(e,this.amount);break;case"sepia":this._colorMatrix=xX(e,this.amount)}}},gD=class vD{constructor(e,r,i,s){this.offsetX=e,this.offsetY=r,this.blurRadius=i,this.color=s,this.type="drop-shadow"}interpolate(e,r,i){this.offsetX=pi(e.offsetX,r.offsetX,i),this.offsetY=pi(e.offsetY,r.offsetY,i),this.blurRadius=pi(e.blurRadius,r.blurRadius,i),this.color[0]=Math.round(pi(e.color[0],r.color[0],i)),this.color[1]=Math.round(pi(e.color[1],r.color[1],i)),this.color[2]=Math.round(pi(e.color[2],r.color[2],i)),this.color[3]=pi(e.color[3],r.color[3],i)}clone(){return new vD(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const e=[...this.color];return e[3]*=255,{type:"drop-shadow",xoffset:Wf(this.offsetX),yoffset:Wf(this.offsetY),blurRadius:Wf(this.blurRadius),color:e}}},wD=class bD{constructor(e){this.angle=e,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,r,i){this.angle=pi(e.angle,r.angle,i),this._updateMatrix()}clone(){return new bD(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const e=this._colorMatrix||Ww();this._colorMatrix=_X(e,this.angle)}},_D=class SD{constructor(e){this.amount=e,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(e,r,i){this.amount=pi(e.amount,r.amount,i)}clone(){return new SD(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function pi(t,e,r){return t+(e-t)*r}function Wf(t){return Math.round(1e3*gs(t))/1e3}function TX(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new OS(t.type,0);case"saturate":case"brightness":case"contrast":return new OS(t.type,1);case"opacity":return new _D(1);case"hue-rotate":return new wD(0);case"blur":return new fD(0);case"drop-shadow":return new gD(0,0,0,[...oM("transparent")]);case"bloom":return new hD(0,0,1)}}function MX(t,e){const r=t.length>e.length?t:e;return(t.length>e.length?e:t).every((i,s)=>i.type===r[s].type)}function IX(t,e){const r=t.length>e.length?t:e,i=t.length>e.length?e:t;for(let s=i.length;s<r.length;s++)i.push(TX(r[s]))}function EX(t){const e=t[0];return!!e&&"type"in e}const ab=()=>L.getLogger("esri.support.basemapUtils");function OX(){return{}}function kX(t){for(const e in t){const r=t[e];r&&!r.destroyed&&r.destroy(),delete t[e]}}function CX(t,e){let r;if(typeof t=="string"){const i=t in Z_,s=!i&&t.includes("/");if(!i&&!s){if($_())ab().warn(`Unable to find basemap definition for: ${t}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const n=Object.entries(Z_).filter(([o,l])=>l.classic||l.is3d).map(([o])=>`"${o}"`).sort().join(", ");ab().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${n}`)}return null}e&&(r=e[t]),r||(r=i?zf.fromId(t):new zf({style:{id:t}}),e&&(e[t]=r))}else r=ct(zf,t);return r?.destroyed&&(ab().warn("The provided basemap is already destroyed",{basemap:r}),r=null),r}function PX(t){return new Zs({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const r=[];return"tables"in e&&r.push(e.tables),"layers"in e&&r.push(e.layers),r},itemFilterFunction:e=>{const r=e.parent;return!!r&&"tables"in r&&r.tables.includes(e)}})}function Gy(t){for(const e of t.values())e?.destroy();t.clear()}const fO={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function AX(t){let e=null;if(typeof t=="string")if(t in fO){const r=fO[t];e=new Av({resourceInfo:{data:{layers:[r]}}})}else L.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=ct(Av,t);return e}function kS(t,e,r){let i,s;if(t)for(let n=0,o=t.length;n<o;n++){if(i=t.at(n),i?.[e]===r)return i;if(i?.type==="group"&&(s=kS(i.layers,e,r),s))return s}}const RX=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.layers=new H;const s=l=>{l.parent&&l.removeFromParent()},n=l=>{l.parent=this,this.layerAdded(l),l.type!=="elevation"&&l.type!=="base-elevation"||L.getLogger(this).error(`Layer 'title:${l.title}, id:${l.id}' of type '${l.type}' is not supported as an operational layer and will therefore be ignored.`)},o=l=>{l.parent=null,this.layerRemoved(l)};this.addHandles([this.layers.on("before-add",l=>{if(l.item===this)return l.preventDefault(),void L.getLogger(this).error("#add()","Cannot add layer to itself.");s(l.item)}),this.layers.on("after-add",l=>n(l.item)),this.layers.on("after-remove",l=>o(l.item))])}destroy(){const i=this.layers.toArray();for(const s of i)s.destroy();this.layers.destroy()}removeChildLayer(i){this.layers.remove(i),super.removeChildLayer?.(i)}set layers(i){this._set("layers",Pn(i,this._get("layers")))}add(i,s){const n=this.layers;if(s=n.getNextIndex(s),i instanceof tt){const o=i;o.parent===this?this.reorder(o,s):n.add(o,s)}else Ar(i)?i.then(o=>{this.destroyed||this.add(o,s)}):L.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(i,s){const n=this.layers;let o=n.getNextIndex(s);i.slice().forEach(l=>{l.parent!==this?(n.add(l,o),o+=1):this.reorder(l,o)})}findLayerById(i){return kS(this.layers,"id",i)}findLayerByUid(i){return kS(this.layers,"uid",i)}remove(i){return this.layers.remove(i)}removeMany(i){return this.layers.removeMany(i)}removeAll(){return this.layers.removeAll()}reorder(i,s){return this.layers.reorder(i,s)}layerAdded(i){}layerRemoved(i){}};return a([c()],r.prototype,"layers",null),r=a([b("esri.support.LayersMixin")],r),r},LX=new Set(["feature","subtype-group"]);function CS(t,e,r){if(t)for(let i=0,s=t.length;i<s;i++){const n=t.at(i);if(n[e]===r)return n;if(n?.type==="group"){const o=CS(n.tables,e,r);if(o)return o}}}const FX=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.tables=new H,this.addHandles([this.tables.on("after-add",s=>{const n=s.item;n.parent&&n.parent!==this&&n.removeFromParent(),n.parent=this,LX.has(n.type)||L.getLogger(this).error(`Layer 'title:${n.title}, id:${n.id}' of type '${n.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",s=>{s.item.parent=null})])}destroy(){const i=this.tables.toArray();for(const s of i)s.destroy();this.tables.destroy()}removeChildLayer(i){this.tables.remove(i),super.removeChildLayer?.(i)}set tables(i){this._set("tables",Pn(i,this._get("tables")))}findTableById(i){return CS(this.tables,"id",i)}findTableByUid(i){return CS(this.tables,"uid",i)}};return a([c()],r.prototype,"tables",null),r=a([b("esri.support.TablesMixin")],r),r};let Xi=class extends FX(RX(Yh)){constructor(e){super(e),this.allLayers=new Zs({getCollections:()=>[this.basemap?.baseLayers,this.basemap?.groundLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:r=>"layers"in r?r.layers:null}),this.focusAreas=new nD,this.allTables=PX(this),this.basemap=null,this.editableLayers=new Zs({getCollections:()=>[this.allLayers],itemFilterFunction:TQ}),this.ground=new Av,this._basemapCache=OX(),this.addHandles(Gi(()=>this.ground,(r,i)=>{i?.parent===this&&(i.parent=null),r.parent=this},{sync:!0}))}destroy(){kX(this._basemapCache),this._basemapCache=null,this.focusAreas.destroy(),this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=Ke(this.basemap),Ke(this.ground),this._set("ground",null)}castBasemap(e){return CX(e,this._basemapCache)}castGround(e){return AX(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(r=>r.id===e)}findTableById(e){return this.allTables.find(r=>r.id===e)}};a([c({readOnly:!0,dependsOn:[]})],Xi.prototype,"allLayers",void 0),a([c({type:nD,nonNullable:!0,json:{write:{overridePolicy:t=>({enabled:t.areas.length>0,ignoreOrigin:!0})}}})],Xi.prototype,"focusAreas",void 0),a([c({readOnly:!0})],Xi.prototype,"allTables",void 0),a([c({type:zf,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Xi.prototype,"basemap",void 0),a([Ce("basemap")],Xi.prototype,"castBasemap",null),a([c({readOnly:!0})],Xi.prototype,"editableLayers",void 0),a([c({type:Av,nonNullable:!0})],Xi.prototype,"ground",void 0),a([Ce("ground")],Xi.prototype,"castGround",null),a([c()],Xi.prototype,"undoRedo",void 0),Xi=a([b("esri.Map")],Xi);const $D=Xi;let El=class extends aM{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return e!=null&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};a([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],El.prototype,"row",void 0),a([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],El.prototype,"column",void 0),a([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],El.prototype,"rows",void 0),a([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],El.prototype,"columns",void 0),El=a([b("esri.CameraLayout")],El);const xD=El;let Jw=class{constructor(e,r){this.min=e,this.max=r,this.range=r-e}normalize(e,r=0,i=!1){return mO(this.range,this.min,this.max,e,r,i)}clamp(e,r=0){return Bi(e-r,this.min,this.max)+r}monotonic(e,r,i){return e<r?r:r+PS(this.range,e-r,i)}minimalMonotonic(e,r,i){return mO(this.range,e,e+this.range,r,i)}center(e,r,i){return r=this.monotonic(e,r,i),this.normalize((e+r)/2,i)}diff(e,r,i){return this.monotonic(e,r,i)-e}shortestSignedDiff(e,r){e=this.normalize(e);const i=(r=this.normalize(r))-e,s=r<e?this.minimalMonotonic(e,r)-e:r-this.minimalMonotonic(r,e);return Math.abs(i)<Math.abs(s)?i:s}contains(e,r,i){return r=this.minimalMonotonic(e,r),(i=this.minimalMonotonic(e,i))>e&&i<r}};function mO(t,e,r,i,s=0,n=!1){return(i-=s)<e?i+=PS(t,e-i):i>r&&(i-=PS(t,i-r)),n&&i===r&&(i=e),i+s}function PS(t,e,r=0){return Math.ceil((e-r)/t)*t+r}const GSe=new Jw(0,2*Math.PI),BSe=new Jw(-Math.PI,Math.PI),NX=new Jw(0,360);let un=class extends pe(F){constructor(...e){super(...e),this.position=new ee([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new xD}normalizeCtorArgs(e,r,i,s){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const n={position:e};return r!=null&&(n.heading=r),i!=null&&(n.tilt=i),s!=null&&(n.fov=s),n}return e}writePosition(e,r,i,s){const n=e.clone();n.x=Hr(e.x||0),n.y=Hr(e.y||0),n.z=e.hasZ?Hr(e.z||0):e.z,r[i]=n.write({},s)}readPosition(e,r){const i=new ee;return i.read(e,r),i.x=Hr(i.x||0),i.y=Hr(i.y||0),i.z=i.hasZ?Hr(i.z||0):i.z,i}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};a([c({type:ee,json:{write:{isRequired:!0}}})],un.prototype,"position",void 0),a([q("position")],un.prototype,"writePosition",null),a([V("position")],un.prototype,"readPosition",null),a([c({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ce(t=>NX.normalize(Hr(t)))],un.prototype,"heading",void 0),a([c({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ce(t=>Bi(Hr(t),-180,180))],un.prototype,"tilt",void 0),a([c({type:Number,nonNullable:!0,json:{default:55,write:!0}}),Ce(t=>Bi(Hr(t,55),1,170))],un.prototype,"fov",void 0),a([c({type:xD,nonNullable:!0,json:{read:!1,write:!1}})],un.prototype,"layout",void 0),un=a([b("esri.Camera")],un);const DX=un;function TD(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function MD(t){return t.points!==void 0}function ID(t){return t.x!==void 0&&t.y!==void 0}function ED(t){return t.paths!==void 0||t.curvePaths!==void 0}function Nd(t){return t.rings!==void 0||t.curveRings!==void 0}function tl(t){return t==null?null:t instanceof qt?t:ID(t)?ee.fromJSON(t):ED(t)?Rt.fromJSON(t):Nd(t)?Be.fromJSON(t):MD(t)?zs.fromJSON(t):TD(t)?he.fromJSON(t):null}function sp(t){return t?ID(t)?"esriGeometryPoint":ED(t)?"esriGeometryPolyline":Nd(t)?"esriGeometryPolygon":TD(t)?"esriGeometryEnvelope":MD(t)?"esriGeometryMultipoint":null:null}const jX={esriGeometryPoint:ee,esriGeometryPolyline:Rt,esriGeometryPolygon:Be,esriGeometryEnvelope:he,esriGeometryMultipoint:zs,esriGeometryMultiPatch:Be};function VX(t){return t&&jX[t]||null}const zX=Ft()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),yO=Ft()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),hy={base:qt,key:"type",typeMap:{extent:he,multipoint:zs,point:ee,polyline:Rt,polygon:Be}};function WSe(t){return t.type==="point"}function ZSe(t){return t.type==="multipoint"}function JSe(t){return t.type==="polygon"}function YSe(t){return t.type==="polyline"}var AS;let na=AS=class extends F{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new AS({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};a([c({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:lb}}}}})],na.prototype,"rotation",void 0),a([Ce("rotation")],na.prototype,"castRotation",null),a([c({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:lb}}}}})],na.prototype,"scale",void 0),a([c({types:hy,json:{read:tl,write:!0,origins:{"web-scene":{read:tl,write:{overridePolicy:lb}}}}})],na.prototype,"targetGeometry",void 0),a([c({type:DX,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],na.prototype,"camera",void 0),na=AS=a([b("esri.Viewpoint")],na);const fs=na;function lb(){return{enabled:!this.camera}}let Am=class{constructor(e=r=>r.values().next().value){this._peeker=e,this._observable=new ty,this._items=new Set}get length(){return le(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return le(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const r=this.length;return this._items.forEach(i=>{e(i)||this._items.delete(i)}),r!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){le(this._observable),yield*this._items}};const OD=new FinalizationRegistry(t=>{t.close()});function UX(t,e){OD.register(t,e,e)}function qX(t){OD.unregister(t)}function kD(t,e){return new Proxy({},{get:(r,i,s)=>(...n)=>{let o,l;const u=n[n.length-1];return GX(u)&&(o=u.signal,l=u.transferList,n.pop()),t.apply(e?`${e}.${i.toString()}`:i.toString(),n,{transferList:l,signal:o})}})}function GX(t){return typeof t=="object"&&!Array.isArray(t)&&t!=null&&("signal"in t||"transferList"in t||Object.keys(t).length===0)}const BX={statsWorker:()=>N(()=>import("./statsWorker-BECh1aT-.js"),__vite__mapDeps([19,20,21,22,23,24])),geometryEngineWorker:()=>N(()=>import("./geometryEngineWorker-BkMQzpX8.js"),__vite__mapDeps([25,26,27,28])),arcadeGeometryOperatorsWorker:()=>N(()=>import("./operatorsWorker-60EnIpnR.js"),[]),CSVSourceWorker:()=>N(()=>import("./CSVSourceWorker-Ppa3L8Wf.js"),__vite__mapDeps([29,30,31,4,32,33,34,35,36,37,38,39,40,41,42,43,21,20,22,23,24,44,45,46,47,48])),EdgeProcessingWorker:()=>N(()=>import("./EdgeProcessingWorker-BvZRfhaD.js"),__vite__mapDeps([49,50,51,52,53,54,55,56,57,58,59])),ElevationSamplerWorker:()=>N(()=>import("./ElevationSamplerWorker-CnSj_yJw.js"),__vite__mapDeps([60,36,61,62,63,64,65,66,67,52,68])),FeatureServiceSnappingSourceWorker:()=>N(()=>import("./FeatureServiceSnappingSourceWorker-sOFtaox-.js"),__vite__mapDeps([69,32,33,31,4,34,35,36,37,38,39,40,41,42,43,21,20,22,23,24,44,45,70,71,72,73])),GaussianSplatSortWorker:()=>N(()=>import("./GaussianSplatSortWorker-CkystscD.js"),[]),GeoJSONSourceWorker:()=>N(()=>import("./GeoJSONSourceWorker-KSWlLHc7.js"),__vite__mapDeps([74,33,31,4,34,32,35,36,37,38,39,40,41,42,43,21,20,22,23,24,44,45,75,30,48,76])),LercWorker:()=>N(()=>import("./LercWorker-GJCTvCIw.js"),[]),MemorySourceWorker:()=>N(()=>import("./MemorySourceWorker-DVCu71sn.js"),__vite__mapDeps([77,33,31,4,34,78,32,35,36,37,38,39,40,41,42,43,21,20,22,23,24,44,45,48,76,30])),PBFDecoderWorker:()=>N(()=>import("./PBFDecoderWorker-BFXqXBUw.js"),__vite__mapDeps([79,80,4,33,31,34,71,72])),FeaturePipelineWorker:()=>N(()=>import("./FeaturePipelineWorker-DJCu2IwZ.js"),__vite__mapDeps([81,82,83,84,54,85,86,31,4,33,34,87,21,88,38,37,89,90,91,92,93,94,95,96,97,98,99,39,40,41,42,43,20,22,23,24,44,45,100,101,102,103,17,104,105,106,107,75,30,48,76,73,71,72,108,109])),PointCloudWorker:()=>N(()=>import("./PointCloudWorker-D3mK8TSP.js"),__vite__mapDeps([110,111,112,113,114,115,116,63,64,117,118])),RasterWorker:()=>N(()=>import("./RasterWorker-BLXf8m72.js"),__vite__mapDeps([119,120,121,28,122,123,124,125,126,127,128])),SceneLayerSnappingSourceWorker:()=>N(()=>import("./SceneLayerSnappingSourceWorker-BllAr-Kc.js"),__vite__mapDeps([129,130,131,118,112,132,133,117,52,56,57,58,51,53,54,55,59])),SceneLayerWorker:()=>N(()=>import("./SceneLayerWorker-llzocICZ.js"),__vite__mapDeps([134,61,67,135,65])),WFSSourceWorker:()=>N(()=>import("./WFSSourceWorker-CCsesCMN.js"),__vite__mapDeps([136,33,31,4,34,32,35,36,37,38,39,40,41,42,43,21,20,22,23,24,44,45,75,30,76,137,138])),WorkerTileHandler:()=>N(()=>import("./WorkerTileHandler-DQKK_UnU.js"),__vite__mapDeps([139,94,140,95,141,72,4,97,142,143,55,54,123,144,93])),Lyr3DWorker:()=>N(()=>import("./Lyr3DWorker-CEp70ZLk.js"),[]),Feature3DPipelineWorker:()=>N(()=>import("./Feature3DPipelineWorker-DuKxClvm.js"),__vite__mapDeps([145,40,33,31,4,34,41,42,37,38,43,21,20,22,23,24,44,45,146,66,61,135,65,147,113,148,58,52,149,131,118,112,130,150,151,133,117,116,111,63,64,55,54,51,53,152,153,154,155,156,157,158,159,160,161,36,73,71,72,162])),TextureCompressionWorker:()=>N(()=>import("./TextureCompressionWorker-B7p2cN_m.js"),[]),FlowWorker:()=>N(()=>import("./FlowWorker-C3WAwHkA.js"),__vite__mapDeps([163,128])),ParquetSourceWorker:()=>N(()=>import("./ParquetSourceWorker-Nte-4xPF.js"),__vite__mapDeps([164,99,40,33,31,4,34,41,42,37,38,43,21,20,22,23,24,44,45,48,165,47,102,86,87,101,100])),PanoramicMeshWorker:()=>N(()=>import("./PanoramicMeshWorker-DL-LiDyT.js"),__vite__mapDeps([166,120]))},CD="worker:port-closed",Fo={HANDSHAKE:0,OPEN:1,OPENED:2,RESPONSE:3,INVOKE:4,ABORT:5,CLOSE:6,OPEN_PORT:7,ON:8};let HX=0;function PD(){return HX++}function WX(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function Fv(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function AD(t,e,r,i){if(e.type===Fo.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==Fo.INVOKE&&e.type!==Fo.RESPONSE)return void t.postMessage(e);let s;WX(r)?(s=gO(r.transferList),e.data=r.result):(s=gO(i),e.data=r),s?t.postMessage(e,s):t.postMessage(e)}function Rm(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function gO(t){if(!t?.length)return null;if(k("esri-workers-arraybuffer-transfer"))return t;const e=t.filter(r=>!ZX(r));return e.length?e:null}function ZX(t){return t instanceof ArrayBuffer||t?.constructor?.name==="ArrayBuffer"}async function QSe(t){try{return await t}catch(e){const r=e?.name===CD;if(!(nr(e)||r))throw e;return}}const{CLOSE:By,ABORT:RS,INVOKE:vO,RESPONSE:xp,OPEN_PORT:wO,ON:bO}=Fo,JX=2;let YX=class{constructor(e){this._invoke=e,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(e){e.type===RS?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}};var os;let kh=(os=class{static connect(e,r){const i=new MessageChannel;let s;s=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const n=new os(i.port1,{channel:i,client:s,schedule:r});return typeof s=="object"&&"remoteClient"in s&&(s.remoteClient=n),os.clients.set(n,s),i.port2}static loadWorker(e){const r=BX[e];return r?r():Promise.resolve(null)}constructor(e,r,i,s){this._port=e,this._jobQueue=i,this._lowPriorityJobQueue=s,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new YX(n=>this._onInvokeMessage(n)),this._client=r.client,this._onMessage=this._onMessage.bind(this),this._channel=r.channel,this._schedule=r.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:By}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,r,i){return this.apply(e,[r],i)}apply(e,r,i){const s=i?.signal,n=i?.transferList;if(!this._port)return Promise.reject(new x(CD,`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:r}));const o=PD();return new Promise((l,u)=>{if(Pr(s))return this._processWork(),void u(Fe());const d=ys(s,()=>{const f=this._outJobs.get(o);f&&(this._outJobs.delete(o),this._processWork(),He(f.abortHandle),this._post({type:RS,jobId:o}),u(Fe()))}),p={resolve:l,reject:u,abortHandle:d,debugInfo:e};this._outJobs.set(o,p),this._post({type:vO,jobId:o,methodName:e,abortable:s!=null},r,n)})}createInvokeProxy(e){return kD(this,e)}on(e,r){const i=new MessageChannel;function s(n){r(n.data)}return this._port.postMessage({type:bO,eventType:e,port:i.port2},[i.port2]),i.port1.addEventListener("message",s),i.port1.start(),Te(()=>{i.port1.postMessage({type:By}),i.port1.close(),i.port1.removeEventListener("message",s)})}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:wO,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=JX)return;const e=this._jobQueue?.pop()??this._lowPriorityJobQueue?.pop();if(!e)return;const{methodName:r,data:i,invokeOptions:s,resolver:n}=e;this.apply(r,i,s).then(o=>n.resolve(o)).catch(o=>n.reject(o))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{He(e.abortHandle),e.reject(Fe(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null,this._onMessage=null,this._channel=null,this._jobQueue=void 0,this._invokeQueue=void 0,this._lowPriorityJobQueue=void 0}_onMessage(e){this._schedule!=null?this._schedule(()=>this._processMessage(e,!0)):this._processMessage(e,!1)}_processMessage(e,r){const i=Rm(e);if(i)switch(i.type){case xp:this._onResponseMessage(i);break;case vO:r?this._onInvokeMessage(i):this._invokeQueue.push(i);break;case RS:this._onAbortMessage(i);break;case By:this._onCloseMessage();break;case wO:this._onOpenPortMessage(i);break;case bO:this._onOnMessage(i)}}_onAbortMessage(e){const r=this._inJobs,i=e.jobId,s=r.get(i);this._invokeQueue.push(e),s&&(s.controller&&s.controller.abort(),r.delete(i))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&os.clients.get(this)===e&&e.destroy(),os.clients.delete(this),e?.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:r,jobId:i,data:s=[],abortable:n}=e,o=n?new AbortController:null,l=this._inJobs;let u,d=this._client,p=d[r];try{if(!p&&r&&r.includes(".")){const f=r.split(".");for(let m=0;m<f.length-1;m++)d=d[f[m]],p=d[f[m+1]]}if(typeof p!="function")throw new TypeError(`${r} is not a function`);s.push({client:this,signal:o?o.signal:null}),u=p.apply(d,s)}catch(f){return void this._post({type:xp,jobId:i,error:Fv(f)})}Ar(u)?(l.set(i,{controller:o,promise:u}),u.then(f=>{l.has(i)&&(l.delete(i),this._post({type:xp,jobId:i},f))},f=>{l.has(i)&&(l.delete(i),nr(f)||this._post({type:xp,jobId:i,error:Fv(f||{message:`Error encountered at method ${r}`})}))})):this._post({type:xp,jobId:i},u)}_onOpenPortMessage(e){new os(e.port,{client:this._client})}_onOnMessage(e){const{port:r}=e,i=this._client.on(e.eventType,n=>{r.postMessage(n)}),s=qh(e.port,"message",n=>{Rm(n)?.type===By&&(s.remove(),i.remove(),r.close())})}_onResponseMessage(e){const{jobId:r,error:i,data:s}=e,n=this._outJobs;if(!n.has(r))return;const o=n.get(r);n.delete(r),this._processWork(),He(o.abortHandle),i?o.reject(x.fromJSON(JSON.parse(i))):o.resolve(s)}_post(e,r,i){return AD(this._port,e,r,i)}},os.kernelInfo={buildDate:bR,fullVersion:fT,revision:_R},os.clients=new Map,os),KX=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new Am,this._ongoingLowPriorityJobsQueue=new Am}destroy(){this.close()}get closed(){return!this._clients?.length}open(e,r){return new Promise((i,s)=>{let n=!0;const o=l=>{We(r.signal),n&&(n=!1,l())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let l=0;l<e.length;++l){const u=e[l];Ar(u)?this._clientPromises[l]=u.then(d=>(this._clients[l]=new kh(d,r,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),o(i),this._clients[l]),()=>(o(s),null)):(this._clients[l]=new kh(u,r,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),this._clientPromises[l]=Promise.resolve(this._clients[l]),o(i))}})}broadcast(e,r,i){const s=new Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n){const o=this._clientPromises[n];s[n]=o.then(l=>l?.invoke(e,r,i))}return s}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(Fe(`Worker closing, aborting job calling '${e.methodName}'`));for(;e=this._ongoingLowPriorityJobsQueue.pop();)e.resolver.reject(Fe(`Worker closing, aborting job calling '${e.methodName}'`));for(const r of this._clientPromises)r.then(i=>i?.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,qX(this)}invoke(e,r,i){return this.apply(e,[r],i)}apply(e,r,i){const s=bi();(i?.priority==="low"?this._ongoingLowPriorityJobsQueue:this._ongoingJobsQueue).push({methodName:e,data:r,invokeOptions:i,resolver:s});for(let n=0;n<this._clientPromises.length;n++){const o=this._clients[n];o?o.jobAdded():this._clientPromises[n].then(l=>l?.jobAdded())}return s.promise}createInvokeProxy(e){return kD(this,e)}on(e,r){return Promise.all(this._clientPromises).then(()=>qu(this._clients.map(i=>i.on(e,r))))}openPorts(){return new Promise(e=>{const r=new Array(this._clientPromises.length);let i=r.length;for(let s=0;s<this._clientPromises.length;++s)this._clientPromises[s].then(n=>{n&&(r[s]=n.openPort()),--i===0&&e(r)})})}get test(){}};const QX={async request(t,e){const r=t.options,i=r.responseType;r.signal=e?.signal,r.responseType=i==="native"||i==="native-request-init"?"native-request-init":i&&["blob","json","text"].includes(i)&&g_(t.url)?.after?i:"array-buffer";const s=await Ae(t.url,r),n={data:s.data,httpStatus:s.httpStatus,ssl:s.ssl};switch(s.requestOptions?.responseType){case"native-request-init":return delete n.data.signal,n;case"blob":n.data=await n.data.arrayBuffer();break;case"json":n.data=new TextEncoder().encode(JSON.stringify(n.data)).buffer;break;case"text":n.data=new TextEncoder().encode(n.data).buffer}return{result:n,transferList:[n.data]}}},_O={};function XX(t){const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages?.slice()||[],paths:{..._O.paths,...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=_O.baseUrl),e}let eee=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(r=>{this[r]=(...i)=>e[r](...i)})}},r0=class{constructor(){this._dispatcher=new eee,this._workerPostMessage({type:Fo.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){uv(()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))})}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,r,i){this._dispatcher.addEventListener(e,r,i)}removeEventListener(e,r,i){this._dispatcher.removeEventListener(e,r,i)}_workerPostMessage(e){uv(()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))})}async _workerMessageHandler(e){const r=Rm(e);if(r&&r.type===Fo.OPEN){const{modulePath:i,jobId:s}=r;let n=await kh.loadWorker(i);n||(n=await import(i));const o=kh.connect(n);this._workerPostMessage({type:Fo.OPENED,jobId:s,data:o})}}};const LS=()=>L.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:tee}=Fo,ree='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}).finally(()=>{t&&t.removeEventListener("abort",s)})}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://esriurl.com/using-local-assets.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(e=>e||new Promise(e=>{require([o.modulePath],e)})).then(t)}):"System"in self&&"function"==typeof System.import?System.import(workerPath).then(e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath))).then(e=>e||System.import(o.modulePath)).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(e=>e||import(o.modulePath)).then(t)}):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let Hy,Wy;const SO="Failed to create Worker. Fallback to execute module in main thread";async function iee(){if(!k("esri-workers"))return $O(new r0);if(!Hy&&!Wy)try{const e=ree.split("{CONFIGURATION}").join(see());Hy=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){Wy=e||{}}let t;if(Hy)try{t=new Worker(Hy,{name:"esri-worker-"+nee++})}catch{LS().warn(SO,Wy),t=new r0}else LS().warn(SO,Wy),t=new r0;return $O(t)}async function $O(t){return new Promise(e=>{function r(s){const n=Rm(s);n&&n.type===tee&&(t.removeEventListener("message",r),t.removeEventListener("error",i),e(t))}function i(s){s.preventDefault(),t.removeEventListener("message",r),t.removeEventListener("error",i),LS().warn("Failed to create Worker. Fallback to execute module in main thread",s),(t=new r0).addEventListener("message",r),t.addEventListener("error",i)}t.addEventListener("message",r),t.addEventListener("error",i)})}function see(){let t;if(_e.default!=null){const s={..._e};delete s.default,t=JSON.parse(JSON.stringify(s))}else t=JSON.parse(JSON.stringify(_e));t.assetsPath=ls(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?ls(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=vi(),t.has={"esri-csp-restrictions":k("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":k("esri-2d-update-debug"),"esri-2d-log-updating":k("esri-2d-log-updating"),"featurelayer-pbf":k("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":k("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":k("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":k("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":k("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":k("featurelayer-query-max-depth"),"featurelayer-query-tile-max-features":k("featurelayer-query-tile-max-features"),"featurelayer-query-tile-concurrency":k("featurelayer-query-tile-concurrency"),"featurelayer-query-pausing-enabled":k("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-concurrency":k("featurelayer-snapshot-concurrency"),"featurelayer-snapshot-enabled":k("featurelayer-snapshot-enabled"),"parquetlayer-full-query-feature-count":k("parquetlayer-full-query-feature-count"),"esri-atomics":k("esri-atomics"),"esri-shared-array-buffer":k("esri-shared-array-buffer"),"esri-tiles-debug":k("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":k("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":k("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=ls(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=ls(t.workers.workerPath):t.workers.workerPath=ls(ot("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=_e.workers.loaderConfig,r=XX({baseUrl:e?.baseUrl,locale:vi(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e?.has},map:{...e?.map},paths:{...e?.paths},packages:e?.packages||[]});return JSON.stringify({esriConfig:t,loaderConfig:r,kernelInfo:{buildDate:bR,fullVersion:fT,revision:_R}})}let nee=0;const{ABORT:xO,INVOKE:oee,OPEN:aee,OPENED:lee,RESPONSE:Tp}=Fo;let uee=class RD{static async create(e){const r=await iee();return new RD(r,e)}constructor(e,r){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=r,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",i=>{i.preventDefault(),L.getLogger("esri.core.workers.WorkerOwner").error(i)})}terminate(){this.worker.terminate()}async open(e,r={}){const{signal:i}=r,s=PD();return new Promise((n,o)=>{const l={resolve:n,reject:o,abortHandle:mT(i,()=>{this._outJobs.delete(s),this._post({type:xO,jobId:s})})};this._outJobs.set(s,l),this._post({type:aee,jobId:s,modulePath:e})})}_onMessage(e){const r=Rm(e);if(r)switch(r.type){case lee:this._onOpenedMessage(r);break;case Tp:this._onResponseMessage(r);break;case xO:this._onAbortMessage(r);break;case oee:this._onInvokeMessage(r)}}_onAbortMessage(e){const r=this._inJobs,i=e.jobId,s=r.get(i);s&&(s.controller&&s.controller.abort(),r.delete(i))}_onInvokeMessage(e){const{methodName:r,jobId:i,data:s,abortable:n}=e,o=n?new AbortController:null,l=this._inJobs,u=QX[r];let d;try{if(typeof u!="function")throw new TypeError(`${r} is not a function`);d=u.call(null,s,{signal:o?o.signal:null})}catch(p){return void this._post({type:Tp,jobId:i,error:Fv(p)})}Ar(d)?(l.set(i,{controller:o,promise:d}),d.then(p=>{l.has(i)&&(l.delete(i),this._post({type:Tp,jobId:i},p))},p=>{l.has(i)&&(l.delete(i),p||(p={message:"Error encountered at method"+r}),nr(p)||this._post({type:Tp,jobId:i,error:Fv(p||{message:`Error encountered at method ${r}`})}))})):this._post({type:Tp,jobId:i},d)}_onOpenedMessage(e){const{jobId:r,data:i}=e,s=this._outJobs.get(r);s&&(this._outJobs.delete(r),He(s.abortHandle),s.resolve(i))}_onResponseMessage(e){const{jobId:r,error:i,data:s}=e,n=this._outJobs.get(r);n&&(this._outJobs.delete(r),He(n.abortHandle),i?n.reject(x.fromJSON(JSON.parse(i))):n.resolve(s))}_post(e,r,i){return AD(this.worker,e,r,i)}};const TO=k("host-browser")?Math.min(navigator.hardwareConcurrency-1,k("workers-pool-size")??8):0;let su=k("esri-mobile")?Math.min(TO,3):TO;su||(su=k("safari")&&k("mac")?7:2);let MO=0;const i0=[];function cee(){LD()}async function Zy(t,e){const r=new KX,{registryTarget:i,...s}=e;return await r.open(t,s),i&&UX(i,r),r}async function dee(t,e={}){if(typeof t!="string")throw new x("workers:undefined-module","modulePath is missing");let r=e.strategy||"distributed";if(k("host-webworker")&&!k("esri-workers")&&(r="local"),r==="local"){let i=await kh.loadWorker(t);i||(i=await import(t)),We(e.signal);const s=e.client||i;return Zy([kh.connect(i,e.schedule)],{...e,client:s})}if(await LD(),We(e.signal),r==="dedicated"){const i=MO++%su;return Zy([await i0[i].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const i=Math.min(e.maxNumWorkers,su);if(i<su){const s=new Array(i);for(let n=0;n<i;++n){const o=MO++%su;s[n]=i0[o].open(t,e)}return Zy(s,e)}}return Zy(i0.map(i=>i.open(t,e)),e)}let Jy=null;async function LD(){if(Jy)return Jy;new AbortController;const t=[];for(let e=0;e<su;e++){const r=uee.create(e).then(i=>(i0[e]=i,i));t.push(r)}return Jy=Promise.all(t),Jy}let Zf=class extends H{constructor(e){super(e),this.addHandles([this.on("before-add",r=>{r.item==null&&r.preventDefault()}),this.on("after-add",r=>this._own(r.item)),this.on("after-remove",r=>this._release(r.item))])}get owner(){return this._get("owner")}set owner(e){this.destroyed||e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(H.ofType(this.itemType.Type))(e):new H(e)}};function FS(t,e){return{type:t,cast:EL,set(r){const i=Pn(r,this._get(e),t);i&&!i.destroyed&&(i.owner=this),this._set(e,i)}}}a([c()],Zf.prototype,"owner",null),Zf=a([b("esri.core.support.OwningCollection")],Zf);var NS,Gd;let pr=(Gd=class extends F{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new NS({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}},NS=Gd,Gd);a([c({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],pr.prototype,"cols",void 0),a([c({type:xe,json:{write:!0}})],pr.prototype,"level",void 0),a([c({type:String,json:{write:!0}})],pr.prototype,"levelValue",void 0),a([c({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],pr.prototype,"origin",void 0),a([c({type:Number,json:{write:!0}})],pr.prototype,"resolution",void 0),a([c({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],pr.prototype,"rows",void 0),a([c({type:Number,json:{write:!0}})],pr.prototype,"scale",void 0),pr=NS=a([b("esri.layers.support.LOD")],pr);let hee=class FD{constructor(e,r,i,s=yi()){this._level=e,this._row=r,this._col=i,this.extent=s}get id(){return this._id??=`${this.level}/${this.row}/${this.col}`,this._id}get level(){return this._level}set level(e){this._level=e,this._id=null}get row(){return this._row}set row(e){this._row=e,this._id=null}get col(){return this._col}set col(e){this._col=e,this._id=null}toJSON(){return{level:this._level,row:this._row,col:this._col,extent:this.extent}}static fromJSON(e){return new FD(e.level,e.row,e.col,e.extent)}};var Tc;const IO=new $e({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});var Bd;let Nr=(Bd=class extends F{static create(e={}){const{resolutionFactor:r=1,scales:i,size:s=256,spatialReference:n=Z.WebMercator,numLODs:o=24}=e;if(!Ni(n)){const m=[];if(i)for(let y=0;y<i.length;y++){const g=i[y];m.push(new pr({level:y,scale:g,resolution:g}))}else{let y=5e-4;for(let g=o-1;g>=0;g--)m.unshift(new pr({level:g,scale:y,resolution:y})),y*=2}return new Tc({dpi:96,lods:m,origin:new ee(0,0,n),size:[s,s],spatialReference:n})}const l=Kr(n),u=e.origin?new ee({x:e.origin.x,y:e.origin.y,spatialReference:n}):new ee(l?{x:l.origin[0],y:l.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),d=96,p=1/(Hi(n)*39.37*d),f=[];if(i)for(let m=0;m<i.length;m++){const y=i[m],g=y*p;f.push(new pr({level:m,scale:y,resolution:g}))}else{let m=Kh(n)?512/s*5916575275917094e-7:256/s*591657527591555e-6;const y=Math.ceil(o/r);f.push(new pr({level:0,scale:m,resolution:m*p}));for(let g=1;g<y;g++){const v=m/2**r,_=v*p;f.push(new pr({level:g,scale:v,resolution:_})),m=v}}return new Tc({dpi:d,lods:f,origin:u,size:[s,s],spatialReference:n})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:r}=this;if(e&&r){const i=Kr(e);return e.isWrappable&&!!i&&Math.abs(i.origin[0]-r.x)<=i.dx}return!1}readOrigin(e,r){return ee.fromJSON({spatialReference:r.spatialReference,...e})}set lods(e){let r=0,i=0;const s=[],n=this._levelToLOD={};e&&(r=-1/0,i=1/0,e.forEach(o=>{s.push(o.scale),r=o.scale>r?o.scale:r,i=o.scale<i?o.scale:i,n[o.level]=o})),this._set("scales",s),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,r){return[r.cols,r.rows]}writeSize(e,r){r.cols=e[0],r.rows=e[1]}zoomToScale(e){const r=this.scales;if(e<=0)return r[0];if(e>=r.length-1)return r[r.length-1];const i=Math.floor(e),s=i+1;return r[i]/(r[i]/r[s])**(e-i)}scaleToZoom(e){const r=this.scales,i=r.length-1;let s=0;for(;s<i;s++){const n=r[s],o=r[s+1];if(n<=e)return s;if(o===e)return s+1;if(n>e&&o<e)return s+Math.log(n/e)/Math.log(n/o)}return s}tileAt(e,r,i,s){const n=this.lodAt(e);if(!n)return null;let o,l;if(typeof r=="number")o=r,l=i;else if(Wt(r.spatialReference,this.spatialReference))o=r.x,l=r.y,s=i;else{const p=Ow(r,this.spatialReference);if(p==null)return null;o=p.x,l=p.y,s=i}const u=n.resolution*this.size[0],d=n.resolution*this.size[1];return s??=new hee(0,0,0),s.level=e,s.row=Math.floor((this.origin.y-l)/d+.001),s.col=Math.floor((o-this.origin.x)/u+.001),this.updateTileInfo(s),s}updateTileInfo(e,r=0){if(!("extent"in e))return!1;let i=this.lodAt(e.level);if(!i&&r===1){const l=this.lods[this.lods.length-1];l.level<e.level&&(i=l)}if(!i)return!1;const s=e.level-i.level,n=i.resolution*this.size[0]/2**s,o=i.resolution*this.size[1]/2**s;return e.extent[0]=this.origin.x+e.col*n,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+n,e.extent[3]=e.extent[1]+o,!0}upsampleTile(e){const r=this._upsampleLevels[e.level];return!(!r||r.parentLevel===-1)&&(e.level=r.parentLevel,e.row=Math.floor(e.row/r.factor+.001),e.col=Math.floor(e.col/r.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,r){const i=this.lodAt(r.level);if(i==null)return null;const{resolution:s}=i,n=s*this.size[0],o=s*this.size[1];return e[0]=this.origin.x+r.col*n,e[1]=this.origin.y-(r.row+1)*o,e[2]=e[0]+n,e[3]=e[1]+o,e}lodAt(e){return this._levelToLOD?.[e]??null}clone(){return Tc.fromJSON(this.write({}))}getCompatibleForVTL(e){if(this.size[0]!==this.size[1]||this.size[0]===256&&e===512)return null;const r=(this.size[0]===512&&e===256?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===e&&r===0)return this;const i=[],s=this.lods.length-r;for(let n=0;n<s;n++){const o=n+r,{scale:l,resolution:u}=o>=0?this.lods[o]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};i.push(new pr({level:n,scale:l,resolution:u}))}return new Tc({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let r=null;for(let i=0;i<e.length;i++){const s=e[i];this._upsampleLevels[s.level]={parentLevel:r?r.level:-1,factor:r?r.resolution/s.resolution:0},r=s}}},Tc=Bd,Bd);a([c({type:Number,json:{write:!0}})],Nr.prototype,"compressionQuality",void 0),a([c({type:Number,json:{write:!0}})],Nr.prototype,"dpi",void 0),a([c({type:String,json:{read:IO.read,write:IO.write,origins:{"web-scene":{read:!1,write:!1}}}})],Nr.prototype,"format",void 0),a([c({readOnly:!0})],Nr.prototype,"isWrappable",null),a([c({type:ee,json:{write:!0}})],Nr.prototype,"origin",void 0),a([V("origin")],Nr.prototype,"readOrigin",null),a([c({type:[pr],value:null,json:{write:!0}})],Nr.prototype,"lods",null),a([c({readOnly:!0})],Nr.prototype,"scales",void 0),a([c({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],Nr.prototype,"size",void 0),a([V("size",["rows","cols"])],Nr.prototype,"readSize",null),a([q("size",{cols:{type:xe},rows:{type:xe}})],Nr.prototype,"writeSize",null),a([c({type:Z,json:{write:!0}})],Nr.prototype,"spatialReference",void 0),Nr=Tc=a([b("esri.layers.support.TileInfo")],Nr);let Ch=class extends Zf{constructor(e){super(e),this.addHandles(this.on("before-add",r=>{r.item!=null&&r.item.parent===this.owner&&(L.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),r.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};Ch=a([b("esri.support.AnalysesCollection")],Ch);const s0={widthBreakpoint:{getValue(t){const e=t.viewSize[0],r=t.breakpoints,i=this.values;return e<=r.xsmall?i.xsmall:e<=r.small?i.small:e<=r.medium?i.medium:e<=r.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],r=t.breakpoints,i=this.values;return e<=r.xsmall?i.xsmall:e<=r.small?i.small:e<=r.medium?i.medium:e<=r.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,r=e[0],i=e[1],s=this.values;return i>=r?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},ub={xsmall:544,small:768,medium:992,large:1200};function pee(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function cb(t,e){return e?s0[t].valueToClassName[e].split(" "):[]}const fee=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=ub}initialize(){this.addHandles(ne(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),Ot))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i!==this._get("breakpoints")){if(!pee(i)){const s=JSON.stringify(ub,null,2);console.warn("provided breakpoints are not valid, using defaults:"+s),i=ub}this._set("breakpoints",{...i})}}_updateClassNames(){if(!this.container)return;const i=Br.acquire(),s=Br.acquire();let n,o=!1;for(n in s0){const l=this[n],u=s0[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});l!==u&&(o=!0,this[n]=u,cb(n,l).forEach(d=>s.push(d)),cb(n,u).forEach(d=>i.push(d)))}o&&(this._applyClassNameChanges(i,s),Br.release(i),Br.release(s))}_applyClassNameChanges(i,s){const n=this.container;n&&(s.forEach(o=>n.classList.remove(o)),i.forEach(o=>n.classList.add(o)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let s;for(s in s0)cb(s,this[s]).forEach(n=>i.classList.remove(n))}};return a([c()],r.prototype,"breakpoints",null),a([c()],r.prototype,"orientation",void 0),a([c()],r.prototype,"widthBreakpoint",void 0),a([c()],r.prototype,"heightBreakpoint",void 0),r=a([b("esri.views.BreakpointsOwner")],r),r};function TM(t){return typeof t=="string"?document.getElementById(t):t??null}function EO(t,e){for(;;){const r=t.firstChild;if(!r)break;e.appendChild(r)}}let yu=class extends X{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(e,r,i={}){return this._installWatch(e,r,i,ne)}addWhen(e,r,i={}){return this._installWatch(e,r,i,Gi)}addOnCollectionChange(e,r,{initial:i=!1,final:s=!1}={}){const n=++this._handleId;return this.addHandles([Fu(e,"after-changes",this._createSyncUpdatingCallback(),jn),Fu(e,"change",r,{onListenerAdd:i?o=>r({added:o.toArray(),removed:[]}):void 0,onListenerRemove:s?o=>r({added:[],removed:o.toArray()}):void 0})],n),Te(()=>this.removeHandles(n))}addPromise(e){if(e==null)return e;const r=++this._handleId;this.addHandles(Te(()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this.hasHandles(Yy)||this._set("updating",!1))}),r),this._pendingPromises.add(e),this._set("updating",!0);const i=()=>this.removeHandles(r);return e.then(i,i),e}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(e,r,i={},s){const n=++this._handleId;i.sync||this._installSyncUpdatingWatch(e,n);const o=s(e,r,i);return this.addHandles(o,n),Te(()=>this.removeHandles(n))}_installSyncUpdatingWatch(e,r){const i=this._createSyncUpdatingCallback(),s=ne(e,i,{sync:!0,equals:()=>!1});return this.addHandles(s,r),s}_createSyncUpdatingCallback(){return()=>{this.removeHandles(Yy),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(Wh(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(Yy))}),Yy)}}};a([c({readOnly:!0})],yu.prototype,"updating",void 0),yu=a([b("esri.core.support.UpdatingHandles")],yu);const Yy=-42;var Nv=function(){return Nv=Object.assign||function(e){for(var r,i=1,s=arguments.length;i<s;i++){r=arguments[i];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nv.apply(this,arguments)},DS={exports:{}},ht={},jS={exports:{}},Ju={};function ND(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function mee(t,e,r){}function yee(t,e,r){}var gee=/javascript\s*\:/img;function vee(t,e){return gee.test(e)?"":e}Ju.whiteList=ND();Ju.getDefaultWhiteList=ND;Ju.onAttr=mee;Ju.onIgnoreAttr=yee;Ju.safeAttrValue=vee;var wee={indexOf:function(t,e){var r,i;if(Array.prototype.indexOf)return t.indexOf(e);for(r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1},forEach:function(t,e,r){var i,s;if(Array.prototype.forEach)return t.forEach(e,r);for(i=0,s=t.length;i<s;i++)e.call(r,t[i],i,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},Mp=wee;function bee(t,e){t=Mp.trimRight(t),t[t.length-1]!==";"&&(t+=";");var r=t.length,i=!1,s=0,n=0,o="";function l(){if(!i){var p=Mp.trim(t.slice(s,n)),f=p.indexOf(":");if(f!==-1){var m=Mp.trim(p.slice(0,f)),y=Mp.trim(p.slice(f+1));if(m){var g=e(s,o.length,m,y,p);g&&(o+=g+"; ")}}}s=n+1}for(;n<r;n++){var u=t[n];if(u==="/"&&t[n+1]==="*"){var d=t.indexOf("*/",n+2);if(d===-1)break;n=d+1,s=n+1,i=!1}else u==="("?i=!0:u===")"?i=!1:u===";"?i||l():u===`
`&&l()}return Mp.trim(o)}var _ee=bee,Ky=Ju,See=_ee;function OO(t){return t==null}function $ee(t){var e={};for(var r in t)e[r]=t[r];return e}function DD(t){t=$ee(t||{}),t.whiteList=t.whiteList||Ky.whiteList,t.onAttr=t.onAttr||Ky.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||Ky.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||Ky.safeAttrValue,this.options=t}DD.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,r=e.options,i=r.whiteList,s=r.onAttr,n=r.onIgnoreAttr,o=r.safeAttrValue,l=See(t,function(u,d,p,f,m){var y=i[p],g=!1;if(y===!0?g=y:typeof y=="function"?g=y(f):y instanceof RegExp&&(g=y.test(f)),g!==!0&&(g=!1),f=o(p,f),!!f){var v={position:d,sourcePosition:u,source:m,isWhite:g};if(g){var _=s(p,f,v);return OO(_)?p+":"+f:_}else{var _=n(p,f,v);if(!OO(_))return _}}});return l};var xee=DD;(function(t,e){var r=Ju,i=xee;function s(o,l){var u=new i(l);return u.process(o)}e=t.exports=s,e.FilterCSS=i;for(var n in r)e[n]=r[n]})(jS,jS.exports);var MM=jS.exports,IM={indexOf:function(t,e){var r,i;if(Array.prototype.indexOf)return t.indexOf(e);for(r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1},forEach:function(t,e,r){var i,s;if(Array.prototype.forEach)return t.forEach(e,r);for(i=0,s=t.length;i<s;i++)e.call(r,t[i],i,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,r=e.exec(t);return r?r.index:-1}},Tee=MM.FilterCSS,Mee=MM.getDefaultWhiteList,Dv=IM;function jD(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var VD=new Tee;function Iee(t,e,r){}function Eee(t,e,r){}function Oee(t,e,r){}function kee(t,e,r){}function zD(t){return t.replace(Pee,"&lt;").replace(Aee,"&gt;")}function Cee(t,e,r,i){if(r=WD(r),e==="href"||e==="src"){if(r=Dv.trim(r),r==="#")return"#";if(!(r.substr(0,7)==="http://"||r.substr(0,8)==="https://"||r.substr(0,7)==="mailto:"||r.substr(0,4)==="tel:"||r.substr(0,11)==="data:image/"||r.substr(0,6)==="ftp://"||r.substr(0,2)==="./"||r.substr(0,3)==="../"||r[0]==="#"||r[0]==="/"))return""}else if(e==="background"){if(Qy.lastIndex=0,Qy.test(r))return""}else if(e==="style"){if(kO.lastIndex=0,kO.test(r)||(CO.lastIndex=0,CO.test(r)&&(Qy.lastIndex=0,Qy.test(r))))return"";i!==!1&&(i=i||VD,r=i.process(r))}return r=ZD(r),r}var Pee=/</g,Aee=/>/g,Ree=/"/g,Lee=/&quot;/g,Fee=/&#([a-zA-Z0-9]*);?/gim,Nee=/&colon;?/gim,Dee=/&newline;?/gim,Qy=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,kO=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,CO=/u\s*r\s*l\s*\(.*/gi;function UD(t){return t.replace(Ree,"&quot;")}function qD(t){return t.replace(Lee,'"')}function GD(t){return t.replace(Fee,function(r,i){return i[0]==="x"||i[0]==="X"?String.fromCharCode(parseInt(i.substr(1),16)):String.fromCharCode(parseInt(i,10))})}function BD(t){return t.replace(Nee,":").replace(Dee," ")}function HD(t){for(var e="",r=0,i=t.length;r<i;r++)e+=t.charCodeAt(r)<32?" ":t.charAt(r);return Dv.trim(e)}function WD(t){return t=qD(t),t=GD(t),t=BD(t),t=HD(t),t}function ZD(t){return t=UD(t),t=zD(t),t}function jee(){return""}function Vee(t,e){typeof e!="function"&&(e=function(){});var r=!Array.isArray(t);function i(o){return r?!0:Dv.indexOf(t,o)!==-1}var s=[],n=!1;return{onIgnoreTag:function(o,l,u){if(i(o))if(u.isClosing){var d="[/removed]",p=u.position+d.length;return s.push([n!==!1?n:u.position,p]),n=!1,d}else return n||(n=u.position),"[removed]";else return e(o,l,u)},remove:function(o){var l="",u=0;return Dv.forEach(s,function(d){l+=o.slice(u,d[0]),u=d[1]}),l+=o.slice(u),l}}}function zee(t){for(var e="",r=0;r<t.length;){var i=t.indexOf("<!--",r);if(i===-1){e+=t.slice(r);break}e+=t.slice(r,i);var s=t.indexOf("-->",i);if(s===-1)break;r=s+3}return e}function Uee(t){var e=t.split("");return e=e.filter(function(r){var i=r.charCodeAt(0);return i===127?!1:i<=31?i===10||i===13:!0}),e.join("")}ht.whiteList=jD();ht.getDefaultWhiteList=jD;ht.onTag=Iee;ht.onIgnoreTag=Eee;ht.onTagAttr=Oee;ht.onIgnoreTagAttr=kee;ht.safeAttrValue=Cee;ht.escapeHtml=zD;ht.escapeQuote=UD;ht.unescapeQuote=qD;ht.escapeHtmlEntities=GD;ht.escapeDangerHtml5Entities=BD;ht.clearNonPrintableCharacter=HD;ht.friendlyAttrValue=WD;ht.escapeAttrValue=ZD;ht.onIgnoreTagStripAll=jee;ht.StripTagBody=Vee;ht.stripCommentTag=zee;ht.stripBlankChar=Uee;ht.cssFilter=VD;ht.getDefaultCSSWhiteList=Mee;var Yw={},ba=IM;function qee(t){var e=ba.spaceIndex(t),r;return e===-1?r=t.slice(1,-1):r=t.slice(1,e+1),r=ba.trim(r).toLowerCase(),r.slice(0,1)==="/"&&(r=r.slice(1)),r.slice(-1)==="/"&&(r=r.slice(0,-1)),r}function Gee(t){return t.slice(0,2)==="</"}function Bee(t,e,r){var i="",s=0,n=!1,o=!1,l=0,u=t.length,d="",p="";e:for(l=0;l<u;l++){var f=t.charAt(l);if(n===!1){if(f==="<"){n=l;continue}}else if(o===!1){if(f==="<"){i+=r(t.slice(s,l)),n=l,s=l;continue}if(f===">"){i+=r(t.slice(s,n)),p=t.slice(n,l+1),d=qee(p),i+=e(n,i.length,d,p,Gee(p)),s=l+1,n=!1;continue}if(f==='"'||f==="'")for(var m=1,y=t.charAt(l-m);y.trim()===""||y==="=";){if(y==="="){o=f;continue e}y=t.charAt(l-++m)}}else if(f===o){o=!1;continue}}return s<t.length&&(i+=r(t.substr(s))),i}var Hee=/[^a-zA-Z0-9\\_:.-]/gim;function Wee(t,e){var r=0,i=0,s=[],n=!1,o=t.length;function l(m,y){if(m=ba.trim(m),m=m.replace(Hee,"").toLowerCase(),!(m.length<1)){var g=e(m,y||"");g&&s.push(g)}}for(var u=0;u<o;u++){var d=t.charAt(u),p,f;if(n===!1&&d==="="){n=t.slice(r,u),r=u+1,i=t.charAt(r)==='"'||t.charAt(r)==="'"?r:Jee(t,u+1);continue}if(n!==!1&&u===i){if(f=t.indexOf(d,u+1),f===-1)break;p=ba.trim(t.slice(i+1,f)),l(n,p),n=!1,u=f,r=u+1;continue}if(/\s|\n|\t/.test(d))if(t=t.replace(/\s|\n|\t/g," "),n===!1)if(f=Zee(t,u),f===-1){p=ba.trim(t.slice(r,u)),l(p),n=!1,r=u+1;continue}else{u=f-1;continue}else if(f=Yee(t,u-1),f===-1){p=ba.trim(t.slice(r,u)),p=PO(p),l(n,p),n=!1,r=u+1;continue}else continue}return r<t.length&&(n===!1?l(t.slice(r)):l(n,PO(ba.trim(t.slice(r))))),ba.trim(s.join(" "))}function Zee(t,e){for(;e<t.length;e++){var r=t[e];if(r!==" ")return r==="="?e:-1}}function Jee(t,e){for(;e<t.length;e++){var r=t[e];if(r!==" ")return r==="'"||r==='"'?e:-1}}function Yee(t,e){for(;e>0;e--){var r=t[e];if(r!==" ")return r==="="?e:-1}}function Kee(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function PO(t){return Kee(t)?t.substr(1,t.length-2):t}Yw.parseTag=Bee;Yw.parseAttr=Wee;var Qee=MM.FilterCSS,Vs=ht,JD=Yw,Xee=JD.parseTag,ete=JD.parseAttr,n0=IM;function Xy(t){return t==null}function tte(t){var e=n0.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=n0.trim(t.slice(e+1,-1));var r=t[t.length-1]==="/";return r&&(t=n0.trim(t.slice(0,-1))),{html:t,closing:r}}function rte(t){var e={};for(var r in t)e[r]=t[r];return e}function ite(t){var e={};for(var r in t)Array.isArray(t[r])?e[r.toLowerCase()]=t[r].map(function(i){return i.toLowerCase()}):e[r.toLowerCase()]=t[r];return e}function YD(t){t=rte(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=Vs.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=ite(t.whiteList||t.allowList):t.whiteList=Vs.whiteList,t.onTag=t.onTag||Vs.onTag,t.onTagAttr=t.onTagAttr||Vs.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||Vs.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||Vs.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||Vs.safeAttrValue,t.escapeHtml=t.escapeHtml||Vs.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new Qee(t.css))}YD.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,r=e.options,i=r.whiteList,s=r.onTag,n=r.onIgnoreTag,o=r.onTagAttr,l=r.onIgnoreTagAttr,u=r.safeAttrValue,d=r.escapeHtml,p=e.cssFilter;r.stripBlankChar&&(t=Vs.stripBlankChar(t)),r.allowCommentTag||(t=Vs.stripCommentTag(t));var f=!1;r.stripIgnoreTagBody&&(f=Vs.StripTagBody(r.stripIgnoreTagBody,n),n=f.onIgnoreTag);var m=Xee(t,function(y,g,v,_,S){var M={sourcePosition:y,position:g,isClosing:S,isWhite:Object.prototype.hasOwnProperty.call(i,v)},C=s(v,_,M);if(!Xy(C))return C;if(M.isWhite){if(M.isClosing)return"</"+v+">";var T=tte(_),O=i[v],P=ete(T.html,function(D,z){var B=n0.indexOf(O,D)!==-1,G=o(v,D,z,B);return Xy(G)?B?(z=u(v,D,z,p),z?D+'="'+z+'"':D):(G=l(v,D,z,B),Xy(G)?void 0:G):G});return _="<"+v,P&&(_+=" "+P),T.closing&&(_+=" /"),_+=">",_}else return C=n(v,_,M),Xy(C)?d(_):C},d);return f&&(m=f.remove(m)),m};var ste=YD;(function(t,e){var r=ht,i=Yw,s=ste;function n(l,u){var d=new s(u);return d.process(l)}e=t.exports=n,e.filterXSS=n,e.FilterXSS=s,(function(){for(var l in r)e[l]=r[l];for(var u in i)e[u]=i[u]})();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=t.exports)})(DS,DS.exports);var sc=DS.exports,nte=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},KD=(function(){function t(e,r){var i=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=Nv(Nv({},sc.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(n,o,l,u){return n==="a"&&o==="href"||(n==="img"||n==="source")&&o==="src"?i.sanitizeUrl(l):sc.safeAttrValue(n,o,l,u)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var s;e&&!r?s=e:e&&r?(s=Object.create(this.arcgisFilterOptions),s.css={whiteList:this.arcgisCSSWhiteList},Object.keys(e).forEach(function(n){if(n==="whiteList")s.whiteList=i._extendObjectOfArrays([i.arcgisWhiteList,e.whiteList||{}]);else if(n==="css"){var o=e.css.whiteList;o!=null&&e.css instanceof Object&&Object.keys(o).forEach(function(l){return s.css.whiteList[l]=o[l]})}else s[n]=e[n]})):(s=Object.create(this.arcgisFilterOptions),s.whiteList=this.arcgisWhiteList,s.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=s,this._xssFilter=new sc.FilterXSS(s)}return t.prototype.sanitize=function(e,r){switch(r===void 0&&(r={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,r);default:return r.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,r){var i=(r??{}).isProtocolRequired,s=i===void 0?!0:i,n=this._trim(e.substring(0,e.indexOf(":"))),o=e==="/",l=/^#/.test(e),u=n&&this.allowedProtocols.indexOf(n.toLowerCase())>-1;return o||l||u?sc.escapeAttrValue(e):!n&&!s?sc.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,r,i,s){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,r,i,s):sc.safeAttrValue(e,r,i,s)},t.prototype.validate=function(e,r){r===void 0&&(r={});var i=this.sanitize(e,r);return{isValid:e===i,sanitized:i}},t.prototype.encodeHTML=function(e){var r=this;return String(e).replace(/[&<>"'\/]/g,function(i){return r._entityMap[i]})},t.prototype.encodeAttrValue=function(e){var r=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(i,s){return r.test(i)?i:"&#x".concat(Number(e.charCodeAt(s)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var r={};return e.forEach(function(i){Object.keys(i).forEach(function(s){Array.isArray(i[s])&&Array.isArray(r[s])?r[s]=r[s].concat(i[s]):r[s]=i[s]})}),r},t.prototype._iterateOverObject=function(e,r){var i=this;r===void 0&&(r={});try{var s=!1,n=void 0;if(Array.isArray(e))n=e.reduce(function(l,u){var d=i.validate(u,r);return d.isValid?l.concat([u]):(s=!0,l.concat([d.sanitized]))},[]);else if(nte(e)){var o=Object.keys(e);n=o.reduce(function(l,u){var d=e[u],p=i.validate(d,r);return p.isValid?l[u]=d:(s=!0,l[u]=p.sanitized),l},{})}else return r.allowUndefined&&typeof e>"u"?void 0:null;return s?n:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t})();const ote=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],ate=ote.reduce((t,e)=>(t[e]=[],t),{}),lte=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],QD=new KD({whiteList:ate,onTagAttr:(t,e,r)=>{const i=`${e}="${r}"`;if(lte.includes(e))return i},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0),ute=new KD({whiteList:{br:[]},stripIgnoreTag:!0,escapeHtml:t=>t},!1),XD="http://www.w3.org/",Kw=`${XD}2000/svg`,e4=`${XD}1999/xlink`;let AO=[],EM=(t,e)=>{let r={};return Object.keys(t).forEach(i=>{r[i]=t[i]}),e&&Object.keys(e).forEach(i=>{r[i]=e[i]}),r},OM=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),t4=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},cte=(t,e,r)=>{if(e.vnodeSelector!==""){for(let i=r;i<t.length;i++)if(OM(t[i],e))return i}return-1},db=(t,e,r,i)=>{let s=t[e];if(s.vnodeSelector==="")return;let n=s.properties;if(!(n&&(n.key===void 0?n.bind:n.key))){for(let o=0;o<t.length;o++)if(o!==e){let l=t[o];if(OM(l,s))throw new Error(`${r.vnodeSelector} had a ${s.vnodeSelector} child ${i==="added"?i:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},dte=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},VS=[],zS=!1,r4=t=>{(t.children||[]).forEach(r4),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},RO=()=>{zS=!1,VS.forEach(r4),VS.length=0},LO=t=>{VS.push(t),zS||(zS=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(RO,{timeout:16}):setTimeout(RO,16))},FO=t=>{let e=t.domNode;if(t.properties){let r=t.properties.exitAnimation;if(r)return e.style.pointerEvents="none",void r(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),LO(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),LO(t))},hte=(t,e,r)=>{if(!e)return;let i=r.eventHandlerInterceptor,s=Object.keys(e),n=s.length;for(let o=0;o<n;o++){let l=s[o],u=e[l];if(l==="className")throw new Error('Property "className" is not supported, use "class".');if(l==="class")qS(t,u,!0);else if(l==="classes"){let d=Object.keys(u),p=d.length;for(let f=0;f<p;f++){let m=d[f];u[m]&&t.classList.add(m)}}else if(l==="styles"){let d=Object.keys(u),p=d.length;for(let f=0;f<p;f++){let m=d[f],y=u[m];y&&(t4(y),r.styleApplyer(t,m,y))}}else if(l!=="key"&&u!=null){let d=typeof u;d==="function"?(l.lastIndexOf("on",0)===0&&(i&&(u=i(l,u,t,e)),l==="oninput"&&(function(){let p=u;u=function(f){p.apply(this,[f]),f.target["oninput-value"]=f.target.value}})()),t[l]=u):r.namespace===Kw?l==="href"?t.setAttributeNS(e4,l,u):t.setAttribute(l,u):d==="string"&&l!=="value"?l==="innerHTML"?t[l]=QD.sanitize(u):US(t)&&l in t?t[l]=u:t.setAttribute(l,u):t[l]=u}}};function US(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let jv,pte=(t,e,r)=>{if(e)for(let i of e)Jf(i,t,void 0,r)},i4=(t,e,r)=>{pte(t,e.children,r),e.text&&(t.textContent=e.text),hte(t,e.properties,r),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,r,e.vnodeSelector,e.properties,e.children])},Jf=(t,e,r,i)=>{let s,n=0,o=t.vnodeSelector,l=e.ownerDocument;if(o==="")s=t.domNode=l.createTextNode(t.text),r!==void 0?e.insertBefore(s,r):e.appendChild(s);else{for(let u=0;u<=o.length;++u){let d=o.charAt(u);if(u===o.length||d==="."||d==="#"){let p=o.charAt(n-1),f=o.slice(n,u);p==="."?s.classList.add(f):p==="#"?s.id=f:(f==="svg"&&(i=EM(i,{namespace:Kw})),i.namespace!==void 0?s=t.domNode=l.createElementNS(i.namespace,f):(s=t.domNode=t.domNode||l.createElement(f),f==="input"&&t.properties&&t.properties.type!==void 0&&s.setAttribute("type",t.properties.type)),r!==void 0?e.insertBefore(s,r):s.parentNode!==e&&e.appendChild(s)),n=u+1}}i4(s,t,i)}},qS=(t,e,r)=>{e&&e.split(" ").forEach(i=>{i&&t.classList.toggle(i,r)})},fte=(t,e,r,i)=>{if(!r)return;let s=!1,n=Object.keys(r),o=n.length;for(let l=0;l<o;l++){let u=n[l],d=r[u],p=e[u];if(u==="class")p!==d&&(qS(t,p,!1),qS(t,d,!0));else if(u==="classes"){let f=t.classList,m=Object.keys(d),y=m.length;for(let g=0;g<y;g++){let v=m[g],_=!!d[v];_!==!!p[v]&&(s=!0,_?f.add(v):f.remove(v))}}else if(u==="styles"){let f=Object.keys(d),m=f.length;for(let y=0;y<m;y++){let g=f[y],v=d[g];v!==p[g]&&(s=!0,v?(t4(v),i.styleApplyer(t,g,v)):i.styleApplyer(t,g,""))}}else if(d||typeof p!="string"||(d=""),u!=="value"||US(t)){if(d!==p){let f=typeof d;f==="function"&&i.eventHandlerInterceptor||(i.namespace===Kw?u==="href"?t.setAttributeNS(e4,u,d):t.setAttribute(u,d):f==="string"?u==="innerHTML"?t[u]=QD.sanitize(d):u==="role"&&d===""?t.removeAttribute(u):US(t)&&u in t?t[u]=d:t.setAttribute(u,d):t[u]!==d&&(t[u]=d),s=!0)}}else{let f=t[u];f!==d&&(t["oninput-value"]?f===t["oninput-value"]:d!==p)&&(t[u]=d,t["oninput-value"]=void 0),d!==p&&(s=!0)}}return s},mte=(t,e,r,i,s)=>{if(r===i)return!1;i=i||AO;let n,o=(r=r||AO).length,l=i.length,u=0,d=0,p=!1;for(;d<l;){let f=u<o?r[u]:void 0,m=i[d];if(f!==void 0&&OM(f,m))p=jv(f,m,s)||p,u++;else{let y=cte(r,m,u+1);if(y>=0){for(n=u;n<y;n++)FO(r[n]),db(r,n,t,"removed");p=jv(r[y],m,s)||p,u=y+1}else Jf(m,e,u<o?r[u].domNode:void 0,s),dte(m),db(i,d,t,"added")}d++}if(o>u)for(n=u;n<o;n++)FO(r[n]),db(r,n,t,"removed");return p};jv=(t,e,r)=>{let i=t.domNode,s=!1;if(t===e)return!1;let n=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let o=i.ownerDocument.createTextNode(e.text);return i.parentNode.replaceChild(o,i),e.domNode=o,s=!0,s}e.domNode=i}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(r=EM(r,{namespace:Kw})),t.text!==e.text&&(n=!0,e.text===void 0?i.removeChild(i.firstChild):i.textContent=e.text),e.domNode=i,n=mte(e,i,t.children,e.children,r)||n,n=fte(i,t.properties,e.properties,r)||n,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[i,r,e.vnodeSelector,e.properties,e.children]);return n&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(i,e.properties,t.properties),s};let eg=(t,e)=>({getLastRender:()=>t,update:r=>{if(t.vnodeSelector!==r.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let i=t;t=r,jv(i,r,e)},domNode:t.domNode});const yte={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,r)=>{e.charAt(0)==="-"?t.style.setProperty(e,r):t.style[e]=r}};let Jp=t=>EM(yte,t),La={append:(t,e,r)=>(r=Jp(r),Jf(e,t,void 0,r),eg(e,r)),insertBefore:(t,e,r)=>(r=Jp(r),Jf(e,t.parentNode,t,r),eg(e,r)),merge:(t,e,r)=>(r=Jp(r),e.domNode=t,i4(t,e,r),eg(e,r)),replace:(t,e,r)=>(r=Jp(r),Jf(e,t.parentNode,t,r),t.parentNode.removeChild(t),eg(e,r))},s4,gte=(t,e)=>{let r=[];for(;t&&t!==e;)r.push(t),t=t.parentNode;return r};s4=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let vte=(t,e)=>{let r=t;return e.forEach(i=>{r=r&&r.children?s4(r.children,s=>s.domNode===i):void 0}),r},wte=(t,e,r)=>{let i=function(s){r("domEvent",s);let n=e(),o=gte(s.currentTarget,n.domNode);o.reverse();let l,u=vte(n.getLastRender(),o);return t.scheduleRender(),u&&(l=u.properties[`on${s.type}`].apply(u.properties.bind||this,arguments)),r("domEventProcessed",s),l};return(s,n,o,l)=>i},NO=t=>{let e,r,i=Jp(t),s=i.performanceLogger,n=!0,o=!1,l=[],u=[],d=(f,m,y)=>{let g,v=()=>g;i.eventHandlerInterceptor=wte(e,v,s),g=f(m,y(),i),l.push(g),u.push(y)},p=()=>{if(r=void 0,n){n=!1,s("renderStart",void 0);for(let f=0;f<l.length;f++){let m=u[f]();s("rendered",void 0),l[f].update(m),s("patched",void 0)}s("renderDone",void 0),n=!0}};return e={renderNow:p,scheduleRender:()=>{r||o||(r=requestAnimationFrame(p))},stop:()=>{r&&(cancelAnimationFrame(r),r=void 0),o=!0},resume:()=>{o=!1,n=!0,e.scheduleRender()},append:(f,m)=>{d(La.append,f,m)},insertBefore:(f,m)=>{d(La.insertBefore,f,m)},merge:(f,m)=>{d(La.merge,f,m)},replace:(f,m)=>{d(La.replace,f,m)},detach:f=>{for(let m=0;m<u.length;m++)if(u[m]===f)return u.splice(m,1),l.splice(m,1)[0];throw new Error("renderFunction was not found")}},e},oa=class extends X{constructor(){super(...arguments),this.items=new H,this._watchUpdatingTracking=new yu,this._callbacks=new Map,this._projector=NO(),this._hiddenProjector=NO()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,r=>{for(const i of r.added){const s=()=>i.render();this._callbacks.set(i,s),this._projector.append(this.surface,s)}for(const i of r.removed){const s=this._projector.detach(this._callbacks.get(i));this.surface.removeChild(s.domNode),this._callbacks.delete(i)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const r=this._hiddenSurface,i=this._hiddenProjector;let s;const n=()=>(s=e.render(),s);i.append(r,n),i.renderNow();const o={left:0,top:0,right:0,bottom:0};if(s?.domNode){const l=s.domNode.getBoundingClientRect();o.left=l.left,o.top=l.top,o.right=l.right,o.bottom=l.bottom}for(i.detach(n);r.firstChild;)r.removeChild(r.firstChild);return o}overlaps(e,r){const i=this.computeBoundingRect(e),s=this.computeBoundingRect(r);return Math.max(i.left,s.left)<=Math.min(i.right,s.right)&&Math.max(i.top,s.top)<=Math.min(i.bottom,s.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,r){const i=!!r?.disableDecorations;if(!this.items.some(n=>n.visible&&!(i&&n.isDecoration)))return;const s=e.getContext("2d");s.save(),s.font=this._fontString(),this.items.forEach(n=>{i&&n.isDecoration||(s.save(),n.renderCanvas(s),s.restore())}),s.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};a([c({readOnly:!0})],oa.prototype,"surface",void 0),a([c({readOnly:!0})],oa.prototype,"items",void 0),a([c({readOnly:!0})],oa.prototype,"needsRender",null),a([c({readOnly:!0})],oa.prototype,"_watchUpdatingTracking",void 0),a([c({readOnly:!0})],oa.prototype,"updating",null),oa=a([b("esri.views.overlay.ViewOverlay")],oa);const DO=oa,hb=[0,0];function bte(t){const e=(t.ownerDocument||window.document).defaultView,r=t.getBoundingClientRect();return hb[0]=r.left+(e?.pageXOffset??0),hb[1]=r.top+(e?.pageYOffset??0),hb}function jO(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function _te(t){const e=document.createElement("div");return t.appendChild(e),e}const nc=16,Ip=750,Ste=512,$te=2,xte=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this._freqInfo={freq:nc,time:Ip},this._overlayRenderTaskHandle=null,this.aria={},this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([ne(()=>this.cursor,s=>{const{surface:n}=this;n&&n.setAttribute("data-cursor",s)}),ne(()=>this.navigating,s=>{const{surface:n}=this;n&&n.setAttribute("data-navigating",s.toString())}),ne(()=>[this.aria,this.surface],()=>this._updateAria(),{initial:!0})])}initialize(){const i=this;this.addHandles([ne(()=>this.ui,(s,n)=>this._handleUIChange(s,n),Ot),i.on("focus",()=>this.notifyChange("focused")),i.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui?.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(i){const s=this._get("container"),n=TM(i);if(n||typeof i!="string"||L.getLogger(this).error("#container",`element with id '${i}' not found`),s===n)return;if(this._stopMeasuring(),s&&(s.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(jO(this.root),this._set("root",null)),this.userContent&&(EO(this.userContent,s),jO(this.userContent),this._set("userContent",null))),!n)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);n.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",EO(n,o),n.appendChild(o),this._set("userContent",o);const l=document.createElement("div");l.className="esri-view-root",n.insertBefore(l,n.firstChild),this._set("root",l);const u=document.createElement("div");u.className="esri-view-surface",u.setAttribute("role","application"),u.tabIndex=0,l.appendChild(u),this._set("surface",u);const d=new DO;l.appendChild(d.surface),this._set("overlay",d),this.addHandles(ne(()=>d.needsRender,p=>{p&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=bh({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=He(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",n),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}set ui(i){const s=this._get("ui");s!==i&&s?.destroy(),this._set("ui",i)}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(i,s,n){const o=this.position;return i-=o?o[0]:0,s-=o?o[1]:0,n?(n[0]=i,n[1]=s):n=[i,s],n}containerToPage(i,s,n){const o=this.position;return i+=o?o[0]:0,s+=o?o[1]:0,n?(n[0]=i,n[1]=s):n=[i,s],n}_updateAria(){const{surface:i,aria:s}=this;i&&(i.ariaLabelledByElements=s?.labelledByElements??null,i.ariaDescribedByElements=s?.describedByElements??null,i.ariaLabel=s?.label??null,i.ariaDescription=s?.description??null)}_handleUIChange(i,s){this.removeHandles("ui"),s&&s!==i&&s.destroy(),i&&(i.view=this,this.addHandles(ne(()=>this.root,n=>{i.container=n?_te(n):null},Ot),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=nc,i.time=Ip;const s=bh({prepare:l=>{const u=this._measure(),d=this._freqInfo;if(d.time+=l.deltaTime,u&&(d.freq=nc,this._get("resizing")||this._set("resizing",!0)),d.time<d.freq)return;d.time=0;const p=this._position();d.freq=p||u?nc:Math.min(Ip,d.freq*$te),!u&&d.freq>=Ste&&(s.pause(),this._get("resizing")&&this._set("resizing",!1))}}),n=new ResizeObserver(l=>{i.freq=nc,i.time=Ip,s.resume()});this.container!=null&&n.observe(this.container);const o=Te(()=>n.disconnect());this.addHandles([qh(window,"resize",()=>{i.freq=nc,i.time=Ip,s.resume()}),o,s],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,s=i?i.clientWidth:0,n=i?i.clientHeight:0;if(s===0||n===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,l=this.height;return s===o&&n===l?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",s),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:l,width:s,height:n}),!0)}_position(){const i=this.container,s=this.position,n=i&&bte(i);return!!n&&(!s||n[0]!==s[0]||n[1]!==s[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return a([c()],r.prototype,"aria",void 0),a([c()],r.prototype,"container",null),a([c({readOnly:!0})],r.prototype,"focused",null),a([c({readOnly:!0})],r.prototype,"height",void 0),a([c()],r.prototype,"messagesCommon",void 0),a([c({type:DO})],r.prototype,"overlay",void 0),a([c({readOnly:!0})],r.prototype,"position",void 0),a([c({readOnly:!0})],r.prototype,"resizing",void 0),a([c({readOnly:!0})],r.prototype,"root",void 0),a([c({value:null,readOnly:!0})],r.prototype,"size",null),a([c({readOnly:!0})],r.prototype,"surface",void 0),a([c({readOnly:!0})],r.prototype,"suspended",void 0),a([c({nonNullable:!0})],r.prototype,"ui",null),a([c({readOnly:!0})],r.prototype,"userContent",void 0),a([c({readOnly:!0})],r.prototype,"width",void 0),a([c()],r.prototype,"widthBreakpoint",void 0),r=a([b("esri.views.DOMContainer")],r),r},tg="popup",VO="manual";function GS(t){const{popupElement:e,popup:r}=t||{};return e??r??null}function Rn(t){return t!=null&&"open"in t&&"declaredClass"in t}function Uo(t){return!!t&&t.tagName.toLowerCase()==="arcgis-popup"&&"open"in t}function Tte(t,e,r){const[i,s,n]=e;if(r){const[o,l,u]=r;o&&Rn(l)&&(l.view=null,o.remove(l,tg),l!==s&&s&&l.destroy()),o&&u&&Uo(u)&&(u.view=null,o.remove(u,tg),u!==n&&n&&u.remove())}i&&Rn(s)&&(s.view=t,i.add(s,{key:tg,position:VO,internal:!0})),i&&n&&Uo(n)&&(n.view=t,i.add(n,{key:tg,position:VO,internal:!0}))}async function Mte(t,e){const{popup:r,popupElement:i}=t;Rn(r)?await rg(r,null,e):i&&Uo(i)?await rg(null,i,e):e?.defer(async()=>{await t.setupPopup();const{popup:s,popupElement:n}=t;Rn(s)&&!t.destroyed&&t.ready&&t.popupEnabled?await rg(s,null,e):n&&Uo(n)&&await rg(null,n,e)})}function Ite(t,e){const{popup:r,popupElement:i}=t;if(Rn(r))return r.open(e);i&&Uo(i)&&i.open(e)}function n4(t,e){Rn(t)&&t.close(),e&&Uo(e)&&(e.visible=!1)}async function rg(t,e,r){if(Rn(t)){const i=await t.viewModel.handleViewClick(r);return void(i?.promises?.length?t.open(i):t.visible&&t.close())}if(e&&Uo(e)){const i=await e.handleViewClick(r);i?.promises?.length?e.open(i):e.visible&&(e.visible=!1)}}const o4=k("mac")?"Meta":"Control",Ete=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),Ote=t=>Ete.has(t);let kte=class{constructor(e,r=[]){this.eventType=e,this.keyModifiers=r}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const r=e.modifiers;for(const i of this.keyModifiers)if(!r.has(i))return!1;return!0}},Zt=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const r=this._incoming[e];for(const i of r)this._incomingEventMatches.push(i.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback(r=>this._handleEvent(r)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,r,i){let s;typeof r=="function"?(i=r,s=[]):s=r||[];const n=typeof e=="string"?new kte(e,s):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},l=p=>{const f=this._incoming[p.match.eventType];if(f){const m=f.indexOf(p);f.splice(m,1),o(),this._manager&&this._manager.updateDependencies()}},u=new Cte(n,i,{onPause:l,onRemove:l,onResume:p=>{const f=this._incoming[p.match.eventType];f&&!f.includes(p)&&(f.push(p),o(),this._manager&&this._manager.updateDependencies())}});let d=this._incoming[n.eventType];return d||(d=[],this._incoming[n.eventType]=d),d.push(u),o(),this._manager&&this._manager.updateDependencies(),u}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const r=new Pte(e,{onEmit:(i,s,n,o)=>{this._manager?.emit(i.eventType,s,n,o)},onRemove:i=>{delete this._outgoing[i.eventType],this._manager?.updateDependencies()}});return this._outgoing[e]=r,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),r}startCapturingPointer(e){this._manager?.setPointerCapture(e,!0)}stopCapturingPointer(e){this._manager?.setPointerCapture(e,!1)}refreshHasPendingInputs(){this._manager?.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){const r=this._incoming[e.type];if(r){for(const i of r)if(i.match.matches(e)&&(i.callback?.(e),e.shouldStopPropagation()))break}}},Cte=class{constructor(e,r,i){this.match=e,this._callback=r,this._handler=i}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},Pte=class{constructor(e,r){this.eventType=e,this._removed=!1,this._handler=r}emit(e,r,i){this._removed||this._handler.onEmit(this,e,r,i)}remove(){this._removed=!0,this._handler.onRemove(this)}},Ate=class extends Zt{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this._id=null,this.registerIncoming("pointer-move",r=>this._update(r.data))}_update(e){const r=e.native.pointerType==="touch"?"touch":"mouse",{x:i,y:s,native:{pointerId:n}}=e;r===this._value&&this._x===i&&this._y===s&&this._id===n||(this._value=r,this._x=i,this._y=s,this._id=n,this._onChange(n,r,i,s))}},Rte=class{constructor(e,r){this._observable=new ty,this._value=e,this._equalityFunction=r}get value(){return le(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function Ph(t,e=XA){return new Rte(t,e)}let Lte=class extends Zt{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=Ph(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},Fte=class{constructor(e,r){this._owner=r,this._properties={},this._afterDispatchHandle=null;for(const i in e){const s=e[i],n=new QR(s,void 0,void 0,2,2);this._properties[i]={pool:n,acquired:[]}}this._afterDispatchHandle=Uq(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const r=this._properties[e];for(const i of r.acquired)kI(i)||r.pool.release(i);r.pool.destroy(),r.pool=null,r.acquired=null}this._properties=null,this._owner=null}get(e){const r=this._owner._get(e),i=this._properties[e];let s=i.pool.acquire();for(i.acquired.push(s);s===r;)s=i.pool.acquire(),i.acquired.push(s);return dL(),s}_release(){for(const e in this._properties){const r=this._properties[e];let i=0;for(const s of r.acquired)kI(s)?r.acquired[i++]=s:r.pool.release(s);r.acquired.length=i}}},Nte=class{constructor(){this.id=0,this.type="mouse",this.location=Bt()}},Ps=class extends X{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=o4,this._propertiesPool=new Fte({latestPointerInfo:()=>new Nte},this),this._latestPointerInfo=void 0,this._paused=!1,this._testTimestamp=void 0}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const r of e)this.uninstallHandlers(r);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get latestPointerInfo(){return this._latestPointerInfo}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,r,i=No.INTERNAL){if(this._nameToGroup[e]||r.length===0)return;const s={name:e,handlers:r.map(n=>({handler:n,active:!0,removed:!1,priorityIndex:0,groupPriority:i,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=s;for(let n=s.handlers.length-1;n>=0;n--){const o=s.handlers[n];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(l,u,d,p,f)=>{this._emitInputEvent(o.priorityIndex+1,l,u,d,f,p)},setPointerCapture:(l,u)=>{this._setPointerCapture(s,o,l,u)},setEventCallback:l=>{o.eventCallback=l},setUninstallCallback:l=>{o.uninstallCallback=l},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const r=this._nameToGroup[e];r?(r.handlers.forEach(i=>{i.removed=!0,i.uninstallCallback?.()}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):L.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,r=new Set;this._handlersPriority=[];for(let i=this._handlers.length-1;i>=0;i--){const s=this._handlers[i];s.priorityIndex=i,this._handlersPriority.push(s)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let i=this._handlersPriority.length-1;i>=0;i--){const s=this._handlersPriority[i];s.priorityIndex=i;let n=s.handler.hasSideEffects;if(!n){for(const o of s.handler.outgoingEventTypes)if(e.has(o)){n=!0;break}}if(n)for(const o of s.handler.incomingEventMatches){e.add(o.eventType);for(const l of o.keyModifiers)Ote(l)||r.add(l)}s.active=n}this._sourceEvents=e,this._keyModifiers=r,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,r,i,s){const n=this._latestPointerInfo;if(n==null||n.id!==e||n.type!==r||n.location.x!==i||n.location.y!==s){const o=this._propertiesPool.get("latestPointerInfo");o.id=e,o.type=r,o.location.x=i,o.location.y=s,this._latestPointerInfo=o}}_onEventReceived(e,r){if(e==="pointer-capture-lost"){const n=r;this._pointerCaptures.delete(n.native.pointerId)}this._updateKeyModifiers(e,r);const i=this._testTimestamp??r.native?.timestamp,s=r.native?.cancelable;this._emitInputEventFromSource(e,r,i,s)}_updateKeyModifiers(e,r){if(!r)return;let i=!1;const s=()=>{i||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),i=!0)},n=(l,u)=>{u&&!this._activeKeyModifiers.has(l)?(s(),this._activeKeyModifiers.add(l)):!u&&this._activeKeyModifiers.has(l)&&(s(),this._activeKeyModifiers.delete(l))};if(e==="key-down"||e==="key-up"){const l=r.key;this._keyModifiers.has(l)&&n(l,e==="key-down")}const o=r.native;n("Alt",!!o?.altKey),n("Control",!!o?.ctrlKey),n("Ctrl",!!o?.ctrlKey),n("Shift",!!o?.shiftKey),n("Meta",!!o?.metaKey),n("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new Ate((e,r,i,s)=>this._setLatestPointer(e,r,i,s)),this._multiTouchHandler=new Lte,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],No.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,No.INTERNAL)}_setPointerCapture(e,r,i,s){const n=e.name+"-"+r.priorityIndex,o=this._pointerCaptures.get(i.pointerId)||new Set;this._pointerCaptures.set(i.pointerId,o),s?(o.add(n),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(i,!0)):o.has(n)&&(o.delete(n),o.size===0&&(this._pointerCaptures.delete(i.pointerId),this.eventSource&&this.eventSource.setPointerCapture(i,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,r,i,s){this._emitInputEvent(0,e,r,i,s)}_emitInputEvent(e,r,i,s,n,o){const l=s??this._currentPropagation?.timestamp??performance.now(),u=n??!1,d={event:new Dte(r,i,l,o||this._activeKeyModifiers,u),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(d):this._doNewPropagation(d)}_doNewPropagation(e){this._currentPropagation={events:new Am,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:r,priorityIndex:i}=e.events.pop(),s=r.data?.eventId;if(!(s!=null&&this._stoppedPropagationEventIds.has(s)))for(e.currentHandler=this._handlersPriority[i];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!r.shouldStopPropagation()&&e.currentHandler.eventCallback?.(r),r.shouldStopPropagation()){s!=null&&this._stoppedPropagationEventIds.add(s);break}if(r.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:r,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const r=new Am;r.push(e);const i=this._currentPropagation;if(i){for(;i.events.length;)r.push(i.events.pop());i.events=r,i.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,r){if(e.handler.hasSideEffects!==r.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==r.groupPriority)return e.groupPriority>r.groupPriority?-1:1;for(const i of e.handler.incomingEventMatches)for(const s of r.handler.incomingEventMatches){if(i.eventType!==s.eventType)continue;const n=i.keyModifiers.filter(o=>s.keyModifiers.includes(o));if(n.length===i.keyModifiers.length!=(n.length===s.keyModifiers.length))return i.keyModifiers.length>s.keyModifiers.length?-1:1}return e.priorityIndex>r.priorityIndex?-1:1}_sortHandlersPriority(e){const r=[];for(const i of e){let s=0;for(;s<r.length&&this._compareHandlerPriority(i,r[s])>=0;)s++;r.splice(s,0,i)}return r}get test(){}};a([c({readOnly:!0})],Ps.prototype,"hasPendingInputs",null),a([c({constructOnly:!0})],Ps.prototype,"eventSource",void 0),a([c({constructOnly:!0})],Ps.prototype,"recognizers",void 0),a([c()],Ps.prototype,"multiTouchActive",null),a([c()],Ps.prototype,"_latestPointerInfo",void 0),a([c()],Ps.prototype,"latestPointerInfo",null),a([c()],Ps.prototype,"_paused",void 0),a([c({readOnly:!0})],Ps.prototype,"updating",null),Ps=a([b("esri.views.input.InputManager")],Ps);let Dte=class{constructor(e,r,i,s,n){this.type=e,this.data=r,this.timestamp=i,this.modifiers=s,this.cancelable=n,this._propagationState=0,this._resumeCallback=null}stopPropagation(){this._propagationState|=1}shouldStopPropagation(){return!!(1&this._propagationState)}defer(e){this._propagationState|=2;const r=(i,s)=>{this._propagationState&=-3;const n=this._resumeCallback;if(this._resumeCallback=null,n&&n(),s)throw i;return i};return(typeof e=="function"?e():e).then(i=>r(i,!1),i=>r(i,!0))}shouldPausePropagation(e){return!!(2&this._propagationState)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};const No={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3},jte=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([ne(()=>[this.ui,this.popup,this.popupElement],([i,s,n],o)=>{const[l,u,d]=o??[];Tte(this,[i,s,n],[l,u,d])},Tr),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&Mte(this,i)},No.WIDGET)]),Nw(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>N(()=>import("./Popup-Bd0TgebR.js").then(i=>i.P),__vite__mapDeps([167,168,169,170,171,172,22,173,174,175,73,71,72,4,31,34,176,177,178,89,179,180,181])))}destroy(){this.destroyed||this.closePopup()}async openPopup(i){if(Rn(this.popup))return this.popup.open(i);if(this.popupElement&&Uo(this.popupElement))this.popupElement.open(i).catch(()=>{});else try{if(await this.setupPopup(),!this.popup)return void L.getLogger(this).error(new x("view:null-popup","Popup is null and can't be opened"));Ite(this,i)}catch{}}closePopup(){this._popupSetupTask?.abort(),n4(this.popup,this.popupElement)}async fetchPopupFeatures(i,s){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(i,s),s)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!Rn(this.popup))return this._popupSetupTask=iy(async i=>{if(!this.popupEnabled||!Uo(this.popupElement))if(this.dependencies.popup&&typeof this.dependencies.popup=="function")await this.dependencies.popup(),We(i),customElements.get("arcgis-popup")||L.getLogger(this).error(new x("view:undefined-popup-element","`arcgis-popup` custom element is undefined and can't be opened")),this.popupElement=document.createElement("arcgis-popup");else{const{default:s}=await N(()=>import("./Popup-Bd0TgebR.js").then(o=>o.P),__vite__mapDeps([167,168,169,170,171,172,22,173,174,175,73,71,72,4,31,34,176,177,178,89,179,180,181]));if(We(i),!this.popup||Rn(this.popup))return;const n=this.popup;if("open"in n||"close"in n){const{open:o,close:l,...u}=n;this.popup=new s({...u})}else this.popup=new s(n)}}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:i,hits:s},n){const o=[],l=[];let u=!1;const d=y7(n,k("popup-view-fetch-timeout")??zte),p=y=>{const g=new Vte(y);return l.push(g),o.push(g.promise),g},f=y=>{const g=l.at(-1);return g&&g.layerView===y&&!u?g:p(y)};for(const y of s)"graphic"in y?(f(y.layerView).graphics.push(y.graphic),u=!1):(o.push(y.layerView.fetchPopupFeaturesAtLocation(y.mapPoint,d)),u=!0);l.forEach(y=>y.resolve(d));const m=m7(o).then(y=>y.filter(g=>!!g).flat());return{pendingFeatures:o,allGraphicsPromise:m,location:i}}async _getPopupHits(i,s){const{hits:n,location:o}=await this.popupHitTest(i);We(s);const l=[];for(const u of n)if("graphic"in u){if(this._isValidPopupGraphic(u.graphic,s)){const d=this._isValidPopupGraphicsLayerView(u.layerView)?u.layerView:void 0;l.push({graphic:u.graphic,layerView:d})}}else this._isValidPopupLocationLayerView(u.layerView)&&l.push({mapPoint:u.mapPoint,layerView:u.layerView});return{hits:l,location:o}}_isValidPopupGraphic(i,s){return i&&!!i.getEffectivePopupTemplate(s?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(i){return!i||(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesFromGraphics"in i}_isValidPopupLocationLayerView(i){return(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesAtLocation"in i}};return a([c()],r.prototype,"popup",void 0),a([c()],r.prototype,"popupElement",void 0),a([c()],r.prototype,"popupEnabled",void 0),r=a([b("esri.views.PopupView")],r),r};let Vte=class{constructor(e){this.layerView=e,this._resolver=bi(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:r,graphics:i,_resolver:s}=this;if(!r)return s.resolve(i),s.promise;let n;return r.fetchPopupFeaturesFromGraphics(i,e).catch(o=>(n=o,null)).then(o=>{o?s.resolve(o):s.reject(n)}),s.promise}};const zte=5e3;var Yp;const Vv=Ft()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),a4=Vv.jsonValues.slice();m_(a4,"orthometric");const Yf=Ft()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let Ur=Yp=class extends F{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,r){return Vv.write(t,e,r)}readHeightModel(t,e,r){return Vv.read(t)||(r?.messages&&r.messages.push(Ute(t,{context:r})),null)}readHeightUnit(t,e,r){return Yf.read(t)||(r?.messages&&r.messages.push(zO(t,{context:r})),null)}readHeightUnitService(t,e,r){return zT(t)||Yf.read(t)||(r?.messages&&r.messages.push(zO(t,{context:r})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new Yp({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const r=eF(e);return new Yp({heightModel:t.heightModel,heightUnit:r??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new Yp;return e.read(t,{origin:"web-scene"}),e}};function zO(t,e){return new qi("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function Ute(t,e){return new qi("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}a([c({type:Vv.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:a4,default:"ellipsoidal",write:{isRequired:!0}}}}})],Ur.prototype,"heightModel",void 0),a([q("web-scene","heightModel")],Ur.prototype,"writeHeightModel",null),a([V(["web-scene","service"],"heightModel")],Ur.prototype,"readHeightModel",null),a([c({type:Yf.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:Yf.jsonValues,write:{writer:Yf.write,isRequired:!0}}}}})],Ur.prototype,"heightUnit",void 0),a([V("web-scene","heightUnit")],Ur.prototype,"readHeightUnit",null),a([V("service","heightUnit")],Ur.prototype,"readHeightUnitService",null),a([c({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],Ur.prototype,"vertCRS",void 0),a([V("service","vertCRS",["vertCRS","ellipsoid","geoid"])],Ur.prototype,"readVertCRS",null),Ur=Yp=a([b("esri.geometry.HeightModelInfo")],Ur);let pb;async function qte(){return pb==null&&(pb=N(()=>import("./WhereClauseCache-BtPiDZmc.js"),__vite__mapDeps([41,42])).then(t=>new t.WhereClauseCache(500,500))),pb}async function l4(t,e){const r=await qte(),i=r.get(t,e);if(i==null)throw r.getError(t,e);return i}function Gte(t,e){return t||=null,e||=null,t==="1=1"?e??t:e==="1=1"?t??e:t&&e?`(${t}) AND (${e})`:t??e}function Bte(t,e){return t||=null,e||=null,t==="1=1"||e==="1=1"||t===e?t==="1=1"?t:e:t&&e?`(${t}) OR (${e})`:t??e}function w2e(t,e){return e.length===0?null:`${t} IN (${Hte(e)})`}function Hte(t){return t.map(e=>typeof e=="string"?Wte(e):e).join(",")}function Wte(t){return`'${t.replaceAll("'","''")}'`}function Zte(t){return typeof t=="number"}function b2e(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function _2e(t){return typeof t=="boolean"}function py(t){return typeof t=="string"||t instanceof String}function Jte(t){return t==null||py(t)}function S2e(t){return Array.isArray(t)}function $2e(t){return t?.declaredClass==="esri.Graphic"}function x2e(t){return t instanceof Date}const Yte="HH:mm",Kte="HH:mm:ss",Qte="HH:mm:ss.SSS",Xte=[Qte,Kte,Yte,"TT"],ere="yyyy-MM-dd";function UO(t){if(!t||!py(t))return null;const e=Y.fromFormat(t,ere);return e.isValid?e:null}function qO(t){return t&&py(t)?ev(Xte,e=>{const r=Y.fromFormat(t,e);return r.isValid?r:null})??null:null}function GO(t){if(!t||!py(t))return null;const e=Y.fromISO(t);return e.isValid?e:null}const u4=new Set(["integer","small-integer","long","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"]);function tre(t){return t!=null&&u4.has(t.type)}function c4(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function d4(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function h4(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}const rre=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);xT(u4,rre);function T2e(t,e){const r=t?.domain;if(!r||r.type!=="range")return;const i="range"in r?r.range[0]:r.minValue,s="range"in r?r.range[1]:r.maxValue,n=tre(t);return c4(t)||h4(t)||d4(t)?{...ire(t,s,i),isInteger:n}:{min:i!=null&&typeof i=="number"?i:null,max:s!=null&&typeof s=="number"?s:null,rawMin:i,rawMax:s,isInteger:n}}function ire(t,e,r){return c4(t)?{min:UO(r)?.toMillis(),max:UO(e)?.toMillis(),rawMin:r,rawMax:e}:h4(t)?{min:qO(r)?.toMillis(),max:qO(e)?.toMillis(),rawMin:r,rawMax:e}:d4(t)?{min:GO(r)?.toMillis(),max:GO(e)?.toMillis(),rawMin:r,rawMax:e}:{max:null,min:null}}function sre(t){if(!t)return;const e=t.match(nre);return e?.groups?e.groups.doubleQuoted??e.groups.singleQuoted??e.groups.dotNotation:void 0}const nre=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-z_][a-z0-9_]*))$/i;function ore(t){return t.match(are)?.[1]?.replaceAll("\\'","'")??null}const are=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let fb;function Nu(){return fb||(fb=(async()=>{const[t,e,r]=await Promise.all([N(()=>import("./arcadeUtils-CGghaEMA.js"),__vite__mapDeps([182,183,184,185,186,176,46,187,33,31,4,34,188,42,89,189,177,178,190])),N(()=>import("./batchExec-CKgRCHzU.js"),__vite__mapDeps([191,99])),N(()=>import("./aiServices-CfUg-pLE.js").then(i=>i.a),__vite__mapDeps([188,185,186,176,46,184]))]);return{arcade:t.arcade,arcadeUtils:t,batchExec:e,aiServices:r,Dictionary:t.Dictionary,Feature:t.arcadeFeature,Voxel:t.Voxel,Pixel:t.Pixel}})()),fb}const lre=/^([0-9_])/,ure=/[^a-z0-9_\u0080-\uffff]+/gi;function cre(t){return t==null?null:t.trim().replaceAll(ure,"_").replace(lre,"F$1")||null}const dre=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],hre=["field","normalizationField"];function BO(t,e){if(t!=null&&e!=null){for(const r of Array.isArray(t)?t:[t])if(HO(dre,r,e),"visualVariables"in r&&r.visualVariables)for(const i of r.visualVariables)HO(hre,i,e)}}function HO(t,e,r){if(t)for(const i of t){const s=Ym(i,e),n=s&&typeof s!="function"&&r.get(s);n&&Ht(i,n.name,e)}}function p4(t,e){if(t!=null&&e?.fields?.length)if("startField"in t){const r=e.get(t.startField),i=e.get(t.endField);t.startField=r?.name??null,t.endField=i?.name??null}else{const r=e.get(t.startTimeField),i=e.get(t.endTimeField);t.startTimeField=r?.name??null,t.endTimeField=i?.name??null}}const mb=new Set;function Qw(t,e){return t&&e?(mb.clear(),Du(mb,t,e),Array.from(mb).sort()):[]}function Du(t,e,r){if(r)if(e?.fields?.length)if(r.includes("*"))for(const{name:i}of e.fields)t.add(i);else for(const i of r)Rr(t,e,i);else{if(r.includes("*"))return t.clear(),void t.add("*");for(const i of r)i!=null&&t.add(i)}}function Rr(t,e,r){if(typeof r=="string")if(e){const i=e.get(r);i&&t.add(i.name)}else t.add(r)}function M2e(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(r=>r.name):e}function I2e(t,e,r=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const i=Qw(t,e);return i.length/t.fields.length>=r?["*"]:i}async function Fr(t,e,r,i){if(!i)return;const s=sre(i);if(s)Rr(t,e,s);else{const{arcadeUtils:n}=await Nu(),o=n.extractFieldNames(i,r?.partitions??e?.fields?.map(l=>l.name));for(const l of o)Rr(t,r?.index??e,l)}}async function kM(t,e,r){if(r&&r!=="1=1"){const i=await l4(r,e);if(!i.isStandardized)throw new x("fieldUtils:collectFilterFields","Where clause is not standardized",{where:r});Du(t,e,i.fieldNames)}}function pre({displayField:t,fields:e}){return t||(e?.length?fre(e):null)}function fre(t){return yb(t,"name-or-title")||yb(t,"unique-identifier")||yb(t,"type-or-category")||mre(t)}function mre(t){for(const e of t){if(!e?.name)continue;const r=e.name.toLowerCase();if(r.includes("name")||r.includes("title"))return e.name}return null}function yb(t,e){for(const r of t)if(r?.valueType&&r.valueType===e)return r.name;return null}async function E2e(t,e){if(!e)return;const r=e.elevationInfo?.featureExpressionInfo;return r?r.collectRequiredFields(t,e.fieldsIndex):void 0}function yre(t,e,r){r.onStatisticExpression?Fr(t,e,null,r.onStatisticExpression.expression):t.add(r.onStatisticField)}async function O2e(t,e,r){if(!e||!r||!("fields"in r))return;const i=[],s=r.popupTemplate;i.push(f4(t,e,s)),r.fields&&i.push(...r.fields.map(async n=>yre(t,e.fieldsIndex,n))),await Promise.all(i)}async function k2e(t,e){const{fieldsIndex:r,trackInfo:i}=e;if(!e||!i||!r)return;const s=[i.latestObservations.renderer?.collectRequiredFields(t,r),i.previousObservations.renderer?.collectRequiredFields(t,r),i.trackLines.renderer?.collectRequiredFields(t,r)];i.popupTemplate&&s.push(f4(t,e,i.popupTemplate));for(const n of[i.latestObservations.labelingInfo,i.previousObservations.labelingInfo,i.trackLines.labelingInfo])if(n)for(const o of n)s.push(v4(t,r,o));await Promise.all(s)}async function f4(t,e,r){const i=[];r?.expressionInfos&&i.push(...r.expressionInfos.map(n=>Fr(t,e.fieldsIndex,null,n.expression)));const s=r?.content;if(Array.isArray(s))for(const n of s)n.type==="expression"&&n.expressionInfo&&i.push(Fr(t,e.fieldsIndex,null,n.expressionInfo.expression));await Promise.all(i)}async function C2e(t,e,r){e&&(e.timeInfo&&r?.timeExtent&&Du(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&Du(t,e.fieldsIndex,[e.floorInfo.floorField]),r?.where!=null&&await kM(t,e.fieldsIndex,r.where))}async function P2e(t,e,r){e&&r&&await Promise.all(r.map(i=>gre(t,e,i)))}async function gre(t,e,r){e&&r&&(r.valueExpression?await Fr(t,e.fieldsIndex,null,r.valueExpression):r.field&&Rr(t,e.fieldsIndex,r.field))}function A2e(t){return t?Qw(t.fieldsIndex,m4(t)):[]}function vre(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?Qw(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}async function R2e(t,e,r){if(!e||!r)return;const i=e.fieldsIndex;await Promise.all(r.filters.map(s=>kM(t,i,s.where)))}const wre=new Set(["oid","global-id","guid"]),bre=new Set(["oid","global-id"]),_re=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/objectid/i,/^perimeter_/i,/_perimeter$/i,/_i$/i];function Sre(t){const e=new Set;y4(t).forEach(i=>e.add(i)),vre(t).forEach(i=>e.add(i.toLowerCase()));const r=t&&"infoFor3D"in t?t.infoFor3D:void 0;return r&&(Object.values(r.assetMapFieldRoles).forEach(i=>e.add(i.toLowerCase())),Object.values(r.transformFieldRoles).forEach(i=>e.add(i.toLowerCase()))),Array.from(e)}function m4(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:r,creatorField:i,editDateField:s,editorField:n}=e;return[r,i,s,n].filter(Boolean)}function y4(t){return m4(t).map(e=>e.toLowerCase())}function g4(t,e){return t.editable&&!wre.has(t.type)&&!y4(e).includes(t.name?.toLowerCase()??"")}function $re(t,e){const r=t.name?.toLowerCase()??"";return!(e?.objectIdField!=null&&r===e.objectIdField.toLowerCase()||e?.globalIdField!=null&&r===e.globalIdField.toLowerCase()||Sre(e).includes(r)||bre.has(t.type)||_re.some(i=>i.test(r)))}async function L2e(t,e){const{labelingInfo:r,fieldsIndex:i}=e;r?.length&&await Promise.all(r.map(s=>v4(t,i,s)))}async function v4(t,e,r){if(!r)return;const i=r.getLabelExpression(),s=r.where;if(i.type==="arcade")await Fr(t,e,null,i.expression);else{const n=i.expression.match(/{[^}]*}/g);n&&n.forEach(o=>{Rr(t,e,o.slice(1,-1))})}await kM(t,e,s)}function xre(t){const e=t.defaultValue;return e!==void 0&&b4(t,e)?e:t.nullable?null:void 0}function F2e(t){const e=typeof t=="string"?{type:t}:t;return S4(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function w4(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function Tre(t){return t===null||w4(t)}function Mre(t){return t===null||Number.isInteger(t)}function Ire(){return!0}function b4(t,e){let r;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":r=t.nullable?Mre:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":r=t.nullable?Tre:w4;break;case"string":case"esriFieldTypeString":r=t.nullable?Jte:py;break;default:r=Ire}return arguments.length===1?r:r(e)}const Ere=["integer","small-integer","big-integer","long"],Ore=["single","double"],kre=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"],Cre=["esriFieldTypeSingle","esriFieldTypeDouble"],_4=new Set([...Ere,...kre]),Pre=new Set([...Ore,...Cre]),Are=xT(_4,Pre);function Rre(t){return t!=null&&_4.has(t.type)}function CM(t){return t!=null&&Are.has(t.type)}function S4(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function $4(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function Lre(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function Fre(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function x4(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function WO(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function ZO(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function N2e(t,e){return Nre(t,e)===null}function D2e(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function Nre(t,e){return t==null||t.nullable&&e===null?null:b4(t,e)?CM(t)&&!Dre(t.type,Number(e))?"numeric-range-validation-error::out-of-range":null:"type-validation-error::invalid-type"}function Dre(t,e){const r=typeof t=="string"?T4(t):t;if(!r)return!1;const i=r.min,s=r.max;return r.isInteger?Number.isInteger(e)&&e>=i&&e<=s:e>=i&&e<=s}function T4(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return jre;case"esriFieldTypeInteger":case"esriFieldTypeLong":case"integer":case"long":return Vre;case"esriFieldTypeBigInteger":case"big-integer":return zre;case"esriFieldTypeSingle":case"single":return Ure;case"esriFieldTypeDouble":case"double":return qre}}const jre={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},Vre={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},zre={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},ig=(2-2**-23)*2**127,Ure={min:-ig,max:ig,isInteger:!1,rawMin:-ig,rawMax:ig},qre={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function j2e(t,e,r){switch(t){case"domain-validation-error::invalid-coded-value":return`Value ${r} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"domain-validation-error::value-out-of-range":return`Value ${r} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"type-validation-error::invalid-type":return`Value ${r} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case"numeric-range-validation-error::out-of-range":{const{min:i,max:s}=T4(e.type);return`Value ${r} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${i} to ${s}`}}}function Gre(t,e){return!Bre(t,e,null)}function Bre(t,e,r){if(!t?.attributes||!e)return!0;const i=new Set(Object.keys(t.attributes));let s=!1;for(const n of e)if(!i.has(n)&&(s=!0,r==null))break;return s}function Hre(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}function PM(t){const e=t?.match(/{[^}]+}/g);return e?e.map(r=>r.slice(1,-1).split(":")[0].trim()):[]}let o0=class extends F{constructor(e){super(e),this.type=null}};a([c({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],o0.prototype,"type",void 0),o0=a([b("esri.popup.content.Content")],o0);const Go=o0,sg=new $e({asc:"ascending",desc:"descending"});let Kp=class extends pe(F){constructor(e){super(e),this.field=null,this.order="ascending"}};a([c({type:String,json:{write:!0}})],Kp.prototype,"field",void 0),a([c({type:sg.apiValues,json:{type:sg.jsonValues,read:sg.read,write:sg.write}})],Kp.prototype,"order",void 0),Kp=a([b("esri.popup.support.AttachmentsOrderByInfo")],Kp);const Wre=Kp;let cn=class extends pe(Go){constructor(e){super(e),this.attachmentKeywords=null,this.attachmentTypes=null,this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};a([c({type:[String],json:{write:!0}})],cn.prototype,"attachmentKeywords",void 0),a([c({type:[["application","audio","image","model","text","video"]],json:{write:!0}})],cn.prototype,"attachmentTypes",void 0),a([c({type:String,json:{write:!0}})],cn.prototype,"description",void 0),a([c({type:["auto","preview","list"],json:{write:!0}})],cn.prototype,"displayType",void 0),a([c({type:[Wre],json:{write:!0}})],cn.prototype,"orderByFields",void 0),a([c({type:String,json:{write:!0}})],cn.prototype,"title",void 0),a([c({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],cn.prototype,"type",void 0),cn=a([b("esri.popup.content.AttachmentsContent")],cn);const Ah=cn;var BS;let Ol=BS=class extends Go{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new BS({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?E(this.outFields):null})}};a([c()],Ol.prototype,"creator",void 0),a([c()],Ol.prototype,"destroyer",void 0),a([c()],Ol.prototype,"outFields",void 0),a([c({type:["custom"],readOnly:!0})],Ol.prototype,"type",void 0),Ol=BS=a([b("esri.popup.content.CustomContent")],Ol);const Zre=Ol;var HS;let Mc=HS=class extends F{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new HS({title:this.title,expression:this.expression})}};a([c({type:String,json:{write:!0}})],Mc.prototype,"title",void 0),a([c({type:String,json:{write:!0}})],Mc.prototype,"expression",void 0),a([c({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],Mc.prototype,"returnType",void 0),Mc=HS=a([b("esri.popup.ElementExpressionInfo")],Mc);const Jre=Mc;var WS;let Qp=WS=class extends Go{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new WS({expressionInfo:this.expressionInfo?.clone()})}};a([c({type:Jre,json:{write:!0}})],Qp.prototype,"expressionInfo",void 0),a([c({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],Qp.prototype,"type",void 0),Qp=WS=a([b("esri.popup.content.ExpressionContent")],Qp);const Xw=Qp;let a0=class extends pe(F){constructor(e){super(e),this.type=null}};a([c({type:["date-time","number"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],a0.prototype,"type",void 0),a0=a([b("esri.layers.support.FieldFormat")],a0);const AM=a0,M4="auto";let eo=class extends AM{constructor(e){super(e),this.dateStyle=null,this.hour12=M4,this.month=null,this.timeStyle=null,this.type="date-time",this.year=null}};a([c({type:["full","long","medium","short"],json:{write:!0}})],eo.prototype,"dateStyle",void 0),a([c({type:["always","auto","never"],nonNullable:!0,json:{default:M4,write:!0}})],eo.prototype,"hour12",void 0),a([c({type:["long","short"],json:{write:!0}})],eo.prototype,"month",void 0),a([c({type:["full","long","medium","short"],json:{write:!0}})],eo.prototype,"timeStyle",void 0),a([c({type:["date-time"]})],eo.prototype,"type",void 0),a([c({type:["numeric"],json:{write:!0}})],eo.prototype,"year",void 0),eo=a([b("esri.layers.support.DateTimeFieldFormat")],eo);const gu=eo,JO={min:0,max:20},I4=2,E4=0,O4="decimal",k4="auto";let aa=class extends AM{constructor(e){super(e),this.maximumFractionDigits=I4,this.minimumFractionDigits=E4,this.style=O4,this.type="number",this.useGrouping=k4}};a([c({type:xe,nonNullable:!0,range:JO,json:{default:I4,write:!0}})],aa.prototype,"maximumFractionDigits",void 0),a([c({type:xe,nonNullable:!0,range:JO,json:{default:E4,write:!0}})],aa.prototype,"minimumFractionDigits",void 0),a([c({type:["decimal"],nonNullable:!0,json:{default:O4,write:!0}})],aa.prototype,"style",void 0),a([c({type:["number"]})],aa.prototype,"type",void 0),a([c({type:["always","auto","never"],nonNullable:!0,json:{default:k4,write:!0}})],aa.prototype,"useGrouping",void 0),aa=a([b("esri.layers.support.NumberFieldFormat")],aa);const zv=aa;let Ic=class extends pe(F){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};a([se(RZ)],Ic.prototype,"dateFormat",void 0),a([c({type:Boolean,json:{write:!0}})],Ic.prototype,"digitSeparator",void 0),a([c({type:xe,json:{write:!0}})],Ic.prototype,"places",void 0),Ic=a([b("esri.popup.support.FieldInfoFormat")],Ic);const Do=Ic,C4={base:AM,key:"type",errorContext:"field-configuration-field-format",typeMap:{"date-time":gu,number:zv}};function Yre(t,e){const{format:r}=t;return e&&Yu(e)?r?P4(r,e):Kf(e,{hour12:"always",useGrouping:"always"}):null}function P4(t,e){const{dateFormat:r}=t;if(!e)return r?KO(t):YO(t);if(!Yu(e))return;const i={hour12:"always"};switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return A4(t);case"single":case"double":return YO(t);case"date":case"timestamp-offset":return r?KO(t):Kf(e,i);case"date-only":return r?Kre(t):Kf(e);case"time-only":return r?Qre(t):Kf(e,i)}}function Yu(t){return CM(t)||$4(t)||Lre(t)||x4(t)||Fre(t)}function A4(t){return new zv({useGrouping:t.digitSeparator?"always":"never"})}function YO(t){const e=A4(t),{places:r}=t;return e.minimumFractionDigits=r??0,e.maximumFractionDigits=r??2,e}function KO(t){return new gu({dateStyle:R4(t),year:D4(t),month:F4(t),timeStyle:N4(t),hour12:L4(t)})}function Kre(t){return new gu({dateStyle:R4(t),year:D4(t),month:F4(t)})}function Qre(t){return new gu({timeStyle:N4(t),hour12:L4(t)})}function R4(t){const{dateFormat:e}=t;return e?e.startsWith("short-date")?"short":e.startsWith("day-short-month-year")?"medium":e.startsWith("long-month-day-year")?"long":e.startsWith("long-date")?"full":null:null}function L4(t){return t.dateFormat?.endsWith("-24")?"never":"always"}function F4(t){switch(t.dateFormat){case"short-month-year":return"short";case"long-month-year":return"long";default:return null}}function N4(t){const{dateFormat:e}=t;return e?e.includes("short-time")?"short":e.includes("long-time")?"medium":null:null}function D4(t){switch(t.dateFormat){case"short-month-year":case"long-month-year":case"year":return"numeric";default:return null}}function RM(t,e){const r=t.type==="number",i=t.type==="date-time";if(!e)return r?QO(t):i?XO(t):null;if(Yu(e))switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return r?j4(t):null;case"single":case"double":return r?QO(t):null;case"date":case"timestamp-offset":return i?XO(t):null;case"date-only":return i?Xre(t):null;case"time-only":return i?eie(t):null}}function j4(t){return new Do({digitSeparator:t.useGrouping!=="never"})}function QO(t){const e=j4(t);return e.places=t.maximumFractionDigits,e}function XO(t){let e;const r=V4(t),i=z4(t),s=t.hour12==="never"?"24":null,n=t.year==="numeric"?"year":null,o=U4(t);return r&&i&&s?e=`${r}-${i}-${s}`:r&&i?e=`${r}-${i}`:r?e=r:n&&o?e=`${o}-${n}`:n&&(e=n),e?new Do({dateFormat:e}):null}function Xre(t){let e;const r=V4(t),i=t.year==="numeric"?"year":null,s=U4(t);return r?e=r:i&&s?e=`${s}-${i}`:i&&(e=i),e?new Do({dateFormat:e}):null}function eie(t){let e;const r=z4(t),i=t.hour12==="never"?"24":null;return r&&i?e=`short-date-${r}-${i}`:r&&(e=`short-date-${r}`),e?new Do({dateFormat:e}):null}function V4(t){switch(t.dateStyle){case"short":return"short-date";case"medium":return"day-short-month-year";case"long":return"long-month-day-year";case"full":return"long-date";default:return}}function z4(t){return t.timeStyle&&(t.timeStyle==="short"?"short-time":"long-time")}function U4(t){switch(t.month){case"short":return"short-month";case"long":return"long-month";default:return}}function Kf(t,e){if(!Yu(t))return;const r=e?.useGrouping??"auto",i=e?.hour12??"auto";switch(t.type){case"integer":case"small-integer":case"big-integer":case"long":return new zv({minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:r});case"single":case"double":return new zv({minimumFractionDigits:0,maximumFractionDigits:2,useGrouping:r});case"date":case"timestamp-offset":return new gu({dateStyle:"short",timeStyle:"short",hour12:i});case"date-only":return new gu({dateStyle:"short"});case"time-only":return new gu({timeStyle:"short",hour12:i})}}let Ti=class extends pe(F){constructor(e){super(e),this.fieldName=null,this.isEditable=!0,this.label=null,this.statisticType=null,this.stringFieldOption="text-box",this.tooltip=null,this.visible=!0}set fieldFormat(e){this._set("fieldFormat",e),this._set("format",e?RM(e):null)}set format(e){this._set("format",e),this._set("fieldFormat",e?P4(e):null)}readFormat(e,r){if(!r.fieldFormat)return e?Do.fromJSON(e):null}clone(){const e=super.clone();return e._set("format",this.format?.clone()),e._set("fieldFormat",this.fieldFormat?.clone()),e}};a([c({value:null,clonable:!1,types:C4,json:{write:{overridePolicy(t,e,r){const{fieldName:i}=this;return{enabled:!!i&&!i.startsWith("expression/")&&!i.startsWith("relationships/")&&!!r?.writeFieldFormat}}}}})],Ti.prototype,"fieldFormat",null),a([c({type:String,json:{write:!0}})],Ti.prototype,"fieldName",void 0),a([c({value:null,clonable:!1,type:Do,json:{write:!0}})],Ti.prototype,"format",null),a([V("format")],Ti.prototype,"readFormat",null),a([c({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],Ti.prototype,"isEditable",void 0),a([c({type:String,json:{write:!0}})],Ti.prototype,"label",void 0),a([c({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],Ti.prototype,"statisticType",void 0),a([se(new $e({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],Ti.prototype,"stringFieldOption",void 0),a([c({type:String,json:{write:!0}})],Ti.prototype,"tooltip",void 0),a([c({type:Boolean,json:{write:!0}})],Ti.prototype,"visible",void 0),Ti=a([b("esri.popup.FieldInfo")],Ti);const e1=Ti;var ZS;let la=ZS=class extends Go{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}clone(){return new ZS(E({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};a([c({type:Object,json:{write:!0}})],la.prototype,"attributes",void 0),a([c({type:String,json:{write:!0}})],la.prototype,"description",void 0),a([c({type:[e1],json:{write:!0}})],la.prototype,"fieldInfos",void 0),a([c({type:String,json:{write:!0}})],la.prototype,"title",void 0),a([c({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],la.prototype,"type",void 0),la=ZS=a([b("esri.popup.content.FieldsContent")],la);const Rh=la;let kl=class extends F{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};a([c({type:String,json:{write:!0}})],kl.prototype,"altText",void 0),a([c({type:String,json:{write:!0}})],kl.prototype,"caption",void 0),a([c({type:String,json:{write:!0}})],kl.prototype,"title",void 0),a([c({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],kl.prototype,"type",void 0),kl=a([b("esri.popup.content.mixins.MediaInfo")],kl);const LM=kl;var JS;let Cl=JS=class extends X{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new JS({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};a([c()],Cl.prototype,"color",void 0),a([c()],Cl.prototype,"fieldName",void 0),a([c()],Cl.prototype,"tooltip",void 0),a([c()],Cl.prototype,"value",void 0),Cl=JS=a([b("esri.popup.content.support.ChartMediaInfoValueSeries")],Cl);const tie=Cl;var YS;let ua=YS=class extends F{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new YS({colors:E(this.colors),fields:E(this.fields),normalizeField:this.normalizeField,series:E(this.series),tooltipField:this.tooltipField})}};a([c({type:[ue],json:{type:[[xe]],write:!0}})],ua.prototype,"colors",void 0),a([c({type:[String],json:{write:{isRequired:!0}}})],ua.prototype,"fields",void 0),a([c({type:String,json:{write:!0}})],ua.prototype,"normalizeField",void 0),a([c({type:[tie],json:{read:!1}})],ua.prototype,"series",void 0),a([c({type:String,json:{write:!0}})],ua.prototype,"tooltipField",void 0),ua=YS=a([b("esri.popup.content.support.ChartMediaInfoValue")],ua);const rie=ua;let Xp=class extends LM{constructor(e){super(e),this.type=null,this.value=void 0}};a([c({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Xp.prototype,"type",void 0),a([c({type:rie,json:{write:{isRequired:!0}}})],Xp.prototype,"value",void 0),Xp=a([b("esri.popup.content.mixins.ChartMediaInfo")],Xp);const t1=Xp,r1=Ft()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var KS;let l0=KS=class extends t1{constructor(t){super(t),this.type="bar-chart"}clone(){return new KS({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};a([c({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:r1.write,isRequired:!0}}})],l0.prototype,"type",void 0),l0=KS=a([b("esri.popup.content.BarChartMediaInfo")],l0);const q4=l0;var QS;let u0=QS=class extends t1{constructor(t){super(t),this.type="column-chart"}clone(){return new QS({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};a([c({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:r1.write,isRequired:!0}}})],u0.prototype,"type",void 0),u0=QS=a([b("esri.popup.content.ColumnChartMediaInfo")],u0);const G4=u0;var XS;let ef=XS=class extends F{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new XS({linkURL:this.linkURL,sourceURL:this.sourceURL})}};a([c({type:String,json:{write:!0}})],ef.prototype,"linkURL",void 0),a([c({type:String,json:{write:{isRequired:!0}}})],ef.prototype,"sourceURL",void 0),ef=XS=a([b("esri.popup.content.support.ImageMediaInfoValue")],ef);const iie=ef;var e2;let Ec=e2=class extends LM{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new e2({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};a([c({type:Number,json:{write:!0}})],Ec.prototype,"refreshInterval",void 0),a([c({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Ec.prototype,"type",void 0),a([c({type:iie,json:{write:{isRequired:!0}}})],Ec.prototype,"value",void 0),Ec=e2=a([b("esri.popup.content.ImageMediaInfo")],Ec);const B4=Ec;var t2;let c0=t2=class extends t1{constructor(t){super(t),this.type="line-chart"}clone(){return new t2({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};a([c({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:r1.write,isRequired:!0}}})],c0.prototype,"type",void 0),c0=t2=a([b("esri.popup.content.LineChartMediaInfo")],c0);const H4=c0;var r2;let d0=r2=class extends t1{constructor(t){super(t),this.type="pie-chart"}clone(){return new r2({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};a([c({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:r1.write,isRequired:!0}}})],d0.prototype,"type",void 0),d0=r2=a([b("esri.popup.content.PieChartMediaInfo")],d0);const W4=d0,i2={base:LM,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":q4,"column-chart":G4,"line-chart":H4,"pie-chart":W4,image:B4}};var s2;let As=s2=class extends Go{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?B4.fromJSON(e):e.type==="barchart"?q4.fromJSON(e):e.type==="columnchart"?G4.fromJSON(e):e.type==="linechart"?H4.fromJSON(e):e.type==="piechart"?W4.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(r=>r.toJSON())}clone(){return new s2(E({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};a([c()],As.prototype,"activeMediaInfoIndex",void 0),a([c({type:Object,json:{write:!0}})],As.prototype,"attributes",void 0),a([c({type:String,json:{write:!0}})],As.prototype,"description",void 0),a([c({types:[i2]})],As.prototype,"mediaInfos",void 0),a([V("mediaInfos")],As.prototype,"readMediaInfos",null),a([q("mediaInfos")],As.prototype,"writeMediaInfos",null),a([c({type:String,json:{write:!0}})],As.prototype,"title",void 0),a([c({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],As.prototype,"type",void 0),As=s2=a([b("esri.popup.content.MediaContent")],As);const Lm=As;var n2;let tf=n2=class extends F{constructor(t){super(t),this.field=null,this.order=null}clone(){return new n2({field:this.field,order:this.order})}};a([c({type:String,json:{write:!0}})],tf.prototype,"field",void 0),a([c({type:["asc","desc"],json:{write:!0}})],tf.prototype,"order",void 0),tf=n2=a([b("esri.popup.support.RelatedRecordsInfoFieldOrder")],tf);const FM=tf;let dn=class extends pe(Go){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};a([c({type:String,json:{write:!0}})],dn.prototype,"description",void 0),a([c({type:Number,json:{type:xe,write:!0}})],dn.prototype,"displayCount",void 0),a([c({type:["list"],json:{write:{isRequired:!0}}})],dn.prototype,"displayType",void 0),a([c({type:[FM],json:{write:!0}})],dn.prototype,"orderByFields",void 0),a([c({type:Number,json:{type:xe,write:{isRequired:!0}}})],dn.prototype,"relationshipId",void 0),a([c({type:String,json:{write:!0}})],dn.prototype,"title",void 0),a([c({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],dn.prototype,"type",void 0),dn=a([b("esri.popup.content.RelationshipContent")],dn);const Fm=dn;var o2;let rf=o2=class extends Go{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new o2({text:this.text})}};a([c({type:String,json:{write:!0}})],rf.prototype,"text",void 0),a([c({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],rf.prototype,"type",void 0),rf=o2=a([b("esri.popup.content.TextContent")],rf);const Nm=rf;let to=class extends pe(F){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};a([c({type:String,json:{write:!0}})],to.prototype,"title",void 0),a([c({type:String,json:{write:!0}})],to.prototype,"description",void 0),a([c({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],to.prototype,"type",void 0),a([c({type:Number,json:{type:xe,write:!0}})],to.prototype,"associatedNetworkSourceId",void 0),a([c({type:Number,json:{type:xe,write:!0}})],to.prototype,"associatedAssetGroup",void 0),a([c({type:Number,json:{type:xe,write:!0}})],to.prototype,"associatedAssetType",void 0),to=a([b("esri.popup.support.UtilityNetworkAssociationType")],to);const Z4=to;let ca=class extends pe(Go){constructor(e){super(e),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};a([c({type:String,json:{write:!0}})],ca.prototype,"description",void 0),a([c({type:Number,json:{type:xe,write:!0}})],ca.prototype,"displayCount",void 0),a([c({type:String,json:{write:!0}})],ca.prototype,"title",void 0),a([c({type:[Z4],json:{write:!0}})],ca.prototype,"associationTypes",void 0),a([se({utilityNetworkAssociations:"utility-network-associations"})],ca.prototype,"type",void 0),ca=a([b("esri.popup.content.UtilityNetworkAssociationsContent")],ca);const NM=ca,sie={base:null,key:"type",typeMap:{attachment:Ah,media:Lm,text:Nm,expression:Xw,field:Rh,relationship:Fm,utilityNetworkAssociations:NM}},nie={base:null,key:"type",typeMap:{attachment:Ah,media:Lm,text:Nm,expression:Xw,field:Rh,relationship:Fm}};var a2;let Pl=a2=class extends F{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new a2({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};a([c({type:String,json:{write:!0}})],Pl.prototype,"name",void 0),a([c({type:String,json:{write:!0}})],Pl.prototype,"title",void 0),a([c({type:String,json:{write:!0}})],Pl.prototype,"expression",void 0),a([c({type:["string","number"],json:{write:!0}})],Pl.prototype,"returnType",void 0),Pl=a2=a([b("esri.popup.ExpressionInfo")],Pl);const oie=Pl;var l2;let sf=l2=class extends F{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new l2({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};a([c({type:Boolean,json:{write:!0}})],sf.prototype,"returnTopmostRaster",void 0),a([c({type:Boolean,json:{write:!0}})],sf.prototype,"showNoDataRecords",void 0),sf=l2=a([b("esri.popup.LayerOptions")],sf);const aie=sf;var u2;let nf=u2=class extends F{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new u2({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?E(this.orderByFields):null})}};a([c({type:Boolean,json:{write:!0}})],nf.prototype,"showRelatedRecords",void 0),a([c({type:[FM],json:{write:!0}})],nf.prototype,"orderByFields",void 0),nf=u2=a([b("esri.popup.RelatedRecordsInfo")],nf);const ek=nf;var c2;let es=c2=class extends Dw(X){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new c2({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};a([c()],es.prototype,"active",void 0),a([c()],es.prototype,"className",void 0),a([c()],es.prototype,"disabled",void 0),a([c()],es.prototype,"icon",void 0),a([c()],es.prototype,"id",void 0),a([c()],es.prototype,"indicator",void 0),a([c()],es.prototype,"title",void 0),a([c()],es.prototype,"type",void 0),a([c()],es.prototype,"visible",void 0),es=c2=a([b("esri.support.actions.ActionBase")],es);const DM=es;var d2;let h0=d2=class extends DM{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new d2({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};a([c()],h0.prototype,"image",void 0),h0=d2=a([b("esri.support.actions.ActionButton")],h0);const lie=h0;var h2;let of=h2=class extends DM{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new h2({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};a([c()],of.prototype,"image",void 0),a([c()],of.prototype,"value",void 0),of=h2=a([b("esri.support.actions.ActionToggle")],of);const uie=of,Ep="relationships/",tk="expression/",cie=H.ofType({key:"type",defaultKeyValue:"button",base:DM,typeMap:{button:lie,toggle:uie}}),die={base:Go,key:"type",typeMap:{media:Lm,custom:Zre,text:Nm,attachments:Ah,fields:Rh,expression:Xw,relationship:Fm,utilityNetworkAssociations:NM}},J4=new Set(["attachments","fields","media","text","expression","relationship"]),hie=new Set([...J4,"utility-network-associations"]);let kt=class extends pe(F){constructor(e){super(e),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(r=>Nn(die,r)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||Ar(e)?e:(L.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,r){const{popupElements:i}=r;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(r.description,r.mediaInfos,i):this._readPopupInfo(r)}writeWebSceneContent(e,r,i,s){this._writePopupTemplateContent(e,r,s)}writeWebMapContent(e,r,i,s){this._writePopupTemplateContent(e,r,s)}writeFieldInfos(e,r,i,s){const{content:n}=this,o=Array.isArray(n)?n:null,{writeFieldFormat:l,...u}=s||{};if(e){const d=o?o.filter(f=>f.type==="fields"):[],p=d.length&&d.every(f=>f.fieldInfos?.length);r.fieldInfos=e.filter(Boolean).map(f=>{const m=f.toJSON(u);return p&&(m.visible=!1),m})}if(o)for(const d of o)d.type==="fields"&&this._writeFieldsContent(d,r,u)}writeLayerOptions(e,r,i,s){r[i]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(s)}writeTitle(e,r){r.title=e||""}async collectRequiredFields(e,r,i){const s=this.expressionInfos||[];await this._collectExpressionInfoFields(e,r,i,[...s,...this._getContentExpressionInfos(this.content,s)]),Du(e,r,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e,r){const i=new Set;return await this.collectRequiredFields(i,e,r),[...i].sort()}_writePopupTemplateContent(e,r,i){typeof e!="string"?Array.isArray(e)&&(r.popupElements=e.filter(s=>i?.origin==="web-scene"?J4.has(s.type):hie.has(s.type)).map(s=>s?.toJSON(i)),r.popupElements.forEach(s=>{s.type==="attachments"?this._writeAttachmentContent(r):s.type==="media"?this._writeMediaContent(s,r):s.type==="text"?this._writeTextContent(s,r):s.type==="relationship"&&this._writeRelationshipContent(s,r)})):r.description=e}_writeFieldsContent(e,r,i){const s=e.fieldInfos;if(!Array.isArray(s)||!s.length)return;const n=r.fieldInfos;if(Array.isArray(n))for(const o of s){const l=n.find(u=>u.fieldName?.toLowerCase()===o.fieldName?.toLowerCase());l?l.visible=!0:n.push(o.toJSON(i))}else r.fieldInfos=s.map(o=>o.toJSON(i))}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,r){const i=e.orderByFields?.map(n=>this._toFieldOrderJSON(n,e.relationshipId))||[],s=[...r.relatedRecordsInfo?.orderByFields||[],...i];r.relatedRecordsInfo={showRelatedRecords:!0,...s?.length&&{orderByFields:s}}}_writeTextContent(e,r){!r.description&&e.text&&(r.description=e.text)}_writeMediaContent(e,r){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const i=E(e.mediaInfos);Array.isArray(r.mediaInfos)?r.mediaInfos=[...r.mediaInfos,...i]:r.mediaInfos=i}_readPopupInfoElements(e,r,i){const s={description:!1,mediaInfos:!1};return i.map(n=>n.type==="media"?(n.mediaInfos||!r||s.mediaInfos||(n.mediaInfos=r,s.mediaInfos=!0),Lm.fromJSON(n)):n.type==="text"?(n.text||!e||s.description||(n.text=e,s.description=!0),Nm.fromJSON(n)):n.type==="attachments"?Ah.fromJSON(n):n.type==="fields"?Rh.fromJSON(n):n.type==="expression"?Xw.fromJSON(n):n.type==="relationship"?Fm.fromJSON(n):n.type==="utilityNetworkAssociations"?NM.fromJSON(n):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:r,order:i}=e;if(!r?.startsWith(Ep))return null;const s=r.replace(Ep,"").split("/");if(s.length!==2)return null;const n=parseInt(s[0],10),o=s[1];return!Number.isNaN(n)&&o?Fm.fromJSON({relationshipId:n,orderByFields:[{field:o,order:i}]}):null}_toFieldOrderJSON(e,r){const{order:i,field:s}=e;return{field:`${Ep}${r}/${s}`,order:i}}_readPopupInfo({description:e,mediaInfos:r,showAttachments:i,relatedRecordsInfo:s={showRelatedRecords:!1}}){const n=[];e?n.push(new Nm({text:e})):n.push(new Rh),Array.isArray(r)&&r.length&&n.push(Lm.fromJSON({mediaInfos:r})),i&&n.push(Ah.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:l}=s;return o&&l?.length&&l.forEach(u=>{const d=this._toRelationshipContent(u);d&&n.push(d)}),n.length?n:e}_getContentElementFields(e){const r=e?.type;if(r==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(r==="custom")return e.outFields||[];if(r==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(r==="media"){const i=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...i.reduce((s,n)=>[...s,...this._getMediaInfoFields(n)],[])]}return r==="text"?this._extractFieldNames(e.text):r==="relationship"||r==="utility-network-associations"?[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)]:[]}_getMediaInfoFields(e){const{caption:r,title:i,value:s}=e,n=s||{},{fields:o,normalizeField:l,tooltipField:u,sourceURL:d,linkURL:p}=n,f=[...this._extractFieldNames(i),...this._extractFieldNames(r),...this._extractFieldNames(d),...this._extractFieldNames(p),...o??[]];return l&&f.push(l),u&&f.push(u),f}_getContentExpressionInfos(e,r){return Array.isArray(e)?e.reduce((i,s)=>[...i,...s.type==="expression"&&s.expressionInfo?[s.expressionInfo]:[]],r):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((r,i)=>[...r,...this._getContentElementFields(i)],[]):[]}async _collectExpressionInfoFields(e,r,i,s){s&&await Promise.all(s.map(n=>Fr(e,r,i,n.expression)))}_getFieldInfoFields(e){return e?e.filter(({fieldName:r,visible:i})=>!(i!==void 0&&!i||!r||r.startsWith(Ep)||r.startsWith(tk))).map(r=>r.fieldName):[]}_getActionsFields(e){return e?e.toArray().reduce((r,i)=>[...r,...this._getActionFields(i)],[]):[]}_getActionFields(e){const{className:r,title:i,type:s}=e,n=s==="button"||s==="toggle"?e.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(r),...this._extractFieldNames(n)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return PM(e).filter(r=>!(r.startsWith(Ep)||r.startsWith(tk)))}};a([c({type:cie})],kt.prototype,"actions",void 0),a([c()],kt.prototype,"content",void 0),a([Ce("content")],kt.prototype,"castContent",null),a([V("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],kt.prototype,"readContent",null),a([q("web-scene","content",{popupElements:{type:H.ofType(nie)},showAttachments:{type:Boolean},mediaInfos:{type:H.ofType(i2)},description:{type:String},relatedRecordsInfo:{type:ek}})],kt.prototype,"writeWebSceneContent",null),a([q("content",{popupElements:{type:H.ofType(sie)},showAttachments:{type:Boolean},mediaInfos:{type:H.ofType(i2)},description:{type:String},relatedRecordsInfo:{type:ek}})],kt.prototype,"writeWebMapContent",null),a([c({type:[oie],json:{write:!0}})],kt.prototype,"expressionInfos",void 0),a([c({type:[e1]})],kt.prototype,"fieldInfos",void 0),a([q("fieldInfos")],kt.prototype,"writeFieldInfos",null),a([c({type:aie})],kt.prototype,"layerOptions",void 0),a([q("layerOptions")],kt.prototype,"writeLayerOptions",null),a([c({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],kt.prototype,"lastEditInfoEnabled",void 0),a([c()],kt.prototype,"outFields",void 0),a([c()],kt.prototype,"overwriteActions",void 0),a([c()],kt.prototype,"returnGeometry",void 0),a([c({json:{type:String}})],kt.prototype,"title",void 0),a([q("title")],kt.prototype,"writeTitle",null),kt=a([b("esri.PopupTemplate")],kt);const Vn=kt,jM=Symbol("idFieldsProviderSymbol");function pie(t){return!!t&&jM in t}function rk(t){return pie(t)?t[jM]:void 0}const fy=Symbol("popupProvider");function e$e(t){return typeof t=="object"&&t!==null&&"popupEnabled"in t&&"popupTemplate"in t}function fie(t){return!!t&&fy in t}function mie(t){return fie(t)?t[fy]:null}function t$e(t,e){switch(e.type){case"object-id":case"unique-id-simple":return t.attributes[e.fieldName];case"unique-id-composite":{const r=[];for(const i of e.fieldNames)r.push(t.attributes[i]??null);return JSON.stringify(r)}}}function ik(t,e){if("uniqueIdFields"in e&&e.uniqueIdFields?.length){if(e.uniqueIdFields.length===1)return t.attributes?.[e.uniqueIdFields[0]];const r=e.uniqueIdFields.map(i=>t.attributes?.[i]);return JSON.stringify(r)}return"objectIdField"in e&&e.objectIdField?t.attributes?.[e.objectIdField]:null}const sk=new $e({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let yie=0,St=class extends F{constructor(e){super(e),this.id="sym"+yie++,this.type=null,this.color=new ue([0,0,0,1])}readColor(e){return e?.[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,r){}hash(){return JSON.stringify(this.toJSON())}clone(){}};a([c({type:sk.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:sk.write,isRequired:!0}}})],St.prototype,"type",void 0),a([c({type:ue,json:{write:{allowNull:!0}}})],St.prototype,"color",void 0),a([V("color")],St.prototype,"readColor",null),St=a([b("esri.symbols.Symbol")],St);var p2;let Er=p2=class extends St{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){if(this.data?.type==="CIMSymbolReference"){const r=this.data.primitiveOverrides;if(r){const i=r.map(s=>{const n=s.valueExpressionInfo;return n?Fr(t,e,null,n.expression):null});await Promise.all(i)}}}clone(){return new p2({data:E(this.data)})}hash(){return rR(JSON.stringify(this.data)).toString()}};a([c({json:{write:!1}})],Er.prototype,"color",void 0),a([c({json:{write:!0}})],Er.prototype,"data",void 0),a([V("data",["symbol"])],Er.prototype,"readData",null),a([q("data",{})],Er.prototype,"writeData",null),a([se({CIMSymbolReference:"cim"},{readOnly:!0})],Er.prototype,"type",void 0),Er=p2=a([b("esri.symbols.CIMSymbol")],Er);let Jr=class extends F{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,r,i){e||(r[i]=e)}};a([c({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],Jr.prototype,"enabled",void 0),a([q("enabled")],Jr.prototype,"writeEnabled",null),a([c({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0,json:{write:{isRequired:!0}}})],Jr.prototype,"type",void 0),Jr=a([b("esri.symbols.Symbol3DLayer")],Jr);function gie(t,e){const r=e.transparency!=null?Tm(e.transparency):1,i=e.color;return i&&Array.isArray(i)?new ue([i[0]||0,i[1]||0,i[2]||0,r]):null}function vie(t,e){e.color=t.toJSON().slice(0,3);const r=Vw(t.a);r!==0&&(e.transparency=r)}function dl(t){return{type:ue,nonNullable:t?.nonNullable,json:{type:[xe],default:null,read:{source:["color","transparency"],reader:gie},write:{target:{color:{type:[xe],isRequired:t?.colorRequiredOnWrite},transparency:{type:xe}},writer:vie}}}}const zn={type:Number,cast:Me,json:{write:!0}};function s$e(t){return t==="emissive"?0:1}let Al=class extends F{constructor(e){super(e),this.color=new ue([0,0,0,1]),this.extensionLength=0,this.size=gs(1)}clone(){}cloneProperties(){return{color:E(this.color),size:this.size,extensionLength:this.extensionLength}}};a([c({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],Al.prototype,"type",void 0),a([c(dl({colorRequiredOnWrite:!0}))],Al.prototype,"color",void 0),a([c({...zn,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],Al.prototype,"extensionLength",void 0),a([c(zn)],Al.prototype,"size",void 0),Al=a([b("esri.symbols.edges.Edges3D")],Al);const VM=Al;var f2;let p0=f2=class extends VM{constructor(t){super(t),this.type="sketch"}clone(){return new f2(this.cloneProperties())}};a([se({sketch:"sketch"},{readOnly:!0})],p0.prototype,"type",void 0),p0=f2=a([b("esri.symbols.edges.SketchEdges3D")],p0);const wie=p0;var m2;let f0=m2=class extends VM{constructor(t){super(t),this.type="solid"}clone(){return new m2(this.cloneProperties())}};a([se({solid:"solid"},{readOnly:!0})],f0.prototype,"type",void 0),f0=m2=a([b("esri.symbols.edges.SolidEdges3D")],f0);const Y4=f0,K4={types:{key:"type",base:VM,typeMap:{solid:Y4,sketch:wie}},json:{write:!0}};var y2;let hd=y2=class extends F{constructor(){super(...arguments),this.strength=null,this.source="emissive"}clone(){const t={strength:this.strength,source:this.source};return new y2(t)}};a([c({json:{write:!1}})],hd.prototype,"strength",void 0),a([c({json:{write:!1}})],hd.prototype,"source",void 0),hd=y2=a([b("esri.symbols.support.Symbol3DEmissive")],hd);var g2;let Di=g2=class extends F{constructor(t){super(t),this.color=null,this.emissive=new hd({source:"emissive"})}clone(){const t={color:this.color?.clone()??null,emissive:this.emissive?.clone()??null};return new g2(t)}};a([c(dl())],Di.prototype,"color",void 0),a([c({type:hd,json:{write:!1}})],Di.prototype,"emissive",void 0),Di=g2=a([b("esri.symbols.support.Symbol3DMaterial")],Di);var v2,Hd;let mo=(Hd=class extends Jr{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new v2({edges:this.edges?.clone(),enabled:this.enabled,material:this.material?.clone(),castShadows:this.castShadows,size:this.size})}},v2=Hd,Hd);a([se({Extrude:"extrude"},{readOnly:!0})],mo.prototype,"type",void 0),a([c({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],mo.prototype,"size",void 0),a([c({type:Di,json:{write:!0}})],mo.prototype,"material",void 0),a([c({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],mo.prototype,"castShadows",void 0),a([c(K4)],mo.prototype,"edges",void 0),mo=v2=a([b("esri.symbols.ExtrudeSymbol3DLayer")],mo);let Qf=class extends F{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};a([c({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Qf.prototype,"type",void 0),Qf=a([b("esri.symbols.patterns.LinePattern3D")],Qf);const bie=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var w2;const _ie=Ft()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let nu=w2=class extends Qf{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new w2(t)}};a([c({type:["style"],json:{write:{isRequired:!0}}})],nu.prototype,"type",void 0),a([se(_ie),c({type:bie,json:{write:{isRequired:!0}}})],nu.prototype,"style",void 0),nu=w2=a([b("esri.symbols.patterns.LineStylePattern3D")],nu);let Xf=class extends F{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};a([c({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Xf.prototype,"type",void 0),Xf=a([b("esri.symbols.patterns.Pattern3D")],Xf);const Sie=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var b2;let pd=b2=class extends Xf{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new b2({style:this.style})}};a([c({type:["style"],json:{write:{isRequired:!0}}})],pd.prototype,"type",void 0),a([c({type:Sie,json:{read:!0,write:{isRequired:!0}}})],pd.prototype,"style",void 0),pd=b2=a([b("esri.symbols.patterns.StylePattern3D")],pd);const $ie={types:{key:"type",base:Xf,typeMap:{style:pd}},json:{write:!0}},Q4={types:{key:"type",base:Qf,typeMap:{style:nu}},json:{write:!0}},em=new ue("white"),xie=new ue([255,255,255,0]);function Tie(t){return t.r===0&&t.g===0&&t.b===0}var _2;let tm=_2=class extends Di{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color?.clone()??null,colorMixMode:this.colorMixMode,emissive:this.emissive?.clone()??null};return new _2(t)}};a([se({multiply:"multiply",replace:"replace",tint:"tint"})],tm.prototype,"colorMixMode",void 0),tm=_2=a([b("esri.symbols.support.Symbol3DFillMaterial")],tm);function zM(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Mie(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function Iie(t,e,r,i,s,n,o,l,u,d,p,f,m,y,g,v){return[t,e,r,i,s,n,o,l,u,d,p,f,m,y,g,v]}const Eie=zM();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:Eie,clone:Mie,create:zM,fromValues:Iie},Symbol.toStringTag,{value:"Module"}));function Oie(t){return t<=JA?new Array(t).fill(0):new Float64Array(t)}function l$e(t){return(gU(t)?t.byteLength/8:t.length)<=JA?Array.from(t):new Float64Array(t)}function u$e(t,e,r){return Array.isArray(t)?t.slice(e,e+r):t.subarray(e,e+r)}function c$e(t){return[...t]}function d$e(t){const e=zM();for(let r=0;r<16;++r)e[r]=t[r];return e}function my(t=Aie){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function UM(t,e,r,i,s,n,o=my()){return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o[4]=s,o[5]=n,o}function h$e(t,e=my()){return kie(t,0,t.length/3,e)}function kie(t,e,r,i=my()){return X4(i,S2),Cie(i,t,e,r),i}function p$e(t,e=Oie(24)){const[r,i,s,n,o,l]=t;return e[0]=r,e[1]=i,e[2]=s,e[3]=r,e[4]=i,e[5]=l,e[6]=r,e[7]=o,e[8]=s,e[9]=r,e[10]=o,e[11]=l,e[12]=n,e[13]=i,e[14]=s,e[15]=n,e[16]=i,e[17]=l,e[18]=n,e[19]=o,e[20]=s,e[21]=n,e[22]=o,e[23]=l,e}function f$e(t,e){const r=isFinite(t[2])||isFinite(t[5]);return new he(r?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function m$e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function y$e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function g$e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function Cie(t,e,r=0,i=e.length/3){let s=t[0],n=t[1],o=t[2],l=t[3],u=t[4],d=t[5];for(let p=0;p<i;p++)s=Math.min(s,e[r+3*p]),n=Math.min(n,e[r+3*p+1]),o=Math.min(o,e[r+3*p+2]),l=Math.max(l,e[r+3*p]),u=Math.max(u,e[r+3*p+1]),d=Math.max(d,e[r+3*p+2]);t[0]=s,t[1]=n,t[2]=o,t[3]=l,t[4]=u,t[5]=d}function v$e(t,e,r){const i=e.length;let s=t[0],n=t[1],o=t[2],l=t[3],u=t[4],d=t[5];if(r)for(let p=0;p<i;p++){const f=e[p];s=Math.min(s,f[0]),n=Math.min(n,f[1]),o=Math.min(o,f[2]),l=Math.max(l,f[0]),u=Math.max(u,f[1]),d=Math.max(d,f[2])}else for(let p=0;p<i;p++){const f=e[p];s=Math.min(s,f[0]),n=Math.min(n,f[1]),l=Math.max(l,f[0]),u=Math.max(u,f[1])}t[0]=s,t[1]=n,t[2]=o,t[3]=l,t[4]=u,t[5]=d}function w$e(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function yy(t){return t[0]>=t[3]?0:t[3]-t[0]}function gy(t){return t[1]>=t[4]?0:t[4]-t[1]}function vy(t){return t[2]>=t[5]?0:t[5]-t[2]}function b$e(t){const e=yy(t),r=vy(t),i=gy(t);return Math.sqrt(e*e+r*r+i*i)}function _$e(t,e=[0,0,0]){return e[0]=t[0]+yy(t)/2,e[1]=t[1]+gy(t)/2,e[2]=t[2]+vy(t)/2,e}function S$e(t,e=[0,0,0]){return e[0]=yy(t),e[1]=gy(t),e[2]=vy(t),e}function $$e(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function Pie(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function x$e(t,e){return e==null||Pie(t,e)}function T$e(t,e,r,i,s=t){return s[0]=t[0]+e,s[1]=t[1]+r,s[2]=t[2]+i,s[3]=t[3]+e,s[4]=t[4]+r,s[5]=t[5]+i,s}function M$e(t,e,r=t){const i=t[0]+yy(t)/2,s=t[1]+gy(t)/2,n=t[2]+vy(t)/2;return r[0]=i+(t[0]-i)*e,r[1]=s+(t[1]-s)*e,r[2]=n+(t[2]-n)*e,r[3]=i+(t[3]-i)*e,r[4]=s+(t[4]-s)*e,r[5]=n+(t[5]-n)*e,r}function I$e(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function E$e(t,e,r=t){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r!==t&&(r[3]=t[3],r[4]=t[4],r[5]=t[5]),r}function O$e(t,e,r=t){return r[3]=e[0],r[4]=e[1],r[5]=e[2],r!==t&&(r[0]=t[0],r[1]=t[1],r[2]=t[2]),t}function X4(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function k$e(t){return t?X4(t,S2):my(S2)}function C$e(t,e=yi()){return e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function P$e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function A$e(t,e,r,i,s){return t[0]=e,t[1]=r,t[2]=Number.NEGATIVE_INFINITY,t[3]=i,t[4]=s,t[5]=Number.POSITIVE_INFINITY,t}function nk(t){return t.length===6}function R$e(t){return yy(t)===0&&gy(t)===0&&vy(t)===0}function L$e(t,e,r){if(t==null||e==null)return t===e;if(!nk(t)||!nk(e))return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}const S2=[1/0,1/0,1/0,-1/0,-1/0,-1/0],Aie=[0,0,0,0,0,0];my();function F$e(t,{isPrimitive:e,width:r,depth:i,height:s}){const n=e?10:1;if(r==null&&s==null&&i==null)return[n*t[0],n*t[1],n*t[2]];const o=ip(r,i,s);let l;for(let u=0;u<3;u++){const d=o[u];if(d!=null){l=d/t[u];break}}for(let u=0;u<3;u++)o[u]==null&&(o[u]=t[u]*l);return o}const Rie=UM(-.5,-.5,-.5,.5,.5,.5),Lie=UM(-.5,-.5,0,.5,.5,1),Fie=UM(-.5,-.5,0,.5,.5,.5);function N$e(t){switch(t){case"sphere":case"cube":case"diamond":return Rie;case"cylinder":case"cone":case"inverted-cone":return Lie;case"tetrahedron":return Fie;default:return}}const qM=["butt","square","round"],Nie=[...qM,"none"],ej=["miter","bevel","round"];var $2;let Rl=$2=class extends F{constructor(t){super(t),this.color=new ue([0,0,0,1]),this.size=gs(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new $2(t)}};a([c(dl({colorRequiredOnWrite:!0}))],Rl.prototype,"color",void 0),a([c({...zn,json:{write:{isRequired:!0}}})],Rl.prototype,"size",void 0),a([c(Q4)],Rl.prototype,"pattern",void 0),a([c({type:qM,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],Rl.prototype,"patternCap",void 0),Rl=$2=a([b("esri.symbols.support.Symbol3DOutline")],Rl);var m0,Wd;let Gr=(Wd=class extends Jr{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const e={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new m0(e)}static fromSimpleFillSymbol(e){const r=e.outline&&e.outline.style&&e.outline.style!=="solid"?new nu({style:e.outline.style}):null,i={size:e.outline?.width??0,color:(e.outline?.color??em).clone(),pattern:r};return r&&e.outline?.cap&&(i.patternCap=e.outline.cap),new m0({material:new tm({color:(e.color??xie).clone()}),pattern:e.style&&e.style!=="solid"?new pd({style:e.style}):null,outline:i})}},m0=Wd,Wd);a([se({Fill:"fill"},{readOnly:!0})],Gr.prototype,"type",void 0),a([c({type:tm,json:{write:!0}})],Gr.prototype,"material",void 0),a([c($ie)],Gr.prototype,"pattern",void 0),a([c({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Gr.prototype,"castShadows",void 0),a([c({type:Rl,json:{write:!0}})],Gr.prototype,"outline",void 0),a([c(K4)],Gr.prototype,"edges",void 0),Gr=m0=a([b("esri.symbols.FillSymbol3DLayer")],Gr);var x2;const Die=Ft()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let Ll=x2=class extends F{constructor(t){super(t)}readHref(t,e,r){return t?Gu(t,r):e.dataURI}writeHref(t,e,r,i){t&&(Uu(t)?e.dataURI=t:(e.href=Iu(t,i),gi(e.href)&&(e.href=en(e.href))))}clone(){return new x2({href:this.href,primitive:this.primitive})}equals(t){return t.primitive===this.primitive&&t.href===this.href}};a([c({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],Ll.prototype,"href",void 0),a([V("href")],Ll.prototype,"readHref",null),a([q("href",{href:{type:String},dataURI:{type:String}})],Ll.prototype,"writeHref",null),a([se(Die)],Ll.prototype,"primitive",void 0),Ll=x2=a([b("esri.symbols.support.IconSymbol3DLayerResource")],Ll);const D$e="circle";let y0=class extends pe(F){constructor(e){super(e),this.mode="hidden"}equals(e){return this.mode===e.mode}};a([c({type:["adaptive","hidden","visible"],json:{write:{isRequired:!0}}})],y0.prototype,"mode",void 0),y0=a([b("esri.symbols.support.OccludedVisibility")],y0);const tj=y0;var T2;let fd=T2=class extends X{constructor(t){super(t),this.x=0,this.y=0}clone(){return new T2({x:this.x,y:this.y})}equals(t){return t.x===this.x&&t.y===this.y}};a([c({type:Number})],fd.prototype,"x",void 0),a([c({type:Number})],fd.prototype,"y",void 0),fd=T2=a([b("esri.symbols.support.Symbol3DAnchorPosition2D")],fd);var M2;let af=M2=class extends F{constructor(t){super(t),this.color=new ue([0,0,0,1]),this.size=gs(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new M2(t)}equals(t){return t.size===this.size&&(this.color==null?t.color==null:this.color.equals(t.color))}};a([c(dl({colorRequiredOnWrite:!0}))],af.prototype,"color",void 0),a([c({...zn,json:{write:{isRequired:!0}}})],af.prototype,"size",void 0),af=M2=a([b("esri.symbols.support.Symbol3DIconOutline")],af);var Oc,Zd;let ir=(Zd=class extends Jr{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0,this.occludedVisibility=null}clone(){return new Oc({anchor:this.anchor,anchorPosition:E(this.anchorPosition),enabled:this.enabled,material:E(this.material),outline:E(this.outline),resource:E(this.resource),angle:this.angle,size:this.size,occludedVisibility:E(this.occludedVisibility)})}static fromSimpleMarkerSymbol(e){const r=e.color||em,i=ok(e),s=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||em).clone()}:null;return new Oc({size:e.size,angle:e.angle,resource:{primitive:Vie(()=>L.getLogger(this.prototype),e.style)},material:{color:r},outline:s,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(e){const r=!e.color||Tie(e.color)?em:e.color,i=ok(e);return new Oc({size:e.width<=e.height?e.height:e.width,angle:e.angle,resource:{href:e.url},material:{color:r.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(e){return new Oc({resource:{href:fR({mediaType:"application/json",data:JSON.stringify(e.data)})}})}},Oc=Zd,Zd);function ok(t){const e="width"in t?t.width:t.size,r="height"in t?t.height:t.size,i=ak(t.xoffset),s=ak(t.yoffset);return(i||s)&&e&&r?{x:-i/e,y:s/r}:null}function ak(t){return isFinite(t)?t:0}a([c({type:Di,json:{write:!0}})],ir.prototype,"material",void 0),a([c({type:Ll,json:{write:!0}})],ir.prototype,"resource",void 0),a([se({Icon:"icon"},{readOnly:!0})],ir.prototype,"type",void 0),a([c({...zn,json:{write:{isRequired:!0}}})],ir.prototype,"size",void 0),a([se({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],ir.prototype,"anchor",void 0),a([c({type:fd,json:{type:[Number],read:{reader:t=>new fd({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],ir.prototype,"anchorPosition",void 0),a([c({type:af,json:{write:!0}})],ir.prototype,"outline",void 0),a([c({type:Number,json:{write:!0,default:0}})],ir.prototype,"angle",void 0),a([c({type:tj})],ir.prototype,"occludedVisibility",void 0),ir=Oc=a([b("esri.symbols.IconSymbol3DLayer")],ir);const jie={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function Vie(t,e){return jie[e]||(t().warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const zie=["begin","end","begin-end"],rj=["arrow","circle","square","diamond","cross","x"];let To=class extends pe(F){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};a([c({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],To.prototype,"type",void 0),a([c({type:zie,json:{default:"begin-end",write:!0}})],To.prototype,"placement",void 0),a([c({type:rj,json:{default:"arrow",write:!0}})],To.prototype,"style",void 0),a([c({type:ue,json:{type:[xe],default:null,write:!0}})],To.prototype,"color",void 0),To=a([b("esri.symbols.LineStyleMarker3D")],To);var g0,Jd;let qr=(Jd=class extends Jr{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=gs(1),this.pattern=null,this.marker=null}clone(){const e={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new g0(e)}static fromSimpleLineSymbol(e){const r={enabled:!0,size:e.width??gs(1),cap:e.cap||"butt",join:e.join||"miter",pattern:e.style?new nu({style:e.style}):null,material:new Di({color:(e.color||em).clone()}),marker:e.marker?new To({placement:e.marker.placement,style:e.marker.style,color:e.marker.color?.clone()??null}):null};return new g0(r)}},g0=Jd,Jd);a([c({type:Di,json:{write:!0}})],qr.prototype,"material",void 0),a([se({Line:"line"},{readOnly:!0})],qr.prototype,"type",void 0),a([c({type:ej,json:{write:!0,default:"miter"}})],qr.prototype,"join",void 0),a([c({type:qM,json:{write:!0,default:"butt"}})],qr.prototype,"cap",void 0),a([c({...zn,json:{write:{isRequired:!0}}})],qr.prototype,"size",void 0),a([c(Q4)],qr.prototype,"pattern",void 0),a([c({types:{key:"type",base:To,typeMap:{style:To}},json:{write:!0}})],qr.prototype,"marker",void 0),qr=g0=a([b("esri.symbols.LineSymbol3DLayer")],qr);var I2;const Uie=Ft()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let lf=I2=class extends F{clone(){return new I2({href:this.href,primitive:this.primitive})}};a([c({type:String,json:{read:vw,write:Eu}})],lf.prototype,"href",void 0),a([se(Uie)],lf.prototype,"primitive",void 0),lf=I2=a([b("esri.symbols.support.ObjectSymbol3DLayerResource")],lf);const z$e="sphere";var E2;let Jl=E2=class extends X{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new E2({x:this.x,y:this.y,z:this.z})}};a([c({type:Number})],Jl.prototype,"x",void 0),a([c({type:Number})],Jl.prototype,"y",void 0),a([c({type:Number})],Jl.prototype,"z",void 0),Jl=E2=a([b("esri.symbols.support.Symbol3DAnchorPosition3D")],Jl);var O2,Yd;let tr=(Yd=class extends Jr{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new O2({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition?.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material?.clone()??null,castShadows:this.castShadows,resource:this.resource?.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}},O2=Yd,Yd);a([c({type:Di,json:{write:!0}})],tr.prototype,"material",void 0),a([c({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],tr.prototype,"castShadows",void 0),a([c({type:lf,json:{write:!0}})],tr.prototype,"resource",void 0),a([se({Object:"object"},{readOnly:!0})],tr.prototype,"type",void 0),a([c({type:Number,json:{write:!0}})],tr.prototype,"width",void 0),a([c({type:Number,json:{write:!0}})],tr.prototype,"height",void 0),a([c({type:Number,json:{write:!0}})],tr.prototype,"depth",void 0),a([se({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],tr.prototype,"anchor",void 0),a([c({type:Jl,json:{type:[Number],read:{reader:t=>new Jl({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],tr.prototype,"anchorPosition",void 0),a([c({type:Number,json:{write:!0}})],tr.prototype,"heading",void 0),a([c({type:Number,json:{write:!0}})],tr.prototype,"tilt",void 0),a([c({type:Number,json:{write:!0}})],tr.prototype,"roll",void 0),a([c({readOnly:!0})],tr.prototype,"isPrimitive",null),tr=O2=a([b("esri.symbols.ObjectSymbol3DLayer")],tr);var k2,Kd;let dr=(Kd=class extends Jr{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(e,r){return e??(r.height==null&&r.size!=null?r.size:void 0)}readHeight(e,r){return e??(r.width==null&&r.size!=null?r.size:void 0)}clone(){return new k2({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}},k2=Kd,Kd);a([c({type:Di,json:{write:!0}})],dr.prototype,"material",void 0),a([c({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],dr.prototype,"castShadows",void 0),a([se({Path:"path"},{readOnly:!0})],dr.prototype,"type",void 0),a([c({type:["circle","quad"],nonNullable:!0,json:{write:!0,default:"circle"}})],dr.prototype,"profile",void 0),a([c({type:ej,nonNullable:!0,json:{write:!0,default:"miter"}})],dr.prototype,"join",void 0),a([c({type:Nie,nonNullable:!0,json:{write:!0,default:"butt"}})],dr.prototype,"cap",void 0),a([c({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],dr.prototype,"width",void 0),a([V("width",["width","size","height"])],dr.prototype,"readWidth",null),a([c({type:Number,json:{write:!0}})],dr.prototype,"height",void 0),a([V("height",["height","size","width"])],dr.prototype,"readHeight",null),a([c({type:["center","bottom","top"],nonNullable:!0,json:{write:!0,default:"center"}})],dr.prototype,"anchor",void 0),a([c({type:["heading","all"],nonNullable:!0,json:{write:!0,default:"all"}})],dr.prototype,"profileRotation",void 0),dr=k2=a([b("esri.symbols.PathSymbol3DLayer")],dr);const qie=["none","underline","line-through"],Gie=["normal","italic","oblique"],Bie=["normal","lighter","bold","bolder"],ij={type:Number,cast:t=>{const e=Hr(t);return e===0?1:Bi(e,.1,4)},nonNullable:!0},Hie=["left","right","center"],Wie=["baseline","top","middle","bottom"],sj={type:Hie,nonNullable:!0},nj={type:Wie,nonNullable:!0},U$e=8;var C2;let is=C2=class extends F{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return Me(t)}clone(){return new C2({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};a([c({type:qie,json:{default:"none",write:!0}})],is.prototype,"decoration",void 0),a([c({type:String,json:{write:!0}})],is.prototype,"family",void 0),a([c({type:Number,json:{write:{overridePolicy:(t,e,r)=>({enabled:!r||!r.textSymbol3D})}}})],is.prototype,"size",void 0),a([Ce("size")],is.prototype,"castSize",null),a([c({type:Gie,json:{default:"normal",write:!0}})],is.prototype,"style",void 0),a([c({type:Bie,json:{default:"normal",write:!0}})],is.prototype,"weight",void 0),is=C2=a([b("esri.symbols.Font")],is);var P2;let md=P2=class extends F{constructor(){super(...arguments),this.color=new ue([0,0,0,1]),this.size=0}clone(){const t={color:E(this.color),size:this.size};return new P2(t)}};a([c(dl())],md.prototype,"color",void 0),a([c(zn)],md.prototype,"size",void 0),md=P2=a([b("esri.symbols.support.Symbol3DHalo")],md);let rm=class extends pe(F){constructor(e){super(e),this.color=null}};a([c(dl())],rm.prototype,"color",void 0),rm=a([b("esri.symbols.support.Symbol3DTextBackground")],rm);var v0,Qd;let Pt=(Qd=class extends Jr{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline",this.occludedVisibility=null}get font(){return this._get("font")||null}set font(e){e!=null&&this._userSize!=null&&(e.size=this._userSize),this._set("font",e)}writeFont(e,r,i,s){const n={...s,textSymbol3D:!0};r.font=e.write({},n),delete r.font.size}get size(){return this._userSize!=null?this._userSize:this.font?.size!=null?this.font.size:9}set size(e){this._userSize=e,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const e=new v0({enabled:this.enabled,font:E(this.font),halo:E(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:E(this.background),occludedVisibility:E(this.occludedVisibility)});return e._userSize=this._userSize,e}static fromTextSymbol(e){return new v0({font:e.font!=null?e.font.clone():new is,halo:Zie(e.haloColor,e.haloSize),horizontalAlignment:e.horizontalAlignment,lineHeight:e.lineHeight,material:e.color?new Di({color:e.color.clone()}):null,text:e.text,verticalAlignment:e.verticalAlignment,background:e.backgroundColor?new rm({color:e.backgroundColor.clone()}):null})}},v0=Qd,Qd);function Zie(t,e){return t&&e!=null&&e>0?new md({color:E(t),size:e}):null}a([c({type:is,json:{write:!0}})],Pt.prototype,"font",null),a([q("font")],Pt.prototype,"writeFont",null),a([c({type:md,json:{write:!0}})],Pt.prototype,"halo",void 0),a([c({...sj,json:{default:"center",write:!0}})],Pt.prototype,"horizontalAlignment",void 0),a([c({...ij,json:{default:1,write:!0}})],Pt.prototype,"lineHeight",void 0),a([c({type:Di,json:{write:!0}})],Pt.prototype,"material",void 0),a([c({type:rm,json:{write:!0}})],Pt.prototype,"background",void 0),a([c(zn)],Pt.prototype,"size",null),a([c({type:String,json:{write:!0}})],Pt.prototype,"text",void 0),a([se({Text:"text"},{readOnly:!0})],Pt.prototype,"type",void 0),a([c({...nj,json:{default:"baseline",write:!0}})],Pt.prototype,"verticalAlignment",void 0),a([c({type:tj})],Pt.prototype,"occludedVisibility",void 0),Pt=v0=a([b("esri.symbols.TextSymbol3DLayer")],Pt);var A2,Xd;let yo=(Xd=class extends Jr{constructor(e){super(e),this.color=R2.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new A2({color:this.color.clone(),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}},A2=Xd,Xd);a([c({type:ue,nonNullable:!0,json:{type:[xe],write:(t,e,r)=>e[r]=t.toArray(1),default:()=>R2.clone(),defaultEquals:t=>t.toCss(!0)===R2.toCss(!0)}})],yo.prototype,"color",void 0),a([se({Water:"water"},{readOnly:!0})],yo.prototype,"type",void 0),a([c({type:["small","medium","large"],json:{write:!0,default:"medium"}})],yo.prototype,"waterbodySize",void 0),a([c({type:Number,json:{write:!0,default:null}})],yo.prototype,"waveDirection",void 0),a([c({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],yo.prototype,"waveStrength",void 0),yo=A2=a([b("esri.symbols.WaterSymbol3DLayer")],yo);const R2=new ue([0,119,190]);var L2;let Mo=L2=class extends X{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new L2({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};a([c({type:String})],Mo.prototype,"name",void 0),a([c({type:String})],Mo.prototype,"styleUrl",void 0),a([c({type:String})],Mo.prototype,"styleName",void 0),a([c({type:j})],Mo.prototype,"portal",void 0),Mo=L2=a([b("esri.symbols.support.StyleOrigin")],Mo);var F2;let im=F2=class extends X{constructor(){super(...arguments),this.url=""}clone(){return new F2({url:this.url})}};a([c({type:String})],im.prototype,"url",void 0),im=F2=a([b("esri.symbols.support.Thumbnail")],im);const oj={icon:ir,object:tr,line:qr,path:dr,fill:Gr,extrude:mo,text:Pt,water:yo},Jie=H.ofType({base:Jr,key:"type",typeMap:oj,errorContext:"symbol-layer"});let ci=class extends St{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const r=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,i=r?.type,s=i||H;this._set("symbolLayers",new s)}get color(){return null}set color(e){this.constructed&&L.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){Pn(e,this._get("symbolLayers"))}readStyleOrigin(e,r,i){if(e.styleUrl&&e.name){const s=Gu(e.styleUrl,i);return new Mo({styleUrl:s,name:e.name})}if(e.styleName&&e.name)return new Mo({portal:i?.portal||j.getDefault(),styleName:e.styleName,name:e.name});i?.messages&&i.messages.push(new qi("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:i,definition:e}))}writeStyleOrigin(e,r,i,s){if(e.styleUrl&&e.name){let n=Iu(e.styleUrl,s);gi(n)&&(n=en(n)),r.styleOrigin={styleUrl:n,name:e.name}}else e.styleName&&e.name&&(e.portal&&s?.portal&&!pR(e.portal.restUrl,s.portal.restUrl)?s?.messages&&s.messages.push(new qi("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):r.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof Jr||e&&oj[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};a([c({json:{read:!1,write:!1}})],ci.prototype,"color",null),a([c({type:Jie,nonNullable:!0,json:{write:!0}}),Ce(EL)],ci.prototype,"symbolLayers",null),a([c({type:Mo})],ci.prototype,"styleOrigin",void 0),a([V("styleOrigin")],ci.prototype,"readStyleOrigin",null),a([q("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],ci.prototype,"writeStyleOrigin",null),a([c({type:im,json:{read:!1}})],ci.prototype,"thumbnail",void 0),a([c({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],ci.prototype,"type",void 0),ci=a([b("esri.symbols.Symbol3D")],ci);let yd=class extends F{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};a([c({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],yd.prototype,"type",void 0),a([c({readOnly:!0})],yd.prototype,"visible",void 0),yd=a([b("esri.symbols.callouts.Callout3D")],yd);var N2;let w0=N2=class extends F{constructor(t){super(t),this.color=new ue("white")}clone(){return new N2({color:E(this.color)})}};a([c(dl({colorRequiredOnWrite:!0}))],w0.prototype,"color",void 0),w0=N2=a([b("esri.symbols.callouts.LineCallout3DBorder")],w0);const Yie=w0;var D2;let go=D2=class extends yd{constructor(t){super(t),this.type="line",this.color=new ue([0,0,0,1]),this.size=gs(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new D2({color:E(this.color),size:this.size,border:E(this.border)})}};a([se({line:"line"})],go.prototype,"type",void 0),a([c(dl({colorRequiredOnWrite:!0}))],go.prototype,"color",void 0),a([c({...zn,json:{write:{isRequired:!0}}})],go.prototype,"size",void 0),a([c({type:Yie,json:{write:!0}})],go.prototype,"border",void 0),a([c({readOnly:!0})],go.prototype,"visible",null),go=D2=a([b("esri.symbols.callouts.LineCallout3D")],go);function GM(t){if(!t)return!1;const e=t.verticalOffset;return!(!e||e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function aj(t){return!t||!t.supportsCallout||!t.supportsCallout()?!1:!!t.callout?.visible&&!!GM(t)}function H$e(t){return t.type==="point-3d"||t.type==="label-3d"}function W$e(t){return t.horizontalAlignment==="center"}const lj={types:{key:"type",base:yd,typeMap:{line:go}},json:{write:!0}};var j2;let Ia=j2=class extends F{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new j2({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};a([c({...zn,json:{write:{isRequired:!0}}})],Ia.prototype,"screenLength",void 0),a([c({type:Number,nonNullable:!0,json:{write:!0,default:0}})],Ia.prototype,"minWorldLength",void 0),a([c({type:Number,json:{write:!0}})],Ia.prototype,"maxWorldLength",void 0),Ia=j2=a([b("esri.symbols.support.Symbol3DVerticalOffset")],Ia);var b0;const uj=H.ofType({base:null,key:"type",typeMap:{text:Pt}});let Us=b0=class extends ci{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new uj,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return aj(this)}hasVisibleVerticalOffset(){return GM(this)}clone(){return new b0({styleOrigin:E(this.styleOrigin),symbolLayers:E(this.symbolLayers),thumbnail:E(this.thumbnail),callout:E(this.callout),verticalOffset:E(this.verticalOffset)})}static fromTextSymbol(t){return new b0({symbolLayers:new H([Pt.fromTextSymbol(t)])})}};a([c({type:Ia,json:{write:!0}})],Us.prototype,"verticalOffset",void 0),a([c(lj)],Us.prototype,"callout",void 0),a([c({json:{read:!1,write:!1}})],Us.prototype,"styleOrigin",void 0),a([c({type:uj})],Us.prototype,"symbolLayers",void 0),a([se({LabelSymbol3D:"label-3d"},{readOnly:!0})],Us.prototype,"type",void 0),Us=b0=a([b("esri.symbols.LabelSymbol3D")],Us);var _0;const cj=H.ofType({base:null,key:"type",typeMap:{line:qr,path:dr}}),Kie=H.ofType({base:null,key:"type",typeMap:{line:qr,path:dr}});let Xs=_0=class extends ci{constructor(t){super(t),this.symbolLayers=new cj,this.type="line-3d"}clone(){return new _0({styleOrigin:E(this.styleOrigin),symbolLayers:E(this.symbolLayers),thumbnail:E(this.thumbnail)})}static fromSimpleLineSymbol(t){return new _0({symbolLayers:new H([qr.fromSimpleLineSymbol(t)])})}};a([c({type:cj,json:{type:Kie}})],Xs.prototype,"symbolLayers",void 0),a([se({LineSymbol3D:"line-3d"},{readOnly:!0})],Xs.prototype,"type",void 0),Xs=_0=a([b("esri.symbols.LineSymbol3D")],Xs);var S0;const dj=H.ofType({base:null,key:"type",typeMap:{fill:Gr}});let Po=S0=class extends ci{constructor(t){super(t),this.symbolLayers=new dj,this.type="mesh-3d"}clone(){return new S0({styleOrigin:E(this.styleOrigin),symbolLayers:E(this.symbolLayers),thumbnail:E(this.thumbnail)})}static fromSimpleFillSymbol(t){return new S0({symbolLayers:new H([Gr.fromSimpleFillSymbol(t)])})}};a([c({type:dj})],Po.prototype,"symbolLayers",void 0),a([se({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],Po.prototype,"type",void 0),Po=S0=a([b("esri.symbols.MeshSymbol3D")],Po);let uf=class extends St{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};a([se({esriSLS:"simple-line"},{readOnly:!0})],uf.prototype,"type",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],uf.prototype,"width",void 0),uf=a([b("esri.symbols.LineSymbol")],uf);var V2;let hn=V2=class extends F{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,r,i){e[r]=i?.origin==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t?.[0]!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,r,i){i?.origin==="web-map"||(e[r]=t)}clone(){return new V2({color:E(this.color),placement:this.placement,style:this.style})}hash(){return`${this.placement}.${this.color?.hash()}.${this.style}`}};a([c({type:["begin","end","begin-end"],json:{write:!0}})],hn.prototype,"placement",void 0),a([se({"line-marker":"line-marker"},{readOnly:!0}),c({json:{origins:{"web-map":{write:!1}}}})],hn.prototype,"type",void 0),a([c({type:rj})],hn.prototype,"style",void 0),a([q("style")],hn.prototype,"writeStyle",null),a([c({type:ue,value:null,json:{write:{allowNull:!0}}})],hn.prototype,"color",null),a([V("color")],hn.prototype,"readColor",null),a([q("color")],hn.prototype,"writeColor",null),hn=V2=a([b("esri.symbols.LineSymbolMarker")],hn);const Qie=hn;var z2;const gb=new $e({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let bt=z2=class extends uf{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,r,i,s,n){if(t&&typeof t!="string")return t;const o={};return t!=null&&(o.style=t),e!=null&&(o.color=e),r!=null&&(o.width=Me(r)),i!=null&&(o.cap=i),s!=null&&(o.join=s),n!=null&&(o.miterLimit=Me(n)),o}clone(){return new z2({color:E(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:this.marker?.clone()})}hash(){return`${super.hash()}.${this.color?.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${this.marker?.hash()}`}};a([se({esriSLS:"simple-line"},{readOnly:!0})],bt.prototype,"type",void 0),a([c({type:gb.apiValues,json:{read:gb.read,write:gb.write}})],bt.prototype,"style",void 0),a([c({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,r)=>({enabled:t!=="round"&&r?.origin==null})}}})],bt.prototype,"cap",void 0),a([c({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,r)=>({enabled:t!=="round"&&r?.origin==null})}}})],bt.prototype,"join",void 0),a([c({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":Qie}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],bt.prototype,"marker",void 0),a([c({type:Number,json:{read:!1,write:!1}})],bt.prototype,"miterLimit",void 0),bt=z2=a([b("esri.symbols.SimpleLineSymbol")],bt);let gd=class extends St{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline?.hash()}`}};a([c({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":bt}},json:{default:null,write:!0}})],gd.prototype,"outline",void 0),a([c({type:["simple-fill","picture-fill"],readOnly:!0})],gd.prototype,"type",void 0),gd=a([b("esri.symbols.FillSymbol")],gd);function Xie(t,e,r){return e.imageData?fR({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):hj(e.url,r)}function hj(t,e){if(!gi(t)){const r=tse(e);if(r)return Mu(r,"images",t)}return Gu(t,e)}function ese(t,e,r,i){if(Uu(t)){const s=gh(t);if(!s)return;e.contentType=s.mediaType,e.imageData=s.data,r&&r.imageData===e.imageData&&r.url&&Eu(r.url,e,"url",i)}else Eu(t,e,"url",i)}const pj={json:{read:{source:["imageData","url"],reader:Xie},write:{writer(t,e,r,i){ese(t,e,this.source,i)}}}},fj={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,r){const i={};return e.imageData&&(i.imageData=e.imageData),e.contentType&&(i.contentType=e.contentType),e.url&&(i.url=hj(e.url,r)),i}}}};function tse(t){if(!t)return null;const{origin:e,layer:r}=t;if(e!=="service"&&e!=="portal-item")return null;const i=r?.type;return i==="feature"||i==="stream"?r.parsedUrl?.path:i==="map-image"||i==="tile"?t.url?.path:null}var U2;let li=U2=class extends gd{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,r,i){if(t&&typeof t!="string"&&t.imageData==null)return t;const s={};return t&&(s.url=t),e&&(s.outline=e),r!=null&&(s.width=Me(r)),i!=null&&(s.height=Me(i)),s}clone(){const t=new U2({color:E(this.color),height:this.height,outline:E(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",E(this.source)),t}hash(){return`${super.hash()}.${this.color?.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};a([se({esriPFS:"picture-fill"},{readOnly:!0})],li.prototype,"type",void 0),a([c(pj)],li.prototype,"url",void 0),a([c({type:Number,json:{write:!0}})],li.prototype,"xscale",void 0),a([c({type:Number,json:{write:!0}})],li.prototype,"yscale",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],li.prototype,"width",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],li.prototype,"height",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],li.prototype,"xoffset",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],li.prototype,"yoffset",void 0),a([c(fj)],li.prototype,"source",void 0),li=U2=a([b("esri.symbols.PictureFillSymbol")],li);let vo=class extends St{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};a([c({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],vo.prototype,"angle",void 0),a([c({type:["simple-marker","picture-marker"],readOnly:!0})],vo.prototype,"type",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],vo.prototype,"xoffset",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],vo.prototype,"yoffset",void 0),a([c({cast:t=>t==="auto"?t:Hr(Me(t)),json:{write:!0}})],vo.prototype,"size",void 0),vo=a([b("esri.symbols.MarkerSymbol")],vo);var q2;let Sr=q2=class extends vo{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,r){if(t&&typeof t!="string"&&t.imageData==null)return t;const i={};return t&&(i.url=t),e!=null&&(i.width=Me(e)),r!=null&&(i.height=Me(r)),i}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new q2({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",E(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};a([c({json:{write:!1}})],Sr.prototype,"color",void 0),a([se({esriPMS:"picture-marker"},{readOnly:!0})],Sr.prototype,"type",void 0),a([c(pj)],Sr.prototype,"url",void 0),a([c(fj)],Sr.prototype,"source",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],Sr.prototype,"height",void 0),a([V("height",["height","size"])],Sr.prototype,"readHeight",null),a([c({type:Number,cast:Me,json:{write:!0}})],Sr.prototype,"width",void 0),a([c({json:{write:!1}})],Sr.prototype,"size",void 0),Sr=q2=a([b("esri.symbols.PictureMarkerSymbol")],Sr);var Fl;const mj=H.ofType({base:null,key:"type",typeMap:{icon:ir,object:tr,text:Pt}});let Wr=Fl=class extends ci{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new mj,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return aj(this)}hasVisibleVerticalOffset(){return GM(this)}clone(){return new Fl({verticalOffset:E(this.verticalOffset),callout:E(this.callout),styleOrigin:E(this.styleOrigin),symbolLayers:E(this.symbolLayers),thumbnail:E(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new Fl({symbolLayers:new H([ir.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new Fl({symbolLayers:new H([ir.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){if(t.data?.symbol?.type!=="CIMPointSymbol")return null;const r=t.data.symbol;return new Fl(r?.callout?{symbolLayers:new H([ir.fromCIMSymbol(t)]),callout:new go({size:.5,color:new ue([0,0,0])}),verticalOffset:new Ia({screenLength:40})}:{symbolLayers:new H([ir.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new Fl({symbolLayers:new H([Pt.fromTextSymbol(t)])})}};a([c({type:Ia,json:{write:!0}})],Wr.prototype,"verticalOffset",void 0),a([c(lj)],Wr.prototype,"callout",void 0),a([c({type:mj,json:{origins:{"web-scene":{write:!0}}}})],Wr.prototype,"symbolLayers",void 0),a([se({PointSymbol3D:"point-3d"},{readOnly:!0})],Wr.prototype,"type",void 0),Wr=Fl=a([b("esri.symbols.PointSymbol3D")],Wr);var cf;const yj=H.ofType({base:null,key:"type",typeMap:{extrude:mo,fill:Gr,icon:ir,line:qr,object:tr,text:Pt,water:yo}});let hs=cf=class extends ci{constructor(t){super(t),this.symbolLayers=new yj,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&Vo(L.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&Vo(L.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(Fu(()=>this.symbolLayers,"after-add",({item:e})=>t(e),jn))}clone(){return new cf({styleOrigin:E(this.styleOrigin),symbolLayers:E(this.symbolLayers),thumbnail:E(this.thumbnail)})}static fromJSON(t){const e=new cf;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const r=e.symbolLayers.at(0),i=e.symbolLayers.at(1);!i.enabled||t.symbolLayers?.[1]&&t.symbolLayers[1].enable===!1||(r.outline={size:i.size,color:i.material!=null?i.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new cf({symbolLayers:new H([Gr.fromSimpleFillSymbol(t)])})}};a([c({type:yj,json:{write:!0}})],hs.prototype,"symbolLayers",void 0),a([se({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],hs.prototype,"type",void 0),hs=cf=a([b("esri.symbols.PolygonSymbol3D")],hs);var G2;const vb=new $e({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let fi=G2=class extends gd{constructor(...t){super(...t),this.color=new ue([0,0,0,.25]),this.outline=new bt,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,r){if(t&&typeof t!="string")return t;const i={};return t&&(i.style=t),e&&(i.outline=e),r&&(i.color=r),i}clone(){return new G2({color:E(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};a([c()],fi.prototype,"color",void 0),a([c()],fi.prototype,"outline",void 0),a([se({esriSFS:"simple-fill"},{readOnly:!0})],fi.prototype,"type",void 0),a([c({type:vb.apiValues,json:{read:vb.read,write:vb.write}})],fi.prototype,"style",void 0),fi=G2=a([b("esri.symbols.SimpleFillSymbol")],fi);var B2;const wb=new $e({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Gt=B2=class extends vo{constructor(...t){super(...t),this.color=new ue([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new bt}normalizeCtorArgs(t,e,r,i){if(t&&typeof t!="string")return t;const s={};return t&&(s.style=t),e!=null&&(s.size=Me(e)),r&&(s.outline=r),i&&(s.color=i),s}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new B2({angle:this.angle,color:E(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${this.outline?.hash()}`}};a([c()],Gt.prototype,"color",void 0),a([q("color")],Gt.prototype,"writeColor",null),a([se({esriSMS:"simple-marker"},{readOnly:!0})],Gt.prototype,"type",void 0),a([c()],Gt.prototype,"size",void 0),a([c({type:wb.apiValues,json:{read:wb.read,write:wb.write}})],Gt.prototype,"style",void 0),a([c({type:String,json:{write:!0}})],Gt.prototype,"path",null),a([c({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":bt}},json:{default:null,write:!0}})],Gt.prototype,"outline",void 0),Gt=B2=a([b("esri.symbols.SimpleMarkerSymbol")],Gt);var H2;let Le=H2=class extends St{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new is,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,r){if(t&&typeof t!="string")return t;const i={};return t&&(i.text=t),e&&(i.font=e),r&&(i.color=r),i}writeLineWidth(t,e,r,i){i&&typeof i!="string"?i.origin:e[r]=t}castLineWidth(t){return Me(t)}writeLineHeight(t,e,r,i){i&&typeof i!="string"?i.origin:e[r]=t}clone(){return new H2({angle:this.angle,backgroundColor:E(this.backgroundColor),borderLineColor:E(this.borderLineColor),borderLineSize:this.borderLineSize,color:E(this.color),font:this.font&&this.font.clone(),haloColor:E(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor?.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color?.hash()}.${this.font&&this.font.hash()}.${this.haloColor?.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};a([c({type:ue,json:{write:!0}})],Le.prototype,"backgroundColor",void 0),a([c({type:ue,json:{write:!0}})],Le.prototype,"borderLineColor",void 0),a([c({type:Number,json:{write:!0},cast:Me})],Le.prototype,"borderLineSize",void 0),a([c({type:is,json:{write:!0}})],Le.prototype,"font",void 0),a([c({...sj,json:{write:!0}})],Le.prototype,"horizontalAlignment",void 0),a([c({type:Boolean,json:{write:!0}})],Le.prototype,"kerning",void 0),a([c({type:ue,json:{write:!0}})],Le.prototype,"haloColor",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],Le.prototype,"haloSize",void 0),a([c({type:Boolean,json:{write:!0}})],Le.prototype,"rightToLeft",void 0),a([c({type:Boolean,json:{write:!0}})],Le.prototype,"rotated",void 0),a([c({type:String,json:{write:!0}})],Le.prototype,"text",void 0),a([se({esriTS:"text"},{readOnly:!0})],Le.prototype,"type",void 0),a([c({...nj,json:{write:!0}})],Le.prototype,"verticalAlignment",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],Le.prototype,"xoffset",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],Le.prototype,"yoffset",void 0),a([c({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Le.prototype,"angle",void 0),a([c({type:Number,json:{write:!0}})],Le.prototype,"width",void 0),a([c({type:Number})],Le.prototype,"lineWidth",void 0),a([q("lineWidth")],Le.prototype,"writeLineWidth",null),a([Ce("lineWidth")],Le.prototype,"castLineWidth",null),a([c(ij)],Le.prototype,"lineHeight",void 0),a([q("lineHeight")],Le.prototype,"writeLineHeight",null),Le=H2=a([b("esri.symbols.TextSymbol")],Le);var W2;let hr=W2=class extends St{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:j.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e?.portal,super.read(t,e)}clone(){return new W2({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol(t)}async fetchCIMSymbol(t){VR(L.getLogger(this),"WebStyleSymbol.fetchCIMSymbol is deprecated in favour of WebStyleSymbol.fetchSymbol which now supports both web and cim symbology",{version:"4.33",replacement:"WebStyleSymbol.fetchSymbol",see:"https://arcg.is/0CXPTr#fetchSymbol",warnOnce:!0});const e=await this._fetchSymbol({...t,acceptedFormats:["cim"]});if(e?.type!=="cim")throw new x("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return e}async _fetchSymbol(t){const e=t!=null?t.cache:null,r=e?this._fetchCacheKey:null;if(e!=null){const o=r&&e.get(r);if(o)return o.clone()}const{resolveWebStyleSymbol:i}=await N(()=>import("./webStyleSymbolUtils-B093fbCp.js"),__vite__mapDeps([192,193]));We(t);const s=i(this,{portal:this.portal},t);s.catch(o=>{L.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",o)});const n=await s;return e?.set(r,n.clone()),n}};a([c({json:{write:!1}})],hr.prototype,"color",void 0),a([c({type:String,json:{write:!0}})],hr.prototype,"styleName",void 0),a([c({type:j,json:{write:!1}})],hr.prototype,"portal",void 0),a([c({type:String,json:{read:vw,write:Eu}})],hr.prototype,"styleUrl",void 0),a([c({type:im,json:{read:!1}})],hr.prototype,"thumbnail",void 0),a([c({type:String,json:{write:!0}})],hr.prototype,"name",void 0),a([se({styleSymbolReference:"web-style"},{readOnly:!0})],hr.prototype,"type",void 0),a([c()],hr.prototype,"_fetchCacheKey",null),hr=W2=a([b("esri.symbols.WebStyleSymbol")],hr);function K$e(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function gj(t){switch(t?.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const Fa={base:St,key:"type",typeMap:{"simple-fill":fi,"picture-fill":li,"picture-marker":Sr,"simple-line":bt,"simple-marker":Gt,text:Le,"label-3d":Us,"line-3d":Xs,"mesh-3d":Po,"point-3d":Wr,"polygon-3d":hs,"web-style":hr,cim:Er},errorContext:"symbol"},Q$e={base:St,key:"type",typeMap:{"picture-marker":Sr,"simple-marker":Gt,"point-3d":Wr,cim:Er},errorContext:"symbol"},X$e={base:St,key:"type",typeMap:{"simple-line":bt,"line-3d":Xs,cim:Er},errorContext:"symbol"},exe={base:St,key:"type",typeMap:{"simple-fill":fi,"picture-fill":li,"polygon-3d":hs,cim:Er},errorContext:"symbol"},rse={base:St,key:"type",typeMap:{"picture-marker":Sr,"simple-marker":Gt,text:Le,"web-style":hr,cim:Er},errorContext:"symbol"},ise=Jh({types:Fa}),vj={base:St,key:"type",typeMap:{"simple-fill":fi,"picture-fill":li,"picture-marker":Sr,"simple-line":bt,"simple-marker":Gt,text:Le,"line-3d":Xs,"mesh-3d":Po,"point-3d":Wr,"polygon-3d":hs,"web-style":hr,cim:Er},errorContext:"symbol"},sse={base:St,key:"type",typeMap:{text:Le,"label-3d":Us},errorContext:"symbol"},lk={base:St,key:"type",typeMap:{"line-3d":Xs,"mesh-3d":Po,"point-3d":Wr,"polygon-3d":hs,"web-style":hr,cim:Er},errorContext:"symbol"},nse={base:St,key:"type",typeMap:{"label-3d":Us},errorContext:"symbol"},wj=Nn(Fa);var Z2;function ose(t){if(!t)return null;const e={};for(const r in t){const i=tl(t[r]);i&&(e[r]=i)}return Object.keys(e).length!==0?e:null}function ase(t){if(t==null)return null;const e={};for(const r in t){const i=t[r];i&&(e[r]=i.toJSON())}return Object.keys(e).length!==0?e:null}var eh;let nt=(eh=class extends pe(F){constructor(e){super(e),this.isAggregate=!1,this.layer=null,this.origin=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:Rg(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&K7(L.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(e){const r=this._get("aggregateGeometries");JSON.stringify(r)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const r=this._get("attributes");r!==e&&(this._set("attributes",e),this._notifyLayer("attributes",r,e))}set geometry(e){const r=this._get("geometry");r!==e&&(this._set("geometry",e),e?.type!=="mesh"&&this._notifyLayer("geometry",r,e))}set popupTemplate(e){const r=this._get("popupTemplate");r!==e&&(this._set("popupTemplate",e),this._notifyLayer("popupTemplate",r,e))}set symbol(e){const r=this._get("symbol");r!==e&&(this._set("symbol",e),this._notifyLayer("symbol",r,e))}get version(){return this._version}set visible(e){const r=this._get("visible");r!==e&&(this._set("visible",e),this._notifyLayer("visible",r,e))}cloneShallow(){return new Z2({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const r=mie(this.origin);if(r)return r.popupTemplate??(e?r.defaultPopupTemplate:null)??null;const i=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const s of[i,this.sourceLayer,this.layer])if(s&&typeof s=="object"){if("popupTemplate"in s&&s.popupTemplate)return s.popupTemplate;if(e&&"defaultPopupTemplate"in s&&s.defaultPopupTemplate!=null)return s.defaultPopupTemplate}return null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,r){if(this.attributes){const i=this.getAttribute(e);this.attributes[e]=r,this._notifyLayer("attributes",i,r,e)}else this.attributes={[e]:r}}getObjectId(){const e=rk(this.origin);if(e)return ik(this,e);const r=this.sourceLayer??this.layer;return r?ik(this,r):null}getGlobalId(){const e=rk(this.origin);if(e?.globalIdField)return this.getAttribute(e.globalIdField);const r=this.sourceLayer??this.layer;return r&&"globalIdField"in r&&r.globalIdField?this.getAttribute(r.globalIdField):null}toJSON(){return{aggregateGeometries:ase(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:gm(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(e={}){const{geometry:r}=this;if(r?.type==="mesh"){const i={origin:r.origin,transform:r.transform};this._notifyLayer("origin-transform",i,i,e.action)}}_notifyLayer(e,r,i,s){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:e,oldValue:r,newValue:i};e==="origin-transform"&&(n.action=s),e==="attributes"&&(n.attributeName=s),this.layer.graphicChanged(n)}_watchMeshGeometryChanges(){this.addHandles([Gi(()=>this.geometry?.type==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0,({localMatrix:e,origin:r})=>{this._lastMeshTransform.localMatrix===e&&this._lastMeshTransform.origin===r||(this._lastMeshTransform.localMatrix=e,this._lastMeshTransform.origin=r,this.notifyMeshTransformChanged())}),Gi(()=>this.geometry?.type==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0,()=>{const e=this.geometry;e?.type==="mesh"&&e.vertexSpace.origin?(this._lastMeshTransform.localMatrix=e.transform?.localMatrix,this._lastMeshTransform.origin=e.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(e,r)=>e===r,sync:!0})])}},Z2=eh,eh);a([c({value:null,json:{read:ose}})],nt.prototype,"aggregateGeometries",null),a([c({value:null})],nt.prototype,"attributes",null),a([c({value:null,types:hy,json:{read:tl}})],nt.prototype,"geometry",null),a([c({type:Boolean})],nt.prototype,"isAggregate",void 0),a([c({clonable:!1})],nt.prototype,"layer",void 0),a([c({clonable:"reference"})],nt.prototype,"origin",void 0),a([c({type:Vn,value:null})],nt.prototype,"popupTemplate",null),a([c({clonable:"reference"})],nt.prototype,"sourceLayer",void 0),a([c({value:null,types:Fa})],nt.prototype,"symbol",null),a([c({clonable:!1,json:{read:!1,write:!1}})],nt.prototype,"_version",void 0),a([c({type:Boolean,value:!0})],nt.prototype,"visible",null),nt=Z2=a([b("esri.Graphic")],nt);let sm=class extends Zf{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};a([CT({Type:nt,ensureType:ct(nt)})],sm.prototype,"itemType",void 0),sm=a([b("esri.support.GraphicsCollection")],sm);let ro=class extends X{constructor(e){super(e),this.view=null,this.baseLayerViews=new H,this.groundLayerViews=new H,this.referenceLayerViews=new H,this._loadingHandle=ne(()=>this.view?.map?.basemap,r=>{r&&r.load().catch(()=>{})},Ot)}destroy(){this._set("view",null),this._loadingHandle=He(this._loadingHandle),this.baseLayerViews.destroyAll(),this.groundLayerViews.destroyAll(),this.referenceLayerViews.destroyAll()}get suspended(){return this.view?.suspended??!0}get updating(){return this.view?.suspended?!1:!!this.view?.map?.basemap?.loaded&&(this.baseLayerViews.some(r=>r.updating)||this.groundLayerViews.some(r=>r.updating)||this.referenceLayerViews.some(r=>r.updating))}};a([c({constructOnly:!0})],ro.prototype,"view",void 0),a([c({readOnly:!0})],ro.prototype,"baseLayerViews",void 0),a([c({readOnly:!0})],ro.prototype,"groundLayerViews",void 0),a([c({readOnly:!0})],ro.prototype,"referenceLayerViews",void 0),a([c({readOnly:!0})],ro.prototype,"suspended",null),a([c({type:Boolean,readOnly:!0})],ro.prototype,"updating",null),ro=a([b("esri.views.BasemapView")],ro);const lse=ro;let Mi=class extends X{constructor(e){super(e),this.factor=1.5,this.offset=Bt(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};a([c({type:Number})],Mi.prototype,"factor",void 0),a([c({nonNullable:!0})],Mi.prototype,"offset",void 0),a([c()],Mi.prototype,"position",void 0),a([c({type:Number,range:{min:0}})],Mi.prototype,"size",void 0),a([c()],Mi.prototype,"maskUrl",void 0),a([c()],Mi.prototype,"maskEnabled",void 0),a([c()],Mi.prototype,"overlayUrl",void 0),a([c()],Mi.prototype,"overlayEnabled",void 0),a([c({readOnly:!0})],Mi.prototype,"version",null),a([c({type:Boolean})],Mi.prototype,"visible",void 0),Mi=a([b("esri.views.Magnifier")],Mi);const bj=Mi;let Dd=class{constructor(e){this._observable=new ty,this._map=new Map(e)}get size(){return le(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const r=this._map.delete(e);return r&&this._observable.notify(),r}entries(){return le(this._observable),this._map.entries()}forEach(e,r){le(this._observable),this._map.forEach((i,s)=>e.call(r,i,s,this),r)}get(e){return le(this._observable),this._map.get(e)}has(e){return le(this._observable),this._map.has(e)}keys(){return le(this._observable),this._map.keys()}set(e,r){return this._map.set(e,r),this._observable.notify(),this}values(){return le(this._observable),this._map.values()}[Symbol.iterator](){return le(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};var J2;let ou=J2=class extends F{constructor(t){super(t),this.name=null,this.code=null}clone(){return new J2({name:this.name,code:this.code})}};a([c({type:String,json:{write:{isRequired:!0}}})],ou.prototype,"name",void 0),a([c({type:[String,Number],json:{write:{isRequired:!0}}})],ou.prototype,"code",void 0),ou=J2=a([b("esri.layers.support.CodedValue")],ou);const use=new $e({inherited:"inherited",codedValue:"coded-value",range:"range"});let Na=class extends F{constructor(e){super(e),this.name=null,this.type=null}};a([c({type:String,json:{write:!0}})],Na.prototype,"name",void 0),a([se(use),c({json:{write:{isRequired:!0}}})],Na.prototype,"type",void 0),Na=a([b("esri.layers.support.Domain")],Na);var Y2,th;let Da=(th=class extends Na{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let r=null;if(this.codedValues){const i=String(e);this.codedValues.some(s=>(String(s.code)===i&&(r=s.name),!!r))}return r}clone(){return new Y2({codedValues:E(this.codedValues),name:this.name})}},Y2=th,th);a([c({type:[ou],json:{write:{isRequired:!0}}})],Da.prototype,"codedValues",void 0),a([se({codedValue:"coded-value"})],Da.prototype,"type",void 0),Da=Y2=a([b("esri.layers.support.CodedValueDomain")],Da);var K2,rh;let nm=(rh=class extends Na{constructor(e){super(e),this.type="inherited"}clone(){return new K2}},K2=rh,rh);a([se({inherited:"inherited"})],nm.prototype,"type",void 0),nm=K2=a([b("esri.layers.support.InheritedDomain")],nm);var Q2,ih;let Yl=(ih=class extends Na{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new Q2({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}},Q2=ih,ih);a([c({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,r){e[r]=[this.minValue||0,t]},isRequired:!0}}})],Yl.prototype,"maxValue",void 0),a([c({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[0]},write:{target:"range",writer(t,e,r){e[r]=[t,this.maxValue||0]},isRequired:!0}}})],Yl.prototype,"minValue",void 0),a([se({range:"range"})],Yl.prototype,"type",void 0),Yl=Q2=a([b("esri.layers.support.RangeDomain")],Yl);const _j={key:"type",base:Na,typeMap:{range:Yl,"coded-value":Da,inherited:nm}};function i1(t){if(!t?.type)return null;switch(t.type){case"range":return Yl.fromJSON(t);case"codedValue":return Da.fromJSON(t);case"inherited":return nm.fromJSON(t)}return null}const cse=new $e({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var X2;const dse=new $e({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",currency:"currency",dateAndTime:"date-and-time",description:"description",emailAddress:"email-address",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",phoneNumber:"phone-number",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});var sh;let rr=(sh=class extends F{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:r}){let i=null;try{i=r?JSON.parse(r):null}catch{}return i?.value??null}readValueType(e,{description:r}){let i=null;try{i=r?JSON.parse(r):null}catch{}return i?dse.fromJSON(i.fieldValueType):null}clone(){return new X2({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}},X2=sh,sh);a([c({type:String,json:{write:!0}})],rr.prototype,"alias",void 0),a([c({type:[String,Number],json:{write:{allowNull:!0}}})],rr.prototype,"defaultValue",void 0),a([c()],rr.prototype,"description",void 0),a([V("description")],rr.prototype,"readDescription",null),a([c({types:_j,json:{read:{reader:i1},write:!0}})],rr.prototype,"domain",void 0),a([c({type:Boolean,json:{write:!0}})],rr.prototype,"editable",void 0),a([c({type:xe,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],rr.prototype,"length",void 0),a([c({type:String,json:{write:!0}})],rr.prototype,"name",void 0),a([c({type:Boolean,json:{write:!0}})],rr.prototype,"nullable",void 0),a([se(cse)],rr.prototype,"type",void 0),a([c()],rr.prototype,"valueType",void 0),a([V("valueType",["description"])],rr.prototype,"readValueType",null),a([c({type:Boolean,json:{read:!1}})],rr.prototype,"visible",void 0),rr=X2=a([b("esri.layers.support.Field")],rr);var e$;let kc=e$=class extends F{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new e$({mapLayerId:t,gdbVersion:e})}};a([se({mapLayer:"map-layer"}),c({json:{write:{isRequired:!0}}})],kc.prototype,"type",void 0),a([c({type:xe,json:{write:{isRequired:!0}}})],kc.prototype,"mapLayerId",void 0),a([c({type:String,json:{write:!0}})],kc.prototype,"gdbVersion",void 0),kc=e$=a([b("esri.layers.support.source.MapLayerSource")],kc);var t$;let io=t$=class extends F{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:r,spatialReference:i,geometryType:s}=this,n={workspaceId:t,query:e,oidFields:r,spatialReference:i?.clone()??void 0,geometryType:s};return new t$(n)}};a([se({queryTable:"query-table"}),c({json:{write:{isRequired:!0}}})],io.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],io.prototype,"workspaceId",void 0),a([c({type:String,json:{write:!0}})],io.prototype,"query",void 0),a([c({type:String,json:{write:!0}})],io.prototype,"oidFields",void 0),a([c({type:Z,json:{write:!0}})],io.prototype,"spatialReference",void 0),a([se(zX)],io.prototype,"geometryType",void 0),io=t$=a([b("esri.layers.support.source.QueryTableDataSource")],io);var r$;let Cc=r$=class extends F{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new r$({workspaceId:t,dataSourceName:e})}};a([se({raster:"raster"}),c({json:{write:{isRequired:!0}}})],Cc.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],Cc.prototype,"dataSourceName",void 0),a([c({type:String,json:{write:!0}})],Cc.prototype,"workspaceId",void 0),Cc=r$=a([b("esri.layers.support.source.RasterDataSource")],Cc);var i$;let Nl=i$=class extends F{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:r}=this;return new i$({workspaceId:t,gdbVersion:e,dataSourceName:r})}};a([se({table:"table"}),c({json:{write:{isRequired:!0}}})],Nl.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],Nl.prototype,"workspaceId",void 0),a([c({type:String,json:{write:!0}})],Nl.prototype,"gdbVersion",void 0),a([c({type:String,json:{write:!0}})],Nl.prototype,"dataSourceName",void 0),Nl=i$=a([b("esri.layers.support.source.TableDataSource")],Nl);var s$,n$;const hse=Ft()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let Ii=s$=class extends F{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,r){return uk()(t,e,r)}castLeftTableSource(t){return Nn(o$(),t)}readRightTableSource(t,e,r){return uk()(t,e,r)}castRightTableSource(t){return Nn(o$(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:r,rightTableSource:i,joinType:s}=this,n={leftTableKey:t,rightTableKey:e,leftTableSource:r?.clone()??void 0,rightTableSource:i?.clone()??void 0,joinType:s};return new s$(n)}};a([se({joinTable:"join-table"}),c({json:{write:{isRequired:!0}}})],Ii.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],Ii.prototype,"leftTableKey",void 0),a([c({type:String,json:{write:!0}})],Ii.prototype,"rightTableKey",void 0),a([c({json:{write:!0}})],Ii.prototype,"leftTableSource",void 0),a([V("leftTableSource")],Ii.prototype,"readLeftTableSource",null),a([Ce("leftTableSource")],Ii.prototype,"castLeftTableSource",null),a([c({json:{write:!0}})],Ii.prototype,"rightTableSource",void 0),a([V("rightTableSource")],Ii.prototype,"readRightTableSource",null),a([Ce("rightTableSource")],Ii.prototype,"castRightTableSource",null),a([se(hse)],Ii.prototype,"joinType",void 0),Ii=s$=a([b("esri.layers.support.source.JoinTableDataSource")],Ii);let bb=null;function uk(){return bb||(bb=Jh({types:o$()})),bb}let _b=null;function o$(){return _b||(_b={key:"type",base:null,typeMap:{"data-layer":qs,"map-layer":kc}}),_b}const pse={key:"type",base:null,typeMap:{"join-table":Ii,"query-table":io,raster:Cc,table:Nl}};var nh;let qs=(nh=class extends F{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:r}=this;return new n$({fields:e,dataSource:r})}},n$=nh,nh);a([se({dataLayer:"data-layer"}),c({json:{write:{isRequired:!0}}})],qs.prototype,"type",void 0),a([c({type:[rr],json:{write:!0}})],qs.prototype,"fields",void 0),a([c({types:pse,json:{write:!0}})],qs.prototype,"dataSource",void 0),qs=n$=a([b("esri.layers.support.source.DataLayerSource")],qs),qs.from=ct(qs);let Dl=class extends pe(F){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};a([c({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],Dl.prototype,"onFields",void 0),a([c({type:String,json:{write:!0}})],Dl.prototype,"operator",void 0),a([c({type:String,json:{write:!0}})],Dl.prototype,"searchTerm",void 0),a([c({type:String,json:{write:!0}})],Dl.prototype,"searchType",void 0),Dl=a([b("esri.rest.support.FullTextSearch")],Dl);const Sj=Dl;var a$;const ck=new $e({upperLeft:"upper-left",lowerLeft:"lower-left"});let _a=a$=class extends F{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new a$(E({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};a([c({type:he,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],_a.prototype,"extent",void 0),a([c({type:["view","edit"],json:{write:!0}})],_a.prototype,"mode",void 0),a([c({type:String,json:{read:ck.read,write:ck.write}})],_a.prototype,"originPosition",void 0),a([c({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],_a.prototype,"tolerance",void 0),_a=a$=a([b("esri.rest.support.QuantizationParameters")],_a);const fse=t=>{const e=t;let r=class extends e{};return r=a([b("esri.rest.support.QueryMixin")],r),r},mse=new $e({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var l$;const dk=new $e({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let Rs=l$=class extends F{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=E(t))}clone(){return new l$({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:E(this.statisticParameters)})}};a([c({type:Number,json:{write:!0}})],Rs.prototype,"maxPointCount",void 0),a([c({type:Number,json:{write:!0}})],Rs.prototype,"maxRecordCount",void 0),a([c({type:Number,json:{write:!0}})],Rs.prototype,"maxVertexCount",void 0),a([c({type:String,json:{write:!0}})],Rs.prototype,"onStatisticField",void 0),a([c({type:String,json:{write:!0}})],Rs.prototype,"outStatisticFieldName",void 0),a([c({type:String,json:{read:{source:"statisticType",reader:dk.read},write:{target:"statisticType",writer:dk.write}}})],Rs.prototype,"statisticType",void 0),a([c({type:Object})],Rs.prototype,"statisticParameters",void 0),a([q("statisticParameters")],Rs.prototype,"writeStatisticParameters",null),Rs=l$=a([b("esri.rest.support.StatisticDefinition")],Rs);var $0;const yse=new $e({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});var Su;let re=(Su=class extends fse(F){static from(e){return Zh($0,e)}constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.returnTrueCurves=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(e){return typeof e=="number"||typeof e=="object"?e:null}writeHistoricMoment(e,r){r.historicMoment=e&&e.getTime()}writeParameterValues(e,r){if(e){const i={};for(const s in e){const n=e[s];Array.isArray(n)?i[s]=n.map(o=>o instanceof Date?o.getTime():o):n instanceof Date?i[s]=n.getTime():i[s]=n}r.parameterValues=i}}writeStart(e,r){r.resultOffset=this.start,r.resultRecordCount=this.num||10,r.where="1=1"}writeWhere(e,r){r.where=e||"1=1"}clone(){return new $0(E({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,returnTrueCurves:this.returnTrueCurves,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}},$0=Su,Su.MAX_MAX_RECORD_COUNT_FACTOR=5,Su);a([c({json:{write:!0}})],re.prototype,"aggregateIds",void 0),a([c({type:Boolean,json:{write:!0}})],re.prototype,"cacheHint",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"compactGeometryEnabled",void 0),a([c({json:{write:!0}})],re.prototype,"datumTransformation",void 0),a([Ce("datumTransformation")],re.prototype,"castDatumTransformation",null),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"defaultSpatialReferenceEnabled",void 0),a([c({type:Number,json:{write:!0}})],re.prototype,"distance",void 0),a([c({type:qs,json:{write:!0}})],re.prototype,"dynamicDataSource",void 0),a([c({type:String,json:{write:!0}})],re.prototype,"formatOf3DObjects",void 0),a([c({type:[Sj],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],re.prototype,"fullText",void 0),a([c({type:String,json:{write:!0}})],re.prototype,"gdbVersion",void 0),a([c({types:hy,json:{read:tl,write:!0}})],re.prototype,"geometry",void 0),a([c({type:Number,json:{write:!0}})],re.prototype,"geometryPrecision",void 0),a([c({type:[String],json:{write:!0}})],re.prototype,"groupByFieldsForStatistics",void 0),a([c({type:String,json:{write:!0}})],re.prototype,"having",void 0),a([c({type:Date})],re.prototype,"historicMoment",void 0),a([q("historicMoment")],re.prototype,"writeHistoricMoment",null),a([c({type:Number,json:{write:!0}})],re.prototype,"maxAllowableOffset",void 0),a([c({type:Number,cast:t=>t<1?1:t>re.MAX_MAX_RECORD_COUNT_FACTOR?re.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],re.prototype,"maxRecordCountFactor",void 0),a([c({type:["xyFootprint"],json:{write:!0}})],re.prototype,"multipatchOption",void 0),a([c({type:Number,json:{read:{source:"resultRecordCount"}}})],re.prototype,"num",void 0),a([c({json:{write:!0}})],re.prototype,"objectIds",void 0),a([c({type:[String],json:{write:!0}})],re.prototype,"orderByFields",void 0),a([c({type:[String],json:{write:!0}})],re.prototype,"outFields",void 0),a([c({type:Z,json:{name:"outSR",write:!0}})],re.prototype,"outSpatialReference",void 0),a([c({type:[Rs],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],re.prototype,"outStatistics",void 0),a([c({json:{write:!0}})],re.prototype,"parameterValues",void 0),a([q("parameterValues")],re.prototype,"writeParameterValues",null),a([c({type:ee,json:{write:!0}})],re.prototype,"pixelSize",void 0),a([c({type:_a,json:{write:!0}})],re.prototype,"quantizationParameters",void 0),a([c({type:[Object],json:{write:!0}})],re.prototype,"rangeValues",void 0),a([c({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],re.prototype,"relationParameter",void 0),a([c({type:String,json:{write:!0}})],re.prototype,"resultType",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"returnCentroid",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"returnDistinctValues",void 0),a([c({type:Boolean,json:{default:!0,write:!0}})],re.prototype,"returnExceededLimitFeatures",void 0),a([c({type:Boolean,json:{write:!0}})],re.prototype,"returnGeometry",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"returnQueryGeometry",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"returnM",void 0),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],re.prototype,"returnZ",void 0),a([c({type:Boolean,json:{write:!0}})],re.prototype,"returnTrueCurves",void 0),a([c({type:Z,json:{write:!0}})],re.prototype,"sourceSpatialReference",void 0),a([se(mse,{ignoreUnknown:!1,name:"spatialRel"})],re.prototype,"spatialRelationship",void 0),a([c({type:Number,json:{read:{source:"resultOffset"}}})],re.prototype,"start",void 0),a([q("start"),q("num")],re.prototype,"writeStart",null),a([c({type:String,json:{write:!0}})],re.prototype,"sqlFormat",void 0),a([c({type:String,json:{write:!0}})],re.prototype,"text",void 0),a([c({type:Et,json:{write:!0}})],re.prototype,"timeExtent",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"timeReferenceUnknownClient",void 0),a([se(yse,{ignoreUnknown:!1}),c({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null}}}}})],re.prototype,"units",void 0),a([c({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],re.prototype,"where",void 0),a([q("where")],re.prototype,"writeWhere",null),re=$0=a([b("esri.rest.support.Query")],re);function ia(t){return!(t==null||typeof t!="object"||!("createQuery"in t)||!t.createQuery)}let ts=class extends Yh{constructor(e){super(e),this._selectionMap=new Dd,this._sources=new H,this._trashCan=[],this._layerEditHandles=new H,this._vizTaskId=0,this.view=null,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([ne(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),ne(()=>this.view,e=>{e?.when().then(()=>this.syncSources())},Ot),Fu(()=>this.sources,"change",e=>{const r=this._selectionMap,i=[];for(const s of e.removed){const n=r.get(s);n&&(r.delete(s),n.highlightHandle?.remove(),i.push({layer:s,selection:[],added:[],removed:[...n.selection]}))}this._refreshListeners(),i.length&&this._onSelectionChange(i)},{onListenerAdd:()=>this._refreshListeners()})])}destroy(){this.clear(),this._layerEditHandles.drain(He)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[r,i]=e;return{layer:r,selection:[...i.selection]}})}get count(){let e=0;for(const r of this._selectionMap.values())e+=r.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){Pn(e,this._sources)}syncSources(){const e=new Set,r=this.view?.map;if(!r)return;const i=s=>{QZ(s)?(s.layers?.forEach(i),s.tables?.forEach(i)):KZ(s)?(s.sublayers?.forEach(i),s.subtables?.forEach(i)):GE(s)?s.sublayers?.forEach(i):ia(s)&&e.add(s)};r.allLayers.forEach(i),r.allTables.forEach(i),this.sources=[...e]}async getSelectedFeatures(e,r={},i="layerView"){const{view:s,selections:n}=this;if(!s&&i==="layerView")return L.getLogger(this).warn("Cannot query layer views without a view."),[];const o=(e?.length?n.filter(l=>e.includes(l.layer)):n).map(async l=>{const{layer:u,selection:d}=l;if(!d.length)return;const p=_c(u)?u.parent:u;if(p!=null){if(s&&i==="layerView"&&!hk(p)&&pk(p)){const f=await s.whenLayerView(p).catch(()=>null);if(f)return fk(f,d,r)}return fk(p,d,r)}}).filter(ps);return(await Promise.all(o)).filter(ps)}updateSelection(e){const r=new Map;for(const[n,o]of this._selectionMap)r.set(n,[...o.selection]);let i=!1;const s=e.current.concat(e.added);for(const n of s){const o=n.sourceLayer,l=n.getObjectId();if(this.sources.includes(o)&&(ia(o)||_c(o))&&l!==null){const u=zh(r,o,()=>[]);u.includes(l)||(u.push(l),i=!0)}}for(const n of e.removed){const o=n.sourceLayer,l=n.getObjectId();if(this.sources.includes(o)&&(ia(o)||_c(o))&&l!==null){const u=r.get(o),d=u?.indexOf(l);d!==void 0&&d>=0&&(u?.splice(d,1),i=!0)}}if(i){const{_selectionMap:n,_trashCan:o}=this,l=[];for(const[u,d]of r){const p=n.get(u);p!==void 0&&o.push(p),n.set(u,{selection:d}),l.push({layer:u,selection:d,...eI(p!==void 0?p.selection:[],d)})}this._onSelectionChange(l)}}setSelection(e,r){this._setSelection(e,r)}getSelection(e){return this._selectionMap.get(e)?.selection}appendToSelection(e,r){const i=this._selectionMap.get(e),s=i!==void 0?[...i.selection]:[];for(const n of r)s.includes(n)||s.push(n);this._setSelection(e,s)}removeFromSelection(e,r){const i=this._selectionMap.get(e);if(!i)return;const s=[];for(const n of i.selection)r.includes(n)||s.push(n);this._setSelection(e,s)}toggleInSelection(e,r){const i=this._selectionMap.get(e);if(!i||i.selection.length===0)return void this._setSelection(e,r);const s=new Set(i.selection),n=new Set(r),o=Rq(s,n);this._setSelection(e,Array.from(o))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const r=[];for(const[i,s]of this._selectionMap.entries())r.push({layer:i,added:[],removed:[...s.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(r)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){for(this._vizTaskId++;this._trashCan.length>0;)this._trashCan.pop()?.highlightHandle?.remove();if(this.view==null)return;const{sources:e,view:r,_selectionMap:i,showHighlight:s}=this,n=this._vizTaskId;for(const o of e){const l=i.get(o),u=_c(o)?o.parent:o;if(u!=null&&pk(u)){if(hk(u))continue;r.whenLayerView(u).then(d=>{l?.highlightHandle?.remove(),l!=null&&s&&n===this._vizTaskId&&"highlight"in d&&typeof d.highlight=="function"&&l.selection.length>0&&(l.highlightHandle=d.highlight(l.selection,this.highlightName))}).catch(()=>{l?.highlightHandle?.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(He);const e=new Set(this.sources.map(r=>_c(r)?r.parent:r));for(const r of e)ia(r)&&"on"in r&&r.on&&this._layerEditHandles.push(r.on("edits",i=>this._onLayerEdit(i,r)))}_onLayerEdit(e,r){if(GE(r))this._onParentLayerEdit(e,r);else if(e.deletedFeatures.length&&this._selectionMap.has(r)){const i=[];e.deletedFeatures.forEach(({error:s,objectId:n})=>{n!=null&&s==null&&i.push(n)}),this.removeFromSelection(r,i)}}_onParentLayerEdit(e,r){const{deletedFeatures:i,edits:s,updatedFeatures:n}=e;if(s?.updateFeatures?.forEach(o=>{const l=o.getObjectId()??o.attributes[r.objectIdField];if(l==null||n.find(p=>p.objectId===l)?.error)return;const u=r.findSublayerForFeature(o);if(!ia(u))return;const d=r.sublayers.find(p=>!(!ia(p)||!this.getSelection(p)?.includes(l)));ia(d)&&d!==u&&(this.removeFromSelection(d,[l]),this.appendToSelection(u,[l]))}),i.length){const o=[];i.forEach(({error:l,objectId:u})=>{u!=null&&l==null&&o.push(u)}),r.sublayers.forEach(l=>{ia(l)&&this._selectionMap.has(l)&&this.removeFromSelection(l,o)})}}_setSelection(e,r){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const i=this._selectionMap.get(e);if(i===void 0||!vse(i,{selection:r})){i!==void 0&&this._trashCan.push(i),this._selectionMap.set(e,{selection:[...r]});const s={layer:e,selection:[...r],...eI(i!==void 0?i.selection:[],r)};this._onSelectionChange([s])}}};a([c()],ts.prototype,"_selectionMap",void 0),a([c()],ts.prototype,"_sources",void 0),a([c({readOnly:!0,nonNullable:!0})],ts.prototype,"selections",null),a([c({readOnly:!0,nonNullable:!0})],ts.prototype,"count",null),a([c()],ts.prototype,"view",void 0),a([c({readOnly:!0,nonNullable:!0})],ts.prototype,"hasSelection",null),a([c()],ts.prototype,"showHighlight",void 0),a([c()],ts.prototype,"sources",null),a([c()],ts.prototype,"highlightName",void 0),ts=a([b("esri.views.SelectionManager")],ts);const hk=t=>_c(t)?t.parent?.isTable===!0:t.isTable,gse=t=>t.layer!==void 0,pk=t=>t?.when!==void 0,vse=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const r=[...t.selection],i=[...e.selection];if(r.length!==i.length)return!1;r.sort(),i.sort();for(let s=0;s<r.length;s++)if(r[s]!==i[s])return!1}return!0},fk=async(t,e,r={})=>{let i;if(gse(t)){const s=t;i=s===void 0?null:await s.queryFeatures(new re({...r,objectIds:e})).then(n=>({data:n,layer:t.layer}))}else{const s=t;i=s===void 0?null:await s.queryFeatures(new re({...r,objectIds:e})).then(n=>({data:n,layer:s}))}return i},wse=ts;let df=class extends pe(X){constructor(e){super(e),this.accentColor=new ue([255,127,0]),this.textColor=new ue([255,255,255])}};a([c({type:ue,nonNullable:!0})],df.prototype,"accentColor",void 0),a([c({type:ue,nonNullable:!0})],df.prototype,"textColor",void 0),df=a([b("esri.views.Theme")],df);const u$=df,$j=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],xj={};function Tj(t){return!!xj[t]}function bse(t){for(const e of t)if(!Tj(e))return!1;return!0}$j.forEach(t=>{xj[t]=!0});let Mj=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:r,priority:i},s)=>this.inputManager?.installHandlers(s,[r],i))}disconnect(){this.inputManager&&this._handlers.forEach((e,r)=>this.inputManager?.uninstallHandlers(r)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,r,i,s){const n=Array.isArray(e)?e:e.split(",");if(!bse(n))return n.some(Tj)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,l;Array.isArray(r)?l=r:(o=r,l=[]),typeof i=="function"?o=i:s=i,s=s??No.DEFAULT;const u=this._createUniqueGroupName(),d=new _se(this.view,n,l,o);this._handlers.set(u,{handler:d,priority:s});for(const p of n){const f=this._handlerCounts.get(p)||0;this._handlerCounts.set(p,f+1)}return this.inputManager&&this.inputManager.installHandlers(u,[d],s),Te(()=>this._removeHandler(u,n))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,r){if(this._handlers.has(e)){this._handlers.delete(e);for(const i of r){const s=this._handlerCounts.get(i);s===void 0||(s===1?this._handlerCounts.delete(i):this._handlerCounts.set(i,s-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},_se=class extends Zt{constructor(e,r,i,s){super(!0),this._latestDragStart=void 0,this.view=e;for(const n of r)switch(n){case"click":this.registerIncoming("click",i,o=>s(xse(e,o)));break;case"double-click":this.registerIncoming("double-click",i,o=>s(Tse(e,o)));break;case"immediate-click":this.registerIncoming("immediate-click",i,o=>s(Mse(e,o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,o=>s(Ise(e,o)));break;case"hold":this.registerIncoming("hold",i,o=>s(Ese(e,o)));break;case"drag":this.registerIncoming("drag",i,o=>{const l=this._wrapDrag(o);l&&s(l)});break;case"key-down":this.registerIncoming("key-down",i,o=>s(Ose(o)));break;case"key-up":this.registerIncoming("key-up",i,o=>s(kse(o)));break;case"pointer-down":this.registerIncoming("pointer-down",i,o=>s(Op(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",i,o=>s(Op(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",i,o=>s(Op(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,o=>s(Cse(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,o=>s(Pse(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,o=>s(Op(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,o=>s(Op(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",i,o=>{s(Ase(o))});break;case"focus":this.registerIncoming("focus",i,o=>{s(Sse(o))});break;case"blur":this.registerIncoming("blur",i,o=>{s($se(o))})}}_wrapDrag(e){const r=e.data,{x:i,y:s}=r.center,{action:n,pointerType:o,button:l}=r;if(n==="start"&&(this._latestDragStart=r),!this._latestDragStart)return;const u=r.pointer.native,d=r.buttons,{cancelable:p,timestamp:f}=e,m={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return n==="end"&&(this._latestDragStart=void 0),{type:"drag",action:n,x:i,y:s,origin:m,pointerType:o,button:l,buttons:d,radius:r.radius,angle:q5(r.angle),native:u,timestamp:f,cancelable:p,stopPropagation:()=>e.stopPropagation(),defer:y=>e.defer(y),preventDefault:()=>e.preventDefault()}}};function Sse(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function $se(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function xse(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:l,eventId:u}=e.data,{cancelable:d,timestamp:p}=e;return{type:"click",pointerType:r,button:i,buttons:s,x:n,y:o,native:l,timestamp:p,screenPoint:Bt(n,o),mapPoint:wy(t,n,o),eventId:u,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:f=>e.defer(f),preventDefault:()=>e.preventDefault()}}function Tse(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:l,eventId:u}=e.data,{cancelable:d,timestamp:p}=e;return{type:"double-click",pointerType:r,button:i,buttons:s,x:n,y:o,native:l,timestamp:p,mapPoint:wy(t,n,o),eventId:u,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:f=>e.defer(f),preventDefault:()=>e.preventDefault()}}function Mse(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:l,eventId:u}=e.data,d=l.pointerId,{cancelable:p,timestamp:f}=e;return{type:"immediate-click",pointerId:d,pointerType:r,button:i,buttons:s,x:n,y:o,native:l,timestamp:f,mapPoint:wy(t,n,o),eventId:u,cancelable:p,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function Ise(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:l,eventId:u}=e.data,d=l.pointerId,{cancelable:p,timestamp:f}=e;return{type:"immediate-double-click",pointerId:d,pointerType:r,button:i,buttons:s,x:n,y:o,native:l,timestamp:f,mapPoint:wy(t,n,o),eventId:u,cancelable:p,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function Ese(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:l}=e.data,{cancelable:u,timestamp:d}=e;return{type:"hold",pointerType:r,button:i,buttons:s,x:n,y:o,native:l,timestamp:d,mapPoint:wy(t,n,o),cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:p=>e.defer(p),preventDefault:()=>e.preventDefault()}}function wy(t,e,r){return t.toMap(Bt(e,r),{exclude:[]})}function Ose(t){const{key:e,repeat:r,native:i}=t.data,{cancelable:s,timestamp:n}=t;return{type:"key-down",key:e,repeat:r,native:i,timestamp:n,cancelable:s,stopPropagation:()=>t.stopPropagation(),defer:o=>t.defer(o),preventDefault:()=>t.preventDefault()}}function kse(t){const{key:e,native:r}=t.data,{cancelable:i,timestamp:s}=t;return{type:"key-up",key:e,native:r,timestamp:s,cancelable:i,stopPropagation:()=>t.stopPropagation(),defer:n=>t.defer(n),preventDefault:()=>t.preventDefault()}}function Op(t,e){const{x:r,y:i,button:s,buttons:n,native:o,eventId:l}=t.data,u=o.pointerId,d=o.pointerType,{cancelable:p,timestamp:f}=t;return{type:e,x:r,y:i,pointerId:u,pointerType:d,button:s,buttons:n,native:o,timestamp:f,eventId:l,cancelable:p,stopPropagation:()=>t.stopPropagation(),defer:m=>t.defer(m),preventDefault:()=>t.preventDefault()}}function Cse(t){const{x:e,y:r,buttons:i,native:s,eventId:n}=t.data.currentEvent,{button:o}=t.data.startEvent,l=t.data.startEvent.native.pointerId,u=t.data.startEvent.native.pointerType,d=t.data.action,p={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:f,timestamp:m}=t;return{type:"pointer-drag",x:e,y:r,pointerId:l,pointerType:u,button:o,buttons:i,action:d,origin:p,native:s,timestamp:m,eventId:n,cancelable:f,stopPropagation:()=>t.stopPropagation(),defer:y=>t.defer(y),preventDefault:()=>t.preventDefault()}}function Pse(t){const{cancelable:e,data:r,timestamp:i}=t,{x:s,y:n,deltaY:o,native:l}=r;return{type:"mouse-wheel",x:s,y:n,deltaY:o,native:l,timestamp:i,cancelable:e,stopPropagation:()=>t.stopPropagation(),defer:u=>t.defer(u),preventDefault:()=>t.preventDefault()}}function Ase(t){const{action:e,state:r,device:i}=t.data,{cancelable:s,timestamp:n}=t,{buttons:o,axes:l}=r;return{type:"gamepad",device:i,timestamp:n,action:e,buttons:o,axes:l,cancelable:s,stopPropagation:()=>t.stopPropagation(),defer:u=>t.defer(u),preventDefault:()=>t.preventDefault()}}const Rse="z",Lse="r",Ij={cancel:"Escape",complete:"Enter"},dxe={...Ij,redo:Lse,undo:Rse,center:"Alt",constraint:"Shift",delete:["Backspace","Delete"],vertexAdd:"f",pan:" "},hxe={toggle:"Control"},pxe={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},fxe={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:o4,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0}};let mxe=class{constructor(){this._bindings=new Map}add(e,r){return this.addToggle(e,i=>{i.type==="key-down"&&r(i)})}addToggle(e,r){const i=Fse.fromDefinition(e,r),s=zh(this._bindings,i.key,()=>[]);return s.push(i),Te(()=>eT(s,i))}register(e,r=No.WIDGET){return qu([e.on("key-down",i=>this.dispatch(e.inputManager,i),r),e.on("key-up",i=>this.dispatch(e.inputManager,i),r)])}dispatch(e,r){const i=r.key,s=this._bindings.get(i);if(s)for(const n of s)n.process(e,r)}},Fse=class c${constructor(e,r,i,s,n){this.key=e,this.modifiers=r,this.repeats=i,this.continuePropagation=s,this.callback=n}process(e,r){if(!(r.key!==this.key||"repeat"in r&&r.repeat&&!this.repeats)){for(const i of this.modifiers)if(!e.isModifierKeyDown(i))return;this.continuePropagation||r.stopPropagation(),this.callback(r)}}static fromDefinition(e,r){if(typeof e=="string")return new c$(e,[],!1,!1,r);const{key:i,modifier:s,repeats:n,continuePropagation:o}=e;return new c$(i,s?Array.isArray(s)?s:[s]:[],!!n,!!o,r)}};function Nse(t){return[t.on("before-add",e=>{const r=e.item;if(r==null||t.includes(r))return L.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();r.onAdd()}),t.on("after-remove",e=>{const r=e.item;r.active&&(r.view.activeTool=null),r.destroy()})]}function d$(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(0)&&t.getEditableFlag(1)}function Dse(t){return t.type==="key-down"&&t.key===Ij.cancel}function pn(t){return Bt(t.x,t.y)}function Ej(t,e){const r=(t instanceof HTMLElement?t:t.surface)?.getBoundingClientRect();return r?Bt(e.clientX-r.left,e.clientY-r.top):Bt(0,0)}function Oj(t,e){return e instanceof Event?Ej(t,e):pn(e)}function kj(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let x0=class extends X{constructor(){super(...arguments),this._pointerLocations=new Map,this._hoveredManipulators=new Dd,this._grabbedManipulators=new Dd,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1}get cursor(){return this._cursorFromMap(this._grabbedManipulators,"grabbing")??this._cursorFromMap(this._hoveredManipulators,"pointer")}get hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,r){const i=()=>e.stopPropagation();switch(e.type){case"pointer-move":mk(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(i(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!yk(e))break;const s=pn(e),n=oc(s,e.pointerType,r.tools);if(n==null)break;const o=n.manipulator,l=n.tool;o==null||l==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,e,r),o!=null&&l!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:l,start:s,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&r.activeTool==null&&(this._revertToNullActiveTool=!0,r.setActiveTool(n.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:s}),i());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,r);break;case"pointer-drag":{if(!yk(e))break;const s=this._grabbedManipulators.get(e.pointerId),n=s?.manipulator,o=s?.tool;if(n==null||o==null)break;const l=pn(e);l.x=Bi(l.x,0,r.view.width),l.y=Bi(l.y,0,r.view.height);const u=s.start,d=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(n.dragging=!0,d?n.events.emit("drag",{action:"update",start:u,screenPoint:l}):n.events.emit("drag",{action:"start",start:u,screenPoint:l,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:n,start:u}));break;case"end":n.dragging=!1,d&&n.events.emit("drag",{action:"end",start:u,screenPoint:l}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,r)}i();break}case"immediate-click":{const s=pn(e),n=oc(s,e.pointerType,r.tools);if(!jse(e)){for(const d of r.tools)if((n==null||n.tool!==d||d.automaticManipulatorSelection)&&d.manipulators){let p=!1;d.manipulators.forEach(({manipulator:f})=>{f.selected&&(f.selected=!1,p=!0)}),p&&d.onManipulatorSelectionChanged&&d.onManipulatorSelectionChanged()}}if(n==null)break;const{manipulator:o,tool:l}=n;if(!o.interactive)break;o.selectable&&l.automaticManipulatorSelection&&(o.selected=!o.selected,l.onManipulatorSelectionChanged&&l.onManipulatorSelectionChanged());const u=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:u,stopPropagation:i}),Sb(o,i);break}case"click":{const s=pn(e),n=oc(s,e.pointerType,r.tools),o=n?.manipulator;if(o==null||!o.interactive)break;const l=e.native.shiftKey;o.events.emit(e.type,{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l}),i();break}case"double-click":{const s=pn(e),n=oc(s,e.pointerType,r.tools),o=n!=null?n.manipulator:null;if(o==null||!o.interactive)break;const l=e.native.shiftKey;o.events.emit("double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:i}),Sb(o,i);break}case"immediate-double-click":{const s=pn(e),n=oc(s,e.pointerType,r.tools),o=n!=null?n.manipulator:null;if(o==null||!o.interactive)break;const l=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:i}),e.pointerType==="mouse"&&Sb(o,i);break}}this._onFocusChange(r.tools)}_releaseManipulatorBeforeDragging(e,r,i){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:r.pointerType,screenPoint:pn(r)}),this._grabbedManipulators.forEach(({manipulator:s},n)=>{s===e&&this._grabbedManipulators.delete(n)}),this._afterManipulatorRelease(i.setActiveTool)}_handlePointerEnd(e,r){const i=this._grabbedManipulators.get(e.pointerId)?.manipulator;i!=null&&i.grabbing&&(i.grabbing=!1,i.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:pn(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(r.setActiveTool))}_onFocusChange(e){this._updateFocusedManipulatorTools(e)}_updateFocusedManipulatorTools(e){const r=new Set,i=new Set;this._grabbedManipulators.forEach(({tool:s})=>r.add(s)),this._hoveredManipulators.forEach(({tool:s})=>i.add(s));for(const s of e){s.hasGrabbedManipulators=r.has(s),s.hasHoveredManipulators=i.has(s);const n=this._grabbedManipulators.values(),o=Q7(n,({tool:l})=>l===s);s.firstGrabbedManipulator=o!=null?o.manipulator:null}}clearPointers(e,{tools:r,setActiveTool:i},s=!0,n){const o=(l,u)=>l===e&&(n==null||n===u);this._grabbedManipulators.forEach(({tool:l,manipulator:u,pointerType:d},p)=>{o(l,u)&&(this._grabbedManipulators.delete(p),u.grabbing=!1,u.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:d}))}),this._draggedManipulators.forEach(({tool:l,manipulator:u},d)=>{o(l,u)&&(this._draggedManipulators.delete(d),u.dragging=!1,u.events.emit("drag",{action:"cancel"}))}),s&&this._hoveredManipulators.forEach(({tool:l,manipulator:u},d)=>{o(l,u)&&(this._hoveredManipulators.delete(d),u.hovering=!1)}),this._afterManipulatorRelease(i),this._onFocusChange(r)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((r,i)=>{this._updateHoveredStateForPointerAtScreenPosition(Bt(r.x,r.y),i,r.pointerType,e)})}handleHoverEvent(e,r){const i=e.type;i!=="pointer-up"&&i!=="immediate-click"&&i!=="pointer-move"||!mk(e.pointerType)||(i!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(pn(e),e.pointerId,e.pointerType,r))}_updateHoveredStateForPointerAtScreenPosition(e,r,i,s){let n=oc(e,i,s);const o=this._hoveredManipulators.get(r)?.manipulator;n==null||n.manipulator.interactive||(n=null),n!=null&&o===n.manipulator||(o!=null&&(o.hovering=!1),n!=null?(n.manipulator.hovering=!0,this._hoveredManipulators.set(r,n)):this._hoveredManipulators.delete(r),this._onFocusChange(s))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach(({manipulator:r},i)=>{e===i&&(this._hoveredManipulators.delete(e),r.hovering=!1)})}_cursorFromMap(e,r){if(!e?.size)return null;for(const{manipulator:i}of e.values())if(i?.interactive){if(i.grabbing&&i.grabCursor)return i.grabCursor;if(i.cursor)return i.cursor}return r}};function oc(t,e,r){for(const i of r){if(i.manipulators==null||!d$(i))continue;const s=i.manipulators.intersect(t,e);if(s!=null)return{tool:i,manipulator:s}}return null}function mk(t){return t==="mouse"}function yk(t){return t.pointerType!=="mouse"||t.button===0}function jse(t){return!!t.native.shiftKey}function Sb(t,e){t?.consumesClicks&&e()}a([c()],x0.prototype,"cursor",null),x0=a([b("esri.views.interactive.ToolViewManagerManipulatorState")],x0);const gk="attached",$b="tools",Vse=1e3;let fn=class extends X{constructor(e){super(e),this._updatingHandles=new yu,this._clock=Uh,this._manipulatorState=new x0,this.tools=new H,this._interacting=!1,this._interactingTimeout=Vse,this._interactingTimeoutHandle=null}initialize(){this.addHandles([this.view.on($j,e=>{this._handleInputEvent(e)},No.TOOL),...Nse(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs)}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy(),this._manipulatorState.destroy()}get _manipulatorStateEventArgs(){return{tools:this.tools,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void L.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const r=this.activeTool;this._set("activeTool",e),r?.deactivate(),e?.activate(),this._removeIncompleteTools(e);for(const i of this.tools){this._updateToolEditableFlag(i);const s=d$(i);this.activeTool!=null&&s||this._manipulatorState.clearPointers(i,this._manipulatorStateEventArgs,!s)}}get cursor(){const e=this._manipulatorState.cursor;if(e!=null)return e;for(const r of this.tools)if(r.visible&&r.cursor!=null)return r.cursor;return null}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=He(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){this.view.type==="3d"?this.addHandles([ne(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>this._forEachManipulator(e=>e.onViewChange())),this.view.elevationProvider.on("elevation-change",e=>this._forEachManipulator(r=>r.onElevationChange(e)))],gk):this.addHandles(ne(()=>this.view.extent,()=>this._forEachManipulator(e=>e.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(gk),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){for(const r of this.tools)r.manipulators&&r.manipulators.forEach(({manipulator:i})=>e(i,r))}_handleInputEvent(e){let r=!1;const i={...e,stopPropagation:()=>{r=!0,e.stopPropagation()}};if(this.activeTool!=null)this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i);else for(const s of this.tools)!r&&s.visible&&s.handleInputEvent(i);!r&&Dse(e)&&this.activeTool&&(e.stopPropagation(),e.preventDefault(),this.activeTool.cancel(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),r||this.activeTool==null||this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this.tools),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles($b);for(const e of this.tools){if(e instanceof X){const r=ne(()=>[e.cursor,e.visible,e.editable],()=>{d$(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs)});this.addHandles(r,$b)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",r=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,r.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this.tools)})],$b)}this._manipulatorState.updateHoveredStateFromKnownPointers(this.tools)}_updateToolEditableFlag(e){e.setEditableFlag?.(1,this.activeTool==null||e===this.activeTool)}_removeIncompleteTools(e){this.tools.filter(r=>(e==null||r!==e)&&!r.created&&r.removeIncompleteOnCancel).forEach(r=>{this.tools.remove(r)})}get test(){}};a([c({constructOnly:!0,nonNullable:!0})],fn.prototype,"view",void 0),a([c({value:null})],fn.prototype,"activeTool",null),a([c({readOnly:!0,type:H})],fn.prototype,"tools",void 0),a([c()],fn.prototype,"cursor",null),a([c({readOnly:!0})],fn.prototype,"updating",null),a([c()],fn.prototype,"_interacting",void 0),a([c({readOnly:!0})],fn.prototype,"interacting",null),fn=a([b("esri.views.ToolViewManager")],fn);const zse=new ue("cyan"),Use=1,qse=.25,Gse=new ue("black"),Bse=.4,Hse=.2,wxe=.25,Cj="default",Wse="temporary",Zse=new ue("yellow");var h$;let Ei=h$=class extends X{constructor(t){super(t),this.name=Cj,this.color=zse.clone(),this.haloColor=null,this.haloOpacity=Use,this.fillOpacity=qse,this.shadowColor=Gse.clone(),this.shadowOpacity=Bse,this.shadowDifference=Hse,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur&&this.shadowColor.equals(t.shadowColor)&&this.shadowOpacity===t.shadowOpacity&&this.shadowDifference===t.shadowDifference}clone(){return new h$({...this,color:this.color.clone(),haloColor:this.haloColor?.clone(),shadowColor:this.shadowColor?.clone()})}assignFrom(t){this.color=t.color.clone(),this.haloColor=t.haloColor?.clone(),this.haloOpacity=t.haloOpacity,this.fillOpacity=t.fillOpacity,this.shadowColor=t.shadowColor.clone(),this.shadowDifference=t.shadowDifference,this.shadowOpacity=t.shadowOpacity,this.haloBlur=t.haloBlur,this.haloWidth=t.haloWidth}};a([c({type:String,constructOnly:!0,nonNullable:!0})],Ei.prototype,"name",void 0),a([c({type:ue,nonNullable:!0})],Ei.prototype,"color",void 0),a([c({type:ue})],Ei.prototype,"haloColor",void 0),a([c({nonNullable:!0})],Ei.prototype,"haloOpacity",void 0),a([c({nonNullable:!0})],Ei.prototype,"fillOpacity",void 0),a([c({type:ue,nonNullable:!0})],Ei.prototype,"shadowColor",void 0),a([c({nonNullable:!0})],Ei.prototype,"shadowOpacity",void 0),a([c({nonNullable:!0})],Ei.prototype,"shadowDifference",void 0),a([c({nonNullable:!0})],Ei.prototype,"haloWidth",void 0),a([c({nonNullable:!0})],Ei.prototype,"haloBlur",void 0),Ei=h$=a([b("esri.views.support.HighlightOptions")],Ei);const qa=Ei;function Jse(){return new(H.ofType(qa))([new qa({name:Cj}),new qa({name:Wse,color:Zse})])}let Pc=class extends X{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":Yse.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Kse[this.deviceType]}};a([c({nonNullable:!0,readOnly:!0})],Pc.prototype,"nativeIndex",void 0),a([c({type:String,readOnly:!0})],Pc.prototype,"deviceType",null),a([c({type:Number,readOnly:!0})],Pc.prototype,"axisThreshold",null),Pc=a([b("esri.views.input.gamepad.GamepadInputDevice")],Pc);const BM=Pc,Yse=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Kse={standard:.15,spacemouse:.025,unknown:0};let hf=class extends X{constructor(e){super(e),this.devices=new H,this.enabledFocusMode="document"}};a([c({type:H.ofType(BM),readOnly:!0})],hf.prototype,"devices",void 0),a([c({type:["document","view","none"]})],hf.prototype,"enabledFocusMode",void 0),hf=a([b("esri.views.input.gamepad.GamepadSettings")],hf);const Qse=hf;let T0=class extends X{constructor(){super(...arguments),this.gamepad=new Qse}};a([c({readOnly:!0})],T0.prototype,"gamepad",void 0),T0=a([b("esri.views.input.Input")],T0);const Xse=T0,xb=()=>c({type:["pan","rotate","zoom","none"],nonNullable:!0});let jl=class extends X{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};a([xb()],jl.prototype,"dragPrimary",void 0),a([xb()],jl.prototype,"dragSecondary",void 0),a([xb()],jl.prototype,"dragTertiary",void 0),a([c({type:["zoom","none"],nonNullable:!0})],jl.prototype,"mouseWheel",void 0),jl=a([b("esri.views.navigation.NavigationActionMap")],jl);const HM=jl;let da=class extends X{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};a([c({type:Boolean,nonNullable:!0})],da.prototype,"enabled",void 0),a([c({type:BM})],da.prototype,"device",void 0),a([c({type:["pan","zoom"],nonNullable:!0})],da.prototype,"mode",void 0),a([c({type:["forward-down","forward-up"],nonNullable:!0})],da.prototype,"tiltDirection",void 0),a([c({type:Number,nonNullable:!0})],da.prototype,"velocityFactor",void 0),da=a([b("esri.views.navigation.gamepad.GamepadSettings")],da);const Pj=da;let ha=class extends X{constructor(e){super(e),this.actionMap=new HM,this.browserTouchPanEnabled=!0,this.gamepad=new Pj,this.momentumEnabled=!0}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(e){I_(L.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};a([c({type:HM,nonNullable:!0})],ha.prototype,"actionMap",void 0),a([c({type:Boolean})],ha.prototype,"browserTouchPanEnabled",void 0),a([c({type:Pj,nonNullable:!0})],ha.prototype,"gamepad",void 0),a([c({type:Boolean})],ha.prototype,"momentumEnabled",void 0),a([c({type:Boolean})],ha.prototype,"mouseWheelZoomEnabled",null),ha=a([b("esri.views.navigation.Navigation")],ha);const s1=ha;function Mxe(t,e,r){const i=Aj(t),s=e,n=ene(i,s,r);if(i){const o=Ur.deriveUnitFromSR(i,t.spatialReference).heightUnit;if(!r&&o!==i.heightUnit){const l=new x("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new x("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:i,error:l})}}if(!tne(t)||n===4)return new x("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:i});switch(n){case 1:{const o=i?.heightUnit||"unknown",l=s?.heightUnit||"unknown",u=new x("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${l})`,{layerUnit:o,sceneUnit:l});return new x("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:s,error:u})}case 2:{const o=i?.heightModel||"unknown",l=s?.heightModel||"unknown",u=new x("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${l})`,{layerHeightModel:o,sceneHeightModel:l});return new x("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:s,error:u})}case 3:{const o=i?.vertCRS||"unknown",l=s?.vertCRS||"unknown",u=new x("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${l})`,{layerDatum:o,sceneDatum:l});return new x("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:s,error:u})}}return null}function ene(t,e,r){if(!vk(t)||!vk(e))return 4;if(t==null||e==null)return 0;if(!r&&t.heightUnit!==e.heightUnit)return 1;if(t.heightModel!==e.heightModel)return 2;switch(t.heightModel){case"gravity-related-height":return 0;case"ellipsoidal":return t.vertCRS===e.vertCRS?0:3;default:return 4}}function vk(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function tne(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!Fj(t)}function Aj(t){if(t.type==="integrated-mesh-3dtiles"||t.type==="gaussian-splat")return null;const e=t.url?nl(t.url):void 0;return!(t.spatialReference?.vcsWkid==null&&e!=null&&e.serverType==="ImageServer")&&Rj(t)&&t.heightModelInfo?t.heightModelInfo:Fj(t)?Ur.deriveUnitFromSR(ine,t.spatialReference):null}function Rj(t){return"heightModelInfo"in t}function Lj(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function Fj(t){return Lj(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):Nj(t)}function rne(t){return t.layers!=null||Nj(t)||Lj(t)||Rj(t)}function Nj(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"gaussian-splat":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}const ine=new Ur({heightModel:"gravity-related-height"});let p$,Tb=null;async function sne(t){Tb||(Tb=N(()=>import("./geometryServiceUtils-B4-QdC8A.js"),[]).then(e=>p$=e)),await Tb,We(t)}async function Dj(t,e,r,i){if(!t)return null;const s=t.spatialReference;return qo()||nn(s,e)?ll(t,e):p$?p$.projectGeometry(t,e,r,i):(await Promise.race([sne(i),el(i)]),Dj(t,e,r,i))}async function Ixe(t,e){try{return t?.spatialReference?await KN(t,e):null}catch{return null}}let Ue=class extends X{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=jo(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const e=this.map?.(),r=[];return this.priorityCollection!=null&&r.push(this.priorityCollection),r.push({parent:e?.basemap,layers:e?.basemap?.baseLayers},{parent:e?.basemap,layers:e?.basemap?.groundLayers},{layers:e?.layers},{parent:e?.ground,layers:e?.ground?.layers},{parent:e?.basemap,layers:e?.basemap?.referenceLayers}),r}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,i=>{const s=this._getSupportedSpatialReferences(i);if(s.length>0){const n=this._narrowDownSpatialReferenceCandidates(e,s);n!=null&&(e=n)}return e?.length===1})&&e?.length!==1)return{updating:!0};const r=this._pickSpatialReferenceCandidate(e);return{spatialReference:r?.spatialReference??null,viewingMode:r?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=this.map?.(),r=this.spatialReference;if(!r)return{updating:this._spatialReferenceTask.updating};let i;const s=this._collectLayers([{parent:e?.basemap,layers:e?.basemap?.baseLayers},{parent:e?.basemap,layers:e?.basemap?.groundLayers},{layers:e?.layers}],n=>!(!("tileInfo"in n)||!n.tileInfo?.spatialReference.equals(r))&&(i=n,!0),n=>"tileInfo"in n);return i?{tileInfo:i.tileInfo,updating:!1}:{updating:s}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let e={};const r=this._collectLayers(this.mapCollections,i=>{const s=Aj(i);return!!s&&(e={heightModelInfo:s,vcsWkid:i.spatialReference?.vcsWkid,latestVcsWkid:i.spatialReference?.latestVcsWkid},!0)},i=>rne(i));return{...e,updating:r}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],r=this._collectLayers(this.mapCollections,i=>{const s="fullExtents"in i&&i.fullExtents||(i.fullExtent!=null?[i.fullExtent]:[]),n=this.requiresExtentInSpatialReference?null:s[0],o=s.find(l=>l.spatialReference.equals(this.spatialReference))??n;if(o)return e.push({extent:o,layer:i}),!0;if(this._getSupportedSpatialReferences(i).length>0)for(const l of s)e.push({extent:l,layer:i});return!1});return{candidates:e,updating:r}}get _extentTask(){const{candidates:e,updating:r}=this._extentCandidatesTask;if(r)return{updating:r};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const i=this._pickExtentCandidate(e),s=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&s.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=jo(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:s.clone(),task:iy(async n=>{try{const o=await Dj(i.extent,s,"portalItem"in i.layer?i.layer.portalItem:void 0,n);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(Pr(n))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,r){if(e==null)return r;const i=new Array;for(const s of e)for(const n of r){if(!s.spatialReference.equals(n.spatialReference))continue;const o=one(s.viewingMode,n.viewingMode);if(o!==!1){i.push({spatialReference:s.spatialReference,viewingMode:o});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(e){const r=this.defaultSpatialReference;return e==null||e.length<1?r?{spatialReference:r,viewingMode:null}:null:(r!=null&&e.length>1&&e.some(({spatialReference:i})=>i.equals(r))&&(e=e.filter(({spatialReference:i})=>i.equals(r))),e.length>1&&e.some(({viewingMode:i})=>i!==2)&&(e=e.filter(({viewingMode:i})=>i!==2)),e[0])}_getSupportedSpatialReferences(e){const r="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(r.length===0)return[];const i=[];for(const s of r){const n=this.getSpatialReferenceSupport(s,e);if(n!=null){const o=n.constraints??[{spatialReference:s,viewingMode:null}];for(const{spatialReference:l,viewingMode:u}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!l.equals(this.userSpatialReference)||i.push({spatialReference:l,viewingMode:u})}}return i}_pickExtentCandidate(e){const r=this.spatialReference;return e.find(({extent:i})=>r.equals(i.spatialReference))||e[0]}_collectLayers(e,r,i=()=>!0){switch(this._loadMaybe(this.map?.())){case"loading":return!0;case"failed":return!1}const s=new nne(i,r);for(const n of e)if(this._collectCollection(n,s),s.done||s.preloading===this.sourcePreloadCount)break;return s.updating}_collectCollection(e,r){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return r.updating=!0,void++r.preloading;case"failed":return}for(const i of e.layers)if((i.type!=="graphics"||!i.internal)&&r.layerFilter(i)){switch(this._loadMaybe(i)){case"failed":continue;case"loading":r.updating=!0,++r.preloading;break;case"loaded":if(r.updating||(r.done=r.pushLayer(i)),r.done||r.preloading===this.sourcePreloadCount)break;"layers"in i&&this._collectCollection({layers:i.layers},r)}if(r.done||r.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(r=>{nr(r)}),"loading"):e.loadStatus:"loaded"}};a([c()],Ue.prototype,"required",void 0),a([c({constructOnly:!0})],Ue.prototype,"map",void 0),a([c({constructOnly:!0})],Ue.prototype,"getSpatialReferenceSupport",void 0),a([c()],Ue.prototype,"defaultSpatialReference",void 0),a([c()],Ue.prototype,"userSpatialReference",void 0),a([c()],Ue.prototype,"sourcePreloadCount",void 0),a([c()],Ue.prototype,"priorityCollection",void 0),a([c()],Ue.prototype,"requiresExtentInSpatialReference",void 0),a([c()],Ue.prototype,"suspended",void 0),a([c({readOnly:!0})],Ue.prototype,"ready",null),a([c({readOnly:!0})],Ue.prototype,"heightModelInfoReady",null),a([c({readOnly:!0})],Ue.prototype,"spatialReference",null),a([c({readOnly:!0})],Ue.prototype,"extent",null),a([c({readOnly:!0})],Ue.prototype,"heightModelInfo",null),a([c({readOnly:!0})],Ue.prototype,"vcsWkid",null),a([c({readOnly:!0})],Ue.prototype,"latestVcsWkid",null),a([c({readOnly:!0})],Ue.prototype,"viewingMode",null),a([c({readOnly:!0})],Ue.prototype,"tileInfo",null),a([c({readOnly:!0})],Ue.prototype,"mapCollections",null),a([c({readOnly:!0})],Ue.prototype,"_spatialReferenceTask",null),a([c({readOnly:!0})],Ue.prototype,"_tileInfoTask",null),a([c({readOnly:!0})],Ue.prototype,"_heightModelInfoTask",null),a([c({readOnly:!0})],Ue.prototype,"_extentCandidatesTask",null),a([c()],Ue.prototype,"_extentTask",null),a([c()],Ue.prototype,"_projectExtentTask",void 0),Ue=a([b("esri.views.support.DefaultsFromMap")],Ue);let nne=class{constructor(e,r){this.layerFilter=e,this.pushLayer=r,this.preloading=-1,this.updating=!1,this.done=!1}};function one(t,e){return t!=null?e!=null?t===e&&t:t:e}function ane(t){return"tryRecycleWith"in t}let lne=class{constructor(e,r,i){this.layer=e,this.view=r,this.layerViewImporter=i,this._controller=new AbortController,this._started=!1,this.done=!1,this._deferred=bi(),this.promise=this._deferred.promise,ys(this._controller.signal,()=>{this._recycleController?.abort();const s=new x("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred?.reject(s)})}tryRecycle(e){if(!this.done||!this.layerView||!ane(this.layerView))return null;this._recycleController?.abort(),this._recycleController=new AbortController;const r=this.layer.type,i=this._recycleController.signal;for(let s=0;s<e.length;s++){const n=e[s];if(n.type!==r)continue;const o=this.layerView.tryRecycleWith(n,{signal:i});if(o){e.splice(s,1),this.layer=n;const l=this.layerView,u=l.view;return this.promise=o.then(()=>(We(i),n.emit("layerview-destroy",{view:u,layerView:l}),u.emit("layerview-destroy",{view:u,layerView:l}),n.emit("layerview-create",{view:u,layerView:l}),u.emit("layerview-create",{view:u,layerView:l}),l)),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:r,view:i}=this;r.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{layer:r,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null,this.promise=null,this._deferred=null}async start(){const{view:e}=this;if(this._started||!e.map)return;this._started=!0;const{_controller:{signal:r},layer:i}=this;this._map=e.map;try{let s,n;if(await i.load({signal:r}),i.prefetchResources&&await i.prefetchResources({signal:r}),une(i))s=await i.createLayerView(e,{signal:r});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new x("layer:view-not-supported","No layerview implementation was found");const u=await this.layerViewImporter.importLayerView(i);We(r),s="default"in u?new u.default({layer:i,view:e}):new u({layer:i,view:e})}const o=()=>{n=He(n),s.destroyed||s.destroy(),this.done=!0};n=ys(r,o),We(r);try{await s.when()}catch(u){throw o(),u}if(!this._map?.allLayers?.includes(i))return o(),void this._deferred?.reject(new x("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=s,i.emit("layerview-create",{view:e,layerView:s}),e.emit("layerview-create",{layer:i,layerView:s}),this.done=!0,this._deferred?.resolve(s)}catch(s){i.emit("layerview-create-error",{view:e,error:s}),e.emit("layerview-create-error",{layer:i,error:s}),this.done=!0,this._deferred?.reject(new x("layerview:create-error","layerview creation failed",{layer:i,error:s}))}}};function une(t){return t.createLayerView!==tt.prototype.createLayerView}function cne(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let ri=class extends X{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new yu,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const r=this.view.map?.allLayers;if(r)for(const i of r)this.layerViewFilter?.(i)!==!1&&this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=bi(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(Wh(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{if(this.destroyed)return;const{map:r}=this.view;if(!r)return void this.clear();if(this._map!==r&&(this.clear(),this._map=r),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const i=new Set,s=[],n=this.view.ready,o=p=>{if(p!=null){for(const f of p)if(f){if(this.layerViewFilter?.(f)===!1)continue;i.add(f);const m=this._layerLayerViewInfoMap.get(f);m&&n?m.start():m||this._recyclingInfoMap.has(f)||s.push(f),"layers"in f&&f.layers&&o(f.layers)}}};for(const p of this._rootCollectionNames)o(Ys(this,p));const l=new Array,u=p=>{const f=p.tryRecycle(s);f?(this._recyclingInfoMap.set(p.layer,p),this.notifyChange("updating"),f.then(()=>{this._recyclingInfoMap.delete(p.layer),this._layerLayerViewInfoMap.set(p.layer,p),this._reschedule(),this.notifyChange("updating")}).catch(m=>{nr(m)||(this._recyclingInfoMap.delete(p.layer),p.destroy(),this._reschedule(),this.notifyChange("updating"))})):l.push(p)};for(const p of this._layerLayerViewInfoMap.values())i.has(p.layer)||(this._layerLayerViewInfoMap.delete(p.layer),u(p));for(const p of this._recyclingInfoMap.values())i.has(p.layer)||(this._recyclingInfoMap.delete(p.layer),u(p));for(const p of s)this._createLayerView(p);this._refreshCollections(),l.forEach(p=>p.destroy());const d=[r?.ground?.layers,r?.basemap?.baseLayers,r?.basemap?.groundLayers,r?.basemap?.referenceLayers,r?.layers].filter(p=>!!p);i.forEach(p=>"layers"in p&&d.push(p.layers)),this.addHandles(d.map(p=>this._watchUpdatingTracking.addOnCollectionChange(()=>p,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null},this._layersToLayerViews=new Map(e.layerviewMapping)}initialize(){this.addHandles([Fu(()=>this.view?.map?.allLayers,"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),ne(()=>{const e=this.view,r=e?.map;return[r?.basemap,r?.ground,r?.layers,e?.ready]},()=>this._reschedule(),Tr)]),this._preloadLayerViewModules(),this._reschedule()}clearHandles(){this._watchUpdatingTracking.removeAll()}destroy(){this.clear(),Gy(this._recyclingInfoMap),Gy(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(Fe()),this._workPromise=null)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||a7(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const r of this._layerLayerViewInfoMap.values())r.done||++e;return e}clear(){this.destroyed||(this._clearCollections(),Gy(this._layerLayerViewInfoMap),Gy(this._recyclingInfoMap))}async whenLayerView(e){await this._reschedule();const r=this._layerLayerViewInfoMap.get(e)?.promise;if(!r){const i=this._recyclingInfoMap.get(e)?.promise;if(!i)throw new x("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return i}return r}isCreatingLayerViewsForLayer(e,r){this.commitProperty("updatingRemaining");const i=this._layerLayerViewInfoMap.get(e);if(!i?.done)return!0;const s=i.layerView;return!(!s||!r||s.parent===r)||!!(i.done&&s&&"layers"in e&&e.layers?.length)&&e.layers.some(n=>this.isCreatingLayerViewsForLayer(n,s))}_refreshCollections(){for(const[e,r]of this._layersToLayerViews)this._populateLayerViewsOwners(Ys(this,e),Ys(this,r),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_clearCollections(){for(const e of this._layersToLayerViews.values())Ys(this,e)?.removeAll()}_populateLayerViewsOwners(e,r,i){if(!e||!r)return void r?.removeAll();let s=0;for(const n of e){const o=this._layerLayerViewInfoMap.get(n);if(!o?.layerView)continue;const{layerView:l}=o;l.layer=n,l.parent=i,r.at(s)!==l&&r.splice(s,0,l),"layers"in n&&cne(l)&&this._populateLayerViewsOwners(n.layers,l.layerViews,l),++s}s<r.length&&r.splice(s)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const r=new lne(e,this.view,this.layerViewImporter);r.promise?.then(()=>this._refreshCollections(),i=>{i&&(nr(i)||i.name==="cancelled:layerview-create")||L.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:i}),this.destroyed||this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,r),this.view.ready&&r.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};a([c()],ri.prototype,"_workPromise",void 0),a([c({readOnly:!0})],ri.prototype,"_watchUpdatingTracking",void 0),a([c({readOnly:!0})],ri.prototype,"_layersToLayerViews",void 0),a([c({constructOnly:!0})],ri.prototype,"layerviewMapping",void 0),a([c({readOnly:!0})],ri.prototype,"_rootCollectionNames",null),a([c({constructOnly:!0})],ri.prototype,"layerViewFilter",void 0),a([c()],ri.prototype,"layerViewImporter",void 0),a([c()],ri.prototype,"supportsGround",void 0),a([c({readOnly:!0})],ri.prototype,"updating",null),a([c({readOnly:!0})],ri.prototype,"updatingRemaining",null),a([c({constructOnly:!0})],ri.prototype,"view",void 0),ri=a([b("esri.views.support.LayerViewManager")],ri);const dne=ri;let Ac=class extends X{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};a([c()],Ac.prototype,"featureTitleFields",void 0),a([c()],Ac.prototype,"utilityNetworkFields",void 0),a([c()],Ac.prototype,"globalIdField",void 0),Ac=a([b("esri.views.support.RequiredFieldsOptions")],Ac);const hne=Ac;var Rc,Wa;let te=(Wa=class extends xw(AT){constructor(e){super(e),this._userSpatialReference=null,this.handles=new Bh,this.updatingHandles=new yu,this.allLayerViews=new Zs({getCollections:()=>this.layerviewCollections,getChildrenFunction:fne}),this.analyses=new Ch,this.basemapView=null,this.dependencies={popup:void 0},this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new sm,this.typeSpecificPreconditionsReady=!0,this.layerViews=new H,this.magnifier=new bj,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this._lowPriorityCursorHandles=new H,this._highPriorityCursorHandles=new H,this.input=new Xse,this.navigation=new s1,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new Mj(this),this.persistableViewModels=new H,this.requiredFieldsOptions=new hne,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(ne(()=>this.preconditionsReady,r=>{const i=this.ready;if(r?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,Rc.views.add(this)):(this._lockedSpatialReference=null,Rc.views.remove(this)),this.notifyChange("spatialReference"),!r&&i)this.toolViewManager?.detach(),this.analysisViewManager?.detach(),this.layerViewManager?.clear(),this._teardown();else if(r&&!i){try{this._startup()}catch(s){return void queueMicrotask(()=>{this.fatalError=new x("view:startup-error","View._startup failed",s)})}this.analysisViewManager?.attach(),this.toolViewManager.attach()}},jn))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this._validateWithErrorDisplay()]).then(()=>(this._isValid=!0,Nw(()=>this.ready)))),this.basemapView=new lse({view:this}),this.layerViewManager=new dne({view:this,layerViewFilter:e=>this.layerViewFilter?.(e)??!0,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},layerviewMapping:this._layerToLayerviewMapping}),this.toolViewManager=new fn({view:this}),this.selectionManager=new wse({view:this}),this.addHandles([Gi(()=>this.readyState==="map-content-error"&&!this.spatialReference,()=>{L.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),ne(()=>this.initialExtentRequired,e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e},Tr),ne(()=>this.ready,e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)},jn),ne(()=>this._userSpatialReference,e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)},Tr)])}get _layerToLayerviewMapping(){return Rc._layerToLayerview}destroy(){this.destroyed||(Rc.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=Ke(this.graphics),this.analyses=Ke(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.analysisViewManager=Ke(this.analysisViewManager),this.toolViewManager=Ke(this.toolViewManager),this.layerViewManager=Ke(this.layerViewManager),this.selectionManager=Ke(this.selectionManager),this.basemapView=Ke(this.basemapView),this.layerViews?.forEach(e=>e.destroy()),this.layerViews.length=0,this.invalidate(),this.handles.destroy(),this.map=Ke(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return L.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get layerviewCollections(){return[this.basemapView?.baseLayerViews,this.basemapView?.groundLayerViews,this.layerViews,this.basemapView?.referenceLayerViews]}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Ue({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(e,r)=>this.getSpatialReferenceSupport(e,r),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??Jse()}set highlights(e){this._set("highlights",Pn(e,this._get("highlights"),H.ofType(qa)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!this.destroying&&!this.destroyed&&!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||j_(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e?.destroyed&&(L.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),j_(e)&&e.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get readyState(){if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((this.defaultsFromMap?.ready??!1)&&!this.spatialReference){const e=!("loaded"in this.map)||this.map.loaded,r=this.map.ground.loaded,i=this.map.basemap?.loaded??!0;return e&&i&&r&&!this.map?.allLayers.length?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=iy(s=>yT(k("view-readyState-waiting-delay"),null,s)),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),this._readyStateWaitingTask?.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=jo(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&this.defaultsFromMap?.required?.heightModelInfo){const r=e.clone();return r.vcsWkid=this.defaultsFromMap.vcsWkid,r.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,r}return e}set spatialReference(e){const r=!Wt(e,this._get("spatialReference"));this._set("_userSpatialReference",e),r&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(e){this._userTimeExtent=e}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??rn}set timeZone(e){this._userTimeZone=e,CZ(e)||L.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._highPriorityCursorHandles.at(-1)?.cursor??this._lowPriorityCursorHandles.at(-1)?.cursor??"default"}acquireCursor(e,r="low"){const i=r==="high"?this._highPriorityCursorHandles:this._lowPriorityCursorHandles,s={cursor:e},n=Te(()=>i.remove(s));return i.add(s),this.addHandles(n),n}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new u$}whenLayerView(e){return this.layerViewManager?.whenLayerView(e)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}getSurface(){return null}importLayerView(e){throw new x("view:importLayerView-missing","importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return this.getSpatialReferenceSupport(e)!=null}when(e,r){return this.isResolved()&&!this.ready&&L.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,r)}forceReadyCycle(){this.ready&&(Gi(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}on(e,r){return super.on(e,r)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}async _validateWithErrorDisplay(){try{await this.validate()}catch(e){const r=document.createElement("div");r.setAttribute("style","display: flex; flex-direction: column; gap: 8px; padding: 20px; height: 100%; justify-content: center; color: black; background: white; font-family: sans-serif;");const i=document.createElement("div");i.innerHTML="Unable to display map. WebGL2 support is required.",i.setAttribute("style","font-size: 24px; font-weight: bold;");const s=document.createElement("div");s.innerHTML="Ensure that your browser and hardware meet the minimum requirements.",s.setAttribute("style","font-size: 18px;");const n=document.createElement("a");n.innerHTML="https://esriurl.com/webgl-faq",n.target="_blank",n.setAttribute("style","font-size: 18px;"),n.href="https://esriurl.com/webgl-faq",r.appendChild(i),r.appendChild(s),r.appendChild(n);const o=this.getSurface();throw o&&o.appendChild(r),e}}},Rc=Wa,Wa._layerToLayerview=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.basemap.groundLayers","view.basemapView.groundLayerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"],["view.map.layers","view.layerViews"]],Wa.views=new H,Wa);a([c()],te.prototype,"_userSpatialReference",void 0),a([c()],te.prototype,"activeTool",null),a([c({readOnly:!0})],te.prototype,"allLayerViews",void 0),a([c({readOnly:!0})],te.prototype,"layerviewCollections",null),a([c(FS(Ch,"analyses"))],te.prototype,"analyses",void 0),a([c()],te.prototype,"animation",null),a([c()],te.prototype,"basemapView",void 0),a([c()],te.prototype,"center",null),a([c()],te.prototype,"defaultsFromMapSettings",null),a([c()],te.prototype,"defaultsFromMap",null),a([c()],te.prototype,"dependencies",void 0),a([c()],te.prototype,"displayFilterEnabled",void 0),a([c({type:he})],te.prototype,"extent",null),a([c()],te.prototype,"fatalError",void 0),a([c(FS(sm,"graphics"))],te.prototype,"graphics",void 0),a([c({readOnly:!0,type:Ur})],te.prototype,"heightModelInfo",null),a([c({type:H.ofType(qa)})],te.prototype,"highlights",null),a([c({readOnly:!0})],te.prototype,"interacting",null),a([c({constructOnly:!0})],te.prototype,"layerViewFilter",void 0),a([c({readOnly:!0})],te.prototype,"navigating",null),a([c({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],te.prototype,"preconditionsReady",null),a([c({readOnly:!0})],te.prototype,"typeSpecificPreconditionsReady",void 0),a([c({type:H,readOnly:!0})],te.prototype,"layerViews",void 0),a([c()],te.prototype,"resolution",null),a([c({type:bj})],te.prototype,"magnifier",void 0),a([c({value:null,type:$D})],te.prototype,"map",null),a([c()],te.prototype,"padding",void 0),a([c({readOnly:!0})],te.prototype,"ready",void 0),a([c()],te.prototype,"_readyStateWaitingTask",void 0),a([c({readOnly:!0})],te.prototype,"readyState",null),a([c({type:Z})],te.prototype,"spatialReference",null),a([c()],te.prototype,"stationary",null),a([c({type:Et})],te.prototype,"timeExtent",null),a([c({type:String,nonNullable:!0})],te.prototype,"timeZone",null),a([c()],te.prototype,"tools",null),a([c()],te.prototype,"toolViewManager",void 0),a([c({readOnly:!0})],te.prototype,"type",void 0),a([c({type:Number})],te.prototype,"scale",void 0),a([c({readOnly:!0})],te.prototype,"updating",void 0),a([c({readOnly:!0})],te.prototype,"initialExtentRequired",void 0),a([c({readOnly:!0})],te.prototype,"initialExtent",null),a([c()],te.prototype,"cursor",null),a([c({readOnly:!0})],te.prototype,"input",void 0),a([c({type:s1,nonNullable:!0})],te.prototype,"navigation",void 0),a([c()],te.prototype,"layerViewManager",void 0),a([c()],te.prototype,"analysisViewManager",void 0),a([c()],te.prototype,"selectionManager",void 0),a([c()],te.prototype,"width",void 0),a([c()],te.prototype,"height",void 0),a([c({readOnly:!0})],te.prototype,"resizing",void 0),a([c({value:null,readOnly:!0})],te.prototype,"size",null),a([c({readOnly:!0})],te.prototype,"suspended",void 0),a([c({readOnly:!0})],te.prototype,"viewEvents",void 0),a([c({readOnly:!0})],te.prototype,"persistableViewModels",void 0),a([c()],te.prototype,"_isValid",void 0),a([c()],te.prototype,"_readyCycleForced",void 0),a([c()],te.prototype,"_lockedSpatialReference",void 0),a([c()],te.prototype,"_userTimeZone",void 0),a([c()],te.prototype,"_lockedTimeZone",void 0),a([c()],te.prototype,"_userTimeExtent",void 0),a([c()],te.prototype,"_lockedTimeExtent",void 0),a([c({type:u$})],te.prototype,"theme",void 0),a([c({readOnly:!0,type:u$})],te.prototype,"effectiveTheme",null),te=Rc=a([b("esri.views.View")],te);const Mb=globalThis.$arcgis;Mb&&!Mb.views&&Object.defineProperty(Mb,"views",{configurable:!1,enumerable:!0,writable:!1,value:te.views});const pne=te;function fne(t){return t.layerViews}function ut(){return[0,0]}function mne(t){return[t[0],t[1]]}function by(t,e){return[t,e]}function yne(t,e){return[t,e]}function gne(t,e=ut()){const r=Math.min(2,t.length);for(let i=0;i<r;++i)e[i]=t[i];return e}function jj(){return ut()}function Vj(){return by(1,1)}function zj(){return by(1,0)}function Uj(){return by(0,1)}const vne=jj(),wne=Vj(),bne=zj(),_ne=Uj();Object.freeze(Object.defineProperty({__proto__:null,ONES:wne,UNIT_X:bne,UNIT_Y:_ne,ZEROS:vne,clone:mne,create:ut,freeze:yne,fromArray:gne,fromValues:by,ones:Vj,unitX:zj,unitY:Uj,zeros:jj},Symbol.toStringTag,{value:"Module"}));function Sne(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function qj(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function $ne(t,e,r,i,s,n,o){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=n,t[5]=o,t}function WM(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],l=e[5];let u=r*n-i*s;return u?(u=1/u,t[0]=n*u,t[1]=-i*u,t[2]=-s*u,t[3]=r*u,t[4]=(s*l-n*o)*u,t[5]=(i*o-r*l)*u,t):null}function xne(t){return t[0]*t[3]-t[1]*t[2]}function Gj(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=r[0],p=r[1],f=r[2],m=r[3],y=r[4],g=r[5];return t[0]=i*d+n*p,t[1]=s*d+o*p,t[2]=i*f+n*m,t[3]=s*f+o*m,t[4]=i*y+n*g+l,t[5]=s*y+o*g+u,t}function _y(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=Math.sin(r),p=Math.cos(r);return t[0]=i*p+n*d,t[1]=s*p+o*d,t[2]=i*-d+n*p,t[3]=s*-d+o*p,t[4]=l,t[5]=u,t}function n1(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=r[0],p=r[1];return t[0]=i*d,t[1]=s*d,t[2]=n*p,t[3]=o*p,t[4]=l,t[5]=u,t}function Lh(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=r[0],p=r[1];return t[0]=i,t[1]=s,t[2]=n,t[3]=o,t[4]=i*d+n*p+l,t[5]=s*d+o*p+u,t}function Bj(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t[4]=0,t[5]=0,t}function Hj(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function ZM(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function Tne(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function Mne(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function Ine(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t}function Wj(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}function Ene(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t}function One(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t}function kne(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function Cne(t,e){const r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],l=t[5],u=e[0],d=e[1],p=e[2],f=e[3],m=e[4],y=e[5],g=Qr();return Math.abs(r-u)<=g*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-d)<=g*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(s-p)<=g*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(n-f)<=g*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(o-m)<=g*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(l-y)<=g*Math.max(1,Math.abs(l),Math.abs(y))}const Pne=Gj,Ane=Wj;Object.freeze(Object.defineProperty({__proto__:null,add:Ine,copy:Sne,determinant:xne,equals:Cne,exactEquals:kne,frob:Mne,fromRotation:Bj,fromScaling:Hj,fromTranslation:ZM,identity:qj,invert:WM,mul:Pne,multiply:Gj,multiplyScalar:Ene,multiplyScalarAndAdd:One,rotate:_y,scale:n1,set:$ne,str:Tne,sub:Ane,subtract:Wj,translate:Lh},Symbol.toStringTag,{value:"Module"}));function Ln(){return[1,0,0,1,0,0]}function Rne(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function Lne(t,e,r,i,s,n){return[t,e,r,i,s,n]}const Fne=Ln();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:Fne,clone:Rne,create:Ln,fromValues:Lne},Symbol.toStringTag,{value:"Module"}));const ng={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new Rt({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:Z.WebMercator}),minus180Line:new Rt({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new Rt({paths:[[[180,-180],[180,180]]],spatialReference:Z.WGS84}),minus180Line:new Rt({paths:[[[-180,-180],[-180,180]]],spatialReference:Z.WGS84})}};function au(t,e){return Math.ceil((t-e)/(2*e))}function Zj(t,e){const r=om(t);for(const i of r)for(const s of i)s[0]+=e;return t}function om(t){return Nd(t)?t.rings:t.paths}function JM(t,e){return e?{...e,query:{...t,...e.query}}:{query:t}}function Sy(t){return typeof t=="string"?Lr(t):E(t)}function YM(t,e,r){const i={};for(const s in t){if(s==="declaredClass")continue;const n=t[s];if(n!=null&&typeof n!="function")if(Array.isArray(n))i[s]=n.map(o=>YM(o));else if(typeof n=="object")if(n.toJSON){const o=n.toJSON(r?.[s]);i[s]=e?o:JSON.stringify(o)}else i[s]=e?n:JSON.stringify(n);else i[s]=n}return i}function Nne(t,e){return t?e&&_T(t)?e:bT(t)??Se?.findCredential(t)?.token:null}async function Axe(t,e,r){const i=Nne(t,e);return i||(!Se&&_e.request.useIdentity&&await N(()=>import("./IdentityManager-DyLqGjR7.js"),[]),(await Se.getCredential(t,r))?.token)}async function Dne(t,e,r,i){const s=Sy(t),n=e[0].spatialReference,o={...i,responseType:"json",query:{...s.query,f:"json",sr:_v(n),target:JSON.stringify({geometryType:sp(e[0]),geometries:e}),cutter:JSON.stringify(r)}},l=await Ae(s.path+"/cut",o),{cutIndexes:u,geometries:d=[]}=l.data;return{cutIndexes:u,geometries:d.map(p=>{const f=tl(p);return f.spatialReference=n,f})}}function jne(t){return{geometryType:sp(t[0]),geometries:t.map(e=>e.toJSON())}}function Jj(t,e,r){const i=VX(e);return t.map(s=>{const n=i.fromJSON(s);return n.spatialReference=r,n})}async function Vne(t,e,r){const i=typeof t=="string"?Lr(t):t,s=e[0].spatialReference,n=sp(e[0]),o={...r,query:{...i.query,f:"json",sr:_v(s),geometries:JSON.stringify(jne(e))}},{data:l}=await Ae(i.path+"/simplify",o);return Jj(l.geometries,n,s)}const Yj=()=>L.getLogger("esri.geometry.support.normalizeUtils");function zne(t){return t.type==="polygon"}function Une(t){return t[0].type==="polygon"}function qne(t){return t[0].type==="polyline"}function wk(t){const e=[];let r=0,i=0;for(let s=0;s<t.length;s++){const n=t[s];let o=null;for(let l=0;l<n.length;l++)o=n[l],e.push(o),l===0?(r=o[0],i=r):(r=Math.min(r,o[0]),i=Math.max(i,o[0]));o&&e.push([(r+i)/2,0])}return e}function Gne(t,e){if(!(t instanceof Rt||t instanceof Be)){const s="straightLineDensify: the input geometry is neither polyline nor polygon";throw Yj().error(s),new x("internal:geometry",s)}const r=om(t),i=[];for(const s of r){const n=[];i.push(n),n.push([s[0][0],s[0][1]]);for(let o=0;o<s.length-1;o++){const l=s[o][0],u=s[o][1],d=s[o+1][0],p=s[o+1][1],f=Math.sqrt((d-l)*(d-l)+(p-u)*(p-u)),m=(p-u)/f,y=(d-l)/f,g=f/e;if(g>1){for(let M=1;M<=g-1;M++){const C=M*e,T=y*C+l,O=m*C+u;n.push([T,O])}const v=(f+Math.floor(g-1)*e)/2,_=y*v+l,S=m*v+u;n.push([_,S])}n.push([d,p])}}return zne(t)?new Be({rings:i,spatialReference:t.spatialReference}):new Rt({paths:i,spatialReference:t.spatialReference})}function bk(t,e,r){if(e){const i=Gne(t,1e6);t=cd(i,!0)}return r&&(t=Zj(t,r)),t}function _k(t,e,r){if(Array.isArray(t)){const i=t[0];if(i>e){const s=au(i,e);t[0]=i+s*(-2*e)}else if(i<r){const s=au(i,r);t[0]=i+s*(-2*r)}}else{const i=t.x;if(i>e){const s=au(i,e);t=t.clone().offset(s*(-2*e),0)}else if(i<r){const s=au(i,r);t=t.clone().offset(s*(-2*r),0)}}return t}function Bne(t,e){let r=-1;for(let i=0;i<e.cutIndexes.length;i++){const s=e.cutIndexes[i],n=e.geometries[i],o=om(n);for(let l=0;l<o.length;l++){const u=o[l];u.some(d=>{if(d[0]<180)return!0;{let p=0;for(let m=0;m<u.length;m++){const y=u[m][0];p=y>p?y:p}p=Number(p.toFixed(9));const f=-360*au(p,180);for(let m=0;m<u.length;m++){const y=n.getPoint(l,m);n.setPoint(l,m,y.clone().offset(f,0))}return!0}})}if(s===r){if(Une(t))for(const l of om(n))t[s]=t[s].addRing(l);else if(qne(t))for(const l of om(n))t[s]=t[s].addPath(l)}else r=s,t[s]=n}return t}async function Hne(t,e,r){if(!Array.isArray(t))return Hne([t],e);e&&typeof e!="string"&&Yj().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const i=typeof e=="string"?e:e?.url??_e.geometryServiceUrl;let s,n,o,l,u,d,p,f,m=0;const y=[],g=[];for(const T of t)if(T!=null)if(s||(s=T.spatialReference,n=Kr(s),o=s.isWebMercator,d=o?102100:4326,l=ng[d].maxX,u=ng[d].minX,p=ng[d].plus180Line,f=ng[d].minus180Line),n)if(T.type==="mesh")g.push(T);else if(T.type==="point")g.push(_k(T.clone(),l,u));else if(T.type==="multipoint"){const O=T.clone();O.points=O.points.map(P=>_k(P,l,u)),g.push(O)}else if(T.type==="extent"){const O=T.clone()._normalize(!1,!1,n);g.push(O.rings?new Be(O):O)}else if(T.extent){const O=T.extent,P=au(O.xmin,u)*(2*l);let D=P===0?T.clone():Zj(T.clone(),P);O.offset(P,0);let{xmin:z,xmax:B}=O;z=Number(z.toFixed(9)),B=Number(B.toFixed(9)),O.intersects(p)&&B!==l?(m=B>m?B:m,D=bk(D,o),y.push(D),g.push("cut")):O.intersects(f)&&z!==u?(m=B*(2*l)>m?B*(2*l):m,D=bk(D,o,360),y.push(D),g.push("cut")):g.push(D)}else g.push(T.clone());else g.push(T);else g.push(T);let v=au(m,l),_=-90;const S=v,M=new Rt;for(;v>0;){const T=360*v-180;M.addPath([[T,_],[T,-1*_]]),_*=-1,v--}if(y.length>0&&S>0){const T=Bne(y,await Dne(i,y,M,r)),O=[],P=[];for(let B=0;B<g.length;B++){const G=g[B];if(G!=="cut")P.push(G);else{const Q=T.shift(),oe=t[B];oe!=null&&oe.type==="polygon"&&oe.rings&&oe.rings.length>1&&Q.rings.length>=oe.rings.length?(O.push(Q),P.push("simplify")):P.push(o?za(Q):Q)}}if(!O.length)return P;const D=await Vne(i,O,r),z=[];for(let B=0;B<P.length;B++){const G=P[B];G!=="simplify"?z.push(G):z.push(o?za(D.shift()):D.shift())}return z}const C=[];for(let T=0;T<g.length;T++){const O=g[T];if(O!=="cut")C.push(O);else{const P=y.shift();C.push(o===!0?za(P):P)}}return C}function Wne(t){if(!t)return null;const e=t.extent;if(!e)return null;const r=t.spatialReference&&Kr(t.spatialReference);if(!r)return e;const[i,s]=r.valid,n=2*s,{width:o}=e;let l,{xmin:u,xmax:d}=e;if([u,d]=[d,u],t.type==="extent"||o===0||o<=s||o>n||u<i||d>s)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;l=wk(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;l=wk(t.paths);break;case"multipoint":l=t.points}const p=e.clone();for(let f=0;f<l.length;f++){let m=l[f][0];m<0?(m+=s,d=Math.max(m,d)):(m-=s,u=Math.min(m,u))}return p.xmin=u,p.xmax=d,p.width<o?(p.xmin-=s,p.xmax-=s,p):e}function KM(t,e,r){const i=Kr(r);if(i==null)return t;const[s,n]=i.valid,o=2*n;let l=0,u=0;e>n?l=Math.ceil(Math.abs(e-n)/o):e<s&&(l=-Math.ceil(Math.abs(e-s)/o)),t>n?u=Math.ceil(Math.abs(t-n)/o):t<s&&(u=-Math.ceil(Math.abs(t-s)/o));let d=t+(l-u)*o;const p=d-e;return p>n?d-=o:p<s&&(d+=o),d}function Rxe(t,e){return QM(e)?.normalize(t)??t}function QM(t){const e=Kr(t);if(e==null)return null;const[r,i]=e.valid;return new Jw(r,i)}const Lxe=QM(Z.WGS84);QM(Z.WebMercator);const Kj=96,Qj=39.37,Zne=180/Math.PI;function Xj(t){return t.wkid?t:t.spatialReference||Z.WGS84}function XM(t,e){return e.type?sr(t,e.x,e.y):Od(t,e)}function e6(t){return Hi(t)}function o1(t,e,r=0){let i=t.width,s=t.height;if(r!==0){const l=ly(r),u=Math.abs(Math.cos(l)),d=Math.abs(Math.sin(l));i=t.width*u+t.height*d,s=t.width*d+t.height*u}const n=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(i/n,s/o)*roe(t.spatialReference)}async function pf(t,e,r,i){let s,n;if(!t||Array.isArray(t)&&!t.length)return null;if(H.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const l=t.every(p=>"attributes"in p),u=t.some(p=>!p.geometry);let d=t;if(l&&u&&e&&e.allLayerViews){const p=new Map;for(const g of t){const v=g.layer,_=p.get(v)||[],S=g.attributes[v.objectIdField];S!=null&&_.push(S),p.set(v,_)}const f=[];p.forEach((g,v)=>{const _=e.allLayerViews?.find(S=>S.layer.id===v.id);if(_&&"queryFeatures"in _){const S=v.createQuery();S.objectIds=g,S.returnGeometry=!0,f.push(_.queryFeatures(S))}});const m=await Promise.all(f),y=[];for(const g of m)if(g&&g.features&&g.features.length)for(const v of g.features)v.geometry!=null&&y.push(v.geometry);d=y}for(const p of d)i=await pf(p,e,r,i);return i}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")s=new ee(t);else if(t instanceof qt)s=t;else if("geometry"in t){if(t.geometry)s=t.geometry;else if(t.layer){const l=t.layer,u=e.allLayerViews?.find(d=>d.layer.id===l.id);if(u&&"queryFeatures"in u){const d=l.createQuery();d.objectIds=[t.attributes[l.objectIdField]],d.returnGeometry=!0,s=(await u.queryFeatures(d))?.features?.[0]?.geometry}}}if(s==null)return null;switch(s.type){case"point":n=new he({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":n=Wne(s);break;default:n=s.extent}if(!n)return null;qo()||nn(n.spatialReference,r)||await el();const o=ll(n,r);if(!o)return null;if(i){const l=o.center,u=l.clone();u.x=KM(l.x,i.center.x,r),u.x!==l.x&&o.centerAt(u),i=i.union(o)}else i=o;return i}function Jne(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer?.minScale!=null&&t.layer.maxScale!=null){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every(e=>"layer"in e)){let e=0,r=0;for(const i of t){const s=i.layer;s?.minScale&&s.maxScale&&(e=s.minScale<e?s.minScale:e,r=s.maxScale>r?s.maxScale:r)}return e&&r?{min:e,max:r}:null}}}function Sk(t,e){const r=Xj(t);return Wt(r,e)||r.imageCoordinateSystem||e.imageCoordinateSystem?t:ll(t,e)}async function Yne(t,e){if(!t||!e)return new fs({targetGeometry:new ee,scale:0,rotation:0});let r=e.spatialReference;const{constraints:i,padding:s,viewpoint:n,size:o}=e,l=[s?o[0]-s.left-s.right:o[0],s?o[1]-s.top-s.bottom:o[1]];let u=null;t instanceof fs?u=t:t.viewpoint?u=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(u=t.target);let d=null;u?.targetGeometry?d=u.targetGeometry:t instanceof he?d=t:t instanceof qt?d=await pf(t,e,r):t&&(d=await pf(t.center,e,r)||await pf(t.target,e,r)||await pf(t,e,r)),!d&&n?.targetGeometry?d=n.targetGeometry:!d&&e.extent&&(d=e.extent),r||(r=Xj(e.spatialReference||e.extent||d)),qo()||Wt(d.spatialReference,r)||nn(d.spatialReference,r)||await el();const p=Sk(d,r),f="center"in p?p.center:p;e.pickClosestTarget!==!1&&f.type==="point"&&n.targetGeometry?.type==="point"&&(f.x=KM(f.x,n.targetGeometry.x,f.spatialReference));let m=0;u?m=u.rotation:t.hasOwnProperty("rotation")?m=t.rotation:n&&(m=n.rotation);let y=0;y=u?.targetGeometry!=null&&u.targetGeometry.type==="point"?u.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&i&&i.effectiveLODs?i.zoomToScale(t.zoom):Array.isArray(d)||d.type==="point"||d.type==="extent"&&d.width===0&&d.height===0?n.scale:o1(Sk(d.extent,r),l,m);const g=Jne(t.target??t);g&&(g.min&&g.min<y?y=g.min:g.max&&g.max>y&&(y=g.max));let v=new fs({targetGeometry:f,scale:y,rotation:m});return i&&(v=i.fit(v),i.constrainByGeometry(v),i.rotationEnabled||(v.rotation=n.rotation)),v}function Cr(t,e){const r=t.targetGeometry,i=e.targetGeometry;return r.x=i.x,r.y=i.y,r.spatialReference=i.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function Kne(t,e,r){return r?sr(t,.5*(e[0]-r.right+r.left),.5*(e[1]-r.bottom+r.top)):uy(t,e,.5)}const Qne=(function(){const t=ut();return function(e,r,i){const s=r.targetGeometry;XM(t,s);const n=.5*np(r);return e.xmin=t[0]-n*i[0],e.ymin=t[1]-n*i[1],e.xmax=t[0]+n*i[0],e.ymax=t[1]+n*i[1],e.spatialReference=s.spatialReference,e}})();function Xne(t,e,r,i,s){return f$(t,e,r.center),t.scale=o1(r,i),s?.constraints?.constrain(t),t}function eoe(t,e,r,i){return r3(t,e,r,i),WM(t,t)}const t6=(function(){const t=ut();return function(e,r,i){return fM(e,ioe(e,r),Kne(t,r,i))}})(),toe=(function(){const t=Ln(),e=ut();return function(r,i,s,n){const o=np(i),l=e3(i);return sr(e,o,o),Hj(t,e),_y(t,t,l),Lh(t,t,t6(e,s,n)),Lh(t,t,[0,n.top-n.bottom]),sr(r,t[4],t[5])}})();function np(t){return t.scale*r6(t.targetGeometry?.spatialReference)}function r6(t){return Ni(t)?1/(e6(t)*Qj*Kj):1}function e3(t){return pM(t.rotation)||0}function roe(t){return Ni(t)?e6(t)*Qj*Kj:1}function ioe(t,e){return uy(t,e,.5)}const t3=(function(){const t=ut(),e=ut(),r=ut();return function(i,s,n,o,l,u){return cN(t,s),uy(e,n,.5*u),sr(r,1/o*u,-1/o*u),ZM(i,e),l&&_y(i,i,l),n1(i,i,r),Lh(i,i,t),i}})(),r3=(function(){const t=ut();return function(e,r,i,s){const n=np(r),o=e3(r);return XM(t,r.targetGeometry),t3(e,t,i,n,o,s)}})(),soe=(function(){const t=ut();return function(e,r,i,s){const n=np(r);return XM(t,r.targetGeometry),t3(e,t,i,n,0,s)}})();function i6(t){const e=Kr(t);return e?e.valid[1]-e.valid[0]:0}function noe(t,e){return Math.round(i6(t)/e)}const ooe=(function(){const t=ut(),e=ut(),r=[0,0,0];return function(i,s,n){Mm(t,i,s),wS(t,t),Mm(e,i,n),wS(e,e),hN(r,t,e);let o=Math.acos(dN(t,e)/(Rv(t)*Rv(e)))*Zne;return r[2]<0&&(o=-o),isNaN(o)&&(o=0),o}})(),aoe=(function(){const t=ut();return function(e,r,i,s){const n=e.targetGeometry;return Cr(e,r),toe(t,r,i,s),n.x+=t[0],n.y+=t[1],e}})(),f$=function(t,e,r){Cr(t,e);const i=t.targetGeometry;return i.x=r.x,i.y=r.y,i.spatialReference=r.spatialReference,t},loe=(function(){const t=ut();return function(e,r,i,s,n){n||(n="center"),fM(t,i,s),uy(t,t,.5);const o=t[0],l=t[1];switch(n){case"center":sr(t,0,0);break;case"left":sr(t,-o,0);break;case"top":sr(t,0,l);break;case"right":sr(t,o,0);break;case"bottom":sr(t,0,-l);break;case"top-left":sr(t,-o,l);break;case"bottom-left":sr(t,-o,-l);break;case"top-right":sr(t,o,l);break;case"bottom-right":sr(t,o,-l)}return a1(e,r,t),e}})();function Fxe(t,e,r){return Cr(t,e),t.rotation+=r,t}function uoe(t,e,r){return Cr(t,e),t.rotation=r,t}const coe=(function(){const t=ut();return function(e,r,i,s,n){return Cr(e,r),isNaN(i)||i===0||(n6(t,s,r,n),e.scale=r.scale*i,o6(t,t,e,n),a1(e,e,sr(t,t[0]-s[0],s[1]-t[1]))),e}})();function $k(t,e,r){return Cr(t,e),t.scale=r,t}const s6=(function(){const t=ut();return function(e,r,i,s,n,o){return Cr(e,r),isNaN(i)||i===0||(n6(t,n,r,o),e.scale=r.scale*i,e.rotation+=s,o6(t,t,e,o),a1(e,e,sr(t,t[0]-n[0],n[1]-t[1]))),e}})(),Nxe=(function(){const t=ut(),e=ut();return function(r,i,s,n,o,l,u){return t6(e,l,u),oN(t,o,e),n?s6(r,i,s,n,t,l):coe(r,i,s,t,l)}})(),n6=(function(){const t=Ln();return function(e,r,i,s){return In(e,r,eoe(t,i,s,1))}})(),o6=(function(){const t=Ln();return function(e,r,i,s){return In(e,r,r3(t,i,s,1))}})(),a1=(function(){const t=ut(),e=Ln();return function(r,i,s){Cr(r,i);const n=np(i),o=r.targetGeometry;return Bj(e,e3(i)),n1(e,e,by(n,n)),In(t,s,e),o.x+=t[0],o.y+=t[1],r}})();function a6(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function doe(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function hoe(t,e,r,i,s,n){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o[4]=s,o[5]=n,o}function l6(t,e,r,i){const s=e[i],n=e[i+1];t[i]=r[0]*s+r[2]*n+r[4],t[i+1]=r[1]*s+r[3]*n+r[5]}function poe(t,e,r,i=0,s=0,n=2){const o=s||e.length/n;for(let l=i;l<o;l++)l6(t,e,r,l*n)}Object.freeze(Object.defineProperty({__proto__:null,clone:doe,create:a6,fromValues:hoe,transform:l6,transformMany:poe},Symbol.toStringTag,{value:"Module"}));function M0(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function foe(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function moe(t,e,r,i,s,n,o,l,u){const d=new Float32Array(9);return d[0]=t,d[1]=e,d[2]=r,d[3]=i,d[4]=s,d[5]=n,d[6]=o,d[7]=l,d[8]=u,d}Object.freeze(Object.defineProperty({__proto__:null,clone:foe,create:M0,fromValues:moe},Symbol.toStringTag,{value:"Module"}));function u6(){return new Float32Array(2)}function yoe(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function Fh(t,e){const r=new Float32Array(2);return r[0]=t,r[1]=e,r}function c6(){return u6()}function d6(){return Fh(1,1)}function h6(){return Fh(1,0)}function p6(){return Fh(0,1)}const goe=c6(),voe=d6(),woe=h6(),boe=p6();Object.freeze(Object.defineProperty({__proto__:null,ONES:voe,UNIT_X:woe,UNIT_Y:boe,ZEROS:goe,clone:yoe,create:u6,fromValues:Fh,ones:d6,unitX:h6,unitY:p6,zeros:c6},Symbol.toStringTag,{value:"Module"}));function _oe(t){return t instanceof Float32Array&&t.length>=2}function Soe(t){return Array.isArray(t)&&t.length>=2}function Ib(t){return _oe(t)||Soe(t)}var m$;const Gn=[0,0];let so=m$=class extends F{constructor(t){super(t),this._viewpoint2D={center:ut(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new he,this.id=0,this.inverseTransform=Ln(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=Ln(),this.transformNoRotation=Ln(),this.displayMat3=M0(),this.displayViewMat3=M0(),this.viewMat3=M0(),this.viewMat2d=a6(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,r=t.targetGeometry;e.center[0]=r.x,e.center[1]=r.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=r.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,r=this.viewpoint;return r&&e?(this.viewpoint=Cr(r,t.viewpoint),this._set("size",Od(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new m$({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,r){return Ib(e)?In(t,e,this.inverseTransform):(Gn[0]=e,Gn[1]=r,In(t,Gn,this.inverseTransform))}toScreen(t,e,r){return Ib(e)?In(t,e,this.transform):(Gn[0]=e,Gn[1]=r,In(t,Gn,this.transform))}toScreenNoRotation(t,e,r){return Ib(e)?In(t,e,this.transformNoRotation):(Gn[0]=e,Gn[1]=r,In(t,Gn,this.transformNoRotation))}wrapMapCoordinate(t,e){Od(t,e);const[r]=e,[i]=this.center,{extent:s,spatialReference:n}=this;let{xmin:o,xmax:l}=s;if(n.isWrappable){const u=i6(n)/2;o=Math.max(o,i-u),l=Math.min(l,i+u)}return(r<o||r>l)&&(t[0]=KM(r,i,n)),t}getScreenTransform(t,e){const{center:r}=this._viewpoint2D,i=this._get("pixelRatio")||1,s=this._get("size");return t3(t,r,s,e,0,i),t}_update(){const{center:t,spatialReference:e,scale:r,rotation:i}=this._viewpoint2D,s=this._get("pixelRatio")||1,n=this._get("size"),o=new fs({targetGeometry:new ee(t[0],t[1],e),scale:r,rotation:i});if(this._set("viewpoint",o),!n||!e||!r)return;this.resolution=np(o),this.rotation=i,this.scale=r,this.spatialReference=e,Od(this.center,t);const l=n[0]!==0?2/n[0]:0,u=n[1]!==0?-2/n[1]:0;kd(this.displayMat3,l,0,0,0,u,0,-1,1,1);const d=vN(this.viewMat3),p=Fh(n[0]/2,n[1]/2),f=Fh(-n[0]/2,-n[1]/2),m=pM(i);_S(d,d,p),_N(d,d,m),_S(d,d,f),Em(this.displayViewMat3,this.displayMat3,d);const y=ZM(this.viewMat2d,p);return _y(y,y,m),Lh(y,y,f),Qne(this.extent,o,n),r3(this.transform,o,n,s),WM(this.inverseTransform,this.transform),soe(this.transformNoRotation,o,n,s),this.worldScreenWidth=noe(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};a([c({readOnly:!0})],so.prototype,"id",void 0),a([c({value:1,json:{write:!0}})],so.prototype,"pixelRatio",null),a([c({json:{write:!0}})],so.prototype,"size",null),a([c()],so.prototype,"spatialReference",void 0),a([c({type:fs,json:{write:!0}})],so.prototype,"viewpoint",null),a([c({readOnly:!0})],so.prototype,"visibleArea",null),so=m$=a([b("esri.views.2d.ViewState")],so);const xk=so;var y$,g$;let Io=y$=class extends X{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new y$({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};a([c()],Io.prototype,"left",void 0),a([c()],Io.prototype,"top",void 0),a([c()],Io.prototype,"right",void 0),a([c()],Io.prototype,"bottom",void 0),Io=y$=a([b("esri.views.2d.PaddedViewState.Padding")],Io);let Lc=g$=class extends xk{constructor(...t){super(...t),this.paddedViewState=new xk,this._updateContent=(()=>{const e=ut();return()=>{const r=this._get("size"),i=this._get("padding");if(!r||!i)return;const s=this.paddedViewState;sr(e,i.left+i.right,i.top+i.bottom),Mm(e,r,e),Od(s.size,e);const n=s.viewpoint;n&&(this.viewpoint=n)}})(),this.addHandles(ne(()=>[this.size,this.padding],()=>this._updateContent(),jn)),this.padding=new Io,this.size=[0,0]}set padding(t){this._set("padding",t||new Io)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const r=this._get("padding");r&&(e=aoe(t.clone(),t,this._get("size"),r));const{targetGeometry:i,rotation:s,scale:n}=e,{x:o,y:l,spatialReference:u}=i,d=this._viewpoint2D;d.center[0]=o,d.center[1]=l,d.rotation=s,d.scale=n,d.spatialReference=u,this._update()}}clone(){return new g$({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};a([c()],Lc.prototype,"paddedViewState",void 0),a([c({type:Io})],Lc.prototype,"padding",null),a([c()],Lc.prototype,"viewpoint",null),Lc=g$=a([b("esri.views.2d.PaddedViewState")],Lc);const i3=Lc;let ff=class extends X{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};a([c()],ff.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),a([c()],ff.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),ff=a([b("esri.views.support.debugFlags")],ff);const $oe=new ff,f6=Symbol("Yield");let xoe=class{constructor(){this._tasks=new Array,this._numPendingTasks=Ph(0),this._readyToRun=Ph(!1)}get length(){return this._tasks.length}get updating(){return this._numPendingTasks.value>0}get readyToRun(){return this._readyToRun.value}_updateReadyToRun(){this._readyToRun.value=this._tasks.length>0}destroy(){this.cancelAll()}runTask(e){if(this.length===0)return f6;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,r,i){return this._addTask((s,n)=>new Mk(s,n,e,r,i),Array.prototype.push)}unshift(e,r,i){return this._addTask((s,n)=>new Mk(s,n,e,r,i),Array.prototype.unshift)}pushGenerator(e,r,i){return this._addTask((s,n)=>new Toe(s,n,e,r,i),Array.prototype.push)}_process(e){if(this._tasks.length===0)return!1;const r=this._tasks.shift();this._updateReadyToRun();try{if(Pr(r.signal))this._cancelTask(r,Fe());else switch(r.type){case 0:this._processSimple(r,e);break;case 1:this._processGenerator(r,e);break;case 2:this._processIterator(r,e);break;default:}}catch(i){r.reject(i)}return!0}cancelAll(){const e=Fe();for(const r of this._tasks)this._cancelTask(r,e);this._tasks.length=0,this._updateReadyToRun()}_cancelTask(e,r){if(e.abortCallback){const i=e.abortCallback(r);e.type===2&&e.iterator.return&&Tk(e.iterator.return()),Ar(i)?i.then(e.resolve,e.reject):e.resolve(i)}else e.type===2&&e.iterator.throw&&Tk(e.iterator.throw(r)),e.reject(r)}_onIteratorResult(e,r){r.done?e.resolve(r.value):(this._tasks.unshift(e),this._updateReadyToRun())}_processSimple(e,r){const i=e.callback(r);Ar(i)?i.then(e.resolve,e.reject):e.resolve(i)}_processGenerator(e,r){const i=e.generatorFunction(r),s=new Moe(e.resolve,e.reject,i,e.signal,e.abortCallback);this._processIterator(s,r)}_processIterator(e,r){const i=e.iterator.next(r);Ar(i)?i.then(s=>this._onIteratorResult(e,s),e.reject):this._onIteratorResult(e,i)}_addTask(e,r){return new Promise((i,s)=>{const n=e(i,s);r.call(this._tasks,n),++this._numPendingTasks.value,this._updateReadyToRun()}).finally(()=>--this._numPendingTasks.value)}};function Tk(t){Ar(t)?t.then(Eb,Eb):Eb(t)}function Eb(t){nr(t)||t instanceof Error||t instanceof x||t!=null&&typeof t=="object"&&"done"in t&&t.done||L.getLogger("esri.layers.support.PromiseQueue").warn("Generator iterator was aborted, but it is not done.")}let s3=class{constructor(e,r,i=void 0,s=void 0){this.resolve=e,this.reject=r,this.signal=i,this.abortCallback=s}},Mk=class extends s3{constructor(e,r,i,s,n){super(e,r,s,n),this.callback=i,this.type=0}},Toe=class extends s3{constructor(e,r,i,s,n){super(e,r,s,n),this.generatorFunction=i,this.type=1}},Moe=class extends s3{constructor(e,r,i,s,n){super(e,r,s,n),this.iterator=i,this.type=2}};function Ioe(){return new Poe}const ge={RESOURCE_CONTROLLER_IMMEDIATE:"immediate",RESOURCE_CONTROLLER:"schedule",SLIDE:"slide",STREAM_DATA_LOADER:"stream loader",ELEVATION_QUERY:"elevation query",TERRAIN_SURFACE:"terrain",SURFACE_GEOMETRY_UPDATES:"surface geometry updates",LOD_RENDERER:"LoD renderer",GRAPHICS_CORE:"Graphics3D",I3S_CONTROLLER:"I3S",POINT_CLOUD_LAYER:"point cloud",FEATURE_TILE_FETCHER:"feature fetcher",STREAM_CONTROLLER:"stream controller",OVERLAY:"overlay",OVERLAY_RENDERER:"overlay renderer",STAGE:"stage",GRAPHICS_DECONFLICTOR:"graphics deconflictor",FILTER_VISIBILITY:"Graphics3D filter visibility",SCALE_VISIBILITY:"Graphics3D scale visibility",FRUSTUM_VISIBILITY:"Graphics3D frustum visibility",POINT_OF_INTEREST_FREQUENT:"POI frequent",POINT_OF_INTEREST_INFREQUENT:"POI infrequent",LABELER:"labeler",FEATURE_QUERY_ENGINE:"feature query",FEATURE_TILE_TREE:"feature tile tree",FEATURE_TILE_TREE_ACTIVE:"fast feature tile tree",ELEVATION_ALIGNMENT:"elevation alignment",ELEVATION_ALIGNMENT_SCENE:"elevation alignment scene",TEXT_TEXTURE_ATLAS:"text texture atlas",TEXTURE_UNLOAD:"texture unload",LINE_OF_SIGHT_TOOL:"line of sight tool",LINE_OF_SIGHT_TOOL_INTERACTIVE:"interactive line of sight tool",ELEVATION_PROFILE:"elevation profile",SNAPPING:"snapping",SHADOW_ACCUMULATOR:"shadow accumulator",CLOUDS_GENERATOR:"clouds generator",FLOW_GENERATOR:"flow generator",MAPVIEW_FETCH_QUEUE:"mapview fetch queue",MAPVIEW_LAYERVIEW_UPDATE:"mapview layerview update",MAPVIEW_VECTOR_TILE_PARSING_QUEUE:"mapview vector tile parsing queue",NONE:0,TEST_PRIO:1},rs=0,Ik=new Map([[ge.RESOURCE_CONTROLLER_IMMEDIATE,rs],[ge.RESOURCE_CONTROLLER,4],[ge.SLIDE,rs],[ge.STREAM_DATA_LOADER,rs],[ge.ELEVATION_QUERY,rs],[ge.TERRAIN_SURFACE,1],[ge.SURFACE_GEOMETRY_UPDATES,1],[ge.LOD_RENDERER,2],[ge.GRAPHICS_CORE,2],[ge.I3S_CONTROLLER,2],[ge.POINT_CLOUD_LAYER,2],[ge.FEATURE_TILE_FETCHER,2],[ge.STREAM_CONTROLLER,2],[ge.CLOUDS_GENERATOR,2],[ge.OVERLAY,4],[ge.OVERLAY_RENDERER,4],[ge.STAGE,4],[ge.GRAPHICS_DECONFLICTOR,4],[ge.FILTER_VISIBILITY,4],[ge.SCALE_VISIBILITY,4],[ge.FRUSTUM_VISIBILITY,4],[ge.POINT_OF_INTEREST_FREQUENT,6],[ge.POINT_OF_INTEREST_INFREQUENT,30],[ge.LABELER,8],[ge.FEATURE_QUERY_ENGINE,8],[ge.FEATURE_TILE_TREE,16],[ge.FEATURE_TILE_TREE_ACTIVE,rs],[ge.ELEVATION_ALIGNMENT,12],[ge.ELEVATION_ALIGNMENT_SCENE,14],[ge.TEXT_TEXTURE_ATLAS,12],[ge.TEXTURE_UNLOAD,12],[ge.LINE_OF_SIGHT_TOOL,16],[ge.LINE_OF_SIGHT_TOOL_INTERACTIVE,rs],[ge.SNAPPING,rs],[ge.SHADOW_ACCUMULATOR,30],[ge.FLOW_GENERATOR,12],[ge.MAPVIEW_FETCH_QUEUE,rs],[ge.MAPVIEW_LAYERVIEW_UPDATE,2],[ge.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,rs]]);function Ek(t){return Ik.has(t)?Ik.get(t):typeof t=="number"?t:1}const Eoe=6.5,Ok=1,Ooe=30,koe=1e3/30,Coe=100,kk=.9;let Poe=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(e=>e.needsUpdate)}constructor(){this._updating=Ph(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new Df("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new m6,this.state=1,this._tasks=new Array,this._runQueue=new Array,this._load=0,this._forceTask=!1,this._debug=!1,this._debugHandle=ne(()=>$oe.SCHEDULER_LOG_SLOW_TASKS,e=>this._debug=e,Ot);for(const e of Object.keys(ge))this.performanceInfo.tasks.set(ge[e],new Df(String(ge[e])))}destroy(){this._tasks.forEach(e=>e.remove()),this._tasks.length=0,this._runQueue.length=0,He(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())}))}registerTask(e,r){const i=new Aoe(this,e,r);return this._tasks.push(i),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new Df(e)),i}get load(){return this._load}frame(e){if(this._startFrameTaskTimes(),this._updateBudget(e)){const r=this._budget.now();return this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-r),!0}return this._recordFrameTaskTimes(0),!1}_updateBudget(e){this._test&&(this._test.usedBudget=0),++this._frameNumber;let r=Eoe,i=e.frameDuration,s=Ok;switch(this.state){case 2:r=0,i=Math.max(Coe,e.frameDuration),s=Ooe;break;case 1:i=Math.max(koe,e.frameDuration)}return i=i-e.elapsedFrameTime-r,this.state!==2&&i<Ok&&!this._forceTask?(this._forceTask=!0,!1):(i=Math.max(i,s),this._budget.reset(i),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case 2:this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(0),this._budget.madeProgress()}removeTask(e){m_(this._tasks,e),m_(this._runQueue,e),this._updatingChanged()}_updateTask(e){this._tasks.forEach(r=>{r.name===e&&r.setPriority(e)})}_getState(e){if(this._runQueue.some(i=>i.name===e))return"s";let r="i";return this._tasks.forEach(i=>{i.name===e&&i.needsUpdate&&(i.schedulePriority<=1?r="r":r!=="r"&&(r="w"))}),r}_getRuntime(e){let r=0;return this._tasks.forEach(i=>{i.name===e&&(r+=i.runtime)}),r}_resetRuntimes(){this._tasks.forEach(e=>e.runtime=0)}_getRunning(){const e=new Map;if(this._tasks.forEach(i=>{i.needsUpdate&&e.set(i.name,(e.get(i.name)||0)+1)}),e.size===0)return null;let r="";return e.forEach((i,s)=>{r+=i>1?` ${i}x ${s}`:` ${s}`}),r}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce((r,i)=>i.needsUpdate?++r:r,0);this._load=this._load*kk+e*(1-kk)}_schedule(){for(mU(this._runQueue,e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1)),this._tasks.forEach(e=>{e.basePriority===rs&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)});this._runQueue.length===0;){let e=!1,r=0;if(this._tasks.forEach(i=>{i.needsUpdate&&i.schedulePriority!==0&&i.basePriority!==rs&&i.blockFrame!==this._frameNumber&&(e=!0,r=Math.max(r,i.basePriority),i.schedulePriority===1?(i.schedulePriority=0,this._runQueue.push(i)):--i.schedulePriority)}),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do for(;this._runQueue.length>0;){const e=this._budget.now(),r=this._runQueue.pop();this._budget.resetProgress();try{r.task.runTask(this._budget)===f6&&(r.blockFrame=this._frameNumber)}catch(s){L.getLogger("esri.views.support.Scheduler").error(`Exception in task "${r.name}"`,s),r.blockFrame=this._frameNumber}!this._budget.hasProgressed&&r.blockFrame!==this._frameNumber&&r.needsUpdate&&(r.name,r.blockFrame=this._frameNumber),r.schedulePriority=r.basePriority;const i=this._budget.now()-e;if(r.runtime+=i,this._frameTaskTimes.set(r.priority,this._frameTaskTimes.get(r.priority)+i),this._budget.remaining<=0)return void this._updatingChanged()}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const e of Object.keys(ge))this._frameTaskTimes.set(ge[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach((r,i)=>this.performanceInfo.tasks.get(i).push(r)),this.performanceInfo.total.push(e)}get test(){return this._test}},Aoe=class{get task(){return this._task.value}get readyToRun(){return this._queue.readyToRun}get updating(){return this._queue.updating}constructor(e,r,i){this._scheduler=e,this.name=r,this.blockFrame=0,this.runtime=0,this._queue=new xoe,this._handles=new Bh,this._basePriority=Ek(r),this.schedulePriority=this._basePriority,this._task=Ph(i??this._queue),this._handles.add(Gi(()=>this.task.readyToRun,s=>e.taskRunningChanged(s)))}remove(){this.processQueue(am),this._scheduler.removeTask(this),this.schedule=Ob.schedule,this.reschedule=Ob.reschedule,this.scheduleGenerator=Ob.scheduleGenerator,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const r=Ek(e);this._basePriority!==rs&&this.schedulePriority===0||(this.schedulePriority=r),this._basePriority=r}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.readyToRun||!this.task.destroyed&&this.task.readyToRun}schedule(e,r,i){return this._queue.push(e,r,i)}reschedule(e,r,i){return this._queue.unshift(e,r,i)}scheduleGenerator(e,r,i){return this._queue.pushGenerator(e,r,i)}processQueue(e){return this._queue.runTask(e)}},m6=class{constructor(){this._begin=performance?.now()??0,this._budget=0,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(e()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e){this._begin=this.now(),this._budget=e,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}};const am=new m6;am.enabled=!1;let Roe=class{remove(){}processQueue(){}schedule(e,r,i){try{if(Pr(r)){const s=Fe();return i?Promise.resolve(i(s)):Promise.reject(s)}return __(e(am))}catch(s){return Promise.reject(s)}}reschedule(e,r,i){return this.schedule(e,r,i)}async scheduleGenerator(e,r,i){if(Pr(r)){const n=Fe();if(i)return i(n);throw n}const s=e(am);for(;;){const n=s.next(am),o=Ar(n)?await n:n;if(Pr(r)){const l=Fe();if(i){const d=i(l),p=s.return(null);return Ar(p)&&await vh(p),d}const u=s.throw(l);throw Ar(u)&&await vh(u),l}if(o.done)return o.value}}};const Ob=new Roe;let Loe=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=Ioe(),this._schedulerHandle=Gi(()=>this._scheduler.updating,()=>this.requestFrame()),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),this.view.animation?.target==null||Ar(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=r=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:i,graphicsView:s,labelManager:n,state:{id:o}}=this.view;i?.forEach(this._updateLayerView,this),n!=null&&(n.lastUpdateId!==o&&(n.viewChange(),n.lastUpdateId=o),n.updateRequested&&n.processUpdate(this._updateParameters)),s!=null&&(s.lastUpdateId!==o&&(s.viewChange(),s.lastUpdateId=o),s.updateRequested&&s.processUpdate(this._updateParameters)),this.view.graphicsTileStore?.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=0:this.view.interacting?this._scheduler.state=1:this._scheduler.state=2,this._scheduler.frame(r)||this._updateRequested||this._scheduler.state!==2||this._frameTaskHandle?.pause()}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new i3,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=ne(()=>e.stationary,r=>{this.stationary=r,this.requestFrame()}),this._frameTaskHandle=bh(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){if(!e.attached)return void this.requestUpdate();const r=this.view.state,i=e.lastUpdateId;i!=null&&(this.stationary||e.moving)||(e.moving=!0),i!==r.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=r.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews?.forEach(this._updateLayerView,this)}};function Foe(t,e){const{spatialReference:r}=e,i=[e.x,e.y];let s,n,o,l;const u=[0,0],d=Noe(t);for(let m=0;m<d.length;m++){const y=d[m];for(let g=0;g<y.length-1;g++){BJ(u,i,y,g);const v=Gw(i,u);(s==null||v<s)&&(s=v,n=[...u],o=m,l=g)}}if(s==null||!n||o==null||l==null)throw new x("nearest-coordinate:failed","Failed to find the nearest coordinate");const[p,f]=n;return{coordinate:new ee({x:p,y:f,spatialReference:r}),distance:s}}function Noe(t){switch(t.type){case"extent":return[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]];case"polygon":return t.rings;case"polyline":return t.paths}}var v$;let Kl=v$=class extends sM(X){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return ll(this.geometry,this.spatialReference)}catch(t){return L.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const r=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?sy(this.normalizedGeometry,r):UT(this.normalizedGeometry,r))return t;const{coordinate:i}=Foe(this.normalizedGeometry,r);return i&&(t.targetGeometry=i),t}clone(){return new v$({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};a([c({constructOnly:!0})],Kl.prototype,"geometry",void 0),a([c({readOnly:!0})],Kl.prototype,"normalizedGeometry",null),a([c({constructOnly:!0})],Kl.prototype,"spatialReference",void 0),Kl=v$=a([b("esri.views.2d.constraints.GeometryConstraint")],Kl);var w$;let mf=w$=class extends sM(X){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new w$({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};a([c()],mf.prototype,"enabled",void 0),a([c()],mf.prototype,"rotationEnabled",void 0),mf=w$=a([b("esri.views.2d.constraints.RotationConstraint")],mf);const y6=mf;var b$;let ii=b$=class extends sM(X){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:r,maxScale:i,minZoom:s,maxZoom:n}=this,o=-1,l=-1,u=!1,d=!1;if(r!==0&&i!==0&&r<i&&([r,i]=[i,r]),!e?.length)return this._set("effectiveMinScale",r),void this._set("effectiveMaxScale",i);e=e.map(p=>p.clone()),e.sort((p,f)=>f.scale-p.scale),e.forEach((p,f)=>p.level=f);for(const p of e)!u&&r>0&&r>=p.scale&&(o=p.level,u=!0),!d&&i>0&&i>=p.scale&&(l=t?t.level:-1,d=!0),t=p;s===-1&&(s=r===0?0:o),n===-1&&(n=i===0?e.length-1:l),s=Math.max(s,0),s=Math.min(s,e.length-1),n=Math.max(n,0),n=Math.min(n,e.length-1),s>n&&([s,n]=[n,s]),r=e[s].scale,i=e[n].scale,e.splice(0,s),e.splice(n-s+1),e.forEach((p,f)=>{this._lodByScale[p.scale]=p,this._scales[f]=p.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",s),this._set("effectiveMaxZoom",n),this._set("effectiveMinScale",r),this._set("effectiveMaxScale",i)}constrain(t,e){if(e&&t.scale===e.scale)return t;const r=this.effectiveMinScale,i=this.effectiveMaxScale,s=t.targetGeometry,n=e&&e.targetGeometry,o=i!==0&&t.scale<i,l=r!==0&&t.scale>r;if(o||l){const u=l?r:i;if(e&&n){const d=(u-e.scale)/(t.scale-e.scale);s.x=n.x+(s.x-n.x)*d,s.y=n.y+(s.y-n.y)*d}t.scale=u}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),r=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(r>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const r=Math.floor(t),i=Math.ceil(t);return e[r]+(t-r)*(e[i]-e[r])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let r,i;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let s=0;s<e.length-1;s++){if(r=e[s],i=e[s+1],i===t)return s+this.effectiveMinZoom+1;if(r>t&&i<t)return s+this.effectiveMinZoom+1-(t-i)/(r-i)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const r=Math.round(this.scaleToZoom(t));return this.zoomToScale(r+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const r=Math.round(this.scaleToZoom(t));return this.zoomToScale(r-1)}clone(){return new b$({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,r)=>Math.abs(r-t)<=Math.abs(e-t)?r:e,this._scales[0])),this._lodByScale[t].scale}};a([c({readOnly:!0})],ii.prototype,"effectiveLODs",void 0),a([c({readOnly:!0})],ii.prototype,"effectiveMinZoom",void 0),a([c({readOnly:!0})],ii.prototype,"effectiveMaxZoom",void 0),a([c({readOnly:!0})],ii.prototype,"effectiveMinScale",void 0),a([c({readOnly:!0})],ii.prototype,"effectiveMaxScale",void 0),a([c()],ii.prototype,"lods",void 0),a([c()],ii.prototype,"minZoom",void 0),a([c()],ii.prototype,"maxZoom",void 0),a([c()],ii.prototype,"minScale",void 0),a([c()],ii.prototype,"maxScale",void 0),a([c()],ii.prototype,"snapToZoom",void 0),ii=b$=a([b("esri.views.2d.constraints.ZoomConstraint")],ii);const g6=ii,Doe={base:null,key:"type",typeMap:{extent:he,polygon:Be}};let ft=class extends X{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new H}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const e=this._get("_geometry");return e&&this.geometry===e.geometry&&this.view?.constraintsInfo.spatialReference===e.spatialReference?e:new Kl({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new y6({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),r=this.lods||this.view?.constraintsInfo.lods,i=this.minZoom,s=this.maxZoom,n=this.minScale,o=this.maxScale,l=this.snapToZoom;return e&&e.lods===r&&e.minZoom===i&&e.maxZoom===s&&e.minScale===n&&e.maxScale===o&&e.snapToZoom===l?e:new g6({lods:r,minZoom:i,maxZoom:s,minScale:n,maxScale:o,snapToZoom:l})}canZoomInTo(e){const r=this.effectiveMaxScale;return r===0||e>=r}canZoomOutTo(e){const r=this.effectiveMinScale;return r===0||e<=r}constrain(e,r){return this._zoom.constrain(e,r),this._rotation.constrain(e,r),this._geometry.constrain(e,r),this.customConstraints.forEach(i=>i.constrain(e,r)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(r=>r.applyPanConstraint?.(e)),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};a([c({readOnly:!0})],ft.prototype,"effectiveLODs",null),a([c({readOnly:!0})],ft.prototype,"effectiveMinScale",null),a([c({readOnly:!0})],ft.prototype,"effectiveMaxScale",null),a([c({readOnly:!0})],ft.prototype,"effectiveMinZoom",null),a([c({readOnly:!0})],ft.prototype,"effectiveMaxZoom",null),a([c({types:Doe,value:null})],ft.prototype,"geometry",null),a([c({type:[pr]})],ft.prototype,"lods",void 0),a([c()],ft.prototype,"minScale",void 0),a([c()],ft.prototype,"maxScale",void 0),a([c()],ft.prototype,"minZoom",void 0),a([c()],ft.prototype,"maxZoom",void 0),a([c()],ft.prototype,"rotationEnabled",void 0),a([c()],ft.prototype,"snapToZoom",void 0),a([c({type:H})],ft.prototype,"customConstraints",void 0),a([c()],ft.prototype,"view",void 0),a([c({readOnly:!0})],ft.prototype,"version",null),a([c({type:Kl,readOnly:!0})],ft.prototype,"_geometry",null),a([c({type:y6})],ft.prototype,"_rotation",null),a([c({readOnly:!0,type:g6})],ft.prototype,"_zoom",null),ft=a([b("esri.views.2d.MapViewConstraints")],ft);const Ck=ft;let br=class extends X{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([ne(()=>this.constraints?.version,r=>{this.constraints&&r&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},jn)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:r}=this.state.paddedViewState;return this.state.commitProperty("id"),new ee({x:e[0],y:e[1],spatialReference:r})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let r;try{r=this._project(e,this.state.spatialReference)}catch(s){return void L.getLogger(this).error(new x("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:s}))}const i=this.viewpoint;f$(i,i,r),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void L.getLogger(this).error(new x("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let r;try{r=this._project(e,this.state.spatialReference)}catch(s){return void L.getLogger(this).error(new x("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:s}))}const i=this.viewpoint;Xne(i,i,r,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const r=this.viewpoint;uoe(r,r,e),this.viewpoint=r}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const i=this._get("extent");return void(i&&(this._set("extent",void 0),this._set("center",i.center)))}const r=this.viewpoint;$k(r,r,e),this.viewpoint=r}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let r,i;try{r=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?i=new x("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(i=new x("mapview:invalid-viewpoint","geometry not defined"))}catch(n){i=new x("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:n})}if(i)return void L.getLogger(this).error(i);this._scaleBeforeChangingSpatialReference=null;const s=new fs({targetGeometry:new ee,scale:0,rotation:0});Cr(s,r),this.constraints?.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this._set("viewpoint",s)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(e){if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const s=this._get("extent");return void(s&&(this._set("extent",void 0),this._set("center",s.center)))}const r=this.constraints?.zoomToScale(e)??0;if(!r)return void this._set("zoom",-1);const i=this.viewpoint;$k(i,i,r),this.viewpoint=i,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:r,constraints:i}=this,s=this._get("center"),n=this._get("extent"),o=this._get("scale"),l=this._get("rotation"),u=this._get("viewpoint"),d=this._get("zoom"),p=d!=null&&i!=null&&i.zoomToScale(d)||void 0;let f,m,y;const g=u?.rotation,v=u?.targetGeometry;v?.type==="extent"?f=v:v?.type==="point"&&(m=v,y=u?.scale);const _=n??f;return{center:s??m??_?.center,rotation:l??g,scale:(o??p??y??(_&&o1(_,[e[0]-r.left-r.right,e[1]-r.top-r.bottom])))||void 0}}startup(e,r,i,s){const n=e.targetGeometry;try{this._project(e,i)}catch(o){L.getLogger(this).warn(new qi("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:n.toJSON(),spatialReference:i,error:o})),e.targetGeometry=s||new ee({x:0,y:0,spatialReference:i})}this.constraints?.fit(e),this._set("state",new i3({padding:this.padding,size:r,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,r],spatialReference:i,rotation:s,scale:n}=this.state.paddedViewState,o=new ee({x:e,y:r,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("state",null)}changeSpatialReference(e){const r=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=r.scale;else{const u=r.viewpoint.clone();u.scale=this._scaleBeforeChangingSpatialReference,r.viewpoint=u}const i=r.clone(),[s,n]=r.center;let o=null;try{o=this._project(new ee({x:s,y:n,spatialReference:r.spatialReference}),e)}catch(u){NL()||L.getLogger(this).warn(new qi("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o?.toJSON(),spatialReference:e,error:u}))}o||(o=new ee({x:0,y:0,spatialReference:e}));const l=f$(new fs({targetGeometry:new ee,scale:0,rotation:0}),r.viewpoint,o);i.viewpoint=l;try{const d=[r.size[0]/2,r.size[1]/2],p=[d[0]+20,d[1]],f=r.toMap([0,0],p),{x:m,y}=this._project(new ee({x:f[0],y:f[1],spatialReference:r.spatialReference}),e);f[0]=m,f[1]=y,i.toScreen(f,f);const g=ooe(d,f,p),v=Math.hypot(f[0]-d[0],f[1]-d[1])/20;!Number.isFinite(v)||Math.abs(v)>4?(l.rotation=0,l.targetGeometry=new ee({x:0,y:0,spatialReference:e})):(l.scale*=v,l.scale>k("mapview-srswitch-adjust-rotation-scale-threshold")?l.rotation=0:l.rotation+=Number.isFinite(g)?g:0)}catch{}this._get("constraints")?.constrain(l,void 0),this._get("state").viewpoint=l}resize(e,r){if(!this.ready)return;const i=this.state;let s=this.state.paddedViewState.viewpoint;const n=this.state.paddedViewState.size.slice();i.size=[e,r],loe(s,s,n,this.state.paddedViewState.size,this.resizeAlign),s=this.constraints?.constrain(s,void 0)??s,this.state.viewpoint=s}toMap(e){if(!this.ready)return null;const r=[0,0],[i,s]=this.state.toMap(r,[e.x,e.y]),n=this.state.spatialReference;return new ee({x:i,y:s,spatialReference:n})}toScreen(e,r){if(!this.ready)return null;const i=this._project(e,this.state.spatialReference),s=[i.x,i.y];return r?.pickClosestTarget===!1||this.state.paddedViewState.wrapMapCoordinate(s,s),this.state.toScreen(s,s),Bt(s[0],s[1])}_project(e,r){const i=e?.targetGeometry||e;if(!r)return e;if(!i)return null;if(r.imageCoordinateSystem||i.spatialReference?.imageCoordinateSystem||Wt(r,i.spatialReference))return e;const s=ll(i,r);if(!s)throw new x("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:r});return joe(e)?(e.targetGeometry=s,e):s}};function joe(t){return t?.declaredClass==="esri.Viewpoint"}a([c({type:ee})],br.prototype,"center",null),a([c()],br.prototype,"constraints",void 0),a([c({type:he})],br.prototype,"extent",null),a([c({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],br.prototype,"padding",null),a([c()],br.prototype,"ready",void 0),a([c()],br.prototype,"resizeAlign",void 0),a([c({readOnly:!0})],br.prototype,"resolution",null),a([c({type:Number})],br.prototype,"rotation",null),a([c({type:Number})],br.prototype,"scale",null),a([c({readOnly:!0})],br.prototype,"state",void 0),a([c({type:fs})],br.prototype,"viewpoint",null),a([c({readOnly:!0})],br.prototype,"visibleArea",null),a([c()],br.prototype,"zoom",null),br=a([b("esri.views.2d.ViewStateManager")],br);const Pk=160;let yf=class extends X{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=Pk&&this.clear()},Pk))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};a([c()],yf.prototype,"_timer",void 0),a([c()],yf.prototype,"stationary",null),yf=a([b("esri.views.2d.support.StationaryManager")],yf);const Voe=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.fullOpacity=1,this.stateManager=new br({constraints:new Ck({view:this})}),this.stationaryManager=new yf,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new Loe(this),this.viewEvents=new Mj(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([ne(()=>this.viewpoint,()=>this.stationaryManager.flip(),jn)])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){return this.stateManager?.extent??null}set extent(i){this.stateManager.extent=i}get state(){return this.stateManager.state}get interacting(){return!1}get stationary(){return!this.animation&&this.stationaryManager.stationary}set animation(i){const s=this._get("animation");if(i===s)return;if(s&&s.stop(),i!==this.animationManager.animation&&this.animationManager.stop(),!i||i.isFulfilled())return void this._set("animation",null);this._set("animation",i);const n=()=>{this.destroyed||i===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};i.when(n,n)}get constraints(){return this.stateManager?.constraints}set constraints(i){i.view=this;const s=this.stateManager.constraints;this.stateManager.constraints=i,s?.destroy()}get padding(){return this.stateManager?.padding}set padding(i){this.stateManager&&(this.stateManager.padding=i)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(i){this.stateManager.resizeAlign=i}get rotation(){return this.stateManager.rotation??0}set rotation(i){const{rotationEnabled:s}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=i,this.constraints.rotationEnabled=s}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(i){this.stateManager.viewpoint=i,this.frameTask.requestFrame()}};return a([c({readOnly:!0})],r.prototype,"animationManager",void 0),a([c({readOnly:!0})],r.prototype,"fullOpacity",void 0),a([c()],r.prototype,"stateManager",void 0),a([c()],r.prototype,"constraintsInfo",null),a([c()],r.prototype,"extent",null),a([c({readOnly:!0})],r.prototype,"state",null),a([c({readOnly:!0})],r.prototype,"mapViewNavigation",void 0),a([c()],r.prototype,"renderingOptions",void 0),a([c({readOnly:!0})],r.prototype,"interacting",null),a([c()],r.prototype,"stationary",null),a([c()],r.prototype,"animation",null),a([c({type:Ck})],r.prototype,"constraints",null),a([c()],r.prototype,"padding",null),a([c()],r.prototype,"resizeAlign",null),a([c()],r.prototype,"rotation",null),a([c({readOnly:!0})],r.prototype,"viewEvents",void 0),a([c({type:fs})],r.prototype,"viewpoint",null),r=a([b("esri.views.Viewport2DBaseMixin")],r),r},zoe=()=>_e.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;var oh;let Fc=(oh=class extends AT{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=bi(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),this._resolver?.reject(new x("view:animation-stopped","ViewAnimation stopped")))}finish(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),this._resolver?.resolve())}update(e,r){r||(r=Ar(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",r)}},oh.state={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"},oh);a([c({readOnly:!0})],Fc.prototype,"done",null),a([c({readOnly:!0,type:String})],Fc.prototype,"state",void 0),a([c()],Fc.prototype,"target",void 0),Fc=a([b("esri.views.ViewAnimation")],Fc);const _$=Fc;let I0=class extends X{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,r){if(!e)return void L.getLogger(this).error("#goTo()","target cannot be null or undefined");const i=new _$;this.view.animation=i,await Nw(()=>this.view.ready,r);const s={...r,animate:r?.animate??(!zoe()&&this.view.animationsEnabled),animationMode:r?.animationMode??"auto"},{extent:n,spatialReference:o,size:l,viewpoint:u,constraints:d,padding:p,allLayerViews:f}=this.view,m=Yne(e,{extent:n,spatialReference:o,size:l,viewpoint:u,constraints:d,padding:p,allLayerViews:f,pickClosestTarget:r?.pickClosestTarget??!0});return i?.update(m),this._gotoTask={},s.animate?this._gotoAnimated(m,s):this._gotoImmediate(m,s)}_gotoImmediate(e,r){const i=this._gotoTask,s=this.view.animation,n=e.then(o=>{if(We(r),i!==this._gotoTask)throw new x("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=s.target=o,s.finish()});return this._cancellableGoTo(i,s,n,r)}_gotoAnimated(e,r){const i=this._gotoTask,s=this.view.animation;if(!s)return Promise.resolve();const n=e.then(o=>{if(We(r),i!==this._gotoTask)throw new x("view:goto-interrupted","Goto was interrupted");return s.update(o),this.view.animationManager.animate(s,this.view.viewpoint,r),s.when().then(()=>{},()=>{})});return this._cancellableGoTo(i,s,n,r)}_cancellableGoTo(e,r,i,s){const n=()=>e===this._gotoTask;return MR(i,s).finally(()=>{n()&&(r.done||r.stop())})}};a([c({constructOnly:!0})],I0.prototype,"view",void 0),I0=a([b("esri.views.2d.GoToManager")],I0);function v6(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}function w6(t,e){return e.some(r=>v6(t,r))}function Ak(t,{dragPrimary:e,dragSecondary:r,dragTertiary:i}){return[{key:"primary",value:e},{key:"secondary",value:r},{key:"tertiary",value:i}].filter(s=>s.value===t).map(s=>s.key)}let Rk=class extends Zt{constructor(e,r){super(!0),this._view=e,this.registerIncoming("double-click",r,i=>this._handleDoubleClick(i,r))}_handleDoubleClick(e,r){v6(e.data,"primary")&&(e.stopPropagation(),r?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},Uoe=class extends Zt{constructor(e,r,i){super(!0),this.view=e,this.pointerType=r,this.registerIncoming("double-tap-drag",i,s=>this._handleDoubleTapDrag(s))}_handleDoubleTapDrag(e){const{data:r}=e,{pointerType:i}=r;if(i!==this.pointerType)return;e.stopPropagation();const{action:s,delta:n}=r,{view:o}=this,{mapViewNavigation:l}=o;switch(s){case"begin":{const{scale:u}=o;this._startScale=u,this._currentScale=u,this._previousDelta=n,l.begin();break}case"update":{if(this._previousDelta.y===n.y)return;this._previousDelta=n;const u=1.015**n.y,d=this._startScale*u,p=d/this._currentScale;l.setViewpointImmediate(p),this._currentScale=d;break}case"end":{const{constraints:u}=o,{effectiveLODs:d,snapToZoom:p}=u;if(!p||!d)return void l.end();const f=u.snapScale(this._currentScale),m=(n.y>0?Math.max(f,u.snapToPreviousScale(this._startScale)):Math.min(f,u.snapToNextScale(this._startScale)))/this._currentScale;l.zoom(m).then(()=>{l.end()});break}}}},l1=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const r=e.data,i=r.pointers.size;switch(r.action){case"start":this._currentCount=i,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){this._startEvent=e,this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},qoe=class extends Zt{constructor(e,r,i){super(!0),this.view=e,this.pointerActions=r,this.registerIncoming("drag",i,s=>this._handleDrag(s)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new l1({start:(r,i)=>{this.view.mapViewNavigation.pan.begin(this.view,i.data),i.stopPropagation()},update:(r,i)=>{this.view.mapViewNavigation.pan.update(this.view,i.data),i.stopPropagation()},end:(r,i)=>{this.view.mapViewNavigation.pan.end(this.view,i.data),i.stopPropagation()},condition:(r,i)=>r===1&&w6(i.data,this.pointerActions)})}_handleDrag(e){const r=this.view.mapViewNavigation;r.pinch.zoomMomentum||r.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Goe=class extends Zt{constructor(e,r,i){super(!0),this._view=e,this.pointerActions=r;const s=this._view.mapViewNavigation;this._dragEventSeparator=new l1({start:(n,o)=>{s.rotate.begin(this._view,o.data),o.stopPropagation()},update:(n,o)=>{s.rotate.update(this._view,o.data),o.stopPropagation()},end:(n,o)=>{s.rotate.end(),o.stopPropagation()},condition:(n,o)=>n===1&&w6(o.data,this.pointerActions)}),this.registerIncoming("drag",i,n=>this._dragEventSeparator.handle(n))}};function b6(t){const e=t[0],r=t[1],i=t[2];return Math.sqrt(e*e+r*r+i*i)}function Boe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Hoe(t,e,r,i){return t[0]=e,t[1]=r,t[2]=i,t}function Woe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function _6(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function S6(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function $6(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function Zoe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Joe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Yoe(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function Koe(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function Qoe(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function Xoe(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function eae(t,e=0,r=1){return t[0]=Math.min(Math.max(t[0],e),r),t[1]=Math.min(Math.max(t[1],e),r),t[2]=Math.min(Math.max(t[2],e),r),t}function tae(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function x6(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function rae(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t}function T6(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2];return Math.sqrt(r*r+i*i+s*s)}function M6(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2];return r*r+i*i+s*s}function I6(t){const e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i}function iae(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function sae(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function S$(t,e){const r=e[0],i=e[1],s=e[2];let n=r*r+i*i+s*s;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n),t}function E6(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function nae(t,e,r){const i=e[0],s=e[1],n=e[2],o=r[0],l=r[1],u=r[2];return t[0]=s*u-n*l,t[1]=n*o-i*u,t[2]=i*l-s*o,t}function oae(t,e,r){const i=e[0],s=e[1],n=e[2],o=r[0],l=r[1],u=r[2],d=s*u-n*l,p=n*o-i*u,f=i*l-s*o,m=Math.sqrt(d*d+p*p+f*f);return t[0]=d/m,t[1]=p/m,t[2]=f/m,t}function aae(t,e,r,i){const s=e[0],n=e[1],o=e[2];return t[0]=s+i*(r[0]-s),t[1]=n+i*(r[1]-n),t[2]=o+i*(r[2]-o),t}function lae(t,e,r,i,s,n){const o=n*n,l=o*(2*n-3)+1,u=o*(n-2)+n,d=o*(n-1),p=o*(3-2*n);return t[0]=e[0]*l+r[0]*u+i[0]*d+s[0]*p,t[1]=e[1]*l+r[1]*u+i[1]*d+s[1]*p,t[2]=e[2]*l+r[2]*u+i[2]*d+s[2]*p,t}function uae(t,e,r,i,s,n){const o=1-n,l=o*o,u=n*n,d=l*o,p=3*n*l,f=3*u*o,m=u*n;return t[0]=e[0]*d+r[0]*p+i[0]*f+s[0]*m,t[1]=e[1]*d+r[1]*p+i[1]*f+s[1]*m,t[2]=e[2]*d+r[2]*p+i[2]*f+s[2]*m,t}function cae(t,e=1){const r=qw,i=2*r()*Math.PI,s=2*r()-1,n=Math.sqrt(1-s*s)*e;return t[0]=Math.cos(i)*n,t[1]=Math.sin(i)*n,t[2]=s*e,t}function dae(t,e,r){const i=e[0],s=e[1],n=e[2];return t[0]=r[0]*i+r[4]*s+r[8]*n+r[12],t[1]=r[1]*i+r[5]*s+r[9]*n+r[13],t[2]=r[2]*i+r[6]*s+r[10]*n+r[14],t}function hae(t,e,r){const i=e[0],s=e[1],n=e[2];return t[0]=i*r[0]+s*r[3]+n*r[6],t[1]=i*r[1]+s*r[4]+n*r[7],t[2]=i*r[2]+s*r[5]+n*r[8],t}function pae(t,e,r){const i=r[0],s=r[1],n=r[2],o=r[3],l=e[0],u=e[1],d=e[2],p=s*d-n*u,f=n*l-i*d,m=i*u-s*l,y=s*m-n*f,g=n*p-i*m,v=i*f-s*p,_=2*o;return t[0]=l+p*_+2*y,t[1]=u+f*_+2*g,t[2]=d+m*_+2*v,t}function fae(t,e,r,i){const s=[],n=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],n[0]=s[0],n[1]=s[1]*Math.cos(i)-s[2]*Math.sin(i),n[2]=s[1]*Math.sin(i)+s[2]*Math.cos(i),t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function mae(t,e,r,i){const s=[],n=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],n[0]=s[2]*Math.sin(i)+s[0]*Math.cos(i),n[1]=s[1],n[2]=s[2]*Math.cos(i)-s[0]*Math.sin(i),t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function yae(t,e,r,i){const s=[],n=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],n[0]=s[0]*Math.cos(i)-s[1]*Math.sin(i),n[1]=s[0]*Math.sin(i)+s[1]*Math.cos(i),n[2]=s[2],t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function gae(t,e){S$(Lk,t),S$(Fk,e);const r=E6(Lk,Fk);return r>1?0:r<-1?Math.PI:Math.acos(r)}const Lk=al(),Fk=al();function vae(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function wae(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function bae(t,e){if(t===e)return!0;const r=t[0],i=t[1],s=t[2],n=e[0],o=e[1],l=e[2],u=Qr();return Math.abs(r-n)<=u*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-o)<=u*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(s-l)<=u*Math.max(1,Math.abs(s),Math.abs(l))}function _ae(t,e,r){const i=r[0]-e[0],s=r[1]-e[1],n=r[2]-e[2];let o=i*i+s*s+n*n;return o>0?(o=1/Math.sqrt(o),t[0]=i*o,t[1]=s*o,t[2]=n*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const Sae=_6,$ae=S6,xae=$6,Tae=T6,Mae=M6,Iae=b6,Eae=I6;Object.freeze(Object.defineProperty({__proto__:null,abs:Yoe,add:Woe,angle:gae,bezier:uae,ceil:Zoe,clamp:eae,copy:Boe,cross:nae,crossAndNormalize:oae,direction:_ae,dist:Tae,distance:T6,div:xae,divide:$6,dot:E6,equals:bae,exactEquals:wae,floor:Joe,hermite:lae,inverse:sae,len:Iae,length:b6,lerp:aae,max:Xoe,min:Qoe,mul:$ae,multiply:S6,negate:iae,normalize:S$,random:cae,rotateX:fae,rotateY:mae,rotateZ:yae,round:tae,scale:x6,scaleAndAdd:rae,set:Hoe,sign:Koe,sqrDist:Mae,sqrLen:Eae,squaredDistance:M6,squaredLength:I6,str:vae,sub:Sae,subtract:_6,transformMat3:hae,transformMat4:dae,transformQuat:pae},Symbol.toStringTag,{value:"Module"}));function Os(t){let e=t*t;return t<0&&(e*=-1),e}function Oae(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function kae(t,e,r){const i=r,s=t.state,n=t.device,o=e.tiltDirection==="forward-down"?1:-1,l=1;return n.deviceType==="standard"?(i.translation[0]=Os(s.axes[0]),i.translation[1]=Os(s.axes[1]),i.translation[2]=Os(s.buttons[7])-Os(s.buttons[6]),i.heading=Os(s.axes[2]),i.tilt=Os(s.axes[3])):n.deviceType==="spacemouse"&&(i.translation[0]=1.2*Os(s.axes[0]),i.translation[1]=1.2*Os(s.axes[1]),i.translation[2]=2*-Os(s.axes[2]),i.heading=1.2*Os(s.axes[5]),i.tilt=1.2*Os(s.axes[3])),i.tilt*=o,x6(i.translation,i.translation,l),i}function Cae(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let Pae=class extends Zt{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Bh,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",r=>this._handleGamePadEvent(r)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([ne(()=>this._view.navigation.gamepad?.enabled,r=>{r?(this._handle.resume(),this._frameTask||(this._frameTask=bh({update:i=>this._frameUpdate(i.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},Ot)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const r=this._view.navigation.gamepad.device;r&&e.data.device!==r||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,Oae(this._transformation)):(this._currentDevice=e.data.device,kae(e.data,this._view.navigation.gamepad,this._transformation)),this._frameTask?.resume())}_frameUpdate(e){const r=this._transformation;if(Cae(r))return void this._frameTask?.pause();const i=this._view.viewpoint.clone(),s=this._view.navigation.gamepad.velocityFactor,n=Rae*s*e;a1(i,i,[r.translation[0]*n,-r.translation[1]*n]);const o=1+r.translation[2]*Lae*e,l=this._view.constraints.rotationEnabled?-r.heading*Aae*e:0,u=this._view.size,d=[u[0]/2,u[1]];s6(i,i,o,l,d,u);const p=this._view.constraints.constrain(i,this._view.viewpoint);this._view.viewpoint=p}};const Aae=.06,Rae=.7,Lae=6e-4;function O6(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),Te(()=>document.removeEventListener("visibilitychange",e))}let Fae=class extends Zt{constructor(e,r,i){super(!0),this.view=e,this.keys=r,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=s=>{const n=this._keyMap[s.data.key];if(s.modifiers.has("Meta")||s.modifiers.has("Control"))return void this._stopMovement();if(n==null)return;s.stopPropagation(),s.preventDefault();const o=s.type==="key-down";if(this._pressedKeys[o?"add":"delete"](n),o){if(this._direction===n)return;this._direction=n,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const l=this._timeout===void 0,u=this._pressedKeys.size>0;l||u?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[r.left]:"left",[r.right]:"right",[r.up]:"up",[r.down]:"down"},this.registerIncoming("key-down",i,this._handleKey),this.registerIncoming("key-up",i,this._handleKey),this.registerIncoming("blur",i,this._stopMovement),this._visibilityHandle=O6(s=>s?null:this._stopMovement())}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(e){const r=this._currentDirection!=null;if(e!=null){if(r||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else r&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout(()=>{this._timeout=void 0,e()},this._stickyKeyDuration)}},Nae=class extends Zt{constructor(e,r,i){super(!0),this.view=e,this.keys=r,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(r),this.registerIncoming("key-down",i,s=>this._handleKeyDown(s)),this.registerIncoming("key-up",i,s=>this._handleKeyUp(s)),this.registerIncoming("blur",i,()=>this._handleStop()),this._visibilityHandle=O6(s=>s?null:this._handleStop())}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,r){for(const i of e)this._keyToDirection.set(i,r)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,r){const i=e.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection.get(e.data.key);if(this._pressed=s!=null,this._pressed){if(e.preventDefault(),r)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},Dae=class extends Zt{constructor(e,r,i){super(!0),this.view=e,this.keys=r,this._keysToZoomAction={},this.registerIncoming("key-down",i,s=>this._handleKeyDown(s)),r.zoomIn.forEach(s=>this._keysToZoomAction[s]=0),r.zoomOut.forEach(s=>this._keysToZoomAction[s]=1)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const r=e.modifiers;if(r.size>0&&!r.has("Shift"))return;const{key:i}=e.data;if(!(i in this._keysToZoomAction))return;const s=this._keysToZoomAction[i],{mapViewNavigation:n}=this.view;let o=null;switch(s){case 0:o=n.zoomIn();break;case 1:o=n.zoomOut();break;default:return}n.begin(),o.then(()=>n.end()),e.stopPropagation()}};const jae=.6;let Vae=class extends Zt{constructor(e,r){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",r,i=>this._handleMouseWheel(i))}_handleMouseWheel(e){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const r=this._view.mapViewNavigation,{x:i,y:s,deltaY:n}=e.data,o=1/jae**(1/60*n),l=r.zoom(o,[i,s]);this._canZoom=!1,l.catch(()=>{}).then(()=>{this._canZoom=!0,r.end()})}},zae=class extends Zt{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",i=>this._handleDrag(i)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const r=this.view.mapViewNavigation;this._dragEventSeparator=new l1({start:(i,s)=>{r.pinch.begin(this.view,s.data),s.stopPropagation()},update:(i,s)=>{r.pinch.update(this.view,s.data),s.stopPropagation()},end:(i,s)=>{r.pinch.end(this.view),s.stopPropagation()},condition:i=>i>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function Nk(t){const e=t.native;return e?{buttons:e.buttons.map(r=>r.pressed?r.value||1:0),axes:e.axes.map(r=>Gae(r,t.axisThreshold))}:{buttons:[],axes:[]}}function Uae(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let r=0;r<t.axes.length;r++)if(t.axes[r]!==e.axes[r])return!1;for(let r=0;r<t.buttons.length;r++)if(t.buttons[r]!==e.buttons[r])return!1;return!0}function qae(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function Gae(t,e){const r=Math.abs(t);return r<e?0:Math.sign(t)*(r-e)/(1-e)}let Bae=class{constructor(e,r){this._element=e,this._input=r,this._hasEventListeners=!1,this._onConnectGamepad=n=>{this._connectGamepad(n.gamepad)},this._onDisconnectGamepad=n=>{const o=n.gamepad,l=o.index,u=this._inputDevices[l];u&&(this._emitGamepadEvent(o,Nk(u),!1),this._inputDevices.splice(l,1),this._latestUpdate.splice(l,1),this._input.gamepad.devices.remove(u),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const i="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=i&&s,this.supported&&(Dk(n=>this._connectGamepad(n)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const r=new BM(e);r.deviceType!=="unknown"&&(this._inputDevices[e.index]=r,this._input.gamepad.devices.add(r)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=bh({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),r=this._element.contains(document.activeElement),i=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!r;Dk(s=>{const n=this._inputDevices[s.index];if(!n)return;const o=this._latestUpdate[s.index],l=Nk(n),u=i||qae(l);o&&(o.timestamp===s.timestamp||!o.active&&u||Uae(o.state,l))||this._emitGamepadEvent(s,l,!u)})}_emitGamepadEvent(e,r,i){const s=this._latestUpdate[e.index],n=s&&s.active;if(!n&&!i)return;const o=!n&&i?"start":n&&i?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:r,active:i},this._callback&&this._callback({device:this._inputDevices[e.index],state:r,action:o})}};function Hae(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function Dk(t){for(const e of navigator.getGamepads())Hae(e)&&t(e)}const jk=k("edge"),Wae=k("chrome"),Zae=k("ff"),Jae=k("safari"),Vk="esri-view-surface",ac={touchNone:`${Vk}--touch-none`,touchPan:`${Vk}--touch-pan`};var $u;let Yae=($u=class{constructor(e,r){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new Bae(e,r),this._gamepadSource.onEvent=i=>this._callback("gamepad",i)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>this._releasePointerCaptureSafe(e)),this._activePointerCaptures.clear(),this._gamepadSource=Ke(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const r in this._active)if(!e||!e.has(r)){const i=this._active[r];this._element.removeEventListener(kb[r],i),delete this._active[r]}e&&e.forEach(r=>{if(!this._active[r]&&kb[r]){const i=(this._eventHandlers[r]||this._handleDefault).bind(this,r);this._element.addEventListener(kb[r],i),this._active[r]=i}}),this._gamepadSource&&(this._gamepadSource.hasEventListeners=e?.has("gamepad")??!1)}setPointerCapture(e,r){r?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?ac.touchNone:ac.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?ac.touchPan:ac.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(ac.touchNone),this._element.classList.remove(ac.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,r){const i=Ej(this._element,e);return $u.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),r.x=i.x,r.y=i.y,r}_handleKey(e,r){const{key:i}=r;i&&e==="key-up"&&this._keyDownState.delete(i);const s={native:r,key:i,repeat:!!i&&this._keyDownState.has(i)};i&&e==="key-down"&&this._keyDownState.add(s.key),this._callback(e,s)}_handlePointer(e,r){const i=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,pointerType:r.pointerType,button:r.button,buttons:r.buttons,eventId:this._eventId++});this._callback(e,i)}_handlePointerPreventDefault(e,r){const i=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,pointerType:r.pointerType,button:r.button,buttons:r.buttons,eventId:this._eventId++});r.preventDefault(),this._callback(e,i)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&k("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,r){let i=this._getDeltaFromTrackpadOrMouseWheel(r);switch(r.deltaMode){case 0:jk&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}jk?i*=.7:Wae||Jae?i*=.6:Zae&&(i*=1.375);const s=100,n=Math.abs(i);n>s&&(i=i/n*200/(1+Math.exp(-.02*(n-s))));const o=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,deltaY:i});this._callback(e,o)}_handlePointerCaptureLost(e,r){this._activePointerCaptures.delete(r.pointerId),this._handleDefault(e,r)}_handleDefault(e,r){const i={native:r};r.preventDefault(),this._callback(e,i)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}},$u.test={disableSubpixelCoordinates:!1},$u);const kb={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let Kae=class extends Zt{constructor(){super(!0),this.registerIncoming("context-menu",e=>e.data.native.preventDefault())}};const k6=()=>({maximumClickDelay:300}),Qae=(t={})=>({...k6(),movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,...t}),n3=(t={})=>({...k6(),maximumDoubleClickDistance:10,maximumDoubleTouchDistance:35,maximumDoubleClickDelay:250,maximumDoubleTouchDelay:350,...t});function Uv(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function Xae(t,e){const r=e.x-t.x,i=e.y-t.y;return Math.sqrt(r*r+i*i)}function ele(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Bt()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[C,T]=t,[O,P]=[T.x-C.x,T.y-C.y];return e.radius=Math.sqrt(O*O+P*P)/2,e.center.x=(C.x+T.x)/2,e.center.y=(C.y+T.y)/2,e}let r=0,i=0;for(let C=0;C<t.length;C++)r+=t[C].x,i+=t[C].y;r/=t.length,i/=t.length;const s=t.map(C=>C.x-r),n=t.map(C=>C.y-i);let o=0,l=0,u=0,d=0,p=0,f=0,m=0;for(let C=0;C<s.length;C++){const T=s[C],O=n[C],P=T*T,D=O*O;o+=P,l+=D,u+=T*O,d+=P*T,p+=D*O,f+=T*D,m+=O*P}const y=.5*(d+f),g=.5*(p+m),v=o*l-u*u,_=(y*l-g*u)/v,S=(o*g-u*y)/v,M=Bt(_+r,S+i);return{radius:Math.sqrt(_*_+S*S+(o+l)/t.length),center:M}}function vu(t){const{native:e}=t,{pointerId:r,button:i,pointerType:s}=e;return s==="mouse"?`${r}:${i}`:`${s}`}let tle=class extends Zt{constructor(e={},r=Uh){super(!1),this._clock=r,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Bt(0,0),this._pointerState=new Map,this._parameters=n3(e),this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new l1({start:(i,s)=>this._dragStart(i,s),update:(i,s)=>this._dragUpdate(s),end:(i,s)=>this._dragEnd(s)}),this.registerIncoming("drag",i=>this._dragEventSeparator.handle(i)),this.registerIncoming("pointer-down",i=>this._handlePointerDown(i)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=He(e.doubleTapTimeout)})}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(e){const r=this._pointerState.get(e);r&&(r.doubleTapTimeout=He(r.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,r){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:s}=r,{center:n}=i;this._dragStartCenter=n;const o=Cb("begin",Bt(0,0),i);this._doubleTapDrag.emit(o,void 0,s),r.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:r,modifiers:i}=e,{center:s}=r,n=Cb("update",Bt(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r);this._doubleTapDrag.emit(n,void 0,i),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:r,modifiers:i}=e,{center:s}=r,n=Cb("end",Bt(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r);this._doubleTapDrag.emit(n,void 0,i),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:r}=e,i=vu(r),s=this._pointerState.get(i),{pointerType:n}=r.native;if(s){const o=n==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;this._clearPointerDown(i),Uv(s.event.data,r)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:r}=e,{pointerType:i}=r.native,s=vu(r),n=i==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(s),n);this._pointerState.set(s,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}};function Cb(t,e,r){const{button:i,buttons:s,pointer:n,pointers:o,pointerType:l,timestamp:u}=r;return{action:t,delta:e,button:i,buttons:s,pointer:n,pointers:o,pointerType:l,timestamp:u}}let rle=class extends Zt{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,r,i,s){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:r.buttons,timestamp:s,pointers:ile(this._activePointerMap),pointer:r,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(e){const r=e.native.pointerId,i=og(this._activePointerMap).angle,s={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(r,s);const n=E0(s,C6(this._activePointerMap));s.initialAngle=n,s.lastAngle=n,this._updatePointerAngles(i)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const r=e.native.pointerId,i=this._activePointerMap.get(r);i?i.event=e:this._addPointer(e)}_removePointer(e){const r=og(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(r)}_updatePointerAngles(e){const r=og(this._activePointerMap);this._activePointerMap.forEach(i=>{i.initialAngle=E0(i,r)-e,i.lastAngle=E0(i,r)-e})}_emitEvent(e,r,i){const s=og(this._activePointerMap);this._drag.emit(this._createPayload(e,r,s,i),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const r=e.data.native.pointerId,i=e.timestamp;this._activePointerMap.get(r)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,i),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(r)):(this._removePointer(r),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const r=e.data,i=r.currentEvent,s=e.timestamp;switch(r.action){case"start":case"update":this._isDragging?this._activePointerMap.has(i.native.pointerId)?(this._updatePointer(i),!this._isCurrentDragSuppressed&&this._emitEvent("update",i,s)):(this._addPointer(i),this._emitEvent("added",i,s),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(i),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",i,s))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function C6(t){const e=[];return t.forEach(r=>{e.push(Bt(r.event.x,r.event.y))}),ele(e)}function og(t){const e=C6(t);let r=0;return t.forEach(i=>{let s=E0(i,e),n=s-i.lastAngle;for(;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;s=i.lastAngle+n,i.lastAngle=s;const o=s-i.initialAngle;r+=o}),r/=t.size||1,{angle:r,radius:e.radius,center:e.center}}function ile(t){const e=new Map;return t.forEach((r,i)=>e.set(i,r.event)),e}function E0(t,e){const r=t.event,i=r.x-e.center.x,s=r.y-e.center.y;return Math.atan2(s,i)}let sle=class extends Zt{constructor(e={},r=Uh){super(!1),this._clock=r,this._pointerState=new Map,this._parameters=n3(e),this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const r=e.data,i=vu(r);if(!this._pointerState.has(i)){const s={downButton:r.native.button,x:r.x,y:r.y,immediateDoubleClick:null};this._pointerState.set(i,s),this.startCapturingPointer(r.native)}}_handlePointerUp(e){const r=e.data,i=vu(r),s=this._pointerState.get(i);if(s&&s.downButton===r.native.button){const n=s.immediateDoubleClick,o=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;n?(n.timeoutHandle.remove(),Uv(n,e.data)>o?this._startImmediateDoubleClick(e,s):(this._immediateDoubleClick.emit(e.data,void 0,n.modifiers),this._removeState(r))):Uv(s,e.data)>o?this._removeState(r):this._startImmediateDoubleClick(e,s)}}_startImmediateDoubleClick(e,r){const i=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay;r.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),i)}}_removeState(e){const r=vu(e);this._pointerState.delete(r),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},nle=class extends Zt{constructor(e={},r=Uh){super(!1),this._clock=r,this._pointerState=new Map,this._parameters=Qae(e),this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",i=>this._handlePointerDown(i)),this.registerIncoming("pointer-up",i=>this._handlePointerLoss(i,"pointer-up")),this.registerIncoming("pointer-capture-lost",i=>this._handlePointerLoss(i,"pointer-capture-lost")),this.registerIncoming("pointer-cancel",i=>this._handlePointerLoss(i,"pointer-cancel")),this._moveHandle=this.registerIncoming("pointer-move",i=>this._handlePointerMove(i)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=He(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const r=e.data,i=r.native.pointerId;let s=null;this._pointerState.size===0&&(s=this._clock.setTimeout(()=>{const o=this._pointerState.get(i);if(o){if(!o.isDragging){const l=o.previousEvent;this._pointerHold.emit(l,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._parameters.holdDelay));const n={startEvent:r,previousEvent:r,startTimestamp:e.timestamp,isDragging:!1,downButton:r.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(i,n),this.startCapturingPointer(r.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const r=e.data,i=r.native.pointerId,s=this._pointerState.get(i);s&&(s.isDragging?this._pointerDrag.emit(ag("update",s,r),void 0,s.modifiers):Xae(r,s.startEvent)>this._getDragThreshold(r.native.pointerType)&&this._startDragging(e),s.previousEvent=r)}_getDragThreshold(e){switch(e){case"touch":return this._parameters.movementUntilTouchDrag;case"pen":return this._parameters.movementUntilPenDrag;default:return this._parameters.movementUntilMouseDrag}}_startDragging(e){const r=e.data,i=r.native.pointerId;this._pointerState.forEach(s=>{s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=e.modifiers,s.isDragging=!0,i===s.startEvent.native.pointerId?this._pointerDrag.emit(ag("start",s,r)):this._pointerDrag.emit(ag("start",s,s.previousEvent),e.timestamp))})}_handlePointerLoss(e,r){const i=e.data,s=i.native.pointerId,n=this._pointerState.get(s);n&&(n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging?this._pointerDrag.emit(ag("end",n,r==="pointer-up"?i:n.previousEvent),void 0,n.modifiers):r==="pointer-up"&&n.downButton===i.native.button&&e.timestamp-n.startTimestamp<=this._parameters.maximumClickDelay&&!n.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(s),this.stopCapturingPointer(i.native),this._pointerState.size===0&&this._moveHandle.pause())}};function ag(t,e,r){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:r}}let ole=class extends Zt{constructor(e={},r=Uh){super(!1),this._clock=r,this._pointerState=new Map,this._parameters=n3(e),this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",i=>this._handleImmediateClick(i)),this.registerIncoming("pointer-down",i=>this._handlePointerDown(i))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=He(e.doubleClickTimer))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,r){const i=this._pointerState.get(e);i&&(i.doubleClickTimer=He(i.doubleClickTimer),r&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const r=this._pointerState.get(e);r.pointerDownCount===1&&this._click.emit(r.event.data,void 0,r.event.modifiers),r.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const r=e.data,{pointerType:i}=r.native,s=ale(r);if(!this._pointerState.has(s))return void this._startClick(e);const n=this._pointerState.get(s),{data:o,modifiers:l}=n.event,u=i==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;Uv(o,r)>u?(this._clearDoubleClickTimer(s,!0),this._startClick(e)):(this._clearDoubleClickTimer(s,!1),n.pointerDownCount===2&&this._doubleClick.emit(o,void 0,l))}_handlePointerDown(e){const r=vu(e.data),i=this._pointerState.get(r);i&&(i.pointerDownCount+=1)}_startClick(e){const{data:r}=e,{native:{pointerType:i}}=r,s=vu(r),n=i==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(s),n);this._pointerState.set(s,{event:e,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};function ale(t){const{pointerId:e,pointerType:r,button:i}=t.native;return r==="mouse"?`${e}:${i}`:`${r}`}const lg={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},zk=Symbol("handles");let Nc=class extends X{initialize(){const e=()=>this.view?.ready;this.addHandles([Gi(()=>!e(),()=>this._disconnect()),Gi(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerInfo(){return this._inputManager?.latestPointerInfo}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(zk),this._inputManager=Ke(this._inputManager)}_connect(){const e=this.view.surface,r=new Yae(e,this.view.input),i=[new sle,new nle,new ole,new rle(this.view.navigation),new tle],s=new Ps({eventSource:r,recognizers:i}),n=new qoe(this.view,["primary"]),o=new Goe(this.view,["secondary"]);s.installHandlers("prevent-context-menu",[new Kae],No.INTERNAL),s.installHandlers("navigation",[new zae(this.view),new Pae(this.view),new Vae(this.view),new Rk(this.view),new Rk(this.view,[lg.counter]),n,new Fae(this.view,lg.pan),new Dae(this.view,lg.zoom),new Nae(this.view,lg.rotate),o,new Uoe(this.view,"touch")],No.INTERNAL),this.view.viewEvents.connect(s),this._source=r,this._inputManager=s,this.addHandles([ne(()=>this.view?.navigation?.browserTouchPanEnabled,l=>{this._source&&(this._source.browserTouchPanningEnabled=!l)},Ot),ne(()=>{const{actionMap:l}=this.view.navigation;return{panActions:Ak("pan",l),rotateActions:Ak("rotate",l)}},({panActions:l,rotateActions:u})=>{n.pointerActions=l,o.pointerActions=u},Tr)],zk)}get test(){}};a([c()],Nc.prototype,"view",void 0),a([c()],Nc.prototype,"latestPointerInfo",null),a([c()],Nc.prototype,"multiTouchActive",null),Nc=a([b("esri.views.2d.input.MapViewInputManager")],Nc);const lle=Nc,ule=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.goToManager=new I0({view:this}),this.animationsEnabled=!0,this.inputManager=new lle({view:this}),this.addHandles([this.on("resize",s=>this.stateManager.resize(s.width,s.height))])}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}on(i,s,n,o){return this.viewEvents.on(i,s,n,o)||super.on(i,s)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}goTo(i,s){return this.goToManager.goTo(i,s)}toMap(i){if(!this.ready)return null;const s=kj(i)?Oj(this,i):i;return this.stateManager.toMap(s)}};return a([c()],r.prototype,"goToManager",void 0),a([c({readOnly:!0})],r.prototype,"interacting",null),a([c()],r.prototype,"stationary",null),a([c()],r.prototype,"animationsEnabled",void 0),a([c({readOnly:!0})],r.prototype,"inputManager",void 0),r=a([b("esri.views.Viewport2DMixin")],r),r};let Uk=class{constructor(e){this._view=e,this.viewpoint=new fs({targetGeometry:new ee,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,r]=this._view.size;return Math.sqrt(e*e+r*r)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return r6(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,r){r.pan=sF(this.center,e.center);let i=Math.abs(e.rotation-this.rotation);i=i>=180?360-i:i,r.rotate=ly(i),r.sourceZoom=this.scale,r.targetZoom=e.scale}interpolate(e,r,i){const{pan:s,rotate:n,zoom:o,zoomOffset:l}=i,{center:u}=this;u.spatialReference=e.center.spatialReference,u.x=Wp(e.center.x,r.center.x,s),u.y=Wp(e.center.y,r.center.y,s),this.viewpoint.scale=Wp(e.scale,r.scale+l,o);let d=e.rotation;const p=r.rotation;Math.abs(p-d)>=180&&(d+=360*(d<p?1:-1)),this.viewpoint.rotation=Wp(d,p,n)}copyFrom(e){Cr(this.viewpoint,e.viewpoint),this._view=e.view}};function kp(t,e,r,i){const s=3*t,n=3*(r-t)-s,o=1-s-n,l=3*e,u=3*(i-e)-l,d=1-l-u;function p(g){return((o*g+n)*g+s)*g}function f(g){return((d*g+u)*g+l)*g}function m(g){return(3*o*g+2*n)*g+s}function y(g,v){let _,S,M,C,T,O;for(M=g,O=0;O<8;O++){if(C=p(M)-g,Math.abs(C)<v)return M;if(T=m(M),Math.abs(T)<1e-6)break;M-=C/T}if(_=0,S=1,M=g,M<_)return _;if(M>S)return S;for(;_<S;){if(C=p(M),Math.abs(C-g)<v)return M;g>C?_=M:S=M,M=.5*(S-_)+_}return M}return function(g,v=1e-6){return f(y(g,v))}}const ss={};ss.ease=kp(.25,.1,.25,1),ss.linear=kp(0,0,1,1),ss.easeIn=ss["ease-in"]=kp(.42,0,1,1),ss.easeOut=ss["ease-out"]=kp(0,0,.58,1),ss.easeInOut=ss["ease-in-out"]=kp(.42,0,.58,1);const cle=t=>t,Dm=t=>t*t,qv=t=>1-Dm(1-t),qk=t=>t<.5?Dm(2*t)/2:(qv(2*(t-.5))+1)/2,Gv=t=>t*t*t,$$=t=>1-Gv(1-t),Gk=t=>t<.5?Gv(2*t)/2:($$(2*(t-.5))+1)/2,Bv=t=>t*t*t*t,x$=t=>1-Bv(1-t),Bk=t=>t<.5?Bv(2*t)/2:(x$(2*(t-.5))+1)/2,Hv=t=>t*t*t*t*t,T$=t=>1-Hv(1-t),Hk=t=>t<.5?Hv(2*t)/2:(T$(2*(t-.5))+1)/2,Wv=t=>1-Math.cos(t*Math.PI/2),M$=t=>1-Wv(1-t),Wk=t=>t<.5?Wv(2*t)/2:(M$(2*(t-.5))+1)/2,Zv=t=>2**(10*(t-1)),Jv=t=>1-Zv(1-t),Zk=t=>t<.5?Zv(2*t)/2:(Jv(2*(t-.5))+1)/2,Yv=t=>-(Math.sqrt(1-t*t)-1),I$=t=>1-Yv(1-t),Jk=t=>t<.5?Yv(2*t)/2:(I$(2*(t-.5))+1)/2;function vs(t){const e=2*(t-Math.sqrt((t-1)*t)),r=e/2/t;return i=>i<r?t*i*i:e*i-e+1}function ws(t,e){return(r,i)=>r<e?e*t(r/e,i):1-t((1-r)/(1-e),i)*(1-e)}const Yk=ws(vs(1),1),Kk=ws(vs(1),0),Kv=ws(vs(1),.5),Qk=ws(vs(2),1),Xk=ws(vs(2),0),eC=ws(vs(2),.5),tC=ws(vs(3),1),rC=ws(vs(3),0),iC=ws(vs(3),.5),sC=ws(vs(4),1),nC=ws(vs(4),0),oC=ws(vs(4),.5),aC={linear:cle,"in-quad":Dm,"out-quad":qv,"in-out-quad":qk,"in-coast-quad":Yk,"out-coast-quad":Kk,"in-out-coast-quad":Kv,"in-cubic":Gv,"out-cubic":$$,"in-out-cubic":Gk,"in-coast-cubic":Qk,"out-coast-cubic":Xk,"in-out-coast-cubic":eC,"in-quart":Bv,"out-quart":x$,"in-out-quart":Bk,"in-coast-quart":tC,"out-coast-quart":rC,"in-out-coast-quart":iC,"in-quint":Hv,"out-quint":T$,"in-out-quint":Hk,"in-coast-quint":sC,"out-coast-quint":nC,"in-out-coast-quint":oC,"in-sine":Wv,"out-sine":M$,"in-out-sine":Wk,"in-expo":Zv,"out-expo":Jv,"in-out-expo":Zk,"in-circ":Yv,"out-circ":I$,"in-out-circ":Jk,"quad-in":Dm,"quad-out":qv,"quad-in-out":qk,"quad-in-coast":Yk,"quad-out-coast":Kk,"quad-in-out-coast":Kv,"cubic-in":Gv,"cubic-out":$$,"cubic-in-out":Gk,"cubic-in-coast":Qk,"cubic-out-coast":Xk,"cubic-in-out-coast":eC,"quart-in":Bv,"quart-out":x$,"quart-in-out":Bk,"quart-in-coast":tC,"quart-out-coast":rC,"quart-in-out-coast":iC,"quint-in":Hv,"quint-out":T$,"quint-in-out":Hk,"quint-in-coast":sC,"quint-out-coast":nC,"quint-in-out-coast":oC,"sine-in":Wv,"sine-out":M$,"sine-in-out":Wk,"expo-in":Zv,"expo-out":Jv,"expo-in-out":Zk,"circ-in":Yv,"circ-out":I$,"circ-in-out":Jk,ease:t=>ss.ease(t),"ease-in":t=>ss.easeIn(t),"ease-out":t=>ss.easeOut(t),"ease-in-out":t=>ss.easeInOut(t)};let dle=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const Qv={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},P6={maxDuration:4e3};let hle=class A6{constructor(e){this._createCamera=e,this.compared=new dle,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:Qv.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new A6(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,r,i){this.source!==e&&this.source.copyFrom(e),this.target!==r&&this.target.copyFrom(r),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=i.desiredScreenFlow??Qv.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const r=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/r}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>Qr()}get hasFov(){return Math.abs(this.compared.fov)>Qr()}get hasRotate(){return this.compared.rotate>Qr()}},ple=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},fle=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,r)=>e+r.time,0)}interpolateComponentsAt(e,r){e=Math.min(Math.max(e,0),1),e*=this.time;let i=0,s=0;const n=this.definition,o=this.segments.reduce((l,u)=>l||u.definition.hasZoom,!1);for(let l=0;l<this.segments.length;l++){const u=this.segments[l],d=u.definition;if(e<=u.time||l===this.segments.length-1){if(this.segmentInterpolateComponentsAt(u,u.time===0?0:e/u.time,r),n.hasPan&&!isNaN(r.pan)&&isFinite(n.compared.pan)?r.pan=(i+d.compared.pan*r.pan)/n.compared.pan:r.pan=1,n.hasRotate&&!isNaN(r.rotate)&&isFinite(n.compared.rotate)?r.rotate=(s+d.compared.rotate*r.rotate)/n.compared.rotate:r.rotate=1,o&&!isNaN(r.zoom)&&isFinite(d.compared.targetZoom)){const{sourceZoom:p,targetZoom:f}=d.compared,m=r.zoom*(f-p)+p,y=this.segments[0].definition.compared.sourceZoom,g=this.segments[this.segments.length-1].definition.compared.targetZoom,v=Math.abs(f-y)>Math.abs(p-y)?f:p;r.zoomOffset=v-g,r.zoom=(m-y)/(v-y)}else r.zoom=1;return r}e-=u.time,i+=d.compared.pan,s+=d.compared.rotate}}segmentInterpolateComponentsAt(e,r,i){e.interpolateComponentsAt(r,i)}},Pb=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,r=e.compared,i=r.sourceZoom,s=r.targetZoom;this._zoomSign=i>s?1:-1,this._panPixelsAtSource=r.pan*e.source.pixelsPerPanAtZoom(i);const n=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=r.rotate*n}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom,{hasZoom:i,hasPan:s,hasRotate:n}=this.definition;let o=0,l=0;i&&(s&&(o=(r/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),n&&(l=this._zoomSign*(Math.log(e/r)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const u=this.definition.desiredPixelFlow;if(i&&s&&n){const d=o+l+o*l;this._zoomPixelFlow=o*l/d*u,this._panPixelFlow=l/d*u,this._rotatePixelFlow=o/d*u}else if(i&&s){const d=1+o;this._zoomPixelFlow=o/d*u,this._panPixelFlow=1/d*u}else if(i&&n){const d=1+l;this._zoomPixelFlow=l/d*u,this._rotatePixelFlow=1/d*u}else if(s&&n){const d=this._panPixelsAtSource/this._rotatePixels,p=1+d;this._panPixelFlow=d/p*u,this._rotatePixelFlow=1/p*u}else s?this._panPixelFlow=u:i?this._zoomPixelFlow=u:n&&(this._rotatePixelFlow=u);if(this._time=Math.max(this.rotateTime,this.zoomTime,this.panTime),this.fovTime>this._time){const d=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=d,this._panPixelFlow/=d,this._rotatePixelFlow/=d}}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:0}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/mle:0}get panTime(){if(!this.definition.hasPan)return 0;if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,r=e*this._panPixelsAtSource;return Math.log(r*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const r=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom;return(r*(r/i)**-e-r)/(i-r)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:r,segmentEnd:i}=this.definition;return r+e*(i-r)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const r=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(r*e*this._time)-1))/(r*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,r){e=Math.min(Math.max(e,0),1),r.zoom=this._interpolateComponentsZoom(e),r.pan=this._interpolateComponentsPan(e),r.rotate=this._interpolateComponentsRotate(e),r.zoomOffset=0,r.fov=this._interpolateComponentsFov(e)}};const mle=ly(45);function yle(t,e,r){const i=e-t.compared.sourceZoom,s=t.halfWindowPanAtZoom(i);return-t.halfWindowSize*(r.ascensionFactor*Math.LN2*t.compared.pan+s)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*s)}function gle(t,e,r){const i=1/e,s=Math.log(t.compared.sourceZoom*i),n=1/t.desiredPixelFlow,o=1/Math.LN2,l=e-t.compared.sourceZoom,u=1/l,d=(r.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(l))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*i*n*o*u*d-t.halfWindowSize*s*n*o*u+t.halfWindowSize*s*n*o*d/(l*l)}function vle(t,e,r){const i=e-t.compared.sourceZoom,s=1/i,n=1/e,o=Math.log(t.compared.sourceZoom*n),l=(r.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(i))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*(-2*s*n*l+2*s*o+2*n-2*o*l/(i*i)-l/(e*e))/(t.desiredPixelFlow*Math.LN2)}function wle(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function ble(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function _le(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function Sle(t,e,r){return-t.compared.pan*t.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function $le(t,e,r){return t.compared.pan*t.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function xle(t,e,r){return-2*t.compared.pan*t.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function Tle(t,e,r){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-r.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function Mle(t,e,r){const i=Math.log(e/t.compared.targetZoom),s=1/t.desiredPixelFlow,n=1/Math.LN2,o=-e+t.compared.targetZoom,l=1/o,u=(-t.halfWindowPanAtZoom(e)-r.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*i*s*n*l+t.halfWindowSize*i*s*n*u/(o*o)+t.halfWindowSize*s*n*l*u/e}function Ile(t,e,r){const i=e-t.compared.targetZoom,s=1/i,n=1/e,o=Math.log(e/t.compared.targetZoom),l=(t.halfWindowPanAtZoom(e)+r.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*(-2*s*n*l-2*s*o+2*n+2*o*l/(i*i)-l/(e*e))/(t.desiredPixelFlow*Math.LN2)}function Ele(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function Ole(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function kle(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function Cle(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const r=Math.LN2*t.compared.pan,i=e,s=t.halfWindowPanAtZoom(i),n=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*s);return t.compared.sourceZoom<=t.compared.targetZoom?n*(r-s):n*(r+s)}function Ple(t,e){let r=Ale(t,e);const i={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},s=i.ascensionFactor===0,n=i.descensionFactor===0,o=s?wle:yle,l=s?ble:gle,u=s?_le:vle,d=n?Ele:Tle,p=n?Ole:Mle,f=n?kle:Ile,m=O=>o(t,O,i)+Sle(t,O,i)+d(t,O,i),y=O=>l(t,O,i)+$le(t,O,i)+p(t,O,i),g=O=>u(t,O,i)+xle(t,O,i)+f(t,O,i);let v=m(r);const _=Cle(t);let S;const M=e.maximumIterations||20,C=e.maximumDistance!=null?e.maximumDistance:1/0;for(S=0;S<M;S++){const O=e.desiredSlope??1e-6;let P=y(r);Math.abs(P)>O&&(P+=O);const D=P/g(r);if(isNaN(D)||r>=C&&D<0){if(!isFinite(C))return null;r=C,v=m(r);break}if(r-=D,r<=t.compared.sourceZoom||r<=t.compared.targetZoom)return null;const z=m(r);if(Math.abs(z-v)/v<=.005)break;v=z}return isNaN(v)||v>_*(1-.3)||r<=t.compared.sourceZoom||r<=t.compared.targetZoom?null:r}function Ale(t,e){const r=Math.max(t.compared.sourceZoom,t.compared.targetZoom),i=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return i<r?e.maximumDistance!=null?r+(e.maximumDistance-r)/2:1.5*r:e.maximumDistance?Math.min(e.maximumDistance,i):i}let Rle=class extends fle{constructor(e,r){super(),this._preallocSegments=[new Pb,new Pb,new Pb],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,r)}update(e,r){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const i=r?.apex?Ple(e,r.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,i?this._updateWithApex(i,r?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,r,i){e.interpolateComponentsAt(r,i),e===this._ascensionSegment?i.zoom=qv(i.zoom):e===this._descensionSegment&&(i.zoom=Dm(i.zoom))}_updateWithApex(e,r){const[i,s,n]=this._preallocSegments,o=r?.ascensionFactor??.5,l=Math.min(1-o,r?.ascensionFactor!=null&&r.descensionFactor!=null?r.descensionFactor:.5),u=1-o-l;i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.compared.targetZoom=e,i.definition.compared.pan=this.definition.compared.pan*o,i.definition.compared.rotate=this.definition.compared.rotate*o,i.definition.segmentEnd=o,i.update(),this._ascensionSegment=i,this.segments.push(i),u>0&&(s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.copyFrom(this.definition),s.definition.compared.sourceZoom=e,s.definition.compared.targetZoom=e,s.definition.compared.pan=this.definition.compared.pan*u,s.definition.compared.rotate=this.definition.compared.rotate*u,s.definition.segmentStart=i.definition.segmentEnd,s.definition.segmentEnd=i.definition.segmentEnd+u,s.update(),this.segments.push(s)),n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.compared.sourceZoom=e,n.definition.compared.pan=this.definition.compared.pan*l,n.definition.compared.rotate=this.definition.compared.rotate*l,n.definition.segmentStart=o+u,n.update(),this._descensionSegment=n,this.segments.push(n)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const Lle=new ple;let Fle=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=0,this._easing=Kv,this.definition=new hle(e),this.path=new Rle}update(e,r,i){this.definition.update(e,r,i),this.path.update(this.definition,i),this._time=this._applyTimeSettings(_q(isFinite(this.path.time)?this.path.time:0),i),this._easing=i.easing??(this._time>=1e3?Kv:Jv)}cameraAt(e,r){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const i=this.path.interpolateComponentsAt(e,Lle);r.interpolate(this.definition.source,this.definition.target,i)}_normalizedEasing(e){const r=this._easing(0,this._time),i=this._easing(1,this._time);return(this._easing(e,this._time)-r)/(i-r)}_applyTimeSettings(e,r){const i=r.speedFactor!=null?r.speedFactor:1,s=r.minDuration??Qv.minDuration/i,n=r.maxDuration??Qv.maxDuration/i;return e=r.duration!=null?r.duration:Math.min(Math.max(e/i,s),n)}};const Nle=2e3,Dle=64;let jle=class{constructor(e){this._view=e,this._animation=new Fle(()=>new Uk(this._view)),this._current=new Uk(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,r,i={}){Cr(this._current.viewpoint,e),Cr(this._source.viewpoint,e),Cr(this._target.viewpoint,r),this._animation.update(this._source,this._target,i)}applyRatio(e,r){this._animation.cameraAt(r,this._current),Cr(e,this._current.viewpoint)}},Dc=class extends X{constructor(e){super(e),this._animation=null,this._destinationViewState=new i3,this.updateFunction=null,this.easing=aC.ease,this.viewpoint=new fs({targetGeometry:new ee,scale:0,rotation:0}),this._updateTask=bh({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new jle(e.view)}destroy(){this._updateTask=He(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,r,i){this.stop();const s=this.viewpoint;Cr(s,r);const n=e.target;this._transition.update(this.viewpoint,n,{apex:{maximumDistance:Math.min(Math.min(r.scale,n.scale)*Dle,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:i?.duration,maxDuration:i?.animationMode==="auto"?1/0:i?.maxDuration??P6.maxDuration,speedFactor:i?.speedFactor,easing:(typeof i?.easing=="string"?aC[i.easing]:i?.easing)||this.easing}),i?.animationMode==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=n,Vle(this._transition.animation,i,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,n,{duration:0}));const o=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,r){this.stop(),this.updateFunction=r,this.viewpoint=e;const i=new _$({target:e.clone()}),s=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const r=this.animation;if(r&&r.state!==_$.state.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),this.animation?.update(this.viewpoint);else{const i=performance.now()-this._startTime,s=this._transition.duration,n=s>0?i/s:1,o=n>=1;this._transition.applyRatio(this.viewpoint,n),o&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function Vle(t,e,r,i){if(e?.duration!=null)return!0;const{time:s,isLinear:n}=t,o=e?.speedFactor||1;if(s>(e?.maxDuration??P6.maxDuration/o))return!1;if(n){const u=ut(),d=Bt(...i.toScreen(u,...r.center)),p=Bt(...r.toScreen(u,...i.center)),f=p!=null&&p.x>-1*r.size[0]&&p.x<(1.5+.5)*r.size[0]&&p.y>-1*r.size[1]&&p.y<(1.5+.5)*r.size[1],m=d!=null&&d.x>-1*i.size[0]&&d.x<(1.5+.5)*i.size[0]&&d.y>-1*i.size[1]&&d.y<(1.5+.5)*i.size[1];if(s>Nle/o&&!f&&!m)return!1}return!0}a([c()],Dc.prototype,"easing",void 0),a([c()],Dc.prototype,"view",void 0),a([c()],Dc.prototype,"viewpoint",void 0),Dc=a([b("esri.views.2d.AnimationManager")],Dc);const zle=Dc;function Ze(){return Promise.all([N(()=>import("./webglDeps-BNJ663uh.js"),__vite__mapDeps([194,161,195,196,197,4,55])),N(()=>import("./mapViewDeps-BvkAy0z3.js"),__vite__mapDeps([198,123,92,93,87,31,4,94,91,95,84,199,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,204,96,97,205,206,21,194,207,108,208,209,140,210,150,151,211,72,82,86,38,37,212,98,213,90,15,16,17,214,100,105,80,215,216,217,218,157,219,220]))])}const Cp=()=>Ze().then(()=>N(()=>import("./TileLayerView2D-DKW7yj-s.js"),__vite__mapDeps([221,91,92,93,87,31,4,94,95,84,205,123,206,21,203,202,83,54,196,197,55,160,161,113,141,144,33,34,207,200,195,152,201,88,108,208,209,140,72,199,85,89,99,96,97,150,151,214,82,86,38,37,100,105,80,222,223,224,218,225,226,216,217,227,228,229,230,231,232,233,234]))),ml=()=>Ze().then(()=>N(()=>import("./FeatureLayerView2D-CbM4ujea.js").then(t=>t.F),__vite__mapDeps([235,199,92,93,87,31,4,94,91,95,84,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,236,237,238,38,45,225,217,218,108,73,71,72,106,100,204,239,165,47,102,230,233,227,228,234]))),lC={"base-dynamic":()=>Ze().then(()=>N(()=>import("./BaseDynamicLayerView2D-DgqOvmfz.js"),__vite__mapDeps([240,241,202,83,84,54,196,197,4,55,160,161,113,203,141,144,33,31,34,223,200,195,152,224,225,242,227,228]))),"base-tile":Cp,"bing-maps":Cp,catalog:()=>Ze().then(()=>N(()=>import("./CatalogLayerView2D-CkDPMDuA.js"),__vite__mapDeps([243,225,203,227]))),"catalog-dynamic-group":()=>Ze().then(()=>N(()=>import("./CatalogDynamicGroupLayerView2D-WGDq3bjK.js"),__vite__mapDeps([244,225,203,227]))),"catalog-footprint":()=>Ze().then(()=>N(()=>import("./CatalogFootprintLayerView2D-kip7PRyy.js"),__vite__mapDeps([245,235,199,92,93,87,31,4,94,91,95,84,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,236,237,238,38,45,225,217,218,108,73,71,72,106,100,204,239,165,47,102,230,233,227,228,234]))),csv:ml,"geo-rss":()=>Ze().then(()=>N(()=>import("./GeoRSSLayerView2D-DmeYn9FN.js"),__vite__mapDeps([246,225,203,215,216,217,4,85,83,84,54,195,161,218,202,196,197,55,160,113,141,144,33,31,34,199,92,93,87,94,91,95,200,152,201,88,89,99,214,205,123,206,21,82,86,38,37,100,105,80,227]))),feature:ml,geojson:ml,parquet:ml,graphics:()=>Ze().then(()=>N(()=>import("./GraphicsLayerView2D-NF_kEgiI.js"),__vite__mapDeps([247,225,203,215,216,217,4,85,83,84,54,195,161,218,202,196,197,55,160,113,141,144,33,31,34,199,92,93,87,94,91,95,200,152,201,88,89,99,214,205,123,206,21,82,86,38,37,100,105,80,227,234]))),group:()=>Ze().then(()=>N(()=>import("./GroupLayerView2D-B957Ehx4.js"),__vite__mapDeps([248,225,203,227]))),imagery:()=>Ze().then(()=>N(()=>import("./ImageryLayerView2D-BnSyFVCo.js"),__vite__mapDeps([249,250,197,4,55,160,161,54,128,202,83,84,196,113,203,141,144,33,31,34,122,120,225,214,92,93,87,94,91,95,205,123,206,21,82,85,86,88,38,37,199,200,195,152,201,89,99,100,105,80,226,216,217,218,241,223,224,242,126,190,236,233,227,228,234]))),"imagery-tile":()=>Ze().then(()=>N(()=>import("./ImageryTileLayerView2D-B6aniczX.js"),__vite__mapDeps([251,252,250,197,4,55,160,161,54,128,202,83,84,196,113,203,141,144,33,31,34,122,120,225,125,253,218,200,195,152,213,201,88,224,254,126,234,190,236,233,227,228]))),kml:()=>Ze().then(()=>N(()=>import("./KMLLayerView2D-Dx2os8Fk.js"),__vite__mapDeps([255,256,223,203,200,161,195,196,152,224,241,202,83,84,54,197,4,55,160,113,141,144,33,31,34,225,215,216,217,85,218,199,92,93,87,94,91,95,201,88,89,99,214,205,123,206,21,82,86,38,37,100,105,80,227,15,16,17,126,210,194,150,151,208,253]))),"knowledge-graph":()=>Ze().then(()=>N(()=>import("./KnowledgeGraphLayerView2D-DvUAd8zE.js"),__vite__mapDeps([257,225,203,227]))),"link-chart":()=>Ze().then(()=>N(()=>import("./KnowledgeGraphLayerView2D-DvUAd8zE.js"),__vite__mapDeps([257,225,203,227]))),"knowledge-graph-sublayer":ml,"map-image":()=>Ze().then(()=>N(()=>import("./MapImageLayerView2D-BQLc3by9.js"),__vite__mapDeps([258,241,202,83,84,54,196,197,4,55,160,161,113,203,141,144,33,31,34,223,200,195,152,224,225,214,92,93,87,94,91,95,205,123,206,21,82,85,86,88,38,37,199,201,89,99,100,105,80,226,216,217,218,242,227,259,230,232,236,228,229,231,233,234]))),"map-notes":()=>Ze().then(()=>N(()=>import("./MapNotesLayerView2D-DMWOMlaK.js"),__vite__mapDeps([260,225,203,215,216,217,4,85,83,84,54,195,161,218,202,196,197,55,160,113,141,144,33,31,34,199,92,93,87,94,91,95,200,152,201,88,89,99,214,205,123,206,21,82,86,38,37,100,105,80,227,234]))),media:()=>Ze().then(()=>N(()=>import("./MediaLayerView2D-7NaczYum.js"),__vite__mapDeps([261,262,105,91,92,93,87,31,4,94,95,84,205,123,206,21,203,202,83,54,196,197,55,160,161,113,141,144,33,34,207,200,195,152,201,88,108,208,209,140,72,199,85,89,99,96,97,150,151,214,82,86,38,37,100,80,212,98,263,213,225,227]))),"ogc-feature":()=>Ze().then(()=>N(()=>import("./OGCFeatureLayerView2D-BiBPedNa.js"),__vite__mapDeps([264,235,199,92,93,87,31,4,94,91,95,84,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,236,237,238,38,45,225,217,218,108,73,71,72,106,100,204,239,165,47,102,230,233,227,228,234]))),"open-street-map":Cp,"oriented-imagery":ml,route:()=>Ze().then(()=>N(()=>import("./RouteLayerView2D-CETIdPtM.js"),__vite__mapDeps([265,266,267,225,203,215,216,217,4,85,83,84,54,195,161,218,202,196,197,55,160,113,141,144,33,31,34,199,92,93,87,94,91,95,200,152,201,88,89,99,214,205,123,206,21,82,86,38,37,100,105,80,227,234]))),stream:()=>Ze().then(()=>N(()=>import("./StreamLayerView2D-CtzMQQ_B.js"),__vite__mapDeps([268,235,199,92,93,87,31,4,94,91,95,84,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,236,237,238,38,45,225,217,218,108,73,71,72,106,100,204,239,165,47,102,230,233,227,228,234]))),"subtype-group":()=>Ze().then(()=>N(()=>import("./SubtypeGroupLayerView2D-HaKUiEBb.js"),__vite__mapDeps([269,235,199,92,93,87,31,4,94,91,95,84,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,236,237,238,38,45,225,217,218,108,73,71,72,106,100,204,239,165,47,102,230,233,227,228,234]))),tile:Cp,"vector-tile":()=>Ze().then(()=>N(()=>import("./VectorTileLayerView2D-NKrVBSV5.js"),__vite__mapDeps([270,95,72,4,91,140,209,141,94,161,197,55,160,202,83,84,54,196,113,203,144,33,31,34,218,36,142,143,123,225,227,228]))),video:()=>Ze().then(()=>N(()=>import("./VideoLayerView2D-D_BgKWXz.js"),__vite__mapDeps([271,272,273,174,173,263,113,202,83,84,54,196,197,4,55,160,161,203,141,144,33,31,34,199,92,93,87,94,91,95,200,195,152,85,201,88,89,99,213,274,225,215,216,217,218,214,205,123,206,21,82,86,38,37,100,105,80,227]))),wcs:()=>Ze().then(()=>N(()=>import("./ImageryTileLayerView2D-B6aniczX.js"),__vite__mapDeps([251,252,250,197,4,55,160,161,54,128,202,83,84,196,113,203,141,144,33,31,34,122,120,225,125,253,218,200,195,152,213,201,88,224,254,126,234,190,236,233,227,228]))),"web-tile":Cp,wfs:ml,wms:()=>Ze().then(()=>N(()=>import("./WMSLayerView2D-Ci7ifXte.js"),__vite__mapDeps([275,241,202,83,84,54,196,197,4,55,160,161,113,203,141,144,33,31,34,223,200,195,152,224,225,242,227,228,276,236]))),wmts:()=>Ze().then(()=>N(()=>import("./WMTSLayerView2D-CfX-2E2E.js"),__vite__mapDeps([277,222,223,203,200,161,195,196,152,224,202,83,84,54,197,4,55,160,113,141,144,33,31,34,218,225,227,228]))),"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"gaussian-splat":null,"integrated-mesh-3dtiles":null,"integrated-mesh":null,"line-of-sight":null,"point-cloud":null,scene:null,unknown:null,unsupported:null,viewshed:null,voxel:null};function Ule(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",r=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new x(`${r}:view-not-supported`,`${e} is not supported in 2D`)}const uC={hasLayerViewModule:t=>lC[t.type]!=null,importLayerView:t=>{const e=lC[t.type];if(e==null)throw Ule(t);return e(t)}};var Li;let op=(Li=class{static getId(e,r,i,s){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${r}/${i}/${s}`}constructor(e,r,i,s){this.set(e,r,i,s)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,r=4095&this.col,i=63&this.level;return(3&this.world)<<30|r<<22|e<<8|i}acquire(e,r,i,s){this.set(e,r,i,s)}contains(e){const r=e.level-this.level;return r>=0&&this.row===e.row>>r&&this.col===e.col>>r&&this.world===e.world}containsChild(e){const r=e.level-this.level;return r>0&&this.row===e.row>>r&&this.col===e.col>>r&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new Li(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,r,i,s){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[n,o,l,u]=e.split("/");this.level=parseFloat(n),this.row=parseFloat(o),this.col=parseFloat(l),this.world=parseFloat(u)}else this.level=+e,this.row=+r,this.col=+i,this.world=+s||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new Li(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(e,r,i){const s=this.clone();return s.col+=e,s.row+=r,i.normalizeKey(s),s}getChildKeys(){const e=this.level+1,r=this.row<<1,i=this.col<<1,s=this.world;return[new Li(e,r,i,s),new Li(e,r,i+1,s),new Li(e,r+1,i,s),new Li(e,r+1,i+1,s)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}},Li.pool=new Gh(()=>new Li(""),null,null,25,50),Li);function lc(t,e){return[t,e]}function yl(t,e,r){return t[0]=e,t[1]=r,t}function qle(t,e,r,i,s){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t}const ks=new op("0/0/0/0");let Gle=class R6{static create(e,r,i=null){const s=Kr(e.spatialReference),n=r.origin||lc(e.origin.x,e.origin.y),o=lc(e.size[0]*r.resolution,e.size[1]*r.resolution),l=lc(-1/0,-1/0),u=lc(1/0,1/0),d=lc(1/0,1/0);i!=null&&(yl(l,Math.max(0,Math.floor((i.xmin-n[0])/o[0])),Math.max(0,Math.floor((n[1]-i.ymax)/o[1]))),yl(u,Math.max(0,Math.floor((i.xmax-n[0])/o[0])),Math.max(0,Math.floor((n[1]-i.ymin)/o[1]))),yl(d,u[0]-l[0]+1,u[1]-l[1]+1));const{cols:p,rows:f}=r;let m,y,g,v;return!i&&p&&f&&(yl(l,p[0],f[0]),yl(u,p[1],f[1]),yl(d,p[1]-p[0]+1,f[1]-f[0]+1)),e.isWrappable?(m=lc(Math.ceil(Math.round((s.valid[1]-s.valid[0])/r.resolution)/e.size[0]),d[1]),y=!0,g=s.origin,v=s.valid):(m=d,y=!1),new R6(r.level,r.resolution,r.scale,n,l,u,d,o,m,y,g,v)}constructor(e,r,i,s,n,o,l,u,d,p,f,m){this.level=e,this.resolution=r,this.scale=i,this.origin=s,this.first=n,this.last=o,this.size=l,this.norm=u,this.worldSize=d,this.wrap=p,this._spatialReferenceOrigin=f,this._spatialReferenceValid=m}normalizeCol(e){if(!this.wrap)return e;const r=this.worldSize[0];return e<0?r-1-Math.abs((e+1)%r):e%r}normalizeKey(e){if(!this.wrap)return;const r=this.worldSize[0],i=e.col;i<0?(e.col=i+r,e.world-=1):i>=r&&(e.col=i-r,e.world+=1)}denormalizeCol(e,r){return this.wrap?this.worldSize[0]*r+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){const r=this.origin[0]+e*this.norm[0],i=this._spatialReferenceOrigin,s=this._spatialReferenceValid;return this.wrap&&i&&s?r===i[0]?s[0]:this.origin[0]===i[0]&&e===this.worldSize[0]?s[1]:r:r}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,r,i=!1){ks.set(r);const s=i?ks.col:this.denormalizeCol(ks.col,ks.world),n=ks.row;return qle(e,this.getXForColumn(s),this.getYForRow(n+1),this.getXForColumn(s+1),this.getYForRow(n)),e}getTileCoords(e,r,i=!1){ks.set(r);const s=i?ks.col:this.denormalizeCol(ks.col,ks.world);return Array.isArray(e)?yl(e,this.getXForColumn(s),this.getYForRow(ks.row)):(e.x=this.getXForColumn(s),e.y=this.getYForRow(ks.row)),e}};var xu;let o3=(xu=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}*keys(){const e=this.lodInfo;for(const{row:r,colFrom:i,colTo:s}of this.spans)for(let n=i;n<=s;n++){const o=e.getWorldForColumn(n);yield new op(e.level,r,e.normalizeCol(n),o)}}forEach(e,r){const{spans:i,lodInfo:s}=this,{level:n}=s;if(i.length!==0)for(const{row:o,colFrom:l,colTo:u}of i)for(let d=l;d<=u;d++)e.call(r,n,o,s.normalizeCol(d),s.getWorldForColumn(d))}},xu.pool=new Gh(()=>new xu),xu),Ab=class{constructor(e,r,i){this.row=e,this.colFrom=r,this.colTo=i}};const Qe=new op("0/0/0/0");let Ble=class L6{static create(e,r){e[1]>r[1]&&([e,r]=[r,e]);const[i,s]=e,[n,o]=r,l=n-i,u=o-s,d=u!==0?l/u:0,p=(Math.ceil(s)-s)*d,f=(Math.floor(s)-s)*d;return new L6(i,Math.floor(s),Math.ceil(o),d,l<0?p:f,l<0?f:p,l<0?n:i,l<0?i:n)}constructor(e,r,i,s,n,o,l,u){this.x=e,this.ymin=r,this.ymax=i,this.invM=s,this.leftAdjust=n,this.rightAdjust=o,this.leftBound=l,this.rightBound=u}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const $i=[[0,0],[0,0],[0,0],[0,0]],Hle=1e-6;let Wle=class{constructor(e,r=null,i=e.lods[0].level,s=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=r,this.scales=[],this._infoByScale={},this._infoByLevel={};const n=e.lods.filter(l=>l.level>=i&&l.level<=s);this.minScale=n[0].scale,this.maxScale=n[n.length-1].scale;const o=this._lodInfos=n.map(l=>Gle.create(e,l,r));n.forEach((l,u)=>{this._infoByLevel[l.level]=o[u],this._infoByScale[l.scale]=o[u],this.scales[u]=l.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,r,i=!1){Qe.set(r);const s=this._infoByLevel[Qe.level];return s?s.getTileBounds(e,Qe,i):e}getTileCoords(e,r,i=!1){Qe.set(r);const s=this._infoByLevel[Qe.level];return s?s.getTileCoords(e,Qe,i):e}getTileCoverage(e,r=192,i=!0,s="closest"){if(!i&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const n=s==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),o=o3.pool.acquire(n),l=this._wrap;let u,d,p,f=1/0,m=-1/0;const y=o.spans;$i[0][0]=$i[0][1]=$i[1][1]=$i[3][0]=-r,$i[1][0]=$i[2][0]=e.size[0]+r,$i[2][1]=$i[3][1]=e.size[1]+r;for(const S of $i)e.toMap(S,S),S[0]=n.getColumnForX(S[0]),S[1]=n.getRowForY(S[1]);const g=[];let v=3;for(let S=0;S<4;S++){if($i[S][1]===$i[v][1]){v=S;continue}const M=Ble.create($i[S],$i[v]);f=Math.min(M.ymin,f),m=Math.max(M.ymax,m),g[M.ymin]===void 0&&(g[M.ymin]=[]),g[M.ymin].push(M),v=S}if(f==null||m==null||m-f>100)return null;let _=[];for(u=f;u<m;){g[u]!=null&&(_=_.concat(g[u])),d=1/0,p=-1/0;for(let S=_.length-1;S>=0;S--){const M=_[S];d=Math.min(d,M.getLeftCol()),p=Math.max(p,M.getRightCol())}if(d=Math.floor(d),p=Math.floor(p),u>=n.first[1]&&u<=n.last[1])if(l)if(n.size[0]<n.worldSize[0]){const S=Math.floor(p/n.worldSize[0]);for(let M=Math.floor(d/n.worldSize[0]);M<=S;M++)y.push(new Ab(u,Math.max(n.getFirstColumnForWorld(M),d),Math.min(n.getLastColumnForWorld(M),p)))}else y.push(new Ab(u,d,p));else d>n.last[0]||p<n.first[0]||(d=Math.max(d,n.first[0]),p=Math.min(p,n.last[0]),y.push(new Ab(u,d,p)));u+=1;for(let S=_.length-1;S>=0;S--){const M=_[S];M.ymax>=u?M.incrRow():_.splice(S,1)}}return o}getTileParentId(e){Qe.set(e);const r=this._infoByLevel[Qe.level],i=this._lodInfos.indexOf(r)-1;return i<0?null:(this._getTileIdAtLOD(Qe,this._lodInfos[i],Qe),Qe.id)}getTileResolution(e){const r=this._infoByLevel[typeof e=="object"?e.level:e];return r?r.resolution:-1}getTileScale(e){const r=this._infoByLevel[e.level];return r?r.scale:-1}intersects(e,r){Qe.set(r);const i=this._infoByLevel[Qe.level],s=e.lodInfo;if(s.resolution>i.resolution){this._getTileIdAtLOD(Qe,s,Qe);const o=s.denormalizeCol(Qe.col,Qe.world);for(const l of e.spans)if(l.row===Qe.row&&l.colFrom<=o&&l.colTo>=o)return!0}if(s.resolution<i.resolution){const[o,l,u,d]=e.spans.reduce((v,_)=>(v[0]=Math.min(v[0],_.row),v[1]=Math.max(v[1],_.row),v[2]=Math.min(v[2],_.colFrom),v[3]=Math.max(v[3],_.colTo),v),[1/0,-1/0,1/0,-1/0]),p=i.denormalizeCol(Qe.col,Qe.world),f=s.getColumnForX(i.getXForColumn(p)),m=s.getRowForY(i.getYForRow(Qe.row)),y=s.getColumnForX(i.getXForColumn(p+1))-1,g=s.getRowForY(i.getYForRow(Qe.row+1))-1;return!(f>d||y<u||m>l||g<o)}const n=s.denormalizeCol(Qe.col,Qe.world);return e.spans.some(o=>o.row===Qe.row&&o.colFrom<=n&&o.colTo>=n)}normalizeBounds(e,r,i){if(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],this._wrap){const s=Kr(this.tileInfo.spatialReference),n=-i*(s.valid[1]-s.valid[0]);e[0]+=n,e[2]+=n}return e}getSmallestInfoForScale(e){const r=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>r[0])return this._infoByScale[r[0]];for(let i=1;i<r.length-1;i++)if(e>r[i]+Hle)return this._infoByScale[r[i-1]];return this._infoByScale[r[r.length-1]]}getClosestInfoForScale(e){const r=this.scales;return this._infoByScale[e]||(e=r.reduce((i,s)=>Math.abs(s-e)<Math.abs(i-e)?s:i,r[0])),this._infoByScale[e]}scaleToLevel(e){const r=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let i=r.length-1;i>=0;i--)if(e<r[i])return i===r.length-1?this._infoByScale[r[r.length-1]].level:this._infoByScale[r[i]].level+(r[i]-e)/(r[i]-r[i+1]);return this._infoByScale[r[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}zoomToScale(e){return this.tileInfo.zoomToScale(e)}_getTileIdAtLOD(e,r,i){const s=this._infoByLevel[i.level];return e.set(i),r.resolution<s.resolution?null:(r.resolution===s.resolution||(e.level=r.level,e.col=Math.floor(i.col*s.resolution/r.resolution+.01),e.row=Math.floor(i.row*s.resolution/r.resolution+.01)),e)}},Zle=class{constructor(e,r){this.item=e,this.controller=r,this.promise=null}},Jle=class{constructor(e){this._schedule=null,this._task=null,this._deferreds=new Dd,this._controllers=new Dd,this._processingItems=new Dd,this._pausedSignal=Ph(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new Am(e.peeker),this.process=e.process;const r=e.scheduler;e.priority&&r&&(this._task=r.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=He(this._schedule),this._task=He(this._task)}get updating(){return!!this._task?.updating||this.readyToRun}get length(){return this._processingItems.size+this._queue.length}abort(e){const r=this._controllers.get(e);r&&r.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(r=>e.push(r)),this._controllers.clear(),e.forEach(r=>r.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((r,i)=>e(i))}get(e){const r=this._deferreds.get(e);return r?r.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,r){const i=this.get(e);if(i)return i;const s=new AbortController;let n=null;r&&(n=ys(r,()=>s.abort()));const o=()=>{const p=this._processingItems.get(e);p&&p.controller.abort(),l(),d.reject(Fe())},l=()=>{u.remove(),n?.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},u=mT(s.signal,o),d=bi();return this._deferreds.set(e,d),this._controllers.set(e,s),d.promise.then(l,l),this._queue.push(e),this._scheduleNext(),d.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){const e=this._queue.popLast();return e&&(this._deferreds.get(e)?.reject(Fe()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const r of e)this._queue.push(r.item),r.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get readyToRun(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=Wh(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,r){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(r))}_processError(e,r){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(r))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let r;const i=new AbortController,s=new Zle(e,i);this._processingItems.set(e,s);try{r=this.process(e,i.signal)}catch(n){this._processError(s,n)}Ar(r)?(s.promise=r,r.then(n=>this._processResult(s,n),n=>this._processError(s,n))):this._processResult(s,r)}get test(){}};const cC=[0,0];let no=class extends X{constructor(e){super(e),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:e,process:r,scheduler:i,priority:s}=this;this._queue=new Jle({concurrency:e,scheduler:i,priority:s,process:(n,o)=>{const l=this._keyToItem.get(n);return r(l,{signal:o})},peeker:n=>this._peek(n)})}destroy(){this.clear(),this._queue=Ke(this._queue)}get length(){return this._queue?this._queue.length:0}abort(e){const r=typeof e=="string"?e:e.id;this._queue.abort(r)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}pause(){this._queue.pause()}push(e){const r=e.key.id;if(this._queue.has(r))return this._queue.get(r);const i=this._queue.push(r),s=this.tileInfoView.getTileScale(e.key),n=zh(this._tilesByScale,s,()=>new Set),o=()=>{n.delete(e.key),n.size===0&&this._tilesByScale.delete(s),this._keyToItem.delete(r)};return n.add(e.key),this._keyToItem.set(r,e),i.then(o,o),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(e){if(!this.state)return e.values().next().value;const r=new Set;for(const o of e)r.add(this._keyToItem.get(o).key);const i=this.state.scale;let s,n=Number.POSITIVE_INFINITY;for(const[o,l]of this._tilesByScale)if(nL(l,u=>r.has(u))){const u=Math.abs(o-i);u<n&&(s=l,n=u)}return this._getClosestTileKey(s,e).id}_getClosestTileKey(e,r){const i=this.tileInfoView,s=this.state.center;let n,o=Number.POSITIVE_INFINITY;for(const l of e)if(r.has(l.id)){i.getTileCoords(cC,l);const u=Gw(cC,s);u<o&&(o=u,n=l)}return n}};a([c({constructOnly:!0})],no.prototype,"concurrency",void 0),a([c({constructOnly:!0})],no.prototype,"priority",void 0),a([c({constructOnly:!0})],no.prototype,"process",void 0),a([c({constructOnly:!0})],no.prototype,"scheduler",void 0),a([c()],no.prototype,"state",void 0),a([c({constructOnly:!0})],no.prototype,"tileInfoView",void 0),no=a([b("esri.views.2d.tiling.TileQueue")],no);const PTe=no;let Yle=class{constructor(e,r,i){this.maxSize=e,this._tileInfoView=r,this._removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const r=this._tilePerId.get(e);if(!r)return;const i=r.key.level,s=this._tileKeysPerLevel[i];dC(this._tilePerId,e);for(let n=0;n<s.length;n++)if(s[n].id===e){s.splice(n,1);break}return r.visible=!0,r}add(e){e.visible=!1;const r=e.key,i=r.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,e);const s=r.level;this._tileKeysPerLevel[s]||(this._tileKeysPerLevel[s]=[]),this._tileKeysPerLevel[s].push(r)}prune(e,r,i){let s=this._tilePerId.size;if(s<=this.maxSize)return;let n=this._tileKeysPerLevel.length-1;for(;s>this.maxSize&&n>=0;)n!==e&&(s=this._pruneAroundCenterTile(s,r,i,n)),n--;s>this.maxSize&&(s=this._pruneAroundCenterTile(s,r,i,e))}_pruneAroundCenterTile(e,r,i,s){const n=this._tileKeysPerLevel[s];if(!n||n.length===0)return e;const{size:o,origin:l}=this._tileInfoView.tileInfo,u=i*o[0],d=i*o[1],p=[0,0],f=[0,0];for(n.sort((m,y)=>(p[0]=l.x+u*(m.col+.5),p[1]=l.y-d*(m.row+.5),f[0]=l.x+u*(y.col+.5),f[1]=l.y-d*(y.row+.5),Im(p,r)-Im(f,r)));n.length>0;){const m=n.pop();if(this._removeTile(m.id),--e===this.maxSize)break}return e}_removeTile(e){const r=this._tilePerId.get(e);this._removedFunc&&r&&this._removedFunc(r),dC(this._tilePerId,e)}};function dC(t,e){t.delete(e)}const gl=new op(0,0,0,0),Bn=new Map,Pp=[],Rb=[];let RTe=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new Yle(e.cacheSize,this.tileInfoView,r=>{this.releaseTile(r)}))}destroy(){this.tileIndex.clear()}update(e){const{resampling:r,tileIndex:i}=this,{scale:s,center:n,resolution:o}=e.state,{minScale:l,maxScale:u}=this.tileInfoView,d=!e.stationary&&s>this._previousScale;if(this._previousScale=s,!r&&(s>l||s<u))return this.tiles.length=0,void this.clear();const p=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!p)return this.tiles.length=0,void this.clear();const{spans:f,lodInfo:m}=p,{level:y}=m;this.tiles.length=0,i.forEach(S=>S.visible=!0);let g=0,v=0;if(f.length>0)for(const{row:S,colFrom:M,colTo:C}of f)for(let T=M;T<=C;T++){g++;const O=gl.set(y,S,m.normalizeCol(T),m.getWorldForColumn(T)).id;let P=i.get(O);if(P)P.isReady?(Bn.set(O,P),v++):d||this._addParentTile(O,Bn);else{if(this._tileCache?.has(O)){if(P=this._tileCache.pop(O),this.tileIndex.set(O,P),P.isReady){Bn.set(O,P),v++;continue}}else P=this.acquireTile(gl),this.tileIndex.set(O,P);d||this._addParentTile(O,Bn)}}const _=v===g;for(const[S,M]of i){if(Bn.has(S))continue;gl.set(S);const C=this.tileInfoView.intersects(p,gl),T=this.cachePolicy==="purge"?gl.level!==y:gl.level>y;!C||!d&&_?!T&&C||Pp.push(M):M.isReady?T&&this.cachePolicy==="purge"&&this._hasReadyAncestor(gl,y)?Pp.push(M):Rb.push(M):T&&Pp.push(M)}for(const S of Rb)S.isReady&&Bn.set(S.key.id,S);for(const S of Pp)this._tileCache?this._tileCache.add(S):this.releaseTile(S),i.delete(S.key.id);for(const S of Bn.values())this.tiles.push(S);for(const S of i.values())Bn.has(S.key.id)||(S.visible=!1);this._tileCache?.prune(y,n,o),o3.pool.release(p),Rb.length=0,Pp.length=0,Bn.clear()}clear(){const{tileIndex:e}=this;for(const r of e.values())this.releaseTile(r);e.clear()}refresh(e){for(const r of this.tileIndex.values())e(r);this._tileCache?.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,r){let i=e,s=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(s=this.tileIndex.get(i),s?.isReady){r.has(s.key.id)||r.set(s.key.id,s);break}}else if(this._tileCache?.has(i)&&(s=this._tileCache.pop(i),this.tileIndex.set(i,s),s?.isReady)){r.has(s.key.id)||r.set(s.key.id,s);break}}_hasReadyAncestor(e,r){const i=yi();this.tileInfoView.getTileBounds(i,e,!0);for(const s of this.tileIndex.values())if(s.isReady&&s.key.level>=r&&s.key.level<e.level){const n=yi();if(this.tileInfoView.getTileBounds(n,s.key,!0),uY(n,i))return!0}return!1}};const Kle={"area-measurement":null,dimension:null,"direct-line-measurement":null,"elevation-profile":()=>N(()=>import("./ElevationProfileAnalysisView2D-YLTj2dlB.js"),__vite__mapDeps([278,123,168,272,279,220,280,281,282,283,284,285,17,286,287,288,289,290,111,112,291,292,293,14,294,295,135,65,117,118,131,170,63,296,104,144,149,130])),"line-of-sight":null,slice:null,viewshed:null,"volume-measurement":null};function Qle(t){const e=Kle[t.type];if(!e)throw new x("analysis-view-module-import-utils:analysis-not-supported",`Analysis "${t.type}" is not supported`);return e()}let Xle=class{constructor(e,r={}){this.events=new ML,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,e!=null?(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform"),e.contains(this._canvas)||e.appendChild(this._canvas)):r.canvas!=null&&(this._canvas=r.canvas);const i={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};let s=this._canvas.getContext("webgl2",i);s||(s=this._canvas.getContext("webgl2",{...i,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=s,this._handles=qu([qh(this._canvas,"webglcontextlost",n=>this.events.emit("webgl-context-lost",n))])}destroy(){this._canvas.remove(),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}get canvas(){return this._canvas}render(e,r){if(this._hasMajorPerformanceCaveat||k("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=k("esri-performance-mode-frames-between-render")&&(r(),this._lastRenderViewState=e.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[i,s,n,o,l,u]=this._computeViewTransform(this._lastRenderViewState,e.state);this._canvas.style.transform=`matrix(${i}, ${s}, ${n}, ${o}, ${l}, ${u})`}}else r()}resize(e){const r=this._canvas,i=r.style,{state:{size:s},pixelRatio:n}=e,o=s[0],l=s[1],u=Math.round(o*n),d=Math.round(l*n);r.width===u&&r.height===d||(r.width=u,r.height=d),i.width=o+"px",i.height=l+"px"}_computeViewTransform(e,r){const[i,s]=e.center,[n,o]=r.center,[l,u]=e.toScreen([0,0],n,o),[d,p]=e.toScreen([0,0],i,s),f=d-l,m=p-u,y=e.scale/r.scale,g=r.rotation-e.rotation,v=Ln();return qj(v),n1(v,v,[y,y]),_y(v,v,ly(g)),Lh(v,v,[f,m]),v}};function eue(t,e,r,i,s){F6(t,e,r||0,i||t.length-1,s||tue)}function F6(t,e,r,i,s){for(;i>r;){if(i-r>600){var n=i-r+1,o=e-r+1,l=Math.log(n),u=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*u*(n-u)/n)*(o-n/2<0?-1:1);F6(t,e,Math.max(r,Math.floor(e-o*u/n+d)),Math.min(i,Math.floor(e+(n-o)*u/n+d)),s)}var p=t[e],f=r,m=i;for(Ap(t,r,e),s(t[i],p)>0&&Ap(t,r,i);f<m;){for(Ap(t,f,m),f++,m--;s(t[f],p)<0;)f++;for(;s(t[m],p)>0;)m--}s(t[r],p)===0?Ap(t,r,m):Ap(t,++m,i),m<=e&&(r=m+1),e<=m&&(i=m-1)}}function Ap(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function tue(t,e){return t<e?-1:t>e?1:0}function Xv(t,e){if(!(this instanceof Xv))return new Xv(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function rue(t,e,r){if(!r)return e.indexOf(t);for(var i=0;i<e.length;i++)if(r(t,e[i]))return i;return-1}function uc(t,e){gf(t,0,t.children.length,e,t)}function gf(t,e,r,i,s){s||(s=jc(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var n,o=e;o<r;o++)n=t.children[o],vf(s,t.leaf?i(n):n);return s}function vf(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function hC(t,e){return t.minX-e.minX}function pC(t,e){return t.minY-e.minY}function Lb(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function ug(t){return t.maxX-t.minX+(t.maxY-t.minY)}function iue(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function sue(t,e){var r=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),n=Math.min(t.maxY,e.maxY);return Math.max(0,s-r)*Math.max(0,n-i)}function Fb(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function cg(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function jc(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function fC(t,e,r,i,s){for(var n,o=[e,r];o.length;)(r=o.pop())-(e=o.pop())<=i||(n=e+Math.ceil((r-e)/i/2)*i,eue(t,n,e,r,s),o.push(e,n,n,r))}Xv.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],i=this.toBBox;if(!cg(t,e))return r;for(var s,n,o,l,u=[];e;){for(s=0,n=e.children.length;s<n;s++)o=e.children[s],cg(t,l=e.leaf?i(o):o)&&(e.leaf?r.push(o):Fb(t,l)?this._all(o,r):u.push(o));e=u.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!cg(t,e))return!1;for(var i,s,n,o,l=[];e;){for(i=0,s=e.children.length;i<s;i++)if(n=e.children[i],cg(t,o=e.leaf?r(n):n)){if(e.leaf||Fb(t,o))return!0;l.push(n)}e=l.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var s=this.data;this.data=i,i=s}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t!=null&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=jc([]),this},remove:function(t,e){if(t==null)return this;for(var r,i,s,n,o=this.data,l=this.toBBox(t),u=[],d=[];o||u.length;){if(o||(o=u.pop(),i=u[u.length-1],r=d.pop(),n=!0),o.leaf&&(s=rue(t,o.children,e))!==-1)return o.children.splice(s,1),u.push(o),this._condense(u),this;n||o.leaf||!Fb(o,l)?i?(r++,o=i.children[r],n=!1):o=null:(u.push(o),d.push(r),r=0,i=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:hC,compareMinY:pC,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,i){var s,n=r-e+1,o=this._maxEntries;if(n<=o)return uc(s=jc(t.slice(e,r+1)),this.toBBox),s;i||(i=Math.ceil(Math.log(n)/Math.log(o)),o=Math.ceil(n/Math.pow(o,i-1))),(s=jc([])).leaf=!1,s.height=i;var l,u,d,p,f=Math.ceil(n/o),m=f*Math.ceil(Math.sqrt(o));for(fC(t,e,r,m,this.compareMinX),l=e;l<=r;l+=m)for(fC(t,l,d=Math.min(l+m-1,r),f,this.compareMinY),u=l;u<=d;u+=f)p=Math.min(u+f-1,d),s.children.push(this._build(t,u,p,i-1));return uc(s,this.toBBox),s},_chooseSubtree:function(t,e,r,i){for(var s,n,o,l,u,d,p,f;i.push(e),!e.leaf&&i.length-1!==r;){for(p=f=1/0,s=0,n=e.children.length;s<n;s++)u=Lb(o=e.children[s]),(d=iue(t,o)-u)<f?(f=d,p=u<p?u:p,l=o):d===f&&u<p&&(p=u,l=o);e=l||e.children[0]}return e},_insert:function(t,e,r){var i=this.toBBox,s=r?t:i(t),n=[],o=this._chooseSubtree(s,this.data,e,n);for(o.children.push(t),vf(o,s);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(s,n,e)},_split:function(t,e){var r=t[e],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);var n=this._chooseSplitIndex(r,s,i),o=jc(r.children.splice(n,r.children.length-n));o.height=r.height,o.leaf=r.leaf,uc(r,this.toBBox),uc(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(r,o)},_splitRoot:function(t,e){this.data=jc([t,e]),this.data.height=t.height+1,this.data.leaf=!1,uc(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var i,s,n,o,l,u,d,p;for(u=d=1/0,i=e;i<=r-e;i++)o=sue(s=gf(t,0,i,this.toBBox),n=gf(t,i,r,this.toBBox)),l=Lb(s)+Lb(n),o<u?(u=o,p=i,d=l<d?l:d):o===u&&l<d&&(d=l,p=i);return p},_chooseSplitAxis:function(t,e,r){var i=t.leaf?this.compareMinX:hC,s=t.leaf?this.compareMinY:pC;this._allDistMargin(t,e,r,i)<this._allDistMargin(t,e,r,s)&&t.children.sort(i)},_allDistMargin:function(t,e,r,i){t.children.sort(i);var s,n,o=this.toBBox,l=gf(t,0,e,o),u=gf(t,r-e,r,o),d=ug(l)+ug(u);for(s=e;s<r-e;s++)n=t.children[s],vf(l,t.leaf?o(n):n),d+=ug(l);for(s=r-e-1;s>=e;s--)n=t.children[s],vf(u,t.leaf?o(n):n),d+=ug(u);return d},_adjustParentBBoxes:function(t,e,r){for(var i=r;i>=0;i--)vf(e[i],t)},_condense:function(t){for(var e,r=t.length-1;r>=0;r--)t[r].children.length===0?r>0?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():uc(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};function nue(t,{timeZone:e,timeExtent:r}){return{$view:{scale:t,timeZone:e,timeProperties:{currentStart:r?.start,currentEnd:r?.end}}}}let mC=class N6{constructor(e,r){this.key=new op(0,0,0,0),this.bounds=yi(),this.objectIds=new Set,this.key.set(r);const i=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.level=i.level,this.scale=i.scale,this.minScale=e.zoomToScale(i.level-1),this.maxScale=e.zoomToScale(i.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return oY(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(e){return nue(this.scale,e)}createChildTiles(){const e=this.key.getChildKeys(),r=Br.acquire();for(let i=0;i<e.length;i++)r[i]=new N6(this.tileInfoView,e[i]);return r}getQuantizationParameters(){return _a.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const vl={added:[],removed:[]},Nb=new Set,oue=new op(0,0,0,0);function aue(t,e){const r=Kr(e);if(!r)return null;const[i,s]=r.valid;return t[2]>s?[yi([t[0],t[1],s,t[3]]),yi([i,t[1],i+t[2]-s,t[3]])]:t[0]<i?[yi([i,t[1],t[2],t[3]]),yi([s-(i-t[0]),t[1],s,t[3]])]:null}let lue=class extends TL{constructor(e){super(),this._tiles=new Map,this._index=Xv(9,k("esri-csp-restrictions")?r=>({minX:r.bounds[0],minY:r.bounds[1],maxX:r.bounds[2],maxY:r.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){super.destroy(),this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||cM(e)===0||dM(e)===0)return[];const r=aue(e,this.tileScheme.spatialReference);return r!=null?[...new Set([...this.boundsIntersections(r[0]),...this.boundsIntersections(r[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const r={added:[],removed:[]};for(const i of e.added)if(!this.has(i)){const s=new mC(this.tileScheme,i);this._tiles.set(i,s),this._index.insert(s),r.added.push(s)}for(const i of e.removed)if(this.has(i)){const s=this.get(i);this._tiles.delete(i),this._index.remove(s),r.removed.push(s)}this.tiles.length=0,this._tiles.forEach(i=>this.tiles.push(i)),(r.added.length||r.removed.length)&&this.emit("update",r)}setViewState(e){const r=this.tileScheme.getTileCoverage(e,0);if(!r)return;const{spans:i,lodInfo:s}=r,{level:n}=s;if(i.length>0)for(const{row:o,colFrom:l,colTo:u}of i)for(let d=l;d<=u;d++){const p=oue.set(n,o,s.normalizeCol(d),s.getWorldForColumn(d)).id;if(Nb.add(p),!this.has(p)){const f=new mC(this.tileScheme,p);this._tiles.set(p,f),this._index.insert(f),this.tiles.push(f),vl.added.push(f)}}for(let o=this.tiles.length-1;o>=0;o--){const l=this.tiles[o];Nb.has(l.id)||(this._tiles.delete(l.id),this.tiles.splice(o,1),this._index.remove(l),vl.removed.push(l))}(vl.added.length||vl.removed.length)&&this.emit("update",vl),o3.pool.release(r),Nb.clear(),vl.added.length=0,vl.removed.length=0}};const DTe=1e-30,yC=512,dg=16777216,jTe=8,VTe=29,zTe=24,UTe=4,qTe=0,GTe=0,BTe=0,HTe=1,WTe=2,ZTe=3,JTe=4,YTe=5,KTe=6,QTe=12,XTe=13,eMe=5,uue=6,tMe=5,rMe=6,D6=6,cue=1<<D6,iMe=cue<<1,sMe=1.05,nMe=3,oMe=1,aMe=3,lMe=3,uMe=5,cMe=6,dMe=1.15,due=4,hMe=128,hue=256,pMe=hue-2*due,fMe=2,mMe=128,yMe=1,gMe=10,vMe=1024,wMe=128,bMe=4,_Me=1,SMe=1<<20,$Me=.75,xMe=10,TMe=.75,MMe=256,IMe=32,EMe=512,OMe=0,kMe=1,pue=1,CMe=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],PMe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Rp=256,fue=()=>L.getLogger("esri.views.webgl.checkWebGLError");function j6(t){switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const V6=!!k("enable-feature:webgl-debug");function z6(){return V6}function AMe(){return V6}function wl(t,e=z6()){if(e){const r=j6(t);if(r){const i=new Error().stack;fue().error(new x("webgl-error","WebGL error occurred",{message:r,stack:i}))}}}const RMe={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},bl={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131},ie={RGBA4:32854,R16F:33325,RG16F:33327,RGB32F:34837,RGBA16F:34842,R32F:33326,RG32F:33328,RGBA32F:34836,R11F_G11F_B10F:35898,RGB8:32849,RGBA8:32856,RGB5_A1:32855,R8:33321,RG8:33323,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,RGB16F:34843,RGB9_E5:35901,SRGB8:35905,SRGB8_ALPHA8:35907,RGB565:36194,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2:32857,RGB10_A2UI:36975},mue=Object.values(ie),ew={DEPTH24_STENCIL8:35056,DEPTH32F_STENCIL8:36013},lm={DEPTH_COMPONENT16:33189,DEPTH_COMPONENT24:33190,DEPTH_COMPONENT32F:36012},E$={FLOAT:bl.FLOAT,UNSIGNED_BYTE:bl.UNSIGNED_BYTE,UNSIGNED_INT_24_8:34042,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,BYTE:bl.BYTE,UNSIGNED_SHORT:bl.UNSIGNED_SHORT,SHORT:bl.SHORT,UNSIGNED_INT:bl.UNSIGNED_INT,INT:bl.INT,HALF_FLOAT:5131,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269},LMe=33984,gC={Texture:0,TileTexture:1,BufferObject:2,VertexArrayObject:3,Shader:4,Program:5,FramebufferObject:6,Renderbuffer:7,TransformFeedback:8,Sync:9,UNCOUNTED:10,LinesOfCode:10,Uniform:11,COUNT:12},FMe=1029,NMe=0,DMe=36064,jMe=36065,VMe=36066,zMe=36067,UMe=33306,qMe=36096,GMe=36128,_r={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497};function BMe(t,e,r,i=0){const s=t.gl;t.bindBuffer(r);for(const n of r.layout){const o=e.get(n.name);if(o==null){console.warn(`There is no location for vertex attribute '${n.name}' defined.`);continue}const l=i*n.stride;if(n.count<=4)s.vertexAttribPointer(o,n.count,n.type,n.normalized,n.stride,n.offset+l),s.enableVertexAttribArray(o),n.divisor>0&&s.vertexAttribDivisor(o,n.divisor);else if(n.count===9)for(let u=0;u<3;u++)s.vertexAttribPointer(o+u,3,n.type,n.normalized,n.stride,n.offset+12*u+l),s.enableVertexAttribArray(o+u),n.divisor>0&&s.vertexAttribDivisor(o+u,n.divisor);else if(n.count===16)for(let u=0;u<4;u++)s.vertexAttribPointer(o+u,4,n.type,n.normalized,n.stride,n.offset+16*u+l),s.enableVertexAttribArray(o+u),n.divisor>0&&s.vertexAttribDivisor(o+u,n.divisor);else console.error("Unsupported vertex attribute element count: "+n.count);if(z6()){const u=j6(t.gl);u&&console.error(`Unable to bind vertex attribute "${n.name}" with baseInstanceOffset ${l}:`,u,n)}}}function HMe(t){switch(t){case 6406:case 6409:case 6403:case 36244:case 6402:case 34041:return 1;case 6410:case 33319:case 33320:return 2;case 6407:case 36248:return 3;case 6408:case 36249:return 4}return 0}function yue(t){switch(t){case 6406:case 6409:case 6403:case 36244:case ie.R8:case ie.R8I:case ie.R8UI:case ie.R8_SNORM:case 36168:return 1;case 6410:case 33319:case 33320:case ie.RGBA4:case ie.R16F:case ie.R16I:case ie.R16UI:case ie.RG8:case ie.RG8I:case ie.RG8UI:case ie.RG8_SNORM:case ie.RGB565:case ie.RGB5_A1:case lm.DEPTH_COMPONENT16:return 2;case 6407:case 36248:case ie.RGB8:case ie.RGB8I:case ie.RGB8UI:case ie.RGB8_SNORM:case ie.SRGB8:case lm.DEPTH_COMPONENT24:return 3;case 6408:case 36249:case ie.RGBA8:case ie.R32F:case ie.R11F_G11F_B10F:case ie.RG16F:case ie.R32I:case ie.R32UI:case ie.RG16I:case ie.RG16UI:case ie.RGBA8I:case ie.RGBA8UI:case ie.RGBA8_SNORM:case ie.SRGB8_ALPHA8:case ie.RGB9_E5:case ie.RGB10_A2UI:case ie.RGB10_A2:case lm.DEPTH_COMPONENT32F:case ew.DEPTH24_STENCIL8:return 4;case ew.DEPTH32F_STENCIL8:return 5;case ie.RGB16F:case ie.RGB16I:case ie.RGB16UI:return 6;case ie.RG32F:case ie.RG32I:case ie.RG32UI:case ie.RGBA16F:case ie.RGBA16I:case ie.RGBA16UI:return 8;case ie.RGB32F:case ie.RGB32I:case ie.RGB32UI:return 12;case ie.RGBA32F:case ie.RGBA32I:case ie.RGBA32UI:return 16;case _r.COMPRESSED_RGB_S3TC_DXT1_EXT:case _r.COMPRESSED_RGBA_S3TC_DXT1_EXT:return .5;case _r.COMPRESSED_RGBA_S3TC_DXT3_EXT:case _r.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case _r.COMPRESSED_R11_EAC:case _r.COMPRESSED_SIGNED_R11_EAC:case _r.COMPRESSED_RGB8_ETC2:case _r.COMPRESSED_SRGB8_ETC2:case _r.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case _r.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return .5;case _r.COMPRESSED_RG11_EAC:case _r.COMPRESSED_SIGNED_RG11_EAC:case _r.COMPRESSED_RGBA8_ETC2_EAC:case _r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}let U6=class{constructor(e=0,r=e){this.width=e,this.height=r,this.type=0,this.target=3553,this.pixelFormat=6408,this.dataType=E$.UNSIGNED_BYTE,this.samplingMode=9729,this.wrapMode=10497,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.compareEnabled=!1,this.linearFilterDepth=!1,this.depth=1,this.isImmutable=!1}};function gue(t){return t.width<=0||t.height<=0||t.depth<=0?0:Math.round(t.width*t.height*t.depth*(t.hasMipmap?4/3:1)*(t.internalFormat==null?4:yue(t.internalFormat))*(t.target===34067?6:1))}const Lp=()=>L.getLogger("esri/views/webgl/textureUtils");function Fp(t){const{width:e,height:r,depth:i}=t;(e!=null&&e<0||r!=null&&r<0||i!=null&&i<0)&&Lp().error("Negative dimension parameters are not allowed!");const{internalFormat:s}=t;if(s&&(q6(s)||G6(s))){const{linearFilterDepth:n,compareEnabled:o,samplingMode:l,hasMipmap:u}=t;u&&Lp().error("Depth textures cannot have mipmaps"),n?l!==9729&&l!==9728&&Lp().error("Depth textures cannot sample mipmaps"):(l!==9728&&Lp().error("Depth textures without filtering must use NEAREST filtering"),o&&Lp().error("Depth textures without filtering cannot use compare function"))}}function vue(t){return mue.includes(t)}function q6(t){return mw(lm,t)}function G6(t){return mw(ew,t)}function wue(t){return t!=null&&mw(_r,t)}function Vc(t){return t!=null&&"type"in t&&t.type==="compressed"}function bue(t){return t!=null&&"byteLength"in t}function vC(t){return t!=null&&!Vc(t)&&!bue(t)}function cc(t){return t===32879||t===35866}function wC(t,e,r,i=1){let s=Math.max(e,r);return t===32879&&(s=Math.max(s,i)),Math.floor(Math.log2(s))+1}function hg(t){if(t.internalFormat!=null)return t.internalFormat;switch(t.dataType){case E$.FLOAT:switch(t.pixelFormat){case 6408:return ie.RGBA32F;case 6407:return ie.RGB32F;default:throw new x("texture:unknown-format","Unable to derive format")}case E$.UNSIGNED_BYTE:switch(t.pixelFormat){case 6408:return ie.RGBA8;case 6407:return ie.RGB8}}const{pixelFormat:e}=t;return t.internalFormat=e===34041?ew.DEPTH24_STENCIL8:e===6402?lm.DEPTH_COMPONENT24:e,t.internalFormat}function _ue(t){let e="width"in t?t.width:t.codedWidth,r="height"in t?t.height:t.codedHeight;return t instanceof HTMLVideoElement&&(e=t.videoWidth,r=t.videoHeight),{width:e,height:r,depth:1}}let Sue=class B6 extends U6{constructor(e,r){switch(super(),this.context=e,Object.assign(this,r),this.internalFormat){case ie.R16F:case ie.R32F:case ie.R8_SNORM:case ie.R8:this.pixelFormat=6403;break;case ie.R8I:case ie.R8UI:case ie.R16I:case ie.R16UI:case ie.R32I:case ie.R32UI:this.pixelFormat=36244}}static validate(e,r){return new B6(e,r)}};const $ue=!!k("esri-tests-disable-gpu-memory-measurements"),Hn=()=>L.getLogger("esri/views/webgl/Texture");var Ct;let xue=(Ct=class{constructor(e,r=null,i=null){if(this.type=1,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._shadowFilterDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,i=r;else{const s=Sue.validate(e,r);if(!s)throw new x("texture:invalid-descriptor","Texture descriptor invalid");this._descriptor=s}this._descriptor.target===34067?this._setDataCubeMap(i):this.setData(i)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return $ue?0:gue(this._descriptor)}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty||this._shadowFilterDirty}get hasWebGLTextureObject(){return!!this._glName}dispose(){this.abortCompression(),this.hasWebGLTextureObject&&this._descriptor.context?.gl&&(this._descriptor.context.instanceCounter.decrement(gC.Texture,this),this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null,this._descriptor=null)}release(){this.dispose()}[Symbol.dispose](){this.dispose()}resize(e,r){const i=this._descriptor;if(i.width!==e||i.height!==r){if(this._wasImmutablyAllocated)throw new x("texture:immutable-resize","Immutable textures can't be resized!");i.width=e,i.height=r,this._descriptor.target===34067?this._setDataCubeMap(null):this.setData(null)}}enableCompression(e){this._descriptor.compress=e}disableCompression(){this._descriptor.compress=void 0}setData(e){this.abortCompression(),!Vc(e)&&this._descriptor.internalFormat&&mw(_r,this._descriptor.internalFormat)&&(this._descriptor.internalFormat=void 0),this._setData(e),!Vc(e)&&this._descriptor.compress&&this._compressOnWorker(e)}updateData(e,r,i,s,n,o,l=0){o||Hn().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||Hn().error("An attempt to update uninitialized texture!");const u=this._descriptor;u.internalFormat=hg(u);const{context:d,pixelFormat:p,dataType:f,target:m,isImmutable:y}=u;if(y&&!this._wasImmutablyAllocated)throw new x("texture:uninitialized","Cannot update immutable texture before allocation!");const g=d.bindTexture(this,Ct.TEXTURE_UNIT_FOR_UPDATES,!0);(r<0||i<0||r+s>u.width||i+n>u.height)&&Hn().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:v}=d;l&&(s&&n||Hn().warn("Must pass width and height if `UNPACK_SKIP_ROWS` is used"),v.pixelStorei(v.UNPACK_SKIP_ROWS,l)),vC(o)?v.texSubImage2D(m,e,r,i,s,n,p,f,o):Vc(o)?v.compressedTexSubImage2D(m,e,r,i,s,n,u.internalFormat,o.levels[e]):v.texSubImage2D(m,e,r,i,s,n,p,f,o),l&&v.pixelStorei(v.UNPACK_SKIP_ROWS,0),d.bindTexture(g,Ct.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,r,i,s,n,o,l,u){u||Hn().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||Hn().error("An attempt to update an uninitialized texture!");const d=this._descriptor;d.internalFormat=hg(d);const{context:p,pixelFormat:f,dataType:m,isImmutable:y,target:g}=d;if(y&&!this._wasImmutablyAllocated)throw new x("texture:uninitialized","Cannot update immutable texture before allocation!");cc(g)||Hn().warn("Attempting to set 3D texture data on a non-3D texture");const v=p.bindTexture(this,Ct.TEXTURE_UNIT_FOR_UPDATES);p.setActiveTexture(Ct.TEXTURE_UNIT_FOR_UPDATES),(r<0||i<0||s<0||r+n>d.width||i+o>d.height||s+l>d.depth)&&Hn().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:_}=p;if(Vc(u))u=u.levels[e],_.compressedTexSubImage3D(g,e,r,i,s,n,o,l,d.internalFormat,u);else{const S=u;_.texSubImage3D(g,e,r,i,s,n,o,l,f,m,S)}p.bindTexture(v,Ct.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(e.width===0||e.height===0)return;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new x("texture:immutable-change","Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,Fp(e)}e.samplingMode===9729?(this._samplingModeDirty=!0,e.samplingMode=9985):e.samplingMode===9728&&(this._samplingModeDirty=!0,e.samplingMode=9984);const r=this._descriptor.context.bindTexture(this,Ct.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(Ct.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(r,Ct.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new x("texture:immutable-change","Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,Fp(e)}e.samplingMode===9985?(this._samplingModeDirty=!0,e.samplingMode=9729):e.samplingMode===9984&&(this._samplingModeDirty=!0,e.samplingMode=9728)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,Fp(this._descriptor),this._wrapModeDirty=!0)}setShadowFiltering(e){e!==this._descriptor.linearFilterDepth&&(this._descriptor.linearFilterDepth=this._descriptor.compareEnabled=e,this.setSamplingMode(e?9729:9728),Fp(this._descriptor),this._shadowFilterDirty=!0)}applyChanges(){this._samplingModeDirty&&(this._applySamplingMode(),this._samplingModeDirty=!1),this._wrapModeDirty&&(this._applyWrapMode(),this._wrapModeDirty=!1),this._shadowFilterDirty&&(this._applyShadowMode(),this._shadowFilterDirty=!1)}abortCompression(){this._compressionAbortController=jo(this._compressionAbortController)}_setData(e,r){const i=this._descriptor,s=i.context?.gl;if(!s)return;wl(s),this.hasWebGLTextureObject||(this._glName=s.createTexture(),i.context.instanceCounter.increment(gC.Texture,this)),Fp(i);const n=i.context.bindTexture(this,Ct.TEXTURE_UNIT_FOR_UPDATES);i.context.setActiveTexture(Ct.TEXTURE_UNIT_FOR_UPDATES),this._configurePixelStorage(),wl(s);const o=r??i.target,l=cc(o);if(vC(e))this._setDataFromTexImageSource(e,o);else{const{width:u,height:d,depth:p}=i;if(u==null||d==null)throw new x("texture:missing-size","Width and height must be specified!");if(l&&p==null)throw new x("texture:missing-depth","Depth must be specified!");if(i.internalFormat=hg(i),i.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(o,i.internalFormat,i.hasMipmap,u,d,p),Vc(e)){if(!wue(i.internalFormat))throw new x("texture:format-mismatch","Attempting to use compressed data with an uncompressed format!");this._setDataFromCompressedSource(e,i.internalFormat,o)}else this._texImage(o,0,i.internalFormat,u,d,p,e),wl(s),i.hasMipmap&&this.generateMipmap()}this._applySamplingMode(),this._applyWrapMode(),this._applyAnisotropicFilteringParameters(),this._applyShadowMode(),wl(s),i.context.bindTexture(n,Ct.TEXTURE_UNIT_FOR_UPDATES)}_setDataCubeMap(e=null){for(let r=34069;r<=34074;r++)this._setData(e,r)}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:r,flipped:i,preMultiplyAlpha:s}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s?1:0)}_setDataFromTexImageSource(e,r){const{gl:i}=this._descriptor.context,s=this._descriptor;s.internalFormat=hg(s);const n=cc(r),{width:o,height:l,depth:u}=_ue(e);s.width&&s.height,s.width||(s.width=o),s.height||(s.height=l),n&&s.depth,n&&(s.depth=u),s.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(r,s.internalFormat,s.hasMipmap,o,l,u),this._texImage(r,0,s.internalFormat,o,l,u,e),wl(i),s.hasMipmap&&(this.generateMipmap(),wl(i))}_setDataFromCompressedSource(e,r,i){const s=this._descriptor,{width:n,height:o,depth:l}=s,u=e.levels,d=wC(i,n,o,l),p=Math.min(d,u.length)-1;this._descriptor.context.gl.texParameteri(s.target,33085,p),this._forEachMipmapLevel((f,m,y,g)=>{const v=u[Math.min(f,u.length-1)];this._compressedTexImage(i,f,r,m,y,g,v)},p)}_texStorage(e,r,i,s,n,o){const{gl:l}=this._descriptor.context;if(!vue(r)&&!q6(r)&&!G6(r))throw new x("texture:missing-format","Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const u=i?wC(e,s,n,o):1;if(cc(e)){if(o==null)throw new x("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texStorage3D(e,u,r,s,n,o)}else l.texStorage2D(e,u,r,s,n);this._wasImmutablyAllocated=!0}_texImage(e,r,i,s,n,o,l){const u=this._descriptor.context.gl,d=cc(e),{isImmutable:p,pixelFormat:f,dataType:m}=this._descriptor;if(p){if(l!=null){const y=l;if(d){if(o==null)throw new x("texture:missing-depth","Missing depth dimension for 3D texture upload");u.texSubImage3D(e,r,0,0,0,s,n,o,f,m,y)}else u.texSubImage2D(e,r,0,0,s,n,f,m,y)}}else{const y=l;if(d){if(o==null)throw new x("texture:missing-depth","Missing depth dimension for 3D texture upload");u.texImage3D(e,r,i,s,n,o,0,f,m,y)}else u.texImage2D(e,r,i,s,n,0,f,m,y)}}_compressedTexImage(e,r,i,s,n,o,l){const u=this._descriptor.context.gl,d=cc(e);if(this._descriptor.isImmutable){if(l!=null)if(d){if(o==null)throw new x("texture:missing-depth","Missing depth dimension for 3D texture upload");u.compressedTexSubImage3D(e,r,0,0,0,s,n,o,i,l)}else u.compressedTexSubImage2D(e,r,0,0,s,n,i,l)}else if(d){if(o==null)throw new x("texture:missing-depth","Missing depth dimension for 3D texture upload");u.compressedTexImage3D(e,r,i,s,n,o,0,l)}else u.compressedTexImage2D(e,r,i,s,n,0,l)}async _compressOnWorker(e){const{width:r,height:i,context:s,flipped:n,preMultiplyAlpha:o,hasMipmap:l}=this._descriptor,u=this._descriptor.compress?.compressionTracker,d=this._descriptor.compress?.compressionCallback,{compressedTextureETC:p,compressedTextureS3TC:f}=s.capabilities;if(!Ct.compressionWorkerHandle?.isCompressible(e,this._descriptor)||!p&&!f)return;this.abortCompression();const m=new AbortController;let y;this._compressionAbortController=m,u?.increment();try{e instanceof Uint8Array?y=e.buffer:(y=await createImageBitmap(e,{imageOrientation:n?"flipY":"none"}),We(m));const g={data:y,width:r,height:i,needsFlip:e instanceof Uint8Array&&this.descriptor.flipped,components:this._descriptor.pixelFormat===6408?4:3,preMultiplyAlpha:o,hasMipmap:l,hasETC:!!p,hasS3TC:!!f},v=await Ct.compressionWorkerHandle.invoke(g,m.signal,"low");if(We(m),v.compressedTexture&&this.hasWebGLTextureObject){const _=this.usedMemory;this._descriptor.internalFormat=v.internalFormat,this._setData(v.compressedTexture),d?.(_-this.usedMemory)}}catch(g){nr(g)||Hn().error("Texture compression failed!")}finally{u?.decrement(),this._compressionAbortController?.signal.aborted&&(this._compressionAbortController=null),y instanceof ImageBitmap&&y.close()}}_forEachMipmapLevel(e,r=1/0){let{width:i,height:s,depth:n,hasMipmap:o,target:l}=this._descriptor;const u=l===32879;if(i==null||s==null||u&&n==null)throw new x("texture:missing-size","Missing texture dimensions for mipmap calculation");for(let d=0;e(d,i,s,n),o&&(i!==1||s!==1||u&&n!==1)&&!(d>=r);++d)i=Math.max(1,i>>1),s=Math.max(1,s>>1),u&&(n=Math.max(1,n>>1))}_applySamplingMode(){const e=this._descriptor,r=e.context?.gl;let i=e.samplingMode,s=e.samplingMode;i===9985||i===9987?(i=9729,e.hasMipmap||(s=9729)):i!==9984&&i!==9986||(i=9728,e.hasMipmap||(s=9728)),r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,i),r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,s)}_applyWrapMode(){const e=this._descriptor,r=e.context?.gl;typeof e.wrapMode=="number"?(r.texParameteri(e.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,e.wrapMode)):(r.texParameteri(e.target,r.TEXTURE_WRAP_S,e.wrapMode.s),r.texParameteri(e.target,r.TEXTURE_WRAP_T,e.wrapMode.t))}_applyShadowMode(){const e=this._descriptor,r=e.context?.gl,i=e.compareEnabled?r.COMPARE_REF_TO_TEXTURE:r.NONE;r.texParameteri(e.target,r.TEXTURE_COMPARE_MODE,i),e.compareEnabled&&r.texParameteri(e.target,r.TEXTURE_COMPARE_FUNC,r.GREATER),wl(r)}_applyAnisotropicFilteringParameters(){const e=this._descriptor,r=e.context.capabilities.textureFilterAnisotropic;r&&e.context.gl.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}},Ct.TEXTURE_UNIT_FOR_UPDATES=0,Ct.compressionWorkerHandle=null,Ct);const Db=()=>L.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function Tue(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const Mue=[0,0,0,0];let H6=class{constructor(){this.type="single",this._highlightOptions=new qa,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*Rp),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,r){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,uue),r.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<D6)-1,activeGradient:this}]}_updateGradientTexture(e){const r=Iue(this._highlightOptions);if(r===this._optionsShadeTexKey)return;this._optionsShadeTexKey=r,Tue(this._highlightOptions,this._convertedHighlightOptions);const i=this._convertedHighlightOptions,s=i.outlinePosition-i.outlineWidth/2-i.outerHaloWidth,n=i.outlinePosition-i.outlineWidth/2,o=i.outlinePosition+i.outlineWidth/2,l=i.outlinePosition+i.outlineWidth/2+i.innerHaloWidth,u=Math.sqrt(Math.PI/2)*pue,d=Math.abs(s)>u?Math.round(10*(Math.abs(s)-u))/10:0,p=Math.abs(l)>u?Math.round(10*(Math.abs(l)-u))/10:0;let f;d&&!p?Db().error("The outer rim of the highlight is "+d+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!d&&p?Db().error("The inner rim of the highlight is "+p+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):d&&p&&Db().error("The highlight is "+Math.max(d,p)+"px away from the edge of the feature; consider reducing some width values.");const m=[void 0,void 0,void 0,void 0];function y(v,_,S){m[0]=(1-S)*v[0]+S*_[0],m[1]=(1-S)*v[1]+S*_[1],m[2]=(1-S)*v[2]+S*_[2],m[3]=(1-S)*v[3]+S*_[3]}const{_texelData:g}=this;for(let v=0;v<Rp;++v)f=s+v/(Rp-1)*(l-s),f<s?(m[0]=0,m[1]=0,m[2]=0,m[3]=0):f<n?y(Mue,i.outlineColor,(f-s)/(n-s)):f<o?[m[0],m[1],m[2],m[3]]=i.outlineColor:f<l?y(i.outlineColor,i.fillColor,(f-o)/(l-o)):[m[0],m[1],m[2],m[3]]=i.fillColor,g[4*v]=255*m[0],g[4*v+1]=255*m[1],g[4*v+2]=255*m[2],g[4*v+3]=255*m[3];if(this._minMaxDistance[0]=s,this._minMaxDistance[1]=l,!this._shadeTex){const v=new U6(Rp,1);v.wrapMode=33071,this._shadeTex=new xue(e,v)}this._shadeTex.updateData(0,0,0,Rp,1,this._texelData)}};function Iue(t){return`${t.color};${t.haloColor};${t.haloOpacity};${t.fillOpacity};${t.haloWidth};${t.haloBlur}`}let Eue=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let r=0;r<e.length;r++)this.gradients[r]||(this.gradients[r]=new H6),this.gradients[r].setHighlightOptions(e[r]);for(let r=e.length+1;r<this.gradients.length;r++)this.gradients[r].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const r=[];for(let i=0;i<this.gradients.length;i++){const s=this.gradients[i];r.push({activeReasons:e,activeGradient:s}),e<<=1}return r}};const W6={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{compare:514,mask:255,op:{fail:7680,zFail:7680,zPass:7681}}}},Oue={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},kue={...W6,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function Cue({pixelRatio:t,state:e,displayLevel:r,requiredLevel:i},s){const n=1/2**(r-s.key.level),o=1/2**(i-s.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:s.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:s.transforms.tileMat3,displayZoomFactor:n,requiredZoomFactor:o,tileOffset:[s.x,s.y],currentScale:e.scale,currentZoom:r,metersPerSRUnit:Hi(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function Z6(t){return t.passOptions?.type==="highlight"}function J6(t){return t.passOptions?.type==="hittest"}function Pue(t){if(!J6(t))return null;const{position:e,distance:r,smallSymbolDistance:i,smallSymbolSizeThreshold:s}=t.passOptions;return{position:e,distance:r,smallSymbolDistance:i,smallSymbolSizeThreshold:s}}function Aue(t){if(!Z6(t))return null;const{activeReasons:e,highlightAll:r}=t.passOptions;return{activeReasons:e,highlightAll:r?1:0}}function YMe(t,e,r){const i={};for(const s in r)typeof r[s]!="function"?i[s]=r[s]:i[s]=r[s](t,e);return i}function KMe(t,e){const{attributeView:r,context:i}=t;return{storage:r.getUniforms(i),view:Cue(t,e),hittestRequest:Pue(t),highlight:Aue(t)}}function QMe(t){return{inside:t.selection===2,outside:t.selection===3}}function Rue(t){return J6(t)?Oue:Z6(t)&&t.passOptions.stepType==="clear"?kue:W6}function XMe(t){const{row:e,col:r}=t.key,i=r*yC,s=e*yC;return{tileOffsetFromLocalOrigin:[i%dg,s%dg],maxIntsToLocalOrigin:[Math.floor(i/dg),Math.floor(s/dg)]}}const Lue=new $e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function e3e(t){return Lue.toJSON(t)}function t3e(t){const{bandCount:e,attributeTable:r,colormap:i,pixelType:s}=t.raster.rasterInfo;return e===1&&(r!=null||i!=null||s==="u8"||s==="s8")}function Fue(t,e){return e==null?(t?.destroy(),null):(t?.type==="single"&&Array.isArray(e)&&(t.destroy(),t=null),t?.type!=="multi"||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new Eue:new H6),Array.isArray(e)?t.type==="multi"&&t.setHighlightOptions(e):t.type==="single"&&t.setHighlightOptions(e),t)}function r3e(t,e,r,i){const{painter:s,highlightGradient:n}=t,{highlight:o}=s.effects;if(!n)return;const l=t.passOptions,u=n.getReasonsWithGradients();for(let d=0;d<u.length;d++){const p={...t,passOptions:{type:"highlight",activeGradient:u[d].activeGradient,activeReasons:u[d].activeReasons,stepType:"burn",highlightAll:e}};if(o.bind(p),r(p),d<u.length-1){let m=0;for(let y=d+1;y<u.length;y++)m|=u[y].activeReasons;r({...t,passOptions:{type:"highlight",activeGradient:u[d].activeGradient,activeReasons:m,stepType:"clear",highlightAll:e}})}const f={...t,passOptions:{type:"highlight",activeGradient:u[d].activeGradient,activeReasons:u[d].activeReasons,stepType:"draw",highlightAll:e}};s.setPipelineState(Rue(t)),s.updatePipelineState(t.context),o.draw(f),o.unbind()}t.passOptions=l}const pg=t=>parseFloat(t)/100;function Nue(t,e,r){const i=typeof t.left=="string"?pg(t.left)*e:t.left,s=typeof t.right=="string"?pg(t.right)*e:t.right,n=typeof t.top=="string"?pg(t.top)*r:t.top,o=typeof t.bottom=="string"?pg(t.bottom)*r:t.bottom,l=n;return{xmin:i,xmax:Math.max(e-s,i),ymin:l,ymax:Math.max(r-o,n)}}function Y6(t,e,r,i){switch(e.type){case"rect":{const{width:s,height:n}=t,{xmin:o,xmax:l,ymin:u,ymax:d}=Nue(e,s,n),{x:p,y:f}=r;return p>o&&p<l&&f>u&&f<d}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||qT(e.path,[r.x,r.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?UT(e.geometry,i):sy(e.geometry,i))}}function Due(t){if(!t.highlights)return null;const e=t.highlights.findIndex(r=>r.name==="default");return e===-1?null:t.highlights.items[e]}function jue(t,e){if(!t.highlights){if(!e)return;t.highlights=new H([new qa])}const r=t.highlights.findIndex(i=>i.name==="default");e?t.highlights.items[r].assignFrom(e):(t.highlights.removeAt(r),t.highlights.length===0&&(t.highlights=null))}async function Vue(t,e,r){const i=kj(e)?Oj(t,e):e;if(!t.ready||isNaN(i.x)||isNaN(i.y))return{screenPoint:i,results:[]};let s=new Set;const n=new Set;let o=!1,l=null,u=null;r?.include?_C(r.include,bC(t,m=>{s.add(m),jb(m,y=>n.add(y))},(m,y)=>{n.add(m),s.add(y)},m=>{l||(l=new Set),l.add(m)},m=>s.add(m),()=>o=!0)):(o=!0,s=new Set(t.allLayerViews),s.forEach(m=>{jb(m,y=>n.add(y))})),r?.exclude&&_C(r.exclude,bC(t,m=>{s.delete(m),jb(m,y=>n.delete(y))},m=>n.delete(m),m=>{u||(u=new Set),u.add(m)}));const d=t.toMap(i),p=t.allLayerViews.filter(m=>!m.suspended&&s.has(m)&&m.clips.every(y=>Y6(t,y,i,d))).reverse();let f=[...o?t.graphicsView.hitTest(d).map(m=>({type:"graphic",graphic:m,layer:null,mapPoint:d})):[],...await Promise.all(p.map(m=>m.hitTest(d,i)).toArray())].filter(ps).flat().filter(ps);return f=f.filter(m=>m.type!=="graphic"||m.layer?.type!=="subtype-group"||n.has(m.graphic.layer)),l&&(f=f.filter(m=>!("graphic"in m)||!m.graphic||l?.has(O$(m.graphic)))),u&&(f=f.filter(m=>!("graphic"in m)||!m.graphic||!u?.has(O$(m.graphic)))),{screenPoint:i,results:f}}function bC(t,e,r,i,s,n){return o=>{if(o instanceof nt){if(o.layer===t)n?.();else{const l=t.allLayerViews.find(u=>u.layer===o.layer);l&&s?.(l)}i(O$(o))}else if(!("layer"in o&&"element"in o))if(o.type==="subtype-sublayer"){const l=t.allLayerViews.find(u=>u.layer===o.parent);l&&r(o,l)}else{const l=t.allLayerViews.find(u=>u.layer===o);l&&e(l)}}}function _C(t,e){if(t)if(nv(t))for(const r of t)if(nv(r))for(const i of r)e(i);else e(r);else e(t)}function O$(t){const e=t.getObjectId();return e?`${t.layer?.uid??t.sourceLayer?.uid??"MapView"}/${e}`:`"MapView/${t.uid}`}function jb(t,e){const r=t.layer;r?.type==="subtype-group"&&r.sublayers.forEach(i=>{e(i)})}let Np=null,tw=!0;function zue(t,e,r){if(!t||!e)throw new Error("Cannot construct image data without dimensions");if(tw)try{return new ImageData(t,e)}catch{tw=!1}return K6(t,e,r)}function i3e(t,e,r,i){if(!e||!r)throw new Error("Cannot construct image data without dimensions");if(tw)try{return new ImageData(t,e,r)}catch{tw=!1}const s=K6(e,r,i);return s.data.set(t,0),s}function Uue(){return Np||(Np=document.createElement("canvas"),Np.width=1,Np.height=1),Np}function K6(t,e,r){return r||(r=Uue()),r.getContext("2d").createImageData(t,e)}async function que(t,e){const r=window.URL.createObjectURL(t);try{const{data:i}=await Ae(r,{...e,responseType:"image"});return i}catch(i){throw nr(i)?i:new x("invalid-image",`Could not fetch requested image at ${r}`)}finally{window.URL.revokeObjectURL(r)}}async function s3e(t,e){const{arrayBuffer:r,mediaType:i}=await Gue(t,e),s=i==="image/png";if(i==="image/gif"){const{isAnimatedGIF:n,parseGif:o}=await N(()=>import("./gif-Dw7i4GP6.js"),[]);if(n(r))return o(r,e)}if(s){const{isAnimatedPNG:n,parseApng:o}=await N(()=>import("./apng-DsRXW_zY.js"),__vite__mapDeps([297,28]));if(n(r))return o(r,e)}return que(new Blob([r],{type:i}),e)}async function Gue(t,e){const r=gh(t);if(r?.isBase64)return{arrayBuffer:aR(r.data),mediaType:r.mediaType};const i=await Ae(t,{responseType:"array-buffer",...e});return{arrayBuffer:i.data,mediaType:i.getHeader?.("Content-Type")??""}}function Q6(t,e,r){const{ctx:i,canvas:s}=e8(t,r),n=i.getImageData(0,0,t.width,t.height),o=r8(s,e);return t8(s),{dataUrl:o,data:n}}function X6(t,e){const{ctx:r,canvas:i}=e8(t,e),s=r.getImageData(0,0,t.width,t.height);return t8(i),s}function e8(t,e){const r=Bue();e.premultipliedAlpha&&Jue(t),r.width=t.width,r.height=t.height;const i=r.getContext("2d",{willReadFrequently:!0});return i.putImageData(t,0,0),e.flipY&&Zue(i),{ctx:i,canvas:r}}function t8(t){t.width=0,t.height=0}function Bue(){return Vb==null&&(Vb=document.createElement("canvas")),Vb}let Vb=null;function r8(t,e){const r=Yue[e.format],i=e.quality/100;return t.toDataURL(r,i)}function i8(t,e){const r=Wue(t),i=Que[r];return{format:r,quality:Bi(e??i,0,100)}}function s8(t,e){return e/Math.max(t[0],t[1])}function Hue(t,e,r,i=0,s=0,n=t.width-i,o=t.height-s,l=!1){const{data:u}=t,{width:d,height:p,data:f}=e,m=n/d,y=o/p,g=Math.ceil(m/2),v=Math.ceil(y/2),_=t.width;for(let S=0;S<p;S++)for(let M=0;M<d;M++){const C=4*(M+(l?p-S-1:S)*d);let T=0,O=0,P=0,D=0,z=0,B=0;const G=(S+.5)*y;for(let Q=Math.floor(S*y);Q<(S+1)*y;Q++){const oe=Math.abs(G-(Q+.5))/v,Pe=(M+.5)*m,fe=oe*oe;for(let Nt=Math.floor(M*m);Nt<(M+1)*m;Nt++){const Si=Math.abs(Pe-(Nt+.5))/g,or=Math.sqrt(fe+Si*Si);if(or>=1)continue;let Ne=2*or*or*or-3*or*or+1;const bs=4*(i+Nt+(s+Q)*_);B+=Ne*u[bs+3],O+=Ne,!r&&u[bs+3]<255&&(Ne=Ne*u[bs+3]/255),P+=Ne*u[bs],D+=Ne*u[bs+1],z+=Ne*u[bs+2],T+=Ne}}f[C]=P/T,f[C+1]=D/T,f[C+2]=z/T,f[C+3]=B/O}return e}function Wue(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return Kue}}function Zue(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function Jue(t){const e=t.data,r=e.length;for(let i=0;i<r;i+=4){const s=e[i+3];if(s!==255&&s>0){const n=255/s;e[i]=e[i]*n,e[i+1]=e[i+1]*n,e[i+2]=e[i+2]*n}}}const Yue={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},SC=98,Kue="png",Que={png:100,jpg:SC,jpeg:SC},n3e=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:zue,encode:Q6,encodeData:X6,getFormatAndQuality:i8,getMaximumResolutionScale:s8,resampleHermite:Hue,toDataUrl:r8},Symbol.toStringTag,{value:"Module"})),n8={flipY:!0,premultipliedAlpha:!0};async function Xue(t,e){const r=await o8(t,e),{format:i,quality:s}=i8(e?.format,e?.quality);return Q6(r,{format:i,quality:s},n8)}async function ece(t,e){const r=await o8(t,e);return X6(r,n8)}function o8(t,e){const r=ice(e||{},rce(t.stage,t.size),t.size,t.padding),i=tce(e,t.allLayerViews);return t.stage.takeScreenshot(r,i,t.backgroundColor,e?.rotation)}function tce(t={},e){if(!t.layers)return;const r=[];return t.layers.forEach(i=>{const s=e.find(n=>n.layer.id===i.id);s?.container&&r.push(s.container)}),r}function rce(t,e){return Math.min(4,s8(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function ice(t,e,r,i){t.ignorePadding&&(i={left:0,right:0,top:0,bottom:0});let s=null;t.width!=null&&t.height!=null?s=[t.width,t.height]:t.width==null&&t.height!=null?s=[t.height,t.height]:t.width!=null&&t.height==null?s=[t.width,t.width]:t.width==null&&t.height==null&&(s=null);const n=r[0]-(i.left+i.right),o=r[1]-(i.top+i.bottom);let l,u,d=t.area||{x:0,y:0,width:n,height:o};if(s){const p=n/o,f=s[0]/s[1];if(f>p){const m=d.width/f;d={x:d.x,y:Math.round(d.y+(d.height-m)/2),width:d.width,height:Math.round(m)}}else{const m=d.height*f;d={x:Math.round(d.x+(d.width-m)/2),y:d.y,width:Math.round(m),height:d.height}}}else s=[d.width,d.height];return s[0]>d.width?(l=Math.min(s[0]/d.width,e),u=s[0]/d.width/l):(l=1,u=s[0]/d.width),{cropArea:{x:Math.round((d.x+i.left)*l),y:Math.round((d.y+i.top)*l),width:Math.round(d.width*l),height:Math.round(d.height*l)},outputScale:u,resolutionScale:l}}const sce=t=>t.includes("Brush");let a8=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),sce(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};const $C=Symbol("analyses-owner-handles");let pa=class extends X{constructor(e){super(e),this._allAnalysisViews=new H,this._creatingViewCount=0,this._attachedToViewResolver=xC(),this._items=new Map,this._moduleMap=new Map,this._scheduledUpdateHandle=null,this._emitOnView=(r,i)=>this.view.emit(r,i)}destroy(){this._disconnectOwners(),this._attachedToViewResolver.reject(Fe("AnalysisViewManager was destroyed")),this._set("view",null)}attach(){this._connectOwners(),this._attachedToViewResolver.resolve()}detach(){this._disconnectOwners(),this._attachedToViewResolver.reject(Fe()),this._attachedToViewResolver=xC()}get updating(){return!this.view.ready||this._creatingViewCount!==0||this._allAnalysisViews.some(e=>e.updating)}get testInfo(){}async whenAnalysisView(e){await this._attachedToViewResolver.promise;const r=this._items.get(e);if(r==null||r.state.list===1)throw new x("AnalysisViewManager:no-analysis-view-for-analysis","The analysis does not exist in view.analyses",{analysis:e});return r.createAnalysisViewTask.promise}_connectOwners(){this.addHandles(this._connectAnalysesCollection(this.view.analyses),$C)}_disconnectOwners(){this.removeHandles($C),this._update(),this._creatingViewCount=0}_connectAnalysesCollection(e){for(const s of e)this._addAnalysis(s);const r=e.on("after-add",s=>this._addAnalysis(s.item)),i=e.on("after-remove",s=>this._removeAnalysis(s.item));return Te(()=>{r.remove(),i.remove();for(const s of e)this._removeAnalysis(s)})}_addAnalysis(e){const r=this._items.get(e);if(r==null){const i={state:{view:0,list:0},analysis:e,view:null,createAnalysisViewTask:null};this._items.set(e,i),i.createAnalysisViewTask=iy(s=>this._createAnalysisViewPromise(i,s).then(n=>(this._emitOnView("analysis-view-create",{analysis:e,analysisView:n}),n),n=>{throw this._emitOnView("analysis-view-create-error",{analysis:e,error:n}),n}))}else r.state.list=0}_removeAnalysis(e){const r=this._items.get(e);r!=null?(r.state.list=1,this._scheduleUpdate()):L.getLogger(this).error("Trying to remove analysis which was not added")}_scheduleUpdate(){this._scheduledUpdateHandle==null&&(this._scheduledUpdateHandle=Wh(()=>this._update()))}_update(){this._scheduledUpdateHandle=He(this._scheduledUpdateHandle),this._items.forEach(e=>{if(e.state.list!==1)return;const{analysis:r,view:i}=e;switch(this._items.delete(r),e.state.view){case 0:e.createAnalysisViewTask=jo(e.createAnalysisViewTask);break;case 1:i!=null&&(this._allAnalysisViews.remove(i),e.view=Ke(i),e.createAnalysisViewTask=null,this._emitOnView("analysis-view-destroy",{analysis:r,analysisView:i}))}})}async _createAnalysisViewPromise(e,r){const{analysis:i}=e;if(this._creatingViewCount+=1,!this._moduleMap.has(i.type))try{this._moduleMap.set(i.type,await this.importAnalysisViewModule(i))}catch{throw this._creatingViewCount-=1,new x("AnalysisViewManager:no-analysis-view-for-analysis",`Analysis of type "${i.type}" is not supported`)}if(Pr(r))throw this._creatingViewCount-=1,Fe("AnalysisView creation aborted");const s=new(this._moduleMap.get(i.type)).default({analysis:i,view:this.view});let n=!0;ys(r,()=>{n&&this._destroyAnalysisView(i,s)});try{await s.when()}catch(o){throw n=!1,this._destroyAnalysisView(i,s),o}if(Pr(r))throw Fe();return n=!1,e.view=s,e.state.view=1,this._allAnalysisViews.add(s),this._creatingViewCount-=1,s}_destroyAnalysisView(e,r){r.destroyed||(this._creatingViewCount-=1,r.destroy(),this._emitOnView("analysis-view-destroy",{analysis:e,analysisView:r}))}};a([c()],pa.prototype,"updating",null),a([c({constructOnly:!0})],pa.prototype,"importAnalysisViewModule",void 0),a([c({constructOnly:!0})],pa.prototype,"view",void 0),a([c()],pa.prototype,"_allAnalysisViews",void 0),a([c()],pa.prototype,"_creatingViewCount",void 0),pa=a([b("esri.views.support.AnalysisViewManager")],pa);const nce=pa;function xC(){const t=bi();return t.promise.catch(()=>{}),t}let oce=class{constructor(e){this.getUnmaskedRenderer=e}};function ace(t){const e=t.getExtension("WEBGL_debug_renderer_info");return e?new oce(()=>t.getParameter(e.UNMASKED_RENDERER_WEBGL)):null}let TC;function lce(){return TC??=dce(),TC}let uce=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}};function cce(t){if(typeof WebGL2RenderingContext>"u")return null;const e=document.createElement("canvas");if(!e)return null;let r=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(r==null&&(r=e.getContext("webgl2"),r!=null&&(t.majorPerformanceCaveat=!0,t.unmaskedRenderer=ace(r)?.getUnmaskedRenderer()??"unknown")),r==null)return r;t.available=!0,t.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const i=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);return i&&(t.supportsHighPrecisionFragment=i.precision>0),r}function dce(){const t=new uce,e=cce(t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null),t}function hce(t){const e=lce();return e.available?t==="3d"&&e.majorPerformanceCaveat?new x("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new x("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new x("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new x("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function pce(t){return t&&"nodeType"in t}function fce(t){return t&&typeof t.render=="function"}const MC={component:"esri-component"};let Vl=class extends X{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(e){this._set("id",e)}set node(e){const r=this._get("node");e!==r&&(e&&e.classList.add(MC.component),r&&r.classList.remove(MC.component),this._set("node",e))}castNode(e){return this.widget?.destroy(),e?typeof e=="string"||pce(e)?(this._set("widget",null),TM(e)):(fce(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};a([c()],Vl.prototype,"id",null),a([c()],Vl.prototype,"node",null),a([Ce("node")],Vl.prototype,"castNode",null),a([c({readOnly:!0})],Vl.prototype,"widget",void 0),Vl=a([b("esri.views.ui.Component")],Vl);const O0=Vl,mce=(t,e)=>{let r=t;for(;r;){if(r===e)return!0;if(!r.parentNode)return!1;r.parentNode instanceof ShadowRoot?r=r.parentNode.host:r=r.parentNode}return!1},d3e=(t,e,r)=>{const i=yce(e).subscribe;return i(s=>{s.some(o=>mce(t,o.target))&&r()})},zb={},yce=t=>{const e=t.join(","),r=zb[e];if(r!==void 0)return r;const i=new Set,s=new MutationObserver(o=>i.forEach(l=>l(o)));globalThis.document&&s.observe(document.documentElement,{attributes:!0,attributeFilter:t,subtree:!0});const n={subscribe:o=>(i.add(o),()=>{i.delete(o),i.size===0&&(s.disconnect(),zb[e]=void 0)})};return zb[e]=n,n},l8=(t,e)=>{let r=t;for(;r;){const i=r.closest?.(e);if(i)return i;const s=r.getRootNode?.();if(s===globalThis.document)return;r=s.host}};function gce(t){const e=l8(t,".calcite-mode-dark, .calcite-mode-light, .calcite-mode-auto");return e?.classList.contains("calcite-mode-dark")||e?.classList.contains("calcite-mode-auto")&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}const h3e=(t,e,r)=>l8(t,`[${e}]`)?.getAttribute(e)??r,vce="--esri-calcite-mode-name";function wce(){const t=getComputedStyle(document.body).getPropertyValue(vce).replaceAll(/\W/g,"").toLowerCase();return t==="dark"||t==="light"?t:void 0}const u8="calcite-mode-";function c8(t){return wce()??gce(t??document.body)}function p3e(t){return c8(t)==="dark"}function bce(t){return`${u8}${c8(t)}`}function _ce(t){const e=bce(t);Sce(t),t.classList.add(e)}function Sce(t){Array.from(t.classList).forEach(e=>{e.startsWith(u8)&&t.classList.remove(e)})}const u1=new Map;function d8(){u1.clear()}function $ce(t){return u1.get(t)}function xce(t,e){u1.set(t,e)}function Ub(t){u1.delete(t)}function Tce(...t){const e=Br.acquire();for(let i=0;i<t.length;i++){const s=t[i],n=typeof s;if(n==="string")e.push(s);else if(Array.isArray(s))e.push.apply(e,s);else if(n==="object")for(const o in s)s[o]&&e.push(o)}const r=e.join(" ");return Br.release(e),r}(()=>{const t=new Map,e=new ResizeObserver(i=>{d8();for(const s of i)t.get(s.target)?.(s)}),r=(i,s,n)=>(t.set(i,s),e.observe(i,n),Te(()=>{e.unobserve(i),t.delete(i)}));return(i,s,n)=>{let o=null;return qu([ne(()=>typeof i=="function"?i():i,l=>{o?.remove(),l&&(o=r(l,s,n))},Tr),Te(()=>o?.remove())])}})();function Mce(t){const e=t?.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function f3e(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function m3e(t){const e="data-node-ref";this[t.getAttribute(e)]=t}function Ice(t){return t==="Enter"||t===" "}async function Ece(t,e){await sL(Km(e));const r=typeof t=="function"?t():t;r&&("setFocus"in r&&typeof r.setFocus=="function"?await r.setFocus():r instanceof HTMLElement&&r.focus())}const Oce={left:0,top:0,bottom:0,right:0},h8={bottom:30,top:15,right:15,left:15},Wn="esri-ui",ei={ui:Wn,corner:`${Wn}-corner`,innerContainer:`${Wn}-inner-container`,manualContainer:`${Wn}-manual-container`,cornerContainer:`${Wn}-corner-container`,topLeft:`${Wn}-top-left`,topRight:`${Wn}-top-right`,bottomLeft:`${Wn}-bottom-left`,bottomRight:`${Wn}-bottom-right`};function kce(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function fg(t){return t===0?"0":`${t}px`}function qb(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function Gb(t,{top:e,bottom:r,left:i,right:s}){t.style.top=e,t.style.bottom=r,t.style.left=i,t.style.right=s}let mn=class extends Yh{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=vi(),this.view=null,this._applyViewPadding=()=>{const r=this.container;r&&Gb(r,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const r=this._innerContainer;r&&Gb(r,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([ne(()=>[this.view?.padding,this.container],this._applyViewPadding,Ot),ne(()=>this.padding,this._applyUIPadding,Ot),ne(()=>[this.container,this._locale],([e,r])=>{e&&e.setAttribute("lang",r)},Ot),hF(e=>{this._locale=e})])}destroy(){this.removeAllHandles(),this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear(),this.view=null,this._set("view",null)}set container(e){const r=this._get("container");e!==r&&(e&&(e.classList.add(ei.ui),_ce(e),this._attachContainers(e)),r&&(r.classList.remove(ei.ui),Gb(r,{top:"",bottom:"",left:"",right:""}),r.textContent=""),this._set("container",e))}get height(){const e=this.view?.height??0;if(e===0)return e;const r=this._getViewPadding(),{top:i,bottom:s}=r;return Math.max(e-i-s,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...h8,...e}}get width(){const e=this.view?.width??0;if(e===0)return e;const r=this._getViewPadding(),{left:i,right:s}=r;return Math.max(e-i-s,0)}add(e,r){let i,s,n;if(Array.isArray(e))return void e.forEach(l=>this.add(l,r));const o=qb(e);o&&({index:i,position:r,component:e,key:s}=o),r&&typeof r=="object"&&({index:i,key:s,position:r,internal:n}=r),!e||r&&!this._isValidPosition(r)||this._add(e,r,i??this._getNumComponentsAtPosition(r),s,n)}remove(e,r){if(!e)return;if(Array.isArray(e))return e.map(s=>this.remove(s,r));const i=this._find(e);if(i){const s=this._componentMap.get(i);if(!s||s.key!==r)return;const n=this._components.indexOf(i);return i.node.parentNode?.removeChild(i.node),this._componentMap.delete(i),i.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.forEach(l=>{const u=this._componentMap.get(l);u&&u.position===s.position&&u.index>s.index&&u.index--}),this._components.splice(n,1)[0]}}empty(e,r={removeInternal:!1}){if(Array.isArray(e)){for(const n of e)this.empty(n,r);return}const i=this._positionNameToContainerLookup[e??"manual"],s=Array.prototype.slice.call(i.children).map(n=>this._findByNode(n)).filter(n=>n==null?!1:!(this._componentMap.get(n)?.internal??!1)||r.removeInternal);for(const n of s)this.remove(n)}move(e,r){if(Array.isArray(e)&&e.forEach(o=>this.move(o,r)),!e)return;let i;const s=qb(e)||qb(r);if(s&&(i=s.index,r=s.position,e=s.component||e),r&&!this._isValidPosition(r))return;const n=this.remove(e);n&&this.add(n,{position:r,index:i})}find(e){if(!e)return null;const r=this._findById(e);return r&&(r.widget||r.node)}getComponents(e,r={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap(i=>this._getComponentsAtPosition(i,r)):this._getComponentsAtPosition(e,r):this._components.filter(i=>r.includeInternal||!this._componentMap.get(i)?.internal).map(({widget:i,node:s})=>i??s)}getPosition(e){for(const r in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[r].contains(e))return r;return null}_add(e,r,i,s,n){e instanceof O0||(e=new O0({node:e}));const{widget:o}=e;o!=null&&o instanceof X&&o.addHandles(Te(()=>{queueMicrotask(()=>this.remove(e))}),this._removeWidgetHandleKey);const l=this._positionNameToContainerLookup[r];this._components.some(u=>{const d=this._componentMap.get(u)?.position,p=d?this._positionNameToContainerLookup[d]:null;return l===p&&this._componentMap.get(u)?.index===i})&&this._components.forEach(u=>{const d=this._componentMap.get(u),p=d?.position,f=p?this._positionNameToContainerLookup[p]:null;d&&f===l&&d.index>=i&&d.index++}),this._place({component:e,position:r,index:i}),this._components.push(e),this._componentMap.set(e,{key:s,position:r,internal:n,index:i})}_find(e){return e?e instanceof O0?this._findByComponent(e):typeof e=="string"?this._findById(e):"domNode"in e?this._findByNode(e.domNode):this._findByNode(e):null}_getViewPadding(){return this.view?.padding??Oce}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(ei.innerContainer,ei.cornerContainer);const r=document.createElement("div");r.classList.add(ei.innerContainer,ei.manualContainer);const i=document.createElement("div");i.classList.add(ei.topLeft,ei.corner),e.appendChild(i);const s=document.createElement("div");s.classList.add(ei.topRight,ei.corner),e.appendChild(s);const n=document.createElement("div");n.classList.add(ei.bottomLeft,ei.corner),e.appendChild(n);const o=document.createElement("div");o.classList.add(ei.bottomRight,ei.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=r;const l=Mce();this._cornerNameToContainerLookup={"top-left":i,"top-right":s,"bottom-left":n,"bottom-right":o,"top-leading":l?s:i,"top-trailing":l?i:s,"bottom-leading":l?o:n,"bottom-trailing":l?n:o},this._positionNameToContainerLookup={manual:r,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const r=e.position??"manual",{component:i,index:s}=e,n=this._positionNameToContainerLookup[r],o=s!=null&&s>-1;if(kce(i.widget)&&i.widget.startup(),!o)return void n.appendChild(i.node);const l=Array.from(n.children);if(l.length!==0){for(const u of l){const d=this._findByNode(u);if(d&&s<(this._componentMap.get(d)?.index??0))return void u.parentNode?.insertBefore(i.node,u)}n.appendChild(i.node)}else n.appendChild(i.node)}_toPixelPosition(e){return{top:fg(e.top),left:fg(e.left),right:fg(e.right),bottom:fg(e.bottom)}}_findByComponent(e){return this._components.find(r=>r===e)??null}_findById(e){return this._components.find(({id:r})=>r===e)??null}_findByNode(e){return e?this._components.find(({node:r})=>r===e):null}_getComponentsAtPosition(e,r){const i=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(i.children).map(s=>this._findByNode(s)).filter(ps).filter(s=>r.includeInternal||!this._componentMap.get(s)?.internal).map(({widget:s,node:n})=>s??n)}_getNumComponentsAtPosition(e){return this._positionNameToContainerLookup[e]?.children.length??0}};a([c()],mn.prototype,"_locale",void 0),a([c()],mn.prototype,"container",null),a([c()],mn.prototype,"height",null),a([c({value:h8})],mn.prototype,"padding",null),a([Ce("padding")],mn.prototype,"castPadding",null),a([c()],mn.prototype,"view",void 0),a([c()],mn.prototype,"width",null),mn=a([b("esri.views.ui.UI")],mn);const Cce=mn,Pce={handleInterceptedEvent:(t,e,r,i)=>(t.scheduleRender(),e.properties[`on${i.type}`].apply(e.properties.bind||r,[i]))},Ace={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,r)=>{e.startsWith("-")?t.style.setProperty(e,r):t.style[e]=r}},Rce=t=>({...Ace,...t}),Lce=(t,e)=>{const r=[];for(;t&&t!==e;)r.push(t),t=t.parentNode;return r},Fce=(t,e)=>t.find(e),IC=(t,e,r=!1)=>{let i=t;return e.forEach((s,n)=>{const o=i?.children?Fce(i.children,l=>l.domNode===s):void 0;r&&!o&&n!==e.length-1||(i=o)}),i},Nce=t=>{let e;const r={...Pce,...t},i=Rce(r),s=i.performanceLogger;let n,o=!0,l=!1;const u=[],d=[],p=(m,y,g)=>{let v;i.eventHandlerInterceptor=(S,M,C,T)=>function(O){let P;s("domEvent",O);const D=Lce(O.currentTarget,v.domNode),z=D.some(G=>customElements.get(G?.tagName?.toLowerCase()));if(O.eventPhase===Event.CAPTURING_PHASE||!z)D.reverse(),P=IC(v.getLastRender(),D);else{const G=O.composedPath(),Q=G.slice(G.indexOf(O.currentTarget),G.indexOf(v.domNode)).reverse();P=IC(v.getLastRender(),Q,!0)}let B;return P&&(B=r.handleInterceptedEvent(e,P,this,O)),s("domEventProcessed",O),B},r.postProcessProjectionOptions?.(i);const _=g();v=m(y,_,i),i.eventHandlerInterceptor=void 0,u.push(v),d.push(g),r.afterFirstVNodeRendered&&r.afterFirstVNodeRendered(v,_)};let f=()=>{if(n=void 0,o){o=!1,s("renderStart",void 0);for(let m=0;m<u.length;m++){const y=d[m]();s("rendered",void 0);try{u[m].update(y)}catch(g){console.error(g)}s("patched",void 0)}s("renderDone",void 0),o=!0}};return r.modifyDoRenderImplementation&&(f=r.modifyDoRenderImplementation(f,u,d)),e={renderNow:f,scheduleRender:()=>{n||l||(n=requestAnimationFrame(f))},stop:()=>{n&&(cancelAnimationFrame(n),n=void 0),l=!0},resume:()=>{l=!1,o=!0,e.scheduleRender()},append:(m,y)=>{p(La.append,m,y)},insertBefore:(m,y)=>{p(La.insertBefore,m,y)},merge:(m,y)=>{p(La.merge,m,y)},replace:(m,y)=>{p(La.replace,m,y)},detach:m=>{for(let y=0;y<d.length;y++)if(d[y]===m)return d.splice(y,1),u.splice(y,1)[0];throw new Error("renderFunction was not found")}},e},at=(t,e,...r)=>{try{return t?.call(e,...r)}catch(i){console.error(i,t)}},k$=async(t,e,...r)=>{try{return await t?.call(e,...r)}catch(i){console.error(i,t)}},a3=Symbol.for("controller"),Dce=t=>typeof t=="object"&&t!==null&&(a3 in t||"hostConnected"in t||"hostDisconnected"in t||"hostUpdate"in t||"hostUpdated"in t),g3e=t=>typeof t?.then=="function";let wf;const bf=t=>{wf!==t&&(wf=t,queueMicrotask(()=>wf===t?wf=void 0:0))},c1=t=>wf;let zl=[];const jce=t=>{if(t===void 0){zl=[];return}const e=zl.indexOf(t);zl=e===-1?[...zl,t]:zl.slice(0,e+1),queueMicrotask(()=>zl=[])},Vce=()=>zl;let vd;const v3e=t=>{vd!==t&&(vd=t,queueMicrotask(()=>vd===t?vd=void 0:0))},zce=()=>{const t=vd;return vd=void 0,t},Uce=async(t,e)=>{const r=l3(t);if(r===void 0)return t;if(await r.ready,typeof e=="function"){const i=r.watchExports(s=>e(s,i))}return r.exports},qce=async t=>{const e=l3(t);return await e.ready,e},l3=t=>{const r=c1().manager.X(t);if(r!==void 0)return r;if(Dce(t))return t;const i=zce();if(i!==void 0)return i};let C$=!1;const w3e=t=>{C$=!0;try{return t()}finally{C$=!1}};const k0=globalThis,u3=k0.ShadowRoot&&(k0.ShadyCSS===void 0||k0.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,c3=Symbol(),EC=new WeakMap;let p8=class{constructor(e,r,i){if(this._$cssResult$=!0,i!==c3)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=r}get styleSheet(){let e=this.o;const r=this.t;if(u3&&e===void 0){const i=r!==void 0&&r.length===1;i&&(e=EC.get(r)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&EC.set(r,e))}return e}toString(){return this.cssText}};const Gce=t=>new p8(typeof t=="string"?t:t+"",void 0,c3),_3e=(t,...e)=>{const r=t.length===1?t[0]:e.reduce((i,s,n)=>i+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[n+1],t[0]);return new p8(r,t,c3)},Bce=(t,e)=>{if(u3)t.adoptedStyleSheets=e.map(r=>r instanceof CSSStyleSheet?r:r.styleSheet);else for(const r of e){const i=document.createElement("style"),s=k0.litNonce;s!==void 0&&i.setAttribute("nonce",s),i.textContent=r.cssText,t.appendChild(i)}},OC=u3?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let r="";for(const i of e.cssRules)r+=i.cssText;return Gce(r)})(t):t;const{is:Hce,defineProperty:Wce,getOwnPropertyDescriptor:Zce,getOwnPropertyNames:Jce,getOwnPropertySymbols:Yce,getPrototypeOf:Kce}=Object,d1=globalThis,kC=d1.trustedTypes,Qce=kC?kC.emptyScript:"",Xce=d1.reactiveElementPolyfillSupport,um=(t,e)=>t,P$={toAttribute(t,e){switch(e){case Boolean:t=t?Qce:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let r=t;switch(e){case Boolean:r=t!==null;break;case Number:r=t===null?null:Number(t);break;case Object:case Array:try{r=JSON.parse(t)}catch{r=null}}return r}},d3=(t,e)=>!Hce(t,e),CC={attribute:!0,type:String,converter:P$,reflect:!1,useDefault:!1,hasChanged:d3};Symbol.metadata??=Symbol("metadata"),d1.litPropertyMetadata??=new WeakMap;let zc=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,r=CC){if(r.state&&(r.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((r=Object.create(r)).wrapped=!0),this.elementProperties.set(e,r),!r.noAccessor){const i=Symbol(),s=this.getPropertyDescriptor(e,i,r);s!==void 0&&Wce(this.prototype,e,s)}}static getPropertyDescriptor(e,r,i){const{get:s,set:n}=Zce(this.prototype,e)??{get(){return this[r]},set(o){this[r]=o}};return{get:s,set(o){const l=s?.call(this);n?.call(this,o),this.requestUpdate(e,l,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??CC}static _$Ei(){if(this.hasOwnProperty(um("elementProperties")))return;const e=Kce(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(um("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(um("properties"))){const r=this.properties,i=[...Jce(r),...Yce(r)];for(const s of i)this.createProperty(s,r[s])}const e=this[Symbol.metadata];if(e!==null){const r=litPropertyMetadata.get(e);if(r!==void 0)for(const[i,s]of r)this.elementProperties.set(i,s)}this._$Eh=new Map;for(const[r,i]of this.elementProperties){const s=this._$Eu(r,i);s!==void 0&&this._$Eh.set(s,r)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const r=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const s of i)r.unshift(OC(s))}else e!==void 0&&r.push(OC(e));return r}static _$Eu(e,r){const i=r.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,r=this.constructor.elementProperties;for(const i of r.keys())this.hasOwnProperty(i)&&(e.set(i,this[i]),delete this[i]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Bce(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,r,i){this._$AK(e,i)}_$ET(e,r){const i=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,i);if(s!==void 0&&i.reflect===!0){const n=(i.converter?.toAttribute!==void 0?i.converter:P$).toAttribute(r,i.type);this._$Em=e,n==null?this.removeAttribute(s):this.setAttribute(s,n),this._$Em=null}}_$AK(e,r){const i=this.constructor,s=i._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const n=i.getPropertyOptions(s),o=typeof n.converter=="function"?{fromAttribute:n.converter}:n.converter?.fromAttribute!==void 0?n.converter:P$;this._$Em=s;const l=o.fromAttribute(r,n.type);this[s]=l??this._$Ej?.get(s)??l,this._$Em=null}}requestUpdate(e,r,i,s=!1,n){if(e!==void 0){const o=this.constructor;if(s===!1&&(n=this[e]),i??=o.getPropertyOptions(e),!((i.hasChanged??d3)(n,r)||i.useDefault&&i.reflect&&n===this._$Ej?.get(e)&&!this.hasAttribute(o._$Eu(e,i))))return;this.C(e,r,i)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,r,{useDefault:i,reflect:s,wrapped:n},o){i&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??r??this[e]),n!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||i||(r=void 0),this._$AL.set(e,r)),s===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(r){Promise.reject(r)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,n]of this._$Ep)this[s]=n;this._$Ep=void 0}const i=this.constructor.elementProperties;if(i.size>0)for(const[s,n]of i){const{wrapped:o}=n,l=this[s];o!==!0||this._$AL.has(s)||l===void 0||this.C(s,void 0,n,l)}}let e=!1;const r=this._$AL;try{e=this.shouldUpdate(r),e?(this.willUpdate(r),this._$EO?.forEach(i=>i.hostUpdate?.()),this.update(r)):this._$EM()}catch(i){throw e=!1,this._$EM(),i}e&&this._$AE(r)}willUpdate(e){}_$AE(e){this._$EO?.forEach(r=>r.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(r=>this._$ET(r,this[r])),this._$EM()}updated(e){}firstUpdated(e){}};zc.elementStyles=[],zc.shadowRootOptions={mode:"open"},zc[um("elementProperties")]=new Map,zc[um("finalized")]=new Map,Xce?.({ReactiveElement:zc}),(d1.reactiveElementVersions??=[]).push("2.1.2");const h3=globalThis,PC=t=>t,rw=h3.trustedTypes,AC=rw?rw.createPolicy("lit-html",{createHTML:t=>t}):void 0,f8="$lit$",Ea=`lit$${Math.random().toFixed(9).slice(2)}$`,m8="?"+Ea,ede=`<${m8}>`,ju=document,jm=()=>ju.createComment(""),Vm=t=>t===null||typeof t!="object"&&typeof t!="function",p3=Array.isArray,tde=t=>p3(t)||typeof t?.[Symbol.iterator]=="function",Bb=`[ 	
\f\r]`,Dp=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,RC=/-->/g,LC=/>/g,_l=RegExp(`>|${Bb}(?:([^\\s"'>=/]+)(${Bb}*=${Bb}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),FC=/'/g,NC=/"/g,y8=/^(?:script|style|textarea|title)$/i,g8=t=>(e,...r)=>({_$litType$:t,strings:e,values:r}),$3e=g8(1),x3e=g8(2),rl=Symbol.for("lit-noChange"),_t=Symbol.for("lit-nothing"),DC=new WeakMap,lu=ju.createTreeWalker(ju,129);function v8(t,e){if(!p3(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return AC!==void 0?AC.createHTML(e):e}const rde=(t,e)=>{const r=t.length-1,i=[];let s,n=e===2?"<svg>":e===3?"<math>":"",o=Dp;for(let l=0;l<r;l++){const u=t[l];let d,p,f=-1,m=0;for(;m<u.length&&(o.lastIndex=m,p=o.exec(u),p!==null);)m=o.lastIndex,o===Dp?p[1]==="!--"?o=RC:p[1]!==void 0?o=LC:p[2]!==void 0?(y8.test(p[2])&&(s=RegExp("</"+p[2],"g")),o=_l):p[3]!==void 0&&(o=_l):o===_l?p[0]===">"?(o=s??Dp,f=-1):p[1]===void 0?f=-2:(f=o.lastIndex-p[2].length,d=p[1],o=p[3]===void 0?_l:p[3]==='"'?NC:FC):o===NC||o===FC?o=_l:o===RC||o===LC?o=Dp:(o=_l,s=void 0);const y=o===_l&&t[l+1].startsWith("/>")?" ":"";n+=o===Dp?u+ede:f>=0?(i.push(d),u.slice(0,f)+f8+u.slice(f)+Ea+y):u+Ea+(f===-2?l:y)}return[v8(t,n+(t[r]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),i]};let A$=class w8{constructor({strings:e,_$litType$:r},i){let s;this.parts=[];let n=0,o=0;const l=e.length-1,u=this.parts,[d,p]=rde(e,r);if(this.el=w8.createElement(d,i),lu.currentNode=this.el.content,r===2||r===3){const f=this.el.content.firstChild;f.replaceWith(...f.childNodes)}for(;(s=lu.nextNode())!==null&&u.length<l;){if(s.nodeType===1){if(s.hasAttributes())for(const f of s.getAttributeNames())if(f.endsWith(f8)){const m=p[o++],y=s.getAttribute(f).split(Ea),g=/([.?@])?(.*)/.exec(m);u.push({type:1,index:n,name:g[2],strings:y,ctor:g[1]==="."?sde:g[1]==="?"?nde:g[1]==="@"?ode:p1}),s.removeAttribute(f)}else f.startsWith(Ea)&&(u.push({type:6,index:n}),s.removeAttribute(f));if(y8.test(s.tagName)){const f=s.textContent.split(Ea),m=f.length-1;if(m>0){s.textContent=rw?rw.emptyScript:"";for(let y=0;y<m;y++)s.append(f[y],jm()),lu.nextNode(),u.push({type:2,index:++n});s.append(f[m],jm())}}}else if(s.nodeType===8)if(s.data===m8)u.push({type:2,index:n});else{let f=-1;for(;(f=s.data.indexOf(Ea,f+1))!==-1;)u.push({type:7,index:n}),f+=Ea.length-1}n++}}static createElement(e,r){const i=ju.createElement("template");return i.innerHTML=e,i}};function Nh(t,e,r=t,i){if(e===rl)return e;let s=i!==void 0?r._$Co?.[i]:r._$Cl;const n=Vm(e)?void 0:e._$litDirective$;return s?.constructor!==n&&(s?._$AO?.(!1),n===void 0?s=void 0:(s=new n(t),s._$AT(t,r,i)),i!==void 0?(r._$Co??=[])[i]=s:r._$Cl=s),s!==void 0&&(e=Nh(t,s._$AS(t,e.values),s,i)),e}let ide=class{constructor(e,r){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=r}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:r},parts:i}=this._$AD,s=(e?.creationScope??ju).importNode(r,!0);lu.currentNode=s;let n=lu.nextNode(),o=0,l=0,u=i[0];for(;u!==void 0;){if(o===u.index){let d;u.type===2?d=new h1(n,n.nextSibling,this,e):u.type===1?d=new u.ctor(n,u.name,u.strings,this,e):u.type===6&&(d=new ade(n,this,e)),this._$AV.push(d),u=i[++l]}o!==u?.index&&(n=lu.nextNode(),o++)}return lu.currentNode=ju,s}p(e){let r=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,r),r+=i.strings.length-2):i._$AI(e[r])),r++}},h1=class b8{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,r,i,s){this.type=2,this._$AH=_t,this._$AN=void 0,this._$AA=e,this._$AB=r,this._$AM=i,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const r=this._$AM;return r!==void 0&&e?.nodeType===11&&(e=r.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,r=this){e=Nh(this,e,r),Vm(e)?e===_t||e==null||e===""?(this._$AH!==_t&&this._$AR(),this._$AH=_t):e!==this._$AH&&e!==rl&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):tde(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==_t&&Vm(this._$AH)?this._$AA.nextSibling.data=e:this.T(ju.createTextNode(e)),this._$AH=e}$(e){const{values:r,_$litType$:i}=e,s=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=A$.createElement(v8(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===s)this._$AH.p(r);else{const n=new ide(s,this),o=n.u(this.options);n.p(r),this.T(o),this._$AH=n}}_$AC(e){let r=DC.get(e.strings);return r===void 0&&DC.set(e.strings,r=new A$(e)),r}k(e){p3(this._$AH)||(this._$AH=[],this._$AR());const r=this._$AH;let i,s=0;for(const n of e)s===r.length?r.push(i=new b8(this.O(jm()),this.O(jm()),this,this.options)):i=r[s],i._$AI(n),s++;s<r.length&&(this._$AR(i&&i._$AB.nextSibling,s),r.length=s)}_$AR(e=this._$AA.nextSibling,r){for(this._$AP?.(!1,!0,r);e!==this._$AB;){const i=PC(e).nextSibling;PC(e).remove(),e=i}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},p1=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,r,i,s,n){this.type=1,this._$AH=_t,this._$AN=void 0,this.element=e,this.name=r,this._$AM=s,this.options=n,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=_t}_$AI(e,r=this,i,s){const n=this.strings;let o=!1;if(n===void 0)e=Nh(this,e,r,0),o=!Vm(e)||e!==this._$AH&&e!==rl,o&&(this._$AH=e);else{const l=e;let u,d;for(e=n[0],u=0;u<n.length-1;u++)d=Nh(this,l[i+u],r,u),d===rl&&(d=this._$AH[u]),o||=!Vm(d)||d!==this._$AH[u],d===_t?e=_t:e!==_t&&(e+=(d??"")+n[u+1]),this._$AH[u]=d}o&&!s&&this.j(e)}j(e){e===_t?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},sde=class extends p1{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===_t?void 0:e}},nde=class extends p1{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==_t)}},ode=class extends p1{constructor(e,r,i,s,n){super(e,r,i,s,n),this.type=5}_$AI(e,r=this){if((e=Nh(this,e,r,0)??_t)===rl)return;const i=this._$AH,s=e===_t&&i!==_t||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,n=e!==_t&&(i===_t||s);s&&this.element.removeEventListener(this.name,this,i),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},ade=class{constructor(e,r,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=r,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){Nh(this,e)}};const C3e={I:h1},lde=h3.litHtmlPolyfillSupport;lde?.(A$,h1),(h3.litHtmlVersions??=[]).push("3.3.2");const ude=(t,e,r)=>{const i=r?.renderBefore??e;let s=i._$litPart$;if(s===void 0){const n=r?.renderBefore??null;i._$litPart$=s=new h1(e.insertBefore(jm(),n),n,void 0,r??{})}return s._$AI(t),s};const f3=globalThis;let jd=class extends zc{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=ude(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return rl}};jd._$litElement$=!0,jd.finalized=!0,f3.litElementHydrateSupport?.({LitElement:jd});const cde=f3.litElementPolyfillSupport;cde?.({LitElement:jd});(f3.litElementVersions??=[]).push("4.2.2");class zm{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}const dde=(t,e)=>{const r=e/hde;let i=0;const s=setInterval(()=>{i+=r,i>=e&&(clearInterval(s),t())},r);return s},hde=4,pde=(t,e,r)=>{const i=Object.keys(t),s=i.length;wd===void 0&&queueMicrotask(f1),wd??=new Map;let n=wd.get(t);return n===void 0&&(n={callbacks:[],keyCount:s},wd.set(t,n)),n.keyCount!==s&&(n.callbacks.forEach(o=>o(i)),n.callbacks=[],n.keyCount=s),n.callbacks.push(o=>{const l=d=>at(e,null,d),u=o[s];u===void 0?l(void 0):t[u]===r?l(u):l(void 0)}),r};let wd;const f1=()=>{wd?.forEach(({callbacks:t},e)=>{const r=Object.keys(e);t.forEach(i=>i(r))}),wd=void 0},fde=(t,e,r)=>{const i=t.manager;return i.V!==_t&&i.V!==r&&i.S(void 0,void 0),i.T.length===0&&queueMicrotask(()=>i.S(void 0,void 0)),i.V=r,i.T.push((s,n)=>at(e,void 0,r===n?s:void 0)),r},mde=(t=[c1(),...Vce()],e,r)=>{const i=Array.isArray(t)?t:[t];let s=i.length+1;const n=o=>{s-=1,o!==void 0&&(s=Math.min(s,0)),s===0&&e(o)};i.forEach(o=>pde(o,l=>n(l===void 0?void 0:{key:l,host:o,isReactive:!1}),r));for(const o of i)if("manager"in o&&o.manager.component===o){fde(o,l=>n(l===void 0?void 0:{key:l,host:o,isReactive:!0}),r);break}return r},yde=(t="",e={},r=c1())=>{const i={emit:s=>{t===""&&f1();const n=new CustomEvent(t,{detail:s,cancelable:!0,bubbles:!0,composed:!0,...e});return r.el.dispatchEvent(n),n}};return t===""&&mde(void 0,s=>t=s.key,i),i},A3e=yde.bind(null,"");var _8;_8=a3;class gde{constructor(e){this.#r=[],this.#e=[],this.#i=[],this.#l=[],this.#u=[],this.#c=[],this.#d=[],this.#h=[],this.#o=[],this.#a=!1,this.P=new zm,this.connectedCalled=!1,this.loadedCalled=!1,this[_8]=!0,this.#n=[];const r=this,i=e??c1();r.#t=i,r.ready=r.P.promise,r.#s=VC(r),r.component=i,r.#t.addController(r),r.#t.manager===void 0||(jce(r),queueMicrotask(()=>r.catchUpLifecycle()))}#r;#e;#i;#l;#u;#c;#d;#h;#o;#a;#t;catchUpLifecycle(){const{manager:e}=this.#t;e.connectedCalled&&!this.connectedCalled&&this.triggerConnected(),e.#a&&this.triggerLoad().then(()=>e.loadedCalled&&this.triggerLoaded()).catch(console.error)}#s;get exports(){return this.#s}set exports(e){const r=this.#s;r!==e&&(this.#s=e,this.#n.forEach(at),this.connectedCalled&&this.O!==!1&&this.#t.requestUpdate(this.O,r)),this.P.resolve(e)}setProvisionalExports(e,r=!0){this.#s=r?VC(e):e,this.#n.forEach(at)}#n;watchExports(e){const r=()=>e(this.#s);return this.#n.push(r),()=>{this.#n.splice(this.#n.indexOf(r),1)}}get use(){return bf(this.#t),Uce}get useRef(){return bf(this.#t),qce}get useRefSync(){return bf(this.#t),l3}controllerRemoved(){this.#t.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(e){this.#r.push(e)}onDisconnected(e){this.#e.push(e)}onLoad(e){this.#i.push(e)}onLoaded(e){this.#l.push(e)}onUpdate(e){this.#u.push(e)}onUpdated(e){this.#c.push(e)}onDestroy(e){this.#d.push(e)}onLifecycle(e){this.#h.push(e),this.connectedCalled&&this.#t.el.isConnected&&this.#p(e)}triggerConnected(){const e=this;e.hostConnected&&at(e.hostConnected,e),e.#r.forEach(at),e.triggerLifecycle(),e.connectedCalled=!0}triggerDisconnected(){const e=this;e.hostDisconnected&&at(e.hostDisconnected,e),e.#e.forEach(at),e.#o.forEach(at),e.#o=[]}async triggerLoad(){if(this.#a)return;this.#a=!0;const e=this;e.hostLoad&&await k$(e.hostLoad,e),this.#i.length>0&&await Promise.allSettled(this.#i.map(k$)),this.P.resolve(this.#s)}triggerLoaded(){this.loadedCalled||(this.hostLoaded&&at(this.hostLoaded,this),this.#l.forEach(at),this.loadedCalled=!0)}triggerUpdate(e){this.hostUpdate&&at(this.hostUpdate,this,e),this.#u.forEach(jC,e)}triggerUpdated(e){this.hostUpdated&&at(this.hostUpdated,this,e),this.#c.forEach(jC,e)}triggerDestroy(){this.hostDestroy&&at(this.hostDestroy,this),this.#d.forEach(at)}triggerLifecycle(){this.hostLifecycle&&this.#p(()=>this.hostLifecycle()),this.#h.forEach(this.#p,this)}#p(e){bf(this.#t);const r=at(e);(Array.isArray(r)?r:[r]).forEach(s=>{typeof s=="function"?this.#o.push(s):typeof s=="object"&&typeof s.remove=="function"&&this.#o.push(s.remove)})}}function jC(t){at(t,void 0,this)}const vde=gde,VC=t=>{if(typeof t!="object"&&typeof t!="function"||t===null)return t;const e={get(i,s,n){if(!((s==="exports"||s==="_exports")&&s in i&&i[s]===r)&&(s in i||s in Promise.prototype||typeof s=="symbol"))return typeof i=="function"?i[s]:Reflect.get(i,s,n)}},r=new Proxy(t,e);return r},wde=t=>t.replace(bde,(e,r)=>`${r===0?"":"-"}${e.toLowerCase()}`),bde=/[A-Z]+(?![a-z])|[A-Z]/gu,_de=1,Sde=2,$de=4,xde=8,Tde=16,Mde=32,Ide=64,S8=t=>{let e=t;for(;e=e.parentNode??e.host;)if(e?.constructor?.lumina){const r=e;return r.manager?.loadedCalled||(r.J??r._offspring).push(t),(r.I??r._postLoad).promise}return!1},zC={};function $8(){}const C0=Object.defineProperty,Ede=globalThis.HTMLElement??$8;var ui,ko,ah,Wm,R$;const q3=class q3 extends Ede{constructor(){var s;super();Ss(this,Wm);Ss(this,ui);Ss(this,ko);Ss(this,ah);$s(this,ko,{}),$s(this,ah,[]),this.I=new zm,this.H=new zm,this.J=[];const r=this,i=r.constructor;r._offspring=r.J,r._postLoad=r.I,i.C?.forEach(n=>{Object.hasOwn(r,n)&&(je(r,ko)[n]=r[n],delete r[n])}),i.A?fp(s=r,Wm,R$).call(s,{a:i.A}):i.B.then(async n=>{var o;await i.K.p,fp(o=r,Wm,R$).call(o,await(n.default?.then(l=>typeof l=="function"?{a:l}:l)??n))}).catch(n=>{r.H.reject(n),setTimeout(()=>{throw n})})}static F(){for(const r of this.C??[])C0(this.prototype,r,{configurable:!0,enumerable:!0,get(){return je(this,ko)[r]},set(i){je(this,ko)[r]=i}});for(const r of this.E??[])C0(this.prototype,r,{async value(...i){return je(this,ui)||await this.H.promise,await je(this,ui)[r](...i)},configurable:!0});for(const r of this.D??[])C0(this.prototype,r,{value(...i){return je(this,ui)[r](...i)},configurable:!0})}get manager(){return je(this,ui)?.manager}attributeChangedCallback(r,i,s){je(this,ui)?.attributeChangedCallback(r,i,s),je(this,ui)||je(this,ah).push(r)}connectedCallback(){je(this,ui)?je(this,ui).connectedCallback?.():queueMicrotask(()=>this.G=S8(this))}disconnectedCallback(){je(this,ui)?.disconnectedCallback?.()}async componentOnReady(){return await this.H.promise,this}addController(){}requestUpdate(){je(this,ui)?.requestUpdate()}};ui=new WeakMap,ko=new WeakMap,ah=new WeakMap,Wm=new WeakSet,R$=function(r){const i=this.constructor,s=i.L,n=je(this,ko),o=Object.values(r).find(m=>m.L===s),l=`${s}--lazy`;let u=o;for(;u&&!Object.hasOwn(u,"lumina");)u=Object.getPrototypeOf(u);kde(u),!i.A&&(i.A=o,customElements.define(l,o)),o.N=this;const p=document.createElement(l);o.N=void 0,$s(this,ui,p),$s(this,ko,p),je(this,ah).forEach(m=>p.attributeChangedCallback(m,null,this.getAttribute(m))),Object.entries(n).forEach(Ode,p);const f=this.isConnected;(f||this.G)&&(p.connectedCallback?.(),f||p.disconnectedCallback())},q3.lumina=!0;let UC=q3;function Ode([t,e]){this[t]=e}const kde=t=>{const e=t.prototype,r=Element.prototype;Object.hasOwn(e,"isConnected")||(e.setAttribute=function(s,n){r.setAttribute.call(this.el,s,n)},e.removeAttribute=function(s){r.removeAttribute.call(this.el,s)},C0(e,"isConnected",{get(){return Reflect.get(r,"isConnected",this.el)}}))};const x8={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},T8=t=>(...e)=>({_$litDirective$:t,values:e});let M8=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,r,i){this._$Ct=e,this._$AM=r,this._$Ci=i}_$AS(e,r){return this.update(e,r)}update(e,r){return this.render(...r)}};const Cde=T8(class extends M8{constructor(t){if(super(t),t.type!==x8.ATTRIBUTE||t.name!=="class"||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter(e=>t[e]).join(" ")+" "}update(t,[e]){if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(i=>i!=="")));for(const i in e)e[i]&&!this.nt?.has(i)&&this.st.add(i);return this.render(e)}const r=t.element.classList;for(const i of this.st)i in e||(r.remove(i),this.st.delete(i));for(const i in e){const s=!!e[i];s===this.st.has(i)||this.nt?.has(i)||(s?(r.add(i),this.st.add(i)):(r.remove(i),this.st.delete(i)))}return rl}});const I8="important",Pde=" !"+I8,Ade=T8(class extends M8{constructor(t){if(super(t),t.type!==x8.ATTRIBUTE||t.name!=="style"||t.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce((e,r)=>{const i=t[r];return i==null?e:e+`${r=r.includes("-")?r:r.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${i};`},"")}update(t,[e]){const{style:r}=t.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(e)),this.render(e);for(const i of this.ft)e[i]==null&&(this.ft.delete(i),i.includes("-")?r.removeProperty(i):r[i]=null);for(const i in e){const s=e[i];if(s!=null){this.ft.add(i);const n=typeof s=="string"&&s.endsWith(Pde);i.includes("-")||n?r.setProperty(i,n?s.slice(0,-11):s,n?I8:""):r[i]=s}}return rl}});class Rde extends vde{constructor(e){super(e),this.destroyed=!1,this.R=!1,this.V=_t,this.T=[],this.#i=new WeakMap,this.#e=e,this.exports=void 0,this.hasDestroy=L$ in e&&typeof e.destroy=="function",jd.prototype.addController.call(e,{hostConnected:()=>{if(this.destroyed){const r=e.el.localName;throw e.el.remove(),new Error(`The ${r} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${L$} prop.`)}this.#r!==void 0&&clearTimeout(this.#r),f1();for(const r of e.M)"triggerConnected"in r?r.triggerConnected():at(r.hostConnected,r)},hostDisconnected:()=>{for(const r of e.M)"triggerDisconnected"in r?r.triggerDisconnected():at(r.hostDisconnected,r);this.hasDestroy&&!this.destroyed&&this.U()},hostUpdate:()=>{for(const r of e.M)"triggerUpdate"in r?r.triggerUpdate(this.Q):at(r.hostUpdate,r,this.Q)},hostUpdated:()=>{for(const r of e.M)"triggerUpdated"in r?r.triggerUpdated(this.Q):at(r.hostUpdated,r,this.Q);this.Q=void 0}}),queueMicrotask(()=>this.R=!0),bf(e)}#r;#e;async destroy(){if(!this.destroyed){this.#e.el.isConnected&&(this.hasDestroy=!1,this.#e.el.remove()),this.#r=void 0,this.destroyed=!0;for(const e of this.#e.M)"triggerDestroy"in e?e.triggerDestroy():at(e.hostDestroy,e);this.#e.M.splice(0)}}U(){if(this.#r!==void 0&&clearTimeout(this.#r),!this.#e.el.isConnected&&!this.#e.autoDestroyDisabled){const e=()=>{this.#e.destroy()};this.#r=dde(e,Lde)}}S(e,r){const i=this.T;this.V=_t,this.T=[],i.forEach(s=>s(e,r))}#i;W(e,r){(typeof r=="object"&&r!==null||typeof r=="function")&&this.#i.set(r,e)}X(e){if(typeof e=="object"&&e!==null||typeof e=="function")return this.#i.get(e)}}let Lde=1e3;const L$="autoDestroyDisabled";var cu,Zm,Jm,du,Tn,Dh,E8,O8;const ym=class ym extends jd{constructor(){super();Ss(this,Dh);Ss(this,cu);Ss(this,Zm);Ss(this,Jm);Ss(this,du);Ss(this,Tn);this.M=[],this.manager=new Rde(this);const r=this,i=r.constructor,s=i.N,n=i.K.o,o=ym.prototype.shouldUpdate;$s(r,du,s?.H??new zm),r.I=s?.I??new zm,r.J=s?.J??[],r._offspring=r.J,r._postLoad=r.I,r.el=s??r,$s(r,Jm,r.enableUpdating),r.enableUpdating=$8,r.shouldUpdate!==o&&($s(r,Zm,r.shouldUpdate),r.shouldUpdate=o),n&&($s(r,cu,new Map),i.elementProperties.forEach((l,u)=>je(r,cu).set(u,n())))}static finalizeStyles(r){const i=super.finalizeStyles(r),s=this.shadowRootOptions===zC;return this.K?.commonStyles===void 0||s?i:[this.K.commonStyles,...i]}static createProperty(r,i){const s=typeof i=="number"?i:Array.isArray(i)?i[0]:0,n=Array.isArray(i)?i[1]:void 0,o=n?.hasChanged??d3,l={attribute:s&_de&&typeof r=="string"?wde(r):!1,reflect:!!(s&Sde),type:s&$de?Boolean:s&xde?Number:void 0,state:!!(s&Tde),readOnly:!!(s&Mde),noAccessor:!!(s&Ide),c:!1,...n,hasChanged(u,d){const p=o(u,d);return l.c=p,p}};super.createProperty(r,l)}static getPropertyDescriptor(r,i,s){const n=this.K,o=super.getPropertyDescriptor(r,i,s);return s.d=o,{...o,get(){return n.t?.(je(this,cu).get(r)),o.get?.call(this)},set(l){const u=this.manager;if(s.readOnly&&!C$&&(u.R||u.connectedCalled))throw Error(`Cannot assign to read-only property "${r}" of ${this.el.localName}. Trying to assign "${l}"`);o.set.call(this,l??void 0),s.c&&je(this,cu)?.get(r)?.notify(),u.T.length>0&&(f1(),u?.S(r,l))}}}connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const r=this.constructor.K.c?.(()=>this.requestUpdate());$s(this,Tn,r);const i=!this.manager.connectedCalled;super.connectedCallback(),i?queueMicrotask(()=>fp(this,Dh,O8).call(this).catch(s=>{je(this,du).reject(s),setTimeout(()=>{throw s})})):r&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),je(this,Tn)?.destroy(),$s(this,Tn,void 0)}createRenderRoot(){const r=this.el.shadowRoot,i=this.constructor,s=i.shadowRootOptions,o=r??(s===zC?this.el:this.el.attachShadow(s));if(this.isConnected){const l=o.getRootNode();l.adoptedStyleSheets=[...l.adoptedStyleSheets,...i.elementStyles.map(u=>"styleSheet"in u?u.styleSheet:u)]}return o}shouldUpdate(r){var i;return this.manager.Q=r,((i=je(this,Zm))==null?void 0:i.call(this,r))??!0}update(r){je(this,Tn)?fp(this,Dh,E8).call(this,r):super.update(r)}listen(r,i,s){const n=i?.bind(this)??i;this.manager.onLifecycle(()=>(this.el.addEventListener(r,n,s),()=>this.el.removeEventListener(r,n,s)))}listenOn(r,i,s,n){const o=s?.bind(this)??s;this.manager.onLifecycle(()=>(r.addEventListener(i,o,n),()=>r.removeEventListener(i,o,n)))}async componentOnReady(){return await je(this,du).promise,this}addController(r){this.M.push(r),!(a3 in r)&&this.renderRoot&&this.el.isConnected&&r.hostConnected?.()}removeController(r){this.M.splice(this.M.indexOf(r),1),r.controllerRemoved?.()}};cu=new WeakMap,Zm=new WeakMap,Jm=new WeakMap,du=new WeakMap,Tn=new WeakMap,Dh=new WeakSet,E8=function(r){try{je(this,Tn).clear(),this.constructor.K.r(je(this,Tn),()=>X3(ym.prototype,this,"update").call(this,r))}catch(i){throw je(this,Tn).clear(),i}},O8=async function(){const r=this.el.G??S8(this.el);r&&await r;const i=[];for(const n of this.M)"triggerLoad"in n?i.push(n.triggerLoad()):i.push(k$(n.hostLoad,n));await Promise.all(i),await this.load?.(),this.manager.hasDestroy&&this.manager.onUpdate(n=>n.has(L$)&&this.manager.U()),je(this,Jm).call(this,!0),this.performUpdate(),this.I.resolve(),await Promise.resolve();const s=this.J.filter(n=>!n.manager?.loadedCalled);s.length&&await Promise.allSettled(s.map(async n=>await n.componentOnReady())),this.J.length=0,this.el.setAttribute(this.constructor.K.hydratedAttribute,"");for(const n of this.M)"triggerLoaded"in n?n.triggerLoaded():at(n.hostLoaded,n);this.loaded?.(),je(this,du).resolve()},ym.lumina=!0;let qC=ym;const Fde=t=>{let e;const r=s=>{e=new URL(s,globalThis.location?.href||void 0).href},i={...t,getAssetPath(s){const n=new URL(s,e);return n.origin!==globalThis.location?.origin?n.href:n.pathname},setAssetPath:r,customElement(s,n){n.K=i,n.L=s,customElements.get(s)||customElements.define(s,n)}};return r(t.defaultAssetPath),i},L3e=t=>typeof t=="object"&&t!=null?Cde(t):t,F3e=t=>typeof t=="object"&&t!=null?Ade(t):t,N3e=_t;function D3e(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}const j3e={toAttribute:t=>t===!0?"":t===!1?null:t},Nde="calcite-mode-auto",Dde="calcite-mode-dark",V3e={rtl:"calcite--rtl"},z3e={filter:250,nextTick:0,resize:150,reposition:100},U3e=25;function GC(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,r=()=>t.contains(Dde)||t.contains(Nde)&&e?"dark":"light",i=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),s=o=>{n!==o&&i(o),n=o};let n=r();i(n),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>s(o.matches?"dark":"light")),new MutationObserver(()=>s(r())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const cm=globalThis.calciteConfig,q3e=cm?.focusTrapStack||[],G3e=cm?.logLevel||"info",BC="3.3.3",jde="2025-10-08",Vde="7391af08e";function zde(){if(cm&&cm.version)return;console.info(`Using Calcite Components ${BC} [Date: ${jde}, Revision: ${Vde}]`);const t=cm||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:BC,writable:!1}),globalThis.calciteConfig=t}document.readyState==="interactive"?GC():document.addEventListener("DOMContentLoaded",GC,{once:!0});queueMicrotask(zde);const Ude=Fde({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.3.3/",hydratedAttribute:"calcite-hydrated"}),{customElement:B3e,getAssetPath:H3e,setAssetPath:qde}=Ude;let k8=!1;const Gde=t=>{k8=!0,qde(t)};let C8;function Bde(){k8||Gde(ls(ot(C8)))}function $y(t){const e=[];for(const r of Object.keys(t))customElements.get(`calcite-${r}`)||e.push(t[r]?.());return e.length>0?Promise.all(e):null}C8="components/assets";const P8=Symbol("widget"),A8=Symbol("widget-test-data"),Hde=[],Wde={},iw=new WeakMap;function R8(t,e){let r=e.children;if(r?.length)for(let s=0;s<r.length;++s)r[s]=R8(t,r[s]);else r=Hde;const i=e.vnodeSelector;if(sw(i)){const s=e.properties||Wde,n=s.key||i,o={key:n,afterCreate:Zde,afterUpdate:Jde,afterRemoved:L8,parentWidget:t,widgetConstructor:i,widgetProperties:{...s,key:n,children:r}};return{vnodeSelector:i.vnodeSelector,properties:o,children:void 0,text:void 0,domNode:null}}return e}function Zde(t,e,r,{parentWidget:i,widgetConstructor:s,widgetProperties:n}){const o=new s(n);o.container=t,iw.set(t,o),o.afterCreate?.(o,t),i.addHandles(Te(()=>L8(t))),queueMicrotask(()=>{o[A8].projector?.renderNow()})}function Jde(t,e,r,{widgetProperties:i}){const s=iw.get(t);s&&(s.set(i),s.afterUpdate?.(s,t))}function L8(t){const e=iw.get(t);e&&(e.afterRemoved?.(e,t),e.destroy(),iw.delete(t))}function sw(t){return typeof t=="function"&&t[P8]}const HC=new Set;function Yde(t){HC.add(t),t.finally(()=>HC.delete(t))}function Kde(t){return Te()}var WC;let Qde=0;function F8(t,e){const r=Object.prototype.hasOwnProperty;for(const i in e)r.call(e,i)&&r.call(t,i)&&(t[i]!=null&&e[i]!=null&&typeof t[i]=="object"&&typeof e[i]=="object"?F8(t[i],e[i]):t[i]=e[i]);return t}const Xde=Nce({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,r=/capture$/i;t.eventHandlerInterceptor=(i,s,n,o)=>{const l=e?.(i,s,n,o),u=r.test(i);if(!((i=i.replace(r,"")).toLowerCase()in n)||u){const d=i[2].toLowerCase()+i.slice(3),p=y=>l?.call(n,y);n.addEventListener(d,p,u);const f=()=>n.removeEventListener(d,p,u),m=o.afterRemoved;o.afterRemoved=y=>{m?.(y),f()}}return l}},handleInterceptedEvent(t,e,r,i){const{eventPhase:s,type:n}=i,o=s===Event.CAPTURING_PHASE;let l=`on${n}${o?"capture":""}`;const u=e.properties;(u&&l in u||(l=`on${n[0].toUpperCase()}${n.slice(1)}${o?"Capture":""}`,u&&l in u))&&(d8(),t.scheduleRender(),u[l].call(u.bind||r,i))}});let Hb=!1;var Tu;let Xt=(Tu=class extends PT(Yh){constructor(e,r){super(e,r),this._attached=!1,this._projector=Xde,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=gT(async()=>{if(this._messageBundleProps?.length){const u=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:d,propertyName:p})=>{if(this.destroyed)return;let f=await mF(d);this.destroyed||(this.uiStrings&&Object.keys(this.uiStrings)&&(f=F8(E(f),this.uiStrings)),this[p]=f)}));if(this.destroyed)return;for(const d of u)d.status==="rejected"&&L.getLogger(this).error("widget-intl:locale-error",this.declaredClass,d.reason)}await this.loadLocale()}),this.addHandles(Kde()),Bde();const i="esri-widget-uid-"+rp(),s=this.render.bind(this);this._trackingTarget=new _w(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const n=()=>({vnodeSelector:"div",properties:{key:`${i}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),o=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const u=s()??n(),d=u.properties??={};if(d.key??=i,sw(u.vnodeSelector)){if(!this.visible)return n()}else this.visible?d.styles||(d.styles={}):(d.class="",d.styles={display:"none"}),d.styles.display??="";let p=0;return u.children?.forEach(f=>{sw(f.vnodeSelector)||(f.properties??={},f.properties.key??=`${this.id}--${p++}`)}),R8(this,u)};this.render=()=>{if(Hb)return o();let u=$ce(this)??null;if(u)return u;this._trackingTarget.clear(),Hb=!0;try{u=zo(this._trackingTarget,o)}catch(d){throw L.getLogger(this).error(d),d}finally{Hb=!1}return u&&xce(this,u),u};const l=this.beforeFirstRender();l?this._resourcesFetch=l.then(()=>{this.destroyed||(this._readyForTrueRender=!0,this._postInitialize())}):(this._resourcesFetch=Promise.resolve().then(()=>{this.destroyed||this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),Yde(this._resourcesFetch)}normalizeCtorArgs(e,r){const i={...e};return r&&(i.container=r),i}postInitialize(){}beforeFirstRender(){const e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(dI):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(Ke(this._trackingTarget),Ke(this.viewModel),this._detach(this.container),this._set("container",null),this.render=()=>null,this._projector=null,Ub(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return TM(e)}get destroyed(){return super.destroyed}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+Qde++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(WC=P8,A8)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(Ub(this),this._projector.scheduleRender())}classes(...e){return Tce.apply(this,e)}renderNow(){Ub(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(ne(()=>this.viewModel,(r,i)=>{i&&this.removeHandles("delegated-events"),r&&gw(r)&&this.addHandles(this._delegatedEventNames.map(s=>qh(r,s,n=>{this.emit(s,n)})),"delegated-events")},Tr)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(dI),this.scheduleRender()};this.addHandles([hF(e),ne(()=>this.uiStrings,e)]),this.addHandles(Gi(()=>this.container,r=>{this.destroyed||this._attach(r)},{initial:!0,once:!0}))}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}},Tu[WC]=!0,Tu.vnodeSelector="div",Tu);a([c()],Xt.prototype,"_readyForTrueRender",void 0),a([c({value:null})],Xt.prototype,"container",null),a([Ce("container")],Xt.prototype,"castContainer",null),a([c()],Xt.prototype,"icon",null),a([c()],Xt.prototype,"id",null),a([c()],Xt.prototype,"label",null),a([c()],Xt.prototype,"renderable",null),a([c()],Xt.prototype,"uiStrings",void 0),a([c()],Xt.prototype,"viewModel",void 0),a([c({value:!0})],Xt.prototype,"visible",null),a([c()],Xt.prototype,"key",void 0),a([c()],Xt.prototype,"children",void 0),a([c()],Xt.prototype,"afterCreate",void 0),a([c()],Xt.prototype,"afterUpdate",void 0),a([c()],Xt.prototype,"afterRemoved",void 0),Xt=a([b("esri.widgets.Widget")],Xt);const ap=Xt,ehe=new Map;function the(t){return ehe.get(t)}function ZC(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function rhe(t,e){return t.length!==e.length||t.some((r,i)=>r.text!==e[i].text)}function mg(t,e,r){!r||!e||t.find(i=>i.layerView===e&&i.text===r)||t.push({text:r,layerView:e})}function ihe(t){return t.type==="bing-maps"}const an=[];let Uc=class extends X{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new H,this.view=null,this._allLayerViewsChange=r=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const i=this.view?.allLayerViews;i&&(this.addHandles(i.map(s=>ne(()=>[s.suspended,s.layer?.attributionVisible],()=>this._updateAttributionItems())).toArray(),"suspension"),i.forEach(s=>{s.declaredClass==="esri.views.3d.layers.IntegratedMesh3DTilesLayerView3D"&&this.addHandles(s.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),r?.removed&&r.removed.forEach(s=>{this._pendingAttributions.delete(s),this._fetchedAttributionData.delete(s)}),this._updateAttributionItems()},this.addHandles([Fu(()=>this.view?.allLayerViews,"change",r=>this._allLayerViewsChange(r),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),Gi(()=>this.view?.stationary===!0,()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,r=e?.allLayerViews;an.length=0;let i=!1,s=null;if(!e||!r)return void this._clear();r.forEach(o=>{if(o.suspended||!o.layer?.attributionVisible)return;const l=o.layer;if(ZC(l,"user"))return void mg(an,o,l.copyright);if(l.type==="integrated-mesh-3dtiles"&&l.hasGoogleUrl&&(i=!0,s=o),l.hasAttributionData){if(this._fetchedAttributionData.has(o)){const d=this._fetchedAttributionData.get(o);return void(d?mg(an,o,this._getDynamicAttribution(d,e,l)):ZC(l)&&mg(an,o,l.copyright))}return void this._fetchAttributionData(o)}const u="portalItem"in l?l.portalItem?.accessInformation:void 0;mg(an,o,u||l.copyright)});const n=r.find(o=>o.layer?.type==="integrated-mesh-3dtiles");if(this.view&&n){const o=the(this.view);if(o){const l=o.getAttributionText();for(let u=l.length-1;u>-1;--u)an.unshift({text:l[u],layerView:n})}}i&&s&&an.unshift({text:"Google Maps",layerView:s}),rhe(this.items,an)&&(this.items.removeAll(),this.items.addMany(an)),an.length=0,this.notifyChange("state")}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const r=await Tw(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const i=r.ok?this._createContributionIndex(r.value,ihe(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,i)}this._updateAttributionItems()}_createContributionIndex(e,r){const i=e.contributors,s={};if(!i)return s;for(let n=0;n<i.length;n++){const o=i[n],l=o.coverageAreas;if(!l)return;for(const u of l){const d=u.bbox,p=u.zoomMin-(r&&u.zoomMin?1:0),f=u.zoomMax-(r&&u.zoomMax?1:0),m=new he({xmin:d[1],ymin:d[0],xmax:d[3],ymax:d[2],spatialReference:Z.WGS84}),y={extent:za(m),attribution:o.attribution||"",score:u.score!=null?u.score:100,id:n};for(let g=p;g<=f;g++)s[g]??=[],s[g].push(y)}}return s.maxKey=Math.max.apply(null,Object.keys(s)),s}_getDynamicAttribution(e,r,i){const{extent:s,scale:n}=r;let o=i.tileInfo?.scaleToZoom(n)??0;if(o=Math.min(e.maxKey??0,Math.round(o)),!s||o==null||o<=-1)return"";const l=e[o],u=Ow(s.center.clone().normalize(),Z.WebMercator),d=new Set;return l?l.filter(p=>{const f=p.id,m=!d.has(f)&&u&&p.extent&&sy(p.extent,u);return m&&d.add(f),m}).sort((p,f)=>f.score-p.score||p.objectId-f.objectId).map(p=>p.attribution).join(", "):""}};a([c({readOnly:!0,type:H})],Uc.prototype,"items",void 0),a([c({readOnly:!0})],Uc.prototype,"state",null),a([c()],Uc.prototype,"view",void 0),Uc=a([b("esri.widgets.Attribution.AttributionViewModel")],Uc);const N8=Uc,ms={button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",empty:"esri-widget__content--empty",heading:"esri-widget__heading",interactive:"esri-interactive",panel:"esri-widget--panel",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button"};function she(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:ohe(t[e])}}}function nhe(t){const e=t?.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function ohe(t){return function(e,...r){nhe(e)?Ice(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...r)}}function Vu(t){return(e,r)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:r})}}var ahe=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},D8=function(t,e){for(var r=0,i=t.length;r<i;r++){var s=t[r];Array.isArray(s)?D8(s,e):s!=null&&s!==!1&&(s.hasOwnProperty("vnodeSelector")||(s=ahe(s)),e.push(s))}},lhe=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(r.length===1&&typeof r[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:r[0],domNode:null};var s=[];return D8(r,s),{vnodeSelector:t,properties:e||void 0,children:s,text:void 0,domNode:null}};function Ie(t,e,...r){return typeof t!="function"||sw(t)?lhe(t,e??null,...r):t(e,...r)}function Z3e(...t){return t}const dc="esri-attribution",hc={base:dc,poweredBy:`${dc}__powered-by`,sources:`${dc}__sources`,open:`${dc}--open`,sourcesOpen:`${dc}__sources--open`,link:`${dc}__link`};let Dr=class extends ap{constructor(e,r){super(e,r),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._sourcesNode=null,this._overflowRequestAnimationFrame=null,this._resizeObserver=new ResizeObserver(i=>{i.forEach(({target:s})=>{this._scheduleOverflowCheck(s)})}),this._mutationObserver=new MutationObserver(i=>{let s=!1;for(const n of i)if(n.type==="childList"||n.type==="characterData"||n.type==="attributes"){s=!0;break}s&&this._sourcesNode&&this._scheduleOverflowCheck(this._sourcesNode)}),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new N8}initialize(){this.addHandles(Fu(()=>this.viewModel?.items,"change",()=>this.scheduleRender()))}destroy(){this._resizeObserver?.disconnect(),this._mutationObserver?.disconnect(),this._overflowRequestAnimationFrame!=null&&(cancelAnimationFrame(this._overflowRequestAnimationFrame),this._overflowRequestAnimationFrame=null)}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}_scheduleOverflowCheck(e){this._overflowRequestAnimationFrame==null&&(this._overflowRequestAnimationFrame=requestAnimationFrame(()=>{this._overflowRequestAnimationFrame=null,this._checkSourceTextOverflow(e)}))}get attributionText(){return this.viewModel.items.reduce((e,r)=>(e.includes(r.text)||e.push(r.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[hc.open]:this._isOpen};return Ie("div",{bind:this,class:this.classes(hc.base,ms.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return Ie("div",{class:hc.poweredBy},"Powered by"," ",Ie("a",{class:hc.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,r=this._isInteractive,i=r?0:void 0,{attributionText:s}=this,n={[hc.sourcesOpen]:e,[ms.interactive]:r};return Ie("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(hc.sources,n),innerHTML:s,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._sourcesNode=e,this._resizeObserver.observe(e),this._mutationObserver.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0}),this._scheduleOverflowCheck(e)}_checkSourceTextOverflow(e){let r=!1;const{clientHeight:i,clientWidth:s,scrollWidth:n}=e,o=n>s,l=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,l&&(r=!0),this._isOpen){const u=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,u&&(this._isOpen=!1,r=!0)}r&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};a([c()],Dr.prototype,"_isOpen",void 0),a([c()],Dr.prototype,"_isInteractive",null),a([c()],Dr.prototype,"_attributionTextOverflowed",void 0),a([c()],Dr.prototype,"_prevSourceNodeHeight",void 0),a([c({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],Dr.prototype,"attributionText",null),a([c()],Dr.prototype,"icon",null),a([c()],Dr.prototype,"itemDelimiter",void 0),a([c()],Dr.prototype,"label",null),a([c(),Vu("esri/widgets/Attribution/t9n/Attribution")],Dr.prototype,"messages",void 0),a([c()],Dr.prototype,"view",null),a([c({type:N8})],Dr.prototype,"viewModel",void 0),a([she()],Dr.prototype,"_toggleState",null),Dr=a([b("esri.widgets.Attribution")],Dr);const uhe=Dr;function che(){const t=k("mapview-essential-goto-duration");return t==null?t:t}function dhe(t){return t?.spatialReference?.isWebMercator||t?.spatialReference?.isGeographic||!1}function hhe(t,e,r){return t.goTo(e,r)}const j8=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:s}=this;return TR(s),this.goToOverride?this.goToOverride(s,i):hhe(s,i.target,i.options)}};return a([c()],r.prototype,"goToOverride",void 0),a([c()],r.prototype,"view",void 0),r=a([b("esri.widgets.support.GoTo")],r),r};let Ul=class extends j8(X){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(Ot)}destroy(){this.view=null}get canShowNorth(){return dhe(this.view)}get state(){return!this.view?.ready||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&(this.view?.type==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:che()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const r=-e.heading;this._set("orientation",{x:0,y:0,z:r})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles(e.type==="2d"?ne(()=>e?.rotation,this._updateForRotation,Ot):ne(()=>e?.camera,this._updateForCamera,Ot))}_watchForView(e){this.addHandles(ne(()=>this.view,this._updateRotationWatcher,e))}};a([c({readOnly:!0})],Ul.prototype,"canShowNorth",null),a([c({readOnly:!0})],Ul.prototype,"orientation",void 0),a([c({readOnly:!0})],Ul.prototype,"state",null),a([c()],Ul.prototype,"view",void 0),Ul=a([b("esri.widgets.Compass.CompassViewModel")],Ul);const V8=Ul,JC="esri-compass",YC={base:JC,iconContainer:`${JC}__icon-container`};let oo=class extends ap{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new V8,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=i=>({transform:`rotateZ(${i.z}deg)`})}loadDependencies(){return $y({button:()=>N(()=>import("./index-BsUKe-uf.js"),__vite__mapDeps([298,299,300,301,302,303,304,305,306,307,308,309,310,311,312])),icon:()=>N(()=>import("./index-BzVuEUWK.js").then(e=>e.i),__vite__mapDeps([303,304,305]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:r}=this.viewModel,{messages:i}=this;return Ie("div",{class:this.classes(YC.base,ms.widget)},Ie("calcite-button",{class:ms.widgetButton,disabled:r==="disabled",kind:"neutral",label:i.reset,onclick:this._reset,round:!0,scale:"s",title:i.reset},Ie("div",{"aria-hidden":"true",class:YC.iconContainer,title:i.reset},Ie("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};a([c()],oo.prototype,"goToOverride",null),a([c()],oo.prototype,"icon",null),a([c()],oo.prototype,"label",null),a([c(),Vu("esri/widgets/Compass/t9n/Compass")],oo.prototype,"messages",void 0),a([c()],oo.prototype,"view",null),a([c({type:V8})],oo.prototype,"viewModel",void 0),oo=a([b("esri.widgets.Compass")],oo);const phe=oo,KC="esri-navigation-toggle",QC={base:KC,isLayoutHorizontal:`${KC}--horizontal`};let qc=class extends X{constructor(e){super(e),this._navigationMode="pan",this.view=null,e?.isDefaultViewModel||J7(L.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.33"})}normalizeCtorArgs(e={}){const{isDefaultViewModel:r,...i}=e;return i}initialize(){this.addHandles(Gi(()=>this.view?.navigation?.actionMap,()=>this._updateNavigationActionMap()))}destroy(){this.view=null}get state(){return this.view?.ready&&this.view?.type==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(e){this._navigationMode=e,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){const e=this.view?.navigation?.actionMap;if(!e)return;const r=this._navigationMode==="pan";e.dragPrimary=r?"pan":"rotate",e.dragSecondary=r?"rotate":"pan"}};a([c({readOnly:!0})],qc.prototype,"state",null),a([c()],qc.prototype,"_navigationMode",void 0),a([c()],qc.prototype,"view",void 0),qc=a([b("esri.widgets.NavigationToggle.NavigationToggleViewModel")],qc);const z8=qc;let ao=class extends ap{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new z8({isDefaultViewModel:!0}),this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const i=this.viewModel?.navigationMode==="pan"?this._rotateButton:this._panButton;Ece(i),this.toggle()},e?.isDefaultUI||jR(L.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.32"})}normalizeCtorArgs(e={}){const{isDefaultUI:r,...i}=e;return i}loadDependencies(){return $y({button:()=>N(()=>import("./index-BsUKe-uf.js"),__vite__mapDeps([298,299,300,301,302,303,304,305,306,307,308,309,310,311,312]))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.viewModel?.state==="disabled",r=this.viewModel?.navigationMode==="pan",i=this.messages.toggle;return Ie("div",{class:this.classes(QC.base,ms.widget,{[QC.isLayoutHorizontal]:this.layout==="horizontal"})},Ie("calcite-button",{afterCreate:s=>{this._panButton=s},appearance:r?"outline-fill":"solid",class:ms.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:r?void 0:-1,title:i}),Ie("calcite-button",{afterCreate:s=>{this._rotateButton=s},appearance:r?"solid":"outline-fill",class:ms.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:r?-1:void 0,title:i}))}};a([c()],ao.prototype,"icon",null),a([c()],ao.prototype,"label",null),a([c({value:"vertical"})],ao.prototype,"layout",null),a([c(),Vu("esri/widgets/NavigationToggle/t9n/NavigationToggle")],ao.prototype,"messages",void 0),a([c()],ao.prototype,"view",null),a([c({type:z8})],ao.prototype,"viewModel",void 0),ao=a([b("esri.widgets.NavigationToggle")],ao);const fhe=ao;let ql=class extends X{get canZoomIn(){if(!this.view?.ready)return!1;const r=this.view?.constraints?.effectiveMaxScale;return r===0||this._scale>r}get canZoomOut(){const{view:e}=this;if(!e?.ready)return!1;const i=e.constraints?.effectiveMinScale;return i===0||this._scale<i}get _scale(){const e=this.view?.animation?.target;return(e&&"then"in e?void 0:e?.scale)??this.view?.scale??0}};a([c({readOnly:!0})],ql.prototype,"canZoomIn",null),a([c({readOnly:!0})],ql.prototype,"canZoomOut",null),a([c()],ql.prototype,"view",void 0),a([c()],ql.prototype,"_scale",null),ql=a([b("esri.widgets.Zoom.ZoomConditions2D")],ql);const mhe=ql;let Gc=class extends X{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};a([c({readOnly:!0})],Gc.prototype,"canZoomIn",null),a([c({readOnly:!0})],Gc.prototype,"canZoomOut",null),a([c()],Gc.prototype,"view",void 0),Gc=a([b("esri.widgets.Zoom.ZoomConditions3D")],Gc);const yhe=Gc;let fa=class extends X{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){return this._zoomConditions!=null&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new mhe({view:e}):e.type==="3d"&&(this._zoomConditions=new yhe({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&(e.type==="2d"?e.mapViewNavigation.zoomIn():vh(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&(e.type==="2d"?e.mapViewNavigation.zoomOut():vh(e.goTo({zoomFactor:.5})))}};a([c()],fa.prototype,"_zoomConditions",void 0),a([c()],fa.prototype,"canZoomIn",null),a([c()],fa.prototype,"canZoomOut",null),a([c({readOnly:!0})],fa.prototype,"state",null),a([c()],fa.prototype,"view",null),fa=a([b("esri.widgets.Zoom.ZoomViewModel")],fa);const U8=fa,XC={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let lo=class extends ap{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new U8,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return $y({button:()=>N(()=>import("./index-BsUKe-uf.js"),__vite__mapDeps([298,299,300,301,302,303,304,305,306,307,308,309,310,311,312]))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[XC.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:r,canZoomOut:i}=this.viewModel,{zoomIn:s,zoomOut:n}=this.messages;return Ie("div",{class:this.classes(XC.base,ms.widget,e)},Ie("calcite-button",{class:ms.widgetButton,disabled:!r,iconStart:"plus",kind:"neutral",label:s,onclick:this.zoomIn,title:s}),Ie("calcite-button",{class:ms.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:n,onclick:this.zoomOut,title:n}))}};a([c()],lo.prototype,"icon",null),a([c()],lo.prototype,"label",null),a([c({value:"vertical"})],lo.prototype,"layout",null),a([c(),Vu("esri/widgets/Zoom/t9n/Zoom")],lo.prototype,"messages",void 0),a([c()],lo.prototype,"view",null),a([c({type:U8})],lo.prototype,"viewModel",void 0),lo=a([b("esri.widgets.Zoom")],lo);const ghe=lo;function vhe(t){return t?.view!==void 0}let P0=class extends Cce{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=r=>{this.components.forEach(i=>{const s=this._find(i),n=s?.widget;vhe(n)&&(n.view=r)})},this._componentsWatcher=(r,i)=>{this._removeComponents(i),this._addComponents(r),this._adjustPadding(r)}}initialize(){this.addHandles([ne(()=>this.components,this._componentsWatcher,Ot),ne(()=>this.view,this._updateViewAwareWidgets,Ot)])}_add(e,r,i,s,n){let o=e;if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;o=this._createComponent(e)}super._add(o,r,i,s,n)}_removeComponents(e){e.forEach(r=>{const i=this._find(r);i&&(this.remove(i),i.destroy())})}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:r}=this.padding;this.padding=r}}_addComponents(e){this.constructed&&e.forEach(r=>this.add(this._createComponent(r),this._defaultPositionLookup[r]))}_createComponent(e){const r=this._createWidget(e);return new O0({id:e,node:r})}_createWidget(e){const r=this.view;switch(e){case"attribution":return new uhe({view:r});case"compass":return new phe({view:r});case"navigation-toggle":return new fhe({view:r,isDefaultUI:!0});case"zoom":return new ghe({view:r})}}};a([c()],P0.prototype,"components",void 0),P0=a([b("esri.views.ui.DefaultUI")],P0);const q8=P0;let A0=class extends q8{constructor(e){super(e),this.components=["attribution","zoom"]}};a([c()],A0.prototype,"components",void 0),A0=a([b("esri.views.ui.2d.DefaultUI2D")],A0);const G8=A0;let whe=class{constructor(e={},r={},i=8,s=1/0){this.disabledExtensions=e,this.debugWebGLExtensions=r,this.maxAnisotropy=i,this.maxPreferredTexturePixels=s}},B8=class F${constructor(e,r,i=""){this.major=e,this.minor=r,this._context=i}lessThan(e,r){return this.major<e||e===this.major&&this.minor<r}greaterEqual(e,r){return!this.lessThan(e,r)}validate(e){if(this.major!==e.major){const r=this._context&&this._context+":",i=this._context&&this._context+" ";throw new x(r+"unsupported-version",`Required major ${i}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new F$(this.major,this.minor,this._context)}static parse(e,r=""){const[i,s]=e.split("."),n=/^\s*\d+\s*$/;if(!i?.match||!n.test(i))throw new x((r&&r+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!s?.match||!n.test(s))throw new x((r&&r+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const o=parseInt(i,10),l=parseInt(s,10);return new F$(o,l,r)}},bhe=class extends B8{constructor(e,r){super(e,r,"webmap")}};function Wb(t){return t!=null&&typeof t=="object"&&"declaredClass"in t&&t.declaredClass==="esri.WebMap"}new bhe(2,35);var N$;let R0=N$=class extends F{constructor(t){super(t),this.color=new ue([0,0,0,1])}clone(){return new N$(E({color:this.color}))}};a([c({type:ue,json:{write:!0}})],R0.prototype,"color",void 0),R0=N$=a([b("esri.webmap.background.ColorBackground")],R0);const _he=R0;let H8,W8,Z8,J8,Y8,K8,Q8;async function She(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:r,MapViewNavigation:i,MagnifierView2D:s,GridView2D:n,Stage:o}]=await Promise.all([N(()=>import("./webglDeps-BNJ663uh.js"),__vite__mapDeps([194,161,195,196,197,4,55])),N(()=>import("./mapViewDeps-BvkAy0z3.js"),__vite__mapDeps([198,123,92,93,87,31,4,94,91,95,84,199,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,204,96,97,205,206,21,194,207,108,208,209,140,210,150,151,211,72,82,86,38,37,212,98,213,90,15,16,17,214,100,105,80,215,216,217,218,157,219,220]))]);W8=t,Z8=e,J8=r,Y8=i,K8=s,Q8=n,H8=o}var lh;let be=(lh=class extends ule(Voe(fee(jte(xte(pne))))){get timeZone(){return super.timeZone}set timeZone(e){super.timeZone=e}constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new Zs({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new s1({actionMap:new HM({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.analyses=new Ch,this.analysisViewManager=new nce({importAnalysisViewModule:r=>Qle(r),view:this}),this.floors=new H,this.grid=null,this.map=null,this.timeline=new a8,this.type="2d",this.view2dType=null,this.ui=new G8,this.animationsEnabled=!0,this.test={takeScreenshot:async r=>ece(this._getScreenshotView(r),r)},this.padding={top:0,right:0,bottom:0,left:0},cee()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=Ke(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new lue(this.featuresTilingScheme)}get constraintsInfo(){const e=this.defaultsFromMap?.tileInfo,r=this.spatialReference;return{lods:e?.spatialReference?.equals(r)?e.lods:null,spatialReference:r}}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:e,constraints:r,center:i,viewpoint:s,extent:n}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!n&&(r?.effectiveLODs||(o=-1),(!i||e===0&&o===-1)&&(s?.targetGeometry==null||s.targetGeometry.type!=="extent"&&!s.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const r=e.targetGeometry,i=this.spatialReference;return ZN(r.spatialReference,i)}get background(){return Wb(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){return this.stateManager?.center??null}set center(e){this.stateManager.center=e}get constraints(){return super.constraints}set constraints(e){super.constraints=e}get highlightOptions(){return Due(this)}set highlightOptions(e){jue(this,e)}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){return this.stage?.renderRequested??!1}get resizeAlign(){return super.resizeAlign}set resizeAlign(e){super.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return super.rotation}set rotation(e){super.rotation=e}get scale(){return this.stateManager?.scale??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get spatialReference(){return super.spatialReference}set spatialReference(e){super.spatialReference=e}get spatialReferenceLocked(){return this._get("spatialReferenceLocked")}set spatialReferenceLocked(e){this.stage&&L.getLogger(this).warn("spatialReferenceLocked cannot be changed after the view has become ready"),this._set("spatialReferenceLocked",e)}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const e=!(!this.magnifier.visible||this.magnifier.position===null||!this._magnifierView?.updatingHandles.updating),r=!this.destroyed&&(!this.analysisViewManager||!this.layerViewManager||!this.labelManager||!this.graphicsView||this.analysisViewManager.updating===!0||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(i=>!i.destroyed&&!("layerViews"in i)&&i.updating===!0)||e);if(k("esri-2d-log-updating")){const i=this.allLayerViews.reduce((s,n)=>({...s,[`${n.layer.id}(${n.layer.type})`]:!n.destroyed&&!("layerViews"in n)&&n.updating}),{});console.log(`Updating MapView: ${r}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${this.layerViewManager?.updating}
-> labelManager.updating: ${this.labelManager?.updating}
-> graphicsView.updating: ${this.graphicsView?.updating}
-> allLayerViews: ${JSON.stringify(i)}
-> updatingMagnifier: ${e}
`)}return r}get viewpoint(){return super.viewpoint}set viewpoint(e){super.viewpoint=e}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new Be({rings:[e.map(r=>[r[0],r[1]])],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return this.mapViewNavigation?.interacting??!1}async hitTest(e,r){return Vue(this,e,r)}async takeScreenshot(e){return Xue(this._getScreenshotView(e),e)}toScreen(e,r){return this.stateManager.toScreen(e,r)}async whenAnalysisView(e){if(e.parent==null)throw new x("view:no-analysisview-for-analysis","The analysis does not exist in view.analyses",{analysis:e});return this.analysisViewManager.whenAnalysisView(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return Wb(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return Wb(this.map)?this.map.initialViewProperties.timeExtent:null}getSurface(){return this.surface}hasLayerViewModule(e){return uC.hasLayerViewModule(e)}importLayerView(e){return uC.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(L.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){const r=this.toMap(e),i=await this.hitTest(e),s=this.allLayerViews.toArray().filter(d=>d.clips.every(p=>Y6(this,p,e,r))).reverse(),n=new globalThis.Map(s.map(d=>[d.layer.uid,d])),o=[];let l=0,u=0;for(;l<i.results.length||u<s.length;){const d=i.results.at(l);if(d&&d.type!=="graphic"){++l;continue}const p=n.get((d?.layer??d?.graphic.layer)?.uid);if((!d||p)&&u<s.length&&s.at(u)!==p){const f=s.at(u);"fetchPopupFeaturesAtLocation"in f&&o.push({mapPoint:r,layerView:f}),++u}else d&&(o.push({graphic:d.graphic,layerView:p}),++l)}return{hits:o,location:r}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=hce(this.type);if(k("safari")&&k("safari")<9&&(e=new x("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:k("safari")})),e!=null)throw L.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return She()}_getDefaultViewpoint(){const{constraints:e,initialExtent:r,map:i,padding:s,size:n}=this;if(!e)return null;const o=i&&"initialViewProperties"in i?i.initialViewProperties:void 0,l=this.stateManager.getUserStartupOptions(this.size),u=o?.viewpoint,d=u?.targetGeometry?.extent??r,p=d?.center,f=u?.rotation??0,m=u?.scale||d&&o1(d,[n[0]-s.left-s.right,n[1]-s.top-s.bottom]),y=l.center??p,g=l.rotation??f,v=l.scale??m;return y&&v?new fs({targetGeometry:y,scale:v,rotation:g}):null}_startup(){this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const r=new Xle(this.surface),i=new H8(this.surface,{canvas:this.renderCanvas,contextOptions:new whe(this.deactivatedWebGLExtensions,this.debugWebGLExtensions),renderingOptions:this.renderingOptions,timeline:this.timeline},r);this.stage=i,this._magnifierView=new K8,this._magnifierView.magnifier=this.magnifier,this._gridView=new Q8;const s=new J8({view:this});this._set("labelManager",s);const n=new zle({view:this});this._set("animationManager",n);const o=new Y8({view:this,animationManager:n});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),i.on("webgl-error",u=>this.fatalError=u.error),ne(()=>this.stationary,u=>i.stationary=u,Tr),ne(()=>this.background,u=>{i.backgroundColor=u?.color,this._magnifierView.backgroundColor=u?.color},Tr),ne(()=>this.magnifier,u=>this._magnifierView.magnifier=u,Tr),ne(()=>this.grid,u=>this._gridView.grid=u,Tr),ne(()=>this.renderingOptions,u=>i.renderingOptions=u,Tr),ne(()=>this.highlights.items.map(u=>({name:u.name,options:{fillColor:u.color,haloColor:u.haloColor,fillOpacity:u.fillOpacity,haloOpacity:u.haloOpacity,haloWidth:u.haloWidth,haloBlur:u.haloBlur}})),()=>{i.highlightGradient=Fue(i.highlightGradient,this.highlights.items)},Tr),ne(()=>this.state.id,()=>i.state=this.state,Tr),ne(()=>this.animationsEnabled,u=>{this.stage.animationsEnabled=u},Tr)],"map-view"),this._updateStageChildren();const l=this._resolveWhenReady;this._resolveWhenReady=[],l.forEach(u=>u(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(r=>{this.stage.addChild(r.container)});const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new Wle(Nr.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const r=new W8({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new Z8(e)});this._set("graphicsView",r)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){const{allLayerViews:r,padding:i,size:s,stage:n}=this;return{allLayerViews:r,backgroundColor:e?.ignoreBackground?null:this.background?.color,padding:i,size:s,stage:n}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const r of this.allLayerViews)r.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const r of this.allLayerViews)r.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}},lh.type="2d",lh);a([c({constructOnly:!0})],be.prototype,"deactivatedWebGLExtensions",void 0),a([c({constructOnly:!0})],be.prototype,"debugWebGLExtensions",void 0),a([c({readOnly:!0})],be.prototype,"featuresTilingScheme",void 0),a([c({readOnly:!0})],be.prototype,"graphicsTileStore",null),a([c()],be.prototype,"graphicsView",void 0),a([c()],be.prototype,"constraintsInfo",null),a([c()],be.prototype,"initialExtentRequired",null),a([c()],be.prototype,"labelManager",void 0),a([c({type:s1,nonNullable:!0})],be.prototype,"navigation",void 0),a([c({constructOnly:!0})],be.prototype,"renderCanvas",void 0),a([c()],be.prototype,"renderingOptions",void 0),a([c({constructOnly:!0})],be.prototype,"supersampleScreenshotsEnabled",void 0),a([c()],be.prototype,"defaultsFromMapSettings",null),a([c({readOnly:!0})],be.prototype,"typeSpecificPreconditionsReady",null),a([c(FS(Ch,"analyses"))],be.prototype,"analyses",void 0),a([c()],be.prototype,"analysisViewManager",void 0),a([c({type:_he})],be.prototype,"background",null),a([c()],be.prototype,"center",null),a([c({type:H})],be.prototype,"floors",void 0),a([c()],be.prototype,"grid",void 0),a([c({type:qa})],be.prototype,"highlightOptions",null),a([c()],be.prototype,"map",void 0),a([c()],be.prototype,"padding",null),a([c({readOnly:!0})],be.prototype,"rendering",null),a([c({readOnly:!0})],be.prototype,"resolution",null),a([c()],be.prototype,"scale",null),a([c({type:Boolean,value:!1})],be.prototype,"spatialReferenceLocked",null),a([c({readOnly:!0})],be.prototype,"tileInfo",null),a([c({type:a8,readOnly:!0})],be.prototype,"timeline",void 0),a([c({readOnly:!0})],be.prototype,"type",void 0),a([c({readOnly:!0})],be.prototype,"updating",null),a([c({readOnly:!0})],be.prototype,"view2dType",void 0),a([c({readOnly:!0})],be.prototype,"visibleArea",null),a([c()],be.prototype,"zoom",null),a([c({readOnly:!0})],be.prototype,"navigating",null),a([c(),Ce(t=>t instanceof q8?t:Zh(G8,t))],be.prototype,"ui",void 0),a([c()],be.prototype,"animationsEnabled",void 0),be=a([b("esri.views.View2D")],be);const $he=be;let L0=class extends $he{constructor(e){super(e),this.view2dType="map"}};a([c({readOnly:!0})],L0.prototype,"view2dType",void 0),L0=a([b("esri.views.MapView")],L0);const xhe=L0;let The=class X8{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(E_),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const r=new X8,i=this._originStores[0];i&&i.forEach((s,n)=>{r.set(n,E(s),0)});for(let s=2;s<E_;s++){const n=this._originStores[s];n&&n.forEach((o,l)=>{e&&e.has(l)||r.set(l,E(o),s)})}return r}get(e,r){const i=r===void 0?this._values:this._originStores[r];return i?i.get(e):void 0}keys(e){const r=e==null?this._values:this._originStores[e];return r?[...r.keys()]:[]}set(e,r,i=7){let s=this._originStores[i];if(s||(s=new Map,this._originStores[i]=s),s.set(e,r),!this._values.has(e)||this._propertyOriginMap.get(e)<=i){const n=this._values.get(e);return this._values.set(e,r),this._propertyOriginMap.set(e,i),n!==r}return!1}delete(e,r=7){const i=this._originStores[r];if(!i)return;const s=i.get(e);if(i.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===r){this._values.delete(e);for(let n=r-1;n>=0;n--){const o=this._originStores[n];if(o&&o.has(e)){this._values.set(e,o.get(e)),this._propertyOriginMap.set(e,n);break}}}return s}has(e,r){const i=r===void 0?this._values:this._originStores[r];return!!i&&i.has(e)}revert(e,r){for(;r>0&&!this.has(e,r);)--r;const i=this._originStores[r],s=i?.get(e),n=this._values.get(e);return this._values.set(e,s),this._propertyOriginMap.set(e,r),n!==s}originOf(e){return this._propertyOriginMap.get(e)||0}isAtOrigin(e,r){return this.has(e,r)&&this.originOf(e)===r}isBelowOrigin(e,r){return!this.has(e)||this.originOf(e)<r}forEach(e){this._values.forEach(e)}};const e9=t=>{const e=t;let r=class extends e{constructor(...i){super(...i);const s=Xr(this),n=s.store,o=new The;s.store=o,kL(s,n,o)}read(i,s){PL(this,i,s)}getAtOrigin(i,s){const n=Zb(this),o=Co(s);if(typeof i=="string")return n.get(i,o);const l={};return i.forEach(u=>{l[u]=n.get(u,o)}),l}originOf(i){return wm(this.originIdOf(i))}originIdOf(i){return Zb(this).originOf(i)}revert(i,s){const n=Zb(this),o=Co(s),l=Xr(this);let u;u=typeof i=="string"?i==="*"?n.keys(o):[i]:i,u.forEach(d=>{l.invalidate(d),n.revert(d,o),l.commit(d)})}};return r=a([b("esri.core.ReadOnlyMultiOriginJSONSupport")],r),r};function Zb(t){return Xr(t).store}e9(X);const Mhe=t=>{const e=t;let r=class extends e{constructor(...i){super(...i)}clear(i,s="user"){Xr(this).clearOrigin(i,Co(s))}write(i,s){return RL(this,i=i||{},s),i}setAtOrigin(i,s,n){Xr(this).setAtOrigin(i,s,Co(n))}removeOrigin(i){const s=eP(this),n=Co(i),o=s.keys(n);for(const l of o)s.originOf(l)===n&&s.set(l,s.get(l,n),7)}updateOrigin(i,s){const n=eP(this),o=Co(s),l=Ys(this,i);for(let u=o+1;u<E_;++u)n.delete(i,u);n.set(i,l,o)}toJSON(i){return this.write({},i)}};return r=a([b("esri.core.MultiOriginJSONSupport.WriteableMultiOriginJSONSupport")],r),r.prototype.toJSON.isDefaultToJSON=!0,r};function eP(t){return Xr(t).store}const t9=t=>{const e=Mhe(e9(t));let r=class extends e{};return r=a([b("esri.core.MultiOriginJSONSupport")],r),r},uIe=t9(X),qe=(t=>t)(["operational-layers","basemap-base-layers","basemap-ground-layers","ground"]);var D$;let Gl=D$=class extends F{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new D$({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};a([c({type:String,json:{write:!0}})],Gl.prototype,"expression",void 0),a([c({type:String,json:{write:!0}})],Gl.prototype,"name",void 0),a([c({type:["boolean","date","number","string"],json:{write:!0}})],Gl.prototype,"returnType",void 0),a([c({type:String,json:{write:!0}})],Gl.prototype,"title",void 0),Gl=D$=a([b("esri.form.ExpressionInfo")],Gl);const Ihe=Gl;let mi=class extends F{constructor(e){super(e),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};a([c({type:String,json:{write:!0}})],mi.prototype,"description",void 0),a([c({type:String,json:{write:!0}})],mi.prototype,"label",void 0),a([c()],mi.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],mi.prototype,"visibilityExpression",void 0),mi=a([b("esri.form.elements.Element")],mi);let F0=class extends pe(F){constructor(e){super(e),this.type=null}};a([c()],F0.prototype,"type",void 0),F0=a([b("esri.form.elements.inputs.attachments.Input")],F0);const il=F0,m1=["any","capture","upload"];let Bc=class extends il{constructor(e){super(e),this.type="audio",this.inputMethod="any",this.maxDuration=null}};a([c({type:["audio"],readOnly:!0,json:{write:!0}})],Bc.prototype,"type",void 0),a([c({type:m1,json:{write:!0}})],Bc.prototype,"inputMethod",void 0),a([c({type:Number,json:{write:!0}})],Bc.prototype,"maxDuration",void 0),Bc=a([b("esri.form.elements.inputs.attachments.AudioInput")],Bc);const tP=Bc;let _f=class extends il{constructor(e){super(e),this.type="document",this.maxFileSize=null}};a([c({type:["document"],readOnly:!0,json:{write:!0}})],_f.prototype,"type",void 0),a([c({type:Number,json:{write:!0}})],_f.prototype,"maxFileSize",void 0),_f=a([b("esri.form.elements.inputs.attachments.DocumentInput")],_f);const rP=_f;let Hc=class extends il{constructor(e){super(e),this.type="image",this.inputMethod="any",this.maxImageSize=null}};a([c({type:["image"],readOnly:!0,json:{write:!0}})],Hc.prototype,"type",void 0),a([c({type:m1,json:{write:!0}})],Hc.prototype,"inputMethod",void 0),a([c({type:Number,json:{write:!0}})],Hc.prototype,"maxImageSize",void 0),Hc=a([b("esri.form.elements.inputs.attachments.ImageInput")],Hc);const iP=Hc;let Sf=class extends il{constructor(e){super(e),this.type="signature",this.inputMethod="any"}};a([c({type:["signature"],readOnly:!0,json:{write:!0}})],Sf.prototype,"type",void 0),a([c({type:m1,json:{write:!0}})],Sf.prototype,"inputMethod",void 0),Sf=a([b("esri.form.elements.inputs.attachments.SignatureInput")],Sf);const sP=Sf;let Wc=class extends il{constructor(e){super(e),this.type="video",this.inputMethod="any",this.maxDuration=null}};a([c({type:["video"],readOnly:!0,json:{write:!0}})],Wc.prototype,"type",void 0),a([c({type:m1,json:{write:!0}})],Wc.prototype,"inputMethod",void 0),a([c({type:Number,json:{write:!0}})],Wc.prototype,"maxDuration",void 0),Wc=a([b("esri.form.elements.inputs.attachments.VideoInput")],Wc);const nP=Wc;function r9(t){return{nestableTypes:{base:il,key:"type",typeMap:{audio:tP,document:rP,image:iP,signature:sP,video:nP}},allTypes:{base:il,key:"type",typeMap:{attachment:t,audio:tP,document:rP,image:iP,signature:sP,video:nP}}}}function Ehe(t,e,r){return t?t.map(i=>Nn(e.nestableTypes,i)):null}function Ohe(t,e,r){if(!t)return null;const i=e.nestableTypes.typeMap;return t.filter(s=>i[s.type]).map(s=>i[s.type].fromJSON(s))}function khe(t,e,r){if(!t)return null;const i=e.nestableTypes.typeMap;return t.filter(s=>i[s.type]).map(s=>s.toJSON())}let wn=class extends il{constructor(e){super(e),this.type="attachment",this.attachmentAssociationType="exact",this.inputTypes=null}castInputs(e){return Ehe(e,Jb)}readInputs(e,r){return Ohe(r.inputTypes,Jb)}writeInputs(e,r){r.inputTypes=khe(e,Jb)}};a([c({type:["attachment"],readOnly:!0,json:{write:!0}})],wn.prototype,"type",void 0),a([c({type:["any","exact","exactOrNone"],json:{write:!0}})],wn.prototype,"attachmentAssociationType",void 0),a([c({json:{write:{isRequired:!0}}})],wn.prototype,"inputTypes",void 0),a([Ce("inputTypes")],wn.prototype,"castInputs",null),a([V("inputTypes")],wn.prototype,"readInputs",null),a([q("inputTypes")],wn.prototype,"writeInputs",null),wn=a([b("esri.form.elements.inputs.attachments.AttachmentInput")],wn);const Jb=r9(wn),Che=wn;var j$;const Phe=r9(Che);let Oi=j$=class extends mi{constructor(t){super(t),this.allowUserRename=!0,this.attachmentKeyword=null,this.displayFilename=!1,this.editableExpression=null,this.filenameExpression="{attachmentKeyword}_{now}",this.input=null,this.maxAttachmentCount=null,this.minAttachmentCount=null,this.type="attachment",this.useOriginalFilename=!0}clone(){return new j$({allowUserRename:this.allowUserRename,attachmentKeyword:this.attachmentKeyword,description:this.description,displayFilename:this.displayFilename,editableExpression:this.editableExpression,filenameExpression:this.filenameExpression,input:this.input?.clone(),label:this.label,maxAttachmentCount:this.maxAttachmentCount,minAttachmentCount:this.minAttachmentCount,useOriginalFilename:this.useOriginalFilename,visibilityExpression:this.visibilityExpression})}};a([c({type:Boolean,json:{write:!0}})],Oi.prototype,"allowUserRename",void 0),a([c({type:String,json:{write:{isRequired:!0}}})],Oi.prototype,"attachmentKeyword",void 0),a([c({type:Boolean,json:{write:!0}})],Oi.prototype,"displayFilename",void 0),a([c({type:String,json:{write:!0}})],Oi.prototype,"editableExpression",void 0),a([c({type:String,json:{write:!0}})],Oi.prototype,"filenameExpression",void 0),a([c({types:Phe.allTypes,json:{read:{source:"inputType"},write:{target:"inputType",isRequired:!0}}})],Oi.prototype,"input",void 0),a([c({type:Number,json:{write:!0}})],Oi.prototype,"maxAttachmentCount",void 0),a([c({type:Number,json:{write:!0}})],Oi.prototype,"minAttachmentCount",void 0),a([c({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],Oi.prototype,"type",void 0),a([c({type:Boolean,json:{write:!0}})],Oi.prototype,"useOriginalFilename",void 0),Oi=j$=a([b("esri.form.elements.AttachmentElement")],Oi);const oP=Oi;let N0=class extends F{constructor(e){super(e),this.type=null}};a([c()],N0.prototype,"type",void 0),N0=a([b("esri.form.elements.inputs.Input")],N0);const Bo=N0;let $f=class extends Bo{constructor(e){super(e),this.maxLength=null,this.minLength=0}};a([c({type:Number,json:{write:!0}})],$f.prototype,"maxLength",void 0),a([c({type:Number,json:{write:!0}})],$f.prototype,"minLength",void 0),$f=a([b("esri.form.elements.inputs.TextInput")],$f);const m3=$f;var V$;let D0=V$=class extends m3{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new V$({maxLength:this.maxLength,minLength:this.minLength})}};a([c({type:["barcode-scanner"],json:{read:!1,write:!0}})],D0.prototype,"type",void 0),D0=V$=a([b("esri.form.elements.inputs.BarcodeScannerInput")],D0);const Ahe=D0;var z$;let Zc=z$=class extends Bo{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new z$({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};a([c({type:String,json:{write:!0}})],Zc.prototype,"noValueOptionLabel",void 0),a([c({type:Boolean,json:{write:!0}})],Zc.prototype,"showNoValueOption",void 0),a([c({type:["combo-box"],json:{read:!1,write:!0}})],Zc.prototype,"type",void 0),Zc=z$=a([b("esri.form.elements.inputs.ComboBoxInput")],Zc);const Rhe=Zc;var U$;function aP(t){return t??null}function lP(t){return t??null}let yn=U$=class extends Bo{constructor(t){super(t),this.max=null,this.min=null,this.type="date-picker"}readMax(t,e){return aP(e.max)}writeMax(t,e){e.max=lP(t)}readMin(t,e){return aP(e.min)}writeMin(t,e){e.min=lP(t)}clone(){return new U$({max:this.max,min:this.min})}};a([c({type:String,json:{type:String,write:!0}})],yn.prototype,"max",void 0),a([V("max")],yn.prototype,"readMax",null),a([q("max")],yn.prototype,"writeMax",null),a([c({type:String,json:{type:String,write:!0}})],yn.prototype,"min",void 0),a([V("min")],yn.prototype,"readMin",null),a([q("min")],yn.prototype,"writeMin",null),a([c({type:["date-picker"],json:{read:!1,write:!0}})],yn.prototype,"type",void 0),yn=U$=a([b("esri.form.elements.inputs.DatePickerInput")],yn);const Lhe=yn;var q$;function Yb(t){return t??null}function Kb(t){return t??null}let si=q$=class extends Bo{constructor(t){super(t),this.includeTimeOffset=!0,this.max=null,this.min=null,this.timeResolution="minutes",this.type="datetimeoffset-picker"}readMax(t,e){return Yb(e.max)}writeMax(t,e){e.max=Kb(t)}readMin(t,e){return Yb(e.min)}writeMin(t,e){e.min=Kb(t)}readTimeResolution(t,e){return Yb(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=Kb(t)}clone(){return new q$({includeTimeOffset:this.includeTimeOffset,max:this.max,min:this.min,timeResolution:this.timeResolution})}};a([c({type:Boolean,json:{write:!0}})],si.prototype,"includeTimeOffset",void 0),a([c({type:String,json:{type:String,write:!0}})],si.prototype,"max",void 0),a([V("max")],si.prototype,"readMax",null),a([q("max")],si.prototype,"writeMax",null),a([c({type:String,json:{type:String,write:!0}})],si.prototype,"min",void 0),a([V("min")],si.prototype,"readMin",null),a([q("min")],si.prototype,"writeMin",null),a([c({type:String,json:{type:String,write:!0}})],si.prototype,"timeResolution",void 0),a([V("timeResolution")],si.prototype,"readTimeResolution",null),a([q("timeResolution")],si.prototype,"writeTimeResolution",null),a([c({type:["datetimeoffset-picker"],json:{read:!1,write:!0}})],si.prototype,"type",void 0),si=q$=a([b("esri.form.elements.inputs.DateTimeOffsetPickerInput")],si);const Fhe=si;var G$;function uP(t){return t!=null?new Date(t):null}function cP(t){return t?t.getTime():null}let Ls=G$=class extends Bo{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return uP(e.max)}writeMax(t,e){e.max=cP(t)}readMin(t,e){return uP(e.min)}writeMin(t,e){e.min=cP(t)}clone(){return new G$({includeTime:this.includeTime,max:this.max,min:this.min})}};a([c({type:Boolean,json:{write:!0}})],Ls.prototype,"includeTime",void 0),a([c({type:Date,json:{type:Number,write:!0}})],Ls.prototype,"max",void 0),a([V("max")],Ls.prototype,"readMax",null),a([q("max")],Ls.prototype,"writeMax",null),a([c({type:Date,json:{type:Number,write:!0}})],Ls.prototype,"min",void 0),a([V("min")],Ls.prototype,"readMin",null),a([q("min")],Ls.prototype,"writeMin",null),a([c({type:["datetime-picker"],json:{read:!1,write:!0}})],Ls.prototype,"type",void 0),Ls=G$=a([b("esri.form.elements.inputs.DateTimePickerInput")],Ls);const Nhe=Ls;var B$;let Jc=B$=class extends Bo{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new B$({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};a([c({type:String,json:{write:!0}})],Jc.prototype,"noValueOptionLabel",void 0),a([c({type:Boolean,json:{write:!0}})],Jc.prototype,"showNoValueOption",void 0),a([c({type:["radio-buttons"],json:{read:!1,write:!0}})],Jc.prototype,"type",void 0),Jc=B$=a([b("esri.form.elements.inputs.RadioButtonsInput")],Jc);const Dhe=Jc;var H$;let Yc=H$=class extends Bo{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new H$({offValue:this.offValue,onValue:this.onValue})}};a([c({type:[String,Number],json:{write:!0}})],Yc.prototype,"offValue",void 0),a([c({type:[String,Number],json:{write:!0}})],Yc.prototype,"onValue",void 0),a([c({type:["switch"],json:{read:!1,write:!0}})],Yc.prototype,"type",void 0),Yc=H$=a([b("esri.form.elements.inputs.SwitchInput")],Yc);const jhe=Yc;var W$;let j0=W$=class extends m3{constructor(t){super(t),this.type="text-area"}clone(){return new W$({maxLength:this.maxLength,minLength:this.minLength})}};a([c({type:["text-area"],json:{read:!1,write:!0}})],j0.prototype,"type",void 0),j0=W$=a([b("esri.form.elements.inputs.TextAreaInput")],j0);const Vhe=j0;var Z$;let V0=Z$=class extends m3{constructor(t){super(t),this.type="text-box"}clone(){return new Z$({maxLength:this.maxLength,minLength:this.minLength})}};a([c({type:["text-box"],json:{read:!1,write:!0}})],V0.prototype,"type",void 0),V0=Z$=a([b("esri.form.elements.inputs.TextBoxInput")],V0);const zhe=V0;var J$;function Qb(t){return t??null}function Xb(t){return t??null}let ki=J$=class extends Bo{constructor(t){super(t),this.max=null,this.min=null,this.timeResolution="minutes",this.type="time-picker"}readMax(t,e){return Qb(e.max)}writeMax(t,e){e.max=Xb(t)}readMin(t,e){return Qb(e.min)}writeMin(t,e){e.min=Xb(t)}readTimeResolution(t,e){return Qb(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=Xb(t)}clone(){return new J$({max:this.max,min:this.min,timeResolution:this.timeResolution})}};a([c({type:String,json:{type:String,write:!0}})],ki.prototype,"max",void 0),a([V("max")],ki.prototype,"readMax",null),a([q("max")],ki.prototype,"writeMax",null),a([c({type:String,json:{type:String,write:!0}})],ki.prototype,"min",void 0),a([V("min")],ki.prototype,"readMin",null),a([q("min")],ki.prototype,"writeMin",null),a([c({type:String,json:{type:String,write:!0}})],ki.prototype,"timeResolution",void 0),a([V("timeResolution")],ki.prototype,"readTimeResolution",null),a([q("timeResolution")],ki.prototype,"writeTimeResolution",null),a([c({type:["time-picker"],json:{read:!1,write:!0}})],ki.prototype,"type",void 0),ki=J$=a([b("esri.form.elements.inputs.TimePickerInput")],ki);const Uhe=ki,qhe=Ahe,Ghe=Rhe,Bhe=Lhe,Hhe=Fhe,Whe=Nhe,Zhe=Dhe,Jhe=jhe,Yhe=Vhe,Khe=zhe,Qhe=Uhe,Xhe={base:Bo,key:"type",typeMap:{"barcode-scanner":qhe,"combo-box":Ghe,"date-picker":Bhe,"datetime-picker":Whe,"datetimeoffset-picker":Hhe,"radio-buttons":Zhe,switch:Jhe,"text-area":Yhe,"text-box":Khe,"time-picker":Qhe}};var Y$;let Ri=Y$=class extends mi{constructor(t){super(t),this.domain=null,this.editable=null,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}clone(){return new Y$({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};a([c({types:_j,json:{read:{reader:i1},write:!0}})],Ri.prototype,"domain",void 0),a([c({type:Boolean,json:{write:!0}})],Ri.prototype,"editable",void 0),a([c({type:String,json:{write:!0}})],Ri.prototype,"editableExpression",void 0),a([c({type:String,json:{write:!0}})],Ri.prototype,"fieldName",void 0),a([c({type:String,json:{write:!0}})],Ri.prototype,"hint",void 0),a([c({types:Xhe,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Ri.prototype,"input",void 0),a([c({type:String,json:{write:!0}})],Ri.prototype,"requiredExpression",void 0),a([c({type:String,json:{read:!1,write:!0}})],Ri.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],Ri.prototype,"valueExpression",void 0),Ri=Y$=a([b("esri.form.elements.FieldElement")],Ri);var K$;let uo=K$=class extends mi{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editableExpression=null,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new K$({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editableExpression:this.editableExpression,label:this.label,orderByFields:E(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};a([c({type:Number,json:{write:!0}})],uo.prototype,"displayCount",void 0),a([c({type:["list"],json:{write:!0}})],uo.prototype,"displayType",void 0),a([c({type:String,json:{write:!0}})],uo.prototype,"editableExpression",void 0),a([c({type:[FM],json:{write:!0}})],uo.prototype,"orderByFields",void 0),a([c({type:Number,json:{write:!0}})],uo.prototype,"relationshipId",void 0),a([c({type:["relationship"],json:{read:!1,write:!0}})],uo.prototype,"type",void 0),uo=K$=a([b("esri.form.elements.RelationshipElement")],uo);const dP=uo;var Q$;let Kc=Q$=class extends mi{constructor(t){super(t),this.text=null,this.textFormat="plain-text",this.type="text"}clone(){return new Q$({text:this.text,textFormat:this.textFormat,visibilityExpression:this.visibilityExpression})}};a([c({type:String,json:{write:!0}})],Kc.prototype,"text",void 0),a([c({type:String,json:{write:!0}})],Kc.prototype,"textFormat",void 0),a([c({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],Kc.prototype,"type",void 0),Kc=Q$=a([b("esri.form.elements.TextElement")],Kc);const hP=Kc;let Qc=class extends pe(mi){constructor(e){super(e),this.associationTypes=null,this.editableExpression=null,this.type="utilityNetworkAssociations"}};a([c({type:[Z4],json:{write:{isRequired:!0}}})],Qc.prototype,"associationTypes",void 0),a([c({type:String,json:{write:!0}})],Qc.prototype,"editableExpression",void 0),a([c({type:["utilityNetworkAssociations"],json:{read:!1,write:!0}})],Qc.prototype,"type",void 0),Qc=a([b("esri.form.elements.UtilityNetworkAssociationsElement")],Qc);const pP=Qc,epe=t=>t.type==="field",tpe=t=>t.type==="group",rpe=t=>t.type==="text";function i9(t){return{typesWithGroup:{base:mi,key:"type",typeMap:{attachment:oP,field:Ri,group:t,relationship:dP,text:hP,utilityNetworkAssociations:pP}},typesWithoutGroup:{base:mi,key:"type",typeMap:{attachment:oP,field:Ri,relationship:dP,text:hP,utilityNetworkAssociations:pP}}}}function s9(t,e,r=!0){if(!t)return null;const i=r?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(s=>i[s.type]).map(s=>i[s.type].fromJSON(s))}function n9(t,e,r=!0){if(!t)return null;const i=r?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(s=>i[s.type]).map(s=>s.toJSON())}function o9(t,e,r=!0){return t?t.map(i=>Nn(r?e.typesWithGroup:e.typesWithoutGroup,i)):null}var X$;let bn=X$=class extends mi{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return o9(t,e_,!1)}readElements(t,e){return s9(e.formElements,e_,!1)}writeElements(t,e){e.formElements=n9(t,e_,!1)}clone(){return new X$({description:this.description,elements:E(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};a([c({json:{write:!0}})],bn.prototype,"elements",void 0),a([Ce("elements")],bn.prototype,"castElements",null),a([V("elements",["formElements"])],bn.prototype,"readElements",null),a([q("elements")],bn.prototype,"writeElements",null),a([c({type:["collapsed","expanded"],json:{write:!0}})],bn.prototype,"initialState",void 0),a([c({type:String,json:{read:!1,write:!0}})],bn.prototype,"type",void 0),bn=X$=a([b("esri.form.elements.GroupElement")],bn);const e_=i9(bn),ipe=bn;var ex;const t_=i9(ipe);let Fs=ex=class extends F{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(t){return o9(t,t_)}readElements(t,e){return s9(e.formElements,t_)}writeElements(t,e){e.formElements=n9(t,t_)}clone(){return new ex({description:this.description,expressionInfos:E(this.expressionInfos),elements:E(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}async getFieldsUsed(t,e){const r=new Set,{description:i,elements:s,expressionInfos:n,title:o}=this;if(dm(r,t,i),dm(r,t,o),!s)return[];const l=spe(s,n).map(u=>Fr(r,t,null,u));await Promise.all(l);for(const u of s)a9(r,{fieldsIndex:t,relationships:e},u);return Array.from(r).sort()}};function a9(t,e,r){const{fieldsIndex:i}=e;if(!i||i.fields.length!==t.size)switch(dm(t,i,r.label),dm(t,i,r.description),r.type){case"field":Rr(t,i,r.fieldName);break;case"group":r.elements.forEach(s=>a9(t,e,s));break;case"relationship":if(e.relationships){const s=e.relationships.find(n=>n.id===r.relationshipId);s&&Rr(t,i,s.keyField)}Du(t,i,r.orderByFields?.map(s=>s.field));break;case"text":dm(t,i,r.text)}}function spe(t,e){if(!e||e.length===0)return[];const r=l9(t),i=[];for(const s of e)r.has(s.name)&&i.push(s.expression);return i}function l9(t){const e=new Set;for(const r of t)if(EI(e,r.visibilityExpression),!rpe(r)){if(tpe(r))hv(e,l9(r.elements));else if(EI(e,r.editableExpression),epe(r)){const{requiredExpression:i,valueExpression:s}=r;hv(e,[i,s])}}return e}function dm(t,e,r){Du(t,e,PM(r))}a([c({type:String,json:{write:!0}})],Fs.prototype,"description",void 0),a([c({json:{write:!0}})],Fs.prototype,"elements",void 0),a([Ce("elements")],Fs.prototype,"castElements",null),a([V("elements",["formElements"])],Fs.prototype,"readElements",null),a([q("elements")],Fs.prototype,"writeElements",null),a([c({type:[Ihe],json:{write:!0}})],Fs.prototype,"expressionInfos",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],Fs.prototype,"preserveFieldValuesWhenHidden",void 0),a([c({type:String,json:{write:!0}})],Fs.prototype,"title",void 0),Fs=ex=a([b("esri.form.FormTemplate")],Fs);const npe=Symbol("getSliceableSymbol");let Um=class{};Um=a([b("esri.graphic.GraphicOrigin")],Um);const ope=Symbol("isFeatureGraphicOrigin");var fP;let ape=class extends Um{get[(fP=ope,fy)](){return this.layer}get[jM](){return this.layer}get[npe](){return this.layer}constructor(e){super(),this[fP]=!0,this.type="feature",this.layer=e}get id(){return this.layer.id}};function mP(t,e,r){if(t.hasM==null||t.hasZ)for(const i of e)for(const s of i)s.length>2&&(s[2]*=r)}function lpe(t,e,r){if(!t&&!e||!r)return;const i=$v(r);yP(t,r,i),yP(e,r,i)}function yP(t,e,r){if(t)for(const i of t)upe(i.geometry,e,r)}function upe(t,e,r){if(!t?.spatialReference||Wt(t.spatialReference,e))return;const i=$v(t.spatialReference)/r;if(i!==1){if("x"in t)t.z!=null&&(t.z*=i);else if("rings"in t)mP(t,t.rings,i);else if("paths"in t)mP(t,t.paths,i);else if("points"in t&&(t.hasM==null||t.hasZ))for(const s of t.points)s.length>2&&(s[2]*=i)}}function gP(t,e,r){if(!r?.features||!r.hasZ)return;const i=HN(r.geometryType,e,t.outSpatialReference);if(i!=null)for(const s of r.features)i(s.geometry)}var tx;const rx=new $e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let zt=tx=class extends F{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){return this.readFeaturesWithClass(t,e,nt)}writeGeometryType(t,e,r,i){if(t)return void rx.write(t,e,r,i);const{features:s}=this;if(s){for(const n of s)if(n?.geometry!=null)return void rx.write(n.geometry.type,e,r,i)}}readQueryGeometry(t,e){if(!t)return null;const r=!!t.spatialReference,i=tl(t);return i&&!r&&e.spatialReference&&(i.spatialReference=Z.fromJSON(e.spatialReference)),i}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:r}=this;if(r){for(const i of r)if(i&&i.geometry!=null&&i.geometry.spatialReference)return void(e.spatialReference=i.geometry.spatialReference.toJSON())}}clone(){return new tx(this.cloneProperties())}cloneProperties(){return E({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let r=0;r<e.features.length;r++){const i=e.features[r];if(i.geometry){const s=t?.[r];i.geometry=s?.toJSON()||i.geometry}}return e}quantize(t){const{scale:[e,r],translate:[i,s]}=t,n=d=>Math.round((d-i)/e),o=d=>Math.round((s-d)/r),l=this.features,u=this._getQuantizationFunction(this.geometryType,n,o);for(let d=0,p=l.length;d<p;d++)u?.(l[d].geometry)||(l.splice(d,1),d--,p--);return this.transform=t,this}unquantize(){const{geometryType:t,features:e,transform:r}=this;if(!r)return this;const{translate:[i,s],scale:[n,o]}=r,l=m=>m*n+i,u=m=>s-m*o;let d=null,p=null;if(this.hasZ&&r?.scale?.[2]!=null){const{translate:[,,m],scale:[,,y]}=r;d=g=>g*y+m}if(this.hasM&&r?.scale?.[3]!=null){const{translate:[,,,m],scale:[,,,y]}=r;p=g=>g==null?g:g*y+m}const f=this._getHydrationFunction(t,l,u,d,p);for(const{geometry:m}of e)m!=null&&f&&f(m);return this.transform=null,this}readFeaturesWithClass(t,e,r){const i=Z.fromJSON(e.spatialReference),s=[];for(let n=0;n<t.length;n++){const o=t[n],l=r.fromJSON(o),u=o.geometry?.spatialReference;l.geometry==null||u||(l.geometry.spatialReference=i);const d=o.aggregateGeometries,p=l.aggregateGeometries;if(d&&p!=null)for(const f in p){const m=p[f],y=d[f],g=y?.spatialReference;m==null||g||(m.spatialReference=i)}s.push(l)}return s}_quantizePoints(t,e,r){let i,s;const n=[];for(let o=0,l=t.length;o<l;o++){const u=t[o];if(o>0){const d=e(u[0]),p=r(u[1]);d===i&&p===s||(n.push([d-i,p-s]),i=d,s=p)}else i=e(u[0]),s=r(u[1]),n.push([i,s])}return n.length>0?n:null}_getQuantizationFunction(t,e,r){return t==="point"?i=>(i.x=e(i.x),i.y=r(i.y),i):t==="polyline"||t==="polygon"?i=>{const s=Nd(i)?i.rings:i.paths,n=[];for(let o=0,l=s.length;o<l;o++){const u=s[o],d=this._quantizePoints(u,e,r);d&&n.push(d)}return n.length>0?(Nd(i)?i.rings=n:i.paths=n,i):null}:t==="multipoint"?i=>{const s=this._quantizePoints(i.points,e,r);return s&&s.length>0?(i.points=s,i):null}:t==="extent"?i=>i:null}_getHydrationFunction(t,e,r,i,s){return t==="point"?n=>{n.x=e(n.x),n.y=r(n.y),i&&(n.z=i(n.z))}:t==="polyline"||t==="polygon"?n=>{const o=Nd(n)?n.rings:n.paths;let l,u;for(let d=0,p=o.length;d<p;d++){const f=o[d];for(let m=0,y=f.length;m<y;m++){const g=f[m];m>0?(l+=g[0],u+=g[1]):(l=g[0],u=g[1]),g[0]=e(l),g[1]=r(u)}}if(i&&s)for(let d=0,p=o.length;d<p;d++){const f=o[d];for(let m=0,y=f.length;m<y;m++){const g=f[m];g[2]=i(g[2]),g[3]=s(g[3])}}else if(i)for(let d=0,p=o.length;d<p;d++){const f=o[d];for(let m=0,y=f.length;m<y;m++){const g=f[m];g[2]=i(g[2])}}else if(s)for(let d=0,p=o.length;d<p;d++){const f=o[d];for(let m=0,y=f.length;m<y;m++){const g=f[m];g[2]=s(g[2])}}}:t==="extent"?n=>{n.xmin=e(n.xmin),n.ymin=r(n.ymin),n.xmax=e(n.xmax),n.ymax=r(n.ymax),i&&n.zmax!=null&&n.zmin!=null&&(n.zmax=i(n.zmax),n.zmin=i(n.zmin)),s&&n.mmax!=null&&n.mmin!=null&&(n.mmax=s(n.mmax),n.mmin=s(n.mmin))}:t==="multipoint"?n=>{const o=n.points;let l,u;for(let d=0,p=o.length;d<p;d++){const f=o[d];d>0?(l+=f[0],u+=f[1]):(l=f[0],u=f[1]),f[0]=e(l),f[1]=r(u)}if(i&&s)for(let d=0,p=o.length;d<p;d++){const f=o[d];f[2]=i(f[2]),f[3]=s(f[3])}else if(i)for(let d=0,p=o.length;d<p;d++){const f=o[d];f[2]=i(f[2])}else if(s)for(let d=0,p=o.length;d<p;d++){const f=o[d];f[2]=s(f[2])}}:null}};a([c({type:String,json:{write:!0}})],zt.prototype,"displayFieldName",void 0),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],zt.prototype,"exceededTransferLimit",void 0),a([c({type:[nt],json:{write:!0}})],zt.prototype,"features",void 0),a([V("features")],zt.prototype,"readFeatures",null),a([c({type:[rr],json:{write:!0}})],zt.prototype,"fields",void 0),a([c({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:rx.read}}})],zt.prototype,"geometryType",void 0),a([q("geometryType")],zt.prototype,"writeGeometryType",null),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],zt.prototype,"hasM",void 0),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],zt.prototype,"hasZ",void 0),a([c({types:hy,json:{write:!0}})],zt.prototype,"queryGeometry",void 0),a([V("queryGeometry")],zt.prototype,"readQueryGeometry",null),a([c({type:Z,json:{write:!0}})],zt.prototype,"spatialReference",void 0),a([q("spatialReference")],zt.prototype,"writeSpatialReference",null),a([c({json:{write:!0}})],zt.prototype,"transform",void 0),zt=tx=a([b("esri.rest.support.FeatureSet")],zt),zt.prototype.toJSON.isDefaultToJSON=!0;let cpe=0,wo=class extends LL(PT(H)){constructor(e){super(e),this._idToClientGeometry=null,this.type="memory"}load(e){const r=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(r)),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null}get _workerGeometryType(){const e=this.layer?.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(e){return this.load().then(()=>this._applyEdits(e))}openPorts(){return this.load().then(()=>this._connection.openPorts())}async queryFeatures(e,r={}){await this.load(r);const i=await this._connection.invoke("queryFeatures",e?e.toJSON():null,r);gP(e,this.layer.spatialReference,i);const s=zt.fromJSON(i);if(!this._requiresClientGraphicMapping()||!this._idToClientGeometry)return s;const n=this.layer.objectIdField;for(const o of s.features){const l=o.attributes[n],u=this._idToClientGeometry.get(l);u!==void 0&&(o.geometry=u)}return s.geometryType=this.layer.geometryType,s}async queryFeaturesJSON(e,r={}){if(this._requiresClientGraphicMapping())throw new x("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(r);const i=await this._connection.invoke("queryFeatures",e?e.toJSON():null,r);return gP(e,this.layer.spatialReference,i),i}queryFeatureCount(e,r={}){return this.load(r).then(()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,r))}queryObjectIds(e,r={}){return this.load(r).then(()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,r))}queryExtent(e,r={}){return this.load(r).then(()=>this._connection.invoke("queryExtent",e?e.toJSON():null,r)).then(i=>({count:i.count,extent:he.fromJSON(i.extent)}))}querySnapping(e,r={}){return this.load(r).then(()=>this._connection.invoke("querySnapping",e,r))}async queryAttributeBins(e,r={}){return await this.load(),this._connection.invoke("queryAttributeBins",e?.toJSON(),r)}async _applyEdits(e){if(!this._connection)throw new x("feature-layer-source:edit-failure","Memory source not loaded");const r=this.layer.objectIdField;let i=null;const s=[],n=[];await Promise.all([this._prepareClientMapping(e.addFeatures,null),this._prepareClientMapping(e.updateFeatures,null)]);const o=p=>"objectId"in p&&p.objectId!=null?p.objectId:"attributes"in p&&p.attributes[r]!=null?p.attributes[r]:null;if(e.addFeatures&&(i=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(const p of e.deleteFeatures){const f=o(p);f!=null&&s.push(f)}const l=e.updateFeatures&&this._idToClientGeometry?new Map:null;if(e.updateFeatures){for(const p of e.updateFeatures)if(n.push(this._serializeFeature(p)),l&&p.geometry!=null){const f=o(p);f!=null&&l.set(f,p)}}lpe(i?i.features:null,n,this.layer.spatialReference);const{fullExtent:u,featureEditResults:d}=await this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:n,deletes:s});return this.fullExtent=u,i&&i.finish(d.uidToObjectId),this._updateIdToClientGeometries(l,d),this._createEditsResult(d)}async _prepareClientMapping(e,r){if(this._layerOrSourceGeometryType!=="mesh"||e==null)return;const i=[];for(const{geometry:s}of e)s==null||s.type!=="mesh"||s.hasExtent||s.loaded||i.push(s.load({signal:r}));i.length&&await Promise.all(i)}_updateIdToClientGeometries(e,r){if(this._idToClientGeometry){if(e)for(const i of r.updateResults){if(!i.success)continue;const s=e.get(i.objectId);s!=null&&this._addIdToClientGeometry(s)}for(const i of r.deleteResults)i.success&&this._idToClientGeometry.delete(i.objectId)}}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const r=e.success===!0?null:e.error||{code:void 0,description:""};return{objectId:e.objectId,globalId:e.globalId,error:r?new x("feature-layer-source:edit-failure",r.description,{code:r.code}):null}}_prepareAddFeatures(e){const r=new Map,i=new Array(e.length);let s=null;for(let o=0;o<e.length;o++){const l=e[o],u=this._serializeFeature(l);s||l.geometry==null||(s=l.geometry.type),i[o]=u,r.set(`${u.uid}`,l)}const n=this;return{features:i,inferredGeometryType:s,finish(o){const l=n.sourceJSON.objectIdField;for(const u in o){const d=o[u],p=r.get(u);p&&(p.attributes||(p.attributes={}),d===-1?delete p.attributes[l]:p.attributes[l]=d,n._addIdToClientGeometry(p))}}}}_addIdToClientGeometry(e){if(!this._idToClientGeometry)return;const r=this.sourceJSON.objectIdField,i=e.attributes?.[r];i!=null&&this._idToClientGeometry.set(i,e.geometry??null)}get _layerOrSourceGeometryType(){return this.layer?.geometryType??this.sourceJSON?.geometryType}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}_geometryTypeRequiresClientGraphicMapping(e){return e==="mesh"||e==="multipatch"||e==="extent"}_serializeFeature(e){const{attributes:r}=e,i=this._geometryForSerialization(e),s=(cpe++).toString();return i?{uid:s,geometry:i.toJSON(),attributes:r}:{uid:s,attributes:r}}_geometryForSerialization(e){const{geometry:r}=e;return r==null?null:this._geometryRequiresClientGraphicMapping(r)?r.extent?Be.fromExtent(r.extent):null:r}async _startWorker(e){this._connection=await dee("MemorySourceWorker",{strategy:k("feature-layers-workers")?"dedicated":"local",signal:e,registryTarget:this});const{fields:r,spatialReference:i,objectIdField:s,hasM:n,hasZ:o,timeInfo:l,dateFieldsTimeZone:u}=this.layer,d=this.layer.originOf("spatialReference")==="defaults";await this._prepareClientMapping(this.items,e);const p=this._prepareAddFeatures(this.items);this.addHandles(this.on("before-changes",g=>{L.getLogger(this).error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),g.preventDefault()}));const f={features:p.features,fields:r?.map(g=>g.toJSON()),geometryType:yO.toJSON(this._workerGeometryType),hasM:this._layerOrSourceGeometryType!=="mesh"&&n,hasZ:this._layerOrSourceGeometryType==="mesh"||o,objectIdField:s,spatialReference:d?null:i&&i.toJSON(),timeInfo:l?.toJSON()??null,dateFieldsTimeZone:u},m=await this._connection.invoke("load",f,{signal:e});for(const g of m.warnings)L.getLogger(this.layer).warn("#load()",`${g.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:g});m.featureErrors.length&&L.getLogger(this.layer).warn("#load()",`Encountered ${m.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:m.featureErrors});const y=m.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(p.inferredGeometryType)&&(y.geometryType=yO.toJSON(p.inferredGeometryType)),this.sourceJSON=y,this._requiresClientGraphicMapping()&&(this._idToClientGeometry=new Map),p.finish(m.assignedObjectIds)}};a([CT({Type:nt,ensureType:ct(nt)})],wo.prototype,"itemType",void 0),a([c()],wo.prototype,"type",void 0),a([c({constructOnly:!0})],wo.prototype,"layer",void 0),a([c({readOnly:!0})],wo.prototype,"_workerGeometryType",null),a([c()],wo.prototype,"sourceJSON",void 0),wo=a([b("esri.layers.graphics.sources.MemorySource")],wo);function dpe(t){return"portalItem"in t}const hpe=t=>{const e=t;let r=class extends e{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):dpe(this)?this.portalItem?.apiKey:null}set apiKey(i){i!=null?this._override("apiKey",i):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return a([c({type:String})],r.prototype,"apiKey",null),r=a([b("esri.layers.mixins.APIKeyMixin")],r),r},ppe=t=>{const e=t;let r=class extends e{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const i=nl(this.url);if(i?.title)return i.title}return this._get("title")||""}set title(i){this._set("title",i)}set url(i){this._set("url",$7(i,L.getLogger(this)))}};return a([c()],r.prototype,"title",null),a([c({type:String})],r.prototype,"url",null),r=a([b("esri.layers.mixins.ArcGISService")],r),r};let vP=class extends SyntaxError{constructor(e,r,i,s){super(e),this.expected=r,this.found=i,this.location=s,this.name="SyntaxError"}format(e){let r="Error: "+this.message;if(this.location){let i=null;const s=e.find(u=>u.source===this.location.source);s&&(i=s.text.split(/\r\n|\n|\r/g));const n=this.location.start,o=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(n):n,l=this.location.source+":"+o.line+":"+o.column;if(i){const u=this.location.end,d="".padEnd(o.line.toString().length," "),p=i[n.line-1],f=(n.line===u.line?u.column:p.length+1)-n.column||1;r+=`
 --> `+l+`
`+d+` |
`+o.line+" | "+p+`
`+d+" | "+"".padEnd(n.column-1," ")+"".padEnd(f,"^")}else r+=`
 at `+l}return r}static buildMessage(e,r){function i(m){return m.codePointAt(0).toString(16).toUpperCase()}const s=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function n(m){return s?m.replace(s,y=>"\\u{"+i(y)+"}"):m}function o(m){return n(m.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,y=>"\\x0"+i(y)).replace(/[\x10-\x1F\x7F-\x9F]/g,y=>"\\x"+i(y)))}function l(m){return n(m.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,y=>"\\x0"+i(y)).replace(/[\x10-\x1F\x7F-\x9F]/g,y=>"\\x"+i(y)))}const u={literal:m=>'"'+o(m.text)+'"',class(m){const y=m.parts.map(g=>Array.isArray(g)?l(g[0])+"-"+l(g[1]):l(g));return"["+(m.inverted?"^":"")+y.join("")+"]"+(m.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:m=>m.description};function d(m){return u[m.type](m)}function p(m){const y=m.map(d);if(y.sort(),y.length>0){let g=1;for(let v=1;v<y.length;v++)y[v-1]!==y[v]&&(y[g]=y[v],g++);y.length=g}switch(y.length){case 1:return y[0];case 2:return y[0]+" or "+y[1];default:return y.slice(0,-1).join(", ")+", or "+y[y.length-1]}}function f(m){return m?'"'+o(m)+'"':"end of input"}return"Expected "+p(e)+" but "+f(r)+" found."}};function fpe(t,e){const r={},i=(e=e!==void 0?e:{}).grammarSource,s={start:J3};let n=J3;const o="none",l=")",u=",",d="(",p="%",f="px",m="cm",y="mm",g="in",v="pt",_="pc",S="deg",M="rad",C="grad",T="turn",O="#",P=".",D="e",z=/^[ \t\n\r]/,B=/^[a-z\-]/,G=/^[0-9a-fA-F]/,Q=/^[+\-]/,oe=/^[0-9]/,Pe=Wo("none"),fe=Jt("none",!1),Nt=Jt(")",!1),Si=Jt(",",!1),or=pp([" ","	",`
`,"\r"],!1,!1,!1),Ne=Wo("function"),bs=Jt("(",!1),nz=Wo("identifier"),G3=pp([["a","z"],"-"],!1,!1,!1),oz=Wo("percentage"),az=Jt("%",!1),lz=Wo("length"),uz=Jt("px",!1),cz=Jt("cm",!1),dz=Jt("mm",!1),hz=Jt("in",!1),pz=Jt("pt",!1),fz=Jt("pc",!1),mz=Wo("angle"),yz=Jt("deg",!1),gz=Jt("rad",!1),vz=Jt("grad",!1),wz=Jt("turn",!1),bz=Wo("number"),_z=Wo("color"),Sz=Jt("#",!1),B3=pp([["0","9"],["a","f"],["A","F"]],!1,!1,!1),H3=pp(["+","-"],!1,!1,!1),Ho=pp([["0","9"]],!1,!1,!1),$z=Jt(".",!1),xz=Jt("e",!1);function Tz(){return[]}function Mz($,A){return{type:"function",name:$,parameters:A||[]}}function Iz($,A){return A.length>0?oU($,A,3):[$]}function Ez($){return{type:"quantity",value:$.value,unit:$.unit}}function Oz($){return{type:"color",colorType:$.type,value:$.value}}function Nwe($){return $}function kz(){return Ey()}function Cz($){return{value:$,unit:"%"}}function Pz($){return{value:$,unit:"px"}}function Az($){return{value:$,unit:"cm"}}function Rz($){return{value:$,unit:"mm"}}function Lz($){return{value:$,unit:"in"}}function Fz($){return{value:$,unit:"pt"}}function Nz($){return{value:$,unit:"pc"}}function Dz($){return{value:$,unit:"deg"}}function jz($){return{value:$,unit:"rad"}}function Vz($){return{value:$,unit:"grad"}}function zz($){return{value:$,unit:"turn"}}function Uz($){return{value:$,unit:null}}function qz(){return{type:"hex",value:Ey()}}function Gz($){return{type:"function",value:$}}function Bz(){return{type:"named",value:Ey()}}function Hz(){return parseFloat(Ey())}let R=0|e.peg$currPos,st=R;const Ku=[{line:1,column:1}];let hp,_s=R,Iy=e.peg$maxFailExpected||[],ae=0|e.peg$silentFails;if(e.startRule){if(!(e.startRule in s))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');n=s[e.startRule]}function Ey(){return t.substring(st,R)}function Wz($=R){const A=t.codePointAt($);return A===void 0?"":String.fromCodePoint(A)}function Jt($,A){return{type:"literal",text:$,ignoreCase:A}}function pp($,A,U,ce){return{type:"class",parts:$,inverted:A,ignoreCase:U,unicode:ce}}function Zz(){return{type:"end"}}function Wo($){return{type:"other",description:$}}function W3($){let A,U=Ku[$];if(U)return U;if($>=Ku.length)A=Ku.length-1;else for(A=$;!Ku[--A];);for(U=Ku[A],U={line:U.line,column:U.column};A<$;)t.charCodeAt(A)===10?(U.line++,U.column=1):U.column++,A++;return Ku[$]=U,U}function Z3($,A,U){const ce=W3($),De=W3(A);return{source:i,start:{offset:$,line:ce.line,column:ce.column},end:{offset:A,line:De.line,column:De.column}}}function ye($){R<_s||(R>_s&&(_s=R,Iy=[]),Iy.push($))}function Jz($,A,U){return new vP(vP.buildMessage($,A),$,A,U)}function J3(){let $;return $=Yz(),$===r&&($=Kz()),$}function Yz(){let $,A;return ae++,$=R,Yt(),t.substr(R,4)===o?(A=o,R+=4):(A=r,ae===0&&ye(fe)),A!==r?(Yt(),st=$,$=Tz()):(R=$,$=r),ae--,$===r&&ae===0&&ye(Pe),$}function Kz(){let $,A;if($=[],A=I1(),A!==r)for(;A!==r;)$.push(A),A=I1();else $=r;return $}function I1(){let $,A,U,ce;return $=R,Yt(),A=Xz(),A!==r?(Yt(),U=Qz(),U===r&&(U=null),Yt(),t.charCodeAt(R)===41?(ce=l,R++):(ce=r,ae===0&&ye(Nt)),ce!==r?(Yt(),st=$,$=Mz(A,U)):(R=$,$=r)):(R=$,$=r),$}function Qz(){let $,A,U,ce,De,pt,Dt,fr;if($=R,A=E1(),A!==r){for(U=[],ce=R,De=Yt(),t.charCodeAt(R)===44?(pt=u,R++):(pt=r,ae===0&&ye(Si)),pt===r&&(pt=null),Dt=Yt(),fr=E1(),fr!==r?(De=[De,pt,Dt,fr],ce=De):(R=ce,ce=r);ce!==r;)U.push(ce),ce=R,De=Yt(),t.charCodeAt(R)===44?(pt=u,R++):(pt=r,ae===0&&ye(Si)),pt===r&&(pt=null),Dt=Yt(),fr=E1(),fr!==r?(De=[De,pt,Dt,fr],ce=De):(R=ce,ce=r);st=$,$=Iz(A,U)}else R=$,$=r;return $}function E1(){let $,A;return $=R,A=eU(),A===r&&(A=tU(),A===r&&(A=rU(),A===r&&(A=iU()))),A!==r&&(st=$,A=Ez(A)),$=A,$===r&&($=R,A=sU(),A!==r&&(st=$,A=Oz(A)),$=A),$}function Yt(){let $,A;for(ae++,$=[],A=t.charAt(R),z.test(A)?R++:(A=r,ae===0&&ye(or));A!==r;)$.push(A),A=t.charAt(R),z.test(A)?R++:(A=r,ae===0&&ye(or));return ae--,$}function Xz(){let $,A,U;return ae++,$=R,A=Y3(),A!==r?(t.charCodeAt(R)===40?(U=d,R++):(U=r,ae===0&&ye(bs)),U!==r?(st=$,$=A):(R=$,$=r)):(R=$,$=r),ae--,$===r&&(A=r,ae===0&&ye(Ne)),$}function Y3(){let $,A,U;if(ae++,$=R,A=[],U=t.charAt(R),B.test(U)?R++:(U=r,ae===0&&ye(G3)),U!==r)for(;U!==r;)A.push(U),U=t.charAt(R),B.test(U)?R++:(U=r,ae===0&&ye(G3));else A=r;return A!==r&&(st=$,A=kz()),$=A,ae--,$===r&&(A=r,ae===0&&ye(nz)),$}function eU(){let $,A,U;return ae++,$=R,Yt(),A=Wi(),A!==r?(t.charCodeAt(R)===37?(U=p,R++):(U=r,ae===0&&ye(az)),U!==r?(st=$,$=Cz(A)):(R=$,$=r)):(R=$,$=r),ae--,$===r&&ae===0&&ye(oz),$}function tU(){let $,A,U;return ae++,$=R,Yt(),A=Wi(),A!==r?(t.substr(R,2)===f?(U=f,R+=2):(U=r,ae===0&&ye(uz)),U!==r?(st=$,$=Pz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,Yt(),A=Wi(),A!==r?(t.substr(R,2)===m?(U=m,R+=2):(U=r,ae===0&&ye(cz)),U!==r?(st=$,$=Az(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,Yt(),A=Wi(),A!==r?(t.substr(R,2)===y?(U=y,R+=2):(U=r,ae===0&&ye(dz)),U!==r?(st=$,$=Rz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,Yt(),A=Wi(),A!==r?(t.substr(R,2)===g?(U=g,R+=2):(U=r,ae===0&&ye(hz)),U!==r?(st=$,$=Lz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,Yt(),A=Wi(),A!==r?(t.substr(R,2)===v?(U=v,R+=2):(U=r,ae===0&&ye(pz)),U!==r?(st=$,$=Fz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,Yt(),A=Wi(),A!==r?(t.substr(R,2)===_?(U=_,R+=2):(U=r,ae===0&&ye(fz)),U!==r?(st=$,$=Nz(A)):(R=$,$=r)):(R=$,$=r)))))),ae--,$===r&&ae===0&&ye(lz),$}function rU(){let $,A,U;return ae++,$=R,A=Wi(),A!==r?(t.substr(R,3)===S?(U=S,R+=3):(U=r,ae===0&&ye(yz)),U!==r?(st=$,$=Dz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,A=Wi(),A!==r?(t.substr(R,3)===M?(U=M,R+=3):(U=r,ae===0&&ye(gz)),U!==r?(st=$,$=jz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,A=Wi(),A!==r?(t.substr(R,4)===C?(U=C,R+=4):(U=r,ae===0&&ye(vz)),U!==r?(st=$,$=Vz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,A=Wi(),A!==r?(t.substr(R,4)===T?(U=T,R+=4):(U=r,ae===0&&ye(wz)),U!==r?(st=$,$=zz(A)):(R=$,$=r)):(R=$,$=r)))),ae--,$===r&&(A=r,ae===0&&ye(mz)),$}function iU(){let $,A;return ae++,$=R,Yt(),A=Wi(),A!==r?(st=$,$=Uz(A)):(R=$,$=r),ae--,$===r&&ae===0&&ye(bz),$}function sU(){let $,A,U,ce;if(ae++,$=R,t.charCodeAt(R)===35?(A=O,R++):(A=r,ae===0&&ye(Sz)),A!==r){if(U=[],ce=t.charAt(R),G.test(ce)?R++:(ce=r,ae===0&&ye(B3)),ce!==r)for(;ce!==r;)U.push(ce),ce=t.charAt(R),G.test(ce)?R++:(ce=r,ae===0&&ye(B3));else U=r;U!==r?(st=$,$=qz()):(R=$,$=r)}else R=$,$=r;return $===r&&($=R,A=I1(),A!==r&&(st=$,A=Gz(A)),$=A,$===r&&($=R,A=Y3(),A!==r&&(st=$,A=Bz()),$=A)),ae--,$===r&&(A=r,ae===0&&ye(_z)),$}function Wi(){let $,A,U,ce,De,pt,Dt,fr;for($=R,A=t.charAt(R),Q.test(A)?R++:(A=r,ae===0&&ye(H3)),A===r&&(A=null),U=R,ce=[],De=t.charAt(R),oe.test(De)?R++:(De=r,ae===0&&ye(Ho));De!==r;)ce.push(De),De=t.charAt(R),oe.test(De)?R++:(De=r,ae===0&&ye(Ho));if(t.charCodeAt(R)===46?(De=P,R++):(De=r,ae===0&&ye($z)),De!==r){if(pt=[],Dt=t.charAt(R),oe.test(Dt)?R++:(Dt=r,ae===0&&ye(Ho)),Dt!==r)for(;Dt!==r;)pt.push(Dt),Dt=t.charAt(R),oe.test(Dt)?R++:(Dt=r,ae===0&&ye(Ho));else pt=r;pt!==r?(ce=[ce,De,pt],U=ce):(R=U,U=r)}else R=U,U=r;if(U===r)if(U=[],ce=t.charAt(R),oe.test(ce)?R++:(ce=r,ae===0&&ye(Ho)),ce!==r)for(;ce!==r;)U.push(ce),ce=t.charAt(R),oe.test(ce)?R++:(ce=r,ae===0&&ye(Ho));else U=r;if(U!==r){if(ce=R,t.charCodeAt(R)===101?(De=D,R++):(De=r,ae===0&&ye(xz)),De!==r){if(pt=t.charAt(R),Q.test(pt)?R++:(pt=r,ae===0&&ye(H3)),pt===r&&(pt=null),Dt=[],fr=t.charAt(R),oe.test(fr)?R++:(fr=r,ae===0&&ye(Ho)),fr!==r)for(;fr!==r;)Dt.push(fr),fr=t.charAt(R),oe.test(fr)?R++:(fr=r,ae===0&&ye(Ho));else Dt=r;Dt!==r?(De=[De,pt,Dt],ce=De):(R=ce,ce=r)}else R=ce,ce=r;ce===r&&(ce=null),st=$,$=Hz()}else R=$,$=r;return $}function nU($,A){return $.map(function(U){return U[A]})}function oU($,A,U){return[$].concat(nU(A,U))}hp=n();const O1=hp!==r&&R===t.length;function K3(){throw hp!==r&&R<t.length&&ye(Zz()),Jz(Iy,_s<t.length?Wz(_s):null,_s<t.length?Z3(_s,_s+1):Z3(_s,_s))}return e.peg$library?{peg$result:hp,peg$currPos:R,peg$FAILED:r,peg$maxFailExpected:Iy,peg$maxFailPos:_s,peg$success:O1,peg$throw:O1?void 0:K3}:O1?hp:void K3()}function u9(t){if(!t||t.length===0)return null;if(typeof t=="string"){const r=wP(t);return r&&r.length!==0?r:null}const e=t.map(r=>{if(!Number.isFinite(r.scale)||r.scale<=0)throw new x("effect:invalid-scale","scale must be finite and greater than 0",{stop:r});return{scale:r.scale,effects:wP(r.value)}});e.sort((r,i)=>i.effects.length-r.effects.length);for(let r=0;r<e.length-1;r++){if(!MX(e[r].effects,e[r+1].effects))throw new x("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[r].effects,b:e[r+1].effects});IX(e[r].effects,e[r+1].effects)}return e.sort((r,i)=>i.scale-r.scale),e}function wP(t){let e;if(!t)return[];try{e=fpe(t)}catch(r){throw new x("effect:invalid-syntax","Invalid effect syntax",{value:t,error:r})}return e.map(r=>mpe(r))}function mpe(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return ype(t);case"opacity":return gpe(t);case"hue-rotate":return vpe(t);case"blur":return wpe(t);case"drop-shadow":return bpe(t);case"bloom":return _pe(t)}}catch(e){throw e.details.filter=t,e}throw new x("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function ype(t){let e=1;return lp(t.parameters,1),t.parameters.length===1&&(e=Gs(t.parameters[0])),new OS(t.name,e)}function gpe(t){let e=1;return lp(t.parameters,1),t.parameters.length===1&&(e=Gs(t.parameters[0])),new _D(e)}function vpe(t){let e=0;return lp(t.parameters,1),t.parameters.length===1&&(e=Ipe(t.parameters[0])),new wD(e)}function wpe(t){let e=0;return lp(t.parameters,1),t.parameters.length===1&&(e=v3(t.parameters[0]),xy(e,t.parameters[0])),new fD(e)}function bpe(t){const e=[];let r=null;for(const i of t.parameters)if(i.type==="color"){if(e.length&&Object.freeze(e),r)throw new x("effect:type-error","Accepts only one color",{});r=Epe(i)}else{const s=v3(i);if(Object.isFrozen(e))throw new x("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(s),e.length===3&&xy(s,i)}if(e.length<2||e.length>3)throw new x("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new gD(e[0],e[1],e[2]||0,r||c9("black"))}function _pe(t){let e=1,r=0,i=0;return lp(t.parameters,3),t.parameters[0]&&(e=Gs(t.parameters[0])),t.parameters[1]&&(r=v3(t.parameters[1]),xy(r,t.parameters[1])),t.parameters[2]&&(i=Gs(t.parameters[2])),new hD(e,r,i)}function lp(t,e){if(t.length>e)throw new x("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function y1(t){if(t.type==="color")return"<color>";if(t.unit){if(t.unit in g3)return"<length>";if(t.unit in y3)return"<angle>";if(t.unit==="%")return"<percentage>"}return"<double>"}function xy(t,e){if(t<0)throw new x("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function Spe(t){if(t.type!=="quantity"||t.unit!==null)throw new x("effect:type-error",`Expected <double>, Actual: ${y1(t)}`,{term:t})}function $pe(t){if(t.type!=="quantity"||t.unit!==null&&t.unit!=="%")throw new x("effect:type-error",`Expected <double> or <percentage>, Actual: ${y1(t)}`,{term:t})}const y3={deg:1,grad:.9,rad:180/Math.PI,turn:360};function xpe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&y3[t.unit]!=null))throw new x("effect:type-error",`Expected <angle>, Actual: ${y1(t)}`,{term:t})}const g3={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function Tpe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&g3[t.unit]!=null))throw new x("effect:type-error",`Expected <length>, Actual: ${y1(t)}`,{term:t})}function Gs(t){$pe(t);const e=t.value;return xy(e,t),t.unit==="%"?.01*e:e}function Mpe(t){return Spe(t),xy(t.value,t),t.value}function Ipe(t){return xpe(t),t.value*y3[t.unit]||0}function v3(t){return Tpe(t),t.value*g3[t.unit]||0}function Epe(t){switch(t.colorType){case"hex":return yJ(t.value);case"named":return c9(t.value);case"function":return Cpe(t.value)}}function c9(t){if(!L5(t))throw new x("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return mJ(t)}const Ope=/^rgba?/i,kpe=/^hsla?/i;function Cpe(t){if(lp(t.parameters,4),Ope.test(t.name))return[Gs(t.parameters[0]),Gs(t.parameters[1]),Gs(t.parameters[2]),t.parameters[3]?Gs(t.parameters[3]):1];if(kpe.test(t.name))return F5(Mpe(t.parameters[0]),Gs(t.parameters[1]),Gs(t.parameters[2]),t.parameters[3]?Gs(t.parameters[3]):1);throw new x("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}function qm(t,e,r){try{return Ape(t)}catch(i){r?.messages?.push(i)}return null}function Gm(t,e,r,i){try{const s=Ppe(t);Ht(r,s,e)}catch(s){i.messages&&i.messages.push(s)}}function Ppe(t){const e=u9(t);return e?EX(e)?e.map(r=>r.toJSON()):e.map(({scale:r,effects:i})=>({scale:r,value:i.map(s=>s.toJSON())})):null}function Ape(t){if(!t||t.length===0)return null;if(Rpe(t)){const e=[];for(const r of t)e.push({scale:r.scale,value:bP(r.value)});return e}return bP(t)}function Rpe(t){const e=t[0];return!!e&&"scale"in e}function bP(t){if(!t?.length)return"";const e=[];for(const r of t){let i=[];switch(r.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":i=[Zn(r,"amount")];break;case"blur":i=[Zn(r,"radius","pt")];break;case"hue-rotate":i=[Zn(r,"angle","deg")];break;case"drop-shadow":i=[Zn(r,"xoffset","pt"),Zn(r,"yoffset","pt"),Zn(r,"blurRadius","pt"),Lpe(r,"color")];break;case"bloom":i=[Zn(r,"strength"),Zn(r,"radius","pt"),Zn(r,"threshold")]}const s=`${r.type}(${i.filter(Boolean).join(" ")})`;u9(s),e.push(s)}return e.join(" ")}function Zn(t,e,r){if(t[e]==null)throw new x("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return r?t[e]+r:""+t[e]}function Lpe(t,e){if(t[e]==null)throw new x("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const r=t[e];return`rgba(${r[0]||0}, ${r[1]||0}, ${r[2]||0}, ${r[3]/255||0})`}const Fpe={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:{layerContainerTypes:qe}},"portal-item":{read:!0,write:{layerContainerTypes:qe}}}}},_P={read:{reader:qm},write:{allowNull:!0,writer:Gm,layerContainerTypes:qe}},Npe={json:{read:!1,write:!1,origins:{"web-map":_P,"portal-item":_P}}},Dpe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return a([c(Fpe)],r.prototype,"blendMode",void 0),a([c(Npe)],r.prototype,"effect",void 0),r=a([b("esri.layers.mixins.BlendLayer")],r),r},jpe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.customParameters=null}};return a([c({type:Object,json:{write:{overridePolicy:i=>({enabled:!!(i&&Object.keys(i).length>0)})}}})],r.prototype,"customParameters",void 0),r=a([b("esri.layers.mixins.CustomParametersMixin")],r),r},d9=96;function TIe(t,e){const r=t.extent,i=t.width,s=Hi(r?.spatialReference);return r&&i?r.width/i*s*YL*d9:0}function Vpe(t,e){return t/(Hi(e)*YL*d9)}function zpe(t,e){const r=t.extent,i=t.width-(t.padding?t.padding.left+t.padding.right:0),s=Vpe(e,r.spatialReference);return r.clone().expand(s*i/r.width)}function MIe(t,e,r){return Upe(t,e)&&qpe(t,r)}function Upe(t,e){return e===0||Ui(t,e)||t<e}function qpe(t,e){return e===0||Ui(t,e)||t>e}function Gpe(t,e){return Ui(t,e)?0:(t||Number.POSITIVE_INFINITY)>(e||Number.POSITIVE_INFINITY)?1:-1}const SP={write:{overridePolicy:(t,e,r)=>({enabled:!r||r.filterMode==="scale"})}};let bo=class extends pe(F){constructor(e){super(e),this.id=rp(),this.maxScale=0,this.minScale=0,this.title="",this.where=null}};a([c({type:String,json:{write:!0}})],bo.prototype,"id",void 0),a([c({type:Number,json:SP})],bo.prototype,"maxScale",void 0),a([c({type:Number,json:SP})],bo.prototype,"minScale",void 0),a([c({type:String,json:{write:!0}})],bo.prototype,"title",void 0),a([c({type:String,json:{write:!0}})],bo.prototype,"where",void 0),bo=a([b("esri.layers.support.DisplayFilter")],bo);function Bpe(t,e){return{...e,filterMode:t.mode}}function EIe(t,e){return h9(t,e).next().value??null}function OIe(t,e,r){const i=Hpe(t);if(i&&(G5(e,i[0])||cS(r,i[1])))return"";const s=Array.from(h9(t,e,r)),n=Wpe(s,e,r)?"1=1":s.map(o=>o.where||"1=1").reduce((o,l)=>Bte(o,l),"");return n&&n!=="1=1"?n:""}function Hpe(t){if(p9(t)==="manual")return null;const e=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:r,maxScale:i}of t.filters)e[0]=Math.max(e[0],Bm(r)),e[1]=Math.min(e[1],nw(i));return e}function*h9(t,e,r){if(p9(t)==="manual"){const i=t.filters.find(s=>s.id===t.activeFilterId);i&&(yield i)}else{typeof e=="object"&&(e=e.scale);for(const i of t.filters)Zpe(i.minScale,i.maxScale,e,r)&&(yield i)}}function Wpe(t,e,r){if(t.length===0)return!0;const i=Bm(t.at(0)?.minScale),s=nw(t.at(-1)?.maxScale);if(cS(i,e)||G5(s,r))return!0;for(let n=0;n<t.length-1;n++){const o=t[n],l=t[n+1];if(cS(Bm(l.minScale),nw(o.maxScale)))return!0}return!1}function Zpe(t,e,r,i){return t=Bm(t),r=Bm(r),e=nw(e),!(!Ui(r,t)&&(i??r)>t)&&!wJ(e,r)&&(i===void 0||!Ui(i,t))}function p9(t){return"mode"in t?t.mode:t.filterMode}function Bm(t){return t||Number.POSITIVE_INFINITY}function nw(t){return t||0}let Bl=class extends pe(F){constructor(e){super(e),this.activeFilterId=null,this.filters=new(H.ofType(bo)),this.mode="manual"}writeFilters(e,r,i,s){const n=e.toArray();this.mode==="scale"&&n.sort((o,l)=>{const u=Gpe(l.minScale,o.minScale),d=o.maxScale-l.maxScale;return u===0?d:u}),r[i]=n.map(o=>o.toJSON(s))}write(e,r){return super.write(e,Bpe(this,r))}};a([c({type:String,json:{write:{overridePolicy:(t,e,r)=>({enabled:r.filterMode==="manual",isRequired:!0})}}})],Bl.prototype,"activeFilterId",void 0),a([c({type:H.ofType(bo),nonNullable:!0,json:{write:!0}})],Bl.prototype,"filters",void 0),a([q("filters")],Bl.prototype,"writeFilters",null),a([c({type:["manual","scale"],nonNullable:!0,json:{name:"filterMode",write:!0}})],Bl.prototype,"mode",void 0),Bl=a([b("esri.layers.support.DisplayFilterInfo")],Bl);const Jpe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.displayFilterEnabled=!0,this.displayFilterInfo=null}};return a([c(Ype)],r.prototype,"displayFilterEnabled",void 0),a([c(Kpe)],r.prototype,"displayFilterInfo",void 0),r=a([b("esri.layers.mixins.DisplayFilteredLayer")],r),r},Ype={type:Boolean,json:{name:"layerDefinition.disableDisplayFilter",read:{reader:t=>!t},write:{layerContainerTypes:qe,writer(t,e,r){Ht(r,!t,e)}},origins:{"web-scene":{write:!1,read:!1}}}},Kpe={type:Bl,json:{name:"layerDefinition.displayFilterInfo",write:{enabled:!0,allowNull:!0,layerContainerTypes:qe},origins:{"web-scene":{write:!1,read:!1}}}},Qpe=xJ(),f9=new Map,m9=new Map;async function CIe(t,e,r){if(!t||!r)return!1;if(!e)return!0;const i=new URL(t).host;let s=f9.get(i);if(!s){const n=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");s=(await Ae(n,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return s===e}async function PIe(t,e,r=!1){if(!t||!e)return!0;const i=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),s=m9.get(i)?.entries();if(s){for(const[n,o]of s)if(o.name===e){const l=!o.stack?.hasForwardEdits();if(!l&&r){const[{deleteForwardEdits:u},{default:d}]=await Promise.all([N(()=>import("./deleteForwardEdits-wSNkHEWS.js"),[]),N(()=>import("./DeleteForwardEditsParameters-BEdkR6Gc.js"),[])]),p=await u(i,n,new d({sessionId:Qpe,moment:o.moment}));return p.success&&o.stack?.clearForwardEdits(),p.success}return l}}return!0}function Xpe(t,e){if(!t)return!1;const r=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),i=m9.get(r)?.entries();if(i){for(const[s,n]of i)if(n.name===e)return n.lockType==="edit"}return!1}const w3=new ML;function efe(t){return w3.on("apply-edits",new WeakRef(t))}function tfe(t){return w3.on("update-moment",new WeakRef(t))}function AIe(t,e,r=null,i=!1){const s=bi();return i=e==null||i,w3.emit("apply-edits",{serviceUrl:t,layerId:e,gdbVersion:r,mayReceiveServiceEdits:i,result:s.promise}),s}const y9=Symbol();function RIe(t){return t!=null&&typeof t=="object"&&y9 in t}function jp(t){return t!=null&&typeof t=="object"&&"gdbVersion"in t}function r_(t,e,r){const i=new URL(t).host,s=f9.get(i),n=o=>!o||o===s;return n(e)&&n(r)||e===r}const rfe=t=>{var s;var e;const r=t;let i=(s=class extends r{constructor(...n){super(...n),this[e]=!0,this._applyEditsHandler=o=>{const{serviceUrl:l,layerId:u,gdbVersion:d,mayReceiveServiceEdits:p,result:f}=o,m=l===this.url,y=u!=null&&this.layerId!=null&&u===this.layerId,g=jp(this),v=jp(this)&&r_(l,d,this.gdbVersion);if(!m||g&&!v||!y&&!p)return;const _=f.then(S=>{if(this.lastEditsEventDate=new Date,y&&(S.addedFeatures.length||S.updatedFeatures.length||S.deletedFeatures.length||S.addedAttachments.length||S.updatedAttachments.length||S.deletedAttachments.length))return this.emit("edits",E(S)),S;const M=S.editedFeatures?.find(({layerId:T})=>T===this.layerId);if(M){const{adds:T,updates:O,deletes:P}=M.editedFeatures,D={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:T?T.map(({attributes:z})=>({objectId:this.objectIdField&&z[this.objectIdField],globalId:this.globalIdField&&z[this.globalIdField]})):[],deletedFeatures:P?P.map(({attributes:z})=>({objectId:this.objectIdField&&z[this.objectIdField],globalId:this.globalIdField&&z[this.globalIdField]})):[],updatedFeatures:O?O.map(({current:{attributes:z}})=>({objectId:this.objectIdField&&z[this.objectIdField],globalId:this.globalIdField&&z[this.globalIdField]})):[],editedFeatures:E(S.editedFeatures),exceededTransferLimit:!1,historicMoment:E(S.historicMoment)};return this.emit("edits",D),D}const C={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:E(S.editedFeatures),exceededTransferLimit:!1,historicMoment:E(S.historicMoment)};return"historicMoment"in this&&this._shouldUpdateHistoricMoment(l,d,C.historicMoment)&&this.emit("edits",C),C}).then(S=>("historicMoment"in this&&this._shouldUpdateHistoricMoment(l,d,S.historicMoment)&&(this.historicMoment=S.historicMoment),S));this.emit("apply-edits",{result:_})},this._updateMomentHandler=o=>{const{serviceUrl:l,gdbVersion:u,moment:d}=o,p=l===this.url,f=jp(this),m=jp(this)&&r_(l,u,this.gdbVersion),y=jp(this)&&!r_(l,this.gdbVersion,null);p&&f&&m&&y&&"historicMoment"in this&&this.historicMoment!==d&&(this.historicMoment=d)},this.when().then(()=>{this.addHandles(efe(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(tfe(this._updateMomentHandler))},()=>{})}_shouldUpdateHistoricMoment(n,o,l){return"historicMoment"in this&&this.historicMoment!==l&&Xpe(n,o)}},e=y9,s);return a([c()],i.prototype,"lastEditsEventDate",void 0),i=a([b("esri.layers.mixins.EditBusLayer")],i),i};var ix;const i_=new $e({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),s_=new $e({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let gn=ix=class extends F{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:r,spatialRelationship:i,timeExtent:s,objectIds:n,units:o,distance:l}=this;return new re({geometry:E(r),objectIds:E(n),spatialRelationship:i,timeExtent:E(s),where:e,units:o,distance:l,...t})}clone(){const{where:t,geometry:e,spatialRelationship:r,timeExtent:i,objectIds:s,units:n,distance:o}=this;return new ix({geometry:E(e),objectIds:E(s),spatialRelationship:r,timeExtent:E(i),where:t,units:n,distance:o})}};a([c({type:String,json:{write:!0}})],gn.prototype,"where",void 0),a([c({types:hy,json:{write:!0}})],gn.prototype,"geometry",void 0),a([c({type:i_.apiValues,json:{name:"spatialRel",read:{reader:i_.read},write:{allowNull:!1,writer:i_.write,overridePolicy(){return{enabled:this.geometry!=null}}}}})],gn.prototype,"spatialRelationship",void 0),a([c({type:Number,json:{write:{overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],gn.prototype,"distance",void 0),a([c({type:[Number],json:{write:!0}})],gn.prototype,"objectIds",void 0),a([c({type:s_.apiValues,json:{read:s_.read,write:{writer:s_.write,overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],gn.prototype,"units",void 0),a([c({type:Et,json:{write:!0}})],gn.prototype,"timeExtent",void 0),gn=ix=a([b("esri.layers.support.FeatureFilter")],gn);const ife=gn;var sx;const $P={read:{reader:qm},write:{writer:Gm,overridePolicy(){return{allowNull:this.excludedEffect!=null,isRequired:this.excludedEffect==null}}}},xP={read:{reader:qm},write:{writer:Gm,overridePolicy(){return{allowNull:this.includedEffect!=null,isRequired:this.includedEffect==null}}}},TP={name:"showExcludedLabels",default:!0};let Hl=sx=class extends F{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(t,e){const r=super.write(t,e);if(e?.origin){if(r.filter){const i=Object.keys(r.filter);if(i.length>1||i[0]!=="where")return e.messages?.push(new x("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:e.layer,effect:this})),null}if("showExcludedLabels"in r)return e.messages?.push(new x("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:e.layer,effect:this})),null}return r}clone(){return new sx({filter:this.filter!=null?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};a([c({type:ife,json:{write:{allowNull:!0,writer(t,e,r,i){const s=t?.write({},i);s&&Object.keys(s).length!==0?Ht(r,s,e):Ht(r,null,e)}}}})],Hl.prototype,"filter",void 0),a([c({json:{read:qm,write:{writer:Gm,allowNull:!0},origins:{"web-map":$P,"portal-item":$P}}})],Hl.prototype,"includedEffect",void 0),a([c({json:{read:qm,write:{writer:Gm,allowNull:!0},origins:{"web-map":xP,"portal-item":xP}}})],Hl.prototype,"excludedEffect",void 0),a([c({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":TP,"portal-item":TP}}})],Hl.prototype,"excludedLabelsVisible",void 0),Hl=sx=a([b("esri.layers.support.FeatureEffect")],Hl);const MP={write:{allowNull:!0}},sfe={type:Hl,json:{origins:{"web-map":MP,"portal-item":MP}}},nfe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.featureEffect=null}};return a([c(sfe)],r.prototype,"featureEffect",void 0),r=a([b("esri.layers.mixins.FeatureEffectLayer")],r),r};var nx;let xf=nx=class extends F{constructor(t){super(t),this.expression=void 0,this.title=void 0}async collectRequiredFields(t,e){return Fr(t,e,null,this.expression)}clone(){return new nx({expression:this.expression,title:this.title})}equals(t){return this.expression===t.expression&&this.title===t.title}};a([c({type:String,json:{write:{isRequired:!0}}})],xf.prototype,"expression",void 0),a([c({type:String,json:{write:!0}})],xf.prototype,"title",void 0),xf=nx=a([b("esri.symbols.support.FeatureExpressionInfo")],xf);const IP=xf,g1={unknown:1,inches:gt(1,"meters","inches"),feet:gt(1,"meters","feet"),"us-feet":gt(1,"meters","us-feet"),yards:gt(1,"meters","yards"),miles:gt(1,"meters","miles"),"nautical-miles":gt(1,"meters","nautical-miles"),millimeters:gt(1,"meters","millimeters"),centimeters:gt(1,"meters","centimeters"),decimeters:gt(1,"meters","decimeters"),meters:gt(1,"meters","meters"),kilometers:gt(1,"meters","kilometers"),"decimal-degrees":1/FB(1,"meters",dt.radius)};function LIe(t){return!!t&&g1[t]!=null}function FIe(t){return 1/(g1[t]||1)}function ofe(){const t=Object.keys(g1);return eT(t,"decimal-degrees"),t.sort(),t}const afe=ofe(),yg=Ft()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),EP=new $e({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let co=class extends pe(F){constructor(e){super(e),this.featureExpressionInfo=void 0,this.offset=null}readFeatureExpressionInfo(e,r){return e!=null?e.expression?e:void 0:r.featureExpression&&r.featureExpression.value===0?{expression:"0"}:void 0}writeFeatureExpressionInfo(e,r,i,s){r[i]=e.write({},s),e.expression==="0"&&(r.featureExpression={value:0})}get mode(){const{offset:e,featureExpressionInfo:r}=this;return this._isOverridden("mode")?this._get("mode"):e!=null||r?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,r){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,r):null}equals(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&f7(this.featureExpressionInfo,e.featureExpressionInfo)}};a([c({type:IP,json:{write:!0}})],co.prototype,"featureExpressionInfo",void 0),a([V("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],co.prototype,"readFeatureExpressionInfo",null),a([q("featureExpressionInfo",{featureExpressionInfo:{type:IP},"featureExpression.value":{type:[0]}})],co.prototype,"writeFeatureExpressionInfo",null),a([c({type:yg.apiValues,nonNullable:!0,json:{type:yg.jsonValues,read:yg.read,write:{writer:yg.write,isRequired:!0}}})],co.prototype,"mode",null),a([c({type:Number,json:{write:!0}})],co.prototype,"offset",void 0),a([c({type:afe,json:{type:String,read:EP.read,write:EP.write}})],co.prototype,"unit",null),co=a([b("esri.symbols.support.ElevationInfo")],co);let Xc=class extends F{constructor(e){super(e),this.description=null,this.label=null,this.type=null}};a([c({type:String,json:{write:!0}})],Xc.prototype,"description",void 0),a([c({type:String,json:{write:!0}})],Xc.prototype,"label",void 0),a([c()],Xc.prototype,"type",void 0),Xc=a([b("esri.tables.elements.AttributeTableElement")],Xc);const up=Xc;let Tf=class extends pe(up){constructor(e){super(e),this.displayType="auto",this.type="attachment"}clone(){return super.clone()}};a([c({type:["auto"],json:{write:!0}})],Tf.prototype,"displayType",void 0),a([c({type:["attachment"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],Tf.prototype,"type",void 0),Tf=a([b("esri.tables.elements.AttributeTableAttachmentElement")],Tf);const g9=Tf;let Wl=class extends pe(up){constructor(e){super(e),this.description=null,this.fieldName=null,this.label=null,this.type="field"}clone(){return super.clone()}};a([c({type:String,json:{read:!1,write:!1}})],Wl.prototype,"description",void 0),a([c({type:String,json:{write:{enabled:!0,isRequired:!0}}})],Wl.prototype,"fieldName",void 0),a([c({type:String,json:{read:!1,write:!1}})],Wl.prototype,"label",void 0),a([c({type:["field"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],Wl.prototype,"type",void 0),Wl=a([b("esri.tables.elements.AttributeTableFieldElement")],Wl);const v9=Wl;let Mf=class extends pe(up){constructor(e){super(e),this.relationshipId=null,this.type="relationship"}clone(){return super.clone()}};a([c({type:Number,json:{type:xe,write:{enabled:!0,isRequired:!0}}})],Mf.prototype,"relationshipId",void 0),a([c({type:["relationship"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],Mf.prototype,"type",void 0),Mf=a([b("esri.tables.elements.AttributeTableRelationshipElement")],Mf);const w9=Mf,b9={base:up,key:"type",typeMap:{attachment:g9,field:v9,relationship:w9}};function lfe(t){return{typesWithGroup:{base:up,key:"type",typeMap:{attachment:g9,field:v9,group:t,relationship:w9}},typesWithoutGroup:b9}}let If=class extends pe(up){constructor(e){super(e),this.elements=null,this.type="group"}clone(){return super.clone()}};a([c({types:[b9],json:{name:"attributeTableElements",write:!0}})],If.prototype,"elements",void 0),a([c({type:["group"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],If.prototype,"type",void 0),If=a([b("esri.tables.elements.AttributeTableGroupElement")],If);const ufe=If;let Ef=class extends pe(F){constructor(e){super(e),this.field=null,this.order=null}};a([c({type:String,json:{write:!0}})],Ef.prototype,"field",void 0),a([c({type:["asc","desc"],json:{write:!0}})],Ef.prototype,"order",void 0),Ef=a([b("esri.tables.support.FieldOrder")],Ef);const cfe=Ef;var ox;const dfe=lfe(ufe);let Of=ox=class extends F{constructor(t){super(t),this.elements=null,this.orderByFields=null}clone(){return new ox({elements:E(this.elements),orderByFields:E(this.orderByFields)})}};a([c({types:[dfe.typesWithGroup],json:{name:"attributeTableElements",write:!0}})],Of.prototype,"elements",void 0),a([c({type:[cfe],json:{write:!0}})],Of.prototype,"orderByFields",void 0),Of=ox=a([b("esri.tables.AttributeTableTemplate")],Of);const hfe=Of,pfe={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:qe}}},v1={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,r){e[r]=!t}}}},w1={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:qe}}},ffe={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:Eu}}},mfe={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:qe}}},yfe={value:null,type:co,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:qe}}};function GIe(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const _9={write:{enabled:!0,layerContainerTypes:qe},read:!0},ax={type:Number,json:{origins:{"web-document":_9,"portal-item":{write:{layerContainerTypes:qe}}}}},gfe={...ax,json:{...ax.json,origins:{"web-document":{..._9,write:{enabled:!0,layerContainerTypes:qe,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,r)=>r&&r.origin!=="service"||!e.drawingInfo||e.drawingInfo.transparency===void 0?e.layerDefinition?.drawingInfo&&e.layerDefinition.drawingInfo.transparency!==void 0?Tm(e.layerDefinition.drawingInfo.transparency):void 0:Tm(e.drawingInfo.transparency)}}},BIe={type:he,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const r=he.fromJSON(t);return e.spatialReference!=null&&typeof e.spatialReference=="object"&&(r.spatialReference=Z.fromJSON(e.spatialReference)),r}}}},read:!1}},vfe={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},wfe={type:Number,json:{origins:{service:{write:{enabled:!1}}},name:"layerDefinition.minScale",write:{layerContainerTypes:qe}}},bfe={type:Number,json:{origins:{service:{write:{enabled:!1}}},name:"layerDefinition.maxScale",write:{layerContainerTypes:qe}}},S9={json:{write:{ignoreOrigin:!0,layerContainerTypes:qe},origins:{"web-map":{read:!1,write:!1}}}},_fe={type:hfe,json:{name:"attributeTableInfo",write:!0}};let ho=class extends pe(F){constructor(e){super(e),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.timeZone=null}};a([c()],ho.prototype,"creatorField",void 0),a([c()],ho.prototype,"creationDateField",void 0),a([c()],ho.prototype,"editorField",void 0),a([c()],ho.prototype,"editDateField",void 0),a([c()],ho.prototype,"realm",void 0),a([c(Ov("dateFieldsTimeReference",!0))],ho.prototype,"timeZone",void 0),ho=a([b("esri.layers.support.EditFieldsInfo")],ho);let _n=class extends pe(F){constructor(e){super(e)}};a([c({constructOnly:!0,json:{write:!0}})],_n.prototype,"name",void 0),a([c({constructOnly:!0,json:{write:!0}})],_n.prototype,"fields",void 0),a([c({constructOnly:!0,json:{write:!0}})],_n.prototype,"isAscending",void 0),a([c({constructOnly:!0,json:{write:!0}})],_n.prototype,"indexType",void 0),a([c({constructOnly:!0,json:{write:!0}})],_n.prototype,"isUnique",void 0),a([c({constructOnly:!0,json:{write:!0}})],_n.prototype,"description",void 0),_n=a([b("esri.layers.support.FeatureIndex")],_n);async function Sfe(t,e,r){e=e.clone(),t.capabilities.query.supportsMaxRecordCountFactor&&(e.maxRecordCountFactor=$9(t));const i=$fe(t),s=t.capabilities.query.supportsPagination;e.start=0,e.num=i;let n=null;for(;;){const o=await t.source.queryFeaturesJSON(e,r);if(n==null?n=o:n.features=n.features.concat(o.features),n.exceededTransferLimit=o.exceededTransferLimit,!s||!o.exceededTransferLimit)break;e.start+=i}return n}function $fe(t){return $9(t)*xfe(t)}function xfe(t){return t.capabilities.query.maxRecordCount||2e3}function $9(t){return t.capabilities.query.supportsMaxRecordCountFactor?re.MAX_MAX_RECORD_COUNT_FACTOR:1}var lx;let kf=lx=class extends F{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new lx({minValue:this.minValue,maxValue:this.maxValue})}};a([c({type:Number,json:{write:!0}})],kf.prototype,"minValue",void 0),a([c({type:Number,json:{write:!0}})],kf.prototype,"maxValue",void 0),kf=lx=a([b("esri.renderers.support.AuthoringInfoClassBreakInfo")],kf);var ux;let Sa=ux=class extends F{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=new Array}clone(){return new ux({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:E(this.classBreakInfos)})}};a([c({type:String,json:{write:!0}})],Sa.prototype,"field",void 0),a([c({type:String,json:{write:!0}})],Sa.prototype,"normalizationField",void 0),a([c({type:String,json:{write:!0}})],Sa.prototype,"label",void 0),a([c({type:[kf],json:{write:!0}})],Sa.prototype,"classBreakInfos",void 0),Sa=ux=a([b("esri.renderers.support.AuthoringInfoFieldInfo")],Sa);var cx;let ed=cx=class extends F{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new cx({label:this.label,value:this.value,size:this.size})}};a([c({type:String,json:{write:!0}})],ed.prototype,"label",void 0),a([c({type:Number,json:{write:!0}})],ed.prototype,"size",void 0),a([c({type:Number,json:{write:!0}})],ed.prototype,"value",void 0),ed=cx=a([b("esri.renderers.support.AuthoringInfoSizeStop")],ed);const Tfe=ed;var dx;const gg=new $e({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),vg=new $e({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),OP={key:t=>typeof t=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},kP=["high-to-low","above-and-below","centered-on","extremes"],CP=[...new Set(["high-to-low","above-and-below","centered-on","extremes","above","below","high-to-low","above-and-below","above","below","reference-size","spike"])],PP=["seconds","minutes","hours","days","months","years"],Mfe=["circle","diamond","hexagon-flat","hexagon-pointy","square"],Ife=["triangle-closed-outline","triangle-gradient-fill-closed","triangle-gradient-fill-closed-outline","triangle-gradient-fill-open","triangle-gradient-fill-open-outline","triangle-open-outline","triangle-solid-fill-closed","triangle-solid-fill-closed-outline","triangle-solid-fill-open","triangle-solid-fill-open-outline"];let jt=dx=class extends F{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return typeof t=="string"||typeof t=="number"?t:null}get normalizationField(){return this.theme==="reference-size"||this.theme==="spike"?this._get("normalizationField"):null}set normalizationField(t){this._set("normalizationField",t)}get referenceSizeScale(){return this.theme==="reference-size"?this._get("referenceSizeScale"):null}set referenceSizeScale(t){this._set("referenceSizeScale",t)}get referenceSizeSymbolStyle(){return this.theme==="reference-size"?this._get("referenceSizeSymbolStyle"):null}set referenceSizeSymbolStyle(t){this._set("referenceSizeSymbolStyle",t)}get spikeSymbolStyle(){return this.theme==="spike"?this._get("spikeSymbolStyle"):null}set spikeSymbolStyle(t){this._set("spikeSymbolStyle",t)}castStartTime(t){return typeof t=="string"||typeof t=="number"?t:null}get sizeStops(){return this.theme==="reference-size"||this.theme==="spike"?this._get("sizeStops"):null}set sizeStops(t){this._set("sizeStops",t)}get style(){return this.type==="color"?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new dx({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,normalizationField:this.normalizationField,referenceSizeScale:this.referenceSizeScale,referenceSizeSymbolStyle:this.referenceSizeSymbolStyle,spikeSymbolStyle:this.spikeSymbolStyle,sizeStops:E(this.sizeStops),startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};a([c({types:OP,json:{write:!0}})],jt.prototype,"endTime",void 0),a([Ce("endTime")],jt.prototype,"castEndTime",null),a([c({type:String,json:{write:!0}})],jt.prototype,"field",void 0),a([c({type:Number,json:{write:!0}})],jt.prototype,"maxSliderValue",void 0),a([c({type:Number,json:{write:!0}})],jt.prototype,"minSliderValue",void 0),a([c({type:String,json:{origins:{"web-scene":{write:!1}},write:!0}})],jt.prototype,"normalizationField",null),a([c({type:Number,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],jt.prototype,"referenceSizeScale",null),a([c({type:Mfe,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],jt.prototype,"referenceSizeSymbolStyle",null),a([c({type:Ife,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],jt.prototype,"spikeSymbolStyle",null),a([c({types:OP,json:{write:!0}})],jt.prototype,"startTime",void 0),a([Ce("startTime")],jt.prototype,"castStartTime",null),a([c({type:[Tfe],json:{origins:{"web-scene":{write:!1}},write:!0}})],jt.prototype,"sizeStops",null),a([c({type:gg.apiValues,value:null,json:{type:gg.jsonValues,read:gg.read,write:gg.write}})],jt.prototype,"style",null),a([c({type:CP,value:null,json:{type:CP,origins:{"web-scene":{type:kP,write:{writer:(t,e)=>{kP.includes(t)&&(e.theme=t)}}}},write:!0}})],jt.prototype,"theme",null),a([c({type:vg.apiValues,json:{type:vg.jsonValues,read:vg.read,write:vg.write}})],jt.prototype,"type",void 0),a([c({type:PP,json:{type:PP,write:!0}})],jt.prototype,"units",void 0),jt=dx=a([b("esri.renderers.support.AuthoringInfoVisualVariable")],jt);const Efe=jt;let Vd=class extends F{constructor(e){super(e),this.type=null}};a([c({readOnly:!0,json:{read:!1,write:!0}})],Vd.prototype,"type",void 0),Vd=a([b("esri.rest.support.ColorRamp")],Vd);var hx;let Eo=hx=class extends Vd{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new hx({fromColor:E(this.fromColor),toColor:E(this.toColor),algorithm:this.algorithm})}};a([se({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],Eo.prototype,"algorithm",void 0),a([c({type:ue,json:{type:[xe],write:{isRequired:!0}}})],Eo.prototype,"fromColor",void 0),a([c({type:ue,json:{type:[xe],write:{isRequired:!0}}})],Eo.prototype,"toColor",void 0),a([c({type:["algorithmic"],json:{write:{isRequired:!0}}})],Eo.prototype,"type",void 0),Eo=hx=a([b("esri.rest.support.AlgorithmicColorRamp")],Eo);var px;let _o=px=class extends Vd{constructor(t){super(t),this.colorRamps=null,this.type="multipart",this.weights=void 0}writeColorRamps(t,e,r,i){const s=t?.map(o=>o.toJSON(i)),{weights:n}=this;if(s&&n?.length&&s.length===n?.length){const o=100/n.reduce((u,d)=>u+d);let l=0;s.forEach((u,d)=>{u.start=l,l+=n[d]*o,u.stop=l})}e.colorRamps=s}readWeights(t,e){const r=e.colorRamps?.map(({start:i,stop:s})=>i==null||s==null?-1:s-i);if(!r?.some(i=>i<0))return r}clone(){return new px({colorRamps:E(this.colorRamps)})}};a([c({type:[Eo],json:{write:{isRequired:!0}}})],_o.prototype,"colorRamps",void 0),a([q("colorRamps")],_o.prototype,"writeColorRamps",null),a([c({type:["multipart"],json:{write:{isRequired:!0}}})],_o.prototype,"type",void 0),a([c({type:[Number]})],_o.prototype,"weights",void 0),a([V("weights",["colorRamps"])],_o.prototype,"readWeights",null),_o=px=a([b("esri.rest.support.MultipartColorRamp")],_o);const Ofe={key:"type",base:Vd,typeMap:{algorithmic:Eo,multipart:_o}};function kfe(t){return t?.type?t.type==="algorithmic"?Eo.fromJSON(t):t.type==="multipart"?_o.fromJSON(t):null:null}var fx;const Sl=new $e({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),wg=new $e({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),AP=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers"],Cfe=["high-to-low","above-and-below","above","below"],Pfe=["flow-line","wave-front"],Afe=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let et=fx=class extends F{constructor(t){super(t),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&e!=="relationship"?e==="class-breaks-size"||e==="class-breaks-color"?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){return t?kfe(t):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(t){this._set("field2",t)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(t){this._set("flowTheme",t)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&t!=="relationship"&&t!=="class-breaks-size"&&t!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;t==="classed-size"?e="class-breaks-size":t==="classed-color"&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){return new fx({classificationMethod:this.classificationMethod,colorRamp:E(this.colorRamp),fadeRatio:E(this.fadeRatio),fields:this.fields?.slice(),field1:E(this.field1),field2:E(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(t=>t.clone()),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};a([c({type:Sl.apiValues,value:null,json:{type:Sl.jsonValues,read:Sl.read,write:Sl.write,origins:{"web-document":{default:"manual",type:Sl.jsonValues,read:Sl.read,write:Sl.write}}}})],et.prototype,"classificationMethod",null),a([c({types:Ofe,json:{write:!0}})],et.prototype,"colorRamp",void 0),a([V("colorRamp")],et.prototype,"readColorRamp",null),a([c({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],et.prototype,"fadeRatio",void 0),a([c({type:[String],value:null,json:{write:!0}})],et.prototype,"fields",null),a([c({type:Sa,value:null,json:{write:!0}})],et.prototype,"field1",null),a([c({type:Sa,value:null,json:{write:!0}})],et.prototype,"field2",null),a([c({type:Pfe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],et.prototype,"flowTheme",null),a([c({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],et.prototype,"focus",null),a([c({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],et.prototype,"isAutoGenerated",void 0),a([c({type:Number,value:null,json:{type:xe,write:!0}})],et.prototype,"numClasses",null),a([c({type:AP,json:{type:AP,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],et.prototype,"lengthUnit",void 0),a([c({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],et.prototype,"maxSliderValue",void 0),a([c({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],et.prototype,"minSliderValue",void 0),a([c({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],et.prototype,"statistics",null),a([c({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],et.prototype,"standardDeviationInterval",null),a([c({type:wg.apiValues,value:null,json:{type:wg.jsonValues,read:wg.read,write:wg.write}})],et.prototype,"type",null),a([c({type:[Efe],json:{write:!0}})],et.prototype,"visualVariables",void 0),a([c({type:Afe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],et.prototype,"univariateSymbolStyle",null),a([c({type:Cfe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],et.prototype,"univariateTheme",null),et=fx=a([b("esri.renderers.support.AuthoringInfo")],et);const n_=new $e({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let ji=class extends F{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const r=new Set;return await this.collectRequiredFields(r,e),Array.from(r).sort()}getSymbol(e,r){}async getSymbolAsync(e,r){}get symbols(){return[]}get arcadeRequired(){return!1}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};a([c({type:et,json:{write:!0}})],ji.prototype,"authoringInfo",void 0),a([c({type:n_.apiValues,readOnly:!0,json:{type:n_.jsonValues,read:!1,write:{writer:n_.write,ignoreOrigin:!0,isRequired:!0}}})],ji.prototype,"type",void 0),ji=a([b("esri.renderers.Renderer")],ji);let Cf=class extends pe(F){constructor(){super(...arguments),this.showLegend=null,this.title=null}};a([c({type:Boolean,json:{write:!0}})],Cf.prototype,"showLegend",void 0),a([c({type:String,json:{write:!0}})],Cf.prototype,"title",void 0),Cf=a([b("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],Cf);const x9=Cf,o_=new $e({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let $r=class extends F{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return e==null?e:typeof e=="function"?(L.getLogger(this).error(".field: field must be a string value"),null):ey(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};a([c()],$r.prototype,"index",void 0),a([c({type:o_.apiValues,readOnly:!0,json:{read:o_.read,write:{writer:o_.write,isRequired:!0}}})],$r.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],$r.prototype,"field",void 0),a([Ce("field")],$r.prototype,"castField",null),a([c({type:String,json:{write:!0}})],$r.prototype,"valueExpression",void 0),a([c({type:String,json:{write:!0}})],$r.prototype,"valueExpressionTitle",void 0),a([c({readOnly:!0})],$r.prototype,"arcadeRequired",null),a([c({type:x9,json:{write:!0}})],$r.prototype,"legendOptions",void 0),$r=a([b("esri.renderers.visualVariables.VisualVariable")],$r);var mx;let Zl=mx=class extends F{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,r){e[r]=t??0}clone(){return new mx({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};a([c({type:ue,json:{type:[xe],write:{isRequired:!0}}})],Zl.prototype,"color",void 0),a([c({type:String,json:{write:!0}})],Zl.prototype,"label",void 0),a([c({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],Zl.prototype,"value",void 0),a([q("value")],Zl.prototype,"writeValue",null),Zl=mx=a([b("esri.renderers.visualVariables.support.ColorStop")],Zl);const Rfe=Zl;var yx;let $a=yx=class extends $r{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,r)=>e.value-r.value),this._set("stops",t)}clone(){return new yx({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(t=>t.clone()),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};a([c({readOnly:!0})],$a.prototype,"cache",null),a([c({type:["color"],json:{type:["colorInfo"]}})],$a.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],$a.prototype,"normalizationField",void 0),a([c({type:[Rfe],json:{write:!0}})],$a.prototype,"stops",null),$a=yx=a([b("esri.renderers.visualVariables.ColorVariable")],$a);var gx;let ma=gx=class extends F{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return Tm(e.transparency)}writeOpacity(t,e,r){e[r]=Vw(t)}clone(){return new gx({label:this.label,opacity:this.opacity,value:this.value})}};a([c({type:String,json:{write:!0}})],ma.prototype,"label",void 0),a([c({type:Number,json:{type:xe,write:{target:"transparency",isRequired:!0}}})],ma.prototype,"opacity",void 0),a([V("opacity",["transparency"])],ma.prototype,"readOpacity",null),a([q("opacity")],ma.prototype,"writeOpacity",null),a([c({type:Number,json:{write:{isRequired:!0}}})],ma.prototype,"value",void 0),ma=gx=a([b("esri.renderers.visualVariables.support.OpacityStop")],ma);const Lfe=ma;var vx;let Oo=vx=class extends $r{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,r)=>e.value-r.value),this._set("stops",t)}clone(){return new vx({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(t=>t.clone()),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};a([c({readOnly:!0})],Oo.prototype,"cache",null),a([c({type:["opacity"],json:{type:["transparencyInfo"]}})],Oo.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],Oo.prototype,"normalizationField",void 0),a([c({type:[Lfe],json:{write:!0}})],Oo.prototype,"stops",null),Oo=vx=a([b("esri.renderers.visualVariables.OpacityVariable")],Oo);var wx;let xa=wx=class extends $r{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic"}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}clone(){return new wx({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions?.clone()})}};a([c({readOnly:!0})],xa.prototype,"cache",null),a([c({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],xa.prototype,"axis",void 0),a([c({type:["rotation"],json:{type:["rotationInfo"]}})],xa.prototype,"type",void 0),a([c({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],xa.prototype,"rotationType",void 0),xa=wx=a([b("esri.renderers.visualVariables.RotationVariable")],xa);function Ffe(t){return Me(t)}var bx;let Bs=bx=class extends F{constructor(t){super(t),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new bx({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};a([c({type:String,json:{write:!0}})],Bs.prototype,"label",void 0),a([c({type:Number,cast:Me,json:{write:{isRequired:!0}}})],Bs.prototype,"size",void 0),a([c({type:Number,json:{write:{isRequired:!0}}})],Bs.prototype,"value",void 0),a([c({type:Boolean,json:{write:!1}})],Bs.prototype,"useMinValue",void 0),a([c({type:Boolean,json:{write:!1}})],Bs.prototype,"useMaxValue",void 0),Bs=bx=a([b("esri.renderers.visualVariables.support.SizeStop")],Bs);let z0=class extends x9{constructor(){super(...arguments),this.customValues=null}};a([c({type:[Number],json:{write:!0}})],z0.prototype,"customValues",void 0),z0=a([b("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],z0);const Nfe=z0;function bd(t){return t&&t.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function zu(t){return t!=null&&!isNaN(t)&&isFinite(t)}function T9(t){return t.valueExpression?"expression":t.field&&typeof t.field=="string"?"field":"unknown"}function Dfe(t,e){const r=e||T9(t),i=t.valueUnit||"unknown";return r==="unknown"?"constant":t.stops?"stops":t.minSize!=null&&t.maxSize!=null&&t.minDataValue!=null&&t.maxDataValue!=null?"clamped-linear":i==="unknown"?t.minSize!=null&&t.minDataValue!=null?t.minSize&&t.minDataValue?"proportional":"additive":"identity":"real-world-size"}const M9=()=>L.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),b1=t=>M9().warn(`The visualVariable should be an instance of esri.renderers.visualVariables.${t}`),_1=()=>M9().error("Use of arcade expressions requires an arcade context"),RP=new nt,U0=Math.PI,I9=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function E9(t,e,r){const i="visualVariables"in t?t.visualVariables?.find(g=>g.type==="color"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void b1("ColorVariable");const s=typeof e=="number",n=s?null:e,o=n?.attributes;let l=s?e:null;const u=i.field,{ipData:d,hasExpression:p}=i.cache;let f=i.cache.compiledFunc;if(!u&&!p){const g=i.stops;return g&&g[0]&&g[0].color}if(typeof l!="number")if(p){if(r?.arcade==null)return void _1();const g={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,_=v.getViewInfo(g),S=v.createExecContext(n,_,r.timeZone);if(!f){const M=v.createSyntaxTree(i.valueExpression);f=v.createFunction(M),i.cache.compiledFunc=f}l=v.executeFunction(f,S)}else o&&(l=o[u]);const m=i.normalizationField,y=o!=null&&m!=null?parseFloat(o[m]):void 0;if(l!=null&&(!m||s||!isNaN(y)&&y!==0)){zu(y)&&!s&&(l/=y);const g=b3(l,d);if(g){const v=g[0],_=g[1],S=v===_?i.stops[v].color:ue.blendColors(i.stops[v].color,i.stops[_].color,g[2],r?.color);return new ue(S)}}}function O9(t,e,r){const i="visualVariables"in t?t.visualVariables?.find(g=>g.type==="opacity"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void b1("OpacityVariable");const s=typeof e=="number",n=s?null:e,o=n?.attributes;let l=s?e:null;const u=i.field,{ipData:d,hasExpression:p}=i.cache;let f=i.cache.compiledFunc;if(!u&&!p){const g=i.stops;return g&&g[0]&&g[0].opacity}if(typeof l!="number")if(p){if(r?.arcade==null)return void _1();const g={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,_=v.getViewInfo(g),S=v.createExecContext(n,_,r.timeZone);if(!f){const M=v.createSyntaxTree(i.valueExpression);f=v.createFunction(M),i.cache.compiledFunc=f}l=v.executeFunction(f,S)}else o&&(l=o[u]);const m=i.normalizationField,y=o!=null&&m!=null?parseFloat(o[m]):void 0;if(l!=null&&(!m||s||!isNaN(y)&&y!==0)){zu(y)&&!s&&(l/=y);const g=b3(l,d);if(g){const v=g[0],_=g[1];if(v===_)return i.stops[v].opacity;{const S=i.stops[v].opacity;return S+(i.stops[_].opacity-S)*g[2]}}}}function k9(t,e,r){const i="visualVariables"in t?t.visualVariables?.find(y=>y.type==="rotation"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void b1("RotationVariable");const s=i.axis||"heading",n=s==="heading"&&i.rotationType==="arithmetic"?90:0,o=s==="heading"&&i.rotationType==="arithmetic"?-1:1,l=typeof e=="number"?null:e,u=l?.attributes,d=i.field,{hasExpression:p}=i.cache;let f=i.cache.compiledFunc,m=null;if(!d&&!p)return m;if(p){if(r?.arcade==null)return void _1();const y={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},g=r.arcade.arcadeUtils,v=g.getViewInfo(y),_=g.createExecContext(l,v,r.timeZone);if(!f){const S=g.createSyntaxTree(i.valueExpression);f=g.createFunction(S),i.cache.compiledFunc=f}m=g.executeFunction(f,_)}else u&&(m=u[d]);return m=typeof m!="number"||isNaN(m)?null:n+o*m,m}function jfe(t,e,r){const i=typeof e=="number",s=i?null:e,n=s?.attributes;let o=i?e:null;const{isScaleDriven:l}=t.cache;let u=t.cache.compiledFunc;if(l){const p=r?.scale,f=r?.view;o=p==null||f==="3d"?Vfe(t):p}else if(!i)switch(t.inputValueType){case"expression":{if(r?.arcade==null)return void _1();const p={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},f=r.arcade.arcadeUtils,m=f.getViewInfo(p),y=f.createExecContext(s,m,r.timeZone);if(!u){const g=f.createSyntaxTree(t.valueExpression);u=f.createFunction(g),t.cache.compiledFunc=u}o=f.executeFunction(u,y);break}case"field":n&&(o=n[t.field]);break;case"unknown":o=null}if(!zu(o))return null;if(i||!t.normalizationField)return o;const d=n?parseFloat(n[t.normalizationField]):null;return zu(d)&&d!==0?o/d:null}function Vfe(t){let e=null,r=null;const i=t.stops;return i?(e=i[0].value,r=i[i.length-1].value):(e=t.minDataValue||0,r=t.maxDataValue||0),(e+r)/2}function S1(t,e,r){const i="visualVariables"in t?t.visualVariables?.find(n=>n.type==="size"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void b1("SizeVariable");const s=P9(jfe(i,e,r),i,e,r,i.cache.ipData);return s==null||isNaN(s)?void 0:s}function wi(t,e,r){return t==null?null:bd(t)?S1(t,e,r):zu(t)?t:null}function C9(t,e,r){return zu(r)&&t>r?r:zu(e)&&t<e?e:t}function zfe(t,e,r,i){const s=wi(e.minSize,r,i)||e.minDataValue;return t==null&&s==null?null:(t??0)+(s??0)}function Ufe(t,e,r){const i=t.stops;let s=i?.length&&i[0].size;return s==null&&(s=t.minSize),wi(s,e,r)}function qfe(t,e,r,i){const s=wi(e.minSize,r,i);if(t==null)return s;const{minDataValue:n,maxDataValue:o}=e;if(n==null||o==null)return null;const l=(t-n)/(o-n),u=wi(e.maxSize,r,i),d=i?.shape;if(t<=n)return s;if(t>=o)return u;if(s==null||u==null)return null;if(e.scaleBy==="area"&&d){const p=d==="circle",f=p?U0*(s/2)**2:s*s,m=f+l*((p?U0*(u/2)**2:u*u)-f);return p?2*Math.sqrt(m/U0):Math.sqrt(m)}return s+l*(u-s)}function Gfe(t,e,r,i){const s=wi(e.minSize,r,i);if(t==null||s==null)return s;const n=i?.shape,{minDataValue:o}=e;if(o==null)return null;const l=t/o,u=wi(e.maxSize,r,i);let d=null;return d=n==="circle"?2*Math.sqrt(l*(s/2)**2):n==="square"||n==="diamond"||n==="image"?Math.sqrt(l*s**2):l*s,C9(d,s,u)}function Bfe(t,e,r,i,s){if(t==null)return null;const[n,o,l]=b3(t,s);if(n===o)return wi(e.stops?.[n].size,r,i);{const u=wi(e.stops?.[n].size,r,i),d=wi(e.stops?.[o].size,r,i);return u==null||d==null?null:u+(d-u)*l}}function Hfe(t,e,r,i){const s=(i?.resolution??1)*g1[e.valueUnit],n=wi(e.minSize,r,i),o=wi(e.maxSize,r,i),{valueRepresentation:l}=e;if(t==null)return n;let u=null;return u=l==="area"?2*Math.sqrt(t/U0)/s:l==="radius"||l==="distance"?2*t/s:t/s,C9(u,n,o)}function P9(t,e,r,i,s){switch(e.transformationType){case"additive":return zfe(t,e,r,i);case"constant":return Ufe(e,r,i);case"clamped-linear":return qfe(t,e,r,i);case"proportional":return Gfe(t,e,r,i);case"stops":return Bfe(t,e,r,i,s);case"real-world-size":return Hfe(t,e,r,i);case"identity":return t;case"unknown":return null}}function Wfe(t,e,r){const{isScaleDriven:i}=t.cache;if(!(i&&r==="3d"||e))return null;const s={scale:e,view:r};let n=wi(t.minSize,RP,s),o=wi(t.maxSize,RP,s);if(n!=null||o!=null){if(n>o){const l=o;o=n,n=l}return{minSize:n,maxSize:o}}}function Zfe(t,e,r){if(!t.visualVariables)return;const i=[],s=[],n=[],o=[],l=[];for(const u of t.visualVariables)switch(u.type){case"color":s.push(u);break;case"opacity":n.push(u);break;case"rotation":l.push(u);break;case"size":o.push(u)}return s.forEach(u=>{const d=E9(u,e,r);i.push({variable:u,value:d})}),n.forEach(u=>{const d=O9(u,e,r);i.push({variable:u,value:d})}),l.forEach(u=>{const d=k9(u,e,r);i.push({variable:u,value:d})}),o.forEach(u=>{const d=S1(u,e,r);i.push({variable:u,value:d})}),i}function b3(t,e){if(!e)return;let r=0,i=e.length-1;return e.some((s,n)=>t<s?(i=n,!0):(r=n,!1)),[r,i,(t-e[r])/(e[i]-e[r])]}function Jfe(t,e,r){const i=["proportional","proportional","proportional"];for(const s of t){const n=s.useSymbolValue?"symbol-value":S1(s,e,r)??"proportional";switch(s.axis){case"width":i[0]=n;break;case"depth":i[1]=n;break;case"height":i[2]=n;break;case"width-and-depth":i[0]=n,i[1]=n;break;case"all":case void 0:case null:i[0]=n,i[1]=n,i[2]=n;break;default:s.axis}}return i}const XIe=Object.freeze(Object.defineProperty({__proto__:null,getAllSizes:Jfe,getColor:E9,getOpacity:O9,getRotationAngle:k9,getSize:S1,getSizeForValue:P9,getSizeFromNumberOrVariable:wi,getSizeRangeAtScale:Wfe,getVisualVariableValues:Zfe,viewScaleRE:I9},Symbol.toStringTag,{value:"Module"}));var _x;const bg=new $e({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),Sx=new $e({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});function LP(t){if(t!=null)return typeof t=="string"||typeof t=="number"?Ffe(t):t.type==="size"?bd(t)?t:(delete(t={...t}).type,new Ee(t)):void 0}function FP(t,e,r){if(typeof t!="object")return t;const i=new Ee;return i.read(t,r),i}let Ee=_x=class extends $r{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&I9.test(this.valueExpression)}}set index(t){bd(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),bd(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return T9(this)}set maxDataValue(t){t&&this.stops&&(L.getLogger(this).warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(L.getLogger(this).warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return LP(t)}readMaxSize(t,e,r){return FP(t,e,r)}set minDataValue(t){t&&this.stops&&(L.getLogger(this).warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(L.getLogger(this).warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return LP(t)}readMinSize(t,e,r){return FP(t,e,r)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(t){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,r)=>e.value-r.value):t&&(L.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return Dfe(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,r,i){if(t==="$view.scale"){if(i?.messages){const s=this.index,n=typeof s=="string"?s:`visualVariables[${s}]`;i.messages.push(new x("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:n+".valueExpression",context:i}))}}else e[r]=t}readValueUnit(t){return t?Sx.read(t):null}clone(){return new _x({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:bd(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:bd(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops?.map(t=>t.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions?.clone()})}flipSizes(){if(this.transformationType==="clamped-linear"){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if(this.transformationType==="stops"){const t=this.stops;if(!t)return this;const e=t.map(i=>i.size).reverse(),r=t.length;for(let i=0;i<r;i++)t[i].size=e[i];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops?.map(t=>t.value||0)}};a([c({readOnly:!0})],Ee.prototype,"cache",null),a([c({type:bg.apiValues,json:{type:bg.jsonValues,origins:{"web-map":{read:!1}},read:bg.read,write:bg.write}})],Ee.prototype,"axis",void 0),a([c()],Ee.prototype,"index",null),a([c({type:String,readOnly:!0})],Ee.prototype,"inputValueType",null),a([c({type:Nfe,json:{write:!0}})],Ee.prototype,"legendOptions",void 0),a([c({type:Number,value:null,json:{write:!0}})],Ee.prototype,"maxDataValue",null),a([c({type:Number,value:null,json:{write:!0}})],Ee.prototype,"maxSize",null),a([Ce("maxSize")],Ee.prototype,"castMaxSize",null),a([V("maxSize")],Ee.prototype,"readMaxSize",null),a([c({type:Number,value:null,json:{write:!0}})],Ee.prototype,"minDataValue",null),a([c({type:Number,value:null,json:{write:!0}})],Ee.prototype,"minSize",null),a([Ce("minSize")],Ee.prototype,"castMinSize",null),a([V("minSize")],Ee.prototype,"readMinSize",null),a([c({type:String,json:{write:!0}})],Ee.prototype,"normalizationField",void 0),a([c({readOnly:!0})],Ee.prototype,"arcadeRequired",null),a([c({type:String})],Ee.prototype,"scaleBy",void 0),a([c({type:[Bs],value:null,json:{write:!0}})],Ee.prototype,"stops",null),a([c({type:["outline"],json:{write:!0}})],Ee.prototype,"target",void 0),a([c({type:String,readOnly:!0})],Ee.prototype,"transformationType",null),a([c({type:["size"],json:{type:["sizeInfo"]}})],Ee.prototype,"type",void 0),a([c({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],Ee.prototype,"useSymbolValue",void 0),a([c({type:String,json:{write:!0}})],Ee.prototype,"valueExpression",void 0),a([V("valueExpression",["valueExpression","expression"])],Ee.prototype,"readValueExpression",null),a([q("web-scene","valueExpression")],Ee.prototype,"writeValueExpressionWebScene",null),a([c({type:["radius","diameter","area","width","distance"],json:{write:!0}})],Ee.prototype,"valueRepresentation",void 0),a([c({type:Sx.apiValues,json:{write:Sx.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],Ee.prototype,"valueUnit",void 0),a([V("valueUnit")],Ee.prototype,"readValueUnit",null),Ee=_x=a([b("esri.renderers.visualVariables.SizeVariable")],Ee);const Yfe={color:$a,size:Ee,opacity:Oo,rotation:xa},Kfe=new $e({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),Qfe=/^\[([^\]]+)\]$/i;let q0=class extends X{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),e=e?.filter(r=>!!r),e?.length){for(const r of e)switch(r.type){case"color":this.colorVariables.push(r);break;case"opacity":this.opacityVariables.push(r);break;case"rotation":this.rotationVariables.push(r);break;case"size":this.sizeVariables.push(r)}this.sizeVariables.length&&this.sizeVariables.some(r=>!!r.target)&&e.sort((r,i)=>{let s=null;return s=r.target===i.target?0:r.target?1:-1,s});for(let r=0;r<e.length;r++)e[r].index=r;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,r,i){const{rotationExpression:s,rotationType:n}=r,o=s?.match(Qfe),l=o?.[1];if(l&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:n,field:l})),e)return e.map(u=>{const d=Kfe.read(u.type),p=Yfe[d];p||(L.getLogger(this).warn(`Unknown variable type: ${d}`),i?.messages&&i.messages.push(new qi("visual-variable:unsupported",`visualVariable of type '${d}' is not supported`,{definition:u,context:i})));const f=new p;return f.read(u,i),f})}writeVariables(e,r){const i=[];for(const s of e){const n=s.toJSON(r);n&&i.push(n)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};a([c()],q0.prototype,"visualVariables",null),q0=a([b("esri.renderers.visualVariables.VisualVariableFactory")],q0);const Xfe={base:$r,key:"type",typeMap:{opacity:Oo,color:$a,rotation:xa,size:Ee}},cp=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this._vvFactory=new q0}set visualVariables(i){this._vvFactory.visualVariables=i,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(i,s,n){return this._vvFactory.readVariables(i,s,n)}writeVisualVariables(i,s,n,o){s[n]=this._vvFactory.writeVariables(i,o)}get arcadeRequiredForVisualVariables(){return this.visualVariables?.some(({arcadeRequired:i})=>i)??!1}hasVisualVariables(i,s){return i?this.getVisualVariablesForType(i,s).length>0:this.getVisualVariablesForType("size",s).length>0||this.getVisualVariablesForType("color",s).length>0||this.getVisualVariablesForType("opacity",s).length>0||this.getVisualVariablesForType("rotation",s).length>0}getVisualVariablesForType(i,s){return this.visualVariables?.filter(n=>n.type===i&&(typeof s=="string"?n.target===s:s!==!1||!n.target))??[]}async collectVVRequiredFields(i,s){let n=[];this.visualVariables&&(n=n.concat(this.visualVariables));for(const o of n)o&&(o.field&&Rr(i,s,o.field),o.normalizationField&&Rr(i,s,o.normalizationField),o.valueExpression&&(eme(o.valueExpression,i,s)||await Fr(i,s,null,o.valueExpression)))}};return a([c({types:[Xfe],value:null,json:{write:!0}})],r.prototype,"visualVariables",null),a([V("visualVariables",["visualVariables","rotationType","rotationExpression"])],r.prototype,"readVisualVariables",null),a([q("visualVariables")],r.prototype,"writeVisualVariables",null),r=a([b("esri.renderers.mixins.VisualVariablesMixin")],r),r};function eme(t,e,r){const i=ore(t);return i!=null&&(Rr(e,r,i),!0)}const _3=[252,146,31,255],tme=[153,153,153,255],rme={type:"esriSMS",style:"esriSMSCircle",size:6,color:_3,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},ime={type:"esriSLS",style:"esriSLSSolid",width:.75,color:_3},sme={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},nme={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},ome={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},ame={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},lme={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null},ow=Gt.fromJSON(rme),S3=bt.fromJSON(ime),A9=fi.fromJSON(sme),ume=Le.fromJSON(nme);function tEe(t){if(t==null)return null;switch(t.type){case"mesh":return null;case"point":case"multipoint":return ow;case"polyline":return S3;case"polygon":case"extent":return A9}return null}const rEe=Gt.fromJSON(ome),iEe=bt.fromJSON(ame),sEe=fi.fromJSON(lme),cme=Wr.fromSimpleMarkerSymbol(ow),dme=Xs.fromSimpleLineSymbol(S3),hme=hs.fromSimpleFillSymbol(A9),pme=new Po({symbolLayers:new H([new Gr({material:{color:_3},edges:new Y4({size:gs(1),color:new ue(tme)})})])}),fme=new Xs({symbolLayers:new H([new qr({material:{color:new ue([0,0,0])},size:gs(1)})])}),mme=new hs({symbolLayers:new H([new Gr({outline:{color:new ue([0,0,0]),size:gs(1)}})])});function nEe(t){if(t==null)return null;switch(t.type){case"mesh":return pme;case"point":case"multipoint":return cme;case"polyline":return dme;case"polygon":case"extent":return hme}return null}const NP="#useCIMFallbackSymbology()",pc={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function yme(t,e=pc){if(!t)return{symbol:null};const{retainId:r=pc.retainId,ignoreDrivers:i=pc.ignoreDrivers,hasLabelingContext:s=pc.hasLabelingContext,retainCIM:n=pc.retainCIM,cimFallbackEnabled:o=pc.cimFallbackEnabled}=e;let l=null;if(gj(t))l=t.clone();else if(t.type==="web-style")l=t.clone();else if(t.type==="cim"){const u=t.data?.symbol?.type;switch(u){case"CIMPointSymbol":l=n?t.clone():Wr.fromCIMSymbol(t);break;case"CIMLineSymbol":o&&(l=fme.clone(),e?.logWarning?.(NP,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":o&&(l=mme.clone(),e?.logWarning?.(NP,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!l)return{error:new x("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${u||"unknown"}' is unsupported in 3D`,{symbol:t})}}else if(t instanceof bt)l=Xs.fromSimpleLineSymbol(t);else if(t instanceof Gt)l=Wr.fromSimpleMarkerSymbol(t);else if(t instanceof Sr)l=Wr.fromPictureMarkerSymbol(t);else if(t instanceof fi)l=e.geometryType&&e.geometryType==="mesh"?Po.fromSimpleFillSymbol(t):hs.fromSimpleFillSymbol(t);else{if(!(t instanceof Le))return{error:new x("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};l=s?Us.fromTextSymbol(t):Wr.fromTextSymbol(t)}return r&&l&&l.type!=="cim"&&(l.id=t.id),!i||l.type==="cim"||l instanceof hr||l.symbolLayers.forEach(u=>u.ignoreDrivers=!0),{symbol:l}}function aw(t,e,r,i){const s=R9(t,{},{context:i,isLabelSymbol:!1});s!=null&&Ht(r,s,e)}function DP(t,e,r,i){const s=R9(t,{},{context:i,isLabelSymbol:!0});s!=null&&(e[r]=s)}function jP(t){return gj(t)||t instanceof hr}function gme(t){return t?.type==="polygon-3d"||t?.type==="line-3d"}function R9(t,e,r){if(t==null)return null;const{context:i,isLabelSymbol:s}=r,n=i?.origin,o=i?.messages;if(n==="web-scene"&&!jP(t)){const l=yme(t,{retainCIM:!0,hasLabelingContext:s});return l.symbol!=null?l.symbol.write(e,i):(o?.push(new x("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:i,error:l.error})),null)}return lS(i?.layer)&&gme(t)?(o?.push(new x("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported on layers of type '${i?.layer?.declaredClass}'.`,{symbol:t,context:i})),null):(n==="web-map"||n==="portal-item"&&!lS(i?.layer))&&jP(t)?(o?.push(new x("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:t,context:i})),null):t.write(e,i)}function oEe(t,e){return ise(t,null,e)}const $1={types:vj,json:{write:{writer:aw},origins:{"web-scene":{types:lk,write:{writer:aw},read:{reader:Jh({types:lk})}}}}},$3=nT({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},$1),x3={types:{base:St,key:"type",typeMap:{"simple-fill":Fa.typeMap["simple-fill"],"picture-fill":Fa.typeMap["picture-fill"],"polygon-3d":Fa.typeMap["polygon-3d"],cim:Fa.typeMap.cim}},json:{write:{writer:aw},origins:{"web-scene":{type:hs,write:{writer:aw}}}}},G0={cast:t=>t==null||typeof t=="string"||typeof t=="number"?t:`${t}`,json:{type:String,write:{writer:(t,e)=>{e.value=t?.toString()}}}};var $x;let Zr=$x=class extends cp(ji){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.symbols.map(r=>r.collectRequiredFields(t,e)))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}get symbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){return this.symbols.reduce((t,e)=>t+JSON.stringify(e),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new $x({description:this.description,label:this.label,symbol:E(this.symbol),visualVariables:E(this.visualVariables),authoringInfo:E(this.authoringInfo)})}};a([c({type:String,json:{write:!0}})],Zr.prototype,"description",void 0),a([c({type:String,json:{write:!0}})],Zr.prototype,"label",void 0),a([c($3)],Zr.prototype,"symbol",void 0),a([se({simple:"simple"})],Zr.prototype,"type",void 0),Zr=$x=a([b("esri.renderers.SimpleRenderer")],Zr);const vme=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function xx(t){return t instanceof X}function VP(t){return t instanceof H?Object.keys(t.items):xx(t)?Xr(t).keys():t?Object.keys(t):[]}function _g(t,e){return t instanceof H?t.items[e]:t[e]}function wme(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function hm(t){return t?t.declaredClass:null}function L9(t,e){const r=t.diff;if(r&&typeof r=="function")return r(t,e);const i=VP(t),s=VP(e);if(i.length===0&&s.length===0)return;if(!i.length||!s.length||wme(t,e))return{type:"complete",oldValue:t,newValue:e};const n=s.filter(f=>!i.includes(f)),o=i.filter(f=>!s.includes(f)),l=i.filter(f=>s.includes(f)&&_g(t,f)!==_g(e,f)).concat(n,o).sort(),u=hm(t);if(u&&vme.has(u)&&l.length)return{type:"complete",oldValue:t,newValue:e};let d;const p=xx(t)&&xx(e);for(const f of l){const m=_g(t,f),y=_g(e,f);let g;if((p||typeof m!="function"&&typeof y!="function")&&m!==y&&(m!=null||y!=null)){if(r&&r[f]&&typeof r[f]=="function")g=r[f]?.(m,y);else if(m instanceof Date&&y instanceof Date){if(m.getTime()===y.getTime())continue;g={type:"complete",oldValue:m,newValue:y}}else g=typeof m=="object"&&typeof y=="object"&&hm(m)===hm(y)?L9(m,y):{type:"complete",oldValue:m,newValue:y};g!=null&&(d!=null?d.diff[f]=g:d={type:"partial",diff:{[f]:g}})}}return d}function aEe(t,e){if(t==null)return!1;const r=e.split(".");let i=t;for(const s of r){if(i.type==="complete")return!0;if(i.type!=="partial")return!1;{const n=i.diff[s];if(!n)return!1;i=n}}return!0}function bme(t,e){if(typeof t!="function"&&typeof e!="function"&&(t!=null||e!=null))return t==null||e==null||typeof t=="object"&&typeof e=="object"&&hm(t)!==hm(e)?{type:"complete",oldValue:t,newValue:e}:L9(t,e)}function Sg(t){if(t==null)return!0;switch(t.type){case"complete":return!1;case"collection":{const e=t;for(const r of e.added)if(!Sg(r))return!1;for(const r of e.removed)if(!Sg(r))return!1;for(const r of e.changed)if(!Sg(r))return!1;return!0}case"partial":for(const e in t.diff)if(!Sg(t.diff[e]))return!1;return!0}}var Tx;const _me=Ft()({ascendingValues:"ascending-values",descendingValues:"descending-values"});let Pf=Tx=class extends pe(F){static from(t){return Zh(Tx,t)}constructor(t){super(t),this.title=null,this.order=null}};a([c({type:String,json:{write:!0}})],Pf.prototype,"title",void 0),a([se(_me)],Pf.prototype,"order",void 0),Pf=Tx=a([b("esri.renderers.support.RendererLegendOptions")],Pf);const T3=Pf;let Js=class extends pe(F){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};a([c(G0)],Js.prototype,"value",void 0),a([c(G0)],Js.prototype,"value2",void 0),a([c(G0)],Js.prototype,"value3",void 0),Js=a([b("esri.renderers.support.UniqueValue")],Js);let So=class extends pe(F){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(e==null)return null;const r=typeof(e=Array.isArray(e)?e:[e])[0];return r==="string"||r==="number"?e.map(i=>new Js({value:i})):r==="object"?e[0]instanceof Js?e:e.map(i=>new Js(i)):null}};a([c({type:String,json:{write:!0}})],So.prototype,"description",void 0),a([c({type:String,json:{write:!0}})],So.prototype,"label",void 0),a([c($1)],So.prototype,"symbol",void 0),a([c({type:[Js],json:{type:[[String]],read:{reader:t=>t?t.map(e=>new Js({value:e[0],value2:e[1],value3:e[2]})):null},write:{writer:(t,e)=>{const r=[];for(const i of t){const s=[i.value,i.value2,i.value3].filter(ps).map(n=>n.toString());r.push(s)}e.values=r}}}})],So.prototype,"values",void 0),a([Ce("values")],So.prototype,"castValues",null),So=a([b("esri.renderers.support.UniqueValueClass")],So);let uu=class extends pe(F){constructor(e){super(e),this.heading=null,this.classes=null}};a([c({type:String,json:{write:!0}})],uu.prototype,"heading",void 0),a([c({type:[So],json:{write:{isRequired:!0}}})],uu.prototype,"classes",void 0),uu=a([b("esri.renderers.support.UniqueValueGroup")],uu);var Mx;let Ws=Mx=class extends F{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new Mx({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol?.toJSON());return`${this.value}.${t}`}};a([c({type:String,json:{write:!0}})],Ws.prototype,"description",void 0),a([c({type:String,json:{write:!0}})],Ws.prototype,"label",void 0),a([c($3)],Ws.prototype,"symbol",void 0),a([c(G0)],Ws.prototype,"value",void 0),Ws=Mx=a([b("esri.renderers.support.UniqueValueInfo")],Ws);const zP=new Map;async function Sme(t,e){try{return{data:(await Mme(t,e)).data,baseUrl:QU(t),styleUrl:t}}catch(r){return Mn(r),null}}function $me(t,e,r){const i=e.portal!=null?e.portal:j.getDefault();let s;const n=`${i.url} - ${i.user?.username} - ${t}`,o=zP.get(n);if(o)return o;const l=xme(t,i,r).then(u=>(s=u,u.fetchData())).then(u=>({data:u,baseUrl:s.itemUrl??"",styleName:t}));return zP.set(n,l),l}function xme(t,e,r){return e.load(r).then(()=>{const i=new vt({disableExtraQuery:!0,query:`owner:${UP} AND type:${qP} AND typekeywords:"${t}"`});return e.queryItems(i,r)}).then(({results:i})=>{let s=null;const n=t.toLowerCase();if(i&&Array.isArray(i)){for(const o of i)if(o.typeKeywords?.some(u=>u.toLowerCase()===n)&&o.type===qP&&o.owner===UP){s=o;break}}if(!s)throw new x("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return s.load(r)})}function Tme(t,e,r){return t?.styleUrl!=null?Sme(t.styleUrl,r):t?.styleName!=null?$me(t.styleName,e,r):Promise.reject(new x("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function dEe(t){return t===null||t.type==="CIMSymbolReference"?t:{type:"CIMSymbolReference",symbol:t}}function hEe(t,e){for(const r of e)switch(r){case"cim":if(t.cimRef)return{format:r,url:encodeURI(t.cimRef)};break;case"web-gltf-basisu":{const i=a_(t,"gltf_basisu");if(i)return{format:r,url:i};break}case"web-gltf":{const i=a_(t,"gltf");if(i)return{format:r,url:i};break}case"web":{const i=a_(t,"gltf");if(i)return{format:"web-gltf",url:i};if(t.webRef)return{format:r,url:encodeURI(t.webRef)};break}}}function a_(t,e){if(!k("enable-feature:force-wosr"))return t.formatInfos?.find(r=>r.type===e)?.href}function Mme(t,e){const r={responseType:"json",query:{f:"json"},...e};return Ae(en(t),r)}const UP="esri_en",qP="Style",pEe="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var Af;const GP="uvInfos-watcher",BP="uvGroups-watcher",Ime=",",Eme=ct(Ws);function Ome(t){const{field1:e,field2:r,field3:i,fieldDelimiter:s,uniqueValueInfos:n,valueExpression:o}=t,l=!(!e||!r);return[{classes:(n??[]).map(u=>{const{symbol:d,label:p,value:f,description:m}=u,[y,g,v]=l?f?.toString()?.split(s||"")||[]:[f],_=[];return(e||o)&&_.push(y),r&&_.push(g),i&&_.push(v),{symbol:d,label:p,values:[_],description:m}})}]}function fc(t){return t!=null&&t!==""&&(typeof t!="string"||t.trim()!==""&&t.toLowerCase()!=="<null>")||(t=null),t+""}let Ge=Af=class extends cp(ji){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,r){if(!e&&!r)return;if(!e||!r)return{type:"complete",oldValue:e,newValue:r};let i=!1;const s={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let n=0;n<r.length;n++){const o=e.find(l=>l.value===r[n].value);o?bme(o,r[n])?(s.changed.push({type:"complete",oldValue:o,newValue:r[n]}),i=!0):s.unchanged.push({oldValue:o,newValue:r[n]}):(s.added.push(r[n]),i=!0)}for(let n=0;n<e.length;n++)r.find(o=>o.value===e[n].value)||(s.removed.push(e[n]),i=!0);return i?s:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(t){this._set("field",t),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(t){return t==null||typeof t=="function"?t:ey(t)}writeField(t,e,r,i){typeof t=="string"?e[r]=t:i?.messages?i.messages.push(new x("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):L.getLogger(this).error(".field: cannot write field to JSON since it's not a string value")}set field2(t){this._set("field2",t),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(t){this._set("field3",t),this._updateUniqueValues()}set valueExpression(t){this._set("valueExpression",t),this._updateUniqueValues()}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}set fieldDelimiter(t){this._set("fieldDelimiter",t),this._updateUniqueValues()}readPortal(t,e,r){return r.portal||j.getDefault()}readStyleOrigin(t,e,r){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const i=Gu(e.styleUrl,r);return Object.freeze({styleUrl:i})}}writeStyleOrigin(t,e,r,i){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=Iu(t.styleUrl,i))}set uniqueValueGroups(t){this.styleOrigin?L.getLogger(this).error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",t),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(t){this.styleOrigin?L.getLogger(this).error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(t,e){if(this.styleOrigin)return void L.getLogger(this).error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let r;r=typeof t=="object"?Eme(t):new Ws({value:t,symbol:wj(e)}),this.uniqueValueInfos?.push(r),this._valueInfoMap[fc(r.value)]=r,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(t){if(this.styleOrigin)return void L.getLogger(this).error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const e=this.uniqueValueInfos;if(e)for(let r=0;r<e.length;r++){const i=e[r];if(String(i.value)===String(t)){delete this._valueInfoMap[fc(t)],e.splice(r,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(t,e){let r=e;return this.valueExpression&&e?.arcade==null&&(r={...r,arcade:await Nu()}),this._getUniqueValueInfo(t,r)}getSymbol(t,e){return this.valueExpression&&e?.arcade==null?void L.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used"):this._getUniqueValueInfo(t,e)?.symbol||this.defaultSymbol}async getSymbolAsync(t,e){let r=e;if(this.valueExpression&&r?.arcade==null){const s=await Nu(),{arcadeUtils:n}=s;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),r={...r,arcade:s}}return this._getUniqueValueInfo(t,r)?.symbol||this.defaultSymbol}get symbols(){const t=[];if(this._isInfosSource)for(const e of this.uniqueValueInfos??[])e.symbol&&t.push(e.symbol);else for(const e of this.uniqueValueGroups??[])for(const r of e.classes??[])r.symbol&&t.push(r.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),r=this.uniqueValueInfos?.reduce((i,s)=>i+s.getMeshHash(),"");return`${t}.${e}.${r}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const t=new Af({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:E(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:E(this.visualVariables),legendOptions:E(this.legendOptions),authoringInfo:E(this.authoringInfo),backgroundFillSymbol:E(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=E(this.uniqueValueInfos),r=E(this.uniqueValueGroups);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(E(this.styleOrigin))),Object.freeze(e),Object.freeze(r)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t._set("uniqueValueGroups",r),t._isInfosSource=this._isInfosSource,t._watchUniqueValueInfosAndGroups(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const r=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(r)}async collectSymbolFields(t,e){const r=[...this.symbols.map(i=>i.collectRequiredFields(t,e)),Fr(t,e,null,this.valueExpression)];Rr(t,e,this.field),Rr(t,e,this.field2),Rr(t,e,this.field3),await Promise.all(r)}populateFromStyle(){return Tme(this.styleOrigin,{portal:this.portal}).then(t=>{const e=[];return this._valueInfoMap={},t?.data&&Array.isArray(t.data.items)&&t.data.items.forEach(r=>{const i=new hr({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:r.name});this.defaultSymbol||r.name!==t.data.defaultItem||(this.defaultSymbol=i,this._isDefaultSymbolDerived=!0);const s=new Ws({value:r.name,symbol:i});e.push(s),this._valueInfoMap[fc(r.name)]=s}),this._set("uniqueValueInfos",Object.freeze(e)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&this.uniqueValueInfos?.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this})}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",Ime)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:t}=this;if(t)for(const e of t)this._valueInfoMap[fc(e.value)]=e}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(GP);const{uniqueValueInfos:t}=this;if(t){const e=[];for(const r of t)e.push(ne(()=>({symbol:r.symbol,value:r.value,label:r.label,description:r.description}),(i,s)=>{i!==s&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)},{sync:!0}));this.addHandles(e,GP)}}_watchUniqueValueGroups(){this.removeHandles(BP);const{uniqueValueGroups:t}=this;if(t){const e=[];for(const r of t){e.push(ne(()=>({classes:r.classes}),(i,s)=>{i!==s&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}));for(const i of r.classes??[])e.push(ne(()=>({symbol:i.symbol,values:i.values,label:i.label,description:i.description}),(s,n)=>{s!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}))}this.addHandles(e,BP)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const t=[],{field:e,field2:r,field3:i,fieldDelimiter:s,uniqueValueGroups:n,valueExpression:o}=this;if(!e&&!o)return this._set("uniqueValueInfos",t),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const l=!(!e||!r);for(const u of n)for(const d of u.classes??[]){const{symbol:p,label:f,values:m,description:y}=d;for(const g of m??[]){const{value:v,value2:_,value3:S}=g,M=[v];r&&M.push(_),i&&M.push(S);const C=l?M.join(s||""):M[0]??void 0;t.push(new Ws({symbol:p,label:f,value:C,description:y}))}}this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(t=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:e,field2:r,valueExpression:i,fieldDelimiter:s,uniqueValueInfos:n}=this;if(!e&&!i||!n.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!e||!r),l=n.map(d=>{const{symbol:p,label:f,value:m,description:y}=d,[g,v,_]=o?m?.toString()?.split(s||"")||[]:[m];return new So({symbol:p,label:f,description:y,values:[new Js({value:g,value2:v,value3:_})]})}),u=[new uu({classes:l})];t&&Object.freeze(u),this._set("uniqueValueGroups",u),this._watchUniqueValueGroups()}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:r,scale:i,spatialReference:s,arcade:n,timeZone:o}=e??{};let l=this._cache.compiledFunc;const u=n.arcadeUtils;if(!l){const p=u.createSyntaxTree(this.valueExpression);l=u.createFunction(p),this._cache.compiledFunc=l}const d=u.executeFunction(l,u.createExecContext(t,u.getViewInfo({viewingMode:r,scale:i,spatialReference:s}),o));return this._valueInfoMap[fc(d)]}_getUnqiueValueInfoForFields(t){const e=this.field,r=t.attributes;let i;if(this.field2){const s=this.field2,n=this.field3,o=[];e&&o.push(r[e]),s&&o.push(r[s]),n&&o.push(r[n]),i=o.join(this.fieldDelimiter||"")}else e&&(i=r[e]);return this._valueInfoMap[fc(i)]}static fromPortalStyle(t,e){const r=new Af(e?.properties);r._set("styleOrigin",Object.freeze({styleName:t})),r._set("portal",e?.portal||j.getDefault());const i=r.populateFromStyle();return i.catch(s=>{L.getLogger(this.prototype).error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",s)}),i}static fromStyleUrl(t,e){const r=new Af(e?.properties);r._set("styleOrigin",Object.freeze({styleUrl:t}));const i=r.populateFromStyle();return i.catch(s=>{L.getLogger(this.prototype).error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",s)}),i}};a([c({readOnly:!0})],Ge.prototype,"_cache",null),a([se({uniqueValue:"unique-value"})],Ge.prototype,"type",void 0),a([c(x3)],Ge.prototype,"backgroundFillSymbol",void 0),a([c({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],Ge.prototype,"field",null),a([Ce("field")],Ge.prototype,"castField",null),a([q("field")],Ge.prototype,"writeField",null),a([c({type:String,value:null,json:{write:!0}})],Ge.prototype,"field2",null),a([c({type:String,value:null,json:{write:!0}})],Ge.prototype,"field3",null),a([c({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],Ge.prototype,"orderByClassesEnabled",void 0),a([c({type:String,value:null,json:{write:!0}})],Ge.prototype,"valueExpression",null),a([c({type:String,json:{write:!0}})],Ge.prototype,"valueExpressionTitle",void 0),a([c({type:T3,json:{write:!0}})],Ge.prototype,"legendOptions",void 0),a([c({type:String,json:{write:!0}})],Ge.prototype,"defaultLabel",void 0),a([c(nT({...$1},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],Ge.prototype,"defaultSymbol",null),a([c({type:String,value:null,json:{write:!0}})],Ge.prototype,"fieldDelimiter",null),a([c({type:j,readOnly:!0})],Ge.prototype,"portal",void 0),a([V("portal",["styleName"])],Ge.prototype,"readPortal",null),a([c({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],Ge.prototype,"styleOrigin",void 0),a([V("styleOrigin",["styleName","styleUrl"])],Ge.prototype,"readStyleOrigin",null),a([q("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],Ge.prototype,"writeStyleOrigin",null),a([c({type:[uu],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(t,e,r)=>(e.uniqueValueGroups||Ome(e)).map(i=>uu.fromJSON(i,r))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],Ge.prototype,"uniqueValueGroups",null),a([c({type:[Ws],json:{read:!1,write:{isRequired:!0,overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0,isRequired:!0}}}}})],Ge.prototype,"uniqueValueInfos",null),Ge=Af=a([b("esri.renderers.UniqueValueRenderer")],Ge);var Ix,uh;let Vt=(uh=class extends F{constructor(e){super(e),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.orderByFields=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(e,r){r.resultOffset=this.start,r.resultRecordCount=this.num||10}clone(){return new Ix(E({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}},Ix=uh,uh);a([c({type:[String],json:{write:!0}})],Vt.prototype,"attachmentTypes",void 0),a([c({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],Vt.prototype,"attachmentsWhere",void 0),a([c({type:Boolean,json:{write:!0}})],Vt.prototype,"cacheHint",void 0),a([c({type:[String],json:{write:!0}})],Vt.prototype,"keywords",void 0),a([c({type:[String],json:{write:!0}})],Vt.prototype,"globalIds",void 0),a([c({json:{write:!0}})],Vt.prototype,"name",void 0),a([c({type:Number,json:{read:{source:"resultRecordCount"}}})],Vt.prototype,"num",void 0),a([c({type:[Number],json:{write:!0}})],Vt.prototype,"objectIds",void 0),a([c({type:[String],json:{write:!0}})],Vt.prototype,"orderByFields",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],Vt.prototype,"returnMetadata",void 0),a([c({type:[Number],json:{write:!0}})],Vt.prototype,"size",void 0),a([c({type:Number,json:{read:{source:"resultOffset"}}})],Vt.prototype,"start",void 0),a([q("start"),q("num")],Vt.prototype,"writeStart",null),a([c({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],Vt.prototype,"where",void 0),Vt=Ix=a([b("esri.rest.support.AttachmentQuery")],Vt),Vt.from=ct(Vt);const F9=Ft()({naturalLog:"natural-log",squareRoot:"square-root",percentOfTotal:"percent-of-total",log:"log",field:"field"}),HP="percent-of-total",WP="field",fEe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.normalizationField=null,this.normalizationMaxValue=null,this.normalizationMinValue=null,this.normalizationTotal=null}get normalizationType(){let i=this._get("normalizationType");const s=!!this.normalizationField,n=this.normalizationTotal!=null;return s||n?(i=s&&WP||n&&HP||null,s&&n&&L.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):i!==WP&&i!==HP||(i=null),i}set normalizationType(i){this._set("normalizationType",i)}};return a([c({type:String,json:{name:"parameters.normalizationField",write:!0}})],r.prototype,"normalizationField",void 0),a([c({type:Number,json:{name:"parameters.normalizationMaxValue",write:!0}})],r.prototype,"normalizationMaxValue",void 0),a([c({type:Number,json:{name:"parameters.normalizationMinValue",write:!0}})],r.prototype,"normalizationMinValue",void 0),a([c({type:Number,json:{name:"parameters.normalizationTotal",write:!0}})],r.prototype,"normalizationTotal",void 0),a([se(F9,{name:"parameters.normalizationType"})],r.prototype,"normalizationType",null),r=a([b("esri.rest.support.NormalizationBinParametersMixin")],r),r};var Ex,ch;let Je=(ch=class extends F{constructor(e){super(e),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(e,r){r.historicMoment=e&&e.getTime()}writeStart(e,r){r.resultOffset=this.start,r.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(r.definitionExpression="1=1")}clone(){return new Ex(E({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}},Ex=ch,ch);a([c({type:Boolean,json:{write:!0}})],Je.prototype,"cacheHint",void 0),a([c({type:qs,json:{write:!0}})],Je.prototype,"dynamicDataSource",void 0),a([c({type:String,json:{write:!0}})],Je.prototype,"gdbVersion",void 0),a([c({type:Number,json:{write:!0}})],Je.prototype,"geometryPrecision",void 0),a([c({type:Date})],Je.prototype,"historicMoment",void 0),a([q("historicMoment")],Je.prototype,"_writeHistoricMoment",null),a([c({type:Number,json:{write:!0}})],Je.prototype,"maxAllowableOffset",void 0),a([c({json:{write:!0}})],Je.prototype,"objectIds",void 0),a([c({type:[String],json:{write:!0}})],Je.prototype,"orderByFields",void 0),a([c({type:[String],json:{write:!0}})],Je.prototype,"outFields",void 0),a([c({type:Z,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Je.prototype,"outSpatialReference",void 0),a([c({json:{write:!0}})],Je.prototype,"relationshipId",void 0),a([c({type:Number,json:{read:{source:"resultOffset"}}})],Je.prototype,"start",void 0),a([q("start"),q("num")],Je.prototype,"writeStart",null),a([c({type:Number,json:{read:{source:"resultRecordCount"}}})],Je.prototype,"num",void 0),a([c({json:{write:!0}})],Je.prototype,"returnGeometry",void 0),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Je.prototype,"returnM",void 0),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Je.prototype,"returnZ",void 0),a([c({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],Je.prototype,"where",void 0),Je=Ex=a([b("esri.rest.support.RelationshipQuery")],Je),Je.from=ct(Je);const mEe=Object.freeze(Object.defineProperty({__proto__:null,get default(){return Je}},Symbol.toStringTag,{value:"Module"})),Ox=new $e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function kme(t,e,r,i){const s=await hl(t);if(await M3(t,e,i),!s.addAttachment)throw new x(i,"Layer source does not support addAttachment capability");return s.addAttachment(e,r)}function M3(t,e,r){const{attributes:i}=e,{objectIdField:s}=t;return t.capabilities?.data?.supportsAttachment?e?i?s&&i[s]?Promise.resolve():Promise.reject(new x(r,`feature is missing the identifying attribute ${s}`)):Promise.reject(new x(r,"'attributes' are required on a feature to query attachments")):Promise.reject(new x(r,"A feature is required to add/delete/update attachments")):Promise.reject(new x(r,"this layer doesn't support attachments"))}async function Cme(t,e,r,i,s){const n=await hl(t);if(await M3(t,e,s),!n.updateAttachment)throw new x(s,"Layer source does not support updateAttachment capability");return n.updateAttachment(e,r,i)}async function Pme(t,e,r){const{applyEdits:i}=await N(()=>import("./editingSupport-umtYHrTl.js"),[]),s=await t.load();let n=r;return s.type==="feature"&&s.infoFor3D&&e.deleteFeatures!=null&&s.globalIdField!=null&&(n={...n,globalIdToObjectId:await eye(s,e.deleteFeatures,s.globalIdField)}),i(s,s.source,e,r)}async function Ame(t,e,r){const{uploadAssets:i}=await N(()=>import("./editingSupport-umtYHrTl.js"),[]),s=await t.load();return i(s,s.source,e,r)}async function Rme(t,e,r,i){const s=await hl(t);if(await M3(t,e,i),!s.deleteAttachments)throw new x(i,"Layer source does not support deleteAttachments capability");return s.deleteAttachments(e,r)}async function Lme(t,e,r){const i=(await t.load({signal:e?.signal})).source;if(!i.fetchRecomputedExtents)throw new x(r,"Layer source does not support fetchUpdates capability");return i.fetchRecomputedExtents(e)}async function Fme(t,e,r,i){e=Vt.from(e),await t.load();const s=t.source,n=t.capabilities;if(!n?.data?.supportsAttachment)throw new x(i,"this layer doesn't support attachments");const{attachmentTypes:o,objectIds:l,globalIds:u,num:d,size:p,start:f,where:m}=e;if(!n?.operations?.supportsQueryAttachments&&(o?.length>0||u?.length>0||p?.length>0||d||f||m))throw new x(i,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(l?.length||u?.length||m))throw new x(i,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!s.queryAttachments)throw new x(i,"Layer source does not support queryAttachments capability",e);return!n?.attachment?.supportsOrderByFields&&e.orderByFields?.length&&((e=e.clone()).orderByFields=null),s.queryAttachments(e)}async function Nme(t,e,r,i){const s=await hl(t);if(!s.queryObjectIds)throw new x(i,"Layer source does not support queryObjectIds capability");return s.queryObjectIds(re.from(e)??t.createQuery(),r)}async function Dme(t,e,r,i){const s=await hl(t);if(!s.queryFeatureCount)throw new x(i,"Layer source does not support queryFeatureCount capability");return s.queryFeatureCount(re.from(e)??t.createQuery(),r)}async function jme(t,e,r,i){const s=await hl(t);if(!s.queryExtent)throw new x(i,"Layer source does not support queryExtent capability");return s.queryExtent(re.from(e)??t.createQuery(),r)}async function Vme(t,e,r,i){const s=await hl(t);if(!s.queryRelatedFeatures)throw new x(i,"Layer source does not support queryRelatedFeatures capability");return s.queryRelatedFeatures(Je.from(e),r)}async function zme(t,e,r,i){const s=await hl(t);if(!s.queryRelatedFeaturesCount)throw new x(i,"Layer source does not support queryRelatedFeaturesCount capability");return s.queryRelatedFeaturesCount(Je.from(e),r)}async function Ume(t){const e=t.source;if(e?.refresh)try{const{dataChanged:r,updates:i}=await e.refresh();if(i!=null&&(t.sourceJSON={...t.sourceJSON,...i},t.read(i,{origin:"service",url:t.parsedUrl})),r)return!0}catch{}if(t.definitionExpression)try{return(await l4(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function qme(t){const e=new re;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,e.outFields=["*"],e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null;const r=t.capabilities?.query;r&&(e.compactGeometryEnabled=r.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=r.supportsDefaultSpatialReference);const i=t.capabilities?.data;i?.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),i?.supportsM&&t.returnM!=null&&(e.returnM=t.returnM);const{timeOffset:s,timeExtent:n}=t;return e.timeExtent=s!=null&&n!=null?n.offset(-s.value,s.unit):n||null,e}function N9(t){const{globalIdField:e,fields:r}=t;if(e)return e;if(r){for(const i of r)if(i.type==="esriFieldTypeGlobalID")return i.name}}function D9(t){const{objectIdField:e,fields:r}=t;if(e)return e;if(r){for(const i of r)if(i.type==="esriFieldTypeOID")return i.name}}function Gme(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}function Bme(t,e,r,i){const s=r?.feature,n=!!t.subtypes?.length;if(n&&!r?.excludeImpliedDomains){const u=Wme(t,e);if(u)return u}const o=n&&Hme(t,s);if(o){const u=o?.domains?.[e];return u?.type==="inherited"?i:u}const l=z9(t.types,t.typeIdField,s);if(l){const u=l.domains&&l.domains[e];if(u&&u?.type!=="inherited")return u}if(i)return i;if(!r?.excludeImpliedDomains){const u=Zme(t,e);if(u)return u}return null}function Hme(t,e){const{subtypes:r,subtypeField:i}=t;if(!e?.attributes||!r?.length||!i)return null;const s=e.attributes[i];return s==null?null:r.find(n=>n.code===s)}function Wme(t,e){const{fieldsIndex:r,subtypeField:i}=t,{name:s,type:n}=r.get(e)??{};if(!s)return null;if((i&&r.get(i)?.name)===s&&t.subtypes?.length){const o=t.subtypes.map(l=>new ou({code:j9(l.code,n),name:l.name}));if(o?.length)return new Da({codedValues:o})}return null}function Zme(t,e){const{fieldsIndex:r}=t,{name:i,type:s}=r.get(e)??{};if(!i)return null;if(("typeIdField"in t?r.get(t.typeIdField)?.name:null)===i&&"types"in t&&t.types?.length){const n=t.types.map(o=>new ou({code:j9(o.id,s),name:o.name}));return new Da({codedValues:n})}return null}function j9(t,e){return e?S4({type:e})&&typeof t=="number"?`${t}`:Rre({type:e})&&typeof t=="string"?Number.parseInt(t,10):t:t}async function hl(t){return(await t.load()).source}async function yEe(t,e){if(!Se)return;const r=Se.findCredential(t);if(r)return r.userId;let i;try{const s=await nM(t,e);s&&(i=await Se.checkSignInStatus(`${s}/sharing`))}catch{}return i?i.userId:null}async function V9(t,e){if(!Se||Se.findCredential(t))return;let r;try{const i=await nM(t,e);i&&(r=await Se.checkSignInStatus(`${i}/sharing`))}catch{}if(r)try{const i=e!=null?e.signal:null;await Se.getCredential(t,{signal:i})}catch{}}async function Jme(t,e,r){const i=t.parsedUrl?.path;i&&t.authenticationTriggerEvent===e&&await V9(i,r)}async function gEe(t){const e=t.parsedUrl?.path;e&&Yme(t)&&await V9(e)}function Yme(t){return Kme(t)&&("serviceDefinitionExpression"in t&&lw(t.serviceDefinitionExpression)||"definitionExpression"in t&&lw(t.definitionExpression))}function Kme(t){return!(!A5(t)||!t.capabilities?.query.supportsCurrentUser)}function lw(t){return!!t?.toLowerCase().includes("current_user")}function Qme(t){return!B0(t)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const l_=Jh({types:vj});function I3(t,e){if(t.defaultSymbol)return t.types?.length?new Ge({defaultSymbol:l_(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map(r=>({id:r.id,symbol:l_(r.symbol,r,e)}))}):new Zr({symbol:l_(t.defaultSymbol,t,e)})}function Xme(t){let e=t.sourceJSON?.cacheMaxAge;if(!e)return!1;const r=t.editingInfo?.lastEditDate?.getTime();return r==null||(e*=1e3,Date.now()-r<e)}async function eye(t,e,r){if(e==null)return null;const i=[],{objectIdField:s}=t;if(e.forEach(d=>{let p=null;if("attributes"in d){const{attributes:f}=d;p={globalId:f[r],objectId:f[s]!=null&&f[s]!==-1?f[s]:null}}else p={globalId:d.globalId,objectId:d.objectId!=null&&d.objectId!==-1?d.objectId:null};p.globalId!=null&&(p.objectId!=null&&p.objectId!==-1||i.push(p.globalId))}),i.length===0)return null;const n=t.createQuery();n.where=i.map(d=>`${r}='${d}'`).join(" OR "),n.returnGeometry=!1,n.outFields=[s,r],n.cacheHint=!1;const o=await KG(Sfe(t,n));if(!o.ok)return null;const l=new Map,u=o.value.features;for(const d of u){const p=d.attributes[r],f=d.attributes[s];p!=null&&f!=null&&f!==-1&&l.set(TJ(p),f)}return l}function z9(t,e,r){if(!e||!r||!t)return null;const i=r.getAttribute(e);return i==null?null:t.find(s=>{const{id:n}=s;return n!=null&&n.toString()===i.toString()})??null}function B0(t){return t.sourceJSON?.isMultiServicesView||tye(t)}function tye(t){return!!t.sourceJSON?.capabilities?.toLowerCase().split(",").map(e=>e.trim()).includes("map")}function rye(t,e,r){const i=e?.queryAttributeBins;if(!e?.operations?.supportsQueryBins||!i)throw new x(r,"Layer source does not support binning");switch(t.binParameters.type){case"auto-interval":if(!i.supportsAutoInterval)throw new x(r,"Layer source does not support auto-interval binning");if(t.binParameters.normalizationType&&(!i.supportsNormalization||!ZP(t.binParameters.normalizationType,i.supportedNormalizationTypes)))throw new x(r,"Layer source does not support normalization binning");break;case"date":if(!i.supportsDate)throw new x(r,"Layer source does not support date binning");if(t.binParameters.snapToData&&!i.supportsSnapToData)throw new x(r,"Layer source does not support snapToData binning");if(t.binParameters.returnFullIntervalBin&&!i.supportsReturnFullIntervalBin)throw new x(r,"Layer source does not support returnFullIntervalBin binning");break;case"fixed-boundaries":if(!i.supportsFixedBoundaries)throw new x(r,"Layer source does not support fixed-boundaries binning");break;case"fixed-interval":if(!i.supportsFixedInterval)throw new x(r,"Layer source does not support fixed-interval binning");if(t.binParameters.normalizationType&&(!i.supportsNormalization||!ZP(t.binParameters.normalizationType,i.supportedNormalizationTypes)))throw new x(r,"Layer source does not support normalization binning")}if(t.binParameters.stackBy&&!i.supportsStackBy)throw new x(r,"Layer source does not support stackBy binning");if(t.binParameters.splitBy&&!i.supportsSplitBy)throw new x(r,"Layer source does not support splitBy binning");if(t.binParameters.firstDayOfWeek&&!i.supportsFirstDayOfWeek)throw new x(r,"Layer source does not support firstDayOfWeek binning");const s=i?.supportedStatistics;if(t.outStatistics&&s){const n=new Map([["count","count"],["sum","sum"],["min","min"],["max","max"],["avg","avg"],["stddev","stddev"],["var","var"],["percentile-continuous","percentileContinuous"],["percentile-discrete","percentileDiscrete"],["centroid-aggregate","centroid"],["convex-hull-aggregate","convexHull"],["envelope-aggregate","envelope"]]);for(const{statisticType:o}of t.outStatistics){const l=n.get(o);if(l&&!s[l])throw new x(r,`Layer source does not support ${o} statistic type`)}}}function ZP(t,e){return t!=null&&!!e?.[F9.toJSON(t)]}let td=class extends pe(F){constructor(e){super(e),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};a([c({type:String,json:{read:{source:"shapeAreaFieldName"}}})],td.prototype,"shapeAreaField",void 0),a([c({type:String,json:{read:{source:"shapeLengthFieldName"}}})],td.prototype,"shapeLengthField",void 0),a([c({type:String,json:{read:t=>qB.read(t)||GB.read(t)}})],td.prototype,"units",void 0),td=a([b("esri.layers.support.GeometryFieldsInfo")],td);var kx;let rd=kx=class extends F{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new H}clone(){return new kx({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};a([c({type:String,json:{write:{isRequired:!0}}})],rd.prototype,"floorField",void 0),a([c({json:{read:!1,write:!1}})],rd.prototype,"viewAllMode",void 0),a([c({json:{read:!1,write:!1}})],rd.prototype,"viewAllLevelIds",void 0),rd=kx=a([b("esri.layers.support.LayerFloorInfo")],rd);function iye(t){const{nonStandardUrlAllowed:e=!1,separator:r}=t??{},i=E(ffe),s=i.json?.write;return typeof s=="object"&&s&&(s.writer=function(n,o,l,u){T7(this,n,r,o,u)}),{...i,set:function(n){if(n==null)return void this._set("url",n);const o=x7({layer:this,url:n,nonStandardUrlAllowed:e,logger:L.getLogger(this)});this._set("url",o.url),o.layerId!=null&&this._set("layerId",o.layerId)}}}function sye(t,e){const{separator:r}=e??{},i=Lr(t.url);return i!=null&&(t.dynamicDataSource!=null?i.path=Mu(i.path,"dynamicLayer"):t.layerId!=null&&(i.path=Mu(i.path,r??"",t.layerId.toString()))),i}const JP=new $e({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),YP=new $e({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let Ci=class extends pe(F){constructor(e){super(e),this.cardinality=null,this.catalogId=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};a([c({json:{read:JP.read,write:JP.write}})],Ci.prototype,"cardinality",void 0),a([c({json:{name:"catalogID"}})],Ci.prototype,"catalogId",void 0),a([c({json:{read:!0,write:!0}})],Ci.prototype,"composite",void 0),a([c({json:{read:!0,write:!0}})],Ci.prototype,"id",void 0),a([c({json:{read:!0,write:!0}})],Ci.prototype,"keyField",void 0),a([c({json:{read:!0,write:!0}})],Ci.prototype,"keyFieldInRelationshipTable",void 0),a([c({json:{read:!0,write:!0}})],Ci.prototype,"name",void 0),a([c({json:{read:!0,write:!0}})],Ci.prototype,"relatedTableId",void 0),a([c({json:{read:!0,write:!0}})],Ci.prototype,"relationshipTableId",void 0),a([c({json:{read:YP.read,write:YP.write}})],Ci.prototype,"role",void 0),Ci=a([b("esri.layers.support.Relationship")],Ci);const nye=[["binary","application/octet-stream","bin",""]];function bEe(t,e){return B9(e.name,t?.supportedFormats??[])!=null}function _Ee(t,e){if(!t)return!1;const r=oye(e,t.supportedFormats??[]);return r!=null&&t.editFormats.includes(r)}function U9(t,e){return O3(cye(t,e))}function q9(t,e){return O3(B9(t,e))}function SEe(t,e){return H9(uye(t,e))}function oye(t,e){return q9(t.name,e)??U9(t.type,e)}function x1(t,e,r){return U9(t,r)??q9(e,r)}function G9({supportedFormats:t}){return x1("model/gltf-binary","glb",t)}function $Ee(t){const e=G9(t);return e!=null&&t.editFormats.includes(e)}function aye({supportedFormats:t}){return x1("model/gltf+json","gltf",t)}function lye(t){if(!t)return null;const e=G9(t),r=aye(t);let i=null;for(const s of t.queryFormats){if(s===e)return s;s===r&&(i=s)}return i}function xEe({supportedFormats:t}){return x1("application/esri3do-SR_world","wld",t)}function TEe({supportedFormats:t}){return x1("application/esri3do-SR_prj","prj",t)}function E3(t){return[...nye,...t]}function uye(t,e){return E3(e).find(r=>O3(r)===t)}function cye(t,e){const r=t.toLowerCase();return E3(e).find(i=>H9(i)===r)}function B9(t,e){const r=t.toLowerCase();return E3(e).find(i=>dye(i).some(s=>r.endsWith(s)))}function O3(t){return t?.[0]}function H9(t){return t?.[1].toLowerCase()}function dye(t){return t?.[2].split(",").map(e=>e.toLowerCase())??[]}function MEe(t){return t.tables?.find(e=>e.role==="assetMaps")}function W(t,e,r){return!!W9(t,e,r)}function id(t,e,r){return W9(t,e,r)}function W9(t,e,r){return t&&t.hasOwnProperty(e)?t[e]:r}const hye={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function pye(t){const e=t?.supportedSpatialAggregationStatistics?.map(r=>r.toLowerCase());return{envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function Ty(t,e){return!!t?.supportedOperationsWithCacheHint?.map(i=>i.toLowerCase())?.includes(e.toLowerCase())}function fye(t){const e=t?.supportedStatisticTypes?.map(r=>r.toLowerCase());return{count:!!e?.includes("count"),sum:!!e?.includes("sum"),min:!!e?.includes("min"),max:!!e?.includes("max"),avg:!!e?.includes("avg"),var:!!e?.includes("var"),stddev:!!e?.includes("stddev"),percentileContinuous:!!e?.includes("percentile_cont"),percentileDiscrete:!!e?.includes("percentile_disc"),envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function mye(t){const e=t?.supportedNormalizationTypes?.map(r=>r.toLowerCase());return{field:!!e?.includes("field"),log:!!e?.includes("log"),naturalLog:!!e?.includes("naturallog"),percentOfTotal:!!e?.includes("percentoftotal"),squareRoot:!!e?.includes("squareroot")}}function Z9(t,e){return{analytics:yye(t),attachment:gye(t),data:vye(t),metadata:wye(t),operations:bye(t.capabilities,t,e),query:_ye(t,e),queryAttributeBins:xye(t),queryRelated:Sye(t),queryTopFeatures:$ye(t),editing:Tye(t)}}function yye(t){return{supportsCacheHint:Ty(t.advancedQueryCapabilities,"queryAnalytics")}}function gye(t){const e=t.attachmentProperties,r={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:Ty(t.advancedQueryCapabilities,"queryAttachments"),supportsOrderByFields:W(t.advancedQueryCapabilities,"supportsQueryAttachmentOrderByFields",!1),supportsResize:W(t,"supportsAttachmentsResizing",!1),supportsTypeWildcard:W(t.advancedQueryCapabilities,"supportsQueryAttachmentWithTypeWildcard",!1)};return e&&Array.isArray(e)&&e.forEach(i=>{const s=hye[i.name];s&&(r[s]=!!i.isEnabled)}),r}function vye(t){return{isVersioned:W(t,"isDataVersioned",!1),isBranchVersioned:W(t,"isDataBranchVersioned",!1),supportsAttachment:W(t,"hasAttachments",!1),supportsM:W(t,"hasM",!1),supportsZ:W(t,"hasZ",!1)}}function wye(t){return{supportsAdvancedFieldProperties:W(t,"supportsFieldDescriptionProperty",!1)}}function bye(t,e,r){const i=t?.toLowerCase().split(",").map(m=>m.trim())??[],s=r?nl(r):null,n=i.includes(s?.serverType==="MapServer"?"data":"query"),o=i.includes("editing")&&!e.datesInUnknownTimezone&&e.uniqueIdInfo?.OIDFieldContainsHashValue!==!0;let l=o&&i.includes("create"),u=o&&i.includes("delete"),d=o&&i.includes("update");const p=i.includes("changetracking"),f=e.advancedQueryCapabilities;return o&&!(l||u||d)&&(l=u=d=!0),{supportsCalculate:W(e,"supportsCalculate",!1),supportsTruncate:W(e,"supportsTruncate",!1),supportsValidateSql:W(e,"supportsValidateSql",!1),supportsAdd:l,supportsDelete:u,supportsEditing:o,supportsChangeTracking:p,supportsQuery:n,supportsQueryAnalytics:W(f,"supportsQueryAnalytic",!1),supportsQueryAttachments:W(f,"supportsQueryAttachments",!1),supportsQueryBins:W(f,"supportsQueryBins",!1)||!!e.queryBinsCapabilities,supportsQueryPivot:W(f,"supportsQueryPivot",!1),supportsQueryTopFeatures:W(f,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:W(e,"supportsAttachmentsResizing",!1),supportsSync:i.includes("sync"),supportsUpdate:d,supportsExceedsLimitStatistics:W(e,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:W(e,"supportsAsyncConvert3D",!1)}}function _ye(t,e){const r=t.advancedQueryCapabilities,i=t.ownershipBasedAccessControlForFeatures,s=t.archivingInfo,n=t.currentVersion,o=e?.includes("MapServer"),l=!o||n>=k("mapserver-pbf-version-support"),u=tv(e),d=new Set((t.supportedQueryFormats??"").split(",").map(p=>p.toLowerCase().trim()));return{maxRecordCount:id(t,"maxRecordCount",void 0),maxRecordCountFactor:id(t,"maxRecordCountFactor",void 0),maxUniqueIDCount:id(t,"maxUniqueIDCount",void 0),standardMaxRecordCount:id(t,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:pye(r),supportsCacheHint:W(r,"supportsQueryWithCacheHint",!1)||Ty(r,"query"),supportsCentroid:W(r,"supportsReturningGeometryCentroid",!1),supportsCentroidOnDegeneratedQuantizedGeometry:u||e==null,supportsCompactGeometry:u,supportsCurrentUser:W(r,"supportsCurrentUserQueries",!1),supportsDefaultSpatialReference:W(r,"supportsDefaultSR",!1),supportsDegeneratedQuantizedGeometry:W(r,"supportsDegeneratedQuantizedGeometry",!1),supportsDisjointSpatialRelationship:W(r,"supportsDisjointSpatialRel",!1),supportsDistance:W(r,"supportsQueryWithDistance",!1),supportsDistinct:W(r,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:W(r,"supportsReturningQueryExtent",!1),supportsFormatPBF:l&&d.has("pbf"),supportsFullTextSearch:W(r,"supportsFullTextSearch",!1),supportsGeometryProperties:W(r,"supportsReturningGeometryProperties",!1),supportsHavingClause:W(r,"supportsHavingClause",!1),supportsHistoricMoment:W(s,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:W(r,"supportsMaxRecordCountFactor",!1),supportsOrderBy:W(r,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:W(r,"supportsPagination",!1),supportsPaginationOnAggregatedQueries:W(r,"supportsPaginationOnAggregatedQueries",!1),supportsPercentileStatistics:W(r,"supportsPercentileStatistics",!1),supportsQuantization:W(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:W(t,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:W(i,"allowAnonymousToQuery",!0),supportsQueryByOthers:W(i,"allowOthersToQuery",!0),supportsQueryGeometry:W(t,"supportsReturningQueryGeometry",!1),supportsResultType:W(r,"supportsQueryWithResultType",!1),supportsReturnMesh:!!lye(t.infoFor3D),supportsSpatialAggregationStatistics:W(r,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:W(r,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:W(t,"useStandardizedQueries",!1),supportsStatistics:W(r,"supportsStatistics",t.supportsStatistics),supportsTopFeaturesQuery:W(r,"supportsTopFeaturesQuery",!1),supportsTrueCurve:W(r,"supportsTrueCurve",!1),tileMaxRecordCount:id(t,"tileMaxRecordCount",void 0)}}function Sye(t){const e=t.advancedQueryCapabilities,r=W(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:W(e,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r,supportsCacheHint:Ty(e,"queryRelated")}}function $ye(t){return{supportsCacheHint:Ty(t.advancedQueryCapabilities,"queryTopFilter")}}function xye(t){const e=t?t.queryBinsCapabilities:void 0;return{supportsDate:W(e,"supportsDateBin",!1),supportsFixedInterval:W(e,"supportsFixedIntervalBin",!1),supportsAutoInterval:W(e,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:W(e,"supportsFixedBoundariesBin",!1),supportsStackBy:W(e,"supportsStackBy",!1),supportsSplitBy:W(e,"supportsSplitBy",!1),supportsSnapToData:W(e,"supportsSnapToData",!1),supportsReturnFullIntervalBin:W(e,"supportsReturnFullIntervalBin",!1),supportsFirstDayOfWeek:W(e,"supportsFirstDayOfWeek",!1),supportsNormalization:W(e,"supportsNormalization",!1),supportedStatistics:fye(e),supportedNormalizationTypes:mye(e)}}function Tye(t){const e=t.ownershipBasedAccessControlForFeatures,r=t?t.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:W(t,"allowGeometryUpdates",!0),supportsGlobalId:W(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:W(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:W(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:W(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:W(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:W(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:W(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:W(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:W(e,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:W(r,"supportsAsyncApplyEdits",!1),zDefault:id(t,"zDefault",void 0)}}function IEe(t){return{operations:{supportsAppend:W(t,"supportsAppend",!1),supportsCoverageQuery:t?.playbackInfo?.klv["0601"]??!1,supportsExportClip:W(t,"supportsExportClip",!1),supportsExportFrameset:W(t,"supportsExportFrameset",!1),supportsMensuration:W(t,"supportsMensuration",!1),supportsPreviews:W(t,"supportsPreviews",!1),supportsUpdate:W(t,"supportsUpdate",!1)}}}let po=class extends pe(F){constructor(e){super(e),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(e){if(!e)return null;const r={};for(const i of Object.keys(e))r[i]=i1(e[i]);return r}writeDomains(e,r){if(!e)return;const i={};for(const s of Object.keys(e))e[s]&&(i[s]=e[s]?.toJSON());r.domains=i}};a([c({type:Number,json:{write:!0}})],po.prototype,"code",void 0),a([c({type:Object,json:{write:!0}})],po.prototype,"defaultValues",void 0),a([c({json:{write:!0}})],po.prototype,"domains",void 0),a([V("domains")],po.prototype,"readDomains",null),a([q("domains")],po.prototype,"writeDomains",null),a([c({type:String,json:{write:!0}})],po.prototype,"name",void 0),po=a([b("esri.layers.support.Subtype")],po);async function Mye(t){const e=t.spatialReference;if(e.isWGS84)return t.clone();if(e.isWebMercator)return cd(t);const r=Z.WGS84;return await xM(e,r),ll(t,r)}function Iye(t,e){if(!k3(t,e)){const r=t.typeKeywords;r?r.push(e):t.typeKeywords=[e]}}function k3(t,e){return!!t.typeKeywords?.includes(e)}function OEe(t){return k3(t,J9.HOSTED_SERVICE)}function Eye(t,e){const r=t.typeKeywords;if(r){const i=r.indexOf(e);i>-1&&r.splice(i,1)}}function kEe(t,e,r){r?Iye(t,e):Eye(t,e)}async function CEe(t){const e=t.clone().normalize();let r;if(e.length>1)for(const i of e)r?i.width>r.width&&(r=i):r=i;else r=e[0];return Mye(r)}const J9={CHARTS:"Charts",DYNAMIC:"Dynamic",GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function Oye(t){const{portal:e,isOrgItem:r,itemControl:i}=t,s=e.user?.privileges;let n=!s||s.includes("features:user:edit"),o=!!r&&!!s?.includes("features:user:fullEdit");const l=i==="update"||i==="admin";return l?o=n=!0:o&&(n=!0),{features:{edit:n,fullEdit:o},content:{updateItem:l}}}const kye=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.copyright=null,this.capabilities=null,this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.definitionExpression=null,this.displayField=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.fieldsIndex=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.globalIdField=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.indexes=new(H.ofType(_n)),this.isTable=!1,this.layerId=void 0,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.preferredTimeZone=null,this.relationships=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.sourceJSON=null,this.spatialReference=Z.WGS84,this.subtypeField=null,this.subtypes=null,this.trackIdField=null,this.uniqueIdFields=null,this.url=null,this.version=void 0,this._isUrlHostModified=!1,this._isUrlHostModificationEnabled=!1}getFieldDomain(i,s){throw new Error("Not implemented")}getField(i){return this.fieldsIndex.get(i)}get authenticationTriggerEvent(){if(!this.url)return null;const{capabilities:i}=this;if(i){const{query:n,operations:o,editing:l}=i;if(!n.supportsQueryByOthers||!n.supportsQueryByAnonymous||o.supportsEditing&&!(l.supportsUpdateByOthers&&l.supportsUpdateByAnonymous&&l.supportsDeleteByOthers&&l.supportsDeleteByAnonymous))return"load"}if(lw(this.serviceDefinitionExpression)||lw(this.definitionExpression))return"load";if(this.userHasUpdateItemPrivileges){if(Xme(this))return"load";if(this.hasUpdateItemRestrictions)return i.operations.supportsQuery?"editing":"load"}if(this.userHasFullEditingPrivileges&&this.hasFullEditingRestrictions)return"editing";const s=this.editFieldsInfo;return(s?.creatorField||s?.editorField)&&i?.operations.supportsEditing?"editing":null}readCapabilitiesFromService(i,s){return Z9(s,this.url)}readEditingInfo(i,s){const{editingInfo:n}=s;return n?{lastEditDate:n.lastEditDate!=null?new Date(n.lastEditDate):null}:null}get effectiveCapabilities(){const i=this.capabilities;if(!i)return null;const s=E(i),{operations:n,editing:o}=s;return B0(this)?(this.userHasUpdateItemPrivileges&&(n.supportsQuery=!0),s):this.userHasUpdateItemPrivileges?(n.supportsAdd=n.supportsDelete=n.supportsEditing=n.supportsQuery=n.supportsUpdate=o.supportsDeleteByOthers=o.supportsGeometryUpdate=o.supportsUpdateByOthers=!0,s):(this.userHasFullEditingPrivileges&&n.supportsEditing&&(n.supportsAdd=n.supportsDelete=n.supportsUpdate=o.supportsGeometryUpdate=!0),s)}get effectiveEditingEnabled(){return!1}readGlobalIdFieldFromService(i,s){return N9(s)}get hasFullEditingRestrictions(){const i=this.capabilities;if(!i||B0(this))return!1;const{operations:s,editing:n}=i;return s.supportsEditing&&!(s.supportsAdd&&s.supportsDelete&&s.supportsUpdate&&n.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){const i=this.capabilities;if(!i)return!1;const{operations:s,editing:n}=i;return B0(this)?!s.supportsQuery:!(s.supportsAdd&&s.supportsDelete&&s.supportsEditing&&s.supportsQuery&&s.supportsUpdate&&n.supportsDeleteByOthers&&n.supportsGeometryUpdate&&n.supportsUpdateByOthers)}readIsTableFromService(i,s){return s.type==="Table"}readMaxScale(i,s){return s.effectiveMaxScale||i||0}readMinScale(i,s){return s.effectiveMinScale||i||0}readObjectIdFieldFromService(i,s){return D9(s)}get parsedUrl(){return sye(this)}readServiceDefinitionExpression(i,s){return s.definitionQuery||s.definitionExpression}readUniqueIdFields(i,s){return s.uniqueIdInfo?.OIDFieldContainsHashValue?s.uniqueIdInfo.fields:null}readVersion(i,s){return Gme(s)}get isUrlHostModified(){const{loaded:i,url:s,_isUrlHostModified:n}=this;if(n)return!0;if(!i||!s||this.originIdOf("url")<7)return!1;const o=this.sourceJSON?.preferredHost;if(!o||!Cn(s,`https://${o}`,!0))return!1;for(let l=6;l>=3;l--){const u=this.getAtOrigin("url",wm(l));if(u)return!Cn(s,u,!0)}return!1}applyPreferredHost(i){const{url:s,portalItem:n}=this;!s||uS(n)}applyHostFromPortalItem(){const{url:i,portalItem:s}=this;if(!i||this.originIdOf("url")===7||!s?.url||!uS(s)||!k3(s,J9.HOSTED_SERVICE)||Cn(i,s.url,!0)||!this._isUrlHostModificationEnabled)return;const n=i7(s.url);this._set("url",yR(i,n)),this._isUrlHostModified=!0}};return a([c({readOnly:!0})],r.prototype,"authenticationTriggerEvent",null),a([c({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],r.prototype,"copyright",void 0),a([c({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","isDataBranchVersioned","isDataVersioned","maxRecordCount","maxRecordCountFactor","maxUniqueIDCount","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],r.prototype,"capabilities",void 0),a([V("service","capabilities")],r.prototype,"readCapabilitiesFromService",null),a([c(Ov("dateFieldsTimeReference"))],r.prototype,"dateFieldsTimeZone",void 0),a([c({type:Boolean})],r.prototype,"datesInUnknownTimezone",void 0),a([c({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],r.prototype,"definitionExpression",void 0),a([c({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],r.prototype,"displayField",void 0),a([c({readOnly:!0,type:ho})],r.prototype,"editFieldsInfo",void 0),a([c({readOnly:!0})],r.prototype,"editingInfo",void 0),a([V("editingInfo")],r.prototype,"readEditingInfo",null),a([c({readOnly:!0})],r.prototype,"effectiveCapabilities",null),a([c()],r.prototype,"effectiveEditingEnabled",null),a([c((()=>{const i=E(yfe),s=i.json.origins;return s["web-map"]={read:!1,write:!1},s["portal-item"]={read:!1,write:!1},i})())],r.prototype,"elevationInfo",void 0),a([c()],r.prototype,"fieldsIndex",void 0),a([c({type:rd,json:{name:"layerDefinition.floorInfo",write:{layerContainerTypes:qe}}})],r.prototype,"floorInfo",void 0),a([c({type:he,json:{origins:{service:{read:{source:"extent"}}}}})],r.prototype,"fullExtent",void 0),a([c()],r.prototype,"gdbVersion",void 0),a([c({readOnly:!0,type:td,json:{read:{source:"geometryProperties"}}})],r.prototype,"geometryFieldsInfo",void 0),a([c({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:Ox.read}}}})],r.prototype,"geometryType",void 0),a([c({type:String})],r.prototype,"globalIdField",void 0),a([V("service","globalIdField",["globalIdField","fields"])],r.prototype,"readGlobalIdFieldFromService",null),a([c({readOnly:!0})],r.prototype,"hasFullEditingRestrictions",null),a([c({type:Boolean,json:{origins:{service:{read:!0}}}})],r.prototype,"hasM",void 0),a([c({readOnly:!0})],r.prototype,"hasUpdateItemRestrictions",null),a([c({type:Boolean,json:{origins:{service:{read:!0}}}})],r.prototype,"hasZ",void 0),a([c({readOnly:!0,type:Ur})],r.prototype,"heightModelInfo",void 0),a([c({type:Date})],r.prototype,"historicMoment",void 0),a([c({type:H.ofType(_n),readOnly:!0})],r.prototype,"indexes",void 0),a([c({readOnly:!0})],r.prototype,"isTable",void 0),a([V("service","isTable",["type"])],r.prototype,"readIsTableFromService",null),a([c({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],r.prototype,"layerId",void 0),a([c(bfe)],r.prototype,"maxScale",void 0),a([V("service","maxScale",["maxScale","effectiveMaxScale"])],r.prototype,"readMaxScale",null),a([c(wfe)],r.prototype,"minScale",void 0),a([V("service","minScale",["minScale","effectiveMinScale"])],r.prototype,"readMinScale",null),a([c({type:String})],r.prototype,"objectIdField",void 0),a([V("service","objectIdField",["objectIdField","fields"])],r.prototype,"readObjectIdFieldFromService",null),a([c({readOnly:!0})],r.prototype,"parsedUrl",null),a([c(Ov("preferredTimeReference"))],r.prototype,"preferredTimeZone",void 0),a([c({type:[Ci],readOnly:!0})],r.prototype,"relationships",void 0),a([c({type:Boolean})],r.prototype,"returnM",void 0),a([c({type:Boolean})],r.prototype,"returnZ",void 0),a([c({readOnly:!0,json:{write:!1}})],r.prototype,"serverGens",void 0),a([c({readOnly:!0})],r.prototype,"serviceDefinitionExpression",void 0),a([V("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],r.prototype,"readServiceDefinitionExpression",null),a([c({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],r.prototype,"serviceItemId",void 0),a([c()],r.prototype,"sourceJSON",void 0),a([c({type:Z,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],r.prototype,"spatialReference",void 0),a([c({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],r.prototype,"subtypeField",void 0),a([c({type:[po],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],r.prototype,"subtypes",void 0),a([c({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],r.prototype,"trackIdField",void 0),a([c({type:[String],readOnly:!0})],r.prototype,"uniqueIdFields",void 0),a([V("service","uniqueIdFields",["uniqueIdInfo.OIDFieldContainsHashValue","uniqueIdInfo.fields"])],r.prototype,"readUniqueIdFields",null),a([c(iye({nonStandardUrlAllowed:!0}))],r.prototype,"url",void 0),a([c({json:{origins:{service:{read:!0}},read:!1}})],r.prototype,"version",void 0),a([V("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],r.prototype,"readVersion",null),a([c({readOnly:!0})],r.prototype,"isUrlHostModified",null),r=a([b("esri.layers.mixins.FeatureLayerBase")],r),r};let Cye=class extends Um{constructor(e){super(),this.type="aggregate",this.featureReductionProvider=e}get id(){return this.featureReductionProvider.id}get[fy](){const e=this.featureReductionProvider.featureReduction;return e&&"popupTemplate"in e?e:null}},Oa=class extends pe(F){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};a([c({type:String,json:{write:!0}})],Oa.prototype,"expression",void 0),a([c({type:String,json:{write:!0}})],Oa.prototype,"title",void 0),a([c({type:String,json:{write:!0}})],Oa.prototype,"returnType",void 0),Oa=a([b("esri.layers.support.ExpressionInfo")],Oa);var Cx,dh;let Ir=(dh=class extends F{constructor(e){super(e),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new Cx({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:E(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}},Cx=dh,dh);a([c({type:Boolean,json:{write:!0}})],Ir.prototype,"isAutoGenerated",void 0),a([c({type:String,json:{write:!0}})],Ir.prototype,"name",void 0),a([c({type:String,json:{write:!0}})],Ir.prototype,"alias",void 0),a([c({type:String,json:{write:!0}})],Ir.prototype,"onStatisticField",void 0),a([c({type:Oa,json:{write:!0}})],Ir.prototype,"onStatisticExpression",void 0),a([c({type:String,json:{write:!0}})],Ir.prototype,"statisticType",void 0),Ir=Cx=a([b("esri.layers.support.AggregateField")],Ir);let Ga=class extends F{constructor(){super(...arguments),this.type=null}};a([c({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],Ga.prototype,"type",void 0),Ga=a([b("esri.layers.support.FeatureReduction")],Ga);const C3="__begin__",P3="__end__",Pye=new RegExp(C3,"ig"),Aye=new RegExp(P3,"ig"),KP=new RegExp("^"+C3,"i"),QP=new RegExp(P3+"$","i"),uw='"',Rye=uw+" + ",Lye=" + "+uw;function Fye(t){return t.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function Nye(t){return t.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function A3(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):t.labelExpression!=null&&(e.expression=Fye(t.labelExpression),e.type="conventional"),e}function Dye(t){const e=A3(t);if(!e)return null;switch(e.type){case"conventional":return Px(e.expression);case"arcade":return e.expression}return null}function jye(t){const e=A3(t);if(!e)return null;switch(e.type){case"conventional":return zye(e.expression);case"arcade":return Y9(e.expression)}return null}function Px(t){let e;return t?(e=sl(t,r=>C3+'$feature["'+r+'"]'+P3),e=KP.test(e)?e.replace(KP,""):uw+e,e=QP.test(e)?e.replace(QP,""):e+uw,e=e.replaceAll(Pye,Rye).replaceAll(Aye,Lye)):e='""',e}const Vye=/^\s*\{([^}]+)\}\s*$/i;function zye(t){return t?.match(Vye)?.[1].trim()||null}const Uye=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,qye=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,Gye=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function Y9(t){if(!t)return null;let e=Uye.exec(t)||qye.exec(t);return e?e[1]||e[3]:(e=Gye.exec(t),e?e[2]:null)}var Ax,hh;let $o=(hh=class extends F{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(e,r){return r.value?Px(r.value):e}writeExpression(e,r,i){this.value!=null&&(e=Px(this.value)),e!=null&&(r[i]=e)}clone(){return new Ax({expression:this.expression,title:this.title,value:this.value})}},Ax=hh,hh);a([c({type:String,json:{write:{writerEnsuresNonNull:!0}}})],$o.prototype,"expression",void 0),a([V("expression",["expression","value"])],$o.prototype,"readExpression",null),a([q("expression")],$o.prototype,"writeExpression",null),a([c({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],$o.prototype,"title",void 0),a([c({json:{read:!1,write:!1}})],$o.prototype,"value",void 0),$o=Ax=a([b("esri.layers.support.LabelExpressionInfo")],$o);var Rx;const $g=new $e({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function xg(t,e,r){return{enabled:!lS(r?.layer)}}function K9(t){return!t||t.origin!=="service"&&t.layer?.type!=="map-image"}function Bye(t){return t?.type==="map-image"}function Q9(t){return!!Bye(t)&&!!t.capabilities?.exportMap?.supportsArcadeExpressionForLabeling}function Hye(t){return K9(t)||Q9(t?.layer)}var ph;let Ye=(ph=class extends F{static evaluateWhere(e,r){const i=(s,n,o)=>{switch(n){case"=":return s==o;case"<>":return s!=o;case">":return s>o;case">=":return s>=o;case"<":return s<o;case"<=":return s<=o}return!1};try{if(e==null)return!0;const s=e.split(" ");if(s.length===3)return i(r[s[0]],s[1],s[2]);if(s.length===7){const n=i(r[s[0]],s[1],s[2]),o=s[3],l=i(r[s[4]],s[5],s[6]);switch(o){case"AND":return n&&l;case"OR":return n||l}}return!1}catch{}}constructor(e){super(e),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=ume,this.useCodedValues=void 0,this.where=null}readLabelExpression(e,r){const i=r.labelExpressionInfo;if(!i||!i.value&&!i.expression)return e}writeLabelExpression(e,r,i){if(this.labelExpressionInfo){if(this.labelExpressionInfo.value!=null)e=Nye(this.labelExpressionInfo.value);else if(this.labelExpressionInfo.expression!=null){const s=Y9(this.labelExpressionInfo.expression);s&&(e="["+s+"]")}}e!=null&&(r[i]=e)}writeLabelExpressionInfo(e,r,i,s){if(e==null&&this.labelExpression!=null&&K9(s))e=new $o({expression:this.getLabelExpressionArcade()});else if(!e)return;const n=e.toJSON(s);n.expression&&(r[i]=n)}writeMaxScale(e,r){(e||this.minScale)&&(r.maxScale=e)}writeMinScale(e,r){(e||this.maxScale)&&(r.minScale=e)}getLabelExpression(){return A3(this)}getLabelExpressionArcade(){return Dye(this)}getLabelExpressionSingleField(){return jye(this)}hash(){return JSON.stringify(this)}clone(){return new Rx({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:E(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:E(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}},Rx=ph,ph);a([c({type:String,json:{write:!0}})],Ye.prototype,"name",void 0),a([c({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:xg}}}}})],Ye.prototype,"allowOverrun",void 0),a([c({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:xg}}}}})],Ye.prototype,"deconflictionStrategy",void 0),a([c({type:String,json:{write:{overridePolicy(t,e,r){return this.labelExpressionInfo&&r?.origin==="service"&&Q9(r.layer)?{enabled:!1}:{allowNull:!0}}}}})],Ye.prototype,"labelExpression",void 0),a([V("labelExpression")],Ye.prototype,"readLabelExpression",null),a([q("labelExpression")],Ye.prototype,"writeLabelExpression",null),a([c({type:$o,json:{write:{overridePolicy:(t,e,r)=>Hye(r)?{allowNull:!0}:{enabled:!1}}}})],Ye.prototype,"labelExpressionInfo",void 0),a([q("labelExpressionInfo")],Ye.prototype,"writeLabelExpressionInfo",null),a([c({type:$g.apiValues,json:{type:$g.jsonValues,read:$g.read,write:$g.write}})],Ye.prototype,"labelPlacement",void 0),a([c({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],Ye.prototype,"labelPosition",void 0),a([c({type:Number})],Ye.prototype,"maxScale",void 0),a([q("maxScale")],Ye.prototype,"writeMaxScale",null),a([c({type:Number})],Ye.prototype,"minScale",void 0),a([q("minScale")],Ye.prototype,"writeMinScale",null),a([c({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:xg}}}}})],Ye.prototype,"repeatLabel",void 0),a([c({type:Number,cast:Me,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:xg}}}}})],Ye.prototype,"repeatLabelDistance",void 0),a([c({types:sse,json:{origins:{"web-scene":{types:nse,write:DP,default:null}},write:DP,default:null}})],Ye.prototype,"symbol",void 0),a([c({type:Boolean,json:{write:!0}})],Ye.prototype,"useCodedValues",void 0),a([c({type:String,json:{write:!0}})],Ye.prototype,"where",void 0),Ye=Rx=a([b("esri.layers.support.LabelClass")],Ye);var Lx;let Hs=Lx=class extends F{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new Lx({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?.clone()??null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};a([c({type:String,json:{write:!0}})],Hs.prototype,"description",void 0),a([c({type:String,json:{write:!0}})],Hs.prototype,"label",void 0),a([c({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],Hs.prototype,"minValue",void 0),a([c({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],Hs.prototype,"maxValue",void 0),a([c($3)],Hs.prototype,"symbol",void 0),Hs=Lx=a([b("esri.renderers.support.ClassBreakInfo")],Hs);var Fx;const X9="log",H0="percent-of-total",W0="field",Tg=new $e({esriNormalizeByLog:X9,esriNormalizeByPercentOfTotal:H0,esriNormalizeByField:W0}),Wye=ct(Hs);let Tt=Fx=class extends cp(ji){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,r){if(!Array.isArray(t))return;let i=e.minValue;return t.map(s=>{const n=new Hs;return n.read(s,r),n.minValue==null&&(n.minValue=i),n.maxValue==null&&(n.maxValue=n.minValue),i=n.maxValue,n})}writeClassBreakInfos(t,e,r,i){const s=t.map(n=>n.write({},i));this._areClassBreaksConsecutive()&&s.forEach(n=>delete n.classMinValue),e[r]=s}castField(t){return t==null?t:typeof t=="function"?(L.getLogger(this).error(".field: field must be a string value"),null):ey(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,r=this.normalizationTotal!=null;return e||r?(t=e&&W0||r&&H0||null,e&&r&&L.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==W0&&t!==H0||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,r){let i=null;i=typeof t=="number"?new Hs({minValue:t,maxValue:e,symbol:wj(r)}):Wye(E(t)),this.classBreakInfos.push(i),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const r=this.classBreakInfos.length;for(let i=0;i<r;i++){const s=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(s[0]===t&&s[1]===e){this.classBreakInfos.splice(i,1);break}}}getBreakIndex(t,e){return this.valueExpression&&e?.arcade==null&&L.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let r=e;this.valueExpression&&e?.arcade==null&&(r={...r,arcade:await Nu()});const i=this.getBreakIndex(t,r);return i!==-1?this.classBreakInfos[i]:null}getSymbol(t,e){if(this.valueExpression&&e?.arcade==null)return void L.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const r=this.getBreakIndex(t,e);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let r=e;if(this.valueExpression&&e?.arcade==null){const s=await Nu(),{arcadeUtils:n}=s;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),r={...r,arcade:s}}const i=this.getBreakIndex(t,r);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}get symbols(){const t=[];return this.classBreakInfos.forEach(e=>{e.symbol&&t.push(e.symbol)}),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),r=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce((i,s)=>i+s.getMeshHash(),"")}.${r}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new Fx({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:E(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:E(this.visualVariables),legendOptions:E(this.legendOptions),authoringInfo:E(this.authoringInfo)})}async collectRequiredFields(t,e){const r=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(r)}async collectSymbolFields(t,e){const r=[...this.symbols.map(i=>i.collectRequiredFields(t,e)),Fr(t,e,null,this.valueExpression)];Rr(t,e,this.field),Rr(t,e,this.normalizationField),await Promise.all(r)}_getBreakIndexForExpression(t,e){const{viewingMode:r,scale:i,spatialReference:s,arcade:n,timeZone:o}=e??{},{valueExpression:l}=this;let u=this._compiledValueExpression.valueExpression===l?this._compiledValueExpression.compiledFunction:null;const d=n.arcadeUtils;if(!u){const f=d.createSyntaxTree(l);u=d.createFunction(f),this._compiledValueExpression.compiledFunction=u}this._compiledValueExpression.valueExpression=l;const p=d.executeFunction(u,d.createExecContext(t,d.getViewInfo({viewingMode:r,scale:i,spatialReference:s}),o));return this._getBreakIndexfromInfos(p)}_getBreakIndexForField(t){const e=this.field,r=t.attributes,i=this.normalizationType;let s=parseFloat(r[e]);if(i){const n=this.normalizationTotal,o=parseFloat(this.normalizationField?r[this.normalizationField]:void 0);if(i===X9)s=Math.log(s)*Math.LOG10E;else if(i!==H0||n==null||isNaN(n)){if(i===W0&&!isNaN(o)){if(isNaN(s)||isNaN(o))return-1;s/=o}}else s=s/n*100}return this._getBreakIndexfromInfos(s)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(t!=null&&typeof t=="number"&&!isNaN(t))for(let r=0;r<this.classBreakInfos.length;r++){const i=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(i[0]<=t&&(e?t<=i[1]:t<i[1]))return r}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let r=1;r<e;r++)if(t[r-1].maxValue!==t[r].minValue)return!1;return!0}};a([c(x3)],Tt.prototype,"backgroundFillSymbol",void 0),a([c({type:[Hs],json:{write:{isRequired:!0}}})],Tt.prototype,"classBreakInfos",void 0),a([V("classBreakInfos")],Tt.prototype,"readClassBreakInfos",null),a([q("classBreakInfos")],Tt.prototype,"writeClassBreakInfos",null),a([c({type:String,json:{write:!0}})],Tt.prototype,"defaultLabel",void 0),a([c($1)],Tt.prototype,"defaultSymbol",void 0),a([c({type:String,json:{write:!0}})],Tt.prototype,"field",void 0),a([Ce("field")],Tt.prototype,"castField",null),a([c({type:Boolean})],Tt.prototype,"isMaxInclusive",void 0),a([c({type:T3,json:{write:!0}})],Tt.prototype,"legendOptions",void 0),a([c({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],Tt.prototype,"minValue",null),a([c({type:String,json:{write:!0}})],Tt.prototype,"normalizationField",void 0),a([c({type:Number,json:{write:!0}})],Tt.prototype,"normalizationTotal",void 0),a([c({type:Tg.apiValues,value:null,json:{type:Tg.jsonValues,read:Tg.read,write:Tg.write}})],Tt.prototype,"normalizationType",null),a([se({classBreaks:"class-breaks"})],Tt.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],Tt.prototype,"valueExpression",void 0),a([c({type:String,json:{write:!0}})],Tt.prototype,"valueExpressionTitle",void 0),Tt=Fx=a([b("esri.renderers.ClassBreaksRenderer")],Tt);const Nx=-3,Zye=Nx-1,Jye=!!k("esri-tests-disable-gpu-memory-measurements");let Yye=class{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._users=new Map,this._sizeLimits=new Map}destroy(){this.clearAll(),this._sizeLimits.clear(),this._users.clear(),this._db=null}register(e){this._users.set(e.id.slice(0,-1),e)}deregister(e){this.clear(e),this._sizeLimits.delete(e),this._users.delete(e.id.slice(0,-1))}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,r){return this._db.get(e.id+r)?.size??0}put(e,r,i,s,n){r=e.id+r;const o=this._db.get(r);if(o&&(this._size-=o.size,e.size-=o.size,this._db.delete(r),o.entry!==i&&this._notifyRemove(r,o.entry,o.size,0)),s>this._maxSize)return void this._notifyRemove(r,i,s,0);if(i===void 0)return void console.warn("Refusing to cache undefined entry ");if(!s||s<0)return Jye||console.warn(`Refusing to cache entry with size ${s} for key ${r}`),void this._notifyRemove(r,i,0,0);const l=1+Math.max(n,Zye)-Nx;this._db.set(r,new Kye(i,s,l)),this._size+=s,e.size+=s,this._checkSize()}updateSize(e,r){r=e.id+r;const i=this._db.get(r);if(!i)return;this._size-=i.size,e.size-=i.size;let s=i.entry.usedMemory;for(;s>this._maxSize;){const n=this._notifyRemove(r,i.entry,s,1);if(!(n!=null&&n>0))return void this._db.delete(r);s=n}i.size=s,this._size+=s,e.size+=s,this._checkSize()}pop(e,r){r=e.id+r;const i=this._db.get(r);if(i)return this._size-=i.size,e.size-=i.size,this._db.delete(r),++this._hit,i.entry;++this._miss}get(e,r){r=e.id+r;const i=this._db.get(r);if(i!==void 0)return this._db.delete(r),i.lives=i.lifetime,this._db.set(r,i),++this._hit,i.entry;++this._miss}peek(e,r){const i=this._db.get(e.id+r);return i?++this._hit:++this._miss,i?.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},r={},i=new Array;this._db.forEach((o,l)=>{const u=o.lifetime;i[u]=(i[u]||0)+o.size,this._users.forEach(d=>{const{id:p,name:f}=d;if(l.startsWith(p)){const m=r[f]||0;r[f]=m+o.size}})});const s={};this._users.forEach(o=>{const l=o.name;if("hitRate"in o&&typeof o.hitRate=="number"&&!isNaN(o.hitRate)&&o.hitRate>0){const u=r[l]||0;r[l]=u,s[l]=Math.round(100*o.hitRate)+"%"}else s[l]="0%"});const n=Object.keys(r);n.sort((o,l)=>r[l]-r[o]),n.forEach(o=>e[o]=Math.round(r[o]/2**20)+"MB / "+s[o]);for(let o=i.length-1;o>=0;--o){const l=i[o];l&&(e["Priority "+(o+Nx-1)]=Math.round(l/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forEach(e=>e.resetHitRate())}clear(e){const r=e.id;this._db.forEach((i,s)=>{s.startsWith(r)&&(this._size-=i.size,this._db.delete(s),this._notifyRemove(s,i.entry,i.size,0))}),e.size=0}clearAll(){this._db.forEach((e,r)=>this._notifyRemove(r,e.entry,e.size,0)),this._users.forEach(e=>e.size=0),this._size=0,this._db.clear()}*values(e){for(const[r,i]of this._db)r.startsWith(e.id)&&(yield i.entry)}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,r,i,s){const n=this._users.get(e.split(u_)[0])?.removeFunc,o=n?.(r,s,i);return typeof o=="number"?o:null}_checkSize(){this._sizeLimits.forEach((e,r)=>this._checkSizeLimits(e,r)),this._checkSizeLimits(this.maxSize)}setMaxSize(e,r){r==null||r<=0?this._sizeLimits.delete(e):this._sizeLimits.set(e,r)}_checkSizeLimits(e,r){const i=r??this;if(i.size<=e)return;const s=r?.id;let n=!0;for(;n;){n=!1;for(const[o,l]of this._db)if(l.lifetime===0&&(!s||o.startsWith(s))){const u=r??this._users.get(o.split(u_)[0]);if(this._purgeItem(o,l,u),i.size<=.9*e)return;n||=this._db.has(o)}}for(const[o,l]of this._db)if(!s||o.startsWith(s)){const u=r??this._users.get(o.split(u_)[0]);if(this._purgeItem(o,l,u),i.size<=.9*e)return}}_purgeItem(e,r,i){if(this._db.delete(e),r.lives<=1){this._size-=r.size,i&&(i.size-=r.size);const s=this._notifyRemove(e,r.entry,r.size,1);s!=null&&s>0&&(this._size+=s,i&&(i.size+=s),r.lives=r.lifetime,r.size=s,this._db.set(e,r))}else--r.lives,this._db.set(e,r)}},Kye=class{constructor(e,r,i){this.entry=e,this.size=r,this.lifetime=i,this.lives=i}};const u_=":";let Qye=class{constructor(e,r){this.removeFunc=r,this._storage=new Yye,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this)}destroy(){this._storage.deregister(this),this._storage.destroy(),this._storage=null}put(e,r,i=1){this._storage.put(this,e,r,i,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}},XP=class eV{static parse(e,r,i){const s=[],n=[],o=e.split(";");for(let l=0;l<o.length;l++){const u=o[l];if(u){if(u.includes("po:")){const d=u.slice(3).split("|");if(d.length===3){const[p,f,m]=d,y=ege(p,f,m);y&&n.push(y)}continue}if(u.includes("|")){for(const d of u.split("|"))if(r.has(d)){s.push(d);break}}else if(r.has(u))s.push(u);else if(l===0){s.length=0,s.push(tge(i));break}}}return new eV(s,n)}constructor(e,r){this.partNames=e,this.overrides=r}};function Xye(t,e){if(t==="DashTemplate")return e.split(" ").map(r=>Number(r));if(t==="Color"){const r=new ue(e).toRgba();return[r[0],r[1],r[2],255*r[3]]}return Number(e)}function ege(t,e,r){return{primitiveName:t,propertyName:e,value:Xye(e,r),defaultValue:null}}function tge(t){switch(t){case"esriGeometryPolyline":return"Invalid_L";case"esriGeometryPolygon":return"Invalid_A";default:return"Invalid_P"}}var fh;let En=(fh=class{},fh.instance=new _i("Etc/UTC"),fh);function rge(t){return t instanceof Wu?t===En.instance:t?.toString().toLowerCase()==="unknown"}function DEe(t){return rge(t)?En.instance:t}function ige(t){return"timeZone"in t}function sge(t){return"timeZone"in t}function nge(t){return"dateFieldsTimeZone"in t}const oge=new Map;let cw=class Z0{static fromJSON(e){return new Z0(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new Z0(e.fields??[],tA(e))}static fromLayerJSON(e){return new Z0(e.fields??[],tA(e))}constructor(e=[],r){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=r?new Map(r):null;const i=[];for(const s of this.fields){const n=s?.name,o=eA(n);if(n&&o){const l=Ql(n);this._fieldsMap.set(n,s),this._fieldsMap.set(l,s),this._normalizedFieldsMap.set(o,s),i.push(`${l}:${s.type}:${this._timeZoneByFieldName?.get(n)}`),$4(s)?(this.dateFields.push(s),this._dateFieldsSet.add(s)):CM(s)&&(this._numericFieldsSet.add(s),this.numericFields.push(s)),WO(s)||ZO(s)||(s.editable=s.editable==null||!!s.editable,s.nullable=s.nullable==null||!!s.nullable)}}i.sort(),this.uid=i.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)WO(e)||ZO(e)||e.nullable||xre(e)!==void 0||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return this.get(e)!=null}get(e){if(!e)return;let r=this._fieldsMap.get(e);return r||(r=this._fieldsMap.get(Ql(e))??this._normalizedFieldsMap.get(eA(e)),r&&this._fieldsMap.set(e,r),r)}getTimeZone(e){const r=this.get(e&&typeof e!="string"?e.name:e);return r?this._timeZoneByFieldName?this._timeZoneByFieldName.get(r.name):r.type==="date"||r.type==="esriFieldTypeDate"?(L.getLogger("esri.layers.support.FieldsIndex").errorOnce(new x("getTimeZone:no-timezone-information",`no time zone information for field '${r.name}'`)),Qa):tV.has(r.type)?Ka:null:null}getLuxonTimeZone(e){const r=this.getTimeZone(e);return r?r===Ka?En.instance:r===Qa?Lt.utcInstance:zh(oge,r,()=>_i.create(r)):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return x4(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map(e=>gm(e)?e.toJSON():e),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}};function Ql(t){return t.trim().toLowerCase()}function eA(t){return cre(t)?.toLowerCase()??""}const tV=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function tA(t){const e=new Map;if(!t.fields)return e;const r=t.datesInUnknownTimezone===!0,{timeInfo:i,editFieldsInfo:s}=t,n=(i?"startField"in i?i.startField:i.startTimeField:"")??"",o=(i?"endField"in i?i.endField:i.endTimeField:"")??"",l=nge(t)?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?Bg(t.dateFieldsTimeReference):null,u=s?ige(s)?s.timeZone??l:s.dateFieldsTimeReference?Bg(s.dateFieldsTimeReference):l??Qa:null,d=i?sge(i)?i.timeZone??l:i.timeReference?Bg(i.timeReference):l:null,p=new Map([[Ql(s?.creationDateField??""),u],[Ql(s?.editDateField??""),u],[Ql(n),d],[Ql(o),d]]);for(const{name:f,type:m}of t.fields)if(tV.has(m))e.set(f,Ka);else if(m!=="date"&&m!=="esriFieldTypeDate")e.set(f,null);else if(r)e.set(f,Ka);else{const y=p.get(Ql(f??""))??l;e.set(f,y)}return e}const rV={TypeNotAllowedInFeature:"Feature attributes only support dates, numbers, strings, guids.",LogicError:"Logic error - {reason}",CannotCompareDateAndTime:"Cannot compare date or dateonly with timeonly types",NeverReach:"Encountered unreachable logic",AsyncNotEnabled:"Async Arcade must be enabled for this script",ModuleAccessorMustBeString:"Module accessor must be a string",ModuleExportNotFound:"Module has no export with provided identifier",ModulesNotSupported:"Current profile does not support modules",ArrayAccessMustBeNumber:"Array accessor must be a number",FunctionNotFound:"Function not found",FieldNotFound:"Key not found - {key}",CircularModules:"Circular module dependencies are not allowed",Cancelled:"Execution cancelled",UnsupportedHashType:"Type not supported in hash function",IllegalResult:"Value is not a supported return type",PortalRequired:"Portal is required",InvalidParameter:"Invalid parameter",WrongNumberOfParameters:"Call with wrong number of parameters",Unrecognized:"Unrecognized code structure",UnrecognizedType:"Unrecognized type",WrongSpatialReference:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",BooleanConditionRequired:"Conditions must use booleans",NoFunctionInDictionary:"Dictionaries cannot contain functions.",NoFunctionInArray:"Arrays cannot contain functions.",NoFunctionInTemplateLiteral:"Template Literals do not expect functions by value.",KeyAccessorMustBeString:"Accessor must be a string",KeyMustBeString:"Object keys must be a string",Immutable:"Object is immutable",UnexpectedToken:"Unexpected token",MemberOfNull:"Cannot access property of null object",MaximumCallDepth:"Exceeded maximum function depth",OutOfBounds:"Out of bounds",InvalidIdentifier:"Identifier not recognized",CallNonFunction:"Expression is not a function",InvalidMemberAccessKey:"Cannot access value using a key of this type",AssignModuleFunction:"Cannot assign function to module variable",UnsupportUnaryOperator:"Unsupported unary operator",UnsupportedOperator:"Unsupported operator",LogicalExpressionOnlyBoolean:"Logical expressions must be boolean",LogicExpressionOrAnd:"Logical expression can only be combined with || or &&",CannotChangeTimeZoneTime:"Cannot change the timezone of a Time",CannotChangeTimeZoneDateOnly:"Cannot change the timezone of a DateOnly",FeatureSetDoesNotHaveSubtypes:"FeatureSet does not have subtypes"};let age=class extends Error{constructor(...e){super(...e)}},rA=class iV extends age{constructor(e,r){super(R3(r)+e.message,{cause:e}),this.loc=null,Error.captureStackTrace&&Error.captureStackTrace(this,iV),r?.loc&&(this.loc=r.loc)}},lge=class sV extends Error{constructor(e,r,i,s){super("Execution error - "+R3(i)+sl(rV[r],s)),this.loc=null,this.declaredRootClass="esri.arcade.arcadeexecutionerror",Error.captureStackTrace&&Error.captureStackTrace(this,sV),i?.loc&&(this.loc=i.loc)}};function R3(t){return t&&t.loc?`Line : ${t.loc.start?.line}, ${t.loc.start?.column}: `:""}let VEe=class nV extends Error{constructor(e,r,i,s){super("Compilation error - "+R3(i)+sl(rV[r],s)),this.loc=null,this.declaredRootClass="esri.arcade.arcadecompilationerror",Error.captureStackTrace&&Error.captureStackTrace(this,nV),i?.loc&&(this.loc=i.loc)}},zEe=class oV extends Error{constructor(){super("Uncompilable code structures"),this.declaredRootClass="esri.arcade.arcadeuncompilableerror",Error.captureStackTrace&&Error.captureStackTrace(this,oV)}};function UEe(t,e,r){return r.declaredRootClass==="esri.arcade.arcadeexecutionerror"||r.declaredRootClass==="esri.arcade.arcadecompilationerror"?r.loc===null&&e?.loc?new rA(r,{cause:r}):r:(r.declaredRootClass==="esri.arcade.featureset.support.featureseterror"||r.declaredRootClass==="esri.arcade.featureset.support.sqlerror"||r.declaredRootClass,e?.loc?new rA(r,{cause:r}):r)}const uge={UnrecognizedUri:"Unrecognized uri - {uri}",UnsupportedUriProtocol:"Unrecognized uri protocol"};let qEe=class aV extends Error{constructor(e,r){super(sl(uge[e],r)),this.declaredRootClass="esri.arcade.arcademoduleerror",Error.captureStackTrace&&Error.captureStackTrace(this,aV)}};function J0(t){return t.toLowerCase().replaceAll(/[\s-]+/g,"")}let GEe=class{constructor(e,r){const i=new Map;for(const s of e){const n=J0(s);if(i.has(n))throw new Error(`${s} already added as ${i.get(n)}`);i.set(n,s)}if(r!=null)for(const[s,n]of r){const o=J0(s);if(i.has(o))throw new Error(`${s} already associated with ${i.get(o)}`);i.set(o,n)}this._enumMap=i}lookup(e){return this._enumMap.get(J0(e))}get(e){const r=this.lookup(e);if(r==null)throw new lge(null,"InvalidParameter",null);return r}};const cge={TimeZoneNotRecognized:"Timezone identifier has not been recognized."};let dge=class lV extends Error{constructor(e,r){super(sl(cge[e],r)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,lV)}};function mc(t,e,r){return t<e?t-e:t>r?t-r:0}function yc(t,e,r){return t<e?e:t>r?r:t}let Ao=class $t{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,r=1,i=1,s=0,n=0,o=0,l=0,u){if(isNaN(e)||isNaN(r)||isNaN(i)||isNaN(s)||isNaN(n)||isNaN(o)||isNaN(l))return null;const d=Y.local(e,r).daysInMonth;let p=Y.fromObject({day:yc(i,1,d),year:e,month:yc(r,1,12),hour:yc(s,0,23),minute:yc(n,0,59),second:yc(o,0,59),millisecond:yc(l,0,999)},{zone:$n(u)});return p=p.plus({months:mc(r,1,12),days:mc(i,1,d),hours:mc(s,0,23),minutes:mc(n,0,59),seconds:mc(o,0,59),milliseconds:mc(l,0,999)}),new $t(p)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,r){const i=$n(r);return e.isUnknownTimeZone||i===En.instance?$t.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,i):new $t(e._date.setZone(i))}static dateJSToArcadeDate(e){return new $t(Y.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,r="system"){const i=$n(r);return new $t(Y.fromJSDate(e,{zone:i}))}static unknownEpochToArcadeDate(e){return new $t(Y.fromMillis(e,{zone:En.instance}))}static unknownDateJSToArcadeDate(e){return new $t(Y.fromMillis(e.getTime(),{zone:En.instance}))}static epochToArcadeDate(e,r="system"){const i=$n(r);return new $t(Y.fromMillis(e,{zone:i}))}static dateTimeToArcadeDate(e){return new $t(e)}clone(){return new $t(this._date)}changeTimeZone(e){const r=$n(e);return $t.dateTimeToArcadeDate(this._date.setZone(r))}static dateTimeAndZoneToArcadeDate(e,r){const i=$n(r);return e.zone===En.instance||i===En.instance?$t.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,i):new $t(e.setZone(i))}static nowToArcadeDate(e){const r=$n(e);return new $t(Y.fromJSDate(new Date,{zone:r}))}static nowUTCToArcadeDate(){return new $t(Y.utc())}get isSystem(){return this.timeZone==="system"||this.timeZone===$t.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===En.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if(this._date.zone.type==="system")return"system";const e=this.zone;return e.type==="fixed"?e.fixed===0?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new $t(this._date.plus(e))}diff(e,r){return this._date.diff(e._date,r)[r]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,r){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:r&&!this.isUnknownTimeZone})}toFormat(e,r){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,r)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new $t(this._date.toUTC())}toLocal(){return new $t(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const r=Y.fromISO(e,{setZone:!0});return new $t(r)}};function $n(t,e=!0){if(t instanceof Wu)return t;switch(J0(t)){case"system":return"system";case"utc":return"UTC";case"unknown":return En.instance}if(/^[+-]?[0-9]{1,2}(:[0-9]{2})?$/.test(t)){const i=Lt.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(i)return i}const r=_i.create(t);if(!r.isValid){if(e)throw new dge("TimeZoneNotRecognized");return null}return r}function iA(t){t=t.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$&]");let e="";const r=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const i of t.match(r)||[])switch(i){case"D":e+="d";break;case"DD":e+="dd";break;case"DDD":e+="o";break;case"d":e+="c";break;case"ddd":e+="ccc";break;case"dddd":e+="cccc";break;case"M":e+="L";break;case"MM":e+="LL";break;case"MMM":e+="LLL";break;case"MMMM":e+="LLLL";break;case"YY":e+="yy";break;case"Y":case"YYYY":e+="yyyy";break;case"Q":e+="q";break;case"X":case"x":e+=i;break;default:i.length>=2&&i.startsWith("[")&&i.endsWith("]")?e+=`'${i.slice(1,-1)}'`:e+=`'${i}'`}return e}const sA="esri.core.sql.dateonly";let hge=class Pi{constructor(e,r,i){this._year=e,this._month=r,this._day=i,this.declaredRootClass=sA}static isDateOnly(e){return typeof e=="object"&&e!=null&&"declaredRootClass"in e&&e.declaredRootClass===sA}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(e){return Pi.isDateOnly(e)&&e.day===this.day&&e.month===this.month&&e.year===this.year}clone(){return new Pi(this._year,this._month,this._day)}toDateTime(e){return Y.fromObject({day:this.day,month:this.month,year:this.year},{zone:$n(e)})}toDateTimeLuxon(e){return Y.fromObject({day:this.day,month:this.month,year:this.year},{zone:$n(e)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(e=null,r=!0){if(e===null||e==="")return this.toString();if(r&&(e=iA(e)),!e)return"";const i=this.toDateTime("unknown");return Ao.dateTimeToArcadeDate(i).toFormat(e,{locale:vi(),numberingSystem:"latn"})}toArcadeDate(){const e=this.toDateTime("unknown");return Ao.dateTimeToArcadeDate(e)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(e,r){return Pi.fromDateTime(this.toUTCDateTime().plus({[e]:r}))}toUTCDateTime(){return Y.utc(this.year,this.month,this.day,0,0,0,0)}difference(e,r){switch(r.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return r==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}static fromMilliseconds(e){const r=Y.fromMillis(e,{zone:Lt.utcInstance});return r.isValid?Pi.fromParts(r.year,r.month,r.day):null}static fromSeconds(e){const r=Y.fromSeconds(e,{zone:Lt.utcInstance});return r.isValid?Pi.fromParts(r.year,r.month,r.day):null}static fromReader(e){if(!e)return null;const r=e.split("-");return r.length!==3?null:new Pi(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10))}static fromParts(e,r,i){const s=new Pi(e,r,i);return s.isValid===!1?null:s}static fromDateJS(e){return Pi.fromParts(e.getFullYear(),e.getMonth()+1,e.getDay())}static fromDateTime(e){return Pi.fromParts(e.year,e.month,e.day)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,r=null){if(e===""||e===null)return null;const i=[];if(r)(r=iA(r))&&i.push(r);else if(r===null||r===""){const s=Y.fromISO(e,{setZone:!0});return s.isValid?Pi.fromParts(s.year,s.month,s.day):null}for(const s of i){const n=Y.fromFormat(e,r??s);if(n.isValid)return new Pi(n.year,n.month,n.day)}return null}static fromNow(e="system"){const r=Y.fromJSDate(new Date).setZone($n(e));return new Pi(r.year,r.month,r.day)}};function HEe(t){if(t==null)return null;switch(t.type){case"polygon":case"multipoint":case"polyline":return t.extent;case"point":return new he({xmin:t.x,ymin:t.y,xmax:t.x,ymax:t.y,spatialReference:t.spatialReference});case"extent":return t}return null}function WEe(t){if(t==null)return null;const e=t.clone();return t.cache._geVersion!==void 0&&(e.cache._geVersion=t.cache._geVersion),e}function Mg(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function nA(t){if(!t)return"";const e=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let r="";for(const i of t.match(e)||[])switch(i){case"SSS":case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":r+=i;break;case"A":case"a":r+="a";break;default:r+=`'${i}'`}return r}const oA="esri.core.sql.timeonly";let pge=class vn{constructor(e,r,i,s){this._hour=e,this._minute=r,this._second=i,this._millisecond=s,this.declaredRootClass=oA}static isTimeOnly(e){return typeof e=="object"&&e!=null&&"declaredRootClass"in e&&e.declaredRootClass===oA}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(e){return vn.isTimeOnly(e)&&e.hour===this.hour&&e.minute===this.minute&&e.second===this.second&&e.millisecond===this.millisecond}clone(){return new vn(this.hour,this.minute,this.second,this.millisecond)}isValid(){return Mg(this.hour)&&Mg(this.minute)&&Mg(this.second)&&Mg(this.millisecond)&&this.hour>=0&&this.hour<24&&this.minute>=0&&this.minute<60&&this.second>=0&&this.second<60&&this.millisecond>=0&&this.millisecond<1e3}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(e=null){return e===null||e===""?this.toString():(e=nA(e))?Y.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(e,{locale:vi(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1e3*this.second+1e3*this.minute*60+60*this.hour*60*1e3}static fromParts(e,r,i,s){const n=new vn(e,r,i,s);return n.isValid()?n:null}static fromReader(e){if(!e)return null;const r=e.split(":");return r.length!==3?null:new vn(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10),0)}static fromMilliseconds(e){if(e>864e5||e<0)return null;const r=Math.floor(e/1e3%60),i=Math.floor(e/6e4%60),s=Math.floor(e/36e5%24),n=Math.floor(e%1e3);return new vn(s,i,r,n)}static fromDateJS(e){return new vn(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}static fromDateTime(e){return new vn(e.hour,e.minute,e.second,e.millisecond)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,r=null){if(e===""||e===null)return null;const i=[];r?(r=nA(r))&&i.push(r):r!==null&&r!==""||(i.push("HH:mm:ss"),i.push("HH:mm:ss.SSS"),i.push("hh:mm:ss a"),i.push("hh:mm:ss.SSS a"),i.push("HH:mm"),i.push("hh:mm a"),i.push("H:mm"),i.push("h:mm a"),i.push("H:mm:ss"),i.push("h:mm:ss a"),i.push("H:mm:ss.SSS"),i.push("h:mm:ss.SSS a"));for(const s of i){const n=Y.fromFormat(e,s);if(n.isValid)return new vn(n.hour,n.minute,n.second,n.millisecond)}return null}plus(e,r){switch(e){case"days":case"years":case"months":return this.clone();case"hours":case"minutes":case"seconds":case"milliseconds":return vn.fromDateTime(this.toUTCDateTime().plus({[e]:r}))}return null}toUTCDateTime(){return Y.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(e,r){switch(r.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return r==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}};const fge=["geometry","scale","timeProperties"];function ZEe(t,e){if(e!=null)for(const r of fge)e.hasArcadeDependency(r)&&t.add(r);return t}function JEe(t,e){return uV.create(t,e,null,["$feature","$view"])}function mge(t,e,r){return uV.create(t,e,r,["$feature","$view","$config"])}let uV=class cV{static async create(e,r,i,s){const{arcade:n,Dictionary:o}=await Nu();let l;try{l=n.parseScript(e)}catch(y){throw new x("arcade-bad-expression","Failed to parse arcade script",{script:e,error:y})}const u=n.scriptUsesGeometryEngine(l);u&&await n.enableGeometrySupport(),await n.loadDependentModules(new Set,l,null,!1,u);const d={vars:s.reduce((y,g)=>({...y,[g]:null}),{}),spatialReference:r,useAsync:!1},p=n.compileScript(l,d);let f=null;i!=null&&(f=new o(i),f.immutable=!0);const m=new o;return m.immutable=!1,m.setField("scale",0),new cV(e,n,l,p,r,m,f,o)}constructor(e,r,i,s,n,o,l,u){this.script=e,this._arcade=r,this._syntaxTree=i,this._compiled=s,this._spatialReference=n,this._viewDict=o,this._configDict=l,this._dictionaryCtor=u,this._dependencies=new Map,this._featureReader=new dV,this._dependencies.set("geometry",r.scriptTouchesGeometry(this._syntaxTree)),this._dependencies.set("scale",this._arcade.referencesMember(this._syntaxTree,"scale")),this._dependencies.set("timeProperties",this._arcade.scriptUsesViewProperties(this._syntaxTree,["timeProperties"]))}evaluate(e,r){const i=r.$view?.timeZone;if(r.$view){let s;if(this._viewDict.setField("scale",r.$view.scale),r.$view.timeProperties!=null){const{currentStart:n,currentEnd:o}=r.$view.timeProperties;s=new this._dictionaryCtor({currentStart:n!=null?i!=null?Ao.epochToArcadeDate(n,i):Ao.unknownEpochToArcadeDate(n):void 0,currentEnd:o!=null?i!=null?Ao.epochToArcadeDate(o,i):Ao.unknownEpochToArcadeDate(o):void 0,startIncluded:!0,endIncluded:!0})}this._viewDict.setField("timeProperties",s)}return this._compiled({vars:{$view:this._viewDict,$config:this._configDict,$feature:e},spatialReference:this._spatialReference,timeZone:i})}repurposeFeature(e,r){return this._featureReader.bind(e,r,this._spatialReference),this._featureReader}references(e){return this._dependencies.get(e)??!1}},dV=class{constructor(){this._boundTarget=null,this._boundSchema={fields:null,fieldsIndex:null,spatialReference:null,get geometryType(){return null},get objectIdField(){return null}},this.arcadeDeclaredClass="esri.arcade.Feature",this._contextTimeZone=null}bind(e,r,i){const s=r??new cw(hV(e.attributes));this._boundTarget=e,this._boundSchema.fields=s.fields,this._boundSchema.fieldsIndex=s,this._boundSchema.spatialReference=i}_getField(e){return this._boundSchema.fieldsIndex.get(e)}get contextTimeZone(){return this._contextTimeZone}set contextTimeZone(e){this._contextTimeZone=e}readArcadeFeature(){return this}hasField(e){return this._boundSchema.fieldsIndex.has(e)}geometry(){if("fromJSON"in this._boundTarget)return this._boundTarget.geometry;const e=tl(this._boundTarget.geometry);if(e){if(!this._boundSchema.spatialReference)throw new Error("InternalError: Expected spatial reference to be defined");e.spatialReference=this._boundSchema.spatialReference}return e}_hasGeometry(){return this._boundTarget.geometry!=null}isUnknownDateTimeField(e){return this._boundSchema.fieldsIndex.getTimeZone(e)===Ka}field(e,r=!0){const i=this._getField(e);if(i){const s=this._boundTarget.attributes[i.name];if(s==null)return null;switch(i.type){case"date-only":case"esriFieldTypeDateOnly":return hge.fromReader(s);case"time-only":case"esriFieldTypeTimeOnly":return pge.fromReader(s);case"esriFieldTypeTimestampOffset":case"timestamp-offset":return Ao.fromReaderAsTimeStampOffset(s);case"date":case"esriFieldTypeDate":return this.isUnknownDateTimeField(e)?Ao.unknownEpochToArcadeDate(s):Ao.epochToArcadeDate(s,this.contextTimeZone??rn);default:return s}}if(r)throw new Error(`Field ${e} does not exist`);return null}setField(e,r){throw new Error("Unable to update feature attribute values, feature is readonly")}keys(){return this._boundSchema.fieldsIndex.fields.map(e=>e.name)}isEmpty(){return this._boundSchema.fields.length<=0&&!this._hasGeometry()}castToText(e=!1){return JSON.stringify(this._boundTarget)}gdbVersion(){return null}fullSchema(){return this._boundSchema}castAsJson(e=null){return{attributes:this._boundTarget.attributes,geometry:e?.keepGeometryType===!0?this.geometry():this.geometry()?.toJSON()??null}}castAsJsonAsync(e=null,r=null){return Promise.resolve(this.castAsJson(r))}};function hV(t){const e=[];for(const r in t)e.push({name:r,alias:r,type:typeof t[r]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"});return e}let yge=class pV{static async from(e,r,i){const s=e.dictionary_version?B8.parse(e.dictionary_version):null,n=new Set(e.itemsNames),o={};if(r)for(const f in r)o[f]=r[f];if(e.authoringInfo.configuration)for(const f of e.authoringInfo.configuration)o.hasOwnProperty(f.name)||(o[f.name]=f.value);const l=new Set(e.authoringInfo.symbol);for(const f of Object.keys(i))l.delete(f);l.size&&L.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("missing-fields: fieldMap entries for the following symbol fields are missing",{symbolFields:l});const u=await mge(e.expression,null,o);if(!u)throw new x("dictionary-renderer:expression-error","Unable to create dictionary renderer expression");const d=!s||!s.greaterEqual(4,0);d&&L.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("Dictionary script does not support native field types. Applying fallback",{version:s});const p=new gge(i,d);return new pV(d,n,u,p)}constructor(e,r,i,s){this._requiresFieldCoercionToString=e,this._itemNames=r,this._compiled=i,this._reader=s}get itemNames(){return this._itemNames}evaluate(e,r,i,s){try{return this._reader.bind(e,i,s),this._compiled.evaluate(this._reader,{$view:{scale:r}})}catch(n){L.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("arcade: dictionary script evaluation failed",{error:n})}return null}createDictionaryFieldsIndex(e){if(!this._requiresFieldCoercionToString)return new cw(e);const r=e.map(i=>({...i,type:"esriFieldTypeString"}));return new cw(r)}},gge=class extends dV{constructor(e,r){super(),this._fieldMap=e,this._requiresFieldCoercionToString=r}_getField(e){const r=this._fieldMap[e]??e;return this._boundSchema.fieldsIndex.get(r)}field(e){if(!this._requiresFieldCoercionToString)return super.field(e,!1);const r=this._getField(e);return r==null||this._boundTarget.attributes[r.name]==null?"":""+this._boundTarget.attributes[r.name]}};const aA={Relative:0,Absolute:1},vge={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},Dx={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1,gradientMethod:"AcrossLine",gradientSize:75,gradientSizeUnits:aA.Relative,gradientType:"Discrete",interval:5},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGradientFill:{enable:!0,angle:90,gradientMethod:"Linear",gradientSize:75,gradientSizeUnits:aA.Relative,gradientType:"Discrete",interval:5},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRadial:{angle:0,length:5},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:"Loop",repeatdelay:0,easing:"Linear"},CIMSymbolAnimationSize:{tosize:10},CIMSymbolAnimationScale:{scalefactor:1},CIMSymbolAnimationColor:{tocolor:[255,255,255,1]},CIMSymbolAnimationTransparency:{totransparency:0},CIMSymbolAnimationRotation:{torotation:0,rotateclockwise:!1},CIMSymbolAnimationOffset:{offsetx:0,offsety:0},CIMSymbolAnimationMoveAlongLine:{speed:30,distanceAlong:100}};function wge(t){return typeof t=="function"}function QEe(t,e,r,i){return wge(t)?t(e,r,i):t}function XEe(t){return[t.r,t.g,t.b,t.a]}const bge=` /-,
`;function lA(t){let e=t.length;for(;e--;)if(!bge.includes(t.charAt(e)))return!1;return!0}function eOe(t,e){const r=[];let i=0,s=-1;do if(s=t.indexOf("[",i),s>=i){if(s>i){const n=t.slice(i,s);r.push([n,null,lA(n)])}if(i=s+1,s=t.indexOf("]",i),s>=i){if(s>i){const n=e[t.slice(i,s)];n&&r.push([null,n,!1])}i=s+1}}while(s!==-1);if(i<t.length){const n=t.slice(i);r.push([n,null,lA(n)])}return r}function tOe(t,e,r){let i="",s=null;for(const n of e){const[o,l,u]=n;if(o!=null&&o!=="")u?s=o:(s!=null&&(i+=s,s=null),i+=o);else{const d=t.readAttribute(l);d!=null&&d!==""&&(s!==null&&(i+=s,s=null),i+=d)}}return fV(i,r)}function rOe(t,e,r,i){let s="",n=null;for(const o of e){const[l,u,d]=o;if(l!=null&&l!=="")d?n=l:(n!=null&&(s+=n,n=null),s+=l);else{let p=u;r!=null&&(p=Ege(u,r));const f=t.attributes[p];f!=null&&f!==""&&(n!=null&&(s+=n,n=null),s+=f)}}return fV(s,i)}function fV(t,e){switch(typeof t!="string"&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function iOe(t,e,r,i,s,n,o=!0){const l=e/s,u=r/n,d=Math.ceil(l/2),p=Math.ceil(u/2);for(let f=0;f<n;f++)for(let m=0;m<s;m++){const y=4*(m+(o?n-f-1:f)*s);let g=0,v=0,_=0,S=0,M=0,C=0,T=0;const O=(f+.5)*u;for(let P=Math.floor(f*u);P<(f+1)*u;P++){const D=Math.abs(O-(P+.5))/p,z=(m+.5)*l,B=D*D;for(let G=Math.floor(m*l);G<(m+1)*l;G++){let Q=Math.abs(z-(G+.5))/d;const oe=Math.sqrt(B+Q*Q);oe>=-1&&oe<=1&&(g=2*oe*oe*oe-3*oe*oe+1,g>0&&(Q=4*(G+P*e),T+=g*t[Q+3],_+=g,t[Q+3]<255&&(g=g*t[Q+3]/250),S+=g*t[Q],M+=g*t[Q+1],C+=g*t[Q+2],v+=g))}}i[y]=S/v,i[y+1]=M/v,i[y+2]=C/v,i[y+3]=T/_}}function _ge(t){return t?[t[0],t[1],t[2],t[3]/255]:[0,0,0,0]}function sOe(t){return t.data?.symbol??null}function nOe(t){return t.type==="CIMVectorMarker"||t.type==="CIMPictureMarker"||t.type==="CIMBarChartMarker"||t.type==="CIMCharacterMarker"||t.type==="CIMPieChartMarker"||t.type==="CIMStackedBarChartMarker"}function oOe(t){return t.type==="CIMGradientStroke"||t.type==="CIMPictureStroke"||t.type==="CIMSolidStroke"}function aOe(t){return t!=null&&(t.type==="CIMGradientFill"||t.type==="CIMHatchFill"||t.type==="CIMPictureFill"||t.type==="CIMSolidFill"||t.type==="CIMWaterFill")}function Sge(t){return t!=null&&(t.type==="CIMMarkerPlacementAlongLineRandomSize"||t.type==="CIMMarkerPlacementAlongLineSameSize"||t.type==="CIMMarkerPlacementAlongLineVariableSize"||t.type==="CIMMarkerPlacementAtExtremities"||t.type==="CIMMarkerPlacementAtMeasuredUnits"||t.type==="CIMMarkerPlacementAtRatioPositions"||t.type==="CIMMarkerPlacementOnLine"||t.type==="CIMMarkerPlacementOnVertices")}const lOe=(t,e=0)=>t==null||isNaN(t)?e:t,uOe=(t,e)=>t??e,cOe=(t,e)=>t??e,dOe=t=>t.tintColor?_ge(t.tintColor):[255,255,255,1];let $ge=class{constructor(e){this._import=e}getImportPromise(){return this._promise==null&&(this._promise=this._import().then(e=>this.module=e)),this._promise}};function pOe(t){return new $ge(t)}function fOe(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function mOe(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function yOe(t){let e="normal",r="normal";if(t){const i=t.toLowerCase();i.includes("italic")?e="italic":i.includes("oblique")&&(e="oblique"),i.includes("bold")?r="bold":i.includes("light")&&(r="lighter")}return{style:e,weight:r}}function gOe(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function uA(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const r=uA(e);if(r!=null)return r}break;case"CIMTextSymbol":return uA(t.symbol);case"CIMSolidFill":return t.color}return null}function cA(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const r of e){const i=cA(r);if(i!=null)return i}break}case"CIMTextSymbol":return cA(t.symbol);case"CIMSolidStroke":return t.color}}function vOe(t){for(const e of t)if(e.enable)switch(e.type){case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return!0}return!1}function dA(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const r=dA(e);if(r!==void 0)return r}break;case"CIMTextSymbol":return dA(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function wOe(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function bOe(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function _Oe(t){return(t?Object.keys(t):[]).map(e=>({name:e,alias:e,type:typeof t[e]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"}))}const SOe=t=>t.includes("data:image/svg+xml");function $Oe(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function T1(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function xOe(t,e,r,i,s,n,o=!0){const{infos:l}=n;let u=1,d=0,p=0,f=0,m=1;for(const{absoluteAnchorPoint:v,offsetX:_,offsetY:S,rotation:M,size:C,frameHeight:T,rotateClockWise:O,scaleSymbolsProportionally:P}of l)m=v?1:u,p=pA(_,S,d,m,p),f=hA(_,S,d,m,f),T&&(P||o)&&(u*=C/T),d=fA(M,O,d);const y=pA(i,s,d,m,p),g=hA(i,s,d,m,f);return{size:t*u,rotation:fA(e,r,d),offsetX:y,offsetY:g}}function xge(t){if(t==null)return!1;if(Array.isArray(t))return t.every(e=>xge(e));switch(typeof t){case"string":return!!t;case"number":return!isNaN(t)}}function Tge(t,e){if(e==="color"||e==="outlinecolor"||e==="backgroundcolor"||e==="borderlinecolor"||e==="tintcolor")return[...vge[e]];const r=Dx[t];if(!r)throw new Error(`InternalError: default value for type ${t}.`);return r[e]}function Mge(t){return t.split(" ").map(e=>Number(e))}function Ige(t){return typeof t=="string"?Mge(t):t}function TOe(t){return t?.dashTemplate&&(t.dashTemplate=Ige(t.dashTemplate)),t}function jx(t){if(t==null)return"Normal";switch(t.type){case"CIMTextSymbol":return t.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const e=t.symbolLayers;if(!e)return"Normal";for(const r of e)if(r.type==="CIMVectorMarker")return jx(r)}break;case"CIMVectorMarker":{const e=t.markerGraphics;if(!e)return"Normal";for(const r of e)if(r.symbol)return jx(r.symbol)}}return"Normal"}function MOe(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":{let e=0;if(t.symbolLayers){for(const r of t.symbolLayers)if(r)switch(r.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const i=r.size??Dx.CIMVectorMarker.size;i>e&&(e=i);break}}}return e}case"CIMLineSymbol":case"CIMPolygonSymbol":{let e=0;if(t.symbolLayers){for(const r of t.symbolLayers)if(r)switch(r.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const i=r.width;i!=null&&i>e&&(e=i);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(r.markerPlacement&&Sge(r.markerPlacement)){const i=r.size??Dx.CIMVectorMarker.size;i>e&&(e=i)}break;case"CIMPictureFill":{const i=r.height;i!=null&&i>e&&(e=i)}}}return e}}}function Ege(t,e){if(e!==null){const r=e.get(t);return r?r.name:t}return t}function IOe(t){return t.map(e=>({...e,propertyName:T1(e.propertyName)}))}function EOe(t){const e={};for(const r in t){const i=t[r];e[T1(r)]=i}return e}function hA(t,e,r,i,s){const n=r*Math.PI/180;if(n){const o=Math.cos(n);return(Math.sin(n)*t+o*e)*i+s}return e*i+s}function pA(t,e,r,i,s){const n=r*Math.PI/180;return n?(Math.cos(n)*t-Math.sin(n)*e)*i+s:t*i+s}function fA(t,e,r){return e?r-t:r+t}function OOe(t,e,r){const i=r==="Color"||r==="TintColor"||r==="ToColor",s=r==="Rotation"||r==="Angle"||r==="ToRotation";let n=e[T1(r)];if(n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]/255]:s&&(n*=Math.PI/180)),n==null&&(n=Tge(e.type,r.toLowerCase()),n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]]:s&&(n*=Math.PI/180))),e.primitiveName!=null){const o=t[e.primitiveName];if(o!=null){const l=o[r];l==null||(typeof l=="string"||typeof l=="number"||Array.isArray(l)?(n=l,n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]/255]:s&&(n*=Math.PI/180))):(n={valueExpressionInfo:l,defaultValue:n},n!=null&&(i?n={type:"Process",op:"ArcadeColor",value:n}:s&&(n={type:"Process",op:"Divide",left:n,right:180/Math.PI}))))}}if(n==null)throw new Error(`Failed to derive a value or an expression for "${r}".`);return n}function kOe(t,e,r){if(e[T1(r)]!=null)return!0;if(e.primitiveName!=null){const i=t[e.primitiveName];if(i!=null&&i[r]!=null)return!0}return!1}function COe(t,e){return Math.max(Math.min((t??e)/100,1),0)}const Oge={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let mV=class{constructor(e,r,i,s){this.url=e,this.fieldMap=i,this.dictionaryInfo=s,this._symbolPartCache=new Qye(100);const n=async()=>yge.from(await s,r,i);this._evaluator=n()}async getSymbolAsync(e,r,i=!0){const s=await this._evaluator,n=r?.fields??hV(e.attributes),o=s.createDictionaryFieldsIndex(n),l=s.evaluate(e,r?.scale??0,o,r?.spatialReference);if(l==null)return null;const u=sp(e.geometry),d=XP.parse(l,s.itemNames,u),p=u==="esriGeometryPoint"&&!e.geometry?.hasZ;return await this._cimPartsToCIMSymbol(e,d.partNames,d.overrides,p,r,i,o)}async getSymbolForControlString(e,r,i){const s=await this._evaluator,n=XP.parse(e,s.itemNames,r),o=r==="esriGeometryPoint"&&!i,l=mA(await Promise.all(n.partNames.map(u=>this._getSymbolPart(u))),n.overrides,o);return new Er({data:l})}async _cimPartsToCIMSymbol(e,r,i,s,n,o,l){const u=r.map(f=>this._getSymbolPart(f,n));let d=await Promise.all(u);if(o&&this.fieldMap&&d.length>0){const{OverrideHelper:f}=await N(()=>import("./OverrideHelper-sRayrMwn.js"),__vite__mapDeps([205,123,206,21]));d=E(d);for(const m of d)f.applyDictionaryTextOverrides(m,e,this.fieldMap,l,jx(m))}const p=mA(d,i,s);return new Er({data:p})}async _fetchSymbolPart(e,r){const i=await this.dictionaryInfo,s=(this.url+"/"+i.cimRefTemplateUrl).replaceAll(/\{itemName\}/gi,e),{data:n}=await Ae(s,{responseType:"json",query:{f:"json"},...r});return n}async _getSymbolPart(e,r){let i=this._symbolPartCache.get(e);return i||(i=this._fetchSymbolPart(e,r),this._symbolPartCache.put(e,i)),i}};function mA(t,e,r){if(!t||t.length===0)return null;const i={...t[0]};if(t.length>1){i.effects=null,i.symbolLayers=[];for(const s of t){const n=s;if(n.effects!=null)for(const o of n.symbolLayers)o.effects==null?o.effects=n.effects:o.effects.unshift(...n.effects);i.symbolLayers.unshift(...n.symbolLayers)}}return r&&(i.callout=Oge),{type:"CIMSymbolReference",symbol:i,primitiveOverrides:e}}var Vx;let Ns=Vx=class extends cp(ji){constructor(t){super(t),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){const t=this.getDictionaryInfo();return new mV(this.url,this.config,this.fieldMap??{},t)}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,r,i){i?.origin||super.writeVisualVariables(t,e,r,i)}clone(){return new Vx({config:E(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:E(this.fieldMap),url:E(this.url),visualVariables:E(this.visualVariables)})}async getSymbolAsync(t,e,r=!0){return this._loader.getSymbolAsync(t,e,r)}async getSymbolForControlString(t,e,r){return this._loader.getSymbolForControlString(t,e,r)}getDictionaryInfo(){return this._dictionaryInfoPromise||(this._dictionaryInfoPromise=this._fetchDictionaryInfo()),this._dictionaryInfoPromise}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await Fr(t,e,null,this.scaleExpression);for(const r in this.fieldMap){const i=this.fieldMap[r];e.has(i)&&t.add(i)}}get arcadeRequired(){return!0}getSymbol(){return null}get symbols(){return[]}getAttributeHash(){return this.visualVariables?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}async _fetchDictionaryInfo(){const{data:t}=await Ae(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"}});return t}};a([c({type:mV})],Ns.prototype,"_loader",null),a([c({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],Ns.prototype,"config",void 0),a([c({type:Object,json:{write:!0}})],Ns.prototype,"fieldMap",void 0),a([c({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],Ns.prototype,"scaleExpression",void 0),a([q("scaleExpression")],Ns.prototype,"writeData",null),a([c({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],Ns.prototype,"scaleExpressionTitle",void 0),a([c({type:String,json:{write:!0}})],Ns.prototype,"url",void 0),a([q("visualVariables")],Ns.prototype,"writeVisualVariables",null),Ns=Vx=a([b("esri.renderers.DictionaryRenderer")],Ns);var zx;let fo=zx=class extends F{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return t==null?t:typeof t=="function"?(L.getLogger(this).error(".field: field must be a string value"),null):ey(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new zx({color:this.color?.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};a([c({type:ue,json:{type:[Number],write:!0}})],fo.prototype,"color",void 0),a([c({type:String,json:{write:!0}})],fo.prototype,"field",void 0),a([Ce("field")],fo.prototype,"castField",null),a([c({type:String,json:{write:!0}})],fo.prototype,"label",void 0),a([c({type:String,json:{write:!0}})],fo.prototype,"valueExpression",void 0),a([c({type:String,json:{write:!0}})],fo.prototype,"valueExpressionTitle",void 0),fo=zx=a([b("esri.renderers.support.AttributeColorInfo")],fo);const yV=fo;var Ux;let Y0=Ux=class extends F{constructor(){super(...arguments),this.unit=null}clone(){return new Ux({unit:this.unit})}};a([c({type:String,json:{write:!0}})],Y0.prototype,"unit",void 0),Y0=Ux=a([b("esri.renderers.support.DotDensityLegendOptions")],Y0);const kge=Y0;var qx;let ni=qx=class extends cp(ji){constructor(t){super(t),this.attributes=null,this.backgroundColor=new ue([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new bt,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}set visualVariables(t){super.visualVariables=t}calculateDotValue(t){if(this.referenceScale==null)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new fi({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new qx({attributes:E(this.attributes),backgroundColor:E(this.backgroundColor),dotBlendingEnabled:E(this.dotBlendingEnabled),dotShape:E(this.dotShape),dotSize:E(this.dotSize),dotValue:E(this.dotValue),legendOptions:E(this.legendOptions),outline:E(this.outline),referenceScale:E(this.referenceScale),seed:E(this.seed),visualVariables:E(this.visualVariables),authoringInfo:E(this.authoringInfo)})}getControllerHash(){return`${this.attributes?.map(e=>e.field||e.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const r of this.attributes??[])r.valueExpression&&await Fr(t,e,null,r.valueExpression),r.field&&t.add(r.field)}};a([c({type:[yV],json:{write:!0}})],ni.prototype,"attributes",void 0),a([c({type:ue,json:{write:!0}})],ni.prototype,"backgroundColor",void 0),a([c({type:Boolean,json:{write:!0}})],ni.prototype,"dotBlendingEnabled",void 0),a([c({type:String,json:{write:!1}})],ni.prototype,"dotShape",void 0),a([c({type:Number,json:{write:!0}})],ni.prototype,"dotSize",void 0),a([c({type:kge,json:{write:!0}})],ni.prototype,"legendOptions",void 0),a([c({type:bt,json:{default:null,write:!0}})],ni.prototype,"outline",void 0),a([c({type:Number,json:{write:!0}})],ni.prototype,"dotValue",void 0),a([c({type:Number,json:{write:!0}})],ni.prototype,"referenceScale",void 0),a([c({type:Number,json:{write:!0}})],ni.prototype,"seed",void 0),a([se({dotDensity:"dot-density"})],ni.prototype,"type",void 0),ni=qx=a([b("esri.renderers.DotDensityRenderer")],ni);var Gx;let ja=Gx=class extends F{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new Gx({color:this.color&&this.color.clone(),ratio:this.ratio})}};a([c({type:ue,json:{type:[xe],default:null,write:{isRequired:!0}}})],ja.prototype,"color",void 0),a([c({type:Number,json:{write:{isRequired:!0}}})],ja.prototype,"ratio",void 0),ja=Gx=a([b("esri.renderers.support.HeatmapColorStop")],ja);let sd=class extends pe(F){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};a([c({type:String,json:{write:!0}})],sd.prototype,"minLabel",void 0),a([c({type:String,json:{write:!0}})],sd.prototype,"maxLabel",void 0),a([c({type:String,json:{write:!0}})],sd.prototype,"title",void 0),sd=a([b("esri.renderers.support.HeatmapLegendOptions")],sd);function Cge(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Pge(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Age(t,e,r,i,s){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t}function Rge(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function gV(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function vV(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function wV(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Lge(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Fge(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Nge(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Dge(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function jge(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Vge(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function zge(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t}function bV(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],n=e[3]-t[3];return Math.sqrt(r*r+i*i+s*s+n*n)}function _V(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],n=e[3]-t[3];return r*r+i*i+s*s+n*n}function SV(t){const e=t[0],r=t[1],i=t[2],s=t[3];return Math.sqrt(e*e+r*r+i*i+s*s)}function $V(t){const e=t[0],r=t[1],i=t[2],s=t[3];return e*e+r*r+i*i+s*s}function Uge(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function qge(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Gge(t,e){const r=e[0],i=e[1],s=e[2],n=e[3];let o=r*r+i*i+s*s+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=r*o,t[1]=i*o,t[2]=s*o,t[3]=n*o),t}function Bge(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function xV(t,e,r,i){const s=e[0],n=e[1],o=e[2],l=e[3];return t[0]=s+i*(r[0]-s),t[1]=n+i*(r[1]-n),t[2]=o+i*(r[2]-o),t[3]=l+i*(r[3]-l),t}function Hge(t,e=1){const r=qw;let i,s,n,o,l,u;do i=2*r()-1,s=2*r()-1,l=i*i+s*s;while(l>=1);do n=2*r()-1,o=2*r()-1,u=n*n+o*o;while(u>=1);const d=Math.sqrt((1-l)/u);return t[0]=e*i,t[1]=e*s,t[2]=e*n*d,t[3]=e*o*d,t}function Wge(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3];return t[0]=r[0]*i+r[4]*s+r[8]*n+r[12]*o,t[1]=r[1]*i+r[5]*s+r[9]*n+r[13]*o,t[2]=r[2]*i+r[6]*s+r[10]*n+r[14]*o,t[3]=r[3]*i+r[7]*s+r[11]*n+r[15]*o,t}function Zge(t,e,r){const i=e[0],s=e[1],n=e[2],o=r[0],l=r[1],u=r[2],d=r[3],p=d*i+l*n-u*s,f=d*s+u*i-o*n,m=d*n+o*s-l*i,y=-o*i-l*s-u*n;return t[0]=p*d+y*-o+f*-u-m*-l,t[1]=f*d+y*-l+m*-o-p*-u,t[2]=m*d+y*-u+p*-l-f*-o,t[3]=e[3],t}function Jge(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Yge(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Kge(t,e){const r=t[0],i=t[1],s=t[2],n=t[3],o=e[0],l=e[1],u=e[2],d=e[3],p=Qr();return Math.abs(r-o)<=p*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-l)<=p*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-u)<=p*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(n-d)<=p*Math.max(1,Math.abs(n),Math.abs(d))}const Qge=gV,Xge=vV,e0e=wV,t0e=bV,r0e=_V,i0e=SV,s0e=$V;Object.freeze(Object.defineProperty({__proto__:null,add:Rge,ceil:Lge,copy:Cge,copyVec3:Pge,dist:t0e,distance:bV,div:e0e,divide:wV,dot:Bge,equals:Kge,exactEquals:Yge,floor:Fge,inverse:qge,len:i0e,length:SV,lerp:xV,max:Dge,min:Nge,mul:Xge,multiply:vV,negate:Uge,normalize:Gge,random:Hge,round:jge,scale:Vge,scaleAndAdd:zge,set:Age,sqrDist:r0e,sqrLen:s0e,squaredDistance:_V,squaredLength:$V,str:Jge,sub:Qge,subtract:gV,transformMat4:Wge,transformQuat:Zge},Symbol.toStringTag,{value:"Module"}));function M1(){return[0,0,0,0]}function n0e(t){return[t[0],t[1],t[2],t[3]]}function dp(t,e,r,i){return[t,e,r,i]}function o0e(t,e,r,i){return[t,e,r,i]}function a0e(t,e=M1()){const r=Math.min(4,t.length);for(let i=0;i<r;++i)e[i]=t[i];return e}function TV(){return M1()}function MV(){return dp(1,1,1,1)}function IV(){return dp(1,0,0,0)}function EV(){return dp(0,1,0,0)}function OV(){return dp(0,0,1,0)}function kV(){return dp(0,0,0,1)}const l0e=TV(),u0e=MV(),c0e=IV(),d0e=EV(),h0e=OV(),p0e=kV();Object.freeze(Object.defineProperty({__proto__:null,ONES:u0e,UNIT_W:p0e,UNIT_X:c0e,UNIT_Y:d0e,UNIT_Z:h0e,ZEROS:l0e,clone:n0e,create:M1,freeze:o0e,fromArray:a0e,fromValues:dp,ones:MV,unitW:kV,unitX:IV,unitY:EV,unitZ:OV,zeros:TV},Symbol.toStringTag,{value:"Module"}));const L3=2.4;function f0e(t){return gs(t*L3)}function m0e(t){return EQ(t)/L3}function y0e(t,e,r,i){let{color:s,ratio:n}=e,{color:o,ratio:l}=r;l===n&&(l===1?n-=1e-6:l+=1e-6);const u=Bi((i-n)/(l-n),0,1);xV(t,s.toArray(),o.toArray(),u)}function ROe(t){const r=new Uint8ClampedArray(2048);if(t=t.filter(({ratio:l})=>l>=0&&l<=1).sort((l,u)=>l.ratio-u.ratio).map(({color:l,ratio:u})=>({color:l,ratio:Math.max(u,.001)})),t.length<1)return r;let i=t[0],s=t[0],n=1;const o=M1();for(let l=0;l<512;l++){const u=(l+.5)/512;for(;u>s.ratio&&n<t.length;)i=s,s=t[n++];y0e(o,i,s,u),r.set(o,4*l)}return r}function LOe(t,e,r){const i=Math.sqrt(t**2+e**2)/r;return i>1?0:3/(Math.PI*r**2)*(1-i**2)**2}function FOe(t){return typeof t=="function"?t:t?e=>+e[t]:()=>1}var Bx;function yA(t){if(t!=null){const{maxDensity:e,minDensity:r,radius:i}=t;if(e!=null||r!=null||i!=null){const{blurRadius:s,maxPixelIntensity:n,minPixelIntensity:o,...l}=t;return l}}return t}let Ut=Bx=class extends ji{constructor(t){super(t),this.authoringInfo=null,this.colorStops=[new ja({ratio:0,color:new ue("rgba(255, 140, 0, 0)")}),new ja({ratio:.75,color:new ue("rgba(255, 140, 0, 1)")}),new ja({ratio:.9,color:new ue("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(t){return yA(t)}get blurRadius(){return m0e(this.radius)}set blurRadius(t){const e=this.maxPixelIntensity,r=this.minPixelIntensity;this._set("radius",f0e(t)),this._set("maxDensity",e*this._pixelIntensityToDensity),this._set("minDensity",r*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(t){this._set("maxDensity",t*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(t){this._set("minDensity",t*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(L3**2*this.blurRadius**4)}read(t,e){t=yA(t),super.read(t,e)}getSymbol(){return new Gt}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}async collectRequiredFields(t,e){const r=this.field,i=this.valueExpression;r&&typeof r=="string"&&Rr(t,e,r),i&&typeof i=="string"&&await Fr(t,e,null,i)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new Bx({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:E(this.colorStops),field:this.field,legendOptions:E(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};a([c({type:et,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Ut.prototype,"authoringInfo",void 0),a([c({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Ut.prototype,"blurRadius",null),a([c({type:[ja],json:{write:{isRequired:!0}}})],Ut.prototype,"colorStops",void 0),a([c({type:String,json:{write:!0}})],Ut.prototype,"field",void 0),a([c({type:sd,json:{write:!0}})],Ut.prototype,"legendOptions",void 0),a([c({type:Number,json:{write:!0}})],Ut.prototype,"maxDensity",void 0),a([c({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Ut.prototype,"maxPixelIntensity",null),a([c({type:Number,json:{write:!0}})],Ut.prototype,"minDensity",void 0),a([c({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Ut.prototype,"minPixelIntensity",null),a([c({type:Number,cast:Me,json:{write:!0}})],Ut.prototype,"radius",void 0),a([c({type:Number,range:{min:0},json:{default:0,write:!0}})],Ut.prototype,"referenceScale",void 0),a([se({heatmap:"heatmap"})],Ut.prototype,"type",void 0),a([c({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],Ut.prototype,"valueExpression",void 0),a([c({type:String})],Ut.prototype,"valueExpressionTitle",void 0),a([c({readOnly:!0})],Ut.prototype,"_pixelIntensityToDensity",null),Ut=Bx=a([b("esri.renderers.HeatmapRenderer")],Ut);let Xl=class extends pe(F){constructor(){super(...arguments),this.color=new ue([0,0,0,0]),this.label=null,this.threshold=0}};a([c({type:ue,json:{write:!0}})],Xl.prototype,"color",void 0),a([c({type:String,json:{write:!0}})],Xl.prototype,"label",void 0),a([c({type:Number,range:{min:0,max:1},json:{write:!0}})],Xl.prototype,"threshold",void 0),Xl=a([b("esri.renderers.support.OthersCategory")],Xl);const g0e={base:$r,key:"type",typeMap:{size:Ee,opacity:Oo}};let oi=class extends cp(pe(ji)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new ue([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new Xl,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart",this.visualVariables=null}getSymbol(){return new Gt({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(ps)}getAttributeHash(){return this.visualVariables?.reduce((e,r)=>e+r.getAttributeHash(),"")??""}getMeshHash(){return this.symbols.reduce((e,r)=>e+JSON.stringify(r),"")}async collectRequiredFields(e,r){await this.collectVVRequiredFields(e,r);for(const i of this.attributes)i.valueExpression&&await Fr(e,r,null,i.valueExpression),i.field&&e.add(i.field)}};a([c({type:[yV],json:{write:!0}})],oi.prototype,"attributes",void 0),a([c(x3)],oi.prototype,"backgroundFillSymbol",void 0),a([c({type:ue,json:{write:!0}})],oi.prototype,"defaultColor",void 0),a([c({type:String,json:{write:!0}})],oi.prototype,"defaultLabel",void 0),a([c({type:Number,range:{min:0,max:1},json:{write:!0}})],oi.prototype,"holePercentage",void 0),a([c({type:Xl,json:{write:!0}})],oi.prototype,"othersCategory",void 0),a([c({type:T3,json:{write:!0}})],oi.prototype,"legendOptions",void 0),a([c({type:bt,json:{default:null,write:!0}})],oi.prototype,"outline",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],oi.prototype,"size",void 0),a([se({pieChart:"pie-chart"})],oi.prototype,"type",void 0),a([c({types:[g0e]})],oi.prototype,"visualVariables",void 0),oi=a([b("esri.renderers.PieChartRenderer")],oi);const My={key:"type",base:ji,typeMap:{heatmap:Ut,simple:Zr,"unique-value":Ge,"class-breaks":Tt,"dot-density":ni,dictionary:Ns,"pie-chart":oi},errorContext:"renderer"},v0e={key:"type",base:ji,typeMap:{simple:Zr,"unique-value":Ge,"class-breaks":Tt,heatmap:Ut},errorContext:"renderer",validate:w0e};function w0e(t){switch(t.type){case"simple":return b0e(t);case"unique-value":return _0e(t);case"class-breaks":return S0e(t);case"heatmap":return t}}function b0e(t){if(t.symbol)return t;L.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function _0e(t){const e=t.uniqueValueInfos,r=e?.filter(({symbol:i,label:s},n)=>(i||L.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${n}] ${s}) without a symbol from web scene.`),!!i));return r?.length!==e?.length&&(t.uniqueValueInfos=r),t}function S0e(t){const e=t.classBreakInfos,r=e?.filter(({symbol:i,label:s},n)=>(i||L.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${n}] ${s}) without a symbol from web scene.`),!!i));return r?.length!==e?.length&&(t.classBreakInfos=r),t}function jOe(t,e){return Hm(t,null,e)}const $0e=Jh({types:My});function Hm(t,e,r){return t?t&&(t.styleName||t.styleUrl)&&t.type!=="uniqueValue"?(r?.messages&&r.messages.push(new qi("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:r})),null):$0e(t,e,r):null}var Hx;let cr=Hx=class extends Ga{constructor(t){super(t),this.type="binning",this.binType="geohash",this.fixedBinLevel=null,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.size=Me("12px"),this.fields=[],this.renderer=null}writeFields(t,e,r){const i=t.filter(s=>s.statisticType!=="avg_angle").map(s=>s.toJSON());Ht(r,i,e)}readRenderer(t,e,r){const i=e.drawingInfo?.renderer;return i?Hm(i,e,r)??void 0:I3(e,r)}clone(){return new Hx({fields:E(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:E(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:E(this.popupTemplate),renderer:E(this.renderer),binType:E(this.binType),size:this.size})}};a([se({binning:"binning"})],cr.prototype,"type",void 0),a([se({geohash:"geohash",square:"square"}),c({type:["geohash","square"]})],cr.prototype,"binType",void 0),a([c({type:Number,json:{write:!0}})],cr.prototype,"fixedBinLevel",void 0),a([c({type:[Ye],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],cr.prototype,"labelingInfo",void 0),a([c(w1)],cr.prototype,"labelsVisible",void 0),a([c({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],cr.prototype,"maxScale",void 0),a([c(v1)],cr.prototype,"popupEnabled",void 0),a([c({type:Vn,json:{name:"popupInfo",write:!0}})],cr.prototype,"popupTemplate",void 0),a([c({cast:t=>t==="auto"?t:Hr(Me(t))})],cr.prototype,"size",void 0),a([c({type:[Ir],json:{write:!0}})],cr.prototype,"fields",void 0),a([q("fields")],cr.prototype,"writeFields",null),a([c({types:My,json:{write:{target:"drawingInfo.renderer"}}})],cr.prototype,"renderer",void 0),a([V("renderer",["drawingInfo.renderer"])],cr.prototype,"readRenderer",null),cr=Hx=a([b("esri.layers.support.FeatureReductionBinning")],cr);var Wx;function gA(t){return t.type==="simple"&&!t.visualVariables?.length}let Mt=Wx=class extends F{constructor(t){super(t),this.type="cluster",this.clusterRadius=Me("80px"),this.clusterMinSize=Me("12px"),this.clusterMaxSize=Me("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(t,e,r){const i=e.drawingInfo?.renderer;return i?.authoringInfo?.isAutoGenerated?null:i?gA(i)?null:Hm(i,e,r)??void 0:I3(e,r)}readSymbol(t,e,r){const i=e.drawingInfo?.renderer;return i?.authoringInfo?.isAutoGenerated?null:i&&gA(i)?Hm(i,e,r)?.symbol:null}writeSymbol(t,e,r,i){const s=this.renderer?.authoringInfo?.isAutoGenerated;if(!this.renderer||s){const n=new Zr({symbol:t});e.drawingInfo={renderer:n.write({},i)}}}writeFields(t,e,r){const i=t.filter(s=>s.statisticType!=="avg_angle").map(s=>s.toJSON());Ht(r,i,e)}readFields(t,e,r){return t.filter(i=>!i.isAutoGenerated).map(i=>Ir.fromJSON(i))}clone(){return new Wx({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:E(this.labelingInfo),labelsVisible:this.labelsVisible,fields:E(this.fields),maxScale:this.maxScale,renderer:E(this.renderer),symbol:E(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:E(this.popupTemplate)})}};a([c({type:["cluster"],readOnly:!0,json:{write:!0}})],Mt.prototype,"type",void 0),a([c({cast:t=>t==="auto"?t:Hr(Me(t)),json:{write:!0}})],Mt.prototype,"clusterRadius",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],Mt.prototype,"clusterMinSize",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],Mt.prototype,"clusterMaxSize",void 0),a([c({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Mt.prototype,"maxScale",void 0),a([c(v1)],Mt.prototype,"popupEnabled",void 0),a([c({type:Vn,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],Mt.prototype,"popupTemplate",void 0),a([c({types:My,json:{write:{target:"drawingInfo.renderer"}}})],Mt.prototype,"renderer",void 0),a([V("renderer",["drawingInfo.renderer"])],Mt.prototype,"readRenderer",null),a([c({types:rse})],Mt.prototype,"symbol",void 0),a([V("symbol",["drawingInfo.renderer"])],Mt.prototype,"readSymbol",null),a([q("symbol")],Mt.prototype,"writeSymbol",null),a([c({type:[Ye],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Mt.prototype,"labelingInfo",void 0),a([c(w1)],Mt.prototype,"labelsVisible",void 0),a([c({type:[Ir],json:{write:!0}})],Mt.prototype,"fields",void 0),a([q("fields")],Mt.prototype,"writeFields",null),a([V("fields")],Mt.prototype,"readFields",null),Mt=Wx=a([b("esri.layers.support.FeatureReductionCluster")],Mt);var Zx;let pm=Zx=class extends Ga{constructor(t){super(t),this.type="selection"}clone(){return new Zx}};a([c({type:["selection"]})],pm.prototype,"type",void 0),pm=Zx=a([b("esri.layers.support.FeatureReductionSelection")],pm);const vA={key:"type",base:Ga,typeMap:{cluster:Mt,binning:cr}},x0e={types:{key:"type",base:Ga,typeMap:{selection:pm,cluster:Mt,binning:cr}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:vA},"portal-item":{types:vA},"web-scene":{types:{key:"type",base:Ga,typeMap:{selection:pm}},name:"layerDefinition.featureReduction",write:{allowNull:!0,layerContainerTypes:qe}}}}},T0e=()=>L.getLogger("esri.views.2d.layers.support.clusterUtils");k.add("esri-cluster-arcade-enabled",!0);const M0e=k("esri-cluster-arcade-enabled"),I0e=new Set(["simple-line","simple-fill","picture-fill"]);function wA(t,e){let r=e.clone();if(!E0e(r))return r;if(e.symbols.some(i=>I0e.has(i.type))&&(r=new Zr({symbol:new Gt})),r.authoringInfo||(r.authoringInfo=new et),r.authoringInfo.isAutoGenerated=!0,"visualVariables"in r){const i=(r.visualVariables||[]).filter(s=>s.valueExpression!=="$view.scale");i.forEach(s=>{s.type==="rotation"?s.field?s.field=$l(t,s.field,"avg_angle","number"):s.valueExpression&&(s.field=Vp(t,s.valueExpression,"avg_angle","number"),s.valueExpression=null):s.normalizationField?(s.field=$l(t,s.field,"avg_norm","number",s.normalizationField),s.normalizationField=null):s.field?s.field=$l(t,s.field,"avg","number"):s.valueExpression&&(s.field=Vp(t,s.valueExpression,"avg","number"),s.valueExpression=null)}),r.visualVariables=i}switch(r.type){case"simple":break;case"pie-chart":for(const i of r.attributes)i.field?i.field=$l(t,i.field,"sum","number"):i.valueExpression&&(i.field=Vp(t,i.valueExpression,"sum","number"),i.valueExpression=null);break;case"unique-value":r.field?r.field=$l(t,r.field,"mode","string"):r.valueExpression&&(r.field=Vp(t,r.valueExpression,"mode","string"),r.valueExpression=null);break;case"class-breaks":r.normalizationField?(r.field=$l(t,r.field,"avg_norm","number",r.normalizationField),r.normalizationField=null):r.field?r.field=$l(t,r.field,"avg","number"):r.valueExpression&&(r.field=Vp(t,r.valueExpression,"avg","number"),r.valueExpression=null)}return r}const E0e=t=>{const e=r=>T0e().error(new x("Unsupported-renderer",r,{renderer:t}));if(!t)return!1;switch(t.type){case"unique-value":if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(t.normalizationField){const r=t.normalizationType;if(r!=="field")return e(`FeatureReductionCluster does not support a normalizationType of ${r}`),!1}break;case"simple":case"pie-chart":break;default:return e(`FeatureReductionCluster does not support renderers of type ${t.type}`),!1}if(!M0e){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some(r=>!(!("valueExpression"in r)||!r.valueExpression)))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function O0e(t,e,r){switch(t){case"sum":return`cluster_sum_${e}`;case"avg":case"avg_angle":return`cluster_avg_${e}`;case"mode":return`cluster_type_${e}`;case"avg_norm":{const i=r,s="field",n=e.toLowerCase()+",norm:"+s+","+i.toLowerCase();return"cluster_avg_"+lM(n)}}}function Vp(t,e,r,i){const s=lM(e),n=r==="mode"?`cluster_type_${s}`:r==="sum"?`cluster_sum_${s}`:`cluster_avg_${s}`;return t.some(o=>o.name===n)||t.push(new Ir({name:n,isAutoGenerated:!0,onStatisticExpression:new Oa({expression:e,returnType:i}),statisticType:r})),n}function $l(t,e,r,i,s){if(e==="cluster_count"||t.some(o=>o.name===e))return e;const n=O0e(r,e,s);return t.some(o=>o.name===n)||(r==="avg_norm"?t.push(new Ir({name:n,isAutoGenerated:!0,onStatisticExpression:new Oa({expression:`$feature.${e} / $feature.${s}`,returnType:i}),statisticType:"avg"})):t.push(new Ir({name:n,isAutoGenerated:!0,onStatisticField:e,statisticType:r}))),n}const k0e=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.aggregateGraphicOrigin=new Cye(this),this.addHandles(ne(()=>this.renderer,()=>{if(this.featureReduction){const s=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",s)}},jn))}set featureReduction(i){const s=this._normalizeFeatureReduction(i);this._set("featureReduction",s)}set renderer(i){}_withClusterVariable(i,s,n){const o=i.clone();return"visualVariables"in o&&(o.visualVariables||(o.visualVariables=[]),o.visualVariables.some(l=>l.type==="size")||o.visualVariables.push(new Ee({field:"cluster_count",stops:[new Bs({value:1}),new Bs({useMinValue:!0,size:s}),new Bs({useMaxValue:!0,size:n})]}))),o}_normalizeFeatureReduction(i){if(i?.type!=="cluster")return i;const s=i.clone(),n=[new Ir({name:"cluster_count",alias:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],o=(s.fields??[]).filter(m=>!m.isAutoGenerated),l=i.renderer&&!i.renderer.authoringInfo?.isAutoGenerated,{clusterMinSize:u,clusterMaxSize:d}=s;if(l){s.fields=[...n,...o];const m=this._withClusterVariable(s.renderer,u,d);return s.effectiveFeatureRenderer=m,s.effectiveClusterRenderer=m,s}if(i.symbol){if(s.fields=[...n,...o],s.renderer=null,!this.renderer)return s.effectiveFeatureRenderer=null,s.effectiveClusterRenderer=null,s;const m=wA(n,this.renderer),y=this._withClusterVariable(m,u,d),g="visualVariables"in y&&y.visualVariables?y.visualVariables:[],v=new Zr({symbol:i.symbol,visualVariables:g});return s.fields=[...n,...o],s.effectiveFeatureRenderer=y,s.effectiveClusterRenderer=v,s}if(!this.renderer)return i;const p=wA(n,this.renderer);s.fields=[...n,...o],s.renderer=p;const f=this._withClusterVariable(p,u,d);return s.effectiveFeatureRenderer=f,s.effectiveClusterRenderer=f,s}};return a([c({readOnly:!0,clonable:!1})],r.prototype,"aggregateGraphicOrigin",void 0),a([c(x0e)],r.prototype,"featureReduction",null),r=a([b("esri.layers.mixins.FeatureReductionLayer")],r),r},bA={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,ArcGISVideoLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,ParquetLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},_A={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},SA={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},C0e={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GaussianSplatLayer:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,Object3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,ViewshedLayer:!0,Voxel:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap-base-layers":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap-ground-layers":{IntegratedMesh3DTilesLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":bA,"web-map/basemap-base-layers":_A,"web-map/tables":SA,"link-chart/operational-layers":{...bA,LinkChartLayer:!0},"link-chart/basemap-base-layers":_A,"link-chart/tables":SA,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0,WCS:!0},"portal-item/tables":{ArcGISFeatureLayer:!0,SubtypeGroupTable:!0}},P0e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(i,s,n){return n?.portalItem?.type==="Group Layer"?void 0:i}writeListMode(i,s,n,o){(o&&o.layerContainerType==="ground"||i&&UG(this,n,{},o))&&(s[n]=i)}writeOperationalLayerType(i,s,n){i&&(s[n]=i)}writeTitle(i,s){s.title=i??"Layer"}readVisibilityTimeExtent(i){return i?Et.fromArray(i):null}writeVisibilityTimeExtent(i,s,n,o){i&&o.layerContainerType!=="tables"&&(i.isEmpty?o?.messages&&o.messages.push(new x("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):s[n]=i.toArray())}read(i,s){s&&(s.layer=this),jG(this,i,n=>super.read(i,n),s)}write(i,s){if(!this.persistenceEnabled&&!s?.ignorePersistenceEnabled)return null;if(s?.origin){const l=`${s.origin}/${s.layerContainerType||"operational-layers"}`;let d=!!C0e[l]?.[this.operationalLayerType];if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&l==="web-scene/operational-layers"&&(d=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&l==="web-map/operational-layers"&&(d=!1),!d)return s.messages?.push(new x("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${l}'`,{layer:this})),null}const n=super.write(i,{...s,layer:this}),o=!!s&&!!s.messages&&!!s.messages.filter(l=>l instanceof x&&l.name==="web-document-write:property-required").length;return Vh(n?.url)?(s?.messages?.push(new x("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&o?null:n}beforeSave(){}};return a([c({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],r.prototype,"id",void 0),a([V("id",["id"])],r.prototype,"readId",null),a([c(S9)],r.prototype,"listMode",void 0),a([q("listMode")],r.prototype,"writeListMode",null),a([c({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:qe,isRequired:!0}}}}})],r.prototype,"operationalLayerType",void 0),a([q("operationalLayerType")],r.prototype,"writeOperationalLayerType",null),a([c(ax)],r.prototype,"opacity",void 0),a([c({type:Boolean,readOnly:!1})],r.prototype,"persistenceEnabled",void 0),a([c({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],r.prototype,"title",void 0),a([q("title"),q(["web-scene"],"title")],r.prototype,"writeTitle",null),a([c({type:Et,json:{origins:{"web-scene":{write:{layerContainerTypes:qe}}}}})],r.prototype,"visibilityTimeExtent",void 0),a([V("visibilityTimeExtent")],r.prototype,"readVisibilityTimeExtent",null),a([q(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[xe,$w]]}})],r.prototype,"writeVisibilityTimeExtent",null),a([c({type:Boolean,json:{name:"visibility",write:{layerContainerTypes:qe}}})],r.prototype,"visible",void 0),r=a([b("esri.layers.mixins.OperationalLayer")],r),r};var Jx;const Ig=new $e({asc:"ascending",desc:"descending"});var mh;let eu=(mh=class extends F{constructor(e){super(e),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new Jx({field:this.field,valueExpression:this.valueExpression,order:this.order})}},Jx=mh,mh);a([c({type:String,json:{write:!0}})],eu.prototype,"field",void 0),a([c({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],eu.prototype,"valueExpression",void 0),a([c({type:Ig.apiValues,json:{type:Ig.jsonValues,read:Ig.read,write:Ig.write}})],eu.prototype,"order",void 0),eu=Jx=a([b("esri.layers.support.OrderByInfo")],eu);function A0e(t,e,r){if(!t)return null;const i=t.find(n=>!!n.field);if(!i)return null;const s=new eu;return s.read(i,r),[s]}function R0e(t,e,r,i){const s=t.find(n=>!!n.field);s&&Ht(r,[s.toJSON()],e)}const L0e={type:[eu],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:A0e},write:{writer:R0e}}},F0e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.orderBy=null}};return a([c(L0e)],r.prototype,"orderBy",void 0),r=a([b("esri.layers.mixins.OrderedLayer")],r),r},N0e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=Ke(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(i){i!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",i))}readPortalItem(i,s,n){if(s.itemId)return new de({id:s.itemId,portal:n?.portal})}writePortalItem(i,s){i?.id&&(s.itemId=i.id)}async loadFromPortal(i,s){if(this.portalItem?.id)try{const{load:n}=await N(()=>import("./layersLoader-BTDb0Baa.js"),__vite__mapDeps([313,8,9,7,314]));return We(s),await n({instance:this,supportedTypes:i.supportedTypes,validateItem:i.validateItem,supportsData:i.supportsData,layerModuleTypeMap:i.layerModuleTypeMap,populateGroupLayer:i.populateGroupLayer},s)}catch(n){throw nr(n)||L.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${n}`),n}}async finishLoadEditablePortalLayer(i){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(i).catch(s=>(Mn(s),!0)))}async setUserPrivileges(i,s){if(!_e.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(s);if(this.url)try{const{features:{edit:n,fullEdit:o},content:{updateItem:l}}=await this._fetchUserPrivileges(i,s);this._set("userHasEditingPrivileges",n),this._set("userHasFullEditingPrivileges",o),this._set("userHasUpdateItemPrivileges",l)}catch(n){Mn(n)}}async _fetchUserPrivileges(i,s){let n=this.portalItem;if(!i||!n||!n.loaded||n.sourceUrl)return this._fetchFallbackUserPrivileges(s);const o=!Se?.findCredential(this.url),l=i===n.id;if(l&&n.portal.user)return this._getUserPrivileges(n,o);let u,d;if(l)u=n.portal.url;else try{u=await nM(this.url,s)}catch(y){Mn(y)}if(!u||!UU(u,n.portal.url))return this._fetchFallbackUserPrivileges(s);try{const y=s!=null?s.signal:null;d=await Se?.getCredential(`${u}/sharing`,{prompt:!1,signal:y})}catch(y){Mn(y)}const p=!0,f=!1,m=!1;if(!d)return{features:{edit:p,fullEdit:f},content:{updateItem:m}};try{if(l?await n.reload():(n=new de({id:i,portal:{url:u}}),await n.load(s)),n.portal.user)return this._getUserPrivileges(n,o)}catch(y){Mn(y)}return{features:{edit:p,fullEdit:f},content:{updateItem:m}}}_getUserPrivileges(i,s){const n=Oye(i);return s&&(n.features.edit=!0),n}async _fetchFallbackUserPrivileges(i){let s=!0;try{s=await this._fetchUserHasEditingPrivileges(i)}catch(n){Mn(n)}return{features:{edit:s,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(i){const s=this.url?Se?.findCredential(this.url):null;if(!s)return!0;const n=Eg.credential===s?Eg.user:await this._fetchEditingUser(i);return Eg.credential=s,Eg.user=n,n?.privileges==null||n.privileges.includes("features:user:edit")}async _fetchEditingUser(i){const s=this.portalItem?.portal?.user;if(s)return s;const n=Se?.findServerInfo(this.url??"");if(!n?.owningSystemUrl)return null;const o=`${n.owningSystemUrl}/sharing/rest`,l=j.getDefault();if(l&&l.loaded&&en(l.restUrl)===en(o))return l.user;const u=`${o}/community/self`,d=i!=null?i.signal:null,p=await Tw(Ae(u,{authMode:"no-prompt",query:{f:"json"},signal:d}));return p.ok?Ve.fromJSON(p.value.data):null}read(i,s){s&&(s.layer=this),super.read(i,s)}write(i,s){const n=s?.portal,o=this.portalItem?.id&&(this.portalItem.portal||j.getDefault());return n&&o&&!pR(o.restUrl,n.restUrl)?(s.messages&&s.messages.push(new x("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(i,{...s,layer:this})}};return a([c({type:de})],r.prototype,"portalItem",null),a([V("web-document","portalItem",["itemId"])],r.prototype,"readPortalItem",null),a([q("web-document","portalItem",{itemId:{type:String}})],r.prototype,"writePortalItem",null),a([c({clonable:!1})],r.prototype,"resourceReferences",void 0),a([c({type:Boolean,readOnly:!0})],r.prototype,"userHasEditingPrivileges",void 0),a([c({type:Boolean,readOnly:!0})],r.prototype,"userHasFullEditingPrivileges",void 0),a([c({type:Boolean,readOnly:!0})],r.prototype,"userHasUpdateItemPrivileges",void 0),r=a([b("esri.layers.mixins.PortalLayer")],r),r},Eg={credential:null,user:null};let Rf=class extends X{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};a([c()],Rf.prototype,"updating",void 0),a([c()],Rf.prototype,"status",void 0),Rf=a([b("esri.layers.support.PublishingInfo")],Rf);const D0e=Symbol(),j0e=t=>{var s;var e;const r=t;let i=(s=class extends r{constructor(){super(...arguments),this[e]=!0}get publishingInfo(){if(this.destroyed)return null;const n=this._get("publishingInfo");if(n)return n;const o=new Rf;return this._checkPublishingStatus(o),o}_checkPublishingStatus(n){let u=0;const d=async f=>{let m;n.updating=!0;try{m=await this.fetchPublishingStatus()}catch{m="unavailable"}m!=="published"&&m!=="unavailable"||(n.status==="publishing"&&this.refresh(),p.remove()),n.status=m,n.updating=!1,p.removed||(u=setTimeout(d,f,f+125))},p={removed:!1,remove(){this.removed=!0,clearTimeout(u)}};this.when().catch(()=>p.remove()),d(250),this.addHandles(p)}},e=D0e,s);return a([c({readOnly:!0,clonable:!1})],i.prototype,"publishingInfo",null),i=a([b("esri.layers.mixins.PublishableLayer")],i),i},Va=new H,fm=new WeakMap;function V0e(t){U0e(t)&&Va.push(new WeakRef(t))}function z0e(t){const e=Va.find(r=>r.deref()===t);e&&Va.remove(e)}function U0e(t){return t!=null&&typeof t=="object"&&"refreshInterval"in t&&"refresh"in t}function CV(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:CV(e,t%e):0}let c_=0,Og=0;function q0e(){const t=Date.now();let e=!1;for(const r of Va){const i=r.deref();i?i.refreshInterval&&t-(fm.get(i)??0)+5>=6e4*i.refreshInterval&&(fm.set(i,t),i.refresh(t)):e=!0}if(e)for(let r=Va.length-1;r>=0;r--)Va.at(r).deref()||Va.removeAt(r)}lL(()=>{const t=Date.now();let e=0;for(const r of Va){const i=r.deref();i&&(e=CV(Math.round(6e4*i.refreshInterval),e),i.refreshInterval?fm.get(i)||fm.set(i,t):fm.delete(i))}if(e!==Og){if(Og=e,clearInterval(c_),Og===0)return void(c_=0);c_=setInterval(q0e,Og)}},jn);const $A=.1,G0e=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=gT(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||V0e(this)},()=>{})}destroy(){z0e(this)}castRefreshInterval(i){return i>=$A?i:i<=0?0:$A}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(i=Date.now()){vh(this._debounceHasDataChanged()).then(s=>{s&&this._set("refreshTimestamp",i),this.emit("refresh",{dataChanged:s})},s=>{L.getLogger(this).error(s),this.emit("refresh",{dataChanged:!1,error:s})})}async hasDataChanged(){return!0}get test(){}};return a([c({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:qe}}}}})],r.prototype,"refreshInterval",void 0),a([Ce("refreshInterval")],r.prototype,"castRefreshInterval",null),a([c({readOnly:!0})],r.prototype,"refreshTimestamp",void 0),a([c({readOnly:!0})],r.prototype,"refreshParameters",null),r=a([b("esri.layers.mixins.RefreshableLayer")],r),r},B0e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const i={minScale:this.minScale,maxScale:this.maxScale},s=this.parent;s?.effectiveScaleRange!==void 0&&H0e(i,s.effectiveScaleRange);const n=this._get("effectiveScaleRange");return n&&n.minScale===i.minScale&&n.maxScale===i.maxScale?n:i}};return a([c({type:Number,nonNullable:!0,json:{write:!0}})],r.prototype,"minScale",void 0),a([c({type:Number,nonNullable:!0,json:{write:!0}})],r.prototype,"maxScale",void 0),a([c({readOnly:!0})],r.prototype,"effectiveScaleRange",null),r=a([b("esri.layers.mixins.ScaleRangeLayer")],r),r};function H0e(t,e){return t.minScale=t.minScale>0?e.minScale>0?Math.min(t.minScale,e.minScale):t.minScale:e.minScale,t.maxScale=t.maxScale>0?e.maxScale>0?Math.max(t.maxScale,e.maxScale):t.maxScale:e.maxScale,t}const PV=Ft()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let Ro=class extends pe(F){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return k5(this.value,this.unit,"milliseconds")}};a([se(PV,{nonNullable:!0})],Ro.prototype,"unit",void 0),a([c({type:Number,json:{write:!0},nonNullable:!0})],Ro.prototype,"value",void 0),Ro=a([b("esri.time.TimeInterval")],Ro);function xA(t,e){return Ro.fromJSON({value:t,unit:e})}let er=class extends pe(F){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(e,r){return r.timeExtent&&Array.isArray(r.timeExtent)&&r.timeExtent.length===2?Et.fromArray(r.timeExtent):null}writeFullTimeExtent(e,r){e?.start!=null&&e.end!=null?r.timeExtent=e.toArray():r.timeExtent=null}readInterval(e,r){return r.timeInterval&&r.timeIntervalUnits?xA(r.timeInterval,r.timeIntervalUnits):r.defaultTimeInterval&&r.defaultTimeIntervalUnits?xA(r.defaultTimeInterval,r.defaultTimeIntervalUnits):null}writeInterval(e,r){r.timeInterval=e?.toJSON().value??null,r.timeIntervalUnits=e?.toJSON().unit??null}};a([c({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],er.prototype,"cumulative",void 0),a([c({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],er.prototype,"endField",void 0),a([c({type:Et,json:{write:{enabled:!0,allowNull:!0}}})],er.prototype,"fullTimeExtent",void 0),a([V("fullTimeExtent",["timeExtent"])],er.prototype,"readFullTimeExtent",null),a([q("fullTimeExtent")],er.prototype,"writeFullTimeExtent",null),a([c({type:Boolean,json:{write:!0}})],er.prototype,"hasLiveData",void 0),a([c({type:Ro,json:{write:{enabled:!0,allowNull:!0}}})],er.prototype,"interval",void 0),a([V("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],er.prototype,"readInterval",null),a([q("interval")],er.prototype,"writeInterval",null),a([c({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],er.prototype,"startField",void 0),a([c(Ov("timeReference",!0))],er.prototype,"timeZone",void 0),a([c({type:String,json:{write:{enabled:!0,allowNull:!0}}})],er.prototype,"trackIdField",void 0),a([c({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],er.prototype,"useTime",void 0),a([c({type:[Date],json:{read:!1}})],er.prototype,"stops",void 0),er=a([b("esri.layers.support.TimeInfo")],er);const W0e={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:qe}}},Z0e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(i,s){const n=s.timeInfo.exportOptions;if(!n)return null;const o=n.timeOffset,l=PV.fromJSON(n.timeOffsetUnits);return o&&l?new Ro({value:o,unit:l}):null}set timeInfo(i){p4(i,this.fieldsIndex),this._set("timeInfo",i)}};return a([c({type:Et,json:{write:!1}})],r.prototype,"timeExtent",void 0),a([c({type:Ro})],r.prototype,"timeOffset",void 0),a([V("service","timeOffset",["timeInfo.exportOptions"])],r.prototype,"readOffset",null),a([c({value:null,type:er,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],r.prototype,"timeInfo",null),a([c(W0e)],r.prototype,"useViewTime",void 0),r=a([b("esri.layers.mixins.TemporalLayer")],r),r};let J0e=class extends Um{constructor(e){super(),this.type="track",this.trackInfoProvider=e}get id(){return this.trackInfoProvider.id}get[fy](){return this.trackInfoProvider.trackInfo}},as=class extends pe(F){constructor(e){super(e),this.labelingInfo=null,this.labelsVisible=!0,this.renderer=null,this.visible=!0}};a([c({type:[Ye],json:{write:!0}})],as.prototype,"labelingInfo",void 0),a([c(w1)],as.prototype,"labelsVisible",void 0),a([c({types:My,json:{write:!0}})],as.prototype,"renderer",void 0),a([c({type:Boolean,json:{write:!0}})],as.prototype,"visible",void 0),as=a([b("esri.layers.support.TrackPartInfo")],as);let ai=class extends pe(F){constructor(e){super(e),this.enabled=!0,this.fields=[],this.latestObservations=new as({renderer:new Zr({symbol:ow.clone()})}),this.maxDisplayDuration=null,this.maxDisplayObservationsPerTrack=0,this.popupEnabled=!0,this.popupTemplate=null,this.previousObservations=new as({renderer:new Zr({symbol:ow.clone()})}),this.trackLines=new as({renderer:new Zr({symbol:S3.clone()})}),this.timeField="startTimeField"}writeFields(e,r,i){const s=e.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());Ht(i,s,r)}};a([c({type:Boolean,json:{write:!0}})],ai.prototype,"enabled",void 0),a([c({type:[Ir],json:{write:!0}})],ai.prototype,"fields",void 0),a([q("fields")],ai.prototype,"writeFields",null),a([c({type:as,json:{write:!0}})],ai.prototype,"latestObservations",void 0),a([c({type:Ro,json:{write:!0}})],ai.prototype,"maxDisplayDuration",void 0),a([c({type:Number,json:{write:!0}})],ai.prototype,"maxDisplayObservationsPerTrack",void 0),a([c(v1)],ai.prototype,"popupEnabled",void 0),a([c({type:Vn,json:{name:"popupInfo",write:!0}})],ai.prototype,"popupTemplate",void 0),a([c({type:as,json:{write:!0}})],ai.prototype,"previousObservations",void 0),a([c({type:as,json:{write:!0}})],ai.prototype,"trackLines",void 0),a([c({type:["timeReceived","startTimeField","endTimeField"],json:{read:!0,write:!0}})],ai.prototype,"timeField",void 0),ai=a([b("esri.layers.support.TrackInfo")],ai);const Y0e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.trackGraphicOrigin=new J0e(this),this.trackInfo=null}};return a([c({readOnly:!0,clonable:!1})],r.prototype,"trackGraphicOrigin",void 0),a([c({type:ai})],r.prototype,"trackInfo",void 0),r=a([b("esri.layers.mixins.TrackableLayer")],r),r},TA=new $e({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let xn=class extends pe(F){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};a([c({json:{write:!0}})],xn.prototype,"name",void 0),a([c({json:{write:!0}})],xn.prototype,"description",void 0),a([c({json:{read:TA.read,write:TA.write}})],xn.prototype,"drawingTool",void 0),a([c({json:{write:!0}})],xn.prototype,"prototype",void 0),a([c({json:{write:!0}})],xn.prototype,"thumbnail",void 0),xn=a([b("esri.layers.support.FeatureTemplate")],xn);let Sn=class extends pe(F){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const r={};for(const i of Object.keys(e))r[i]=i1(e[i]);return r}writeDomains(e,r){const i={};for(const s of Object.keys(e))e[s]&&(i[s]=e[s]?.toJSON());r.domains=i}};a([c({json:{write:!0}})],Sn.prototype,"id",void 0),a([c({json:{write:!0}})],Sn.prototype,"name",void 0),a([c({json:{write:!0}})],Sn.prototype,"domains",void 0),a([V("domains")],Sn.prototype,"readDomains",null),a([q("domains")],Sn.prototype,"writeDomains",null),a([c({type:[xn],json:{write:!0}})],Sn.prototype,"templates",void 0),Sn=a([b("esri.layers.support.FeatureType")],Sn);let ka=class extends pe(F){constructor(e){super(e),this.alias=null,this.name=void 0,this.fieldFormat=null}};a([c({type:String,json:{write:!0}})],ka.prototype,"alias",void 0),a([c({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],ka.prototype,"name",void 0),a([c({types:C4,json:{write:!0}})],ka.prototype,"fieldFormat",void 0),ka=a([b("esri.layers.support.FieldConfiguration")],ka);function K0e(t){const{popupTemplate:e,fieldsIndex:r}=t,i=e?.fieldInfos;if(!i?.length||!r)return;const s=[];for(const n of i){const{fieldName:o,label:l}=n,u=r.get(o);if(!u)continue;const d=l&&l!==u.alias?l:null,p=Yre(n,u);(d||p)&&s.push(new ka({name:u.name,alias:d,fieldFormat:p}))}return s.length?s:null}function Q0e(t){const{fields:e}=t;if(!e?.length)return;const r=[];for(const i of e){const s=Yu(i)?Kf(i):null;s&&r.push(new ka({name:i.name,fieldFormat:s}))}return r.length?r:null}function X0e(t,e){const{popupTemplate:r,fieldsIndex:i}=t;if(!r||!i)return;const s=eve(t,e,r.fieldInfos);if(!s)return;const n=r.clone();return n.fieldInfos=s,n}function eve(t,e,r){e??=[],r=E(r)??[];let i=!1;const s=new Map;for(const n of e){const o=t.fieldsIndex.get(n.name);o&&s.set(o.name,n)}for(const n of r){const o=t.fieldsIndex.get(n.fieldName);if(!o)continue;const l=s.get(o.name);n.label=l?.alias||o.alias,n.format=Yu(o)&&l?.fieldFormat?RM(l.fieldFormat,o):null,i=!0,s.delete(o.name)}for(const n of s.values()){const o=tve(t,n);o&&(r.push(o),i=!0)}return i?r:null}function tve(t,e){const{name:r,alias:i,fieldFormat:s}=e,n=t.fieldsIndex.get(r);if(!n||!i&&!s)return;const o=i||n.alias,l=Yu(n)&&s?RM(s,n):null;return new e1({fieldName:n.name,label:o,format:l,visible:!1,isEditable:g4(n,t)})}function rve(){return{fields:{type:[rr],value:null,set:function(t){if(t&&k("big-integer-warning-enabled")){const e=t.filter(r=>r.type==="big-integer"||r.type==="oid"&&(r.length||0)>=8);if(e.length){const r=e.map(i=>`'${i.name}'`).join(", ");L.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${r}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",t)}},fieldsIndex:{readOnly:!0,get(){return cw.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){const t=this._userOutFields;if(!t?.length)return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const e of t)this.fieldsIndex?.has(e)||L.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${e} found in outFields`,{layer:this,outFields:t});return Qw(this.fieldsIndex,t)}}}}const d_=()=>L.getLogger("esri.layers.support.labelingInfo"),ive=/\[([^[\]]+)\]/gi;function MA(t,e,r){return t?t.map(i=>{const s=new Ye;if(s.read(i,r),s.labelExpression){const n=e.fields||e.layerDefinition?.fields||this.fields;s.labelExpression=s.labelExpression.replaceAll(ive,(o,l)=>`[${sve(l,n)}]`)}return s}):null}function sve(t,e){if(!e)return t;const r=t.toLowerCase();for(let i=0;i<e.length;i++){const s=e[i].name;if(s.toLowerCase()===r)return s}return t}const IA=["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],nve={esriGeometryPoint:IA,esriGeometryMultiPatch:["always-horizontal"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along","above-along","below-along"],esriGeometryMultipoint:IA,esriGeometryEnvelope:null};function JOe(t,e){const r=[];for(const i of t){const s=i.labelPlacement,n=nve[e];if(!i.symbol)return d_().warn("No ILabelClass symbol specified."),[];if(!n)return d_().error(new x("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${e}' is not supported`)),[];if(n.includes(s))r.push(i);else{const o=n[0];s&&d_().warn(`Found invalid label placement type ${s} for ${e}. Defaulting to ${o}`);const l=i.clone();l.labelPlacement=o,r.push(l)}}return r}const ove="relationships/",ave="expression/",lve=/<br\s*\/*>/gi;let jr=class extends X{constructor(e){super(e),this._featureUtils=null,this.effectivePopupTemplate=null}get _arcadeTask(){return this.expressionsUsedInTitle.length>0?this._get("_arcadeTask")||iy(()=>Nu()):null}get featureUtilsPromise(){return this._get("featureUtilsPromise")??N(()=>import("./featureUtils-Dbxr6p8y.js"),__vite__mapDeps([172,22])).then(e=>this._featureUtils=e)}get calculatedExpressions(){const e=new H;if(!this.expressionsUsedInTitle.length)return e;if(!this._arcadeTask?.value){for(const r of this.expressionsUsedInTitle??[])e.push({name:r.name,invalid:!0});return e}for(const r of this.expressionsUsedInTitle)try{const i=this._arcadeTask.value.arcade.parseScript(r.expression,["$layer","$map","$datastore"]);if(i.isAsync){e.push({name:r.name,invalid:!0});break}e.push({name:r.name,syntax:i,invalid:!1,func:this._arcadeTask.value.arcade.compileScript(i,{vars:{$feature:"any"}})})}catch{e.push({name:r.name,invalid:!0});break}return e}get expressionsUsedInTitle(){let e=this.effectivePopupTemplate?.title??"";return typeof e!="string"?[]:(e=e.toLowerCase(),this.effectivePopupTemplate?.expressionInfos?.filter(r=>e.includes(`{expression/${r.name.toLowerCase()}}`))??[])}get fieldInfoMap(){return this._featureUtils?this._createFieldInfoMap(this._featureUtils.getAllFieldInfos(this.effectivePopupTemplate)):null}get hasBadExpressions(){return this.calculatedExpressions.some(e=>e.invalid===!0)}get requiredFields(){const e=new Set;if(this._arcadeTask?.value&&!this.hasBadExpressions)for(const i of this.calculatedExpressions?.toArray()??[])try{const s=this._arcadeTask.value.arcade.extractFieldLiterals(i.syntax);for(const n of s){const o=n.split("."),l=this.fieldsIndex.get(o.at(-1)??"");l&&e.add(l.name)}}catch{}const r=this._extractFieldNames(this.workingTitle);for(const i of r){const s=this.fieldsIndex.get(i);s&&e.add(s.name)}return this.objectIdField!=null&&e.add(this.objectIdField),e}get titleFromDisplayField(){let e="";return this.displayField&&(e=this.fieldsIndex.get(this.displayField)?.name??""),e||(e=this.fieldsIndex.get(this.objectIdField)?.name??""),e?`{${e}}`:""}get workingTitle(){const e=this.effectivePopupTemplate?this.effectivePopupTemplate.title:"";return e===""||e==null||this.hasBadExpressions||typeof e!="string"?this.titleFromDisplayField:e}async getTitle(e,r,i){const s=r.getObjectId()??r.attributes[e.objectIdField];return(await this.getTitles(e,[r],i)).get(s)??""}async getTitles(e,r,i){const s=new Map,n=i?.timeZone??"system";try{const[{substituteFieldsInLinksAndAttributes:o}]=await Promise.all([this.featureUtilsPromise,this._arcadeTask?.promise]);i?.fetchMissingFields&&(r=await this._checkAndReQueryGraphics(e,r));const{fieldInfoMap:l,workingTitle:u}=this,d=u&&l;r.forEach(p=>{const f=p.getObjectId()??p.attributes[e.objectIdField];let m=d?o({attributes:p.attributes,expressionAttributes:null,fieldInfoMap:l,globalAttributes:this._createFormattedAttributes(e,p,n).global,layer:e,text:u}):"";i?.removeHTML&&(m=ute.sanitize(m).replaceAll(lve," ")),s.set(f,m)})}catch{}return s}async _checkAndReQueryGraphics(e,r){const i=r.map(s=>s.getObjectId()??s.attributes[e.objectIdField]).filter(ps);if(i.length!==r.length)return r;if(r.some(s=>!Gre(s,this.requiredFields))){const s=e.createQuery();s.where="1=1",s.outFields=[...this.requiredFields],s.objectIds=i;const n=await e.queryFeatures(s);if(n?.features.length===r.length)return n.features}return r}_createFieldInfoMap(e){const r=new Map;if(!e)return r;for(const i of e){if(!i.fieldName)continue;const s=this.fieldsIndex.get(i.fieldName),n=s?.name??i.fieldName;i.fieldName=n,r.set(n.toLowerCase(),i)}return r}_createFormattedAttributes(e,r,i="system"){const s=this.effectivePopupTemplate?.fieldInfos??[],n={};if(!this._featureUtils)return{};if(!this.hasBadExpressions&&this.calculatedExpressions.length>0&&this._arcadeTask?.value){const l=this._arcadeTask.value.Feature.createFromGraphicLikeObject(r.geometry,r.attributes,e,null);for(const u of this.calculatedExpressions)try{n[`expression/${u.name}`]=u.func({vars:{$feature:l}})}catch{}}const o={...r.attributes,...n};return{global:this._featureUtils.formatAttributes({fieldInfos:s,attributes:o,graphic:r,timeZone:i,layer:e,fieldInfoMap:this.fieldInfoMap}),content:[]}}_extractFieldNames(e){return PM(e).filter(r=>!(r.startsWith(ove)||r.startsWith(ave)))}};a([c({readOnly:!0})],jr.prototype,"_arcadeTask",null),a([c()],jr.prototype,"_featureUtils",void 0),a([c({readOnly:!0})],jr.prototype,"featureUtilsPromise",null),a([c({readOnly:!0})],jr.prototype,"calculatedExpressions",null),a([c()],jr.prototype,"displayField",void 0),a([c()],jr.prototype,"effectivePopupTemplate",void 0),a([c()],jr.prototype,"expressionsUsedInTitle",null),a([c()],jr.prototype,"fieldsIndex",void 0),a([c()],jr.prototype,"fieldInfoMap",null),a([c()],jr.prototype,"fields",void 0),a([c()],jr.prototype,"objectIdField",void 0),a([c()],jr.prototype,"requiredFields",null),jr=a([b("esri.layers.support.TitleCreator")],jr);const nd=[];function uve(t,e){if(tv(t.url??""))return!0;const{wkid:r}=e;for(const i of nd){if((t.version??0)>=i[0])return!0;if(typeof i[1]=="function"&&(i[1]=i[1]()),i[1].has(r))return!1}return!0}nd.push([10.91,()=>{const t=new Set([9709,9716,9741,9761,9766]);for(let e=9712;e<=9713;e++)t.add(e);for(let e=9748;e<=9749;e++)t.add(e);for(let e=20904;e<=20932;e++)t.add(e);for(let e=21004;e<=21032;e++)t.add(e);for(let e=21207;e<=21264;e++)t.add(e);for(let e=21307;e<=21364;e++)t.add(e);for(let e=23301;e<=23333;e++)t.add(e);for(let e=102759;e<=102760;e++)t.add(e);for(let e=102934;e<=102955;e++)t.add(e);return t}]),nd.push([10.9,()=>{const t=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let e=9356;e<=9360;e++)t.add(e);for(let e=9404;e<=9407;e++)t.add(e);for(let e=9476;e<=9482;e++)t.add(e);for(let e=9487;e<=9494;e++)t.add(e);for(let e=9697;e<=9699;e++)t.add(e);return t}]),nd.push([10.81,()=>{const t=new Set([9265,9333,103598,103699]);for(let e=9248;e<=9254;e++)t.add(e);for(let e=9271;e<=9273;e++)t.add(e);for(let e=9284;e<=9285;e++)t.add(e);for(let e=21453;e<=21463;e++)t.add(e);return t}]),nd.push([10.8,()=>{const t=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let e=8035;e<=8036;e++)t.add(e);for(let e=8455;e<=8456;e++)t.add(e);for(let e=8518;e<=8529;e++)t.add(e);for(let e=8533;e<=8536;e++)t.add(e);for(let e=8538;e<=8540;e++)t.add(e);for(let e=8677;e<=8679;e++)t.add(e);for(let e=8902;e<=8903;e++)t.add(e);for(let e=8907;e<=8910;e++)t.add(e);for(let e=8949;e<=8951;e++)t.add(e);for(let e=8972;e<=8987;e++)t.add(e);for(let e=9039;e<=9040;e++)t.add(e);for(let e=9068;e<=9069;e++)t.add(e);for(let e=9140;e<=9141;e++)t.add(e);for(let e=9148;e<=9150;e++)t.add(e);for(let e=9153;e<=9159;e++)t.add(e);for(let e=9205;e<=9218;e++)t.add(e);for(let e=9221;e<=9222;e++)t.add(e);for(let e=54098;e<=54101;e++)t.add(e);return t}]),nd.push([10.71,()=>{const t=new Set([6316]);for(let e=8351;e<=8353;e++)t.add(e);for(let e=9294;e<=9297;e++)t.add(e);for(let e=22619;e<=22621;e++)t.add(e);for(let e=103586;e<=103594;e++)t.add(e);return t}]);async function cve(t,e,r){const i=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(i&&i.type==="unique-value"&&i.styleOrigin){const s=await Tw(i.populateFromStyle());if(We(r),s.ok===!1){const n=s.error;e?.messages&&e.messages.push(new qi("renderer:style-reference",`Failed to create unique value renderer from style reference: ${n.message}`,{error:n,context:e})),t.clear("renderer",e?.origin)}}}function dve({displayField:t,editFieldsInfo:e,fields:r,objectIdField:i,title:s},n){if(!r)return null;const o=mve({editFieldsInfo:e,fields:r,objectIdField:i},n);if(!o.length)return null;const l=vve({titleBase:s,fields:r,displayField:t}),u=gve();return new Vn({title:l,content:u,fieldInfos:o})}const hve=(t,e)=>e.visibleFieldNames?e.visibleFieldNames.has(t.name):$re(t,e);function pve({fields:t,ignoreFieldTypes:e,sortDisabled:r}){const i=t;return e&&(t=t.filter(s=>!e.includes(s.type))),t===i&&(t=t.slice()),r!==!0&&t.sort(fve),t}function fve(t,e){return t.type==="oid"?-1:e.type==="oid"?1:EA(t)?-1:EA(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function mve(t,e){const r=e?.visibleFieldNames;return pve({fields:t.fields??[],ignoreFieldTypes:e?.ignoreFieldTypes||wve,sortDisabled:e?.sortDisabled}).map(i=>new e1({fieldName:i.name,isEditable:g4(i,t),label:i.alias,format:yve(i),visible:hve(i,{...t,visibleFieldNames:r})}))}function yve(t){switch(t.type){case"small-integer":case"integer":return new Do({digitSeparator:!0,places:0});case"single":case"double":return new Do({digitSeparator:!0,places:2});case"string":return Hre(t.name)?new Do({digitSeparator:!0,places:0}):void 0;default:return}}function gve(){return[new Rh,new Ah]}function vve(t){const e=pre(t),{titleBase:r}=t;return e?`${r}: {${e.trim()}}`:r??""}function EA(t){return(t.name&&t.name.toLowerCase())==="name"?!0:t.alias?.toLowerCase()==="name"}const wve=["geometry","blob","raster","guid","xml"],Qt="FeatureLayer";function kg(t,e){return new x("layer:unsupported",`Layer (${t.title}, ${t.id}) of type '${t.declaredClass}' ${e}`,{layer:t})}function OA(t){return t&&t instanceof H}const h_=rve();function p_(t,e,r){const i=!!r?.writeLayerSchema;return{enabled:i,ignoreOrigin:i}}let K=class extends kye(k0e(nfe(j0e(rfe(Jpe(Dpe(F0e(Z0e(Y0e(B0e(G0e(ppe(P0e(N0e(t9(jpe(hpe(pe(tt))))))))))))))))))){constructor(...t){super(...t),this.attributeTableTemplate=null,this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.graphicOrigin=new ape(this),this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="ArcGISFeatureLayer",this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.resourceInfo=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=Z.WGS84,this.subtypeCode=null,this.supportedSourceTypes=new Set(["Feature Layer","Oriented Imagery Layer","Table","Catalog Layer"]),this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0,this._debouncedSaveOperations=gT(async(e,r,i)=>{const{save:s,saveAs:n}=await N(()=>import("./featureLayerUtils-BY7Jqlzq.js"),__vite__mapDeps([315,316,317,314,318,8]));switch(e){case 0:return s(this,r);case 1:return n(this,i,r)}})}destroy(){this.source?.destroy()}normalizeCtorArgs(t,e){return typeof t=="string"?{url:t,...e}:t}load(t){const e=t!=null?t.signal:null;if(this.portalItem?.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(e).then(i=>this.initLayerProperties(i))),Promise.resolve(this);const r=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},t).catch(Mn).then(async()=>{if(this.url&&this.layerId==null&&/FeatureServer|MapServer\/*$/i.test(this.url)){const i=await this._fetchFirstValidLayerId(e);i!=null&&(this.layerId=i)}if(!this.url&&!this._hasMemorySource())throw new x("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(e))}).then(()=>Jme(this,"load",t));return this.addResolvingPromise(r),Promise.resolve(this)}get _titleCreator(){const t=this._get("_titleCreator");return Ke(t),new jr({fieldsIndex:this.fieldsIndex,objectIdField:this.objectIdField,fields:this.fields,displayField:this.displayField,effectivePopupTemplate:this.popupTemplate??this.defaultPopupTemplate})}readCapabilities(t,e){return e=e.layerDefinition||e,Z9(e,this.url)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){return!(this.loaded&&!this.capabilities?.operations.supportsEditing)&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(t){this._overrideIfSome("editingEnabled",t)}readEditingEnabled(t,e){return this._readEditingEnabled(e,!1)}readEditingEnabledFromWebMap(t,e,r){return this._readEditingEnabled(e,!0,r)}writeEditingEnabled(t,e){this._writeEditingEnabled(t,e,!1)}writeEditingEnabledToWebMap(t,e,r,i){this._writeEditingEnabled(t,e,!0,i)}get effectiveEditingEnabled(){return Qme(this)}get featureTitleFields(){return[...this._titleCreator.requiredFields]}set fieldConfigurations(t){if(this._hasMemorySource()||(this._override("fieldConfigurations",t),!this.loaded))return;const e=X0e(this,t);e&&this._set("popupTemplate",e)}get fieldConfigurations(){if(!this._hasMemorySource())return this._isOverridden("fieldConfigurations")?this._get("fieldConfigurations"):K0e(this)||null}readIsTable(t,e){return(e=e?.layerDefinition??e).type==="Table"||!e.geometryType}writeIsTable(t,e,r,i){i?.writeLayerSchema&&Ht(r,t?"Table":"Feature Layer",e)}readGlobalIdField(t,e){return N9(e.layerDefinition||e)}readObjectIdField(t,e){return D9(e.layerDefinition||e)}writePopupTemplate(t,e,r,i){t&&(e[r]=t.toJSON({...i,writeFieldFormat:!i?.writeLayerSchema}))}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(t){BO(t,this.fieldsIndex),this._set("renderer",t)}readRenderer(t,e,r){e=e.layerDefinition||e;const i=e.drawingInfo?.renderer;if(i){const s=Hm(i,e,r)??void 0;return s||L.getLogger(this).error("Failed to create renderer",{rendererDefinition:e.drawingInfo.renderer,layer:this,context:r}),s}return I3(e,r)}set source(t){const e=this._get("source");e!==t&&(OA(e)&&this._resetMemorySource(e),OA(t)&&this._initMemorySource(t),this._set("source",t))}castSource(t){return t?Array.isArray(t)||t instanceof H?new wo({layer:this,items:t}):t:null}readSource(t,e){const r=zt.fromJSON(e.featureSet);return new wo({layer:this,items:r?.features??[]})}readTemplates(t,e){const r=e.editFieldsInfo,i=r?.creatorField,s=r?.editorField;return t=t?.map(n=>xn.fromJSON(n)),this._fixTemplates(t,i),this._fixTemplates(t,s),t}readTitle(t,e){const r=e.layerDefinition?.name??e.name,i=e.title||e.layerDefinition?.title;if(r){const s=this.portalItem?.title;if(this.sublayerTitleMode==="item-title")return this.url?S7(this.url,r):r;let n=r;if(!n&&this.url){const o=nl(this.url);o!=null&&(n=o.title)}return n?(this.sublayerTitleMode==="item-title-and-service-name"&&s&&s!==n&&(n=s+" - "+n),wT(n)):void 0}if(this.sublayerTitleMode==="item-title"&&i)return i}readTitleFromWebMap(t,e){return e.title||e.layerDefinition?.name}readTypeIdField(t,e){let r=(e=e.layerDefinition||e).typeIdField;if(r&&e.fields){r=r.toLowerCase();const i=e.fields.find(s=>s.name.toLowerCase()===r);i&&(r=i.name)}return r}readTypes(t,e){t=(e=e.layerDefinition||e).types;const r=e.editFieldsInfo,i=r?.creatorField,s=r?.editorField;return t?.map(n=>(n=Sn.fromJSON(n),this._fixTemplates(n.templates,i),this._fixTemplates(n.templates,s),n))}readVisible(t,e){return e.layerDefinition?.defaultVisibility!=null?!!e.layerDefinition.defaultVisibility:e.visibility!=null?!!e.visibility:void 0}async addAttachment(t,e){const r=await kme(this,t,e,Qt);return this.lastEditsEventDate=new Date,r}async updateAttachment(t,e,r){const i=await Cme(this,t,e,r,Qt);return this.lastEditsEventDate=new Date,i}async applyEdits(t,e){return Pme(this,t,e)}async uploadAssets(t,e){return Ame(this,t,e)}createFieldConfigurations(){return Q0e(this)}createPopupTemplate(t){return dve(this,t)}async createGraphicsSource(t){if(this._hasMemorySource()&&this.source)return this.source.load({signal:t});const{default:e}=await MR(N(()=>import("./FeatureLayerSource-ClstiKdw.js"),__vite__mapDeps([319,61,66,320,321,111,112,322,323,48,43,324,325,73,71,72,4,31,34,175,33])),t);return new e({layer:this,supportedSourceTypes:this.supportedSourceTypes}).load({signal:t})}createQuery(){const t=qme(this);t.dynamicDataSource=this.dynamicDataSource;const e=this.subtypeCode!=null?`${this.subtypeField} = ${this.subtypeCode}`:null,r=Gte(this.definitionExpression,e);return t.where=r||"1=1",t}async deleteAttachments(t,e){const r=await Rme(this,t,e,Qt);return this.lastEditsEventDate=new Date,r}async fetchRecomputedExtents(t){return Lme(this,t,Qt)}async getFeatureTitle(t,e){return this._titleCreator.getTitle(this,t,e)}async getFeatureTitles(t,e){return this._titleCreator.getTitles(this,t,e)}getFeatureType(t){return z9(this.types,this.typeIdField,t)}getFieldAlias(t){const e=this.getField(t);if(e)return this.getFieldConfiguration(e.name)?.alias||e.alias}getFieldConfiguration(t){return t=t.toLowerCase(),this.fieldConfigurations?.find(e=>e.name.toLowerCase()===t)}getFieldDomain(t,e){return Bme(this,t,e,this.getField(t)?.domain??null)}async queryAttachments(t,e){return Fme(this,t,e,Qt)}async queryFeatures(t,e){const r=await this.load(),i=await r.source.queryFeatures(re.from(t)??r.createQuery(),e),s=this.graphicOrigin;if(i?.features)for(const n of i.features)n.layer=n.sourceLayer=r,n.origin=s;return i}async queryObjectIds(t,e){return await Nme(this,t,e,Qt)}async queryFeatureCount(t,e){return Dme(this,t,e,Qt)}async queryExtent(t,e){return jme(this,t,e,Qt)}async queryRelatedFeatures(t,e){return Vme(this,t,e,Qt)}async queryRelatedFeaturesCount(t,e){return zme(this,t,e,Qt)}async queryPivot(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryPivot||!i?.operations?.supportsQueryPivot)throw new x(Qt,"Layer source does not support queryPivot capability");const s=await N(()=>import("./PivotQuery-DpciVf71.js").then(o=>o.P),[]),n=await r.queryPivot(s.default.from(t),e);if(n?.features)for(const o of n.features)o.layer=o.sourceLayer=this;return n}async queryTopFeatures(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryTopFeatures||!i?.query?.supportsTopFeaturesQuery)throw new x(Qt,"Layer source does not support queryTopFeatures capability");const s=await N(()=>import("./TopFeaturesQuery-GQSLw8wH.js"),[]),n=await r.queryTopFeatures(s.default.from(t),e);if(n?.features)for(const o of n.features)o.layer=o.sourceLayer=this;return n}async queryAttributeBins(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryAttributeBins)throw new x(Qt,"Layer source does not support queryAttributeBins capability");rye(t,i,Qt);const s=await N(()=>import("./AttributeBinsQuery-BaTpEbYl.js"),__vite__mapDeps([238,38,45])),n=await r.queryAttributeBins(s.default.from(t),e);if(n.features)for(const o of n.features)o.layer=o.sourceLayer=this;return n}async queryTopObjectIds(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryTopObjectIds||!i?.query.supportsTopFeaturesQuery)throw new x(Qt,"Layer source does not support queryTopObjectIds capability");const s=await N(()=>import("./TopFeaturesQuery-GQSLw8wH.js"),[]);return(await r.queryTopObjectIds(s.default.from(t),e)).filter(Zte)}async queryTopFeaturesExtent(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryTopExtents||!i?.query?.supportsTopFeaturesQuery)throw new x(Qt,"Layer source does not support queryTopExtents capability");const s=await N(()=>import("./TopFeaturesQuery-GQSLw8wH.js"),[]);return r.queryTopExtents(s.default.from(t),e)}async queryTopFeatureCount(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryTopCount||!i?.query?.supportsTopFeaturesQuery)throw new x(Qt,"Layer source does not support queryFeatureCount capability");const s=await N(()=>import("./TopFeaturesQuery-GQSLw8wH.js"),[]);return r.queryTopCount(s.default.from(t),e)}read(t,e){const r=t.featureCollection;if((r||t.type==="Feature Collection")&&(this.resourceInfo=t),r){const{layers:i,showLegend:s}=r;i?.length===1&&(super.read(i[0],e),s!=null&&super.read({showLegend:s},e))}super.read(t,e),e&&e.origin==="service"&&(this.revert(["objectIdField","fields","timeInfo","dateFieldsTimeZone"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))}write(t,e){e={...e,origin:e?.origin??void 0,writeLayerSchema:e?.writeLayerSchema??this._hasMemorySource()};const{origin:r,layerContainerType:i,messages:s}=e;if(this.dynamicDataSource)return s?.push(kg(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if((r==="web-map"||r==="web-scene")&&i!=="tables")return s?.push(kg(this,`a table source can only be written to tables, not ${i}`)),null;if(this._hasMemorySource())return s?.push(kg(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&(r==="web-map"||r==="web-scene")&&i==="tables")return s?.push(kg(this,"using a non-table source cannot be written to tables in web maps or web scenes")),null;return super.write(t,e)}clone(){if(this._hasMemorySource())throw new x(Qt,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(t){return!!this.loaded&&(this.source?.type==="memory"||uve(this,t))}async save(t){return this._debouncedSaveOperations(0,t)}async saveAs(t,e){return this._debouncedSaveOperations(1,e,t)}_readEditingEnabled(t,e,r){let i=t.layerDefinition?.capabilities;return i?this._hasEditingCapability(i):(i=t.capabilities,e&&r?.origin==="web-map"&&!this._hasMemorySource()&&i?this._hasEditingCapability(i):void 0)}_hasEditingCapability(t){return t.toLowerCase().split(",").map(e=>e.trim()).includes("editing")}_writeEditingEnabled(t,e,r,i){if(!t){const s=this.capabilities?.operations?.supportsSync?"Query,Sync":"Query";Ht("layerDefinition.capabilities",s,e),r&&!i?.writeLayerSchema&&(e.capabilities=s)}}_fetchFirstValidLayerId(t){return Ae(this.url??"",{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:t}).then(e=>{const r=e.data;if(r)return this.applyPreferredHost(r),this.findFirstValidLayerId(r)})}async initLayerProperties(t){return this._set("source",t),t.sourceJSON&&(this.sourceJSON=t.sourceJSON,this.read(t.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:this.portalItem?.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),BO(this.renderer,this.fieldsIndex),p4(this.timeInfo,this.fieldsIndex),this._hasMemorySource()&&this.geometryType==="mesh"&&(this.capabilities.query.supportsReturnMesh=!0),cve(this,{origin:"service"})}async hasDataChanged(){return Ume(this)}async fetchPublishingStatus(){const t=this.source;return t?.fetchPublishingStatus?t.fetchPublishingStatus():"unavailable"}_verifyFields(){const t=this.parsedUrl?.path??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+t+")"),this.isTable||this._hasMemorySource()||t.search(/\/FeatureServer\//i)!==-1||this.fields?.some(e=>e.type==="geometry")||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+t+")")}_fixTemplates(t,e){t&&t.forEach(r=>{const i=r.prototype?.attributes;i&&e&&delete i[e]})}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new x("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new x("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(t){t.forEach(e=>{e.layer=this,e.sourceLayer=this}),this.addHandles([t.on("after-add",e=>{e.item.layer=this,e.item.sourceLayer=this}),t.on("after-remove",e=>{e.item.layer=null,e.item.sourceLayer=null})],"fl-source")}_resetMemorySource(t){t.forEach(e=>{e.layer=null,e.sourceLayer=null}),this.removeHandles("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}findFirstValidLayerId(t){return Array.isArray(t.layers)&&t.layers.length>0?t.layers[0].id:Array.isArray(t.tables)&&t.tables.length>0?t.tables[0].id:void 0}};a([c({clonable:!1,readOnly:!0})],K.prototype,"_titleCreator",null),a([c(_fe)],K.prototype,"attributeTableTemplate",void 0),a([V("service","capabilities")],K.prototype,"readCapabilities",null),a([c({json:{origins:{"web-scene":{write:!1}},write:!0}})],K.prototype,"charts",void 0),a([c({readOnly:!0})],K.prototype,"createQueryVersion",null),a([c({json:{read:{source:"layerDefinition.copyrightText"}}})],K.prototype,"copyright",void 0),a([c({json:{read:{source:"layerDefinition.displayField"}}})],K.prototype,"displayField",void 0),a([c({types:Fa,readOnly:!0})],K.prototype,"defaultSymbol",void 0),a([c({type:qs})],K.prototype,"dynamicDataSource",void 0),a([c({type:Boolean})],K.prototype,"editingEnabled",null),a([V(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],K.prototype,"readEditingEnabled",null),a([V("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],K.prototype,"readEditingEnabledFromWebMap",null),a([q(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],K.prototype,"writeEditingEnabled",null),a([q("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],K.prototype,"writeEditingEnabledToWebMap",null),a([c({readOnly:!0})],K.prototype,"effectiveEditingEnabled",null),a([c({clonable:!1,readOnly:!0})],K.prototype,"featureTitleFields",null),a([c({type:[ka],json:{name:"layerDefinition.fieldConfigurations",write:{overridePolicy(t,e,r){return{enabled:!r?.writeLayerSchema,ignoreOrigin:this.originIdOf(e)===1}}}}})],K.prototype,"fieldConfigurations",null),a([c({...h_.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:p_}}}}})],K.prototype,"fields",void 0),a([c(h_.fieldsIndex)],K.prototype,"fieldsIndex",void 0),a([c({type:Fs,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],K.prototype,"formTemplate",void 0),a([c({json:{read:{source:"layerDefinition.extent"}}})],K.prototype,"fullExtent",void 0),a([c({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:p_,writer(t,e,r){const i=t?Ox.toJSON(t):null;i&&Ht(r,i,e)}}}},read:{source:"layerDefinition.geometryType",reader:Ox.read}}})],K.prototype,"geometryType",void 0),a([c({readOnly:!0,clonable:!1})],K.prototype,"graphicOrigin",void 0),a([c({json:{read:{source:"layerDefinition.hasM"}}})],K.prototype,"hasM",void 0),a([c({json:{read:{source:"layerDefinition.hasZ"}}})],K.prototype,"hasZ",void 0),a([c(vfe)],K.prototype,"id",void 0),a([c({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],K.prototype,"infoFor3D",void 0),a([c({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],K.prototype,"isTable",void 0),a([V("service","isTable",["type","geometryType"]),V("isTable",["layerDefinition.type","layerDefinition.geometryType"])],K.prototype,"readIsTable",null),a([q("web-map","isTable")],K.prototype,"writeIsTable",null),a([c(w1)],K.prototype,"labelsVisible",void 0),a([c({type:[Ye],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:MA,write:!1}},name:"layerDefinition.drawingInfo.labelingInfo",read:MA,write:{layerContainerTypes:qe}}})],K.prototype,"labelingInfo",void 0),a([c((()=>{const t=E(gfe);return t.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(e,r,i){Ht(i,Vw(e),r)}}},t})())],K.prototype,"opacity",void 0),a([c(mfe)],K.prototype,"legendEnabled",void 0),a([c({type:["show","hide"],json:(()=>{const t=E(S9.json);return t.origins["portal-item"]={read:!1,write:!1},t})()})],K.prototype,"listMode",void 0),a([V("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],K.prototype,"readGlobalIdField",null),a([c({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:p_}}}}})],K.prototype,"objectIdField",void 0),a([V("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],K.prototype,"readObjectIdField",null),a([c({type:["ArcGISFeatureLayer"],json:{write:{target:"layerType",ignoreOrigin:!0,layerContainerTypes:qe}}})],K.prototype,"operationalLayerType",void 0),a([c(h_.outFields)],K.prototype,"outFields",void 0),a([c({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],K.prototype,"path",void 0),a([c(v1)],K.prototype,"popupEnabled",void 0),a([c({type:Vn,json:{name:"popupInfo",write:!0}})],K.prototype,"popupTemplate",void 0),a([q("popupTemplate")],K.prototype,"writePopupTemplate",null),a([c({readOnly:!0})],K.prototype,"defaultPopupTemplate",null),a([c({types:My,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:v0e,name:"layerDefinition.drawingInfo.renderer",write:{layerContainerTypes:qe,overridePolicy:(t,e,r)=>({ignoreOrigin:r?.writeLayerSchema,layerContainerTypes:qe})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,r)=>({ignoreOrigin:r?.writeLayerSchema,layerContainerTypes:qe})}}})],K.prototype,"renderer",null),a([V("service","renderer",["drawingInfo.renderer","defaultSymbol"]),V("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],K.prototype,"readRenderer",null),a([c()],K.prototype,"resourceInfo",void 0),a([c((()=>{const t=E(pfe);return t.json.origins["portal-item"]={read:!1,write:!1},t})())],K.prototype,"screenSizePerspectiveEnabled",void 0),a([c({clonable:!1})],K.prototype,"source",null),a([Ce("source")],K.prototype,"castSource",null),a([V("portal-item","source",["featureSet"]),V("web-map","source",["featureSet"])],K.prototype,"readSource",null),a([c({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],K.prototype,"spatialReference",void 0),a([c({type:Number})],K.prototype,"subtypeCode",void 0),a([c({type:[xn]})],K.prototype,"templates",void 0),a([V("templates",["editFieldsInfo","creatorField","editorField","templates"])],K.prototype,"readTemplates",null),a([c({type:er})],K.prototype,"timeInfo",void 0),a([c()],K.prototype,"title",void 0),a([V("service","title",["name"]),V("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],K.prototype,"readTitle",null),a([V("web-map","title",["layerDefinition.name","title"])],K.prototype,"readTitleFromWebMap",null),a([c({type:String})],K.prototype,"sublayerTitleMode",void 0),a([c({json:{read:!1}})],K.prototype,"type",void 0),a([c({type:String})],K.prototype,"typeIdField",void 0),a([V("service","typeIdField"),V("typeIdField",["layerDefinition.typeIdField"])],K.prototype,"readTypeIdField",null),a([c({type:[Sn]})],K.prototype,"types",void 0),a([V("service","types",["types"]),V("types",["layerDefinition.types"])],K.prototype,"readTypes",null),a([c({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility",layerContainerTypes:qe}}}}})],K.prototype,"visible",void 0),a([V("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],K.prototype,"readVisible",null),K=a([b("esri.layers.FeatureLayer")],K);const KOe=Object.freeze(Object.defineProperty({__proto__:null,get default(){return K}},Symbol.toStringTag,{value:"Module"})),gc="esri-search",xl={base:gc,autocomplete:`${gc}__autocomplete`,dropdown:`${gc}__dropdown`,container:`${gc}__container`,form:`${gc}__form`,submitButton:`${gc}__submit-button`},kA="esri-search-result-renderer",CA={base:kA,moreResults:`${kA}--more-results`};function PA(t){switch(t?.type){case"point":return t;case"extent":return t.center;case"polygon":{const e=iN(t);return e?ee.fromJSON(e):null}case"multipoint":case"polyline":return t.extent?.center;default:return null}}async function bve(t,e){if(t.hasZ||e.type==="2d")return t;const r=e.map?.ground;return r?.layers.length?(await r.queryElevation(t,{cache:e.basemapTerrain?.elevationQueryCache})).geometry:t}function Yx(t,e,r){return AV(t.center,e,r)}function F3(t,e,r){switch(t?.type){case"extent":return t;case"multipoint":case"polygon":case"polyline":return t.extent;case"point":return AV(t,e,r);default:return null}}function AV(t,e,r){const i=t.hasZ?t.z:void 0;if(e?.map)return(r!=null?zpe(e,r):e.extent).clone().centerAt(t).set({zmax:i,zmin:i});const{x:s,y:n,spatialReference:o}=t;return new he({xmin:s-.25,ymin:n-.25,xmax:s+.25,ymax:n+.25,spatialReference:o,zmin:i,zmax:i})}function _ve(t){return t&&typeof t.highlight=="function"}function Sve(t,e,r){return t==null||t>=r&&(e===0||t<=e)}function QOe(t,e){if(e&&t){const{minScale:r,maxScale:i}=t;if($ve(r,i))return Sve(e,r,i)}return!0}function $ve(t,e){return t!=null&&t>0||e!=null&&e>0}function XOe(t){return!t?.minScale||!t.maxScale||t.minScale>=t.maxScale}const eke=()=>!k("disable-feature:layer-based-scale-visibility");let xt=class extends Dw(F){constructor(t){super(t),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suffix="",this.suggestionsEnabled=null,this.withinViewEnabled=!1,this.zoomScale=null}};a([c()],xt.prototype,"autoNavigate",void 0),a([c()],xt.prototype,"filter",void 0),a([c()],xt.prototype,"getResults",void 0),a([c()],xt.prototype,"getSuggestions",void 0),a([c()],xt.prototype,"maxResults",void 0),a([c()],xt.prototype,"maxSuggestions",void 0),a([c()],xt.prototype,"minSuggestCharacters",void 0),a([c()],xt.prototype,"outFields",void 0),a([c()],xt.prototype,"placeholder",void 0),a([c()],xt.prototype,"popupEnabled",void 0),a([c({type:Vn})],xt.prototype,"popupTemplate",void 0),a([c()],xt.prototype,"prefix",void 0),a([c()],xt.prototype,"resultGraphicEnabled",void 0),a([c()],xt.prototype,"resultSymbol",void 0),a([c()],xt.prototype,"suffix",void 0),a([c()],xt.prototype,"suggestionsEnabled",void 0),a([c()],xt.prototype,"withinViewEnabled",void 0),a([c()],xt.prototype,"zoomScale",void 0),xt=a([b("esri.widgets.Search.SearchSource")],xt);const N3=xt,xve=/https?:\/\/services.*\.arcgis\.com/i,Tve=/(?:\{([^}]+)\})/g,zd=()=>L.getLogger("esri.widgets.Search.support.layerSearchUtils");function Mve(t,e){const{exactMatch:r=!1,location:i,maxResults:s,spatialReference:n,source:o,sourceIndex:l,suggestResult:u,view:d}=t,{layer:p,filter:f,zoomScale:m}=o,y=d?.scale,g=RV(o,d),v=e?.signal;return FV(p).then(()=>{const _=p.popupTemplate;return _?_.getRequiredFields(p.fieldsIndex):null}).then(_=>{const{objectIdField:S,returnZ:M}=p,C=UV(o);if(!D3(p,C))throw zd().error("invalid-field: displayField is invalid."),new x("getResults():invalid-field","displayField is invalid.");const T=_?.length?_:[C],O=o.outFields||T,P=LV(O);if(O.includes(S)||P||O.push(S),p.floorInfo?.floorField&&O.push(p.floorInfo.floorField),!(P||dw(p,O)))throw zd().error("invalid-field: outField is invalid."),new x("getResults():invalid-field","outField is invalid.");const D=p.createQuery(),{orderByFields:z}=o;if(z&&(D.orderByFields=z),n){D.outSpatialReference=n;const Q=1/Hi(n);Q&&(D.maxAllowableOffset=Q)}const B=p.geometryType==="mesh"||p.geometryType==="multipatch",G=p.capabilities?.data?.supportsZ&&!B;if(D.returnZ=G&&M!==!1,D.returnGeometry=!0,D.multipatchOption=B?"xyFootprint":null,O&&(D.outFields=O),i)D.geometry=i;else if(u.key)D.objectIds=[u.key];else{const Q=o.searchFields||[C];if(!dw(p,Q))throw zd().error("invalid-field: search field is invalid."),new x("getResults():invalid-field","search field is invalid.");if(zV(p)&&(D.num=s),g&&(D.geometry=g),!u.text?.trim())return[];const Pe=u.text,{prefix:fe="",suffix:Nt=""}=o,Si=qV(`${fe}${Pe}${Nt}`);VV(p)&&DV(p,Q)&&!r&&Pe&&(D.fullText=jV({text:Pe,searchFields:Q}));const or=GV({searchTerm:Si,layer:p,searchFields:Q,filter:f,exactMatch:r,query:D,type:"search"});if(D.where=or,!NV(D))return[]}return p.queryFeatures(D,{signal:v}).then(Q=>jve(Q,d,o,l,C,y,m))})}function Ive(t,e){const{source:r,spatialReference:i,view:s,suggestTerm:n,maxSuggestions:o,sourceIndex:l,exactMatch:u}=t,{layer:d,filter:p}=r,f=e?.signal,m=RV(r,s);return FV(d).then(()=>{if(!zV(d))return[];const y=UV(r),g=r.searchFields||[y],v=[];r.suggestionTemplate?r.suggestionTemplate.replaceAll(Tve,(G,Q)=>(v.push(Q),G)):v.push(y);const _=LV(v);v.includes(d.objectIdField)||_||v.push(d.objectIdField);const S=D3(d,y),M=_||dw(d,v),C=dw(d,g);if(!S)throw zd().error("invalid-field: displayField is invalid."),new x("getSuggestions():invalid-field","displayField is invalid.");if(!M)throw zd().error("invalid-field: outField is invalid."),new x("getSuggestions():invalid-field","outField is invalid.");if(!C)throw zd().error("invalid-field: search field is invalid."),new x("getSuggestions():invalid-field","search field is invalid.");const T=d.createQuery(),{orderByFields:O}=r;if(O&&(T.orderByFields=O),T.outSpatialReference=i,T.returnGeometry=!1,T.num=o,T.outFields=v,m&&(T.geometry=m),!n.trim())return[];const{prefix:P="",suffix:D=""}=r,z=qV(`${P}${n}${D}`);VV(d)&&DV(d,g)&&!u&&n&&(T.fullText=jV({text:n,searchFields:g}));const B=GV({searchTerm:z,layer:d,searchFields:g,filter:p,exactMatch:u,query:T,type:"suggest"});return T.where=B,NV(T)?d.queryFeatures(T,{signal:f}).then(G=>Fve(G,r,l,y)):[]})}function RV(t,e){const{filter:r,withinViewEnabled:i}=t,s=e?.extent;return r?.geometry??(i&&s?s:void 0)}function LV(t){return t&&t.includes("*")}async function FV(t){t&&await t.load()}function NV(t){return!(!t.fullText&&!t.where)}function DV(t,e){const r=t?.indexes;return!r||!e?.length?!1:r.filter(i=>i.indexType==="FullText").some(i=>{const s=i.fields?.split(",").map(n=>n.trim().toLowerCase())||[];return e.every(n=>s.includes(n.toLowerCase()))})}function jV({text:t,searchFields:e}){return t.trim().split(" ").filter(r=>!!r.trim()).map(r=>new Sj({onFields:e,searchTerm:r,searchType:"prefix"}))}function VV(t){return t?.capabilities?.query?.supportsFullTextSearch??!1}function zV(t){return t?.capabilities?.query?.supportsPagination??!1}function Eve(t){return t?.fieldsIndex?.fields?.find(e=>e.type==="string")?.name??""}function UV(t){return t.displayField||t.layer.displayField||Eve(t.layer)}function dw(t,e){return!(!t||!e?.length)&&e.every(r=>D3(t,r))}function D3(t,e){return!!t.getField(e)}function Ove(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!0;return!1}function kve({codedValues:t},e,r){return ev(t??[],i=>{const s=i.name,n=r?s:s.toLowerCase();return(r?e:e.toLowerCase())===n?i.code.toString():null})??null}function qV(t){return t.replaceAll("'","''")}function zp(t,e){const r=e?.where;return r?`(${t}) AND (${r})`:t}function Cve({currentTerm:t,field:e,filter:r,exactMatch:i,url:s,type:n}){const o=e?.type,l=e?.name;if(o==="string"||o==="date"||o==="global-id"){const u=xve.test(s??""),d=u&&Ove(t)?"N":"";return zp(i&&n==="search"?`${l} = ${d}'${t}'`:u?`${l} LIKE ${d}${`'${t}%'`}`:`${`LOWER(${l})`} LIKE ${d}${`'${t.toLowerCase()}%'`}`,r)}if(o==="oid"||o==="small-integer"||o==="integer"||o==="single"||o==="double"){const u=Number(t);return isNaN(u)?null:zp(`${l} = ${u}`,r)}return zp(`${l} = ${t}`,r)}function Pve(t,e){return t?` OR (${e})`:`(${e})`}function GV({searchTerm:t,layer:e,searchFields:r,filter:i,exactMatch:s,query:n,type:o}){const{definitionExpression:l,url:u}=e;let d="";return!n.fullText&&t&&r&&r.forEach(p=>{const f=e.getField(p),m=e.getFieldDomain?.(p,{excludeImpliedDomains:k("esri-widget-legacy-field-domain-calculation")}),y=(m&&m.type==="coded-value"?kve(m,t,s):null)||t||null;if(y!==null){const g=Cve({currentTerm:y,field:f,filter:i,exactMatch:s,url:u,type:o});g&&(d+=Pve(d,g))}}),l&&d?`(${l}) AND (${d})`:l||d}function Ave(t,e){let r=null;const{codedValues:i}=t;return i&&i.length&&i.some(s=>s.code===e&&(r=s.name,!0)),r}function Rve(t,e){return t[e]??t[Object.keys(t).find(r=>r.toLowerCase()===e.toLowerCase())]}function BV(t,e,r){const i=t.sourceLayer,{attributes:s}=t,n=i.getFieldDomain?.(r,{feature:t,excludeImpliedDomains:k("esri-widget-legacy-field-domain-calculation")});if(e)return tM(e,s);if(r&&s){const o=i.getField(r),l=Rve(s,r);return l==null?"":n&&n.type==="coded-value"?Ave(n,l)??"":o?.type==="date"?Xa(new Date(l)):typeof l=="number"?l.toString():typeof l!="string"?"":l.trim()}return""}function Lve(t,e,r,i){const s=t.sourceLayer,{attributes:n}=t,{objectIdField:o}=s,l=o?n[o]:null;return{text:BV(t,e.suggestionTemplate,i),key:l,sourceIndex:r}}function Fve(t,e,r,i){return t.features.map(s=>Lve(s,e,r,i))}function Nve(t){return t!=null&&t.minScale!=null&&t.maxScale!=null}function Dve(t,e,r,i,s,n,o){const l=t.clone();l.layer=t.layer;const u=t.sourceLayer,d=u?.objectIdField,p=d?t.attributes[d]:null,f=BV(t,r.searchTemplate,s);n!=null&&Nve(u)&&(u.minScale&&u.minScale<n?n=u.minScale:u.maxScale&&u.maxScale>n&&(n=u.maxScale));const m=l.geometry?F3(l.geometry,e??void 0,n??void 0):void 0,y=typeof o=="number"&&m?Yx(E(m),e??void 0,o):m,g=t.clone();return g.layer=t.layer,y!=null&&(g.geometry=Be.fromExtent(y)),{extent:y,target:g,feature:l,key:p,name:f,sourceIndex:i}}function jve(t,e,r,i,s,n,o){return t.features.map(l=>Dve(l,e,r,i,s,n,o))}var Kx;let Ds=Kx=class extends N3{constructor(t){super(t),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,r)=>Mve({source:this,...e},r),this.getSuggestions=(e,r)=>Ive({source:this,...e},r)}set layer(t){this._set("layer",t),t&&t.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(t){this._overrideIfSome("name",t)}clone(){return new Kx({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?E(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?E(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){return this.layer.fieldsIndex?.fields.find(t=>t.type==="string")?.name??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:t,searchFields:e}=this;if(!t.loaded)return"";const r=e||[this._getDisplayField()],i=eJ(t);return`: ${r.map(s=>{const n=t.getField(s);return(i?t.getFieldAlias(s):n?.alias)||s}).join(", ")}`}_getLayerTitle(){const{layer:t}=this;if(!t)return;const{title:e}=t;return e?`${e}${this._getSearchFieldsString()}`:void 0}};a([c({json:{read:{source:"field.name"},write:{target:"field.name"}}})],Ds.prototype,"displayField",void 0),a([c({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],Ds.prototype,"exactMatch",void 0),a([c({value:null})],Ds.prototype,"layer",null),a([c()],Ds.prototype,"name",null),a([c({type:[String],json:{write:!0}})],Ds.prototype,"orderByFields",void 0),a([c()],Ds.prototype,"searchFields",void 0),a([c()],Ds.prototype,"searchTemplate",void 0),a([c()],Ds.prototype,"suggestionTemplate",void 0),Ds=Kx=a([b("esri.widgets.Search.LayerSearchSource")],Ds);const od=Ds;function Vve(t){return!!t&&typeof t.x=="number"&&typeof t.y=="number"}function zve(t){return t&&typeof t.xmin=="number"&&typeof t.ymin=="number"&&typeof t.xmax=="number"&&typeof t.ymax=="number"}let ya=class extends F{constructor(e){super(e),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};a([c({type:String,json:{write:!0}})],ya.prototype,"address",void 0),a([c({type:Object,json:{write:!0}})],ya.prototype,"attributes",void 0),a([c({type:he,json:{write:!0}})],ya.prototype,"extent",void 0),a([c({type:ee,json:{write:!0}})],ya.prototype,"location",void 0),a([c({type:Number,json:{write:!0}})],ya.prototype,"score",void 0),ya=a([b("esri.rest.support.AddressCandidate")],ya);const HV=ya,j3={type:String,json:{read:{source:"token"},write:{target:"token"}}};let lr=class extends F{constructor(e){super(e),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};a([c({type:Object,json:{write:!0}})],lr.prototype,"address",void 0),a([c(j3)],lr.prototype,"apiKey",void 0),a([c({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],lr.prototype,"categories",void 0),a([c({type:String,json:{write:!0}})],lr.prototype,"countryCode",void 0),a([c({type:Boolean,json:{write:!0}})],lr.prototype,"forStorage",void 0),a([c({type:ee,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],lr.prototype,"location",void 0),a([c({type:["rooftop","street"],json:{write:!0}})],lr.prototype,"locationType",void 0),a([c({type:String,json:{write:!0}})],lr.prototype,"magicKey",void 0),a([c({type:Number,json:{write:!0}})],lr.prototype,"maxLocations",void 0),a([c({type:[String],json:{write:{writer:(t,e)=>{e.outFields=t?t.join(","):null}}}})],lr.prototype,"outFields",void 0),a([c({type:Z,json:{read:{source:"outSR"},write:{target:"outSR"}}})],lr.prototype,"outSpatialReference",void 0),a([c({type:he,json:{write:{writer:(t,e)=>{const r=t?t.shiftCentralMeridian():null;e.searchExtent=r}}}})],lr.prototype,"searchExtent",void 0),lr=a([b("esri.rest.support.AddressToLocationsParameters")],lr),lr.from=ct(lr);const WV=lr;async function Uve(t,e,r){e=WV.from(e);const i=Sy(t),{address:s,...n}=e.toJSON(),o={...s,...n,f:"json"},l=YM({...i.query,...o}),u=JM(l,r),d=`${i.path}/findAddressCandidates`;return Ae(d,u).then(qve)}function qve({data:t}){if(!t)return[];const{candidates:e,spatialReference:r}=t;return e?e.map(i=>{if(!i)return;const{extent:s,location:n}=i,o=!s||zve(s);return Vve(n)&&o?(s&&(s.spatialReference=r),n&&(n.spatialReference=r),HV.fromJSON(i)):void 0}):[]}const Gve=Ft()({DistanceMarker:"distance-marker",Locality:"locality",POI:"poi",PointAddress:"point-address",Postal:"postal",StreetAddress:"street-address",StreetInt:"street-intersection",StreetName:"street-name",Subaddress:"sub-address"}),Bve=Ft()({localCity:"local-city",postalCity:"postal-city"});var Qx;let Vr=Qx=class extends F{constructor(t){super(t),this.apiKey=null,this.featureTypes=null,this.forStorage=null,this.language=null,this.location=null,this.locationType=null,this.outFields=null,this.outSpatialReference=null,this.preferredLabelValues=null,this.returnInputLocation=null}writeFeatureTypes(t,e){t?.length&&(e.featureTypes=t.map(r=>Gve.toJSON(r)))}writeLocation(t,e){e.location=t?.clone().normalize().toJSON()}static from(t){return Zh(Qx,t)}};a([c(j3)],Vr.prototype,"apiKey",void 0),a([c({type:[["distance-marker","locality","poi","point-address","postal","street-address","street-intersection","street-name","sub-address"]],json:{write:!0}})],Vr.prototype,"featureTypes",void 0),a([q("featureTypes")],Vr.prototype,"writeFeatureTypes",null),a([c({type:Boolean,json:{write:!0}})],Vr.prototype,"forStorage",void 0),a([c({type:String,json:{name:"langCode",write:!0}})],Vr.prototype,"language",void 0),a([c({type:ee,json:{write:!0}})],Vr.prototype,"location",void 0),a([q("location")],Vr.prototype,"writeLocation",null),a([c({type:["street","rooftop"],json:{write:!0}})],Vr.prototype,"locationType",void 0),a([c({type:[String],json:{write:!0}})],Vr.prototype,"outFields",void 0),a([c({type:Z,json:{name:"outSR",write:!0}})],Vr.prototype,"outSpatialReference",void 0),a([se(Bve)],Vr.prototype,"preferredLabelValues",void 0),a([c({type:Boolean,json:{write:!0}})],Vr.prototype,"returnInputLocation",void 0),Vr=Qx=a([b("esri.rest.support.LocationToAddressParameters")],Vr);const ZV=Vr;async function Hve(t,e,r){const i=Sy(t),{path:s,query:n}=i,o=ZV.from(e);if(!o.location)throw new x("location-to-address:location-required","The location parameter is required");const l={...r,query:{...n,...Wve(o),f:"json"}},u=`${s}/reverseGeocode`,{data:d}=await Ae(u,l),{address:p,location:f}=d;return HV.fromJSON({address:p?.Match_addr??"",attributes:p,location:f,score:100})}function Wve(t){const e=t.toJSON(),{featureTypes:r,forStorage:i,langCode:s,location:n,locationType:o,outFields:l,outSR:u,preferredLabelValues:d,returnInputLocation:p,token:f}=e;return{featureTypes:r?.join(","),forStorage:i,langCode:s,location:JSON.stringify(n),locationType:o,outFields:l?.join(","),outSR:u?.wkid??void 0,preferredLabelValues:d,returnInputLocation:p,token:f}}let ad=class extends F{constructor(t){super(t),this.isCollection=null,this.magicKey=null,this.text=null}};a([c({type:Boolean,json:{write:!0}})],ad.prototype,"isCollection",void 0),a([c({type:String,json:{write:!0}})],ad.prototype,"magicKey",void 0),a([c({type:String,json:{write:!0}})],ad.prototype,"text",void 0),ad=a([b("esri.rest.support.SuggestionCandidate")],ad);const Zve=ad;let Ai=class extends F{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};a([c(j3)],Ai.prototype,"apiKey",void 0),a([c({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Ai.prototype,"categories",void 0),a([c({type:String,json:{write:!0}})],Ai.prototype,"countryCode",void 0),a([c({type:ee,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Ai.prototype,"location",void 0),a([c({type:Number,json:{write:!0}})],Ai.prototype,"maxSuggestions",void 0),a([c({type:Z,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Ai.prototype,"outSpatialReference",void 0),a([c({type:he,json:{write:{writer:(t,e)=>{const r=t?t.shiftCentralMeridian():null;e.searchExtent=JSON.stringify(r)}}}})],Ai.prototype,"searchExtent",void 0),a([c({type:String,json:{write:!0}})],Ai.prototype,"text",void 0),Ai=a([b("esri.rest.support.SuggestLocationsParameters")],Ai),Ai.from=ct(Ai);const JV=Ai;async function Jve(t,e,r){const i=Sy(t),s={...(e=JV.from(e)).toJSON(),f:"json"},n=YM({...i.query,...s}),o=JM(n,r),l=`${i.path}/suggest`;return Ae(l,o).then(Yve)}function Yve(t){const{data:e}=t;if(!e)return[];const{suggestions:r}=e;return r?r.map(i=>new Zve(i)):[]}const Kve="Single Line Input",Qve=3e5;function Xve(t,e){return t.location?swe(t,e):nwe(t,e)}function YV(t,e){if(e.localSearchDisabled)return null;const r=t?.scale;return typeof r=="number"&&r<=Qve?t?.extent?.center:null}async function ewe(t,e){const{source:r,spatialReference:i,view:s,suggestTerm:n,maxSuggestions:o,sourceIndex:l}=t,u=new JV,{apiKey:d,url:p}=r,f=KV(r,s),m=e?.signal;if(!p)return null;d&&(u.apiKey=d),r.categories&&(u.categories=r.categories),i&&(u.outSpatialReference=i);const y=YV(s,r);if(y&&(u.location=y),!n.trim())return null;const{prefix:g="",suffix:v=""}=r,_=`${g}${n}${v}`;return u.text=_,f&&(u.searchExtent=f),u.maxSuggestions=o,r.countryCode&&(u.countryCode=r.countryCode),Jve(p,u,{signal:m}).then(S=>awe(S,l))}function twe(t){return!!t&&/(?:geocode-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}function rwe(t){return!!t&&/(?:\/servers\/[\da-z.-]+\/rest\/services\/world\/geocodeserver).*/i.test(t)}function AA(t){return!!t&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}const iwe="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";async function swe(t,e){const{location:r,source:i,sourceIndex:s,spatialReference:n,view:o}=t,{apiKey:l,defaultZoomScale:u,language:d,url:p,zoomScale:f}=i;if(p==null)return[];const m=o?.scale,y=e?.signal,g=new ZV({language:d,location:r,apiKey:l,outSpatialReference:n});try{return QV([await Hve(p,g,{signal:y})],{defaultZoomScale:u,scale:m,sourceIndex:s,view:o,zoomScale:f})}catch{return[]}}function KV(t,e){const{filter:r,withinViewEnabled:i}=t,s=e?.scale,n=e?.extent,o=r?.geometry;return(o?F3(o,e??void 0,s):void 0)||(i&&n?n:void 0)}async function nwe(t,e){const{source:r,suggestResult:i,spatialReference:s,view:n,maxResults:o,sourceIndex:l}=t,u=r?.zoomScale,d=r?.defaultZoomScale;if(!i.text?.trim())return null;const f=!i.key&&r.prefix?r.prefix:"",m=!i.key&&r.suffix?r.suffix:"",y=`${f}${i.text}${m}`,g=new WV,{apiKey:v,url:_}=r,S=n?.scale,M=KV(r,n),C=e?.signal;if(v&&(g.apiKey=v),!_)return null;r.categories&&(g.categories=r.categories),r.locationType&&(g.locationType=r.locationType),s&&(g.outSpatialReference=s);const T=YV(n,r);T&&(g.location=T),g.maxLocations=o,M&&(g.searchExtent=M),r.countryCode&&(g.countryCode=r.countryCode);const{key:O}=i,P=`${O}`;return O&&(g.magicKey=P),g.address={},g.address[r.singleLineFieldName||Kve]=y,r.outFields&&(g.outFields=r.outFields),Uve(_,g,{signal:C}).then(D=>QV(D,{key:P,scale:S,sourceIndex:l,view:n,zoomScale:u,defaultZoomScale:d}))}function owe(t,e){return{text:t.text,key:t.magicKey,sourceIndex:e}}function awe(t,e){return t.map(r=>owe(r,e))}function lwe(t,e){const{key:r,scale:i,sourceIndex:s,view:n,zoomScale:o,defaultZoomScale:l}=e,{attributes:u,extent:d,location:p,address:f}=t,m=new nt({geometry:p,attributes:u}),y=d||p,g=y?F3(y,n??void 0,i??void 0):void 0,v=g?typeof o=="number"?Yx(g,n??void 0,o):typeof l=="number"&&y?.type==="point"?Yx(g,n??void 0,l):g:null,_=p?`${p.x},${p.y}`:"",S=f||_,M=m.clone();return v!=null&&(M.geometry=Be.fromExtent(v)),{extent:v,feature:m,target:M,key:r,name:S,sourceIndex:s}}function QV(t,e){return t.filter(Boolean).map(r=>lwe(r,e))}var Xx;let ur=Xx=class extends N3{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.language=null,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(e,r)=>Xve({source:this,...e},r),this.getSuggestions=(e,r)=>ewe({source:this,...e},r)}clone(){return new Xx({apiKey:this.apiKey,autoNavigate:this.autoNavigate,categories:this.categories?E(this.categories):null,countryCode:this.countryCode,filter:this.filter,language:this.language,locationType:this.locationType,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?E(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?.clone()??null,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,suffix:this.suffix,suggestionsEnabled:this.suggestionsEnabled,url:this.url,withinViewEnabled:this.withinViewEnabled,zoomScale:this.zoomScale})}};a([c()],ur.prototype,"apiKey",void 0),a([c()],ur.prototype,"categories",void 0),a([c()],ur.prototype,"countryCode",void 0),a([c({json:{write:!0}})],ur.prototype,"defaultZoomScale",void 0),a([c()],ur.prototype,"localSearchDisabled",void 0),a([c()],ur.prototype,"language",void 0),a([c()],ur.prototype,"locationType",void 0),a([c({json:{write:!0}})],ur.prototype,"name",void 0),a([c({json:{write:!0}})],ur.prototype,"placeholder",void 0),a([c()],ur.prototype,"searchTemplate",void 0),a([c({json:{write:!0}})],ur.prototype,"singleLineFieldName",void 0),a([c({json:{read:{source:"suggest"},write:{target:"suggest"}}})],ur.prototype,"suggestionsEnabled",void 0),a([c({json:{write:!0}})],ur.prototype,"url",void 0),a([c({json:{write:!0}})],ur.prototype,"zoomScale",void 0),ur=Xx=a([b("esri.widgets.Search.LocatorSearchSource")],ur);const XV=ur;let Ta=class extends F{constructor(e){super(e),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(s=>s.toJSON()),r=this.geometries[0],i={};return i.outSR=_v(this.outSpatialReference),i.inSR=_v(r.spatialReference),i.geometries=JSON.stringify({geometryType:sp(r),geometries:e}),this.transformation&&(i.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(i.transformForward=this.transformForward),i}};a([c()],Ta.prototype,"geometries",void 0),a([c({type:Z,json:{read:{source:"outSR"}}})],Ta.prototype,"outSpatialReference",void 0),a([c()],Ta.prototype,"transformation",void 0),a([c()],Ta.prototype,"transformForward",void 0),Ta=a([b("esri.rest.support.ProjectParameters")],Ta);const uwe=ct(Ta);async function cwe(t,e,r){e=uwe(e);const i=Sy(t),s={...i.query,f:"json",...e.toJSON()},n=e.outSpatialReference,o=sp(e.geometries[0]),l=JM(s,r);return Ae(i.path+"/project",l).then(({data:{geometries:u}})=>Jj(u,o,n))}const ez=()=>L.getLogger("esri.widgets.support.geolocationUtils"),dwe={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function hwe(){const t=!!k("esri-geolocation");return t||ez().warn("geolocation-unsupported","Geolocation unsupported."),t}function pwe(){const t=window.isSecureContext;return t||ez().warnOnce("insecure-context","Geolocation requires a secure origin."),t}function RA(){return hwe()&&pwe()}function fwe(t){return t??=dwe,new Promise((r,i)=>{setTimeout(()=>i(new x("geolocation:timeout","getting the current geolocation position timed out")),15e3),navigator.geolocation.getCurrentPosition(r,i,t??void 0)})}function mwe(t,e){const{position:r,view:i}=t,s=ywe(r),n=s?.coords;if(!n)throw new x("geometry-service:no-coords","Geolocation has no coordinates");return vwe(gwe(n),i,e)}function ywe(t){const e=t&&t.coords||{},r={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed,toJSON:()=>({})};return t&&{coords:r,timestamp:t.timestamp,toJSON:()=>({})}}function gwe({longitude:t,latitude:e,altitude:r}){return new ee({longitude:t,latitude:e,z:r||void 0,spatialReference:{wkid:4326}})}function vwe(t,e,r){if(!e)return Promise.resolve(t);const i=e.spatialReference;return i.isWGS84?Promise.resolve(t):i.isWebMercator?Promise.resolve(za(t)):wwe(r).then(s=>{if(!s)throw new x("geometry-service:missing-url","Geometry service URL is missing");const n=new Ta({geometries:[t],outSpatialReference:i});return cwe(s,n,r).then(o=>o[0])})}function wwe(t){if(_e.geometryServiceUrl)return Promise.resolve(_e.geometryServiceUrl);const e=j.getDefault();return e.load(t).catch(()=>{}).then(()=>e.helperServices?.geometry?.url)}function wr(t,e){return t.hasOwnProperty(e)&&t[e]!=null&&t[e]!==""}const LA="highlight",K0=H.ofType({key:t=>t.layer?"layer":"locator",base:N3,typeMap:{layer:od,locator:XV}}),FA=Z.WGS84,bwe="esri/images/search/search-symbol-32.png",_we=/<[\s\S]*?>/g,vc=-1;var yh;let ve=(yh=class extends j8(Yh){constructor(e){super(e),this._defaultPopupTemplate=new Vn({content:"{Match_addr}"}),this._gotoController=null,this._searching=null,this._updatingPromise=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultSources=new K0,this.defaultSymbols={point:new Sr({url:ot(bwe),size:24,width:24,height:24}),polyline:new bt({color:[130,130,130,1],width:2}),polygon:new fi({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=j.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new K0,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){this.addHandles([ne(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),Ot),ne(()=>this.messages,()=>{this._defaultPopupTemplate.title=this.messages?.searchResult??"",this._update()},Ot)])}destroy(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return this.allSources.length===1||!this.searchAllEnabled?0:vc}set activeSourceIndex(e){this._overrideIfSome("activeSourceIndex",e)}get allPlaceholder(){return this.messages?.allPlaceholder}set allPlaceholder(e){this._overrideIfSome("allPlaceholder",e)}get allSources(){const{sources:e,defaultSources:r,includeDefaultSources:i}=this,s=typeof i=="function"?i.call(null,{sources:e,defaultSources:r}):i?r.concat(e):e,n=this._get("allSources")||new K0;return n.removeAll(),n.addMany(s.filter(Boolean)),n}get defaultPopupTemplate(){return this._defaultPopupTemplate}set defaultPopupTemplate(e){this._overrideIfSome("defaultPopupTemplate",e)}get locationEnabled(){return this._get("locationEnabled")||RA()}set locationEnabled(e){if(e===void 0)return void this._clearOverride("locationEnabled");const r=RA();if(e&&!r){const i=new x("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});L.getLogger(this).error(i)}this._override("locationEnabled",!!e&&r)}get placeholder(){const{allSources:e,activeSourceIndex:r,allPlaceholder:i}=this;return r===vc?i??"":e.at(r)?.placeholder??""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),e===""&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":this.allSources.length===0?"disabled":"ready"}get updating(){return this._updatingPromise!=null}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup();const{view:e,resultGraphic:r}=this;e&&r&&e.graphics.remove(r),this._set("resultGraphic",null)}search(e,r){this.emit("search-start"),this.clearGraphics();const i=this._createSuggestionForSearch(e),s=(async()=>{try{await this.when();const n=await this._getResultsFromSources(i,r);if(r?.signal?.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:i.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(o,n,i);const l=this._getFirstResult(o.results),u=i.location&&l?l.name:i.text,d=u?.replaceAll(_we,"");return this._set("searchTerm",d),(i.key&&typeof i.sourceIndex=="number"||i.location)&&this._set("selectedSuggestion",i),this._set("results",o.results),this._set("resultCount",o.results.reduce((p,f)=>p+(f.results?.length??0),0)),this.emit("search-complete",o),await this._selectFirstResult(l),o}finally{this._clearSearching()}})();return this._searching=s,s}async searchNearby(e){if(!this.locationEnabled){const i=new x("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});throw L.getLogger(this).error(i),i}const r=(async()=>{try{const i=await fwe(),s=await mwe({position:i,view:this.view},e);return await this.search(s,e)}finally{this._clearSearching()}})();return this._searching=r,r}async select(e){if(this.clearGraphics(),!e){const G=new x("select:missing-parameter","Cannot select without a searchResult.",{value:e});throw L.getLogger(this).error(G),G}const{view:r}=this,i=wr(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),s=i!=null?this.allSources.at(i):null;if(!s){const G=new x("select:missing-source","Cannot select without a source.",{source:s});throw L.getLogger(this).error(G),G}const n=s instanceof od?this._getLayerSourcePopupTemplate(s):s.popupTemplate,o=s.resultSymbol||this._getDefaultSymbol(e),l=wr(s,"resultGraphicEnabled")?s.resultGraphicEnabled:this.resultGraphicEnabled,u=wr(s,"autoNavigate")?s.autoNavigate:this.autoNavigate,d=wr(s,"popupEnabled")?s.popupEnabled:this.popupEnabled,p=d?n||this.popupTemplate||this.defaultPopupTemplate:null,{feature:f}=e;if(!f){const G=new x("select:missing-feature","Cannot select without a feature.",{feature:f});throw L.getLogger(this).error(G),G}const{attributes:m,geometry:y,layer:g,sourceLayer:v}=f,_=y?PA(y):null,S={layerViewQuery:this._getLayerView(f),elevationQuery:r&&_!=null?bve(_,r):Promise.resolve(_)},M=await tu(S),C=M.layerViewQuery.value,T=M.elevationQuery.value;o instanceof Le&&(o.text=e.name);const O=r&&u?e.target||e.extent:null;await(O!=null?this._goToSearchResult(O):Promise.resolve());const D=C?f:new nt({geometry:y,symbol:o,attributes:m,layer:g,sourceLayer:v,popupTemplate:p}),z=GS(r),B=z&&d&&D.getEffectivePopupTemplate(z.defaultPopupTemplateEnabled);return B&&await r?.openPopup({features:[D],location:T}),C&&_ve(C)&&!B&&this._highlightFeature({graphic:D,layerView:C}),!C&&l&&r&&r.graphics.push(D),this._setResultFloor(e),this._set("selectedResult",e),this._set("resultGraphic",D),this.emit("select-result",{result:e,source:s,sourceIndex:i}),e}async suggest(e,r,i){const s=e||this.searchTerm;this.emit("suggest-start",{searchTerm:s}),await this._suggestTimer(r,i);const n=await this._suggestImmediate(s,i);return this._set("suggestions",n?.results),this._set("suggestionCount",n?.results.reduce((o,l)=>o+(l.results?.length??0),0)??null),this.emit("suggest-complete",n),n}async when(e,r){await Nw(()=>!this.updating)}async _update(){const{portal:e,view:r}=this;if(this.includeDefaultSources){const i=this._updatingPromise=tu([e?.load(),r?.when()]);if(this.destroyed||(await i,i!==this._updatingPromise))return}this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){const e=this.portal?.helperServices?.geocode;return e?e.map(r=>{if(r.placefinding===!1)return;const i=AA(r.url)&&RR(r.url)?{url:iwe}:null,s=XV.fromJSON({...r,...i}),n=s.url;if(AA(n)||rwe(n)||twe(n)){const o=s.outFields??["Addr_type","Match_addr","StAddr","City"],l=(s.placeholder||this.messages?.placeholder)??"",u=typeof s.defaultZoomScale=="number"?s.defaultZoomScale:2500;s.singleLineFieldName="SingleLine",s.outFields=o,s.placeholder=l,s.defaultZoomScale=u}return s.singleLineFieldName?s:void 0}).filter(ps):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(e=>e?.destroy()),this._createdFeatureLayers=[]}_getLayerSources(e,r){const i=this.view?.map;return e.map(s=>{const n=i.findLayerById(s.id);if(!n)return;const o=this._getLayerJSON(s),l=od.fromJSON(o);return l.placeholder=r,this._getLayer(n,o).then(u=>{l.layer=u}),l}).filter(ps).toArray()}_getTableSources(e,r){const i=this.view?.map;return e.map(s=>{if(!s.id)return;const n=i.findTableById(s.id);if(!n)return;const o=this._getLayerJSON(s),l=od.fromJSON(o);return l.placeholder=r,this._getLayer(n,o).then(u=>{l.layer=u}),l}).filter(ps).toArray()}_convertApplicationProperties(){const e=this.view?.map,r=e?.applicationProperties?.viewing?.search;if(!r)return[];const{enabled:i,hintText:s,layers:n,tables:o}=r;return i?[...this._getLayerSources(n,s),...this._getTableSources(o,s)]:[]}async _getSubLayer(e,r){if(await e.load(),!e.allSublayers)throw new Error;const i=e.allSublayers.find(n=>n.id===r.subLayer);if(!i)throw new Error;const s=await i.createFeatureLayer?.();if(!s)throw new Error;return this._createdFeatureLayers.push(s),s}async _getBuildingSubLayer(e,r){await e.load();const i=e.allSublayers.find(s=>s.id===r.subLayer);if(i?.type!=="building-component")throw new Error;if(await i.load(),i.associatedLayer==null)throw new Error;return await i.associatedLayer.load(),i}async _getLayer(e,r){if(e.type==="feature"||e.type==="scene"||e.type==="csv"||e.type==="geojson"||e.type==="ogc-feature")return e;if(e.type==="map-image")try{return await this._getSubLayer(e,r)}catch{const s=new x("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return L.getLogger(this).error(s),null}return e.type==="building-scene"?this._getBuildingSubLayer(e,r):null}_getLayerJSON(e){return typeof e.toJSON=="function"?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:r}=this;this._destroyFeatureLayers(),e.removeAll(),r&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){const e=GS(this.view),{resultGraphic:r}=this;if(!e||!r)return;const i="selectedFeature"in e,s=i?e.selectedFeature:null;i&&s&&s===r&&n4(this.view?.popup,this.view?.popupElement)}_suggestTimer(e,r){const i=e??this.suggestionDelay;return yT(i,null,r?.signal)}_createLocationForSearch(e){return e instanceof nt&&e.geometry?PA(e.geometry):e instanceof ee?e:Array.isArray(e)&&e.length===2?new ee({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&wr(e,"key")&&wr(e,"text")&&wr(e,"sourceIndex"))return e;const r=this._createLocationForSearch(e),i=typeof e=="string"?e:this.searchTerm,{selectedSuggestion:s,selectedResult:n}=this,o=!e&&s&&n,l=o&&s.key===n.key&&s.sourceIndex===n.sourceIndex,u=o&&s.location;return l||u?s:{location:r,text:r?"":i,sourceIndex:null,key:null}}_getFirstResult(e){return ev(e,({results:r})=>r?.[0])??null}async _selectFirstResult(e){return this.autoSelect&&e?this.select(e):null}async _suggestImmediate(e,r){await this.when();const i=await this._getSuggestionsFromSources(e,r);if(r?.signal?.aborted)return null;const s={activeSourceIndex:this.activeSourceIndex,searchTerm:e??"",numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(s,i),s}_formatSourceResponse(e,r,i){const s=r?.value||[],n=r?.error,o=this.allSources.at(i);if(n){const l={sourceIndex:i,source:o,error:n};e.errors.push(l),L.getLogger(this).error(n),e.numErrors++}else{const l={sourceIndex:i,source:o,results:s};e.results.push(l),e.numResults+=s.length}}_formatResponse(e,r,i){if(r)if(e.activeSourceIndex===vc){const s=i&&wr(i,"sourceIndex")&&i.sourceIndex!==-1?i.sourceIndex:void 0;r.forEach((n,o)=>{const l=s!==void 0?s:o;this._formatSourceResponse(e,n,l)})}else this._formatSourceResponse(e,r[0],e.activeSourceIndex)}async _getResultsFromSources(e,r){const{allSources:i}=this,s=!e.location&&wr(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,n=[];if(!i.length){const o=new x("search:no-sources-defined","At least one source is required.",{allSources:i});throw L.getLogger(this).error(o),o}return s===vc?i.forEach((o,l)=>{n.push(this._getResultsFromSource(e,l,r))}):n.push(this._getResultsFromSource(e,s,r)),tu(n)}async _getSuggestionsFromSources(e,r){const{allSources:i,activeSourceIndex:s}=this,n=[];if(!i.length){const o=new x("suggest:no-sources-defined","At least one source is required.",{allSources:i});throw L.getLogger(this).error(o),o}return s===vc?i.forEach((o,l)=>{n.push(this._getSuggestionsFromSource(e,l,r))}):n.push(this._getSuggestionsFromSource(e,s,r)),tu(n)}async _getResultsFromSource(e,r,i){const s=r!=null?this.allSources.at(r):null;if(!s)return null;const{location:n=null}=e,o=this.view?.spatialReference??FA,l=wr(s,"maxResults")?s.maxResults:this.maxResults,u=!!(s instanceof od&&wr(s,"exactMatch"))&&s.exactMatch,{view:d}=this;return s.getResults?.({exactMatch:u,location:n,maxResults:l,sourceIndex:r,spatialReference:o,suggestResult:e,view:d},i)}async _getSuggestionsFromSource(e,r,i){const s=this.allSources.at(r);if(!s)return null;e??="";const n=wr(s,"suggestionsEnabled")?s.suggestionsEnabled:this.suggestionsEnabled,o=e?.length,l=wr(s,"minSuggestCharacters")?s.minSuggestCharacters:this.minSuggestCharacters;if(n&&e.trim()&&o>=l){const u=this.view?.spatialReference||FA,d=wr(s,"maxSuggestions")?s.maxSuggestions:this.maxSuggestions,{view:p}=this,f=!!(s instanceof od&&wr(s,"exactMatch"))&&s.exactMatch;return s.getSuggestions?.({view:p,sourceIndex:r,suggestTerm:e,spatialReference:u,maxSuggestions:d,exactMatch:f},i)}return null}_getLayerSourcePopupTemplate(e){const{layer:r}=e;if(r)return wr(e,"popupTemplate")?e.popupTemplate:r.popupTemplate}_getSourceIndexOfResult(e){return ev(this.results??[],({results:r,sourceIndex:i})=>r?.includes(e)?i:null)??null}async _goToSearchResult(e){this._abortGoTo();const r=new AbortController;this._gotoController=r;const i={target:{target:e},options:{signal:r.signal}};e||(i.options.animate=!1),await this.callGoTo(i),this._gotoController=null}_getDefaultSymbol(e){const{defaultSymbols:r}=this,i=e.feature?.geometry;if(i==null)return null;switch(i.type){case"point":case"multipoint":return r.point;case"polyline":return r.polyline;case"extent":case"polygon":return r.polygon;default:return null}}_removeHighlight(){this.removeHandles(LA)}async _getLayerView(e){const{view:r}=this;if(!e||!r)return null;const{layer:i,sourceLayer:s}=e,n=i??s;return n&&n.type!=="building-component"&&n.type!=="subtype-sublayer"?(await r.when(),r.whenLayerView(n)):null}_highlightFeature(e){const{graphic:r,layerView:i}=e,{attributes:s,layer:n,sourceLayer:o}=r,l=n??o,{objectIdField:u}=l,d=(u&&s?.[u])??null,p=i.highlight(d??r);this.addHandles(p,LA)}_setResultFloor(e){const{view:r}=this,i=e.feature?.attributes,s=e.feature?.sourceLayer;if(s&&"floorInfo"in s&&s?.floorInfo?.floorField&&i){const n=i[s.floorInfo.floorField];r?.emit("select-result-floor",n)}}},yh.ALL_INDEX=vc,yh);a([c()],ve.prototype,"_searching",void 0),a([c()],ve.prototype,"_updatingPromise",void 0),a([c({readOnly:!0,value:null})],ve.prototype,"activeSource",null),a([c()],ve.prototype,"activeSourceIndex",null),a([c()],ve.prototype,"allPlaceholder",null),a([c({readOnly:!0})],ve.prototype,"allSources",null),a([c()],ve.prototype,"autoNavigate",void 0),a([c()],ve.prototype,"autoSelect",void 0),a([c({type:Vn})],ve.prototype,"defaultPopupTemplate",null),a([c({readOnly:!0})],ve.prototype,"defaultSources",void 0),a([c()],ve.prototype,"defaultSymbols",void 0),a([c()],ve.prototype,"includeDefaultSources",void 0),a([c()],ve.prototype,"locationEnabled",null),a([c()],ve.prototype,"maxInputLength",void 0),a([c()],ve.prototype,"maxResults",void 0),a([c()],ve.prototype,"maxSuggestions",void 0),a([c()],ve.prototype,"messages",void 0),a([c()],ve.prototype,"minSuggestCharacters",void 0),a([c({readOnly:!0})],ve.prototype,"placeholder",null),a([c()],ve.prototype,"popupEnabled",void 0),a([c({type:Vn})],ve.prototype,"popupTemplate",void 0),a([c({type:j})],ve.prototype,"portal",void 0),a([c()],ve.prototype,"resultCount",void 0),a([c()],ve.prototype,"resultGraphicEnabled",void 0),a([c({readOnly:!0})],ve.prototype,"resultGraphic",void 0),a([c({readOnly:!0})],ve.prototype,"results",void 0),a([c({readOnly:!0})],ve.prototype,"selectedSuggestion",void 0),a([c()],ve.prototype,"searchAllEnabled",void 0),a([c({readOnly:!0})],ve.prototype,"selectedResult",void 0),a([c()],ve.prototype,"searchTerm",null),a([c({type:K0})],ve.prototype,"sources",void 0),a([c({readOnly:!0})],ve.prototype,"state",null),a([c()],ve.prototype,"suggestionDelay",void 0),a([c()],ve.prototype,"suggestionCount",void 0),a([c({readOnly:!0})],ve.prototype,"suggestions",void 0),a([c()],ve.prototype,"suggestionsEnabled",void 0),a([c({readOnly:!0})],ve.prototype,"updating",null),a([c()],ve.prototype,"view",void 0),a([c()],ve.prototype,"clear",null),ve=a([b("esri.widgets.Search.SearchViewModel")],ve);const _d=ve;let ld=class extends ap{constructor(t,e){super(t,e),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}loadDependencies(){return $y({block:()=>N(()=>import("./index-CbRaCHSA.js"),__vite__mapDeps([326,299,300,301,302,327,306,305,304,303,328,329,330,309,331,332,333,312,311,334,335,308,336,337,338,339,340,307,341])),list:()=>N(()=>import("./index-WK9-ylyo.js"),__vite__mapDeps([342,299,300,301,302,327,306,305,304,335,303,343,344,307,308,309,331,310,311,312,345,346,330,347])),"list-item":()=>N(()=>import("./index-CLRmKLUp.js"),__vite__mapDeps([348,303,304,305,328,306,329,330,300,309,331,332,333,312,302,311,299,301,334,335,308,336,337,338,339,347,349])),"list-item-group":()=>N(()=>import("./index-DexyPALL.js"),__vite__mapDeps([350,309,349]))})}destroy(){this.viewModel=null}render(){return Ie("div",{class:this.classes(CA.base,ms.widget)},this.viewModel?.selectedResult?.name??"",this._renderMoreResults())}_renderMoreResults(){if(!this.viewModel)return null;const{resultCount:t,results:e}=this.viewModel;return!t||t<2||!e?null:Ie("calcite-block",{class:CA.moreResults,collapsible:!0,expanded:this.showMoreResultsOpen,heading:tM(this.messages.showMoreResults,{count:t-1}),onCalciteBlockClose:()=>this._toggleShowMoreResults(!1),onCalciteBlockOpen:()=>this._toggleShowMoreResults(!0)},e.map(r=>this._renderMoreResultsList(r,e?.length>1)))}_renderListItem(t){return Ie("calcite-list-item",{key:`result-${t.sourceIndex}-${t.key}`,label:t.name,onCalciteListItemSelect:()=>this._selectResult(t)})}_renderMoreResultsList(t,e){const{results:r}=t;if(!(r?.length??0)||!r)return null;const i=this.viewModel?.selectedResult,s=this._getSourceName(t.source,t.sourceIndex),n=r.filter(o=>o!==i).map(o=>this._renderListItem(o));return Ie("calcite-list",{label:s},e?Ie("calcite-list-item-group",{heading:s,key:`group-${t.sourceIndex}`},n):n)}_selectResult(t){this.showMoreResultsOpen=!1,this.viewModel?.select(t)}_toggleShowMoreResults(t){this.showMoreResultsOpen=t;const e=GS(this.viewModel?.view);e&&"reposition"in e&&typeof e.reposition=="function"&&e.reposition()}_getSourceName(t,e){return e===_d.ALL_INDEX?this.messages.all:t.name}};a([c(),Vu("esri/widgets/Search/t9n/Search")],ld.prototype,"messages",void 0),a([c()],ld.prototype,"showMoreResultsOpen",void 0),a([c()],ld.prototype,"viewModel",void 0),ld=a([b("esri.widgets.Search.SearchResultRenderer")],ld);const Swe=ld;function $we(t){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const r=e._delegatedEventNames;t=Array.isArray(t)?t:xwe(t),r.push(...t)}}function xwe(t){return t.split(",").map(e=>e.trim())}let we=class extends ap{constructor(t,e){super(t,e),this._currentLocationValue=`${this.id}-search-use-current-location`,this._autocompleteNode=null,this._focusAbortController=null,this._searchResultRenderer=new Swe,this._suggestController=null,this._searchController=null,this._lastSearchTerm="",this._locateFailed=!1,this._showNoResults=!1,this.disabled=!1,this.messages=null,this.messagesCommon=null,this.viewModel=new _d,this._renderSearchResultsContent=()=>this._searchResultRenderer,jR(L.getLogger(this),"Search","arcgis-search",{version:"4.33"}),this.addHandles([ne(()=>this.viewModel,r=>this._searchResultRenderer.viewModel=r,Ot),ne(()=>this.viewModel.results,()=>this._searchResultRenderer.showMoreResultsOpen=!1),ne(()=>this.messages,r=>this.viewModel.messages=r),ne(()=>this.viewModel?.defaultPopupTemplate,r=>{r&&(r.content=this._renderSearchResultsContent)},Ot),ne(()=>this.viewModel?.view?.popupElement&&this.viewModel?.defaultPopupTemplate,()=>{if(this.viewModel?.defaultPopupTemplate&&this.viewModel?.view?.popupElement){const r=document.createElement("arcgis-search-result-renderer");r.viewModel=this.viewModel,r.messages=this.messages,this.viewModel.defaultPopupTemplate.content=r}},Ot)])}loadDependencies(){return $y({autocomplete:()=>N(()=>import("./index-Bj4nyfk-.js"),__vite__mapDeps([351,303,304,305,343,344,306,335,307,302,308,309,331,310,311,301,312,329,330,332,300,346,345])),"autocomplete-item-group":()=>N(()=>import("./index-C2k_W6Mi.js"),[]),"autocomplete-item":()=>N(()=>import("./index-jkxNT087.js"),__vite__mapDeps([352,303,304,305,311,309,300])),button:()=>N(()=>import("./index-BsUKe-uf.js"),__vite__mapDeps([298,299,300,301,302,303,304,305,306,307,308,309,310,311,312])),dropdown:()=>N(()=>import("./index-CymEwLOV.js"),__vite__mapDeps([328,306,304,329,330,300,309,331,305,332,333,312,302,311])),"dropdown-group":()=>N(()=>import("./index-C_epJZpm.js"),__vite__mapDeps([338,305,337])),"dropdown-item":()=>N(()=>import("./index-CaZkAYwq.js"),__vite__mapDeps([336,303,304,305,306,311,309,312,302,337])),notice:()=>N(()=>import("./index-DXYKWOjo.js"),__vite__mapDeps([353,303,304,305,306,332,311,301,302,312]))})}destroy(){this._cancelQueries(),this._searchResultRenderer=Ke(this._searchResultRenderer),this._focusAbortController?.abort()}get _isDisabled(){const{state:t}=this.viewModel;return t==="disabled"||t==="loading"||this.disabled}get _showCurrentLocation(){return this.locationEnabled&&!this.searchTerm?.trim()}get _effectiveActiveMenu(){const{activeMenu:t}=this;return this._isDisabled?"none":t==="warning"?"suggestion":t}get activeMenu(){return"none"}set activeMenu(t){t==="warning"&&Y7(L.getLogger(this),"activeMenu","warning",{replacement:"Use the value 'suggestion' instead",version:"4.32",warnOnce:!0}),this._overrideIfSome("activeMenu",t)}get activeSource(){return this.viewModel?.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(t){this.viewModel.activeSourceIndex=t}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(t){this.viewModel.allPlaceholder=t}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(t){this.viewModel.autoNavigate=t}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(t){this.viewModel.autoSelect=t}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return"search"}set icon(t){this._overrideIfSome("icon",t)}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(t){this.viewModel.includeDefaultSources=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(t){this.viewModel.locationEnabled=t}get maxResults(){return this.viewModel.maxResults}set maxResults(t){this.viewModel.maxResults=t}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(t){this.viewModel.maxSuggestions=t}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(t){this.viewModel.minSuggestCharacters=t}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(t){this.viewModel.popupEnabled=t}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(t){this.viewModel.popupTemplate=t}get portal(){return this.viewModel?.portal}set portal(t){this.viewModel&&(this.viewModel.portal=t)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(t){this.viewModel.resultGraphic=t}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(t){this.viewModel.resultGraphicEnabled=t}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(t){this.viewModel.searchAllEnabled=t}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(t){this.viewModel.searchTerm=t}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(t){this.viewModel.sources=t}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(t){this.viewModel.suggestionsEnabled=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}clear(){this._locateFailed=!1,this.viewModel.clear()}focus(){this._handleFocus(),this._emitFocus()}blur(){this._autocompleteNode?.blur(),this._emitBlur()}async search(t){this._cancelQueries();const e=new AbortController,{signal:r}=e;this._searchController=e;try{const i=await this.viewModel.search(t,{signal:r});return this._searchController!==e?void 0:(i?.numResults||(this._showNoResults=!0,this.activeMenu="suggestion"),this._searchController=null,i)}catch{return this._searchController!==e?void 0:void(this._searchController=null)}}async suggest(t){this._cancelSuggest();const e=new AbortController,{signal:r}=e;this._suggestController=e;try{const i=await this.viewModel.suggest(t,null,{signal:r});return this._suggestController!==e?void 0:(this._suggestController=null,i?.numResults&&(this.activeMenu="suggestion",this._scrollToTopSuggestion()),i)}catch{return this._suggestController!==e||(this._suggestController=null),null}}render(){return Ie("div",{class:this.classes(xl.base,ms.widget)},Ie("div",{class:xl.container},this._renderSourcesMenu(),this._renderForm()))}_handleInputKeydown(t){t.key==="Tab"&&this._cancelSuggest()}_emitFocus(){this.emit("search-focus")}_emitBlur(){this.emit("search-blur")}async _handleFocus(){this._focusAbortController?.abort(),this._focusAbortController=new AbortController;const t=this._focusAbortController.signal;await vh(sL(t)),this._autocompleteNode?.setFocus()}_renderSourcesMenu(){const{messages:t,_isDisabled:e,_effectiveActiveMenu:r}=this,{allSources:i,searchAllEnabled:s}=this.viewModel;return i.length>1?Ie("calcite-dropdown",{bind:this,class:xl.dropdown,disabled:e,open:r==="source",overlayPositioning:"fixed",onCalciteDropdownClose:this._handleSourceClose,onCalciteDropdownOpen:this._handleSourceOpen,onCalciteDropdownSelect:this._handleSourceSelect},Ie("calcite-button",{appearance:"outline-fill",iconStart:"caret-down",kind:"neutral",label:t.searchIn,slot:"trigger"}),Ie("calcite-dropdown-group",{groupTitle:t.searchIn},s?this._renderSource(_d.ALL_INDEX):null,i.map((n,o)=>this._renderSource(o)).toArray())):null}_renderUseCurrentLocation(){const{_currentLocationValue:t}=this;return Ie("calcite-autocomplete-item",{heading:this.messages.useCurrentLocation,iconStart:"gps-on",key:t,value:t})}_handleAutocompleteCreate(t){this._autocompleteNode=t}_handleCalciteAutocompleteTextInput(t){const e=t.target.inputValue;e!==this.viewModel.searchTerm&&(this.viewModel.searchTerm=e,e||this.clear(),this.suggest())}_handleAutocompleteOpen(){this.activeMenu="suggestion"}_handleAutocompleteClose(){this.activeMenu==="suggestion"&&(this.activeMenu="none")}_handleCalciteAutocompleteChange(t){const e=t.target.value;if(e===this._currentLocationValue)return void this._useCurrentLocation();const r=JSON.parse(e),i=this.viewModel.suggestions?.find(({sourceIndex:s})=>s===r.sourceIndex)?.results?.find(({key:s})=>`${s}`==`${r.key}`);i&&this.search(i)}_renderAutocomplete(){const{_effectiveActiveMenu:t,messages:e,_isDisabled:r}=this,{maxInputLength:i,placeholder:s,searchTerm:n,state:o}=this.viewModel,l=this.label??e.searchButtonTitle??"";return Ie("calcite-autocomplete",{afterCreate:this._handleAutocompleteCreate,autocomplete:"off",bind:this,class:xl.autocomplete,disabled:r,icon:this.icon||!1,inputValue:n,label:l,loading:o==="searching",maxLength:i,name:this.id,onblur:this._emitBlur,onfocus:this._emitFocus,onkeydown:this._handleInputKeydown,open:t==="suggestion",overlayPositioning:"fixed",placeholder:s,title:n?"":s,onCalciteAutocompleteChange:this._handleCalciteAutocompleteChange,onCalciteAutocompleteClose:this._handleAutocompleteClose,onCalciteAutocompleteOpen:this._handleAutocompleteOpen,onCalciteAutocompleteTextChange:this._handleCalciteAutocompleteTextInput,onCalciteAutocompleteTextInput:this._handleCalciteAutocompleteTextInput},this._renderSuggestions(),this._renderNotices())}_renderForm(){return Ie("form",{bind:this,class:xl.form,disabled:this._isDisabled,key:xl.form,onsubmit:this._formSubmit,role:"search"},this._renderAutocomplete(),Ie("button",{class:xl.submitButton,type:"submit"},this.label??this.messages.searchButtonTitle??""))}_renderSuggestGroup(t){return t.results?.map(e=>this._renderSuggestion(e))}_renderSuggestions(){const{suggestions:t}=this.viewModel;return this._showNoResults?null:this._showCurrentLocation?this._renderUseCurrentLocation():t?.map(e=>this._renderSuggestResults(e))}_renderSuggestResults(t){const{allSources:e,activeSourceIndex:r}=this.viewModel,{sourceIndex:i}=t,s=t.results?.length,n=e.length>1&&r===_d.ALL_INDEX,o=this._getSourceName(i);return s&&n?Ie("calcite-autocomplete-item-group",{heading:o,key:`suggestion-group-${o}-${i}`},this._renderSuggestGroup(t)):this._renderSuggestGroup(t)}_renderSuggestion({key:t,sourceIndex:e,text:r}){const i={key:t,sourceIndex:e};return Ie("calcite-autocomplete-item",{heading:r??this.messages.untitledResult,key:`suggestion_${t}`,value:JSON.stringify(i)})}_renderSource(t){const e=this._getSourceName(t);return Ie("calcite-dropdown-item",{"data-source-index":`${t}`,key:`source-${e}-${t}`,selected:t===this.viewModel.activeSourceIndex},e)}_renderNoResultsWarning(t){const{messages:e}=this,r=t?tM(e.noResultsFoundForValue,{value:`"${t}"`}):e.noResultsFound;return Ie("calcite-notice",{icon:"exclamation-mark-triangle",key:"no-results-warning",kind:"warning",open:!0,slot:"content-bottom"},Ie("div",{slot:"title"},e.noResults),Ie("div",{slot:"message"},r))}_renderLocateError(){return Ie("calcite-notice",{icon:"exclamation-mark-circle",key:"locate-warning",kind:"danger",open:!0,slot:"content-bottom"},Ie("div",{slot:"message"},this.messages.locateError))}_renderNotices(){return this._locateFailed?this._renderLocateError():this._showNoResults?this._renderNoResultsWarning(this._lastSearchTerm??this.viewModel.searchTerm):null}async _useCurrentLocation(){this._cancelQueries();const t=new AbortController,{signal:e}=t;this._searchController=t;try{await this.viewModel.searchNearby({signal:e})}catch(r){nr(r)||(this._locateFailed=!0,this.activeMenu="suggestion")}finally{this._searchController=null}}_handleSourceOpen(){this.activeMenu="source"}_handleSourceClose(){this.activeMenu==="source"&&(this.activeMenu="none")}_handleSourceSelect(t){const e=t.target.selectedItems[0].getAttribute("data-source-index");e&&(this.viewModel.activeSourceIndex=parseInt(e,10))}_cancelSuggest(){this.activeMenu="none",this._locateFailed=!1,this._showNoResults=!1,this._suggestController=jo(this._suggestController)}_cancelQueries(){this._cancelSuggest(),this._searchController=jo(this._searchController)}_scrollToTopSuggestion(){this._autocompleteNode?.scrollContentTo({top:0})}_formSubmit(t){t.preventDefault(),this.activeMenu="none",this._lastSearchTerm=this.searchTerm,this.searchTerm&&this.search()}_getSourceName(t){const{messages:e}=this,{allSources:r}=this.viewModel,i=r.at(t);return t===_d.ALL_INDEX?e.all:i?.name||e.untitledSource}};a([c()],we.prototype,"_locateFailed",void 0),a([c()],we.prototype,"_showNoResults",void 0),a([c()],we.prototype,"_isDisabled",null),a([c()],we.prototype,"_showCurrentLocation",null),a([c()],we.prototype,"_effectiveActiveMenu",null),a([c()],we.prototype,"activeMenu",null),a([c({readOnly:!0})],we.prototype,"activeSource",null),a([c()],we.prototype,"activeSourceIndex",null),a([c()],we.prototype,"allPlaceholder",null),a([c({readOnly:!0})],we.prototype,"allSources",null),a([c()],we.prototype,"autoNavigate",null),a([c()],we.prototype,"autoSelect",null),a([c({readOnly:!0})],we.prototype,"defaultSources",null),a([c()],we.prototype,"disabled",void 0),a([c()],we.prototype,"goToOverride",null),a([c()],we.prototype,"icon",null),a([c()],we.prototype,"includeDefaultSources",null),a([c()],we.prototype,"label",null),a([c()],we.prototype,"locationEnabled",null),a([c()],we.prototype,"maxResults",null),a([c()],we.prototype,"maxSuggestions",null),a([c(),Vu("esri/widgets/Search/t9n/Search")],we.prototype,"messages",void 0),a([c(),Vu("esri/t9n/common")],we.prototype,"messagesCommon",void 0),a([c()],we.prototype,"minSuggestCharacters",null),a([c()],we.prototype,"popupEnabled",null),a([c()],we.prototype,"popupTemplate",null),a([c()],we.prototype,"portal",null),a([c()],we.prototype,"resultGraphic",null),a([c()],we.prototype,"resultGraphicEnabled",null),a([c({readOnly:!0})],we.prototype,"results",null),a([c()],we.prototype,"searchAllEnabled",null),a([c()],we.prototype,"searchTerm",null),a([c({readOnly:!0})],we.prototype,"selectedResult",null),a([c()],we.prototype,"sources",null),a([c({readOnly:!0})],we.prototype,"suggestions",null),a([c()],we.prototype,"suggestionsEnabled",null),a([c()],we.prototype,"view",null),a([$we(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),c({type:_d})],we.prototype,"viewModel",void 0),we=a([b("esri.widgets.Search")],we);const Twe=we;_e.assetsPath="https://js.arcgis.com/4.30/@arcgis/core/assets";const tz="https://services8.arcgis.com/jzdN07B7ZhRTxuzU/arcgis/rest/services/Streetlights_Inspections/FeatureServer",Mwe=`${tz}/0`,Iwe=`${tz}/1`;document.querySelector("#app").innerHTML=`
  <div id="app-container">
    <div id="sidebar">
      <h2>Streetlight Web Map</h2>
      <p class="subtitle">Internal-style GIS operations viewer</p>

      <div class="section">
        <label style="display:flex; gap:8px; align-items:center;">
          <input id="toggleLayer" type="checkbox" checked />
          <span>Show Streetlights Layer</span>
        </label>
        <div class="info" id="statusText">Loading</div>
      </div>

      <div class="section">
        <div style="font-size:13px; margin-bottom:8px;">Filter</div>
        <select id="priorityFilter">
          <option value="All" selected>All</option>
          <option value="High Priority">High Priority</option>
          <option value="Medium Priority">Medium Priority</option>
          <option value="Low Priority">Low Priority</option>
        </select>

        <button id="clearFilterBtn">Clear filter</button>
        <button id="resetViewBtn">Reset view</button>
      </div>

      <div class="section">
        <label style="display:flex; gap:8px; align-items:center;">
          <input id="clusterToggle" type="checkbox" checked />
          <span>Cluster points</span>
        </label>
        <div class="hint">Tip: Use Search (top-left) to jump to an address.</div>
      </div>
    </div>

    <div id="viewDiv"></div>
  </div>
`;const Ewe=document.getElementById("statusText"),NA=document.getElementById("toggleLayer"),V3=document.getElementById("priorityFilter"),Owe=document.getElementById("clearFilterBtn"),kwe=document.getElementById("resetViewBtn"),rz=document.getElementById("clusterToggle");function wu(t){Ewe.textContent=t}const Cwe={type:"simple",symbol:{type:"simple-marker",style:"circle",size:12,color:[239,68,68,1],outline:{color:[255,255,255,1],width:1.5}}},Lf=new $D({basemap:"streets-navigation-vector"}),z3=new xhe({container:"viewDiv",map:Lf,center:[-96.7026,40.8136],zoom:13}),Pwe=new Twe({view:z3});z3.ui.add(Pwe,"top-left");const Awe={type:"cluster",clusterRadius:"60px",popupTemplate:{title:"Cluster summary",content:"This cluster represents {cluster_count} streetlights."}};function iz(t){t.featureReduction=rz.checked?Awe:null}let mm=null,Ud=null;function Rwe(t){const e=t.fields||[];for(const r of e){const i=r.domain;if(!i||i.type!=="codedValue")continue;const s=i.codedValues||[],n=s.map(d=>String(d.name).toLowerCase()),o=n.some(d=>d.includes("high")),l=n.some(d=>d.includes("medium")||d.includes("med")),u=n.some(d=>d.includes("low"));if(o&&l&&u){mm=r.name;const d={};for(const p of s){const f=String(p.name).toLowerCase();f.includes("high")&&(d["High Priority"]=p.code),(f.includes("medium")||f.includes("med"))&&(d["Medium Priority"]=p.code),f.includes("low")&&(d["Low Priority"]=p.code)}Ud=d,console.log(" Priority field detected:",mm),console.log(" Priority mapping:",Ud);return}}mm=null,Ud=null,console.warn(" No coded priority domain found. Fields:",e.map(r=>r.name))}function DA(t){return typeof t=="number"?String(t):typeof t=="boolean"?t?"1":"0":`'${String(t).replaceAll("'","''")}'`}function sz(t){const e=V3.value;if(e==="All"){t.definitionExpression=null;return}if(mm&&Ud&&Ud[e]!==void 0){const n=Ud[e];t.definitionExpression=`${mm} = ${DA(n)}`;return}const r=["Priority","priority","PRIORITY","OutagePriority","outage_priority"],i=(t.fields||[]).map(n=>n.name),s=r.find(n=>i.includes(n));if(!s){t.definitionExpression=null,wu("Loaded (filter field not found  showing all)");return}t.definitionExpression=`${s} = ${DA(e)}`}async function U3(t){try{const e=t.createQuery();e.where=t.definitionExpression||"1=1",e.returnGeometry=!1;const r=await t.queryFeatureCount(e);wu(`Loaded: ${r} features`)}catch(e){console.error(" Count failed:",e),wu("Loaded (count failed  check console)")}}function Lwe(t){return new K({url:t,outFields:["*"],title:"Streetlights",renderer:Cwe,popupEnabled:!0,popupTemplate:{title:"Streetlight",content:"ObjectID: {OBJECTID}"}})}async function jA(t){const e=Lwe(t);e.on("layerview-create-error",s=>{console.error(" layerview-create-error:",s),wu("Layer view error  open console")}),await e.load();const r=e.createQuery();r.where="1=1",r.returnGeometry=!1;const i=await e.queryFeatureCount(r);return{layer:e,count:i}}let rt=null;async function Fwe(){wu("Loading"),rt&&(Lf.remove(rt),rt=null);try{const t=await jA(Mwe);if(console.log(" Using FeatureServer/0, count:",t.count),rt=t.layer,Lf.add(rt),t.count===0){console.warn(" Layer 0 returned 0 features. Trying layer 1"),Lf.remove(rt);const r=await jA(Iwe);console.log(" Using FeatureServer/1, count:",r.count),rt=r.layer,Lf.add(rt)}await rt.when(),Rwe(rt),iz(rt),sz(rt),await U3(rt),await rt.queryFeatureCount(rt.createQuery())===0&&(console.warn(" Still 0 features. This usually means the layer is not public or requires a token."),wu("Loaded: 0 features (check layer sharing / token)"))}catch(t){console.error(" Failed to init streetlights:",t),wu("Layer failed to load/query  open console")}}NA.addEventListener("change",()=>{rt&&(rt.visible=NA.checked)});V3.addEventListener("change",async()=>{rt&&(sz(rt),await U3(rt))});Owe.addEventListener("click",async()=>{rt&&(V3.value="All",rt.definitionExpression=null,await U3(rt))});kwe.addEventListener("click",()=>{z3.goTo({center:[-96.7026,40.8136],zoom:13})});rz.addEventListener("change",()=>{rt&&iz(rt)});Fwe();export{AK as $,_t as A,x1 as B,rme as C,ime as D,J9 as E,k as F,E as G,wae as H,Lr as I,zt as J,sJ as K,qC as L,j as M,ps as N,p_e as O,Sy as P,f_e as Q,uS as R,sme as S,re as T,pe as U,F as V,m_e as W,al as X,LK as Y,ip as Z,N as _,k3 as a,$e as a$,QQ as a0,lD as a1,zM as a2,hX as a3,a as a4,c as a5,b as a6,RIe as a7,AIe as a8,bi as a9,Kge as aA,Bge as aB,Cge as aC,Rge as aD,Zu as aE,qw as aF,Boe as aG,ly as aH,DK as aI,jK as aJ,VK as aK,q5 as aL,KQ as aM,gae as aN,ID as aO,Nd as aP,ED as aQ,MD as aR,t$e as aS,nk as aT,A$e as aU,nY as aV,TR as aW,Gh as aX,gU as aY,fse as aZ,CZ as a_,H as aa,Hne as ab,nt as ac,iJ as ad,tJ as ae,L as af,P_e as ag,gh as ah,$Ee as ai,N2e as aj,Kh as ak,Wt as al,Cu as am,Dn as an,Age as ao,Qr as ap,Yge as aq,E6 as ar,nae as as,Iae as at,S$ as au,Gge as av,$V as aw,Vge as ax,xV as ay,SV as az,L3e as b,rB as b$,se as b0,Z as b1,tl as b2,hy as b3,Rs as b4,mse as b5,Et as b6,ct as b7,T8 as b8,M8 as b9,T1 as bA,ue as bB,dp as bC,Ywe as bD,GA as bE,TD as bF,hMe as bG,due as bH,Dd as bI,Ph as bJ,Am as bK,He as bL,ys as bM,mT as bN,Fe as bO,Wh as bP,Ar as bQ,gt as bR,ESe as bS,MSe as bT,ISe as bU,Zh as bV,Be as bW,s3e as bX,Fh as bY,u6 as bZ,rR as b_,H3e as ba,Mn as bb,Se as bc,xM as bd,zs as be,ll as bf,Rt as bg,gC as bh,wl as bi,bl as bj,BA as bk,WA as bl,ZA as bm,Hwe as bn,Vwe as bo,A1e as bp,BMe as bq,r3e as br,TOe as bs,EOe as bt,IOe as bu,_Oe as bv,cw as bw,JEe as bx,eOe as by,rOe as bz,Eye as c,Pbe as c$,$be as c0,NL as c1,Kr as c2,gm as c3,ng as c4,SSe as c5,Zj as c6,yi as c7,au as c8,WJ as c9,Nr as cA,hI as cB,nr as cC,dee as cD,Te as cE,eT as cF,Mu as cG,vR as cH,Uf as cI,xc as cJ,ty as cK,le as cL,sOe as cM,nOe as cN,oOe as cO,Sge as cP,_ge as cQ,rr as cR,Y as cS,pge as cT,Ao as cU,hge as cV,NX as cW,PB as cX,RB as cY,AB as cZ,LB as c_,ebe as ca,D6 as cb,Qye as cc,Wbe as cd,Xa as ce,eJ as cf,Hre as cg,e_e as ch,Xbe as ci,kv as cj,Yre as ck,Gre as cl,sl as cm,x4 as cn,Zbe as co,Nu as cp,Jbe as cq,Qbe as cr,Kbe as cs,Ybe as ct,$4 as cu,Lre as cv,Fre as cw,Qa as cx,x3e as cy,V as cz,eI as d,FS as d$,Abe as d0,Bi as d1,z_ as d2,sm as d3,Wle as d4,PTe as d5,ge as d6,RTe as d7,op as d8,Dw as d9,jOe as dA,Vn as dB,C1 as dC,_e as dD,my as dE,S2 as dF,xSe as dG,m$e as dH,L$e as dI,Pn as dJ,EL as dK,X as dL,Gte as dM,MIe as dN,ne as dO,Ot as dP,Zs as dQ,Tr as dR,Ft as dS,eL as dT,f_ as dU,eue as dV,UA as dW,Dpe as dX,B0e as dY,tt as dZ,co as d_,PT as da,Yh as db,yu as dc,Ke as dd,XOe as de,Fu as df,Cj as dg,A2e as dh,Qw as di,cre as dj,Gi as dk,cU as dl,E_e as dm,he as dn,wc as dp,lt as dq,Hi as dr,UL as ds,e0 as dt,Fg as du,sB as dv,ie as dw,U6 as dx,E$ as dy,xue as dz,$3e as e,Cn as e$,aM as e0,C1e as e1,iy as e2,Pr as e3,vh as e4,k1e as e5,Dbe as e6,_6 as e7,b6 as e8,l1e as e9,ML as eA,P$e as eB,rSe as eC,w_e as eD,JA as eE,U5 as eF,ZL as eG,cse as eH,xre as eI,F2e as eJ,sp as eK,CM as eL,Nre as eM,j2e as eN,Ni as eO,S4 as eP,D2e as eQ,M_e as eR,ls as eS,Ow as eT,aae as eU,Zte as eV,qi as eW,D1e as eX,Q7 as eY,q1e as eZ,WU as e_,u1e as ea,nn as eb,dy as ec,Pm as ed,I6 as ee,x6 as ef,Woe as eg,M6 as eh,jT as ei,VT as ej,gB as ek,vB as el,Iw as em,Ew as en,JM as eo,YM as ep,lge as eq,vi as er,c1e as es,N1e as et,zh as eu,mB as ev,zE as ew,FOe as ex,LOe as ey,EQ as ez,B3e as f,tv as f$,pT as f0,zX as f1,o0e as f2,cl as f3,dae as f4,qQ as f5,Hoe as f6,T6 as f7,_ae as f8,x_e as f9,G0e as fA,vfe as fB,mfe as fC,bt as fD,St as fE,Gt as fF,Sr as fG,fi as fH,Gu as fI,jn as fJ,s_e as fK,FJ as fL,wm as fM,Co as fN,Iu as fO,gi as fP,q as fQ,Z0e as fR,gT as fS,TIe as fT,YL as fU,FL as fV,uve as fW,Ov as fX,xe as fY,pr as fZ,vm as f_,pw as fa,fw as fb,xR as fc,Ta as fd,cwe as fe,Ce as ff,SEe as fg,g1e as fh,x1e as fi,gP as fj,_v as fk,rp as fl,L1e as fm,tu as fn,ppe as fo,P0e as fp,N0e as fq,t9 as fr,jpe as fs,hpe as ft,ffe as fu,yfe as fv,Qoe as fw,Xoe as fx,Sae as fy,Ur as fz,j3e as g,IS as g$,Ibe as g0,Mbe as g1,S$e as g2,N$e as g3,Vo as g4,K as g5,No as g6,u7 as g7,Mm as g8,hN as g9,HEe as gA,cd as gB,qo as gC,el as gD,x2e as gE,za as gF,D3e as gG,MR as gH,m7 as gI,m_ as gJ,$Oe as gK,x8 as gL,rl as gM,vQ as gN,Rbe as gO,S1e as gP,ry as gQ,Jme as gR,lpe as gS,PIe as gT,Xpe as gU,CIe as gV,Qpe as gW,yT as gX,Ht as gY,MEe as gZ,Dg as g_,ut as ga,Er as gb,gs as gc,L_e as gd,Th as ge,Y_e as gf,ob as gg,pSe as gh,Hw as gi,mM as gj,yM as gk,hSe as gl,_Se as gm,Jw as gn,EY as go,_ne as gp,ZN as gq,KM as gr,Vpe as gs,yae as gt,$2e as gu,UEe as gv,_2e as gw,py as gx,qt as gy,S2e as gz,hw as h,WK as h$,ud as h0,kw as h1,TSe as h2,Bu as h3,Gne as h4,F_e as h5,R_e as h6,$Se as h7,xK as h8,q_e as h9,iF as hA,Hr as hB,QU as hC,Mme as hD,dEe as hE,oEe as hF,im as hG,Mo as hH,Tme as hI,hEe as hJ,pEe as hK,rK as hL,I_e as hM,BY as hN,hae as hO,zbe as hP,ZI as hQ,HL as hR,WL as hS,dt as hT,T_e as hU,FQ as hV,aD as hW,Eie as hX,iae as hY,uD as hZ,pB as h_,HJ as ha,q_ as hb,ot as hc,sMe as hd,k$e as he,v$e as hf,W_e as hg,gj as hh,K$e as hi,Di as hj,wbe as hk,NK as hl,ib as hm,OIe as hn,oY as ho,qu as hp,JE as hq,ife as hr,Bh as hs,qh as ht,Bt as hu,Fa as hv,FIe as hw,Fbe as hx,$B as hy,NB as hz,_3e as i,GMe as i$,zQ as i0,HK as i1,Zw as i2,HN as i3,jwe as i4,Rg as i5,Qwe as i6,pae as i7,rae as i8,Wge as i9,Sd as iA,XU as iB,Fn as iC,en as iD,z3e as iE,IY as iF,GE as iG,Sve as iH,YZ as iI,Im as iJ,Sh as iK,WEe as iL,_a as iM,C3e as iN,jce as iO,v3e as iP,mde as iQ,Vce as iR,w3e as iS,h3e as iT,d3e as iU,gde as iV,bf as iW,g3e as iX,yue as iY,DMe as iZ,z6 as i_,X4 as ia,y$e as ib,kM as ic,$v as id,u$e as ie,l$e as ig,Oie as ih,tN as ii,Je as ij,hee as ik,U1e as il,iye as im,S7 as io,wT as ip,sye as iq,a0e as ir,ol as is,FX as it,RX as iu,PX as iv,sb as iw,Xr as ix,tD as iy,iN as iz,_7 as j,gS as j$,ew as j0,UMe as j1,lm as j2,qMe as j3,M0 as j4,RMe as j5,Rxe as j6,vN as j7,Em as j8,_S as j9,w as jA,FB as jB,_B as jC,Ln as jD,Rne as jE,WM as jF,JJ as jG,V_e as jH,uv as jI,M1 as jJ,J0 as jK,mK as jL,FK as jM,Yoe as jN,Mae as jO,Eae as jP,eK as jQ,fB as jR,GN as jS,RK as jT,Koe as jU,S6 as jV,d$e as jW,c$e as jX,_r as jY,dM as jZ,cM as j_,ZY as ja,_N as jb,Dx as jc,__e as jd,yMe as je,R1e as jf,Eq as jg,NO as jh,Vh as ji,Um as jj,npe as jk,Zr as jl,hbe as jm,whe as jn,jo,lT as jp,o7 as jq,B_e as jr,mQ as js,WY as jt,kd as ju,wN as jv,sr as jw,o1e as jx,i6 as jy,pM as jz,A3e as k,F0e as k$,H_e as k0,iSe as k1,Le as k2,QE as k3,f7 as k4,JN as k5,uIe as k6,Lt as k7,j1e as k8,QD as k9,WTe as kA,HTe as kB,JY as kC,dI as kD,BTe as kE,qT as kF,lH as kG,vJ as kH,rT as kI,r1e as kJ,iT as kK,i1e as kL,by as kM,Od as kN,vne as kO,I7 as kP,HMe as kQ,_q as kR,tbe as kS,TEe as kT,xEe as kU,G9 as kV,U9 as kW,fy as kX,jM as kY,Eu as kZ,vw as k_,UG as ka,U3e as kb,hK as kc,tEe as kd,VSe as ke,LSe as kf,_ve as kg,pn as kh,e1e as ki,t1e as kj,Xwe as kk,Uu as kl,GU as km,Tw as kn,qs as ko,lye as kp,u9 as kq,MX as kr,IX as ks,TL as kt,KTe as ku,YTe as kv,JTe as kw,ZTe as kx,XTe as ky,QTe as kz,CEe as l,i3e as l$,Jpe as l0,k0e as l1,nfe as l2,Y0e as l3,BO as l4,p4 as l5,dve as l6,rye as l7,_fe as l8,w1 as l9,$6 as lA,v_e as lB,wne as lC,AMe as lD,nH as lE,hH as lF,sy as lG,Ube as lH,KG as lI,xT as lJ,abe as lK,obe as lL,TJ as lM,Aq as lN,Pq as lO,X_e as lP,J_e as lQ,eu as lR,a7 as lS,Fs as lT,kye as lU,rfe as lV,Pme as lW,z9 as lX,Ume as lY,oR as lZ,pR as l_,MA as la,Ye as lb,ax as lc,v1 as ld,v0e as le,My as lf,pfe as lg,xn as lh,rve as li,$7 as lj,xw as lk,Nw as ll,d1e as lm,UM as ln,g$e as lo,f$e as lp,yO as lq,Sn as lr,Hm as ls,I3 as lt,bfe as lu,wfe as lv,gfe as lw,goe as lx,voe as ly,B8 as lz,PJ as m,Ece as m$,Me as m0,Jh as m1,Tt as m2,Ge as m3,ji as m4,jr as m5,qme as m6,Wme as m7,A9 as m8,S3 as m9,_c as mA,c_e as mB,xN as mC,$N as mD,bK as mE,Kg as mF,eN as mG,nSe as mH,gM as mI,$c as mJ,ZSe as mK,JSe as mL,YSe as mM,vSe as mN,ySe as mO,dSe as mP,UY as mQ,mSe as mR,vK as mS,n_e as mT,j_e as mU,WSe as mV,dxe as mW,fu as mX,Gwe as mY,uY as mZ,bce as m_,ow as ma,hfe as mb,qe as mc,Qme as md,kme as me,Cme as mf,Rme as mg,Lme as mh,Hme as mi,Fme as mj,Nme as mk,Dme as ml,jme as mm,Vme as mn,zme as mo,er as mp,Tbe as mq,Ym as mr,ap as ms,$y as mt,Ie as mu,tM as mv,Vu as mw,Z3e as mx,ms as my,EI as mz,N3e as n,GQ as n$,vU as n0,v1e as n1,nR as n2,yw as n3,$1e as n4,yC as n5,QJ as n6,KJ as n7,Xv as n8,nN as n9,$Y as nA,qa as nB,Fue as nC,QOe as nD,Due as nE,jue as nF,VR as nG,b2e as nH,$n as nI,OEe as nJ,Z9 as nK,MT as nL,kc as nM,Vt as nN,JOe as nO,rd as nP,A0e as nQ,Ci as nR,GEe as nS,fEe as nT,foe as nU,iMe as nV,q3e as nW,n1e as nX,Mie as nY,LQ as nZ,NQ as n_,aMe as na,nMe as nb,oMe as nc,cue as nd,iEe as ne,sEe as nf,rEe as ng,rn as nh,Ka as ni,Du as nj,zse as nk,NN as nl,U_e as nm,Ob as nn,Km as no,V1e as np,IEe as nq,I_ as nr,Npe as ns,aw as nt,Gw as nu,BSe as nv,GSe as nw,dN as nx,uN as ny,_Y as nz,Iye as o,ace as o$,Wr as o0,go as o1,Ia as o2,Pt as o3,Yie as o4,Wp as o5,$oe as o6,UTe as o7,Ro as o8,Hf as o9,YQ as oA,sae as oB,JQ as oC,LL as oD,Aie as oE,bN as oF,S_e as oG,sM as oH,IR as oI,w1e as oJ,fS as oK,oie as oL,a1e as oM,o4 as oN,wS as oO,mxe as oP,fxe as oQ,bne as oR,T3 as oS,Rfe as oT,GT as oU,xbe as oV,lM as oW,rc as oX,pU as oY,j_ as oZ,FMe as o_,Bme as oa,M2e as ob,eye as oc,_Ee as od,KN as oe,bEe as of,pm as og,Ga as oh,Tm as oi,W0e as oj,HA as ok,y1e as ol,mR as om,JL as on,lI as oo,OR as op,lce as oq,DEe as or,Wu as os,En as ot,rge as ou,O_e as ov,p$e as ow,h$e as ox,dT as oy,XQ as oz,nl as p,xa as p$,NMe as p0,LMe as p1,j6 as p2,o3 as p3,bme as p4,aEe as p5,Br as p6,YY as p7,kp as p8,y_e as p9,j3 as pA,ou as pB,Da as pC,eM as pD,F1e as pE,Jwe as pF,r6 as pG,xOe as pH,EMe as pI,IMe as pJ,VTe as pK,zTe as pL,Bj as pM,a6 as pN,Lh as pO,In as pP,fM as pQ,oN as pR,uy as pS,I1e as pT,qj as pU,_y as pV,cp as pW,et as pX,kfe as pY,Ofe as pZ,Ee as p_,nue as pa,l4 as pb,T2e as pc,Fye as pd,tOe as pe,MMe as pf,ZEe as pg,gMe as ph,aA as pi,GIe as pj,QG as pk,K4 as pl,BIe as pm,Ri as pn,$o as po,kh as pp,Fpe as pq,Ype as pr,Kpe as ps,sfe as pt,x0e as pu,L0e as pv,Q$e as pw,X$e as px,exe as py,Ys as pz,b1e as q,$ne as q$,Jfe as q0,k9 as q1,Hs as q2,Ws as q3,_o as q4,hxe as q5,Wb as q6,a_e as q7,Rv as q8,Ui as q9,fs as qA,a1 as qB,zoe as qC,rbe as qD,t6 as qE,s6 as qF,Kne as qG,Fxe as qH,ooe as qI,Nxe as qJ,TQ as qK,u_e as qL,Nbe as qM,Po as qN,Gr as qO,h_e as qP,E1e as qQ,Jle as qR,YJ as qS,Wwe as qT,qwe as qU,XA as qV,Cbe as qW,kbe as qX,C_e as qY,SR as qZ,Dse as q_,bae as qa,kY as qb,Sv as qc,Lbe as qd,fY as qe,o_e as qf,ir as qg,tr as qh,l0e as qi,D$e as qj,z$e as qk,F$e as ql,u0e as qm,Oq as qn,P1e as qo,ul as qp,nF as qq,gne as qr,CY as qs,PY as qt,Yg as qu,z_e as qv,lL as qw,vY as qx,wY as qy,che as qz,de as r,cA as r$,Gj as r0,J6 as r1,s1e as r2,SMe as r3,$Me as r4,xMe as r5,TMe as r6,uMe as r7,dMe as r8,cMe as r9,k2e as rA,R2e as rB,Rr as rC,e3e as rD,gEe as rE,iI as rF,I2e as rG,GJ as rH,pOe as rI,N_e as rJ,eY as rK,G_e as rL,U$e as rM,poe as rN,aOe as rO,MOe as rP,lOe as rQ,SOe as rR,us as rS,COe as rT,K_e as rU,lMe as rV,gOe as rW,yOe as rX,wOe as rY,bOe as rZ,uA as r_,Nue as ra,aB as rb,t_e as rc,pxe as rd,Tce as re,sL as rf,Obe as rg,Ebe as rh,CB as ri,Mce as rj,_ce as rk,RSe as rl,g1 as rm,ROe as rn,jTe as ro,Hl as rp,EIe as rq,Bte as rr,w2e as rs,yEe as rt,mie as ru,L2e as rv,E2e as rw,C2e as rx,O2e as ry,P2e as rz,x as s,f3e as s$,dA as s0,mOe as s1,fOe as s2,is as s3,vMe as s4,GB as s5,qB as s6,jbe as s7,Qq as s8,OOe as s9,a8 as sA,bh as sB,_Me as sC,Xle as sD,_1e as sE,KY as sF,YK as sG,FY as sH,tSe as sI,wxe as sJ,nX as sK,cN as sL,VN as sM,nL as sN,am as sO,T1e as sP,sX as sQ,QSe as sR,yge as sS,eSe as sT,KX as sU,mC as sV,dU as sW,Uwe as sX,zwe as sY,yK as sZ,Wre as s_,kOe as sa,uOe as sb,XEe as sc,vOe as sd,dOe as se,Tge as sf,cOe as sg,jx as sh,mMe as si,xge as sj,Ige as sk,fMe as sl,iOe as sm,Sue as sn,pMe as so,qTe as sp,GTe as sq,wMe as sr,bMe as ss,OMe as st,kMe as su,eMe as sv,CMe as sw,PMe as sx,uue as sy,pue as sz,cve as t,GY as t$,m3e as t0,e1 as t1,ja as t2,tie as t3,p3e as t4,Lm as t5,Nm as t6,Rh as t7,Jre as t8,h1e as t9,Yr as tA,yU as tB,Tae as tC,Bwe as tD,E$e as tE,O$e as tF,tK as tG,mX as tH,fX as tI,jN as tJ,MV as tK,Jte as tL,VQ as tM,DQ as tN,jQ as tO,tX as tP,pX as tQ,_V as tR,FSe as tS,mne as tT,HQ as tU,Lxe as tV,Axe as tW,G3e as tX,V3e as tY,F3e as tZ,VEe as t_,Sfe as ta,lie as tb,uie as tc,DM as td,j8 as te,PA as tf,$we as tg,VMe as th,zMe as ti,b_e as tj,jMe as tk,t3e as tl,QMe as tm,XMe as tn,KMe as to,YMe as tp,Rue as tq,Z6 as tr,rMe as ts,tMe as tt,Cue as tu,DTe as tv,fSe as tw,xo as tx,bS as ty,sSe as tz,kEe as u,Q_e as u$,oSe as u0,uSe as u1,wSe as u2,aSe as u3,cSe as u4,bSe as u5,wK as u6,hv as u7,zEe as u8,qEe as u9,M1e as uA,Sg as uB,pO as uC,e$e as uD,Us as uE,nEe as uF,hr as uG,Nx as uH,eke as uI,Ixe as uJ,x$e as uK,PQ as uL,QEe as uM,fd as uN,Cie as uO,g_e as uP,s$e as uQ,b$e as uR,$_e as uS,TY as uT,kie as uU,hF as uV,mF as uW,jSe as uX,M$e as uY,DSe as uZ,NSe as u_,n0e as ua,wQ as ub,D_e as uc,yy as ud,gy as ue,vy as uf,LIe as ug,rne as uh,Mxe as ui,Zfe as uj,pc as uk,yme as ul,R$e as um,_$e as un,T$e as uo,$$e as up,p1e as uq,W$e as ur,H$e as us,Kwe as ut,w$e as uu,Z_e as uv,C$e as uw,Fte as ux,xoe as uy,f6 as uz,ee as v,SM as v0,O1e as v1,I$e as v2,UQ as v3,Iie as v4,eX as v5,OSe as v6,CSe as v7,n3e as v8,XIe as v9,mEe as va,KOe as vb,d_e as w,Ae as x,We as y,oye as z};
