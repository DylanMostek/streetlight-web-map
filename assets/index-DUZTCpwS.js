const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ElevationLayer-HWWZveyi.js","assets/ArcGISCachedService-DZeMeiXQ.js","assets/TileInfoTilemapCache-DROs8pCg.js","assets/TilemapCache-BEYUTl1p.js","assets/memoryEstimations-Q8BgqXz3.js","assets/WorkerHandle-B8_rgAHm.js","assets/portalLayers-Cg2Dfb0s.js","assets/associatedFeatureServiceUtils-gaSpyTF3.js","assets/fetchService-BqRiYXDi.js","assets/loadUtils-BZstyzw3.js","assets/lazyLayerLoader-CDraDpfi.js","assets/arcgisLayers-DRXE11Cu.js","assets/layersCreator-BEKV_G8I.js","assets/ElevationQuery-CjH_9s09.js","assets/GeometryDescriptor-D114q_t7.js","assets/projectOperator-Cerll4jP.js","assets/operatorProject-DUZD155Y.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/projectOperator-VISE7Qa5.js","assets/statsWorker-BnBK0FRH.js","assets/utils-DR09OHLI.js","assets/quantizationUtils-Bh5pLjQD.js","assets/utils-BY52eTYC.js","assets/utils-DFDcmd_3.js","assets/ClassBreaksDefinition-B17S-N1z.js","assets/geometryEngineWorker-BkMQzpX8.js","assets/geometryEngineJSON-B_JiqPb-.js","assets/geometryEngineBase-BQTefT4Y.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/CSVSourceWorker-D4AIwthH.js","assets/date-DCujAECq.js","assets/OptimizedFeature-5aCabYHq.js","assets/FeatureStore-Bo2ch1oJ.js","assets/featureConversionUtils-fAWQ9-RF.js","assets/OptimizedFeatureSet-BR8EEvDc.js","assets/BoundsStore-8TwUecJ5.js","assets/PooledRBush-2qqEVKts.js","assets/timeSupport-CTrd7SwY.js","assets/queryUtils-BwXFruhU.js","assets/optimizedFeatureQueryEngineAdapter-BNwH84Nn.js","assets/QueryEngine-DsNvevhp.js","assets/WhereClauseCache-MPPL4SEJ.js","assets/WhereClause-DenswbY8.js","assets/QueryEngineCapabilities-DJC_YILC.js","assets/SnappingCandidate-DGkpYqI6.js","assets/FixedIntervalBinParameters-DBdyAh-T.js","assets/number-CBfdLus3.js","assets/locationUtils-Cdwb_ey5.js","assets/clientSideDefaults-D0iJQYCp.js","assets/EdgeProcessingWorker-DxvLKpwV.js","assets/workerHelper-BO3Zd1w8.js","assets/InterleavedLayout-DT1v80bt.js","assets/BufferView-BD5gUzyI.js","assets/types-BKo2foNY.js","assets/VertexElementDescriptor-BLyltQyJ.js","assets/VertexAttributeLocations-BfZbt_DV.js","assets/edgeProcessing-TvJ4PQux.js","assets/deduplicate-BjmkRxU7.js","assets/Indices-nCmC_6aN.js","assets/Normals-CtvWzcRL.js","assets/ElevationSamplerWorker-BYHIc4h-.js","assets/MeshLocalVertexSpace-DhRHhz-6.js","assets/vertexSpaceConversion-203zZ3ot.js","assets/spatialReferenceEllipsoidUtils-BVzWJLTu.js","assets/computeTranslationToOriginAndRotation-CQOQaU66.js","assets/projectPointToVector-DlQnRgsi.js","assets/meshVertexSpaceUtils-63CswkRg.js","assets/vec3-CEEpE_Q3.js","assets/vec4-D62a7RVV.js","assets/FeatureServiceSnappingSourceWorker-Bhzyx-yk.js","assets/symbologySnappingCandidates-CGwltkay.js","assets/pbfQueryUtils-ByQrNyEu.js","assets/pbf-B6x87M2D.js","assets/query-DQfSEI5S.js","assets/GeoJSONSourceWorker-DOVOMDKk.js","assets/geojson-BpMctJIw.js","assets/sourceUtils-8Ca0oEb8.js","assets/MemorySourceWorker-C9uC2a-b.js","assets/objectIdUtils-BmFjqQA3.js","assets/PBFDecoderWorker-Dypgvcmb.js","assets/dehydratedFeatures-DiKye93s.js","assets/FeaturePipelineWorker-CE_N_NaB.js","assets/AttributeStore-DUxLpStD.js","assets/Utils-CN6uVJdH.js","assets/BoundingBox-xPTgP2_P.js","assets/UpdateTracking2D-BCKV7l_p.js","assets/FeatureStoreQueryAdapter-B4CMFSVV.js","assets/labelPoint-Bi4VDfh8.js","assets/constants-BBnGEY1d.js","assets/streamLayerUtils-DFlbJ4P1.js","assets/MeshWriterRegistry-BffffGAb.js","assets/rasterizingUtils-CjNt593S.js","assets/CIMSymbolHelper-BjmnjfTQ.js","assets/BidiEngine-BvER9tXK.js","assets/GeometryUtils-eI5ExZrp.js","assets/Rect-CUzevAry.js","assets/TexturedLineMeshWriter-BMOulhtZ.js","assets/TurboLine-2xrIn3Vf.js","assets/grouping-CuTpqffH.js","assets/QueueProcessor-9uNcUb7f.js","assets/FeatureMetadata-CCb2rFkM.js","assets/SourceChunkStore-BiUiRt-i.js","assets/parquet-D7rX6I-r.js","assets/operatorGeodeticDensify-DHQhZ0zE.js","assets/geodeticCurveType-CirnHLSB.js","assets/normalizeUtilsSync-CSpxZkB7.js","assets/FeatureIdInfo-B2PD5zcu.js","assets/ogcFeatureUtils-CXPOTz5y.js","assets/CircularArray-CujHzHWW.js","assets/createConnection-BlAYGPJs.js","assets/PointCloudWorker-B4qS1_e9.js","assets/quat-DLTWWwDE.js","assets/quatf64-aQ5IuZRd.js","assets/vec3f32-WCVSSNPR.js","assets/PointCloudUniqueValueRenderer-DiWPFUgn.js","assets/I3SBinaryReader-DTwlQBot.js","assets/orientedBoundingBox-htZ9ZVwR.js","assets/plane-Ca-doYiU.js","assets/vectorStacks-CTU8_AZd.js","assets/RasterWorker-8Xi1yupn.js","assets/PixelBlock-DlyyK6EO.js","assets/RasterSymbolizer-DyVcDkgb.js","assets/vectorFieldUtils-CZnmhLcJ.js","assets/colorUtils-CqUiD5Av.js","assets/rasterFunctionHelper-DoMOHCYK.js","assets/clipUtils-D9OmMTyT.js","assets/rasterProjectionHelper-DKyoXCUw.js","assets/PolynomialTransform-DyE3oaVf.js","assets/dataUtils-DcRGg4Lv.js","assets/SceneLayerSnappingSourceWorker-BPKCO35g.js","assets/lineSegment-Dff-R9Sk.js","assets/sphere-C6ttXJGf.js","assets/Octree-W2lJZEJW.js","assets/frustum-UiiahH8_.js","assets/SceneLayerWorker-D2IZWqI3.js","assets/projectVectorToVector-CjJgAlIs.js","assets/WFSSourceWorker-C7pJzb94.js","assets/wfsUtils-BatFZZ8j.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-BBC_HAvy.js","assets/constants-BHYAGdRm.js","assets/config-BOD8--da.js","assets/SourceLayerData-DZ5eieqc.js","assets/StyleRepository-C6MplgG-.js","assets/earcut-D9gy186-.js","assets/Feature3DPipelineWorker-IlSGpVpD.js","assets/HUDMaterial.glsl-BIWClM-0.js","assets/hydratedFeatures-CClK0G4y.js","assets/OutputColorHighlightOID.glsl-Bg7KRyMj.js","assets/triangle-CNcLxxzf.js","assets/renderState-CKc66y4x.js","assets/glsl-B5bJgrnA.js","assets/ShaderBuilder-BywBVDxB.js","assets/placementUtils-Buk5A2w4.js","assets/sdfPrimitives-D2pP54Ma.js","assets/Texture-BSKeBQAs.js","assets/videoUtils-VcyGGJYs.js","assets/requestImageUtils-CVsFgECZ.js","assets/RealisticTree.glsl-DDmENOEN.js","assets/DefaultMaterial-Rckoefxy.js","assets/VertexBuffer-DOyWLBlU.js","assets/BufferObject-b0xockws.js","assets/boundedPlane-CGvHVb-S.js","assets/FlowWorker-bE1G6TOV.js","assets/ParquetSourceWorker-B9IXp_x_.js","assets/parquetUtils-B0FxLEz3.js","assets/PanoramicMeshWorker-C13pwgGO.js","assets/Popup-Ck-NcCFx.js","assets/throttle-C-1Hj4-Z.js","assets/unitFormatUtils-CNDd6EXr.js","assets/quantityUtils-BmqTCiFW.js","assets/AttachmentInfo-DAnn-6rS.js","assets/featureUtils-P7c0_6a4.js","assets/utils-DBxEiDoA.js","assets/cimSymbolUtils-CtKYJLVm.js","assets/executeQueryJSON-BvG5A90j.js","assets/shared-CgMFz1td.js","assets/isImageryGraphicOrigin-Ccuhb4eK.js","assets/isImageryTileGraphicOrigin-ZR-gBf9D.js","assets/NetworkElement-uxEBgUvM.js","assets/ReactiveSet-DsVscx2Y.js","assets/symbolUtils-D9Y5uhFE.js","assets/arcadeUtils-BYxWU4IU.js","assets/arcade-FkFRImBg.js","assets/arcadeEnvironment-BtULFiEH.js","assets/Dictionary-DIE2H18H.js","assets/ImmutableArray-BPVd6ESQ.js","assets/Feature-CUGzHqgS.js","assets/aiServices-BoAwI5HK.js","assets/unitConversion-CXdS2dcF.js","assets/rasterFieldUtils-DLudkJOj.js","assets/batchExec-B9WTAYuI.js","assets/webStyleSymbolUtils-B_AulekT.js","assets/devEnvironmentUtils-8WtPGj6h.js","assets/webglDeps-k3PfyBd5.js","assets/FramebufferObject-a_gVaGeo.js","assets/ProgramTemplate-DT7tniBe.js","assets/VertexArrayObject-BM8pLEiM.js","assets/mapViewDeps-C99TyUM3.js","assets/FeatureCommandQueue-CgbJ1DIV.js","assets/GraphShaderModule-BqCWX6of.js","assets/utils-CHVMR5W_.js","assets/WGLContainer-C81nSCI-.js","assets/Container-DmyzfY2Z.js","assets/SDFHelper-DGuFDwhL.js","assets/OverrideHelper-BVVS96oC.js","assets/callExpressionWithFeature-CZJ_cI1V.js","assets/GridShader-C4rSksOb.js","assets/testSVGPremultipliedAlpha-DgriiGdk.js","assets/SymbolFader-at8DBt5Q.js","assets/RenderingContext-DMQHPDPE.js","assets/CIMResourceManager-8wy_cx5g.js","assets/utils-DOjr8OwN.js","assets/utils-DDjZAYSk.js","assets/GraphicsView2D-BU-EY09e.js","assets/GraphicContainer-DOBxuaDV.js","assets/AGraphicContainer-PezizYJQ.js","assets/TechniqueInstance-DzJlXfrI.js","assets/TileContainer-Lt4YPEor.js","assets/gridUtils-BtD0fHLb.js","assets/geodesicUtils-BS8Yqlea.js","assets/TileLayerView2D-DTSxT-Mw.js","assets/imageUtils-2py5hIXJ.js","assets/BitmapTechnique-B8PBnRxr.js","assets/bitmapUtils-CtexybUN.js","assets/LayerView2D-DStezG5-.js","assets/HighlightGraphicContainer-BqDS04le.js","assets/LayerView-I4bCKuGe.js","assets/RefreshableLayerView-AWBQ4XZw.js","assets/MapServiceLayerViewHelper-DMtvDjZw.js","assets/floorFilterUtils-DKzVzLpH.js","assets/drapedUtils-Cpfou1XU.js","assets/sublayerUtils-BEQnBRaB.js","assets/popupUtils-azDjauQI.js","assets/highlightOptionsUtils-OA8Ttt0i.js","assets/FeatureLayerView2D-BT5n2D8K.js","assets/timeSupport-B2v7OmG1.js","assets/AttributeBinsFeatureSet-sFG4KRqK.js","assets/AttributeBinsQuery-Dk5u1ssg.js","assets/constants-SxxbBSOD.js","assets/BaseDynamicLayerView2D-DMf3-c73.js","assets/BitmapContainer-CT7KgFdh.js","assets/ExportStrategy-CHrpNvuu.js","assets/CatalogLayerView2D-GIQZhZUV.js","assets/CatalogDynamicGroupLayerView2D-BE3-gmTz.js","assets/CatalogFootprintLayerView2D-DwhePhh_.js","assets/GeoRSSLayerView2D-CRzkbMeu.js","assets/GraphicsLayerView2D-IPyuIkXo.js","assets/GroupLayerView2D-C4g95uzX.js","assets/ImageryLayerView2D-CuLis2un.js","assets/RasterVFDisplayObject-B8FyzhKB.js","assets/ImageryTileLayerView2D-CzXOILYW.js","assets/datasetUtils-tdUq-ach.js","assets/rasterUtils-DQM5iOGl.js","assets/RawBlockCache-DwZxrWUZ.js","assets/KMLLayerView2D-BbTz5Jsq.js","assets/kmlUtils-CC8bdMFo.js","assets/KnowledgeGraphLayerView2D-LN7a8epb.js","assets/MapImageLayerView2D-Dl6ubmBK.js","assets/ExportImageParameters-DXM8cO5R.js","assets/MapNotesLayerView2D-C9soGUVb.js","assets/MediaLayerView2D-3bulBHRV.js","assets/mediaLayerUtils-B1x4VDdG.js","assets/OverlayContainer-MD0r14aW.js","assets/OGCFeatureLayerView2D-CMIvhaF8.js","assets/RouteLayerView2D-CAN_6_Mw.js","assets/Stop-Cl5Hu9_D.js","assets/networkEnums-BPviFRgw.js","assets/StreamLayerView2D-BsIfaGCo.js","assets/SubtypeGroupLayerView2D-D_f0vfm-.js","assets/VectorTileLayerView2D-CUkepym1.js","assets/VideoLayerView2D-1-kWZAVY.js","assets/GraphicsLayer-BBvMhsol.js","assets/videoUtils-Bqm79v91.js","assets/ControlPoint-2IE2naOo.js","assets/WMSLayerView2D-Bsrlxr3W.js","assets/ExportWMSImageParameters-BoeZduZj.js","assets/WMTSLayerView2D-BySrRSBF.js","assets/ElevationProfileAnalysisView2D-Dx7DFNGw.js","assets/createUtils-BvptrE3r.js","assets/distanceOperator-BQPBPpik.js","assets/Point2D-CE_8fSwp.js","assets/Distance2DCalculator-CXhBP-8I-zdPeUB8j.js","assets/ProjectionTransformation-nIs2nsm9.js","assets/Envelope2D-B-iKXdqf.js","assets/Transformation2D-DQXtCBWc.js","assets/OperatorDefinitions-DP7_WWTp.js","assets/apiConverter-zY5DH558.js","assets/jsonConverter-rqbFUzwl.js","assets/simplifyOperator-BRKZR5V5.js","assets/operatorSimplify-CwzQjRzz.js","assets/mapCollectionUtils-BDEbqsP_.js","assets/elevationInfoUtils-B6Ify9F7.js","assets/getDefaultUnitForView-CCI2pENU.js","assets/SketchViewModel-CqSjSu7i.js","assets/hitTestSelectUtils-DPWprv9r.js","assets/geodeticLengthOperator-CcUGsPte.js","assets/apng-BU8upGLc.js","assets/index-B0oBcKDl.js","assets/index-BpQEx_Tk.js","assets/guid-LcV_DAvu.js","assets/useT9n-BlowEu4U.js","assets/index-BtnEvgmD.js","assets/index-DB3XEWBz.js","assets/dom-BF-PY0FG.js","assets/observers-BzDon8NM.js","assets/ref-CZP40pp7.js","assets/static-jTuwRkcH.js","assets/form-CJkp14jH.js","assets/interactive-BA9uSKAU.js","assets/label-DotSI45l.js","assets/component-DUVr6ap7.js","assets/useSetFocus-DOrdlKTR.js","assets/layersLoader-DVIXxcyw.js","assets/jsonContext-BdEuF0Nn.js","assets/featureLayerUtils-CEwBzlPJ.js","assets/originUtils-Bvi-pJH2.js","assets/utils-DPMAdkcP.js","assets/saveUtils-DdxK6tfA.js","assets/FeatureLayerSource-sZYUGFwk.js","assets/External-D3_07izR.js","assets/MeshTransform-i0afCcZL.js","assets/axisAngleDegrees-BYBrYAVK.js","assets/editingSupport-CW7VabYY.js","assets/QueryTask-TtSQ7LCa.js","assets/executeForIds-DxSevTkQ.js","assets/index-C1awwGCk.js","assets/customElement-D8TZTb7O.js","assets/index-2anqfirs.js","assets/floating-ui-BQOyk70C.js","assets/debounce-D0Dr7phT.js","assets/key-Cyh_1epf.js","assets/openCloseComponent-BkasxXrW.js","assets/dynamicClasses-6uzzLOUQ.js","assets/index-tctCdXPk.js","assets/keyed-DhSX3f9D.js","assets/index-DIsXsLJN.js","assets/resources7-v6zOX8CA.js","assets/index-DbOvxA8w.js","assets/_sortable-BtHGJ1RC.js","assets/customElement-CTvOX7ny.js","assets/FloatingArrow-M7HRHk2g.js","assets/index-BI5GxQgU.js","assets/index-CTskOUZp.js","assets/index-DpAxToC1.js","assets/escapeRegExp-CkRNPaSc.js","assets/useCancelable-CTTkoKSE.js","assets/utils2-CQO7k-Nf.js","assets/index-BiXHCN3-.js","assets/resources5-DhgIM17F.js","assets/index-CcAMG5K3.js","assets/index-Db5Q8yTA.js","assets/index-D44McEJw.js","assets/index-CxvW438j.js"])))=>i.map(i=>d[i]);
var tU=Object.getPrototypeOf;var rU=Reflect.get;var J3=t=>{throw TypeError(t)};var Ib=(t,e,r)=>e.has(t)||J3("Cannot "+r);var je=(t,e,r)=>(Ib(t,e,"read from private field"),r?r.call(t):e.get(t)),Ss=(t,e,r)=>e.has(t)?J3("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),$s=(t,e,r,i)=>(Ib(t,e,"write to private field"),i?i.call(t,r):e.set(t,r),r),hp=(t,e,r)=>(Ib(t,e,"access private method"),r);var Y3=(t,e,r)=>rU(tU(t),r,e);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();let Ca;const or=globalThis;function k(t){return typeof Ca[t]=="function"?Ca[t]=Ca[t](or):Ca[t]}Ca=or.dojoConfig?.has||or.esriConfig?.has?{...or.dojoConfig?.has,...or.esriConfig?.has}:{},k.add=(t,e,r,i)=>{(i||Ca[t]===void 0)&&(Ca[t]=e),r&&k(t)},k.cache=Ca,k.add("big-integer-warning-enabled",!0),k.add("esri-deprecation-warnings",!0),k.add("esri-tests-disable-screenshots",!1),k.add("esri-tests-use-full-window",!1),k.add("esri-tests-post-to-influx",!0),k.add("esri-cim-animations-enable-status","enabled"),k.add("esri-cim-animations-spotlight",!1),k.add("esri-cim-animations-freeze-time",!1),(()=>{k.add("host-webworker",or.WorkerGlobalScope!==void 0&&self instanceof or.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(k.add("host-browser",t),k.add("host-node",!(typeof or.process!="object"||!or.process.versions?.node||!or.process.versions.v8)),k.add("dom",t),k("host-browser")){const e=navigator,r=e.userAgent,i=e.appVersion,s=parseFloat(i);if(k.add("wp",parseFloat(r.split("Windows Phone")[1])||void 0),k.add("msapp",parseFloat(r.split("MSAppHost/")[1])||void 0),k.add("khtml",i.includes("Konqueror")?s:void 0),k.add("edge",parseFloat(r.split("Edge/")[1])||void 0),k.add("opr",parseFloat(r.split("OPR/")[1])||void 0),k.add("webkit",!k("wp")&&!k("edge")&&parseFloat(r.split("WebKit/")[1])||void 0),k.add("chrome",!k("edge")&&!k("opr")&&parseFloat(r.split("Chrome/")[1])||void 0),k.add("android",!k("wp")&&parseFloat(r.split("Android ")[1])||void 0),k.add("safari",!i.includes("Safari")||k("wp")||k("chrome")||k("android")||k("edge")||k("opr")?void 0:parseFloat(i.split("Version/")[1])),k.add("mac",i.includes("Macintosh")),!k("wp")&&/(iPhone|iPod|iPad)/.test(r)){const n=RegExp.$1.replace(/P/,"p"),o=/OS ([\d_]+)/.test(r)?RegExp.$1:"1",l=parseFloat(o.replace(/_/,".").replaceAll("_",""));k.add(n,l),k.add("ios",l)}k("webkit")||(!r.includes("Gecko")||k("wp")||k("khtml")||k("edge")||k.add("mozilla",s),k("mozilla")&&k.add("ff",parseFloat(r.split("Firefox/")[1]||r.split("Minefield/")[1])||void 0))}})(),(()=>{if(or.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),r=/iPhone/i.test(t);e&&k.add("esri-mobile",e),r&&k.add("esri-iPhone",r),k.add("esri-geolocation",!!navigator.geolocation)}k.add("esri-wasm","WebAssembly"in or),k.add("esri-performance-mode-frames-between-render",20),k.add("esri-force-performance-mode",!1),k.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in or,e=or.crossOriginIsolated===!1;return t&&!e}),k.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),k.add("esri-atomics","Atomics"in or),k.add("esri-workers","Worker"in or),k.add("web-feat:cache","caches"in or),k.add("esri-workers-arraybuffer-transfer",!k("safari")||Number(k("safari"))>=12),k.add("workers-pool-size",8),k.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),k.add("featurelayer-simplify-payload-size-factors",[1,1,4]),k.add("featurelayer-fast-triangulation-enabled",!0),k.add("featurelayer-animation-enabled",!0),k.add("featurelayer-snapshot-enabled",!0),k.add("featurelayer-snapshot-initial-tolerance",0),k.add("featurelayer-snapshot-point-min-threshold",8e4),k.add("featurelayer-snapshot-point-max-threshold",4e5),k.add("featurelayer-snapshot-multipoint-min-threshold",2e4),k.add("featurelayer-snapshot-multipoint-max-threshold",1e5),k.add("featurelayer-snapshot-polygon-min-threshold",2e3),k.add("featurelayer-snapshot-polygon-max-threshold",2e3),k.add("featurelayer-snapshot-polyline-min-threshold",2e3),k.add("featurelayer-snapshot-polyline-max-threshold",2e3),k.add("featurelayer-snapshot-max-vertex-count",25e4),k.add("featurelayer-snapshot-non-hosted-exceedslimit-enabled",!0),k.add("featurelayer-snapshot-concurrency",4),k.add("featurelayer-snapshot-coverage",.1),k.add("featurelayer-query-max-depth",4),k.add("featurelayer-query-pausing-enabled",!1),k.add("featurelayer-query-tile-concurrency",4),k.add("featurelayer-query-tile-max-features",6e5),k.add("featurelayer-advanced-symbols",!1),k.add("featurelayer-pbf",!0),k.add("featurelayer-pbf-statistics",!1),k.add("feature-layers-workers",!0),k.add("feature-polyline-generalization-factor",1),k.add("parquetlayer-full-query-feature-count",2e4),k.add("parquetlayer-hittest-max-feature-count",1),k.add("parquetlayer-persistence-enabled",!1),k.add("mapview-transitions-duration",200),k.add("mapview-essential-goto-duration",200),k.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),k.add("mapserver-pbf-version-support",10.81),k.add("mapservice-popup-identify-max-tolerance",20),k.add("request-queue-concurrency-hosted",16),k.add("request-queue-concurrency-non-hosted",4),k.add("curve-densification-coarse-segments",128),k.add("curve-densification-max-segments",2e3),k.add("curve-densification-min-segments",3),k.add("curve-densification-pixel-deviation",.5),k.add("view-readyState-waiting-delay",1e3),k.add("gradient-depth-bias",.01),k.add("gradient-depth-epsilon",1e-8),k.add("enable-feature:esri-compress-textures",!0),k("host-webworker")||k("host-browser")&&(k.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),k.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();function Cwe(t){}function iU(t){return()=>t}function Pwe(t){return t}var ci;let sU=(ci=class{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*ci._m}getInt(){return this._seed=(ci._a*this._seed+ci._c)%ci._m,this._seed}getFloat(){return this.getInt()/(ci._m-1)}getIntRange(e,r){return Math.round(this.getFloatRange(e,r))}getFloatRange(e,r){const i=r-e;return e+this.getInt()/ci._m*i}},ci._m=2147483647,ci._a=48271,ci._c=0,ci);const nU=1.5,Awe=1/nU,Rwe=.5;function FA(t){return t}function oU(t,e=FA){if(!t||t.length===0)return;let r=t[0],i=e(r);for(let s=1;s<t.length;++s){const n=t[s],o=Number(e(n));o>i&&(i=o,r=n)}return r}function Lwe(t,e=FA){return oU(t,r=>-e(r))}function Fwe(t,e){return e?t.filter((r,i,s)=>s.findIndex(e.bind(null,r))===i):Array.from(new Set(t))}function aU(t,e,r,i,s,n,o){if(t==null&&i==null)return!0;e=Math.max(0,e),s=Math.max(0,s),r=Math.max(0,r<0?(t?.length??0)+r:r),n=Math.max(0,n<0?(i?.length??0)+n:n);const l=r-e;if(t==null||i==null||l!==n-s)return!1;if(o){for(let u=0;u<l;u++)if(!o(t[e+u],i[s+u]))return!1}else for(let u=0;u<l;u++)if(t[e+u]!==i[s+u])return!1;return!0}function uw(t,e,r){return aU(t,0,t?.length??0,e,0,e?.length??0,r)}function Nwe(){return(t,e)=>{if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}}function K3(t,e,r){let i,s;return r?(i=e.filter(n=>!t.some(o=>r(o,n))),s=t.filter(n=>!e.some(o=>r(o,n)))):(i=e.filter(n=>!t.includes(n)),s=t.filter(n=>!e.includes(n))),{added:i,removed:s}}function Dwe(t){return t&&typeof t.length=="number"}function jwe(t,e){const r=t.length;if(r===0)return[];const i=[];for(let s=0;s<r;s+=e)i.push(t.slice(s,s+e));return i}let NA=class{constructor(){this.last=0}};const DA=new NA;function d_(t,e,r,i){i=i||DA;const s=Math.max(0,i.last-10);for(let o=s;o<r;++o)if(t[o]===e)return i.last=o,o;const n=Math.min(s,r);for(let o=0;o<n;++o)if(t[o]===e)return i.last=o,o;return-1}function h_(t,e,r,i){const s=t.length,n=d_(t,e,s,i);if(n!==-1)return t[n]=t[s-1],t.pop(),e}const xs=new Set;function lU(t,e,r=t.length,i=e.length,s,n){if(i===0||r===0)return r;xs.clear();for(let l=0;l<i;++l)xs.add(e[l]);s=s||DA;const o=Math.max(0,s.last-10);for(let l=o;l<r;++l)if(xs.has(t[l])&&(n?.push(t[l]),xs.delete(t[l]),t[l]=t[r-1],--r,--l,xs.size===0||r===0))return xs.clear(),r;for(let l=0;l<o;++l)if(xs.has(t[l])&&(n?.push(t[l]),xs.delete(t[l]),t[l]=t[r-1],--r,--l,xs.size===0||r===0))return xs.clear(),r;return xs.clear(),r}function uU(t,e){let r=0;for(let i=0;i<t.length;++i){const s=t[i];e(s,i)&&(t[r]=s,r++)}return t.length=r,t}function zwe(t,e,r){const i=t.length;if(e>=i)return t.slice();const s=jA(r),n=new Set,o=[];for(;o.length<e;){const l=Math.floor(s()*i);n.has(l)||(n.add(l),o.push(t[l]))}return o}function jA(t){return t?(Q3.seed=t,()=>Q3.getFloat()):Math.random}const Q3=new sU;function Uwe(t,e){if(!t)return t;const r=jA(e);for(let i=t.length-1;i>0;i--){const s=Math.floor(r()*(i+1)),n=t[i];t[i]=t[s],t[s]=n}return t}function Qx(t,e){const r=t.indexOf(e);return r!==-1?(t.splice(r,1),e):null}function hs(t,e){return t!=null}const qwe=[];function Gwe(t){return t instanceof ArrayBuffer}function Xx(t){return t?.constructor?.name==="Int8Array"}function VA(t){return t?.constructor?.name==="Uint8Array"}function zA(t){return t?.constructor?.name==="Uint8ClampedArray"}function eT(t){return t?.constructor?.name==="Int16Array"}function UA(t){return t?.constructor?.name==="Uint16Array"}function tT(t){return t?.constructor?.name==="Int32Array"}function qA(t){return t?.constructor?.name==="Uint32Array"}function cU(t){return t?.constructor?.name==="Float16Array"}function cw(t){return t?.constructor?.name==="Float32Array"}function dw(t){return t?.constructor?.name==="Float64Array"}function dU(t){return"buffer"in t}const GA=1024;function Bwe(t){return dw(t)||cw(t)||tT(t)||eT(t)||Xx(t)}function Hwe(t){return dw(t)||cw(t)}function Wwe(t){return dw(t)?179769e303:cU(t)?65504:cw(t)?3402823e32:qA(t)?4294967295:UA(t)?65535:VA(t)||zA(t)?255:tT(t)?2147483647:eT(t)?32767:Xx(t)?127:256}const Zwe=-32768,Jwe=-2147483648;function Ywe(t){return t}function hU(t,e){let r;for(r in t)t.hasOwnProperty(r)&&t[r]===void 0&&delete t[r];return t}function E(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=WA(t);if(e!=null)return e;if(Af(t))return t.clone();if(BA(t))return t.map(E);if(HA(t))throw new Error("Trying to clone an unclonable Accessor instance");const r={};for(const i of Object.getOwnPropertyNames(t))r[i]=E(t[i]);return r}function p_(t,e){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const r=WA(t);if(r!=null)return r;if(BA(t)){let s=!0;const n=t.map(o=>{const l=p_(o,e);return o!=null&&l==null&&(s=!1),l});return s?n:null}if(Af(t))return t.clone(e);if(t instanceof File||t instanceof Blob)return t;if(HA(t))return null;const i=new(Object.getPrototypeOf(t)).constructor;for(const s of Object.getOwnPropertyNames(t)){const n=t[s],o=p_(n);if(n!=null&&o==null)return null;i[s]=o}return i}function Af(t){return typeof t.clone=="function"}function BA(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function HA(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function X3(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function WA(t){if(Xx(t)||VA(t)||zA(t)||eT(t)||UA(t)||tT(t)||qA(t)||cw(t)||dw(t))return t.slice();if(t instanceof Date)return new Date(t);if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[r,i]of t)e.set(r,E(i));return e}if(t instanceof Set){const e=new Set;for(const r of t)e.add(E(r));return e}return null}function rT(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof t?.getTime=="function"&&typeof e?.getTime=="function"&&t.getTime()===e.getTime()||!1}function ZA(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&uw(t,e):t instanceof Set?e instanceof Set&&fU(t,e):t instanceof Map?e instanceof Map&&mU(t,e):!!X3(t)&&X3(e)&&pU(t,e))}function pU(t,e){if(t===null||e===null)return!1;const r=Object.keys(t);if(e===null||Object.keys(e).length!==r.length)return!1;for(const i of r)if(t[i]!==e[i]||!Object.prototype.hasOwnProperty.call(e,i))return!1;return!0}function fU(t,e){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}function mU(t,e){if(t.size!==e.size)return!1;for(const[r,i]of t){const s=e.get(r);if(s!==i||s===void 0&&!e.has(r))return!1}return!0}function iT(t,e,r=!1){return YA(t,e,r)}function Wm(t,e){if(e!=null)return e[t]||JA(t.split("."),!1,e)}function Bt(t,e,r){const i=t.split("."),s=i.pop(),n=JA(i,!0,r);n&&s&&(n[s]=e)}function eI(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const r=e;if(t.length!==r.length)return!0;for(let i=0;i<t.length;i++)if(eI(t[i],r[i]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const r in t)if(eI(t[r],e[r]))return!0;return!1}return t!==e}function JA(t,e,r){let i=r;for(const s of t){if(i==null)return;if(!(s in i)){if(!e)return;i[s]={}}i=i[s]}return i}function YA(t,e,r){return e?Object.keys(e).reduce((i,s)=>{if(s==="__proto__")return i;let n=i[s],o=e[s];return n===o?i:n===void 0?(i[s]=E(o),i):(Array.isArray(o)||Array.isArray(i)?(n=n?Array.isArray(n)?i[s]=n.slice():i[s]=[n]:i[s]=[],o&&(Array.isArray(o)||(o=[o]),r?o.forEach(l=>{n.includes(l)||n.push(l)}):i[s]=o.slice())):o&&typeof o=="object"?i[s]=YA(n,o,r):i.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(i[s]=o),i)},t||{}):t}function Kwe(t,e){for(const r of Object.entries(t))if(e===r[1])return r[0]}function hw(t,e){return Object.values(t).includes(e)}const _e={apiKey:void 0,apiKeys:{scopes:[]},applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(iT(_e,globalThis.esriConfig,!0),delete _e.has),!_e.assetsPath){{const t="4.34";_e.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}_e.defaultAssetsPath=_e.assetsPath}function a(t,e,r,i){var s=arguments.length,n=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(t,e,r,i);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(n=(s<3?o(n):s>3?o(e,r,n):o(e,r))||n);return s>3&&n&&Object.defineProperty(e,r,n),n}function Qwe(t,e){return function(r,i){e(r,i,t)}}function Xwe(t,e,r,i){function s(n){return n instanceof r?n:new r(function(o){o(n)})}return new(r||(r=Promise))(function(n,o){function l(p){try{d(i.next(p))}catch(f){o(f)}}function u(p){try{d(i.throw(p))}catch(f){o(f)}}function d(p){p.done?n(p.value):s(p.value).then(l,u)}d((i=i.apply(t,e||[])).next())})}function ebe(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var i,s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=e[Symbol.asyncDispose]}if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=e[Symbol.dispose],r&&(s=i)}if(typeof i!="function")throw new TypeError("Object not disposable.");s&&(i=function(){try{s.call(this)}catch(n){return Promise.reject(n)}}),t.stack.push({value:e,dispose:i,async:r})}else r&&t.stack.push({async:!0});return e}var yU=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var i=new Error(r);return i.name="SuppressedError",i.error=t,i.suppressed=e,i};function tbe(t){function e(n){t.error=t.hasError?new yU(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}var r,i=0;function s(){for(;r=t.stack.pop();)try{if(!r.async&&i===1)return i=0,t.stack.push(r),Promise.resolve().then(s);if(r.dispose){var n=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(n).then(s,function(o){return e(o),s()})}else i|=1}catch(o){e(o)}if(i===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return s()}const gU="modulepreload",vU=function(t){return"/streetlight-web-map/"+t},tI={},N=function(e,r,i){let s=Promise.resolve();if(r&&r.length>0){let u=function(d){return Promise.all(d.map(p=>Promise.resolve(p).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");s=u(r.map(d=>{if(d=vU(d),d in tI)return;tI[d]=!0;const p=d.endsWith(".css"),f=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${f}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":gU,p||(m.as="script"),m.crossOrigin="",m.href=d,l&&m.setAttribute("nonce",l),document.head.appendChild(m),p)return new Promise((y,g)=>{m.addEventListener("load",y),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function n(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&n(l.reason);return e().catch(n)})},wU=/\{([^}]+)\}/g;function rI(t){return t??""}function sl(t,e){return e?t.replaceAll(wU,typeof e=="object"?(r,i)=>rI(Wm(i,e)):(r,i)=>rI(e(i))):t}function rbe(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,r=>e?.includes(r)?r:`\\${r}`)}function KA(t){let e=0;for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return e}let iI;function ibe(t){return iI??=new DOMParser,iI.parseFromString(t||"","text/html").body.innerText||""}function sbe(t,e){return new RegExp(`{${e}}`,"ig").test(t)}function nbe(t,...e){let r=t[0];for(let i=0;i<e.length;++i)r+=e[i]+t[i+1];return r}const sI={info:0,warn:1,error:2,none:3};var Mt;let L=(Mt=class{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,Mt._loggers.set(this.module,this);const r=this.module.lastIndexOf(".");r!==-1&&(this._parent=Mt.getLogger(this.module.slice(0,r)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,Mt._loggers.get(e)||new Mt({module:e})}_log(e,r,...i){if(this._matchLevel(e)){if(r!=="always"&&!Mt._throttlingDisabled){const s=_U(i),n=this._loggedMessages[e].get(s);if(r==="once"&&n!=null||r==="oncePerTick"&&n&&n>=Mt._tickCounter)return;this._loggedMessages[e].set(s,Mt._tickCounter),Mt._scheduleTickCounterIncrement()}for(const s of _e.log.interceptors)if(s(e,this.module,...i))return;this._inheritedWriter()(e,this.module,...i)}}_parentWithMember(e,r){let i=this;for(;i!=null;){const s=i[e];if(s!=null)return s;i=i.parent}return r}_inheritedWriter(){return this._parentWithMember("writer",bU)}_matchLevel(e){const r=_e.log.level||"warn";return sI[this._parentWithMember("level",r)]<=sI[e]}static _scheduleTickCounterIncrement(){Mt._tickCounterScheduled||(Mt._tickCounterScheduled=!0,Promise.resolve().then(()=>{Mt._tickCounter++,Mt._tickCounterScheduled=!1}))}},Mt._loggers=new Map,Mt._tickCounter=0,Mt._tickCounterScheduled=!1,Mt._throttlingDisabled=!1,Mt);function bU(t,e,...r){console[t](`[${e}]`,...r)}function _U(...t){return KA(JSON.stringify(t,(r,i)=>typeof i!="object"||Array.isArray(i)?i:"[Object]"))}function SU(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,(r,i)=>i===""?"$":(Wm(i,e)??"").toString())}let QA=class{constructor(e,r,i=void 0){this.name=e,this.details=i,this.message=(r&&SU(r,i))??""}toString(){return"["+this.name+"]: "+this.message}},x=class XA extends QA{constructor(e,r,i){super(e,r,i)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,r)=>{if(r&&typeof r=="object"&&typeof r.toJSON=="function")return r;try{return E(r)}catch{return"[object]"}}))}}catch(e){throw L.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new XA(e.name,e.message,e.details)}};x.prototype.type="error";function pm(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}const $U=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,xU={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function nI(t){const e=t?.match($U);if(!e)return null;const[,r,i,s]=e;if(!r)return null;let n=null,o=null,l=null;const{devext:u,qaext:d,www:p}=xU;if(i)if(n=r,s)switch(s.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:l}=u);break;case"qa":({customBaseUrl:o,portalHostname:l}=d);break;default:return null}else({customBaseUrl:o,portalHostname:l}=p);else switch(r.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:l}=u);break;case"qaext":({customBaseUrl:o,portalHostname:l}=d);break;case"www":({customBaseUrl:o,portalHostname:l}=p);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:l,urlKey:n}}function eR(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function tR(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,r=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,i=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):r.test(t)?t=t.replace(r,"https://devext.arcgis.com"):i.test(t)&&(t=t.replace(i,"https://qaext.arcgis.com")),t}function rR(t){const e=atob(t),r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r.buffer}function TU(t){const e=new Uint8Array(t);let r="";for(let i=0;i<e.length;i++)r+=String.fromCharCode(e[i]);return btoa(r)}const MU=()=>L.getLogger("esri.core.urlUtils"),Nh=_e.request,oI="esri/config: esriConfig.request.proxyUrl is not set.",iR=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,sR=/^\s*http:/i,IU=/^\s*https:/i,EU=/^\s*file:/i,nR=/:\d+$/,OU=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,kU=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),CU=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let _d=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let r=this.uri.match(kU);this.scheme=r[2]||(r[1]?"":null),this.authority=r[4]||(r[3]?"":null),this.path=r[5],this.query=r[7]||(r[6]?"":null),this.fragment=r[9]||(r[8]?"":null),this.authority!=null&&(r=this.authority.match(CU),this.user=r[3]||null,this.password=r[4]||null,this.host=r[6]||r[7],this.port=r[9]||null)}toString(){return this.uri}};const My={},PU=new _d(_e.applicationUrl);let Er=PU;const AU=RU();let sT=AU;const nT=()=>Er,lbe=()=>sT;function RU(){const t=Er.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${Er.scheme}://${Er.host}${Er.port!=null?`:${Er.port}`:""}`}${e}`}function Rr(t){if(!t)return null;const e={path:null,query:null},r=new _d(t),i=t.indexOf("?");return r.query===null?e.path=t:(e.path=t.slice(0,i),e.query=oT(r.query)),r.fragment&&(e.hash=r.fragment,r.query===null&&(e.path=e.path.slice(0,e.path.length-(r.fragment.length+1)))),e}function oT(t){const e=t.split("&"),r={};for(const i of e){if(!i)continue;const s=i.indexOf("=");let n,o;s<0?(n=decodeURIComponent(i),o=""):(n=decodeURIComponent(i.slice(0,s)),o=decodeURIComponent(i.slice(s+1)));let l=r[n];typeof l=="string"&&(l=r[n]=[l]),Array.isArray(l)?l.push(o):r[n]=o}return r}function fm(t,e){return t?Object.keys(t).map(r=>{const i=t[r];if(i==null)return"";const s=encodeURIComponent(r)+"=",n=e?.[r];return n?s+encodeURIComponent(n(i)):Array.isArray(i)?i.map(o=>pm(o)?s+encodeURIComponent(JSON.stringify(o)):s+encodeURIComponent(o)).join("&"):pm(i)?s+encodeURIComponent(JSON.stringify(i)):s+encodeURIComponent(i)}).filter(r=>r).join("&"):""}function oR(t=!1){let e,r=Nh.proxyUrl;if(typeof t=="string"){e=zU(t);const i=pw(t);i&&(r=i.proxyUrl)}else e=!!t;if(!r)throw MU().warn(oI),new x("urlUtils:proxy-not-set",oI);return e&&m_()&&(r=dT(r)),Rr(r)}function ube(t,e=!1){const r=pw(t);let i,s;if(r){const n=aT(r.proxyUrl);i=n.path,s=n.query?oT(n.query):null}else if(e){const n=oR(t);i=n.path,s=n.query}if(i){const n=Rr(t);t=i+"?"+n.path;const o=fm({...s,...n.query});o&&(t=`${t}?${o}`)}return t}const pp={path:"",query:""};function aT(t){const e=t.indexOf("?");return e!==-1?(pp.path=t.slice(0,e),pp.query=t.slice(e+1)):(pp.path=t,pp.query=null),pp}function aR(t){return t=(t=Y0(t=WU(t=aT(t).path),!0)).toLowerCase()}function LU(t){const e={proxyUrl:t.proxyUrl,urlPrefix:aR(t.urlPrefix)},r=Nh.proxyRules,i=e.urlPrefix;let s=r.length;for(let n=0;n<r.length;n++){const o=r[n].urlPrefix;if(i.startsWith(o)){if(i.length===o.length)return-1;s=n;break}o.startsWith(i)&&(s=n+1)}return r.splice(s,0,e),s}function pw(t){const e=Nh.proxyRules,r=aR(t);for(let i=0;i<e.length;i++)if(r.startsWith(e[i].urlPrefix))return e[i]}function FU(t,e){if(!t||!e)return!1;t=J0(t),e=J0(e);const r=nI(t),i=nI(e);return r!=null&&i!=null?r.portalHostname===i.portalHostname:r==null&&i==null&&Cn(t,e,!0)}function lR(t,e){return t=J0(t),e=J0(e),Y0(t)===Y0(e)}function J0(t){const e=(t=en(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function f_(t,e=Nh.interceptors){const r=i=>i instanceof RegExp?i.test(t):typeof i=="string"?t.startsWith(i):i==null;if(e){for(const i of e)if(Array.isArray(i.urls)){if(i.urls.some(r))return i}else if(r(i.urls))return i}return null}function Cn(t,e,r=!1){if(!t||!e)return!1;const i=g_(t),s=g_(e);return!(!r&&i.scheme!==s.scheme)&&i.host!=null&&s.host!=null&&i.host.toLowerCase()===s.host.toLowerCase()&&i.port===s.port}function lT(t){if(typeof t=="string"){if(!yi(t))return!0;t=g_(t)}if(Cn(t,Er))return!0;const e=Nh.trustedServers||[];for(let r=0;r<e.length;r++){const i=NU(e[r]);for(let s=0;s<i.length;s++)if(Cn(t,i[s]))return!0}return!1}function NU(t){return My[t]||(cT(t)||Fn(t)?My[t]=[new _d(as(t))]:My[t]=[new _d(`http://${t}`),new _d(`https://${t}`)]),My[t]}function as(t,e=sT,r){return Fn(t)?r?.preserveProtocolRelative?t:Er.scheme==="http"&&Er.authority===ji(t).slice(2)?`http:${t}`:`https:${t}`:cT(t)?t:Tu(t.startsWith("/")?BU(e):e,t)}function uT(t,e=sT,r){if(t==null||!yi(t))return t;const i=en(t),s=i.toLowerCase(),n=en(e).toLowerCase().replace(/\/+$/,""),o=r?en(r).toLowerCase().replace(/\/+$/,""):null;if(o&&!n.startsWith(o))return t;const l=(f,m,y)=>(y=f.indexOf(m,y))===-1?f.length:y;let u=l(s,"/",s.indexOf("//")+2),d=-1;for(;s.slice(0,u+1)===n.slice(0,u)+"/"&&(d=u+1,u!==s.length);)u=l(s,"/",u+1);if(d===-1||o&&d<o.length)return t;t=i.slice(d);const p=n.slice(d-1).replaceAll(/[^/]+/g,"").length;if(p>0)for(let f=0;f<p;f++)t=`../${t}`;else t=`./${t}`;return t}function en(t){return t=YU(t=JU(t=ZU(t=as(t=t.trim()))))}function Tu(...t){const e=t.filter(hs);if(!e?.length)return;const r=[];if(yi(e[0])){const s=e[0],n=s.indexOf("//");n!==-1&&(r.push(s.slice(0,n+1)),qU(e[0])&&(r[0]+="/"),e[0]=s.slice(n+2))}else e[0].startsWith("/")&&r.push("");const i=e.reduce((s,n)=>n?s.concat(n.split("/")):s,[]);for(let s=0;s<i.length;s++){const n=i[s];n===".."&&r.length>0&&r[r.length-1]!==".."?r.pop():(!n&&s===i.length-1||n&&(n!=="."||r.length===0))&&r.push(n)}return r.join("/")}function ji(t,e=!1){if(t==null||Dh(t)||zu(t))return null;let r=t.indexOf("://");if(r===-1&&Fn(t))r=2;else{if(r===-1)return null;r+=3}const i=t.indexOf("/",r);return i!==-1&&(t=t.slice(0,i)),e&&(t=Y0(t,!0)),t}function yi(t){return Fn(t)||cT(t)}function Dh(t){return t!=null&&t.startsWith("blob:")}function zu(t){return t!=null&&t.startsWith("data:")}function DU(t){const e=mh(t);return e?.isBase64?rR(e.data):null}function cbe(t){return TU(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const jU=/^data:(.*?)(;base64)?,(.*)$/;function mh(t){const e=t.match(jU);if(!e)return null;const[,r,i,s]=e;return{mediaType:r,isBase64:!!i,data:s}}function uR(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function VU(t){return(await fetch(t)).blob()}function dbe(t){const e=DU(t);if(!e)return null;const r=mh(t);return new Blob([e],{type:r.mediaType})}function Fn(t){return t!=null&&t.startsWith("/")&&t[1]==="/"}function cT(t){return t!=null&&iR.test(t)}function zU(t){return t!=null&&IU.test(t)||Er.scheme==="https"&&Fn(t)}function UU(t){return t!=null&&sR.test(t)||Er.scheme==="http"&&Fn(t)}function qU(t){return t!=null&&EU.test(t)}function dT(t){return Fn(t)?`https:${t}`:t.replace(sR,"https:")}function GU(){return Er.scheme==="http"}function m_(){return Er.scheme==="https"}function Y0(t,e=!1){return Fn(t)?t.slice(2):(t=t.replace(iR,""),e&&t.length>1&&t.startsWith("/")&&t[1]==="/"&&(t=t.slice(2)),t)}function BU(t){const e=t.indexOf("//"),r=t.indexOf("/",e+2);return r===-1?t:t.slice(0,r)}function HU(t){let e=0;if(yi(t)){const i=t.indexOf("//");i!==-1&&(e=i+2)}const r=t.lastIndexOf("/");return r<e?t:t.slice(0,r+1)}function hbe(t,e){if(!t)return"";const r=Rr(t).path.replace(/\/+$/,""),i=r.slice(r.lastIndexOf("/")+1);if(!e?.length)return i;const s=new RegExp(`\\.(${e.join("|")})$`,"i");return i.replace(s,"")}function WU(t){return t.endsWith("/")?t:`${t}/`}function cR(t){return t.replace(/\/+$/,"")}function ZU(t){if(/^https?:\/\//i.test(t)){const e=aT(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function JU(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function YU(t){const e=Nh.httpsDomains;if(!UU(t))return t;const r=t.indexOf("/",7);let i;if(i=r===-1?t:t.slice(0,r),i=i.toLowerCase().slice(7),nR.test(i)){if(!i.endsWith(":80"))return t;i=i.slice(0,-3),t=t.replace(":80","")}return GU()&&i===Er.authority&&!OU.test(t)||(m_()&&i===Er.authority||e&&e.some(s=>i===s||i.endsWith(`.${s}`))||m_()&&!pw(t))&&(t=dT(t)),t}function y_(t,e,r){if(!(e&&r&&t&&yi(t)))return t;const i=t.indexOf("//"),s=t.indexOf("/",i+2),n=t.indexOf(":",i+2),o=Math.min(s<0?t.length:s,n<0?t.length:n);return t.slice(i+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,i+2)}${r}${t.slice(o)}`}function dR(t,e){const r=new URL(t);return r.host=e,r.port&&!nR.test(e)&&(r.port=""),r.toString()}function KU(t){return new URL(t).host}function g_(t){return typeof t=="string"?new _d(as(t)):(t.scheme||(t.scheme=Er.scheme),t)}function pbe(t){return XU.test(t)}function hR(t,e){const r=Rr(t),i=Object.keys(r.query||{});return i.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${i.join(", ")}.`),r.path}function QU(t,e,r){const i=Rr(t),s=i.query||{};return s[e]=String(r),`${i.path}?${fm(s)}`}function Eb(t,e){if(!e)return t;const r=Rr(t),i=r.query||{};for(const[n,o]of Object.entries(e))o!=null&&(i[n]=o);const s=fm(i);return s?`${r.path}?${s}`:r.path}function pR(t){if(t==null)return null;const e=t.match(fR);return e?e[2]:null}function aI(t){if(t==null)return null;const e=t.match(fR);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function fbe(t){return typeof t=="string"?mh(t)??{data:t}:new Promise((e,r)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=()=>e(mh(i.result)),i.onerror=s=>r(s)})}const fR=/([^.]*)\.([^/]*)$/,XU=/(^data:image\/svg|\.svg$)/i,mR="20251114",yR="ec088c999de2dac6fb9478a47da1bad775545540";Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");const e7="4.34";let Se,hT=e7;function mbe(t){Se=t}function ybe(t){const e=Se?.findCredential(t);return e?.token?QU(t,"token",e.token):t}hT="4.34.8",k("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),k("host-webworker");function t7(t,e){for(const r of t.values())if(e(r))return!0;return!1}function gbe(t,e){for(const r of t.values())if(!e(r))return!1;return!0}function vbe(t,e){for(const r of t.values())if(e(r))return r;return null}function jh(t,e,r){const i=t.get(e);if(i!==void 0)return i;const s=r();return t.set(e,s),s}function wbe(t){const e=new Map;return r=>(e.has(r)||e.set(r,t(r)),e.get(r))}const r7={remove:()=>{}};function Te(t){return t?{remove(){t&&(t(),t=void 0)}}:r7}function gR(t){t.forEach(e=>e?.remove())}function bbe(t){gR(t),t.length=0}function Uu(t){return Te(()=>gR(t))}function _be(t){return Te(()=>t()?.remove())}function i7(t){return Te(()=>t?.abort())}function Sbe(t){return Te(t!=null?()=>t.destroy():void 0)}function s7(t){return typeof t=="object"&&!!t&&"remove"in t&&typeof t.remove=="function"}function $be(t){s7(t)&&t.remove()}function xbe(t){return{[Symbol.dispose](){t.remove()}}}function n7(t){return{setTimeout:(e,r)=>{const i=t.setTimeout(e,r);return Te(()=>t.clearTimeout(i))}}}const Vh=n7(globalThis);function fw(t){return o7(t)||vR(t)}function o7(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function vR(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function zh(t,e,r){if(!fw(t))throw new TypeError("target is not a Evented or EventTarget object");return vR(t)?a7(t,e,r):t.on(e,r)}function a7(t,e,r,i){if(Array.isArray(e)){const s=e.slice();for(const n of s)t.addEventListener(n,r,i);return Te(()=>{for(const n of s)t.removeEventListener(n,r,i)})}return t.addEventListener(e,r,i),Te(()=>t.removeEventListener(e,r,i))}function wR(t,e,r){if(!fw(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,r);const i=zh(t,e,s=>{i.remove(),r.call(t,s)});return i}function bR(t,e){if(t==null)throw new Error(e??"value is None")}function Ke(t){return t?.destroy(),null}function Tbe(t){return t?.dispose(),null}function He(t){return t?.remove(),null}function jo(t){return t?.abort(),null}function Mbe(t){return t?.release(),null}function l7(t,e,r){return t!=null&&e!=null?r!=null?r(t,e):t.equals(e):t===e}function K0(t,e){let r;return t.some((i,s)=>(r=e(i,s),r!=null)),r??void 0}function Fe(t="Aborted"){return new x("AbortError",t)}function We(t,e="Aborted"){if(Cr(t))throw Fe(e)}function Zm(t){return t instanceof AbortSignal?t:t?.signal??void 0}function Cr(t){const e=Zm(t);return e!=null&&e.aborted}function Mn(t){if(sr(t))throw t}function lI(t){if(!sr(t))throw t}function ys(t,e){const r=Zm(t);if(r!=null){if(!r.aborted)return wR(r,"abort",()=>e());e()}}function pT(t,e){const r=Zm(t);if(r!=null)return We(r),wR(r,"abort",()=>e(Fe()))}function _R(t,e){return Zm(e)==null?t:new Promise((r,i)=>{let s=ys(e,()=>i(Fe()));const n=()=>{s=He(s)};t.then(n,n),t.then(r,i)})}function sr(t){return t?.name==="AbortError"}async function yh(t){try{return await t}catch(e){if(!sr(e))throw e;return}}async function tu(t){if(!t)return;if(typeof t.forEach!="function"){const r=Object.keys(t),i=r.map(o=>t[o]),s=await tu(i),n={};return r.map((o,l)=>n[o]=s[l]),n}const e=t;return Promise.allSettled(e).then(r=>Array.from(e,(i,s)=>{const n=r[s];return n.status==="fulfilled"?{promise:i,value:n.value}:{promise:i,error:n.reason}}))}async function u7(t){return(await Promise.allSettled(t)).filter(e=>e.status==="fulfilled").map(e=>e.value)}async function Ibe(t){return(await Promise.allSettled(t)).filter(e=>e.status==="rejected").map(e=>e.reason)}function fT(t,e=void 0,r){const i=new AbortController;return ys(r,()=>i.abort()),new Promise((s,n)=>{let o=setTimeout(()=>{o=0,s(e)},t);ys(i,()=>{o&&(clearTimeout(o),n(Fe()))})})}function Ebe(t,e,r,i){const s=r&&"abort"in r?r:null;i!=null||s||(i=r);let n=setTimeout(()=>{n=0,s?.abort()},e);const o=()=>i||new x("promiseUtils:timeout","The wrapped promise did not resolve within "+e+" ms");return t.then(l=>{if(n===0)throw o();return clearTimeout(n),l},l=>{throw clearTimeout(n),n===0?o():l})}function c7(t,e){const r=new AbortController,i=setTimeout(()=>r.abort(),e);return ys(t,()=>{r.abort(),clearTimeout(i)}),{...t,signal:r.signal}}function Pr(t){return t&&typeof t.then=="function"}function v_(t){return Pr(t)?t:Promise.resolve(t)}function mT(t,e=-1){let r,i,s,n,o=null;const l=(...u)=>{if(r){i=u,n&&n.reject(Fe()),n=wi();const m=n.promise;if(o){const y=o;o=null,y.abort()}return m}if(s=n||wi(),n=null,e>0){const m=new AbortController;r=v_(t(...u,m.signal));const y=r;fT(e).then(()=>{r===y&&(n?m.abort():o=m)})}else r=1,r=v_(t(...u));const d=()=>{const m=i;i=s=r=o=null,m!=null&&l(...m)},p=r,f=s;return p.then(d,d),p.then(f.resolve,f.reject),f.promise};return l}function wi(){let t,e;const r=new Promise((s,n)=>{t=s,e=n}),i=s=>{t(s)};return i.resolve=s=>t(s),i.reject=s=>e(s),i.timeout=(s,n)=>Vh.setTimeout(()=>i.reject(n),s),i.promise=r,i}function Obe(t,e){e.then(t.resolve,t.reject)}async function uI(t){await Promise.resolve(),We(t)}function qu(t,e){const r=e?.url?.path;if(t&&r&&(t=as(t,r,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const i=uT(t,e.portalItem.itemUrl);i!=null&&i.startsWith(d7)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(i).path)}return(t=w_(t,e?.portal))&&yw.test(t)?yT(t):t}function Mu(t,e,r=0){if((t=t&&yw.test(t)?TR(t):t)==null)return t;!yi(t)&&e?.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let i=as(t);if(e){const s=e.verifyItemRelativeUrls?.rootPath||e.url?.path;if(s){const n=w_(s,e.portal),o=w_(i,e.portal);i=uT(o,n,n),i!=null&&i!==o&&i!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(i)}}return i=xR(i,e?.portal),yi(i)&&(i=en(i)),e?.resources&&e?.portalItem&&!yi(i)&&!zu(i)&&r===0&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(i),compress:!1}),i}function mw(t,e,r){return qu(t,r)}function Iu(t,e,r,i){const s=Mu(t,i);s!==void 0&&(e[r]=s)}const yw=/\/items\/([^/]+)\/resources\/(.*)/,d7="./resources/";function SR(t){return(t?.match(yw)??null)?.[1]??null}function $R(t){const e=t?.match(yw)??null;if(e==null)return null;const r=e[2],i=r.lastIndexOf("/");if(i===-1){const{path:o,extension:l}=aI(r);return{prefix:null,filename:o,extension:l}}const{path:s,extension:n}=aI(r.slice(i+1));return{prefix:r.slice(0,i),filename:s,extension:n}}function xR(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?y_(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function w_(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const r=`${e.urlKey}.${e.customBaseUrl}`,i=nT();return Cn(i,`${i.scheme}://${r}`)?y_(t,e.portalHostname,r):y_(t,r,e.portalHostname)}function yT(t){if(!t)return t||null;let e=t;return e&&Se&&!Se.findCredential(e)&&(e=tR(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function TR(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Se&&!Se.findCredential(e)&&(e=tR(e)),e}const h7=Object.freeze(Object.defineProperty({__proto__:null,ensureMainOnlineDomain:xR,fromCDNUrl:TR,fromJSON:qu,itemIdFromResourceUrl:SR,prefixAndFilenameFromResourceUrl:$R,read:mw,toCDNUrl:yT,toJSON:Mu,write:Iu},Symbol.toStringTag,{value:"Module"})),MR={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},IR=Object.values(MR),ER=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${IR.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),p7=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${IR.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),f7=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function kbe(t){return ER.test(t)}function nl(t){if(t==null)return null;const e=Rr(t),r=e?.path.match(ER)||e?.path.match(p7);if(!r)return null;const[,i,s,n,o]=r,l=s.indexOf("/");return{title:gT(l!==-1?s.slice(l+1):s),serverType:MR[n.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:i}}}function m7(t){const e=Rr(t).path.match(f7);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function gT(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function y7(t,e){const r=[];if(t){const i=nl(t);i!=null&&i.title&&r.push(i.title)}if(e){const i=gT(e);r.push(i)}if(r.length===2){if(r[0].toLowerCase().includes(r[1].toLowerCase()))return r[0];if(r[1].toLowerCase().includes(r[0].toLowerCase()))return r[1]}return r.join(" - ")}function Q0(t){let e=ji(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")||/^[a-z\d-]+\.svcs[a-z\d-]*\./.test(e)))}function g7(t,e){return t&&cR(hR(t,e))}function v7(t){let{url:e}=t;if(!e)return{url:e};e=hR(e,t.logger);const r=Rr(e),i=nl(r.path);let s;if(i!=null)i.sublayer!=null&&t.layer.layerId==null&&(s=i.sublayer),e=i.url.path;else if(t.nonStandardUrlAllowed){const n=m7(r.path);n!=null&&(e=n.serviceUrl,s=n.sublayerId)}return{url:cR(e),layerId:s}}function w7(t,e,r,i,s){Iu(e,i,"url",s),i.url&&t.layerId!=null&&(i.url=Tu(i.url,r,t.layerId.toString()))}function Cbe(t){if(!t)return!1;const e=t.toLowerCase(),r=e.includes("/services/"),i=e.includes("/mapserver/wmsserver"),s=e.includes("/imageserver/wmsserver"),n=e.includes("/wmsserver");return r&&(i||s||n)}const b7=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function vT(t){if(!wT(t))return null;const e=i=>i instanceof RegExp?i.test(t):typeof i=="string"&&t.startsWith(i),r=_e.apiKeys;if(Array.isArray(r.scopes)){for(const i of r.scopes)if(Array.isArray(i.urls)){if(i.urls.some(e))return i.token}else if(e(i.urls))return i.token}return r.basemapStyles&&/^https?:\/\/(i?basemaps|basemapstyles)-api\.arcgis\.com\//i.test(t)?r.basemapStyles:_e.apiKey&&/^https?:\/\/.+\.arcgis\.com(\/|$)/i.test(t)?_e.apiKey:null}function b_(){return _e.apiKey!=null||_e.apiKeys.basemapStyles!=null}function OR(t,e){return e?wT(t):vT(t)!=null}function wT(t){const e=ji(t,!0);return!!e&&!b7.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function _7(t,e,r=!1,i){return new Promise((s,n)=>{if(Cr(i))return void n(cI());let o=()=>{d(),n(new Error(`Unable to load ${e}`))},l=async()=>{const p=t;try{await p.decode()}catch{}d(),s(p)},u=()=>{if(!t)return;const p=t;d(),p.src="",n(cI())};const d=()=>{t&&(t.removeEventListener("error",o),t.removeEventListener("load",l),o=null,l=null,t=null,i?.removeEventListener("abort",u),u=null,r&&URL.revokeObjectURL(e))};i?.addEventListener("abort",u),t.addEventListener("error",o),t.addEventListener("load",l)})}function cI(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const kR="Timeout exceeded";function S7(){return new Error(kR)}function Pbe(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===kR}function $7(t){_e.request.crossOriginNoCorsDomains||(_e.request.crossOriginNoCorsDomains={});const e=_e.request.crossOriginNoCorsDomains;for(let r of t)r=r.toLowerCase(),/^https?:\/\//.test(r)?e[ji(r)??""]=0:(e[ji("http://"+r)??""]=0,e[ji("https://"+r)??""]=0)}function x7(t){const e=_e.request.crossOriginNoCorsDomains;if(e){let r=ji(t);if(r)return r=r.toLowerCase(),!Cn(r,nT())&&e[r]<Date.now()-36e5}return!1}async function T7(t){const e=Rr(t);t=e.path,e.query?.f==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const r=_e.request.crossOriginNoCorsDomains,i=ji(t);r&&i&&(r[i.toLowerCase()]=Date.now())}const __=new Map;function M7(t,e){const r=e?.preferredHost;if(!r||Cn(t,`https://${r}`,!0))return;const i=nl(t);if(!i||i.serverType!=="FeatureServer"||eR(t))return;const s=i.url.path.toLowerCase();__.has(s)||__.set(s,r)}function dI(t){const e=nl(t)?.url.path.toLowerCase();if(!e)return t;const r=__.get(e);return r?dR(t,r):t}async function Ae(t,e){t instanceof URL&&(t=t.toString()),e?.query instanceof URLSearchParams&&(e.query=oT(e.query.toString().replaceAll("+"," ")));const r=zu(t),i=Dh(t);i||r||(t=en(t));const s={url:t,requestOptions:{...e}},n=y=>({data:y,getAllHeaders:gh,getHeader:gh,httpStatus:200,requestOptions:s.requestOptions,url:s.url}),o=f_(t,ss.internalInterceptors);if(o){const y=await pI(o,s);if(y!=null)return n(y)}let l=f_(t);if(l){const y=await pI(l,s);if(y!=null)return n(y);l.after||l.error||(l=null)}if(t=s.url,(e=s.requestOptions).responseType==="image"&&(k("host-webworker")||k("host-node")))throw tn("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),s);if(e.method==="head"){if(e.body)throw tn("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),s);if(r||i)throw tn("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),s)}if(await C7(),X0)return X0.execute(t,e);const u=new AbortController,d=ys(e,()=>u.abort()),p={controller:u,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:l,params:s,redoRequest:!1,useIdentity:ss.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},f=e.useRequestQueue?F7(p):$_(p),m=await f.finally(()=>d?.remove());return l?.after?.(m),m}let X0,CR=!1;const ss=_e.request,PR="FormData"in globalThis,I7=new Set([499,498,403,401]),E7=new Set(["COM_0056","COM_0057","SB_0008"]),O7=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],gh=()=>null,ev=Symbol();function k7(t){const e=ji(t);e&&!Ae._corsServers.includes(e)&&Ae._corsServers.push(e)}function hI(t){const e=ji(t);return!e||e.endsWith(".arcgis.com")||Ae._corsServers.includes(e)||lT(e)}function tn(t,e,r,i){let s;const n={url:r.url,requestOptions:r.requestOptions,getAllHeaders:gh,getHeader:gh,ssl:!1};if(e instanceof x)return e.details?(e.details=E(e.details),e.details.url=r.url,e.details.requestOptions=r.requestOptions):e.details=n,e;if(e){const o=i&&(()=>Array.from(i.headers)),l=i&&(p=>i.headers.get(p)),u=i?.status,d=e.message;d&&(s=d),o&&l&&(n.getAllHeaders=o,n.getHeader=l),n.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||u||0,n.subCode=e.subcode,n.messageCode=e.messageCode,typeof e.details=="string"?(n.messages=[e.details],s??=e.details):(n.messages=e.details,s??=n.messages?.[0]),n.raw=ev in e?e[ev]:e}return s??="Error",sr(e)?Fe():new x(t,s,n)}async function C7(){k("host-webworker")&&(!X0&&globalThis.invokeStaticMessage?X0=await N(()=>import("./request-cu0zPjI6.js"),[]):CR=!0)}async function S_(){Se||await N(()=>import("./IdentityManager-BERDLhJj.js"),[])}async function P7(t){const e=t.params.url,r=t.params.requestOptions,i=t.controller.signal,s=r.body;let n=null,o=null;if(PR&&"HTMLFormElement"in globalThis&&(s instanceof FormData?n=s:s instanceof HTMLFormElement&&(n=new FormData(s))),typeof s=="string"&&(o=s),t.fetchOptions={cache:r.cacheBust?"no-cache":"default",credentials:"same-origin",headers:r.headers||{},keepalive:r.keepAlive??!1,method:r.method==="head"?"HEAD":"GET",mode:"cors",priority:ss.priority,redirect:"follow",signal:i},(n||o)&&(t.fetchOptions.body=n||o),(CR||r.authMode==="anonymous")&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||r.query?.token||n?.get("token")),!t.hasToken){const l=vT(e);l&&(r.query??={},r.query.token=l,t.hasToken=!0)}if(t.useIdentity&&!t.hasToken&&!t.credential&&!t.credentialToken&&!AR(e)&&!Cr(i)){let l;r.authMode==="immediate"?(await S_(),l=await Se.getCredential(e,{signal:i})):r.authMode==="no-prompt"?(await S_(),l=await Se.getCredential(e,{prompt:!1,signal:i}).catch(()=>{})):Se&&(l=Se.findCredential(e)),l&&(t.credential=l,t.credentialToken=l.token,t.useSSL=!!l.ssl)}}function AR(t){return O7.some(e=>e.test(t))}async function A7(t){let e=t.params.url,r=dI(e);const i=t.params.requestOptions,s=t.fetchOptions??{},n=Dh(e)||zu(e),o=i.responseType||"json",l=n?0:i.timeout!=null?i.timeout:ss.timeout;let u=!1;if(!n){t.useSSL&&(e=dT(e));let y={...i.query};t.credentialToken&&(y.token=t.credentialToken);let g=fm(y);k("esri-url-encodes-apostrophe")&&(g=g.replaceAll("'","%27"));const v=r.length+1+g.length;let _;u=i.method==="delete"||i.method==="post"||i.method==="put"||!!i.body||v>ss.maxUrlLength;const S=i.useProxy||!!pw(e);if(S){const M=oR(e);_=M.path,!u&&_.length+1+v>ss.maxUrlLength&&(u=!0),M.query&&(y={...M.query,...y})}if(s.method==="HEAD"&&(u||S)){if(u)throw v>ss.maxUrlLength?tn("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):tn("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(S)throw tn("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}u?(s.method=i.method==="delete"?"DELETE":i.method==="put"?"PUT":"POST",i.body?e=Eb(e,y):(s.body=fm(y),s.headers||(s.headers={}),s.headers["Content-Type"]="application/x-www-form-urlencoded")):e=Eb(e,y),S&&(t.useProxy=!0,e=`${_}?${e}`),y.token&&PR&&s.body instanceof FormData&&!eR(e)&&s.body.set("token",y.token),i.hasOwnProperty("withCredentials")?t.withCredentials=i.withCredentials:Cn(e,nT())||(lT(e)||Se&&Se.findServerInfo(e)?.webTierAuth)&&(t.withCredentials=!0),t.withCredentials&&(s.credentials="include",x7(e)&&await T7(u?Eb(e,y):e)),r=dI(e)}let d,p,f=0,m=!1;l>0&&(f=setTimeout(()=>{m=!0,t.controller.abort()},l));try{if(i.responseType==="native-request-init")p=s,p.url=r,i.signal?p.signal=i.signal:delete p.signal;else if(i.responseType!=="image"||s.cache!=="default"||s.keepalive||s.method!=="GET"||u||R7(i.headers)||!n&&!t.useProxy&&ss.proxyUrl&&!hI(e)){if(Ae._beforeFetch&&await Ae._beforeFetch(e,s),d=await fetch(r,s),Ae._afterFetch&&await Ae._afterFetch(d),t.useProxy||k7(e),i.responseType==="native")p=d;else if(s.method!=="HEAD")if(d.ok){switch(o){case"array-buffer":p=await d.arrayBuffer();break;case"blob":case"image":p=await d.blob();break;default:p=await d.text()}if(f&&(clearTimeout(f),f=0),o==="json"||o==="xml"||o==="document")if(p)switch(o){case"json":p=JSON.parse(p);break;case"xml":p=fI(p,"application/xml");break;case"document":p=fI(p,"text/html")}else p=null;if(p){if(o==="array-buffer"||o==="blob"){const y=d.headers.get("Content-Type");if(y&&/application\/json|text\/plain/i.test(y)&&p[o==="blob"?"size":"byteLength"]<=750)try{const g=await new Response(p).json();g.error&&(p=g)}catch{}}o==="image"&&p instanceof Blob&&(p=await mI(URL.createObjectURL(p),t,!0))}}else{p=await d.text();try{p=JSON.parse(p)}catch{}}}else p=await mI(r,t)}catch(y){if(y.name==="AbortError")throw m?S7():Fe("Request canceled");if(!(!d&&y instanceof TypeError&&ss.proxyUrl)||i.body||i.method==="delete"||i.method==="head"||i.method==="post"||i.method==="put"||t.useProxy||hI(e))throw y;t.redoRequest=!0,LU({proxyUrl:ss.proxyUrl,urlPrefix:ji(e)??""})}finally{f&&clearTimeout(f)}return[d,p]}async function pI(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let r,i;try{i=await t.before(e)}catch(s){r=tn("request:interceptor",s,e)}if((i instanceof Error||i instanceof x)&&(r=tn("request:interceptor",i,e)),r)throw t.error&&t.error(r),r;return i}}function R7(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function fI(t,e){let r;try{r=new DOMParser().parseFromString(t,e)}catch{}if(!r||r.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return r}Ae._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],Ae._beforeFetch=void 0,Ae._afterFetch=void 0;const L7=new Map;async function F7(t){const e=D7(t.params.url);if(!e)return $_(t);const{QueueProcessor:r}=await N(()=>import("./QueueProcessor-9uNcUb7f.js"),[]);return jh(L7,e.origin,()=>{const s=e.isHosted?k("request-queue-concurrency-hosted"):k("request-queue-concurrency-non-hosted");return new r({concurrency:s,process:n=>{if(Cr(n.params.requestOptions))throw tn("",Fe("Request canceled"),n.params);return $_(n)}})}).push(t)}async function $_(t){let e,r;await P7(t);try{do[e,r]=await A7(t);while(!await N7(t,e,r))}catch(n){const o=tn("request:server",n,t.params,e);throw o.details.ssl=t.useSSL,t.interceptor?.error&&t.interceptor.error(o),o}const i=t.params.url;if(r)if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(i)){if(!t.hasToken&&!t.credentialToken&&r.user?.username&&!lT(i)){const n=ji(i,!0);n&&ss.trustedServers.push(n)}Array.isArray(r.authorizedCrossOriginNoCorsDomains)&&$7(r.authorizedCrossOriginNoCorsDomains)}else(t.params.requestOptions.responseType||"json")==="json"&&M7(i,r);const s=t.credential;if(s&&Se){let o=Se.findServerInfo(s.server)?.owningSystemUrl;if(o){o=o.replace(/\/?$/,"/sharing");const l=Se.findCredential(o,s.userId);l&&Se._getIdenticalSvcIdx(o,l)===-1&&l.resources.unshift(o)}}return{data:r,getAllHeaders:e?()=>Array.from(e.headers):gh,getHeader:e?n=>e.headers.get(n):gh,httpStatus:e?.status??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function N7(t,e,r){if(t.redoRequest)return t.redoRequest=!1,!1;const i=t.params.requestOptions;if(!e||i.responseType==="native"||i.responseType==="native-request-init")return!0;let s,n;if(r&&(r.error&&typeof r.error=="object"?s=r.error:r.status==="error"&&Array.isArray(r.messages)&&(s={...r},s[ev]=r,s.details=r.messages)),!s&&!e.ok)throw s=new Error(`Unable to load ${e.url} status: ${e.status}`),s[ev]=r,s;let o,l=null;s&&(n=Number(s.code),l=s.hasOwnProperty("subcode")?Number(s.subcode):null,o=s.messageCode,o=o?.toUpperCase());const u=i.authMode;if(n===403&&(l===4||s.message?.toLowerCase().includes("ssl")&&!s.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(u!=="no-prompt"||n===498)&&n!==void 0&&I7.has(n)&&!AR(t.params.url)&&(n!==403||(!o||!E7.has(o))&&(l==null||l===2&&t.credentialToken))){await S_();try{const d=await Se.getCredential(t.params.url,{error:tn("request:server",s,t.params),credential:t.credential,prompt:u!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=d,t.credentialToken=d.token,t.useSSL=t.useSSL||d.ssl,!1}catch(d){if(u==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;s=d}}if(s)throw s;return!0}function mI(t,e,r=!1){const i=e.controller.signal,s=new Image;return e.withCredentials?s.crossOrigin="use-credentials":s.crossOrigin="anonymous",s.alt="",s.fetchPriority=ss.priority,s.src=t,_7(s,t,r,i)}function D7(t){let e,r;return typeof t=="string"?(e=ji(t,!0),r=Q0(t)):(e=t.origin,r=Q0(t.toString())),e==null?null:{origin:e,isHosted:r}}function j7(t){return t?.release&&typeof t.release=="function"}function V7(t){return t?.acquire&&typeof t.acquire=="function"}var Ba;let Uh=(Ba=class{constructor(e,r,i,s=1,n=0){this._creator=e,this._acquireFunction=r,this._releaseFunction=i,this.allocationSize=s,this._pool=new Array(n),this._initialSize=n;for(let o=0;o<n;o++)this._pool[o]=this._creator();this.allocationSize=Math.max(s,1)}destroy(){this.prune(0)}acquire(...e){let r;if(Ba.test.disabled)r=this._creator();else{if(this._pool.length===0){const i=this.allocationSize;for(let s=0;s<i;s++)this._pool[s]=this._creator()}r=this._pool.pop()}return this._acquireFunction?this._acquireFunction(r,...e):V7(r)&&r.acquire(...e),r}release(e){e&&!Ba.test.disabled&&(this._releaseFunction?this._releaseFunction(e):j7(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let r=e;r<this._pool.length;++r){const i=this._pool[r];this._dispose(i)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}},Ba.test={disabled:!!k("esri-tests-disable-memory-pools")},Ba);function z7(t){t.length=0}let Gr=class{constructor(e=50,r=50){this._pool=new Uh(()=>[],void 0,z7,r,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return Ob.acquire()}static release(e){return Ob.release(e)}static prune(){Ob.prune()}};const Ob=new Gr(100),yI=new WeakMap;function U7(t,e,r=!1){const i=` DEPRECATED - ${e}`;if(!r)return void t.warn(i);let s=yI.get(t);s||(s=new Set,yI.set(t,s)),s.has(e)||(s.add(e),t.warn(i))}const tv="https://www.esriurl.com/";function RR(t,e,r,i={}){k("esri-deprecation-warnings")&&Vo(t,`This widget is deprecated. Use the ${e} component instead.`,{see:[`${e} component reference: ${tv}${r}/`,`Esri's move to web components: ${tv}components-transition-plan/`],replacement:`<${r}></${r}>`,warnOnce:!0,...i})}function q7(t,e,r,i={}){k("esri-deprecation-warnings")&&Vo(t,`This view model is deprecated. Use the ${e} component directly instead.`,{see:[`${e} component reference: ${tv}${r}/`,`Esri's move to web components: ${tv}components-transition-plan/`],replacement:`<${r}></${r}>`,warnOnce:!0,...i})}function Rbe(t,e,r={}){k("esri-deprecation-warnings")&&Vo(t,`Module: ${e}`,r)}function LR(t,e,r={}){if(k("esri-deprecation-warnings")){const{moduleName:i}=r;Vo(t,`Function: ${(i?i+"::":"")+e+"()"}`,r)}}function x_(t,e,r={}){if(k("esri-deprecation-warnings")){const{moduleName:i}=r;Vo(t,`Property: ${(i?i+"::":"")+e}`,r)}}function G7(t,e,r,i={}){if(k("esri-deprecation-warnings")){const{moduleName:s}=i;Vo(t,`'${(s?s+"::":"")+e}' value: ${r}`,i)}}function B7(t,e,r={}){k("esri-deprecation-warnings")&&Vo(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...r})}function Vo(t,e,r={}){if(k("esri-deprecation-warnings")){const{replacement:i,version:s,see:n,warnOnce:o}=r;let l=e;if(i&&(l+=`
	 Replacement: ${i}`),s&&(l+=`
	 Version: ${s}`),n)if(Array.isArray(n)){l+=`
	 See for more details:`;for(const u of n)l+=`
		${u}`}else l+=`
	 See ${n} for more details.`;U7(t,l,o)}}function Lbe(t){const e=[];return function*(){yield*e;let r,i=e.length;for(;!(r=t.next()).done;)for(e.push(r.value),yield r.value;++i<e.length;)yield e[i]}}function H7(t,e){for(const r of t)if(r!=null&&e(r))return r}function rv(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let qh=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(r=>{e+=r.length}),e}add(e,r){if(rv(e)){const i=this._getOrCreateGroup(r);for(const s of e)vI(s)&&i.push(s)}else vI(e)&&this._getOrCreateGroup(r).push(e);return this}forEach(e,r){if(typeof e=="function")this._groups.forEach(i=>i.forEach(e));else{const i=this._getGroup(e);i&&r&&i.forEach(r)}}has(e){return this._groups.has(Iy(e))}remove(e){if(typeof e!="string"&&rv(e)){for(const r of e)this.remove(r);return this}return this.has(e)?(gI(this._getGroup(e)),this._groups.delete(Iy(e)),this):this}removeAll(){return this._groups.forEach(gI),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const r=[];return this._groups.set(Iy(e),r),r}_getGroup(e){return this._groups.get(Iy(e))}};function Iy(t){return t||"_default_"}function gI(t){for(const e of t)e instanceof qh?e.removeAll():e.remove()}function vI(t){return t!=null&&(!!t.remove||t instanceof qh)}const FR=Symbol("Accessor-beforeDestroy");function Qr(t){return t.__accessor__??null}function W7(t,e){return t?.metadata?.[e]!=null}function Eg(t,e,r){return r?iv(t,e,{policy:r,path:""}):iv(t,e,null)}function iv(t,e,r){return e?Object.keys(e).reduce((i,s)=>{const n=s;if(n==="__proto__")return i;let o=null,l="merge";if(r&&(o=r.path?`${r.path}.${s}`:s,l=r.policy(o)),l==="replace"||l==="replace-arrays"&&Array.isArray(i[n]))return i[n]=e[n],i;if(i[n]===void 0)return i[n]=E(e[n]),i;let u=i[n],d=e[n];if(u===d)return i;if(Array.isArray(d)||Array.isArray(i))u=u?Array.isArray(u)?i[n]=u.slice():i[n]=[u]:i[n]=[],d&&(Array.isArray(d)||(d=[d]),d.forEach(p=>{u.includes(p)||u.push(p)}));else if(d&&typeof d=="object")if(r){const p=r.path;r.path=o,i[n]=iv(u,d,r),r.path=p}else i[n]=iv(u,d,null);else i.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(i[n]=d);return i},t||{}):t}function NR(t){return Array.isArray(t)?t:t.split(".")}function wI(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function Z7(t){if(Array.isArray(t)){const e=[];for(const r of t)e.push(...wI(r));return e}return wI(t)}function DR(t,e,r,i){const s=Z7(e);if(s.length!==1){const n=s.map(o=>i(t,o,r));return Uu(n)}return i(t,s[0],r)}function jR(t,e){const r=t.endsWith("?")?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const s=parseInt(r,10);if(!isNaN(s))return Array.isArray(e)?e[s]:e.at(s)}const i=Qr(e);return W7(i,r)?i.get(r):e[r]}function VR(t,e,r){if(t==null)return t;const i=jR(e[r],t);return!i&&r<e.length-1?void 0:r===e.length-1?i:VR(i,e,r+1)}function Jm(t,e,r=0){return typeof e!="string"||e.includes(".")?VR(t,NR(e),r):jR(e,t)}function Ys(t,e){return Jm(t,e)}function bI(t,e){return Jm(e,t)!==void 0}const Li={INITIALIZING:0,CONSTRUCTING:1,CONSTRUCTED:2,DESTROYING:3,DESTROYED:4};function Gh(t){let e=t.constructor.__accessorMetadata__;const r=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!r){e=Object.create(e);for(const i in e)e[i]=E(e[i]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function Ym(t,e){const r=Gh(t);let i=r[e];return i||(i=r[e]={}),i}function J7(t,e){return Eg(t,e,K7)}const Y7=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function K7(t){return Y7.test(t)?"replace":"merge"}let Q7=class{constructor(e,r){this._observers=e,this._observer=r}remove(){Qx(this._observers,this._observer)}},zR=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return X7;this._observers==null&&(this._observers=[]);const r=this._observers;let i=!1,s=!1;const n=r.length;for(let o=0;o<n;++o){const l=r[o];if(l.destroyed)s=!0;else if(l===e){i=!0;break}}return i||(r.push(e),s&&this._removeDestroyedObservers()),new Q7(r,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const r=e.length;let i=0;for(let s=0;s<r;++s){for(;s+i<r&&e[s+i].destroyed;)++i;if(i>0){if(!(s+i<r))break;e[s]=e[s+i]}}e.length=r-i}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const r of e)r.onCommitted();this._observers=null}}};const X7=Te(),rt={Dirty:1,Overridden:2,Computing:4,NonNullable:8,HasDefaultValue:16,DepTrackingInitialized:32,AutoTracked:64,ExplicitlyTracking:128};let gw=class{constructor(e){this.accessed=void 0,this._handles=void 0,this._observer=e}destroy(){this.accessed?.clear(),this.clear()}onAccessed(e){this._observer!=null&&e!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(e))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach(e=>{this._handles.push(e.observe(this._observer))}),this.accessed.clear()))}clear(){if(this._handles!=null){for(let e=0;e<this._handles.length;++e)this._handles[e].remove();this._handles.length=0}}};const sv=new gw,Vp=[];let Rf=sv;function le(t){Rf.onAccessed(t)}let Og=!1,kg=!1;function zo(t,e,r){if(Og)return bT(t,e,r);let i=null;return UR(t),i=e.call(r),qR(),i}function eq(t,e){return zo(sv,t,e)}function bT(t,e,r){const i=Og;Og=!0,UR(t);let s=null;try{s=e.call(r)}catch(n){kg&&L.getLogger("esri.core.accessorSupport.tracking").error(n)}return qR(),Og=i,s}function UR(t){Rf=t,Vp.push(t)}function qR(){const t=Vp.length;if(t>1){const e=Vp.pop();Rf=Vp[t-2],e.onTrackingEnd()}else if(t===1){const e=Vp.pop();Rf=sv,e.onTrackingEnd()}else Rf=sv}function GR(t,e){if(e.flags&rt.DepTrackingInitialized)return;e.flags|=rt.DepTrackingInitialized;const r=kg;kg=!1,e.flags&rt.AutoTracked?bT(e.trackingTarget,e.metadata.get,t):BR(t,e),kg=r}const tq=[];function BR(t,e){e.flags&rt.ExplicitlyTracking||(e.flags|=rt.ExplicitlyTracking,bT(e.trackingTarget,()=>{const r=e.metadata.dependsOn||tq;for(const i of r)if(typeof i!="string"||i.includes(".")){const s=NR(i);for(let n=0,o=t;n<s.length&&o!=null&&typeof o=="object";++n)o=_I(o,s[n],n!==s.length-1)}else _I(t,i,!1)}),e.flags&=-129)}function _I(t,e,r){const i=e.endsWith("?")?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const n=parseInt(i,10);if(!isNaN(n))return Array.isArray(t)?t[n]:t.at(n)}const s=Qr(t);if(s){const n=s.propertiesByName.get(i);n&&(le(n),GR(t,n))}return r?t[i]:void 0}let SI=class extends zR{constructor(e,r){super(),this.propertyName=e,this.metadata=r,this.trackingTarget=new gw(this),this.flags=0,this.flags=rt.Dirty|(r.nonNullable?rt.NonNullable:0)|(r.hasOwnProperty("value")?rt.HasDefaultValue:0)|(r.get===void 0?rt.DepTrackingInitialized:0)|(r.dependsOn===void 0?rt.AutoTracked:0)}destroy(){this.flags&rt.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(e){e.mutable&&le(this);const r=e.store,i=this.propertyName,s=this.flags,n=r.get(i);if(s&rt.Computing||~s&rt.Dirty&&r.has(i))return n;this.flags|=rt.Computing;const o=e.host;let l;s&rt.AutoTracked?l=zo(this.trackingTarget,this.metadata.get,o):(BR(o,this),l=this.metadata.get.call(o)),this.flags|=rt.DepTrackingInitialized,r.set(i,l,1);const u=r.get(i);return u===n?this.flags&=-2:eq(this.commit,this),this.flags&=-5,u}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=-2,this.onCommitted()}onInvalidated(){~this.flags&rt.Overridden&&(this.flags|=rt.Dirty);const e=this._observers;if(e&&e.length>0)for(const r of e)r.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const r=e.slice();for(const i of r)i.onCommitted()}}};const T_=8;function Co(t){switch(t){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"link-chart":return 6;case"user":return 7;default:return null}}function mm(t){switch(t){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"link-chart";case 7:return"user"}}function rq(t){return mm(t)}let iq=class HR{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const r=new HR;return this._values.forEach((i,s)=>{e&&e.has(s)||r.set(s,E(i))}),r}get(e){return this._values.get(e)}originOf(){return 7}keys(){return[...this._values.keys()]}set(e,r){this._values.set(e,r)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}isAtOrigin(e,r){return this.has(e)}isBelowOrigin(e,r){return!this.has(e)}forEach(e){this._values.forEach(e)}};function Ku(t,e,r){return t!==void 0}function $I(t,e,r,i){return t!==void 0&&(!(r==null&&t.flags&rt.NonNullable)||(i.lifecycle,!1))}let sq=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=Li.INITIALIZING,this.store=new iq,this.mutable=!0,this._origin=7;const r=this.host.constructor.__accessorMetadata__;for(const i in r){const s=new SI(i,r[i]);this.propertiesByName.set(i,s)}this.metadata=r}initialize(){this.lifecycle=Li.CONSTRUCTING}constructed(){this.lifecycle=Li.CONSTRUCTED}destroy(){this.lifecycle=Li.DESTROYED,this.propertiesByName.forEach(e=>e.destroy())}get initialized(){return this.lifecycle!==Li.INITIALIZING}get(e){const r=this.propertiesByName.get(e);if(!Ku(r))return;if(r.metadata.get)return r.getComputed(this);this.mutable&&le(r);const i=this.store;return i.has(e)?i.get(e):r.metadata.value}originOf(e){const r=this.store.originOf(e);if(r===void 0){const i=this.propertiesByName.get(e);if(i!==void 0&&i.flags&rt.HasDefaultValue)return"defaults"}return mm(r)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const r=this.propertiesByName.get(e);if(Ku(r))return this.store.has(e)?this.store.get(e):r.metadata.value}internalSet(e,r){const i=this.propertiesByName.get(e);Ku(i)&&this._internalSet(i,r)}getDependsInfo(e,r,i){const s=this.propertiesByName.get(r);if(!Ku(s))return"";const n=new gw,o=zo(n,()=>s.metadata.get?.call(e));let l=`${i}${e.declaredClass.split(".").pop()}.${r}: ${o}
`;const u=n.accessed??new Set;if(u.size===0)return l;i+="  ";for(const d of u)d instanceof SI&&(l+=`${i}${d.propertyName}: undefined
`);return l}setAtOrigin(e,r,i){const s=this.propertiesByName.get(e);if(Ku(s))return this._setAtOrigin(s,r,i)}isOverridden(e){const r=this.propertiesByName.get(e);return r!==void 0&&!!(r.flags&rt.Overridden)}clearOrigin(e,r){const i=this.store,s=this.propertiesByName.get(e);if(!Ku(s))return;const n=i.isAtOrigin(e,r)&&!(s.flags&rt.Overridden);i.delete(e,r),n&&s.notifyChange()}clearOverride(e){const r=this.propertiesByName.get(e);r&&r.flags&rt.Overridden&&(r.flags&=-3,r.notifyChange())}override(e,r){const i=this.propertiesByName.get(e);if(!$I(i,e,r,this))return;const s=i.metadata.cast;if(s){const n=this._cast(s,r),{valid:o,value:l}=n;if(kb.release(n),!o)return;r=l}i.flags|=rt.Overridden,this._internalSet(i,r)}set(e,r){const i=this.propertiesByName.get(e);if(!$I(i,e,r,this))return;const s=i.metadata.cast;if(s){const o=this._cast(s,r),{valid:l,value:u}=o;if(kb.release(o),!l)return;r=u}const n=i.metadata.set;n?n.call(this.host,r):this._internalSet(i,r)}setDefaultOrigin(e){this._origin=Co(e)}getDefaultOrigin(){return mm(this._origin)}notifyChange(e){const r=this.propertiesByName.get(e);r!==void 0&&r.notifyChange()}invalidate(e){const r=this.propertiesByName.get(e);r!==void 0&&r.invalidate()}commit(e){const r=this.propertiesByName.get(e);r!==void 0&&r.commit()}_internalSet(e,r){const i=this.lifecycle!==Li.INITIALIZING?this._origin:0;this._setAtOrigin(e,r,i)}_setAtOrigin(e,r,i){const s=this.store,n=e.propertyName;if(s.isAtOrigin(n,i)&&rT(r,s.get(n))&&~e.flags&rt.Overridden)return;const o=s.isBelowOrigin(n,i)||s.isAtOrigin(n,i);o&&e.invalidate(),s.set(n,r,i),o&&e.commit(),GR(this.host,e)}_cast(e,r){const i=kb.acquire();return i.valid=!0,i.value=r,e&&(i.value=e.call(this.host,r,i)),i}},nq=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const kb=new Uh(()=>new nq);function nv(t,e,r){if(t&&e)if(typeof e=="object")for(const i of Object.getOwnPropertyNames(e))nv(t,i,e[i]);else{if(e.includes(".")){const s=e.split("."),n=s.splice(-1,1)[0];return void nv(Ys(t,s),n,r)}const i=t.__accessor__;i!=null&&oq(e,i),t[e]=r}}function oq(t,e){if(k("esri-unknown-property-errors")&&!aq(t,e))throw new x("set:unknown-property",lq(t,e))}function aq(t,e){return e.metadata[t]!=null}function lq(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let uq;function cq(){return uq}let WR=class extends Uh{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const r=super.acquire(...e);return this._set.delete(r),r}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const Ey=[];function ov(t){Ey.push(t),Ey.length===1&&queueMicrotask(()=>{const e=Ey.slice();Ey.length=0;for(const r of e)r()})}let Lf=class{constructor(e,r=30){this.name=e,this._counter=0,this._samples=new Array(r)}push(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}set(e){e!=null&&(this._samples[this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,r)=>e-r)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,r)=>e+r,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};const av=(t,e,r,i)=>{let s=e,n=e;const o=r>>>1,l=t[s-1];for(;n<=o;){n=s<<1,n<r&&i(t[n-1],t[n])<0&&++n;const u=t[n-1];if(i(u,l)<=0)break;t[s-1]=u,s=n}t[s-1]=l},ZR=(t,e)=>t<e?-1:t>e?1:0;function dq(t,e,r,i){r===void 0&&(r=t.length),i===void 0&&(i=ZR);for(let n=r>>>1;n>e;n--)av(t,n,r,i);const s=e+1;for(let n=r-1;n>e;n--){const o=t[e];t[e]=t[n],t[n]=o,av(t,s,n,i)}}function*hq(t,e,r,i){r===void 0&&(r=t.length),i===void 0&&(i=ZR);for(let n=r>>>1;n>e;n--)av(t,n,r,i),yield;const s=e+1;for(let n=r-1;n>e;n--){const o=t[e];t[e]=t[n],t[n]=o,av(t,s,n,i),yield}}const pq=1.5,fq=1.1;let JR=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new NA,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>xI(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const r=new Array;for(let i=0;i<this._length;i++){const s=this.data[i];e(s)&&r.push(s)}return r}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,r){const i=this.data.indexOf(e,r);return i!==-1&&i<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let r=e;r<this._length;++r)this.data[r]=this._deallocator(this.data[r]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,r=e.length){for(let i=0;i<r;i++)this.data[this._length++]=e[i]}fill(e,r){for(let i=0;i<r;i++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,xI(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const r=d_(this.data,e,this.length,this._hint);if(r!==-1)return this.data.splice(r,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(d_(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,r=e.length,i){this.length=lU(this.data,e,this.length,r,this._hint,i),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,r){if(e>=this.length||r>=this.length||e===r)return;const i=this.data[e];this.data[e]=this.data[r],this.data[r]=i}sort(e){dq(this.data,0,this.length,e)}iterableSort(e){return hq(this.data,0,this.length,e)}some(e,r){for(let i=0;i<this.length;++i)if(e.call(r,this.data[i],i,this.data))return!0;return!1}find(e,r){const{data:i,length:s}=this;for(let n=0;n<s;++n)if(e.call(r,i[n]))return i[n]}filterInPlace(e,r){let i=0;for(let s=0;s<this._length;++s){const n=this.data[s];e.call(r,n,s,this.data)&&(this.data[s]=this.data[i],this.data[i]=n,i++)}if(this._deallocator)for(let s=i;s<this._length;s++)this.data[s]=this._deallocator(this.data[s]);return this._length=i,this._shrink(),this}forAll(e,r){const{data:i,length:s}=this;for(let n=0;n<s;++n)e.call(r,i[n],n,i)}forEach(e,r){this.data.slice(0,this.length).forEach(e,r)}map(e,r){const i=new Array(this.length);for(let s=0;s<this.length;++s)i[s]=e.call(r,this.data[s],s,this.data);return i}reduce(e,r){let i=r;for(let s=0;s<this.length;++s)i=e(i,this.data[s],s,this.data);return i}has(e){const r=this.length,i=this.data;for(let s=0;s<r;++s)if(i[s]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function xI(t){t.data.length>pq*t.length&&(t.data.length=Math.floor(t.length*fq))}function Hbe(t){return t}function mq(t){return 1e3*t}function Wbe(t){return t}function Zbe(t){return .001*t}let yq=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},gq=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},M_=0;const fp={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},I_=["prepare","preRender","render","postRender","update","finish"],E_=[],Eu=new JR;let vq=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1,YR()}};function wq(){hu!=null&&(cancelAnimationFrame(hu),hu=requestAnimationFrame(_T))}function YR(){hu==null&&(M_=performance.now(),hu=requestAnimationFrame(_T))}const lv={frameTasks:Eu,willDispatch:!1,clearFrameTasks:bq,dispatch:QR,executeFrameTasks:_q,reschedule:wq};function Bh(t){const e=new gq(t);return E_.push(e),lv.willDispatch||(lv.willDispatch=!0,ov(QR)),e}function vh(t){const e=new yq(t);return Eu.push(e),YR(),new vq(e)}let hu=null;function bq(t=!1){Eu.forAll(e=>{e.removed=!0}),t&&KR()}function _T(){const t=performance.now();hu=null,hu=Eu.some(r=>!r.paused&&!r.removed)?requestAnimationFrame(_T):null,lv.executeFrameTasks(t)}function _q(t){const e=t-M_;M_=t;const r=1e3/60,i=Math.max(0,e-r);fp.time=t,fp.frameDuration=r-i;for(let s=0;s<I_.length;s++){const n=performance.now(),o=I_[s];Eu.forAll(l=>{l.paused||l.removed||(s===0&&l.ticks++,l.phases[o]&&(fp.elapsedFrameTime=performance.now()-t,fp.deltaTime=l.ticks===0?0:e,l.phases[o]?.call(l,fp)))}),xq[s].push(performance.now()-n)}KR(),Tq.push(performance.now()-t)}const Oy=new JR;function KR(){Eu.forAll(t=>{t.removed&&Oy.push(t)}),Eu.removeUnorderedMany(Oy.data,Oy.length),Oy.clear()}function QR(){for(;E_.length;){const t=E_.shift();t.isActive&&t.callback()}lv.willDispatch=!1}function Sq(t=1,e){const r=wi(),i=()=>{Cr(e)?r.reject(Fe()):t===0?r():(--t,ov(()=>i()))};return i(),r.promise}function $q(t){return Sq(1,t)}async function XR(t){await $q(t),await new Promise(e=>requestAnimationFrame(()=>{t?.aborted||e()}))}const xq=I_.map(t=>new Lf(t)),Tq=new Lf("total");function eL(t,e){for(const r of t.values())if(e(r))return!0;return!1}function uv(t,e){if(!e)return t;for(const r of e)r!=null&&t.add(r);return t}function TI(t,e){return e!=null&&t.add(e),t}function ST(t,e){const r=new Set;return uv(r,t),uv(r,e),r}function Mq(t,e){const r=new Set;for(const i of e)t.has(i)&&r.add(i);return r}function Qbe(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const r of t)if(!e.has(r))return!1;return!0}function Xbe(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}function Iq(t,e){const r=new Set(t);for(const i of e)r.delete(i);return r}function Eq(t,e){return Iq(ST(t,e),Mq(t,e))}let Oq=0;function Cg(){return++Oq}let vw=class extends gw{constructor(e){super(new kq(e)),this._observer&&MI.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&MI.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}},kq=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=Cq}};const MI=new FinalizationRegistry(t=>{t.deref()?.destroy()});function Cq(){}let Sd=!1;const cv=[];function tL(t,e){let r=new vw(n),i=null,s=!1;function n(){if(!r||s)return;if(Sd)return void sL(n);const l=i;r.clear(),Sd=!0,s=!0,i=zo(r,t),s=!1,Sd=!1,e(i,l),nL()}function o(){r&&(r.destroy(),r=null,i=null)}return s=!0,i=zo(r,t),s=!1,Te(o)}function rL(t,e){let r=new vw(s),i=null;function s(){e(i,o)}function n(){r&&(r.destroy(),r=null),i=null}function o(){return r?(r.clear(),i=zo(r,t),i):null}return o(),Te(n)}function iL(t,e){let r=!1,i=!1;const s=!!e?.sync;let n=new vw(()=>{r||i||(i=!0,s?o():queueMicrotask(o))});function o(){i=!1,n&&!r&&(Sd?sL(o):(n.clear(),Sd=!0,r=!0,zo(n,t),r=!1,Sd=!1,nL()))}function l(){n&&(n.destroy(),n=null)}return r=!0,zo(n,t),r=!1,Te(l)}function sL(t){cv.includes(t)||cv.unshift(t)}function nL(){for(;cv.length;)cv.pop()()}var wu;let $T=(wu=class{constructor(){this.uid=Cg(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,r,i,s,n){return this.pool.acquire(0,e,r,i,s,n,rT)}static acquireTracked(e,r,i,s){return this.pool.acquire(1,e,r,i,null,null,s)}notify(e,r){this.type===0?this.callback.call(this.target,e,r,this.path,this.target):this.callback.call(null,e,r,void 0,void 0)}acquire(e,r,i,s,n,o,l){this.uid=Cg(),this.removed=!1,this.type=e,this.oldValue=r,this.callback=i,this.getValue=s,this.target=n,this.path=o,this.equals=l}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=Cg(),this.removed=!0}},wu.pool=new WR(()=>new wu),wu);const Pg=new Gr,Lo=new Set;let dv;function hv(t){Lo.delete(t),Lo.add(t),oL()}function oL(){dv||(dv=Bh(Rq))}function Pq(t){if(t.removed)return;const e=t.oldValue,r=t.getValue();t.equals(e,r)||(t.oldValue=r,t.notify(r,e))}function Aq(t){for(const e of Lo.values())e.target===t&&(e.removed=!0)}function Rq(){let t=10;for(;dv&&t--;){dv=null;const e=Lq(),r=Pg.acquire();for(const i of e){const s=i.uid;Pq(i),s===i.uid&&i.removed&&r.push(i)}for(const i of Lo)i.removed&&(r.push(i),Lo.delete(i));for(const i of r)$T.pool.release(i);Pg.release(r),Pg.release(e),O_.forEach(i=>i())}}function Lq(){const t=Pg.acquire();t.length=Lo.size;let e=0;for(const r of Lo)t[e]=r,++e;return Lo.clear(),t}const O_=new Set;function Fq(t){return O_.add(t),Te(()=>O_.delete(t))}function Nq(t,e,r){let i=DR(t,e,r,(s,n,o)=>{let l,u,d=rL(()=>Jm(s,n),(p,f)=>{s.__accessor__?.lifecycle===Li.DESTROYED||l&&l.uid!==u?i.remove():(l||(l=$T.acquireUntracked(p,o,f,s,n),u=l.uid),hv(l))});return Te(()=>{d.remove(),l&&(l.uid!==u||l.removed||(l.removed=!0,hv(l)),l=null),i=d=null})});return i}function Dq(t,e,r){const i=DR(t,e,r,(s,n,o)=>{let l=!1;return tL(()=>Jm(s,n),(u,d)=>{s.__accessor__.lifecycle!==Li.DESTROYED?l||(l=!0,rT(d,u)||o.call(s,u,d,n,s),l=!1):i.remove()})});return i}function jq(t,e,r,i=!1){return t.__accessor__&&t.__accessor__.lifecycle!==Li.DESTROYED?i?Dq(t,e,r):Nq(t,e,r):Te()}function Vq(t,e,r){let i,s,n=rL(t,(o,l)=>{i&&i.uid!==s?n.remove():(i||(i=$T.acquireTracked(o,e,l,r),s=i.uid),hv(i))});return Te(()=>{n.remove(),i&&(i.uid!==s||i.removed||(i.removed=!0,hv(i)),i=null),n=null})}function zq(t,e,r){let i=!1;return tL(t,(s,n)=>{i||(i=!0,r(n,s)||e(s,n),i=!1)})}function Uq(t,e,r=!1,i=ZA){return r?zq(t,e,i):Vq(t,e,i)}function II(t){return eL(Lo,e=>e.oldValue===t)}const pu=()=>L.getLogger("esri.core.accessorSupport.ensureTypes");function qq(t){if(t==null)return t;const e=new Date(t);return isNaN(e.getTime())?(pu().error("Accessor#set",`Invalid date value: '${t}', falling back to current date`),new Date):e}function Gq(t){return t==null?t:!!t}function Km(t){return t==null?t:t.toString()}function Br(t,e=0){return t==null?t:(t=parseFloat(t),isNaN(t)?e:t)}function xT(t){return t==null?t:Math.round(parseFloat(t))}function Bq(t){return null}function Hq(t,e){return r=>{let i=t(r);return e.step!=null&&(i=Math.round(i/e.step)*e.step),e.min!=null&&(i=Math.max(e.min,i)),e.max!=null&&(i=Math.min(e.max,i)),i}}function aL(t){return t?.constructor&&t.constructor.__accessorMetadata__!==void 0}function pv(t,e){return e!=null&&t&&!(e instanceof t)}function lL(t){return t&&"isCollection"in t}function EI(t){return t?.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function Wq(t,e){if(!e?.constructor||!lL(e.constructor))return k_(t,e)?e:new t(e);const r=EI(t.prototype.itemType),i=EI(e.constructor.prototype.itemType);return r?i?r===i?e:r.prototype.isPrototypeOf(i.prototype)?new t(e):(k_(t,e),e):new t(e):e}function k_(t,e){return!!aL(e)&&(pu().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+ww(t)+"'"),!0)}function Hh(t,e){return e==null?e:lL(t)?Wq(t,e):pv(t,e)?k_(t,e)?e:new t(e):e}function ww(t){return t?.prototype?.declaredClass||"unknown"}const Zq=new WeakMap;function Jq(t){switch(t){case Number:return e=>Br(e);case xe:return xT;case Boolean:return Gq;case String:return Km;case Date:return qq;case bw:return Bq;default:return jh(Zq,t,()=>Hh.bind(null,t))}}function ut(t,e){const r=Jq(t);return arguments.length===1?r:r(e)}function ym(t,e,r){return arguments.length===1?ym.bind(null,t):e&&(Array.isArray(e)?e.map(i=>t(i,r)):[t(e,r)])}function Yq(t,e){return arguments.length===1?ym(r=>ut(t,r)):ym(r=>ut(t,r),e)}function uL(t,e,r){return e!==0&&Array.isArray(r)?r.map(i=>uL(t,e-1,i)):t(r)}function fv(t,e,r){if(arguments.length===2)return n=>fv(t,e,n);if(!r)return r;r=uL(t,e,r);let i=e,s=r;for(;i>0&&Array.isArray(s);)i--,s=s[0];if(s!==void 0)for(let n=0;n<i;n++)r=[r];return r}function Kq(t,e,r){return arguments.length===2?fv(i=>ut(t,i),e):fv(i=>ut(t,i),e,r)}function cL(t){return!!Array.isArray(t)&&!t.some(e=>{const r=typeof e;return!(r==="string"||r==="number"||r==="function"&&t.length>1)})}function C_(t,e){if(arguments.length===2)return C_(t).call(null,e);const r=new Set,i=t.filter(l=>typeof l!="function"),s=t.filter(l=>typeof l=="function");for(const l of t)typeof l!="string"&&typeof l!="number"||r.add(l);let n=null,o=null;return(l,u)=>{if(l==null)return l;const d=typeof l,p=d==="string"||d==="number";return p&&(r.has(l)||s.some(f=>d==="string"&&f===String||d==="number"&&f===Number))||d==="object"&&s.some(f=>!pv(f,l))?l:(p&&i.length?(n||(n=i.map(f=>typeof f=="string"?`'${f}'`:`${f}`).join(", ")),pu().error("Accessor#set",`'${l}' is not a valid value for this property, only the following values are valid: ${n}`)):typeof l=="object"&&s.length?(o||(o=s.map(f=>ww(f)).join(", ")),pu().error("Accessor#set",`'${l}' is not a valid value for this property, value must be one of ${o}`)):pu().error("Accessor#set",`'${l}' is not a valid value for this property`),u&&(u.valid=!1),null)}}function Nn(t,e){if(arguments.length===2)return Nn(t).call(null,e);const r={},i=[],s=[];for(const u in t.typeMap){const d=t.typeMap[u];r[u]=ut(d),i.push(ww(d)),s.push(u)}const n=()=>`'${i.join("', '")}'`,o=()=>`'${s.join("', '")}'`,l=typeof t.key=="string"?u=>u[t.key]:t.key;return u=>{if(t.base&&!pv(t.base,u)||u==null)return u;const d=l(u)||t.defaultKeyValue,p=r[d];if(!p)return pu().error("Accessor#set",`Invalid property value, value needs to be one of ${n()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!pv(t.typeMap[d],u))return u;if(typeof t.key=="string"&&!aL(u)){const f={};for(const m in u)m!==t.key&&(f[m]=u[m]);return p(f)}return p(u)}}let xe=class{},bw=class{};const s1e={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function Qq(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function dL(t){switch(t.type){case"native":return ut(t.value);case"array":return ym(dL(t.value));case"one-of":return Xq(t);default:return null}}function Xq(t){let e=null;return(r,i)=>A_(r,t)?r:(e==null&&(e=P_(t)),pu().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),i&&(i.valid=!1),null)}function P_(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case xe:return"integer";case Date:return"date";case bw:return"null";default:return ww(t.value)}case"array":return`array of ${P_(t.value)}`;case"one-of":{const e=t.values.map(r=>P_(r));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function A_(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case xe:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case bw:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(r=>!A_(r,e.value));case"one-of":return e.values.some(r=>A_(t,r))}}function c(t={}){return(e,r)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${r}. Accessor does not support static properties.`);const i=Object.getOwnPropertyDescriptor(e,r),s=Ym(e,r);i&&(i.get||i.set?(s.get=i.get||s.get,s.set=i.set||s.set):"value"in i&&("value"in t&&L.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${r}" on "${e.constructor.name}" already defined in the metadata`,t),s.value=t.value=i.value)),t.readOnly!=null&&(s.readOnly=t.readOnly);const n=t.aliasOf;if(n){const u=typeof n=="string"?n:n.source,d=typeof n=="string"?null:n.overridable===!0;let p;s.dependsOn=[u],s.get=function(){let f=Ys(this,u);if(typeof f=="function"){p||(p=u.split(".").slice(0,-1).join("."));const m=Ys(this,p);m&&(f=f.bind(m))}return f},s.readOnly||(s.set=d?function(f){this._override(r,f)}:function(f){nv(this,u,f)})}const o=t.type,l=t.types;if(!s.cast){let u;o?u=eG(o):l&&(u=Array.isArray(l)?ym(Nn(l[0])):Nn(l)),t.cast=tG(t.cast,u)}J7(s,t),t.range&&(s.cast=Hq(s.cast,t.range))}}function TT(t,e,r){const i=Ym(t,r);i.json||(i.json={});let s=i.json;return e!==void 0&&(s.origins||(s.origins={}),s.origins[e]||(s.origins[e]={}),s=s.origins[e]),s}function eG(t){let e=0,r=t;if(Qq(t))return dL(t);for(;Array.isArray(r)&&r.length===1&&typeof r[0]!="string"&&typeof r[0]!="number";)r=r[0],e++;const i=r;if(cL(i))return e===0?C_(i):fv(C_(i),e);if(e===1)return Yq(i);if(e>1)return Kq(i,e);const s=t;return s.from?s.from:ut(s)}function tG(t,e){if(t||e)return t?e?(r,i)=>e(t(r,i),i):t:e}function rG(t){if(t.json&&t.json.origins){const e=t.json.origins,r={"web-document":["web-scene","web-map"]};for(const i in r)if(e[i]){const s=e[i];r[i].forEach(n=>{e[n]=s}),delete e[i]}}}let Ui=class extends QA{constructor(e,r,i){super(e,r,i)}};Ui.prototype.type="warning";function hL(t){return!!t&&t.prototype?.declaredClass&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}function iG(t,e){return MT(t,"any",e?.origin)}function mv(t,e){return MT(t,"read",e?.origin)}function pL(t,e){return MT(t,"write",e?.origin)}function MT(t,e,r){let i=t?.json;if(i?.origins&&r){let s;s=r==="link-chart"?i.origins[r]&&(e==="any"||e in i.origins[r])?i.origins[r]:i.origins["web-map"]:i.origins[r],s&&(e==="any"||e in s)&&(i=s)}return i}const R_=()=>L.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function OI(t,e,r){t&&(!r&&!e.read||e.read?.reader||e.read?.enabled===!1||oG(t)&&Bt("read.reader",Wh(t),e))}function Wh(t){const e=t.ndimArray??0;if(e>1)return nG(t);if(e===1)return kI(t);if("type"in t&&mL(t.type)){const r=t.type.prototype?.itemType?.Type,i=kI(typeof r=="function"?{type:r}:{types:r});return(s,n,o)=>{const l=i(s,n,o);return l&&new t.type(l)}}return IT(t)}function IT(t){return"type"in t?sG(t.type):aG(t.types)}function sG(t){return t.prototype.read?(e,r,i)=>{if(e==null)return e;const s=typeof e;if(s!=="object")return void R_().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${s}'`);const n=new t;return n.read(e,i),n}:t.fromJSON}function fL(t,e,r,i){return i!==0&&Array.isArray(e)?e.map(s=>fL(t,s,r,i-1)):t(e,void 0,r)}function nG(t){const e=IT(t),r=fL.bind(null,e),i=t.ndimArray??0;return(s,n,o)=>{if(s==null)return s;s=r(s,o,i);let l=i,u=s;for(;l>0&&Array.isArray(u);)l--,u=u[0];if(u!==void 0)for(let d=0;d<l;d++)s=[s];return s}}function kI(t){const e=IT(t);return(r,i,s)=>{if(r==null)return r;if(Array.isArray(r)){const o=[];for(const l of r){const u=e(l,void 0,s);u!==void 0&&o.push(u)}return o}const n=e(r,void 0,s);return n!==void 0?[n]:void 0}}function mL(t){if(!hL(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?ET(e.Type):yL(e.Type))}function oG(t){return"types"in t?yL(t.types):ET(t.type)}function ET(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||mL(t))}function yL(t){for(const e in t.typeMap)if(!ET(t.typeMap[e]))return!1;return!0}function aG(t){let e=null;const r=t.errorContext??"type",i=t.validate;return(s,n,o)=>{if(s==null)return s;const l=typeof s;if(l!=="object")return void R_().error(`Expected JSON value of type 'object' to deserialize, but got '${l}'`);e||(e=uG(t));const u=t.key;if(typeof u!="string")return;const d=s[lG(u,e,o)],p=d?e[d]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!p){const m=`Type '${d||"unknown"}' is not supported`;return o?.messages&&s&&o.messages.push(new Ui(`${r}:unsupported`,m,{definition:s,context:o})),void R_().error(m)}const f=new p;return f.read(s,o),i?i(f):f}}function lG(t,e,r){const i=Object.values(e)[0],s=Gh(i.prototype)[t],n=mv(s,r),o=n?.read?.source;return o&&typeof o=="string"?o:t}function uG(t){const e={};for(const r in t.typeMap){const i=t.typeMap[r],s=Gh(i.prototype);if(typeof t.key=="function")continue;const n=s[t.key];if(!n)continue;if(n.json?.type&&Array.isArray(n.json.type)&&n.json.type.length===1&&typeof n.json.type[0]=="string"){e[n.json.type[0]]=i;continue}const o=n.json?.write;if(!o?.writer){e[r]=i;continue}const l=o.target,u=typeof l=="string"?l:t.key,d={};o.writer(r,d,u),d[u]&&(e[d[u]]=i)}return e}function cG(t){if(t.json||(t.json={}),PI(t.json),AI(t.json),CI(t.json),t.json.origins)for(const e in t.json.origins)PI(t.json.origins[e]),AI(t.json.origins[e]),CI(t.json.origins[e]);return!0}function CI(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function PI(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function AI(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function RI(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const r=t?.ndimArray??0;t&&(r===1||"type"in t&&hL(t.type))?e.write.writer=pG:r>1?e.write.writer=fG(r):e.types?Array.isArray(e.types)?e.write.writer=hG(e.types[0]):e.write.writer=dG(e.types):e.write.writer=gm}function dG(t){return(e,r,i,s)=>e?gL(e,t,s)?gm(e,r,i,s):void 0:gm(e,r,i,s)}function gL(t,e,r){for(const i in e.typeMap)if(t instanceof e.typeMap[i])return!0;if(r?.messages){const i=e.errorContext??"type",s=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;r&&r.messages&&t&&r.messages.push(new x(`${i}:unsupported`,s,{definition:t,context:r})),L.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(s)}return!1}function hG(t){return(e,r,i,s)=>!e||!Array.isArray(e)?gm(e,r,i,s):gm(e.filter(n=>gL(n,t,s)),r,i,s)}function gm(t,e,r,i){Bt(r,yv(t,i),e)}function yv(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?gv(t):t}function gv(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function pG(t,e,r,i){let s;t===null?s=null:t&&typeof t.map=="function"?(s=t.map(n=>yv(n,i)),typeof s.toArray=="function"&&(s=s.toArray())):s=[yv(t,i)],Bt(r,s,e)}function vL(t,e,r){return r!==0&&Array.isArray(t)?t.map(i=>vL(i,e,r-1)):yv(t,e)}function fG(t){return(e,r,i,s)=>{let n;if(e===null)n=null;else{n=vL(e,s,t);let o=t,l=n;for(;o>0&&Array.isArray(l);)o--,l=l[0];if(l!==void 0)for(let u=0;u<o;u++)n=[n]}Bt(i,n,r)}}function mG(t){const e=yG(t);if(t.json.origins)for(const r in t.json.origins){const i=t.json.origins[r],s=i.types?gG(i):e;OI(s,i,!1),i.types&&!i.write&&t.json.write?.enabled&&(i.write={...t.json.write}),RI(s,i)}OI(e,t.json,!0),RI(e,t.json)}function yG(t){return t.json.types?L_(t.json):t.type?wL(t):L_(t)}function gG(t){return t.type?wL(t):L_(t)}function wL(t){if(!t.type)return;let e=0,r=t.type;for(;Array.isArray(r)&&!cL(r);)r=r[0],e++;return{type:r,ndimArray:e}}function L_(t){if(!t.types)return;let e=0,r=t.types;for(;Array.isArray(r);)r=r[0],e++;return{types:r,ndimArray:e}}function vG(t){cG(t)&&(rG(t),mG(t))}const Cb=new Set,Pb=new Set;function b(t){return e=>{t??="esri.core.Accessor",e.prototype.declaredClass=t,bG(e);const r=[],i=[];let s=e.prototype;for(;s;)s.hasOwnProperty("initialize")&&!Cb.has(s.initialize)&&(Cb.add(s.initialize),r.push(s.initialize)),s.hasOwnProperty("destroy")&&!Pb.has(s.destroy)&&(Pb.add(s.destroy),i.push(s.destroy)),s=Object.getPrototypeOf(s);Cb.clear(),Pb.clear();const n=class extends e{constructor(...l){if(super(...l),this.constructor===n&&typeof this.postscript=="function"){if(r.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let u=r.length-1;u>=0;u--)r[u].call(this)}}),i.length){let u=!1;const d=this[FR];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!u){this.__accessor__.lifecycle=Li.DESTROYING,u=!0,d.call(this);for(let p=0;p<i.length;p++)i[p].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};n.__accessorMetadata__=Gh(e.prototype),n.prototype.declaredClass=t;const o=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(n,"name",{value:o,configurable:!0}),n}}function wG(t,e){return e.get==null?function(){const r=this.__accessor__,i=r.propertiesByName.get(t);if(i===void 0)return;r.mutable&&le(i);const s=r.store;return s.has(t)?s.get(t):i.metadata.value}:function(){const r=this.__accessor__,i=r.propertiesByName.get(t);if(i!==void 0)return i.getComputed(r)}}function bG(t){const e=t.prototype,r=Gh(e),i={};for(const s of Object.getOwnPropertyNames(r)){const n=r[s];vG(n),i[s]={enumerable:!0,configurable:!0,get:wG(s,n),set(o){const l=this.__accessor__;if(l!==void 0){if(l.mutable)return l.initialized&&n.readOnly?LI("read-only",s):l.lifecycle===Li.CONSTRUCTED&&n.constructOnly?LI("construct-only",s):void l.set(s,o)}else Object.defineProperty(this,s,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(t.prototype,i)}const LI=(t,e)=>{L.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)};var FI,NI;function _G(t){if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor?.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const Zo=Symbol("Accessor-Handles"),Ab=Symbol("Accessor-Initialized");var Ha;let X=(Ha=class{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:r,declaredClass:i,constructor:s}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const n=this;class o extends n{constructor(...u){super(...u),this.inherited=null,s&&s.apply(this,u)}}Gh(o.prototype);for(const l in e){const u=e[l];o.prototype[l]=typeof u=="function"?function(...d){const p=this.inherited;let f;this.inherited=function(...m){if(n.prototype[l])return n.prototype[l].apply(this,m)};try{f=u.apply(this,d)}catch(m){throw this.inherited=p,m}return this.inherited=p,f}:e[l]}for(const l in r){const u=_G(r[l]);c(u)(o.prototype,l)}return b(i)(o)}static freeze(e){return e instanceof Ha?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof Ha?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){if(this[FI]=null,this[NI]=!1,this.constructor===Ha)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const r=new sq(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:r}),e.length>0&&(r.ctorArgs=this.normalizeCtorArgs?.apply(this,e)??e[0])}postscript(){const e=this.__accessor__,r=e.ctorArgs;e.initialize(),r&&(this.set(r),e.ctorArgs=null),e.constructed(),this.initialize(),this[Ab]=!0}initialize(){}[FR](){this[Zo]=Ke(this[Zo])}destroy(){this.destroyed||(Aq(this),this.__accessor__.destroy(),cq()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[Ab]}get destroyed(){return this.__accessor__?.lifecycle===Li.DESTROYED||!1}get destroying(){return this.__accessor__?.lifecycle===Li.DESTROYING||!1}commitProperty(e){Ys(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,r){return nv(this,e,r),this}watch(e,r,i){return LR(L.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://arcg.is/1vaqf42#watch",warnOnce:!0}),jq(this,e,r,i)}addHandles(e,r){if(this.destroyed){const i=Array.isArray(e)?e:[e];for(const s of i)s.remove();return}(this[Zo]??=new qh).add(e,r)}removeHandles(e){this[Zo]?.remove(e)}removeAllHandles(){this[Zo]?.removeAll()}removeHandlesReference(e){this[Zo]?.removeReference(e)}hasHandles(e){return this[Zo]?.has(e)===!0}_override(e,r){r===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,r)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,r){r==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,r)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,r){return this.__accessor__.internalSet(e,r),this}},FI=Zo,NI=Ab,Ha);const _w=t=>{const e=t;class r extends e{constructor(){super(...arguments),this._listenersMap=null}clearEvents(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clearEvents()}emit(s,n){let o=this._listenersMap?.get(s);if(!o)return!1;let l=!1;for(const u of o.slice()){const d="deref"in u?u.deref():u;d?d?.call(this,n):l=!0}return l&&(o=o.filter(u=>!("deref"in u)||u.deref()!=null),this._listenersMap.set(s,o)),o.length>0}on(s,n){if(Array.isArray(s)){const l=s.map(u=>this.on(u,n));return Uu(l)}if(s.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const o=this._listenersMap.get(s)||[];return o.push(n),this._listenersMap.set(s,o),Te(()=>{const l=this._listenersMap?.get(s),u=l?.indexOf(n)??-1;u>=0&&l.splice(u,1)})}once(s,n){const o=this.on(s,l=>{o.remove(),("deref"in n?n.deref():n)?.call(null,l)});return o}hasEventListener(s){const n=this._listenersMap?.get(s);return n!=null&&n.length>0}}return r},bL=_w(class{}),_L=bL,Zh=_w(X);function OT(t){return(e,r)=>{e[r]=t}}let Qm=class extends zR{notify(){const e=this._observers;if(e&&e.length>0){const r=e.slice();for(const i of r)i.onInvalidated(),i.onCommitted()}}};var Jn;let SG=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},$G=class{constructor(e,r,i,s,n){this.target=e,this.added=r,this.removed=i,this.start=s,this.deleteCount=n}};const Wi=new Uh(()=>new SG,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1});function DI(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function Rb(t){return t?t instanceof ga?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function Lb(t){if(t?.length)return t[0]}function xG(t,e,r,i){const s=Math.min(t.length-r,e.length-i);let n=0;for(;n<s&&t[r+n]===e[i+n];)n++;return n}function SL(t,e,r,i){e&&e.forEach((s,n,o)=>{t.push(s),SL(t,r.call(i,s,n,o),r,i)})}const Jo=new Set,Yo=new Set,Ko=new Set,Fb=new Map;let TG=0,ga=Jn=class extends Zh{static ofType(t){if(!t)return Jn;if(Fb.has(t))return Fb.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const i in t.typeMap){const s=t.typeMap[i].prototype.declaredClass;e?e+=` | ${s}`:e=s}let r=class extends Jn{};return a([OT({Type:t,ensureType:typeof t=="function"?ut(t):Nn(t)})],r.prototype,"itemType",void 0),r=a([b(`esri.core.Collection<${e}>`)],r),Fb.set(t,r),r}static isCollection(t){return t!=null&&t instanceof Jn}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new Qm,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:TG++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof Jn?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),super.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return le(this._observable),this._items}set items(t){this._emitBeforeChanges(1)||(this._splice(0,this.length,Rb(t)),this._emitAfterChanges(1))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:super.hasEventListener(t))}on(t,e){if(this.destroyed)return Te();if(t==="change"){const r=this._chgListeners,i={removed:!1,callback:e};return r.push(i),this._notifications&&this._notifications.push({listeners:r.slice(),items:this._items.slice(),changes:[]}),Te(()=>{i.removed=!0,r.splice(r.indexOf(i),1)})}return super.on(t,e)}once(t,e){const r="deref"in e?()=>e.deref():()=>e,i=this.on(t,s=>{r()?.call(null,s),i.remove()});return i}add(t,e){if(le(this._observable),this._emitBeforeChanges(1))return this;const r=this.getNextIndex(e??null);return this._splice(r,0,[t]),this._emitAfterChanges(1),this}addMany(t,e=this._items.length){if(le(this._observable),!t?.length)return this;if(this._emitBeforeChanges(1))return this;const r=this.getNextIndex(e);return this._splice(r,0,Rb(t)),this._emitAfterChanges(1),this}at(t){if(le(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(le(this._observable),!this.length||this._emitBeforeChanges(2))return[];const t=this._removeAllRaw();return this._emitAfterChanges(2),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return le(this._observable),this._createNewInstance({items:this._items.map(E)})}concat(...t){le(this._observable);const e=t.map(Rb);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(le(this._observable),!this.length||this._emitBeforeChanges(2))return;const r=this._splice(0,this.length),i=r.length;for(let s=0;s<i;s++)t.call(e,r[s],s,r);this._emitAfterChanges(2)}destroyAll(){this.drain(DI)}destroyMany(t){const e=this.removeMany(t);return e.forEach(DI),e}every(t,e){return le(this._observable),this._items.every(t,e)}filter(t,e){le(this._observable);const r=arguments.length===2?this._items.filter(t,e):this._items.filter(t);return this._createNewInstance({items:r})}find(t,e){return le(this._observable),this._items.find(t,e)}findIndex(t,e){return le(this._observable),this._items.findIndex(t,e)}flatten(t,e){le(this._observable);const r=[];return SL(r,this,t,e),new Jn(r)}forEach(t,e){return le(this._observable),this._items.forEach(t,e)}getItemAt(t){return le(this._observable),this._items[t]}getNextIndex(t){le(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return le(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return le(this._observable),this._items.indexOf(t,e)}join(t=","){return le(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return le(this._observable),this._items.lastIndexOf(t,e)}map(t,e){le(this._observable);const r=this._items.map(t,e);return new Jn({items:r})}reorder(t,e=this.length-1){le(this._observable);const r=this.indexOf(t);if(r!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),r!==e){if(this._emitBeforeChanges(4))return t;this._splice(r,1),this._splice(e,0,[t]),this._emitAfterChanges(4)}return t}}pop(){if(le(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Lb(this._splice(this.length-1,1));return this._emitAfterChanges(2),t}push(...t){return le(this._observable),this._emitBeforeChanges(1)||(this._splice(this.length,0,t),this._emitAfterChanges(1)),this.length}reduce(t,e){le(this._observable);const r=this._items;return arguments.length===2?r.reduce(t,e):r.reduce(t)}reduceRight(t,e){le(this._observable);const r=this._items;return arguments.length===2?r.reduceRight(t,e):r.reduceRight(t)}remove(t){return le(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(le(this._observable),t<0||t>=this.length||this._emitBeforeChanges(2))return;const e=Lb(this._splice(t,1));return this._emitAfterChanges(2),e}removeMany(t){if(le(this._observable),!t?.length||this._emitBeforeChanges(2))return[];const e=t instanceof Jn?t.toArray():t,r=this._items,i=[],s=e.length;for(let n=0;n<s;n++){const o=e[n],l=r.indexOf(o);if(l>-1){const u=1+xG(e,r,n+1,l+1),d=this._splice(l,u);d&&d.length>0&&i.push.apply(i,d),n+=u-1}}return this._emitAfterChanges(2),i}reverse(){if(le(this._observable),this._emitBeforeChanges(4))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(4),this}shift(){if(le(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Lb(this._splice(0,1));return this._emitAfterChanges(2),t}slice(t=0,e=this.length){return le(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return le(this._observable),this._items.some(t,e)}sort(t){if(le(this._observable),!this.length||this._emitBeforeChanges(4)||!this._requiresSort(t))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(4),this}_requiresSort(t=(e,r)=>e===r?0:e<r?-1:1){const e=this.length-1;for(let r=0;r<e;r++)if(t(this.items[r],this.items[r+1])>0)return!0;return!1}splice(t,e,...r){le(this._observable),arguments.length===1&&(e=this.length),e??=0;const i=(e?2:0)|(r.length?1:0);if(this._emitBeforeChanges(i))return[];const s=this._splice(t,e,r)||[];return this._emitAfterChanges(i),s}toArray(){return le(this._observable),this._items.slice()}toJSON(t){return le(this._observable),this.toArray().map(e=>pm(e)?e.toJSON(t):e)}toLocaleString(){return le(this._observable),this._items.toLocaleString()}toString(){return le(this._observable),this._items.toString()}unshift(...t){return le(this._observable),!t.length||this._emitBeforeChanges(1)||(this._splice(0,0,t),this._emitAfterChanges(1)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,r){const i=this._items,s=this.itemType;let n,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=Bh(()=>this._dispatchChange())),t<0&&(t+=this.length),e){if(o=i.splice(t,e),this.hasEventListener("before-remove")){const l=Wi.acquire();l.target=this,l.cancellable=!0;for(let u=0,d=o.length;u<d;u++)n=o[u],l.reset(n),this.emit("before-remove",l),l.defaultPrevented&&(o.splice(u,1),i.splice(t,0,n),t+=1,u-=1,d-=1);Wi.release(l)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const l=Wi.acquire();l.target=this,l.cancellable=!1;const u=o.length;for(let d=0;d<u;d++)l.reset(o[d]),this.emit("after-remove",l);Wi.release(l)}}if(r?.length){if(s){const p=[];for(const f of r){const m=s.ensureType(f);m==null&&f!=null||p.push(m)}r=p}const l=this.hasEventListener("before-add"),u=this.hasEventListener("after-add"),d=t===this.length;if(l||u){const p=Wi.acquire();p.target=this,p.cancellable=!0;const f=Wi.acquire();f.target=this,f.cancellable=!1;for(const m of r)l?(p.reset(m),this.emit("before-add",p),p.defaultPrevented||(d?i.push(m):i.splice(t++,0,m),this._set("length",i.length),u&&(f.reset(m),this.emit("after-add",f)))):(d?i.push(m):i.splice(t++,0,m),this._set("length",i.length),f.reset(m),this.emit("after-add",f));Wi.release(f),Wi.release(p)}else{if(d)for(const p of r)i.push(p);else i.splice(t,0,...r);this._set("length",i.length)}}if((r?.length||o?.length)&&this._notifyChangeEvent(r,o),this.hasEventListener("after-splice")){const l=new $G(this,r,o,t,e);this.emit("after-splice",l)}return o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const r=Wi.acquire();r.target=this,r.cancellable=!0,r.type=t,this.emit("before-changes",r),e=r.defaultPrevented,Wi.release(r)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Wi.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Wi.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const r=e.changes;Jo.clear(),Yo.clear(),Ko.clear();for(const{added:u,removed:d}of r){if(u)if(Ko.size===0&&Yo.size===0)for(const p of u)Jo.add(p);else for(const p of u)Yo.has(p)?(Ko.add(p),Yo.delete(p)):Ko.has(p)||Jo.add(p);if(d)if(Ko.size===0&&Jo.size===0)for(const p of d)Yo.add(p);else for(const p of d)Jo.has(p)?Jo.delete(p):(Ko.delete(p),Yo.add(p))}const i=Gr.acquire();Jo.forEach(u=>{i.push(u)});const s=Gr.acquire();Yo.forEach(u=>{s.push(u)});const n=this._items,o=e.items,l=Gr.acquire();if(Ko.forEach(u=>{o.indexOf(u)!==n.indexOf(u)&&l.push(u)}),e.listeners&&(i.length||s.length||l.length)){const u={target:this,added:i,removed:s,moved:l},d=e.listeners.length;for(let p=0;p<d;p++){const f=e.listeners[p];f.removed||f.callback.call(this,u)}}Gr.release(i),Gr.release(s),Gr.release(l)}Jo.clear(),Yo.clear(),Ko.clear()}};a([c()],ga.prototype,"_updating",void 0),a([c()],ga.prototype,"length",void 0),a([c()],ga.prototype,"items",null),a([c({readOnly:!0})],ga.prototype,"updating",null),ga=Jn=a([b("esri.core.Collection")],ga);const H=ga;function Pn(t,e,r=H){return e||(e=new r),e===t||e.destroyed||(e.removeAll(),MG(t)?e.addMany(t):t&&e.add(t)),e}function $L(t){return t}function MG(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}let IG=class xL{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const r=new xL;return this._values.forEach((i,s)=>{e&&e.has(s)||r.set(s,E(i.value),i.origin)}),r}get(e,r){r=this._normalizeOrigin(r);const i=this._values.get(e);return r==null||i?.origin===r?i?.value:void 0}originOf(e){return this._values.get(e)?.origin??7}keys(e){e=this._normalizeOrigin(e);const r=[...this._values.keys()];return e==null?r:r.filter(i=>this._values.get(i)?.origin===e)}set(e,r,i){if((i=this._normalizeOrigin(i))===0){const s=this._values.get(e);if(s?.origin!=null&&s.origin>i)return}this._values.set(e,new EG(r,i))}delete(e,r){(r=this._normalizeOrigin(r))!=null&&this._values.get(e)?.origin!==r||this._values.delete(e)}has(e,r){return(r=this._normalizeOrigin(r))!=null?this._values.get(e)?.origin===r:this._values.has(e)}isAtOrigin(e,r){return r=this._normalizeOrigin(r),this.has(e,r)&&this.originOf(e)===r}isBelowOrigin(e,r){return r=this._normalizeOrigin(r),!this.has(e)||this.originOf(e)<r}forEach(e){this._values.forEach(({value:r},i)=>e(r,i))}_normalizeOrigin(e){if(e!=null)return e===0?e:7}},EG=class{constructor(e,r){this.value=e,this.origin=r}};function TL(t,e,r){e.keys().forEach(s=>{r.set(s,e.get(s),0)});const i=t.metadata;Object.keys(i).forEach(s=>{t.internalGet(s)&&r.set(s,t.internalGet(s),0)})}function OG(t,e,r){if(!t?.read||t.read.enabled===!1||!t.read.source)return!1;const i=t.read.source;if(typeof i=="string"){if(i===e||i.includes(".")&&i.startsWith(e)&&bI(i,r))return!0}else for(const s of i)if(s===e||s.includes(".")&&s.startsWith(e)&&bI(s,r))return!0;return!1}function kG(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function CG(t,e,r,i,s){let n=mv(e[r],s);kG(n)&&(t[r]=!0);for(const o of Object.getOwnPropertyNames(e))n=mv(e[o],s),OG(n,r,i)&&(t[o]=!0)}function PG(t,e,r,i){const s=r.metadata,n=iG(s[e],i),o=n?.default;if(o===void 0)return;const l=typeof o=="function"?o.call(t,e,i):o;l!==void 0&&r.set(e,l)}const ML={origin:"service"};function IL(t,e,r=ML){if(!e||typeof e!="object")return;const i=Qr(t),s=i.metadata,n={};for(const o of Object.getOwnPropertyNames(e))CG(n,s,o,e,r);i.setDefaultOrigin(r.origin);for(const o of Object.getOwnPropertyNames(n)){const l=mv(s[o],r).read,u=l?.source;let d;d=u&&typeof u=="string"?Jm(e,u):e[o],l?.reader&&(d=l.reader.call(t,d,e,r)),d!==void 0&&i.set(o,d)}if(!r||!r.ignoreDefaults){i.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(s))n[o]||PG(t,o,i,r)}i.setDefaultOrigin("user")}function AG(t,e,r,i=ML){const s={...i,messages:[]};r(s),s.messages?.forEach(n=>{n.type!=="warning"||t.loaded?i?.messages&&i.messages.push(n):t.loadWarnings.push(n)})}function RG(t,e,r,i,s){const n={};return e.write?.writer?.call(t,i,n,r,s),n}function EL(t,e,r,i,s,n){if(!i?.write)return!1;const o=Ys(t,r);if(!s&&i.write.overridePolicy){const l=i.write.overridePolicy.call(t,o,r,n??void 0);l!==void 0&&(s=l)}if(s||(s=i.write),!s||s.enabled===!1||s.layerContainerTypes&&n?.layerContainerType&&!s.layerContainerTypes.includes(n.layerContainerType))return!1;if((o===null&&!s.allowNull&&!s.writerEnsuresNonNull||o===void 0)&&s.isRequired){const l=new x("web-document-write:property-required",`Missing value for required property '${r}' on '${t.declaredClass}'`,{propertyName:r,target:t});return l&&n?.messages?n.messages.push(l):l&&!n&&L.getLogger("esri.core.accessorSupport.write").error(l.name,l.message),!1}return!(o===void 0||o===null&&!s.allowNull&&!s.writerEnsuresNonNull||!s.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(r)===0)&&LG(t,r,n,i,o)||!s.ignoreOrigin&&n?.origin&&e.store.multipleOriginsSupported&&e.store.originOf(r)<Co(n.origin))}function LG(t,e,r,i,s){const n=i.default;if(n===void 0)return!1;if(i.defaultEquals!=null)return i.defaultEquals(s);if(typeof n=="function"){if(Array.isArray(s)){const o=n.call(t,e,r??void 0);return uw(o,s)}return!1}return n===s}function FG(t,e,r,i){const s=Qr(t),n=s.metadata,o=pL(n[e],i);return!!o&&EL(t,s,e,o,r,i)}function OL(t,e,r){if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return Eg(e,t.toJSON(r));const i=Qr(t),s=i.metadata;for(const n in s){const o=pL(s[n],r);if(!EL(t,i,n,o,void 0,r))continue;const l=Ys(t,n),u=RG(t,o,o.write&&typeof o.write.target=="string"?o.write.target:n,l,r);Object.keys(u).length>0&&(e=Eg(e,u),r?.resources?.pendingOperations?.length&&r.resources.pendingOperations.push(Promise.all(r.resources.pendingOperations).then(()=>Eg(e,u,()=>"replace-arrays"))),r?.writtenProperties&&r.writtenProperties.push({target:t,propName:n,oldOrigin:rq(i.store.originOf(n)),newOrigin:r.origin}))}return e}const ol=t=>{const e=t;let r=class extends e{constructor(...i){super(...i);const s=Qr(this),n=s.store,o=new IG;s.store=o,TL(s,n,o)}read(i,s){IL(this,i,s)}write(i,s){return OL(this,i??{},s)}toJSON(i){return this.write({},i)}static fromJSON(i,s){return NG.call(this,i,s)}};return r=a([b("esri.core.JSONSupport")],r),r.prototype.toJSON.isDefaultToJSON=!0,r};function NG(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const r=new this;return r.read(t,e),r}const F=ol(X);let DG=class{constructor(){this._resolver=wi(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=1,this._cleanUp()},()=>{this._status=2,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===1}isRejected(){return this._status===2}isFulfilled(){return this._status!==0}abort(){this._resolver.reject(Fe())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=wi(),r=[...this._resolvingPromises,e.promise],i=this._allPromise=Promise.all(r);i.then(()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve()},s=>{this.isFulfilled()||this._allPromise!==i||sr(s)||this._resolver.reject(s)}),e.resolve()}};const kT=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this._promiseProps=new DG,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(i,s){return this._promiseProps.promise.then(()=>this).then(i,s)}catch(i){return this.when(null,i)}addResolvingPromise(i){i&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in i?i.when():i)}addResolvingTask(i){i&&!this._promiseProps.isFulfilled()&&(this.addHandles(i7(i)),this._promiseProps.addResolvingPromise(i.promise))}};return r=a([b("esri.core.Promise")],r),r},CT=kT(X),jG="not-loaded",VG="loading",zG="failed",jI="loaded",kL=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(s=>{const n=this.load.bind(this);this.load=o=>{const l=new Promise((u,d)=>{const p=pT(o,d);this.destroyed&&d(new x("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(u,d).finally(()=>{p&&p.remove()})});if(this.loadStatus===jG){this._set("loadStatus",VG);const u=this._loadController=new AbortController;n({signal:u.signal})}return s(),l}})),this.when(()=>{this._set("loadStatus",jI),this._loadController=null},s=>{this.destroyed||(this._set("loadStatus",zG),this._set("loadError",s),this._loadController=null)})}destroy(){this._loadController&&(this._loadController=jo(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===jI}get loadWarnings(){return this._get("loadWarnings")}load(i){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new x("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return a([c({readOnly:!0})],r.prototype,"loaded",null),a([c({readOnly:!0})],r.prototype,"loadError",void 0),a([c({clonable:!1})],r.prototype,"loadStatus",void 0),a([c({type:[Ui],readOnly:!0})],r.prototype,"loadWarnings",null),r=a([b("esri.core.Loadable")],r),r},Xm=kL(CT);function F_(t){return!(!t||!t.load)}function d1e(t,e,r){return tu(t.map((i,s)=>e.apply(r,[i,s])))}async function UG(t,e,r){return(await tu(t.map((i,s)=>e.apply(r,[i,s])))).map(i=>i.value)}function PT(t){return{ok:!0,value:t}}function AT(t){return{ok:!1,error:t}}function qG(t){return t!=null&&t.ok===!0?t.value:null}function GG(t){return t!=null&&t.ok===!1?t.error:null}async function Sw(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return PT(await t)}catch(e){return AT(e)}}async function BG(t){try{return PT(await t)}catch(e){return Mn(e),AT(e)}}function ey(t,e){return new sa(t,e)}let sa=class extends X{get value(){return qG(this._result)}get error(){return GG(this._result)}get finished(){return this._result!=null}constructor(e,r){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=jo(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:i}=this._abortController;this.promise=e(i),this.promise.then(s=>{this._result=PT(s),this._cleanup()},s=>{this._result=AT(s),this._cleanup()}),this._abortHandle=ys(r,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=He(this._abortHandle),this._abortController=null}};a([c()],sa.prototype,"value",null),a([c()],sa.prototype,"error",null),a([c()],sa.prototype,"finished",null),a([c()],sa.prototype,"promise",void 0),a([c()],sa.prototype,"_result",void 0),sa=a([b("esri.core.asyncUtils.ReactiveTask")],sa);async function CL(t,e){return await t.load(),HG(t,e)}async function HG(t,e){const r=[],i=(...n)=>{for(const o of n)o!=null&&(Array.isArray(o)?i(...o):H.isCollection(o)?o.forEach(l=>i(l)):F_(o)&&r.push(o))};e(i);let s=null;if(await UG(r,async n=>{const o=await Sw(WG(n)?n.loadAll():n.load());o.ok!==!1||s||(s=o)}),s)throw s.error;return t}function WG(t){return"loadAll"in t&&typeof t.loadAll=="function"}function q(t,e,r){let i,s;return e===void 0?(s=t,i=[void 0]):typeof e!="string"?(s=t,i=[void 0],r=e):(s=e,i=Array.isArray(t)?t:[t]),(n,o)=>{const l=n.constructor.prototype;for(const u of i){const d=TT(n,u,s);d.write&&typeof d.write=="object"||(d.write={}),r&&(d.write.target=r),d.write.writer=l[o]}}}let $e=class{constructor(e,r={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=r,this.apiValues=[],this.jsonValues=[],this._apiToJSON=ZG(e),this.apiValues=VI(this._apiToJSON),this.jsonValues=VI(this._jsonToAPI),this.read=i=>this.fromJSON(i),this.write=(i,s,n)=>{const o=this.toJSON(i);o!==void 0&&Bt(n,o,s)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const r=this._apiToJSON[e];return this._options.useNumericKeys?+r:r}return this._options.ignoreUnknown?null:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function ZG(t){const e={};for(const r in t)e[t[r]]=r;return e}function VI(t){const e=[];for(const r in t)e.push(r);return e.sort(),e}function Lt(){return function(t,e){return new $e(t,{ignoreUnknown:!0,...e})}}let RT=class{constructor(e,r,i,s,n,o){this.semiMajorAxis=e,this.flattening=r,this.outerAtmosphereRimWidth=i,this.atmosphereHeight=s,this.scaleHeight=n;const l=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*l,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=o||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const ct=new RT(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),An=new RT(3396190,1/169.8944472236118,23e4,6e4,.111),Za=new RT(1737400,0,0,0,0);function nt(t){if(!_e.assetsPath)throw L.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new x("assets:path-not-set","config.assetsPath is not set");return Tu(_e.assetsPath,t)}let Nb,I=null;function PL(){return!!I}function JG(){return!!k("esri-wasm")}function YG(){return Nb||(Nb=N(async()=>{const{default:t}=await import("./pe-wasm-B87Q3u4k.js");return{default:t}},[]).then(({default:t})=>t({locateFile:e=>nt(`esri/geometry/support/${e}`)})).then(t=>{DL(t)}),Nb)}const Ag={geogToProj(t,e,r){I.ensureCache.prepare();const i=Ou(r),s=r===i,n=I.ensureFloat64(i),o=I._pe_geog_to_proj(I.getPointer(t),e,n);return o&&Ja(r,e,n,s),o},projGeog(t,e,r,i){switch(i){case at.PE_TRANSFORM_P_TO_G:return Ag.projToGeog(t,e,r);case at.PE_TRANSFORM_G_TO_P:return Ag.geogToProj(t,e,r)}return 0},projToGeog:(t,e,r)=>Ag.projToGeogCenter(t,e,r,0),projToGeogCenter(t,e,r,i){I.ensureCache.prepare();const s=Ou(r),n=r===s,o=I.ensureFloat64(s),l=I._pe_proj_to_geog_center(I.getPointer(t),e,o,i);return l&&Ja(r,e,o,n),l}};let at=class Oe{static init(){Oe.PE_BUFFER_MAX=I.PeDefs.prototype.PE_BUFFER_MAX,Oe.PE_NAME_MAX=I.PeDefs.prototype.PE_NAME_MAX,Oe.PE_MGRS_MAX=I.PeDefs.prototype.PE_MGRS_MAX,Oe.PE_USNG_MAX=I.PeDefs.prototype.PE_USNG_MAX,Oe.PE_DD_MAX=I.PeDefs.prototype.PE_DD_MAX,Oe.PE_DDM_MAX=I.PeDefs.prototype.PE_DDM_MAX,Oe.PE_DMS_MAX=I.PeDefs.prototype.PE_DMS_MAX,Oe.PE_UTM_MAX=I.PeDefs.prototype.PE_UTM_MAX,Oe.PE_PARM_MAX=I.PeDefs.prototype.PE_PARM_MAX,Oe.PE_TYPE_NONE=I.PeDefs.prototype.PE_TYPE_NONE,Oe.PE_TYPE_GEOGCS=I.PeDefs.prototype.PE_TYPE_GEOGCS,Oe.PE_TYPE_PROJCS=I.PeDefs.prototype.PE_TYPE_PROJCS,Oe.PE_TYPE_GEOGTRAN=I.PeDefs.prototype.PE_TYPE_GEOGTRAN,Oe.PE_TYPE_COORDSYS=I.PeDefs.prototype.PE_TYPE_COORDSYS,Oe.PE_TYPE_UNIT=I.PeDefs.prototype.PE_TYPE_UNIT,Oe.PE_TYPE_LINUNIT=I.PeDefs.prototype.PE_TYPE_LINUNIT,Oe.PE_STR_OPTS_NONE=I.PeDefs.prototype.PE_STR_OPTS_NONE,Oe.PE_STR_AUTH_NONE=I.PeDefs.prototype.PE_STR_AUTH_NONE,Oe.PE_STR_AUTH_TOP=I.PeDefs.prototype.PE_STR_AUTH_TOP,Oe.PE_STR_NAME_CANON=I.PeDefs.prototype.PE_STR_NAME_CANON,Oe.PE_STR_FMT_WKT=I.PeDefs.prototype.PE_STR_FMT_WKT,Oe.PE_STR_FMT_WKT2=I.PeDefs.prototype.PE_STR_FMT_WKT2,Oe.PE_PARM_X0=I.PeDefs.prototype.PE_PARM_X0,Oe.PE_PARM_ND=I.PeDefs.prototype.PE_PARM_ND,Oe.PE_TRANSFORM_1_TO_2=I.PeDefs.prototype.PE_TRANSFORM_1_TO_2,Oe.PE_TRANSFORM_2_TO_1=I.PeDefs.prototype.PE_TRANSFORM_2_TO_1,Oe.PE_TRANSFORM_P_TO_G=I.PeDefs.prototype.PE_TRANSFORM_P_TO_G,Oe.PE_TRANSFORM_G_TO_P=I.PeDefs.prototype.PE_TRANSFORM_G_TO_P,Oe.PE_HORIZON_RECT=I.PeDefs.prototype.PE_HORIZON_RECT,Oe.PE_HORIZON_POLY=I.PeDefs.prototype.PE_HORIZON_POLY,Oe.PE_HORIZON_LINE=I.PeDefs.prototype.PE_HORIZON_LINE,Oe.PE_HORIZON_DELTA=I.PeDefs.prototype.PE_HORIZON_DELTA}},AL=null;const zI={},UI={},qI=t=>{const e=t.getType();switch(e){case at.PE_TYPE_GEOGCS:t=I.castObject(t,I.PeGeogcs);break;case at.PE_TYPE_PROJCS:t=I.castObject(t,I.PeProjcs);break;case at.PE_TYPE_GEOGTRAN:t=I.castObject(t,I.PeGeogtran);break;default:e&at.PE_TYPE_UNIT&&(t=I.castObject(t,I.PeUnit))}return t},vc={initialize(){I.PeFactory.prototype.initialize(null)},coordsys:t=>vc.factoryByType(at.PE_TYPE_COORDSYS,t),factoryByType(t,e){let r=null,i=zI[t];if(i||(i={},zI[t]=i),i.hasOwnProperty(String(e))&&(r=i[e],I.compare(r,I.NULL)&&(r=null)),!r){const s=I.PeFactory.prototype.factoryByType(t,e);I.compare(s,I.NULL)||(r=qI(s),i[e]=r)}return r},fromString(t,e){let r=null,i=UI[t];if(i||(i={},UI[t]=i),i.hasOwnProperty(e)&&(r=i[e],I.compare(r,I.NULL)&&(r=null)),!r){const s=I.PeFactory.prototype.fromString(t,e);I.compare(s,I.NULL)||(r=qI(s),i[e]=r)}return r},geogcs:t=>vc.factoryByType(at.PE_TYPE_GEOGCS,t),geogtran:t=>vc.factoryByType(at.PE_TYPE_GEOGTRAN,t),getCode:t=>I.PeFactory.prototype.getCode(t),projcs:t=>vc.factoryByType(at.PE_TYPE_PROJCS,t),unit:t=>vc.factoryByType(at.PE_TYPE_UNIT,t)};let GI,RL=null;const LT={PE_GTLIST_OPTS_COMMON:0,init(){LT.PE_GTLIST_OPTS_COMMON=I.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,GI=I._pe_getPeGTlistExtendedEntrySize()},getGTlist(t,e,r,i,s,n){let o=null;const l=new I.PeInteger(n);try{const u=I.PeGTlistExtended.prototype.getGTlist(t,e,r,i,s,l);if((n=l.val)&&(o=[u],n>1)){const d=I.getPointer(u);for(let p=1;p<n;p++)o.push(I.wrapPointer(d+GI*p,I.PeGTlistExtendedEntry))}}finally{I.destroy(l)}return o}},KG={destroy(t){if(t?.length){for(const e of t)js(e),e.getEntries().forEach(r=>{js(r);const i=r.getGeogtran();js(i),i.getParameters().forEach(js),[i.getGeogcs1(),i.getGeogcs2()].forEach(s=>{js(s);const n=s.getDatum();js(n),js(n.getSpheroid()),js(s.getPrimem()),js(s.getUnit())})});I.PeGTlistExtendedEntry.prototype.Delete(t[0])}}},QG={geogToGeog(t,e,r,i,s){I.ensureCache.prepare();const n=Ou(r),o=r===n,l=I.ensureFloat64(n);let u=0;i&&(u=I.ensureFloat64(i));const d=I._pe_geog_to_geog(I.getPointer(t),e,l,u,s);return d&&Ja(r,e,l,o),d}},XG={geodesicCoordinate(t,e,r,i,s,n,o,l){I.PeLineType.prototype.geodesic_coordinate(t,e,r,i,s,n,o,l)},geodeticCoordinate(t,e,r,i,s,n,o,l,u){I.PeLineType.prototype.geodetic_coordinate(t,e,r,i,s,n,o,l,u)},geodeticDistance(t,e,r,i,s,n,o,l,u,d){I.PeLineType.prototype.geodetic_distance(t,e,r,i,s,n,o,l,u,d)},greatEllipticDistance(t,e,r,i,s,n,o,l,u){I.PeLineType.prototype.great_elliptic_distance(t,e,r,i,s,n,o,l,u)}},eB={phiToEta:(t,e)=>I.PeMath.prototype.phi_to_eta(t,e),etaToPhi:(t,e)=>I.PeMath.prototype.eta_to_phi(t,e),phiToPhig:(t,e)=>I.PeMath.prototype.phi_to_phig(t,e),q:(t,e,r)=>I.PeMath.prototype.q(t,e,r),q90:(t,e)=>I.PeMath.prototype.q90(t,e)},Db=(t,e,r,i,s,n)=>{let o,l;switch(I.ensureCache.prepare(),t){case"dd":o=I._pe_geog_to_dd,l=at.PE_DD_MAX;break;case"ddm":o=I._pe_geog_to_ddm,l=at.PE_DDM_MAX;break;case"dms":o=I._pe_geog_to_dms,l=at.PE_DMS_MAX}let u=0;e&&(u=I.getPointer(e));const d=Ou(i),p=I.ensureFloat64(d),f=$w(r,l),m=o(u,r,p,s,I.ensureInt32(f));if(m)for(let y=0;y<r;y++)n[y]=I.UTF8ToString(f[y]);return m},jb=(t,e,r,i,s)=>{let n;switch(I.ensureCache.prepare(),t){case"dd":n=I._pe_dd_to_geog;break;case"ddm":n=I._pe_ddm_to_geog;break;case"dms":n=I._pe_dms_to_geog}let o=0;e&&(o=I.getPointer(e));const l=i.map(f=>I.ensureString(f)),u=I.ensureInt32(l),d=I.ensureFloat64(new Array(2*r)),p=n(o,r,u,d);return p&&Ja(s,r,d),p},tB={geogToDms:(t,e,r,i,s)=>Db("dms",t,e,r,i,s),dmsToGeog:(t,e,r,i)=>jb("dms",t,e,r,i),geogToDdm:(t,e,r,i,s)=>Db("ddm",t,e,r,i,s),ddmToGeog:(t,e,r,i)=>jb("ddm",t,e,r,i),geogToDd:(t,e,r,i,s)=>Db("dd",t,e,r,i,s),ddToGeog:(t,e,r,i)=>jb("dd",t,e,r,i)};let LL=class wc{static init(){wc.PE_MGRS_STYLE_NEW=I.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,wc.PE_MGRS_STYLE_OLD=I.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,wc.PE_MGRS_STYLE_AUTO=I.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,wc.PE_MGRS_180_ZONE_1_PLUS=I.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,wc.PE_MGRS_ADD_SPACES=I.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}static geogToMgrsExtended(e,r,i,s,n,o,l){I.ensureCache.prepare();let u=0;e&&(u=I.getPointer(e));const d=Ou(i),p=I.ensureFloat64(d),f=$w(r,at.PE_MGRS_MAX),m=I.ensureInt32(f),y=I._pe_geog_to_mgrs_extended(u,r,p,s,n,o,m);if(y)for(let g=0;g<r;g++)l[g]=I.UTF8ToString(f[g]);return y}static mgrsToGeogExtended(e,r,i,s,n){I.ensureCache.prepare();let o=0;e&&(o=I.getPointer(e));const l=i.map(f=>I.ensureString(f)),u=I.ensureInt32(l),d=I.ensureFloat64(new Array(2*r)),p=I._pe_mgrs_to_geog_extended(o,r,u,s,d);return p&&Ja(n,r,d),p}};const rB={geogToUsng(t,e,r,i,s,n,o){I.ensureCache.prepare();let l=0;t&&(l=I.getPointer(t));const u=Ou(r),d=I.ensureFloat64(u),p=$w(e,at.PE_MGRS_MAX),f=I.ensureInt32(p),m=I._pe_geog_to_usng(l,e,d,i,s,n,f);if(m)for(let y=0;y<e;y++)o[y]=I.UTF8ToString(p[y]);return m},usngToGeog(t,e,r,i){I.ensureCache.prepare();let s=0;t&&(s=I.getPointer(t));const n=r.map(d=>I.ensureString(d)),o=I.ensureInt32(n),l=I.ensureFloat64(new Array(2*e)),u=I._pe_usng_to_geog(s,e,o,l);return u&&Ja(i,e,l),u}};let FL=class Rg{static init(){Rg.PE_UTM_OPTS_NONE=I.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,Rg.PE_UTM_OPTS_ADD_SPACES=I.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,Rg.PE_UTM_OPTS_NS=I.PeNotationUtm.prototype.PE_UTM_OPTS_NS}static geogToUtm(e,r,i,s,n){I.ensureCache.prepare();let o=0;e&&(o=I.getPointer(e));const l=Ou(i),u=I.ensureFloat64(l),d=$w(r,at.PE_UTM_MAX),p=I.ensureInt32(d),f=I._pe_geog_to_utm(o,r,u,s,p);if(f)for(let m=0;m<r;m++)n[m]=I.UTF8ToString(d[m]);return f}static utmToGeog(e,r,i,s,n){I.ensureCache.prepare();let o=0;e&&(o=I.getPointer(e));const l=i.map(f=>I.ensureString(f)),u=I.ensureInt32(l),d=I.ensureFloat64(new Array(2*r)),p=I._pe_utm_to_geog(o,r,u,s,d);return p&&Ja(n,r,d),p}};var di;let NL=(di=class{static init(){di.PE_PCSINFO_OPTION_NONE=I.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,di.PE_PCSINFO_OPTION_DOMAIN=I.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,di.PE_POLE_OUTSIDE_BOUNDARY=I.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,di.PE_POLE_POINT=I.PePCSInfo.prototype.PE_POLE_POINT}static generate(e,r=di.PE_PCSINFO_OPTION_DOMAIN){let i=null,s=null;return di.cache.has(e)&&(s=di.cache.get(e),s[r]&&(i=s[r])),i||(i=I.PePCSInfo.prototype.generate(e,r),s||(s=[],di.cache.set(e,s)),s[r]=i),i}},di.cache=new Map,di);const iB={versionString:()=>I.PeVersion.prototype.version_string()};function DL(t){function e(n,o,l){n[o]=l(n[o])}I=t,at.init(),LT.init(),LL.init(),FL.init(),NL.init(),AL=class extends I.PeDouble{constructor(n=NaN){super(n)}destroy(){I.destroy(this)}[Symbol.dispose](){this.destroy()}},RL=class extends I.PeGCSExtent{destroy(){I.destroy(this)}[Symbol.dispose](){this.destroy()}};const r=[I.PeAngunit,I.PeDatum,I.PeGeogcs,I.PeGeogtran,I.PeObject,I.PeParameter,I.PePrimem,I.PeProjcs,I.PeSpheroid,I.PeUnit];for(const n of r)e(n.prototype,"getName",o=>function(){return o.call(this,new Array(at.PE_NAME_MAX))});for(const n of[I.PeGeogtran,I.PeProjcs])e(n.prototype,"getParameters",o=>function(){const l=new Array(at.PE_PARM_MAX);let u=o.call(this);for(let d=0;d<l.length;d++){const p=I.getValue(u,"*");l[d]=p?I.wrapPointer(p,I.PeParameter):null,u+=Int32Array.BYTES_PER_ELEMENT}return l});e(I.PeHorizon.prototype,"getCoord",n=>function(o=!1){const l=this.getSize();if(!l)return null;const u=[];return Ja(u,l,n.call(this),o),u}),e(I.PeGTlistExtendedEntry.prototype,"getEntries",n=>{const o=I._pe_getPeGTlistExtendedGTsSize();return function(){let l=null;const u=n.call(this);if(!I.compare(u,I.NULL)){l=[u];const d=this.getSteps();if(d>1){const p=I.getPointer(u);for(let f=1;f<d;f++)l.push(I.wrapPointer(p+o*f,I.PeGTlistExtendedGTs))}}return l}});const i=I._pe_getPeHorizonSize(),s=n=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(n))return o.get(n);let l=null;const u=n.call(this);if(!I.compare(u,I.NULL)){l=[u];const d=u.getNump();if(d>1){const p=I.getPointer(u);for(let f=1;f<d;f++)l.push(I.wrapPointer(p+i*f,I.PeHorizon))}}return o.set(n,l),l};e(I.PeProjcs.prototype,"horizonGcsGenerate",s),e(I.PeProjcs.prototype,"horizonPcsGenerate",s),I.PeObject.prototype.toString=function(n=at.PE_STR_OPTS_NONE){I.ensureCache.prepare();const o=I.getPointer(this),l=I.ensureInt8(new Array(at.PE_BUFFER_MAX));return I.UTF8ToString(I._pe_object_to_string_ext(o,n,l))},I.PeGeogcs.prototype.destroy=function(){this.Delete(),js(this),this.ptr=0},I.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},I.PeProjcs.prototype.destroy=function(){this.Delete(),js(this),this.ptr=0},I.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function js(t){if(!t)return;const e=I.getClass(t);if(!e)return;const r=I.getCache(e);if(!r)return;const i=I.getPointer(t);i&&delete r[i]}function $w(t,e){const r=[],i=new Array(e);for(let s=0;s<t;s++)r.push(I.ensureInt8(i));return r}function Ou(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function Ja(t,e,r,i=!1){if(i)for(let s=0;s<2*e;s++)t[s]=I.getValue(r+s*Float64Array.BYTES_PER_ELEMENT,"double");else{const s=t.length===0;for(let n=0;n<e;n++)s&&(t[n]=new Array(2)),t[n][0]=I.getValue(r,"double"),t[n][1]=I.getValue(r+Float64Array.BYTES_PER_ELEMENT,"double"),r+=2*Float64Array.BYTES_PER_ELEMENT}}const m1e=Object.freeze(Object.defineProperty({__proto__:null,PeCSTransformations:Ag,PeDefs:at,get PeDouble(){return AL},PeFactory:vc,get PeGCSExtent(){return RL},PeGTTransformations:QG,PeGTlistExtended:LT,PeGTlistExtendedEntry:KG,PeLineType:XG,PeMath:eB,PeNotationDms:tB,PeNotationMgrs:LL,PeNotationUsng:rB,PeNotationUtm:FL,PePCSInfo:NL,PeVersion:iB,_init:DL,get _pe(){return I},isLoaded:PL,isSupported:JG,load:YG},Symbol.toStringTag,{value:"Module"}));let h;const w={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,10592:0,10594:0,10596:0,10598:0,10601:0,10603:0,10626:0,10632:0,10641:0,10665:0,10674:0,10744:0,10745:0,10759:0,10773:0,10802:0,10820:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,65061:2,65062:2,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1,103978:2,103979:0,103980:2,103981:0};for(h=2e3;h<=2045;h++)w[h]=0;for(h=2056;h<=2065;h++)w[h]=0;for(h=2067;h<=2135;h++)w[h]=0;for(h=2137;h<=2154;h++)w[h]=0;for(h=2161;h<=2170;h++)w[h]=0;for(h=2172;h<=2193;h++)w[h]=0;for(h=2195;h<=2198;h++)w[h]=0;for(h=2200;h<=2203;h++)w[h]=0;for(h=2205;h<=2217;h++)w[h]=0;for(h=2222;h<=2224;h++)w[h]=1;for(h=2225;h<=2250;h++)w[h]=2;for(h=2251;h<=2253;h++)w[h]=1;for(h=2257;h<=2264;h++)w[h]=2;for(h=2274;h<=2279;h++)w[h]=2;for(h=2280;h<=2282;h++)w[h]=1;for(h=2283;h<=2289;h++)w[h]=2;for(h=2290;h<=2292;h++)w[h]=0;for(h=2308;h<=2313;h++)w[h]=0;for(h=2315;h<=2491;h++)w[h]=0;for(h=2494;h<=2866;h++)w[h]=0;for(h=2867;h<=2869;h++)w[h]=1;for(h=2870;h<=2888;h++)w[h]=2;for(h=2891;h<=2895;h++)w[h]=2;for(h=2896;h<=2898;h++)w[h]=1;for(h=2902;h<=2908;h++)w[h]=2;for(h=2915;h<=2920;h++)w[h]=2;for(h=2921;h<=2923;h++)w[h]=1;for(h=2924;h<=2930;h++)w[h]=2;for(h=2931;h<=2962;h++)w[h]=0;for(h=2964;h<=2968;h++)w[h]=2;for(h=2969;h<=2973;h++)w[h]=0;for(h=2975;h<=2991;h++)w[h]=0;for(h=2995;h<=3051;h++)w[h]=0;for(h=3054;h<=3079;h++)w[h]=0;for(h=3081;h<=3088;h++)w[h]=0;for(h=3092;h<=3101;h++)w[h]=0;for(h=3106;h<=3138;h++)w[h]=0;for(h=3146;h<=3151;h++)w[h]=0;for(h=3153;h<=3166;h++)w[h]=0;for(h=3168;h<=3172;h++)w[h]=0;for(h=3174;h<=3203;h++)w[h]=0;for(h=3294;h<=3358;h++)w[h]=0;for(h=3367;h<=3403;h++)w[h]=0;for(h=3408;h<=3416;h++)w[h]=0;for(h=3417;h<=3438;h++)w[h]=2;for(h=3441;h<=3446;h++)w[h]=2;for(h=3447;h<=3450;h++)w[h]=0;for(h=3451;h<=3459;h++)w[h]=2;for(h=3460;h<=3478;h++)w[h]=0;for(h=3554;h<=3559;h++)w[h]=0;for(h=3560;h<=3570;h++)w[h]=2;for(h=3571;h<=3581;h++)w[h]=0;for(h=3594;h<=3597;h++)w[h]=0;for(h=3601;h<=3604;h++)w[h]=0;for(h=3637;h<=3639;h++)w[h]=0;for(h=3665;h<=3667;h++)w[h]=0;for(h=3693;h<=3695;h++)w[h]=0;for(h=3701;h<=3727;h++)w[h]=0;for(h=3728;h<=3739;h++)w[h]=2;for(h=3740;h<=3751;h++)w[h]=0;for(h=3753;h<=3760;h++)w[h]=2;for(h=3761;h<=3773;h++)w[h]=0;for(h=3775;h<=3777;h++)w[h]=0;for(h=3779;h<=3781;h++)w[h]=0;for(h=3783;h<=3785;h++)w[h]=0;for(h=3788;h<=3791;h++)w[h]=0;for(h=3797;h<=3802;h++)w[h]=0;for(h=3814;h<=3816;h++)w[h]=0;for(h=3825;h<=3829;h++)w[h]=0;for(h=3832;h<=3841;h++)w[h]=0;for(h=3844;h<=3852;h++)w[h]=0;for(h=3873;h<=3885;h++)w[h]=0;for(h=3890;h<=3893;h++)w[h]=0;for(h=3907;h<=3912;h++)w[h]=0;for(h=3942;h<=3950;h++)w[h]=0;for(h=3968;h<=3970;h++)w[h]=0;for(h=3973;h<=3976;h++)w[h]=0;for(h=3986;h<=3989;h++)w[h]=0;for(h=3994;h<=3997;h++)w[h]=0;for(h=4048;h<=4051;h++)w[h]=0;for(h=4056;h<=4063;h++)w[h]=0;for(h=4093;h<=4096;h++)w[h]=0;for(h=4390;h<=4398;h++)w[h]=0;for(h=4399;h<=4413;h++)w[h]=2;for(h=4418;h<=4433;h++)w[h]=2;for(h=4455;h<=4457;h++)w[h]=2;for(h=4484;h<=4489;h++)w[h]=0;for(h=4491;h<=4554;h++)w[h]=0;for(h=4568;h<=4589;h++)w[h]=0;for(h=4652;h<=4656;h++)w[h]=0;for(h=4766;h<=4800;h++)w[h]=0;for(h=5014;h<=5016;h++)w[h]=0;for(h=5069;h<=5072;h++)w[h]=0;for(h=5105;h<=5130;h++)w[h]=0;for(h=5167;h<=5188;h++)w[h]=0;for(h=5253;h<=5259;h++)w[h]=0;for(h=5269;h<=5275;h++)w[h]=0;for(h=5292;h<=5311;h++)w[h]=0;for(h=5329;h<=5331;h++)w[h]=0;for(h=5343;h<=5349;h++)w[h]=0;for(h=5355;h<=5357;h++)w[h]=0;for(h=5387;h<=5389;h++)w[h]=0;for(h=5459;h<=5463;h++)w[h]=0;for(h=5479;h<=5482;h++)w[h]=0;for(h=5518;h<=5520;h++)w[h]=0;for(h=5530;h<=5539;h++)w[h]=0;for(h=5550;h<=5552;h++)w[h]=0;for(h=5562;h<=5583;h++)w[h]=0;for(h=5623;h<=5625;h++)w[h]=2;for(h=5631;h<=5639;h++)w[h]=0;for(h=5649;h<=5653;h++)w[h]=0;for(h=5663;h<=5680;h++)w[h]=0;for(h=5682;h<=5685;h++)w[h]=0;for(h=5875;h<=5877;h++)w[h]=0;for(h=5896;h<=5899;h++)w[h]=0;for(h=5921;h<=5940;h++)w[h]=0;for(h=6050;h<=6125;h++)w[h]=0;for(h=6244;h<=6275;h++)w[h]=0;for(h=6328;h<=6348;h++)w[h]=0;for(h=6350;h<=6356;h++)w[h]=0;for(h=6366;h<=6372;h++)w[h]=0;for(h=6381;h<=6387;h++)w[h]=0;for(h=6393;h<=6404;h++)w[h]=0;for(h=6480;h<=6483;h++)w[h]=0;for(h=6511;h<=6514;h++)w[h]=0;for(h=6579;h<=6581;h++)w[h]=0;for(h=6619;h<=6624;h++)w[h]=0;for(h=6625;h<=6627;h++)w[h]=2;for(h=6628;h<=6632;h++)w[h]=0;for(h=6634;h<=6637;h++)w[h]=0;for(h=6669;h<=6692;h++)w[h]=0;for(h=6707;h<=6709;h++)w[h]=0;for(h=6720;h<=6723;h++)w[h]=0;for(h=6732;h<=6738;h++)w[h]=0;for(h=6931;h<=6933;h++)w[h]=0;for(h=6956;h<=6959;h++)w[h]=0;for(h=7005;h<=7007;h++)w[h]=0;for(h=7057;h<=7070;h++)w[h]=2;for(h=7074;h<=7082;h++)w[h]=0;for(h=7109;h<=7118;h++)w[h]=0;for(h=7119;h<=7127;h++)w[h]=1;for(h=7374;h<=7376;h++)w[h]=0;for(h=7528;h<=7586;h++)w[h]=0;for(h=7587;h<=7645;h++)w[h]=2;for(h=7692;h<=7696;h++)w[h]=0;for(h=7755;h<=7787;h++)w[h]=0;for(h=7791;h<=7795;h++)w[h]=0;for(h=7799;h<=7801;h++)w[h]=0;for(h=7803;h<=7805;h++)w[h]=0;for(h=7825;h<=7831;h++)w[h]=0;for(h=7845;h<=7859;h++)w[h]=0;for(h=8013;h<=8032;h++)w[h]=0;for(h=8065;h<=8068;h++)w[h]=1;for(h=8518;h<=8529;h++)w[h]=2;for(h=8533;h<=8536;h++)w[h]=2;for(h=8538;h<=8540;h++)w[h]=2;for(h=8677;h<=8679;h++)w[h]=0;for(h=8836;h<=8840;h++)w[h]=0;for(h=8857;h<=8859;h++)w[h]=0;for(h=8908;h<=8910;h++)w[h]=0;for(h=9154;h<=9159;h++)w[h]=0;for(h=9205;h<=9218;h++)w[h]=0;for(h=9271;h<=9273;h++)w[h]=0;for(h=9295;h<=9297;h++)w[h]=0;for(h=9356;h<=9360;h++)w[h]=0;for(h=9404;h<=9407;h++)w[h]=0;for(h=9476;h<=9482;h++)w[h]=0;for(h=9487;h<=9494;h++)w[h]=0;for(h=9697;h<=9699;h++)w[h]=0;for(h=9821;h<=9865;h++)w[h]=0;for(h=10285;h<=10291;h++)w[h]=0;for(h=10314;h<=10317;h++)w[h]=0;for(h=10448;h<=10465;h++)w[h]=0;for(h=10726;h<=10729;h++)w[h]=0;for(h=10731;h<=10733;h++)w[h]=0;for(h=11114;h<=11118;h++)w[h]=0;for(h=20004;h<=20032;h++)w[h]=0;for(h=20047;h<=20049;h++)w[h]=0;for(h=20062;h<=20092;h++)w[h]=0;for(h=20135;h<=20138;h++)w[h]=0;for(h=20248;h<=20258;h++)w[h]=0;for(h=20348;h<=20358;h++)w[h]=0;for(h=20436;h<=20440;h++)w[h]=0;for(h=20822;h<=20824;h++)w[h]=0;for(h=20904;h<=20932;h++)w[h]=0;for(h=20934;h<=20936;h++)w[h]=0;for(h=21004;h<=21032;h++)w[h]=0;for(h=21035;h<=21037;h++)w[h]=0;for(h=21095;h<=21097;h++)w[h]=0;for(h=21148;h<=21150;h++)w[h]=0;for(h=21207;h<=21264;h++)w[h]=0;for(h=21307;h<=21364;h++)w[h]=0;for(h=21413;h<=21423;h++)w[h]=0;for(h=21453;h<=21463;h++)w[h]=0;for(h=21473;h<=21483;h++)w[h]=0;for(h=21780;h<=21782;h++)w[h]=0;for(h=21891;h<=21894;h++)w[h]=0;for(h=21896;h<=21899;h++)w[h]=0;for(h=22171;h<=22177;h++)w[h]=0;for(h=22181;h<=22187;h++)w[h]=0;for(h=22191;h<=22197;h++)w[h]=0;for(h=22207;h<=22222;h++)w[h]=0;for(h=22229;h<=22232;h++)w[h]=0;for(h=22234;h<=22236;h++)w[h]=0;for(h=22243;h<=22250;h++)w[h]=0;for(h=22262;h<=22265;h++)w[h]=0;for(h=22307;h<=22322;h++)w[h]=0;for(h=22348;h<=22357;h++)w[h]=0;for(h=22407;h<=22422;h++)w[h]=0;for(h=22462;h<=22465;h++)w[h]=0;for(h=22521;h<=22525;h++)w[h]=0;for(h=22607;h<=22622;h++)w[h]=0;for(h=22641;h<=22646;h++)w[h]=0;for(h=22648;h<=22657;h++)w[h]=0;for(h=22707;h<=22722;h++)w[h]=0;for(h=22762;h<=22765;h++)w[h]=0;for(h=22807;h<=22822;h++)w[h]=0;for(h=22991;h<=22994;h++)w[h]=0;for(h=23028;h<=23038;h++)w[h]=0;for(h=23301;h<=23333;h++)w[h]=2;for(h=23830;h<=23853;h++)w[h]=0;for(h=23866;h<=23872;h++)w[h]=0;for(h=23877;h<=23884;h++)w[h]=0;for(h=23886;h<=23894;h++)w[h]=0;for(h=23946;h<=23948;h++)w[h]=0;for(h=24311;h<=24313;h++)w[h]=0;for(h=24342;h<=24347;h++)w[h]=0;for(h=24370;h<=24374;h++)w[h]=10;for(h=24375;h<=24381;h++)w[h]=0;for(h=24718;h<=24721;h++)w[h]=0;for(h=24817;h<=24821;h++)w[h]=0;for(h=24877;h<=24882;h++)w[h]=0;for(h=24891;h<=24893;h++)w[h]=0;for(h=25391;h<=25395;h++)w[h]=0;for(h=25828;h<=25838;h++)w[h]=0;for(h=26191;h<=26195;h++)w[h]=0;for(h=26391;h<=26393;h++)w[h]=0;for(h=26701;h<=26722;h++)w[h]=0;for(h=26729;h<=26799;h++)w[h]=2;for(h=26801;h<=26803;h++)w[h]=2;for(h=26811;h<=26813;h++)w[h]=2;for(h=26847;h<=26870;h++)w[h]=2;for(h=26891;h<=26899;h++)w[h]=0;for(h=26901;h<=26923;h++)w[h]=0;for(h=26929;h<=26946;h++)w[h]=0;for(h=26948;h<=26998;h++)w[h]=0;for(h=27037;h<=27040;h++)w[h]=0;for(h=27205;h<=27232;h++)w[h]=0;for(h=27258;h<=27260;h++)w[h]=0;for(h=27391;h<=27398;h++)w[h]=0;for(h=27561;h<=27564;h++)w[h]=0;for(h=27571;h<=27574;h++)w[h]=0;for(h=27581;h<=27584;h++)w[h]=0;for(h=27591;h<=27594;h++)w[h]=0;for(h=27700;h<=27707;h++)w[h]=0;for(h=28191;h<=28193;h++)w[h]=0;for(h=28348;h<=28358;h++)w[h]=0;for(h=28402;h<=28432;h++)w[h]=0;for(h=28462;h<=28492;h++)w[h]=0;for(h=29118;h<=29122;h++)w[h]=0;for(h=29168;h<=29172;h++)w[h]=0;for(h=29177;h<=29185;h++)w[h]=0;for(h=29187;h<=29195;h++)w[h]=0;for(h=29900;h<=29903;h++)w[h]=0;for(h=30161;h<=30179;h++)w[h]=0;for(h=30491;h<=30494;h++)w[h]=0;for(h=30729;h<=30732;h++)w[h]=0;for(h=31251;h<=31259;h++)w[h]=0;for(h=31265;h<=31268;h++)w[h]=0;for(h=31275;h<=31279;h++)w[h]=0;for(h=31281;h<=31297;h++)w[h]=0;for(h=31461;h<=31469;h++)w[h]=0;for(h=31491;h<=31495;h++)w[h]=0;for(h=31917;h<=31922;h++)w[h]=0;for(h=31965;h<=32e3;h++)w[h]=0;for(h=32001;h<=32003;h++)w[h]=2;for(h=32005;h<=32031;h++)w[h]=2;for(h=32033;h<=32060;h++)w[h]=2;for(h=32064;h<=32067;h++)w[h]=2;for(h=32074;h<=32077;h++)w[h]=2;for(h=32081;h<=32086;h++)w[h]=0;for(h=32107;h<=32130;h++)w[h]=0;for(h=32133;h<=32159;h++)w[h]=0;for(h=32164;h<=32167;h++)w[h]=2;for(h=32180;h<=32199;h++)w[h]=0;for(h=32201;h<=32260;h++)w[h]=0;for(h=32301;h<=32360;h++)w[h]=0;for(h=32401;h<=32460;h++)w[h]=0;for(h=32501;h<=32560;h++)w[h]=0;for(h=32601;h<=32662;h++)w[h]=0;for(h=32664;h<=32667;h++)w[h]=2;for(h=32701;h<=32761;h++)w[h]=0;for(h=53001;h<=53004;h++)w[h]=0;for(h=53008;h<=53019;h++)w[h]=0;for(h=53021;h<=53032;h++)w[h]=0;for(h=53034;h<=53037;h++)w[h]=0;for(h=53042;h<=53046;h++)w[h]=0;for(h=53074;h<=53080;h++)w[h]=0;for(h=54001;h<=54004;h++)w[h]=0;for(h=54008;h<=54019;h++)w[h]=0;for(h=54021;h<=54032;h++)w[h]=0;for(h=54034;h<=54037;h++)w[h]=0;for(h=54042;h<=54046;h++)w[h]=0;for(h=54048;h<=54053;h++)w[h]=0;for(h=54074;h<=54080;h++)w[h]=0;for(h=54090;h<=54096;h++)w[h]=0;for(h=54098;h<=54101;h++)w[h]=0;for(h=65161;h<=65163;h++)w[h]=0;for(h=102001;h<=102040;h++)w[h]=0;for(h=102042;h<=102063;h++)w[h]=0;for(h=102065;h<=102067;h++)w[h]=0;for(h=102070;h<=102117;h++)w[h]=0;for(h=102122;h<=102216;h++)w[h]=0;for(h=102221;h<=102377;h++)w[h]=0;for(h=102382;h<=102388;h++)w[h]=0;for(h=102389;h<=102398;h++)w[h]=2;for(h=102399;h<=102444;h++)w[h]=0;for(h=102445;h<=102447;h++)w[h]=2;for(h=102448;h<=102458;h++)w[h]=0;for(h=102459;h<=102468;h++)w[h]=2;for(h=102469;h<=102499;h++)w[h]=0;for(h=102500;h<=102519;h++)w[h]=1;for(h=102520;h<=102524;h++)w[h]=0;for(h=102525;h<=102529;h++)w[h]=2;for(h=102530;h<=102588;h++)w[h]=0;for(h=102590;h<=102598;h++)w[h]=0;for(h=102601;h<=102603;h++)w[h]=0;for(h=102605;h<=102628;h++)w[h]=0;for(h=102629;h<=102646;h++)w[h]=2;for(h=102648;h<=102700;h++)w[h]=2;for(h=102701;h<=102703;h++)w[h]=0;for(h=102707;h<=102730;h++)w[h]=2;for(h=102733;h<=102758;h++)w[h]=2;for(h=102767;h<=102900;h++)w[h]=0;for(h=102901;h<=102933;h++)w[h]=2;for(h=102934;h<=102950;h++)w[h]=13;for(h=102951;h<=102963;h++)w[h]=0;for(h=102965;h<=102969;h++)w[h]=0;for(h=102971;h<=102973;h++)w[h]=0;for(h=102975;h<=102989;h++)w[h]=0;for(h=102990;h<=102992;h++)w[h]=1;for(h=102997;h<=103002;h++)w[h]=0;for(h=103003;h<=103008;h++)w[h]=2;for(h=103009;h<=103011;h++)w[h]=0;for(h=103012;h<=103014;h++)w[h]=2;for(h=103019;h<=103021;h++)w[h]=0;for(h=103022;h<=103024;h++)w[h]=2;for(h=103029;h<=103031;h++)w[h]=0;for(h=103032;h<=103034;h++)w[h]=2;for(h=103065;h<=103068;h++)w[h]=0;for(h=103074;h<=103076;h++)w[h]=0;for(h=103077;h<=103079;h++)w[h]=1;for(h=103080;h<=103082;h++)w[h]=0;for(h=103083;h<=103085;h++)w[h]=2;for(h=103090;h<=103093;h++)w[h]=0;for(h=103097;h<=103099;h++)w[h]=0;for(h=103100;h<=103102;h++)w[h]=2;for(h=103107;h<=103109;h++)w[h]=0;for(h=103110;h<=103112;h++)w[h]=2;for(h=103113;h<=103116;h++)w[h]=0;for(h=103117;h<=103120;h++)w[h]=2;for(h=103153;h<=103157;h++)w[h]=0;for(h=103158;h<=103162;h++)w[h]=2;for(h=103163;h<=103165;h++)w[h]=0;for(h=103166;h<=103168;h++)w[h]=1;for(h=103169;h<=103171;h++)w[h]=2;for(h=103186;h<=103188;h++)w[h]=0;for(h=103189;h<=103191;h++)w[h]=2;for(h=103192;h<=103195;h++)w[h]=0;for(h=103196;h<=103199;h++)w[h]=2;for(h=103200;h<=103224;h++)w[h]=0;for(h=103225;h<=103227;h++)w[h]=1;for(h=103232;h<=103237;h++)w[h]=0;for(h=103238;h<=103243;h++)w[h]=2;for(h=103244;h<=103246;h++)w[h]=0;for(h=103247;h<=103249;h++)w[h]=2;for(h=103254;h<=103256;h++)w[h]=0;for(h=103257;h<=103259;h++)w[h]=2;for(h=103264;h<=103266;h++)w[h]=0;for(h=103267;h<=103269;h++)w[h]=2;for(h=103300;h<=103375;h++)w[h]=0;for(h=103381;h<=103383;h++)w[h]=0;for(h=103384;h<=103386;h++)w[h]=1;for(h=103387;h<=103389;h++)w[h]=0;for(h=103390;h<=103392;h++)w[h]=2;for(h=103397;h<=103399;h++)w[h]=0;for(h=103400;h<=103471;h++)w[h]=2;for(h=103476;h<=103478;h++)w[h]=0;for(h=103479;h<=103481;h++)w[h]=2;for(h=103486;h<=103488;h++)w[h]=0;for(h=103489;h<=103491;h++)w[h]=2;for(h=103492;h<=103495;h++)w[h]=0;for(h=103496;h<=103499;h++)w[h]=2;for(h=103528;h<=103543;h++)w[h]=0;for(h=103544;h<=103548;h++)w[h]=2;for(h=103549;h<=103551;h++)w[h]=0;for(h=103552;h<=103554;h++)w[h]=1;for(h=103555;h<=103557;h++)w[h]=2;for(h=103558;h<=103560;h++)w[h]=0;for(h=103571;h<=103573;h++)w[h]=0;for(h=103574;h<=103576;h++)w[h]=2;for(h=103577;h<=103580;h++)w[h]=0;for(h=103581;h<=103583;h++)w[h]=2;for(h=103595;h<=103694;h++)w[h]=0;for(h=103696;h<=103699;h++)w[h]=0;for(h=103700;h<=103793;h++)w[h]=2;for(h=103794;h<=103890;h++)w[h]=0;for(h=103891;h<=103896;h++)w[h]=2;for(h=103900;h<=103971;h++)w[h]=2;for(h=103972;h<=103977;h++)w[h]=0;for(h=112e3;h<=112101;h++)w[h]=0;const jL=[102100,102113,3857,3785,900913],sB=[104905,104971],nB=[104903],oB=[4326,...jL,...sB,...nB],vm=[-20037508342788905e-9,20037508342788905e-9],N_=[-20037508342787e-6,20037508342787e-6],Vb={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:vm,origin:N_,dx:1e-5},VL={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:vm,origin:N_,dx:1e-5},102100:Vb,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:vm,origin:N_,dx:1e-5},3857:Vb,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:Vb,104903:{wkTemplate:'GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400,0,AUTHORITY["ESRI","107903"]],AUTHORITY["ESRI","106903"]],PRIMEM["Reference_Meridian",0,AUTHORITY["ESRI","108900"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["ESRI","104903"]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function Ht(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const r=t.wkid,i=e.wkid;if(r!=null||i!=null){if(r===i||Dn(t)&&Dn(e))return!0;const o=t.latestWkid;if(o!=null&&i===o)return!0;const l=e.latestWkid;return l!=null&&r===l}let s,n;return t.wkt2&&e.wkt2?(s=t.wkt2,n=e.wkt2):t.wkt&&e.wkt&&(s=t.wkt,n=e.wkt),!(!s||!n)&&s.toUpperCase()===n.toUpperCase()}function Yr(t){const e=t?.wkid;return e!=null&&e>=2e3&&VL[e]||null}function vv(t){if(!t)return;const{wkid:e,vcsWkid:r}=t;if(e)return r?JSON.stringify({wkid:e,vcsWkid:r}):String(e);const i=t.wkt||t.wkt2;return JSON.stringify(i?r?{wkt:i,vcsWkid:r}:{wkt:i}:{})}function Jh(t){if(!Fi(t))return!1;const{wkid:e}=t;if(e)return w[e]==null;const r=t.wkt2||t.wkt;return!!r&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(r)}function aB(t){return!(zL(t)||UL(t))}function ku(t){return t?.wkid===4326}function y1e(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function BI(t){return t?.wkid===4490}function Dn(t){const e=t?.wkid;return e!=null&&e>=2e3&&jL.includes(e)}function lB(t){return t?.wkid===32662}function xw(t){return t===104971||t===104905}function zL(t){return xw(t?.wkid)}function Tw(t){return t===104903}function UL(t){return Tw(t?.wkid)}function uB(t){const e=t?.wkid;return e!=null&&e>=2e3&&oB.includes(e)}function Fi(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const qL={wkid:4326,wkt:sl(VL[4326].wkTemplate,{Central_Meridian:"0.0"})},GL={wkid:102100,latestWkid:3857},cB={wkid:32662};function FT(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const dB=FT(ct),NT=FT(An),DT=FT(Za),hB={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${ct.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},pB=NT.wkt.toUpperCase(),fB=DT.wkt.toUpperCase();function mB(t){if(t!=null&&Fi(t)){const e=t.wkid,r=t.wkt2??t.wkt;if(xw(e))return An;const i=r?.toUpperCase();if(r&&i===pB)return An;if(Tw(e)||i&&i===fB)return Za}return ct}function g1e(t){return xw(t)?An:Tw(t)?Za:ct}function wv(t){return Ht(t,dB)}function Ya(t){return wv(t)||Ht(t,NT)||Ht(t,DT)}const BL=39.37,yB=ct.radius*Math.PI/200,HL=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,wh=w,WL=/UNIT\[([^\]]+)]/i,gB=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),vB=Lt()({millimeter:"millimeters",centimeter:"centimeters",meter:"meters",meter_german:"german-meters",kilometer:"kilometers",decimeter:"decimeters",micrometer:"micrometers",nanometer:"nanometers","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",fathom:"fathoms",nautical_mile:"nautical-miles",chain_us:"us-chains",link_us:"us-links",mile_us:"us-miles",yard_clarke:"clarke-yards",chain_clarke:"clarke-chains",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",link_sears:"sears-links",yard_benoit_1895_a:"benoit-1895-a-yards",foot_benoit_1895_a:"benoit-1895-a-feet",chain_benoit_1895_a:"benoit-1895-a-chains",link_benoit_1895_a:"benoit-1895-a-links",yard_benoit_1895_b:"benoit-1895-b-yards",foot_benoit_1895_b:"benoit-1895-b-feet",chain_benoit_1895_b:"benoit-1895-b-chains",link_benoit_1895_b:"benoit-1895-b-links",foot_1865:"1865-feet",foot_indian:"indian-feet",foot_indian_1937:"indian-1937-feet",foot_indian_1962:"indian-1962-feet",foot_indian_1975:"indian-1975-feet",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",yard_indian_1962:"indian-1962-yards",yard_indian_1975:"indian-1975-yards",statute_mile:"statute-miles",foot_gold_coast:"gold-coast-feet",foot_british_1936:"british-1936-feet",yard:"yards",chain:"chains",link:"links",yard_sears_1922_truncated:"sears-1922-truncated-yards",foot_sears_1922_truncated:"sears-1922-truncated-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",link_sears_1922_truncated:"sears-1922-truncated-links",yard_us:"us-yards",inch:"inches",inch_us:"us-inches",rod:"rods",rod_us:"us-rods",nautical_mile_us:"us-nautical-miles",nautical_mile_uk:"uk-nautical-miles",smoot:"smoots",vara_tx:"tx-vara",point:"points"}),Ts=t=>t*t,Qo=t=>t*t*t,wm={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},meters:{inBaseUnits:1},feet:{inBaseUnits:.3048},"us-feet":{inBaseUnits:.3048006096012192},"clarke-feet":{inBaseUnits:.3047972654},fathoms:{inBaseUnits:1.8288},"nautical-miles":{inBaseUnits:1852},"german-meters":{inBaseUnits:1.0000135965},"us-chains":{inBaseUnits:20.11684023368047},"us-links":{inBaseUnits:.2011684023368047},"us-miles":{inBaseUnits:1609.347218694438},kilometers:{inBaseUnits:1e3},"clarke-yards":{inBaseUnits:.9143917962},"clarke-chains":{inBaseUnits:20.1166195164},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"sears-links":{inBaseUnits:.2011676512155263},"benoit-1895-a-yards":{inBaseUnits:.9143992},"benoit-1895-a-feet":{inBaseUnits:.3047997333333333},"benoit-1895-a-chains":{inBaseUnits:20.1167824},"benoit-1895-a-links":{inBaseUnits:.201167824},"benoit-1895-b-yards":{inBaseUnits:.9143992042898124},"benoit-1895-b-feet":{inBaseUnits:.3047997347632708},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"benoit-1895-b-links":{inBaseUnits:.2011678249437587},"1865-feet":{inBaseUnits:.3048008333333334},"indian-feet":{inBaseUnits:.3047995102481469},"indian-1937-feet":{inBaseUnits:.30479841},"indian-1962-feet":{inBaseUnits:.3047996},"indian-1975-feet":{inBaseUnits:.3047995},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"indian-1962-yards":{inBaseUnits:.9143988},"indian-1975-yards":{inBaseUnits:.9143985},miles:{inBaseUnits:1609.344},"statute-miles":{inBaseUnits:1609.344},"gold-coast-feet":{inBaseUnits:.3047997101815088},"british-1936-feet":{inBaseUnits:.3048007491},yards:{inBaseUnits:.9144},chains:{inBaseUnits:20.1168},links:{inBaseUnits:.201168},"sears-1922-truncated-yards":{inBaseUnits:.914398},"sears-1922-truncated-feet":{inBaseUnits:.3047993333333334},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"sears-1922-truncated-links":{inBaseUnits:.20116756},"us-yards":{inBaseUnits:.9144018288036576},decimeters:{inBaseUnits:.1},inches:{inBaseUnits:.0254},"us-inches":{inBaseUnits:.0254000508001016},rods:{inBaseUnits:5.0292},"us-rods":{inBaseUnits:5.029210058420118},"us-nautical-miles":{inBaseUnits:1853.248},"uk-nautical-miles":{inBaseUnits:1853.184},smoots:{inBaseUnits:1.7018},"tx-vara":{inBaseUnits:.8466683600033867},points:{inBaseUnits:.0003527777777777778},micrometers:{inBaseUnits:1e-6},nanometers:{inBaseUnits:1e-9},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:Ts(.001)},"square-centimeters":{inBaseUnits:Ts(.01)},"square-decimeters":{inBaseUnits:Ts(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:Ts(1e3)},"square-inches":{inBaseUnits:Ts(.0254)},"square-feet":{inBaseUnits:Ts(.3048)},"square-yards":{inBaseUnits:Ts(.9144)},"square-miles":{inBaseUnits:Ts(1609.344)},"square-nautical-miles":{inBaseUnits:Ts(1852)},"square-us-feet":{inBaseUnits:Ts(1200/3937)},acres:{inBaseUnits:.0015625*Ts(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*Qo(.001)},"cubic-centimeters":{inBaseUnits:1e3*Qo(.01)},"cubic-decimeters":{inBaseUnits:1e3*Qo(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*Qo(1e3)},"cubic-inches":{inBaseUnits:1e3*Qo(.0254)},"cubic-feet":{inBaseUnits:1e3*Qo(.3048)},"cubic-yards":{inBaseUnits:1e3*Qo(.9144)},"cubic-miles":{inBaseUnits:1e3*Qo(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},wB=(()=>{const t={};for(const e in wm)for(const r in wm[e].units)t[r]=e;return t})();function bB(t,e,r){return t*wm[r].units[e].inBaseUnits}function _B(t,e,r){return t/wm[r].units[e].inBaseUnits}const SB=["inches","feet","yards","miles","nautical-miles","us-feet","millimeters","centimeters","decimeters","meters","kilometers"],$B=["metric","imperial"],ZL=[...$B,...SB],xB=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function D_(t){const e=wB[t];if(!e)throw new Error("unknown type");return e}function HI(t,e=null){return e=e||D_(t),wm[e].baseUnit===t}function yt(t,e,r){if(e===r)return t;const i=D_(e);if(i!==D_(r))throw new Error("incompatible units");const s=HI(e,i)?t:bB(t,e,i);return HI(r,i)?s:_B(s,r,i)}function v1e(t,e,r,i=!1){if(!i&&Jh(e))throw new Error("Unable to convert from an angular unit to a linear unit.");const s=Gu(e);return s!==r&&(t=s?yt(t,s,r):yt(t*=Bi(e),"meters",r)),t}function w1e(t,e,r,i=!1){if(!i&&Jh(r))throw new Error("Unable to convert from a linear unit to an angular unit.");const s=Gu(r);return e!==s&&(t=s?yt(t,e,s):yt(t,e,"meters")/Bi(r)),t}function TB(t){switch(t){case"metric":return"meters";case"imperial":return"feet";default:return t}}function b1e(t){return TB(t)}function _1e(t){switch(t){case"metric":return"square-meters";case"imperial":return"square-feet";default:return t}}function S1e(t,e,r){switch(r){case"metric":return MB(t,e);case"imperial":return EB(t,e);default:return r}}function $1e(t,e,r){switch(r){case"metric":return IB(t,e);case"imperial":return OB(t,e);default:return r}}function MB(t,e){const r=yt(t,e,"meters");return Math.abs(r)<3e3?"meters":"kilometers"}function IB(t,e){const r=yt(t,e,"meters");return Math.abs(r)<1e5?"meters":"kilometers"}function EB(t,e){const r=yt(t,e,"feet");return Math.abs(r)<1e3?"feet":"miles"}function OB(t,e){const r=yt(t,e,"feet");return Math.abs(r)<1e5?"feet":"miles"}function x1e(t,e){const r=yt(t,e,"square-meters");return Math.abs(r)<3e6?"square-meters":"square-kilometers"}function T1e(t,e){const r=yt(t,e,"square-feet");return Math.abs(r)<1e6?"square-feet":"square-miles"}function kB(t,e,r){return yt(t,e,"meters")/(r*Math.PI/180)}function jT(t){return vB.fromJSON(t.toLowerCase())||null}function bv(t){if(t!=null&&!aB(t))return 1;const e=Bi(t);return e>1e5?1:e}function JL(t){return Bi(t)>=mB(t).metersPerDegree?"meters":Gu(t)}function Bi(t,e=ct.metersPerDegree){return CB(t,!0)??e}function CB(t,e=!1){const r=t?.wkid??null,i=t?.wkt2??t?.wkt??null;let s=null;if(r){if(xw(r))return An.metersPerDegree;if(Tw(r))return Za.metersPerDegree;s=wh.values[wh[r]],!s&&e&&gB.has(r)&&(s=yB)}else i&&(QL(i)?s=WI(HL.exec(i),s):KL(i)&&(s=WI(WL.exec(i),s)));return s}function M1e(t){return Jh(t)?1:Bi(t)}function WI(t,e){return t?.[1]?YL(t[1]):e}function YL(t){return parseFloat(t.split(",")[1])}function Gu(t){const e=t?.wkid??null,r=t?.wkt2??t?.wkt??null;let i=null;if(e)i=wh.units[wh[e]];else if(r){const s=QL(r)?HL:KL(r)?WL:null;if(s){const n=s.exec(r);n?.[1]&&(i=AB(n[1]))}}return i!=null?jT(i):null}function I1e(t){const e=Gu(t);return e!=null&&ZL.includes(e)?e:null}function E1e(t){const e=JL(t);return e!=null&&ZL.includes(e)?e:null}function O1e(t){const e=Gu(t);return e==null?null:xB.get(e)}function KL(t){return/^GEOCCS/i.test(t)}function QL(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const PB=1e-7;function AB(t){let r=/[\\"']([^\\"']+)/.exec(t)?.[1];if(!r||!jT(r)){const i=YL(t);r=null;const s=wh.values;for(let n=0;n<s.length;++n)if(Math.abs(i-s[n])<PB){r=wh.units[n];break}}return r}function k1e(t){const e=Gu(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"fathoms":case"nautical-miles":case"us-chains":case"us-links":case"us-miles":case"clarke-yards":case"clarke-chains":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"sears-links":case"benoit-1895-a-yards":case"benoit-1895-a-feet":case"benoit-1895-a-chains":case"benoit-1895-a-links":case"benoit-1895-b-yards":case"benoit-1895-b-feet":case"benoit-1895-b-chains":case"benoit-1895-b-links":case"1865-feet":case"indian-feet":case"indian-1937-feet":case"indian-1962-feet":case"indian-1975-feet":case"indian-yards":case"indian-1937-yards":case"indian-1962-yards":case"indian-1975-yards":case"statute-miles":case"gold-coast-feet":case"british-1936-feet":case"yards":case"chains":case"links":case"sears-1922-truncated-yards":case"sears-1922-truncated-feet":case"sears-1922-truncated-chains":case"sears-1922-truncated-links":case"us-yards":case"inches":case"us-inches":case"rods":case"us-rods":case"us-nautical-miles":case"uk-nautical-miles":case"smoots":case"tx-vara":case"points":return"imperial";case"millimeters":case"centimeters":case"meters":case"german-meters":case"kilometers":case"decimeters":case"micrometers":case"nanometers":case"50-kilometers":case"150-kilometers":return"metric"}return null}const RB={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},LB={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},FB={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},NB=Lt()(RB),DB=Lt()(LB),C1e=Lt()(FB);var ln,On;let Z=(On=class extends F{static fromJSON(e){if(!e)return null;if(e?.wkid===102100)return ln.WebMercator;if(e?.wkid===4326)return ln.WGS84;const r=new ln;return r.read(e),r}constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(e){return e&&typeof e=="object"?e:{[typeof e=="string"?"wkt":"wkid"]:e}}get isWGS84(){return ku(this)}get isWebMercator(){return Dn(this)}get isGeographic(){return Jh(this)}get isWrappable(){return uB(this)}get metersPerUnit(){return Bi(this)}get unit(){return Gu(this)||(this.isGeographic?"degrees":null)}writeWkt(e,r){this.wkid||(r.wkt=e)}clone(){if(this===ln.WGS84)return new ln(qL);if(this===ln.WebMercator)return new ln(GL);const e=new ln;return this.wkid!=null?(e.wkid=this.wkid,this.latestWkid!=null&&(e.latestWkid=this.latestWkid),this.vcsWkid!=null&&(e.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(e.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(e.wkt=this.wkt),this.wkt2!=null&&(e.wkt2=this.wkt2)),this.imageCoordinateSystem&&(e.imageCoordinateSystem=E(this.imageCoordinateSystem)),e}equals(e){if(e==null)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(this.imageCoordinateSystem==null||e.imageCoordinateSystem==null)return!1;const{id:r,referenceServiceName:i}=e.imageCoordinateSystem,{geodataXform:s}=e.imageCoordinateSystem,n=this.imageCoordinateSystem;return r==null||s?JSON.stringify(n)===JSON.stringify(e.imageCoordinateSystem):i?n.id===r&&n.referenceServiceName===i:n.id===r}return Ht(this,e)}toJSON(e){return this.write(void 0,e)}},ln=On,On.GCS_NAD_1927=null,On.WGS84=null,On.WebMercator=null,On.PlateCarree=null,On);a([c({readOnly:!0})],Z.prototype,"isWGS84",null),a([c({readOnly:!0})],Z.prototype,"isWebMercator",null),a([c({readOnly:!0})],Z.prototype,"isGeographic",null),a([c({readOnly:!0})],Z.prototype,"isWrappable",null),a([c({type:xe,json:{write:!0}})],Z.prototype,"latestWkid",void 0),a([c({readOnly:!0})],Z.prototype,"metersPerUnit",null),a([c({readOnly:!0})],Z.prototype,"unit",null),a([c({type:xe,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],Z.prototype,"wkid",void 0),a([c({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],Z.prototype,"wkt",void 0),a([q("wkt"),q("web-scene","wkt")],Z.prototype,"writeWkt",null),a([c({type:String,json:{write:!1}})],Z.prototype,"wkt2",void 0),a([c({type:xe,json:{write:!0}})],Z.prototype,"vcsWkid",void 0),a([c({type:xe,json:{write:!0}})],Z.prototype,"latestVcsWkid",void 0),a([c()],Z.prototype,"imageCoordinateSystem",void 0),Z=ln=a([b("esri.geometry.SpatialReference")],Z),Z.prototype.toJSON.isDefaultToJSON=!0,Z.GCS_NAD_1927=X.freeze(new Z({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),Z.WGS84=X.freeze(new Z(qL)),Z.WebMercator=X.freeze(new Z(GL)),Z.PlateCarree=X.freeze(new Z(cB));function V(t,e,r){let i,s;return e===void 0||Array.isArray(e)?(s=t,r=e,i=[void 0]):(s=e,i=Array.isArray(t)?t:[t]),(n,o)=>{const l=n.constructor.prototype;i.forEach(u=>{const d=TT(n,u,s);d.read&&typeof d.read=="object"||(d.read={}),d.read.reader=l[o],r&&(d.read.source=(d.read.source||[]).concat(r))})}}let Ut=class extends F{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Z.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,r){if(e instanceof Z)return e;if(e!=null){const i=new Z;return i.read(e,r),i}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,r){this.cache[e]=r}};a([c()],Ut.prototype,"type",void 0),a([c({readOnly:!0})],Ut.prototype,"cache",null),a([c({readOnly:!0})],Ut.prototype,"extent",null),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Ut.prototype,"hasM",void 0),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Ut.prototype,"hasZ",void 0),a([c({type:Z,json:{write:!0},value:Z.WGS84})],Ut.prototype,"spatialReference",void 0),a([V("spatialReference")],Ut.prototype,"readSpatialReference",null),Ut=a([b("esri.geometry.Geometry")],Ut);const jB=Object.prototype.toString;function VB(t){const e="__accessorMetadata__"in t?ut(t):t;return function(...r){if(r.push(e),typeof r[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return zB.apply(this,r)}}function zB(t,e,r,i){Ym(t,e).cast=i}function UB(t){return(e,r)=>{Ym(e,t).cast=e[r]}}function Ce(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&jB.call(t[0])==="[object Function]"?VB(t[0]):t.length===1&&typeof t[0]=="string"?UB(t[0]):void 0}function bh(t){if(t&&typeof t=="object"&&"type"in t&&t.type==="mesh")throw new x("internal:mesh","Mesh geometries are not supported for this operation")}function qB(t){t.forEach(bh)}const GB=57.29577951308232,BB=.017453292519943;function ZI(t){return t*GB}function JI(t){return t*BB}function A1e(t){return Math.PI/2-2*Math.atan(Math.exp(-t/ct.radius))}function j_(t){return t.wkid!=null||t.wkt!=null}const zb=[0,0];function _v(t,e,r,i,s){const n=t,o=s;if(o.spatialReference=r,"x"in n&&"x"in o)[o.x,o.y]=e(n.x,n.y,zb,i);else if("xmin"in n&&"xmin"in o)[o.xmin,o.ymin]=e(n.xmin,n.ymin,zb,i),[o.xmax,o.ymax]=e(n.xmax,n.ymax,zb,i);else if("paths"in n&&"paths"in o||"rings"in n&&"rings"in o){const l="paths"in n?n.paths:n.rings,u=[];let d;for(let p=0;p<l.length;p++){const f=l[p];d=[],u.push(d);for(let m=0;m<f.length;m++)d.push(e(f[m][0],f[m][1],[0,0],i)),f[m].length>2&&d[m].push(f[m][2]),f[m].length>3&&d[m].push(f[m][3])}"paths"in o?o.paths=u:o.rings=u}else if("points"in n&&"points"in o){const l=n.points,u=[];for(let d=0;d<l.length;d++)u[d]=e(l[d][0],l[d][1],[0,0],i),l[d].length>2&&u[d].push(l[d][2]),l[d].length>3&&u[d].push(l[d][3]);o.points=u}return s}function Lg(t,e){const r=t&&(j_(t)?t:t.spatialReference),i=e&&(j_(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!r||!i)&&(!!Ht(i,r)||Dn(i)&&ku(r)||Dn(r)&&ku(i))}function Mw(t,e){if(t==null)return null;const r=t.spatialReference,i=e&&(j_(e)?e:e.spatialReference);return Lg(r,i)?Ht(r,i)?E(t):Dn(i)?_v(t,ld,Z.WebMercator,!1,E(t)):ku(i)?_v(t,Iw,Z.WGS84,!1,E(t)):null:null}function ld(t,e,r=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const i=JI(e);return r[0]=JI(t)*ct.radius,r[1]=ct.halfSemiMajorAxis*Math.log((1+Math.sin(i))/(1-Math.sin(i))),r}function Iw(t,e,r=[0,0],i=!1){if(t===vm[0])r[0]=-180;else if(t===vm[1])r[0]=180;else{const s=ZI(t/ct.radius);r[0]=i?s:s-360*Math.floor((s+180)/360)}return r[1]=ZI(Math.PI/2-2*Math.atan(Math.exp(-e/ct.radius))),r}function za(t,e=!1,r=E(t)){return bh(t),bh(r),_v(t,ld,Z.WebMercator,e,r)}function ud(t,e=!1,r=E(t)){return bh(t),bh(r),_v(t,Iw,Z.WGS84,e,r)}function XL(t,e){const r=t.x-e.x,i=t.y-e.y,s=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(r*r+i*i+s*s)}function HB(t){return eF(t,tF)?.[0]??null}function WB(t){return eF(t,tF)?.[1]??null}function eF({x:t,y:e,spatialReference:r},i=[0,0]){if(r){if(Dn(r))return Iw(t,e,i);if(Jh(r))return i[0]=t,i[1]=e,i}return null}const tF=[0,0];var Fg;const Ub=[0,0];function YI(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let ee=Fg=class extends Ut{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const r=t._get("spatialReference");e._set("spatialReference",X.isFrozen(r)?r:r.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,r,i,s){let n;if(Array.isArray(t))n=t,s=e,t=n[0],e=n[1],r=n[2],i=n[3];else if(t&&typeof t=="object"){if(n=t,t=n.x!=null?n.x:n.longitude,e=n.y!=null?n.y:n.latitude,r=n.z,i=n.m,(s=n.spatialReference)&&s.declaredClass!=="esri.geometry.SpatialReference"&&(s=new Z(s)),n.longitude!=null||n.latitude!=null){if(n.longitude==null)L.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(n.latitude==null)L.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!n.declaredClass&&s?.isWebMercator){const l=ld(n.longitude,n.latitude,Ub);t=l[0],e=l[1]}}}else YI(r)?(s=r,r=null):YI(i)&&(s=i,i=null);const o={x:t,y:e};return o.x==null&&o.y!=null?L.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&L.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),s!=null&&(o.spatialReference=s),r!=null&&(o.z=r),i!=null&&(o.m=i),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return WB(this)}set latitude(t){const{spatialReference:e,x:r}=this;t!=null&&e&&(e.isWebMercator?this._set("y",ld(r,t,Ub)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return HB(this)}set longitude(t){const{y:e,spatialReference:r}=this;t!=null&&r&&(r.isWebMercator?this._set("x",ld(t,e,Ub)[0]):r.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,r){e[r]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new Fg;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return Fg.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:r,z:i,m:s,spatialReference:n}=this,{z:o,m:l}=t;let{x:u,y:d,spatialReference:p}=t;if(!n.equals(p))if(n.isWebMercator&&p.isWGS84)[u,d]=ld(u,d),p=n;else{if(!n.isWGS84||!p.isWebMercator)return!1;[u,d]=Iw(u,d),p=n}return e===u&&r===d&&i===o&&s===l&&n.wkid===p.wkid}offset(t,e,r){return this.x+=t,this.y+=e,r!=null&&(this.z=(this.z??0)+r),this}normalize(){if(!this.spatialReference)return this;const t=Yr(this.spatialReference);if(!t)return this;let e=this.x;const[r,i]=t.valid,s=2*i;let n;return e>i?(n=Math.ceil(Math.abs(e-i)/s),e-=n*s):e<r&&(n=Math.ceil(Math.abs(e-r)/s),e+=n*s),this._set("x",e),this}distance(t){return XL(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};a([c({readOnly:!0})],ee.prototype,"cache",null),a([c({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],ee.prototype,"hasM",null),a([c({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],ee.prototype,"hasZ",null),a([c({type:Number})],ee.prototype,"latitude",null),a([c({type:Number})],ee.prototype,"longitude",null),a([c({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),Ce(t=>isNaN(t)?t:Br(t))],ee.prototype,"x",void 0),a([q("x")],ee.prototype,"writeX",null),a([V("x")],ee.prototype,"readX",null),a([c({type:Number,json:{write:!0}})],ee.prototype,"y",void 0),a([c({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],ee.prototype,"z",void 0),a([c({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],ee.prototype,"m",void 0),ee=Fg=a([b("esri.geometry.Point")],ee),ee.prototype.toJSON.isDefaultToJSON=!0;const qb=[0,0];function ty(t,e){return e!=null&&Vr(t,e.x,e.y,e.z)}function R1e(t,e){if(!e.points?.length)return!1;for(const r of e.points)if(!_h(t,r))return!1;return!0}function ZB(t,e){const{xmin:r,ymin:i,zmin:s,xmax:n,ymax:o,zmax:l}=e;return t.hasZ&&e.hasZ?Vr(t,r,i,s)&&Vr(t,r,o,s)&&Vr(t,n,o,s)&&Vr(t,n,i,s)&&Vr(t,r,i,l)&&Vr(t,r,o,l)&&Vr(t,n,o,l)&&Vr(t,n,i,l):Vr(t,r,i)&&Vr(t,r,o)&&Vr(t,n,o)&&Vr(t,n,i)}function _h(t,e){return Vr(t,e[0],e[1])}function JB(t,e){return Vr(t,e[0],e[1],e[2])}function Vr(t,e,r,i){return e>=t.xmin&&e<=t.xmax&&r>=t.ymin&&r<=t.ymax&&(i==null||!t.hasZ||i>=t.zmin&&i<=t.zmax)}function VT(t,e){return qb[1]=e.y,qb[0]=e.x,YB(t,qb)}function YB(t,e){return zT(t.rings,e)}function zT(t,e){if(!t||t.length<1)return!1;if(KB(t))return KI(!1,t,e);let r=!1;for(let i=0,s=t.length;i<s;i++)r=KI(r,t[i],e);return r}function KB(t){return!Array.isArray(t[0][0])}function KI(t,e,r){const[i,s]=r;let n=t,o=0;for(let l=0,u=e.length;l<u;l++){o++,o===u&&(o=0);const[d,p]=e[l],[f,m]=e[o];(p<s&&m>=s||m<s&&p>=s)&&d+(s-p)/(m-p)*(f-d)<i&&(n=!n)}return n}function QB(t,e){return ty(t,e)}function XB(t,e){const r=t.hasZ&&e.hasZ;let i,s,n;if(t.xmin<=e.xmin){if(i=e.xmin,t.xmax<i)return!1}else if(i=t.xmin,e.xmax<i)return!1;if(t.ymin<=e.ymin){if(s=e.ymin,t.ymax<s)return!1}else if(s=t.ymin,e.ymax<s)return!1;if(r&&e.hasZ){if(t.zmin<=e.zmin){if(n=e.zmin,t.zmax<n)return!1}else if(n=t.zmin,e.zmax<n)return!1}return!0}function eH(t,e){const{points:r,hasZ:i}=e,s=i?JB:_h;for(const n of r)if(s(t,n))return!0;return!1}const Cu=[0,0],Pu=[0,0],Au=[0,0],Ru=[0,0],tH=[Cu,Pu,Au,Ru],rF=[[Au,Cu],[Cu,Pu],[Pu,Ru],[Ru,Au]];function rH(t,e){return iH(t,e.rings)}function iH(t,e){Cu[0]=t.xmin,Cu[1]=t.ymax,Pu[0]=t.xmax,Pu[1]=t.ymax,Au[0]=t.xmin,Au[1]=t.ymin,Ru[0]=t.xmax,Ru[1]=t.ymin;for(const r of tH)if(zT(e,r))return!0;for(const r of e){if(!r.length)continue;let i=r[0];if(_h(t,i))return!0;for(let s=1;s<r.length;s++){const n=r[s];if(_h(t,n)||iF(i,n,rF))return!0;i=n}}return!1}function sH(t,e){Cu[0]=t.xmin,Cu[1]=t.ymax,Pu[0]=t.xmax,Pu[1]=t.ymax,Au[0]=t.xmin,Au[1]=t.ymin,Ru[0]=t.xmax,Ru[1]=t.ymin;const r=e.paths;for(const i of r){if(!r.length)continue;let s=i[0];if(_h(t,s))return!0;for(let n=1;n<i.length;n++){const o=i[n];if(_h(t,o)||iF(s,o,rF))return!0;s=o}}return!1}const Yt=[0,0];function nH(t){for(let e=0;e<t.length;e++){const r=t[e];for(let s=0;s<r.length-1;s++){const n=r[s],o=r[s+1];for(let l=e+1;l<t.length;l++)for(let u=0;u<t[l].length-1;u++){const d=t[l][u],p=t[l][u+1];if(V_(n,o,d,p,Yt)&&!(Yt[0]===n[0]&&Yt[1]===n[1]||Yt[0]===d[0]&&Yt[1]===d[1]||Yt[0]===o[0]&&Yt[1]===o[1]||Yt[0]===p[0]&&Yt[1]===p[1]))return!0}}const i=r.length;if(!(i<=4))for(let s=0;s<i-3;s++){let n=i-1;s===0&&(n=i-2);const o=r[s],l=r[s+1];for(let u=s+2;u<n;u++){const d=r[u],p=r[u+1];if(V_(o,l,d,p,Yt)&&!(Yt[0]===o[0]&&Yt[1]===o[1]||Yt[0]===d[0]&&Yt[1]===d[1]||Yt[0]===l[0]&&Yt[1]===l[1]||Yt[0]===p[0]&&Yt[1]===p[1]))return!0}}}return!1}function iF(t,e,r){for(let i=0;i<r.length;i++)if(V_(t,e,r[i][0],r[i][1]))return!0;return!1}function V_(t,e,r,i,s){const[n,o]=t,[l,u]=e,[d,p]=r,[f,m]=i,y=f-d,g=n-d,v=l-n,_=m-p,S=o-p,M=u-o,C=_*v-y*M;if(C===0)return!1;const T=(y*S-_*g)/C,O=(v*S-M*g)/C;return T>=0&&T<=1&&O>=0&&O<=1&&(s&&(s[0]=n+T*(l-n),s[1]=o+T*(u-o)),!0)}function oH(t){switch(t){case"esriGeometryEnvelope":case"extent":return XB;case"esriGeometryMultipoint":case"multipoint":return eH;case"esriGeometryPoint":case"point":return QB;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return rH;case"esriGeometryPolyline":case"polyline":return sH}}var Cs;function aH(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function Xo(t,e,r){return e==null?r:r==null?e:t(e,r)}let he=Cs=class extends Ut{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,r,i,s){return aH(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?Z.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:r,ymax:i,spatialReference:s??Z.WGS84}}static fromPoint(t){return new Cs({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new ee({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new Cs;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,r=t.spatialReference;return e&&r&&!e.equals(r)&&Lg(e,r)&&(t=e.isWebMercator?za(t):ud(t,!0)),t.type==="point"?ty(this,t):t.type==="extent"&&ZB(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,r=t.spatialReference;return e&&r&&!e.equals(r)&&Lg(e,r)&&(t=e.isWebMercator?za(t):ud(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),r=this.width*e,i=this.height*e;if(this.xmin+=r,this.ymin+=i,this.xmax-=r,this.ymax-=i,this.hasZ){const s=(this.zmax-this.zmin)*e;this.zmin+=s,this.zmax-=s}if(this.hasM){const s=(this.mmax-this.mmin)*e;this.mmin+=s,this.mmax-=s}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,r=t.spatialReference;return e&&r&&!Ht(e,r)&&Lg(e,r)&&(t=e.isWebMercator?za(t):ud(t,!0)),oH(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,r){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,r!=null&&(this.zmin+=r,this.zmax+=r),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Xo(Math.min,this.zmin,t.zmin),this.zmax=Xo(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Xo(Math.min,this.mmin,t.mmin),this.mmax=Xo(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Xo(Math.max,this.zmin,t.zmin),this.zmax=Xo(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Xo(Math.max,this.mmin,t.mmin),this.mmax=Xo(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=Yr(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,r=this._getCM(t);if(r){const i=e.isWebMercator?ud(r):r;this.xmin-=r.x,this.xmax-=r.x,e.isWebMercator||(i.x=Gb(i.x,t).x),this.spatialReference=new Z(sl((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:i.x}))}return this}_getCM(t){let e=null;const[r,i]=t.valid,s=this.xmin,n=this.xmax;return s>=r&&s<=i&&n>=r&&n<=i||(e=this.center),e}_normalize(t,e,r){const i=this.spatialReference;if(!i)return this;const s=r??Yr(i);if(s==null)return this;const n=this._getParts(s).map(u=>u.extent);if(n.length<2)return n[0]||this;if(n.length>2)return t?this._shiftCM(s):this.set({xmin:s.valid[0],xmax:s.valid[1]});if(t)return this._shiftCM(s);if(e)return n;let o=!0,l=!0;return n.forEach(u=>{u.hasZ||(o=!1),u.hasM||(l=!1)}),{rings:n.map(u=>{const d=[[u.xmin,u.ymin],[u.xmin,u.ymax],[u.xmax,u.ymax],[u.xmax,u.ymin],[u.xmin,u.ymin]];if(o){const p=(u.zmax-u.zmin)/2;for(let f=0;f<d.length;f++)d[f].push(p)}if(l){const p=(u.mmax-u.mmin)/2;for(let f=0;f<d.length;f++)d[f].push(p)}return d}),hasZ:o,hasM:l,spatialReference:i}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:s,ymax:n,spatialReference:o}=this,l=this.width,u=this.xmin,d=this.xmax;let p;t=t||Yr(o);const[f,m]=t.valid;p=Gb(this.xmin,t);const y=p.x,g=p.frameId;p=Gb(this.xmax,t);const v=p.x,_=p.frameId,S=y===v&&l>0;if(l>2*m){const M=new Cs(u<d?y:v,s,m,n,o),C=new Cs(f,s,u<d?v:y,n,o),T=new Cs(0,s,m,n,o),O=new Cs(f,s,0,n,o),P=[],D=[];M.contains(T)&&P.push(g),M.contains(O)&&D.push(g),C.contains(T)&&P.push(_),C.contains(O)&&D.push(_);for(let z=g+1;z<_;z++)P.push(z),D.push(z);e.push({extent:M,frameIds:[g]},{extent:C,frameIds:[_]},{extent:T,frameIds:P},{extent:O,frameIds:D})}else y>v||S?e.push({extent:new Cs(y,s,m,n,o),frameIds:[g]},{extent:new Cs(f,s,v,n,o),frameIds:[_]}):e.push({extent:new Cs(y,s,v,n,o),frameIds:[g]});this.cache._parts=e}const r=this.hasZ,i=this.hasM;if(r||i){const s={};r&&(s.zmin=this.zmin,s.zmax=this.zmax),i&&(s.mmin=this.mmin,s.mmax=this.mmax);for(let n=0;n<e.length;n++)e[n].extent.set(s)}return e}};function Gb(t,e){const[r,i]=e.valid,s=2*i;let n,o=0;return t>i?(n=Math.ceil(Math.abs(t-i)/s),t-=n*s,o=n):t<r&&(n=Math.ceil(Math.abs(t-r)/s),t+=n*s,o=-n),{x:t,frameId:o}}a([c({readOnly:!0})],he.prototype,"cache",null),a([c({readOnly:!0})],he.prototype,"center",null),a([c({readOnly:!0})],he.prototype,"extent",null),a([c({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],he.prototype,"hasM",null),a([c({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],he.prototype,"hasZ",null),a([c({readOnly:!0})],he.prototype,"height",null),a([c({readOnly:!0})],he.prototype,"width",null),a([c({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],he.prototype,"xmin",void 0),a([c({type:Number,json:{write:!0}})],he.prototype,"ymin",void 0),a([c({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],he.prototype,"mmin",void 0),a([c({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],he.prototype,"zmin",void 0),a([c({type:Number,json:{write:!0}})],he.prototype,"xmax",void 0),a([c({type:Number,json:{write:!0}})],he.prototype,"ymax",void 0),a([c({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],he.prototype,"mmax",void 0),a([c({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],he.prototype,"zmax",void 0),he=Cs=a([b("esri.geometry.Extent")],he),he.prototype.toJSON.isDefaultToJSON=!0;let Ff;const lH=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,z_=globalThis.document?.documentElement;function sF(){const t=z_?.getAttribute("lang"),e=globalThis.navigator?.language;return lH??t??e??"en"}function gi(){return Ff===void 0&&(Ff=sF()),Ff}const uH=/^(?<language>[a-z]{2,3})(?:-(?<extlang>[a-z]{3}))?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function UT(t=gi()){return oF(t)?.language}function nF(t=gi()){const e=oF(t);return e?.language&&e?.extlang?t.replace(`${e.language}-`,""):t}function oF(t=gi()){return uH.exec(t)?.groups}const Ng=[];function aF(t){return Ng.push(t),Te(()=>{Ng.splice(Ng.indexOf(t),1)})}const Dg=[];function qT(t){return Dg.push(t),Te(()=>Dg.splice(Dg.indexOf(t),1))}function QI(){const t=sF();Ff!==t&&([...Dg].forEach(e=>e(t)),Ff=t,[...Ng].forEach(e=>e(t)))}globalThis.addEventListener?.("languagechange",QI),z_&&new MutationObserver(()=>{QI()}).observe(z_,{attributeFilter:["lang"]});let ky;function cH(t){return ky&&!ky.destroyed||(ky=t()),ky}var U_;const dH=new $e({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let gt=U_=class extends X{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new U_({categories:this.categories?E(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let r=[];this.categories&&(r=this.categories.map(o=>Array.isArray(o)?JSON.stringify(o):o));let i="";if(this.extent){const o=Mw(this.extent,Z.WGS84);o!=null&&(i=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let s=this.query;!this.disableExtraQuery&&t.extraQuery&&(s="("+s+")"+t.extraQuery);const n={categories:r,bbox:i,q:s,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(n.sortField=this.sortField.split(",").map(o=>dH.toJSON(o.trim())).join(","),n.sortOrder=this.sortOrder),{query:{...e,...n}}}};a([c()],gt.prototype,"categories",void 0),a([c()],gt.prototype,"disableExtraQuery",void 0),a([c({type:he})],gt.prototype,"extent",void 0),a([c()],gt.prototype,"filter",void 0),a([c()],gt.prototype,"num",void 0),a([c()],gt.prototype,"query",void 0),a([c()],gt.prototype,"sortField",void 0),a([c()],gt.prototype,"sortOrder",null),a([c()],gt.prototype,"start",void 0),gt=U_=a([b("esri.portal.PortalQueryParams")],gt);var q_;let ft=q_=class extends F{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e&&this.portal?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.portal?.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then(e=>{const r=e.categorySchema||[];return r.some(i=>i.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):r})}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new x("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new q_({sourceJSON:t});return e.read(t),e}queryItems(t,e){let r=ut(gt,t);const i=this.portal;return parseFloat(i.currentVersion)>5?(r=r||new gt,i.queryPortal(`/content/groups/${this.id}/search`,r,"PortalItem",e)):(r=r?r.clone():new gt,r.query="group:"+this.id+(r.query?" "+r.query:""),i.queryItems(r,e))}_fetchCategorySchemaSet(t,e){const r=this.portal;return r.fetchSelf(r.authMode,!0,e).then(i=>{const s=i.contentCategorySetsGroupQuery;if(s){const n=new gt({disableExtraQuery:!0,num:1,query:s});return r.queryGroups(n,e)}throw new x("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(i=>{if(i.total){const s=i.results[0],n=new gt({num:1,query:`typekeywords:"${t}"`});return s.queryItems(n,e)}throw new x("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(i=>i.total?i.results[0].fetchData("json",e).then(s=>{const n=s?.categorySchema;return n?.length?n:[]}):[])}};a([c()],ft.prototype,"access",void 0),a([c({type:Date})],ft.prototype,"created",void 0),a([c()],ft.prototype,"description",void 0),a([c()],ft.prototype,"id",void 0),a([c()],ft.prototype,"isInvitationOnly",void 0),a([c({type:Date})],ft.prototype,"modified",void 0),a([c()],ft.prototype,"owner",void 0),a([c()],ft.prototype,"portal",void 0),a([c()],ft.prototype,"snippet",void 0),a([c()],ft.prototype,"sortField",void 0),a([c()],ft.prototype,"sortOrder",void 0),a([c()],ft.prototype,"sourceJSON",void 0),a([c()],ft.prototype,"tags",void 0),a([c()],ft.prototype,"thumbnail",void 0),a([c({readOnly:!0})],ft.prototype,"thumbnailUrl",null),a([c()],ft.prototype,"title",void 0),a([c({readOnly:!0})],ft.prototype,"url",null),ft=q_=a([b("esri.portal.PortalGroup")],ft);let Tl=class extends X{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};a([c()],Tl.prototype,"nextQueryParams",void 0),a([c()],Tl.prototype,"queryParams",void 0),a([c()],Tl.prototype,"results",void 0),a([c()],Tl.prototype,"total",void 0),Tl=a([b("esri.portal.PortalQueryResult")],Tl);let Yn=class extends F{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.portal?.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new x("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};a([c({type:Date})],Yn.prototype,"created",void 0),a([c()],Yn.prototype,"id",void 0),a([c()],Yn.prototype,"portal",void 0),a([c()],Yn.prototype,"title",void 0),a([c({readOnly:!0})],Yn.prototype,"url",null),a([c()],Yn.prototype,"username",void 0),Yn=a([b("esri.portal.PortalFolder")],Yn);var G_;let Ve=G_=class extends F{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.id=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.id}`:null}get url(){const t=this.portal?.restUrl;return t?`${t}/community/users/${this.id}`:null}addItem(t){const e=t&&t.item,r=t?.data,i=t?.folder,s={method:"post"};e&&(s.query=e.createPostQuery(),r!=null&&(typeof r=="string"?s.query.text=r:typeof r=="object"&&(s.query.text=JSON.stringify(r))));let n=this.userContentUrl;return i&&(n+="/"+(typeof i=="string"?i:i.id)),this.portal.request(n+"/addItem",s).then(o=>(e.id=o.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}async deleteItem(t,e=!1){let r=this.userContentUrl;t.ownerFolder&&(r+="/"+t.ownerFolder);const i=e?{permanentDelete:!0}:{};await this.portal.request(r+`/items/${t.id}/delete`,{method:"post",query:i}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const r=this.userContentUrl+"/deleteItems",i=[],s=t.map(n=>n.id);if(s.length){const n={method:"post",query:{items:s.join(","),permanentDelete:e}},o=await this.portal.request(r,n);for(const l of o.results){const u=t.find(f=>l.itemId===f.id),d=l.success;let p=null;d?(u.id=null,u.portal=null):l.error&&(p=new x("portal:delete-item-failed",l.error.message,l.error)),i.push({item:u,success:d,error:p})}}return i}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let r;return r=e&&e.folders?e.folders.map(i=>{const s=Yn.fromJSON(i);return s.portal=this.portal,s}):[],r})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(r=>{const i=ft.fromJSON(r);return i.portal=this.portal,i}):[],e})}async fetchItems(t){t??={};let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:r}=await N(()=>Promise.resolve().then(()=>lF),void 0),i={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},s=await this.portal.request(e,{query:i});let n;return s?.items?(n=s.items.map(o=>{const l=r.fromJSON(o);return l.portal=this.portal,l}),await Promise.all(n.map(o=>o.load())),{items:n,nextStart:s.nextStart,total:s.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new ft({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new x("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const r=this.userContentUrl,i=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(r+`/items/${t.id}/restore`,{method:"post",query:i})}toJSON(){throw new x("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new G_({sourceJSON:t});return e.read(t),e}};a([c()],Ve.prototype,"access",void 0),a([c({type:Date})],Ve.prototype,"created",void 0),a([c()],Ve.prototype,"culture",void 0),a([c()],Ve.prototype,"description",void 0),a([c()],Ve.prototype,"email",void 0),a([c()],Ve.prototype,"favGroupId",void 0),a([c()],Ve.prototype,"fullName",void 0),a([c()],Ve.prototype,"id",void 0),a([c({type:Date})],Ve.prototype,"modified",void 0),a([c()],Ve.prototype,"orgId",void 0),a([c()],Ve.prototype,"portal",void 0),a([c()],Ve.prototype,"preferredView",void 0),a([c()],Ve.prototype,"privileges",void 0),a([c()],Ve.prototype,"region",void 0),a([c()],Ve.prototype,"role",void 0),a([c()],Ve.prototype,"roleId",void 0),a([c()],Ve.prototype,"sourceJSON",void 0),a([c()],Ve.prototype,"thumbnail",void 0),a([c({readOnly:!0})],Ve.prototype,"thumbnailUrl",null),a([c()],Ve.prototype,"units",void 0),a([c({readOnly:!0})],Ve.prototype,"userContentUrl",null),a([c({readOnly:!0})],Ve.prototype,"url",null),a([c()],Ve.prototype,"username",void 0),a([c()],Ve.prototype,"userLicenseTypeId",void 0),a([c()],Ve.prototype,"userType",void 0),Ve=G_=a([b("esri.portal.PortalUser")],Ve);var $i;let mp;const XI={PortalGroup:()=>Promise.resolve({default:ft}),PortalItem:()=>N(()=>Promise.resolve().then(()=>lF),void 0),PortalUser:()=>Promise.resolve({default:Ve})};var kn;let j=(kn=class extends ol(Xm){constructor(e){super(e),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.g3DTilesGalleryGroupQuery=null,this.g3dTilesEnabled=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=_e.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e}destroy(){eE.unregister(this),this.defaultBasemap=Ke(this.defaultBasemap),this.defaultDevBasemap=Ke(this.defaultDevBasemap),this.defaultVectorBasemap=Ke(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=He(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const r of e)_e.request.trustedServers.includes(r)||_e.request.trustedServers.push(r);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){const e=this.user?.orgId,r=!e||this.canSearchPublic;return this.id&&!r?` AND orgid:${this.id}`:null}get hasAPIKey(){return OR(this.restUrl)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get loaded(){return super.loaded}get restUrl(){let e=this.url;if(e){const r=e.indexOf("/sharing");e=r>0?e.slice(0,r):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,r=this.thumbnail;return e&&r?this._normalizeSSL(e+"/portals/self/resources/"+r):null}readUrlKey(e){return e&&e.toLowerCase()}readUser(e){let r=null;return e&&(r=Ve.fromJSON(e),r.portal=this),r}load(e){const r=N(async()=>{const{default:i}=await Promise.resolve().then(()=>lJ);return{default:i}},void 0).then(({default:i})=>{We(e),mp=i}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,e)).then(i=>{if(!this.hasAPIKey&&Se){const s=Se;this.credential=s.findCredential(this.restUrl),this.credential||this.authMode!==$i.AUTH_MODE_AUTO&&this.authMode!==$i.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=s.on("credential-create",hH(new WeakRef(this))),eE.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(r),Promise.resolve(this)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),r=(await N(async()=>{const{default:i}=await import("./ElevationLayer-HWWZveyi.js");return{default:i}},__vite__mapDeps([0,1,2,3,4,5]))).default;return e?e.map(i=>new r({id:i.id,url:i.url})):[]}async fetchBasemaps(e,r){const i=await this._fetchBasemaps(e,r);if(r?.include3d===!0&&this.use3dBasemaps!==!1){const s=await this._fetchBasemaps3D(e,r);i.unshift(...s)}return i}async fetchDefault3DBasemap(e){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const r=new gt;r.query=this.default3DBasemapQuery,r.disableExtraQuery=!0;const i=(await this.queryItems(r,e)).results.find(s=>s.type==="Web Scene");return i?new mp({portalItem:i}):null}fetchCategorySchema(e){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",e).then(r=>r.categorySchema):Cr(e)?Promise.reject(Fe()):Promise.resolve([])}async fetchClassificationSchema(e){return this.hasClassificationSchema?this.request(this.restUrl+"/portals/self/classification/classificationSchema",e).then(r=>r.classificationSchema):null}fetchFeaturedGroups(e){const r=this.featuredGroups,i=new gt({num:100,sortField:"title"});if(r?.length){const s=[];for(const n of r)s.push(`(title:"${n.title}" AND owner:${n.owner})`);return i.query=s.join(" OR "),this.queryGroups(i,e).then(n=>n.results)}return Cr(e)?Promise.reject(Fe()):Promise.resolve([])}fetchRegions(e){const r=this.user?.culture||this.culture||gi();return this.request(this.restUrl+"/portals/regions",{...e,query:{culture:r}})}fetchSettings(e){const r=this.user?.culture||this.culture||gi();return this.request(this.restUrl+"/portals/self/settings",{...e,query:{culture:r}})}static getDefault(){return cH(()=>new $i)}queryGroups(e,r){return this.queryPortal("/community/groups",e,"PortalGroup",r)}queryItems(e,r){return this.queryPortal("/search",e,"PortalItem",r)}queryUsers(e,r){return e.sortField||(e.sortField="username"),this.queryPortal("/community/users",e,"PortalUser",r)}fetchSelf(e=this.authMode,r=!1,i){const s=this.restUrl+"/portals/self",n={authMode:e,query:{culture:gi().toLowerCase()},withCredentials:!0,...i};return n.authMode==="auto"&&(n.authMode="no-prompt"),r&&(n.query.default=!0),this.request(s,n)}queryPortal(e,r,i,s){const n=ut(gt,r),o=l=>this.request(this.restUrl+e,{...n.toRequestOptions(this),...s}).then(u=>{const d=n.clone();return d.start=u.nextStart,new Tl({nextQueryParams:d,queryParams:n,total:u.total,results:$i._resultsToTypedArray(l,{portal:this},u,s)})}).then(u=>Promise.all(u.results.map(d=>typeof d.when=="function"?d.when():u)).then(()=>u,d=>(Mn(d),u)));return i&&XI[i]?XI[i]().then(({default:l})=>(We(s),o(l))):o()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new x("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")});if(this.authMode===$i.AUTH_MODE_ANONYMOUS||this.authMode===$i.AUTH_MODE_NO_PROMPT&&!Se)return Promise.reject(new x("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const e=r=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(r||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=r,this.fetchSelf("immediate"))):this.user&&this.credential===r?null:(this.credential=r,this.fetchSelf("immediate"))).then(i=>{i&&(this.sourceJSON=i,this.read(i))});return Se?Se.getCredential(this.restUrl,{prompt:this.authMode!==$i.AUTH_MODE_NO_PROMPT}).then(r=>e(r)):e(this.credential)}normalizeUrl(e){const r=this.credential?.token;return this._normalizeSSL(r?e+(e.includes("?")?"&":"?")+"token="+r:e)}requestToTypedArray(e,r,i){return this.request(e,r).then(s=>{const n=$i._resultsToTypedArray(i,{portal:this},s);return Promise.all(n.map(o=>typeof o.when=="function"?o.when():s)).then(()=>n,()=>n)})}request(e,r={}){const i={f:"json",...r.query},{authMode:s=this.authMode===$i.AUTH_MODE_ANONYMOUS||this.authMode===$i.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:n=null,cacheBust:o=!1,method:l="auto",responseType:u="json",signal:d}=r,p={authMode:s,body:n,cacheBust:o,method:l,query:i,responseType:u,timeout:0,signal:d};return r.withCredentials&&(p.withCredentials=!0),Ae(this._normalizeSSL(e),p).then(f=>f.data)}toJSON(){throw new x("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new $i({sourceJSON:e})}_getHelperService(e){const r=this.helperServices?.[e];if(!r)throw new x("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return r}async _fetchBasemaps(e,r){const i=new gt;i.query=e||(b_()?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0;const s=await this.queryGroups(i,r);if(!s.total)return[];const n=s.results[0];i.num=100,i.query='type:"Web Map" -type:"Web Application"',i.sortField=n.sortField||"name",i.sortOrder=n.sortOrder||"desc";const o=await n.queryItems(i,r);return o.total?o.results.filter(l=>l.type==="Web Map").map(l=>new mp({portalItem:l})):[]}async _fetchBasemaps3D(e,r){const i=e||this.basemapGalleryGroupQuery3D;if(!i)return[];if(b_())return[];const s=new gt({query:i,disableExtraQuery:!0}),n=await this.queryGroups(s,r);if(!n.total)return[];const o=n.results[0];s.num=100,s.query='type:"Web Scene"',s.sortField=o.sortField||"name",s.sortOrder=o.sortOrder||"desc";const l=await o.queryItems(s,r);return l.total?l.results.filter(u=>u.type==="Web Scene").map(u=>new mp({portalItem:u})):[]}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(e){if(e){const r=mp.fromJSON(e);return r.portalItem={portal:this},r}return null}static _resultsToTypedArray(e,r,i,s){let n;if(i){const o=s!=null?s.signal:null;n=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(e||r)&&(n=n.map(l=>{const u=Object.assign(e?e.fromJSON(l):l,r);return typeof u.load=="function"&&u.load(o),u}))}else n=[];return n}},$i=kn,kn.AUTH_MODE_ANONYMOUS="anonymous",kn.AUTH_MODE_AUTO="auto",kn.AUTH_MODE_IMMEDIATE="immediate",kn.AUTH_MODE_NO_PROMPT="no-prompt",kn);a([c()],j.prototype,"access",void 0),a([c()],j.prototype,"allSSL",void 0),a([c()],j.prototype,"authMode",void 0),a([c()],j.prototype,"authorizedCrossOriginDomains",void 0),a([V("authorizedCrossOriginDomains")],j.prototype,"readAuthorizedCrossOriginDomains",null),a([c()],j.prototype,"basemapGalleryGroupQuery",void 0),a([c({json:{name:"3DBasemapGalleryGroupQuery"}})],j.prototype,"basemapGalleryGroupQuery3D",void 0),a([c({json:{name:"g3DTilesGalleryGroupQuery"}})],j.prototype,"g3DTilesGalleryGroupQuery",void 0),a([c({json:{name:"g3dTilesEnabled"}})],j.prototype,"g3dTilesEnabled",void 0),a([c()],j.prototype,"bingKey",void 0),a([c()],j.prototype,"canListApps",void 0),a([c()],j.prototype,"canListData",void 0),a([c()],j.prototype,"canListPreProvisionedItems",void 0),a([c()],j.prototype,"canProvisionDirectPurchase",void 0),a([c()],j.prototype,"canSearchPublic",void 0),a([c()],j.prototype,"canShareBingPublic",void 0),a([c()],j.prototype,"canSharePublic",void 0),a([c()],j.prototype,"canSignInArcGIS",void 0),a([c()],j.prototype,"canSignInIDP",void 0),a([c()],j.prototype,"colorSetsGroupQuery",void 0),a([c()],j.prototype,"commentsEnabled",void 0),a([c({type:Date})],j.prototype,"created",void 0),a([c()],j.prototype,"credential",void 0),a([c()],j.prototype,"culture",void 0),a([c()],j.prototype,"currentVersion",void 0),a([c()],j.prototype,"customBaseUrl",void 0),a([c()],j.prototype,"default3DBasemapQuery",void 0),a([c()],j.prototype,"defaultBasemap",void 0),a([V("defaultBasemap")],j.prototype,"readDefaultBasemap",null),a([c()],j.prototype,"defaultDevBasemap",void 0),a([V("defaultDevBasemap")],j.prototype,"readDefaultDevBasemap",null),a([c({type:he})],j.prototype,"defaultExtent",void 0),a([c()],j.prototype,"defaultVectorBasemap",void 0),a([V("defaultVectorBasemap")],j.prototype,"readDefaultVectorBasemap",null),a([c()],j.prototype,"description",void 0),a([c()],j.prototype,"devBasemapGalleryGroupQuery",void 0),a([c()],j.prototype,"eueiEnabled",void 0),a([c({readOnly:!0})],j.prototype,"extraQuery",null),a([c()],j.prototype,"featuredGroups",void 0),a([c()],j.prototype,"featuredItemsGroupQuery",void 0),a([c()],j.prototype,"galleryTemplatesGroupQuery",void 0),a([c()],j.prototype,"layoutGroupQuery",void 0),a([c()],j.prototype,"livingAtlasGroupQuery",void 0),a([c({readOnly:!0})],j.prototype,"hasAPIKey",null),a([c()],j.prototype,"hasCategorySchema",void 0),a([c()],j.prototype,"hasClassificationSchema",void 0),a([c()],j.prototype,"helpBase",void 0),a([c()],j.prototype,"helperServices",void 0),a([c()],j.prototype,"helpMap",void 0),a([c()],j.prototype,"homePageFeaturedContent",void 0),a([c()],j.prototype,"homePageFeaturedContentCount",void 0),a([c()],j.prototype,"httpPort",void 0),a([c()],j.prototype,"httpsPort",void 0),a([c()],j.prototype,"id",void 0),a([c()],j.prototype,"ipCntryCode",void 0),a([c({readOnly:!0})],j.prototype,"isOrganization",null),a([c()],j.prototype,"isPortal",void 0),a([c()],j.prototype,"isReadOnly",void 0),a([c({readOnly:!0})],j.prototype,"itemPageUrl",null),a([c()],j.prototype,"layerTemplatesGroupQuery",void 0),a([c()],j.prototype,"maxTokenExpirationMinutes",void 0),a([c({type:Date})],j.prototype,"modified",void 0),a([c()],j.prototype,"name",void 0),a([c()],j.prototype,"portalHostname",void 0),a([c()],j.prototype,"portalMode",void 0),a([c()],j.prototype,"portalProperties",void 0),a([c()],j.prototype,"region",void 0),a([c()],j.prototype,"recycleBinEnabled",void 0),a([c({readOnly:!0})],j.prototype,"restUrl",null),a([c()],j.prototype,"rotatorPanels",void 0),a([c()],j.prototype,"showHomePageDescription",void 0),a([c()],j.prototype,"sourceJSON",void 0),a([c()],j.prototype,"staticImagesUrl",void 0),a([c({json:{name:"2DStylesGroupQuery"}})],j.prototype,"stylesGroupQuery2d",void 0),a([c({json:{name:"stylesGroupQuery"}})],j.prototype,"stylesGroupQuery3d",void 0),a([c()],j.prototype,"supportsHostedServices",void 0),a([c()],j.prototype,"symbolSetsGroupQuery",void 0),a([c()],j.prototype,"templatesGroupQuery",void 0),a([c()],j.prototype,"thumbnail",void 0),a([c({readOnly:!0})],j.prototype,"thumbnailUrl",null),a([c()],j.prototype,"units",void 0),a([c()],j.prototype,"url",void 0),a([c()],j.prototype,"urlKey",void 0),a([V("urlKey")],j.prototype,"readUrlKey",null),a([c()],j.prototype,"user",void 0),a([V("user")],j.prototype,"readUser",null),a([c()],j.prototype,"use3dBasemaps",void 0),a([c()],j.prototype,"useDefault3dBasemap",void 0),a([c()],j.prototype,"useStandardizedQuery",void 0),a([c()],j.prototype,"useVectorBasemaps",void 0),a([c()],j.prototype,"vectorBasemapGalleryGroupQuery",void 0),j=$i=a([b("esri.portal.Portal")],j);const eE=new FinalizationRegistry(t=>{t.remove()});function hH(t){const e=Se;return()=>{const r=t.deref();r&&e.findCredential(r.restUrl)&&r.signIn().catch(()=>{})}}let Kn=class extends X{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e?.portalItem&&e.path?{...e,path:tE(e.path,e.portalItem)}:e}set path(e){e!=null&&yi(e)?L.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return tE(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",r){const i=this.cdnUrl;if(i==null)throw new x("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(i,{responseType:e,query:{token:this.portalItem.apiKey,_ts:r?.cacheBust?Date.now():null},signal:r?.signal})}async update(e,r){const{addOrUpdateResources:i}=await N(()=>import("./resourceUtils-DiAnIw6M.js"),[]);return await i(this.portalItem,[{resource:this,content:e,compress:r?.compress,access:r?.access}],"update",r),this}hasPath(){return this.path!=null}};function tE(t,e){return t==null?t:(t=t.replace(/^\/+/,""),e!=null&&yi(t)&&(t=uT(t,e.itemUrl)),t?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}a([c()],Kn.prototype,"portalItem",void 0),a([c({type:String,value:null})],Kn.prototype,"path",null),a([Ce("path")],Kn.prototype,"_castPath",null),a([c({type:String,readOnly:!0})],Kn.prototype,"url",null),a([c({type:String,readOnly:!0})],Kn.prototype,"cdnUrl",null),a([c({type:String,readOnly:!0})],Kn.prototype,"itemRelativeUrl",null),Kn=a([b("esri.portal.PortalItemResource")],Kn);let ru=class extends X{constructor(e){super(e),this.created=null,this.rating=null}};a([c({type:Date})],ru.prototype,"created",void 0),a([c()],ru.prototype,"rating",void 0),ru=a([b("esri.portal.PortalRating")],ru);var Ml;const pH=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Knowledge Graph Layer","Map Service","Media Layer","Scene Service","Stream Service","Video Service","Vector Tile Service","WCS","WFS","WMS","WMTS"]),fH=new Set(["KML","GeoJson","CSV"]);let de=Ml=class extends ol(Xm){static from(t){return Hh(Ml,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let r=t;return t==="Feature Service"||t==="Feature Collection"?r=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?r=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?r="Scene Layer":t==="Video Service"?r="Video Layer":t==="Scene Package"?r="Scene Layer Package":t==="Stream Service"?r="Feature Layer":t==="Geoprocessing Service"?r=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geoenrichment Service"?r="GeoEnrichment Service":t==="Geocoding Service"?r="Locator":t==="Microsoft Powerpoint"?r="Microsoft PowerPoint":t==="GeoJson"?r="GeoJSON":t==="Globe Service"?r="Globe Layer":t==="Vector Tile Service"?r="Tile Layer":t==="netCDF"?r="NetCDF":t==="Map Service"?r=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t?.toLowerCase().includes("add in")?r=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?r="Big Data File Share":t==="Compact Tile Package"?r="Tile Package (tpkx)":t==="Raster function template"?r="Raster Function Template":t==="OGCFeatureServer"?r="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?r="Instant App":t==="Insights Page"?r="Insights Report":t==="Excalibur Imagery Project"?r="Excalibur Project":t==="3DTiles Service"?r="3D tiles layer":t==="3DTiles Package"&&(r="3D tiles package"),r}readExtent(t){return t&&t.length?new he(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type?.toLowerCase()||"",e=this.typeKeywords||[],r="esri/images/portal/",i="16";let s,n=!1,o=!1,l=!1,u=!1,d=!1,p=!1,f=!1,m=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(n=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(o=e.includes("Table"),l=e.includes("Route Layer"),u=e.includes("Markup"),d=e.includes("Spatiotemporal"),p=e.includes("UtilityNetwork"),s=d&&o?"spatiotemporaltable":o?"table":l?"routelayer":u?"markup":d?"spatiotemporal":p?"utilitynetwork":n?"featureshosted":"features"):t==="map service"||t==="wms"||t==="wmts"?(d=e.includes("Spatiotemporal"),f=e.includes("Relational"),s=d||f?"mapimages":n||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages"):s=t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":t==="3dtiles service"?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":e.includes("GaussianSplat")?"gaussiansplatlayer":"3dtileslayer":"layers"):t==="web map"||t==="cityengine web scene"?s="maps":t==="web scene"?s=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?s="instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?s="apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?s="mapsgray":t==="service definition"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?s="datafiles":t==="360 vr experience"?s="360vr":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?s="appsgray":t==="arcgis pro add in"||t==="arcgis pro configuration"?s="addindesktop":t==="pdf"?s="pdf":t==="microsoft word"?s="word":t==="microsoft excel"?s="excel":t==="microsoft powerpoint"?s="ppt":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?s="datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?s="toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?s="layersgray":t==="analysis model"?s="analysismodel":t==="scene package"?s="scenepackage":t==="3dtiles package"?s="3dtileslayerpackage":t==="3dtiles service"?s="3dtileslayer":t==="mobile scene package"?s="mobilescenepackage":t==="tile package"||t==="compact tile package"?s="tilepackage":t==="task file"?s="taskfile":t==="report template"?s="report-template":t==="statistical data collection"?s="statisticaldatacollection":t==="insights workbook"?s="workbook":t==="insights model"?s="insightsmodel":t==="insights page"?s="insightspage":t==="insights theme"?s="insightstheme":t==="hub initiative"?s="hubinitiative":t==="hub page"?s="hubpage":t==="hub site application"?s="hubsite":t==="hub event"?s="hubevent":t==="hub project"?s="hubproject":t==="relational database connection"?s="relationaldatabaseconnection":t==="big data file share"?s="datastorecollection":t==="image collection"?s="imagecollection":t==="desktop style"?s="desktopstyle":t==="style"?s=e.includes("Dictionary")?"dictionarystyle":"style":t==="dashboard"?s="dashboard":t==="raster function template"?s="rasterprocessingtemplate":t==="vector tile package"?s="vectortilepackage":t==="ortho mapping project"?s="orthomappingproject":t==="ortho mapping template"?s="orthomappingtemplate":t==="solution"?s="solutions":t==="geopackage"?s="geopackage":t==="deep learning package"?s="deeplearningpackage":t==="real time analytic"?s="realtimeanalytics":t==="reality mapping project"?s="realitymappingproject":t==="big data analytic"?s="bigdataanalytics":t==="feed"?s="feed":t==="excalibur imagery project"?s="excaliburimageryproject":t==="notebook"?s="notebook":t==="storymap"?s="storymap":t==="survey123 add in"?s="survey123addin":t==="mission"?s="mission":t==="mission report"?s="missionreport":t==="mission template"?s="missiontemplate":t==="quickcapture project"?s="quickcaptureproject":t==="pro report"?s="proreport":t==="pro report template"?s="proreporttemplate":t==="urban model"?s="urbanmodel":t==="urban project"?s="urbanproject":t==="web experience"?s="experiencebuilder":t==="web experience template"?s="webexperiencetemplate":t==="experience builder widget"?s="experiencebuilderwidget":t==="experience builder widget package"?s="experiencebuilderwidgetpackage":t==="workflow"?s="workflow":t==="kernel gateway connection"?s="kernelgatewayconnection":t==="insights script"?s="insightsscript":t==="hub initiative template"?s="hubinitiativetemplate":t==="storymap theme"?s="storymaptheme":t==="knowledge graph"?s="knowledgegraph":t==="knowledge graph layer"?s="knowledgegraphlayer":t==="knowledge studio project"?s="knowledgestudio":t==="native application"?s="nativeapp":t==="native application installer"?s="nativeappinstaller":t==="web link chart"?s="linkchart":t==="knowledge graph web investigation"?s="investigation":t==="ogcfeatureserver"?s="features":t==="pro presentation"?s="propresentation":t==="pro project"?s="proproject":t==="insights workbook package"?s="insightsworkbookpackage":t==="apache parquet"?s="apacheparquet":t==="notebook code snippet library"?s="notebookcodesnippets":t==="suitability model"?s="suitabilitymodel":t==="esri classifier definition"?s="classifierdefinition":t==="esri classification schema"?s="classificationschema":t==="insights data engineering workbook"?s="dataengineeringworkbook":t==="insights data engineering model"?s="dataengineeringmodel":t==="deep learning studio project"?s="deeplearningproject":t==="discussion"?s="discussion":t==="allsource project"?s="allsourceproject":t==="api key"?s="apikey":t==="data pipeline"?s="datapipelines":t==="group layer"?(m=e.includes("Map"),s=m?"layergroup2d":"layergroup"):s=t==="media layer"?"onlinemedialayer":t==="form"?e.includes("Survey123")?"survey":"datafilesgray":t==="csv"?"csv":t==="image"?"image":t==="xr experience"?"xrexperience":"maps",s?nt(r+s+i+".png"):null}get isLayer(){return this.type!=null&&pH.has(this.type)}get itemCdnUrl(){return yT(this.itemUrl)}get itemPageUrl(){const t=this.portal?.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){const t=this.portal?.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get loaded(){return super.loaded}get thumbnailUrl(){const t=this.itemUrl,e=this.thumbnail;return t&&e?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`)??null:null}get userItemUrl(){const t=this.portal?.restUrl;if(!t)return null;const e=this.owner||this.portal?.user?.id;return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=j.getDefault()),r=e.load(t).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{}).then(i=>{this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(r),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}},r=t instanceof ru?t.rating:t;return r==null||isNaN(r)||typeof t!="number"||(e.query.rating=r),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new ru({rating:r,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:E(this.applicationProxies),avgRating:this.avgRating,categories:E(this.categories),classification:E(this.classification),created:E(this.created),culture:this.culture,description:this.description,extent:E(this.extent),groupCategories:E(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:E(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:E(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:E(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:E(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new Ml({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){const t=this.toJSON();for(const e of["tags","typeKeywords","categories"])t[e]=t[e]?.join(", ");for(const e of["extent","classification"]){const r=t[e];r&&(t[e]=JSON.stringify(r))}return t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new ru(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},Ml)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.applicationProxies&&!Object.hasOwn(t,"appProxies")&&(this.applicationProxies=null),this.sourceJSON=t,this.read(t),this))}update(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t?.data,r={method:"post"};r.query=this.createPostQuery();for(const i in r.query)r.query[i]===null&&(r.query[i]="");return r.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?r.query.text=e:typeof e=="object"&&(r.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,r).then(()=>this.reload())}):Promise.reject(new x("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new x("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:r}=this;await e.signIn();const{copyResources:i,folder:s,tags:n,title:o}=t||{},l={method:"post",query:{copyPrivateResources:i==="all",folder:typeof s=="string"?s:s?.id,includeResources:!!i,tags:n?.join(","),title:o}},{itemId:u}=await e.request(`${r}/copy`,l);return new Ml({id:u,portal:e})}updateThumbnail(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t.thumbnail,r=t.filename,i={method:"post"};if(typeof e=="string")zu(e)?i.query={data:e}:i.query={url:as(e)},r!=null&&(i.query.filename=r);else{const s=new FormData;r!=null?s.append("file",e,r):s.append("file",e),i.body=s}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,i).then(()=>this.reload())}):Promise.reject(new x("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:r}=await N(()=>import("./resourceUtils-DiAnIw6M.js"),[]);return r(this,t,e)}async addResource(t,e,r){const{addOrUpdateResources:i}=await N(()=>import("./resourceUtils-DiAnIw6M.js"),[]);return t.portalItem=this,await i(this,[{resource:t,content:e,compress:r?.compress,access:r?.access}],"add",r),t}async removeResource(t,e){const{removeResource:r}=await N(()=>import("./resourceUtils-DiAnIw6M.js"),[]);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new x("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return r(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await N(()=>import("./resourceUtils-DiAnIw6M.js"),[]);return e(this,t)}resourceFromPath(t){return new Kn({portalItem:this,path:t})}toJSON(){const t=this.extent,e={accessInformation:this.accessInformation,categories:E(this.categories),classification:E(this.classification),created:this.created?.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:E(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:E(this.typeKeywords),url:this.url};return hU(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new Ml({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};a([c({type:["private","shared","org","public"]})],de.prototype,"access",void 0),a([c()],de.prototype,"accessInformation",void 0),a([c({type:String})],de.prototype,"apiKey",void 0),a([c({json:{read:{source:"appProxies"}}})],de.prototype,"applicationProxies",void 0),a([c()],de.prototype,"avgRating",void 0),a([c()],de.prototype,"categories",void 0),a([c()],de.prototype,"classification",void 0),a([c({type:Date})],de.prototype,"created",void 0),a([c()],de.prototype,"culture",void 0),a([c()],de.prototype,"description",void 0),a([c({readOnly:!0})],de.prototype,"displayName",null),a([c({type:he})],de.prototype,"extent",void 0),a([V("extent")],de.prototype,"readExtent",null),a([c()],de.prototype,"groupCategories",void 0),a([c({readOnly:!0})],de.prototype,"iconUrl",null),a([c()],de.prototype,"id",void 0),a([c({readOnly:!0})],de.prototype,"isLayer",null),a([c({type:Boolean,readOnly:!0})],de.prototype,"isOrgItem",void 0),a([c()],de.prototype,"itemControl",void 0),a([c({readOnly:!0})],de.prototype,"itemPageUrl",null),a([c({readOnly:!0})],de.prototype,"itemUrl",null),a([c()],de.prototype,"licenseInfo",void 0),a([c({type:Date})],de.prototype,"modified",void 0),a([c()],de.prototype,"name",void 0),a([c()],de.prototype,"numComments",void 0),a([c()],de.prototype,"numRatings",void 0),a([c()],de.prototype,"numViews",void 0),a([c()],de.prototype,"owner",void 0),a([c()],de.prototype,"ownerFolder",void 0),a([c({type:j})],de.prototype,"portal",void 0),a([c()],de.prototype,"screenshots",void 0),a([c()],de.prototype,"size",void 0),a([c()],de.prototype,"snippet",void 0),a([c()],de.prototype,"sourceJSON",void 0),a([c({type:String})],de.prototype,"sourceUrl",void 0),a([c({type:String})],de.prototype,"spatialReference",void 0),a([c()],de.prototype,"tags",void 0),a([c()],de.prototype,"thumbnail",void 0),a([c({readOnly:!0})],de.prototype,"thumbnailUrl",null),a([c()],de.prototype,"title",void 0),a([c()],de.prototype,"type",void 0),a([c()],de.prototype,"typeKeywords",void 0),a([c({type:String,json:{read(t,e){if(fH.has(e.type)){const r=this.portal?.restUrl;t||=r&&this.id?`${r}/content/items/${this.id}/data`:null}return t}}})],de.prototype,"url",void 0),a([c({readOnly:!0})],de.prototype,"userItemUrl",null),de=Ml=a([b("esri.portal.PortalItem")],de);const lF=Object.freeze(Object.defineProperty({__proto__:null,get default(){return de}},Symbol.toStringTag,{value:"Module"})),uF={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,nn:"no",pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function mH(t){return t in uF}function rE(t){if(mH(t)){const e=uF[t];return e===!0?t:e}return null}const zp=[],$d=new Map;function iE(t){for(const e of $d.keys())hF(t.pattern,e)&&$d.delete(e)}function yH(t){return zp.includes(t)||(iE(t),zp.unshift(t)),Te(()=>{const e=zp.indexOf(t);e>-1&&(zp.splice(e,1),iE(t))})}async function cF(t){const e=gi();$d.has(t)||$d.set(t,gH(t,e));const r=$d.get(t);return r&&await vH.add(r),r}function dF(t){const e=UT(t);return e?rE(t)??rE(e):null}async function gH(t,e){const r=[];for(const i of zp)if(hF(i.pattern,t))try{return await i.fetchMessageBundle(t,e)}catch(s){r.push(s)}throw r.length?new x("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:r}):new x("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function hF(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}qT(()=>{$d.clear()});const vH=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=wi())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function wH(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,r=await cF("esri/t9n/basemaps");return r[t]||r[e]}const B_={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return nt("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return nt("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return nt("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-hillshade",url:"https://services.arcgisonline.com/ArcGIS/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1},{id:"terrain-base",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/33064a20de0c48d2bb61efa8faca93a8/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Terrain Base"},{id:"terrain-reference",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/14fbc125ccc9488888b014db09f35f67/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Reference Reference",isReference:!0}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return nt("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/94329802cbfa44a18f423e6f1a0b875c/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return nt("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return nt("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return nt("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return nt("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return nt("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return nt("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return nt("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return nt("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return nt("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return nt("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return nt("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return nt("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Buildings_v1/SceneServer",itemId:"cd33b09dde0a419c986ca1a78a5fc06d",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return nt("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]}},rn="system",Ka="unknown",Qa="UTC",bH=Intl.DateTimeFormat().resolvedOptions().timeZone,sE=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class Bu extends Error{}class _H extends Bu{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class SH extends Bu{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class $H extends Bu{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class cd extends Bu{}class pF extends Bu{constructor(e){super(`Invalid unit ${e}`)}}class $r extends Bu{}class ea extends Bu{constructor(){super("Zone is an abstract class")}}const J="numeric",sn="short",Vi="long",Sv={year:J,month:J,day:J},fF={year:J,month:sn,day:J},xH={year:J,month:sn,day:J,weekday:sn},mF={year:J,month:Vi,day:J},yF={year:J,month:Vi,day:J,weekday:Vi},gF={hour:J,minute:J},vF={hour:J,minute:J,second:J},wF={hour:J,minute:J,second:J,timeZoneName:sn},bF={hour:J,minute:J,second:J,timeZoneName:Vi},_F={hour:J,minute:J,hourCycle:"h23"},SF={hour:J,minute:J,second:J,hourCycle:"h23"},$F={hour:J,minute:J,second:J,hourCycle:"h23",timeZoneName:sn},xF={hour:J,minute:J,second:J,hourCycle:"h23",timeZoneName:Vi},TF={year:J,month:J,day:J,hour:J,minute:J},MF={year:J,month:J,day:J,hour:J,minute:J,second:J},IF={year:J,month:sn,day:J,hour:J,minute:J},EF={year:J,month:sn,day:J,hour:J,minute:J,second:J},TH={year:J,month:sn,day:J,weekday:sn,hour:J,minute:J},OF={year:J,month:Vi,day:J,hour:J,minute:J,timeZoneName:sn},kF={year:J,month:Vi,day:J,hour:J,minute:J,second:J,timeZoneName:sn},CF={year:J,month:Vi,day:J,weekday:Vi,hour:J,minute:J,timeZoneName:Vi},PF={year:J,month:Vi,day:J,weekday:Vi,hour:J,minute:J,second:J,timeZoneName:Vi};class Hu{get type(){throw new ea}get name(){throw new ea}get ianaName(){return this.name}get isUniversal(){throw new ea}offsetName(e,r){throw new ea}formatOffset(e,r){throw new ea}offset(e){throw new ea}equals(e){throw new ea}get isValid(){throw new ea}}let Bb=null;class Ew extends Hu{static get instance(){return Bb===null&&(Bb=new Ew),Bb}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:r,locale:i}){return qF(e,r,i)}formatOffset(e,r){return Nf(this.offset(e),r)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}const H_=new Map;function MH(t){let e=H_.get(t);return e===void 0&&(e=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),H_.set(t,e)),e}const IH={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function EH(t,e){const r=t.format(e).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(r),[,s,n,o,l,u,d,p]=i;return[o,s,n,l,u,d,p]}function OH(t,e){const r=t.formatToParts(e),i=[];for(let s=0;s<r.length;s++){const{type:n,value:o}=r[s],l=IH[n];n==="era"?i[l]=o:me(l)||(i[l]=parseInt(o,10))}return i}const Hb=new Map;class bi extends Hu{static create(e){let r=Hb.get(e);return r===void 0&&Hb.set(e,r=new bi(e)),r}static resetCache(){Hb.clear(),H_.clear()}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=bi.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:r,locale:i}){return qF(e,r,i,this.name)}formatOffset(e,r){return Nf(this.offset(e),r)}offset(e){if(!this.valid)return NaN;const r=new Date(e);if(isNaN(r))return NaN;const i=MH(this.name);let[s,n,o,l,u,d,p]=i.formatToParts?OH(i,r):EH(i,r);l==="BC"&&(s=-Math.abs(s)+1);const m=kw({year:s,month:n,day:o,hour:u===24?0:u,minute:d,second:p,millisecond:0});let y=+r;const g=y%1e3;return y-=g>=0?g:1e3+g,(m-y)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let nE={};function kH(t,e={}){const r=JSON.stringify([t,e]);let i=nE[r];return i||(i=new Intl.ListFormat(t,e),nE[r]=i),i}const W_=new Map;function Z_(t,e={}){const r=JSON.stringify([t,e]);let i=W_.get(r);return i===void 0&&(i=new Intl.DateTimeFormat(t,e),W_.set(r,i)),i}const J_=new Map;function CH(t,e={}){const r=JSON.stringify([t,e]);let i=J_.get(r);return i===void 0&&(i=new Intl.NumberFormat(t,e),J_.set(r,i)),i}const Y_=new Map;function PH(t,e={}){const{base:r,...i}=e,s=JSON.stringify([t,i]);let n=Y_.get(s);return n===void 0&&(n=new Intl.RelativeTimeFormat(t,e),Y_.set(s,n)),n}let Up=null;function AH(){return Up||(Up=new Intl.DateTimeFormat().resolvedOptions().locale,Up)}const K_=new Map;function AF(t){let e=K_.get(t);return e===void 0&&(e=new Intl.DateTimeFormat(t).resolvedOptions(),K_.set(t,e)),e}const Q_=new Map;function RH(t){let e=Q_.get(t);if(!e){const r=new Intl.Locale(t);e="getWeekInfo"in r?r.getWeekInfo():r.weekInfo,"minimalDays"in e||(e={...RF,...e}),Q_.set(t,e)}return e}function LH(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const r=t.indexOf("-u-");if(r===-1)return[t];{let i,s;try{i=Z_(t).resolvedOptions(),s=t}catch{const u=t.substring(0,r);i=Z_(u).resolvedOptions(),s=u}const{numberingSystem:n,calendar:o}=i;return[s,n,o]}}function FH(t,e,r){return(r||e)&&(t.includes("-u-")||(t+="-u"),r&&(t+=`-ca-${r}`),e&&(t+=`-nu-${e}`)),t}function NH(t){const e=[];for(let r=1;r<=12;r++){const i=Y.utc(2009,r,1);e.push(t(i))}return e}function DH(t){const e=[];for(let r=1;r<=7;r++){const i=Y.utc(2016,11,13+r);e.push(t(i))}return e}function Cy(t,e,r,i){const s=t.listingMode();return s==="error"?null:s==="en"?r(e):i(e)}function jH(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||AF(t.locale).numberingSystem==="latn"}class VH{constructor(e,r,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;const{padTo:s,floor:n,...o}=i;if(!r||Object.keys(o).length>0){const l={useGrouping:!1,...i};i.padTo>0&&(l.minimumIntegerDigits=i.padTo),this.inf=CH(e,l)}}format(e){if(this.inf){const r=this.floor?Math.floor(e):e;return this.inf.format(r)}else{const r=this.floor?Math.floor(e):ZT(e,3);return Pt(r,this.padTo)}}}class zH{constructor(e,r,i){this.opts=i,this.originalZone=void 0;let s;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),l=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&bi.create(l).valid?(s=l,this.dt=e):(s="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,s=e.zone.name):(s="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const n={...this.opts};n.timeZone=n.timeZone||s,this.dtf=Z_(r,n)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(r=>{if(r.type==="timeZoneName"){const i=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...r,value:i}}else return r}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class UH{constructor(e,r,i){this.opts={style:"long",...i},!r&&zF()&&(this.rtf=PH(e,i))}format(e,r){return this.rtf?this.rtf.format(e,r):cW(r,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,r){return this.rtf?this.rtf.formatToParts(e,r):[]}}const RF={firstDay:1,minimalDays:4,weekend:[6,7]};class ze{static fromOpts(e){return ze.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,r,i,s,n=!1){const o=e||vt.defaultLocale,l=o||(n?"en-US":AH()),u=r||vt.defaultNumberingSystem,d=i||vt.defaultOutputCalendar,p=eS(s)||vt.defaultWeekSettings;return new ze(l,u,d,p,o)}static resetCache(){Up=null,W_.clear(),J_.clear(),Y_.clear(),K_.clear(),Q_.clear()}static fromObject({locale:e,numberingSystem:r,outputCalendar:i,weekSettings:s}={}){return ze.create(e,r,i,s)}constructor(e,r,i,s,n){const[o,l,u]=LH(e);this.locale=o,this.numberingSystem=r||l||null,this.outputCalendar=i||u||null,this.weekSettings=s,this.intl=FH(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=jH(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),r=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&r?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:ze.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,eS(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,r=!1){return Cy(this,e,HF,()=>{const i=this.intl==="ja"||this.intl.startsWith("ja-");r&=!i;const s=r?{month:e,day:"numeric"}:{month:e},n=r?"format":"standalone";if(!this.monthsCache[n][e]){const o=i?l=>this.dtFormatter(l,s).format():l=>this.extract(l,s,"month");this.monthsCache[n][e]=NH(o)}return this.monthsCache[n][e]})}weekdays(e,r=!1){return Cy(this,e,JF,()=>{const i=r?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},s=r?"format":"standalone";return this.weekdaysCache[s][e]||(this.weekdaysCache[s][e]=DH(n=>this.extract(n,i,"weekday"))),this.weekdaysCache[s][e]})}meridiems(){return Cy(this,void 0,()=>YF,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Y.utc(2016,11,13,9),Y.utc(2016,11,13,19)].map(r=>this.extract(r,e,"dayperiod"))}return this.meridiemCache})}eras(e){return Cy(this,e,KF,()=>{const r={era:e};return this.eraCache[e]||(this.eraCache[e]=[Y.utc(-40,1,1),Y.utc(2017,1,1)].map(i=>this.extract(i,r,"era"))),this.eraCache[e]})}extract(e,r,i){const s=this.dtFormatter(e,r),n=s.formatToParts(),o=n.find(l=>l.type.toLowerCase()===i);return o?o.value:null}numberFormatter(e={}){return new VH(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,r={}){return new zH(e,this.intl,r)}relFormatter(e={}){return new UH(this.intl,this.isEnglish(),e)}listFormatter(e={}){return kH(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||AF(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:UF()?RH(this.locale):RF}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let Wb=null;class Rt extends Hu{static get utcInstance(){return Wb===null&&(Wb=new Rt(0)),Wb}static instance(e){return e===0?Rt.utcInstance:new Rt(e)}static parseSpecifier(e){if(e){const r=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r)return new Rt(Cw(r[1],r[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Nf(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Nf(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,r){return Nf(this.fixed,r)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class qH extends Hu{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Ma(t,e){if(me(t)||t===null)return e;if(t instanceof Hu)return t;if(JH(t)){const r=t.toLowerCase();return r==="default"?e:r==="local"||r==="system"?Ew.instance:r==="utc"||r==="gmt"?Rt.utcInstance:Rt.parseSpecifier(r)||bi.create(t)}else return Ua(t)?Rt.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new qH(t)}const GT={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},oE={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},GH=GT.hanidec.replace(/[\[|\]]/g,"").split("");function BH(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);if(t[r].search(GT.hanidec)!==-1)e+=GH.indexOf(t[r]);else for(const s in oE){const[n,o]=oE[s];i>=n&&i<=o&&(e+=i-n)}}return parseInt(e,10)}else return e}const X_=new Map;function HH(){X_.clear()}function Ms({numberingSystem:t},e=""){const r=t||"latn";let i=X_.get(r);i===void 0&&(i=new Map,X_.set(r,i));let s=i.get(e);return s===void 0&&(s=new RegExp(`${GT[r]}${e}`),i.set(e,s)),s}let aE=()=>Date.now(),lE="system",uE=null,cE=null,dE=null,hE=60,pE,fE=null;class vt{static get now(){return aE}static set now(e){aE=e}static set defaultZone(e){lE=e}static get defaultZone(){return Ma(lE,Ew.instance)}static get defaultLocale(){return uE}static set defaultLocale(e){uE=e}static get defaultNumberingSystem(){return cE}static set defaultNumberingSystem(e){cE=e}static get defaultOutputCalendar(){return dE}static set defaultOutputCalendar(e){dE=e}static get defaultWeekSettings(){return fE}static set defaultWeekSettings(e){fE=eS(e)}static get twoDigitCutoffYear(){return hE}static set twoDigitCutoffYear(e){hE=e%100}static get throwOnInvalid(){return pE}static set throwOnInvalid(e){pE=e}static resetCaches(){ze.resetCache(),bi.resetCache(),Y.resetCache(),HH()}}class Ks{constructor(e,r){this.reason=e,this.explanation=r}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const LF=[0,31,59,90,120,151,181,212,243,273,304,334],FF=[0,31,60,91,121,152,182,213,244,274,305,335];function us(t,e){return new Ks("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function BT(t,e,r){const i=new Date(Date.UTC(t,e-1,r));t<100&&t>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);const s=i.getUTCDay();return s===0?7:s}function NF(t,e,r){return r+(ry(t)?FF:LF)[e-1]}function DF(t,e){const r=ry(t)?FF:LF,i=r.findIndex(n=>n<e),s=e-r[i];return{month:i+1,day:s}}function HT(t,e){return(t-e+7)%7+1}function $v(t,e=4,r=1){const{year:i,month:s,day:n}=t,o=NF(i,s,n),l=HT(BT(i,s,n),r);let u=Math.floor((o-l+14-e)/7),d;return u<1?(d=i-1,u=bm(d,e,r)):u>bm(i,e,r)?(d=i+1,u=1):d=i,{weekYear:d,weekNumber:u,weekday:l,...Pw(t)}}function mE(t,e=4,r=1){const{weekYear:i,weekNumber:s,weekday:n}=t,o=HT(BT(i,1,e),r),l=xd(i);let u=s*7+n-o-7+e,d;u<1?(d=i-1,u+=xd(d)):u>l?(d=i+1,u-=xd(i)):d=i;const{month:p,day:f}=DF(d,u);return{year:d,month:p,day:f,...Pw(t)}}function Zb(t){const{year:e,month:r,day:i}=t,s=NF(e,r,i);return{year:e,ordinal:s,...Pw(t)}}function yE(t){const{year:e,ordinal:r}=t,{month:i,day:s}=DF(e,r);return{year:e,month:i,day:s,...Pw(t)}}function gE(t,e){if(!me(t.localWeekday)||!me(t.localWeekNumber)||!me(t.localWeekYear)){if(!me(t.weekday)||!me(t.weekNumber)||!me(t.weekYear))throw new cd("Cannot mix locale-based week fields with ISO-based week fields");return me(t.localWeekday)||(t.weekday=t.localWeekday),me(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),me(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function WH(t,e=4,r=1){const i=Ow(t.weekYear),s=cs(t.weekNumber,1,bm(t.weekYear,e,r)),n=cs(t.weekday,1,7);return i?s?n?!1:us("weekday",t.weekday):us("week",t.weekNumber):us("weekYear",t.weekYear)}function ZH(t){const e=Ow(t.year),r=cs(t.ordinal,1,xd(t.year));return e?r?!1:us("ordinal",t.ordinal):us("year",t.year)}function jF(t){const e=Ow(t.year),r=cs(t.month,1,12),i=cs(t.day,1,xv(t.year,t.month));return e?r?i?!1:us("day",t.day):us("month",t.month):us("year",t.year)}function VF(t){const{hour:e,minute:r,second:i,millisecond:s}=t,n=cs(e,0,23)||e===24&&r===0&&i===0&&s===0,o=cs(r,0,59),l=cs(i,0,59),u=cs(s,0,999);return n?o?l?u?!1:us("millisecond",s):us("second",i):us("minute",r):us("hour",e)}function me(t){return typeof t>"u"}function Ua(t){return typeof t=="number"}function Ow(t){return typeof t=="number"&&t%1===0}function JH(t){return typeof t=="string"}function YH(t){return Object.prototype.toString.call(t)==="[object Date]"}function zF(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function UF(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function KH(t){return Array.isArray(t)?t:[t]}function vE(t,e,r){if(t.length!==0)return t.reduce((i,s)=>{const n=[e(s),s];return i&&r(i[0],n[0])===i[0]?i:n},null)[1]}function QH(t,e){return e.reduce((r,i)=>(r[i]=t[i],r),{})}function Sh(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function eS(t){if(t==null)return null;if(typeof t!="object")throw new $r("Week settings must be an object");if(!cs(t.firstDay,1,7)||!cs(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!cs(e,1,7)))throw new $r("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function cs(t,e,r){return Ow(t)&&t>=e&&t<=r}function XH(t,e){return t-e*Math.floor(t/e)}function Pt(t,e=2){const r=t<0;let i;return r?i="-"+(""+-t).padStart(e,"0"):i=(""+t).padStart(e,"0"),i}function va(t){if(!(me(t)||t===null||t===""))return parseInt(t,10)}function pl(t){if(!(me(t)||t===null||t===""))return parseFloat(t)}function WT(t){if(!(me(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function ZT(t,e,r="round"){const i=10**e;switch(r){case"expand":return t>0?Math.ceil(t*i)/i:Math.floor(t*i)/i;case"trunc":return Math.trunc(t*i)/i;case"round":return Math.round(t*i)/i;case"floor":return Math.floor(t*i)/i;case"ceil":return Math.ceil(t*i)/i;default:throw new RangeError(`Value rounding ${r} is out of range`)}}function ry(t){return t%4===0&&(t%100!==0||t%400===0)}function xd(t){return ry(t)?366:365}function xv(t,e){const r=XH(e-1,12)+1,i=t+(e-r)/12;return r===2?ry(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][r-1]}function kw(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function wE(t,e,r){return-HT(BT(t,1,e),r)+e-1}function bm(t,e=4,r=1){const i=wE(t,e,r),s=wE(t+1,e,r);return(xd(t)-i+s)/7}function tS(t){return t>99?t:t>vt.twoDigitCutoffYear?1900+t:2e3+t}function qF(t,e,r,i=null){const s=new Date(t),n={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(n.timeZone=i);const o={timeZoneName:e,...n},l=new Intl.DateTimeFormat(r,o).formatToParts(s).find(u=>u.type.toLowerCase()==="timezonename");return l?l.value:null}function Cw(t,e){let r=parseInt(t,10);Number.isNaN(r)&&(r=0);const i=parseInt(e,10)||0,s=r<0||Object.is(r,-0)?-i:i;return r*60+s}function GF(t){const e=Number(t);if(typeof t=="boolean"||t===""||!Number.isFinite(e))throw new $r(`Invalid unit value ${t}`);return e}function Tv(t,e){const r={};for(const i in t)if(Sh(t,i)){const s=t[i];if(s==null)continue;r[e(i)]=GF(s)}return r}function Nf(t,e){const r=Math.trunc(Math.abs(t/60)),i=Math.trunc(Math.abs(t%60)),s=t>=0?"+":"-";switch(e){case"short":return`${s}${Pt(r,2)}:${Pt(i,2)}`;case"narrow":return`${s}${r}${i>0?`:${i}`:""}`;case"techie":return`${s}${Pt(r,2)}${Pt(i,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function Pw(t){return QH(t,["hour","minute","second","millisecond"])}const eW=["January","February","March","April","May","June","July","August","September","October","November","December"],BF=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],tW=["J","F","M","A","M","J","J","A","S","O","N","D"];function HF(t){switch(t){case"narrow":return[...tW];case"short":return[...BF];case"long":return[...eW];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const WF=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],ZF=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],rW=["M","T","W","T","F","S","S"];function JF(t){switch(t){case"narrow":return[...rW];case"short":return[...ZF];case"long":return[...WF];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const YF=["AM","PM"],iW=["Before Christ","Anno Domini"],sW=["BC","AD"],nW=["B","A"];function KF(t){switch(t){case"narrow":return[...nW];case"short":return[...sW];case"long":return[...iW];default:return null}}function oW(t){return YF[t.hour<12?0:1]}function aW(t,e){return JF(e)[t.weekday-1]}function lW(t,e){return HF(e)[t.month-1]}function uW(t,e){return KF(e)[t.year<0?0:1]}function cW(t,e,r="always",i=!1){const s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},n=["hours","minutes","seconds"].indexOf(t)===-1;if(r==="auto"&&n){const f=t==="days";switch(e){case 1:return f?"tomorrow":`next ${s[t][0]}`;case-1:return f?"yesterday":`last ${s[t][0]}`;case 0:return f?"today":`this ${s[t][0]}`}}const o=Object.is(e,-0)||e<0,l=Math.abs(e),u=l===1,d=s[t],p=i?u?d[1]:d[2]||d[1]:u?s[t][0]:t;return o?`${l} ${p} ago`:`in ${l} ${p}`}function bE(t,e){let r="";for(const i of t)i.literal?r+=i.val:r+=e(i.val);return r}const dW={D:Sv,DD:fF,DDD:mF,DDDD:yF,t:gF,tt:vF,ttt:wF,tttt:bF,T:_F,TT:SF,TTT:$F,TTTT:xF,f:TF,ff:IF,fff:OF,ffff:CF,F:MF,FF:EF,FFF:kF,FFFF:PF};class Or{static create(e,r={}){return new Or(e,r)}static parseFormat(e){let r=null,i="",s=!1;const n=[];for(let o=0;o<e.length;o++){const l=e.charAt(o);l==="'"?((i.length>0||s)&&n.push({literal:s||/^\s+$/.test(i),val:i===""?"'":i}),r=null,i="",s=!s):s||l===r?i+=l:(i.length>0&&n.push({literal:/^\s+$/.test(i),val:i}),i=l,r=l)}return i.length>0&&n.push({literal:s||/^\s+$/.test(i),val:i}),n}static macroTokenToFormatOpts(e){return dW[e]}constructor(e,r){this.opts=r,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,r){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...r}).format()}dtFormatter(e,r={}){return this.loc.dtFormatter(e,{...this.opts,...r})}formatDateTime(e,r){return this.dtFormatter(e,r).format()}formatDateTimeParts(e,r){return this.dtFormatter(e,r).formatToParts()}formatInterval(e,r){return this.dtFormatter(e.start,r).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,r){return this.dtFormatter(e,r).resolvedOptions()}num(e,r=0,i=void 0){if(this.opts.forceSimple)return Pt(e,r);const s={...this.opts};return r>0&&(s.padTo=r),i&&(s.signDisplay=i),this.loc.numberFormatter(s).format(e)}formatDateTimeFromString(e,r){const i=this.loc.listingMode()==="en",s=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",n=(y,g)=>this.loc.extract(e,y,g),o=y=>e.isOffsetFixed&&e.offset===0&&y.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,y.format):"",l=()=>i?oW(e):n({hour:"numeric",hourCycle:"h12"},"dayperiod"),u=(y,g)=>i?lW(e,y):n(g?{month:y}:{month:y,day:"numeric"},"month"),d=(y,g)=>i?aW(e,y):n(g?{weekday:y}:{weekday:y,month:"long",day:"numeric"},"weekday"),p=y=>{const g=Or.macroTokenToFormatOpts(y);return g?this.formatWithSystemDefault(e,g):y},f=y=>i?uW(e,y):n({era:y},"era"),m=y=>{switch(y){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return l();case"d":return s?n({day:"numeric"},"day"):this.num(e.day);case"dd":return s?n({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return d("short",!0);case"cccc":return d("long",!0);case"ccccc":return d("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return d("short",!1);case"EEEE":return d("long",!1);case"EEEEE":return d("narrow",!1);case"L":return s?n({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return s?n({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return u("short",!0);case"LLLL":return u("long",!0);case"LLLLL":return u("narrow",!0);case"M":return s?n({month:"numeric"},"month"):this.num(e.month);case"MM":return s?n({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return u("short",!1);case"MMMM":return u("long",!1);case"MMMMM":return u("narrow",!1);case"y":return s?n({year:"numeric"},"year"):this.num(e.year);case"yy":return s?n({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return s?n({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return s?n({year:"numeric"},"year"):this.num(e.year,6);case"G":return f("short");case"GG":return f("long");case"GGGGG":return f("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return p(y)}};return bE(Or.parseFormat(r),m)}formatDurationFromString(e,r){const i=this.opts.signMode==="negativeLargestOnly"?-1:1,s=p=>{switch(p[0]){case"S":return"milliseconds";case"s":return"seconds";case"m":return"minutes";case"h":return"hours";case"d":return"days";case"w":return"weeks";case"M":return"months";case"y":return"years";default:return null}},n=(p,f)=>m=>{const y=s(m);if(y){const g=f.isNegativeDuration&&y!==f.largestUnit?i:1;let v;return this.opts.signMode==="negativeLargestOnly"&&y!==f.largestUnit?v="never":this.opts.signMode==="all"?v="always":v="auto",this.num(p.get(y)*g,m.length,v)}else return m},o=Or.parseFormat(r),l=o.reduce((p,{literal:f,val:m})=>f?p:p.concat(m),[]),u=e.shiftTo(...l.map(s).filter(p=>p)),d={isNegativeDuration:u<0,largestUnit:Object.keys(u.values)[0]};return bE(o,n(u,d))}}const QF=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Yh(...t){const e=t.reduce((r,i)=>r+i.source,"");return RegExp(`^${e}$`)}function Kh(...t){return e=>t.reduce(([r,i,s],n)=>{const[o,l,u]=n(e,s);return[{...r,...o},l||i,u]},[{},null,1]).slice(0,2)}function Qh(t,...e){if(t==null)return[null,null];for(const[r,i]of e){const s=r.exec(t);if(s)return i(s)}return[null,null]}function XF(...t){return(e,r)=>{const i={};let s;for(s=0;s<t.length;s++)i[t[s]]=va(e[r+s]);return[i,null,r+s]}}const e5=/(?:([Zz])|([+-]\d\d)(?::?(\d\d))?)/,hW=`(?:${e5.source}?(?:\\[(${QF.source})\\])?)?`,JT=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,t5=RegExp(`${JT.source}${hW}`),YT=RegExp(`(?:[Tt]${t5.source})?`),pW=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,fW=/(\d{4})-?W(\d\d)(?:-?(\d))?/,mW=/(\d{4})-?(\d{3})/,yW=XF("weekYear","weekNumber","weekDay"),gW=XF("year","ordinal"),vW=/(\d{4})-(\d\d)-(\d\d)/,r5=RegExp(`${JT.source} ?(?:${e5.source}|(${QF.source}))?`),wW=RegExp(`(?: ${r5.source})?`);function Td(t,e,r){const i=t[e];return me(i)?r:va(i)}function bW(t,e){return[{year:Td(t,e),month:Td(t,e+1,1),day:Td(t,e+2,1)},null,e+3]}function Xh(t,e){return[{hours:Td(t,e,0),minutes:Td(t,e+1,0),seconds:Td(t,e+2,0),milliseconds:WT(t[e+3])},null,e+4]}function iy(t,e){const r=!t[e]&&!t[e+1],i=Cw(t[e+1],t[e+2]),s=r?null:Rt.instance(i);return[{},s,e+3]}function sy(t,e){const r=t[e]?bi.create(t[e]):null;return[{},r,e+1]}const _W=RegExp(`^T?${JT.source}$`),SW=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function $W(t){const[e,r,i,s,n,o,l,u,d]=t,p=e[0]==="-",f=u&&u[0]==="-",m=(y,g=!1)=>y!==void 0&&(g||y&&p)?-y:y;return[{years:m(pl(r)),months:m(pl(i)),weeks:m(pl(s)),days:m(pl(n)),hours:m(pl(o)),minutes:m(pl(l)),seconds:m(pl(u),u==="-0"),milliseconds:m(WT(d),f)}]}const xW={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function KT(t,e,r,i,s,n,o){const l={year:e.length===2?tS(va(e)):va(e),month:BF.indexOf(r)+1,day:va(i),hour:va(s),minute:va(n)};return o&&(l.second=va(o)),t&&(l.weekday=t.length>3?WF.indexOf(t)+1:ZF.indexOf(t)+1),l}const TW=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function MW(t){const[,e,r,i,s,n,o,l,u,d,p,f]=t,m=KT(e,s,i,r,n,o,l);let y;return u?y=xW[u]:d?y=0:y=Cw(p,f),[m,new Rt(y)]}function IW(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const EW=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,OW=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,kW=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function _E(t){const[,e,r,i,s,n,o,l]=t;return[KT(e,s,i,r,n,o,l),Rt.utcInstance]}function CW(t){const[,e,r,i,s,n,o,l]=t;return[KT(e,l,r,i,s,n,o),Rt.utcInstance]}const PW=Yh(pW,YT),AW=Yh(fW,YT),RW=Yh(mW,YT),LW=Yh(t5),i5=Kh(bW,Xh,iy,sy),FW=Kh(yW,Xh,iy,sy),NW=Kh(gW,Xh,iy,sy),DW=Kh(Xh,iy,sy);function jW(t){return Qh(t,[PW,i5],[AW,FW],[RW,NW],[LW,DW])}function VW(t){return Qh(IW(t),[TW,MW])}function zW(t){return Qh(t,[EW,_E],[OW,_E],[kW,CW])}function UW(t){return Qh(t,[SW,$W])}const qW=Kh(Xh);function GW(t){return Qh(t,[_W,qW])}const BW=Yh(vW,wW),HW=Yh(r5),WW=Kh(Xh,iy,sy);function ZW(t){return Qh(t,[BW,i5],[HW,WW])}const SE="Invalid Duration",s5={weeks:{days:7,hours:168,minutes:10080,seconds:10080*60,milliseconds:10080*60*1e3},days:{hours:24,minutes:1440,seconds:1440*60,milliseconds:1440*60*1e3},hours:{minutes:60,seconds:3600,milliseconds:3600*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},JW={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:2184*60,seconds:2184*60*60,milliseconds:2184*60*60*1e3},months:{weeks:4,days:30,hours:720,minutes:720*60,seconds:720*60*60,milliseconds:720*60*60*1e3},...s5},Zi=146097/400,Qu=146097/4800,YW={years:{quarters:4,months:12,weeks:Zi/7,days:Zi,hours:Zi*24,minutes:Zi*24*60,seconds:Zi*24*60*60,milliseconds:Zi*24*60*60*1e3},quarters:{months:3,weeks:Zi/28,days:Zi/4,hours:Zi*24/4,minutes:Zi*24*60/4,seconds:Zi*24*60*60/4,milliseconds:Zi*24*60*60*1e3/4},months:{weeks:Qu/7,days:Qu,hours:Qu*24,minutes:Qu*24*60,seconds:Qu*24*60*60,milliseconds:Qu*24*60*60*1e3},...s5},iu=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],KW=iu.slice(0).reverse();function Un(t,e,r=!1){const i={values:r?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new ke(i)}function n5(t,e){let r=e.milliseconds??0;for(const i of KW.slice(1))e[i]&&(r+=e[i]*t[i].milliseconds);return r}function $E(t,e){const r=n5(t,e)<0?-1:1;iu.reduceRight((i,s)=>{if(me(e[s]))return i;if(i){const n=e[i]*r,o=t[s][i],l=Math.floor(n/o);e[s]+=l*r,e[i]-=l*o*r}return s},null),iu.reduce((i,s)=>{if(me(e[s]))return i;if(i){const n=e[i]%1;e[i]-=n,e[s]+=n*t[i][s]}return s},null)}function xE(t){const e={};for(const[r,i]of Object.entries(t))i!==0&&(e[r]=i);return e}class ke{constructor(e){const r=e.conversionAccuracy==="longterm"||!1;let i=r?YW:JW;e.matrix&&(i=e.matrix),this.values=e.values,this.loc=e.loc||ze.create(),this.conversionAccuracy=r?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(e,r){return ke.fromObject({milliseconds:e},r)}static fromObject(e,r={}){if(e==null||typeof e!="object")throw new $r(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new ke({values:Tv(e,ke.normalizeUnit),loc:ze.fromObject(r),conversionAccuracy:r.conversionAccuracy,matrix:r.matrix})}static fromDurationLike(e){if(Ua(e))return ke.fromMillis(e);if(ke.isDuration(e))return e;if(typeof e=="object")return ke.fromObject(e);throw new $r(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,r){const[i]=UW(e);return i?ke.fromObject(i,r):ke.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,r){const[i]=GW(e);return i?ke.fromObject(i,r):ke.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,r=null){if(!e)throw new $r("need to specify a reason the Duration is invalid");const i=e instanceof Ks?e:new Ks(e,r);if(vt.throwOnInvalid)throw new $H(i);return new ke({invalid:i})}static normalizeUnit(e){const r={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!r)throw new pF(e);return r}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,r={}){const i={...r,floor:r.round!==!1&&r.floor!==!1};return this.isValid?Or.create(this.loc,i).formatDurationFromString(this,e):SE}toHuman(e={}){if(!this.isValid)return SE;const r=e.showZeros!==!1,i=iu.map(s=>{const n=this.values[s];return me(n)||n===0&&!r?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:s.slice(0,-1)}).format(n)}).filter(s=>s);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=ZT(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const r=this.toMillis();return r<0||r>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},Y.fromMillis(r,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?n5(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const r=ke.fromDurationLike(e),i={};for(const s of iu)(Sh(r.values,s)||Sh(this.values,s))&&(i[s]=r.get(s)+this.get(s));return Un(this,{values:i},!0)}minus(e){if(!this.isValid)return this;const r=ke.fromDurationLike(e);return this.plus(r.negate())}mapUnits(e){if(!this.isValid)return this;const r={};for(const i of Object.keys(this.values))r[i]=GF(e(this.values[i],i));return Un(this,{values:r},!0)}get(e){return this[ke.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const r={...this.values,...Tv(e,ke.normalizeUnit)};return Un(this,{values:r})}reconfigure({locale:e,numberingSystem:r,conversionAccuracy:i,matrix:s}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:r}),matrix:s,conversionAccuracy:i};return Un(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return $E(this.matrix,e),Un(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=xE(this.normalize().shiftToAll().toObject());return Un(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>ke.normalizeUnit(o));const r={},i={},s=this.toObject();let n;for(const o of iu)if(e.indexOf(o)>=0){n=o;let l=0;for(const d in i)l+=this.matrix[d][o]*i[d],i[d]=0;Ua(s[o])&&(l+=s[o]);const u=Math.trunc(l);r[o]=u,i[o]=(l*1e3-u*1e3)/1e3}else Ua(s[o])&&(i[o]=s[o]);for(const o in i)i[o]!==0&&(r[n]+=o===n?i[o]:i[o]/this.matrix[n][o]);return $E(this.matrix,r),Un(this,{values:r},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const r of Object.keys(this.values))e[r]=this.values[r]===0?0:-this.values[r];return Un(this,{values:e},!0)}removeZeros(){if(!this.isValid)return this;const e=xE(this.values);return Un(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function r(i,s){return i===void 0||i===0?s===void 0||s===0:i===s}for(const i of iu)if(!r(this.values[i],e.values[i]))return!1;return!0}}const Xu="Invalid Interval";function QW(t,e){return!t||!t.isValid?mt.invalid("missing or invalid start"):!e||!e.isValid?mt.invalid("missing or invalid end"):e<t?mt.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class mt{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,r=null){if(!e)throw new $r("need to specify a reason the Interval is invalid");const i=e instanceof Ks?e:new Ks(e,r);if(vt.throwOnInvalid)throw new SH(i);return new mt({invalid:i})}static fromDateTimes(e,r){const i=yp(e),s=yp(r),n=QW(i,s);return n??new mt({start:i,end:s})}static after(e,r){const i=ke.fromDurationLike(r),s=yp(e);return mt.fromDateTimes(s,s.plus(i))}static before(e,r){const i=ke.fromDurationLike(r),s=yp(e);return mt.fromDateTimes(s.minus(i),s)}static fromISO(e,r){const[i,s]=(e||"").split("/",2);if(i&&s){let n,o;try{n=Y.fromISO(i,r),o=n.isValid}catch{o=!1}let l,u;try{l=Y.fromISO(s,r),u=l.isValid}catch{u=!1}if(o&&u)return mt.fromDateTimes(n,l);if(o){const d=ke.fromISO(s,r);if(d.isValid)return mt.after(n,d)}else if(u){const d=ke.fromISO(i,r);if(d.isValid)return mt.before(l,d)}}return mt.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",r){if(!this.isValid)return NaN;const i=this.start.startOf(e,r);let s;return r?.useLocaleWeeks?s=this.end.reconfigure({locale:i.locale}):s=this.end,s=s.startOf(e,r),Math.floor(s.diff(i,e).get(e))+(s.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:r}={}){return this.isValid?mt.fromDateTimes(e||this.s,r||this.e):this}splitAt(...e){if(!this.isValid)return[];const r=e.map(yp).filter(o=>this.contains(o)).sort((o,l)=>o.toMillis()-l.toMillis()),i=[];let{s}=this,n=0;for(;s<this.e;){const o=r[n]||this.e,l=+o>+this.e?this.e:o;i.push(mt.fromDateTimes(s,l)),s=l,n+=1}return i}splitBy(e){const r=ke.fromDurationLike(e);if(!this.isValid||!r.isValid||r.as("milliseconds")===0)return[];let{s:i}=this,s=1,n;const o=[];for(;i<this.e;){const l=this.start.plus(r.mapUnits(u=>u*s));n=+l>+this.e?this.e:l,o.push(mt.fromDateTimes(i,n)),i=n,s+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const r=this.s>e.s?this.s:e.s,i=this.e<e.e?this.e:e.e;return r>=i?null:mt.fromDateTimes(r,i)}union(e){if(!this.isValid)return this;const r=this.s<e.s?this.s:e.s,i=this.e>e.e?this.e:e.e;return mt.fromDateTimes(r,i)}static merge(e){const[r,i]=e.sort((s,n)=>s.s-n.s).reduce(([s,n],o)=>n?n.overlaps(o)||n.abutsStart(o)?[s,n.union(o)]:[s.concat([n]),o]:[s,o],[[],null]);return i&&r.push(i),r}static xor(e){let r=null,i=0;const s=[],n=e.map(u=>[{time:u.s,type:"s"},{time:u.e,type:"e"}]),o=Array.prototype.concat(...n),l=o.sort((u,d)=>u.time-d.time);for(const u of l)i+=u.type==="s"?1:-1,i===1?r=u.time:(r&&+r!=+u.time&&s.push(mt.fromDateTimes(r,u.time)),r=null);return mt.merge(s)}difference(...e){return mt.xor([this].concat(e)).map(r=>this.intersection(r)).filter(r=>r&&!r.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:Xu}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=Sv,r={}){return this.isValid?Or.create(this.s.loc.clone(r),e).formatInterval(this):Xu}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:Xu}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Xu}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:Xu}toFormat(e,{separator:r="  "}={}){return this.isValid?`${this.s.toFormat(e)}${r}${this.e.toFormat(e)}`:Xu}toDuration(e,r){return this.isValid?this.e.diff(this.s,e,r):ke.invalid(this.invalidReason)}mapEndpoints(e){return mt.fromDateTimes(e(this.s),e(this.e))}}class Py{static hasDST(e=vt.defaultZone){const r=Y.now().setZone(e).set({month:12});return!e.isUniversal&&r.offset!==r.set({month:6}).offset}static isValidIANAZone(e){return bi.isValidZone(e)}static normalizeZone(e){return Ma(e,vt.defaultZone)}static getStartOfWeek({locale:e=null,locObj:r=null}={}){return(r||ze.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:r=null}={}){return(r||ze.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:r=null}={}){return(r||ze.create(e)).getWeekendDays().slice()}static months(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null,outputCalendar:n="gregory"}={}){return(s||ze.create(r,i,n)).months(e)}static monthsFormat(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null,outputCalendar:n="gregory"}={}){return(s||ze.create(r,i,n)).months(e,!0)}static weekdays(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null}={}){return(s||ze.create(r,i,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null}={}){return(s||ze.create(r,i,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return ze.create(e).meridiems()}static eras(e="short",{locale:r=null}={}){return ze.create(r,null,"gregory").eras(e)}static features(){return{relative:zF(),localeWeek:UF()}}}function TE(t,e){const r=s=>s.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=r(e)-r(t);return Math.floor(ke.fromMillis(i).as("days"))}function XW(t,e,r){const i=[["years",(u,d)=>d.year-u.year],["quarters",(u,d)=>d.quarter-u.quarter+(d.year-u.year)*4],["months",(u,d)=>d.month-u.month+(d.year-u.year)*12],["weeks",(u,d)=>{const p=TE(u,d);return(p-p%7)/7}],["days",TE]],s={},n=t;let o,l;for(const[u,d]of i)r.indexOf(u)>=0&&(o=u,s[u]=d(t,e),l=n.plus(s),l>e?(s[u]--,t=n.plus(s),t>e&&(l=t,s[u]--,t=n.plus(s))):t=l);return[t,s,l,o]}function eZ(t,e,r,i){let[s,n,o,l]=XW(t,e,r);const u=e-s,d=r.filter(f=>["hours","minutes","seconds","milliseconds"].indexOf(f)>=0);d.length===0&&(o<e&&(o=s.plus({[l]:1})),o!==s&&(n[l]=(n[l]||0)+u/(o-s)));const p=ke.fromObject(n,i);return d.length>0?ke.fromMillis(u,i).shiftTo(...d).plus(p):p}const tZ="missing Intl.DateTimeFormat.formatToParts support";function Re(t,e=r=>r){return{regex:t,deser:([r])=>e(BH(r))}}const rZ="",o5=`[ ${rZ}]`,a5=new RegExp(o5,"g");function iZ(t){return t.replace(/\./g,"\\.?").replace(a5,o5)}function ME(t){return t.replace(/\./g,"").replace(a5," ").toLowerCase()}function Is(t,e){return t===null?null:{regex:RegExp(t.map(iZ).join("|")),deser:([r])=>t.findIndex(i=>ME(r)===ME(i))+e}}function IE(t,e){return{regex:t,deser:([,r,i])=>Cw(r,i),groups:e}}function Ay(t){return{regex:t,deser:([e])=>e}}function sZ(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function nZ(t,e){const r=Ms(e),i=Ms(e,"{2}"),s=Ms(e,"{3}"),n=Ms(e,"{4}"),o=Ms(e,"{6}"),l=Ms(e,"{1,2}"),u=Ms(e,"{1,3}"),d=Ms(e,"{1,6}"),p=Ms(e,"{1,9}"),f=Ms(e,"{2,4}"),m=Ms(e,"{4,6}"),y=_=>({regex:RegExp(sZ(_.val)),deser:([S])=>S,literal:!0}),v=(_=>{if(t.literal)return y(_);switch(_.val){case"G":return Is(e.eras("short"),0);case"GG":return Is(e.eras("long"),0);case"y":return Re(d);case"yy":return Re(f,tS);case"yyyy":return Re(n);case"yyyyy":return Re(m);case"yyyyyy":return Re(o);case"M":return Re(l);case"MM":return Re(i);case"MMM":return Is(e.months("short",!0),1);case"MMMM":return Is(e.months("long",!0),1);case"L":return Re(l);case"LL":return Re(i);case"LLL":return Is(e.months("short",!1),1);case"LLLL":return Is(e.months("long",!1),1);case"d":return Re(l);case"dd":return Re(i);case"o":return Re(u);case"ooo":return Re(s);case"HH":return Re(i);case"H":return Re(l);case"hh":return Re(i);case"h":return Re(l);case"mm":return Re(i);case"m":return Re(l);case"q":return Re(l);case"qq":return Re(i);case"s":return Re(l);case"ss":return Re(i);case"S":return Re(u);case"SSS":return Re(s);case"u":return Ay(p);case"uu":return Ay(l);case"uuu":return Re(r);case"a":return Is(e.meridiems(),0);case"kkkk":return Re(n);case"kk":return Re(f,tS);case"W":return Re(l);case"WW":return Re(i);case"E":case"c":return Re(r);case"EEE":return Is(e.weekdays("short",!1),1);case"EEEE":return Is(e.weekdays("long",!1),1);case"ccc":return Is(e.weekdays("short",!0),1);case"cccc":return Is(e.weekdays("long",!0),1);case"Z":case"ZZ":return IE(new RegExp(`([+-]${l.source})(?::(${i.source}))?`),2);case"ZZZ":return IE(new RegExp(`([+-]${l.source})(${i.source})?`),2);case"z":return Ay(/[a-z_+-/]{1,256}?/i);case" ":return Ay(/[^\S\n\r]/);default:return y(_)}})(t)||{invalidReason:tZ};return v.token=t,v}const oZ={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function aZ(t,e,r){const{type:i,value:s}=t;if(i==="literal"){const u=/^\s+$/.test(s);return{literal:!u,val:u?" ":s}}const n=e[i];let o=i;i==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=r.hour12?"hour12":"hour24");let l=oZ[o];if(typeof l=="object"&&(l=l[n]),l)return{literal:!1,val:l}}function lZ(t){return[`^${t.map(r=>r.regex).reduce((r,i)=>`${r}(${i.source})`,"")}$`,t]}function uZ(t,e,r){const i=t.match(e);if(i){const s={};let n=1;for(const o in r)if(Sh(r,o)){const l=r[o],u=l.groups?l.groups+1:1;!l.literal&&l.token&&(s[l.token.val[0]]=l.deser(i.slice(n,n+u))),n+=u}return[i,s]}else return[i,{}]}function cZ(t){const e=n=>{switch(n){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let r=null,i;return me(t.z)||(r=bi.create(t.z)),me(t.Z)||(r||(r=new Rt(t.Z)),i=t.Z),me(t.q)||(t.M=(t.q-1)*3+1),me(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),me(t.u)||(t.S=WT(t.u)),[Object.keys(t).reduce((n,o)=>{const l=e(o);return l&&(n[l]=t[o]),n},{}),r,i]}let Jb=null;function dZ(){return Jb||(Jb=Y.fromMillis(1555555555555)),Jb}function hZ(t,e){if(t.literal)return t;const r=Or.macroTokenToFormatOpts(t.val),i=d5(r,e);return i==null||i.includes(void 0)?t:i}function l5(t,e){return Array.prototype.concat(...t.map(r=>hZ(r,e)))}class u5{constructor(e,r){if(this.locale=e,this.format=r,this.tokens=l5(Or.parseFormat(r),e),this.units=this.tokens.map(i=>nZ(i,e)),this.disqualifyingUnit=this.units.find(i=>i.invalidReason),!this.disqualifyingUnit){const[i,s]=lZ(this.units);this.regex=RegExp(i,"i"),this.handlers=s}}explainFromTokens(e){if(this.isValid){const[r,i]=uZ(e,this.regex,this.handlers),[s,n,o]=i?cZ(i):[null,null,void 0];if(Sh(i,"a")&&Sh(i,"H"))throw new cd("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:r,matches:i,result:s,zone:n,specificOffset:o}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function c5(t,e,r){return new u5(t,r).explainFromTokens(e)}function pZ(t,e,r){const{result:i,zone:s,specificOffset:n,invalidReason:o}=c5(t,e,r);return[i,s,n,o]}function d5(t,e){if(!t)return null;const i=Or.create(e,t).dtFormatter(dZ()),s=i.formatToParts(),n=i.resolvedOptions();return s.map(o=>aZ(o,t,n))}const Yb="Invalid DateTime",EE=864e13;function qp(t){return new Ks("unsupported zone",`the zone "${t.name}" is not supported`)}function Kb(t){return t.weekData===null&&(t.weekData=$v(t.c)),t.weekData}function Qb(t){return t.localWeekData===null&&(t.localWeekData=$v(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function fl(t,e){const r={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new Y({...r,...e,old:r})}function h5(t,e,r){let i=t-e*60*1e3;const s=r.offset(i);if(e===s)return[i,e];i-=(s-e)*60*1e3;const n=r.offset(i);return s===n?[i,s]:[t-Math.min(s,n)*60*1e3,Math.max(s,n)]}function Ry(t,e){t+=e*60*1e3;const r=new Date(t);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:r.getUTCHours(),minute:r.getUTCMinutes(),second:r.getUTCSeconds(),millisecond:r.getUTCMilliseconds()}}function jg(t,e,r){return h5(kw(t),e,r)}function OE(t,e){const r=t.o,i=t.c.year+Math.trunc(e.years),s=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,n={...t.c,year:i,month:s,day:Math.min(t.c.day,xv(i,s))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=ke.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),l=kw(n);let[u,d]=h5(l,r,t.zone);return o!==0&&(u+=o,d=t.zone.offset(u)),{ts:u,o:d}}function ec(t,e,r,i,s,n){const{setZone:o,zone:l}=r;if(t&&Object.keys(t).length!==0||e){const u=e||l,d=Y.fromObject(t,{...r,zone:u,specificOffset:n});return o?d:d.setZone(l)}else return Y.invalid(new Ks("unparsable",`the input "${s}" can't be parsed as ${i}`))}function Ly(t,e,r=!0){return t.isValid?Or.create(ze.create("en-US"),{allowZ:r,forceSimple:!0}).formatDateTimeFromString(t,e):null}function Xb(t,e,r){const i=t.c.year>9999||t.c.year<0;let s="";if(i&&t.c.year>=0&&(s+="+"),s+=Pt(t.c.year,i?6:4),r==="year")return s;if(e){if(s+="-",s+=Pt(t.c.month),r==="month")return s;s+="-"}else if(s+=Pt(t.c.month),r==="month")return s;return s+=Pt(t.c.day),s}function kE(t,e,r,i,s,n,o){let l=!r||t.c.millisecond!==0||t.c.second!==0,u="";switch(o){case"day":case"month":case"year":break;default:if(u+=Pt(t.c.hour),o==="hour")break;if(e){if(u+=":",u+=Pt(t.c.minute),o==="minute")break;l&&(u+=":",u+=Pt(t.c.second))}else{if(u+=Pt(t.c.minute),o==="minute")break;l&&(u+=Pt(t.c.second))}if(o==="second")break;l&&(!i||t.c.millisecond!==0)&&(u+=".",u+=Pt(t.c.millisecond,3))}return s&&(t.isOffsetFixed&&t.offset===0&&!n?u+="Z":t.o<0?(u+="-",u+=Pt(Math.trunc(-t.o/60)),u+=":",u+=Pt(Math.trunc(-t.o%60))):(u+="+",u+=Pt(Math.trunc(t.o/60)),u+=":",u+=Pt(Math.trunc(t.o%60)))),n&&(u+="["+t.zone.ianaName+"]"),u}const p5={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},fZ={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},mZ={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Vg=["year","month","day","hour","minute","second","millisecond"],yZ=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],gZ=["year","ordinal","hour","minute","second","millisecond"];function zg(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new pF(t);return e}function CE(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return zg(t)}}function vZ(t){if(Gp===void 0&&(Gp=vt.now()),t.type!=="iana")return t.offset(Gp);const e=t.name;let r=rS.get(e);return r===void 0&&(r=t.offset(Gp),rS.set(e,r)),r}function PE(t,e){const r=Ma(e.zone,vt.defaultZone);if(!r.isValid)return Y.invalid(qp(r));const i=ze.fromObject(e);let s,n;if(me(t.year))s=vt.now();else{for(const u of Vg)me(t[u])&&(t[u]=p5[u]);const o=jF(t)||VF(t);if(o)return Y.invalid(o);const l=vZ(r);[s,n]=jg(t,l,r)}return new Y({ts:s,zone:r,loc:i,o:n})}function AE(t,e,r){const i=me(r.round)?!0:r.round,s=me(r.rounding)?"trunc":r.rounding,n=(l,u)=>(l=ZT(l,i||r.calendary?0:2,r.calendary?"round":s),e.loc.clone(r).relFormatter(r).format(l,u)),o=l=>r.calendary?e.hasSame(t,l)?0:e.startOf(l).diff(t.startOf(l),l).get(l):e.diff(t,l).get(l);if(r.unit)return n(o(r.unit),r.unit);for(const l of r.units){const u=o(l);if(Math.abs(u)>=1)return n(u,l)}return n(t>e?-0:0,r.units[r.units.length-1])}function RE(t){let e={},r;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],r=Array.from(t).slice(0,t.length-1)):r=Array.from(t),[e,r]}let Gp;const rS=new Map;class Y{constructor(e){const r=e.zone||vt.defaultZone;let i=e.invalid||(Number.isNaN(e.ts)?new Ks("invalid input"):null)||(r.isValid?null:qp(r));this.ts=me(e.ts)?vt.now():e.ts;let s=null,n=null;if(!i)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(r))[s,n]=[e.old.c,e.old.o];else{const l=Ua(e.o)&&!e.old?e.o:r.offset(this.ts);s=Ry(this.ts,l),i=Number.isNaN(s.year)?new Ks("invalid input"):null,s=i?null:s,n=i?null:l}this._zone=r,this.loc=e.loc||ze.create(),this.invalid=i,this.weekData=null,this.localWeekData=null,this.c=s,this.o=n,this.isLuxonDateTime=!0}static now(){return new Y({})}static local(){const[e,r]=RE(arguments),[i,s,n,o,l,u,d]=r;return PE({year:i,month:s,day:n,hour:o,minute:l,second:u,millisecond:d},e)}static utc(){const[e,r]=RE(arguments),[i,s,n,o,l,u,d]=r;return e.zone=Rt.utcInstance,PE({year:i,month:s,day:n,hour:o,minute:l,second:u,millisecond:d},e)}static fromJSDate(e,r={}){const i=YH(e)?e.valueOf():NaN;if(Number.isNaN(i))return Y.invalid("invalid input");const s=Ma(r.zone,vt.defaultZone);return s.isValid?new Y({ts:i,zone:s,loc:ze.fromObject(r)}):Y.invalid(qp(s))}static fromMillis(e,r={}){if(Ua(e))return e<-EE||e>EE?Y.invalid("Timestamp out of range"):new Y({ts:e,zone:Ma(r.zone,vt.defaultZone),loc:ze.fromObject(r)});throw new $r(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,r={}){if(Ua(e))return new Y({ts:e*1e3,zone:Ma(r.zone,vt.defaultZone),loc:ze.fromObject(r)});throw new $r("fromSeconds requires a numerical input")}static fromObject(e,r={}){e=e||{};const i=Ma(r.zone,vt.defaultZone);if(!i.isValid)return Y.invalid(qp(i));const s=ze.fromObject(r),n=Tv(e,CE),{minDaysInFirstWeek:o,startOfWeek:l}=gE(n,s),u=vt.now(),d=me(r.specificOffset)?i.offset(u):r.specificOffset,p=!me(n.ordinal),f=!me(n.year),m=!me(n.month)||!me(n.day),y=f||m,g=n.weekYear||n.weekNumber;if((y||p)&&g)throw new cd("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(m&&p)throw new cd("Can't mix ordinal dates with month/day");const v=g||n.weekday&&!y;let _,S,M=Ry(u,d);v?(_=yZ,S=fZ,M=$v(M,o,l)):p?(_=gZ,S=mZ,M=Zb(M)):(_=Vg,S=p5);let C=!1;for(const G of _){const Q=n[G];me(Q)?C?n[G]=S[G]:n[G]=M[G]:C=!0}const T=v?WH(n,o,l):p?ZH(n):jF(n),O=T||VF(n);if(O)return Y.invalid(O);const P=v?mE(n,o,l):p?yE(n):n,[D,z]=jg(P,d,i),B=new Y({ts:D,zone:i,o:z,loc:s});return n.weekday&&y&&e.weekday!==B.weekday?Y.invalid("mismatched weekday",`you can't specify both a weekday of ${n.weekday} and a date of ${B.toISO()}`):B.isValid?B:Y.invalid(B.invalid)}static fromISO(e,r={}){const[i,s]=jW(e);return ec(i,s,r,"ISO 8601",e)}static fromRFC2822(e,r={}){const[i,s]=VW(e);return ec(i,s,r,"RFC 2822",e)}static fromHTTP(e,r={}){const[i,s]=zW(e);return ec(i,s,r,"HTTP",r)}static fromFormat(e,r,i={}){if(me(e)||me(r))throw new $r("fromFormat requires an input string and a format");const{locale:s=null,numberingSystem:n=null}=i,o=ze.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0}),[l,u,d,p]=pZ(o,e,r);return p?Y.invalid(p):ec(l,u,i,`format ${r}`,e,d)}static fromString(e,r,i={}){return Y.fromFormat(e,r,i)}static fromSQL(e,r={}){const[i,s]=ZW(e);return ec(i,s,r,"SQL",e)}static invalid(e,r=null){if(!e)throw new $r("need to specify a reason the DateTime is invalid");const i=e instanceof Ks?e:new Ks(e,r);if(vt.throwOnInvalid)throw new _H(i);return new Y({invalid:i})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,r={}){const i=d5(e,ze.fromObject(r));return i?i.map(s=>s?s.val:null).join(""):null}static expandFormat(e,r={}){return l5(Or.parseFormat(e),ze.fromObject(r)).map(s=>s.val).join("")}static resetCache(){Gp=void 0,rS.clear()}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Kb(this).weekYear:NaN}get weekNumber(){return this.isValid?Kb(this).weekNumber:NaN}get weekday(){return this.isValid?Kb(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?Qb(this).weekday:NaN}get localWeekNumber(){return this.isValid?Qb(this).weekNumber:NaN}get localWeekYear(){return this.isValid?Qb(this).weekYear:NaN}get ordinal(){return this.isValid?Zb(this.c).ordinal:NaN}get monthShort(){return this.isValid?Py.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Py.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Py.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Py.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,r=6e4,i=kw(this.c),s=this.zone.offset(i-e),n=this.zone.offset(i+e),o=this.zone.offset(i-s*r),l=this.zone.offset(i-n*r);if(o===l)return[this];const u=i-o*r,d=i-l*r,p=Ry(u,o),f=Ry(d,l);return p.hour===f.hour&&p.minute===f.minute&&p.second===f.second&&p.millisecond===f.millisecond?[fl(this,{ts:u}),fl(this,{ts:d})]:[this]}get isInLeapYear(){return ry(this.year)}get daysInMonth(){return xv(this.year,this.month)}get daysInYear(){return this.isValid?xd(this.year):NaN}get weeksInWeekYear(){return this.isValid?bm(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?bm(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:r,numberingSystem:i,calendar:s}=Or.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:r,numberingSystem:i,outputCalendar:s}}toUTC(e=0,r={}){return this.setZone(Rt.instance(e),r)}toLocal(){return this.setZone(vt.defaultZone)}setZone(e,{keepLocalTime:r=!1,keepCalendarTime:i=!1}={}){if(e=Ma(e,vt.defaultZone),e.equals(this.zone))return this;if(e.isValid){let s=this.ts;if(r||i){const n=e.offset(this.ts),o=this.toObject();[s]=jg(o,n,e)}return fl(this,{ts:s,zone:e})}else return Y.invalid(qp(e))}reconfigure({locale:e,numberingSystem:r,outputCalendar:i}={}){const s=this.loc.clone({locale:e,numberingSystem:r,outputCalendar:i});return fl(this,{loc:s})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const r=Tv(e,CE),{minDaysInFirstWeek:i,startOfWeek:s}=gE(r,this.loc),n=!me(r.weekYear)||!me(r.weekNumber)||!me(r.weekday),o=!me(r.ordinal),l=!me(r.year),u=!me(r.month)||!me(r.day),d=l||u,p=r.weekYear||r.weekNumber;if((d||o)&&p)throw new cd("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(u&&o)throw new cd("Can't mix ordinal dates with month/day");let f;n?f=mE({...$v(this.c,i,s),...r},i,s):me(r.ordinal)?(f={...this.toObject(),...r},me(r.day)&&(f.day=Math.min(xv(f.year,f.month),f.day))):f=yE({...Zb(this.c),...r});const[m,y]=jg(f,this.o,this.zone);return fl(this,{ts:m,o:y})}plus(e){if(!this.isValid)return this;const r=ke.fromDurationLike(e);return fl(this,OE(this,r))}minus(e){if(!this.isValid)return this;const r=ke.fromDurationLike(e).negate();return fl(this,OE(this,r))}startOf(e,{useLocaleWeeks:r=!1}={}){if(!this.isValid)return this;const i={},s=ke.normalizeUnit(e);switch(s){case"years":i.month=1;case"quarters":case"months":i.day=1;case"weeks":case"days":i.hour=0;case"hours":i.minute=0;case"minutes":i.second=0;case"seconds":i.millisecond=0;break}if(s==="weeks")if(r){const n=this.loc.getStartOfWeek(),{weekday:o}=this;o<n&&(i.weekNumber=this.weekNumber-1),i.weekday=n}else i.weekday=1;if(s==="quarters"){const n=Math.ceil(this.month/3);i.month=(n-1)*3+1}return this.set(i)}endOf(e,r){return this.isValid?this.plus({[e]:1}).startOf(e,r).minus(1):this}toFormat(e,r={}){return this.isValid?Or.create(this.loc.redefaultToEN(r)).formatDateTimeFromString(this,e):Yb}toLocaleString(e=Sv,r={}){return this.isValid?Or.create(this.loc.clone(r),e).formatDateTime(this):Yb}toLocaleParts(e={}){return this.isValid?Or.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:r=!1,suppressMilliseconds:i=!1,includeOffset:s=!0,extendedZone:n=!1,precision:o="milliseconds"}={}){if(!this.isValid)return null;o=zg(o);const l=e==="extended";let u=Xb(this,l,o);return Vg.indexOf(o)>=3&&(u+="T"),u+=kE(this,l,r,i,s,n,o),u}toISODate({format:e="extended",precision:r="day"}={}){return this.isValid?Xb(this,e==="extended",zg(r)):null}toISOWeekDate(){return Ly(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:r=!1,includeOffset:i=!0,includePrefix:s=!1,extendedZone:n=!1,format:o="extended",precision:l="milliseconds"}={}){return this.isValid?(l=zg(l),(s&&Vg.indexOf(l)>=3?"T":"")+kE(this,o==="extended",r,e,i,n,l)):null}toRFC2822(){return Ly(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Ly(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?Xb(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:r=!1,includeOffsetSpace:i=!0}={}){let s="HH:mm:ss.SSS";return(r||e)&&(i&&(s+=" "),r?s+="z":e&&(s+="ZZ")),Ly(this,s,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():Yb}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const r={...this.c};return e.includeConfig&&(r.outputCalendar=this.outputCalendar,r.numberingSystem=this.loc.numberingSystem,r.locale=this.loc.locale),r}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,r="milliseconds",i={}){if(!this.isValid||!e.isValid)return ke.invalid("created by diffing an invalid DateTime");const s={locale:this.locale,numberingSystem:this.numberingSystem,...i},n=KH(r).map(ke.normalizeUnit),o=e.valueOf()>this.valueOf(),l=o?this:e,u=o?e:this,d=eZ(l,u,n,s);return o?d.negate():d}diffNow(e="milliseconds",r={}){return this.diff(Y.now(),e,r)}until(e){return this.isValid?mt.fromDateTimes(this,e):this}hasSame(e,r,i){if(!this.isValid)return!1;const s=e.valueOf(),n=this.setZone(e.zone,{keepLocalTime:!0});return n.startOf(r,i)<=s&&s<=n.endOf(r,i)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const r=e.base||Y.fromObject({},{zone:this.zone}),i=e.padding?this<r?-e.padding:e.padding:0;let s=["years","months","days","hours","minutes","seconds"],n=e.unit;return Array.isArray(e.unit)&&(s=e.unit,n=void 0),AE(r,this.plus(i),{...e,numeric:"always",units:s,unit:n})}toRelativeCalendar(e={}){return this.isValid?AE(e.base||Y.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(Y.isDateTime))throw new $r("min requires all arguments be DateTimes");return vE(e,r=>r.valueOf(),Math.min)}static max(...e){if(!e.every(Y.isDateTime))throw new $r("max requires all arguments be DateTimes");return vE(e,r=>r.valueOf(),Math.max)}static fromFormatExplain(e,r,i={}){const{locale:s=null,numberingSystem:n=null}=i,o=ze.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0});return c5(o,e,r)}static fromStringExplain(e,r,i={}){return Y.fromFormatExplain(e,r,i)}static buildFormatParser(e,r={}){const{locale:i=null,numberingSystem:s=null}=r,n=ze.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});return new u5(n,e)}static fromFormatParser(e,r,i={}){if(me(e)||me(r))throw new $r("fromFormatParser requires an input string and a format parser");const{locale:s=null,numberingSystem:n=null}=i,o=ze.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0});if(!o.equals(r.locale))throw new $r(`fromFormatParser called with a locale of ${o}, but the format parser was created for ${r.locale}`);const{result:l,zone:u,specificOffset:d,invalidReason:p}=r.explainFromTokens(e);return p?Y.invalid(p):ec(l,u,i,`format ${r.format}`,e,d)}static get DATE_SHORT(){return Sv}static get DATE_MED(){return fF}static get DATE_MED_WITH_WEEKDAY(){return xH}static get DATE_FULL(){return mF}static get DATE_HUGE(){return yF}static get TIME_SIMPLE(){return gF}static get TIME_WITH_SECONDS(){return vF}static get TIME_WITH_SHORT_OFFSET(){return wF}static get TIME_WITH_LONG_OFFSET(){return bF}static get TIME_24_SIMPLE(){return _F}static get TIME_24_WITH_SECONDS(){return SF}static get TIME_24_WITH_SHORT_OFFSET(){return $F}static get TIME_24_WITH_LONG_OFFSET(){return xF}static get DATETIME_SHORT(){return TF}static get DATETIME_SHORT_WITH_SECONDS(){return MF}static get DATETIME_MED(){return IF}static get DATETIME_MED_WITH_SECONDS(){return EF}static get DATETIME_MED_WITH_WEEKDAY(){return TH}static get DATETIME_FULL(){return OF}static get DATETIME_FULL_WITH_SECONDS(){return kF}static get DATETIME_HUGE(){return CF}static get DATETIME_HUGE_WITH_SECONDS(){return PF}}function yp(t){if(Y.isDateTime(t))return t;if(t&&t.valueOf&&Ua(t.valueOf()))return Y.fromJSDate(t);if(t&&typeof t=="object")return Y.fromObject(t);throw new $r(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const wZ="shortOffset";function bZ(t){return"timeZoneIANA"in t}function _Z(t){return t.startsWith("UTC")}function Mv(t,e=!1){return{json:{read:{source:t,reader:(r,i)=>i[t]?Ug(i[t]):null},write:!!e&&{allowNull:!0,writer(r,i){i[t]=r?SZ(r):null}}}}}function Ug(t,e=rn){return t?bZ(t)?t.timeZoneIANA:$Z(t,e):e}function SZ(t){return{timeZoneIANA:t}}function $Z(t,e=rn){if(!t||!sE.has(t.timeZone))return e;const r=sE.get(t.timeZone);return _Z(t.timeZone)||t.respectsDaylightSaving?r:xZ(r)}function xZ(t){const e=Y.local().setZone(t),r=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return r===0?"Etc/UTC":`Etc/GMT${Rt.instance(-r).formatOffset(0,"narrow")}`}function j1e(t,e,r,i,s){if(e&&s==="date")return{timeZone:Qa,timeZoneName:void 0};const n=i.hour,o=r===Ka;return{timeZone:o?s==="timestamp-offset"?void 0:t??Qa:r,timeZoneName:o&&n?wZ:void 0}}function TZ(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),r=new Set(Intl.supportedValuesOf("timeZone").map(i=>i.toLowerCase()));return t===rn||t===Ka||e.has(t.toLowerCase())||r.has(t.toLowerCase())}const MZ={dateStyle:void 0,year:void 0,month:void 0,day:void 0,weekday:void 0},IZ={timeStyle:void 0,hour12:void 0,hourCycle:void 0,hour:void 0,minute:void 0,second:void 0},f5={timeZone:Qa},on={year:"numeric",month:"numeric",day:"numeric"},gp={year:"numeric",month:"long",day:"numeric"},vp={year:"numeric",month:"short",day:"numeric"},wp={year:"numeric",month:"long",weekday:"long",day:"numeric"},wa={hour:"numeric",minute:"numeric"},Il={...wa,second:"numeric"},m5={hourCycle:"h23"},bp={...wa,...m5},_p={...Il,...m5},y5={"short-date":on,"short-date-short-time":{...on,...wa},"short-date-short-time-24":{...on,...bp},"short-date-long-time":{...on,...Il},"short-date-long-time-24":{...on,..._p},"short-date-le":on,"short-date-le-short-time":{...on,...wa},"short-date-le-short-time-24":{...on,...bp},"short-date-le-long-time":{...on,...Il},"short-date-le-long-time-24":{...on,..._p},"long-month-day-year":gp,"long-month-day-year-short-time":{...gp,...wa},"long-month-day-year-short-time-24":{...gp,...bp},"long-month-day-year-long-time":{...gp,...Il},"long-month-day-year-long-time-24":{...gp,..._p},"day-short-month-year":vp,"day-short-month-year-short-time":{...vp,...wa},"day-short-month-year-short-time-24":{...vp,...bp},"day-short-month-year-long-time":{...vp,...Il},"day-short-month-year-long-time-24":{...vp,..._p},"long-date":wp,"long-date-short-time":{...wp,...wa},"long-date-short-time-24":{...wp,...bp},"long-date-long-time":{...wp,...Il},"long-date-long-time-24":{...wp,..._p},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":wa,"long-time":Il},EZ=Lt()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),g5={ar:"ar-u-nu-latn-ca-gregory",nn:"no-NN"},OZ=new Intl.DateTimeFormat("bs",{month:"long"}).formatToParts(new Date(2025,2)),kZ=OZ.find(({type:t})=>t==="month")?.value.toLowerCase();function v5(){const t=UT();return(t&&g5[t])??nF()}kZ!=="mart"&&(g5.bs="sr-Latn-CS");let iS=new WeakMap;const Aw=y5["short-date-short-time"];function CZ(t){let e=iS.get(t);if(!e){const r=v5(),i=QT(t.timeZone??rn),s={...t,timeZone:i};e=new Intl.DateTimeFormat(r,s),iS.set(t,e)}return e}function V1e(t){return y5[t]}function z1e(t){const{dateStyle:e,timeStyle:r,hour12:i,year:s,month:n}=t,o={};return e?o.dateStyle=e:s&&(o.year=s,o.month=n||void 0),r&&!o.year&&(o.timeStyle=r,o.hour12=i==="auto"?void 0:i==="always"),o}function Xa(t,e=Aw){return CZ(e).format(t)}function U1e(t,e=Aw){return Xa(new Date(t),{...e,...f5,...IZ})}function q1e(t,e=Aw){return Xa(new Date(`1970-01-01T${t}Z`),{...e,...f5,...MZ})}function G1e(t,e=Aw){if(e.timeZone)return Xa(new Date(t),e);const r=Y.fromISO(t,{setZone:!0}),i=r.offset===0?Qa:e.timeZone,s={...e,timeZone:i};return r.toLocaleString(s,{locale:v5()})}function QT(t){switch(t){case rn:return bH;case Ka:return Qa;default:return t}}qT(()=>{iS=new WeakMap});const PZ={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let qg=new WeakMap,w5={};function sS(t){const e=t||w5;if(!qg.has(e)){const r=UT(),i=r&&PZ[r]||nF();qg.set(e,new Intl.NumberFormat(i,t))}return qg.get(e)}function B1e(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function H1e(t){const{minimumFractionDigits:e,maximumFractionDigits:r,useGrouping:i}=t;return{minimumFractionDigits:e,maximumFractionDigits:r,useGrouping:i==="auto"?"auto":i==="always"}}function Iv(t,e){return Object.is(t,-0)&&(t=0),sS(e).format(t)}function W1e(t,e=gi()){if(!t)return null;let r=LE.get(e);if(!r){const i=sS().formatToParts(12345.6),s=[...sS({useGrouping:!1}).format(9876543210)].reverse(),n=new Map(s.map((f,m)=>[f,m])),o=new RegExp(`[${i.find(f=>f.type==="group")?.value}]`,"g"),l=new RegExp(`[${i.find(f=>f.type==="decimal")?.value}]`),u=new RegExp(`[${s.join("")}]`,"g"),d=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,p=/[-\u2212\u2013\u2014\u2015]/g;r=f=>{if((f=f.trim().replaceAll(o,"").replace(l,".").replace(u,y=>String(n.get(y))).replaceAll(d,"").replaceAll(p,"-"))==="")return null;const m=Number(f);return isNaN(m)?null:m},LE.set(e,r)}return r(t)}qT(()=>{qg=new WeakMap,w5={}});const LE=new Map,b5=()=>L.getLogger("esri.intl.substitute");function XT(t,e,r={}){const{format:i={}}=r;return sl(t,s=>AZ(s,e,i))}function AZ(t,e,r){let i,s;const n=t.indexOf(":");if(n===-1?i=t.trim():(i=t.slice(0,n).trim(),s=t.slice(n+1).trim()),!i)return"";const o=Wm(i,e);if(o==null)return"";const l=(s?r?.[s]:null)??r?.[i];return l?RZ(o,l):s?LZ(o,s):eM(o)}function RZ(t,e){switch(e.type){case"date":return Xa(t,e.intlOptions);case"number":return Iv(t,e.intlOptions);default:return b5().warn("missing format descriptor for key {key}"),eM(t)}}function LZ(t,e){switch(e.toLowerCase()){case"dateformat":return Xa(t);case"numberformat":return Iv(t);default:return b5().warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?Xa(t):/^numberformat/i.test(e)?Iv(t):eM(t)}}function eM(t){switch(typeof t){case"string":return t;case"number":return Iv(t);case"boolean":return""+t;default:return t instanceof Date?Xa(t):""}}async function FZ(t,e,r,i){const s=e.exec(r);if(!s)throw new x("esri-intl:invalid-bundle",`Bundle id "${r}" is not compatible with the pattern "${e}"`);const n=s[1]?`${s[1]}/`:"",o=s[2],l=dF(i),u=`${n}${o}.json`,d=l?`${n}${o}_${l}.json`:u;let p;try{p=await FE(t(d))}catch(f){if(d===u)throw new x("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:f});try{p=await FE(t(u))}catch(m){throw new x("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:m})}}return p}async function FE(t){if(NE.fetchBundleAsset!=null)return NE.fetchBundleAsset(t);const e=await Ae(t,{responseType:"text"});return JSON.parse(e.data)}let NZ=class{constructor({base:e="",pattern:r,location:i=new URL(window.location.href)}){let s;s=typeof i=="string"?n=>new URL(n,new URL(i,window.location.href)).href:i instanceof URL?n=>new URL(n,i).href:i,this.pattern=typeof r=="string"?new RegExp(`^${r}`):r,this.getAssetUrl=s,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,r){return FZ(this.getAssetUrl,this.matcher,e,r)}};function DZ(t){return new NZ(t)}const NE={};yH(DZ({pattern:"esri/",location:nt}));let Qn=class extends X{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const e=this.language;let r=e==="local"||e==="global"?e:dF(e??gi())??"global";return r=r==="no"?"nb":r,r}};a([c()],Qn.prototype,"apiKey",void 0),a([c()],Qn.prototype,"id",void 0),a([c()],Qn.prototype,"language",void 0),a([c()],Qn.prototype,"places",void 0),a([c()],Qn.prototype,"serviceUrl",void 0),a([c()],Qn.prototype,"worldview",void 0),Qn=a([b("esri.support.BasemapStyle")],Qn);const jZ=Qn,_5=Symbol("BasemapInstance");function Y1e(t){return t!=null&&typeof t=="object"&&_5 in t}function ne(t,e,r={}){return tM(t,e,r,S5)}function qi(t,e,r={}){return tM(t,e,r,$5)}function tM(t,e,r={},i){let s=null;const n=r.once?(o,l)=>{i(o)&&(He(s),e(o,l))}:(o,l)=>{i(o)&&e(o,l)};if(s=Uq(t,n,r.sync,r.equals),r.initial){const o=t();n(o,o)}return s}function Lu(t,e,r,i={}){let s=null,n=null,o=null;function l(){s&&n&&(n.remove(),i.onListenerRemove?.(s),s=null,n=null)}function u(p){i.once&&i.once&&He(o),r(p)}const d=ne(t,(p,f)=>{l(),fw(p)&&(s=p,n=zh(p,e,u),i.onListenerAdd?.(p))},{sync:i.sync,initial:!0});return o=Te(()=>{d.remove(),l()}),o}function Rw(t,e){return VZ(t,$5,e)}function VZ(t,e,r){if(Cr(r))return Promise.reject(Fe());const i=t();if(e?.(i))return Promise.resolve(i);let s=null;function n(){s=He(s)}return new Promise((o,l)=>{s=Uu([ys(r,()=>{n(),l(Fe())}),tM(t,u=>{n(),o(u)},{sync:!1,once:!0},e??S5)])})}function S5(t){return!0}function $5(t){return!!t}function K1e(t,e,r={}){let i=!1;const s=ne(t,(n,o)=>{i||e(n,o)},r);return{remove(){s.remove()},pause(){i=!0},resume(){i=!1}}}const jn={sync:!0},Et={initial:!0},xr={sync:!0,initial:!0};let x5=0;const Lw=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+x5++})}};return r=a([b("esri.core.Identifiable")],r),r},rM=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:x5++})}};return r=a([b("esri.core.Identifiable.NumericIdentifiable")],r),r};Lw(class{});async function zZ(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:r}=await N(async()=>{const{fromItem:i}=await import("./portalLayers-Cg2Dfb0s.js");return{fromItem:i}},__vite__mapDeps([6,7,8,9,10]));try{return await r(e)}catch(i){const s=e?.portalItem,n=s?.id||"unset",o=s?.portal?.url||_e.portalUrl;throw L.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+o+"', id: '"+n+"')",i),i}}const DE={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function e1(t,e,r,i=rn){const s=new bi(QT(i)),n=Y.fromJSDate(t,{zone:s}),o=r==="decades"||r==="centuries"?"year":M5(r);return r==="decades"&&(e*=10),r==="centuries"&&(e*=100),n.plus({[o]:e}).toJSDate()}function Q1e(t,e,r="milliseconds"){const i=t.getTime(),s=T5(e,r,"milliseconds");return new Date(i+s)}function jE(t,e,r=rn){const i=new bi(QT(r)),s=Y.fromJSDate(t,{zone:i});if(e==="decades"||e==="centuries"){const o=s.startOf("year"),{year:l}=o,u=l-l%(e==="decades"?10:100);return o.set({year:u}).toJSDate()}const n=M5(e);return s.startOf(n).toJSDate()}function T5(t,e,r){return t===0?0:t*DE[e]/DE[r]}function X1e(t,e){return t&&e?t.intersection(e):t||e}function M5(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var Ji,zd;let It=(zd=class extends F{static get allTime(){return VE}static get empty(){return UZ}static fromArray(e){return new Ji({start:e[0]!=null?new Date(e[0]):e[0],end:e[1]!=null?new Date(e[1]):e[1]})}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,r){return r.end!=null?new Date(r.end):null}writeEnd(e,r){r.end=e?.getTime()??null}get isAllTime(){return this.equals(Ji.allTime)}get isEmpty(){return this.equals(Ji.empty)}readStart(e,r){return r.start!=null?new Date(r.start):null}writeStart(e,r){r.start=e?.getTime()??null}clone(){return new Ji({end:this.end,start:this.start})}equals(e){if(!e)return!1;const r=this.start?.getTime()??this.start,i=this.end?.getTime()??this.end,s=e.start?.getTime()??e.start,n=e.end?.getTime()??e.end;return r===s&&i===n}expandTo(e,r=rn){if(this.isEmpty||this.isAllTime)return this.clone();let i=this.start;i&&(i=jE(i,e,r));let s=this.end;if(s){const n=jE(s,e,r);s=s.getTime()===n.getTime()?n:e1(n,1,e,r)}return new Ji({start:i,end:s})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return Ji.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const r=this.start?.getTime()??-1/0,i=this.end?.getTime()??1/0,s=e.start?.getTime()??-1/0,n=e.end?.getTime()??1/0;let o,l;return s>=r&&s<=i?o=s:r>=s&&r<=n&&(o=r),i>=s&&i<=n?l=i:n>=r&&n<=i&&(l=n),o==null||l==null||isNaN(o)||isNaN(l)?Ji.empty:new Ji({start:o===-1/0?null:new Date(o),end:l===1/0?null:new Date(l)})}offset(e,r,i=rn){if(this.isEmpty||this.isAllTime)return this.clone();const s=new Ji,{start:n,end:o}=this;return n!=null&&(s.start=e1(n,e,r,i)),o!=null&&(s.end=e1(o,e,r,i)),s}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return VE.clone();const r=this.start!=null&&e.start!=null?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,i=this.end!=null&&e.end!=null?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new Ji({start:r,end:i})}},Ji=zd,zd);a([c({type:Date,json:{write:{allowNull:!0}}})],It.prototype,"end",void 0),a([V("end")],It.prototype,"readEnd",null),a([q("end")],It.prototype,"writeEnd",null),a([c({readOnly:!0,json:{read:!1}})],It.prototype,"isAllTime",null),a([c({readOnly:!0,json:{read:!1}})],It.prototype,"isEmpty",null),a([c({type:Date,json:{write:{allowNull:!0}}})],It.prototype,"start",void 0),a([V("start")],It.prototype,"readStart",null),a([q("start")],It.prototype,"writeStart",null),It=Ji=a([b("esri.time.TimeExtent")],It);const VE=new It,UZ=new It({start:void 0,end:void 0});let qZ=0,tt=class extends _w(Lw(Xm)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new he(-180,-90,180,90,Z.WGS84),this.id=Date.now().toString(16)+"-layer-"+qZ++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Z.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const r=typeof e=="string"?{url:e}:e;return(await N(async()=>{const{fromUrl:i}=await import("./arcgisLayers-DRXE11Cu.js");return{fromUrl:i}},__vite__mapDeps([11,7,8,10]))).fromUrl(r)}static fromPortalItem(e){return zZ(e)}initialize(){this.when().catch(e=>{sr(e)||L.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const{parent:e}=this;e&&(this.parent=null,e.removeChildLayer?.(this))}get effectiveVisible(){return this.visible&&(this.parent?.effectiveVisible??!0)}get hasAttributionData(){return this.attributionDataUrl!=null}get loaded(){return super.loaded}removeFromParent(){const{parent:e}=this;e&&(e.removeChildLayer?.(this),this.parent=null)}get parsedUrl(){return Rr(this.url)}createLayerView(e,r){return Promise.reject(new x("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await Ae(e,{query:{f:"json"},responseType:"json"})).data;throw new x("layer:no-attribution-data","Layer does not have attribution data")}};a([c({type:String})],tt.prototype,"attributionDataUrl",void 0),a([c({readOnly:!0})],tt.prototype,"effectiveVisible",null),a([c({type:he})],tt.prototype,"fullExtent",void 0),a([c({readOnly:!0})],tt.prototype,"hasAttributionData",null),a([c({type:String,clonable:!1})],tt.prototype,"id",void 0),a([c({type:Boolean,nonNullable:!0})],tt.prototype,"legendEnabled",void 0),a([c({type:["show","hide","hide-children"]})],tt.prototype,"listMode",void 0),a([c({type:Number,range:{min:0,max:1},nonNullable:!0})],tt.prototype,"opacity",void 0),a([c({clonable:!1})],tt.prototype,"parent",void 0),a([c({readOnly:!0})],tt.prototype,"parsedUrl",null),a([c({type:Boolean,readOnly:!0})],tt.prototype,"persistenceEnabled",void 0),a([c({type:Boolean})],tt.prototype,"popupEnabled",void 0),a([c({type:Boolean})],tt.prototype,"attributionVisible",void 0),a([c({type:Z})],tt.prototype,"spatialReference",void 0),a([c({type:String})],tt.prototype,"title",void 0),a([c({readOnly:!0,json:{read:!1}})],tt.prototype,"type",void 0),a([c()],tt.prototype,"url",void 0),a([c({type:It})],tt.prototype,"visibilityTimeExtent",void 0),a([c({type:Boolean,nonNullable:!0})],tt.prototype,"visible",void 0),tt=a([b("esri.layers.Layer")],tt);const Fy=new WeakMap;function I5(t){return!t.destroyed&&(Fy.has(t)||t.addHandles([ne(()=>{const{parent:e}=t;return!!(e&&e instanceof tt)&&(e.type==="catalog-dynamic-group"||I5(e))},e=>Fy.set(t,e),xr),Te(()=>Fy.delete(t))]),Fy.get(t))}function GZ(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function t_e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="graphics"}function BZ(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="map-image"}function HZ(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph"&&"layers"in t}function r_e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph-sublayer"}function zE(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="subtype-group"&&"sublayers"in t}function bc(t){return t?.type==="subtype-sublayer"}const i_e={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function nS(t){const e=t?.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function s_e(t){return t.type==="integrated-mesh"||t.type==="integrated-mesh-3dtiles"}function Fw(t){return t?.type==="feature"&&!t.url&&t.source?.type==="memory"}function n_e(t){const e=t?.type;return(e==="feature"||e==="subtype-group"||e==="oriented-imagery")&&t?.source?.type==="feature-layer"}function WZ(t){return t?.type==="feature"&&t.source?.type==="feature-layer"}function ZZ(t){return GZ(t)&&WZ(t)}async function iM(t,e){const r=Se?.findServerInfo(t);if(r?.currentVersion!=null)return r.owningSystemUrl||null;const i=t.toLowerCase().indexOf("/rest/services");if(i===-1)return null;const s=`${t.slice(0,i)}/rest/info`,n=e!=null?e.signal:null,{data:o}=await Ae(s,{query:{f:"json"},responseType:"json",signal:n});return o?.owningSystemUrl||null}function E5(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function JZ(t){return E5(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function YZ(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"knowledge-graph-sublayer":return!0;default:return!1}}function KZ(t){return!!YZ(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}function QZ(t,e){return null}function o_e(t){return null}function oS(t){return!t||t.type==="Feature Service"&&!t.sourceUrl}function a_e(t,e){!e||!oS(t)||QZ(t.url)}const XZ=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wcs","wms","wmts"]),eJ=new Set(["integrated-mesh-3dtiles"]),O5=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","parquet","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","video","web-tile","wcs","wfs","wms","wmts"]),tJ=new Set([...O5,"link-chart"]);function rJ(t){switch(t.layerContainerType){case"basemap-base-layers":return XZ;case"basemap-ground-layers":return eJ;case"operational-layers":return t.origin==="link-chart"?tJ:O5;default:return null}}function iJ(t,e){if(e.restrictedWebMapWriting){const r=rJ(e);return r==null||r.has(t.type)&&!Fw(t)}return!0}function sJ(t,e){if(e)if(Fw(t)){const r=Wm("featureCollection.layers",e),i=r?.[0]?.layerDefinition;i&&UE(t,i)}else t.type!=="group"&&UE(t,e)}function UE(t,e){"maxScale"in t&&(e.maxScale=gv(t.maxScale)??void 0),"minScale"in t&&(e.minScale=gv(t.minScale)??void 0)}function nJ(t,e){if(sJ(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=gv(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(Fw(t)){const r=e.featureCollection;r&&(r.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function t1(t,e,r){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return r?.messages&&r.messages.push(new x("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(Fw(t)&&!t.isTable)e=t.resourceInfo;else if(iJ(t,r)){const i={};return t.write(i,r)?i:null}return e!=null&&nJ(t,e=E(e)),e}var qE,_c,bu;let ei=(bu=class extends ol(Xm){constructor(e){super(e),this[qE]=!0,this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.type="Basemap",this.id=Date.now().toString(16)+"-basemap-"+_c.idCounter++,this.baseLayers=new H,this.referenceLayers=new H,this.groundLayers=new H;const r=l=>{const{parent:u}=l;u&&u!==this&&"remove"in u&&u.remove?.(l),l.parent=this,l.type!=="elevation"&&l.type!=="integrated-mesh-3dtiles"||L.getLogger(this).error(`Layer '${l.title}, id:${l.id}' of type '${l.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=l=>{const{parent:u}=l;u&&u!==this&&"remove"in u&&u.remove?.(l),l.parent=this},s=l=>{const u=l.item;return u.parent===this?(L.getLogger(this).error(`Layer '${u.title}, id:${u.id}' of type '${u.type}' already a ground layer, second add will be ignored.`),void l.preventDefault()):u.type!=="integrated-mesh-3dtiles"&&u.type!=="integrated-mesh"?(L.getLogger(this).error(`Layer '${u.title}, id:${u.id}' of type '${u.type}' is not supported as a ground layer and will therefore be ignored.`),void l.preventDefault()):void 0},n=l=>{l.parent=null},o=l=>{l.parent===this&&(l.parent=null)};this.addHandles([this.baseLayers.on("after-add",l=>r(l.item)),this.baseLayers.on("after-remove",l=>n(l.item)),this.referenceLayers.on("after-add",l=>r(l.item)),this.referenceLayers.on("after-remove",l=>n(l.item)),this.groundLayers.on("before-add",s),this.groundLayers.on("after-add",l=>i(l.item)),this.groundLayers.on("after-remove",l=>o(l.item))])}initialize(){this.when().catch(e=>{L.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const s of e)s.destroyed||s.destroy();const r=this.groundLayers.toArray();for(const s of r)s.destroyed||s.destroy();const i=this.referenceLayers.toArray();for(const s of i)s.destroyed||s.destroy();this.baseLayers.destroy(),this.groundLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=Ke(this.portalItem)}removeChildLayer(e){for(const r of[this.baseLayers,this.referenceLayers,this.groundLayers])r.remove(e)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",Pn(e,this._get("baseLayers")))}_writeBaseLayers(e,r,i){const s=[];e&&(i={...i,layerContainerType:"basemap-base-layers"},this.baseLayers.forEach(n=>{const o=t1(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);o!=null&&s.push(o)}),this.referenceLayers.forEach(n=>{const o=t1(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);o!=null&&(n.type!=="scene"&&(o.isReference=!0),s.push(o))})),r.baseMapLayers=s}set groundLayers(e){this._set("groundLayers",Pn(e,this._get("groundLayers")))}_writeGroundLayers(e,r,i){const s=[];e&&(i={...i,layerContainerType:"basemap-ground-layers"},this.groundLayers.forEach(n=>{const o=t1(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);o!=null&&s.push(o)}),s.length>0&&(r.groundLayers=s))}get loaded(){return super.loaded}set referenceLayers(e){this._set("referenceLayers",Pn(e,this._get("referenceLayers")))}writeTitle(e,r){r.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return CL(this,e=>{e(this.baseLayers,this.groundLayers,this.referenceLayers)})}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(r=>Af(r)?r.clone():r),groundLayers:this.groundLayers.map(r=>Af(r)?r.clone():r),referenceLayers:this.referenceLayers.map(r=>Af(r)?r.clone():r)};return this.loaded&&(e.loadStatus="loaded"),new _c({resourceInfo:this.resourceInfo}).set(e)}read(e,r){this.resourceInfo||this._set("resourceInfo",{data:e,context:r}),super.read(e,r)}write(e,r){return e=e||{},r?.origin||(r={origin:"web-map",...r}),super.write(e,r),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(i=>{const s=E(i);return s.url&&Fn(s.url)&&(s.url=`https:${s.url}`),s.templateUrl&&Fn(s.templateUrl)&&(s.templateUrl=`https:${s.templateUrl}`),s})),e}async _loadFromSource(e){const{resourceInfo:r,portalItem:i,style:s}=this;We(e);const n=[];if(r){const o=r.context?r.context.url:null;if(n.push(this._loadLayersFromJSON(r.data,o,e)),r.data.id&&!r.data.title){const l=r.data.id;n.push(wH(l).then(u=>{u&&this.read({title:u},r.context)}))}}else i?n.push(this._loadFromItem(i,e)):s&&n.push(this._loadFromStylesService(s,e));await Promise.all(n)}async _loadLayersFromJSON(e,r,i){const s=this.resourceInfo?.context,n=this.portalItem?.portal||s?.portal||null,o=aJ[s?.origin||""]??"web-map",{populateOperationalLayers:l}=await N(async()=>{const{populateOperationalLayers:d}=await import("./layersCreator-BEKV_G8I.js");return{populateOperationalLayers:d}},__vite__mapDeps([12,9,8,7,10,6])),u=[];if(We(i),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const d={context:{...s,origin:o,url:r,portal:n,layerContainerType:"basemap-base-layers"},defaultLayerType:"DefaultTileLayer"},p=y=>o==="web-scene"&&y.layerType==="ArcGISSceneServiceLayer"||y.isReference,f=l(this.baseLayers,e.baseMapLayers.filter(y=>!p(y)),d);u.push(f);const m=l(this.referenceLayers,e.baseMapLayers.filter(p),d);u.push(m)}if(e.groundLayers&&Array.isArray(e.groundLayers)){const d={context:{...s,origin:o,url:r,portal:n,layerContainerType:"basemap-ground-layers"},defaultLayerType:"IntegratedMesh3DTilesLayer"},p=l(this.groundLayers,e.groundLayers,d);u.push(p)}await Promise.allSettled(u)}async _loadFromItem(e,r){const i=await e.load(r),s=await i.fetchData("json",r),n=Rr(e.itemUrl??"");return this._set("resourceInfo",{data:s.baseMap??{},context:{origin:oJ[e.type||""]??"web-map",portal:e.portal||j.getDefault(),url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:s.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||j.getDefault(),url:n}),this._loadLayersFromJSON(this.resourceInfo.data,n,r)}async _loadFromStylesService(e,r){const i=e.serviceUrl.endsWith("/webmaps")?e.serviceUrl.slice(0,-8):e.serviceUrl,s=`${i}/styles/${e.id}/self`,n=`${i}/webmaps/${e.id}`,o=e.apiKey??_e.apiKeys.basemapStyles,[l,u]=await Promise.all([(await Ae(s,{query:{token:o},signal:r?.signal})).data,(await Ae(n,{query:{language:e.languageParameter,places:e.places,worldview:e.worldview,token:o},signal:r?.signal})).data]);this.thumbnailUrl??=l.thumbnailUrl;const d=Rr(n);if(this._set("resourceInfo",{data:u.baseMap??{},context:{origin:"web-map",url:d}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:u.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,d,r),o)for(const p of[...this.baseLayers,...this.groundLayers,...this.referenceLayers])"apiKey"in p&&(p.apiKey=o)}static fromId(e){const r=B_[e];return r?r.itemId?new _c({portalItem:{id:r.itemId,portal:{url:"https://www.arcgis.com"}}}):_c.fromJSON(r,r.is3d?{origin:"web-scene",portal:new j({url:"https://www.arcgis.com"})}:{origin:"web-map"}):null}},qE=_5,_c=bu,bu.idCounter=0,bu);a([c({json:{read:!1,write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,r,i){this._writeBaseLayers(t,e,i)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:H}},writer(t,e,r,i){this._writeBaseLayers(t,e,i)}}}}}})],ei.prototype,"baseLayers",null),a([c({json:{read:!1,write:{ignoreOrigin:!0,target:"groundLayers",writer(t,e,r,i){this._writeGroundLayers(t,e,i)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{groundLayers:{type:H}},writer(t,e,r,i){this._writeGroundLayers(t,e,i)}}}}}})],ei.prototype,"groundLayers",null),a([c({type:String,json:{origins:{"web-scene":{write:!0}}}})],ei.prototype,"id",void 0),a([c({type:de})],ei.prototype,"portalItem",void 0),a([c()],ei.prototype,"referenceLayers",null),a([c({readOnly:!0})],ei.prototype,"resourceInfo",void 0),a([c({type:Z})],ei.prototype,"spatialReference",void 0),a([c({type:jZ})],ei.prototype,"style",void 0),a([c()],ei.prototype,"thumbnailUrl",void 0),a([c({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],ei.prototype,"title",void 0),a([q("title")],ei.prototype,"writeTitle",null),ei=_c=a([b("esri.Basemap")],ei);const oJ={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},aJ={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},Df=ei,lJ=Object.freeze(Object.defineProperty({__proto__:null,default:Df},Symbol.toStringTag,{value:"Module"})),Ev={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function k5(t){return!!Ev[t]||!!Ev[t.toLowerCase()]}function sM(t){return Ev[t]??Ev[t.toLowerCase()]}function uJ(t){return[...sM(t)]}function r1(t,e,r){r<0&&++r,r>1&&--r;const i=6*r;return i<1?t+(e-t)*i:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}function C5(t,e,r,i=1){const s=(t%360+360)%360/360,n=r<=.5?r*(e+1):r+e-r*e,o=2*r-n;return[Math.round(255*r1(o,n,s+1/3)),Math.round(255*r1(o,n,s)),Math.round(255*r1(o,n,s-1/3)),i]}function cJ(t){const e=t.length>5,r=e?8:4,i=(1<<r)-1,s=e?1:17,n=e?t.length===9:t.length===5;let o=+("0x"+t.slice(1));if(isNaN(o))return null;const l=[0,0,0,1];let u;return n&&(u=o&i,o>>=r,l[3]=s*u/255),u=o&i,o>>=r,l[2]=s*u,u=o&i,o>>=r,l[1]=s*u,u=o&i,o>>=r,l[0]=s*u,l}function P5(t){if(!t.startsWith("#")||isNaN(+`0x${t.slice(1)}`))return null;switch(t.length){case 4:case 5:{const e=parseInt(t.slice(1,2),16),r=parseInt(t.slice(2,3),16),i=parseInt(t.slice(3,4),16),s=t.length===4?15:parseInt(t.slice(4),16);return[e+16*e,r+16*r,i+16*i,(s+16*s)/255]}case 7:case 9:return[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16),(t.length===7?255:parseInt(t.slice(7),16))/255];default:return null}}function A5(t){const e=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(e){const r=e[2].split(/\s*,\s*/),i=e[1];if(i==="rgb"&&r.length===3||i==="rgba"&&r.length===4){if(r[0].endsWith("%")){const s=r.map(n=>2.56*parseFloat(n));return r.length===4&&(s[3]=parseFloat(r[3])),GE(s)}return GE(r.map(s=>parseFloat(s)))}if(i==="hsl"&&r.length===3||i==="hsla"&&r.length===4)return C5(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100,parseFloat(r[3]??"1"))}return null}function GE(t){return t[0]=Md(t[0]),t[1]=Md(t[1]),t[2]=Md(t[2]),t[3]=t.length===4?L5(t[3]):1,t}function R5(t){let e=k5(t)?sM(t):null;return e??=A5(t),e??=P5(t),e}function l_e(t){const e=R5(t);return e!=null?[e[0]/255,e[1]/255,e[2]/255,e[3]]:null}function L5(t){return F5(t,0,1)}function Md(t){return Math.round(F5(t,0,255))}function F5(t,e,r){return t=Number(t),isNaN(t)?r:t<e?e:t>r?r:t}const N5=2.2,dJ=1/N5;function u_e(t){return t**N5}function c_e(t){return t**dJ}const BE=new Float32Array(1);function d_e(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function Gi(t,e,r){return Math.min(Math.max(t,e),r)}function h_e(t){return!(t&t-1)}function p_e(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function Bp(t,e,r){return t+(e-t)*r}function f_e(t,e,r,i,s){return Bp(i,s,(t-e)/(r-e))}function ny(t){return t*Math.PI/180}function D5(t){return 180*t/Math.PI}function m_e(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function y_e(t){return Math.acos(Gi(t,-1,1))}function hJ(t){return Math.asin(Gi(t,-1,1))}function zi(t,e,r=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=r}function j5(t,e,r=1e-6){return!zi(t,e,r)&&t>e}function aS(t,e,r=1e-6){return!zi(t,e,r)&&t<e}function pJ(t,e,r=1e-6){return zi(t,e,r)||t>e}const Ov=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function lS(t){return Ov.setFloat64(0,t),Ov.getBigInt64(0)}function fJ(t){return Ov.setBigInt64(0,t),Ov.getFloat64(0)}const Gg=1000000n,mJ=V5(1);function V5(t){const e=lS(t=Math.abs(t)),r=fJ(e<=Gg?Gg:e-Gg);return Math.abs(t-r)}function g_e(t,e,r=mJ){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(r!=null&&V5(Math.min(Math.abs(t),Math.abs(e)))<r)return Math.abs(t-e)<=r;const i=lS(t),s=lS(e);return i<0!=s<0?!1:!((i<s?s-i:i-s)>Gg)}function z5(t,e,r=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;const i=Math.abs(t-e),s=Math.abs(t),n=Math.abs(e);if(t===0||e===0||s<1e-12&&n<1e-12){if(i>.01*r)return!1}else if(i/(s+n)>r)return!1;return!0}function v_e(t){return U5(Math.max(-HE,Math.min(t,HE)))}function U5(t){return BE[0]=t,BE[0]}function w_e(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],i=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(zi(e,1)&&zi(r,1)&&zi(i,1))}function b_e(t,e){return(t%e+e)%e}const HE=U5(34028234663852886e22);function __e(t,e,r){if(r===void 0||+r==0)return Math[t](e);if(e=+e,r=+r,isNaN(e)||typeof r!="number"||r%1!=0)return NaN;let i=e.toString().split("e");return i=(e=Math[t](+(i[0]+"e"+(i[1]?+i[1]-r:-r)))).toString().split("e"),+(i[0]+"e"+(i[1]?+i[1]+r:r))}function Ny(t){return Gi(xT(t),0,255)}function Dy(t,e){const r=t.toString(16).padStart(2,"0");return e?r.slice(0,1):r}let ue=class Yi{static blendColors(e,r,i,s=new Yi){return s.r=Math.round(e.r+(r.r-e.r)*i),s.g=Math.round(e.g+(r.g-e.g)*i),s.b=Math.round(e.b+(r.b-e.b)*i),s.a=e.a+(r.a-e.a)*i,s._sanitize()}static fromRgb(e,r){const i=A5(e);return i?Yi.fromArray(i,r):null}static fromHex(e,r=new Yi){const i=P5(e);return i?Yi.fromArray(i,r):null}static fromArray(e,r=new Yi){return r._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(r.a)&&(r.a=1),r._sanitize()}static fromString(e,r){const i=R5(e);return i?Yi.fromArray(i,r):null}static fromJSON(e){return e!=null?new Yi([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e,r){return e==null?null:(r??=[0,0,0,0],r[0]=e.r/255,r[1]=e.g/255,r[2]=e.b/255,r[3]=e.a!=null?e.a:1,r)}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?Yi.fromString(e,this):Array.isArray(e)?Yi.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof Yi||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const r=e?.capitalize??!1,i=e?.digits??6,s=i===3||i===4,n=i===4||i===8,o=`#${Dy(this.r,s)}${Dy(this.g,s)}${Dy(this.b,s)}${n?Dy(Math.round(255*this.a),s):""}`;return r?o.toUpperCase():o}toCss(e=!1){const r=this.r+", "+this.g+", "+this.b;return e?`rgba(${r}, ${this.a})`:`rgb(${r})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=0){const r=Ny(this.r),i=Ny(this.g),s=Ny(this.b);return e===0||this.a!==1?[r,i,s,Ny(255*this.a)]:[r,i,s]}clone(){return new Yi(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Md(this.r),this.g=Md(this.g),this.b=Md(this.b),this.a=L5(this.a),this}_set(e,r,i,s){this.r=e,this.g=r,this.b=i,this.a=s}};ue.prototype.declaredClass="esri.Color";let Zs=class extends H{constructor(e){super(e),this.getCollections=null}initialize(){this.addHandles(iL(()=>this._refresh(),jn))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections?.();if(e==null)return void this.removeAll();let r=0;for(const i of e)i!=null&&(r=this._processCollection(r,i));this.splice(r)}_createNewInstance(e){return new H(e)}_processCollection(e,r){if(!r)return e;const i=this.itemFilterFunction??(s=>!!s);for(const s of r)if(s){if(i(s)){const n=this.indexOf(s,e);n>=0?n!==e&&this.reorder(s,e):this.add(s,e),++e}if(this.getChildrenFunction){const n=this.getChildrenFunction(s);if(Array.isArray(n))for(const o of n)e=this._processCollection(e,o);else e=this._processCollection(e,n)}}return e}};a([c()],Zs.prototype,"getCollections",void 0),a([c()],Zs.prototype,"getChildrenFunction",void 0),a([c()],Zs.prototype,"itemFilterFunction",void 0),Zs=a([b("esri.core.CollectionFlattener")],Zs);function se(t,e={}){const r=t instanceof $e?t:new $e(t,e),{alwaysWriteDefaults:i,default:s,ignoreUnknown:n=!0,name:o,nonNullable:l,readOnly:u=!1}=e;return c({type:n?r.apiValues:String,json:{type:r.jsonValues,default:s,name:o,read:!u&&{reader:r.read},write:{writer:r.write,alwaysWriteDefaults:i}},nonNullable:l,readOnly:u})}var uS;let Bg=uS=class extends F{constructor(t){super(t),this.type="none"}clone(){return new uS({type:this.type})}};a([se({none:"none",stayAbove:"stay-above"}),c({json:{write:{isRequired:!0}}})],Bg.prototype,"type",void 0),Bg=uS=a([b("esri.ground.NavigationConstraint")],Bg);const q5=Symbol("GroundInstance");function $_e(t){return t!=null&&typeof t=="object"&&q5 in t}function Nw(t){const e=xT(100*(1-t));return Math.max(0,Math.min(e,100))}function _m(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var WE,cS,LA;let Ki=cS=(LA=class extends ol(Xm){constructor(t){super(t),this[WE]=!0,this.parent=null,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new H;const e=i=>{const{parent:s}=i;s&&s!==this&&"remove"in s&&s.remove?.(i),i.parent=this,i.type!=="elevation"&&i.type!=="base-elevation"&&L.getLogger(this).error(`Layer '${i.title}, id:${i.id}' of type '${i.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},r=i=>{i.parent=null};this.addHandles([this.layers.on("after-add",i=>e(i.item)),this.layers.on("after-remove",i=>r(i.item))]),this.allLayers=new Zs({getCollections:()=>[this.layers,this.parent?.basemap?.groundLayers]})}removeChildLayer(t){this.layers.remove(t)}initialize(){this.when().catch(t=>{sr(t)||L.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}get integratedMeshGround(){const t=this.parent?.basemap?.groundLayers.at(0);return t?.replacesTerrain?t:null}destroy(){const t=this.layers.removeAll();for(const e of t)Ke(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}get loaded(){return super.loaded}get layers(){return this._get("layers")}set layers(t){this._set("layers",Pn(t,this._get("layers")))}writeLayers(t,e,r,i){const s=[];t&&(i={...i,layerContainerType:"ground"},t.forEach(n=>{if("write"in n){const o={};iU(n)().write(o,i)&&s.push(o)}else i?.messages&&i.messages.push(new x("layer:unsupported",`Layers (${n.title}, ${n.id}) of type '${n.declaredClass}' cannot be persisted in the ground`,{layer:n}))})),e.layers=s}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return CL(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e?.signal});const{queryAll:r}=await N(()=>import("./ElevationQuery-CjH_9s09.js"),__vite__mapDeps([13,14]));return We(e),r(this.layers.filter(ZE).toArray(),t,e)}async createElevationSampler(t,e){await this.load({signal:e?.signal});const{createSampler:r}=await N(()=>import("./ElevationQuery-CjH_9s09.js"),__vite__mapDeps([13,14]));return We(e),r(this.layers.filter(ZE).toArray(),t,e)}clone(){const t={opacity:this.opacity,surfaceColor:E(this.surfaceColor),navigationConstraint:E(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new cS({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,r){const i=e?.origin||"web-scene",s=e?.portal||null,n=e?.url||null,{populateOperationalLayers:o}=await N(async()=>{const{populateOperationalLayers:u}=await import("./layersCreator-BEKV_G8I.js");return{populateOperationalLayers:u}},__vite__mapDeps([12,9,8,7,10,6]));We(r);const l=[];if(t.layers&&Array.isArray(t.layers)){const u={context:{origin:i,url:n,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};l.push(o(this.layers,t.layers,u))}await Promise.allSettled(l)}},WE=q5,LA);function ZE(t){return t&&"createElevationSampler"in t}a([c()],Ki.prototype,"parent",void 0),a([c()],Ki.prototype,"integratedMeshGround",null),a([c({json:{read:!1,write:{isRequired:!0}}})],Ki.prototype,"layers",null),a([c()],Ki.prototype,"allLayers",void 0),a([q("layers")],Ki.prototype,"writeLayers",null),a([c({readOnly:!0})],Ki.prototype,"resourceInfo",void 0),a([c({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:xe,read:{reader:_m,source:"transparency"},write:{writer:(t,e)=>{e.transparency=Nw(t)},target:"transparency"}}})],Ki.prototype,"opacity",void 0),a([c({type:ue,json:{type:[xe],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],Ki.prototype,"surfaceColor",void 0),a([c({type:Bg,json:{write:!0}})],Ki.prototype,"navigationConstraint",void 0),Ki=cS=a([b("esri.Ground")],Ki);const kv=Ki,yJ=Symbol("ClonableMixin"),pe=t=>{var s;var e;const r=t;let i=(s=class extends r{constructor(){super(...arguments),this[e]=!0}clone(n){const o=Qr(this);bR(o,"unable to clone instance of non-accessor class");const l=o.metadata,u=o.store,d={},p=new Map;for(const m in l){const y=l[m],g=u?.originOf(m),v=y.clonable;if(y.readOnly||v===!1||g!==7&&g!==0&&g!==5&&g!==4)continue;const _=this[m];let S=null;if(typeof v=="function")S=v(_,n);else if(v==="reference")S=_;else if(S=p_(_,n),_!=null&&S==null)continue;g===0?p.set(m,S):d[m]=S}const f=new(Object.getPrototypeOf(this)).constructor(d);if(p.size){const m=Qr(f)?.store;if(m)for(const[y,g]of p)m.set(y,g,0)}return f}},e=yJ,s);return i=a([b("esri.core.Clonable")],i),i},nM=pe(X),gJ="randomUUID"in crypto;function ep(){if(gJ)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=r=>t[r].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function x_e(){return`{${ep().toUpperCase()}}`}function vJ(){return`{${ep()}}`}function wJ(t){const e=t.toUpperCase();return t.startsWith("{")?e:`{${e}}`}const tc={Base64:0,Hex:1,String:2,Raw:3},Id=8,G5=(1<<Id)-1;function Pa(t,e){const r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function bJ(t){const e=[];for(let r=0,i=t.length*Id;r<i;r+=Id)e[r>>5]|=(t.charCodeAt(r/Id)&G5)<<r%32;return e}function _J(t){const e=[];for(let r=0,i=32*t.length;r<i;r+=Id)e.push(String.fromCharCode(t[r>>5]>>>r%32&G5));return e.join("")}function SJ(t){const e="0123456789abcdef",r=[];for(let i=0,s=4*t.length;i<s;i++)r.push(e.charAt(t[i>>2]>>i%4*8+4&15)+e.charAt(t[i>>2]>>i%4*8&15));return r.join("")}function $J(t){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[];for(let s=0,n=4*t.length;s<n;s+=3){const o=(t[s>>2]>>s%4*8&255)<<16|(t[s+1>>2]>>(s+1)%4*8&255)<<8|t[s+2>>2]>>(s+2)%4*8&255;for(let l=0;l<4;l++)8*s+6*l>32*t.length?i.push("="):i.push(r.charAt(o>>6*(3-l)&63))}return i.join("")}function xJ(t,e){return t<<e|t>>>32-e}function Dw(t,e,r,i,s,n){return Pa(xJ(Pa(Pa(e,t),Pa(i,n)),s),r)}function fr(t,e,r,i,s,n,o){return Dw(e&r|~e&i,t,e,s,n,o)}function mr(t,e,r,i,s,n,o){return Dw(e&i|r&~i,t,e,s,n,o)}function yr(t,e,r,i,s,n,o){return Dw(e^r^i,t,e,s,n,o)}function gr(t,e,r,i,s,n,o){return Dw(r^(e|~i),t,e,s,n,o)}function TJ(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let r=1732584193,i=-271733879,s=-1732584194,n=271733878;for(let o=0;o<t.length;o+=16){const l=r,u=i,d=s,p=n;r=fr(r,i,s,n,t[o],7,-680876936),n=fr(n,r,i,s,t[o+1],12,-389564586),s=fr(s,n,r,i,t[o+2],17,606105819),i=fr(i,s,n,r,t[o+3],22,-1044525330),r=fr(r,i,s,n,t[o+4],7,-176418897),n=fr(n,r,i,s,t[o+5],12,1200080426),s=fr(s,n,r,i,t[o+6],17,-1473231341),i=fr(i,s,n,r,t[o+7],22,-45705983),r=fr(r,i,s,n,t[o+8],7,1770035416),n=fr(n,r,i,s,t[o+9],12,-1958414417),s=fr(s,n,r,i,t[o+10],17,-42063),i=fr(i,s,n,r,t[o+11],22,-1990404162),r=fr(r,i,s,n,t[o+12],7,1804603682),n=fr(n,r,i,s,t[o+13],12,-40341101),s=fr(s,n,r,i,t[o+14],17,-1502002290),i=fr(i,s,n,r,t[o+15],22,1236535329),r=mr(r,i,s,n,t[o+1],5,-165796510),n=mr(n,r,i,s,t[o+6],9,-1069501632),s=mr(s,n,r,i,t[o+11],14,643717713),i=mr(i,s,n,r,t[o],20,-373897302),r=mr(r,i,s,n,t[o+5],5,-701558691),n=mr(n,r,i,s,t[o+10],9,38016083),s=mr(s,n,r,i,t[o+15],14,-660478335),i=mr(i,s,n,r,t[o+4],20,-405537848),r=mr(r,i,s,n,t[o+9],5,568446438),n=mr(n,r,i,s,t[o+14],9,-1019803690),s=mr(s,n,r,i,t[o+3],14,-187363961),i=mr(i,s,n,r,t[o+8],20,1163531501),r=mr(r,i,s,n,t[o+13],5,-1444681467),n=mr(n,r,i,s,t[o+2],9,-51403784),s=mr(s,n,r,i,t[o+7],14,1735328473),i=mr(i,s,n,r,t[o+12],20,-1926607734),r=yr(r,i,s,n,t[o+5],4,-378558),n=yr(n,r,i,s,t[o+8],11,-2022574463),s=yr(s,n,r,i,t[o+11],16,1839030562),i=yr(i,s,n,r,t[o+14],23,-35309556),r=yr(r,i,s,n,t[o+1],4,-1530992060),n=yr(n,r,i,s,t[o+4],11,1272893353),s=yr(s,n,r,i,t[o+7],16,-155497632),i=yr(i,s,n,r,t[o+10],23,-1094730640),r=yr(r,i,s,n,t[o+13],4,681279174),n=yr(n,r,i,s,t[o],11,-358537222),s=yr(s,n,r,i,t[o+3],16,-722521979),i=yr(i,s,n,r,t[o+6],23,76029189),r=yr(r,i,s,n,t[o+9],4,-640364487),n=yr(n,r,i,s,t[o+12],11,-421815835),s=yr(s,n,r,i,t[o+15],16,530742520),i=yr(i,s,n,r,t[o+2],23,-995338651),r=gr(r,i,s,n,t[o],6,-198630844),n=gr(n,r,i,s,t[o+7],10,1126891415),s=gr(s,n,r,i,t[o+14],15,-1416354905),i=gr(i,s,n,r,t[o+5],21,-57434055),r=gr(r,i,s,n,t[o+12],6,1700485571),n=gr(n,r,i,s,t[o+3],10,-1894986606),s=gr(s,n,r,i,t[o+10],15,-1051523),i=gr(i,s,n,r,t[o+1],21,-2054922799),r=gr(r,i,s,n,t[o+8],6,1873313359),n=gr(n,r,i,s,t[o+15],10,-30611744),s=gr(s,n,r,i,t[o+6],15,-1560198380),i=gr(i,s,n,r,t[o+13],21,1309151649),r=gr(r,i,s,n,t[o+4],6,-145523070),n=gr(n,r,i,s,t[o+11],10,-1120210379),s=gr(s,n,r,i,t[o+2],15,718787259),i=gr(i,s,n,r,t[o+9],21,-343485551),r=Pa(r,l),i=Pa(i,u),s=Pa(s,d),n=Pa(n,p)}return[r,i,s,n]}function oM(t,e=tc.Hex){const r=e||tc.Base64,i=TJ(bJ(t),t.length*Id);switch(r){case tc.Raw:return i;case tc.Hex:return SJ(i);case tc.String:return _J(i);case tc.Base64:return $J(i)}}function MJ(t){return t&&"getAtOrigin"in t&&"originOf"in t}function dS(t){return aM[IJ(t)]||OJ}function IJ(t){return t.type==="json"?"application/json":t.type==="blob"?t.blob.type:EJ(t.url)}function EJ(t){const e=pR(t);return hS[e]||B5}const aM={},B5="text/plain",OJ=aM[B5],hS={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const t in hS)aM[hS[t]]=t;function kJ(t){const e=t?.origins??[void 0];return(r,i)=>{const s=CJ(t,r,i);for(const n of e){const o=TT(r,n,i);for(const l in s)o[l]=s[l]}}}function CJ(t,e,r){if(t?.type==="resource")return PJ(t,e,r);switch(t?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:i,write:s}=h7;return{read:i,write:s}}}}function PJ(t,e,r){const i=Ym(e,r);return{type:String,read:(s,n,o)=>{const l=mw(s,n,o);return i.type===String?l:typeof i.type=="function"?new i.type({url:l}):void 0},write:{isRequired:i.json?.write?.isRequired,writer(s,n,o,l){if(!l?.resources)return typeof s=="string"?void(n[o]=Mu(s,l)):void(n[o]=s.write({},l));const u=LJ(s),d=Mu(u,{...l,verifyItemRelativeUrls:l?.verifyItemRelativeUrls?{writtenUrls:l.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},1),p=i.type!==String&&(!MJ(this)||l?.origin&&this.originIdOf(r)>Co(l.origin)),f={object:this,propertyName:r,value:s,targetUrl:d,dest:n,targetPropertyName:o,context:l,params:t};l?.portalItem&&d&&!yi(d)?p&&t?.contentAddressed?pS(f):p?AJ(f):RJ(f):l?.portalItem&&(d==null||SR(d)!=null||Dh(d)||p)?pS(f):n[o]=d}}}}function pS(t){const{targetUrl:e,params:r,value:i,context:s,dest:n,targetPropertyName:o}=t;if(!s.portalItem)return;const l=$R(e),u=W5(i,e,s);if(r?.contentAddressed&&u.type!=="json")return void s.messages?.push(new x("persistable:contentAddressingUnsupported",`Property "${o}" is trying to serializing a resource with content of type ${u.type} with content addressing. Content addressing is only supported for json resources.`,{content:u}));const d=r?.contentAddressed&&u.type==="json"?oM(u.jsonString):l?.filename??ep(),p=Tu(r?.prefix??l?.prefix,d),f=`${p}.${dS(u)}`;if(r?.contentAddressed&&s.resources&&u.type==="json"){const g=s.resources.toKeep.find(({resource:v})=>v.path===f)??s.resources.toAdd.find(({resource:v})=>v.path===f);if(g)return void(n[o]=g.resource.itemRelativeUrl)}const m=s.portalItem.resourceFromPath(f);Dh(e)&&s.resources&&s.resources.pendingOperations.push(VU(e).then(g=>{m.path=`${p}.${dS({type:"blob",blob:g})}`,n[o]=m.itemRelativeUrl}).catch(()=>{}));const y=r?.compress??!1;s.resources&&H5({...t,resource:m,content:u,compress:y,updates:s.resources.toAdd}),n[o]=m.itemRelativeUrl}function AJ(t){const{context:e,targetUrl:r,params:i,value:s,dest:n,targetPropertyName:o}=t;if(!e.portalItem)return;const l=e.portalItem.resourceFromPath(r),u=W5(s,r,e),d=dS(u),p=pR(l.path),f=i?.compress??!1;d===p?(e.resources&&H5({...t,resource:l,content:u,compress:f,updates:e.resources.toUpdate}),n[o]=r):pS(t)}function RJ({context:t,targetUrl:e,dest:r,targetPropertyName:i}){t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(e),compress:!1}),r[i]=e)}function H5({object:t,propertyName:e,updates:r,resource:i,content:s,compress:n}){const o=l=>{FJ(t,e,l)};r.push({resource:i,content:s,compress:n,finish:o})}function W5(t,e,r){return typeof t=="string"?{type:"url",url:e}:{type:"json",jsonString:JSON.stringify(t.toJSON(r))}}function LJ(t){return t==null?null:typeof t=="string"?t:t.url}function FJ(t,e,r){typeof t[e]=="string"?t[e]=r.url:t[e].url=r.url}let Hg=class extends pe(F){constructor(e){super(e),this.color=null}};a([c({type:ue,json:{type:[xe],write:!0}})],Hg.prototype,"color",void 0),Hg=a([b("esri.effects.FocusAreaOutline")],Hg);const NJ=Hg;function M_e(t){const e=[];for(t.reset();t.nextPath();){const r=[];for(;t.nextPoint();)r.push([t.x,t.y]);e.push(r)}return t.reset(),e}function DJ(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}function I_e(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,r=t.hasM;if(t.type==="point")return r&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:r?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice();if(t.type==="polyline")return t.paths.slice();if(t.type==="multipoint")return t.points.map(i=>[i]);if(t.type==="extent"){const i=t.clone().normalize();if(!i)return null;let s=!1,n=!1;return i.forEach(o=>{o.hasZ&&(s=!0),o.hasM&&(n=!0)}),i.map(o=>{const l=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(s&&o.hasZ){const u=.5*(o.zmax-o.zmin);for(let d=0;d<l.length;d++)l[d].push(u)}if(n&&o.hasM){const u=.5*(o.mmax-o.mmin);for(let d=0;d<l.length;d++)l[d].push(u)}return l})}return null}function jw(t,e){const r=e[0]-t[0],i=e[1]-t[1];if(t.length>2&&e.length>2){const s=t[2]-e[2];return Math.sqrt(r*r+i*i+s*s)}return Math.sqrt(r*r+i*i)}function Z5(t,e,r){const i=t[0]+r*(e[0]-t[0]),s=t[1]+r*(e[1]-t[1]);return t.length>2&&e.length>2?[i,s,t[2]+r*(e[2]-t[2])]:[i,s]}function jJ(t,e,r,i){return VJ(t,e,r[i],r[i+1])}function VJ(t,e,r,i){const[s,n]=e,[o,l]=r,[u,d]=i,p=u-o,f=d-l,m=p*p+f*f,y=(s-o)*p+(n-l)*f,g=Math.min(1,Math.max(0,y/m));return t[0]=o+p*g,t[1]=l+f*g,t}function E_e(t,e,r,i,s,n){let o=r,l=i,u=s-o,d=n-l;if(u!==0||d!==0){const p=((t-o)*u+(e-l)*d)/(u*u+d*d);p>1?(o=s,l=n):p>0&&(o+=u*p,l+=d*p)}return u=t-o,d=e-l,u*u+d*d}function J5(t,e){return Z5(t,e,.5)}function O_e(t){const e=t.length;let r=0;for(let i=0;i<e-1;++i)r+=jw(t[i],t[i+1]);return r}function k_e(t,e){if(e<=0)return t[0];const r=t.length;let i=0;for(let s=0;s<r-1;++s){const n=jw(t[s],t[s+1]);if(e-i<n){const o=(e-i)/n;return Z5(t[s],t[s+1],o)}i+=n}return t[r-1]}function Y5(t,e=0,r=1){let i=0;const s=t.length;let n=t[0];for(let o=1;o<s;o++){const l=t[o];i+=(l[e]-n[e])*(l[r]+n[r]),n=l}if(K5(t)){const o=t[0];i+=(o[e]-n[e])*(o[r]+n[r])}return i>=0}function K5(t){const e=t.length;return e>0&&!uw(t[0],t[e-1])}function C_e(t){"rings"in t&&(zJ(t),UJ(t))}function zJ(t){if("rings"in t)for(const e of t.rings)K5(e)&&e.push(e[0].slice())}function UJ(t){if(!("rings"in t)||t.rings.length===0||Y5(t.rings[0]))return!1;for(const e of t.rings)e.reverse();return!0}function P_e(t){return t.type!=="polygon"&&t.type!=="polyline"||qJ(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function qJ(t,e){const r=Yr(e);if(!r)return;const i=r.valid[0],s=r.valid[1],n=s-i;for(const o of t){let l=1/0,u=-1/0;for(const p of o){const f=GJ(p[0],i,s);l=Math.min(l,f),u=Math.max(u,f),p[0]=f}const d=u-l;n-d<d&&o.forEach(p=>{p[0]<0&&(p[0]+=n)})}}function GJ(t,e,r){const i=r-e;return t<e?r-(e-t)%i:t>r?e+(t-e)%i:t}function A_e(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[r,i]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return r.length===i.length&&r.every((s,n)=>s.length===i[n].length)}function R_e(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function BJ(t){return HJ(t.rings,t.hasZ??!1)}function Q5(t){const e=BJ(t);if(!e)return null;const{hasZ:r,spatialReference:i}=t,[s,n,o]=e;return isNaN(s)||isNaN(n)||r&&isNaN(o)?null:{x:s,y:n,z:r?o:void 0,spatialReference:i}}function HJ(t,e){if(!t?.length)return null;const r=[],i=[],s=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let n=0,o=t.length;n<o;n++){const l=X5(t[n],e,s);l&&i.push(l)}if(i.sort((n,o)=>{let l=n[2]-o[2];return l===0&&e&&(l=n[4]-o[4]),l}),i.length&&(r[0]=i[0][0],r[1]=i[0][1],e&&(r[2]=i[0][3]),(r[0]<s[0]||r[0]>s[1]||r[1]<s[2]||r[1]>s[3]||e&&(r[2]<s[4]||r[2]>s[5]))&&(r.length=0)),!r.length){const n=t[0]&&t[0].length?WJ(t[0],e):null;if(!n)return null;r[0]=n[0],r[1]=n[1],e&&n.length>2&&(r[2]=n[2])}return r}function X5(t,e,r){let i=0,s=0,n=0,o=0,l=0;const u=t.length?t[0][0]:0,d=t.length?t[0][1]:0,p=t.length&&e?t[0][2]:0;for(let m=0;m<t.length;m++){const y=t[m],g=t[(m+1)%t.length],[v,_,S]=y,M=v-u,C=_-d,[T,O,P]=g,D=T-u,z=O-d,B=M*z-D*C;if(o+=B,i+=(M+D)*B,s+=(C+z)*B,e&&y.length>2&&g.length>2){const G=S-p,Q=P-p,oe=M*Q-D*G;n+=(G+Q)*oe,l+=oe}v<r[0]&&(r[0]=v),v>r[1]&&(r[1]=v),_<r[2]&&(r[2]=_),_>r[3]&&(r[3]=_),e&&(S<r[4]&&(r[4]=S),S>r[5]&&(r[5]=S))}if(o>0&&(o*=-1),l>0&&(l*=-1),!o)return null;o*=.5,l*=.5;const f=[i/(6*o)+u,s/(6*o)+d,o];return e&&(r[4]===r[5]||l===0?(f[3]=(r[4]+r[5])/2,f[4]=0):(f[3]=n/(6*l)+p,f[4]=l)),f}function L_e(t,e){let r=0,i=0,s=0;t.nextPoint();const n=t.pathSize?t.x:0,o=t.pathSize?t.y:0;for(let l=0;l<t.pathSize;l++){t.seekInPath(l);const u=[t.x,t.y];t.seekInPath((l+1)%t.pathSize);const d=[t.x,t.y],[p,f]=u,m=p-n,y=f-o,[g,v]=d,_=g-n,S=v-o,M=m*S-_*y;s+=M,r+=(m+_)*M,i+=(y+S)*M,p<e[0]&&(e[0]=p),p>e[1]&&(e[1]=p),f<e[2]&&(e[2]=f),f>e[3]&&(e[3]=f)}return s>0&&(s*=-1),s?(s*=.5,[r/(6*s)+n,i/(6*s)+o,s]):null}function WJ(t,e){const r=e?[0,0,0]:[0,0],i=e?[0,0,0]:[0,0];let s=0,n=0,o=0,l=0;for(let u=0,d=t.length;u<d-1;u++){const p=t[u],f=t[u+1];if(p&&f){r[0]=p[0],r[1]=p[1],i[0]=f[0],i[1]=f[1],e&&p.length>2&&f.length>2&&(r[2]=p[2],i[2]=f[2]);const m=jw(r,i);if(m){s+=m;const y=J5(p,f);n+=m*y[0],o+=m*y[1],e&&y.length>2&&(l+=m*y[2])}}}return s>0?e?[n/s,o/s,l/s]:[n/s,o/s]:t.length?t[0]:null}function ZJ(t){const{hasZ:e,totalSize:r}=t;if(r===0)return null;const i=[],s=[],n=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const o=X5(DJ(t),t.hasZ,n);o&&s.push(o)}if(s.sort((o,l)=>{let u=o[2]-l[2];return u===0&&e&&(u=o[4]-l[4]),u}),s.length&&(i[0]=s[0][0],i[1]=s[0][1],e&&(i[2]=s[0][3]),(i[0]<n[0]||i[0]>n[1]||i[1]<n[2]||i[1]>n[3]||e&&(i[2]<n[4]||i[2]>n[5]))&&(i.length=0)),!i.length){t.reset(),t.nextPath();const o=t.pathSize?JJ(t):null;if(!o)return null;i[0]=o[0],i[1]=o[1],e&&o.length>2&&(i[2]=o[2])}return i}function JJ(t){const{hasZ:e}=t,r=e?[0,0,0]:[0,0],i=e?[0,0,0]:[0,0];let s=0,n=0,o=0,l=0;if(t.nextPoint()){let u=t.x,d=t.y,p=t.z;for(;t.nextPoint();){const f=t.x,m=t.y,y=t.z;r[0]=u,r[1]=d,i[0]=f,i[1]=m,e&&(r[2]=p,i[2]=y);const g=jw(r,i);if(g){s+=g;const v=J5(r,i);n+=g*v[0],o+=g*v[1],e&&v.length>2&&(l+=g*v[2])}u=f,d=m,p=y}}return s>0?e?[n/s,o/s,l/s]:[n/s,o/s]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const YJ=1e-6;function F_e(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<YJ){const s=ZJ(t);return s?[s[0],s[1]]:null}const r=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const i=[t.x,t.y];for(t.reset();t.nextPath();)QJ(r,i,t);return r[0]*=1/e,r[1]*=1/e,r[0]+=i[0],r[1]+=i[1],r}const KJ=1/3;function QJ(t,e,r){if(!t||!r||r.pathSize<3)return null;r.nextPoint();const i=r.x,s=r.y;r.nextPoint();let n,o=r.x-i,l=r.y-s,u=0,d=0;for(;r.nextPoint();)u=r.x-i,d=r.y-s,n=.5*KJ*(u*l-d*o),t[0]+=n*(o+u),t[1]+=n*(l+d),o=u,l=d;const p=r.getCurrentRingArea(),f=[i,s];return f[0]-=e[0],f[1]-=e[1],f[0]*=p,f[1]*=p,t[0]+=f[0],t[1]+=f[1],t}function mi(t=sY){return[t[0],t[1],t[2],t[3]]}function eN(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function XJ(t,e,r,i,s=mi()){return s[0]=t,s[1]=e,s[2]=r,s[3]=i,s}function N_e(t,e=mi()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function eY(t,e,r=new he){return r.xmin=t[0],r.ymin=t[1],r.xmax=t[2],r.ymax=t[3],r.spatialReference=e,r}function ls(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function tY(t,e){e<t[0]&&(t[0]=e),e>t[2]&&(t[2]=e)}function rY(t,e){e<t[1]&&(t[1]=e),e>t[3]&&(t[3]=e)}function D_e(t,e,r){if(e!=null)if("length"in e)mS(e)?(r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r[2]=Math.max(t[2],e[2]),r[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r[2]=Math.max(t[2],e[0]),r[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":r[0]=Math.min(t[0],e.xmin),r[1]=Math.min(t[1],e.ymin),r[2]=Math.max(t[2],e.xmax),r[3]=Math.max(t[3],e.ymax);break;case"point":r[0]=Math.min(t[0],e.x),r[1]=Math.min(t[1],e.y),r[2]=Math.max(t[2],e.x),r[3]=Math.max(t[3],e.y)}else eN(r,t)}function j_e(t,e,r=t){const i=e.length;let s=t[0],n=t[1],o=t[2],l=t[3];for(let u=0;u<i;u++){const d=e[u];s=Math.min(s,d[0]),n=Math.min(n,d[1]),o=Math.max(o,d[0]),l=Math.max(l,d[1])}return r[0]=s,r[1]=n,r[2]=o,r[3]=l,r}function V_e(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function lM(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function uM(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function z_e(t){return lM(t)*uM(t)}function U_e(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function q_e(t){const e=lM(t),r=uM(t);return Math.sqrt(e*e+r*r)}function G_e(t,e){return!!t&&fS(t,e.x,e.y)}function fS(t,e,r){return e>=t[0]&&r>=t[1]&&e<=t[2]&&r<=t[3]}function B_e(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function H_e(t,e,r){return Math.max(e[0],t[0])-r<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])-r<=Math.min(e[3],t[3])}function iY(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function W_e(t,e,r,i){return i??=t,i[0]=t[0]+e,i[1]=t[1]+r,i[2]=t[2]+e,i[3]=t[3]+r,i}function Z_e(t){return t?eN(t,JE):mi(JE)}function mS(t){return t!=null&&t.length===4}function J_e(t,e){return mS(t)&&mS(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const JE=[1/0,1/0,-1/0,-1/0],sY=[0,0,0,0];let cM=1e-6;function Kr(){return cM}function nY(t){cM=t}const Vw=Math.random,oY=Math.PI/180,aY=180/Math.PI;function dM(t){return t*oY}function lY(t){return t*aY}function uY(t,e){return Math.abs(t-e)<=cM*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:Vw,equals:uY,getEpsilon:Kr,setEpsilon:nY,toDegree:lY,toRadian:dM},Symbol.toStringTag,{value:"Module"}));function Ed(t,e){return t[0]=e[0],t[1]=e[1],t}function ir(t,e,r){return t[0]=e,t[1]=r,t}function tN(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function Sm(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function rN(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function iN(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function cY(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function dY(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function hY(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function pY(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function fY(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function oy(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function mY(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t}function zw(t,e){const r=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(r*r+i*i)}function $m(t,e){const r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i}function Cv(t){const e=t[0],r=t[1];return Math.sqrt(e*e+r*r)}function sN(t){const e=t[0],r=t[1];return e*e+r*r}function nN(t,e){return t[0]=-e[0],t[1]=-e[1],t}function yY(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function yS(t,e){const r=e[0],i=e[1];let s=r*r+i*i;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s),t}function oN(t,e){return t[0]*e[0]+t[1]*e[1]}function aN(t,e,r){const i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t}function gY(t,e,r,i){const s=e[0],n=e[1];return t[0]=s+i*(r[0]-s),t[1]=n+i*(r[1]-n),t}function vY(t,e=1){const r=2*Vw()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function wY(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[2]*s,t[1]=r[1]*i+r[3]*s,t}function In(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[2]*s+r[4],t[1]=r[1]*i+r[3]*s+r[5],t}function Wg(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[3]*s+r[6],t[1]=r[1]*i+r[4]*s+r[7],t}function bY(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[4]*s+r[12],t[1]=r[1]*i+r[5]*s+r[13],t}function _Y(t,e,r,i){const s=e[0]-r[0],n=e[1]-r[1],o=Math.sin(i),l=Math.cos(i);return t[0]=s*l-n*o+r[0],t[1]=s*o+n*l+r[1],t}function SY(t,e){const r=t[0],i=t[1],s=e[0],n=e[1];let o=r*r+i*i;o>0&&(o=1/Math.sqrt(o));let l=s*s+n*n;l>0&&(l=1/Math.sqrt(l));const u=(r*s+i*n)*o*l;return u>1?0:u<-1?Math.PI:Math.acos(u)}function $Y(t){return"vec2("+t[0]+", "+t[1]+")"}function xY(t,e){return t[0]===e[0]&&t[1]===e[1]}function TY(t,e){const r=t[0],i=t[1],s=e[0],n=e[1],o=Kr();return Math.abs(r-s)<=o*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-n)<=o*Math.max(1,Math.abs(i),Math.abs(n))}function MY(t,e,r,i,s){let n=e[0]-r[0],o=e[1]-r[1];const l=(i[0]*n+i[1]*o)*(s-1);return n=i[0]*l,o=i[1]*l,t[0]=e[0]+n,t[1]=e[1]+o,t}const IY=Cv,hM=Sm,EY=rN,OY=iN,kY=zw,CY=$m,PY=sN;Object.freeze(Object.defineProperty({__proto__:null,add:tN,angle:SY,ceil:cY,copy:Ed,cross:aN,dist:kY,distance:zw,div:OY,divide:iN,dot:oN,equals:TY,exactEquals:xY,floor:dY,inverse:yY,len:IY,length:Cv,lerp:gY,max:pY,min:hY,mul:EY,multiply:rN,negate:nN,normalize:yS,projectAndScale:MY,random:vY,rotate:_Y,round:fY,scale:oy,scaleAndAdd:mY,set:ir,sqrDist:CY,sqrLen:PY,squaredDistance:$m,squaredLength:sN,str:$Y,sub:hM,subtract:Sm,transformMat2:wY,transformMat2d:In,transformMat3:Wg,transformMat4:bY},Symbol.toStringTag,{value:"Module"}));function xo(t,e,r,i){return t[0]=e[0]*(1-i)+r[0]*i,t[1]=e[1]*(1-i)+r[1]*i,t}function Jr(t,e){return $m(t,e)}function Y_e(t,e,r){const i=Jr(e,r);if(i===0)return Jr(e,t);const s=(e[0]-t[0])*(r[1]-t[1])-(e[1]-t[1])*(r[0]-t[0]);return s*s/i}function AY(t,e,r,i,s){const[n,o]=e,[l,u]=r,[d,p]=i,[f,m]=s,y=(n-l)*(p-m)-(o-u)*(d-f);if(y===0)return null;const g=(n*u-o*l)*(d-f)-(n-l)*(d*m-p*f),v=(n*u-o*l)*(p-m)-(o-u)*(d*m-p*f);return t[0]=g/y,t[1]=v/y,t}const Qs=2*Math.PI;function fu(t,e){const r=Math.atan2(t,e);return r<0?r+Qs:r}function lN(t){return Math.abs(t)%Qs}function YE(t){const e=lN(t);return e<Math.PI?e:Qs-e}function Uw(t,e){return{min:Math.min(t,e),max:Math.max(t,e)}}function uN(t,e,r,i){if(zi(lN(t-e),0))return r?[t,t]:[t,i?t-Qs:t+Qs];const[s,n]=i?[t-Qs,t]:[t,t+Qs];return[t,ay({min:s,max:n},e)]}function ay({min:t,max:e},r){let i;return i=e-r,i>=Qs?(i-=i%Qs,r+i):(i=r-t,i>=Qs?(i-=i%Qs,r-i):r)}function RY(t,e){const r=ay(t,e);return r>t.min&&r<t.max?r:YE(r-t.min)<YE(r-t.max)?t.min:t.max}function cN(t,e,r,i=10){return e.map(s=>{let n=s;for(let o=0;o<i;o++){const[l,u,d,p,f,m]=r(n),y=t[0]-l,g=t[1]-u,v=-d,_=-p;n+=-(2*y*v+2*g*_)/(2*v*v+2*y*-f+2*_*_+2*g*-m||1e-6)}return n})}const LY=[0,0];function dN(t){const e=1-t,r=e*e,i=t*t;return[r*e,3*t*r,3*i*e,i*t]}function gS(t,e,r,i,s){const[n,o,l,u]=dN(s);return[t[0]*n+e[0]*o+r[0]*l+i[0]*u,t[1]*n+e[1]*o+r[1]*l+i[1]*u]}function KE(t,e,r,i,s){const[n,o,l,u]=dN(s);return t*n+e*o+r*l+i*u}function K_e(t,e,r){const i=t,[s,n,o]=e.b;return gS(i,n,o,s,r)}function FY(t,e,r){const i=t,[s,n,o]=e.b,l=xo([0,0],i,n,r),u=xo(LY,n,o,r),d=xo([0,0],o,s,r),p=xo([0,0],l,u,r),f=xo([0,0],u,d,r);return[{b:[xo([],p,f,r),l,p]},{b:[[...s],f,d]}]}function Q_e(t,e,r){const i=t,[s,n,o]=e.b,l=cN(r,[.1,.5,.9],f=>{const m=1-f,[y,g]=gS(i,n,o,s,f);return[y,g,3*m*m*(n[0]-i[0])+6*m*f*(o[0]-n[0])+3*f*f*(s[0]-o[0]),3*m*m*(n[1]-i[1])+6*m*f*(o[1]-n[1])+3*f*f*(s[1]-o[1]),6*m*(o[0]-2*n[0]+i[0])+6*f*(s[0]-2*o[0]+n[0]),6*m*(o[1]-2*n[1]+i[1])+6*f*(s[1]-2*o[1]+n[1])]}).map(f=>Math.min(1,Math.max(0,f)));l.push(0,1);let u=1/0;const d=l.map(f=>{const m=gS(i,n,o,s,f),[y,g]=m,v=r[0]-y,_=r[1]-g,S=Math.sqrt(v*v+_*_);return u=Math.min(S,u),{t:f,curvePoint:m,distance:S}}),p=[];for(const f of d){const{t:m,distance:y}=f;z5(y,u)&&!p.some(({t:g})=>zi(g,m))&&p.push(f)}return p}function NY(t,e,r){const i=e,[s,n,o]=r.b;if(ls(t,i),ls(t,s),fS(t,n[0],n[1])&&fS(t,o[0],o[1]))return t;for(const l of QE(i[0],n[0],o[0],s[0]))l>0&&l<1&&tY(t,KE(i[0],n[0],o[0],s[0],l));for(const l of QE(i[1],n[1],o[1],s[1]))l>0&&l<1&&rY(t,KE(i[1],n[1],o[1],s[1],l));return t}function QE(t,e,r,i){const s=3*(3*(e-r)-t+i),n=6*(t-2*e+r),o=3*(e-t);if(s===0)return n!==0?[-o/n]:[];const l=Math.sqrt(n*n-4*s*o);return[(-n+l)/(2*s),(-n-l)/(2*s)]}function X_e(t,e,r){let s=0,n=[e];for(let o=0;o<16;o++){let l=t;const u=[];for(const p of n)u.push(...FY(l,p,.5)),l=p.b[0];n=u,l=t,s=0;let d=0;for(const p of n){const[f,m,y]=p.b,g=Math.sqrt(Jr(l,f));s+=(g+(Math.sqrt(Jr(l,m))+Math.sqrt(Jr(m,y))+Math.sqrt(Jr(y,f))))/2,d+=g,l=f}if(s-d<r)return s}return s}function DY(t,e,r){const[i,s]=t,[n,o]=e,[l,u]=r,[d,p]=[n-i,o-s];let f=d*(l-i)+p*(u-s);f/=d**2+p**2,f=Gi(f,0,1);const m=xo([0,0],t,e,f);return{t:f,curvePoint:m,distance:Math.sqrt(Jr(m,r))}}let hN=class{constructor(e,r,i,s,n,o){this.cx=e,this.cy=r,this.radius=i,this.thetaStart=s,this.thetaEnd=n,this.isInvalid=o}get startPoint(){const{cx:e,cy:r,radius:i,thetaStart:s}=this;return[e+i*Math.cos(s),r+i*Math.sin(s)]}get endPoint(){const{cx:e,cy:r,radius:i,thetaEnd:s}=this;return[e+i*Math.cos(s),r+i*Math.sin(s)]}};function Pv(t,e){const{cx:r,cy:i,radius:s}=t;return[r+s*Math.cos(e),i+s*Math.sin(e)]}function Zg(t,e){if(t.isInvalid)return xo([0,0],t.startPoint,t.endPoint,e);const{thetaStart:r,thetaEnd:i}=t;return Pv(t,r*(1-e)+i*e)}function tSe(t,e){if(t.isInvalid)return DY(t.startPoint,t.endPoint,e);const{cx:r,cy:i,thetaStart:s,thetaEnd:n}=t,[o,l]=e,u=RY(Uw(s,n),Math.atan2(l-i,o-r)),d=Pv(t,u);return{t:(u-s)/(n-s),curvePoint:d,distance:Math.sqrt(Jr(e,d))}}function XE(t,e){if(e.isInvalid)return ls(t,e.startPoint),ls(t,e.endPoint),t;const{cx:r,cy:i,radius:s,thetaStart:n,thetaEnd:o}=e;ls(t,Pv(e,n)),ls(t,Pv(e,o));const l=Uw(n,o),u=Math.PI/2;let d=0;for(const p of[[r+s,i],[r,i+s],[r-s,i],[r,i-s]])d=ay(l,d),d>l.min&&d<l.max&&ls(t,p),d+=u;return t}function rSe(t){if(t.isInvalid)return 2*t.radius;const{radius:e,thetaStart:r,thetaEnd:i}=t;return e*Math.abs(i-r)}function jY(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function VY(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Od(t,e,r,i,s,n,o,l,u,d){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=n,t[5]=o,t[6]=l,t[7]=u,t[8]=d,t}function pN(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function fN(t,e){if(t===e){const r=e[1],i=e[2],s=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=i,t[7]=s}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function mN(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],l=e[5],u=e[6],d=e[7],p=e[8],f=p*o-l*d,m=-p*n+l*u,y=d*n-o*u;let g=r*f+i*m+s*y;return g?(g=1/g,t[0]=f*g,t[1]=(-p*i+s*d)*g,t[2]=(l*i-s*o)*g,t[3]=m*g,t[4]=(p*r-s*u)*g,t[5]=(-l*r+s*n)*g,t[6]=y*g,t[7]=(-d*r+i*u)*g,t[8]=(o*r-i*n)*g,t):null}function zY(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],l=e[5],u=e[6],d=e[7],p=e[8];return t[0]=o*p-l*d,t[1]=s*d-i*p,t[2]=i*l-s*o,t[3]=l*u-n*p,t[4]=r*p-s*u,t[5]=s*n-r*l,t[6]=n*d-o*u,t[7]=i*u-r*d,t[8]=r*o-i*n,t}function Jg(t){const e=t[0],r=t[1],i=t[2],s=t[3],n=t[4],o=t[5],l=t[6],u=t[7],d=t[8];return e*(d*n-o*u)+r*(-d*s+o*l)+i*(u*s-n*l)}function xm(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=e[6],p=e[7],f=e[8],m=r[0],y=r[1],g=r[2],v=r[3],_=r[4],S=r[5],M=r[6],C=r[7],T=r[8];return t[0]=m*i+y*o+g*d,t[1]=m*s+y*l+g*p,t[2]=m*n+y*u+g*f,t[3]=v*i+_*o+S*d,t[4]=v*s+_*l+S*p,t[5]=v*n+_*u+S*f,t[6]=M*i+C*o+T*d,t[7]=M*s+C*l+T*p,t[8]=M*n+C*u+T*f,t}function vS(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=e[6],p=e[7],f=e[8],m=r[0],y=r[1];return t[0]=i,t[1]=s,t[2]=n,t[3]=o,t[4]=l,t[5]=u,t[6]=m*i+y*o+d,t[7]=m*s+y*l+p,t[8]=m*n+y*u+f,t}function yN(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=e[6],p=e[7],f=e[8],m=Math.sin(r),y=Math.cos(r);return t[0]=y*i+m*o,t[1]=y*s+m*l,t[2]=y*n+m*u,t[3]=y*o-m*i,t[4]=y*l-m*s,t[5]=y*u-m*n,t[6]=d,t[7]=p,t[8]=f,t}function UY(t,e,r){const i=r[0],s=r[1],n=r[2];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=n*e[6],t[7]=n*e[7],t[8]=n*e[8],t}function qY(t,e,r){const i=r[0],s=r[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t}function GY(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function BY(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=-r,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function HY(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function WY(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function ZY(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=r+r,l=i+i,u=s+s,d=r*o,p=i*o,f=i*l,m=s*o,y=s*l,g=s*u,v=n*o,_=n*l,S=n*u;return t[0]=1-f-g,t[3]=p-S,t[6]=m+_,t[1]=p+S,t[4]=1-d-g,t[7]=y-v,t[2]=m-_,t[5]=y+v,t[8]=1-d-f,t}function JY(t,e){const r=e[0],i=e[1],s=e[2],n=e[4],o=e[5],l=e[6],u=e[8],d=e[9],p=e[10],f=p*o-l*d,m=-p*n+l*u,y=d*n-o*u,g=r*f+i*m+s*y;if(!g)return null;const v=1/g;return t[0]=f*v,t[1]=(-p*i+s*d)*v,t[2]=(l*i-s*o)*v,t[3]=m*v,t[4]=(p*r-s*u)*v,t[5]=(-l*r+s*n)*v,t[6]=y*v,t[7]=(-d*r+i*u)*v,t[8]=(o*r-i*n)*v,t}function YY(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],l=e[5],u=e[6],d=e[7],p=e[8],f=e[9],m=e[10],y=e[11],g=e[12],v=e[13],_=e[14],S=e[15],M=r*l-i*o,C=r*u-s*o,T=r*d-n*o,O=i*u-s*l,P=i*d-n*l,D=s*d-n*u,z=p*v-f*g,B=p*_-m*g,G=p*S-y*g,Q=f*_-m*v,oe=f*S-y*v,Pe=m*S-y*_;let fe=M*Pe-C*oe+T*Q+O*G-P*B+D*z;return fe?(fe=1/fe,t[0]=(l*Pe-u*oe+d*Q)*fe,t[1]=(u*G-o*Pe-d*B)*fe,t[2]=(o*oe-l*G+d*z)*fe,t[3]=(s*oe-i*Pe-n*Q)*fe,t[4]=(r*Pe-s*G+n*B)*fe,t[5]=(i*G-r*oe-n*z)*fe,t[6]=(v*D-_*P+S*O)*fe,t[7]=(_*T-g*D-S*C)*fe,t[8]=(g*P-v*T+S*M)*fe,t):null}function KY(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function QY(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function XY(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function eK(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function gN(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function tK(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function rK(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t}function iK(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function sK(t,e){const r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],l=t[5],u=t[6],d=t[7],p=t[8],f=e[0],m=e[1],y=e[2],g=e[3],v=e[4],_=e[5],S=e[6],M=e[7],C=e[8],T=Kr();return Math.abs(r-f)<=T*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-m)<=T*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-y)<=T*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(n-g)<=T*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(o-v)<=T*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(l-_)<=T*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(u-S)<=T*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(d-M)<=T*Math.max(1,Math.abs(d),Math.abs(M))&&Math.abs(p-C)<=T*Math.max(1,Math.abs(p),Math.abs(C))}function nK(t){const e=Kr(),r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],l=t[5],u=t[6],d=t[7],p=t[8];return Math.abs(1-(r*r+n*n+u*u))<=e&&Math.abs(1-(i*i+o*o+d*d))<=e&&Math.abs(1-(s*s+l*l+p*p))<=e}const oK=xm,aK=gN;Object.freeze(Object.defineProperty({__proto__:null,add:eK,adjoint:zY,copy:VY,determinant:Jg,equals:sK,exactEquals:iK,frob:XY,fromMat2d:WY,fromMat4:jY,fromQuat:ZY,fromRotation:BY,fromScaling:HY,fromTranslation:GY,identity:pN,invert:mN,isOrthoNormal:nK,mul:oK,multiply:xm,multiplyScalar:tK,multiplyScalarAndAdd:rK,normalFromMat4:YY,normalFromMat4Legacy:JY,projection:KY,rotate:yN,scale:UY,scaleByVec2:qY,set:Od,str:QY,sub:aK,subtract:gN,translate:vS,transpose:fN},Symbol.toStringTag,{value:"Module"}));function Wu(){return[1,0,0,0,1,0,0,0,1]}function lK(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function uK(t,e,r,i,s,n,o,l,u){return[t,e,r,i,s,n,o,l,u]}const cK=Wu();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:cK,clone:lK,create:Wu,fromValues:uK},Symbol.toStringTag,{value:"Module"}));const rc=Wu();function dK(t,e,r){const[i,s]=t,[n,o]=e,[l,u]=r;Od(rc,i,n,l,s,o,u,1,1,1);const d=Jg(rc),p=4*d/(Jr(t,e)+Jr(e,r)+Jr(r,t));if(!isFinite(p)||Math.abs(p)<1e-8)return null;const f=i**2+s**2,m=n**2+o**2,y=l**2+u**2;Od(rc,f,m,y,s,o,u,1,1,1);const g=Jg(rc);return Od(rc,f,m,y,i,n,l,1,1,1),[g/d*.5,Jg(rc)/d*-.5]}function vN(t,e){const[r,i]=e.c,s=dK(t,i,r),n=s==null,o=s??xo([],t,r,.5),[l,u]=t,[d,p]=i,[f,m]=r,[y,g]=o,v=l-y,_=u-g,S=Math.sqrt(v*v+_*_),M=fu(u-g,l-y),C=fu(p-g,d-y);let T=fu(m-g,f-y);return(C-M)*(T-C)<0&&(T+=2*Math.sign(M-T)*Math.PI),new hN(y,g,S,M,T,n)}function iSe(t,e,r){const i=Zg(t,r/2),s=Zg(t,r),n=Zg(t,(r+1)/2);return[{c:[s,i]},{c:[[...e.c[0]],n]}]}function sSe(t,e){const[r]=e.c,{cx:i,cy:s,thetaStart:n,thetaEnd:o,radius:l,isInvalid:u}=vN(t,e);return{a:[r,[i,s],Math.abs(o-n)<Math.PI?1:0,n>o?1:0,u?n:0,l,u?0:1]}}function nSe(t){return"curveRings"in t&&!!t.curveRings?.length||"curvePaths"in t&&!!t.curvePaths?.length}function oSe(t){return"curveRings"in t?t.curveRings:t.curvePaths}function pM(t){return"b"in t}function fM(t){return"c"in t}function qw(t){return Array.isArray(t)}function aSe(t){return"a"in t}function wN(t){return"a"in t&&t.a.length===4}function hK(t){return"a"in t&&t.a.length===7}function i1(t){return qw(t)?t:pM(t)?t.b[0]:fM(t)?t.c[0]:t.a[0]}function pK(t){if(pM(t)){const[e,r,i]=t.b;return{b:[[...e],[...r],[...i]]}}if(fM(t)){const[e,r]=t.c;return{c:[[...e],[...r]]}}if(qw(t))return[...t];if(wN(t)){const[e,r,i,s]=t.a;return{a:[[...e],[...r],i,s]}}if(hK(t)){const[e,r,i,s,n,o,l]=t.a;return{a:[[...e],[...r],i,s,n,o,l]}}return t}function fK(t,e){const[r,i,s,n]=e.a,[o,l]=t,[u,d]=r,[p,f]=i,m=o-p,y=l-f,g=Math.sqrt(m*m+y*y),v=u-p,_=d-f,S=Math.sqrt(v*v+_*_),M=g===0||S===0||!z5(g,S),C=g,[T,O]=uN(fu(l-f,o-p),Math.atan2(d-f,u-p),s,n);return new hN(p,f,C,T,O,M)}function lSe(t,e,r){const{cx:i,cy:s,thetaStart:n,thetaEnd:o}=t,[l,u,d,p]=e.a,f=n*(1-r)+o*r;return[{a:[Zg(t,r),[i,s],Math.abs(f-n)<Math.PI?1:0,p]},{a:[[...l],[i,s],Math.abs(o-f)<Math.PI?1:0,p]}]}let mK=class{constructor(e,r,i,s,n,o,l,u,d){this.cx=e,this.cy=r,this.a=i,this.b=s,this.cosR=n,this.sinR=o,this.u1=l,this.u2=u,this.isInvalid=d}};function mM(t,e){const[r,i,s,n,o,l,u]=e.a,[d,p]=t,[f,m]=r,[y,g]=i,v=l*u,_=Math.cos(o),S=Math.sin(o),[M,C]=uN(fu(1/v*(p-g)*_-1/v*(d-y)*S,1/l*(p-g)*S+1/l*(d-y)*_),Math.atan2(1/v*(m-g)*_-1/v*(f-y)*S,1/l*(m-g)*S+1/l*(f-y)*_),s,n);return new mK(y,g,l,v,_,S,M,C,l===0||v===0)}function Tm(t,e){const{a:r,b:i,cosR:s,sinR:n,cx:o,cy:l}=t,u=Math.cos(e),d=Math.sin(e);return[r*u*s-i*d*n+o,r*u*n+i*d*s+l]}function Sc(t,e){const{u1:r,u2:i}=t;return Tm(t,r*(1-e)+i*e)}function cSe(t,e,r){if(r<0||r>1)return[];if(r===0||r===1)return[pK(e)];const[i,[s,n],o,l,u,d,p]=e.a,{u1:f,u2:m}=t,y=f*(1-r)+m*r;return[{a:[[...Sc(t,r)],[s,n],Math.abs(y-f)<Math.PI?1:0,l,u,d,p]},{a:[[...i],[s,n],Math.abs(m-y)<Math.PI?1:0,l,u,d,p]}]}function dSe(t,e){const{a:r,b:i,cosR:s,sinR:n,u1:o,u2:l}=t,u=Math.PI/6,d=cN(e,[1*u,2*u,4*u,5*u,7*u,8*u,10*u,11*u],v=>{const _=Math.cos(v),S=Math.sin(v),[M,C]=Tm(t,v);return[M,C,-r*s*S-i*n*_,-r*n*S+i*s*_,-r*s*_+i*n*S,-r*n*_-i*s*S]}),p=Uw(o,l),f=new Set(d.map(v=>ay(p,v)).filter(v=>v>p.min&&v<p.max));f.add(o),f.add(l);let m,y,g=1/0;for(const v of f){const _=Tm(t,v),[S,M]=_,C=e[0]-S,T=e[1]-M,O=C*C+T*T;O<g&&(m=(v-o)/(l-o),y=_,g=O)}return{t:m,curvePoint:y,distance:Math.sqrt(g)}}function yK(t,e,r){const i=mM(e,r),{a:s,b:n,u1:o,u2:l,cosR:u,sinR:d,isInvalid:p}=i,f=r.a[0];if(ls(t,e),ls(t,f),p)return t;const m=Math.atan2(-n*d,s*u),y=m+Math.PI,g=Math.atan2(n*u,s*d),v=g+Math.PI,_=Uw(o,l);for(const S of[m,y,g,v].map(M=>ay(_,M)))S>_.min&&S<_.max&&ls(t,Tm(i,S));return t}function hSe(t,e,r){const[i,s,n,o,l,u,d]=e.a,p=mM(t,e),{u1:f,u2:m,isInvalid:y}=p,g=m-f;if(y)return Math.sqrt(Jr(t,i));const v=14,_=[0,0];let S=0,M=[Sc(p,0),Sc(p,.25),Sc(p,.5),Sc(p,.75),Sc(p,1)];for(let C=0;C<v;C++){const T=M.length-1,O=g/(2*T),P=[];for(let z=0;z<T;z++)P.push(M[z]),P.push(Tm(p,f+(2*z+1)*O));P.push(M[M.length-1]),M=P,S=0;let D=0;for(let z=1;z<M.length;z++){const B=M[z-1],G=M[z];if(S+=Math.sqrt(Jr(B,G)),z>1){const Q=M[z-2],oe=AY(_,Q,B,s,G);D+=oe?Math.sqrt(Jr(B,oe)):Math.abs(G[0]-B[0])+Math.abs(G[1]-B[1])}else D+=S}if(D-S<r)return S}return S}const eO=Wu(),jy=Wu(),tO=Wu(),ta=Wu();function pSe(t,e,r){const[i,s,n,o,l,u,d]=e.a,p=mM(t,e),{cosR:f,sinR:m,a:y,b:g,cx:v,cy:_}=p,S=Wg([0,0],i,r),M=Wg([0,0],s,r),C=r[0]*r[4]<0?1-o:o;{const T=y*y*m*m+g*g*f*f,O=2*(g*g-y*y)*m*f,P=y*y*f*f+g*g*m*m,D=-2*T*v-O*_,z=-O*v-2*P*_;Od(eO,T,O/2,D/2,O/2,P,z/2,D/2,z/2,T*v*v+O*v*_+P*_*_-y*y*g*g)}if(mN(jy,r),jy==null){const T=Wg([0,0],t,r);return{a:[S,M,n,o,fu(S[1],S[0]),Math.sqrt(Jr(S,T))/2,0]}}fN(tO,jy),xm(ta,xm(ta,tO,eO),jy);{const T=ta[0],O=2*ta[1],P=ta[4],D=2*ta[2],z=2*ta[5],B=O*O-4*T*P,G=2*(T*z*z+P*D*D-O*D*z+B*ta[8]),Q=Math.sqrt((T-P)**2+O*O),oe=-Math.sqrt(G*(T+P+Q))/B,Pe=-Math.sqrt(G*(T+P-Q))/B;return{a:[S,M,n,C,.5*fu(-O,P-T),oe,Pe/oe]}}}function gK(t,e,r){if(qw(r))return ls(t,e),ls(t,r),t;if(pM(r))return NY(t,e,r);if(fM(r)){const i=vN(e,r);return XE(t,i)}if(wN(r)){const i=fK(e,r);return XE(t,i)}return yK(t,e,r)}function bN(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function _N(t){return t.points!==void 0}function SN(t){return t.x!==void 0&&t.y!==void 0}function $N(t){return t.paths!==void 0}function xN(t){return t.rings!==void 0}function TN(t){function e(r,i){return r==null?i:i==null?r:t(r,i)}return e}const Aa=TN(Math.min),Ra=TN(Math.max);function fSe(t,e){return $N(e)?$h(t,e.curvePaths??e.paths,!1,!1)??t:xN(e)?$h(t,e.curveRings??e.rings,!1,!1)??t:_N(e)?yM(t,e.points,!1,!1,!1,!1):bN(e)?MN(t,e):(SN(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function mSe(t){let e,r,i,s;for(t.reset(),e=i=1/0,r=s=-1/0;t.nextPath();){const n=vK(t);e=Math.min(n[0],e),i=Math.min(n[1],i),r=Math.max(n[2],r),s=Math.max(n[3],s)}return mi([e,i,r,s])}function vK(t){let e,r,i,s;for(e=i=1/0,r=s=-1/0;t.nextPoint();)e=Math.min(t.x,e),i=Math.min(t.y,i),r=Math.max(t.x,r),s=Math.max(t.y,s);return mi([e,i,r,s])}function ySe(t,e){return $N(e)?$h(t,e.curvePaths??e.paths,!0,!1)??t:xN(e)?$h(t,e.curveRings??e.rings,!0,!1)??t:_N(e)?yM(t,e.points,!0,!1,!0,!1):bN(e)?MN(t,e,!0,!1,!0,!1):(SN(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function $h(t,e,r,i){const s=r?3:2;if(!e.length||!e[0].length)return null;let n,o,l,u,[d,p]=i1(e[0][0]),f=d,m=p;for(let y=0;y<e.length;y++){const g=e[y];for(let v=0;v<g.length;v++){const _=i1(g[v]),[S,M]=_;if(d=Aa(d,S),p=Aa(p,M),f=Ra(f,S),m=Ra(m,M),r&&_.length>2){const P=_[2];n=Aa(n,P),o=Ra(o,P)}if(i&&_.length>s){const P=_[s];l=Aa(n,P),u=Ra(o,P)}const C=g[v];if(qw(C)||v<1)continue;const T=i1(g[v-1]),O=XJ(d,p,f,m);[d,p,f,m]=gK(O,T,C)}}return r?i?(t[0]=d,t[1]=p,t[2]=n,t[3]=l,t[4]=f,t[5]=m,t[6]=o,t[7]=u,t.length=8,t):(t[0]=d,t[1]=p,t[2]=n,t[3]=f,t[4]=m,t[5]=o,t.length=6,t):i?(t[0]=d,t[1]=p,t[2]=l,t[3]=f,t[4]=m,t[5]=u,t.length=6,t):(t[0]=d,t[1]=p,t[2]=f,t[3]=m,t.length=4,t)}function MN(t,e,r,i,s,n){const o=e.xmin,l=e.xmax,u=e.ymin,d=e.ymax;let p=e.zmin,f=e.zmax,m=e.mmin,y=e.mmax;return s?(p=p||0,f=f||0,n?(m=m||0,y=y||0,t[0]=o,t[1]=u,t[2]=p,t[3]=m,t[4]=l,t[5]=d,t[6]=f,t[7]=y,t):(t[0]=o,t[1]=u,t[2]=p,t[3]=l,t[4]=d,t[5]=f,t)):n?(m=m||0,y=y||0,t[0]=o,t[1]=u,t[2]=m,t[3]=l,t[4]=d,t[5]=y,t):(t[0]=o,t[1]=u,t[2]=l,t[3]=d,t)}function yM(t,e,r,i,s,n){const o=r?3:2,l=i&&n,u=r&&s;if(!e.length||!e[0].length)return null;let d,p,f,m,[y,g]=e[0],[v,_]=e[0];for(let S=0;S<e.length;S++){const M=e[S],[C,T]=M;if(y=Aa(y,C),g=Aa(g,T),v=Ra(v,C),_=Ra(_,T),u&&M.length>2){const O=M[2];d=Aa(d,O),p=Ra(p,O)}if(l&&M.length>o){const O=M[o];f=Aa(d,O),m=Ra(p,O)}}return s?(d=d||0,p=p||0,n?(f=f||0,m=m||0,t[0]=y,t[1]=g,t[2]=d,t[3]=f,t[4]=v,t[5]=_,t[6]=p,t[7]=m,t):(t[0]=y,t[1]=g,t[2]=d,t[3]=v,t[4]=_,t[5]=p,t)):n?(f=f||0,m=m||0,t[0]=y,t[1]=g,t[2]=f,t[3]=v,t[4]=_,t[5]=m,t):(t[0]=y,t[1]=g,t[2]=v,t[3]=_,t)}function wK(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function bK(t){return t.points!==void 0}function _K(t){return t.x!==void 0&&t.y!==void 0}function SK(t){return t.paths!==void 0}function $K(t){return t.rings!==void 0}const gM=[];function IN(t,e,r,i){return{xmin:t,ymin:e,xmax:r,ymax:i}}function EN(t,e,r,i,s,n){return{xmin:t,ymin:e,zmin:r,xmax:i,ymax:s,zmax:n}}function ON(t,e,r,i,s,n){return{xmin:t,ymin:e,mmin:r,xmax:i,ymax:s,mmax:n}}function kN(t,e,r,i,s,n,o,l){return{xmin:t,ymin:e,zmin:r,mmin:i,xmax:s,ymax:n,zmax:o,mmax:l}}function vM(t,e=!1,r=!1){return e?r?kN(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):EN(t[0],t[1],t[2],t[3],t[4],t[5]):r?ON(t[0],t[1],t[2],t[3],t[4],t[5]):IN(t[0],t[1],t[2],t[3])}function gSe(t){return t?wK(t)?t:_K(t)?xK(t):$K(t)?PN(t):SK(t)?AN(t):bK(t)?CN(t):null:null}function CN(t){const{hasZ:e,hasM:r,points:i}=t,s=yM(gM,i,e??!1,r??!1,e??!1,r??!1);return s?vM(s,e,r):null}function xK(t){const{x:e,y:r,z:i,m:s}=t,n=s!=null;return i!=null?n?kN(e,r,i,s,e,r,i,s):EN(e,r,i,e,r,i):n?ON(e,r,s,e,r,s):IN(e,r,e,r)}function PN(t){const{hasZ:e,hasM:r,rings:i,curveRings:s}=t,n=$h(gM,s??i,e??!1,r??!1);return n?vM(n,e,r):null}function AN(t){const{hasZ:e,hasM:r,paths:i,curvePaths:s}=t,n=$h(gM,s??i,e??!1,r??!1);return n?vM(n,e,r):null}function xh(t,e,r=!1){let{hasM:i,hasZ:s}=t;Array.isArray(e)?e.length!==4||i||s?e.length===3&&r&&!i?(s=!0,i=!1):e.length===3&&i&&s&&(i=!1,s=!1):(i=!0,s=!0):(s=!s&&e.hasZ&&(!i||e.hasM),i=!i&&e.hasM&&(!s||e.hasZ)),t.hasZ=s,t.hasM=i}var Yg;function rO(t){return!Array.isArray(t[0])}function TK(t){return typeof t[0]?.[0]=="number"}function MK(t){if(!t)return;let{rings:e,hasM:r,hasZ:i,spatialReference:s}=t;switch(e??=[],TK(e)&&(e=[e]),e[0]?.[0]?.length){case 4:i??=!0,r??=!0;break;case 3:i??=r!==!0,r??=!i;break;default:i??=!1,r??=!1}return s??=Z.WGS84,{...t,hasM:r,hasZ:i,rings:e,spatialReference:s}}let Be=Yg=class extends Ut{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:r}=t;let i=!1,s=!1;for(const o of e)o.hasZ&&(i=!0),o.hasM&&(s=!0);const n={rings:e.map(o=>{const l=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(i&&o.hasZ){const u=o.zmin+.5*(o.zmax-o.zmin);for(let d=0;d<l.length;d++)l[d].push(u)}if(s&&o.hasM){const u=o.mmin+.5*(o.mmax-o.mmin);for(let d=0;d<l.length;d++)l[d].push(u)}return l}),spatialReference:r};return i&&(n.hasZ=!0),s&&(n.hasM=!0),new Yg(n)}constructor(t){super(MK(t)),this.curveRings=void 0,this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("curveRings"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("rings"),this.commitProperty("spatialReference"),{}}get centroid(){x_(L.getLogger(this),"centroid",{replacement:"Please use centroidOperator.execute() instead.",version:"4.34",warnOnce:!0});const t=Q5(this);return t?ee.fromJSON(t):null}writeCurveRings(t,e){e.curveRings=E(t)}get extent(){const t=PN(this),{spatialReference:e}=this;return t?new he({...t,spatialReference:e}):null}get isSelfIntersecting(){return x_(L.getLogger(this),"isSelfIntersecting",{replacement:"Please use simplifyOperator.isSimple() instead.",version:"4.33",warnOnce:!0}),nH(this.rings)}writeRings(t,e){e.rings=E(this.rings)}addRing(t){if(!t)return;const e=this.rings,r=e.length;if(rO(t)){const i=[];for(let s=0,n=t.length;s<n;s++)i[s]=t[s].toArray();e[r]=i}else e[r]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new Yg;return t.spatialReference=this.spatialReference,t.rings=E(this.rings),t.curveRings=E(this.curveRings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,r=t.spatialReference;if(e!=null!=(r!=null)||e!=null&&r!=null&&!e.equals(r)||this.rings.length!==t.rings.length)return!1;const i=([s,n,o,l],[u,d,p,f])=>s===u&&n===d&&(o==null&&p==null||o===p)&&(l==null&&f==null||l===f);for(let s=0;s<this.rings.length;s++){const n=this.rings[s],o=t.rings[s];if(!uw(n,o,i))return!1}return!0}contains(t){if(!t)return!1;const e=Mw(t,this.spatialReference);return VT(this,e??t)}isClockwise(t){const e=rO(t)?t.map(r=>this.hasZ?this.hasM?[r.x,r.y,r.z,r.m]:[r.x,r.y,r.z]:[r.x,r.y]):t;return Y5(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const r=this.rings[t][e],i=this.hasZ,s=this.hasM;return i&&!s?new ee(r[0],r[1],r[2],void 0,this.spatialReference):s&&!i?new ee(r[0],r[1],void 0,r[2],this.spatialReference):i&&s?new ee(r[0],r[1],r[2],r[3],this.spatialReference):new ee(r[0],r[1],this.spatialReference)}insertPoint(t,e,r){return this._validateInputs(t,e,!0)?(xh(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[t].splice(e,0,r),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const r=new ee(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),r}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],r=this.spatialReference,i=e.map(s=>new ee(s,r));return this.notifyChange("rings"),i}setPoint(t,e,r){return this._validateInputs(t,e)?(xh(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[t][e]=r,this.notifyChange("rings"),this):this}_validateInputs(t,e,r=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const i=this.rings[t];if(r&&(e<0||e>i.length)||!r&&(e<0||e>=i.length))return!1}return!0}toJSON(t){return this.write({},t)}};a([c({readOnly:!0})],Be.prototype,"cache",null),a([c({readOnly:!0})],Be.prototype,"centroid",null),a([c({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],Be.prototype,"curveRings",void 0),a([q("curveRings")],Be.prototype,"writeCurveRings",null),a([c({readOnly:!0})],Be.prototype,"extent",null),a([c({readOnly:!0})],Be.prototype,"isSelfIntersecting",null),a([c({type:[[[Number]]],json:{write:{isRequired:!0}}})],Be.prototype,"rings",void 0),a([q("rings")],Be.prototype,"writeRings",null),Be=Yg=a([b("esri.geometry.Polygon")],Be),Be.prototype.toJSON.isDefaultToJSON=!0;function al(){return[0,0,0]}function IK(t){return[t[0],t[1],t[2]]}function tp(t,e,r){return[t,e,r]}function EK(t,e,r){return[t,e,r]}function OK(t,e=al()){const r=Math.min(3,t.length);for(let i=0;i<r;++i)e[i]=t[i];return e}function RN(){return al()}function LN(){return tp(1,1,1)}function FN(){return tp(1,0,0)}function NN(){return tp(0,1,0)}function DN(){return tp(0,0,1)}const kK=RN(),CK=LN(),PK=FN(),AK=NN(),RK=DN();Object.freeze(Object.defineProperty({__proto__:null,ONES:CK,UNIT_X:PK,UNIT_Y:AK,UNIT_Z:RK,ZEROS:kK,clone:IK,create:al,freeze:EK,fromArray:OK,fromValues:tp,ones:LN,unitX:FN,unitY:NN,unitZ:DN,zeros:RN},Symbol.toStringTag,{value:"Module"}));var wS;function LK(t){if(!t)return;let{points:e,hasM:r,hasZ:i,spatialReference:s}=t;switch(e??=[],e?.at(0)?.length){case 4:i??=!0,r??=!0;break;case 3:i??=r!==!0,r??=!i;break;default:i??=!1,r??=!1}return s??=Z.WGS84,{...t,hasM:r,hasZ:i,points:e,spatialReference:s}}let zs=wS=class extends Ut{constructor(t){super(LK(t)),this.points=[],this.type="multipoint"}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=CN(this);return t?new he({...t,spatialReference:this.spatialReference}):null}writePoints(t,e){e.points=E(this.points)}clone(){const{points:t,spatialReference:e,hasM:r,hasZ:i}=this;return new wS({points:E(t),spatialReference:e.clone(),hasM:r,hasZ:i})}addPoint(t){return xh(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],r={x:e[0],y:e[1],spatialReference:this.spatialReference};let i=2;return this.hasZ&&(r.z=e[2],i=3),this.hasM&&(r.m=e[i]),new ee(r)}removePoint(t){if(!this._validateInputs(t))return null;const e=new ee(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(xh(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};a([c({readOnly:!0})],zs.prototype,"cache",null),a([c({readOnly:!0})],zs.prototype,"extent",null),a([c({type:[[Number]],json:{write:{isRequired:!0}}})],zs.prototype,"points",void 0),a([q("points")],zs.prototype,"writePoints",null),zs=wS=a([b("esri.geometry.Multipoint")],zs),zs.prototype.toJSON.isDefaultToJSON=!0;var bS;function FK(t){return!Array.isArray(t[0])}function NK(t){return typeof t[0]?.[0]=="number"}function DK(t){if(!t)return;let{paths:e,hasM:r,hasZ:i,spatialReference:s}=t;switch(e??=[],NK(e)&&(e=[e]),e[0]?.[0]?.length){case 4:i??=!0,r??=!0;break;case 3:i??=r!==!0,r??=!i;break;default:i??=!1,r??=!1}return s??=Z.WGS84,{...t,hasM:r,hasZ:i,paths:e,spatialReference:s}}let At=bS=class extends Ut{constructor(t){super(DK(t)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(t,e){e.curvePaths=E(t)}get extent(){const t=AN(this),{spatialReference:e}=this;return t?new he({...t,spatialReference:e}):null}writePaths(t,e){e.paths=E(this.paths)}addPath(t){if(!t)return;const e=this.paths,r=e.length;if(FK(t)){const i=[];for(let s=0,n=t.length;s<n;s++)i[s]=t[s].toArray();e[r]=i}else e[r]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new bS;return t.spatialReference=this.spatialReference,t.paths=E(this.paths),t.curvePaths=E(this.curvePaths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const r=this.paths[t][e],i=this.hasZ,s=this.hasM;return i&&!s?new ee(r[0],r[1],r[2],void 0,this.spatialReference):s&&!i?new ee(r[0],r[1],void 0,r[2],this.spatialReference):i&&s?new ee(r[0],r[1],r[2],r[3],this.spatialReference):new ee(r[0],r[1],this.spatialReference)}insertPoint(t,e,r){return this._validateInputs(t,e,!0)?(xh(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t].splice(e,0,r),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],r=this.spatialReference,i=e.map(s=>new ee(s,r));return this.notifyChange("paths"),i}removePoint(t,e){if(!this._validateInputs(t,e))return null;const r=new ee(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),r}setPoint(t,e,r){return this._validateInputs(t,e)?(xh(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t][e]=r,this.notifyChange("paths"),this):this}_validateInputs(t,e,r=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const i=this.paths[t];if(r&&(e<0||e>i.length)||!r&&(e<0||e>=i.length))return!1}return!0}toJSON(t){return this.write({},t)}};a([c({readOnly:!0})],At.prototype,"cache",null),a([c({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],At.prototype,"curvePaths",void 0),a([q("curvePaths")],At.prototype,"writeCurvePaths",null),a([c({readOnly:!0})],At.prototype,"extent",null),a([c({type:[[[Number]]],json:{write:{isRequired:!0}}})],At.prototype,"paths",void 0),a([q("paths")],At.prototype,"writePaths",null),At=bS=a([b("esri.geometry.Polyline")],At),At.prototype.toJSON.isDefaultToJSON=!0;var _S;let $c=_S=class extends X{constructor(t){super(t),this.isInverse=!1,this.wkt=null,this.wkid=null}getInverse(){return new _S({isInverse:!this.isInverse,wkid:this.wkid,wkt:this.wkt})}};a([c()],$c.prototype,"isInverse",void 0),a([c()],$c.prototype,"wkt",void 0),a([c()],$c.prototype,"wkid",void 0),$c=_S=a([b("esri.geometry.operators.support.GeographicTransformationStep")],$c);var SS;let jf=SS=class extends X{constructor(t){super(t),this.steps=[]}getInverse(){const t=new SS;for(let e=this.steps.length-1;e>=0;e--){const r=this.steps[e];t.steps.push(r.getInverse())}return t}};a([c({type:[$c],nonNullable:!0})],jf.prototype,"steps",void 0),jf=SS=a([b("esri.geometry.operators.support.GeographicTransformation")],jf);const vSe=Math.PI/180,wSe=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,ra=ct.radius,Es=ct.eccentricitySquared,jK={a1:ra*Es,a2:ra*Es*ra*Es,a3:ra*Es*Es/2,a4:ra*Es*ra*Es*2.5,a5:ra*Es+ra*Es*Es/2,a6:1-Es},bSe={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:ct.radius,f:ct.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:Za.radius,f:Za.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:An.radius,f:An.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:An.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}},VK={2:{5:Xe,7:null,9:null,10:Xe,1:zf,6:null,8:null,0:null,3:kd,11:Cd,2:Xe,4:Rd},5:{5:Xe,7:null,9:null,10:Xe,1:zf,6:null,8:null,0:null,3:kd,11:Cd,2:Xe,4:Rd},7:{5:null,7:Xe,9:null,10:Xe,1:null,6:nO,8:null,0:null,3:null,11:null,2:null,4:null},9:{5:null,7:null,9:Xe,10:Xe,1:null,6:null,8:sO,0:null,3:null,11:null,2:null,4:null},3:{5:Vf,7:null,9:null,10:Vf,1:UK,6:null,8:null,0:null,3:Xe,11:BK,2:Vf,4:qK},4:{5:Ld,7:null,9:null,10:Ld,1:eQ,6:null,8:null,0:null,3:tQ,11:HK,2:Ld,4:Xe},1:{5:Ad,7:null,9:null,10:Ad,1:Xe,6:null,8:null,0:null,3:KK,11:WK,2:Ad,4:QK},6:{5:null,7:aO,9:null,10:aO,1:null,6:Xe,8:null,0:null,3:null,11:null,2:null,4:null},8:{5:null,7:null,9:oO,10:oO,1:null,6:null,8:Xe,0:null,3:null,11:null,2:null,4:null},0:{5:null,7:null,9:null,10:null,1:null,6:null,8:null,0:Xe,3:null,11:null,2:null,4:null},10:{5:Xe,7:Xe,9:Xe,10:Xe,1:zf,6:nO,8:sO,0:null,3:kd,11:Cd,2:Xe,4:Rd},11:{5:Pd,7:null,9:null,10:Pd,1:ZK,6:null,8:null,0:null,3:JK,11:Xe,2:Pd,4:YK}};function jN(t,e){return zK(t,e)?.projector}function zK(t,e){if(t==null||e==null)return null;if(qn.source.spatialReference===t&&qn.dest.spatialReference===e)return qn;const r=iO(t,qn.source),i=iO(e,qn.dest);return r===0&&i===0?Ht(t,e)?qn.projector=Xe:qn.projector=null:qn.projector=VK[r][i],qn}function iO(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=Bi(t,1)),wv(t)?e.spatialReferenceId=1:ku(t)?e.spatialReferenceId=2:Dn(t)?e.spatialReferenceId=3:lB(t)?e.spatialReferenceId=11:t.wkt===hB.wkt?e.spatialReferenceId=4:t.wkid===4490?e.spatialReferenceId=5:t.wkt===NT.wkt?e.spatialReferenceId=6:t.wkt===DT.wkt?e.spatialReferenceId=8:zL(t)?e.spatialReferenceId=7:UL(t)?e.spatialReferenceId=9:e.spatialReferenceId=0):0}function Xe(t,e,r,i){t!==r&&(r[i++]=t[e++],r[i++]=t[e++],r[i]=t[e])}function Vf(t,e,r,i){r[i]=Mh*(t[e]/mu),r[i+1]=Mh*(VN-2*Math.atan(Math.exp(-t[e+1]/mu))),r[i+2]=t[e+2]}function UK(t,e,r,i){const s=t[e]/mu,n=VN-2*Math.atan(Math.exp(-t[e+1]/mu)),o=mu+t[e+2],l=Math.cos(n)*o;r[i]=Math.cos(s)*l,r[i+1]=Math.sin(s)*l,r[i+2]=Math.sin(n)*o}function qK(t,e,r,i){Vf(t,e,r,i),Rd(r,i,r,i)}function GK(t,e,r,i,s){const n=.4999999*Math.PI,o=Gi(Th*t[e+1],-n,n),l=Math.sin(o);r[i++]=Th*t[e]*s.radius,r[i++]=s.halfSemiMajorAxis*Math.log((1+l)/(1-l)),r[i]=t[e+2]}function kd(t,e,r,i){GK(t,e,r,i,ct)}function Cd(t,e,r,i){r[i]=t[e]*lO,r[i+1]=t[e+1]*lO,r[i+2]=t[e+2]}function Pd(t,e,r,i){r[i]=t[e]*uO,r[i+1]=t[e+1]*uO,r[i+2]=t[e+2]}function BK(t,e,r,i){Vf(t,e,r,i),Cd(r,i,r,i)}function HK(t,e,r,i){Ld(t,e,r,i),Cd(r,i,r,i)}function WK(t,e,r,i){Ad(t,e,r,i),Cd(r,i,r,i)}function ZK(t,e,r,i){Pd(t,e,r,i),zf(r,i,r,i)}function JK(t,e,r,i){Pd(t,e,r,i),kd(r,i,r,i)}function YK(t,e,r,i){Pd(t,e,r,i),Rd(r,i,r,i)}function wM(t,e,r,i,s){const n=s+t[e+2],o=Th*t[e+1],l=Th*t[e],u=Math.cos(o)*n;r[i]=Math.cos(l)*u,r[i+1]=Math.sin(l)*u,r[i+2]=Math.sin(o)*n}function sO(t,e,r,i){wM(t,e,r,i,Za.radius)}function nO(t,e,r,i){wM(t,e,r,i,An.radius)}function zf(t,e,r,i){wM(t,e,r,i,ct.radius)}function bM(t,e,r,i,s){const n=t[e],o=t[e+1],l=t[e+2],u=Math.sqrt(n*n+o*o+l*l),d=hJ(l/(u===0?1:u)),p=Math.atan2(o,n);r[i++]=Mh*p,r[i++]=Mh*d,r[i]=u-s}function oO(t,e,r,i){bM(t,e,r,i,Za.radius)}function aO(t,e,r,i){bM(t,e,r,i,An.radius)}function Ad(t,e,r,i){bM(t,e,r,i,ct.radius)}function KK(t,e,r,i){Ad(t,e,r,i),kd(r,i,r,i)}function QK(t,e,r,i){Ad(t,e,r,i),Rd(r,i,r,i)}function XK(t,e,r,i,s){const n=Th*t[e],o=Th*t[e+1],l=t[e+2],u=Math.sin(o),d=Math.cos(o),p=s.radius/Math.sqrt(1-s.eccentricitySquared*u*u);r[i++]=(p+l)*d*Math.cos(n),r[i++]=(p+l)*d*Math.sin(n),r[i++]=(p*(1-s.eccentricitySquared)+l)*u}function Rd(t,e,r,i){XK(t,e,r,i,ct)}function Ld(t,e,r,i){const s=jK,n=t[e],o=t[e+1],l=t[e+2];let u,d,p,f,m,y,g,v,_,S,M,C,T,O,P,D,z,B,G,Q,oe;u=Math.abs(l),d=n*n+o*o,p=Math.sqrt(d),f=d+l*l,m=Math.sqrt(f),Q=Math.atan2(o,n),y=l*l/f,g=d/f,O=s.a2/m,P=s.a3-s.a4/m,g>.3?(v=u/m*(1+g*(s.a1+O+y*P)/m),G=Math.asin(v),S=v*v,_=Math.sqrt(1-S)):(_=p/m*(1-y*(s.a5-O-g*P)/m),G=Math.acos(_),S=1-_*_,v=Math.sqrt(S)),M=1-ct.eccentricitySquared*S,C=ct.radius/Math.sqrt(M),T=s.a6*C,O=p-C*_,P=u-T*v,z=_*O+v*P,D=_*P-v*O,B=D/(T/M+z),G+=B,oe=z+D*B/2,l<0&&(G=-G),r[i++]=Mh*Q,r[i++]=Mh*G,r[i]=oe}function eQ(t,e,r,i){Ld(t,e,r,i),zf(r,i,r,i)}function tQ(t,e,r,i){Ld(t,e,r,i),kd(r,i,r,i)}const qn={source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:Xe},Th=ny(1),Mh=D5(1),VN=.5*Math.PI,mu=ct.radius,lO=mu*Math.PI/180,uO=180/(mu*Math.PI);function ly(t,e,r,i,s,n,o=Math.floor(t.length/3)){const l=jN(e,s);if(l==null)return!1;if(l===Xe){if(t===i&&r===n)return!0;const d=r+3*o;for(let p=r,f=n;p<d;p++,f++)i[f]=t[p];return!0}const u=r+3*o;for(let d=r,p=n;d<u;d+=3,p+=3)l(t,d,i,p);return!0}const _Se=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:ly},Symbol.toStringTag,{value:"Module"}));function cO(t,e,r,i,s,n){return Vy[0]=t,Vy[1]=e,Vy[2]=r,ly(Vy,i,0,s,n,0)}const Vy=al();function zN(t,e,r){if(e==null||r==null||r.vcsWkid||Ht(e,r)||Ya(e)||Ya(r))return null;const i=bv(e)/bv(r);if(i===1)return null;switch(t){case"point":case"esriGeometryPoint":return s=>rQ(s,i);case"polyline":case"esriGeometryPolyline":return s=>sQ(s,i);case"polygon":case"esriGeometryPolygon":return s=>iQ(s,i);case"multipoint":case"esriGeometryMultipoint":return s=>nQ(s,i);case"extent":case"esriGeometryEnvelope":return s=>oQ(s,i);default:return null}}function rQ(t,e){t?.z!=null&&(t.z*=e)}function iQ(t,e){if(t)for(const r of t.rings)for(const i of r)i.length>2&&(i[2]*=e)}function sQ(t,e){if(t)for(const r of t.paths)for(const i of r)i.length>2&&(i[2]*=e)}function nQ(t,e){if(t)for(const r of t.points)r.length>2&&(r[2]*=e)}function oQ(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}let Uf=null,Mm=null,Im=null,Ih=null,$S={};const _M=new Qm;function qo(){return!!(Mm?.isLoaded()&&Im?.isLoaded()&&Ih?.isLoaded())}function UN(){return!!qo()||(le(_M),el(),!1)}function qN(t,e){return!t||!e||nn(t,e)||UN()}function aQ(t,e){return!nn(t,e)&&!qo()}async function el(t){Uf==null&&(Uf=Promise.all([N(()=>import("./projectOperator-Cerll4jP.js"),__vite__mapDeps([15,16,17])).then(e=>(Mm=e,Mm.load())),N(()=>import("./projectOperator-VISE7Qa5.js"),__vite__mapDeps([18,16,17])).then(e=>(Im=e,Im.load())),N(()=>import("./geographicTransformationUtils-DDAw2qlS.js"),[]).then(e=>(Ih=e,Ih.load()))])),await Uf,We(t),_M.notify()}function ll(t,e,r){return Array.isArray(t)?t.length===0?[]:(qB(t),xS(t,t[0].spatialReference,e,r)):(bh(t),xS([t],t.spatialReference,e,r)[0])}function xS(t,e,r,i){if(e==null||r==null)return t;if(nn(e,r,i))return t.map(s=>Kg(s,e,r));if(i?.geographicTransformation==null&&wv(e))return t.map(s=>Kg(s,e,Z.WGS84)).map(s=>Em(s,r));if(i?.geographicTransformation==null&&wv(r))return t.map(s=>Em(s,Z.WGS84)).map(s=>Kg(s,Z.WGS84,r));if(!qo())throw new BN;if(!i?.geographicTransformation){if(i?.extendedParams)i={...i,geographicTransformation:Ih.getTransformation(e,r,i.areaOfInterestExtent)||new jf};else if(!i?.areaOfInterestExtent){const s=lQ(e,r);let n=$S[s];n||(n=Ih.getTransformation(e,r)||new jf,$S[s]=n),i={geographicTransformation:n}}}return t[0].spatialReference||(t[0].spatialReference=e),t[0]instanceof Ut?Mm.executeMany(t,r,i):Im.executeMany(t,r,i)}function lQ(t,e){return[t.wkid?.toString()??"-1",t.wkt?.toString()??"",t.wkt2?.toString()??"",e.wkid?.toString()??"-1",e.wkt?.toString()??"",e.wkt2?.toString()??""].join()}function uQ(t,e){const r=GN([t],e);return r.pending!=null?{pending:r.pending,geometry:null}:r.geometries!=null?{pending:null,geometry:r.geometries[0]}:{pending:null,geometry:null}}function GN(t,e){if(!qo()){for(const r of t)if(r!=null&&!Ht(r.spatialReference,e)&&Fi(r.spatialReference)&&Fi(e)&&!nn(r.spatialReference,e))return le(_M),{pending:el(),geometries:null}}return{pending:null,geometries:t.map(r=>r==null?null:Ht(r.spatialReference,e)?r:Fi(r.spatialReference)&&Fi(e)?Em(r,e):null)}}let BN=class extends x{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function cQ(){Uf=null,Mm=null,Im=null,Ih=null,$S={}}const dQ={get loadPromise(){return Uf}};function Em(t,e){try{const r=ll(t,e);if(r==null)return null;"xmin"in t&&"xmin"in r&&(r.zmin=t.zmin,r.zmax=t.zmax);const i=zN(r.type,t.spatialReference,e);return i?.(r),r}catch(r){if(!(r instanceof BN))throw r;return null}}async function HN(t,e,r){const i=t.spatialReference;return i!=null&&e!=null&&await SM(i,e,null,r),Em(t,e)}function nn(t,e,r){return!(r?.areaOfInterestExtent||r?.extendedParams||r?.geographicTransformation)&&(!!Ht(t,e)||Fi(t)&&Fi(e)&&!!jN(t,e))}function hQ(t,e){if(Ht(t,e))return!0;if(!Fi(t)||!Fi(e))return!1;const r=ku(t)||Dn(t)||BI(t),i=ku(e)||Dn(e)||BI(e);return r&&i}async function SM(t,e,r,i){if(qo())return uI(i);if(Array.isArray(t)){for(const{source:s,dest:n,options:o}of t)if(s&&n&&!nn(s,n,o))return el(i)}else if(t&&e&&!nn(t,e,r))return el(i);return uI(i)}function Kg(t,e,r){return t?"x"in t?WN(t,e,new ee,r,0):"xmin"in t?QN(t,e,new he,r,0):"rings"in t?KN(t,e,new Be,r,0):"paths"in t?JN(t,e,new At,r,0):"points"in t?ZN(t,e,new zs,r,0):null:null}function pQ(t,e,r=e.spatialReference,i=0){return r!=null&&t.spatialReference!=null&&WN(t,t.spatialReference,e,r,i)!=null}function WN(t,e,r,i,s){Tr[0]=t.x,Tr[1]=t.y;const n=t.z;return Tr[2]=n!==void 0?n:s,ly(Tr,e,0,Tr,i,0)?(r.x=Tr[0],r.y=Tr[1],r.spatialReference=i,n!==void 0||Ya(i)?(r.z=Tr[2],r.hasZ=!0):(r.z=void 0,r.hasZ=!1),t.m===void 0?(r.m=void 0,r.hasM=!1):(r.m=t.m,r.hasM=!0),r):null}function fQ(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&ZN(t,t.spatialReference,e,r,i)!=null}function ZN(t,e,r,i,s){const{points:n,hasZ:o,hasM:l}=t,u=[],d=n.length,p=[];for(const m of n)p.push(m[0],m[1],o?m[2]:s);if(!ly(p,e,0,p,i,0,d))return null;const f=o||Ya(i);for(let m=0;m<d;++m){const y=3*m,g=p[y],v=p[y+1];f&&l?u.push([g,v,p[y+2],n[m][3]]):f?u.push([g,v,p[y+2]]):l?u.push([g,v,n[m][2]]):u.push([g,v])}return r.points=u,r.spatialReference=i,r.hasZ=o,r.hasM=l,r}function mQ(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&JN(t,t.spatialReference,e,r,i)!=null}function JN(t,e,r,i,s){const{paths:n,hasZ:o,hasM:l}=t,u=[];if(!XN(n,o??!1,l??!1,e,u,i,s))return null;const d=o||Ya(i);return r.paths=u,r.spatialReference=i,r.hasZ=d,r.hasM=l,r}function YN(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&KN(t,t.spatialReference,e,r,i)!=null}function KN(t,e,r,i,s){const{rings:n,hasZ:o,hasM:l}=t,u=[];if(!XN(n,o??!1,l??!1,e,u,i,s))return null;const d=o||Ya(i);return r.rings=u,r.spatialReference=i,r.hasZ=d,r.hasM=l,r}function yQ(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&QN(t,t.spatialReference,e,r,i)!=null}function QN(t,e,r,i,s){const{xmin:n,ymin:o,xmax:l,ymax:u,hasZ:d,hasM:p}=t,f=d?t.zmin:s;if(!cO(n,o,f,e,Tr,i))return null;const m=d||Ya(i);r.xmin=Tr[0],r.ymin=Tr[1],m&&(r.zmin=Tr[2]);const y=d?t.zmax:s;return cO(l,u,y,e,Tr,i)?(r.xmax=Tr[0],r.ymax=Tr[1],m&&(r.zmax=Tr[2]),p&&(r.mmin=t.mmin,r.mmax=t.mmax),r.spatialReference=i,r):null}function XN(t,e,r,i,s,n,o=0){const l=new Array;for(const p of t)for(const f of p)l.push(f[0],f[1],e?f[2]:o);if(!ly(l,i,0,l,n,0))return!1;let u=0;s.length=0;const d=e||Ya(n);for(const p of t){const f=new Array;for(const m of p)d&&r?f.push([l[u++],l[u++],l[u++],m[3]]):d?f.push([l[u++],l[u++],l[u++]]):r?(f.push([l[u++],l[u++],m[2]]),u++):(f.push([l[u++],l[u++]]),u++);s.push(f)}return!0}const Tr=al(),$Se=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:nn,initializeProjection:SM,isEqualBaseGCS:hQ,isLoaded:qo,isLoadedOrLoad:UN,isLoadedOrLoadFor:qN,load:el,project:ll,projectExtent:yQ,projectMany:xS,projectMultipoint:fQ,projectOrLoad:uQ,projectOrLoadMany:GN,projectPoint:pQ,projectPolygon:YN,projectPolyline:mQ,projectWithZConversion:HN,projectWithoutEngine:Kg,requiresLoad:aQ,test:dQ,tryProjectWithZConversion:Em,unload:cQ},Symbol.toStringTag,{value:"Module"}));var Qg;let TS=Qg=class extends ol(H.ofType(Be)){constructor(t){super(t)}clone(){return new Qg(this.items.map(t=>t.clone()))}write(t,e){return this.toJSON(e)}toJSON(t){const e=t?.layer?.spatialReference;return e?this.toArray().map(r=>{if(!e.equals(r.spatialReference)){if(!nn(r.spatialReference,e))return t?.messages?.push(new Ui("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:t.layer.spatialReference,context:t})),null;const s=new Be;YN(r,s,e),r=s}const i=r.toJSON(t);return delete i.spatialReference,i}).filter(r=>r!=null):this.toArray().map(r=>r.toJSON(t))}static fromJSON(t,e){const r=new Qg;return t.forEach(i=>r.add(Be.fromJSON(i,e))),r}};TS=Qg=a([b("esri.layers.support.PolygonCollection")],TS);const qf=TS;let Xn=class extends ol(nM){constructor(e){super(e),this.id=`focusarea-${ep()}`,this.title=null,this.enabled=!0,this.outline=null,this.geometries=new qf}readGeometries(e,r,i){Array.isArray(e)?this.geometries=qf.fromJSON(e,i):i.origin!=="web-scene"&&i.origin!=="portal-item"||i.hooks?.onAfterLoad?.(()=>this._loadGeometries(qu(e,i),i))}async _loadGeometries(e,r){const i=await Ae(e,{responseType:"json"});this.geometries=qf.fromJSON(i.data,r)}};a([c({type:String,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),c()],Xn.prototype,"id",void 0),a([c({type:String,json:{write:!0}})],Xn.prototype,"title",void 0),a([c({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],Xn.prototype,"enabled",void 0),a([c({type:NJ,json:{write:!0}})],Xn.prototype,"outline",void 0),a([c({type:qf,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new qf(t.items.map(e=>e.clone()))}),kJ({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],Xn.prototype,"geometries",void 0),a([V(["web-scene","portal-item","service"],"geometries")],Xn.prototype,"readGeometries",null),Xn=a([b("esri.effects.FocusArea")],Xn);const gQ=Xn;let Hp=class extends ol(nM){constructor(e){super(e),this.areas=new H,this.style="bright"}};a([c({type:H.ofType(gQ),nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new H(t.items.map(e=>e.clone()))})],Hp.prototype,"areas",void 0),a([c({type:["bright","dark"],nonNullable:!0,json:{write:!0}})],Hp.prototype,"style",void 0),Hp=a([b("esri.effects.FocusAreas")],Hp);const eD=Hp;function vQ(t){return typeof t=="object"&&t!=null&&"loaded"in t&&t.loaded===!0&&"type"in t}function wQ(t){return!(!vQ(t)||!JZ(t)?.operations?.supportsEditing||"editingEnabled"in t&&!KZ(t)||I5(t))}const bQ=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,_Q="screenUtils.toPt: input not recognized!",tD=96;function SQ(t){return t?t/72*tD:0}function gs(t){return t?72*t/tD:0}function Me(t){if(typeof t=="string"){const e=t.match(bQ);if(e){const r=Number(e[1]),i=e[3]&&e[3].toLowerCase(),s=t.startsWith("-"),n=i==="px"?gs(r):r;return s?-n:n}return console.warn(_Q),null}return t}function Gt(t=0,e=0){return{x:t,y:e}}function MSe(t){return t?Gt(t.x,t.y):null}function ISe(t=0,e=0){return[t,e]}function ESe(t=0,e=0,r=0){return[t,e,r]}function OSe(t){return t}function kSe(t){return t}function CSe(t){return t}function PSe(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function Gw(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function $Q(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function xQ(t,e,r,i,s,n,o,l,u,d,p,f,m,y,g,v){const _=new Float32Array(16);return _[0]=t,_[1]=e,_[2]=r,_[3]=i,_[4]=s,_[5]=n,_[6]=o,_[7]=l,_[8]=u,_[9]=d,_[10]=p,_[11]=f,_[12]=m,_[13]=y,_[14]=g,_[15]=v,_}const TQ=Gw();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:TQ,clone:$Q,create:Gw,fromValues:xQ},Symbol.toStringTag,{value:"Module"}));function rD(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ul(t,e,r,i,s,n,o,l,u,d,p,f,m,y,g,v,_){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=n,t[5]=o,t[6]=l,t[7]=u,t[8]=d,t[9]=p,t[10]=f,t[11]=m,t[12]=y,t[13]=g,t[14]=v,t[15]=_,t}function Bw(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function cl(t,e){if(t===e){const r=e[1],i=e[2],s=e[3],n=e[6],o=e[7],l=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=n,t[11]=e[14],t[12]=s,t[13]=o,t[14]=l}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function MQ(t,e){return iD(t,e)||Bw(t),t}function iD(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],l=e[5],u=e[6],d=e[7],p=e[8],f=e[9],m=e[10],y=e[11],g=e[12],v=e[13],_=e[14],S=e[15],M=r*l-i*o,C=r*u-s*o,T=r*d-n*o,O=i*u-s*l,P=i*d-n*l,D=s*d-n*u,z=p*v-f*g,B=p*_-m*g,G=p*S-y*g,Q=f*_-m*v,oe=f*S-y*v,Pe=m*S-y*_;let fe=M*Pe-C*oe+T*Q+O*G-P*B+D*z;return fe?(fe=1/fe,t[0]=(l*Pe-u*oe+d*Q)*fe,t[1]=(s*oe-i*Pe-n*Q)*fe,t[2]=(v*D-_*P+S*O)*fe,t[3]=(m*P-f*D-y*O)*fe,t[4]=(u*G-o*Pe-d*B)*fe,t[5]=(r*Pe-s*G+n*B)*fe,t[6]=(_*T-g*D-S*C)*fe,t[7]=(p*D-m*T+y*C)*fe,t[8]=(o*oe-l*G+d*z)*fe,t[9]=(i*G-r*oe-n*z)*fe,t[10]=(g*P-v*T+S*M)*fe,t[11]=(f*T-p*P-y*M)*fe,t[12]=(l*B-o*Q-u*z)*fe,t[13]=(r*Q-i*B+s*z)*fe,t[14]=(v*C-g*O-_*M)*fe,t[15]=(p*O-f*C+m*M)*fe,t):null}function IQ(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],l=e[5],u=e[6],d=e[7],p=e[8],f=e[9],m=e[10],y=e[11],g=e[12],v=e[13],_=e[14],S=e[15];return t[0]=l*(m*S-y*_)-f*(u*S-d*_)+v*(u*y-d*m),t[1]=-(i*(m*S-y*_)-f*(s*S-n*_)+v*(s*y-n*m)),t[2]=i*(u*S-d*_)-l*(s*S-n*_)+v*(s*d-n*u),t[3]=-(i*(u*y-d*m)-l*(s*y-n*m)+f*(s*d-n*u)),t[4]=-(o*(m*S-y*_)-p*(u*S-d*_)+g*(u*y-d*m)),t[5]=r*(m*S-y*_)-p*(s*S-n*_)+g*(s*y-n*m),t[6]=-(r*(u*S-d*_)-o*(s*S-n*_)+g*(s*d-n*u)),t[7]=r*(u*y-d*m)-o*(s*y-n*m)+p*(s*d-n*u),t[8]=o*(f*S-y*v)-p*(l*S-d*v)+g*(l*y-d*f),t[9]=-(r*(f*S-y*v)-p*(i*S-n*v)+g*(i*y-n*f)),t[10]=r*(l*S-d*v)-o*(i*S-n*v)+g*(i*d-n*l),t[11]=-(r*(l*y-d*f)-o*(i*y-n*f)+p*(i*d-n*l)),t[12]=-(o*(f*_-m*v)-p*(l*_-u*v)+g*(l*m-u*f)),t[13]=r*(f*_-m*v)-p*(i*_-s*v)+g*(i*m-s*f),t[14]=-(r*(l*_-u*v)-o*(i*_-s*v)+g*(i*u-s*l)),t[15]=r*(l*m-u*f)-o*(i*m-s*f)+p*(i*u-s*l),t}function EQ(t){const e=t[0],r=t[1],i=t[2],s=t[3],n=t[4],o=t[5],l=t[6],u=t[7],d=t[8],p=t[9],f=t[10],m=t[11],y=t[12],g=t[13],v=t[14],_=t[15];return(e*o-r*n)*(f*_-m*v)-(e*l-i*n)*(p*_-m*g)+(e*u-s*n)*(p*v-f*g)+(r*l-i*o)*(d*_-m*y)-(r*u-s*o)*(d*v-f*y)+(i*u-s*l)*(d*g-p*y)}function sD(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=e[6],p=e[7],f=e[8],m=e[9],y=e[10],g=e[11],v=e[12],_=e[13],S=e[14],M=e[15];let C=r[0],T=r[1],O=r[2],P=r[3];return t[0]=C*i+T*l+O*f+P*v,t[1]=C*s+T*u+O*m+P*_,t[2]=C*n+T*d+O*y+P*S,t[3]=C*o+T*p+O*g+P*M,C=r[4],T=r[5],O=r[6],P=r[7],t[4]=C*i+T*l+O*f+P*v,t[5]=C*s+T*u+O*m+P*_,t[6]=C*n+T*d+O*y+P*S,t[7]=C*o+T*p+O*g+P*M,C=r[8],T=r[9],O=r[10],P=r[11],t[8]=C*i+T*l+O*f+P*v,t[9]=C*s+T*u+O*m+P*_,t[10]=C*n+T*d+O*y+P*S,t[11]=C*o+T*p+O*g+P*M,C=r[12],T=r[13],O=r[14],P=r[15],t[12]=C*i+T*l+O*f+P*v,t[13]=C*s+T*u+O*m+P*_,t[14]=C*n+T*d+O*y+P*S,t[15]=C*o+T*p+O*g+P*M,t}function OQ(t,e,r){const i=r[0],s=r[1],n=r[2];if(e===t)t[12]=e[0]*i+e[4]*s+e[8]*n+e[12],t[13]=e[1]*i+e[5]*s+e[9]*n+e[13],t[14]=e[2]*i+e[6]*s+e[10]*n+e[14],t[15]=e[3]*i+e[7]*s+e[11]*n+e[15];else{const o=e[0],l=e[1],u=e[2],d=e[3],p=e[4],f=e[5],m=e[6],y=e[7],g=e[8],v=e[9],_=e[10],S=e[11];t[0]=o,t[1]=l,t[2]=u,t[3]=d,t[4]=p,t[5]=f,t[6]=m,t[7]=y,t[8]=g,t[9]=v,t[10]=_,t[11]=S,t[12]=o*i+p*s+g*n+e[12],t[13]=l*i+f*s+v*n+e[13],t[14]=u*i+m*s+_*n+e[14],t[15]=d*i+y*s+S*n+e[15]}return t}function kQ(t,e,r){const i=r[0],s=r[1],n=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function CQ(t,e,r,i){let s=i[0],n=i[1],o=i[2],l=Math.sqrt(s*s+n*n+o*o);if(l<=Kr())return void rD(t,e);l=1/l,s*=l,n*=l,o*=l;const u=Math.sin(r),d=Math.cos(r),p=1-d,f=e[0],m=e[1],y=e[2],g=e[3],v=e[4],_=e[5],S=e[6],M=e[7],C=e[8],T=e[9],O=e[10],P=e[11],D=s*s*p+d,z=n*s*p+o*u,B=o*s*p-n*u,G=s*n*p-o*u,Q=n*n*p+d,oe=o*n*p+s*u,Pe=s*o*p+n*u,fe=n*o*p-s*u,Ft=o*o*p+d;t[0]=f*D+v*z+C*B,t[1]=m*D+_*z+T*B,t[2]=y*D+S*z+O*B,t[3]=g*D+M*z+P*B,t[4]=f*G+v*Q+C*oe,t[5]=m*G+_*Q+T*oe,t[6]=y*G+S*Q+O*oe,t[7]=g*G+M*Q+P*oe,t[8]=f*Pe+v*fe+C*Ft,t[9]=m*Pe+_*fe+T*Ft,t[10]=y*Pe+S*fe+O*Ft,t[11]=g*Pe+M*fe+P*Ft,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15])}function PQ(t,e,r){const i=Math.sin(r),s=Math.cos(r),n=e[4],o=e[5],l=e[6],u=e[7],d=e[8],p=e[9],f=e[10],m=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=n*s+d*i,t[5]=o*s+p*i,t[6]=l*s+f*i,t[7]=u*s+m*i,t[8]=d*s-n*i,t[9]=p*s-o*i,t[10]=f*s-l*i,t[11]=m*s-u*i,t}function AQ(t,e,r){const i=Math.sin(r),s=Math.cos(r),n=e[0],o=e[1],l=e[2],u=e[3],d=e[8],p=e[9],f=e[10],m=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*s-d*i,t[1]=o*s-p*i,t[2]=l*s-f*i,t[3]=u*s-m*i,t[8]=n*i+d*s,t[9]=o*i+p*s,t[10]=l*i+f*s,t[11]=u*i+m*s,t}function RQ(t,e,r){const i=Math.sin(r),s=Math.cos(r),n=e[0],o=e[1],l=e[2],u=e[3],d=e[4],p=e[5],f=e[6],m=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*s+d*i,t[1]=o*s+p*i,t[2]=l*s+f*i,t[3]=u*s+m*i,t[4]=d*s-n*i,t[5]=p*s-o*i,t[6]=f*s-l*i,t[7]=m*s-u*i,t}function LQ(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function FQ(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function NQ(t,e,r){if(e===0)return Bw(t);let i=r[0],s=r[1],n=r[2],o=Math.sqrt(i*i+s*s+n*n);if(o<=Kr())return null;o=1/o,i*=o,s*=o,n*=o;const l=Math.sin(e),u=Math.cos(e),d=1-u;return t[0]=i*i*d+u,t[1]=s*i*d+n*l,t[2]=n*i*d-s*l,t[3]=0,t[4]=i*s*d-n*l,t[5]=s*s*d+u,t[6]=n*s*d+i*l,t[7]=0,t[8]=i*n*d+s*l,t[9]=s*n*d-i*l,t[10]=n*n*d+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function DQ(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function jQ(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function VQ(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nD(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=i+i,u=s+s,d=n+n,p=i*l,f=i*u,m=i*d,y=s*u,g=s*d,v=n*d,_=o*l,S=o*u,M=o*d;return t[0]=1-(y+v),t[1]=f+M,t[2]=m-S,t[3]=0,t[4]=f-M,t[5]=1-(p+v),t[6]=g+_,t[7]=0,t[8]=m+S,t[9]=g-_,t[10]=1-(p+y),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function zQ(t,e){const r=UQ,i=-e[0],s=-e[1],n=-e[2],o=e[3],l=e[4],u=e[5],d=e[6],p=e[7],f=i*i+s*s+n*n+o*o;return f>0?(r[0]=2*(l*o+p*i+u*n-d*s)/f,r[1]=2*(u*o+p*s+d*i-l*n)/f,r[2]=2*(d*o+p*n+l*s-u*i)/f):(r[0]=2*(l*o+p*i+u*n-d*s),r[1]=2*(u*o+p*s+d*i-l*n),r[2]=2*(d*o+p*n+l*s-u*i)),nD(t,e,r),t}const UQ=al();function qQ(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function GQ(t,e){const r=e[0],i=e[1],s=e[2],n=e[4],o=e[5],l=e[6],u=e[8],d=e[9],p=e[10];return t[0]=Math.sqrt(r*r+i*i+s*s),t[1]=Math.sqrt(n*n+o*o+l*l),t[2]=Math.sqrt(u*u+d*d+p*p),t}function BQ(t,e){const r=e[0]+e[5]+e[10];let i=0;return r>0?(i=2*Math.sqrt(r+1),t[3]=.25*i,t[0]=(e[6]-e[9])/i,t[1]=(e[8]-e[2])/i,t[2]=(e[1]-e[4])/i):e[0]>e[5]&&e[0]>e[10]?(i=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/i,t[0]=.25*i,t[1]=(e[1]+e[4])/i,t[2]=(e[8]+e[2])/i):e[5]>e[10]?(i=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/i,t[0]=(e[1]+e[4])/i,t[1]=.25*i,t[2]=(e[6]+e[9])/i):(i=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/i,t[0]=(e[8]+e[2])/i,t[1]=(e[6]+e[9])/i,t[2]=.25*i),t}function HQ(t,e,r,i){const s=e[0],n=e[1],o=e[2],l=e[3],u=s+s,d=n+n,p=o+o,f=s*u,m=s*d,y=s*p,g=n*d,v=n*p,_=o*p,S=l*u,M=l*d,C=l*p,T=i[0],O=i[1],P=i[2];return t[0]=(1-(g+_))*T,t[1]=(m+C)*T,t[2]=(y-M)*T,t[3]=0,t[4]=(m-C)*O,t[5]=(1-(f+_))*O,t[6]=(v+S)*O,t[7]=0,t[8]=(y+M)*P,t[9]=(v-S)*P,t[10]=(1-(f+g))*P,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function WQ(t,e,r,i,s){const n=e[0],o=e[1],l=e[2],u=e[3],d=n+n,p=o+o,f=l+l,m=n*d,y=n*p,g=n*f,v=o*p,_=o*f,S=l*f,M=u*d,C=u*p,T=u*f,O=i[0],P=i[1],D=i[2],z=s[0],B=s[1],G=s[2],Q=(1-(v+S))*O,oe=(y+T)*O,Pe=(g-C)*O,fe=(y-T)*P,Ft=(1-(m+S))*P,_i=(_+M)*P,nr=(g+C)*D,Ne=(_-M)*D,bs=(1-(m+v))*D;return t[0]=Q,t[1]=oe,t[2]=Pe,t[3]=0,t[4]=fe,t[5]=Ft,t[6]=_i,t[7]=0,t[8]=nr,t[9]=Ne,t[10]=bs,t[11]=0,t[12]=r[0]+z-(Q*z+fe*B+nr*G),t[13]=r[1]+B-(oe*z+Ft*B+Ne*G),t[14]=r[2]+G-(Pe*z+_i*B+bs*G),t[15]=1,t}function ZQ(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=r+r,l=i+i,u=s+s,d=r*o,p=i*o,f=i*l,m=s*o,y=s*l,g=s*u,v=n*o,_=n*l,S=n*u;return t[0]=1-f-g,t[1]=p+S,t[2]=m-_,t[3]=0,t[4]=p-S,t[5]=1-d-g,t[6]=y+v,t[7]=0,t[8]=m+_,t[9]=y-v,t[10]=1-d-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function JQ(t,e,r,i,s,n,o){const l=1/(r-e),u=1/(s-i),d=1/(n-o);return t[0]=2*n*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*n*u,t[6]=0,t[7]=0,t[8]=(r+e)*l,t[9]=(s+i)*u,t[10]=(o+n)*d,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*n*2*d,t[15]=0,t}function YQ(t,e,r,i,s){const n=1/Math.tan(e/2);let o;return t[0]=n/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(o=1/(i-s),t[10]=(s+i)*o,t[14]=2*s*i*o):(t[10]=-1,t[14]=-2*i),t}function KQ(t,e,r,i){const s=Math.tan(e.upDegrees*Math.PI/180),n=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),l=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+l),d=2/(s+n);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=-(o-l)*u*.5,t[9]=(s-n)*d*.5,t[10]=i/(r-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*r/(r-i),t[15]=0,t}function QQ(t,e,r,i,s,n,o){const l=1/(e-r),u=1/(i-s),d=1/(n-o);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*d,t[11]=0,t[12]=(e+r)*l,t[13]=(s+i)*u,t[14]=(o+n)*d,t[15]=1,t}function XQ(t,e,r,i){const s=e[0],n=e[1],o=e[2];let l=s-r[0],u=n-r[1],d=o-r[2];const p=Kr();if(Math.abs(l)<p&&Math.abs(u)<p&&Math.abs(d)<p)return void Bw(t);let f=1/Math.sqrt(l*l+u*u+d*d);l*=f,u*=f,d*=f;const m=i[0],y=i[1],g=i[2];let v=y*d-g*u,_=g*l-m*d,S=m*u-y*l;f=Math.sqrt(v*v+_*_+S*S),f?(f=1/f,v*=f,_*=f,S*=f):(v=0,_=0,S=0);let M=u*S-d*_,C=d*v-l*S,T=l*_-u*v;f=Math.sqrt(M*M+C*C+T*T),f?(f=1/f,M*=f,C*=f,T*=f):(M=0,C=0,T=0),t[0]=v,t[1]=M,t[2]=l,t[3]=0,t[4]=_,t[5]=C,t[6]=u,t[7]=0,t[8]=S,t[9]=T,t[10]=d,t[11]=0,t[12]=-(v*s+_*n+S*o),t[13]=-(M*s+C*n+T*o),t[14]=-(l*s+u*n+d*o),t[15]=1}function eX(t,e,r,i){const s=e[0],n=e[1],o=e[2],l=i[0],u=i[1],d=i[2];let p=s-r[0],f=n-r[1],m=o-r[2],y=p*p+f*f+m*m;y>0&&(y=1/Math.sqrt(y),p*=y,f*=y,m*=y);let g=u*m-d*f,v=d*p-l*m,_=l*f-u*p;return y=g*g+v*v+_*_,y>0&&(y=1/Math.sqrt(y),g*=y,v*=y,_*=y),t[0]=g,t[1]=v,t[2]=_,t[3]=0,t[4]=f*_-m*v,t[5]=m*g-p*_,t[6]=p*v-f*g,t[7]=0,t[8]=p,t[9]=f,t[10]=m,t[11]=0,t[12]=s,t[13]=n,t[14]=o,t[15]=1,t}function tX(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function rX(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function iX(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function oD(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function sX(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function nX(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t[9]=e[9]+r[9]*i,t[10]=e[10]+r[10]*i,t[11]=e[11]+r[11]*i,t[12]=e[12]+r[12]*i,t[13]=e[13]+r[13]*i,t[14]=e[14]+r[14]*i,t[15]=e[15]+r[15]*i,t}function oX(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function aX(t,e){if(t===e)return!0;const r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],l=t[5],u=t[6],d=t[7],p=t[8],f=t[9],m=t[10],y=t[11],g=t[12],v=t[13],_=t[14],S=t[15],M=e[0],C=e[1],T=e[2],O=e[3],P=e[4],D=e[5],z=e[6],B=e[7],G=e[8],Q=e[9],oe=e[10],Pe=e[11],fe=e[12],Ft=e[13],_i=e[14],nr=e[15],Ne=Kr();return Math.abs(r-M)<=Ne*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(i-C)<=Ne*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(s-T)<=Ne*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(n-O)<=Ne*Math.max(1,Math.abs(n),Math.abs(O))&&Math.abs(o-P)<=Ne*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(l-D)<=Ne*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(u-z)<=Ne*Math.max(1,Math.abs(u),Math.abs(z))&&Math.abs(d-B)<=Ne*Math.max(1,Math.abs(d),Math.abs(B))&&Math.abs(p-G)<=Ne*Math.max(1,Math.abs(p),Math.abs(G))&&Math.abs(f-Q)<=Ne*Math.max(1,Math.abs(f),Math.abs(Q))&&Math.abs(m-oe)<=Ne*Math.max(1,Math.abs(m),Math.abs(oe))&&Math.abs(y-Pe)<=Ne*Math.max(1,Math.abs(y),Math.abs(Pe))&&Math.abs(g-fe)<=Ne*Math.max(1,Math.abs(g),Math.abs(fe))&&Math.abs(v-Ft)<=Ne*Math.max(1,Math.abs(v),Math.abs(Ft))&&Math.abs(_-_i)<=Ne*Math.max(1,Math.abs(_),Math.abs(_i))&&Math.abs(S-nr)<=Ne*Math.max(1,Math.abs(S),Math.abs(nr))}function lX(t){const e=Kr(),r=t[0],i=t[1],s=t[2],n=t[4],o=t[5],l=t[6],u=t[8],d=t[9],p=t[10];return Math.abs(1-(r*r+n*n+u*u))<=e&&Math.abs(1-(i*i+o*o+d*d))<=e&&Math.abs(1-(s*s+l*l+p*p))<=e}function uX(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const cX=sD,dX=oD;Object.freeze(Object.defineProperty({__proto__:null,add:iX,adjoint:IQ,copy:rD,determinant:EQ,equals:aX,exactEquals:oX,frob:rX,fromQuat:ZQ,fromQuat2:zQ,fromRotation:NQ,fromRotationTranslation:nD,fromRotationTranslationScale:HQ,fromRotationTranslationScaleOrigin:WQ,fromScaling:FQ,fromTranslation:LQ,fromXRotation:DQ,fromYRotation:jQ,fromZRotation:VQ,frustum:JQ,getRotation:BQ,getScale:GQ,getTranslation:qQ,hasIdentityRotation:uX,identity:Bw,invert:iD,invertOrIdentity:MQ,isOrthoNormal:lX,lookAt:XQ,mul:cX,multiply:sD,multiplyScalar:sX,multiplyScalarAndAdd:nX,ortho:QQ,perspective:YQ,perspectiveFromFieldOfView:KQ,rotate:CQ,rotateX:PQ,rotateY:AQ,rotateZ:RQ,scale:kQ,set:ul,str:tX,sub:dX,subtract:oD,targetTo:eX,translate:OQ,transpose:cl},Symbol.toStringTag,{value:"Module"}));const hX=(t,e)=>{const r=ul(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return cl(r,r)},pX=(t,e)=>{const r=ul(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return cl(r,r)},fX=(t,e)=>{const r=1-e,i=ul(t,.2126+.7874*r,.7152-.7152*r,.0722-.0722*r,0,.2126-.2126*r,.7152+.2848*r,.0722-.0722*r,0,.2126-.2126*r,.7152-.7152*r,.0722+.9278*r,0,0,0,0,1);return cl(i,i)},mX=(t,e)=>{const r=Math.sin(e*Math.PI/180),i=Math.cos(e*Math.PI/180),s=ul(t,.213+.787*i-.213*r,.715-.715*i-.715*r,.072-.072*i+.928*r,0,.213-.213*i+.143*r,.715+.285*i+.14*r,.072-.072*i-.283*r,0,.213-.213*i-.787*r,.715-.715*i+.715*r,.072+.928*i+.072*r,0,0,0,0,1);return cl(s,s)},yX=(t,e)=>{const r=1-2*e,i=ul(t,r,0,0,e,0,r,0,e,0,0,r,e,0,0,0,1);return cl(i,i)},gX=(t,e)=>{const r=ul(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return cl(r,r)},vX=(t,e)=>{const r=1-e,i=ul(t,.393+.607*r,.769-.769*r,.189-.189*r,0,.349-.349*r,.686+.314*r,.168-.168*r,0,.272-.272*r,.534-.534*r,.131+.869*r,0,0,0,0,1);return cl(i,i)};let aD=class lD{constructor(e,r,i){this.strength=e,this.radius=r,this.threshold=i,this.type="bloom"}interpolate(e,r,i){this.strength=hi(e.strength,r.strength,i),this.radius=hi(e.radius,r.radius,i),this.threshold=hi(e.threshold,r.threshold,i)}clone(){return new lD(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:Gf(this.radius),strength:this.strength,threshold:this.threshold}}},uD=class cD{constructor(e){this.radius=e,this.type="blur"}interpolate(e,r,i){this.radius=Math.round(hi(e.radius,r.radius,i))}clone(){return new cD(this.radius)}toJSON(){return{type:"blur",radius:Gf(this.radius)}}},MS=class dD{constructor(e,r){this.type=e,this.amount=r,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,r,i){this.amount=hi(e.amount,r.amount,i),this._updateMatrix()}clone(){return new dD(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const e=this._colorMatrix||Gw();switch(this.type){case"brightness":this._colorMatrix=hX(e,this.amount);break;case"contrast":this._colorMatrix=pX(e,this.amount);break;case"grayscale":this._colorMatrix=fX(e,this.amount);break;case"invert":this._colorMatrix=yX(e,this.amount);break;case"saturate":this._colorMatrix=gX(e,this.amount);break;case"sepia":this._colorMatrix=vX(e,this.amount)}}},hD=class pD{constructor(e,r,i,s){this.offsetX=e,this.offsetY=r,this.blurRadius=i,this.color=s,this.type="drop-shadow"}interpolate(e,r,i){this.offsetX=hi(e.offsetX,r.offsetX,i),this.offsetY=hi(e.offsetY,r.offsetY,i),this.blurRadius=hi(e.blurRadius,r.blurRadius,i),this.color[0]=Math.round(hi(e.color[0],r.color[0],i)),this.color[1]=Math.round(hi(e.color[1],r.color[1],i)),this.color[2]=Math.round(hi(e.color[2],r.color[2],i)),this.color[3]=hi(e.color[3],r.color[3],i)}clone(){return new pD(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const e=[...this.color];return e[3]*=255,{type:"drop-shadow",xoffset:Gf(this.offsetX),yoffset:Gf(this.offsetY),blurRadius:Gf(this.blurRadius),color:e}}},fD=class mD{constructor(e){this.angle=e,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,r,i){this.angle=hi(e.angle,r.angle,i),this._updateMatrix()}clone(){return new mD(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const e=this._colorMatrix||Gw();this._colorMatrix=mX(e,this.angle)}},yD=class gD{constructor(e){this.amount=e,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(e,r,i){this.amount=hi(e.amount,r.amount,i)}clone(){return new gD(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function hi(t,e,r){return t+(e-t)*r}function Gf(t){return Math.round(1e3*gs(t))/1e3}function wX(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new MS(t.type,0);case"saturate":case"brightness":case"contrast":return new MS(t.type,1);case"opacity":return new yD(1);case"hue-rotate":return new fD(0);case"blur":return new uD(0);case"drop-shadow":return new hD(0,0,0,[...sM("transparent")]);case"bloom":return new aD(0,0,1)}}function bX(t,e){const r=t.length>e.length?t:e;return(t.length>e.length?e:t).every((i,s)=>i.type===r[s].type)}function _X(t,e){const r=t.length>e.length?t:e,i=t.length>e.length?e:t;for(let s=i.length;s<r.length;s++)i.push(wX(r[s]))}function SX(t){const e=t[0];return!!e&&"type"in e}const s1=()=>L.getLogger("esri.support.basemapUtils");function $X(){return{}}function xX(t){for(const e in t){const r=t[e];r&&!r.destroyed&&r.destroy(),delete t[e]}}function TX(t,e){let r;if(typeof t=="string"){const i=t in B_,s=!i&&t.includes("/");if(!i&&!s){if(b_())s1().warn(`Unable to find basemap definition for: ${t}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const n=Object.entries(B_).filter(([o,l])=>l.classic||l.is3d).map(([o])=>`"${o}"`).sort().join(", ");s1().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${n}`)}return null}e&&(r=e[t]),r||(r=i?Df.fromId(t):new Df({style:{id:t}}),e&&(e[t]=r))}else r=ut(Df,t);return r?.destroyed&&(s1().warn("The provided basemap is already destroyed",{basemap:r}),r=null),r}function MX(t){return new Zs({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const r=[];return"tables"in e&&r.push(e.tables),"layers"in e&&r.push(e.layers),r},itemFilterFunction:e=>{const r=e.parent;return!!r&&"tables"in r&&r.tables.includes(e)}})}function zy(t){for(const e of t.values())e?.destroy();t.clear()}const dO={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function IX(t){let e=null;if(typeof t=="string")if(t in dO){const r=dO[t];e=new kv({resourceInfo:{data:{layers:[r]}}})}else L.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=ut(kv,t);return e}function IS(t,e,r){let i,s;if(t)for(let n=0,o=t.length;n<o;n++){if(i=t.at(n),i?.[e]===r)return i;if(i?.type==="group"&&(s=IS(i.layers,e,r),s))return s}}const EX=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.layers=new H;const s=l=>{l.parent&&l.removeFromParent()},n=l=>{l.parent=this,this.layerAdded(l),l.type!=="elevation"&&l.type!=="base-elevation"||L.getLogger(this).error(`Layer 'title:${l.title}, id:${l.id}' of type '${l.type}' is not supported as an operational layer and will therefore be ignored.`)},o=l=>{l.parent=null,this.layerRemoved(l)};this.addHandles([this.layers.on("before-add",l=>{if(l.item===this)return l.preventDefault(),void L.getLogger(this).error("#add()","Cannot add layer to itself.");s(l.item)}),this.layers.on("after-add",l=>n(l.item)),this.layers.on("after-remove",l=>o(l.item))])}destroy(){const i=this.layers.toArray();for(const s of i)s.destroy();this.layers.destroy()}removeChildLayer(i){this.layers.remove(i),super.removeChildLayer?.(i)}set layers(i){this._set("layers",Pn(i,this._get("layers")))}add(i,s){const n=this.layers;if(s=n.getNextIndex(s),i instanceof tt){const o=i;o.parent===this?this.reorder(o,s):n.add(o,s)}else Pr(i)?i.then(o=>{this.destroyed||this.add(o,s)}):L.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(i,s){const n=this.layers;let o=n.getNextIndex(s);i.slice().forEach(l=>{l.parent!==this?(n.add(l,o),o+=1):this.reorder(l,o)})}findLayerById(i){return IS(this.layers,"id",i)}findLayerByUid(i){return IS(this.layers,"uid",i)}remove(i){return this.layers.remove(i)}removeMany(i){return this.layers.removeMany(i)}removeAll(){return this.layers.removeAll()}reorder(i,s){return this.layers.reorder(i,s)}layerAdded(i){}layerRemoved(i){}};return a([c()],r.prototype,"layers",null),r=a([b("esri.support.LayersMixin")],r),r},OX=new Set(["feature","subtype-group"]);function ES(t,e,r){if(t)for(let i=0,s=t.length;i<s;i++){const n=t.at(i);if(n[e]===r)return n;if(n?.type==="group"){const o=ES(n.tables,e,r);if(o)return o}}}const kX=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.tables=new H,this.addHandles([this.tables.on("after-add",s=>{const n=s.item;n.parent&&n.parent!==this&&n.removeFromParent(),n.parent=this,OX.has(n.type)||L.getLogger(this).error(`Layer 'title:${n.title}, id:${n.id}' of type '${n.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",s=>{s.item.parent=null})])}destroy(){const i=this.tables.toArray();for(const s of i)s.destroy();this.tables.destroy()}removeChildLayer(i){this.tables.remove(i),super.removeChildLayer?.(i)}set tables(i){this._set("tables",Pn(i,this._get("tables")))}findTableById(i){return ES(this.tables,"id",i)}findTableByUid(i){return ES(this.tables,"uid",i)}};return a([c()],r.prototype,"tables",null),r=a([b("esri.support.TablesMixin")],r),r};let Qi=class extends kX(EX(Zh)){constructor(e){super(e),this.allLayers=new Zs({getCollections:()=>[this.basemap?.baseLayers,this.basemap?.groundLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:r=>"layers"in r?r.layers:null}),this.focusAreas=new eD,this.allTables=MX(this),this.basemap=null,this.editableLayers=new Zs({getCollections:()=>[this.allLayers],itemFilterFunction:wQ}),this.ground=new kv,this._basemapCache=$X(),this.addHandles(qi(()=>this.ground,(r,i)=>{i?.parent===this&&(i.parent=null),r.parent=this},{sync:!0}))}destroy(){xX(this._basemapCache),this._basemapCache=null,this.focusAreas.destroy(),this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=Ke(this.basemap),Ke(this.ground),this._set("ground",null)}castBasemap(e){return TX(e,this._basemapCache)}castGround(e){return IX(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(r=>r.id===e)}findTableById(e){return this.allTables.find(r=>r.id===e)}};a([c({readOnly:!0,dependsOn:[]})],Qi.prototype,"allLayers",void 0),a([c({type:eD,nonNullable:!0,json:{write:{overridePolicy:t=>({enabled:t.areas.length>0,ignoreOrigin:!0})}}})],Qi.prototype,"focusAreas",void 0),a([c({readOnly:!0})],Qi.prototype,"allTables",void 0),a([c({type:Df,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Qi.prototype,"basemap",void 0),a([Ce("basemap")],Qi.prototype,"castBasemap",null),a([c({readOnly:!0})],Qi.prototype,"editableLayers",void 0),a([c({type:kv,nonNullable:!0})],Qi.prototype,"ground",void 0),a([Ce("ground")],Qi.prototype,"castGround",null),a([c()],Qi.prototype,"undoRedo",void 0),Qi=a([b("esri.Map")],Qi);const vD=Qi;let El=class extends nM{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return e!=null&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};a([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],El.prototype,"row",void 0),a([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],El.prototype,"column",void 0),a([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],El.prototype,"rows",void 0),a([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],El.prototype,"columns",void 0),El=a([b("esri.CameraLayout")],El);const wD=El;let Hw=class{constructor(e,r){this.min=e,this.max=r,this.range=r-e}normalize(e,r=0,i=!1){return hO(this.range,this.min,this.max,e,r,i)}clamp(e,r=0){return Gi(e-r,this.min,this.max)+r}monotonic(e,r,i){return e<r?r:r+OS(this.range,e-r,i)}minimalMonotonic(e,r,i){return hO(this.range,e,e+this.range,r,i)}center(e,r,i){return r=this.monotonic(e,r,i),this.normalize((e+r)/2,i)}diff(e,r,i){return this.monotonic(e,r,i)-e}shortestSignedDiff(e,r){e=this.normalize(e);const i=(r=this.normalize(r))-e,s=r<e?this.minimalMonotonic(e,r)-e:r-this.minimalMonotonic(r,e);return Math.abs(i)<Math.abs(s)?i:s}contains(e,r,i){return r=this.minimalMonotonic(e,r),(i=this.minimalMonotonic(e,i))>e&&i<r}};function hO(t,e,r,i,s=0,n=!1){return(i-=s)<e?i+=OS(t,e-i):i>r&&(i-=OS(t,i-r)),n&&i===r&&(i=e),i+s}function OS(t,e,r=0){return Math.ceil((e-r)/t)*t+r}const FSe=new Hw(0,2*Math.PI),NSe=new Hw(-Math.PI,Math.PI),CX=new Hw(0,360);let un=class extends pe(F){constructor(...e){super(...e),this.position=new ee([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new wD}normalizeCtorArgs(e,r,i,s){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const n={position:e};return r!=null&&(n.heading=r),i!=null&&(n.tilt=i),s!=null&&(n.fov=s),n}return e}writePosition(e,r,i,s){const n=e.clone();n.x=Br(e.x||0),n.y=Br(e.y||0),n.z=e.hasZ?Br(e.z||0):e.z,r[i]=n.write({},s)}readPosition(e,r){const i=new ee;return i.read(e,r),i.x=Br(i.x||0),i.y=Br(i.y||0),i.z=i.hasZ?Br(i.z||0):i.z,i}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};a([c({type:ee,json:{write:{isRequired:!0}}})],un.prototype,"position",void 0),a([q("position")],un.prototype,"writePosition",null),a([V("position")],un.prototype,"readPosition",null),a([c({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ce(t=>CX.normalize(Br(t)))],un.prototype,"heading",void 0),a([c({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ce(t=>Gi(Br(t),-180,180))],un.prototype,"tilt",void 0),a([c({type:Number,nonNullable:!0,json:{default:55,write:!0}}),Ce(t=>Gi(Br(t,55),1,170))],un.prototype,"fov",void 0),a([c({type:wD,nonNullable:!0,json:{read:!1,write:!1}})],un.prototype,"layout",void 0),un=a([b("esri.Camera")],un);const PX=un;function bD(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function _D(t){return t.points!==void 0}function SD(t){return t.x!==void 0&&t.y!==void 0}function $D(t){return t.paths!==void 0||t.curvePaths!==void 0}function Fd(t){return t.rings!==void 0||t.curveRings!==void 0}function tl(t){return t==null?null:t instanceof Ut?t:SD(t)?ee.fromJSON(t):$D(t)?At.fromJSON(t):Fd(t)?Be.fromJSON(t):_D(t)?zs.fromJSON(t):bD(t)?he.fromJSON(t):null}function rp(t){return t?SD(t)?"esriGeometryPoint":$D(t)?"esriGeometryPolyline":Fd(t)?"esriGeometryPolygon":bD(t)?"esriGeometryEnvelope":_D(t)?"esriGeometryMultipoint":null:null}const AX={esriGeometryPoint:ee,esriGeometryPolyline:At,esriGeometryPolygon:Be,esriGeometryEnvelope:he,esriGeometryMultipoint:zs,esriGeometryMultiPatch:Be};function RX(t){return t&&AX[t]||null}const LX=Lt()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),pO=Lt()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),uy={base:Ut,key:"type",typeMap:{extent:he,multipoint:zs,point:ee,polyline:At,polygon:Be}};function jSe(t){return t.type==="point"}function VSe(t){return t.type==="multipoint"}function zSe(t){return t.type==="polygon"}function USe(t){return t.type==="polyline"}var kS;let na=kS=class extends F{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new kS({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};a([c({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:n1}}}}})],na.prototype,"rotation",void 0),a([Ce("rotation")],na.prototype,"castRotation",null),a([c({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:n1}}}}})],na.prototype,"scale",void 0),a([c({types:uy,json:{read:tl,write:!0,origins:{"web-scene":{read:tl,write:{overridePolicy:n1}}}}})],na.prototype,"targetGeometry",void 0),a([c({type:PX,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],na.prototype,"camera",void 0),na=kS=a([b("esri.Viewpoint")],na);const ps=na;function n1(){return{enabled:!this.camera}}let Om=class{constructor(e=r=>r.values().next().value){this._peeker=e,this._observable=new Qm,this._items=new Set}get length(){return le(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return le(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const r=this.length;return this._items.forEach(i=>{e(i)||this._items.delete(i)}),r!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){le(this._observable),yield*this._items}};const xD=new FinalizationRegistry(t=>{t.close()});function FX(t,e){xD.register(t,e,e)}function NX(t){xD.unregister(t)}function TD(t,e){return new Proxy({},{get:(r,i,s)=>(...n)=>{let o,l;const u=n[n.length-1];return DX(u)&&(o=u.signal,l=u.transferList,n.pop()),t.apply(e?`${e}.${i.toString()}`:i.toString(),n,{transferList:l,signal:o})}})}function DX(t){return typeof t=="object"&&!Array.isArray(t)&&t!=null&&("signal"in t||"transferList"in t||Object.keys(t).length===0)}const jX={statsWorker:()=>N(()=>import("./statsWorker-BnBK0FRH.js"),__vite__mapDeps([19,20,21,22,23,24])),geometryEngineWorker:()=>N(()=>import("./geometryEngineWorker-BkMQzpX8.js"),__vite__mapDeps([25,26,27,28])),arcadeGeometryOperatorsWorker:()=>N(()=>import("./operatorsWorker-D55gYS6G.js"),[]),CSVSourceWorker:()=>N(()=>import("./CSVSourceWorker-D4AIwthH.js"),__vite__mapDeps([29,30,31,4,32,33,34,35,36,37,38,39,40,41,42,43,21,20,22,23,24,44,45,46,47,48])),EdgeProcessingWorker:()=>N(()=>import("./EdgeProcessingWorker-DxvLKpwV.js"),__vite__mapDeps([49,50,51,52,53,54,55,56,57,58,59])),ElevationSamplerWorker:()=>N(()=>import("./ElevationSamplerWorker-BYHIc4h-.js"),__vite__mapDeps([60,36,61,62,63,64,65,66,67,52,68])),FeatureServiceSnappingSourceWorker:()=>N(()=>import("./FeatureServiceSnappingSourceWorker-Bhzyx-yk.js"),__vite__mapDeps([69,32,33,31,4,34,35,36,37,38,39,40,41,42,43,21,20,22,23,24,44,45,70,71,72,73])),GaussianSplatSortWorker:()=>N(()=>import("./GaussianSplatSortWorker-CkystscD.js"),[]),GeoJSONSourceWorker:()=>N(()=>import("./GeoJSONSourceWorker-DOVOMDKk.js"),__vite__mapDeps([74,33,31,4,34,32,35,36,37,38,39,40,41,42,43,21,20,22,23,24,44,45,75,30,48,76])),LercWorker:()=>N(()=>import("./LercWorker-Dnn8ehqb.js"),[]),MemorySourceWorker:()=>N(()=>import("./MemorySourceWorker-C9uC2a-b.js"),__vite__mapDeps([77,33,31,4,34,78,32,35,36,37,38,39,40,41,42,43,21,20,22,23,24,44,45,48,76,30])),PBFDecoderWorker:()=>N(()=>import("./PBFDecoderWorker-Dypgvcmb.js"),__vite__mapDeps([79,80,4,33,31,34,71,72])),FeaturePipelineWorker:()=>N(()=>import("./FeaturePipelineWorker-CE_N_NaB.js"),__vite__mapDeps([81,82,83,84,54,85,86,31,4,33,34,87,21,88,38,37,89,90,91,92,93,94,95,96,97,98,99,39,40,41,42,43,20,22,23,24,44,45,100,101,102,103,17,104,105,106,107,75,30,48,76,73,71,72,108,109])),PointCloudWorker:()=>N(()=>import("./PointCloudWorker-B4qS1_e9.js"),__vite__mapDeps([110,111,112,113,114,115,116,63,64,117,118])),RasterWorker:()=>N(()=>import("./RasterWorker-8Xi1yupn.js"),__vite__mapDeps([119,120,121,28,122,123,124,125,126,127,128])),SceneLayerSnappingSourceWorker:()=>N(()=>import("./SceneLayerSnappingSourceWorker-BPKCO35g.js"),__vite__mapDeps([129,130,131,118,112,132,133,117,52,56,57,58,51,53,54,55,59])),SceneLayerWorker:()=>N(()=>import("./SceneLayerWorker-D2IZWqI3.js"),__vite__mapDeps([134,61,67,135,65])),WFSSourceWorker:()=>N(()=>import("./WFSSourceWorker-C7pJzb94.js"),__vite__mapDeps([136,33,31,4,34,32,35,36,37,38,39,40,41,42,43,21,20,22,23,24,44,45,75,30,76,137,138])),WorkerTileHandler:()=>N(()=>import("./WorkerTileHandler-BBC_HAvy.js"),__vite__mapDeps([139,94,140,95,141,72,4,97,142,143,55,54,123,144,93])),Lyr3DWorker:()=>N(()=>import("./Lyr3DWorker-Cg22h3Jm.js"),[]),Feature3DPipelineWorker:()=>N(()=>import("./Feature3DPipelineWorker-IlSGpVpD.js"),__vite__mapDeps([145,40,33,31,4,34,41,42,37,38,43,21,20,22,23,24,44,45,146,66,61,135,65,147,113,148,58,52,149,131,118,112,130,150,151,133,117,116,111,63,64,55,54,51,53,152,153,154,155,156,157,158,159,160,161,36,73,71,72,162])),TextureCompressionWorker:()=>N(()=>import("./TextureCompressionWorker-Cz6WzA0Q.js"),[]),FlowWorker:()=>N(()=>import("./FlowWorker-bE1G6TOV.js"),__vite__mapDeps([163,128])),ParquetSourceWorker:()=>N(()=>import("./ParquetSourceWorker-B9IXp_x_.js"),__vite__mapDeps([164,99,40,33,31,4,34,41,42,37,38,43,21,20,22,23,24,44,45,48,165,47,102,86,87,101,100])),PanoramicMeshWorker:()=>N(()=>import("./PanoramicMeshWorker-C13pwgGO.js"),__vite__mapDeps([166,120]))},MD="worker:port-closed",Fo={HANDSHAKE:0,OPEN:1,OPENED:2,RESPONSE:3,INVOKE:4,ABORT:5,CLOSE:6,OPEN_PORT:7,ON:8};let VX=0;function ID(){return VX++}function zX(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function Av(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function ED(t,e,r,i){if(e.type===Fo.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==Fo.INVOKE&&e.type!==Fo.RESPONSE)return void t.postMessage(e);let s;zX(r)?(s=fO(r.transferList),e.data=r.result):(s=fO(i),e.data=r),s?t.postMessage(e,s):t.postMessage(e)}function km(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function fO(t){if(!t?.length)return null;if(k("esri-workers-arraybuffer-transfer"))return t;const e=t.filter(r=>!UX(r));return e.length?e:null}function UX(t){return t instanceof ArrayBuffer||t?.constructor?.name==="ArrayBuffer"}async function GSe(t){try{return await t}catch(e){const r=e?.name===MD;if(!(sr(e)||r))throw e;return}}const{CLOSE:Uy,ABORT:CS,INVOKE:mO,RESPONSE:Sp,OPEN_PORT:yO,ON:gO}=Fo,qX=2;let GX=class{constructor(e){this._invoke=e,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(e){e.type===CS?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}};var ns;let Eh=(ns=class{static connect(e,r){const i=new MessageChannel;let s;s=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const n=new ns(i.port1,{channel:i,client:s,schedule:r});return typeof s=="object"&&"remoteClient"in s&&(s.remoteClient=n),ns.clients.set(n,s),i.port2}static loadWorker(e){const r=jX[e];return r?r():Promise.resolve(null)}constructor(e,r,i,s){this._port=e,this._jobQueue=i,this._lowPriorityJobQueue=s,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new GX(n=>this._onInvokeMessage(n)),this._client=r.client,this._onMessage=this._onMessage.bind(this),this._channel=r.channel,this._schedule=r.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:Uy}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,r,i){return this.apply(e,[r],i)}apply(e,r,i){const s=i?.signal,n=i?.transferList;if(!this._port)return Promise.reject(new x(MD,`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:r}));const o=ID();return new Promise((l,u)=>{if(Cr(s))return this._processWork(),void u(Fe());const d=ys(s,()=>{const f=this._outJobs.get(o);f&&(this._outJobs.delete(o),this._processWork(),He(f.abortHandle),this._post({type:CS,jobId:o}),u(Fe()))}),p={resolve:l,reject:u,abortHandle:d,debugInfo:e};this._outJobs.set(o,p),this._post({type:mO,jobId:o,methodName:e,abortable:s!=null},r,n)})}createInvokeProxy(e){return TD(this,e)}on(e,r){const i=new MessageChannel;function s(n){r(n.data)}return this._port.postMessage({type:gO,eventType:e,port:i.port2},[i.port2]),i.port1.addEventListener("message",s),i.port1.start(),Te(()=>{i.port1.postMessage({type:Uy}),i.port1.close(),i.port1.removeEventListener("message",s)})}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:yO,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=qX)return;const e=this._jobQueue?.pop()??this._lowPriorityJobQueue?.pop();if(!e)return;const{methodName:r,data:i,invokeOptions:s,resolver:n}=e;this.apply(r,i,s).then(o=>n.resolve(o)).catch(o=>n.reject(o))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{He(e.abortHandle),e.reject(Fe(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null,this._onMessage=null,this._channel=null,this._jobQueue=void 0,this._invokeQueue=void 0,this._lowPriorityJobQueue=void 0}_onMessage(e){this._schedule!=null?this._schedule(()=>this._processMessage(e,!0)):this._processMessage(e,!1)}_processMessage(e,r){const i=km(e);if(i)switch(i.type){case Sp:this._onResponseMessage(i);break;case mO:r?this._onInvokeMessage(i):this._invokeQueue.push(i);break;case CS:this._onAbortMessage(i);break;case Uy:this._onCloseMessage();break;case yO:this._onOpenPortMessage(i);break;case gO:this._onOnMessage(i)}}_onAbortMessage(e){const r=this._inJobs,i=e.jobId,s=r.get(i);this._invokeQueue.push(e),s&&(s.controller&&s.controller.abort(),r.delete(i))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&ns.clients.get(this)===e&&e.destroy(),ns.clients.delete(this),e?.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:r,jobId:i,data:s=[],abortable:n}=e,o=n?new AbortController:null,l=this._inJobs;let u,d=this._client,p=d[r];try{if(!p&&r&&r.includes(".")){const f=r.split(".");for(let m=0;m<f.length-1;m++)d=d[f[m]],p=d[f[m+1]]}if(typeof p!="function")throw new TypeError(`${r} is not a function`);s.push({client:this,signal:o?o.signal:null}),u=p.apply(d,s)}catch(f){return void this._post({type:Sp,jobId:i,error:Av(f)})}Pr(u)?(l.set(i,{controller:o,promise:u}),u.then(f=>{l.has(i)&&(l.delete(i),this._post({type:Sp,jobId:i},f))},f=>{l.has(i)&&(l.delete(i),sr(f)||this._post({type:Sp,jobId:i,error:Av(f||{message:`Error encountered at method ${r}`})}))})):this._post({type:Sp,jobId:i},u)}_onOpenPortMessage(e){new ns(e.port,{client:this._client})}_onOnMessage(e){const{port:r}=e,i=this._client.on(e.eventType,n=>{r.postMessage(n)}),s=zh(e.port,"message",n=>{km(n)?.type===Uy&&(s.remove(),i.remove(),r.close())})}_onResponseMessage(e){const{jobId:r,error:i,data:s}=e,n=this._outJobs;if(!n.has(r))return;const o=n.get(r);n.delete(r),this._processWork(),He(o.abortHandle),i?o.reject(x.fromJSON(JSON.parse(i))):o.resolve(s)}_post(e,r,i){return ED(this._port,e,r,i)}},ns.kernelInfo={buildDate:mR,fullVersion:hT,revision:yR},ns.clients=new Map,ns),BX=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new Om,this._ongoingLowPriorityJobsQueue=new Om}destroy(){this.close()}get closed(){return!this._clients?.length}open(e,r){return new Promise((i,s)=>{let n=!0;const o=l=>{We(r.signal),n&&(n=!1,l())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let l=0;l<e.length;++l){const u=e[l];Pr(u)?this._clientPromises[l]=u.then(d=>(this._clients[l]=new Eh(d,r,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),o(i),this._clients[l]),()=>(o(s),null)):(this._clients[l]=new Eh(u,r,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),this._clientPromises[l]=Promise.resolve(this._clients[l]),o(i))}})}broadcast(e,r,i){const s=new Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n){const o=this._clientPromises[n];s[n]=o.then(l=>l?.invoke(e,r,i))}return s}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(Fe(`Worker closing, aborting job calling '${e.methodName}'`));for(;e=this._ongoingLowPriorityJobsQueue.pop();)e.resolver.reject(Fe(`Worker closing, aborting job calling '${e.methodName}'`));for(const r of this._clientPromises)r.then(i=>i?.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,NX(this)}invoke(e,r,i){return this.apply(e,[r],i)}apply(e,r,i){const s=wi();(i?.priority==="low"?this._ongoingLowPriorityJobsQueue:this._ongoingJobsQueue).push({methodName:e,data:r,invokeOptions:i,resolver:s});for(let n=0;n<this._clientPromises.length;n++){const o=this._clients[n];o?o.jobAdded():this._clientPromises[n].then(l=>l?.jobAdded())}return s.promise}createInvokeProxy(e){return TD(this,e)}on(e,r){return Promise.all(this._clientPromises).then(()=>Uu(this._clients.map(i=>i.on(e,r))))}openPorts(){return new Promise(e=>{const r=new Array(this._clientPromises.length);let i=r.length;for(let s=0;s<this._clientPromises.length;++s)this._clientPromises[s].then(n=>{n&&(r[s]=n.openPort()),--i===0&&e(r)})})}get test(){}};const HX={async request(t,e){const r=t.options,i=r.responseType;r.signal=e?.signal,r.responseType=i==="native"||i==="native-request-init"?"native-request-init":i&&["blob","json","text"].includes(i)&&f_(t.url)?.after?i:"array-buffer";const s=await Ae(t.url,r),n={data:s.data,httpStatus:s.httpStatus,ssl:s.ssl};switch(s.requestOptions?.responseType){case"native-request-init":return delete n.data.signal,n;case"blob":n.data=await n.data.arrayBuffer();break;case"json":n.data=new TextEncoder().encode(JSON.stringify(n.data)).buffer;break;case"text":n.data=new TextEncoder().encode(n.data).buffer}return{result:n,transferList:[n.data]}}},vO={};function WX(t){const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages?.slice()||[],paths:{...vO.paths,...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=vO.baseUrl),e}let ZX=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(r=>{this[r]=(...i)=>e[r](...i)})}},Xg=class{constructor(){this._dispatcher=new ZX,this._workerPostMessage({type:Fo.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){ov(()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))})}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,r,i){this._dispatcher.addEventListener(e,r,i)}removeEventListener(e,r,i){this._dispatcher.removeEventListener(e,r,i)}_workerPostMessage(e){ov(()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))})}async _workerMessageHandler(e){const r=km(e);if(r&&r.type===Fo.OPEN){const{modulePath:i,jobId:s}=r;let n=await Eh.loadWorker(i);n||(n=await import(i));const o=Eh.connect(n);this._workerPostMessage({type:Fo.OPENED,jobId:s,data:o})}}};const PS=()=>L.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:JX}=Fo,YX='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}).finally(()=>{t&&t.removeEventListener("abort",s)})}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://esriurl.com/using-local-assets.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(e=>e||new Promise(e=>{require([o.modulePath],e)})).then(t)}):"System"in self&&"function"==typeof System.import?System.import(workerPath).then(e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath))).then(e=>e||System.import(o.modulePath)).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(e=>e||import(o.modulePath)).then(t)}):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let qy,Gy;const wO="Failed to create Worker. Fallback to execute module in main thread";async function KX(){if(!k("esri-workers"))return bO(new Xg);if(!qy&&!Gy)try{const e=YX.split("{CONFIGURATION}").join(QX());qy=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){Gy=e||{}}let t;if(qy)try{t=new Worker(qy,{name:"esri-worker-"+XX++})}catch{PS().warn(wO,Gy),t=new Xg}else PS().warn(wO,Gy),t=new Xg;return bO(t)}async function bO(t){return new Promise(e=>{function r(s){const n=km(s);n&&n.type===JX&&(t.removeEventListener("message",r),t.removeEventListener("error",i),e(t))}function i(s){s.preventDefault(),t.removeEventListener("message",r),t.removeEventListener("error",i),PS().warn("Failed to create Worker. Fallback to execute module in main thread",s),(t=new Xg).addEventListener("message",r),t.addEventListener("error",i)}t.addEventListener("message",r),t.addEventListener("error",i)})}function QX(){let t;if(_e.default!=null){const s={..._e};delete s.default,t=JSON.parse(JSON.stringify(s))}else t=JSON.parse(JSON.stringify(_e));t.assetsPath=as(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?as(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=gi(),t.has={"esri-csp-restrictions":k("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":k("esri-2d-update-debug"),"esri-2d-log-updating":k("esri-2d-log-updating"),"featurelayer-pbf":k("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":k("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":k("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":k("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":k("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":k("featurelayer-query-max-depth"),"featurelayer-query-tile-max-features":k("featurelayer-query-tile-max-features"),"featurelayer-query-tile-concurrency":k("featurelayer-query-tile-concurrency"),"featurelayer-query-pausing-enabled":k("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-concurrency":k("featurelayer-snapshot-concurrency"),"featurelayer-snapshot-enabled":k("featurelayer-snapshot-enabled"),"parquetlayer-full-query-feature-count":k("parquetlayer-full-query-feature-count"),"esri-atomics":k("esri-atomics"),"esri-shared-array-buffer":k("esri-shared-array-buffer"),"esri-tiles-debug":k("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":k("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":k("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=as(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=as(t.workers.workerPath):t.workers.workerPath=as(nt("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=_e.workers.loaderConfig,r=WX({baseUrl:e?.baseUrl,locale:gi(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e?.has},map:{...e?.map},paths:{...e?.paths},packages:e?.packages||[]});return JSON.stringify({esriConfig:t,loaderConfig:r,kernelInfo:{buildDate:mR,fullVersion:hT,revision:yR}})}let XX=0;const{ABORT:_O,INVOKE:eee,OPEN:tee,OPENED:ree,RESPONSE:$p}=Fo;let iee=class OD{static async create(e){const r=await KX();return new OD(r,e)}constructor(e,r){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=r,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",i=>{i.preventDefault(),L.getLogger("esri.core.workers.WorkerOwner").error(i)})}terminate(){this.worker.terminate()}async open(e,r={}){const{signal:i}=r,s=ID();return new Promise((n,o)=>{const l={resolve:n,reject:o,abortHandle:pT(i,()=>{this._outJobs.delete(s),this._post({type:_O,jobId:s})})};this._outJobs.set(s,l),this._post({type:tee,jobId:s,modulePath:e})})}_onMessage(e){const r=km(e);if(r)switch(r.type){case ree:this._onOpenedMessage(r);break;case $p:this._onResponseMessage(r);break;case _O:this._onAbortMessage(r);break;case eee:this._onInvokeMessage(r)}}_onAbortMessage(e){const r=this._inJobs,i=e.jobId,s=r.get(i);s&&(s.controller&&s.controller.abort(),r.delete(i))}_onInvokeMessage(e){const{methodName:r,jobId:i,data:s,abortable:n}=e,o=n?new AbortController:null,l=this._inJobs,u=HX[r];let d;try{if(typeof u!="function")throw new TypeError(`${r} is not a function`);d=u.call(null,s,{signal:o?o.signal:null})}catch(p){return void this._post({type:$p,jobId:i,error:Av(p)})}Pr(d)?(l.set(i,{controller:o,promise:d}),d.then(p=>{l.has(i)&&(l.delete(i),this._post({type:$p,jobId:i},p))},p=>{l.has(i)&&(l.delete(i),p||(p={message:"Error encountered at method"+r}),sr(p)||this._post({type:$p,jobId:i,error:Av(p||{message:`Error encountered at method ${r}`})}))})):this._post({type:$p,jobId:i},d)}_onOpenedMessage(e){const{jobId:r,data:i}=e,s=this._outJobs.get(r);s&&(this._outJobs.delete(r),He(s.abortHandle),s.resolve(i))}_onResponseMessage(e){const{jobId:r,error:i,data:s}=e,n=this._outJobs.get(r);n&&(this._outJobs.delete(r),He(n.abortHandle),i?n.reject(x.fromJSON(JSON.parse(i))):n.resolve(s))}_post(e,r,i){return ED(this.worker,e,r,i)}};const SO=k("host-browser")?Math.min(navigator.hardwareConcurrency-1,k("workers-pool-size")??8):0;let su=k("esri-mobile")?Math.min(SO,3):SO;su||(su=k("safari")&&k("mac")?7:2);let $O=0;const e0=[];function see(){kD()}async function By(t,e){const r=new BX,{registryTarget:i,...s}=e;return await r.open(t,s),i&&FX(i,r),r}async function nee(t,e={}){if(typeof t!="string")throw new x("workers:undefined-module","modulePath is missing");let r=e.strategy||"distributed";if(k("host-webworker")&&!k("esri-workers")&&(r="local"),r==="local"){let i=await Eh.loadWorker(t);i||(i=await import(t)),We(e.signal);const s=e.client||i;return By([Eh.connect(i,e.schedule)],{...e,client:s})}if(await kD(),We(e.signal),r==="dedicated"){const i=$O++%su;return By([await e0[i].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const i=Math.min(e.maxNumWorkers,su);if(i<su){const s=new Array(i);for(let n=0;n<i;++n){const o=$O++%su;s[n]=e0[o].open(t,e)}return By(s,e)}}return By(e0.map(i=>i.open(t,e)),e)}let Hy=null;async function kD(){if(Hy)return Hy;new AbortController;const t=[];for(let e=0;e<su;e++){const r=iee.create(e).then(i=>(e0[e]=i,i));t.push(r)}return Hy=Promise.all(t),Hy}let Bf=class extends H{constructor(e){super(e),this.addHandles([this.on("before-add",r=>{r.item==null&&r.preventDefault()}),this.on("after-add",r=>this._own(r.item)),this.on("after-remove",r=>this._release(r.item))])}get owner(){return this._get("owner")}set owner(e){this.destroyed||e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(H.ofType(this.itemType.Type))(e):new H(e)}};function AS(t,e){return{type:t,cast:$L,set(r){const i=Pn(r,this._get(e),t);i&&!i.destroyed&&(i.owner=this),this._set(e,i)}}}a([c()],Bf.prototype,"owner",null),Bf=a([b("esri.core.support.OwningCollection")],Bf);var RS,Ud;let hr=(Ud=class extends F{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new RS({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}},RS=Ud,Ud);a([c({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],hr.prototype,"cols",void 0),a([c({type:xe,json:{write:!0}})],hr.prototype,"level",void 0),a([c({type:String,json:{write:!0}})],hr.prototype,"levelValue",void 0),a([c({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],hr.prototype,"origin",void 0),a([c({type:Number,json:{write:!0}})],hr.prototype,"resolution",void 0),a([c({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],hr.prototype,"rows",void 0),a([c({type:Number,json:{write:!0}})],hr.prototype,"scale",void 0),hr=RS=a([b("esri.layers.support.LOD")],hr);let oee=class CD{constructor(e,r,i,s=mi()){this._level=e,this._row=r,this._col=i,this.extent=s}get id(){return this._id??=`${this.level}/${this.row}/${this.col}`,this._id}get level(){return this._level}set level(e){this._level=e,this._id=null}get row(){return this._row}set row(e){this._row=e,this._id=null}get col(){return this._col}set col(e){this._col=e,this._id=null}toJSON(){return{level:this._level,row:this._row,col:this._col,extent:this.extent}}static fromJSON(e){return new CD(e.level,e.row,e.col,e.extent)}};var xc;const xO=new $e({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});var qd;let Fr=(qd=class extends F{static create(e={}){const{resolutionFactor:r=1,scales:i,size:s=256,spatialReference:n=Z.WebMercator,numLODs:o=24}=e;if(!Fi(n)){const m=[];if(i)for(let y=0;y<i.length;y++){const g=i[y];m.push(new hr({level:y,scale:g,resolution:g}))}else{let y=5e-4;for(let g=o-1;g>=0;g--)m.unshift(new hr({level:g,scale:y,resolution:y})),y*=2}return new xc({dpi:96,lods:m,origin:new ee(0,0,n),size:[s,s],spatialReference:n})}const l=Yr(n),u=e.origin?new ee({x:e.origin.x,y:e.origin.y,spatialReference:n}):new ee(l?{x:l.origin[0],y:l.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),d=96,p=1/(Bi(n)*39.37*d),f=[];if(i)for(let m=0;m<i.length;m++){const y=i[m],g=y*p;f.push(new hr({level:m,scale:y,resolution:g}))}else{let m=Jh(n)?512/s*5916575275917094e-7:256/s*591657527591555e-6;const y=Math.ceil(o/r);f.push(new hr({level:0,scale:m,resolution:m*p}));for(let g=1;g<y;g++){const v=m/2**r,_=v*p;f.push(new hr({level:g,scale:v,resolution:_})),m=v}}return new xc({dpi:d,lods:f,origin:u,size:[s,s],spatialReference:n})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:r}=this;if(e&&r){const i=Yr(e);return e.isWrappable&&!!i&&Math.abs(i.origin[0]-r.x)<=i.dx}return!1}readOrigin(e,r){return ee.fromJSON({spatialReference:r.spatialReference,...e})}set lods(e){let r=0,i=0;const s=[],n=this._levelToLOD={};e&&(r=-1/0,i=1/0,e.forEach(o=>{s.push(o.scale),r=o.scale>r?o.scale:r,i=o.scale<i?o.scale:i,n[o.level]=o})),this._set("scales",s),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,r){return[r.cols,r.rows]}writeSize(e,r){r.cols=e[0],r.rows=e[1]}zoomToScale(e){const r=this.scales;if(e<=0)return r[0];if(e>=r.length-1)return r[r.length-1];const i=Math.floor(e),s=i+1;return r[i]/(r[i]/r[s])**(e-i)}scaleToZoom(e){const r=this.scales,i=r.length-1;let s=0;for(;s<i;s++){const n=r[s],o=r[s+1];if(n<=e)return s;if(o===e)return s+1;if(n>e&&o<e)return s+Math.log(n/e)/Math.log(n/o)}return s}tileAt(e,r,i,s){const n=this.lodAt(e);if(!n)return null;let o,l;if(typeof r=="number")o=r,l=i;else if(Ht(r.spatialReference,this.spatialReference))o=r.x,l=r.y,s=i;else{const p=Mw(r,this.spatialReference);if(p==null)return null;o=p.x,l=p.y,s=i}const u=n.resolution*this.size[0],d=n.resolution*this.size[1];return s??=new oee(0,0,0),s.level=e,s.row=Math.floor((this.origin.y-l)/d+.001),s.col=Math.floor((o-this.origin.x)/u+.001),this.updateTileInfo(s),s}updateTileInfo(e,r=0){if(!("extent"in e))return!1;let i=this.lodAt(e.level);if(!i&&r===1){const l=this.lods[this.lods.length-1];l.level<e.level&&(i=l)}if(!i)return!1;const s=e.level-i.level,n=i.resolution*this.size[0]/2**s,o=i.resolution*this.size[1]/2**s;return e.extent[0]=this.origin.x+e.col*n,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+n,e.extent[3]=e.extent[1]+o,!0}upsampleTile(e){const r=this._upsampleLevels[e.level];return!(!r||r.parentLevel===-1)&&(e.level=r.parentLevel,e.row=Math.floor(e.row/r.factor+.001),e.col=Math.floor(e.col/r.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,r){const i=this.lodAt(r.level);if(i==null)return null;const{resolution:s}=i,n=s*this.size[0],o=s*this.size[1];return e[0]=this.origin.x+r.col*n,e[1]=this.origin.y-(r.row+1)*o,e[2]=e[0]+n,e[3]=e[1]+o,e}lodAt(e){return this._levelToLOD?.[e]??null}clone(){return xc.fromJSON(this.write({}))}getCompatibleForVTL(e){if(this.size[0]!==this.size[1]||this.size[0]===256&&e===512)return null;const r=(this.size[0]===512&&e===256?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===e&&r===0)return this;const i=[],s=this.lods.length-r;for(let n=0;n<s;n++){const o=n+r,{scale:l,resolution:u}=o>=0?this.lods[o]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};i.push(new hr({level:n,scale:l,resolution:u}))}return new xc({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let r=null;for(let i=0;i<e.length;i++){const s=e[i];this._upsampleLevels[s.level]={parentLevel:r?r.level:-1,factor:r?r.resolution/s.resolution:0},r=s}}},xc=qd,qd);a([c({type:Number,json:{write:!0}})],Fr.prototype,"compressionQuality",void 0),a([c({type:Number,json:{write:!0}})],Fr.prototype,"dpi",void 0),a([c({type:String,json:{read:xO.read,write:xO.write,origins:{"web-scene":{read:!1,write:!1}}}})],Fr.prototype,"format",void 0),a([c({readOnly:!0})],Fr.prototype,"isWrappable",null),a([c({type:ee,json:{write:!0}})],Fr.prototype,"origin",void 0),a([V("origin")],Fr.prototype,"readOrigin",null),a([c({type:[hr],value:null,json:{write:!0}})],Fr.prototype,"lods",null),a([c({readOnly:!0})],Fr.prototype,"scales",void 0),a([c({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],Fr.prototype,"size",void 0),a([V("size",["rows","cols"])],Fr.prototype,"readSize",null),a([q("size",{cols:{type:xe},rows:{type:xe}})],Fr.prototype,"writeSize",null),a([c({type:Z,json:{write:!0}})],Fr.prototype,"spatialReference",void 0),Fr=xc=a([b("esri.layers.support.TileInfo")],Fr);let Oh=class extends Bf{constructor(e){super(e),this.addHandles(this.on("before-add",r=>{r.item!=null&&r.item.parent===this.owner&&(L.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),r.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};Oh=a([b("esri.support.AnalysesCollection")],Oh);const t0={widthBreakpoint:{getValue(t){const e=t.viewSize[0],r=t.breakpoints,i=this.values;return e<=r.xsmall?i.xsmall:e<=r.small?i.small:e<=r.medium?i.medium:e<=r.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],r=t.breakpoints,i=this.values;return e<=r.xsmall?i.xsmall:e<=r.small?i.small:e<=r.medium?i.medium:e<=r.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,r=e[0],i=e[1],s=this.values;return i>=r?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},o1={xsmall:544,small:768,medium:992,large:1200};function aee(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function a1(t,e){return e?t0[t].valueToClassName[e].split(" "):[]}const lee=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=o1}initialize(){this.addHandles(ne(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),Et))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i!==this._get("breakpoints")){if(!aee(i)){const s=JSON.stringify(o1,null,2);console.warn("provided breakpoints are not valid, using defaults:"+s),i=o1}this._set("breakpoints",{...i})}}_updateClassNames(){if(!this.container)return;const i=Gr.acquire(),s=Gr.acquire();let n,o=!1;for(n in t0){const l=this[n],u=t0[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});l!==u&&(o=!0,this[n]=u,a1(n,l).forEach(d=>s.push(d)),a1(n,u).forEach(d=>i.push(d)))}o&&(this._applyClassNameChanges(i,s),Gr.release(i),Gr.release(s))}_applyClassNameChanges(i,s){const n=this.container;n&&(s.forEach(o=>n.classList.remove(o)),i.forEach(o=>n.classList.add(o)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let s;for(s in t0)a1(s,this[s]).forEach(n=>i.classList.remove(n))}};return a([c()],r.prototype,"breakpoints",null),a([c()],r.prototype,"orientation",void 0),a([c()],r.prototype,"widthBreakpoint",void 0),a([c()],r.prototype,"heightBreakpoint",void 0),r=a([b("esri.views.BreakpointsOwner")],r),r};function $M(t){return typeof t=="string"?document.getElementById(t):t??null}function TO(t,e){for(;;){const r=t.firstChild;if(!r)break;e.appendChild(r)}}let yu=class extends X{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(e,r,i={}){return this._installWatch(e,r,i,ne)}addWhen(e,r,i={}){return this._installWatch(e,r,i,qi)}addOnCollectionChange(e,r,{initial:i=!1,final:s=!1}={}){const n=++this._handleId;return this.addHandles([Lu(e,"after-changes",this._createSyncUpdatingCallback(),jn),Lu(e,"change",r,{onListenerAdd:i?o=>r({added:o.toArray(),removed:[]}):void 0,onListenerRemove:s?o=>r({added:[],removed:o.toArray()}):void 0})],n),Te(()=>this.removeHandles(n))}addPromise(e){if(e==null)return e;const r=++this._handleId;this.addHandles(Te(()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this.hasHandles(Wy)||this._set("updating",!1))}),r),this._pendingPromises.add(e),this._set("updating",!0);const i=()=>this.removeHandles(r);return e.then(i,i),e}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(e,r,i={},s){const n=++this._handleId;i.sync||this._installSyncUpdatingWatch(e,n);const o=s(e,r,i);return this.addHandles(o,n),Te(()=>this.removeHandles(n))}_installSyncUpdatingWatch(e,r){const i=this._createSyncUpdatingCallback(),s=ne(e,i,{sync:!0,equals:()=>!1});return this.addHandles(s,r),s}_createSyncUpdatingCallback(){return()=>{this.removeHandles(Wy),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(Bh(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(Wy))}),Wy)}}};a([c({readOnly:!0})],yu.prototype,"updating",void 0),yu=a([b("esri.core.support.UpdatingHandles")],yu);const Wy=-42;var Rv=function(){return Rv=Object.assign||function(e){for(var r,i=1,s=arguments.length;i<s;i++){r=arguments[i];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rv.apply(this,arguments)},LS={exports:{}},dt={},FS={exports:{}},Zu={};function PD(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function uee(t,e,r){}function cee(t,e,r){}var dee=/javascript\s*\:/img;function hee(t,e){return dee.test(e)?"":e}Zu.whiteList=PD();Zu.getDefaultWhiteList=PD;Zu.onAttr=uee;Zu.onIgnoreAttr=cee;Zu.safeAttrValue=hee;var pee={indexOf:function(t,e){var r,i;if(Array.prototype.indexOf)return t.indexOf(e);for(r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1},forEach:function(t,e,r){var i,s;if(Array.prototype.forEach)return t.forEach(e,r);for(i=0,s=t.length;i<s;i++)e.call(r,t[i],i,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},xp=pee;function fee(t,e){t=xp.trimRight(t),t[t.length-1]!==";"&&(t+=";");var r=t.length,i=!1,s=0,n=0,o="";function l(){if(!i){var p=xp.trim(t.slice(s,n)),f=p.indexOf(":");if(f!==-1){var m=xp.trim(p.slice(0,f)),y=xp.trim(p.slice(f+1));if(m){var g=e(s,o.length,m,y,p);g&&(o+=g+"; ")}}}s=n+1}for(;n<r;n++){var u=t[n];if(u==="/"&&t[n+1]==="*"){var d=t.indexOf("*/",n+2);if(d===-1)break;n=d+1,s=n+1,i=!1}else u==="("?i=!0:u===")"?i=!1:u===";"?i||l():u===`
`&&l()}return xp.trim(o)}var mee=fee,Zy=Zu,yee=mee;function MO(t){return t==null}function gee(t){var e={};for(var r in t)e[r]=t[r];return e}function AD(t){t=gee(t||{}),t.whiteList=t.whiteList||Zy.whiteList,t.onAttr=t.onAttr||Zy.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||Zy.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||Zy.safeAttrValue,this.options=t}AD.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,r=e.options,i=r.whiteList,s=r.onAttr,n=r.onIgnoreAttr,o=r.safeAttrValue,l=yee(t,function(u,d,p,f,m){var y=i[p],g=!1;if(y===!0?g=y:typeof y=="function"?g=y(f):y instanceof RegExp&&(g=y.test(f)),g!==!0&&(g=!1),f=o(p,f),!!f){var v={position:d,sourcePosition:u,source:m,isWhite:g};if(g){var _=s(p,f,v);return MO(_)?p+":"+f:_}else{var _=n(p,f,v);if(!MO(_))return _}}});return l};var vee=AD;(function(t,e){var r=Zu,i=vee;function s(o,l){var u=new i(l);return u.process(o)}e=t.exports=s,e.FilterCSS=i;for(var n in r)e[n]=r[n]})(FS,FS.exports);var xM=FS.exports,TM={indexOf:function(t,e){var r,i;if(Array.prototype.indexOf)return t.indexOf(e);for(r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1},forEach:function(t,e,r){var i,s;if(Array.prototype.forEach)return t.forEach(e,r);for(i=0,s=t.length;i<s;i++)e.call(r,t[i],i,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,r=e.exec(t);return r?r.index:-1}},wee=xM.FilterCSS,bee=xM.getDefaultWhiteList,Lv=TM;function RD(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var LD=new wee;function _ee(t,e,r){}function See(t,e,r){}function $ee(t,e,r){}function xee(t,e,r){}function FD(t){return t.replace(Mee,"&lt;").replace(Iee,"&gt;")}function Tee(t,e,r,i){if(r=UD(r),e==="href"||e==="src"){if(r=Lv.trim(r),r==="#")return"#";if(!(r.substr(0,7)==="http://"||r.substr(0,8)==="https://"||r.substr(0,7)==="mailto:"||r.substr(0,4)==="tel:"||r.substr(0,11)==="data:image/"||r.substr(0,6)==="ftp://"||r.substr(0,2)==="./"||r.substr(0,3)==="../"||r[0]==="#"||r[0]==="/"))return""}else if(e==="background"){if(Jy.lastIndex=0,Jy.test(r))return""}else if(e==="style"){if(IO.lastIndex=0,IO.test(r)||(EO.lastIndex=0,EO.test(r)&&(Jy.lastIndex=0,Jy.test(r))))return"";i!==!1&&(i=i||LD,r=i.process(r))}return r=qD(r),r}var Mee=/</g,Iee=/>/g,Eee=/"/g,Oee=/&quot;/g,kee=/&#([a-zA-Z0-9]*);?/gim,Cee=/&colon;?/gim,Pee=/&newline;?/gim,Jy=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,IO=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,EO=/u\s*r\s*l\s*\(.*/gi;function ND(t){return t.replace(Eee,"&quot;")}function DD(t){return t.replace(Oee,'"')}function jD(t){return t.replace(kee,function(r,i){return i[0]==="x"||i[0]==="X"?String.fromCharCode(parseInt(i.substr(1),16)):String.fromCharCode(parseInt(i,10))})}function VD(t){return t.replace(Cee,":").replace(Pee," ")}function zD(t){for(var e="",r=0,i=t.length;r<i;r++)e+=t.charCodeAt(r)<32?" ":t.charAt(r);return Lv.trim(e)}function UD(t){return t=DD(t),t=jD(t),t=VD(t),t=zD(t),t}function qD(t){return t=ND(t),t=FD(t),t}function Aee(){return""}function Ree(t,e){typeof e!="function"&&(e=function(){});var r=!Array.isArray(t);function i(o){return r?!0:Lv.indexOf(t,o)!==-1}var s=[],n=!1;return{onIgnoreTag:function(o,l,u){if(i(o))if(u.isClosing){var d="[/removed]",p=u.position+d.length;return s.push([n!==!1?n:u.position,p]),n=!1,d}else return n||(n=u.position),"[removed]";else return e(o,l,u)},remove:function(o){var l="",u=0;return Lv.forEach(s,function(d){l+=o.slice(u,d[0]),u=d[1]}),l+=o.slice(u),l}}}function Lee(t){for(var e="",r=0;r<t.length;){var i=t.indexOf("<!--",r);if(i===-1){e+=t.slice(r);break}e+=t.slice(r,i);var s=t.indexOf("-->",i);if(s===-1)break;r=s+3}return e}function Fee(t){var e=t.split("");return e=e.filter(function(r){var i=r.charCodeAt(0);return i===127?!1:i<=31?i===10||i===13:!0}),e.join("")}dt.whiteList=RD();dt.getDefaultWhiteList=RD;dt.onTag=_ee;dt.onIgnoreTag=See;dt.onTagAttr=$ee;dt.onIgnoreTagAttr=xee;dt.safeAttrValue=Tee;dt.escapeHtml=FD;dt.escapeQuote=ND;dt.unescapeQuote=DD;dt.escapeHtmlEntities=jD;dt.escapeDangerHtml5Entities=VD;dt.clearNonPrintableCharacter=zD;dt.friendlyAttrValue=UD;dt.escapeAttrValue=qD;dt.onIgnoreTagStripAll=Aee;dt.StripTagBody=Ree;dt.stripCommentTag=Lee;dt.stripBlankChar=Fee;dt.cssFilter=LD;dt.getDefaultCSSWhiteList=bee;var Ww={},ba=TM;function Nee(t){var e=ba.spaceIndex(t),r;return e===-1?r=t.slice(1,-1):r=t.slice(1,e+1),r=ba.trim(r).toLowerCase(),r.slice(0,1)==="/"&&(r=r.slice(1)),r.slice(-1)==="/"&&(r=r.slice(0,-1)),r}function Dee(t){return t.slice(0,2)==="</"}function jee(t,e,r){var i="",s=0,n=!1,o=!1,l=0,u=t.length,d="",p="";e:for(l=0;l<u;l++){var f=t.charAt(l);if(n===!1){if(f==="<"){n=l;continue}}else if(o===!1){if(f==="<"){i+=r(t.slice(s,l)),n=l,s=l;continue}if(f===">"){i+=r(t.slice(s,n)),p=t.slice(n,l+1),d=Nee(p),i+=e(n,i.length,d,p,Dee(p)),s=l+1,n=!1;continue}if(f==='"'||f==="'")for(var m=1,y=t.charAt(l-m);y.trim()===""||y==="=";){if(y==="="){o=f;continue e}y=t.charAt(l-++m)}}else if(f===o){o=!1;continue}}return s<t.length&&(i+=r(t.substr(s))),i}var Vee=/[^a-zA-Z0-9\\_:.-]/gim;function zee(t,e){var r=0,i=0,s=[],n=!1,o=t.length;function l(m,y){if(m=ba.trim(m),m=m.replace(Vee,"").toLowerCase(),!(m.length<1)){var g=e(m,y||"");g&&s.push(g)}}for(var u=0;u<o;u++){var d=t.charAt(u),p,f;if(n===!1&&d==="="){n=t.slice(r,u),r=u+1,i=t.charAt(r)==='"'||t.charAt(r)==="'"?r:qee(t,u+1);continue}if(n!==!1&&u===i){if(f=t.indexOf(d,u+1),f===-1)break;p=ba.trim(t.slice(i+1,f)),l(n,p),n=!1,u=f,r=u+1;continue}if(/\s|\n|\t/.test(d))if(t=t.replace(/\s|\n|\t/g," "),n===!1)if(f=Uee(t,u),f===-1){p=ba.trim(t.slice(r,u)),l(p),n=!1,r=u+1;continue}else{u=f-1;continue}else if(f=Gee(t,u-1),f===-1){p=ba.trim(t.slice(r,u)),p=OO(p),l(n,p),n=!1,r=u+1;continue}else continue}return r<t.length&&(n===!1?l(t.slice(r)):l(n,OO(ba.trim(t.slice(r))))),ba.trim(s.join(" "))}function Uee(t,e){for(;e<t.length;e++){var r=t[e];if(r!==" ")return r==="="?e:-1}}function qee(t,e){for(;e<t.length;e++){var r=t[e];if(r!==" ")return r==="'"||r==='"'?e:-1}}function Gee(t,e){for(;e>0;e--){var r=t[e];if(r!==" ")return r==="="?e:-1}}function Bee(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function OO(t){return Bee(t)?t.substr(1,t.length-2):t}Ww.parseTag=jee;Ww.parseAttr=zee;var Hee=xM.FilterCSS,Vs=dt,GD=Ww,Wee=GD.parseTag,Zee=GD.parseAttr,r0=TM;function Yy(t){return t==null}function Jee(t){var e=r0.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=r0.trim(t.slice(e+1,-1));var r=t[t.length-1]==="/";return r&&(t=r0.trim(t.slice(0,-1))),{html:t,closing:r}}function Yee(t){var e={};for(var r in t)e[r]=t[r];return e}function Kee(t){var e={};for(var r in t)Array.isArray(t[r])?e[r.toLowerCase()]=t[r].map(function(i){return i.toLowerCase()}):e[r.toLowerCase()]=t[r];return e}function BD(t){t=Yee(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=Vs.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=Kee(t.whiteList||t.allowList):t.whiteList=Vs.whiteList,t.onTag=t.onTag||Vs.onTag,t.onTagAttr=t.onTagAttr||Vs.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||Vs.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||Vs.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||Vs.safeAttrValue,t.escapeHtml=t.escapeHtml||Vs.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new Hee(t.css))}BD.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,r=e.options,i=r.whiteList,s=r.onTag,n=r.onIgnoreTag,o=r.onTagAttr,l=r.onIgnoreTagAttr,u=r.safeAttrValue,d=r.escapeHtml,p=e.cssFilter;r.stripBlankChar&&(t=Vs.stripBlankChar(t)),r.allowCommentTag||(t=Vs.stripCommentTag(t));var f=!1;r.stripIgnoreTagBody&&(f=Vs.StripTagBody(r.stripIgnoreTagBody,n),n=f.onIgnoreTag);var m=Wee(t,function(y,g,v,_,S){var M={sourcePosition:y,position:g,isClosing:S,isWhite:Object.prototype.hasOwnProperty.call(i,v)},C=s(v,_,M);if(!Yy(C))return C;if(M.isWhite){if(M.isClosing)return"</"+v+">";var T=Jee(_),O=i[v],P=Zee(T.html,function(D,z){var B=r0.indexOf(O,D)!==-1,G=o(v,D,z,B);return Yy(G)?B?(z=u(v,D,z,p),z?D+'="'+z+'"':D):(G=l(v,D,z,B),Yy(G)?void 0:G):G});return _="<"+v,P&&(_+=" "+P),T.closing&&(_+=" /"),_+=">",_}else return C=n(v,_,M),Yy(C)?d(_):C},d);return f&&(m=f.remove(m)),m};var Qee=BD;(function(t,e){var r=dt,i=Ww,s=Qee;function n(l,u){var d=new s(u);return d.process(l)}e=t.exports=n,e.filterXSS=n,e.FilterXSS=s,(function(){for(var l in r)e[l]=r[l];for(var u in i)e[u]=i[u]})();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=t.exports)})(LS,LS.exports);var ic=LS.exports,Xee=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},HD=(function(){function t(e,r){var i=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=Rv(Rv({},ic.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(n,o,l,u){return n==="a"&&o==="href"||(n==="img"||n==="source")&&o==="src"?i.sanitizeUrl(l):ic.safeAttrValue(n,o,l,u)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var s;e&&!r?s=e:e&&r?(s=Object.create(this.arcgisFilterOptions),s.css={whiteList:this.arcgisCSSWhiteList},Object.keys(e).forEach(function(n){if(n==="whiteList")s.whiteList=i._extendObjectOfArrays([i.arcgisWhiteList,e.whiteList||{}]);else if(n==="css"){var o=e.css.whiteList;o!=null&&e.css instanceof Object&&Object.keys(o).forEach(function(l){return s.css.whiteList[l]=o[l]})}else s[n]=e[n]})):(s=Object.create(this.arcgisFilterOptions),s.whiteList=this.arcgisWhiteList,s.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=s,this._xssFilter=new ic.FilterXSS(s)}return t.prototype.sanitize=function(e,r){switch(r===void 0&&(r={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,r);default:return r.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,r){var i=(r??{}).isProtocolRequired,s=i===void 0?!0:i,n=this._trim(e.substring(0,e.indexOf(":"))),o=e==="/",l=/^#/.test(e),u=n&&this.allowedProtocols.indexOf(n.toLowerCase())>-1;return o||l||u?ic.escapeAttrValue(e):!n&&!s?ic.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,r,i,s){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,r,i,s):ic.safeAttrValue(e,r,i,s)},t.prototype.validate=function(e,r){r===void 0&&(r={});var i=this.sanitize(e,r);return{isValid:e===i,sanitized:i}},t.prototype.encodeHTML=function(e){var r=this;return String(e).replace(/[&<>"'\/]/g,function(i){return r._entityMap[i]})},t.prototype.encodeAttrValue=function(e){var r=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(i,s){return r.test(i)?i:"&#x".concat(Number(e.charCodeAt(s)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var r={};return e.forEach(function(i){Object.keys(i).forEach(function(s){Array.isArray(i[s])&&Array.isArray(r[s])?r[s]=r[s].concat(i[s]):r[s]=i[s]})}),r},t.prototype._iterateOverObject=function(e,r){var i=this;r===void 0&&(r={});try{var s=!1,n=void 0;if(Array.isArray(e))n=e.reduce(function(l,u){var d=i.validate(u,r);return d.isValid?l.concat([u]):(s=!0,l.concat([d.sanitized]))},[]);else if(Xee(e)){var o=Object.keys(e);n=o.reduce(function(l,u){var d=e[u],p=i.validate(d,r);return p.isValid?l[u]=d:(s=!0,l[u]=p.sanitized),l},{})}else return r.allowUndefined&&typeof e>"u"?void 0:null;return s?n:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t})();const ete=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],tte=ete.reduce((t,e)=>(t[e]=[],t),{}),rte=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],WD=new HD({whiteList:tte,onTagAttr:(t,e,r)=>{const i=`${e}="${r}"`;if(rte.includes(e))return i},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0),ite=new HD({whiteList:{br:[]},stripIgnoreTag:!0,escapeHtml:t=>t},!1),ZD="http://www.w3.org/",Zw=`${ZD}2000/svg`,JD=`${ZD}1999/xlink`;let kO=[],MM=(t,e)=>{let r={};return Object.keys(t).forEach(i=>{r[i]=t[i]}),e&&Object.keys(e).forEach(i=>{r[i]=e[i]}),r},IM=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),YD=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},ste=(t,e,r)=>{if(e.vnodeSelector!==""){for(let i=r;i<t.length;i++)if(IM(t[i],e))return i}return-1},l1=(t,e,r,i)=>{let s=t[e];if(s.vnodeSelector==="")return;let n=s.properties;if(!(n&&(n.key===void 0?n.bind:n.key))){for(let o=0;o<t.length;o++)if(o!==e){let l=t[o];if(IM(l,s))throw new Error(`${r.vnodeSelector} had a ${s.vnodeSelector} child ${i==="added"?i:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},nte=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},NS=[],DS=!1,KD=t=>{(t.children||[]).forEach(KD),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},CO=()=>{DS=!1,NS.forEach(KD),NS.length=0},PO=t=>{NS.push(t),DS||(DS=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(CO,{timeout:16}):setTimeout(CO,16))},AO=t=>{let e=t.domNode;if(t.properties){let r=t.properties.exitAnimation;if(r)return e.style.pointerEvents="none",void r(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),PO(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),PO(t))},ote=(t,e,r)=>{if(!e)return;let i=r.eventHandlerInterceptor,s=Object.keys(e),n=s.length;for(let o=0;o<n;o++){let l=s[o],u=e[l];if(l==="className")throw new Error('Property "className" is not supported, use "class".');if(l==="class")VS(t,u,!0);else if(l==="classes"){let d=Object.keys(u),p=d.length;for(let f=0;f<p;f++){let m=d[f];u[m]&&t.classList.add(m)}}else if(l==="styles"){let d=Object.keys(u),p=d.length;for(let f=0;f<p;f++){let m=d[f],y=u[m];y&&(YD(y),r.styleApplyer(t,m,y))}}else if(l!=="key"&&u!=null){let d=typeof u;d==="function"?(l.lastIndexOf("on",0)===0&&(i&&(u=i(l,u,t,e)),l==="oninput"&&(function(){let p=u;u=function(f){p.apply(this,[f]),f.target["oninput-value"]=f.target.value}})()),t[l]=u):r.namespace===Zw?l==="href"?t.setAttributeNS(JD,l,u):t.setAttribute(l,u):d==="string"&&l!=="value"?l==="innerHTML"?t[l]=WD.sanitize(u):jS(t)&&l in t?t[l]=u:t.setAttribute(l,u):t[l]=u}}};function jS(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let Fv,ate=(t,e,r)=>{if(e)for(let i of e)Hf(i,t,void 0,r)},QD=(t,e,r)=>{ate(t,e.children,r),e.text&&(t.textContent=e.text),ote(t,e.properties,r),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,r,e.vnodeSelector,e.properties,e.children])},Hf=(t,e,r,i)=>{let s,n=0,o=t.vnodeSelector,l=e.ownerDocument;if(o==="")s=t.domNode=l.createTextNode(t.text),r!==void 0?e.insertBefore(s,r):e.appendChild(s);else{for(let u=0;u<=o.length;++u){let d=o.charAt(u);if(u===o.length||d==="."||d==="#"){let p=o.charAt(n-1),f=o.slice(n,u);p==="."?s.classList.add(f):p==="#"?s.id=f:(f==="svg"&&(i=MM(i,{namespace:Zw})),i.namespace!==void 0?s=t.domNode=l.createElementNS(i.namespace,f):(s=t.domNode=t.domNode||l.createElement(f),f==="input"&&t.properties&&t.properties.type!==void 0&&s.setAttribute("type",t.properties.type)),r!==void 0?e.insertBefore(s,r):s.parentNode!==e&&e.appendChild(s)),n=u+1}}QD(s,t,i)}},VS=(t,e,r)=>{e&&e.split(" ").forEach(i=>{i&&t.classList.toggle(i,r)})},lte=(t,e,r,i)=>{if(!r)return;let s=!1,n=Object.keys(r),o=n.length;for(let l=0;l<o;l++){let u=n[l],d=r[u],p=e[u];if(u==="class")p!==d&&(VS(t,p,!1),VS(t,d,!0));else if(u==="classes"){let f=t.classList,m=Object.keys(d),y=m.length;for(let g=0;g<y;g++){let v=m[g],_=!!d[v];_!==!!p[v]&&(s=!0,_?f.add(v):f.remove(v))}}else if(u==="styles"){let f=Object.keys(d),m=f.length;for(let y=0;y<m;y++){let g=f[y],v=d[g];v!==p[g]&&(s=!0,v?(YD(v),i.styleApplyer(t,g,v)):i.styleApplyer(t,g,""))}}else if(d||typeof p!="string"||(d=""),u!=="value"||jS(t)){if(d!==p){let f=typeof d;f==="function"&&i.eventHandlerInterceptor||(i.namespace===Zw?u==="href"?t.setAttributeNS(JD,u,d):t.setAttribute(u,d):f==="string"?u==="innerHTML"?t[u]=WD.sanitize(d):u==="role"&&d===""?t.removeAttribute(u):jS(t)&&u in t?t[u]=d:t.setAttribute(u,d):t[u]!==d&&(t[u]=d),s=!0)}}else{let f=t[u];f!==d&&(t["oninput-value"]?f===t["oninput-value"]:d!==p)&&(t[u]=d,t["oninput-value"]=void 0),d!==p&&(s=!0)}}return s},ute=(t,e,r,i,s)=>{if(r===i)return!1;i=i||kO;let n,o=(r=r||kO).length,l=i.length,u=0,d=0,p=!1;for(;d<l;){let f=u<o?r[u]:void 0,m=i[d];if(f!==void 0&&IM(f,m))p=Fv(f,m,s)||p,u++;else{let y=ste(r,m,u+1);if(y>=0){for(n=u;n<y;n++)AO(r[n]),l1(r,n,t,"removed");p=Fv(r[y],m,s)||p,u=y+1}else Hf(m,e,u<o?r[u].domNode:void 0,s),nte(m),l1(i,d,t,"added")}d++}if(o>u)for(n=u;n<o;n++)AO(r[n]),l1(r,n,t,"removed");return p};Fv=(t,e,r)=>{let i=t.domNode,s=!1;if(t===e)return!1;let n=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let o=i.ownerDocument.createTextNode(e.text);return i.parentNode.replaceChild(o,i),e.domNode=o,s=!0,s}e.domNode=i}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(r=MM(r,{namespace:Zw})),t.text!==e.text&&(n=!0,e.text===void 0?i.removeChild(i.firstChild):i.textContent=e.text),e.domNode=i,n=ute(e,i,t.children,e.children,r)||n,n=lte(i,t.properties,e.properties,r)||n,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[i,r,e.vnodeSelector,e.properties,e.children]);return n&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(i,e.properties,t.properties),s};let Ky=(t,e)=>({getLastRender:()=>t,update:r=>{if(t.vnodeSelector!==r.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let i=t;t=r,Fv(i,r,e)},domNode:t.domNode});const cte={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,r)=>{e.charAt(0)==="-"?t.style.setProperty(e,r):t.style[e]=r}};let Wp=t=>MM(cte,t),La={append:(t,e,r)=>(r=Wp(r),Hf(e,t,void 0,r),Ky(e,r)),insertBefore:(t,e,r)=>(r=Wp(r),Hf(e,t.parentNode,t,r),Ky(e,r)),merge:(t,e,r)=>(r=Wp(r),e.domNode=t,QD(t,e,r),Ky(e,r)),replace:(t,e,r)=>(r=Wp(r),Hf(e,t.parentNode,t,r),t.parentNode.removeChild(t),Ky(e,r))},XD,dte=(t,e)=>{let r=[];for(;t&&t!==e;)r.push(t),t=t.parentNode;return r};XD=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let hte=(t,e)=>{let r=t;return e.forEach(i=>{r=r&&r.children?XD(r.children,s=>s.domNode===i):void 0}),r},pte=(t,e,r)=>{let i=function(s){r("domEvent",s);let n=e(),o=dte(s.currentTarget,n.domNode);o.reverse();let l,u=hte(n.getLastRender(),o);return t.scheduleRender(),u&&(l=u.properties[`on${s.type}`].apply(u.properties.bind||this,arguments)),r("domEventProcessed",s),l};return(s,n,o,l)=>i},RO=t=>{let e,r,i=Wp(t),s=i.performanceLogger,n=!0,o=!1,l=[],u=[],d=(f,m,y)=>{let g,v=()=>g;i.eventHandlerInterceptor=pte(e,v,s),g=f(m,y(),i),l.push(g),u.push(y)},p=()=>{if(r=void 0,n){n=!1,s("renderStart",void 0);for(let f=0;f<l.length;f++){let m=u[f]();s("rendered",void 0),l[f].update(m),s("patched",void 0)}s("renderDone",void 0),n=!0}};return e={renderNow:p,scheduleRender:()=>{r||o||(r=requestAnimationFrame(p))},stop:()=>{r&&(cancelAnimationFrame(r),r=void 0),o=!0},resume:()=>{o=!1,n=!0,e.scheduleRender()},append:(f,m)=>{d(La.append,f,m)},insertBefore:(f,m)=>{d(La.insertBefore,f,m)},merge:(f,m)=>{d(La.merge,f,m)},replace:(f,m)=>{d(La.replace,f,m)},detach:f=>{for(let m=0;m<u.length;m++)if(u[m]===f)return u.splice(m,1),l.splice(m,1)[0];throw new Error("renderFunction was not found")}},e},oa=class extends X{constructor(){super(...arguments),this.items=new H,this._watchUpdatingTracking=new yu,this._callbacks=new Map,this._projector=RO(),this._hiddenProjector=RO()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,r=>{for(const i of r.added){const s=()=>i.render();this._callbacks.set(i,s),this._projector.append(this.surface,s)}for(const i of r.removed){const s=this._projector.detach(this._callbacks.get(i));this.surface.removeChild(s.domNode),this._callbacks.delete(i)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const r=this._hiddenSurface,i=this._hiddenProjector;let s;const n=()=>(s=e.render(),s);i.append(r,n),i.renderNow();const o={left:0,top:0,right:0,bottom:0};if(s?.domNode){const l=s.domNode.getBoundingClientRect();o.left=l.left,o.top=l.top,o.right=l.right,o.bottom=l.bottom}for(i.detach(n);r.firstChild;)r.removeChild(r.firstChild);return o}overlaps(e,r){const i=this.computeBoundingRect(e),s=this.computeBoundingRect(r);return Math.max(i.left,s.left)<=Math.min(i.right,s.right)&&Math.max(i.top,s.top)<=Math.min(i.bottom,s.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,r){const i=!!r?.disableDecorations;if(!this.items.some(n=>n.visible&&!(i&&n.isDecoration)))return;const s=e.getContext("2d");s.save(),s.font=this._fontString(),this.items.forEach(n=>{i&&n.isDecoration||(s.save(),n.renderCanvas(s),s.restore())}),s.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};a([c({readOnly:!0})],oa.prototype,"surface",void 0),a([c({readOnly:!0})],oa.prototype,"items",void 0),a([c({readOnly:!0})],oa.prototype,"needsRender",null),a([c({readOnly:!0})],oa.prototype,"_watchUpdatingTracking",void 0),a([c({readOnly:!0})],oa.prototype,"updating",null),oa=a([b("esri.views.overlay.ViewOverlay")],oa);const LO=oa,u1=[0,0];function fte(t){const e=(t.ownerDocument||window.document).defaultView,r=t.getBoundingClientRect();return u1[0]=r.left+(e?.pageXOffset??0),u1[1]=r.top+(e?.pageYOffset??0),u1}function FO(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function mte(t){const e=document.createElement("div");return t.appendChild(e),e}const sc=16,Tp=750,yte=512,gte=2,vte=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this._freqInfo={freq:sc,time:Tp},this._overlayRenderTaskHandle=null,this.aria={},this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([ne(()=>this.cursor,s=>{const{surface:n}=this;n&&n.setAttribute("data-cursor",s)}),ne(()=>this.navigating,s=>{const{surface:n}=this;n&&n.setAttribute("data-navigating",s.toString())}),ne(()=>[this.aria,this.surface],()=>this._updateAria(),{initial:!0})])}initialize(){const i=this;this.addHandles([ne(()=>this.ui,(s,n)=>this._handleUIChange(s,n),Et),i.on("focus",()=>this.notifyChange("focused")),i.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui?.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(i){const s=this._get("container"),n=$M(i);if(n||typeof i!="string"||L.getLogger(this).error("#container",`element with id '${i}' not found`),s===n)return;if(this._stopMeasuring(),s&&(s.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(FO(this.root),this._set("root",null)),this.userContent&&(TO(this.userContent,s),FO(this.userContent),this._set("userContent",null))),!n)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);n.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",TO(n,o),n.appendChild(o),this._set("userContent",o);const l=document.createElement("div");l.className="esri-view-root",n.insertBefore(l,n.firstChild),this._set("root",l);const u=document.createElement("div");u.className="esri-view-surface",u.setAttribute("role","application"),u.tabIndex=0,l.appendChild(u),this._set("surface",u);const d=new LO;l.appendChild(d.surface),this._set("overlay",d),this.addHandles(ne(()=>d.needsRender,p=>{p&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=vh({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=He(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",n),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}set ui(i){const s=this._get("ui");s!==i&&s?.destroy(),this._set("ui",i)}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(i,s,n){const o=this.position;return i-=o?o[0]:0,s-=o?o[1]:0,n?(n[0]=i,n[1]=s):n=[i,s],n}containerToPage(i,s,n){const o=this.position;return i+=o?o[0]:0,s+=o?o[1]:0,n?(n[0]=i,n[1]=s):n=[i,s],n}_updateAria(){const{surface:i,aria:s}=this;i&&(i.ariaLabelledByElements=s?.labelledByElements??null,i.ariaDescribedByElements=s?.describedByElements??null,i.ariaLabel=s?.label??null,i.ariaDescription=s?.description??null)}_handleUIChange(i,s){this.removeHandles("ui"),s&&s!==i&&s.destroy(),i&&(i.view=this,this.addHandles(ne(()=>this.root,n=>{i.container=n?mte(n):null},Et),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=sc,i.time=Tp;const s=vh({prepare:l=>{const u=this._measure(),d=this._freqInfo;if(d.time+=l.deltaTime,u&&(d.freq=sc,this._get("resizing")||this._set("resizing",!0)),d.time<d.freq)return;d.time=0;const p=this._position();d.freq=p||u?sc:Math.min(Tp,d.freq*gte),!u&&d.freq>=yte&&(s.pause(),this._get("resizing")&&this._set("resizing",!1))}}),n=new ResizeObserver(l=>{i.freq=sc,i.time=Tp,s.resume()});this.container!=null&&n.observe(this.container);const o=Te(()=>n.disconnect());this.addHandles([zh(window,"resize",()=>{i.freq=sc,i.time=Tp,s.resume()}),o,s],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,s=i?i.clientWidth:0,n=i?i.clientHeight:0;if(s===0||n===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,l=this.height;return s===o&&n===l?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",s),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:l,width:s,height:n}),!0)}_position(){const i=this.container,s=this.position,n=i&&fte(i);return!!n&&(!s||n[0]!==s[0]||n[1]!==s[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return a([c()],r.prototype,"aria",void 0),a([c()],r.prototype,"container",null),a([c({readOnly:!0})],r.prototype,"focused",null),a([c({readOnly:!0})],r.prototype,"height",void 0),a([c()],r.prototype,"messagesCommon",void 0),a([c({type:LO})],r.prototype,"overlay",void 0),a([c({readOnly:!0})],r.prototype,"position",void 0),a([c({readOnly:!0})],r.prototype,"resizing",void 0),a([c({readOnly:!0})],r.prototype,"root",void 0),a([c({value:null,readOnly:!0})],r.prototype,"size",null),a([c({readOnly:!0})],r.prototype,"surface",void 0),a([c({readOnly:!0})],r.prototype,"suspended",void 0),a([c({nonNullable:!0})],r.prototype,"ui",null),a([c({readOnly:!0})],r.prototype,"userContent",void 0),a([c({readOnly:!0})],r.prototype,"width",void 0),a([c()],r.prototype,"widthBreakpoint",void 0),r=a([b("esri.views.DOMContainer")],r),r},Qy="popup",NO="manual";function zS(t){const{popupElement:e,popup:r}=t||{};return e??r??null}function Rn(t){return t!=null&&"open"in t&&"declaredClass"in t}function Uo(t){return!!t&&t.tagName.toLowerCase()==="arcgis-popup"&&"open"in t}function wte(t,e,r){const[i,s,n]=e;if(r){const[o,l,u]=r;o&&Rn(l)&&(l.view=null,o.remove(l,Qy),l!==s&&s&&l.destroy()),o&&u&&Uo(u)&&(u.view=null,o.remove(u,Qy),u!==n&&n&&u.remove())}i&&Rn(s)&&(s.view=t,i.add(s,{key:Qy,position:NO,internal:!0})),i&&n&&Uo(n)&&(n.view=t,i.add(n,{key:Qy,position:NO,internal:!0}))}async function bte(t,e){const{popup:r,popupElement:i}=t;Rn(r)?await Xy(r,null,e):i&&Uo(i)?await Xy(null,i,e):e?.defer(async()=>{await t.setupPopup();const{popup:s,popupElement:n}=t;Rn(s)&&!t.destroyed&&t.ready&&t.popupEnabled?await Xy(s,null,e):n&&Uo(n)&&await Xy(null,n,e)})}function _te(t,e){const{popup:r,popupElement:i}=t;if(Rn(r))return r.open(e);i&&Uo(i)&&i.open(e)}function e4(t,e){Rn(t)&&t.close(),e&&Uo(e)&&(e.visible=!1)}async function Xy(t,e,r){if(Rn(t)){const i=await t.viewModel.handleViewClick(r);return void(i?.promises?.length?t.open(i):t.visible&&t.close())}if(e&&Uo(e)){const i=await e.handleViewClick(r);i?.promises?.length?e.open(i):e.visible&&(e.visible=!1)}}const t4=k("mac")?"Meta":"Control",Ste=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),$te=t=>Ste.has(t);let xte=class{constructor(e,r=[]){this.eventType=e,this.keyModifiers=r}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const r=e.modifiers;for(const i of this.keyModifiers)if(!r.has(i))return!1;return!0}},Wt=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const r=this._incoming[e];for(const i of r)this._incomingEventMatches.push(i.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback(r=>this._handleEvent(r)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,r,i){let s;typeof r=="function"?(i=r,s=[]):s=r||[];const n=typeof e=="string"?new xte(e,s):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},l=p=>{const f=this._incoming[p.match.eventType];if(f){const m=f.indexOf(p);f.splice(m,1),o(),this._manager&&this._manager.updateDependencies()}},u=new Tte(n,i,{onPause:l,onRemove:l,onResume:p=>{const f=this._incoming[p.match.eventType];f&&!f.includes(p)&&(f.push(p),o(),this._manager&&this._manager.updateDependencies())}});let d=this._incoming[n.eventType];return d||(d=[],this._incoming[n.eventType]=d),d.push(u),o(),this._manager&&this._manager.updateDependencies(),u}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const r=new Mte(e,{onEmit:(i,s,n,o)=>{this._manager?.emit(i.eventType,s,n,o)},onRemove:i=>{delete this._outgoing[i.eventType],this._manager?.updateDependencies()}});return this._outgoing[e]=r,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),r}startCapturingPointer(e){this._manager?.setPointerCapture(e,!0)}stopCapturingPointer(e){this._manager?.setPointerCapture(e,!1)}refreshHasPendingInputs(){this._manager?.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){const r=this._incoming[e.type];if(r){for(const i of r)if(i.match.matches(e)&&(i.callback?.(e),e.shouldStopPropagation()))break}}},Tte=class{constructor(e,r,i){this.match=e,this._callback=r,this._handler=i}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},Mte=class{constructor(e,r){this.eventType=e,this._removed=!1,this._handler=r}emit(e,r,i){this._removed||this._handler.onEmit(this,e,r,i)}remove(){this._removed=!0,this._handler.onRemove(this)}},Ite=class extends Wt{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this._id=null,this.registerIncoming("pointer-move",r=>this._update(r.data))}_update(e){const r=e.native.pointerType==="touch"?"touch":"mouse",{x:i,y:s,native:{pointerId:n}}=e;r===this._value&&this._x===i&&this._y===s&&this._id===n||(this._value=r,this._x=i,this._y=s,this._id=n,this._onChange(n,r,i,s))}},Ete=class{constructor(e,r){this._observable=new Qm,this._value=e,this._equalityFunction=r}get value(){return le(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function kh(t,e=ZA){return new Ete(t,e)}let Ote=class extends Wt{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=kh(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},kte=class{constructor(e,r){this._owner=r,this._properties={},this._afterDispatchHandle=null;for(const i in e){const s=e[i],n=new WR(s,void 0,void 0,2,2);this._properties[i]={pool:n,acquired:[]}}this._afterDispatchHandle=Fq(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const r=this._properties[e];for(const i of r.acquired)II(i)||r.pool.release(i);r.pool.destroy(),r.pool=null,r.acquired=null}this._properties=null,this._owner=null}get(e){const r=this._owner._get(e),i=this._properties[e];let s=i.pool.acquire();for(i.acquired.push(s);s===r;)s=i.pool.acquire(),i.acquired.push(s);return oL(),s}_release(){for(const e in this._properties){const r=this._properties[e];let i=0;for(const s of r.acquired)II(s)?r.acquired[i++]=s:r.pool.release(s);r.acquired.length=i}}},Cte=class{constructor(){this.id=0,this.type="mouse",this.location=Gt()}},Ps=class extends X{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=t4,this._propertiesPool=new kte({latestPointerInfo:()=>new Cte},this),this._latestPointerInfo=void 0,this._paused=!1,this._testTimestamp=void 0}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const r of e)this.uninstallHandlers(r);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get latestPointerInfo(){return this._latestPointerInfo}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,r,i=No.INTERNAL){if(this._nameToGroup[e]||r.length===0)return;const s={name:e,handlers:r.map(n=>({handler:n,active:!0,removed:!1,priorityIndex:0,groupPriority:i,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=s;for(let n=s.handlers.length-1;n>=0;n--){const o=s.handlers[n];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(l,u,d,p,f)=>{this._emitInputEvent(o.priorityIndex+1,l,u,d,f,p)},setPointerCapture:(l,u)=>{this._setPointerCapture(s,o,l,u)},setEventCallback:l=>{o.eventCallback=l},setUninstallCallback:l=>{o.uninstallCallback=l},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const r=this._nameToGroup[e];r?(r.handlers.forEach(i=>{i.removed=!0,i.uninstallCallback?.()}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):L.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,r=new Set;this._handlersPriority=[];for(let i=this._handlers.length-1;i>=0;i--){const s=this._handlers[i];s.priorityIndex=i,this._handlersPriority.push(s)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let i=this._handlersPriority.length-1;i>=0;i--){const s=this._handlersPriority[i];s.priorityIndex=i;let n=s.handler.hasSideEffects;if(!n){for(const o of s.handler.outgoingEventTypes)if(e.has(o)){n=!0;break}}if(n)for(const o of s.handler.incomingEventMatches){e.add(o.eventType);for(const l of o.keyModifiers)$te(l)||r.add(l)}s.active=n}this._sourceEvents=e,this._keyModifiers=r,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,r,i,s){const n=this._latestPointerInfo;if(n==null||n.id!==e||n.type!==r||n.location.x!==i||n.location.y!==s){const o=this._propertiesPool.get("latestPointerInfo");o.id=e,o.type=r,o.location.x=i,o.location.y=s,this._latestPointerInfo=o}}_onEventReceived(e,r){if(e==="pointer-capture-lost"){const n=r;this._pointerCaptures.delete(n.native.pointerId)}this._updateKeyModifiers(e,r);const i=this._testTimestamp??r.native?.timestamp,s=r.native?.cancelable;this._emitInputEventFromSource(e,r,i,s)}_updateKeyModifiers(e,r){if(!r)return;let i=!1;const s=()=>{i||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),i=!0)},n=(l,u)=>{u&&!this._activeKeyModifiers.has(l)?(s(),this._activeKeyModifiers.add(l)):!u&&this._activeKeyModifiers.has(l)&&(s(),this._activeKeyModifiers.delete(l))};if(e==="key-down"||e==="key-up"){const l=r.key;this._keyModifiers.has(l)&&n(l,e==="key-down")}const o=r.native;n("Alt",!!o?.altKey),n("Control",!!o?.ctrlKey),n("Ctrl",!!o?.ctrlKey),n("Shift",!!o?.shiftKey),n("Meta",!!o?.metaKey),n("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new Ite((e,r,i,s)=>this._setLatestPointer(e,r,i,s)),this._multiTouchHandler=new Ote,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],No.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,No.INTERNAL)}_setPointerCapture(e,r,i,s){const n=e.name+"-"+r.priorityIndex,o=this._pointerCaptures.get(i.pointerId)||new Set;this._pointerCaptures.set(i.pointerId,o),s?(o.add(n),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(i,!0)):o.has(n)&&(o.delete(n),o.size===0&&(this._pointerCaptures.delete(i.pointerId),this.eventSource&&this.eventSource.setPointerCapture(i,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,r,i,s){this._emitInputEvent(0,e,r,i,s)}_emitInputEvent(e,r,i,s,n,o){const l=s??this._currentPropagation?.timestamp??performance.now(),u=n??!1,d={event:new Pte(r,i,l,o||this._activeKeyModifiers,u),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(d):this._doNewPropagation(d)}_doNewPropagation(e){this._currentPropagation={events:new Om,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:r,priorityIndex:i}=e.events.pop(),s=r.data?.eventId;if(!(s!=null&&this._stoppedPropagationEventIds.has(s)))for(e.currentHandler=this._handlersPriority[i];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!r.shouldStopPropagation()&&e.currentHandler.eventCallback?.(r),r.shouldStopPropagation()){s!=null&&this._stoppedPropagationEventIds.add(s);break}if(r.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:r,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const r=new Om;r.push(e);const i=this._currentPropagation;if(i){for(;i.events.length;)r.push(i.events.pop());i.events=r,i.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,r){if(e.handler.hasSideEffects!==r.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==r.groupPriority)return e.groupPriority>r.groupPriority?-1:1;for(const i of e.handler.incomingEventMatches)for(const s of r.handler.incomingEventMatches){if(i.eventType!==s.eventType)continue;const n=i.keyModifiers.filter(o=>s.keyModifiers.includes(o));if(n.length===i.keyModifiers.length!=(n.length===s.keyModifiers.length))return i.keyModifiers.length>s.keyModifiers.length?-1:1}return e.priorityIndex>r.priorityIndex?-1:1}_sortHandlersPriority(e){const r=[];for(const i of e){let s=0;for(;s<r.length&&this._compareHandlerPriority(i,r[s])>=0;)s++;r.splice(s,0,i)}return r}get test(){}};a([c({readOnly:!0})],Ps.prototype,"hasPendingInputs",null),a([c({constructOnly:!0})],Ps.prototype,"eventSource",void 0),a([c({constructOnly:!0})],Ps.prototype,"recognizers",void 0),a([c()],Ps.prototype,"multiTouchActive",null),a([c()],Ps.prototype,"_latestPointerInfo",void 0),a([c()],Ps.prototype,"latestPointerInfo",null),a([c()],Ps.prototype,"_paused",void 0),a([c({readOnly:!0})],Ps.prototype,"updating",null),Ps=a([b("esri.views.input.InputManager")],Ps);let Pte=class{constructor(e,r,i,s,n){this.type=e,this.data=r,this.timestamp=i,this.modifiers=s,this.cancelable=n,this._propagationState=0,this._resumeCallback=null}stopPropagation(){this._propagationState|=1}shouldStopPropagation(){return!!(1&this._propagationState)}defer(e){this._propagationState|=2;const r=(i,s)=>{this._propagationState&=-3;const n=this._resumeCallback;if(this._resumeCallback=null,n&&n(),s)throw i;return i};return(typeof e=="function"?e():e).then(i=>r(i,!1),i=>r(i,!0))}shouldPausePropagation(e){return!!(2&this._propagationState)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};const No={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3},Ate=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([ne(()=>[this.ui,this.popup,this.popupElement],([i,s,n],o)=>{const[l,u,d]=o??[];wte(this,[i,s,n],[l,u,d])},xr),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&bte(this,i)},No.WIDGET)]),Rw(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>N(()=>import("./Popup-Ck-NcCFx.js").then(i=>i.P),__vite__mapDeps([167,168,169,170,171,172,22,173,174,175,73,71,72,4,31,34,176,177,178,89,179,180,181])))}destroy(){this.destroyed||this.closePopup()}async openPopup(i){if(Rn(this.popup))return this.popup.open(i);if(this.popupElement&&Uo(this.popupElement))this.popupElement.open(i).catch(()=>{});else try{if(await this.setupPopup(),!this.popup)return void L.getLogger(this).error(new x("view:null-popup","Popup is null and can't be opened"));_te(this,i)}catch{}}closePopup(){this._popupSetupTask?.abort(),e4(this.popup,this.popupElement)}async fetchPopupFeatures(i,s){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(i,s),s)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!Rn(this.popup))return this._popupSetupTask=ey(async i=>{if(!this.popupEnabled||!Uo(this.popupElement))if(this.dependencies.popup&&typeof this.dependencies.popup=="function")await this.dependencies.popup(),We(i),customElements.get("arcgis-popup")||L.getLogger(this).error(new x("view:undefined-popup-element","`arcgis-popup` custom element is undefined and can't be opened")),this.popupElement=document.createElement("arcgis-popup");else{const{default:s}=await N(()=>import("./Popup-Ck-NcCFx.js").then(o=>o.P),__vite__mapDeps([167,168,169,170,171,172,22,173,174,175,73,71,72,4,31,34,176,177,178,89,179,180,181]));if(We(i),!this.popup||Rn(this.popup))return;const n=this.popup;if("open"in n||"close"in n){const{open:o,close:l,...u}=n;this.popup=new s({...u})}else this.popup=new s(n)}}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:i,hits:s},n){const o=[],l=[];let u=!1;const d=c7(n,k("popup-view-fetch-timeout")??Lte),p=y=>{const g=new Rte(y);return l.push(g),o.push(g.promise),g},f=y=>{const g=l.at(-1);return g&&g.layerView===y&&!u?g:p(y)};for(const y of s)"graphic"in y?(f(y.layerView).graphics.push(y.graphic),u=!1):(o.push(y.layerView.fetchPopupFeaturesAtLocation(y.mapPoint,d)),u=!0);l.forEach(y=>y.resolve(d));const m=u7(o).then(y=>y.filter(g=>!!g).flat());return{pendingFeatures:o,allGraphicsPromise:m,location:i}}async _getPopupHits(i,s){const{hits:n,location:o}=await this.popupHitTest(i);We(s);const l=[];for(const u of n)if("graphic"in u){if(this._isValidPopupGraphic(u.graphic,s)){const d=this._isValidPopupGraphicsLayerView(u.layerView)?u.layerView:void 0;l.push({graphic:u.graphic,layerView:d})}}else this._isValidPopupLocationLayerView(u.layerView)&&l.push({mapPoint:u.mapPoint,layerView:u.layerView});return{hits:l,location:o}}_isValidPopupGraphic(i,s){return i&&!!i.getEffectivePopupTemplate(s?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(i){return!i||(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesFromGraphics"in i}_isValidPopupLocationLayerView(i){return(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesAtLocation"in i}};return a([c()],r.prototype,"popup",void 0),a([c()],r.prototype,"popupElement",void 0),a([c()],r.prototype,"popupEnabled",void 0),r=a([b("esri.views.PopupView")],r),r};let Rte=class{constructor(e){this.layerView=e,this._resolver=wi(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:r,graphics:i,_resolver:s}=this;if(!r)return s.resolve(i),s.promise;let n;return r.fetchPopupFeaturesFromGraphics(i,e).catch(o=>(n=o,null)).then(o=>{o?s.resolve(o):s.reject(n)}),s.promise}};const Lte=5e3;var Zp;const Nv=Lt()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),r4=Nv.jsonValues.slice();h_(r4,"orthometric");const Wf=Lt()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let zr=Zp=class extends F{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,r){return Nv.write(t,e,r)}readHeightModel(t,e,r){return Nv.read(t)||(r?.messages&&r.messages.push(Fte(t,{context:r})),null)}readHeightUnit(t,e,r){return Wf.read(t)||(r?.messages&&r.messages.push(DO(t,{context:r})),null)}readHeightUnitService(t,e,r){return jT(t)||Wf.read(t)||(r?.messages&&r.messages.push(DO(t,{context:r})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new Zp({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const r=JL(e);return new Zp({heightModel:t.heightModel,heightUnit:r??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new Zp;return e.read(t,{origin:"web-scene"}),e}};function DO(t,e){return new Ui("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function Fte(t,e){return new Ui("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}a([c({type:Nv.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:r4,default:"ellipsoidal",write:{isRequired:!0}}}}})],zr.prototype,"heightModel",void 0),a([q("web-scene","heightModel")],zr.prototype,"writeHeightModel",null),a([V(["web-scene","service"],"heightModel")],zr.prototype,"readHeightModel",null),a([c({type:Wf.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:Wf.jsonValues,write:{writer:Wf.write,isRequired:!0}}}}})],zr.prototype,"heightUnit",void 0),a([V("web-scene","heightUnit")],zr.prototype,"readHeightUnit",null),a([V("service","heightUnit")],zr.prototype,"readHeightUnitService",null),a([c({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],zr.prototype,"vertCRS",void 0),a([V("service","vertCRS",["vertCRS","ellipsoid","geoid"])],zr.prototype,"readVertCRS",null),zr=Zp=a([b("esri.geometry.HeightModelInfo")],zr);let c1;async function Nte(){return c1==null&&(c1=N(()=>import("./WhereClauseCache-MPPL4SEJ.js"),__vite__mapDeps([41,42])).then(t=>new t.WhereClauseCache(500,500))),c1}async function i4(t,e){const r=await Nte(),i=r.get(t,e);if(i==null)throw r.getError(t,e);return i}function Dte(t,e){return t||=null,e||=null,t==="1=1"?e??t:e==="1=1"?t??e:t&&e?`(${t}) AND (${e})`:t??e}function jte(t,e){return t||=null,e||=null,t==="1=1"||e==="1=1"||t===e?t==="1=1"?t:e:t&&e?`(${t}) OR (${e})`:t??e}function d2e(t,e){return e.length===0?null:`${t} IN (${Vte(e)})`}function Vte(t){return t.map(e=>typeof e=="string"?zte(e):e).join(",")}function zte(t){return`'${t.replaceAll("'","''")}'`}function Ute(t){return typeof t=="number"}function h2e(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function p2e(t){return typeof t=="boolean"}function cy(t){return typeof t=="string"||t instanceof String}function qte(t){return t==null||cy(t)}function f2e(t){return Array.isArray(t)}function m2e(t){return t?.declaredClass==="esri.Graphic"}function y2e(t){return t instanceof Date}const Gte="HH:mm",Bte="HH:mm:ss",Hte="HH:mm:ss.SSS",Wte=[Hte,Bte,Gte,"TT"],Zte="yyyy-MM-dd";function jO(t){if(!t||!cy(t))return null;const e=Y.fromFormat(t,Zte);return e.isValid?e:null}function VO(t){return t&&cy(t)?K0(Wte,e=>{const r=Y.fromFormat(t,e);return r.isValid?r:null})??null:null}function zO(t){if(!t||!cy(t))return null;const e=Y.fromISO(t);return e.isValid?e:null}const s4=new Set(["integer","small-integer","long","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"]);function Jte(t){return t!=null&&s4.has(t.type)}function n4(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function o4(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function a4(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}const Yte=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);ST(s4,Yte);function g2e(t,e){const r=t?.domain;if(!r||r.type!=="range")return;const i="range"in r?r.range[0]:r.minValue,s="range"in r?r.range[1]:r.maxValue,n=Jte(t);return n4(t)||a4(t)||o4(t)?{...Kte(t,s,i),isInteger:n}:{min:i!=null&&typeof i=="number"?i:null,max:s!=null&&typeof s=="number"?s:null,rawMin:i,rawMax:s,isInteger:n}}function Kte(t,e,r){return n4(t)?{min:jO(r)?.toMillis(),max:jO(e)?.toMillis(),rawMin:r,rawMax:e}:a4(t)?{min:VO(r)?.toMillis(),max:VO(e)?.toMillis(),rawMin:r,rawMax:e}:o4(t)?{min:zO(r)?.toMillis(),max:zO(e)?.toMillis(),rawMin:r,rawMax:e}:{max:null,min:null}}function Qte(t){if(!t)return;const e=t.match(Xte);return e?.groups?e.groups.doubleQuoted??e.groups.singleQuoted??e.groups.dotNotation:void 0}const Xte=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-z_][a-z0-9_]*))$/i;function ere(t){return t.match(tre)?.[1]?.replaceAll("\\'","'")??null}const tre=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let d1;function Fu(){return d1||(d1=(async()=>{const[t,e,r]=await Promise.all([N(()=>import("./arcadeUtils-BYxWU4IU.js"),__vite__mapDeps([182,183,184,185,186,176,46,187,33,31,4,34,188,42,89,189,177,178,190])),N(()=>import("./batchExec-B9WTAYuI.js"),__vite__mapDeps([191,99])),N(()=>import("./aiServices-BoAwI5HK.js").then(i=>i.a),__vite__mapDeps([188,185,186,176,46,184]))]);return{arcade:t.arcade,arcadeUtils:t,batchExec:e,aiServices:r,Dictionary:t.Dictionary,Feature:t.arcadeFeature,Voxel:t.Voxel,Pixel:t.Pixel}})()),d1}const rre=/^([0-9_])/,ire=/[^a-z0-9_\u0080-\uffff]+/gi;function sre(t){return t==null?null:t.trim().replaceAll(ire,"_").replace(rre,"F$1")||null}const nre=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],ore=["field","normalizationField"];function UO(t,e){if(t!=null&&e!=null){for(const r of Array.isArray(t)?t:[t])if(qO(nre,r,e),"visualVariables"in r&&r.visualVariables)for(const i of r.visualVariables)qO(ore,i,e)}}function qO(t,e,r){if(t)for(const i of t){const s=Wm(i,e),n=s&&typeof s!="function"&&r.get(s);n&&Bt(i,n.name,e)}}function l4(t,e){if(t!=null&&e?.fields?.length)if("startField"in t){const r=e.get(t.startField),i=e.get(t.endField);t.startField=r?.name??null,t.endField=i?.name??null}else{const r=e.get(t.startTimeField),i=e.get(t.endTimeField);t.startTimeField=r?.name??null,t.endTimeField=i?.name??null}}const h1=new Set;function Jw(t,e){return t&&e?(h1.clear(),Nu(h1,t,e),Array.from(h1).sort()):[]}function Nu(t,e,r){if(r)if(e?.fields?.length)if(r.includes("*"))for(const{name:i}of e.fields)t.add(i);else for(const i of r)Ar(t,e,i);else{if(r.includes("*"))return t.clear(),void t.add("*");for(const i of r)i!=null&&t.add(i)}}function Ar(t,e,r){if(typeof r=="string")if(e){const i=e.get(r);i&&t.add(i.name)}else t.add(r)}function v2e(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(r=>r.name):e}function w2e(t,e,r=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const i=Jw(t,e);return i.length/t.fields.length>=r?["*"]:i}async function Lr(t,e,r,i){if(!i)return;const s=Qte(i);if(s)Ar(t,e,s);else{const{arcadeUtils:n}=await Fu(),o=n.extractFieldNames(i,r?.partitions??e?.fields?.map(l=>l.name));for(const l of o)Ar(t,r?.index??e,l)}}async function EM(t,e,r){if(r&&r!=="1=1"){const i=await i4(r,e);if(!i.isStandardized)throw new x("fieldUtils:collectFilterFields","Where clause is not standardized",{where:r});Nu(t,e,i.fieldNames)}}function are({displayField:t,fields:e}){return t||(e?.length?lre(e):null)}function lre(t){return p1(t,"name-or-title")||p1(t,"unique-identifier")||p1(t,"type-or-category")||ure(t)}function ure(t){for(const e of t){if(!e?.name)continue;const r=e.name.toLowerCase();if(r.includes("name")||r.includes("title"))return e.name}return null}function p1(t,e){for(const r of t)if(r?.valueType&&r.valueType===e)return r.name;return null}async function b2e(t,e){if(!e)return;const r=e.elevationInfo?.featureExpressionInfo;return r?r.collectRequiredFields(t,e.fieldsIndex):void 0}function cre(t,e,r){r.onStatisticExpression?Lr(t,e,null,r.onStatisticExpression.expression):t.add(r.onStatisticField)}async function _2e(t,e,r){if(!e||!r||!("fields"in r))return;const i=[],s=r.popupTemplate;i.push(u4(t,e,s)),r.fields&&i.push(...r.fields.map(async n=>cre(t,e.fieldsIndex,n))),await Promise.all(i)}async function S2e(t,e){const{fieldsIndex:r,trackInfo:i}=e;if(!e||!i||!r)return;const s=[i.latestObservations.renderer?.collectRequiredFields(t,r),i.previousObservations.renderer?.collectRequiredFields(t,r),i.trackLines.renderer?.collectRequiredFields(t,r)];i.popupTemplate&&s.push(u4(t,e,i.popupTemplate));for(const n of[i.latestObservations.labelingInfo,i.previousObservations.labelingInfo,i.trackLines.labelingInfo])if(n)for(const o of n)s.push(p4(t,r,o));await Promise.all(s)}async function u4(t,e,r){const i=[];r?.expressionInfos&&i.push(...r.expressionInfos.map(n=>Lr(t,e.fieldsIndex,null,n.expression)));const s=r?.content;if(Array.isArray(s))for(const n of s)n.type==="expression"&&n.expressionInfo&&i.push(Lr(t,e.fieldsIndex,null,n.expressionInfo.expression));await Promise.all(i)}async function $2e(t,e,r){e&&(e.timeInfo&&r?.timeExtent&&Nu(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&Nu(t,e.fieldsIndex,[e.floorInfo.floorField]),r?.where!=null&&await EM(t,e.fieldsIndex,r.where))}async function x2e(t,e,r){e&&r&&await Promise.all(r.map(i=>dre(t,e,i)))}async function dre(t,e,r){e&&r&&(r.valueExpression?await Lr(t,e.fieldsIndex,null,r.valueExpression):r.field&&Ar(t,e.fieldsIndex,r.field))}function T2e(t){return t?Jw(t.fieldsIndex,c4(t)):[]}function hre(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?Jw(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}async function M2e(t,e,r){if(!e||!r)return;const i=e.fieldsIndex;await Promise.all(r.filters.map(s=>EM(t,i,s.where)))}const pre=new Set(["oid","global-id","guid"]),fre=new Set(["oid","global-id"]),mre=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/objectid/i,/^perimeter_/i,/_perimeter$/i,/_i$/i];function yre(t){const e=new Set;d4(t).forEach(i=>e.add(i)),hre(t).forEach(i=>e.add(i.toLowerCase()));const r=t&&"infoFor3D"in t?t.infoFor3D:void 0;return r&&(Object.values(r.assetMapFieldRoles).forEach(i=>e.add(i.toLowerCase())),Object.values(r.transformFieldRoles).forEach(i=>e.add(i.toLowerCase()))),Array.from(e)}function c4(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:r,creatorField:i,editDateField:s,editorField:n}=e;return[r,i,s,n].filter(Boolean)}function d4(t){return c4(t).map(e=>e.toLowerCase())}function h4(t,e){return t.editable&&!pre.has(t.type)&&!d4(e).includes(t.name?.toLowerCase()??"")}function gre(t,e){const r=t.name?.toLowerCase()??"";return!(e?.objectIdField!=null&&r===e.objectIdField.toLowerCase()||e?.globalIdField!=null&&r===e.globalIdField.toLowerCase()||yre(e).includes(r)||fre.has(t.type)||mre.some(i=>i.test(r)))}async function I2e(t,e){const{labelingInfo:r,fieldsIndex:i}=e;r?.length&&await Promise.all(r.map(s=>p4(t,i,s)))}async function p4(t,e,r){if(!r)return;const i=r.getLabelExpression(),s=r.where;if(i.type==="arcade")await Lr(t,e,null,i.expression);else{const n=i.expression.match(/{[^}]*}/g);n&&n.forEach(o=>{Ar(t,e,o.slice(1,-1))})}await EM(t,e,s)}function vre(t){const e=t.defaultValue;return e!==void 0&&m4(t,e)?e:t.nullable?null:void 0}function E2e(t){const e=typeof t=="string"?{type:t}:t;return g4(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function f4(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function wre(t){return t===null||f4(t)}function bre(t){return t===null||Number.isInteger(t)}function _re(){return!0}function m4(t,e){let r;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":r=t.nullable?bre:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":r=t.nullable?wre:f4;break;case"string":case"esriFieldTypeString":r=t.nullable?qte:cy;break;default:r=_re}return arguments.length===1?r:r(e)}const Sre=["integer","small-integer","big-integer","long"],$re=["single","double"],xre=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"],Tre=["esriFieldTypeSingle","esriFieldTypeDouble"],y4=new Set([...Sre,...xre]),Mre=new Set([...$re,...Tre]),Ire=ST(y4,Mre);function Ere(t){return t!=null&&y4.has(t.type)}function OM(t){return t!=null&&Ire.has(t.type)}function g4(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function v4(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function Ore(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function kre(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function w4(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function GO(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function BO(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function O2e(t,e){return Cre(t,e)===null}function k2e(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function Cre(t,e){return t==null||t.nullable&&e===null?null:m4(t,e)?OM(t)&&!Pre(t.type,Number(e))?"numeric-range-validation-error::out-of-range":null:"type-validation-error::invalid-type"}function Pre(t,e){const r=typeof t=="string"?b4(t):t;if(!r)return!1;const i=r.min,s=r.max;return r.isInteger?Number.isInteger(e)&&e>=i&&e<=s:e>=i&&e<=s}function b4(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return Are;case"esriFieldTypeInteger":case"esriFieldTypeLong":case"integer":case"long":return Rre;case"esriFieldTypeBigInteger":case"big-integer":return Lre;case"esriFieldTypeSingle":case"single":return Fre;case"esriFieldTypeDouble":case"double":return Nre}}const Are={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},Rre={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},Lre={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},eg=(2-2**-23)*2**127,Fre={min:-eg,max:eg,isInteger:!1,rawMin:-eg,rawMax:eg},Nre={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function C2e(t,e,r){switch(t){case"domain-validation-error::invalid-coded-value":return`Value ${r} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"domain-validation-error::value-out-of-range":return`Value ${r} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"type-validation-error::invalid-type":return`Value ${r} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case"numeric-range-validation-error::out-of-range":{const{min:i,max:s}=b4(e.type);return`Value ${r} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${i} to ${s}`}}}function Dre(t,e){return!jre(t,e,null)}function jre(t,e,r){if(!t?.attributes||!e)return!0;const i=new Set(Object.keys(t.attributes));let s=!1;for(const n of e)if(!i.has(n)&&(s=!0,r==null))break;return s}function Vre(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}function kM(t){const e=t?.match(/{[^}]+}/g);return e?e.map(r=>r.slice(1,-1).split(":")[0].trim()):[]}let i0=class extends F{constructor(e){super(e),this.type=null}};a([c({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],i0.prototype,"type",void 0),i0=a([b("esri.popup.content.Content")],i0);const Go=i0,tg=new $e({asc:"ascending",desc:"descending"});let Jp=class extends pe(F){constructor(e){super(e),this.field=null,this.order="ascending"}};a([c({type:String,json:{write:!0}})],Jp.prototype,"field",void 0),a([c({type:tg.apiValues,json:{type:tg.jsonValues,read:tg.read,write:tg.write}})],Jp.prototype,"order",void 0),Jp=a([b("esri.popup.support.AttachmentsOrderByInfo")],Jp);const zre=Jp;let cn=class extends pe(Go){constructor(e){super(e),this.attachmentKeywords=null,this.attachmentTypes=null,this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};a([c({type:[String],json:{write:!0}})],cn.prototype,"attachmentKeywords",void 0),a([c({type:[["application","audio","image","model","text","video"]],json:{write:!0}})],cn.prototype,"attachmentTypes",void 0),a([c({type:String,json:{write:!0}})],cn.prototype,"description",void 0),a([c({type:["auto","preview","list"],json:{write:!0}})],cn.prototype,"displayType",void 0),a([c({type:[zre],json:{write:!0}})],cn.prototype,"orderByFields",void 0),a([c({type:String,json:{write:!0}})],cn.prototype,"title",void 0),a([c({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],cn.prototype,"type",void 0),cn=a([b("esri.popup.content.AttachmentsContent")],cn);const Ch=cn;var US;let Ol=US=class extends Go{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new US({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?E(this.outFields):null})}};a([c()],Ol.prototype,"creator",void 0),a([c()],Ol.prototype,"destroyer",void 0),a([c()],Ol.prototype,"outFields",void 0),a([c({type:["custom"],readOnly:!0})],Ol.prototype,"type",void 0),Ol=US=a([b("esri.popup.content.CustomContent")],Ol);const Ure=Ol;var qS;let Tc=qS=class extends F{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new qS({title:this.title,expression:this.expression})}};a([c({type:String,json:{write:!0}})],Tc.prototype,"title",void 0),a([c({type:String,json:{write:!0}})],Tc.prototype,"expression",void 0),a([c({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],Tc.prototype,"returnType",void 0),Tc=qS=a([b("esri.popup.ElementExpressionInfo")],Tc);const qre=Tc;var GS;let Yp=GS=class extends Go{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new GS({expressionInfo:this.expressionInfo?.clone()})}};a([c({type:qre,json:{write:!0}})],Yp.prototype,"expressionInfo",void 0),a([c({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],Yp.prototype,"type",void 0),Yp=GS=a([b("esri.popup.content.ExpressionContent")],Yp);const Yw=Yp;let s0=class extends pe(F){constructor(e){super(e),this.type=null}};a([c({type:["date-time","number"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],s0.prototype,"type",void 0),s0=a([b("esri.layers.support.FieldFormat")],s0);const CM=s0,_4="auto";let eo=class extends CM{constructor(e){super(e),this.dateStyle=null,this.hour12=_4,this.month=null,this.timeStyle=null,this.type="date-time",this.year=null}};a([c({type:["full","long","medium","short"],json:{write:!0}})],eo.prototype,"dateStyle",void 0),a([c({type:["always","auto","never"],nonNullable:!0,json:{default:_4,write:!0}})],eo.prototype,"hour12",void 0),a([c({type:["long","short"],json:{write:!0}})],eo.prototype,"month",void 0),a([c({type:["full","long","medium","short"],json:{write:!0}})],eo.prototype,"timeStyle",void 0),a([c({type:["date-time"]})],eo.prototype,"type",void 0),a([c({type:["numeric"],json:{write:!0}})],eo.prototype,"year",void 0),eo=a([b("esri.layers.support.DateTimeFieldFormat")],eo);const gu=eo,HO={min:0,max:20},S4=2,$4=0,x4="decimal",T4="auto";let aa=class extends CM{constructor(e){super(e),this.maximumFractionDigits=S4,this.minimumFractionDigits=$4,this.style=x4,this.type="number",this.useGrouping=T4}};a([c({type:xe,nonNullable:!0,range:HO,json:{default:S4,write:!0}})],aa.prototype,"maximumFractionDigits",void 0),a([c({type:xe,nonNullable:!0,range:HO,json:{default:$4,write:!0}})],aa.prototype,"minimumFractionDigits",void 0),a([c({type:["decimal"],nonNullable:!0,json:{default:x4,write:!0}})],aa.prototype,"style",void 0),a([c({type:["number"]})],aa.prototype,"type",void 0),a([c({type:["always","auto","never"],nonNullable:!0,json:{default:T4,write:!0}})],aa.prototype,"useGrouping",void 0),aa=a([b("esri.layers.support.NumberFieldFormat")],aa);const Dv=aa;let Mc=class extends pe(F){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};a([se(EZ)],Mc.prototype,"dateFormat",void 0),a([c({type:Boolean,json:{write:!0}})],Mc.prototype,"digitSeparator",void 0),a([c({type:xe,json:{write:!0}})],Mc.prototype,"places",void 0),Mc=a([b("esri.popup.support.FieldInfoFormat")],Mc);const Do=Mc,M4={base:CM,key:"type",errorContext:"field-configuration-field-format",typeMap:{"date-time":gu,number:Dv}};function Gre(t,e){const{format:r}=t;return e&&Ju(e)?r?I4(r,e):Zf(e,{hour12:"always",useGrouping:"always"}):null}function I4(t,e){const{dateFormat:r}=t;if(!e)return r?ZO(t):WO(t);if(!Ju(e))return;const i={hour12:"always"};switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return E4(t);case"single":case"double":return WO(t);case"date":case"timestamp-offset":return r?ZO(t):Zf(e,i);case"date-only":return r?Bre(t):Zf(e);case"time-only":return r?Hre(t):Zf(e,i)}}function Ju(t){return OM(t)||v4(t)||Ore(t)||w4(t)||kre(t)}function E4(t){return new Dv({useGrouping:t.digitSeparator?"always":"never"})}function WO(t){const e=E4(t),{places:r}=t;return e.minimumFractionDigits=r??0,e.maximumFractionDigits=r??2,e}function ZO(t){return new gu({dateStyle:O4(t),year:A4(t),month:C4(t),timeStyle:P4(t),hour12:k4(t)})}function Bre(t){return new gu({dateStyle:O4(t),year:A4(t),month:C4(t)})}function Hre(t){return new gu({timeStyle:P4(t),hour12:k4(t)})}function O4(t){const{dateFormat:e}=t;return e?e.startsWith("short-date")?"short":e.startsWith("day-short-month-year")?"medium":e.startsWith("long-month-day-year")?"long":e.startsWith("long-date")?"full":null:null}function k4(t){return t.dateFormat?.endsWith("-24")?"never":"always"}function C4(t){switch(t.dateFormat){case"short-month-year":return"short";case"long-month-year":return"long";default:return null}}function P4(t){const{dateFormat:e}=t;return e?e.includes("short-time")?"short":e.includes("long-time")?"medium":null:null}function A4(t){switch(t.dateFormat){case"short-month-year":case"long-month-year":case"year":return"numeric";default:return null}}function PM(t,e){const r=t.type==="number",i=t.type==="date-time";if(!e)return r?JO(t):i?YO(t):null;if(Ju(e))switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return r?R4(t):null;case"single":case"double":return r?JO(t):null;case"date":case"timestamp-offset":return i?YO(t):null;case"date-only":return i?Wre(t):null;case"time-only":return i?Zre(t):null}}function R4(t){return new Do({digitSeparator:t.useGrouping!=="never"})}function JO(t){const e=R4(t);return e.places=t.maximumFractionDigits,e}function YO(t){let e;const r=L4(t),i=F4(t),s=t.hour12==="never"?"24":null,n=t.year==="numeric"?"year":null,o=N4(t);return r&&i&&s?e=`${r}-${i}-${s}`:r&&i?e=`${r}-${i}`:r?e=r:n&&o?e=`${o}-${n}`:n&&(e=n),e?new Do({dateFormat:e}):null}function Wre(t){let e;const r=L4(t),i=t.year==="numeric"?"year":null,s=N4(t);return r?e=r:i&&s?e=`${s}-${i}`:i&&(e=i),e?new Do({dateFormat:e}):null}function Zre(t){let e;const r=F4(t),i=t.hour12==="never"?"24":null;return r&&i?e=`short-date-${r}-${i}`:r&&(e=`short-date-${r}`),e?new Do({dateFormat:e}):null}function L4(t){switch(t.dateStyle){case"short":return"short-date";case"medium":return"day-short-month-year";case"long":return"long-month-day-year";case"full":return"long-date";default:return}}function F4(t){return t.timeStyle&&(t.timeStyle==="short"?"short-time":"long-time")}function N4(t){switch(t.month){case"short":return"short-month";case"long":return"long-month";default:return}}function Zf(t,e){if(!Ju(t))return;const r=e?.useGrouping??"auto",i=e?.hour12??"auto";switch(t.type){case"integer":case"small-integer":case"big-integer":case"long":return new Dv({minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:r});case"single":case"double":return new Dv({minimumFractionDigits:0,maximumFractionDigits:2,useGrouping:r});case"date":case"timestamp-offset":return new gu({dateStyle:"short",timeStyle:"short",hour12:i});case"date-only":return new gu({dateStyle:"short"});case"time-only":return new gu({timeStyle:"short",hour12:i})}}let xi=class extends pe(F){constructor(e){super(e),this.fieldName=null,this.isEditable=!0,this.label=null,this.statisticType=null,this.stringFieldOption="text-box",this.tooltip=null,this.visible=!0}set fieldFormat(e){this._set("fieldFormat",e),this._set("format",e?PM(e):null)}set format(e){this._set("format",e),this._set("fieldFormat",e?I4(e):null)}readFormat(e,r){if(!r.fieldFormat)return e?Do.fromJSON(e):null}clone(){const e=super.clone();return e._set("format",this.format?.clone()),e._set("fieldFormat",this.fieldFormat?.clone()),e}};a([c({value:null,clonable:!1,types:M4,json:{write:{overridePolicy(t,e,r){const{fieldName:i}=this;return{enabled:!!i&&!i.startsWith("expression/")&&!i.startsWith("relationships/")&&!!r?.writeFieldFormat}}}}})],xi.prototype,"fieldFormat",null),a([c({type:String,json:{write:!0}})],xi.prototype,"fieldName",void 0),a([c({value:null,clonable:!1,type:Do,json:{write:!0}})],xi.prototype,"format",null),a([V("format")],xi.prototype,"readFormat",null),a([c({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],xi.prototype,"isEditable",void 0),a([c({type:String,json:{write:!0}})],xi.prototype,"label",void 0),a([c({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],xi.prototype,"statisticType",void 0),a([se(new $e({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],xi.prototype,"stringFieldOption",void 0),a([c({type:String,json:{write:!0}})],xi.prototype,"tooltip",void 0),a([c({type:Boolean,json:{write:!0}})],xi.prototype,"visible",void 0),xi=a([b("esri.popup.FieldInfo")],xi);const Kw=xi;var BS;let la=BS=class extends Go{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}clone(){return new BS(E({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};a([c({type:Object,json:{write:!0}})],la.prototype,"attributes",void 0),a([c({type:String,json:{write:!0}})],la.prototype,"description",void 0),a([c({type:[Kw],json:{write:!0}})],la.prototype,"fieldInfos",void 0),a([c({type:String,json:{write:!0}})],la.prototype,"title",void 0),a([c({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],la.prototype,"type",void 0),la=BS=a([b("esri.popup.content.FieldsContent")],la);const Ph=la;let kl=class extends F{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};a([c({type:String,json:{write:!0}})],kl.prototype,"altText",void 0),a([c({type:String,json:{write:!0}})],kl.prototype,"caption",void 0),a([c({type:String,json:{write:!0}})],kl.prototype,"title",void 0),a([c({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],kl.prototype,"type",void 0),kl=a([b("esri.popup.content.mixins.MediaInfo")],kl);const AM=kl;var HS;let Cl=HS=class extends X{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new HS({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};a([c()],Cl.prototype,"color",void 0),a([c()],Cl.prototype,"fieldName",void 0),a([c()],Cl.prototype,"tooltip",void 0),a([c()],Cl.prototype,"value",void 0),Cl=HS=a([b("esri.popup.content.support.ChartMediaInfoValueSeries")],Cl);const Jre=Cl;var WS;let ua=WS=class extends F{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new WS({colors:E(this.colors),fields:E(this.fields),normalizeField:this.normalizeField,series:E(this.series),tooltipField:this.tooltipField})}};a([c({type:[ue],json:{type:[[xe]],write:!0}})],ua.prototype,"colors",void 0),a([c({type:[String],json:{write:{isRequired:!0}}})],ua.prototype,"fields",void 0),a([c({type:String,json:{write:!0}})],ua.prototype,"normalizeField",void 0),a([c({type:[Jre],json:{read:!1}})],ua.prototype,"series",void 0),a([c({type:String,json:{write:!0}})],ua.prototype,"tooltipField",void 0),ua=WS=a([b("esri.popup.content.support.ChartMediaInfoValue")],ua);const Yre=ua;let Kp=class extends AM{constructor(e){super(e),this.type=null,this.value=void 0}};a([c({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Kp.prototype,"type",void 0),a([c({type:Yre,json:{write:{isRequired:!0}}})],Kp.prototype,"value",void 0),Kp=a([b("esri.popup.content.mixins.ChartMediaInfo")],Kp);const Qw=Kp,Xw=Lt()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var ZS;let n0=ZS=class extends Qw{constructor(t){super(t),this.type="bar-chart"}clone(){return new ZS({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};a([c({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:Xw.write,isRequired:!0}}})],n0.prototype,"type",void 0),n0=ZS=a([b("esri.popup.content.BarChartMediaInfo")],n0);const D4=n0;var JS;let o0=JS=class extends Qw{constructor(t){super(t),this.type="column-chart"}clone(){return new JS({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};a([c({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:Xw.write,isRequired:!0}}})],o0.prototype,"type",void 0),o0=JS=a([b("esri.popup.content.ColumnChartMediaInfo")],o0);const j4=o0;var YS;let Qp=YS=class extends F{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new YS({linkURL:this.linkURL,sourceURL:this.sourceURL})}};a([c({type:String,json:{write:!0}})],Qp.prototype,"linkURL",void 0),a([c({type:String,json:{write:{isRequired:!0}}})],Qp.prototype,"sourceURL",void 0),Qp=YS=a([b("esri.popup.content.support.ImageMediaInfoValue")],Qp);const Kre=Qp;var KS;let Ic=KS=class extends AM{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new KS({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};a([c({type:Number,json:{write:!0}})],Ic.prototype,"refreshInterval",void 0),a([c({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Ic.prototype,"type",void 0),a([c({type:Kre,json:{write:{isRequired:!0}}})],Ic.prototype,"value",void 0),Ic=KS=a([b("esri.popup.content.ImageMediaInfo")],Ic);const V4=Ic;var QS;let a0=QS=class extends Qw{constructor(t){super(t),this.type="line-chart"}clone(){return new QS({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};a([c({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:Xw.write,isRequired:!0}}})],a0.prototype,"type",void 0),a0=QS=a([b("esri.popup.content.LineChartMediaInfo")],a0);const z4=a0;var XS;let l0=XS=class extends Qw{constructor(t){super(t),this.type="pie-chart"}clone(){return new XS({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};a([c({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:Xw.write,isRequired:!0}}})],l0.prototype,"type",void 0),l0=XS=a([b("esri.popup.content.PieChartMediaInfo")],l0);const U4=l0,e2={base:AM,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":D4,"column-chart":j4,"line-chart":z4,"pie-chart":U4,image:V4}};var t2;let As=t2=class extends Go{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?V4.fromJSON(e):e.type==="barchart"?D4.fromJSON(e):e.type==="columnchart"?j4.fromJSON(e):e.type==="linechart"?z4.fromJSON(e):e.type==="piechart"?U4.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(r=>r.toJSON())}clone(){return new t2(E({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};a([c()],As.prototype,"activeMediaInfoIndex",void 0),a([c({type:Object,json:{write:!0}})],As.prototype,"attributes",void 0),a([c({type:String,json:{write:!0}})],As.prototype,"description",void 0),a([c({types:[e2]})],As.prototype,"mediaInfos",void 0),a([V("mediaInfos")],As.prototype,"readMediaInfos",null),a([q("mediaInfos")],As.prototype,"writeMediaInfos",null),a([c({type:String,json:{write:!0}})],As.prototype,"title",void 0),a([c({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],As.prototype,"type",void 0),As=t2=a([b("esri.popup.content.MediaContent")],As);const Cm=As;var r2;let Xp=r2=class extends F{constructor(t){super(t),this.field=null,this.order=null}clone(){return new r2({field:this.field,order:this.order})}};a([c({type:String,json:{write:!0}})],Xp.prototype,"field",void 0),a([c({type:["asc","desc"],json:{write:!0}})],Xp.prototype,"order",void 0),Xp=r2=a([b("esri.popup.support.RelatedRecordsInfoFieldOrder")],Xp);const RM=Xp;let dn=class extends pe(Go){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};a([c({type:String,json:{write:!0}})],dn.prototype,"description",void 0),a([c({type:Number,json:{type:xe,write:!0}})],dn.prototype,"displayCount",void 0),a([c({type:["list"],json:{write:{isRequired:!0}}})],dn.prototype,"displayType",void 0),a([c({type:[RM],json:{write:!0}})],dn.prototype,"orderByFields",void 0),a([c({type:Number,json:{type:xe,write:{isRequired:!0}}})],dn.prototype,"relationshipId",void 0),a([c({type:String,json:{write:!0}})],dn.prototype,"title",void 0),a([c({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],dn.prototype,"type",void 0),dn=a([b("esri.popup.content.RelationshipContent")],dn);const Pm=dn;var i2;let ef=i2=class extends Go{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new i2({text:this.text})}};a([c({type:String,json:{write:!0}})],ef.prototype,"text",void 0),a([c({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],ef.prototype,"type",void 0),ef=i2=a([b("esri.popup.content.TextContent")],ef);const Am=ef;let to=class extends pe(F){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};a([c({type:String,json:{write:!0}})],to.prototype,"title",void 0),a([c({type:String,json:{write:!0}})],to.prototype,"description",void 0),a([c({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],to.prototype,"type",void 0),a([c({type:Number,json:{type:xe,write:!0}})],to.prototype,"associatedNetworkSourceId",void 0),a([c({type:Number,json:{type:xe,write:!0}})],to.prototype,"associatedAssetGroup",void 0),a([c({type:Number,json:{type:xe,write:!0}})],to.prototype,"associatedAssetType",void 0),to=a([b("esri.popup.support.UtilityNetworkAssociationType")],to);const q4=to;let ca=class extends pe(Go){constructor(e){super(e),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};a([c({type:String,json:{write:!0}})],ca.prototype,"description",void 0),a([c({type:Number,json:{type:xe,write:!0}})],ca.prototype,"displayCount",void 0),a([c({type:String,json:{write:!0}})],ca.prototype,"title",void 0),a([c({type:[q4],json:{write:!0}})],ca.prototype,"associationTypes",void 0),a([se({utilityNetworkAssociations:"utility-network-associations"})],ca.prototype,"type",void 0),ca=a([b("esri.popup.content.UtilityNetworkAssociationsContent")],ca);const LM=ca,Qre={base:null,key:"type",typeMap:{attachment:Ch,media:Cm,text:Am,expression:Yw,field:Ph,relationship:Pm,utilityNetworkAssociations:LM}},Xre={base:null,key:"type",typeMap:{attachment:Ch,media:Cm,text:Am,expression:Yw,field:Ph,relationship:Pm}};var s2;let Pl=s2=class extends F{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new s2({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};a([c({type:String,json:{write:!0}})],Pl.prototype,"name",void 0),a([c({type:String,json:{write:!0}})],Pl.prototype,"title",void 0),a([c({type:String,json:{write:!0}})],Pl.prototype,"expression",void 0),a([c({type:["string","number"],json:{write:!0}})],Pl.prototype,"returnType",void 0),Pl=s2=a([b("esri.popup.ExpressionInfo")],Pl);const eie=Pl;var n2;let tf=n2=class extends F{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new n2({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};a([c({type:Boolean,json:{write:!0}})],tf.prototype,"returnTopmostRaster",void 0),a([c({type:Boolean,json:{write:!0}})],tf.prototype,"showNoDataRecords",void 0),tf=n2=a([b("esri.popup.LayerOptions")],tf);const tie=tf;var o2;let rf=o2=class extends F{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new o2({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?E(this.orderByFields):null})}};a([c({type:Boolean,json:{write:!0}})],rf.prototype,"showRelatedRecords",void 0),a([c({type:[RM],json:{write:!0}})],rf.prototype,"orderByFields",void 0),rf=o2=a([b("esri.popup.RelatedRecordsInfo")],rf);const KO=rf;var a2;let Xi=a2=class extends Lw(X){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new a2({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};a([c()],Xi.prototype,"active",void 0),a([c()],Xi.prototype,"className",void 0),a([c()],Xi.prototype,"disabled",void 0),a([c()],Xi.prototype,"icon",void 0),a([c()],Xi.prototype,"id",void 0),a([c()],Xi.prototype,"indicator",void 0),a([c()],Xi.prototype,"title",void 0),a([c()],Xi.prototype,"type",void 0),a([c()],Xi.prototype,"visible",void 0),Xi=a2=a([b("esri.support.actions.ActionBase")],Xi);const FM=Xi;var l2;let u0=l2=class extends FM{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new l2({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};a([c()],u0.prototype,"image",void 0),u0=l2=a([b("esri.support.actions.ActionButton")],u0);const rie=u0;var u2;let sf=u2=class extends FM{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new u2({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};a([c()],sf.prototype,"image",void 0),a([c()],sf.prototype,"value",void 0),sf=u2=a([b("esri.support.actions.ActionToggle")],sf);const iie=sf,Mp="relationships/",QO="expression/",sie=H.ofType({key:"type",defaultKeyValue:"button",base:FM,typeMap:{button:rie,toggle:iie}}),nie={base:Go,key:"type",typeMap:{media:Cm,custom:Ure,text:Am,attachments:Ch,fields:Ph,expression:Yw,relationship:Pm,utilityNetworkAssociations:LM}},G4=new Set(["attachments","fields","media","text","expression","relationship"]),oie=new Set([...G4,"utility-network-associations"]);let Ot=class extends pe(F){constructor(e){super(e),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(r=>Nn(nie,r)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||Pr(e)?e:(L.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,r){const{popupElements:i}=r;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(r.description,r.mediaInfos,i):this._readPopupInfo(r)}writeWebSceneContent(e,r,i,s){this._writePopupTemplateContent(e,r,s)}writeWebMapContent(e,r,i,s){this._writePopupTemplateContent(e,r,s)}writeFieldInfos(e,r,i,s){const{content:n}=this,o=Array.isArray(n)?n:null,{writeFieldFormat:l,...u}=s||{};if(e){const d=o?o.filter(f=>f.type==="fields"):[],p=d.length&&d.every(f=>f.fieldInfos?.length);r.fieldInfos=e.filter(Boolean).map(f=>{const m=f.toJSON(u);return p&&(m.visible=!1),m})}if(o)for(const d of o)d.type==="fields"&&this._writeFieldsContent(d,r,u)}writeLayerOptions(e,r,i,s){r[i]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(s)}writeTitle(e,r){r.title=e||""}async collectRequiredFields(e,r,i){const s=this.expressionInfos||[];await this._collectExpressionInfoFields(e,r,i,[...s,...this._getContentExpressionInfos(this.content,s)]),Nu(e,r,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e,r){const i=new Set;return await this.collectRequiredFields(i,e,r),[...i].sort()}_writePopupTemplateContent(e,r,i){typeof e!="string"?Array.isArray(e)&&(r.popupElements=e.filter(s=>i?.origin==="web-scene"?G4.has(s.type):oie.has(s.type)).map(s=>s?.toJSON(i)),r.popupElements.forEach(s=>{s.type==="attachments"?this._writeAttachmentContent(r):s.type==="media"?this._writeMediaContent(s,r):s.type==="text"?this._writeTextContent(s,r):s.type==="relationship"&&this._writeRelationshipContent(s,r)})):r.description=e}_writeFieldsContent(e,r,i){const s=e.fieldInfos;if(!Array.isArray(s)||!s.length)return;const n=r.fieldInfos;if(Array.isArray(n))for(const o of s){const l=n.find(u=>u.fieldName?.toLowerCase()===o.fieldName?.toLowerCase());l?l.visible=!0:n.push(o.toJSON(i))}else r.fieldInfos=s.map(o=>o.toJSON(i))}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,r){const i=e.orderByFields?.map(n=>this._toFieldOrderJSON(n,e.relationshipId))||[],s=[...r.relatedRecordsInfo?.orderByFields||[],...i];r.relatedRecordsInfo={showRelatedRecords:!0,...s?.length&&{orderByFields:s}}}_writeTextContent(e,r){!r.description&&e.text&&(r.description=e.text)}_writeMediaContent(e,r){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const i=E(e.mediaInfos);Array.isArray(r.mediaInfos)?r.mediaInfos=[...r.mediaInfos,...i]:r.mediaInfos=i}_readPopupInfoElements(e,r,i){const s={description:!1,mediaInfos:!1};return i.map(n=>n.type==="media"?(n.mediaInfos||!r||s.mediaInfos||(n.mediaInfos=r,s.mediaInfos=!0),Cm.fromJSON(n)):n.type==="text"?(n.text||!e||s.description||(n.text=e,s.description=!0),Am.fromJSON(n)):n.type==="attachments"?Ch.fromJSON(n):n.type==="fields"?Ph.fromJSON(n):n.type==="expression"?Yw.fromJSON(n):n.type==="relationship"?Pm.fromJSON(n):n.type==="utilityNetworkAssociations"?LM.fromJSON(n):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:r,order:i}=e;if(!r?.startsWith(Mp))return null;const s=r.replace(Mp,"").split("/");if(s.length!==2)return null;const n=parseInt(s[0],10),o=s[1];return!Number.isNaN(n)&&o?Pm.fromJSON({relationshipId:n,orderByFields:[{field:o,order:i}]}):null}_toFieldOrderJSON(e,r){const{order:i,field:s}=e;return{field:`${Mp}${r}/${s}`,order:i}}_readPopupInfo({description:e,mediaInfos:r,showAttachments:i,relatedRecordsInfo:s={showRelatedRecords:!1}}){const n=[];e?n.push(new Am({text:e})):n.push(new Ph),Array.isArray(r)&&r.length&&n.push(Cm.fromJSON({mediaInfos:r})),i&&n.push(Ch.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:l}=s;return o&&l?.length&&l.forEach(u=>{const d=this._toRelationshipContent(u);d&&n.push(d)}),n.length?n:e}_getContentElementFields(e){const r=e?.type;if(r==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(r==="custom")return e.outFields||[];if(r==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(r==="media"){const i=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...i.reduce((s,n)=>[...s,...this._getMediaInfoFields(n)],[])]}return r==="text"?this._extractFieldNames(e.text):r==="relationship"||r==="utility-network-associations"?[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)]:[]}_getMediaInfoFields(e){const{caption:r,title:i,value:s}=e,n=s||{},{fields:o,normalizeField:l,tooltipField:u,sourceURL:d,linkURL:p}=n,f=[...this._extractFieldNames(i),...this._extractFieldNames(r),...this._extractFieldNames(d),...this._extractFieldNames(p),...o??[]];return l&&f.push(l),u&&f.push(u),f}_getContentExpressionInfos(e,r){return Array.isArray(e)?e.reduce((i,s)=>[...i,...s.type==="expression"&&s.expressionInfo?[s.expressionInfo]:[]],r):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((r,i)=>[...r,...this._getContentElementFields(i)],[]):[]}async _collectExpressionInfoFields(e,r,i,s){s&&await Promise.all(s.map(n=>Lr(e,r,i,n.expression)))}_getFieldInfoFields(e){return e?e.filter(({fieldName:r,visible:i})=>!(i!==void 0&&!i||!r||r.startsWith(Mp)||r.startsWith(QO))).map(r=>r.fieldName):[]}_getActionsFields(e){return e?e.toArray().reduce((r,i)=>[...r,...this._getActionFields(i)],[]):[]}_getActionFields(e){const{className:r,title:i,type:s}=e,n=s==="button"||s==="toggle"?e.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(r),...this._extractFieldNames(n)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return kM(e).filter(r=>!(r.startsWith(Mp)||r.startsWith(QO)))}};a([c({type:sie})],Ot.prototype,"actions",void 0),a([c()],Ot.prototype,"content",void 0),a([Ce("content")],Ot.prototype,"castContent",null),a([V("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],Ot.prototype,"readContent",null),a([q("web-scene","content",{popupElements:{type:H.ofType(Xre)},showAttachments:{type:Boolean},mediaInfos:{type:H.ofType(e2)},description:{type:String},relatedRecordsInfo:{type:KO}})],Ot.prototype,"writeWebSceneContent",null),a([q("content",{popupElements:{type:H.ofType(Qre)},showAttachments:{type:Boolean},mediaInfos:{type:H.ofType(e2)},description:{type:String},relatedRecordsInfo:{type:KO}})],Ot.prototype,"writeWebMapContent",null),a([c({type:[eie],json:{write:!0}})],Ot.prototype,"expressionInfos",void 0),a([c({type:[Kw]})],Ot.prototype,"fieldInfos",void 0),a([q("fieldInfos")],Ot.prototype,"writeFieldInfos",null),a([c({type:tie})],Ot.prototype,"layerOptions",void 0),a([q("layerOptions")],Ot.prototype,"writeLayerOptions",null),a([c({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],Ot.prototype,"lastEditInfoEnabled",void 0),a([c()],Ot.prototype,"outFields",void 0),a([c()],Ot.prototype,"overwriteActions",void 0),a([c()],Ot.prototype,"returnGeometry",void 0),a([c({json:{type:String}})],Ot.prototype,"title",void 0),a([q("title")],Ot.prototype,"writeTitle",null),Ot=a([b("esri.PopupTemplate")],Ot);const Vn=Ot,NM=Symbol("idFieldsProviderSymbol");function aie(t){return!!t&&NM in t}function XO(t){return aie(t)?t[NM]:void 0}const dy=Symbol("popupProvider");function H2e(t){return typeof t=="object"&&t!==null&&"popupEnabled"in t&&"popupTemplate"in t}function lie(t){return!!t&&dy in t}function uie(t){return lie(t)?t[dy]:null}function W2e(t,e){switch(e.type){case"object-id":case"unique-id-simple":return t.attributes[e.fieldName];case"unique-id-composite":{const r=[];for(const i of e.fieldNames)r.push(t.attributes[i]??null);return JSON.stringify(r)}}}function ek(t,e){if("uniqueIdFields"in e&&e.uniqueIdFields?.length){if(e.uniqueIdFields.length===1)return t.attributes?.[e.uniqueIdFields[0]];const r=e.uniqueIdFields.map(i=>t.attributes?.[i]);return JSON.stringify(r)}return"objectIdField"in e&&e.objectIdField?t.attributes?.[e.objectIdField]:null}const tk=new $e({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let cie=0,_t=class extends F{constructor(e){super(e),this.id="sym"+cie++,this.type=null,this.color=new ue([0,0,0,1])}readColor(e){return e?.[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,r){}hash(){return JSON.stringify(this.toJSON())}clone(){}};a([c({type:tk.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:tk.write,isRequired:!0}}})],_t.prototype,"type",void 0),a([c({type:ue,json:{write:{allowNull:!0}}})],_t.prototype,"color",void 0),a([V("color")],_t.prototype,"readColor",null),_t=a([b("esri.symbols.Symbol")],_t);var c2;let Ir=c2=class extends _t{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){if(this.data?.type==="CIMSymbolReference"){const r=this.data.primitiveOverrides;if(r){const i=r.map(s=>{const n=s.valueExpressionInfo;return n?Lr(t,e,null,n.expression):null});await Promise.all(i)}}}clone(){return new c2({data:E(this.data)})}hash(){return KA(JSON.stringify(this.data)).toString()}};a([c({json:{write:!1}})],Ir.prototype,"color",void 0),a([c({json:{write:!0}})],Ir.prototype,"data",void 0),a([V("data",["symbol"])],Ir.prototype,"readData",null),a([q("data",{})],Ir.prototype,"writeData",null),a([se({CIMSymbolReference:"cim"},{readOnly:!0})],Ir.prototype,"type",void 0),Ir=c2=a([b("esri.symbols.CIMSymbol")],Ir);let Zr=class extends F{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,r,i){e||(r[i]=e)}};a([c({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],Zr.prototype,"enabled",void 0),a([q("enabled")],Zr.prototype,"writeEnabled",null),a([c({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0,json:{write:{isRequired:!0}}})],Zr.prototype,"type",void 0),Zr=a([b("esri.symbols.Symbol3DLayer")],Zr);function die(t,e){const r=e.transparency!=null?_m(e.transparency):1,i=e.color;return i&&Array.isArray(i)?new ue([i[0]||0,i[1]||0,i[2]||0,r]):null}function hie(t,e){e.color=t.toJSON().slice(0,3);const r=Nw(t.a);r!==0&&(e.transparency=r)}function dl(t){return{type:ue,nonNullable:t?.nonNullable,json:{type:[xe],default:null,read:{source:["color","transparency"],reader:die},write:{target:{color:{type:[xe],isRequired:t?.colorRequiredOnWrite},transparency:{type:xe}},writer:hie}}}}const zn={type:Number,cast:Me,json:{write:!0}};function Y2e(t){return t==="emissive"?0:1}let Al=class extends F{constructor(e){super(e),this.color=new ue([0,0,0,1]),this.extensionLength=0,this.size=gs(1)}clone(){}cloneProperties(){return{color:E(this.color),size:this.size,extensionLength:this.extensionLength}}};a([c({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],Al.prototype,"type",void 0),a([c(dl({colorRequiredOnWrite:!0}))],Al.prototype,"color",void 0),a([c({...zn,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],Al.prototype,"extensionLength",void 0),a([c(zn)],Al.prototype,"size",void 0),Al=a([b("esri.symbols.edges.Edges3D")],Al);const DM=Al;var d2;let c0=d2=class extends DM{constructor(t){super(t),this.type="sketch"}clone(){return new d2(this.cloneProperties())}};a([se({sketch:"sketch"},{readOnly:!0})],c0.prototype,"type",void 0),c0=d2=a([b("esri.symbols.edges.SketchEdges3D")],c0);const pie=c0;var h2;let d0=h2=class extends DM{constructor(t){super(t),this.type="solid"}clone(){return new h2(this.cloneProperties())}};a([se({solid:"solid"},{readOnly:!0})],d0.prototype,"type",void 0),d0=h2=a([b("esri.symbols.edges.SolidEdges3D")],d0);const B4=d0,H4={types:{key:"type",base:DM,typeMap:{solid:B4,sketch:pie}},json:{write:!0}};var p2;let dd=p2=class extends F{constructor(){super(...arguments),this.strength=null,this.source="emissive"}clone(){const t={strength:this.strength,source:this.source};return new p2(t)}};a([c({json:{write:!1}})],dd.prototype,"strength",void 0),a([c({json:{write:!1}})],dd.prototype,"source",void 0),dd=p2=a([b("esri.symbols.support.Symbol3DEmissive")],dd);var f2;let Ni=f2=class extends F{constructor(t){super(t),this.color=null,this.emissive=new dd({source:"emissive"})}clone(){const t={color:this.color?.clone()??null,emissive:this.emissive?.clone()??null};return new f2(t)}};a([c(dl())],Ni.prototype,"color",void 0),a([c({type:dd,json:{write:!1}})],Ni.prototype,"emissive",void 0),Ni=f2=a([b("esri.symbols.support.Symbol3DMaterial")],Ni);var m2,Gd;let mo=(Gd=class extends Zr{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new m2({edges:this.edges?.clone(),enabled:this.enabled,material:this.material?.clone(),castShadows:this.castShadows,size:this.size})}},m2=Gd,Gd);a([se({Extrude:"extrude"},{readOnly:!0})],mo.prototype,"type",void 0),a([c({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],mo.prototype,"size",void 0),a([c({type:Ni,json:{write:!0}})],mo.prototype,"material",void 0),a([c({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],mo.prototype,"castShadows",void 0),a([c(H4)],mo.prototype,"edges",void 0),mo=m2=a([b("esri.symbols.ExtrudeSymbol3DLayer")],mo);let Jf=class extends F{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};a([c({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Jf.prototype,"type",void 0),Jf=a([b("esri.symbols.patterns.LinePattern3D")],Jf);const fie=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var y2;const mie=Lt()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let nu=y2=class extends Jf{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new y2(t)}};a([c({type:["style"],json:{write:{isRequired:!0}}})],nu.prototype,"type",void 0),a([se(mie),c({type:fie,json:{write:{isRequired:!0}}})],nu.prototype,"style",void 0),nu=y2=a([b("esri.symbols.patterns.LineStylePattern3D")],nu);let Yf=class extends F{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};a([c({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Yf.prototype,"type",void 0),Yf=a([b("esri.symbols.patterns.Pattern3D")],Yf);const yie=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var g2;let hd=g2=class extends Yf{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new g2({style:this.style})}};a([c({type:["style"],json:{write:{isRequired:!0}}})],hd.prototype,"type",void 0),a([c({type:yie,json:{read:!0,write:{isRequired:!0}}})],hd.prototype,"style",void 0),hd=g2=a([b("esri.symbols.patterns.StylePattern3D")],hd);const gie={types:{key:"type",base:Yf,typeMap:{style:hd}},json:{write:!0}},W4={types:{key:"type",base:Jf,typeMap:{style:nu}},json:{write:!0}},Kf=new ue("white"),vie=new ue([255,255,255,0]);function wie(t){return t.r===0&&t.g===0&&t.b===0}var v2;let Qf=v2=class extends Ni{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color?.clone()??null,colorMixMode:this.colorMixMode,emissive:this.emissive?.clone()??null};return new v2(t)}};a([se({multiply:"multiply",replace:"replace",tint:"tint"})],Qf.prototype,"colorMixMode",void 0),Qf=v2=a([b("esri.symbols.support.Symbol3DFillMaterial")],Qf);function jM(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function bie(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function _ie(t,e,r,i,s,n,o,l,u,d,p,f,m,y,g,v){return[t,e,r,i,s,n,o,l,u,d,p,f,m,y,g,v]}const Sie=jM();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:Sie,clone:bie,create:jM,fromValues:_ie},Symbol.toStringTag,{value:"Module"}));function $ie(t){return t<=GA?new Array(t).fill(0):new Float64Array(t)}function e$e(t){return(dU(t)?t.byteLength/8:t.length)<=GA?Array.from(t):new Float64Array(t)}function t$e(t,e,r){return Array.isArray(t)?t.slice(e,e+r):t.subarray(e,e+r)}function r$e(t){return[...t]}function i$e(t){const e=jM();for(let r=0;r<16;++r)e[r]=t[r];return e}function hy(t=Iie){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function VM(t,e,r,i,s,n,o=hy()){return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o[4]=s,o[5]=n,o}function s$e(t,e=hy()){return xie(t,0,t.length/3,e)}function xie(t,e,r,i=hy()){return Z4(i,w2),Tie(i,t,e,r),i}function n$e(t,e=$ie(24)){const[r,i,s,n,o,l]=t;return e[0]=r,e[1]=i,e[2]=s,e[3]=r,e[4]=i,e[5]=l,e[6]=r,e[7]=o,e[8]=s,e[9]=r,e[10]=o,e[11]=l,e[12]=n,e[13]=i,e[14]=s,e[15]=n,e[16]=i,e[17]=l,e[18]=n,e[19]=o,e[20]=s,e[21]=n,e[22]=o,e[23]=l,e}function o$e(t,e){const r=isFinite(t[2])||isFinite(t[5]);return new he(r?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function a$e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function l$e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function u$e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function Tie(t,e,r=0,i=e.length/3){let s=t[0],n=t[1],o=t[2],l=t[3],u=t[4],d=t[5];for(let p=0;p<i;p++)s=Math.min(s,e[r+3*p]),n=Math.min(n,e[r+3*p+1]),o=Math.min(o,e[r+3*p+2]),l=Math.max(l,e[r+3*p]),u=Math.max(u,e[r+3*p+1]),d=Math.max(d,e[r+3*p+2]);t[0]=s,t[1]=n,t[2]=o,t[3]=l,t[4]=u,t[5]=d}function c$e(t,e,r){const i=e.length;let s=t[0],n=t[1],o=t[2],l=t[3],u=t[4],d=t[5];if(r)for(let p=0;p<i;p++){const f=e[p];s=Math.min(s,f[0]),n=Math.min(n,f[1]),o=Math.min(o,f[2]),l=Math.max(l,f[0]),u=Math.max(u,f[1]),d=Math.max(d,f[2])}else for(let p=0;p<i;p++){const f=e[p];s=Math.min(s,f[0]),n=Math.min(n,f[1]),l=Math.max(l,f[0]),u=Math.max(u,f[1])}t[0]=s,t[1]=n,t[2]=o,t[3]=l,t[4]=u,t[5]=d}function d$e(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function py(t){return t[0]>=t[3]?0:t[3]-t[0]}function fy(t){return t[1]>=t[4]?0:t[4]-t[1]}function my(t){return t[2]>=t[5]?0:t[5]-t[2]}function h$e(t){const e=py(t),r=my(t),i=fy(t);return Math.sqrt(e*e+r*r+i*i)}function p$e(t,e=[0,0,0]){return e[0]=t[0]+py(t)/2,e[1]=t[1]+fy(t)/2,e[2]=t[2]+my(t)/2,e}function f$e(t,e=[0,0,0]){return e[0]=py(t),e[1]=fy(t),e[2]=my(t),e}function m$e(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function Mie(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function y$e(t,e){return e==null||Mie(t,e)}function g$e(t,e,r,i,s=t){return s[0]=t[0]+e,s[1]=t[1]+r,s[2]=t[2]+i,s[3]=t[3]+e,s[4]=t[4]+r,s[5]=t[5]+i,s}function v$e(t,e,r=t){const i=t[0]+py(t)/2,s=t[1]+fy(t)/2,n=t[2]+my(t)/2;return r[0]=i+(t[0]-i)*e,r[1]=s+(t[1]-s)*e,r[2]=n+(t[2]-n)*e,r[3]=i+(t[3]-i)*e,r[4]=s+(t[4]-s)*e,r[5]=n+(t[5]-n)*e,r}function w$e(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function b$e(t,e,r=t){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r!==t&&(r[3]=t[3],r[4]=t[4],r[5]=t[5]),r}function _$e(t,e,r=t){return r[3]=e[0],r[4]=e[1],r[5]=e[2],r!==t&&(r[0]=t[0],r[1]=t[1],r[2]=t[2]),t}function Z4(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function S$e(t){return t?Z4(t,w2):hy(w2)}function $$e(t,e=mi()){return e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function x$e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function T$e(t,e,r,i,s){return t[0]=e,t[1]=r,t[2]=Number.NEGATIVE_INFINITY,t[3]=i,t[4]=s,t[5]=Number.POSITIVE_INFINITY,t}function rk(t){return t.length===6}function M$e(t){return py(t)===0&&fy(t)===0&&my(t)===0}function I$e(t,e,r){if(t==null||e==null)return t===e;if(!rk(t)||!rk(e))return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}const w2=[1/0,1/0,1/0,-1/0,-1/0,-1/0],Iie=[0,0,0,0,0,0];hy();function E$e(t,{isPrimitive:e,width:r,depth:i,height:s}){const n=e?10:1;if(r==null&&s==null&&i==null)return[n*t[0],n*t[1],n*t[2]];const o=tp(r,i,s);let l;for(let u=0;u<3;u++){const d=o[u];if(d!=null){l=d/t[u];break}}for(let u=0;u<3;u++)o[u]==null&&(o[u]=t[u]*l);return o}const Eie=VM(-.5,-.5,-.5,.5,.5,.5),Oie=VM(-.5,-.5,0,.5,.5,1),kie=VM(-.5,-.5,0,.5,.5,.5);function O$e(t){switch(t){case"sphere":case"cube":case"diamond":return Eie;case"cylinder":case"cone":case"inverted-cone":return Oie;case"tetrahedron":return kie;default:return}}const zM=["butt","square","round"],Cie=[...zM,"none"],J4=["miter","bevel","round"];var b2;let Rl=b2=class extends F{constructor(t){super(t),this.color=new ue([0,0,0,1]),this.size=gs(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new b2(t)}};a([c(dl({colorRequiredOnWrite:!0}))],Rl.prototype,"color",void 0),a([c({...zn,json:{write:{isRequired:!0}}})],Rl.prototype,"size",void 0),a([c(W4)],Rl.prototype,"pattern",void 0),a([c({type:zM,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],Rl.prototype,"patternCap",void 0),Rl=b2=a([b("esri.symbols.support.Symbol3DOutline")],Rl);var h0,Bd;let qr=(Bd=class extends Zr{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const e={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new h0(e)}static fromSimpleFillSymbol(e){const r=e.outline&&e.outline.style&&e.outline.style!=="solid"?new nu({style:e.outline.style}):null,i={size:e.outline?.width??0,color:(e.outline?.color??Kf).clone(),pattern:r};return r&&e.outline?.cap&&(i.patternCap=e.outline.cap),new h0({material:new Qf({color:(e.color??vie).clone()}),pattern:e.style&&e.style!=="solid"?new hd({style:e.style}):null,outline:i})}},h0=Bd,Bd);a([se({Fill:"fill"},{readOnly:!0})],qr.prototype,"type",void 0),a([c({type:Qf,json:{write:!0}})],qr.prototype,"material",void 0),a([c(gie)],qr.prototype,"pattern",void 0),a([c({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],qr.prototype,"castShadows",void 0),a([c({type:Rl,json:{write:!0}})],qr.prototype,"outline",void 0),a([c(H4)],qr.prototype,"edges",void 0),qr=h0=a([b("esri.symbols.FillSymbol3DLayer")],qr);var _2;const Pie=Lt()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let Ll=_2=class extends F{constructor(t){super(t)}readHref(t,e,r){return t?qu(t,r):e.dataURI}writeHref(t,e,r,i){t&&(zu(t)?e.dataURI=t:(e.href=Mu(t,i),yi(e.href)&&(e.href=en(e.href))))}clone(){return new _2({href:this.href,primitive:this.primitive})}equals(t){return t.primitive===this.primitive&&t.href===this.href}};a([c({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],Ll.prototype,"href",void 0),a([V("href")],Ll.prototype,"readHref",null),a([q("href",{href:{type:String},dataURI:{type:String}})],Ll.prototype,"writeHref",null),a([se(Pie)],Ll.prototype,"primitive",void 0),Ll=_2=a([b("esri.symbols.support.IconSymbol3DLayerResource")],Ll);const k$e="circle";let p0=class extends pe(F){constructor(e){super(e),this.mode="hidden"}equals(e){return this.mode===e.mode}};a([c({type:["adaptive","hidden","visible"],json:{write:{isRequired:!0}}})],p0.prototype,"mode",void 0),p0=a([b("esri.symbols.support.OccludedVisibility")],p0);const Y4=p0;var S2;let pd=S2=class extends X{constructor(t){super(t),this.x=0,this.y=0}clone(){return new S2({x:this.x,y:this.y})}equals(t){return t.x===this.x&&t.y===this.y}};a([c({type:Number})],pd.prototype,"x",void 0),a([c({type:Number})],pd.prototype,"y",void 0),pd=S2=a([b("esri.symbols.support.Symbol3DAnchorPosition2D")],pd);var $2;let nf=$2=class extends F{constructor(t){super(t),this.color=new ue([0,0,0,1]),this.size=gs(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new $2(t)}equals(t){return t.size===this.size&&(this.color==null?t.color==null:this.color.equals(t.color))}};a([c(dl({colorRequiredOnWrite:!0}))],nf.prototype,"color",void 0),a([c({...zn,json:{write:{isRequired:!0}}})],nf.prototype,"size",void 0),nf=$2=a([b("esri.symbols.support.Symbol3DIconOutline")],nf);var Ec,Hd;let rr=(Hd=class extends Zr{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0,this.occludedVisibility=null}clone(){return new Ec({anchor:this.anchor,anchorPosition:E(this.anchorPosition),enabled:this.enabled,material:E(this.material),outline:E(this.outline),resource:E(this.resource),angle:this.angle,size:this.size,occludedVisibility:E(this.occludedVisibility)})}static fromSimpleMarkerSymbol(e){const r=e.color||Kf,i=ik(e),s=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||Kf).clone()}:null;return new Ec({size:e.size,angle:e.angle,resource:{primitive:Rie(()=>L.getLogger(this.prototype),e.style)},material:{color:r},outline:s,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(e){const r=!e.color||wie(e.color)?Kf:e.color,i=ik(e);return new Ec({size:e.width<=e.height?e.height:e.width,angle:e.angle,resource:{href:e.url},material:{color:r.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(e){return new Ec({resource:{href:uR({mediaType:"application/json",data:JSON.stringify(e.data)})}})}},Ec=Hd,Hd);function ik(t){const e="width"in t?t.width:t.size,r="height"in t?t.height:t.size,i=sk(t.xoffset),s=sk(t.yoffset);return(i||s)&&e&&r?{x:-i/e,y:s/r}:null}function sk(t){return isFinite(t)?t:0}a([c({type:Ni,json:{write:!0}})],rr.prototype,"material",void 0),a([c({type:Ll,json:{write:!0}})],rr.prototype,"resource",void 0),a([se({Icon:"icon"},{readOnly:!0})],rr.prototype,"type",void 0),a([c({...zn,json:{write:{isRequired:!0}}})],rr.prototype,"size",void 0),a([se({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],rr.prototype,"anchor",void 0),a([c({type:pd,json:{type:[Number],read:{reader:t=>new pd({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],rr.prototype,"anchorPosition",void 0),a([c({type:nf,json:{write:!0}})],rr.prototype,"outline",void 0),a([c({type:Number,json:{write:!0,default:0}})],rr.prototype,"angle",void 0),a([c({type:Y4})],rr.prototype,"occludedVisibility",void 0),rr=Ec=a([b("esri.symbols.IconSymbol3DLayer")],rr);const Aie={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function Rie(t,e){return Aie[e]||(t().warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const Lie=["begin","end","begin-end"],K4=["arrow","circle","square","diamond","cross","x"];let To=class extends pe(F){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};a([c({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],To.prototype,"type",void 0),a([c({type:Lie,json:{default:"begin-end",write:!0}})],To.prototype,"placement",void 0),a([c({type:K4,json:{default:"arrow",write:!0}})],To.prototype,"style",void 0),a([c({type:ue,json:{type:[xe],default:null,write:!0}})],To.prototype,"color",void 0),To=a([b("esri.symbols.LineStyleMarker3D")],To);var f0,Wd;let Ur=(Wd=class extends Zr{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=gs(1),this.pattern=null,this.marker=null}clone(){const e={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new f0(e)}static fromSimpleLineSymbol(e){const r={enabled:!0,size:e.width??gs(1),cap:e.cap||"butt",join:e.join||"miter",pattern:e.style?new nu({style:e.style}):null,material:new Ni({color:(e.color||Kf).clone()}),marker:e.marker?new To({placement:e.marker.placement,style:e.marker.style,color:e.marker.color?.clone()??null}):null};return new f0(r)}},f0=Wd,Wd);a([c({type:Ni,json:{write:!0}})],Ur.prototype,"material",void 0),a([se({Line:"line"},{readOnly:!0})],Ur.prototype,"type",void 0),a([c({type:J4,json:{write:!0,default:"miter"}})],Ur.prototype,"join",void 0),a([c({type:zM,json:{write:!0,default:"butt"}})],Ur.prototype,"cap",void 0),a([c({...zn,json:{write:{isRequired:!0}}})],Ur.prototype,"size",void 0),a([c(W4)],Ur.prototype,"pattern",void 0),a([c({types:{key:"type",base:To,typeMap:{style:To}},json:{write:!0}})],Ur.prototype,"marker",void 0),Ur=f0=a([b("esri.symbols.LineSymbol3DLayer")],Ur);var x2;const Fie=Lt()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let of=x2=class extends F{clone(){return new x2({href:this.href,primitive:this.primitive})}};a([c({type:String,json:{read:mw,write:Iu}})],of.prototype,"href",void 0),a([se(Fie)],of.prototype,"primitive",void 0),of=x2=a([b("esri.symbols.support.ObjectSymbol3DLayerResource")],of);const A$e="sphere";var T2;let Jl=T2=class extends X{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new T2({x:this.x,y:this.y,z:this.z})}};a([c({type:Number})],Jl.prototype,"x",void 0),a([c({type:Number})],Jl.prototype,"y",void 0),a([c({type:Number})],Jl.prototype,"z",void 0),Jl=T2=a([b("esri.symbols.support.Symbol3DAnchorPosition3D")],Jl);var M2,Zd;let er=(Zd=class extends Zr{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new M2({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition?.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material?.clone()??null,castShadows:this.castShadows,resource:this.resource?.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}},M2=Zd,Zd);a([c({type:Ni,json:{write:!0}})],er.prototype,"material",void 0),a([c({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],er.prototype,"castShadows",void 0),a([c({type:of,json:{write:!0}})],er.prototype,"resource",void 0),a([se({Object:"object"},{readOnly:!0})],er.prototype,"type",void 0),a([c({type:Number,json:{write:!0}})],er.prototype,"width",void 0),a([c({type:Number,json:{write:!0}})],er.prototype,"height",void 0),a([c({type:Number,json:{write:!0}})],er.prototype,"depth",void 0),a([se({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],er.prototype,"anchor",void 0),a([c({type:Jl,json:{type:[Number],read:{reader:t=>new Jl({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],er.prototype,"anchorPosition",void 0),a([c({type:Number,json:{write:!0}})],er.prototype,"heading",void 0),a([c({type:Number,json:{write:!0}})],er.prototype,"tilt",void 0),a([c({type:Number,json:{write:!0}})],er.prototype,"roll",void 0),a([c({readOnly:!0})],er.prototype,"isPrimitive",null),er=M2=a([b("esri.symbols.ObjectSymbol3DLayer")],er);var I2,Jd;let cr=(Jd=class extends Zr{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(e,r){return e??(r.height==null&&r.size!=null?r.size:void 0)}readHeight(e,r){return e??(r.width==null&&r.size!=null?r.size:void 0)}clone(){return new I2({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}},I2=Jd,Jd);a([c({type:Ni,json:{write:!0}})],cr.prototype,"material",void 0),a([c({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],cr.prototype,"castShadows",void 0),a([se({Path:"path"},{readOnly:!0})],cr.prototype,"type",void 0),a([c({type:["circle","quad"],nonNullable:!0,json:{write:!0,default:"circle"}})],cr.prototype,"profile",void 0),a([c({type:J4,nonNullable:!0,json:{write:!0,default:"miter"}})],cr.prototype,"join",void 0),a([c({type:Cie,nonNullable:!0,json:{write:!0,default:"butt"}})],cr.prototype,"cap",void 0),a([c({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],cr.prototype,"width",void 0),a([V("width",["width","size","height"])],cr.prototype,"readWidth",null),a([c({type:Number,json:{write:!0}})],cr.prototype,"height",void 0),a([V("height",["height","size","width"])],cr.prototype,"readHeight",null),a([c({type:["center","bottom","top"],nonNullable:!0,json:{write:!0,default:"center"}})],cr.prototype,"anchor",void 0),a([c({type:["heading","all"],nonNullable:!0,json:{write:!0,default:"all"}})],cr.prototype,"profileRotation",void 0),cr=I2=a([b("esri.symbols.PathSymbol3DLayer")],cr);const Nie=["none","underline","line-through"],Die=["normal","italic","oblique"],jie=["normal","lighter","bold","bolder"],Q4={type:Number,cast:t=>{const e=Br(t);return e===0?1:Gi(e,.1,4)},nonNullable:!0},Vie=["left","right","center"],zie=["baseline","top","middle","bottom"],X4={type:Vie,nonNullable:!0},ej={type:zie,nonNullable:!0},R$e=8;var E2;let rs=E2=class extends F{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return Me(t)}clone(){return new E2({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};a([c({type:Nie,json:{default:"none",write:!0}})],rs.prototype,"decoration",void 0),a([c({type:String,json:{write:!0}})],rs.prototype,"family",void 0),a([c({type:Number,json:{write:{overridePolicy:(t,e,r)=>({enabled:!r||!r.textSymbol3D})}}})],rs.prototype,"size",void 0),a([Ce("size")],rs.prototype,"castSize",null),a([c({type:Die,json:{default:"normal",write:!0}})],rs.prototype,"style",void 0),a([c({type:jie,json:{default:"normal",write:!0}})],rs.prototype,"weight",void 0),rs=E2=a([b("esri.symbols.Font")],rs);var O2;let fd=O2=class extends F{constructor(){super(...arguments),this.color=new ue([0,0,0,1]),this.size=0}clone(){const t={color:E(this.color),size:this.size};return new O2(t)}};a([c(dl())],fd.prototype,"color",void 0),a([c(zn)],fd.prototype,"size",void 0),fd=O2=a([b("esri.symbols.support.Symbol3DHalo")],fd);let Xf=class extends pe(F){constructor(e){super(e),this.color=null}};a([c(dl())],Xf.prototype,"color",void 0),Xf=a([b("esri.symbols.support.Symbol3DTextBackground")],Xf);var m0,Yd;let Ct=(Yd=class extends Zr{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline",this.occludedVisibility=null}get font(){return this._get("font")||null}set font(e){e!=null&&this._userSize!=null&&(e.size=this._userSize),this._set("font",e)}writeFont(e,r,i,s){const n={...s,textSymbol3D:!0};r.font=e.write({},n),delete r.font.size}get size(){return this._userSize!=null?this._userSize:this.font?.size!=null?this.font.size:9}set size(e){this._userSize=e,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const e=new m0({enabled:this.enabled,font:E(this.font),halo:E(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:E(this.background),occludedVisibility:E(this.occludedVisibility)});return e._userSize=this._userSize,e}static fromTextSymbol(e){return new m0({font:e.font!=null?e.font.clone():new rs,halo:Uie(e.haloColor,e.haloSize),horizontalAlignment:e.horizontalAlignment,lineHeight:e.lineHeight,material:e.color?new Ni({color:e.color.clone()}):null,text:e.text,verticalAlignment:e.verticalAlignment,background:e.backgroundColor?new Xf({color:e.backgroundColor.clone()}):null})}},m0=Yd,Yd);function Uie(t,e){return t&&e!=null&&e>0?new fd({color:E(t),size:e}):null}a([c({type:rs,json:{write:!0}})],Ct.prototype,"font",null),a([q("font")],Ct.prototype,"writeFont",null),a([c({type:fd,json:{write:!0}})],Ct.prototype,"halo",void 0),a([c({...X4,json:{default:"center",write:!0}})],Ct.prototype,"horizontalAlignment",void 0),a([c({...Q4,json:{default:1,write:!0}})],Ct.prototype,"lineHeight",void 0),a([c({type:Ni,json:{write:!0}})],Ct.prototype,"material",void 0),a([c({type:Xf,json:{write:!0}})],Ct.prototype,"background",void 0),a([c(zn)],Ct.prototype,"size",null),a([c({type:String,json:{write:!0}})],Ct.prototype,"text",void 0),a([se({Text:"text"},{readOnly:!0})],Ct.prototype,"type",void 0),a([c({...ej,json:{default:"baseline",write:!0}})],Ct.prototype,"verticalAlignment",void 0),a([c({type:Y4})],Ct.prototype,"occludedVisibility",void 0),Ct=m0=a([b("esri.symbols.TextSymbol3DLayer")],Ct);var k2,Kd;let yo=(Kd=class extends Zr{constructor(e){super(e),this.color=C2.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new k2({color:this.color.clone(),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}},k2=Kd,Kd);a([c({type:ue,nonNullable:!0,json:{type:[xe],write:(t,e,r)=>e[r]=t.toArray(1),default:()=>C2.clone(),defaultEquals:t=>t.toCss(!0)===C2.toCss(!0)}})],yo.prototype,"color",void 0),a([se({Water:"water"},{readOnly:!0})],yo.prototype,"type",void 0),a([c({type:["small","medium","large"],json:{write:!0,default:"medium"}})],yo.prototype,"waterbodySize",void 0),a([c({type:Number,json:{write:!0,default:null}})],yo.prototype,"waveDirection",void 0),a([c({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],yo.prototype,"waveStrength",void 0),yo=k2=a([b("esri.symbols.WaterSymbol3DLayer")],yo);const C2=new ue([0,119,190]);var P2;let Mo=P2=class extends X{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new P2({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};a([c({type:String})],Mo.prototype,"name",void 0),a([c({type:String})],Mo.prototype,"styleUrl",void 0),a([c({type:String})],Mo.prototype,"styleName",void 0),a([c({type:j})],Mo.prototype,"portal",void 0),Mo=P2=a([b("esri.symbols.support.StyleOrigin")],Mo);var A2;let em=A2=class extends X{constructor(){super(...arguments),this.url=""}clone(){return new A2({url:this.url})}};a([c({type:String})],em.prototype,"url",void 0),em=A2=a([b("esri.symbols.support.Thumbnail")],em);const tj={icon:rr,object:er,line:Ur,path:cr,fill:qr,extrude:mo,text:Ct,water:yo},qie=H.ofType({base:Zr,key:"type",typeMap:tj,errorContext:"symbol-layer"});let ui=class extends _t{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const r=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,i=r?.type,s=i||H;this._set("symbolLayers",new s)}get color(){return null}set color(e){this.constructed&&L.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){Pn(e,this._get("symbolLayers"))}readStyleOrigin(e,r,i){if(e.styleUrl&&e.name){const s=qu(e.styleUrl,i);return new Mo({styleUrl:s,name:e.name})}if(e.styleName&&e.name)return new Mo({portal:i?.portal||j.getDefault(),styleName:e.styleName,name:e.name});i?.messages&&i.messages.push(new Ui("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:i,definition:e}))}writeStyleOrigin(e,r,i,s){if(e.styleUrl&&e.name){let n=Mu(e.styleUrl,s);yi(n)&&(n=en(n)),r.styleOrigin={styleUrl:n,name:e.name}}else e.styleName&&e.name&&(e.portal&&s?.portal&&!lR(e.portal.restUrl,s.portal.restUrl)?s?.messages&&s.messages.push(new Ui("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):r.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof Zr||e&&tj[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};a([c({json:{read:!1,write:!1}})],ui.prototype,"color",null),a([c({type:qie,nonNullable:!0,json:{write:!0}}),Ce($L)],ui.prototype,"symbolLayers",null),a([c({type:Mo})],ui.prototype,"styleOrigin",void 0),a([V("styleOrigin")],ui.prototype,"readStyleOrigin",null),a([q("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],ui.prototype,"writeStyleOrigin",null),a([c({type:em,json:{read:!1}})],ui.prototype,"thumbnail",void 0),a([c({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],ui.prototype,"type",void 0),ui=a([b("esri.symbols.Symbol3D")],ui);let md=class extends F{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};a([c({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],md.prototype,"type",void 0),a([c({readOnly:!0})],md.prototype,"visible",void 0),md=a([b("esri.symbols.callouts.Callout3D")],md);var R2;let y0=R2=class extends F{constructor(t){super(t),this.color=new ue("white")}clone(){return new R2({color:E(this.color)})}};a([c(dl({colorRequiredOnWrite:!0}))],y0.prototype,"color",void 0),y0=R2=a([b("esri.symbols.callouts.LineCallout3DBorder")],y0);const Gie=y0;var L2;let go=L2=class extends md{constructor(t){super(t),this.type="line",this.color=new ue([0,0,0,1]),this.size=gs(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new L2({color:E(this.color),size:this.size,border:E(this.border)})}};a([se({line:"line"})],go.prototype,"type",void 0),a([c(dl({colorRequiredOnWrite:!0}))],go.prototype,"color",void 0),a([c({...zn,json:{write:{isRequired:!0}}})],go.prototype,"size",void 0),a([c({type:Gie,json:{write:!0}})],go.prototype,"border",void 0),a([c({readOnly:!0})],go.prototype,"visible",null),go=L2=a([b("esri.symbols.callouts.LineCallout3D")],go);function UM(t){if(!t)return!1;const e=t.verticalOffset;return!(!e||e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function rj(t){return!t||!t.supportsCallout||!t.supportsCallout()?!1:!!t.callout?.visible&&!!UM(t)}function D$e(t){return t.type==="point-3d"||t.type==="label-3d"}function j$e(t){return t.horizontalAlignment==="center"}const ij={types:{key:"type",base:md,typeMap:{line:go}},json:{write:!0}};var F2;let Ia=F2=class extends F{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new F2({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};a([c({...zn,json:{write:{isRequired:!0}}})],Ia.prototype,"screenLength",void 0),a([c({type:Number,nonNullable:!0,json:{write:!0,default:0}})],Ia.prototype,"minWorldLength",void 0),a([c({type:Number,json:{write:!0}})],Ia.prototype,"maxWorldLength",void 0),Ia=F2=a([b("esri.symbols.support.Symbol3DVerticalOffset")],Ia);var g0;const sj=H.ofType({base:null,key:"type",typeMap:{text:Ct}});let Us=g0=class extends ui{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new sj,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return rj(this)}hasVisibleVerticalOffset(){return UM(this)}clone(){return new g0({styleOrigin:E(this.styleOrigin),symbolLayers:E(this.symbolLayers),thumbnail:E(this.thumbnail),callout:E(this.callout),verticalOffset:E(this.verticalOffset)})}static fromTextSymbol(t){return new g0({symbolLayers:new H([Ct.fromTextSymbol(t)])})}};a([c({type:Ia,json:{write:!0}})],Us.prototype,"verticalOffset",void 0),a([c(ij)],Us.prototype,"callout",void 0),a([c({json:{read:!1,write:!1}})],Us.prototype,"styleOrigin",void 0),a([c({type:sj})],Us.prototype,"symbolLayers",void 0),a([se({LabelSymbol3D:"label-3d"},{readOnly:!0})],Us.prototype,"type",void 0),Us=g0=a([b("esri.symbols.LabelSymbol3D")],Us);var v0;const nj=H.ofType({base:null,key:"type",typeMap:{line:Ur,path:cr}}),Bie=H.ofType({base:null,key:"type",typeMap:{line:Ur,path:cr}});let Xs=v0=class extends ui{constructor(t){super(t),this.symbolLayers=new nj,this.type="line-3d"}clone(){return new v0({styleOrigin:E(this.styleOrigin),symbolLayers:E(this.symbolLayers),thumbnail:E(this.thumbnail)})}static fromSimpleLineSymbol(t){return new v0({symbolLayers:new H([Ur.fromSimpleLineSymbol(t)])})}};a([c({type:nj,json:{type:Bie}})],Xs.prototype,"symbolLayers",void 0),a([se({LineSymbol3D:"line-3d"},{readOnly:!0})],Xs.prototype,"type",void 0),Xs=v0=a([b("esri.symbols.LineSymbol3D")],Xs);var w0;const oj=H.ofType({base:null,key:"type",typeMap:{fill:qr}});let Po=w0=class extends ui{constructor(t){super(t),this.symbolLayers=new oj,this.type="mesh-3d"}clone(){return new w0({styleOrigin:E(this.styleOrigin),symbolLayers:E(this.symbolLayers),thumbnail:E(this.thumbnail)})}static fromSimpleFillSymbol(t){return new w0({symbolLayers:new H([qr.fromSimpleFillSymbol(t)])})}};a([c({type:oj})],Po.prototype,"symbolLayers",void 0),a([se({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],Po.prototype,"type",void 0),Po=w0=a([b("esri.symbols.MeshSymbol3D")],Po);let af=class extends _t{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};a([se({esriSLS:"simple-line"},{readOnly:!0})],af.prototype,"type",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],af.prototype,"width",void 0),af=a([b("esri.symbols.LineSymbol")],af);var N2;let hn=N2=class extends F{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,r,i){e[r]=i?.origin==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t?.[0]!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,r,i){i?.origin==="web-map"||(e[r]=t)}clone(){return new N2({color:E(this.color),placement:this.placement,style:this.style})}hash(){return`${this.placement}.${this.color?.hash()}.${this.style}`}};a([c({type:["begin","end","begin-end"],json:{write:!0}})],hn.prototype,"placement",void 0),a([se({"line-marker":"line-marker"},{readOnly:!0}),c({json:{origins:{"web-map":{write:!1}}}})],hn.prototype,"type",void 0),a([c({type:K4})],hn.prototype,"style",void 0),a([q("style")],hn.prototype,"writeStyle",null),a([c({type:ue,value:null,json:{write:{allowNull:!0}}})],hn.prototype,"color",null),a([V("color")],hn.prototype,"readColor",null),a([q("color")],hn.prototype,"writeColor",null),hn=N2=a([b("esri.symbols.LineSymbolMarker")],hn);const Hie=hn;var D2;const f1=new $e({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let wt=D2=class extends af{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,r,i,s,n){if(t&&typeof t!="string")return t;const o={};return t!=null&&(o.style=t),e!=null&&(o.color=e),r!=null&&(o.width=Me(r)),i!=null&&(o.cap=i),s!=null&&(o.join=s),n!=null&&(o.miterLimit=Me(n)),o}clone(){return new D2({color:E(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:this.marker?.clone()})}hash(){return`${super.hash()}.${this.color?.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${this.marker?.hash()}`}};a([se({esriSLS:"simple-line"},{readOnly:!0})],wt.prototype,"type",void 0),a([c({type:f1.apiValues,json:{read:f1.read,write:f1.write}})],wt.prototype,"style",void 0),a([c({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,r)=>({enabled:t!=="round"&&r?.origin==null})}}})],wt.prototype,"cap",void 0),a([c({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,r)=>({enabled:t!=="round"&&r?.origin==null})}}})],wt.prototype,"join",void 0),a([c({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":Hie}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],wt.prototype,"marker",void 0),a([c({type:Number,json:{read:!1,write:!1}})],wt.prototype,"miterLimit",void 0),wt=D2=a([b("esri.symbols.SimpleLineSymbol")],wt);let yd=class extends _t{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline?.hash()}`}};a([c({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":wt}},json:{default:null,write:!0}})],yd.prototype,"outline",void 0),a([c({type:["simple-fill","picture-fill"],readOnly:!0})],yd.prototype,"type",void 0),yd=a([b("esri.symbols.FillSymbol")],yd);function Wie(t,e,r){return e.imageData?uR({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):aj(e.url,r)}function aj(t,e){if(!yi(t)){const r=Jie(e);if(r)return Tu(r,"images",t)}return qu(t,e)}function Zie(t,e,r,i){if(zu(t)){const s=mh(t);if(!s)return;e.contentType=s.mediaType,e.imageData=s.data,r&&r.imageData===e.imageData&&r.url&&Iu(r.url,e,"url",i)}else Iu(t,e,"url",i)}const lj={json:{read:{source:["imageData","url"],reader:Wie},write:{writer(t,e,r,i){Zie(t,e,this.source,i)}}}},uj={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,r){const i={};return e.imageData&&(i.imageData=e.imageData),e.contentType&&(i.contentType=e.contentType),e.url&&(i.url=aj(e.url,r)),i}}}};function Jie(t){if(!t)return null;const{origin:e,layer:r}=t;if(e!=="service"&&e!=="portal-item")return null;const i=r?.type;return i==="feature"||i==="stream"?r.parsedUrl?.path:i==="map-image"||i==="tile"?t.url?.path:null}var j2;let ai=j2=class extends yd{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,r,i){if(t&&typeof t!="string"&&t.imageData==null)return t;const s={};return t&&(s.url=t),e&&(s.outline=e),r!=null&&(s.width=Me(r)),i!=null&&(s.height=Me(i)),s}clone(){const t=new j2({color:E(this.color),height:this.height,outline:E(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",E(this.source)),t}hash(){return`${super.hash()}.${this.color?.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};a([se({esriPFS:"picture-fill"},{readOnly:!0})],ai.prototype,"type",void 0),a([c(lj)],ai.prototype,"url",void 0),a([c({type:Number,json:{write:!0}})],ai.prototype,"xscale",void 0),a([c({type:Number,json:{write:!0}})],ai.prototype,"yscale",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],ai.prototype,"width",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],ai.prototype,"height",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],ai.prototype,"xoffset",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],ai.prototype,"yoffset",void 0),a([c(uj)],ai.prototype,"source",void 0),ai=j2=a([b("esri.symbols.PictureFillSymbol")],ai);let vo=class extends _t{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};a([c({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],vo.prototype,"angle",void 0),a([c({type:["simple-marker","picture-marker"],readOnly:!0})],vo.prototype,"type",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],vo.prototype,"xoffset",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],vo.prototype,"yoffset",void 0),a([c({cast:t=>t==="auto"?t:Br(Me(t)),json:{write:!0}})],vo.prototype,"size",void 0),vo=a([b("esri.symbols.MarkerSymbol")],vo);var V2;let _r=V2=class extends vo{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,r){if(t&&typeof t!="string"&&t.imageData==null)return t;const i={};return t&&(i.url=t),e!=null&&(i.width=Me(e)),r!=null&&(i.height=Me(r)),i}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new V2({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",E(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};a([c({json:{write:!1}})],_r.prototype,"color",void 0),a([se({esriPMS:"picture-marker"},{readOnly:!0})],_r.prototype,"type",void 0),a([c(lj)],_r.prototype,"url",void 0),a([c(uj)],_r.prototype,"source",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],_r.prototype,"height",void 0),a([V("height",["height","size"])],_r.prototype,"readHeight",null),a([c({type:Number,cast:Me,json:{write:!0}})],_r.prototype,"width",void 0),a([c({json:{write:!1}})],_r.prototype,"size",void 0),_r=V2=a([b("esri.symbols.PictureMarkerSymbol")],_r);var Fl;const cj=H.ofType({base:null,key:"type",typeMap:{icon:rr,object:er,text:Ct}});let Hr=Fl=class extends ui{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new cj,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return rj(this)}hasVisibleVerticalOffset(){return UM(this)}clone(){return new Fl({verticalOffset:E(this.verticalOffset),callout:E(this.callout),styleOrigin:E(this.styleOrigin),symbolLayers:E(this.symbolLayers),thumbnail:E(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new Fl({symbolLayers:new H([rr.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new Fl({symbolLayers:new H([rr.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){if(t.data?.symbol?.type!=="CIMPointSymbol")return null;const r=t.data.symbol;return new Fl(r?.callout?{symbolLayers:new H([rr.fromCIMSymbol(t)]),callout:new go({size:.5,color:new ue([0,0,0])}),verticalOffset:new Ia({screenLength:40})}:{symbolLayers:new H([rr.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new Fl({symbolLayers:new H([Ct.fromTextSymbol(t)])})}};a([c({type:Ia,json:{write:!0}})],Hr.prototype,"verticalOffset",void 0),a([c(ij)],Hr.prototype,"callout",void 0),a([c({type:cj,json:{origins:{"web-scene":{write:!0}}}})],Hr.prototype,"symbolLayers",void 0),a([se({PointSymbol3D:"point-3d"},{readOnly:!0})],Hr.prototype,"type",void 0),Hr=Fl=a([b("esri.symbols.PointSymbol3D")],Hr);var lf;const dj=H.ofType({base:null,key:"type",typeMap:{extrude:mo,fill:qr,icon:rr,line:Ur,object:er,text:Ct,water:yo}});let ds=lf=class extends ui{constructor(t){super(t),this.symbolLayers=new dj,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&Vo(L.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&Vo(L.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(Lu(()=>this.symbolLayers,"after-add",({item:e})=>t(e),jn))}clone(){return new lf({styleOrigin:E(this.styleOrigin),symbolLayers:E(this.symbolLayers),thumbnail:E(this.thumbnail)})}static fromJSON(t){const e=new lf;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const r=e.symbolLayers.at(0),i=e.symbolLayers.at(1);!i.enabled||t.symbolLayers?.[1]&&t.symbolLayers[1].enable===!1||(r.outline={size:i.size,color:i.material!=null?i.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new lf({symbolLayers:new H([qr.fromSimpleFillSymbol(t)])})}};a([c({type:dj,json:{write:!0}})],ds.prototype,"symbolLayers",void 0),a([se({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],ds.prototype,"type",void 0),ds=lf=a([b("esri.symbols.PolygonSymbol3D")],ds);var z2;const m1=new $e({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let pi=z2=class extends yd{constructor(...t){super(...t),this.color=new ue([0,0,0,.25]),this.outline=new wt,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,r){if(t&&typeof t!="string")return t;const i={};return t&&(i.style=t),e&&(i.outline=e),r&&(i.color=r),i}clone(){return new z2({color:E(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};a([c()],pi.prototype,"color",void 0),a([c()],pi.prototype,"outline",void 0),a([se({esriSFS:"simple-fill"},{readOnly:!0})],pi.prototype,"type",void 0),a([c({type:m1.apiValues,json:{read:m1.read,write:m1.write}})],pi.prototype,"style",void 0),pi=z2=a([b("esri.symbols.SimpleFillSymbol")],pi);var U2;const y1=new $e({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let qt=U2=class extends vo{constructor(...t){super(...t),this.color=new ue([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new wt}normalizeCtorArgs(t,e,r,i){if(t&&typeof t!="string")return t;const s={};return t&&(s.style=t),e!=null&&(s.size=Me(e)),r&&(s.outline=r),i&&(s.color=i),s}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new U2({angle:this.angle,color:E(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${this.outline?.hash()}`}};a([c()],qt.prototype,"color",void 0),a([q("color")],qt.prototype,"writeColor",null),a([se({esriSMS:"simple-marker"},{readOnly:!0})],qt.prototype,"type",void 0),a([c()],qt.prototype,"size",void 0),a([c({type:y1.apiValues,json:{read:y1.read,write:y1.write}})],qt.prototype,"style",void 0),a([c({type:String,json:{write:!0}})],qt.prototype,"path",null),a([c({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":wt}},json:{default:null,write:!0}})],qt.prototype,"outline",void 0),qt=U2=a([b("esri.symbols.SimpleMarkerSymbol")],qt);var q2;let Le=q2=class extends _t{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new rs,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,r){if(t&&typeof t!="string")return t;const i={};return t&&(i.text=t),e&&(i.font=e),r&&(i.color=r),i}writeLineWidth(t,e,r,i){i&&typeof i!="string"?i.origin:e[r]=t}castLineWidth(t){return Me(t)}writeLineHeight(t,e,r,i){i&&typeof i!="string"?i.origin:e[r]=t}clone(){return new q2({angle:this.angle,backgroundColor:E(this.backgroundColor),borderLineColor:E(this.borderLineColor),borderLineSize:this.borderLineSize,color:E(this.color),font:this.font&&this.font.clone(),haloColor:E(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor?.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color?.hash()}.${this.font&&this.font.hash()}.${this.haloColor?.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};a([c({type:ue,json:{write:!0}})],Le.prototype,"backgroundColor",void 0),a([c({type:ue,json:{write:!0}})],Le.prototype,"borderLineColor",void 0),a([c({type:Number,json:{write:!0},cast:Me})],Le.prototype,"borderLineSize",void 0),a([c({type:rs,json:{write:!0}})],Le.prototype,"font",void 0),a([c({...X4,json:{write:!0}})],Le.prototype,"horizontalAlignment",void 0),a([c({type:Boolean,json:{write:!0}})],Le.prototype,"kerning",void 0),a([c({type:ue,json:{write:!0}})],Le.prototype,"haloColor",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],Le.prototype,"haloSize",void 0),a([c({type:Boolean,json:{write:!0}})],Le.prototype,"rightToLeft",void 0),a([c({type:Boolean,json:{write:!0}})],Le.prototype,"rotated",void 0),a([c({type:String,json:{write:!0}})],Le.prototype,"text",void 0),a([se({esriTS:"text"},{readOnly:!0})],Le.prototype,"type",void 0),a([c({...ej,json:{write:!0}})],Le.prototype,"verticalAlignment",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],Le.prototype,"xoffset",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],Le.prototype,"yoffset",void 0),a([c({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Le.prototype,"angle",void 0),a([c({type:Number,json:{write:!0}})],Le.prototype,"width",void 0),a([c({type:Number})],Le.prototype,"lineWidth",void 0),a([q("lineWidth")],Le.prototype,"writeLineWidth",null),a([Ce("lineWidth")],Le.prototype,"castLineWidth",null),a([c(Q4)],Le.prototype,"lineHeight",void 0),a([q("lineHeight")],Le.prototype,"writeLineHeight",null),Le=q2=a([b("esri.symbols.TextSymbol")],Le);var G2;let dr=G2=class extends _t{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:j.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e?.portal,super.read(t,e)}clone(){return new G2({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol(t)}async fetchCIMSymbol(t){LR(L.getLogger(this),"WebStyleSymbol.fetchCIMSymbol is deprecated in favour of WebStyleSymbol.fetchSymbol which now supports both web and cim symbology",{version:"4.33",replacement:"WebStyleSymbol.fetchSymbol",see:"https://arcg.is/0CXPTr#fetchSymbol",warnOnce:!0});const e=await this._fetchSymbol({...t,acceptedFormats:["cim"]});if(e?.type!=="cim")throw new x("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return e}async _fetchSymbol(t){const e=t!=null?t.cache:null,r=e?this._fetchCacheKey:null;if(e!=null){const o=r&&e.get(r);if(o)return o.clone()}const{resolveWebStyleSymbol:i}=await N(()=>import("./webStyleSymbolUtils-B_AulekT.js"),__vite__mapDeps([192,193]));We(t);const s=i(this,{portal:this.portal},t);s.catch(o=>{L.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",o)});const n=await s;return e?.set(r,n.clone()),n}};a([c({json:{write:!1}})],dr.prototype,"color",void 0),a([c({type:String,json:{write:!0}})],dr.prototype,"styleName",void 0),a([c({type:j,json:{write:!1}})],dr.prototype,"portal",void 0),a([c({type:String,json:{read:mw,write:Iu}})],dr.prototype,"styleUrl",void 0),a([c({type:em,json:{read:!1}})],dr.prototype,"thumbnail",void 0),a([c({type:String,json:{write:!0}})],dr.prototype,"name",void 0),a([se({styleSymbolReference:"web-style"},{readOnly:!0})],dr.prototype,"type",void 0),a([c()],dr.prototype,"_fetchCacheKey",null),dr=G2=a([b("esri.symbols.WebStyleSymbol")],dr);function q$e(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function hj(t){switch(t?.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const Fa={base:_t,key:"type",typeMap:{"simple-fill":pi,"picture-fill":ai,"picture-marker":_r,"simple-line":wt,"simple-marker":qt,text:Le,"label-3d":Us,"line-3d":Xs,"mesh-3d":Po,"point-3d":Hr,"polygon-3d":ds,"web-style":dr,cim:Ir},errorContext:"symbol"},G$e={base:_t,key:"type",typeMap:{"picture-marker":_r,"simple-marker":qt,"point-3d":Hr,cim:Ir},errorContext:"symbol"},B$e={base:_t,key:"type",typeMap:{"simple-line":wt,"line-3d":Xs,cim:Ir},errorContext:"symbol"},H$e={base:_t,key:"type",typeMap:{"simple-fill":pi,"picture-fill":ai,"polygon-3d":ds,cim:Ir},errorContext:"symbol"},Yie={base:_t,key:"type",typeMap:{"picture-marker":_r,"simple-marker":qt,text:Le,"web-style":dr,cim:Ir},errorContext:"symbol"},Kie=Wh({types:Fa}),pj={base:_t,key:"type",typeMap:{"simple-fill":pi,"picture-fill":ai,"picture-marker":_r,"simple-line":wt,"simple-marker":qt,text:Le,"line-3d":Xs,"mesh-3d":Po,"point-3d":Hr,"polygon-3d":ds,"web-style":dr,cim:Ir},errorContext:"symbol"},Qie={base:_t,key:"type",typeMap:{text:Le,"label-3d":Us},errorContext:"symbol"},nk={base:_t,key:"type",typeMap:{"line-3d":Xs,"mesh-3d":Po,"point-3d":Hr,"polygon-3d":ds,"web-style":dr,cim:Ir},errorContext:"symbol"},Xie={base:_t,key:"type",typeMap:{"label-3d":Us},errorContext:"symbol"},fj=Nn(Fa);var B2;function ese(t){if(!t)return null;const e={};for(const r in t){const i=tl(t[r]);i&&(e[r]=i)}return Object.keys(e).length!==0?e:null}function tse(t){if(t==null)return null;const e={};for(const r in t){const i=t[r];i&&(e[r]=i.toJSON())}return Object.keys(e).length!==0?e:null}var Qd;let st=(Qd=class extends pe(F){constructor(e){super(e),this.isAggregate=!1,this.layer=null,this.origin=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:Cg(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&B7(L.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(e){const r=this._get("aggregateGeometries");JSON.stringify(r)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const r=this._get("attributes");r!==e&&(this._set("attributes",e),this._notifyLayer("attributes",r,e))}set geometry(e){const r=this._get("geometry");r!==e&&(this._set("geometry",e),e?.type!=="mesh"&&this._notifyLayer("geometry",r,e))}set popupTemplate(e){const r=this._get("popupTemplate");r!==e&&(this._set("popupTemplate",e),this._notifyLayer("popupTemplate",r,e))}set symbol(e){const r=this._get("symbol");r!==e&&(this._set("symbol",e),this._notifyLayer("symbol",r,e))}get version(){return this._version}set visible(e){const r=this._get("visible");r!==e&&(this._set("visible",e),this._notifyLayer("visible",r,e))}cloneShallow(){return new B2({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const r=uie(this.origin);if(r)return r.popupTemplate??(e?r.defaultPopupTemplate:null)??null;const i=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const s of[i,this.sourceLayer,this.layer])if(s&&typeof s=="object"){if("popupTemplate"in s&&s.popupTemplate)return s.popupTemplate;if(e&&"defaultPopupTemplate"in s&&s.defaultPopupTemplate!=null)return s.defaultPopupTemplate}return null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,r){if(this.attributes){const i=this.getAttribute(e);this.attributes[e]=r,this._notifyLayer("attributes",i,r,e)}else this.attributes={[e]:r}}getObjectId(){const e=XO(this.origin);if(e)return ek(this,e);const r=this.sourceLayer??this.layer;return r?ek(this,r):null}getGlobalId(){const e=XO(this.origin);if(e?.globalIdField)return this.getAttribute(e.globalIdField);const r=this.sourceLayer??this.layer;return r&&"globalIdField"in r&&r.globalIdField?this.getAttribute(r.globalIdField):null}toJSON(){return{aggregateGeometries:tse(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:pm(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(e={}){const{geometry:r}=this;if(r?.type==="mesh"){const i={origin:r.origin,transform:r.transform};this._notifyLayer("origin-transform",i,i,e.action)}}_notifyLayer(e,r,i,s){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:e,oldValue:r,newValue:i};e==="origin-transform"&&(n.action=s),e==="attributes"&&(n.attributeName=s),this.layer.graphicChanged(n)}_watchMeshGeometryChanges(){this.addHandles([qi(()=>this.geometry?.type==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0,({localMatrix:e,origin:r})=>{this._lastMeshTransform.localMatrix===e&&this._lastMeshTransform.origin===r||(this._lastMeshTransform.localMatrix=e,this._lastMeshTransform.origin=r,this.notifyMeshTransformChanged())}),qi(()=>this.geometry?.type==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0,()=>{const e=this.geometry;e?.type==="mesh"&&e.vertexSpace.origin?(this._lastMeshTransform.localMatrix=e.transform?.localMatrix,this._lastMeshTransform.origin=e.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(e,r)=>e===r,sync:!0})])}},B2=Qd,Qd);a([c({value:null,json:{read:ese}})],st.prototype,"aggregateGeometries",null),a([c({value:null})],st.prototype,"attributes",null),a([c({value:null,types:uy,json:{read:tl}})],st.prototype,"geometry",null),a([c({type:Boolean})],st.prototype,"isAggregate",void 0),a([c({clonable:!1})],st.prototype,"layer",void 0),a([c({clonable:"reference"})],st.prototype,"origin",void 0),a([c({type:Vn,value:null})],st.prototype,"popupTemplate",null),a([c({clonable:"reference"})],st.prototype,"sourceLayer",void 0),a([c({value:null,types:Fa})],st.prototype,"symbol",null),a([c({clonable:!1,json:{read:!1,write:!1}})],st.prototype,"_version",void 0),a([c({type:Boolean,value:!0})],st.prototype,"visible",null),st=B2=a([b("esri.Graphic")],st);let tm=class extends Bf{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};a([OT({Type:st,ensureType:ut(st)})],tm.prototype,"itemType",void 0),tm=a([b("esri.support.GraphicsCollection")],tm);let ro=class extends X{constructor(e){super(e),this.view=null,this.baseLayerViews=new H,this.groundLayerViews=new H,this.referenceLayerViews=new H,this._loadingHandle=ne(()=>this.view?.map?.basemap,r=>{r&&r.load().catch(()=>{})},Et)}destroy(){this._set("view",null),this._loadingHandle=He(this._loadingHandle),this.baseLayerViews.destroyAll(),this.groundLayerViews.destroyAll(),this.referenceLayerViews.destroyAll()}get suspended(){return this.view?.suspended??!0}get updating(){return this.view?.suspended?!1:!!this.view?.map?.basemap?.loaded&&(this.baseLayerViews.some(r=>r.updating)||this.groundLayerViews.some(r=>r.updating)||this.referenceLayerViews.some(r=>r.updating))}};a([c({constructOnly:!0})],ro.prototype,"view",void 0),a([c({readOnly:!0})],ro.prototype,"baseLayerViews",void 0),a([c({readOnly:!0})],ro.prototype,"groundLayerViews",void 0),a([c({readOnly:!0})],ro.prototype,"referenceLayerViews",void 0),a([c({readOnly:!0})],ro.prototype,"suspended",null),a([c({type:Boolean,readOnly:!0})],ro.prototype,"updating",null),ro=a([b("esri.views.BasemapView")],ro);const rse=ro;let Ti=class extends X{constructor(e){super(e),this.factor=1.5,this.offset=Gt(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};a([c({type:Number})],Ti.prototype,"factor",void 0),a([c({nonNullable:!0})],Ti.prototype,"offset",void 0),a([c()],Ti.prototype,"position",void 0),a([c({type:Number,range:{min:0}})],Ti.prototype,"size",void 0),a([c()],Ti.prototype,"maskUrl",void 0),a([c()],Ti.prototype,"maskEnabled",void 0),a([c()],Ti.prototype,"overlayUrl",void 0),a([c()],Ti.prototype,"overlayEnabled",void 0),a([c({readOnly:!0})],Ti.prototype,"version",null),a([c({type:Boolean})],Ti.prototype,"visible",void 0),Ti=a([b("esri.views.Magnifier")],Ti);const mj=Ti;let Nd=class{constructor(e){this._observable=new Qm,this._map=new Map(e)}get size(){return le(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const r=this._map.delete(e);return r&&this._observable.notify(),r}entries(){return le(this._observable),this._map.entries()}forEach(e,r){le(this._observable),this._map.forEach((i,s)=>e.call(r,i,s,this),r)}get(e){return le(this._observable),this._map.get(e)}has(e){return le(this._observable),this._map.has(e)}keys(){return le(this._observable),this._map.keys()}set(e,r){return this._map.set(e,r),this._observable.notify(),this}values(){return le(this._observable),this._map.values()}[Symbol.iterator](){return le(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};var H2;let ou=H2=class extends F{constructor(t){super(t),this.name=null,this.code=null}clone(){return new H2({name:this.name,code:this.code})}};a([c({type:String,json:{write:{isRequired:!0}}})],ou.prototype,"name",void 0),a([c({type:[String,Number],json:{write:{isRequired:!0}}})],ou.prototype,"code",void 0),ou=H2=a([b("esri.layers.support.CodedValue")],ou);const ise=new $e({inherited:"inherited",codedValue:"coded-value",range:"range"});let Na=class extends F{constructor(e){super(e),this.name=null,this.type=null}};a([c({type:String,json:{write:!0}})],Na.prototype,"name",void 0),a([se(ise),c({json:{write:{isRequired:!0}}})],Na.prototype,"type",void 0),Na=a([b("esri.layers.support.Domain")],Na);var W2,Xd;let Da=(Xd=class extends Na{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let r=null;if(this.codedValues){const i=String(e);this.codedValues.some(s=>(String(s.code)===i&&(r=s.name),!!r))}return r}clone(){return new W2({codedValues:E(this.codedValues),name:this.name})}},W2=Xd,Xd);a([c({type:[ou],json:{write:{isRequired:!0}}})],Da.prototype,"codedValues",void 0),a([se({codedValue:"coded-value"})],Da.prototype,"type",void 0),Da=W2=a([b("esri.layers.support.CodedValueDomain")],Da);var Z2,eh;let rm=(eh=class extends Na{constructor(e){super(e),this.type="inherited"}clone(){return new Z2}},Z2=eh,eh);a([se({inherited:"inherited"})],rm.prototype,"type",void 0),rm=Z2=a([b("esri.layers.support.InheritedDomain")],rm);var J2,th;let Yl=(th=class extends Na{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new J2({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}},J2=th,th);a([c({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,r){e[r]=[this.minValue||0,t]},isRequired:!0}}})],Yl.prototype,"maxValue",void 0),a([c({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[0]},write:{target:"range",writer(t,e,r){e[r]=[t,this.maxValue||0]},isRequired:!0}}})],Yl.prototype,"minValue",void 0),a([se({range:"range"})],Yl.prototype,"type",void 0),Yl=J2=a([b("esri.layers.support.RangeDomain")],Yl);const yj={key:"type",base:Na,typeMap:{range:Yl,"coded-value":Da,inherited:rm}};function eb(t){if(!t?.type)return null;switch(t.type){case"range":return Yl.fromJSON(t);case"codedValue":return Da.fromJSON(t);case"inherited":return rm.fromJSON(t)}return null}const sse=new $e({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var Y2;const nse=new $e({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",currency:"currency",dateAndTime:"date-and-time",description:"description",emailAddress:"email-address",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",phoneNumber:"phone-number",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});var rh;let tr=(rh=class extends F{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:r}){let i=null;try{i=r?JSON.parse(r):null}catch{}return i?.value??null}readValueType(e,{description:r}){let i=null;try{i=r?JSON.parse(r):null}catch{}return i?nse.fromJSON(i.fieldValueType):null}clone(){return new Y2({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}},Y2=rh,rh);a([c({type:String,json:{write:!0}})],tr.prototype,"alias",void 0),a([c({type:[String,Number],json:{write:{allowNull:!0}}})],tr.prototype,"defaultValue",void 0),a([c()],tr.prototype,"description",void 0),a([V("description")],tr.prototype,"readDescription",null),a([c({types:yj,json:{read:{reader:eb},write:!0}})],tr.prototype,"domain",void 0),a([c({type:Boolean,json:{write:!0}})],tr.prototype,"editable",void 0),a([c({type:xe,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],tr.prototype,"length",void 0),a([c({type:String,json:{write:!0}})],tr.prototype,"name",void 0),a([c({type:Boolean,json:{write:!0}})],tr.prototype,"nullable",void 0),a([se(sse)],tr.prototype,"type",void 0),a([c()],tr.prototype,"valueType",void 0),a([V("valueType",["description"])],tr.prototype,"readValueType",null),a([c({type:Boolean,json:{read:!1}})],tr.prototype,"visible",void 0),tr=Y2=a([b("esri.layers.support.Field")],tr);var K2;let Oc=K2=class extends F{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new K2({mapLayerId:t,gdbVersion:e})}};a([se({mapLayer:"map-layer"}),c({json:{write:{isRequired:!0}}})],Oc.prototype,"type",void 0),a([c({type:xe,json:{write:{isRequired:!0}}})],Oc.prototype,"mapLayerId",void 0),a([c({type:String,json:{write:!0}})],Oc.prototype,"gdbVersion",void 0),Oc=K2=a([b("esri.layers.support.source.MapLayerSource")],Oc);var Q2;let io=Q2=class extends F{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:r,spatialReference:i,geometryType:s}=this,n={workspaceId:t,query:e,oidFields:r,spatialReference:i?.clone()??void 0,geometryType:s};return new Q2(n)}};a([se({queryTable:"query-table"}),c({json:{write:{isRequired:!0}}})],io.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],io.prototype,"workspaceId",void 0),a([c({type:String,json:{write:!0}})],io.prototype,"query",void 0),a([c({type:String,json:{write:!0}})],io.prototype,"oidFields",void 0),a([c({type:Z,json:{write:!0}})],io.prototype,"spatialReference",void 0),a([se(LX)],io.prototype,"geometryType",void 0),io=Q2=a([b("esri.layers.support.source.QueryTableDataSource")],io);var X2;let kc=X2=class extends F{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new X2({workspaceId:t,dataSourceName:e})}};a([se({raster:"raster"}),c({json:{write:{isRequired:!0}}})],kc.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],kc.prototype,"dataSourceName",void 0),a([c({type:String,json:{write:!0}})],kc.prototype,"workspaceId",void 0),kc=X2=a([b("esri.layers.support.source.RasterDataSource")],kc);var e$;let Nl=e$=class extends F{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:r}=this;return new e$({workspaceId:t,gdbVersion:e,dataSourceName:r})}};a([se({table:"table"}),c({json:{write:{isRequired:!0}}})],Nl.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],Nl.prototype,"workspaceId",void 0),a([c({type:String,json:{write:!0}})],Nl.prototype,"gdbVersion",void 0),a([c({type:String,json:{write:!0}})],Nl.prototype,"dataSourceName",void 0),Nl=e$=a([b("esri.layers.support.source.TableDataSource")],Nl);var t$,r$;const ose=Lt()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let Mi=t$=class extends F{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,r){return ok()(t,e,r)}castLeftTableSource(t){return Nn(i$(),t)}readRightTableSource(t,e,r){return ok()(t,e,r)}castRightTableSource(t){return Nn(i$(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:r,rightTableSource:i,joinType:s}=this,n={leftTableKey:t,rightTableKey:e,leftTableSource:r?.clone()??void 0,rightTableSource:i?.clone()??void 0,joinType:s};return new t$(n)}};a([se({joinTable:"join-table"}),c({json:{write:{isRequired:!0}}})],Mi.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],Mi.prototype,"leftTableKey",void 0),a([c({type:String,json:{write:!0}})],Mi.prototype,"rightTableKey",void 0),a([c({json:{write:!0}})],Mi.prototype,"leftTableSource",void 0),a([V("leftTableSource")],Mi.prototype,"readLeftTableSource",null),a([Ce("leftTableSource")],Mi.prototype,"castLeftTableSource",null),a([c({json:{write:!0}})],Mi.prototype,"rightTableSource",void 0),a([V("rightTableSource")],Mi.prototype,"readRightTableSource",null),a([Ce("rightTableSource")],Mi.prototype,"castRightTableSource",null),a([se(ose)],Mi.prototype,"joinType",void 0),Mi=t$=a([b("esri.layers.support.source.JoinTableDataSource")],Mi);let g1=null;function ok(){return g1||(g1=Wh({types:i$()})),g1}let v1=null;function i$(){return v1||(v1={key:"type",base:null,typeMap:{"data-layer":qs,"map-layer":Oc}}),v1}const ase={key:"type",base:null,typeMap:{"join-table":Mi,"query-table":io,raster:kc,table:Nl}};var ih;let qs=(ih=class extends F{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:r}=this;return new r$({fields:e,dataSource:r})}},r$=ih,ih);a([se({dataLayer:"data-layer"}),c({json:{write:{isRequired:!0}}})],qs.prototype,"type",void 0),a([c({type:[tr],json:{write:!0}})],qs.prototype,"fields",void 0),a([c({types:ase,json:{write:!0}})],qs.prototype,"dataSource",void 0),qs=r$=a([b("esri.layers.support.source.DataLayerSource")],qs),qs.from=ut(qs);let Dl=class extends pe(F){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};a([c({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],Dl.prototype,"onFields",void 0),a([c({type:String,json:{write:!0}})],Dl.prototype,"operator",void 0),a([c({type:String,json:{write:!0}})],Dl.prototype,"searchTerm",void 0),a([c({type:String,json:{write:!0}})],Dl.prototype,"searchType",void 0),Dl=a([b("esri.rest.support.FullTextSearch")],Dl);const gj=Dl;var s$;const ak=new $e({upperLeft:"upper-left",lowerLeft:"lower-left"});let _a=s$=class extends F{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new s$(E({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};a([c({type:he,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],_a.prototype,"extent",void 0),a([c({type:["view","edit"],json:{write:!0}})],_a.prototype,"mode",void 0),a([c({type:String,json:{read:ak.read,write:ak.write}})],_a.prototype,"originPosition",void 0),a([c({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],_a.prototype,"tolerance",void 0),_a=s$=a([b("esri.rest.support.QuantizationParameters")],_a);const lse=t=>{const e=t;let r=class extends e{};return r=a([b("esri.rest.support.QueryMixin")],r),r},use=new $e({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var n$;const lk=new $e({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let Rs=n$=class extends F{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=E(t))}clone(){return new n$({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:E(this.statisticParameters)})}};a([c({type:Number,json:{write:!0}})],Rs.prototype,"maxPointCount",void 0),a([c({type:Number,json:{write:!0}})],Rs.prototype,"maxRecordCount",void 0),a([c({type:Number,json:{write:!0}})],Rs.prototype,"maxVertexCount",void 0),a([c({type:String,json:{write:!0}})],Rs.prototype,"onStatisticField",void 0),a([c({type:String,json:{write:!0}})],Rs.prototype,"outStatisticFieldName",void 0),a([c({type:String,json:{read:{source:"statisticType",reader:lk.read},write:{target:"statisticType",writer:lk.write}}})],Rs.prototype,"statisticType",void 0),a([c({type:Object})],Rs.prototype,"statisticParameters",void 0),a([q("statisticParameters")],Rs.prototype,"writeStatisticParameters",null),Rs=n$=a([b("esri.rest.support.StatisticDefinition")],Rs);var b0;const cse=new $e({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});var _u;let re=(_u=class extends lse(F){static from(e){return Hh(b0,e)}constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.returnTrueCurves=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(e){return typeof e=="number"||typeof e=="object"?e:null}writeHistoricMoment(e,r){r.historicMoment=e&&e.getTime()}writeParameterValues(e,r){if(e){const i={};for(const s in e){const n=e[s];Array.isArray(n)?i[s]=n.map(o=>o instanceof Date?o.getTime():o):n instanceof Date?i[s]=n.getTime():i[s]=n}r.parameterValues=i}}writeStart(e,r){r.resultOffset=this.start,r.resultRecordCount=this.num||10,r.where="1=1"}writeWhere(e,r){r.where=e||"1=1"}clone(){return new b0(E({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,returnTrueCurves:this.returnTrueCurves,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}},b0=_u,_u.MAX_MAX_RECORD_COUNT_FACTOR=5,_u);a([c({json:{write:!0}})],re.prototype,"aggregateIds",void 0),a([c({type:Boolean,json:{write:!0}})],re.prototype,"cacheHint",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"compactGeometryEnabled",void 0),a([c({json:{write:!0}})],re.prototype,"datumTransformation",void 0),a([Ce("datumTransformation")],re.prototype,"castDatumTransformation",null),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"defaultSpatialReferenceEnabled",void 0),a([c({type:Number,json:{write:!0}})],re.prototype,"distance",void 0),a([c({type:qs,json:{write:!0}})],re.prototype,"dynamicDataSource",void 0),a([c({type:String,json:{write:!0}})],re.prototype,"formatOf3DObjects",void 0),a([c({type:[gj],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],re.prototype,"fullText",void 0),a([c({type:String,json:{write:!0}})],re.prototype,"gdbVersion",void 0),a([c({types:uy,json:{read:tl,write:!0}})],re.prototype,"geometry",void 0),a([c({type:Number,json:{write:!0}})],re.prototype,"geometryPrecision",void 0),a([c({type:[String],json:{write:!0}})],re.prototype,"groupByFieldsForStatistics",void 0),a([c({type:String,json:{write:!0}})],re.prototype,"having",void 0),a([c({type:Date})],re.prototype,"historicMoment",void 0),a([q("historicMoment")],re.prototype,"writeHistoricMoment",null),a([c({type:Number,json:{write:!0}})],re.prototype,"maxAllowableOffset",void 0),a([c({type:Number,cast:t=>t<1?1:t>re.MAX_MAX_RECORD_COUNT_FACTOR?re.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],re.prototype,"maxRecordCountFactor",void 0),a([c({type:["xyFootprint"],json:{write:!0}})],re.prototype,"multipatchOption",void 0),a([c({type:Number,json:{read:{source:"resultRecordCount"}}})],re.prototype,"num",void 0),a([c({json:{write:!0}})],re.prototype,"objectIds",void 0),a([c({type:[String],json:{write:!0}})],re.prototype,"orderByFields",void 0),a([c({type:[String],json:{write:!0}})],re.prototype,"outFields",void 0),a([c({type:Z,json:{name:"outSR",write:!0}})],re.prototype,"outSpatialReference",void 0),a([c({type:[Rs],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],re.prototype,"outStatistics",void 0),a([c({json:{write:!0}})],re.prototype,"parameterValues",void 0),a([q("parameterValues")],re.prototype,"writeParameterValues",null),a([c({type:ee,json:{write:!0}})],re.prototype,"pixelSize",void 0),a([c({type:_a,json:{write:!0}})],re.prototype,"quantizationParameters",void 0),a([c({type:[Object],json:{write:!0}})],re.prototype,"rangeValues",void 0),a([c({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],re.prototype,"relationParameter",void 0),a([c({type:String,json:{write:!0}})],re.prototype,"resultType",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"returnCentroid",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"returnDistinctValues",void 0),a([c({type:Boolean,json:{default:!0,write:!0}})],re.prototype,"returnExceededLimitFeatures",void 0),a([c({type:Boolean,json:{write:!0}})],re.prototype,"returnGeometry",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"returnQueryGeometry",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"returnM",void 0),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],re.prototype,"returnZ",void 0),a([c({type:Boolean,json:{write:!0}})],re.prototype,"returnTrueCurves",void 0),a([c({type:Z,json:{write:!0}})],re.prototype,"sourceSpatialReference",void 0),a([se(use,{ignoreUnknown:!1,name:"spatialRel"})],re.prototype,"spatialRelationship",void 0),a([c({type:Number,json:{read:{source:"resultOffset"}}})],re.prototype,"start",void 0),a([q("start"),q("num")],re.prototype,"writeStart",null),a([c({type:String,json:{write:!0}})],re.prototype,"sqlFormat",void 0),a([c({type:String,json:{write:!0}})],re.prototype,"text",void 0),a([c({type:It,json:{write:!0}})],re.prototype,"timeExtent",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],re.prototype,"timeReferenceUnknownClient",void 0),a([se(cse,{ignoreUnknown:!1}),c({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null}}}}})],re.prototype,"units",void 0),a([c({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],re.prototype,"where",void 0),a([q("where")],re.prototype,"writeWhere",null),re=b0=a([b("esri.rest.support.Query")],re);function ia(t){return!(t==null||typeof t!="object"||!("createQuery"in t)||!t.createQuery)}let es=class extends Zh{constructor(e){super(e),this._selectionMap=new Nd,this._sources=new H,this._trashCan=[],this._layerEditHandles=new H,this._vizTaskId=0,this.view=null,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([ne(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),ne(()=>this.view,e=>{e?.when().then(()=>this.syncSources())},Et),Lu(()=>this.sources,"change",e=>{const r=this._selectionMap,i=[];for(const s of e.removed){const n=r.get(s);n&&(r.delete(s),n.highlightHandle?.remove(),i.push({layer:s,selection:[],added:[],removed:[...n.selection]}))}this._refreshListeners(),i.length&&this._onSelectionChange(i)},{onListenerAdd:()=>this._refreshListeners()})])}destroy(){this.clear(),this._layerEditHandles.drain(He)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[r,i]=e;return{layer:r,selection:[...i.selection]}})}get count(){let e=0;for(const r of this._selectionMap.values())e+=r.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){Pn(e,this._sources)}syncSources(){const e=new Set,r=this.view?.map;if(!r)return;const i=s=>{HZ(s)?(s.layers?.forEach(i),s.tables?.forEach(i)):BZ(s)?(s.sublayers?.forEach(i),s.subtables?.forEach(i)):zE(s)?s.sublayers?.forEach(i):ia(s)&&e.add(s)};r.allLayers.forEach(i),r.allTables.forEach(i),this.sources=[...e]}async getSelectedFeatures(e,r={},i="layerView"){const{view:s,selections:n}=this;if(!s&&i==="layerView")return L.getLogger(this).warn("Cannot query layer views without a view."),[];const o=(e?.length?n.filter(l=>e.includes(l.layer)):n).map(async l=>{const{layer:u,selection:d}=l;if(!d.length)return;const p=bc(u)?u.parent:u;if(p!=null){if(s&&i==="layerView"&&!uk(p)&&ck(p)){const f=await s.whenLayerView(p).catch(()=>null);if(f)return dk(f,d,r)}return dk(p,d,r)}}).filter(hs);return(await Promise.all(o)).filter(hs)}updateSelection(e){const r=new Map;for(const[n,o]of this._selectionMap)r.set(n,[...o.selection]);let i=!1;const s=e.current.concat(e.added);for(const n of s){const o=n.sourceLayer,l=n.getObjectId();if(this.sources.includes(o)&&(ia(o)||bc(o))&&l!==null){const u=jh(r,o,()=>[]);u.includes(l)||(u.push(l),i=!0)}}for(const n of e.removed){const o=n.sourceLayer,l=n.getObjectId();if(this.sources.includes(o)&&(ia(o)||bc(o))&&l!==null){const u=r.get(o),d=u?.indexOf(l);d!==void 0&&d>=0&&(u?.splice(d,1),i=!0)}}if(i){const{_selectionMap:n,_trashCan:o}=this,l=[];for(const[u,d]of r){const p=n.get(u);p!==void 0&&o.push(p),n.set(u,{selection:d}),l.push({layer:u,selection:d,...K3(p!==void 0?p.selection:[],d)})}this._onSelectionChange(l)}}setSelection(e,r){this._setSelection(e,r)}getSelection(e){return this._selectionMap.get(e)?.selection}appendToSelection(e,r){const i=this._selectionMap.get(e),s=i!==void 0?[...i.selection]:[];for(const n of r)s.includes(n)||s.push(n);this._setSelection(e,s)}removeFromSelection(e,r){const i=this._selectionMap.get(e);if(!i)return;const s=[];for(const n of i.selection)r.includes(n)||s.push(n);this._setSelection(e,s)}toggleInSelection(e,r){const i=this._selectionMap.get(e);if(!i||i.selection.length===0)return void this._setSelection(e,r);const s=new Set(i.selection),n=new Set(r),o=Eq(s,n);this._setSelection(e,Array.from(o))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const r=[];for(const[i,s]of this._selectionMap.entries())r.push({layer:i,added:[],removed:[...s.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(r)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){for(this._vizTaskId++;this._trashCan.length>0;)this._trashCan.pop()?.highlightHandle?.remove();if(this.view==null)return;const{sources:e,view:r,_selectionMap:i,showHighlight:s}=this,n=this._vizTaskId;for(const o of e){const l=i.get(o),u=bc(o)?o.parent:o;if(u!=null&&ck(u)){if(uk(u))continue;r.whenLayerView(u).then(d=>{l?.highlightHandle?.remove(),l!=null&&s&&n===this._vizTaskId&&"highlight"in d&&typeof d.highlight=="function"&&l.selection.length>0&&(l.highlightHandle=d.highlight(l.selection,this.highlightName))}).catch(()=>{l?.highlightHandle?.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(He);const e=new Set(this.sources.map(r=>bc(r)?r.parent:r));for(const r of e)ia(r)&&"on"in r&&r.on&&this._layerEditHandles.push(r.on("edits",i=>this._onLayerEdit(i,r)))}_onLayerEdit(e,r){if(zE(r))this._onParentLayerEdit(e,r);else if(e.deletedFeatures.length&&this._selectionMap.has(r)){const i=[];e.deletedFeatures.forEach(({error:s,objectId:n})=>{n!=null&&s==null&&i.push(n)}),this.removeFromSelection(r,i)}}_onParentLayerEdit(e,r){const{deletedFeatures:i,edits:s,updatedFeatures:n}=e;if(s?.updateFeatures?.forEach(o=>{const l=o.getObjectId()??o.attributes[r.objectIdField];if(l==null||n.find(p=>p.objectId===l)?.error)return;const u=r.findSublayerForFeature(o);if(!ia(u))return;const d=r.sublayers.find(p=>!(!ia(p)||!this.getSelection(p)?.includes(l)));ia(d)&&d!==u&&(this.removeFromSelection(d,[l]),this.appendToSelection(u,[l]))}),i.length){const o=[];i.forEach(({error:l,objectId:u})=>{u!=null&&l==null&&o.push(u)}),r.sublayers.forEach(l=>{ia(l)&&this._selectionMap.has(l)&&this.removeFromSelection(l,o)})}}_setSelection(e,r){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const i=this._selectionMap.get(e);if(i===void 0||!hse(i,{selection:r})){i!==void 0&&this._trashCan.push(i),this._selectionMap.set(e,{selection:[...r]});const s={layer:e,selection:[...r],...K3(i!==void 0?i.selection:[],r)};this._onSelectionChange([s])}}};a([c()],es.prototype,"_selectionMap",void 0),a([c()],es.prototype,"_sources",void 0),a([c({readOnly:!0,nonNullable:!0})],es.prototype,"selections",null),a([c({readOnly:!0,nonNullable:!0})],es.prototype,"count",null),a([c()],es.prototype,"view",void 0),a([c({readOnly:!0,nonNullable:!0})],es.prototype,"hasSelection",null),a([c()],es.prototype,"showHighlight",void 0),a([c()],es.prototype,"sources",null),a([c()],es.prototype,"highlightName",void 0),es=a([b("esri.views.SelectionManager")],es);const uk=t=>bc(t)?t.parent?.isTable===!0:t.isTable,dse=t=>t.layer!==void 0,ck=t=>t?.when!==void 0,hse=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const r=[...t.selection],i=[...e.selection];if(r.length!==i.length)return!1;r.sort(),i.sort();for(let s=0;s<r.length;s++)if(r[s]!==i[s])return!1}return!0},dk=async(t,e,r={})=>{let i;if(dse(t)){const s=t;i=s===void 0?null:await s.queryFeatures(new re({...r,objectIds:e})).then(n=>({data:n,layer:t.layer}))}else{const s=t;i=s===void 0?null:await s.queryFeatures(new re({...r,objectIds:e})).then(n=>({data:n,layer:s}))}return i},pse=es;let uf=class extends pe(X){constructor(e){super(e),this.accentColor=new ue([255,127,0]),this.textColor=new ue([255,255,255])}};a([c({type:ue,nonNullable:!0})],uf.prototype,"accentColor",void 0),a([c({type:ue,nonNullable:!0})],uf.prototype,"textColor",void 0),uf=a([b("esri.views.Theme")],uf);const o$=uf,vj=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],wj={};function bj(t){return!!wj[t]}function fse(t){for(const e of t)if(!bj(e))return!1;return!0}vj.forEach(t=>{wj[t]=!0});let _j=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:r,priority:i},s)=>this.inputManager?.installHandlers(s,[r],i))}disconnect(){this.inputManager&&this._handlers.forEach((e,r)=>this.inputManager?.uninstallHandlers(r)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,r,i,s){const n=Array.isArray(e)?e:e.split(",");if(!fse(n))return n.some(bj)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,l;Array.isArray(r)?l=r:(o=r,l=[]),typeof i=="function"?o=i:s=i,s=s??No.DEFAULT;const u=this._createUniqueGroupName(),d=new mse(this.view,n,l,o);this._handlers.set(u,{handler:d,priority:s});for(const p of n){const f=this._handlerCounts.get(p)||0;this._handlerCounts.set(p,f+1)}return this.inputManager&&this.inputManager.installHandlers(u,[d],s),Te(()=>this._removeHandler(u,n))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,r){if(this._handlers.has(e)){this._handlers.delete(e);for(const i of r){const s=this._handlerCounts.get(i);s===void 0||(s===1?this._handlerCounts.delete(i):this._handlerCounts.set(i,s-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},mse=class extends Wt{constructor(e,r,i,s){super(!0),this._latestDragStart=void 0,this.view=e;for(const n of r)switch(n){case"click":this.registerIncoming("click",i,o=>s(vse(e,o)));break;case"double-click":this.registerIncoming("double-click",i,o=>s(wse(e,o)));break;case"immediate-click":this.registerIncoming("immediate-click",i,o=>s(bse(e,o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,o=>s(_se(e,o)));break;case"hold":this.registerIncoming("hold",i,o=>s(Sse(e,o)));break;case"drag":this.registerIncoming("drag",i,o=>{const l=this._wrapDrag(o);l&&s(l)});break;case"key-down":this.registerIncoming("key-down",i,o=>s($se(o)));break;case"key-up":this.registerIncoming("key-up",i,o=>s(xse(o)));break;case"pointer-down":this.registerIncoming("pointer-down",i,o=>s(Ip(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",i,o=>s(Ip(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",i,o=>s(Ip(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,o=>s(Tse(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,o=>s(Mse(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,o=>s(Ip(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,o=>s(Ip(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",i,o=>{s(Ise(o))});break;case"focus":this.registerIncoming("focus",i,o=>{s(yse(o))});break;case"blur":this.registerIncoming("blur",i,o=>{s(gse(o))})}}_wrapDrag(e){const r=e.data,{x:i,y:s}=r.center,{action:n,pointerType:o,button:l}=r;if(n==="start"&&(this._latestDragStart=r),!this._latestDragStart)return;const u=r.pointer.native,d=r.buttons,{cancelable:p,timestamp:f}=e,m={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return n==="end"&&(this._latestDragStart=void 0),{type:"drag",action:n,x:i,y:s,origin:m,pointerType:o,button:l,buttons:d,radius:r.radius,angle:D5(r.angle),native:u,timestamp:f,cancelable:p,stopPropagation:()=>e.stopPropagation(),defer:y=>e.defer(y),preventDefault:()=>e.preventDefault()}}};function yse(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function gse(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function vse(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:l,eventId:u}=e.data,{cancelable:d,timestamp:p}=e;return{type:"click",pointerType:r,button:i,buttons:s,x:n,y:o,native:l,timestamp:p,screenPoint:Gt(n,o),mapPoint:yy(t,n,o),eventId:u,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:f=>e.defer(f),preventDefault:()=>e.preventDefault()}}function wse(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:l,eventId:u}=e.data,{cancelable:d,timestamp:p}=e;return{type:"double-click",pointerType:r,button:i,buttons:s,x:n,y:o,native:l,timestamp:p,mapPoint:yy(t,n,o),eventId:u,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:f=>e.defer(f),preventDefault:()=>e.preventDefault()}}function bse(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:l,eventId:u}=e.data,d=l.pointerId,{cancelable:p,timestamp:f}=e;return{type:"immediate-click",pointerId:d,pointerType:r,button:i,buttons:s,x:n,y:o,native:l,timestamp:f,mapPoint:yy(t,n,o),eventId:u,cancelable:p,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function _se(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:l,eventId:u}=e.data,d=l.pointerId,{cancelable:p,timestamp:f}=e;return{type:"immediate-double-click",pointerId:d,pointerType:r,button:i,buttons:s,x:n,y:o,native:l,timestamp:f,mapPoint:yy(t,n,o),eventId:u,cancelable:p,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function Sse(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:l}=e.data,{cancelable:u,timestamp:d}=e;return{type:"hold",pointerType:r,button:i,buttons:s,x:n,y:o,native:l,timestamp:d,mapPoint:yy(t,n,o),cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:p=>e.defer(p),preventDefault:()=>e.preventDefault()}}function yy(t,e,r){return t.toMap(Gt(e,r),{exclude:[]})}function $se(t){const{key:e,repeat:r,native:i}=t.data,{cancelable:s,timestamp:n}=t;return{type:"key-down",key:e,repeat:r,native:i,timestamp:n,cancelable:s,stopPropagation:()=>t.stopPropagation(),defer:o=>t.defer(o),preventDefault:()=>t.preventDefault()}}function xse(t){const{key:e,native:r}=t.data,{cancelable:i,timestamp:s}=t;return{type:"key-up",key:e,native:r,timestamp:s,cancelable:i,stopPropagation:()=>t.stopPropagation(),defer:n=>t.defer(n),preventDefault:()=>t.preventDefault()}}function Ip(t,e){const{x:r,y:i,button:s,buttons:n,native:o,eventId:l}=t.data,u=o.pointerId,d=o.pointerType,{cancelable:p,timestamp:f}=t;return{type:e,x:r,y:i,pointerId:u,pointerType:d,button:s,buttons:n,native:o,timestamp:f,eventId:l,cancelable:p,stopPropagation:()=>t.stopPropagation(),defer:m=>t.defer(m),preventDefault:()=>t.preventDefault()}}function Tse(t){const{x:e,y:r,buttons:i,native:s,eventId:n}=t.data.currentEvent,{button:o}=t.data.startEvent,l=t.data.startEvent.native.pointerId,u=t.data.startEvent.native.pointerType,d=t.data.action,p={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:f,timestamp:m}=t;return{type:"pointer-drag",x:e,y:r,pointerId:l,pointerType:u,button:o,buttons:i,action:d,origin:p,native:s,timestamp:m,eventId:n,cancelable:f,stopPropagation:()=>t.stopPropagation(),defer:y=>t.defer(y),preventDefault:()=>t.preventDefault()}}function Mse(t){const{cancelable:e,data:r,timestamp:i}=t,{x:s,y:n,deltaY:o,native:l}=r;return{type:"mouse-wheel",x:s,y:n,deltaY:o,native:l,timestamp:i,cancelable:e,stopPropagation:()=>t.stopPropagation(),defer:u=>t.defer(u),preventDefault:()=>t.preventDefault()}}function Ise(t){const{action:e,state:r,device:i}=t.data,{cancelable:s,timestamp:n}=t,{buttons:o,axes:l}=r;return{type:"gamepad",device:i,timestamp:n,action:e,buttons:o,axes:l,cancelable:s,stopPropagation:()=>t.stopPropagation(),defer:u=>t.defer(u),preventDefault:()=>t.preventDefault()}}const Ese="z",Ose="r",Sj={cancel:"Escape",complete:"Enter"},ixe={...Sj,redo:Ose,undo:Ese,center:"Alt",constraint:"Shift",delete:["Backspace","Delete"],vertexAdd:"f",pan:" "},sxe={toggle:"Control"},nxe={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},oxe={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:t4,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0}};let axe=class{constructor(){this._bindings=new Map}add(e,r){return this.addToggle(e,i=>{i.type==="key-down"&&r(i)})}addToggle(e,r){const i=kse.fromDefinition(e,r),s=jh(this._bindings,i.key,()=>[]);return s.push(i),Te(()=>Qx(s,i))}register(e,r=No.WIDGET){return Uu([e.on("key-down",i=>this.dispatch(e.inputManager,i),r),e.on("key-up",i=>this.dispatch(e.inputManager,i),r)])}dispatch(e,r){const i=r.key,s=this._bindings.get(i);if(s)for(const n of s)n.process(e,r)}},kse=class a${constructor(e,r,i,s,n){this.key=e,this.modifiers=r,this.repeats=i,this.continuePropagation=s,this.callback=n}process(e,r){if(!(r.key!==this.key||"repeat"in r&&r.repeat&&!this.repeats)){for(const i of this.modifiers)if(!e.isModifierKeyDown(i))return;this.continuePropagation||r.stopPropagation(),this.callback(r)}}static fromDefinition(e,r){if(typeof e=="string")return new a$(e,[],!1,!1,r);const{key:i,modifier:s,repeats:n,continuePropagation:o}=e;return new a$(i,s?Array.isArray(s)?s:[s]:[],!!n,!!o,r)}};function Cse(t){return[t.on("before-add",e=>{const r=e.item;if(r==null||t.includes(r))return L.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();r.onAdd()}),t.on("after-remove",e=>{const r=e.item;r.active&&(r.view.activeTool=null),r.destroy()})]}function l$(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(0)&&t.getEditableFlag(1)}function Pse(t){return t.type==="key-down"&&t.key===Sj.cancel}function pn(t){return Gt(t.x,t.y)}function $j(t,e){const r=(t instanceof HTMLElement?t:t.surface)?.getBoundingClientRect();return r?Gt(e.clientX-r.left,e.clientY-r.top):Gt(0,0)}function xj(t,e){return e instanceof Event?$j(t,e):pn(e)}function Tj(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let _0=class extends X{constructor(){super(...arguments),this._pointerLocations=new Map,this._hoveredManipulators=new Nd,this._grabbedManipulators=new Nd,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1}get cursor(){return this._cursorFromMap(this._grabbedManipulators,"grabbing")??this._cursorFromMap(this._hoveredManipulators,"pointer")}get hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,r){const i=()=>e.stopPropagation();switch(e.type){case"pointer-move":hk(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(i(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!pk(e))break;const s=pn(e),n=nc(s,e.pointerType,r.tools);if(n==null)break;const o=n.manipulator,l=n.tool;o==null||l==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,e,r),o!=null&&l!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:l,start:s,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&r.activeTool==null&&(this._revertToNullActiveTool=!0,r.setActiveTool(n.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:s}),i());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,r);break;case"pointer-drag":{if(!pk(e))break;const s=this._grabbedManipulators.get(e.pointerId),n=s?.manipulator,o=s?.tool;if(n==null||o==null)break;const l=pn(e);l.x=Gi(l.x,0,r.view.width),l.y=Gi(l.y,0,r.view.height);const u=s.start,d=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(n.dragging=!0,d?n.events.emit("drag",{action:"update",start:u,screenPoint:l}):n.events.emit("drag",{action:"start",start:u,screenPoint:l,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:n,start:u}));break;case"end":n.dragging=!1,d&&n.events.emit("drag",{action:"end",start:u,screenPoint:l}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,r)}i();break}case"immediate-click":{const s=pn(e),n=nc(s,e.pointerType,r.tools);if(!Ase(e)){for(const d of r.tools)if((n==null||n.tool!==d||d.automaticManipulatorSelection)&&d.manipulators){let p=!1;d.manipulators.forEach(({manipulator:f})=>{f.selected&&(f.selected=!1,p=!0)}),p&&d.onManipulatorSelectionChanged&&d.onManipulatorSelectionChanged()}}if(n==null)break;const{manipulator:o,tool:l}=n;if(!o.interactive)break;o.selectable&&l.automaticManipulatorSelection&&(o.selected=!o.selected,l.onManipulatorSelectionChanged&&l.onManipulatorSelectionChanged());const u=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:u,stopPropagation:i}),w1(o,i);break}case"click":{const s=pn(e),n=nc(s,e.pointerType,r.tools),o=n?.manipulator;if(o==null||!o.interactive)break;const l=e.native.shiftKey;o.events.emit(e.type,{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l}),i();break}case"double-click":{const s=pn(e),n=nc(s,e.pointerType,r.tools),o=n!=null?n.manipulator:null;if(o==null||!o.interactive)break;const l=e.native.shiftKey;o.events.emit("double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:i}),w1(o,i);break}case"immediate-double-click":{const s=pn(e),n=nc(s,e.pointerType,r.tools),o=n!=null?n.manipulator:null;if(o==null||!o.interactive)break;const l=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:i}),e.pointerType==="mouse"&&w1(o,i);break}}this._onFocusChange(r.tools)}_releaseManipulatorBeforeDragging(e,r,i){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:r.pointerType,screenPoint:pn(r)}),this._grabbedManipulators.forEach(({manipulator:s},n)=>{s===e&&this._grabbedManipulators.delete(n)}),this._afterManipulatorRelease(i.setActiveTool)}_handlePointerEnd(e,r){const i=this._grabbedManipulators.get(e.pointerId)?.manipulator;i!=null&&i.grabbing&&(i.grabbing=!1,i.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:pn(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(r.setActiveTool))}_onFocusChange(e){this._updateFocusedManipulatorTools(e)}_updateFocusedManipulatorTools(e){const r=new Set,i=new Set;this._grabbedManipulators.forEach(({tool:s})=>r.add(s)),this._hoveredManipulators.forEach(({tool:s})=>i.add(s));for(const s of e){s.hasGrabbedManipulators=r.has(s),s.hasHoveredManipulators=i.has(s);const n=this._grabbedManipulators.values(),o=H7(n,({tool:l})=>l===s);s.firstGrabbedManipulator=o!=null?o.manipulator:null}}clearPointers(e,{tools:r,setActiveTool:i},s=!0,n){const o=(l,u)=>l===e&&(n==null||n===u);this._grabbedManipulators.forEach(({tool:l,manipulator:u,pointerType:d},p)=>{o(l,u)&&(this._grabbedManipulators.delete(p),u.grabbing=!1,u.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:d}))}),this._draggedManipulators.forEach(({tool:l,manipulator:u},d)=>{o(l,u)&&(this._draggedManipulators.delete(d),u.dragging=!1,u.events.emit("drag",{action:"cancel"}))}),s&&this._hoveredManipulators.forEach(({tool:l,manipulator:u},d)=>{o(l,u)&&(this._hoveredManipulators.delete(d),u.hovering=!1)}),this._afterManipulatorRelease(i),this._onFocusChange(r)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((r,i)=>{this._updateHoveredStateForPointerAtScreenPosition(Gt(r.x,r.y),i,r.pointerType,e)})}handleHoverEvent(e,r){const i=e.type;i!=="pointer-up"&&i!=="immediate-click"&&i!=="pointer-move"||!hk(e.pointerType)||(i!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(pn(e),e.pointerId,e.pointerType,r))}_updateHoveredStateForPointerAtScreenPosition(e,r,i,s){let n=nc(e,i,s);const o=this._hoveredManipulators.get(r)?.manipulator;n==null||n.manipulator.interactive||(n=null),n!=null&&o===n.manipulator||(o!=null&&(o.hovering=!1),n!=null?(n.manipulator.hovering=!0,this._hoveredManipulators.set(r,n)):this._hoveredManipulators.delete(r),this._onFocusChange(s))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach(({manipulator:r},i)=>{e===i&&(this._hoveredManipulators.delete(e),r.hovering=!1)})}_cursorFromMap(e,r){if(!e?.size)return null;for(const{manipulator:i}of e.values())if(i?.interactive){if(i.grabbing&&i.grabCursor)return i.grabCursor;if(i.cursor)return i.cursor}return r}};function nc(t,e,r){for(const i of r){if(i.manipulators==null||!l$(i))continue;const s=i.manipulators.intersect(t,e);if(s!=null)return{tool:i,manipulator:s}}return null}function hk(t){return t==="mouse"}function pk(t){return t.pointerType!=="mouse"||t.button===0}function Ase(t){return!!t.native.shiftKey}function w1(t,e){t?.consumesClicks&&e()}a([c()],_0.prototype,"cursor",null),_0=a([b("esri.views.interactive.ToolViewManagerManipulatorState")],_0);const fk="attached",b1="tools",Rse=1e3;let fn=class extends X{constructor(e){super(e),this._updatingHandles=new yu,this._clock=Vh,this._manipulatorState=new _0,this.tools=new H,this._interacting=!1,this._interactingTimeout=Rse,this._interactingTimeoutHandle=null}initialize(){this.addHandles([this.view.on(vj,e=>{this._handleInputEvent(e)},No.TOOL),...Cse(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs)}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy(),this._manipulatorState.destroy()}get _manipulatorStateEventArgs(){return{tools:this.tools,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void L.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const r=this.activeTool;this._set("activeTool",e),r?.deactivate(),e?.activate(),this._removeIncompleteTools(e);for(const i of this.tools){this._updateToolEditableFlag(i);const s=l$(i);this.activeTool!=null&&s||this._manipulatorState.clearPointers(i,this._manipulatorStateEventArgs,!s)}}get cursor(){const e=this._manipulatorState.cursor;if(e!=null)return e;for(const r of this.tools)if(r.visible&&r.cursor!=null)return r.cursor;return null}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=He(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){this.view.type==="3d"?this.addHandles([ne(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>this._forEachManipulator(e=>e.onViewChange())),this.view.elevationProvider.on("elevation-change",e=>this._forEachManipulator(r=>r.onElevationChange(e)))],fk):this.addHandles(ne(()=>this.view.extent,()=>this._forEachManipulator(e=>e.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(fk),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){for(const r of this.tools)r.manipulators&&r.manipulators.forEach(({manipulator:i})=>e(i,r))}_handleInputEvent(e){let r=!1;const i={...e,stopPropagation:()=>{r=!0,e.stopPropagation()}};if(this.activeTool!=null)this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i);else for(const s of this.tools)!r&&s.visible&&s.handleInputEvent(i);!r&&Pse(e)&&this.activeTool&&(e.stopPropagation(),e.preventDefault(),this.activeTool.cancel(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),r||this.activeTool==null||this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this.tools),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(b1);for(const e of this.tools){if(e instanceof X){const r=ne(()=>[e.cursor,e.visible,e.editable],()=>{l$(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs)});this.addHandles(r,b1)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",r=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,r.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this.tools)})],b1)}this._manipulatorState.updateHoveredStateFromKnownPointers(this.tools)}_updateToolEditableFlag(e){e.setEditableFlag?.(1,this.activeTool==null||e===this.activeTool)}_removeIncompleteTools(e){this.tools.filter(r=>(e==null||r!==e)&&!r.created&&r.removeIncompleteOnCancel).forEach(r=>{this.tools.remove(r)})}get test(){}};a([c({constructOnly:!0,nonNullable:!0})],fn.prototype,"view",void 0),a([c({value:null})],fn.prototype,"activeTool",null),a([c({readOnly:!0,type:H})],fn.prototype,"tools",void 0),a([c()],fn.prototype,"cursor",null),a([c({readOnly:!0})],fn.prototype,"updating",null),a([c()],fn.prototype,"_interacting",void 0),a([c({readOnly:!0})],fn.prototype,"interacting",null),fn=a([b("esri.views.ToolViewManager")],fn);const Lse=new ue("cyan"),Fse=1,Nse=.25,Dse=new ue("black"),jse=.4,Vse=.2,dxe=.25,Mj="default",zse="temporary",Use=new ue("yellow");var u$;let Ii=u$=class extends X{constructor(t){super(t),this.name=Mj,this.color=Lse.clone(),this.haloColor=null,this.haloOpacity=Fse,this.fillOpacity=Nse,this.shadowColor=Dse.clone(),this.shadowOpacity=jse,this.shadowDifference=Vse,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur&&this.shadowColor.equals(t.shadowColor)&&this.shadowOpacity===t.shadowOpacity&&this.shadowDifference===t.shadowDifference}clone(){return new u$({...this,color:this.color.clone(),haloColor:this.haloColor?.clone(),shadowColor:this.shadowColor?.clone()})}assignFrom(t){this.color=t.color.clone(),this.haloColor=t.haloColor?.clone(),this.haloOpacity=t.haloOpacity,this.fillOpacity=t.fillOpacity,this.shadowColor=t.shadowColor.clone(),this.shadowDifference=t.shadowDifference,this.shadowOpacity=t.shadowOpacity,this.haloBlur=t.haloBlur,this.haloWidth=t.haloWidth}};a([c({type:String,constructOnly:!0,nonNullable:!0})],Ii.prototype,"name",void 0),a([c({type:ue,nonNullable:!0})],Ii.prototype,"color",void 0),a([c({type:ue})],Ii.prototype,"haloColor",void 0),a([c({nonNullable:!0})],Ii.prototype,"haloOpacity",void 0),a([c({nonNullable:!0})],Ii.prototype,"fillOpacity",void 0),a([c({type:ue,nonNullable:!0})],Ii.prototype,"shadowColor",void 0),a([c({nonNullable:!0})],Ii.prototype,"shadowOpacity",void 0),a([c({nonNullable:!0})],Ii.prototype,"shadowDifference",void 0),a([c({nonNullable:!0})],Ii.prototype,"haloWidth",void 0),a([c({nonNullable:!0})],Ii.prototype,"haloBlur",void 0),Ii=u$=a([b("esri.views.support.HighlightOptions")],Ii);const qa=Ii;function qse(){return new(H.ofType(qa))([new qa({name:Mj}),new qa({name:zse,color:Use})])}let Cc=class extends X{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":Gse.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Bse[this.deviceType]}};a([c({nonNullable:!0,readOnly:!0})],Cc.prototype,"nativeIndex",void 0),a([c({type:String,readOnly:!0})],Cc.prototype,"deviceType",null),a([c({type:Number,readOnly:!0})],Cc.prototype,"axisThreshold",null),Cc=a([b("esri.views.input.gamepad.GamepadInputDevice")],Cc);const qM=Cc,Gse=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Bse={standard:.15,spacemouse:.025,unknown:0};let cf=class extends X{constructor(e){super(e),this.devices=new H,this.enabledFocusMode="document"}};a([c({type:H.ofType(qM),readOnly:!0})],cf.prototype,"devices",void 0),a([c({type:["document","view","none"]})],cf.prototype,"enabledFocusMode",void 0),cf=a([b("esri.views.input.gamepad.GamepadSettings")],cf);const Hse=cf;let S0=class extends X{constructor(){super(...arguments),this.gamepad=new Hse}};a([c({readOnly:!0})],S0.prototype,"gamepad",void 0),S0=a([b("esri.views.input.Input")],S0);const Wse=S0,_1=()=>c({type:["pan","rotate","zoom","none"],nonNullable:!0});let jl=class extends X{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};a([_1()],jl.prototype,"dragPrimary",void 0),a([_1()],jl.prototype,"dragSecondary",void 0),a([_1()],jl.prototype,"dragTertiary",void 0),a([c({type:["zoom","none"],nonNullable:!0})],jl.prototype,"mouseWheel",void 0),jl=a([b("esri.views.navigation.NavigationActionMap")],jl);const GM=jl;let da=class extends X{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};a([c({type:Boolean,nonNullable:!0})],da.prototype,"enabled",void 0),a([c({type:qM})],da.prototype,"device",void 0),a([c({type:["pan","zoom"],nonNullable:!0})],da.prototype,"mode",void 0),a([c({type:["forward-down","forward-up"],nonNullable:!0})],da.prototype,"tiltDirection",void 0),a([c({type:Number,nonNullable:!0})],da.prototype,"velocityFactor",void 0),da=a([b("esri.views.navigation.gamepad.GamepadSettings")],da);const Ij=da;let ha=class extends X{constructor(e){super(e),this.actionMap=new GM,this.browserTouchPanEnabled=!0,this.gamepad=new Ij,this.momentumEnabled=!0}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(e){x_(L.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};a([c({type:GM,nonNullable:!0})],ha.prototype,"actionMap",void 0),a([c({type:Boolean})],ha.prototype,"browserTouchPanEnabled",void 0),a([c({type:Ij,nonNullable:!0})],ha.prototype,"gamepad",void 0),a([c({type:Boolean})],ha.prototype,"momentumEnabled",void 0),a([c({type:Boolean})],ha.prototype,"mouseWheelZoomEnabled",null),ha=a([b("esri.views.navigation.Navigation")],ha);const tb=ha;function vxe(t,e,r){const i=Ej(t),s=e,n=Zse(i,s,r);if(i){const o=zr.deriveUnitFromSR(i,t.spatialReference).heightUnit;if(!r&&o!==i.heightUnit){const l=new x("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new x("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:i,error:l})}}if(!Jse(t)||n===4)return new x("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:i});switch(n){case 1:{const o=i?.heightUnit||"unknown",l=s?.heightUnit||"unknown",u=new x("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${l})`,{layerUnit:o,sceneUnit:l});return new x("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:s,error:u})}case 2:{const o=i?.heightModel||"unknown",l=s?.heightModel||"unknown",u=new x("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${l})`,{layerHeightModel:o,sceneHeightModel:l});return new x("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:s,error:u})}case 3:{const o=i?.vertCRS||"unknown",l=s?.vertCRS||"unknown",u=new x("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${l})`,{layerDatum:o,sceneDatum:l});return new x("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:s,error:u})}}return null}function Zse(t,e,r){if(!mk(t)||!mk(e))return 4;if(t==null||e==null)return 0;if(!r&&t.heightUnit!==e.heightUnit)return 1;if(t.heightModel!==e.heightModel)return 2;switch(t.heightModel){case"gravity-related-height":return 0;case"ellipsoidal":return t.vertCRS===e.vertCRS?0:3;default:return 4}}function mk(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function Jse(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!Cj(t)}function Ej(t){if(t.type==="integrated-mesh-3dtiles"||t.type==="gaussian-splat")return null;const e=t.url?nl(t.url):void 0;return!(t.spatialReference?.vcsWkid==null&&e!=null&&e.serverType==="ImageServer")&&Oj(t)&&t.heightModelInfo?t.heightModelInfo:Cj(t)?zr.deriveUnitFromSR(Kse,t.spatialReference):null}function Oj(t){return"heightModelInfo"in t}function kj(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function Cj(t){return kj(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):Pj(t)}function Yse(t){return t.layers!=null||Pj(t)||kj(t)||Oj(t)}function Pj(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"gaussian-splat":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}const Kse=new zr({heightModel:"gravity-related-height"});let c$,S1=null;async function Qse(t){S1||(S1=N(()=>import("./geometryServiceUtils-D2UvfBCV.js"),[]).then(e=>c$=e)),await S1,We(t)}async function Aj(t,e,r,i){if(!t)return null;const s=t.spatialReference;return qo()||nn(s,e)?ll(t,e):c$?c$.projectGeometry(t,e,r,i):(await Promise.race([Qse(i),el(i)]),Aj(t,e,r,i))}async function wxe(t,e){try{return t?.spatialReference?await HN(t,e):null}catch{return null}}let Ue=class extends X{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=jo(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const e=this.map?.(),r=[];return this.priorityCollection!=null&&r.push(this.priorityCollection),r.push({parent:e?.basemap,layers:e?.basemap?.baseLayers},{parent:e?.basemap,layers:e?.basemap?.groundLayers},{layers:e?.layers},{parent:e?.ground,layers:e?.ground?.layers},{parent:e?.basemap,layers:e?.basemap?.referenceLayers}),r}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,i=>{const s=this._getSupportedSpatialReferences(i);if(s.length>0){const n=this._narrowDownSpatialReferenceCandidates(e,s);n!=null&&(e=n)}return e?.length===1})&&e?.length!==1)return{updating:!0};const r=this._pickSpatialReferenceCandidate(e);return{spatialReference:r?.spatialReference??null,viewingMode:r?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=this.map?.(),r=this.spatialReference;if(!r)return{updating:this._spatialReferenceTask.updating};let i;const s=this._collectLayers([{parent:e?.basemap,layers:e?.basemap?.baseLayers},{parent:e?.basemap,layers:e?.basemap?.groundLayers},{layers:e?.layers}],n=>!(!("tileInfo"in n)||!n.tileInfo?.spatialReference.equals(r))&&(i=n,!0),n=>"tileInfo"in n);return i?{tileInfo:i.tileInfo,updating:!1}:{updating:s}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let e={};const r=this._collectLayers(this.mapCollections,i=>{const s=Ej(i);return!!s&&(e={heightModelInfo:s,vcsWkid:i.spatialReference?.vcsWkid,latestVcsWkid:i.spatialReference?.latestVcsWkid},!0)},i=>Yse(i));return{...e,updating:r}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],r=this._collectLayers(this.mapCollections,i=>{const s="fullExtents"in i&&i.fullExtents||(i.fullExtent!=null?[i.fullExtent]:[]),n=this.requiresExtentInSpatialReference?null:s[0],o=s.find(l=>l.spatialReference.equals(this.spatialReference))??n;if(o)return e.push({extent:o,layer:i}),!0;if(this._getSupportedSpatialReferences(i).length>0)for(const l of s)e.push({extent:l,layer:i});return!1});return{candidates:e,updating:r}}get _extentTask(){const{candidates:e,updating:r}=this._extentCandidatesTask;if(r)return{updating:r};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const i=this._pickExtentCandidate(e),s=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&s.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=jo(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:s.clone(),task:ey(async n=>{try{const o=await Aj(i.extent,s,"portalItem"in i.layer?i.layer.portalItem:void 0,n);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(Cr(n))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,r){if(e==null)return r;const i=new Array;for(const s of e)for(const n of r){if(!s.spatialReference.equals(n.spatialReference))continue;const o=ene(s.viewingMode,n.viewingMode);if(o!==!1){i.push({spatialReference:s.spatialReference,viewingMode:o});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(e){const r=this.defaultSpatialReference;return e==null||e.length<1?r?{spatialReference:r,viewingMode:null}:null:(r!=null&&e.length>1&&e.some(({spatialReference:i})=>i.equals(r))&&(e=e.filter(({spatialReference:i})=>i.equals(r))),e.length>1&&e.some(({viewingMode:i})=>i!==2)&&(e=e.filter(({viewingMode:i})=>i!==2)),e[0])}_getSupportedSpatialReferences(e){const r="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(r.length===0)return[];const i=[];for(const s of r){const n=this.getSpatialReferenceSupport(s,e);if(n!=null){const o=n.constraints??[{spatialReference:s,viewingMode:null}];for(const{spatialReference:l,viewingMode:u}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!l.equals(this.userSpatialReference)||i.push({spatialReference:l,viewingMode:u})}}return i}_pickExtentCandidate(e){const r=this.spatialReference;return e.find(({extent:i})=>r.equals(i.spatialReference))||e[0]}_collectLayers(e,r,i=()=>!0){switch(this._loadMaybe(this.map?.())){case"loading":return!0;case"failed":return!1}const s=new Xse(i,r);for(const n of e)if(this._collectCollection(n,s),s.done||s.preloading===this.sourcePreloadCount)break;return s.updating}_collectCollection(e,r){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return r.updating=!0,void++r.preloading;case"failed":return}for(const i of e.layers)if((i.type!=="graphics"||!i.internal)&&r.layerFilter(i)){switch(this._loadMaybe(i)){case"failed":continue;case"loading":r.updating=!0,++r.preloading;break;case"loaded":if(r.updating||(r.done=r.pushLayer(i)),r.done||r.preloading===this.sourcePreloadCount)break;"layers"in i&&this._collectCollection({layers:i.layers},r)}if(r.done||r.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(r=>{sr(r)}),"loading"):e.loadStatus:"loaded"}};a([c()],Ue.prototype,"required",void 0),a([c({constructOnly:!0})],Ue.prototype,"map",void 0),a([c({constructOnly:!0})],Ue.prototype,"getSpatialReferenceSupport",void 0),a([c()],Ue.prototype,"defaultSpatialReference",void 0),a([c()],Ue.prototype,"userSpatialReference",void 0),a([c()],Ue.prototype,"sourcePreloadCount",void 0),a([c()],Ue.prototype,"priorityCollection",void 0),a([c()],Ue.prototype,"requiresExtentInSpatialReference",void 0),a([c()],Ue.prototype,"suspended",void 0),a([c({readOnly:!0})],Ue.prototype,"ready",null),a([c({readOnly:!0})],Ue.prototype,"heightModelInfoReady",null),a([c({readOnly:!0})],Ue.prototype,"spatialReference",null),a([c({readOnly:!0})],Ue.prototype,"extent",null),a([c({readOnly:!0})],Ue.prototype,"heightModelInfo",null),a([c({readOnly:!0})],Ue.prototype,"vcsWkid",null),a([c({readOnly:!0})],Ue.prototype,"latestVcsWkid",null),a([c({readOnly:!0})],Ue.prototype,"viewingMode",null),a([c({readOnly:!0})],Ue.prototype,"tileInfo",null),a([c({readOnly:!0})],Ue.prototype,"mapCollections",null),a([c({readOnly:!0})],Ue.prototype,"_spatialReferenceTask",null),a([c({readOnly:!0})],Ue.prototype,"_tileInfoTask",null),a([c({readOnly:!0})],Ue.prototype,"_heightModelInfoTask",null),a([c({readOnly:!0})],Ue.prototype,"_extentCandidatesTask",null),a([c()],Ue.prototype,"_extentTask",null),a([c()],Ue.prototype,"_projectExtentTask",void 0),Ue=a([b("esri.views.support.DefaultsFromMap")],Ue);let Xse=class{constructor(e,r){this.layerFilter=e,this.pushLayer=r,this.preloading=-1,this.updating=!1,this.done=!1}};function ene(t,e){return t!=null?e!=null?t===e&&t:t:e}function tne(t){return"tryRecycleWith"in t}let rne=class{constructor(e,r,i){this.layer=e,this.view=r,this.layerViewImporter=i,this._controller=new AbortController,this._started=!1,this.done=!1,this._deferred=wi(),this.promise=this._deferred.promise,ys(this._controller.signal,()=>{this._recycleController?.abort();const s=new x("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred?.reject(s)})}tryRecycle(e){if(!this.done||!this.layerView||!tne(this.layerView))return null;this._recycleController?.abort(),this._recycleController=new AbortController;const r=this.layer.type,i=this._recycleController.signal;for(let s=0;s<e.length;s++){const n=e[s];if(n.type!==r)continue;const o=this.layerView.tryRecycleWith(n,{signal:i});if(o){e.splice(s,1),this.layer=n;const l=this.layerView,u=l.view;return this.promise=o.then(()=>(We(i),n.emit("layerview-destroy",{view:u,layerView:l}),u.emit("layerview-destroy",{view:u,layerView:l}),n.emit("layerview-create",{view:u,layerView:l}),u.emit("layerview-create",{view:u,layerView:l}),l)),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:r,view:i}=this;r.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{layer:r,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null,this.promise=null,this._deferred=null}async start(){const{view:e}=this;if(this._started||!e.map)return;this._started=!0;const{_controller:{signal:r},layer:i}=this;this._map=e.map;try{let s,n;if(await i.load({signal:r}),i.prefetchResources&&await i.prefetchResources({signal:r}),ine(i))s=await i.createLayerView(e,{signal:r});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new x("layer:view-not-supported","No layerview implementation was found");const u=await this.layerViewImporter.importLayerView(i);We(r),s="default"in u?new u.default({layer:i,view:e}):new u({layer:i,view:e})}const o=()=>{n=He(n),s.destroyed||s.destroy(),this.done=!0};n=ys(r,o),We(r);try{await s.when()}catch(u){throw o(),u}if(!this._map?.allLayers?.includes(i))return o(),void this._deferred?.reject(new x("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=s,i.emit("layerview-create",{view:e,layerView:s}),e.emit("layerview-create",{layer:i,layerView:s}),this.done=!0,this._deferred?.resolve(s)}catch(s){i.emit("layerview-create-error",{view:e,error:s}),e.emit("layerview-create-error",{layer:i,error:s}),this.done=!0,this._deferred?.reject(new x("layerview:create-error","layerview creation failed",{layer:i,error:s}))}}};function ine(t){return t.createLayerView!==tt.prototype.createLayerView}function sne(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let ti=class extends X{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new yu,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const r=this.view.map?.allLayers;if(r)for(const i of r)this.layerViewFilter?.(i)!==!1&&this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=wi(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(Bh(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{if(this.destroyed)return;const{map:r}=this.view;if(!r)return void this.clear();if(this._map!==r&&(this.clear(),this._map=r),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const i=new Set,s=[],n=this.view.ready,o=p=>{if(p!=null){for(const f of p)if(f){if(this.layerViewFilter?.(f)===!1)continue;i.add(f);const m=this._layerLayerViewInfoMap.get(f);m&&n?m.start():m||this._recyclingInfoMap.has(f)||s.push(f),"layers"in f&&f.layers&&o(f.layers)}}};for(const p of this._rootCollectionNames)o(Ys(this,p));const l=new Array,u=p=>{const f=p.tryRecycle(s);f?(this._recyclingInfoMap.set(p.layer,p),this.notifyChange("updating"),f.then(()=>{this._recyclingInfoMap.delete(p.layer),this._layerLayerViewInfoMap.set(p.layer,p),this._reschedule(),this.notifyChange("updating")}).catch(m=>{sr(m)||(this._recyclingInfoMap.delete(p.layer),p.destroy(),this._reschedule(),this.notifyChange("updating"))})):l.push(p)};for(const p of this._layerLayerViewInfoMap.values())i.has(p.layer)||(this._layerLayerViewInfoMap.delete(p.layer),u(p));for(const p of this._recyclingInfoMap.values())i.has(p.layer)||(this._recyclingInfoMap.delete(p.layer),u(p));for(const p of s)this._createLayerView(p);this._refreshCollections(),l.forEach(p=>p.destroy());const d=[r?.ground?.layers,r?.basemap?.baseLayers,r?.basemap?.groundLayers,r?.basemap?.referenceLayers,r?.layers].filter(p=>!!p);i.forEach(p=>"layers"in p&&d.push(p.layers)),this.addHandles(d.map(p=>this._watchUpdatingTracking.addOnCollectionChange(()=>p,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null},this._layersToLayerViews=new Map(e.layerviewMapping)}initialize(){this.addHandles([Lu(()=>this.view?.map?.allLayers,"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),ne(()=>{const e=this.view,r=e?.map;return[r?.basemap,r?.ground,r?.layers,e?.ready]},()=>this._reschedule(),xr)]),this._preloadLayerViewModules(),this._reschedule()}clearHandles(){this._watchUpdatingTracking.removeAll()}destroy(){this.clear(),zy(this._recyclingInfoMap),zy(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(Fe()),this._workPromise=null)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||t7(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const r of this._layerLayerViewInfoMap.values())r.done||++e;return e}clear(){this.destroyed||(this._clearCollections(),zy(this._layerLayerViewInfoMap),zy(this._recyclingInfoMap))}async whenLayerView(e){await this._reschedule();const r=this._layerLayerViewInfoMap.get(e)?.promise;if(!r){const i=this._recyclingInfoMap.get(e)?.promise;if(!i)throw new x("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return i}return r}isCreatingLayerViewsForLayer(e,r){this.commitProperty("updatingRemaining");const i=this._layerLayerViewInfoMap.get(e);if(!i?.done)return!0;const s=i.layerView;return!(!s||!r||s.parent===r)||!!(i.done&&s&&"layers"in e&&e.layers?.length)&&e.layers.some(n=>this.isCreatingLayerViewsForLayer(n,s))}_refreshCollections(){for(const[e,r]of this._layersToLayerViews)this._populateLayerViewsOwners(Ys(this,e),Ys(this,r),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_clearCollections(){for(const e of this._layersToLayerViews.values())Ys(this,e)?.removeAll()}_populateLayerViewsOwners(e,r,i){if(!e||!r)return void r?.removeAll();let s=0;for(const n of e){const o=this._layerLayerViewInfoMap.get(n);if(!o?.layerView)continue;const{layerView:l}=o;l.layer=n,l.parent=i,r.at(s)!==l&&r.splice(s,0,l),"layers"in n&&sne(l)&&this._populateLayerViewsOwners(n.layers,l.layerViews,l),++s}s<r.length&&r.splice(s)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const r=new rne(e,this.view,this.layerViewImporter);r.promise?.then(()=>this._refreshCollections(),i=>{i&&(sr(i)||i.name==="cancelled:layerview-create")||L.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:i}),this.destroyed||this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,r),this.view.ready&&r.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};a([c()],ti.prototype,"_workPromise",void 0),a([c({readOnly:!0})],ti.prototype,"_watchUpdatingTracking",void 0),a([c({readOnly:!0})],ti.prototype,"_layersToLayerViews",void 0),a([c({constructOnly:!0})],ti.prototype,"layerviewMapping",void 0),a([c({readOnly:!0})],ti.prototype,"_rootCollectionNames",null),a([c({constructOnly:!0})],ti.prototype,"layerViewFilter",void 0),a([c()],ti.prototype,"layerViewImporter",void 0),a([c()],ti.prototype,"supportsGround",void 0),a([c({readOnly:!0})],ti.prototype,"updating",null),a([c({readOnly:!0})],ti.prototype,"updatingRemaining",null),a([c({constructOnly:!0})],ti.prototype,"view",void 0),ti=a([b("esri.views.support.LayerViewManager")],ti);const nne=ti;let Pc=class extends X{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};a([c()],Pc.prototype,"featureTitleFields",void 0),a([c()],Pc.prototype,"utilityNetworkFields",void 0),a([c()],Pc.prototype,"globalIdField",void 0),Pc=a([b("esri.views.support.RequiredFieldsOptions")],Pc);const one=Pc;var Ac,Wa;let te=(Wa=class extends _w(CT){constructor(e){super(e),this._userSpatialReference=null,this.handles=new qh,this.updatingHandles=new yu,this.allLayerViews=new Zs({getCollections:()=>this.layerviewCollections,getChildrenFunction:lne}),this.analyses=new Oh,this.basemapView=null,this.dependencies={popup:void 0},this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new tm,this.typeSpecificPreconditionsReady=!0,this.layerViews=new H,this.magnifier=new mj,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this._lowPriorityCursorHandles=new H,this._highPriorityCursorHandles=new H,this.input=new Wse,this.navigation=new tb,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new _j(this),this.persistableViewModels=new H,this.requiredFieldsOptions=new one,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(ne(()=>this.preconditionsReady,r=>{const i=this.ready;if(r?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,Ac.views.add(this)):(this._lockedSpatialReference=null,Ac.views.remove(this)),this.notifyChange("spatialReference"),!r&&i)this.toolViewManager?.detach(),this.analysisViewManager?.detach(),this.layerViewManager?.clear(),this._teardown();else if(r&&!i){try{this._startup()}catch(s){return void queueMicrotask(()=>{this.fatalError=new x("view:startup-error","View._startup failed",s)})}this.analysisViewManager?.attach(),this.toolViewManager.attach()}},jn))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this._validateWithErrorDisplay()]).then(()=>(this._isValid=!0,Rw(()=>this.ready)))),this.basemapView=new rse({view:this}),this.layerViewManager=new nne({view:this,layerViewFilter:e=>this.layerViewFilter?.(e)??!0,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},layerviewMapping:this._layerToLayerviewMapping}),this.toolViewManager=new fn({view:this}),this.selectionManager=new pse({view:this}),this.addHandles([qi(()=>this.readyState==="map-content-error"&&!this.spatialReference,()=>{L.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),ne(()=>this.initialExtentRequired,e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e},xr),ne(()=>this.ready,e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)},jn),ne(()=>this._userSpatialReference,e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)},xr)])}get _layerToLayerviewMapping(){return Ac._layerToLayerview}destroy(){this.destroyed||(Ac.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=Ke(this.graphics),this.analyses=Ke(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.analysisViewManager=Ke(this.analysisViewManager),this.toolViewManager=Ke(this.toolViewManager),this.layerViewManager=Ke(this.layerViewManager),this.selectionManager=Ke(this.selectionManager),this.basemapView=Ke(this.basemapView),this.layerViews?.forEach(e=>e.destroy()),this.layerViews.length=0,this.invalidate(),this.handles.destroy(),this.map=Ke(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return L.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get layerviewCollections(){return[this.basemapView?.baseLayerViews,this.basemapView?.groundLayerViews,this.layerViews,this.basemapView?.referenceLayerViews]}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Ue({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(e,r)=>this.getSpatialReferenceSupport(e,r),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??qse()}set highlights(e){this._set("highlights",Pn(e,this._get("highlights"),H.ofType(qa)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!this.destroying&&!this.destroyed&&!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||F_(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e?.destroyed&&(L.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),F_(e)&&e.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get readyState(){if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((this.defaultsFromMap?.ready??!1)&&!this.spatialReference){const e=!("loaded"in this.map)||this.map.loaded,r=this.map.ground.loaded,i=this.map.basemap?.loaded??!0;return e&&i&&r&&!this.map?.allLayers.length?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=ey(s=>fT(k("view-readyState-waiting-delay"),null,s)),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),this._readyStateWaitingTask?.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=jo(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&this.defaultsFromMap?.required?.heightModelInfo){const r=e.clone();return r.vcsWkid=this.defaultsFromMap.vcsWkid,r.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,r}return e}set spatialReference(e){const r=!Ht(e,this._get("spatialReference"));this._set("_userSpatialReference",e),r&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(e){this._userTimeExtent=e}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??rn}set timeZone(e){this._userTimeZone=e,TZ(e)||L.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._highPriorityCursorHandles.at(-1)?.cursor??this._lowPriorityCursorHandles.at(-1)?.cursor??"default"}acquireCursor(e,r="low"){const i=r==="high"?this._highPriorityCursorHandles:this._lowPriorityCursorHandles,s={cursor:e},n=Te(()=>i.remove(s));return i.add(s),this.addHandles(n),n}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new o$}whenLayerView(e){return this.layerViewManager?.whenLayerView(e)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}getSurface(){return null}importLayerView(e){throw new x("view:importLayerView-missing","importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return this.getSpatialReferenceSupport(e)!=null}when(e,r){return this.isResolved()&&!this.ready&&L.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,r)}forceReadyCycle(){this.ready&&(qi(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}on(e,r){return super.on(e,r)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}async _validateWithErrorDisplay(){try{await this.validate()}catch(e){const r=document.createElement("div");r.setAttribute("style","display: flex; flex-direction: column; gap: 8px; padding: 20px; height: 100%; justify-content: center; color: black; background: white; font-family: sans-serif;");const i=document.createElement("div");i.innerHTML="Unable to display map. WebGL2 support is required.",i.setAttribute("style","font-size: 24px; font-weight: bold;");const s=document.createElement("div");s.innerHTML="Ensure that your browser and hardware meet the minimum requirements.",s.setAttribute("style","font-size: 18px;");const n=document.createElement("a");n.innerHTML="https://esriurl.com/webgl-faq",n.target="_blank",n.setAttribute("style","font-size: 18px;"),n.href="https://esriurl.com/webgl-faq",r.appendChild(i),r.appendChild(s),r.appendChild(n);const o=this.getSurface();throw o&&o.appendChild(r),e}}},Ac=Wa,Wa._layerToLayerview=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.basemap.groundLayers","view.basemapView.groundLayerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"],["view.map.layers","view.layerViews"]],Wa.views=new H,Wa);a([c()],te.prototype,"_userSpatialReference",void 0),a([c()],te.prototype,"activeTool",null),a([c({readOnly:!0})],te.prototype,"allLayerViews",void 0),a([c({readOnly:!0})],te.prototype,"layerviewCollections",null),a([c(AS(Oh,"analyses"))],te.prototype,"analyses",void 0),a([c()],te.prototype,"animation",null),a([c()],te.prototype,"basemapView",void 0),a([c()],te.prototype,"center",null),a([c()],te.prototype,"defaultsFromMapSettings",null),a([c()],te.prototype,"defaultsFromMap",null),a([c()],te.prototype,"dependencies",void 0),a([c()],te.prototype,"displayFilterEnabled",void 0),a([c({type:he})],te.prototype,"extent",null),a([c()],te.prototype,"fatalError",void 0),a([c(AS(tm,"graphics"))],te.prototype,"graphics",void 0),a([c({readOnly:!0,type:zr})],te.prototype,"heightModelInfo",null),a([c({type:H.ofType(qa)})],te.prototype,"highlights",null),a([c({readOnly:!0})],te.prototype,"interacting",null),a([c({constructOnly:!0})],te.prototype,"layerViewFilter",void 0),a([c({readOnly:!0})],te.prototype,"navigating",null),a([c({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],te.prototype,"preconditionsReady",null),a([c({readOnly:!0})],te.prototype,"typeSpecificPreconditionsReady",void 0),a([c({type:H,readOnly:!0})],te.prototype,"layerViews",void 0),a([c()],te.prototype,"resolution",null),a([c({type:mj})],te.prototype,"magnifier",void 0),a([c({value:null,type:vD})],te.prototype,"map",null),a([c()],te.prototype,"padding",void 0),a([c({readOnly:!0})],te.prototype,"ready",void 0),a([c()],te.prototype,"_readyStateWaitingTask",void 0),a([c({readOnly:!0})],te.prototype,"readyState",null),a([c({type:Z})],te.prototype,"spatialReference",null),a([c()],te.prototype,"stationary",null),a([c({type:It})],te.prototype,"timeExtent",null),a([c({type:String,nonNullable:!0})],te.prototype,"timeZone",null),a([c()],te.prototype,"tools",null),a([c()],te.prototype,"toolViewManager",void 0),a([c({readOnly:!0})],te.prototype,"type",void 0),a([c({type:Number})],te.prototype,"scale",void 0),a([c({readOnly:!0})],te.prototype,"updating",void 0),a([c({readOnly:!0})],te.prototype,"initialExtentRequired",void 0),a([c({readOnly:!0})],te.prototype,"initialExtent",null),a([c()],te.prototype,"cursor",null),a([c({readOnly:!0})],te.prototype,"input",void 0),a([c({type:tb,nonNullable:!0})],te.prototype,"navigation",void 0),a([c()],te.prototype,"layerViewManager",void 0),a([c()],te.prototype,"analysisViewManager",void 0),a([c()],te.prototype,"selectionManager",void 0),a([c()],te.prototype,"width",void 0),a([c()],te.prototype,"height",void 0),a([c({readOnly:!0})],te.prototype,"resizing",void 0),a([c({value:null,readOnly:!0})],te.prototype,"size",null),a([c({readOnly:!0})],te.prototype,"suspended",void 0),a([c({readOnly:!0})],te.prototype,"viewEvents",void 0),a([c({readOnly:!0})],te.prototype,"persistableViewModels",void 0),a([c()],te.prototype,"_isValid",void 0),a([c()],te.prototype,"_readyCycleForced",void 0),a([c()],te.prototype,"_lockedSpatialReference",void 0),a([c()],te.prototype,"_userTimeZone",void 0),a([c()],te.prototype,"_lockedTimeZone",void 0),a([c()],te.prototype,"_userTimeExtent",void 0),a([c()],te.prototype,"_lockedTimeExtent",void 0),a([c({type:o$})],te.prototype,"theme",void 0),a([c({readOnly:!0,type:o$})],te.prototype,"effectiveTheme",null),te=Ac=a([b("esri.views.View")],te);const $1=globalThis.$arcgis;$1&&!$1.views&&Object.defineProperty($1,"views",{configurable:!1,enumerable:!0,writable:!1,value:te.views});const ane=te;function lne(t){return t.layerViews}function lt(){return[0,0]}function une(t){return[t[0],t[1]]}function gy(t,e){return[t,e]}function cne(t,e){return[t,e]}function dne(t,e=lt()){const r=Math.min(2,t.length);for(let i=0;i<r;++i)e[i]=t[i];return e}function Rj(){return lt()}function Lj(){return gy(1,1)}function Fj(){return gy(1,0)}function Nj(){return gy(0,1)}const hne=Rj(),pne=Lj(),fne=Fj(),mne=Nj();Object.freeze(Object.defineProperty({__proto__:null,ONES:pne,UNIT_X:fne,UNIT_Y:mne,ZEROS:hne,clone:une,create:lt,freeze:cne,fromArray:dne,fromValues:gy,ones:Lj,unitX:Fj,unitY:Nj,zeros:Rj},Symbol.toStringTag,{value:"Module"}));function yne(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Dj(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function gne(t,e,r,i,s,n,o){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=n,t[5]=o,t}function BM(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],l=e[5];let u=r*n-i*s;return u?(u=1/u,t[0]=n*u,t[1]=-i*u,t[2]=-s*u,t[3]=r*u,t[4]=(s*l-n*o)*u,t[5]=(i*o-r*l)*u,t):null}function vne(t){return t[0]*t[3]-t[1]*t[2]}function jj(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=r[0],p=r[1],f=r[2],m=r[3],y=r[4],g=r[5];return t[0]=i*d+n*p,t[1]=s*d+o*p,t[2]=i*f+n*m,t[3]=s*f+o*m,t[4]=i*y+n*g+l,t[5]=s*y+o*g+u,t}function vy(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=Math.sin(r),p=Math.cos(r);return t[0]=i*p+n*d,t[1]=s*p+o*d,t[2]=i*-d+n*p,t[3]=s*-d+o*p,t[4]=l,t[5]=u,t}function rb(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=r[0],p=r[1];return t[0]=i*d,t[1]=s*d,t[2]=n*p,t[3]=o*p,t[4]=l,t[5]=u,t}function Ah(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],l=e[4],u=e[5],d=r[0],p=r[1];return t[0]=i,t[1]=s,t[2]=n,t[3]=o,t[4]=i*d+n*p+l,t[5]=s*d+o*p+u,t}function Vj(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t[4]=0,t[5]=0,t}function zj(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function HM(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function wne(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function bne(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function _ne(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t}function Uj(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}function Sne(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t}function $ne(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t}function xne(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function Tne(t,e){const r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],l=t[5],u=e[0],d=e[1],p=e[2],f=e[3],m=e[4],y=e[5],g=Kr();return Math.abs(r-u)<=g*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-d)<=g*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(s-p)<=g*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(n-f)<=g*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(o-m)<=g*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(l-y)<=g*Math.max(1,Math.abs(l),Math.abs(y))}const Mne=jj,Ine=Uj;Object.freeze(Object.defineProperty({__proto__:null,add:_ne,copy:yne,determinant:vne,equals:Tne,exactEquals:xne,frob:bne,fromRotation:Vj,fromScaling:zj,fromTranslation:HM,identity:Dj,invert:BM,mul:Mne,multiply:jj,multiplyScalar:Sne,multiplyScalarAndAdd:$ne,rotate:vy,scale:rb,set:gne,str:wne,sub:Ine,subtract:Uj,translate:Ah},Symbol.toStringTag,{value:"Module"}));function Ln(){return[1,0,0,1,0,0]}function Ene(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function One(t,e,r,i,s,n){return[t,e,r,i,s,n]}const kne=Ln();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:kne,clone:Ene,create:Ln,fromValues:One},Symbol.toStringTag,{value:"Module"}));const rg={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new At({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:Z.WebMercator}),minus180Line:new At({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new At({paths:[[[180,-180],[180,180]]],spatialReference:Z.WGS84}),minus180Line:new At({paths:[[[-180,-180],[-180,180]]],spatialReference:Z.WGS84})}};function au(t,e){return Math.ceil((t-e)/(2*e))}function qj(t,e){const r=im(t);for(const i of r)for(const s of i)s[0]+=e;return t}function im(t){return Fd(t)?t.rings:t.paths}function WM(t,e){return e?{...e,query:{...t,...e.query}}:{query:t}}function wy(t){return typeof t=="string"?Rr(t):E(t)}function ZM(t,e,r){const i={};for(const s in t){if(s==="declaredClass")continue;const n=t[s];if(n!=null&&typeof n!="function")if(Array.isArray(n))i[s]=n.map(o=>ZM(o));else if(typeof n=="object")if(n.toJSON){const o=n.toJSON(r?.[s]);i[s]=e?o:JSON.stringify(o)}else i[s]=e?n:JSON.stringify(n);else i[s]=n}return i}function Cne(t,e){return t?e&&wT(t)?e:vT(t)??Se?.findCredential(t)?.token:null}async function Txe(t,e,r){const i=Cne(t,e);return i||(!Se&&_e.request.useIdentity&&await N(()=>import("./IdentityManager-BERDLhJj.js"),[]),(await Se.getCredential(t,r))?.token)}async function Pne(t,e,r,i){const s=wy(t),n=e[0].spatialReference,o={...i,responseType:"json",query:{...s.query,f:"json",sr:vv(n),target:JSON.stringify({geometryType:rp(e[0]),geometries:e}),cutter:JSON.stringify(r)}},l=await Ae(s.path+"/cut",o),{cutIndexes:u,geometries:d=[]}=l.data;return{cutIndexes:u,geometries:d.map(p=>{const f=tl(p);return f.spatialReference=n,f})}}function Ane(t){return{geometryType:rp(t[0]),geometries:t.map(e=>e.toJSON())}}function Gj(t,e,r){const i=RX(e);return t.map(s=>{const n=i.fromJSON(s);return n.spatialReference=r,n})}async function Rne(t,e,r){const i=typeof t=="string"?Rr(t):t,s=e[0].spatialReference,n=rp(e[0]),o={...r,query:{...i.query,f:"json",sr:vv(s),geometries:JSON.stringify(Ane(e))}},{data:l}=await Ae(i.path+"/simplify",o);return Gj(l.geometries,n,s)}const Bj=()=>L.getLogger("esri.geometry.support.normalizeUtils");function Lne(t){return t.type==="polygon"}function Fne(t){return t[0].type==="polygon"}function Nne(t){return t[0].type==="polyline"}function yk(t){const e=[];let r=0,i=0;for(let s=0;s<t.length;s++){const n=t[s];let o=null;for(let l=0;l<n.length;l++)o=n[l],e.push(o),l===0?(r=o[0],i=r):(r=Math.min(r,o[0]),i=Math.max(i,o[0]));o&&e.push([(r+i)/2,0])}return e}function Dne(t,e){if(!(t instanceof At||t instanceof Be)){const s="straightLineDensify: the input geometry is neither polyline nor polygon";throw Bj().error(s),new x("internal:geometry",s)}const r=im(t),i=[];for(const s of r){const n=[];i.push(n),n.push([s[0][0],s[0][1]]);for(let o=0;o<s.length-1;o++){const l=s[o][0],u=s[o][1],d=s[o+1][0],p=s[o+1][1],f=Math.sqrt((d-l)*(d-l)+(p-u)*(p-u)),m=(p-u)/f,y=(d-l)/f,g=f/e;if(g>1){for(let M=1;M<=g-1;M++){const C=M*e,T=y*C+l,O=m*C+u;n.push([T,O])}const v=(f+Math.floor(g-1)*e)/2,_=y*v+l,S=m*v+u;n.push([_,S])}n.push([d,p])}}return Lne(t)?new Be({rings:i,spatialReference:t.spatialReference}):new At({paths:i,spatialReference:t.spatialReference})}function gk(t,e,r){if(e){const i=Dne(t,1e6);t=ud(i,!0)}return r&&(t=qj(t,r)),t}function vk(t,e,r){if(Array.isArray(t)){const i=t[0];if(i>e){const s=au(i,e);t[0]=i+s*(-2*e)}else if(i<r){const s=au(i,r);t[0]=i+s*(-2*r)}}else{const i=t.x;if(i>e){const s=au(i,e);t=t.clone().offset(s*(-2*e),0)}else if(i<r){const s=au(i,r);t=t.clone().offset(s*(-2*r),0)}}return t}function jne(t,e){let r=-1;for(let i=0;i<e.cutIndexes.length;i++){const s=e.cutIndexes[i],n=e.geometries[i],o=im(n);for(let l=0;l<o.length;l++){const u=o[l];u.some(d=>{if(d[0]<180)return!0;{let p=0;for(let m=0;m<u.length;m++){const y=u[m][0];p=y>p?y:p}p=Number(p.toFixed(9));const f=-360*au(p,180);for(let m=0;m<u.length;m++){const y=n.getPoint(l,m);n.setPoint(l,m,y.clone().offset(f,0))}return!0}})}if(s===r){if(Fne(t))for(const l of im(n))t[s]=t[s].addRing(l);else if(Nne(t))for(const l of im(n))t[s]=t[s].addPath(l)}else r=s,t[s]=n}return t}async function Vne(t,e,r){if(!Array.isArray(t))return Vne([t],e);e&&typeof e!="string"&&Bj().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const i=typeof e=="string"?e:e?.url??_e.geometryServiceUrl;let s,n,o,l,u,d,p,f,m=0;const y=[],g=[];for(const T of t)if(T!=null)if(s||(s=T.spatialReference,n=Yr(s),o=s.isWebMercator,d=o?102100:4326,l=rg[d].maxX,u=rg[d].minX,p=rg[d].plus180Line,f=rg[d].minus180Line),n)if(T.type==="mesh")g.push(T);else if(T.type==="point")g.push(vk(T.clone(),l,u));else if(T.type==="multipoint"){const O=T.clone();O.points=O.points.map(P=>vk(P,l,u)),g.push(O)}else if(T.type==="extent"){const O=T.clone()._normalize(!1,!1,n);g.push(O.rings?new Be(O):O)}else if(T.extent){const O=T.extent,P=au(O.xmin,u)*(2*l);let D=P===0?T.clone():qj(T.clone(),P);O.offset(P,0);let{xmin:z,xmax:B}=O;z=Number(z.toFixed(9)),B=Number(B.toFixed(9)),O.intersects(p)&&B!==l?(m=B>m?B:m,D=gk(D,o),y.push(D),g.push("cut")):O.intersects(f)&&z!==u?(m=B*(2*l)>m?B*(2*l):m,D=gk(D,o,360),y.push(D),g.push("cut")):g.push(D)}else g.push(T.clone());else g.push(T);else g.push(T);let v=au(m,l),_=-90;const S=v,M=new At;for(;v>0;){const T=360*v-180;M.addPath([[T,_],[T,-1*_]]),_*=-1,v--}if(y.length>0&&S>0){const T=jne(y,await Pne(i,y,M,r)),O=[],P=[];for(let B=0;B<g.length;B++){const G=g[B];if(G!=="cut")P.push(G);else{const Q=T.shift(),oe=t[B];oe!=null&&oe.type==="polygon"&&oe.rings&&oe.rings.length>1&&Q.rings.length>=oe.rings.length?(O.push(Q),P.push("simplify")):P.push(o?za(Q):Q)}}if(!O.length)return P;const D=await Rne(i,O,r),z=[];for(let B=0;B<P.length;B++){const G=P[B];G!=="simplify"?z.push(G):z.push(o?za(D.shift()):D.shift())}return z}const C=[];for(let T=0;T<g.length;T++){const O=g[T];if(O!=="cut")C.push(O);else{const P=y.shift();C.push(o===!0?za(P):P)}}return C}function zne(t){if(!t)return null;const e=t.extent;if(!e)return null;const r=t.spatialReference&&Yr(t.spatialReference);if(!r)return e;const[i,s]=r.valid,n=2*s,{width:o}=e;let l,{xmin:u,xmax:d}=e;if([u,d]=[d,u],t.type==="extent"||o===0||o<=s||o>n||u<i||d>s)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;l=yk(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;l=yk(t.paths);break;case"multipoint":l=t.points}const p=e.clone();for(let f=0;f<l.length;f++){let m=l[f][0];m<0?(m+=s,d=Math.max(m,d)):(m-=s,u=Math.min(m,u))}return p.xmin=u,p.xmax=d,p.width<o?(p.xmin-=s,p.xmax-=s,p):e}function JM(t,e,r){const i=Yr(r);if(i==null)return t;const[s,n]=i.valid,o=2*n;let l=0,u=0;e>n?l=Math.ceil(Math.abs(e-n)/o):e<s&&(l=-Math.ceil(Math.abs(e-s)/o)),t>n?u=Math.ceil(Math.abs(t-n)/o):t<s&&(u=-Math.ceil(Math.abs(t-s)/o));let d=t+(l-u)*o;const p=d-e;return p>n?d-=o:p<s&&(d+=o),d}function Mxe(t,e){return YM(e)?.normalize(t)??t}function YM(t){const e=Yr(t);if(e==null)return null;const[r,i]=e.valid;return new Hw(r,i)}const Ixe=YM(Z.WGS84);YM(Z.WebMercator);const Hj=96,Wj=39.37,Une=180/Math.PI;function Zj(t){return t.wkid?t:t.spatialReference||Z.WGS84}function KM(t,e){return e.type?ir(t,e.x,e.y):Ed(t,e)}function Jj(t){return Bi(t)}function ib(t,e,r=0){let i=t.width,s=t.height;if(r!==0){const l=ny(r),u=Math.abs(Math.cos(l)),d=Math.abs(Math.sin(l));i=t.width*u+t.height*d,s=t.width*d+t.height*u}const n=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(i/n,s/o)*Yne(t.spatialReference)}async function df(t,e,r,i){let s,n;if(!t||Array.isArray(t)&&!t.length)return null;if(H.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const l=t.every(p=>"attributes"in p),u=t.some(p=>!p.geometry);let d=t;if(l&&u&&e&&e.allLayerViews){const p=new Map;for(const g of t){const v=g.layer,_=p.get(v)||[],S=g.attributes[v.objectIdField];S!=null&&_.push(S),p.set(v,_)}const f=[];p.forEach((g,v)=>{const _=e.allLayerViews?.find(S=>S.layer.id===v.id);if(_&&"queryFeatures"in _){const S=v.createQuery();S.objectIds=g,S.returnGeometry=!0,f.push(_.queryFeatures(S))}});const m=await Promise.all(f),y=[];for(const g of m)if(g&&g.features&&g.features.length)for(const v of g.features)v.geometry!=null&&y.push(v.geometry);d=y}for(const p of d)i=await df(p,e,r,i);return i}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")s=new ee(t);else if(t instanceof Ut)s=t;else if("geometry"in t){if(t.geometry)s=t.geometry;else if(t.layer){const l=t.layer,u=e.allLayerViews?.find(d=>d.layer.id===l.id);if(u&&"queryFeatures"in u){const d=l.createQuery();d.objectIds=[t.attributes[l.objectIdField]],d.returnGeometry=!0,s=(await u.queryFeatures(d))?.features?.[0]?.geometry}}}if(s==null)return null;switch(s.type){case"point":n=new he({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":n=zne(s);break;default:n=s.extent}if(!n)return null;qo()||nn(n.spatialReference,r)||await el();const o=ll(n,r);if(!o)return null;if(i){const l=o.center,u=l.clone();u.x=JM(l.x,i.center.x,r),u.x!==l.x&&o.centerAt(u),i=i.union(o)}else i=o;return i}function qne(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer?.minScale!=null&&t.layer.maxScale!=null){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every(e=>"layer"in e)){let e=0,r=0;for(const i of t){const s=i.layer;s?.minScale&&s.maxScale&&(e=s.minScale<e?s.minScale:e,r=s.maxScale>r?s.maxScale:r)}return e&&r?{min:e,max:r}:null}}}function wk(t,e){const r=Zj(t);return Ht(r,e)||r.imageCoordinateSystem||e.imageCoordinateSystem?t:ll(t,e)}async function Gne(t,e){if(!t||!e)return new ps({targetGeometry:new ee,scale:0,rotation:0});let r=e.spatialReference;const{constraints:i,padding:s,viewpoint:n,size:o}=e,l=[s?o[0]-s.left-s.right:o[0],s?o[1]-s.top-s.bottom:o[1]];let u=null;t instanceof ps?u=t:t.viewpoint?u=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(u=t.target);let d=null;u?.targetGeometry?d=u.targetGeometry:t instanceof he?d=t:t instanceof Ut?d=await df(t,e,r):t&&(d=await df(t.center,e,r)||await df(t.target,e,r)||await df(t,e,r)),!d&&n?.targetGeometry?d=n.targetGeometry:!d&&e.extent&&(d=e.extent),r||(r=Zj(e.spatialReference||e.extent||d)),qo()||Ht(d.spatialReference,r)||nn(d.spatialReference,r)||await el();const p=wk(d,r),f="center"in p?p.center:p;e.pickClosestTarget!==!1&&f.type==="point"&&n.targetGeometry?.type==="point"&&(f.x=JM(f.x,n.targetGeometry.x,f.spatialReference));let m=0;u?m=u.rotation:t.hasOwnProperty("rotation")?m=t.rotation:n&&(m=n.rotation);let y=0;y=u?.targetGeometry!=null&&u.targetGeometry.type==="point"?u.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&i&&i.effectiveLODs?i.zoomToScale(t.zoom):Array.isArray(d)||d.type==="point"||d.type==="extent"&&d.width===0&&d.height===0?n.scale:ib(wk(d.extent,r),l,m);const g=qne(t.target??t);g&&(g.min&&g.min<y?y=g.min:g.max&&g.max>y&&(y=g.max));let v=new ps({targetGeometry:f,scale:y,rotation:m});return i&&(v=i.fit(v),i.constrainByGeometry(v),i.rotationEnabled||(v.rotation=n.rotation)),v}function kr(t,e){const r=t.targetGeometry,i=e.targetGeometry;return r.x=i.x,r.y=i.y,r.spatialReference=i.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function Bne(t,e,r){return r?ir(t,.5*(e[0]-r.right+r.left),.5*(e[1]-r.bottom+r.top)):oy(t,e,.5)}const Hne=(function(){const t=lt();return function(e,r,i){const s=r.targetGeometry;KM(t,s);const n=.5*ip(r);return e.xmin=t[0]-n*i[0],e.ymin=t[1]-n*i[1],e.xmax=t[0]+n*i[0],e.ymax=t[1]+n*i[1],e.spatialReference=s.spatialReference,e}})();function Wne(t,e,r,i,s){return d$(t,e,r.center),t.scale=ib(r,i),s?.constraints?.constrain(t),t}function Zne(t,e,r,i){return e3(t,e,r,i),BM(t,t)}const Yj=(function(){const t=lt();return function(e,r,i){return hM(e,Kne(e,r),Bne(t,r,i))}})(),Jne=(function(){const t=Ln(),e=lt();return function(r,i,s,n){const o=ip(i),l=QM(i);return ir(e,o,o),zj(t,e),vy(t,t,l),Ah(t,t,Yj(e,s,n)),Ah(t,t,[0,n.top-n.bottom]),ir(r,t[4],t[5])}})();function ip(t){return t.scale*Kj(t.targetGeometry?.spatialReference)}function Kj(t){return Fi(t)?1/(Jj(t)*Wj*Hj):1}function QM(t){return dM(t.rotation)||0}function Yne(t){return Fi(t)?Jj(t)*Wj*Hj:1}function Kne(t,e){return oy(t,e,.5)}const XM=(function(){const t=lt(),e=lt(),r=lt();return function(i,s,n,o,l,u){return nN(t,s),oy(e,n,.5*u),ir(r,1/o*u,-1/o*u),HM(i,e),l&&vy(i,i,l),rb(i,i,r),Ah(i,i,t),i}})(),e3=(function(){const t=lt();return function(e,r,i,s){const n=ip(r),o=QM(r);return KM(t,r.targetGeometry),XM(e,t,i,n,o,s)}})(),Qne=(function(){const t=lt();return function(e,r,i,s){const n=ip(r);return KM(t,r.targetGeometry),XM(e,t,i,n,0,s)}})();function Qj(t){const e=Yr(t);return e?e.valid[1]-e.valid[0]:0}function Xne(t,e){return Math.round(Qj(t)/e)}const eoe=(function(){const t=lt(),e=lt(),r=[0,0,0];return function(i,s,n){Sm(t,i,s),yS(t,t),Sm(e,i,n),yS(e,e),aN(r,t,e);let o=Math.acos(oN(t,e)/(Cv(t)*Cv(e)))*Une;return r[2]<0&&(o=-o),isNaN(o)&&(o=0),o}})(),toe=(function(){const t=lt();return function(e,r,i,s){const n=e.targetGeometry;return kr(e,r),Jne(t,r,i,s),n.x+=t[0],n.y+=t[1],e}})(),d$=function(t,e,r){kr(t,e);const i=t.targetGeometry;return i.x=r.x,i.y=r.y,i.spatialReference=r.spatialReference,t},roe=(function(){const t=lt();return function(e,r,i,s,n){n||(n="center"),hM(t,i,s),oy(t,t,.5);const o=t[0],l=t[1];switch(n){case"center":ir(t,0,0);break;case"left":ir(t,-o,0);break;case"top":ir(t,0,l);break;case"right":ir(t,o,0);break;case"bottom":ir(t,0,-l);break;case"top-left":ir(t,-o,l);break;case"bottom-left":ir(t,-o,-l);break;case"top-right":ir(t,o,l);break;case"bottom-right":ir(t,o,-l)}return sb(e,r,t),e}})();function Exe(t,e,r){return kr(t,e),t.rotation+=r,t}function ioe(t,e,r){return kr(t,e),t.rotation=r,t}const soe=(function(){const t=lt();return function(e,r,i,s,n){return kr(e,r),isNaN(i)||i===0||(e6(t,s,r,n),e.scale=r.scale*i,t6(t,t,e,n),sb(e,e,ir(t,t[0]-s[0],s[1]-t[1]))),e}})();function bk(t,e,r){return kr(t,e),t.scale=r,t}const Xj=(function(){const t=lt();return function(e,r,i,s,n,o){return kr(e,r),isNaN(i)||i===0||(e6(t,n,r,o),e.scale=r.scale*i,e.rotation+=s,t6(t,t,e,o),sb(e,e,ir(t,t[0]-n[0],n[1]-t[1]))),e}})(),Oxe=(function(){const t=lt(),e=lt();return function(r,i,s,n,o,l,u){return Yj(e,l,u),tN(t,o,e),n?Xj(r,i,s,n,t,l):soe(r,i,s,t,l)}})(),e6=(function(){const t=Ln();return function(e,r,i,s){return In(e,r,Zne(t,i,s,1))}})(),t6=(function(){const t=Ln();return function(e,r,i,s){return In(e,r,e3(t,i,s,1))}})(),sb=(function(){const t=lt(),e=Ln();return function(r,i,s){kr(r,i);const n=ip(i),o=r.targetGeometry;return Vj(e,QM(i)),rb(e,e,gy(n,n)),In(t,s,e),o.x+=t[0],o.y+=t[1],r}})();function r6(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function noe(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function ooe(t,e,r,i,s,n){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o[4]=s,o[5]=n,o}function i6(t,e,r,i){const s=e[i],n=e[i+1];t[i]=r[0]*s+r[2]*n+r[4],t[i+1]=r[1]*s+r[3]*n+r[5]}function aoe(t,e,r,i=0,s=0,n=2){const o=s||e.length/n;for(let l=i;l<o;l++)i6(t,e,r,l*n)}Object.freeze(Object.defineProperty({__proto__:null,clone:noe,create:r6,fromValues:ooe,transform:i6,transformMany:aoe},Symbol.toStringTag,{value:"Module"}));function $0(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function loe(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function uoe(t,e,r,i,s,n,o,l,u){const d=new Float32Array(9);return d[0]=t,d[1]=e,d[2]=r,d[3]=i,d[4]=s,d[5]=n,d[6]=o,d[7]=l,d[8]=u,d}Object.freeze(Object.defineProperty({__proto__:null,clone:loe,create:$0,fromValues:uoe},Symbol.toStringTag,{value:"Module"}));function s6(){return new Float32Array(2)}function coe(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function Rh(t,e){const r=new Float32Array(2);return r[0]=t,r[1]=e,r}function n6(){return s6()}function o6(){return Rh(1,1)}function a6(){return Rh(1,0)}function l6(){return Rh(0,1)}const doe=n6(),hoe=o6(),poe=a6(),foe=l6();Object.freeze(Object.defineProperty({__proto__:null,ONES:hoe,UNIT_X:poe,UNIT_Y:foe,ZEROS:doe,clone:coe,create:s6,fromValues:Rh,ones:o6,unitX:a6,unitY:l6,zeros:n6},Symbol.toStringTag,{value:"Module"}));function moe(t){return t instanceof Float32Array&&t.length>=2}function yoe(t){return Array.isArray(t)&&t.length>=2}function x1(t){return moe(t)||yoe(t)}var h$;const Gn=[0,0];let so=h$=class extends F{constructor(t){super(t),this._viewpoint2D={center:lt(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new he,this.id=0,this.inverseTransform=Ln(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=Ln(),this.transformNoRotation=Ln(),this.displayMat3=$0(),this.displayViewMat3=$0(),this.viewMat3=$0(),this.viewMat2d=r6(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,r=t.targetGeometry;e.center[0]=r.x,e.center[1]=r.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=r.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,r=this.viewpoint;return r&&e?(this.viewpoint=kr(r,t.viewpoint),this._set("size",Ed(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new h$({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,r){return x1(e)?In(t,e,this.inverseTransform):(Gn[0]=e,Gn[1]=r,In(t,Gn,this.inverseTransform))}toScreen(t,e,r){return x1(e)?In(t,e,this.transform):(Gn[0]=e,Gn[1]=r,In(t,Gn,this.transform))}toScreenNoRotation(t,e,r){return x1(e)?In(t,e,this.transformNoRotation):(Gn[0]=e,Gn[1]=r,In(t,Gn,this.transformNoRotation))}wrapMapCoordinate(t,e){Ed(t,e);const[r]=e,[i]=this.center,{extent:s,spatialReference:n}=this;let{xmin:o,xmax:l}=s;if(n.isWrappable){const u=Qj(n)/2;o=Math.max(o,i-u),l=Math.min(l,i+u)}return(r<o||r>l)&&(t[0]=JM(r,i,n)),t}getScreenTransform(t,e){const{center:r}=this._viewpoint2D,i=this._get("pixelRatio")||1,s=this._get("size");return XM(t,r,s,e,0,i),t}_update(){const{center:t,spatialReference:e,scale:r,rotation:i}=this._viewpoint2D,s=this._get("pixelRatio")||1,n=this._get("size"),o=new ps({targetGeometry:new ee(t[0],t[1],e),scale:r,rotation:i});if(this._set("viewpoint",o),!n||!e||!r)return;this.resolution=ip(o),this.rotation=i,this.scale=r,this.spatialReference=e,Ed(this.center,t);const l=n[0]!==0?2/n[0]:0,u=n[1]!==0?-2/n[1]:0;Od(this.displayMat3,l,0,0,0,u,0,-1,1,1);const d=pN(this.viewMat3),p=Rh(n[0]/2,n[1]/2),f=Rh(-n[0]/2,-n[1]/2),m=dM(i);vS(d,d,p),yN(d,d,m),vS(d,d,f),xm(this.displayViewMat3,this.displayMat3,d);const y=HM(this.viewMat2d,p);return vy(y,y,m),Ah(y,y,f),Hne(this.extent,o,n),e3(this.transform,o,n,s),BM(this.inverseTransform,this.transform),Qne(this.transformNoRotation,o,n,s),this.worldScreenWidth=Xne(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};a([c({readOnly:!0})],so.prototype,"id",void 0),a([c({value:1,json:{write:!0}})],so.prototype,"pixelRatio",null),a([c({json:{write:!0}})],so.prototype,"size",null),a([c()],so.prototype,"spatialReference",void 0),a([c({type:ps,json:{write:!0}})],so.prototype,"viewpoint",null),a([c({readOnly:!0})],so.prototype,"visibleArea",null),so=h$=a([b("esri.views.2d.ViewState")],so);const _k=so;var p$,f$;let Io=p$=class extends X{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new p$({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};a([c()],Io.prototype,"left",void 0),a([c()],Io.prototype,"top",void 0),a([c()],Io.prototype,"right",void 0),a([c()],Io.prototype,"bottom",void 0),Io=p$=a([b("esri.views.2d.PaddedViewState.Padding")],Io);let Rc=f$=class extends _k{constructor(...t){super(...t),this.paddedViewState=new _k,this._updateContent=(()=>{const e=lt();return()=>{const r=this._get("size"),i=this._get("padding");if(!r||!i)return;const s=this.paddedViewState;ir(e,i.left+i.right,i.top+i.bottom),Sm(e,r,e),Ed(s.size,e);const n=s.viewpoint;n&&(this.viewpoint=n)}})(),this.addHandles(ne(()=>[this.size,this.padding],()=>this._updateContent(),jn)),this.padding=new Io,this.size=[0,0]}set padding(t){this._set("padding",t||new Io)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const r=this._get("padding");r&&(e=toe(t.clone(),t,this._get("size"),r));const{targetGeometry:i,rotation:s,scale:n}=e,{x:o,y:l,spatialReference:u}=i,d=this._viewpoint2D;d.center[0]=o,d.center[1]=l,d.rotation=s,d.scale=n,d.spatialReference=u,this._update()}}clone(){return new f$({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};a([c()],Rc.prototype,"paddedViewState",void 0),a([c({type:Io})],Rc.prototype,"padding",null),a([c()],Rc.prototype,"viewpoint",null),Rc=f$=a([b("esri.views.2d.PaddedViewState")],Rc);const t3=Rc;let hf=class extends X{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};a([c()],hf.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),a([c()],hf.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),hf=a([b("esri.views.support.debugFlags")],hf);const goe=new hf,u6=Symbol("Yield");let voe=class{constructor(){this._tasks=new Array,this._numPendingTasks=kh(0),this._readyToRun=kh(!1)}get length(){return this._tasks.length}get updating(){return this._numPendingTasks.value>0}get readyToRun(){return this._readyToRun.value}_updateReadyToRun(){this._readyToRun.value=this._tasks.length>0}destroy(){this.cancelAll()}runTask(e){if(this.length===0)return u6;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,r,i){return this._addTask((s,n)=>new $k(s,n,e,r,i),Array.prototype.push)}unshift(e,r,i){return this._addTask((s,n)=>new $k(s,n,e,r,i),Array.prototype.unshift)}pushGenerator(e,r,i){return this._addTask((s,n)=>new woe(s,n,e,r,i),Array.prototype.push)}_process(e){if(this._tasks.length===0)return!1;const r=this._tasks.shift();this._updateReadyToRun();try{if(Cr(r.signal))this._cancelTask(r,Fe());else switch(r.type){case 0:this._processSimple(r,e);break;case 1:this._processGenerator(r,e);break;case 2:this._processIterator(r,e);break;default:}}catch(i){r.reject(i)}return!0}cancelAll(){const e=Fe();for(const r of this._tasks)this._cancelTask(r,e);this._tasks.length=0,this._updateReadyToRun()}_cancelTask(e,r){if(e.abortCallback){const i=e.abortCallback(r);e.type===2&&e.iterator.return&&Sk(e.iterator.return()),Pr(i)?i.then(e.resolve,e.reject):e.resolve(i)}else e.type===2&&e.iterator.throw&&Sk(e.iterator.throw(r)),e.reject(r)}_onIteratorResult(e,r){r.done?e.resolve(r.value):(this._tasks.unshift(e),this._updateReadyToRun())}_processSimple(e,r){const i=e.callback(r);Pr(i)?i.then(e.resolve,e.reject):e.resolve(i)}_processGenerator(e,r){const i=e.generatorFunction(r),s=new boe(e.resolve,e.reject,i,e.signal,e.abortCallback);this._processIterator(s,r)}_processIterator(e,r){const i=e.iterator.next(r);Pr(i)?i.then(s=>this._onIteratorResult(e,s),e.reject):this._onIteratorResult(e,i)}_addTask(e,r){return new Promise((i,s)=>{const n=e(i,s);r.call(this._tasks,n),++this._numPendingTasks.value,this._updateReadyToRun()}).finally(()=>--this._numPendingTasks.value)}};function Sk(t){Pr(t)?t.then(T1,T1):T1(t)}function T1(t){sr(t)||t instanceof Error||t instanceof x||t!=null&&typeof t=="object"&&"done"in t&&t.done||L.getLogger("esri.layers.support.PromiseQueue").warn("Generator iterator was aborted, but it is not done.")}let r3=class{constructor(e,r,i=void 0,s=void 0){this.resolve=e,this.reject=r,this.signal=i,this.abortCallback=s}},$k=class extends r3{constructor(e,r,i,s,n){super(e,r,s,n),this.callback=i,this.type=0}},woe=class extends r3{constructor(e,r,i,s,n){super(e,r,s,n),this.generatorFunction=i,this.type=1}},boe=class extends r3{constructor(e,r,i,s,n){super(e,r,s,n),this.iterator=i,this.type=2}};function _oe(){return new Moe}const ge={RESOURCE_CONTROLLER_IMMEDIATE:"immediate",RESOURCE_CONTROLLER:"schedule",SLIDE:"slide",STREAM_DATA_LOADER:"stream loader",ELEVATION_QUERY:"elevation query",TERRAIN_SURFACE:"terrain",SURFACE_GEOMETRY_UPDATES:"surface geometry updates",LOD_RENDERER:"LoD renderer",GRAPHICS_CORE:"Graphics3D",I3S_CONTROLLER:"I3S",POINT_CLOUD_LAYER:"point cloud",FEATURE_TILE_FETCHER:"feature fetcher",STREAM_CONTROLLER:"stream controller",OVERLAY:"overlay",OVERLAY_RENDERER:"overlay renderer",STAGE:"stage",GRAPHICS_DECONFLICTOR:"graphics deconflictor",FILTER_VISIBILITY:"Graphics3D filter visibility",SCALE_VISIBILITY:"Graphics3D scale visibility",FRUSTUM_VISIBILITY:"Graphics3D frustum visibility",POINT_OF_INTEREST_FREQUENT:"POI frequent",POINT_OF_INTEREST_INFREQUENT:"POI infrequent",LABELER:"labeler",FEATURE_QUERY_ENGINE:"feature query",FEATURE_TILE_TREE:"feature tile tree",FEATURE_TILE_TREE_ACTIVE:"fast feature tile tree",ELEVATION_ALIGNMENT:"elevation alignment",ELEVATION_ALIGNMENT_SCENE:"elevation alignment scene",TEXT_TEXTURE_ATLAS:"text texture atlas",TEXTURE_UNLOAD:"texture unload",LINE_OF_SIGHT_TOOL:"line of sight tool",LINE_OF_SIGHT_TOOL_INTERACTIVE:"interactive line of sight tool",ELEVATION_PROFILE:"elevation profile",SNAPPING:"snapping",SHADOW_ACCUMULATOR:"shadow accumulator",CLOUDS_GENERATOR:"clouds generator",FLOW_GENERATOR:"flow generator",MAPVIEW_FETCH_QUEUE:"mapview fetch queue",MAPVIEW_LAYERVIEW_UPDATE:"mapview layerview update",MAPVIEW_VECTOR_TILE_PARSING_QUEUE:"mapview vector tile parsing queue",NONE:0,TEST_PRIO:1},ts=0,xk=new Map([[ge.RESOURCE_CONTROLLER_IMMEDIATE,ts],[ge.RESOURCE_CONTROLLER,4],[ge.SLIDE,ts],[ge.STREAM_DATA_LOADER,ts],[ge.ELEVATION_QUERY,ts],[ge.TERRAIN_SURFACE,1],[ge.SURFACE_GEOMETRY_UPDATES,1],[ge.LOD_RENDERER,2],[ge.GRAPHICS_CORE,2],[ge.I3S_CONTROLLER,2],[ge.POINT_CLOUD_LAYER,2],[ge.FEATURE_TILE_FETCHER,2],[ge.STREAM_CONTROLLER,2],[ge.CLOUDS_GENERATOR,2],[ge.OVERLAY,4],[ge.OVERLAY_RENDERER,4],[ge.STAGE,4],[ge.GRAPHICS_DECONFLICTOR,4],[ge.FILTER_VISIBILITY,4],[ge.SCALE_VISIBILITY,4],[ge.FRUSTUM_VISIBILITY,4],[ge.POINT_OF_INTEREST_FREQUENT,6],[ge.POINT_OF_INTEREST_INFREQUENT,30],[ge.LABELER,8],[ge.FEATURE_QUERY_ENGINE,8],[ge.FEATURE_TILE_TREE,16],[ge.FEATURE_TILE_TREE_ACTIVE,ts],[ge.ELEVATION_ALIGNMENT,12],[ge.ELEVATION_ALIGNMENT_SCENE,14],[ge.TEXT_TEXTURE_ATLAS,12],[ge.TEXTURE_UNLOAD,12],[ge.LINE_OF_SIGHT_TOOL,16],[ge.LINE_OF_SIGHT_TOOL_INTERACTIVE,ts],[ge.SNAPPING,ts],[ge.SHADOW_ACCUMULATOR,30],[ge.FLOW_GENERATOR,12],[ge.MAPVIEW_FETCH_QUEUE,ts],[ge.MAPVIEW_LAYERVIEW_UPDATE,2],[ge.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,ts]]);function Tk(t){return xk.has(t)?xk.get(t):typeof t=="number"?t:1}const Soe=6.5,Mk=1,$oe=30,xoe=1e3/30,Toe=100,Ik=.9;let Moe=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(e=>e.needsUpdate)}constructor(){this._updating=kh(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new Lf("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new c6,this.state=1,this._tasks=new Array,this._runQueue=new Array,this._load=0,this._forceTask=!1,this._debug=!1,this._debugHandle=ne(()=>goe.SCHEDULER_LOG_SLOW_TASKS,e=>this._debug=e,Et);for(const e of Object.keys(ge))this.performanceInfo.tasks.set(ge[e],new Lf(String(ge[e])))}destroy(){this._tasks.forEach(e=>e.remove()),this._tasks.length=0,this._runQueue.length=0,He(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())}))}registerTask(e,r){const i=new Ioe(this,e,r);return this._tasks.push(i),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new Lf(e)),i}get load(){return this._load}frame(e){if(this._startFrameTaskTimes(),this._updateBudget(e)){const r=this._budget.now();return this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-r),!0}return this._recordFrameTaskTimes(0),!1}_updateBudget(e){this._test&&(this._test.usedBudget=0),++this._frameNumber;let r=Soe,i=e.frameDuration,s=Mk;switch(this.state){case 2:r=0,i=Math.max(Toe,e.frameDuration),s=$oe;break;case 1:i=Math.max(xoe,e.frameDuration)}return i=i-e.elapsedFrameTime-r,this.state!==2&&i<Mk&&!this._forceTask?(this._forceTask=!0,!1):(i=Math.max(i,s),this._budget.reset(i),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case 2:this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(0),this._budget.madeProgress()}removeTask(e){h_(this._tasks,e),h_(this._runQueue,e),this._updatingChanged()}_updateTask(e){this._tasks.forEach(r=>{r.name===e&&r.setPriority(e)})}_getState(e){if(this._runQueue.some(i=>i.name===e))return"s";let r="i";return this._tasks.forEach(i=>{i.name===e&&i.needsUpdate&&(i.schedulePriority<=1?r="r":r!=="r"&&(r="w"))}),r}_getRuntime(e){let r=0;return this._tasks.forEach(i=>{i.name===e&&(r+=i.runtime)}),r}_resetRuntimes(){this._tasks.forEach(e=>e.runtime=0)}_getRunning(){const e=new Map;if(this._tasks.forEach(i=>{i.needsUpdate&&e.set(i.name,(e.get(i.name)||0)+1)}),e.size===0)return null;let r="";return e.forEach((i,s)=>{r+=i>1?` ${i}x ${s}`:` ${s}`}),r}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce((r,i)=>i.needsUpdate?++r:r,0);this._load=this._load*Ik+e*(1-Ik)}_schedule(){for(uU(this._runQueue,e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1)),this._tasks.forEach(e=>{e.basePriority===ts&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)});this._runQueue.length===0;){let e=!1,r=0;if(this._tasks.forEach(i=>{i.needsUpdate&&i.schedulePriority!==0&&i.basePriority!==ts&&i.blockFrame!==this._frameNumber&&(e=!0,r=Math.max(r,i.basePriority),i.schedulePriority===1?(i.schedulePriority=0,this._runQueue.push(i)):--i.schedulePriority)}),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do for(;this._runQueue.length>0;){const e=this._budget.now(),r=this._runQueue.pop();this._budget.resetProgress();try{r.task.runTask(this._budget)===u6&&(r.blockFrame=this._frameNumber)}catch(s){L.getLogger("esri.views.support.Scheduler").error(`Exception in task "${r.name}"`,s),r.blockFrame=this._frameNumber}!this._budget.hasProgressed&&r.blockFrame!==this._frameNumber&&r.needsUpdate&&(r.name,r.blockFrame=this._frameNumber),r.schedulePriority=r.basePriority;const i=this._budget.now()-e;if(r.runtime+=i,this._frameTaskTimes.set(r.priority,this._frameTaskTimes.get(r.priority)+i),this._budget.remaining<=0)return void this._updatingChanged()}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const e of Object.keys(ge))this._frameTaskTimes.set(ge[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach((r,i)=>this.performanceInfo.tasks.get(i).push(r)),this.performanceInfo.total.push(e)}get test(){return this._test}},Ioe=class{get task(){return this._task.value}get readyToRun(){return this._queue.readyToRun}get updating(){return this._queue.updating}constructor(e,r,i){this._scheduler=e,this.name=r,this.blockFrame=0,this.runtime=0,this._queue=new voe,this._handles=new qh,this._basePriority=Tk(r),this.schedulePriority=this._basePriority,this._task=kh(i??this._queue),this._handles.add(qi(()=>this.task.readyToRun,s=>e.taskRunningChanged(s)))}remove(){this.processQueue(sm),this._scheduler.removeTask(this),this.schedule=M1.schedule,this.reschedule=M1.reschedule,this.scheduleGenerator=M1.scheduleGenerator,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const r=Tk(e);this._basePriority!==ts&&this.schedulePriority===0||(this.schedulePriority=r),this._basePriority=r}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.readyToRun||!this.task.destroyed&&this.task.readyToRun}schedule(e,r,i){return this._queue.push(e,r,i)}reschedule(e,r,i){return this._queue.unshift(e,r,i)}scheduleGenerator(e,r,i){return this._queue.pushGenerator(e,r,i)}processQueue(e){return this._queue.runTask(e)}},c6=class{constructor(){this._begin=performance?.now()??0,this._budget=0,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(e()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e){this._begin=this.now(),this._budget=e,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}};const sm=new c6;sm.enabled=!1;let Eoe=class{remove(){}processQueue(){}schedule(e,r,i){try{if(Cr(r)){const s=Fe();return i?Promise.resolve(i(s)):Promise.reject(s)}return v_(e(sm))}catch(s){return Promise.reject(s)}}reschedule(e,r,i){return this.schedule(e,r,i)}async scheduleGenerator(e,r,i){if(Cr(r)){const n=Fe();if(i)return i(n);throw n}const s=e(sm);for(;;){const n=s.next(sm),o=Pr(n)?await n:n;if(Cr(r)){const l=Fe();if(i){const d=i(l),p=s.return(null);return Pr(p)&&await yh(p),d}const u=s.throw(l);throw Pr(u)&&await yh(u),l}if(o.done)return o.value}}};const M1=new Eoe;let Ooe=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=_oe(),this._schedulerHandle=qi(()=>this._scheduler.updating,()=>this.requestFrame()),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),this.view.animation?.target==null||Pr(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=r=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:i,graphicsView:s,labelManager:n,state:{id:o}}=this.view;i?.forEach(this._updateLayerView,this),n!=null&&(n.lastUpdateId!==o&&(n.viewChange(),n.lastUpdateId=o),n.updateRequested&&n.processUpdate(this._updateParameters)),s!=null&&(s.lastUpdateId!==o&&(s.viewChange(),s.lastUpdateId=o),s.updateRequested&&s.processUpdate(this._updateParameters)),this.view.graphicsTileStore?.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=0:this.view.interacting?this._scheduler.state=1:this._scheduler.state=2,this._scheduler.frame(r)||this._updateRequested||this._scheduler.state!==2||this._frameTaskHandle?.pause()}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new t3,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=ne(()=>e.stationary,r=>{this.stationary=r,this.requestFrame()}),this._frameTaskHandle=vh(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){if(!e.attached)return void this.requestUpdate();const r=this.view.state,i=e.lastUpdateId;i!=null&&(this.stationary||e.moving)||(e.moving=!0),i!==r.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=r.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews?.forEach(this._updateLayerView,this)}};function koe(t,e){const{spatialReference:r}=e,i=[e.x,e.y];let s,n,o,l;const u=[0,0],d=Coe(t);for(let m=0;m<d.length;m++){const y=d[m];for(let g=0;g<y.length-1;g++){jJ(u,i,y,g);const v=zw(i,u);(s==null||v<s)&&(s=v,n=[...u],o=m,l=g)}}if(s==null||!n||o==null||l==null)throw new x("nearest-coordinate:failed","Failed to find the nearest coordinate");const[p,f]=n;return{coordinate:new ee({x:p,y:f,spatialReference:r}),distance:s}}function Coe(t){switch(t.type){case"extent":return[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]];case"polygon":return t.rings;case"polyline":return t.paths}}var m$;let Kl=m$=class extends rM(X){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return ll(this.geometry,this.spatialReference)}catch(t){return L.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const r=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?ty(this.normalizedGeometry,r):VT(this.normalizedGeometry,r))return t;const{coordinate:i}=koe(this.normalizedGeometry,r);return i&&(t.targetGeometry=i),t}clone(){return new m$({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};a([c({constructOnly:!0})],Kl.prototype,"geometry",void 0),a([c({readOnly:!0})],Kl.prototype,"normalizedGeometry",null),a([c({constructOnly:!0})],Kl.prototype,"spatialReference",void 0),Kl=m$=a([b("esri.views.2d.constraints.GeometryConstraint")],Kl);var y$;let pf=y$=class extends rM(X){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new y$({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};a([c()],pf.prototype,"enabled",void 0),a([c()],pf.prototype,"rotationEnabled",void 0),pf=y$=a([b("esri.views.2d.constraints.RotationConstraint")],pf);const d6=pf;var g$;let ri=g$=class extends rM(X){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:r,maxScale:i,minZoom:s,maxZoom:n}=this,o=-1,l=-1,u=!1,d=!1;if(r!==0&&i!==0&&r<i&&([r,i]=[i,r]),!e?.length)return this._set("effectiveMinScale",r),void this._set("effectiveMaxScale",i);e=e.map(p=>p.clone()),e.sort((p,f)=>f.scale-p.scale),e.forEach((p,f)=>p.level=f);for(const p of e)!u&&r>0&&r>=p.scale&&(o=p.level,u=!0),!d&&i>0&&i>=p.scale&&(l=t?t.level:-1,d=!0),t=p;s===-1&&(s=r===0?0:o),n===-1&&(n=i===0?e.length-1:l),s=Math.max(s,0),s=Math.min(s,e.length-1),n=Math.max(n,0),n=Math.min(n,e.length-1),s>n&&([s,n]=[n,s]),r=e[s].scale,i=e[n].scale,e.splice(0,s),e.splice(n-s+1),e.forEach((p,f)=>{this._lodByScale[p.scale]=p,this._scales[f]=p.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",s),this._set("effectiveMaxZoom",n),this._set("effectiveMinScale",r),this._set("effectiveMaxScale",i)}constrain(t,e){if(e&&t.scale===e.scale)return t;const r=this.effectiveMinScale,i=this.effectiveMaxScale,s=t.targetGeometry,n=e&&e.targetGeometry,o=i!==0&&t.scale<i,l=r!==0&&t.scale>r;if(o||l){const u=l?r:i;if(e&&n){const d=(u-e.scale)/(t.scale-e.scale);s.x=n.x+(s.x-n.x)*d,s.y=n.y+(s.y-n.y)*d}t.scale=u}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),r=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(r>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const r=Math.floor(t),i=Math.ceil(t);return e[r]+(t-r)*(e[i]-e[r])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let r,i;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let s=0;s<e.length-1;s++){if(r=e[s],i=e[s+1],i===t)return s+this.effectiveMinZoom+1;if(r>t&&i<t)return s+this.effectiveMinZoom+1-(t-i)/(r-i)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const r=Math.round(this.scaleToZoom(t));return this.zoomToScale(r+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const r=Math.round(this.scaleToZoom(t));return this.zoomToScale(r-1)}clone(){return new g$({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,r)=>Math.abs(r-t)<=Math.abs(e-t)?r:e,this._scales[0])),this._lodByScale[t].scale}};a([c({readOnly:!0})],ri.prototype,"effectiveLODs",void 0),a([c({readOnly:!0})],ri.prototype,"effectiveMinZoom",void 0),a([c({readOnly:!0})],ri.prototype,"effectiveMaxZoom",void 0),a([c({readOnly:!0})],ri.prototype,"effectiveMinScale",void 0),a([c({readOnly:!0})],ri.prototype,"effectiveMaxScale",void 0),a([c()],ri.prototype,"lods",void 0),a([c()],ri.prototype,"minZoom",void 0),a([c()],ri.prototype,"maxZoom",void 0),a([c()],ri.prototype,"minScale",void 0),a([c()],ri.prototype,"maxScale",void 0),a([c()],ri.prototype,"snapToZoom",void 0),ri=g$=a([b("esri.views.2d.constraints.ZoomConstraint")],ri);const h6=ri,Poe={base:null,key:"type",typeMap:{extent:he,polygon:Be}};let pt=class extends X{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new H}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const e=this._get("_geometry");return e&&this.geometry===e.geometry&&this.view?.constraintsInfo.spatialReference===e.spatialReference?e:new Kl({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new d6({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),r=this.lods||this.view?.constraintsInfo.lods,i=this.minZoom,s=this.maxZoom,n=this.minScale,o=this.maxScale,l=this.snapToZoom;return e&&e.lods===r&&e.minZoom===i&&e.maxZoom===s&&e.minScale===n&&e.maxScale===o&&e.snapToZoom===l?e:new h6({lods:r,minZoom:i,maxZoom:s,minScale:n,maxScale:o,snapToZoom:l})}canZoomInTo(e){const r=this.effectiveMaxScale;return r===0||e>=r}canZoomOutTo(e){const r=this.effectiveMinScale;return r===0||e<=r}constrain(e,r){return this._zoom.constrain(e,r),this._rotation.constrain(e,r),this._geometry.constrain(e,r),this.customConstraints.forEach(i=>i.constrain(e,r)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(r=>r.applyPanConstraint?.(e)),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};a([c({readOnly:!0})],pt.prototype,"effectiveLODs",null),a([c({readOnly:!0})],pt.prototype,"effectiveMinScale",null),a([c({readOnly:!0})],pt.prototype,"effectiveMaxScale",null),a([c({readOnly:!0})],pt.prototype,"effectiveMinZoom",null),a([c({readOnly:!0})],pt.prototype,"effectiveMaxZoom",null),a([c({types:Poe,value:null})],pt.prototype,"geometry",null),a([c({type:[hr]})],pt.prototype,"lods",void 0),a([c()],pt.prototype,"minScale",void 0),a([c()],pt.prototype,"maxScale",void 0),a([c()],pt.prototype,"minZoom",void 0),a([c()],pt.prototype,"maxZoom",void 0),a([c()],pt.prototype,"rotationEnabled",void 0),a([c()],pt.prototype,"snapToZoom",void 0),a([c({type:H})],pt.prototype,"customConstraints",void 0),a([c()],pt.prototype,"view",void 0),a([c({readOnly:!0})],pt.prototype,"version",null),a([c({type:Kl,readOnly:!0})],pt.prototype,"_geometry",null),a([c({type:d6})],pt.prototype,"_rotation",null),a([c({readOnly:!0,type:h6})],pt.prototype,"_zoom",null),pt=a([b("esri.views.2d.MapViewConstraints")],pt);const Ek=pt;let wr=class extends X{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([ne(()=>this.constraints?.version,r=>{this.constraints&&r&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},jn)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:r}=this.state.paddedViewState;return this.state.commitProperty("id"),new ee({x:e[0],y:e[1],spatialReference:r})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let r;try{r=this._project(e,this.state.spatialReference)}catch(s){return void L.getLogger(this).error(new x("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:s}))}const i=this.viewpoint;d$(i,i,r),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void L.getLogger(this).error(new x("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let r;try{r=this._project(e,this.state.spatialReference)}catch(s){return void L.getLogger(this).error(new x("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:s}))}const i=this.viewpoint;Wne(i,i,r,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const r=this.viewpoint;ioe(r,r,e),this.viewpoint=r}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const i=this._get("extent");return void(i&&(this._set("extent",void 0),this._set("center",i.center)))}const r=this.viewpoint;bk(r,r,e),this.viewpoint=r}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let r,i;try{r=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?i=new x("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(i=new x("mapview:invalid-viewpoint","geometry not defined"))}catch(n){i=new x("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:n})}if(i)return void L.getLogger(this).error(i);this._scaleBeforeChangingSpatialReference=null;const s=new ps({targetGeometry:new ee,scale:0,rotation:0});kr(s,r),this.constraints?.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this._set("viewpoint",s)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(e){if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const s=this._get("extent");return void(s&&(this._set("extent",void 0),this._set("center",s.center)))}const r=this.constraints?.zoomToScale(e)??0;if(!r)return void this._set("zoom",-1);const i=this.viewpoint;bk(i,i,r),this.viewpoint=i,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:r,constraints:i}=this,s=this._get("center"),n=this._get("extent"),o=this._get("scale"),l=this._get("rotation"),u=this._get("viewpoint"),d=this._get("zoom"),p=d!=null&&i!=null&&i.zoomToScale(d)||void 0;let f,m,y;const g=u?.rotation,v=u?.targetGeometry;v?.type==="extent"?f=v:v?.type==="point"&&(m=v,y=u?.scale);const _=n??f;return{center:s??m??_?.center,rotation:l??g,scale:(o??p??y??(_&&ib(_,[e[0]-r.left-r.right,e[1]-r.top-r.bottom])))||void 0}}startup(e,r,i,s){const n=e.targetGeometry;try{this._project(e,i)}catch(o){L.getLogger(this).warn(new Ui("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:n.toJSON(),spatialReference:i,error:o})),e.targetGeometry=s||new ee({x:0,y:0,spatialReference:i})}this.constraints?.fit(e),this._set("state",new t3({padding:this.padding,size:r,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,r],spatialReference:i,rotation:s,scale:n}=this.state.paddedViewState,o=new ee({x:e,y:r,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("state",null)}changeSpatialReference(e){const r=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=r.scale;else{const u=r.viewpoint.clone();u.scale=this._scaleBeforeChangingSpatialReference,r.viewpoint=u}const i=r.clone(),[s,n]=r.center;let o=null;try{o=this._project(new ee({x:s,y:n,spatialReference:r.spatialReference}),e)}catch(u){PL()||L.getLogger(this).warn(new Ui("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o?.toJSON(),spatialReference:e,error:u}))}o||(o=new ee({x:0,y:0,spatialReference:e}));const l=d$(new ps({targetGeometry:new ee,scale:0,rotation:0}),r.viewpoint,o);i.viewpoint=l;try{const d=[r.size[0]/2,r.size[1]/2],p=[d[0]+20,d[1]],f=r.toMap([0,0],p),{x:m,y}=this._project(new ee({x:f[0],y:f[1],spatialReference:r.spatialReference}),e);f[0]=m,f[1]=y,i.toScreen(f,f);const g=eoe(d,f,p),v=Math.hypot(f[0]-d[0],f[1]-d[1])/20;!Number.isFinite(v)||Math.abs(v)>4?(l.rotation=0,l.targetGeometry=new ee({x:0,y:0,spatialReference:e})):(l.scale*=v,l.scale>k("mapview-srswitch-adjust-rotation-scale-threshold")?l.rotation=0:l.rotation+=Number.isFinite(g)?g:0)}catch{}this._get("constraints")?.constrain(l,void 0),this._get("state").viewpoint=l}resize(e,r){if(!this.ready)return;const i=this.state;let s=this.state.paddedViewState.viewpoint;const n=this.state.paddedViewState.size.slice();i.size=[e,r],roe(s,s,n,this.state.paddedViewState.size,this.resizeAlign),s=this.constraints?.constrain(s,void 0)??s,this.state.viewpoint=s}toMap(e){if(!this.ready)return null;const r=[0,0],[i,s]=this.state.toMap(r,[e.x,e.y]),n=this.state.spatialReference;return new ee({x:i,y:s,spatialReference:n})}toScreen(e,r){if(!this.ready)return null;const i=this._project(e,this.state.spatialReference),s=[i.x,i.y];return r?.pickClosestTarget===!1||this.state.paddedViewState.wrapMapCoordinate(s,s),this.state.toScreen(s,s),Gt(s[0],s[1])}_project(e,r){const i=e?.targetGeometry||e;if(!r)return e;if(!i)return null;if(r.imageCoordinateSystem||i.spatialReference?.imageCoordinateSystem||Ht(r,i.spatialReference))return e;const s=ll(i,r);if(!s)throw new x("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:r});return Aoe(e)?(e.targetGeometry=s,e):s}};function Aoe(t){return t?.declaredClass==="esri.Viewpoint"}a([c({type:ee})],wr.prototype,"center",null),a([c()],wr.prototype,"constraints",void 0),a([c({type:he})],wr.prototype,"extent",null),a([c({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],wr.prototype,"padding",null),a([c()],wr.prototype,"ready",void 0),a([c()],wr.prototype,"resizeAlign",void 0),a([c({readOnly:!0})],wr.prototype,"resolution",null),a([c({type:Number})],wr.prototype,"rotation",null),a([c({type:Number})],wr.prototype,"scale",null),a([c({readOnly:!0})],wr.prototype,"state",void 0),a([c({type:ps})],wr.prototype,"viewpoint",null),a([c({readOnly:!0})],wr.prototype,"visibleArea",null),a([c()],wr.prototype,"zoom",null),wr=a([b("esri.views.2d.ViewStateManager")],wr);const Ok=160;let ff=class extends X{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=Ok&&this.clear()},Ok))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};a([c()],ff.prototype,"_timer",void 0),a([c()],ff.prototype,"stationary",null),ff=a([b("esri.views.2d.support.StationaryManager")],ff);const Roe=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.fullOpacity=1,this.stateManager=new wr({constraints:new Ek({view:this})}),this.stationaryManager=new ff,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new Ooe(this),this.viewEvents=new _j(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([ne(()=>this.viewpoint,()=>this.stationaryManager.flip(),jn)])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){return this.stateManager?.extent??null}set extent(i){this.stateManager.extent=i}get state(){return this.stateManager.state}get interacting(){return!1}get stationary(){return!this.animation&&this.stationaryManager.stationary}set animation(i){const s=this._get("animation");if(i===s)return;if(s&&s.stop(),i!==this.animationManager.animation&&this.animationManager.stop(),!i||i.isFulfilled())return void this._set("animation",null);this._set("animation",i);const n=()=>{this.destroyed||i===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};i.when(n,n)}get constraints(){return this.stateManager?.constraints}set constraints(i){i.view=this;const s=this.stateManager.constraints;this.stateManager.constraints=i,s?.destroy()}get padding(){return this.stateManager?.padding}set padding(i){this.stateManager&&(this.stateManager.padding=i)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(i){this.stateManager.resizeAlign=i}get rotation(){return this.stateManager.rotation??0}set rotation(i){const{rotationEnabled:s}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=i,this.constraints.rotationEnabled=s}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(i){this.stateManager.viewpoint=i,this.frameTask.requestFrame()}};return a([c({readOnly:!0})],r.prototype,"animationManager",void 0),a([c({readOnly:!0})],r.prototype,"fullOpacity",void 0),a([c()],r.prototype,"stateManager",void 0),a([c()],r.prototype,"constraintsInfo",null),a([c()],r.prototype,"extent",null),a([c({readOnly:!0})],r.prototype,"state",null),a([c({readOnly:!0})],r.prototype,"mapViewNavigation",void 0),a([c()],r.prototype,"renderingOptions",void 0),a([c({readOnly:!0})],r.prototype,"interacting",null),a([c()],r.prototype,"stationary",null),a([c()],r.prototype,"animation",null),a([c({type:Ek})],r.prototype,"constraints",null),a([c()],r.prototype,"padding",null),a([c()],r.prototype,"resizeAlign",null),a([c()],r.prototype,"rotation",null),a([c({readOnly:!0})],r.prototype,"viewEvents",void 0),a([c({type:ps})],r.prototype,"viewpoint",null),r=a([b("esri.views.Viewport2DBaseMixin")],r),r},Loe=()=>_e.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;var sh;let Lc=(sh=class extends CT{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=wi(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),this._resolver?.reject(new x("view:animation-stopped","ViewAnimation stopped")))}finish(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),this._resolver?.resolve())}update(e,r){r||(r=Pr(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",r)}},sh.state={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"},sh);a([c({readOnly:!0})],Lc.prototype,"done",null),a([c({readOnly:!0,type:String})],Lc.prototype,"state",void 0),a([c()],Lc.prototype,"target",void 0),Lc=a([b("esri.views.ViewAnimation")],Lc);const v$=Lc;let x0=class extends X{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,r){if(!e)return void L.getLogger(this).error("#goTo()","target cannot be null or undefined");const i=new v$;this.view.animation=i,await Rw(()=>this.view.ready,r);const s={...r,animate:r?.animate??(!Loe()&&this.view.animationsEnabled),animationMode:r?.animationMode??"auto"},{extent:n,spatialReference:o,size:l,viewpoint:u,constraints:d,padding:p,allLayerViews:f}=this.view,m=Gne(e,{extent:n,spatialReference:o,size:l,viewpoint:u,constraints:d,padding:p,allLayerViews:f,pickClosestTarget:r?.pickClosestTarget??!0});return i?.update(m),this._gotoTask={},s.animate?this._gotoAnimated(m,s):this._gotoImmediate(m,s)}_gotoImmediate(e,r){const i=this._gotoTask,s=this.view.animation,n=e.then(o=>{if(We(r),i!==this._gotoTask)throw new x("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=s.target=o,s.finish()});return this._cancellableGoTo(i,s,n,r)}_gotoAnimated(e,r){const i=this._gotoTask,s=this.view.animation;if(!s)return Promise.resolve();const n=e.then(o=>{if(We(r),i!==this._gotoTask)throw new x("view:goto-interrupted","Goto was interrupted");return s.update(o),this.view.animationManager.animate(s,this.view.viewpoint,r),s.when().then(()=>{},()=>{})});return this._cancellableGoTo(i,s,n,r)}_cancellableGoTo(e,r,i,s){const n=()=>e===this._gotoTask;return _R(i,s).finally(()=>{n()&&(r.done||r.stop())})}};a([c({constructOnly:!0})],x0.prototype,"view",void 0),x0=a([b("esri.views.2d.GoToManager")],x0);function p6(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}function f6(t,e){return e.some(r=>p6(t,r))}function kk(t,{dragPrimary:e,dragSecondary:r,dragTertiary:i}){return[{key:"primary",value:e},{key:"secondary",value:r},{key:"tertiary",value:i}].filter(s=>s.value===t).map(s=>s.key)}let Ck=class extends Wt{constructor(e,r){super(!0),this._view=e,this.registerIncoming("double-click",r,i=>this._handleDoubleClick(i,r))}_handleDoubleClick(e,r){p6(e.data,"primary")&&(e.stopPropagation(),r?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},Foe=class extends Wt{constructor(e,r,i){super(!0),this.view=e,this.pointerType=r,this.registerIncoming("double-tap-drag",i,s=>this._handleDoubleTapDrag(s))}_handleDoubleTapDrag(e){const{data:r}=e,{pointerType:i}=r;if(i!==this.pointerType)return;e.stopPropagation();const{action:s,delta:n}=r,{view:o}=this,{mapViewNavigation:l}=o;switch(s){case"begin":{const{scale:u}=o;this._startScale=u,this._currentScale=u,this._previousDelta=n,l.begin();break}case"update":{if(this._previousDelta.y===n.y)return;this._previousDelta=n;const u=1.015**n.y,d=this._startScale*u,p=d/this._currentScale;l.setViewpointImmediate(p),this._currentScale=d;break}case"end":{const{constraints:u}=o,{effectiveLODs:d,snapToZoom:p}=u;if(!p||!d)return void l.end();const f=u.snapScale(this._currentScale),m=(n.y>0?Math.max(f,u.snapToPreviousScale(this._startScale)):Math.min(f,u.snapToNextScale(this._startScale)))/this._currentScale;l.zoom(m).then(()=>{l.end()});break}}}},nb=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const r=e.data,i=r.pointers.size;switch(r.action){case"start":this._currentCount=i,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){this._startEvent=e,this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},Noe=class extends Wt{constructor(e,r,i){super(!0),this.view=e,this.pointerActions=r,this.registerIncoming("drag",i,s=>this._handleDrag(s)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new nb({start:(r,i)=>{this.view.mapViewNavigation.pan.begin(this.view,i.data),i.stopPropagation()},update:(r,i)=>{this.view.mapViewNavigation.pan.update(this.view,i.data),i.stopPropagation()},end:(r,i)=>{this.view.mapViewNavigation.pan.end(this.view,i.data),i.stopPropagation()},condition:(r,i)=>r===1&&f6(i.data,this.pointerActions)})}_handleDrag(e){const r=this.view.mapViewNavigation;r.pinch.zoomMomentum||r.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Doe=class extends Wt{constructor(e,r,i){super(!0),this._view=e,this.pointerActions=r;const s=this._view.mapViewNavigation;this._dragEventSeparator=new nb({start:(n,o)=>{s.rotate.begin(this._view,o.data),o.stopPropagation()},update:(n,o)=>{s.rotate.update(this._view,o.data),o.stopPropagation()},end:(n,o)=>{s.rotate.end(),o.stopPropagation()},condition:(n,o)=>n===1&&f6(o.data,this.pointerActions)}),this.registerIncoming("drag",i,n=>this._dragEventSeparator.handle(n))}};function m6(t){const e=t[0],r=t[1],i=t[2];return Math.sqrt(e*e+r*r+i*i)}function joe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Voe(t,e,r,i){return t[0]=e,t[1]=r,t[2]=i,t}function zoe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function y6(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function g6(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function v6(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function Uoe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function qoe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Goe(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function Boe(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function Hoe(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function Woe(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function Zoe(t,e=0,r=1){return t[0]=Math.min(Math.max(t[0],e),r),t[1]=Math.min(Math.max(t[1],e),r),t[2]=Math.min(Math.max(t[2],e),r),t}function Joe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function w6(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function Yoe(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t}function b6(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2];return Math.sqrt(r*r+i*i+s*s)}function _6(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2];return r*r+i*i+s*s}function S6(t){const e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i}function Koe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Qoe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function w$(t,e){const r=e[0],i=e[1],s=e[2];let n=r*r+i*i+s*s;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n),t}function $6(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Xoe(t,e,r){const i=e[0],s=e[1],n=e[2],o=r[0],l=r[1],u=r[2];return t[0]=s*u-n*l,t[1]=n*o-i*u,t[2]=i*l-s*o,t}function eae(t,e,r){const i=e[0],s=e[1],n=e[2],o=r[0],l=r[1],u=r[2],d=s*u-n*l,p=n*o-i*u,f=i*l-s*o,m=Math.sqrt(d*d+p*p+f*f);return t[0]=d/m,t[1]=p/m,t[2]=f/m,t}function tae(t,e,r,i){const s=e[0],n=e[1],o=e[2];return t[0]=s+i*(r[0]-s),t[1]=n+i*(r[1]-n),t[2]=o+i*(r[2]-o),t}function rae(t,e,r,i,s,n){const o=n*n,l=o*(2*n-3)+1,u=o*(n-2)+n,d=o*(n-1),p=o*(3-2*n);return t[0]=e[0]*l+r[0]*u+i[0]*d+s[0]*p,t[1]=e[1]*l+r[1]*u+i[1]*d+s[1]*p,t[2]=e[2]*l+r[2]*u+i[2]*d+s[2]*p,t}function iae(t,e,r,i,s,n){const o=1-n,l=o*o,u=n*n,d=l*o,p=3*n*l,f=3*u*o,m=u*n;return t[0]=e[0]*d+r[0]*p+i[0]*f+s[0]*m,t[1]=e[1]*d+r[1]*p+i[1]*f+s[1]*m,t[2]=e[2]*d+r[2]*p+i[2]*f+s[2]*m,t}function sae(t,e=1){const r=Vw,i=2*r()*Math.PI,s=2*r()-1,n=Math.sqrt(1-s*s)*e;return t[0]=Math.cos(i)*n,t[1]=Math.sin(i)*n,t[2]=s*e,t}function nae(t,e,r){const i=e[0],s=e[1],n=e[2];return t[0]=r[0]*i+r[4]*s+r[8]*n+r[12],t[1]=r[1]*i+r[5]*s+r[9]*n+r[13],t[2]=r[2]*i+r[6]*s+r[10]*n+r[14],t}function oae(t,e,r){const i=e[0],s=e[1],n=e[2];return t[0]=i*r[0]+s*r[3]+n*r[6],t[1]=i*r[1]+s*r[4]+n*r[7],t[2]=i*r[2]+s*r[5]+n*r[8],t}function aae(t,e,r){const i=r[0],s=r[1],n=r[2],o=r[3],l=e[0],u=e[1],d=e[2],p=s*d-n*u,f=n*l-i*d,m=i*u-s*l,y=s*m-n*f,g=n*p-i*m,v=i*f-s*p,_=2*o;return t[0]=l+p*_+2*y,t[1]=u+f*_+2*g,t[2]=d+m*_+2*v,t}function lae(t,e,r,i){const s=[],n=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],n[0]=s[0],n[1]=s[1]*Math.cos(i)-s[2]*Math.sin(i),n[2]=s[1]*Math.sin(i)+s[2]*Math.cos(i),t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function uae(t,e,r,i){const s=[],n=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],n[0]=s[2]*Math.sin(i)+s[0]*Math.cos(i),n[1]=s[1],n[2]=s[2]*Math.cos(i)-s[0]*Math.sin(i),t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function cae(t,e,r,i){const s=[],n=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],n[0]=s[0]*Math.cos(i)-s[1]*Math.sin(i),n[1]=s[0]*Math.sin(i)+s[1]*Math.cos(i),n[2]=s[2],t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function dae(t,e){w$(Pk,t),w$(Ak,e);const r=$6(Pk,Ak);return r>1?0:r<-1?Math.PI:Math.acos(r)}const Pk=al(),Ak=al();function hae(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function pae(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function fae(t,e){if(t===e)return!0;const r=t[0],i=t[1],s=t[2],n=e[0],o=e[1],l=e[2],u=Kr();return Math.abs(r-n)<=u*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-o)<=u*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(s-l)<=u*Math.max(1,Math.abs(s),Math.abs(l))}function mae(t,e,r){const i=r[0]-e[0],s=r[1]-e[1],n=r[2]-e[2];let o=i*i+s*s+n*n;return o>0?(o=1/Math.sqrt(o),t[0]=i*o,t[1]=s*o,t[2]=n*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const yae=y6,gae=g6,vae=v6,wae=b6,bae=_6,_ae=m6,Sae=S6;Object.freeze(Object.defineProperty({__proto__:null,abs:Goe,add:zoe,angle:dae,bezier:iae,ceil:Uoe,clamp:Zoe,copy:joe,cross:Xoe,crossAndNormalize:eae,direction:mae,dist:wae,distance:b6,div:vae,divide:v6,dot:$6,equals:fae,exactEquals:pae,floor:qoe,hermite:rae,inverse:Qoe,len:_ae,length:m6,lerp:tae,max:Woe,min:Hoe,mul:gae,multiply:g6,negate:Koe,normalize:w$,random:sae,rotateX:lae,rotateY:uae,rotateZ:cae,round:Joe,scale:w6,scaleAndAdd:Yoe,set:Voe,sign:Boe,sqrDist:bae,sqrLen:Sae,squaredDistance:_6,squaredLength:S6,str:hae,sub:yae,subtract:y6,transformMat3:oae,transformMat4:nae,transformQuat:aae},Symbol.toStringTag,{value:"Module"}));function Os(t){let e=t*t;return t<0&&(e*=-1),e}function $ae(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function xae(t,e,r){const i=r,s=t.state,n=t.device,o=e.tiltDirection==="forward-down"?1:-1,l=1;return n.deviceType==="standard"?(i.translation[0]=Os(s.axes[0]),i.translation[1]=Os(s.axes[1]),i.translation[2]=Os(s.buttons[7])-Os(s.buttons[6]),i.heading=Os(s.axes[2]),i.tilt=Os(s.axes[3])):n.deviceType==="spacemouse"&&(i.translation[0]=1.2*Os(s.axes[0]),i.translation[1]=1.2*Os(s.axes[1]),i.translation[2]=2*-Os(s.axes[2]),i.heading=1.2*Os(s.axes[5]),i.tilt=1.2*Os(s.axes[3])),i.tilt*=o,w6(i.translation,i.translation,l),i}function Tae(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let Mae=class extends Wt{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new qh,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",r=>this._handleGamePadEvent(r)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([ne(()=>this._view.navigation.gamepad?.enabled,r=>{r?(this._handle.resume(),this._frameTask||(this._frameTask=vh({update:i=>this._frameUpdate(i.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},Et)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const r=this._view.navigation.gamepad.device;r&&e.data.device!==r||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,$ae(this._transformation)):(this._currentDevice=e.data.device,xae(e.data,this._view.navigation.gamepad,this._transformation)),this._frameTask?.resume())}_frameUpdate(e){const r=this._transformation;if(Tae(r))return void this._frameTask?.pause();const i=this._view.viewpoint.clone(),s=this._view.navigation.gamepad.velocityFactor,n=Eae*s*e;sb(i,i,[r.translation[0]*n,-r.translation[1]*n]);const o=1+r.translation[2]*Oae*e,l=this._view.constraints.rotationEnabled?-r.heading*Iae*e:0,u=this._view.size,d=[u[0]/2,u[1]];Xj(i,i,o,l,d,u);const p=this._view.constraints.constrain(i,this._view.viewpoint);this._view.viewpoint=p}};const Iae=.06,Eae=.7,Oae=6e-4;function x6(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),Te(()=>document.removeEventListener("visibilitychange",e))}let kae=class extends Wt{constructor(e,r,i){super(!0),this.view=e,this.keys=r,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=s=>{const n=this._keyMap[s.data.key];if(s.modifiers.has("Meta")||s.modifiers.has("Control"))return void this._stopMovement();if(n==null)return;s.stopPropagation(),s.preventDefault();const o=s.type==="key-down";if(this._pressedKeys[o?"add":"delete"](n),o){if(this._direction===n)return;this._direction=n,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const l=this._timeout===void 0,u=this._pressedKeys.size>0;l||u?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[r.left]:"left",[r.right]:"right",[r.up]:"up",[r.down]:"down"},this.registerIncoming("key-down",i,this._handleKey),this.registerIncoming("key-up",i,this._handleKey),this.registerIncoming("blur",i,this._stopMovement),this._visibilityHandle=x6(s=>s?null:this._stopMovement())}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(e){const r=this._currentDirection!=null;if(e!=null){if(r||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else r&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout(()=>{this._timeout=void 0,e()},this._stickyKeyDuration)}},Cae=class extends Wt{constructor(e,r,i){super(!0),this.view=e,this.keys=r,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(r),this.registerIncoming("key-down",i,s=>this._handleKeyDown(s)),this.registerIncoming("key-up",i,s=>this._handleKeyUp(s)),this.registerIncoming("blur",i,()=>this._handleStop()),this._visibilityHandle=x6(s=>s?null:this._handleStop())}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,r){for(const i of e)this._keyToDirection.set(i,r)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,r){const i=e.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection.get(e.data.key);if(this._pressed=s!=null,this._pressed){if(e.preventDefault(),r)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},Pae=class extends Wt{constructor(e,r,i){super(!0),this.view=e,this.keys=r,this._keysToZoomAction={},this.registerIncoming("key-down",i,s=>this._handleKeyDown(s)),r.zoomIn.forEach(s=>this._keysToZoomAction[s]=0),r.zoomOut.forEach(s=>this._keysToZoomAction[s]=1)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const r=e.modifiers;if(r.size>0&&!r.has("Shift"))return;const{key:i}=e.data;if(!(i in this._keysToZoomAction))return;const s=this._keysToZoomAction[i],{mapViewNavigation:n}=this.view;let o=null;switch(s){case 0:o=n.zoomIn();break;case 1:o=n.zoomOut();break;default:return}n.begin(),o.then(()=>n.end()),e.stopPropagation()}};const Aae=.6;let Rae=class extends Wt{constructor(e,r){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",r,i=>this._handleMouseWheel(i))}_handleMouseWheel(e){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const r=this._view.mapViewNavigation,{x:i,y:s,deltaY:n}=e.data,o=1/Aae**(1/60*n),l=r.zoom(o,[i,s]);this._canZoom=!1,l.catch(()=>{}).then(()=>{this._canZoom=!0,r.end()})}},Lae=class extends Wt{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",i=>this._handleDrag(i)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const r=this.view.mapViewNavigation;this._dragEventSeparator=new nb({start:(i,s)=>{r.pinch.begin(this.view,s.data),s.stopPropagation()},update:(i,s)=>{r.pinch.update(this.view,s.data),s.stopPropagation()},end:(i,s)=>{r.pinch.end(this.view),s.stopPropagation()},condition:i=>i>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function Rk(t){const e=t.native;return e?{buttons:e.buttons.map(r=>r.pressed?r.value||1:0),axes:e.axes.map(r=>Dae(r,t.axisThreshold))}:{buttons:[],axes:[]}}function Fae(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let r=0;r<t.axes.length;r++)if(t.axes[r]!==e.axes[r])return!1;for(let r=0;r<t.buttons.length;r++)if(t.buttons[r]!==e.buttons[r])return!1;return!0}function Nae(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function Dae(t,e){const r=Math.abs(t);return r<e?0:Math.sign(t)*(r-e)/(1-e)}let jae=class{constructor(e,r){this._element=e,this._input=r,this._hasEventListeners=!1,this._onConnectGamepad=n=>{this._connectGamepad(n.gamepad)},this._onDisconnectGamepad=n=>{const o=n.gamepad,l=o.index,u=this._inputDevices[l];u&&(this._emitGamepadEvent(o,Rk(u),!1),this._inputDevices.splice(l,1),this._latestUpdate.splice(l,1),this._input.gamepad.devices.remove(u),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const i="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=i&&s,this.supported&&(Lk(n=>this._connectGamepad(n)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const r=new qM(e);r.deviceType!=="unknown"&&(this._inputDevices[e.index]=r,this._input.gamepad.devices.add(r)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=vh({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),r=this._element.contains(document.activeElement),i=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!r;Lk(s=>{const n=this._inputDevices[s.index];if(!n)return;const o=this._latestUpdate[s.index],l=Rk(n),u=i||Nae(l);o&&(o.timestamp===s.timestamp||!o.active&&u||Fae(o.state,l))||this._emitGamepadEvent(s,l,!u)})}_emitGamepadEvent(e,r,i){const s=this._latestUpdate[e.index],n=s&&s.active;if(!n&&!i)return;const o=!n&&i?"start":n&&i?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:r,active:i},this._callback&&this._callback({device:this._inputDevices[e.index],state:r,action:o})}};function Vae(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function Lk(t){for(const e of navigator.getGamepads())Vae(e)&&t(e)}const Fk=k("edge"),zae=k("chrome"),Uae=k("ff"),qae=k("safari"),Nk="esri-view-surface",oc={touchNone:`${Nk}--touch-none`,touchPan:`${Nk}--touch-pan`};var Su;let Gae=(Su=class{constructor(e,r){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new jae(e,r),this._gamepadSource.onEvent=i=>this._callback("gamepad",i)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>this._releasePointerCaptureSafe(e)),this._activePointerCaptures.clear(),this._gamepadSource=Ke(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const r in this._active)if(!e||!e.has(r)){const i=this._active[r];this._element.removeEventListener(I1[r],i),delete this._active[r]}e&&e.forEach(r=>{if(!this._active[r]&&I1[r]){const i=(this._eventHandlers[r]||this._handleDefault).bind(this,r);this._element.addEventListener(I1[r],i),this._active[r]=i}}),this._gamepadSource&&(this._gamepadSource.hasEventListeners=e?.has("gamepad")??!1)}setPointerCapture(e,r){r?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?oc.touchNone:oc.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?oc.touchPan:oc.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(oc.touchNone),this._element.classList.remove(oc.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,r){const i=$j(this._element,e);return Su.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),r.x=i.x,r.y=i.y,r}_handleKey(e,r){const{key:i}=r;i&&e==="key-up"&&this._keyDownState.delete(i);const s={native:r,key:i,repeat:!!i&&this._keyDownState.has(i)};i&&e==="key-down"&&this._keyDownState.add(s.key),this._callback(e,s)}_handlePointer(e,r){const i=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,pointerType:r.pointerType,button:r.button,buttons:r.buttons,eventId:this._eventId++});this._callback(e,i)}_handlePointerPreventDefault(e,r){const i=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,pointerType:r.pointerType,button:r.button,buttons:r.buttons,eventId:this._eventId++});r.preventDefault(),this._callback(e,i)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&k("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,r){let i=this._getDeltaFromTrackpadOrMouseWheel(r);switch(r.deltaMode){case 0:Fk&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}Fk?i*=.7:zae||qae?i*=.6:Uae&&(i*=1.375);const s=100,n=Math.abs(i);n>s&&(i=i/n*200/(1+Math.exp(-.02*(n-s))));const o=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,deltaY:i});this._callback(e,o)}_handlePointerCaptureLost(e,r){this._activePointerCaptures.delete(r.pointerId),this._handleDefault(e,r)}_handleDefault(e,r){const i={native:r};r.preventDefault(),this._callback(e,i)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}},Su.test={disableSubpixelCoordinates:!1},Su);const I1={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let Bae=class extends Wt{constructor(){super(!0),this.registerIncoming("context-menu",e=>e.data.native.preventDefault())}};const T6=()=>({maximumClickDelay:300}),Hae=(t={})=>({...T6(),movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,...t}),i3=(t={})=>({...T6(),maximumDoubleClickDistance:10,maximumDoubleTouchDistance:35,maximumDoubleClickDelay:250,maximumDoubleTouchDelay:350,...t});function jv(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function Wae(t,e){const r=e.x-t.x,i=e.y-t.y;return Math.sqrt(r*r+i*i)}function Zae(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Gt()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[C,T]=t,[O,P]=[T.x-C.x,T.y-C.y];return e.radius=Math.sqrt(O*O+P*P)/2,e.center.x=(C.x+T.x)/2,e.center.y=(C.y+T.y)/2,e}let r=0,i=0;for(let C=0;C<t.length;C++)r+=t[C].x,i+=t[C].y;r/=t.length,i/=t.length;const s=t.map(C=>C.x-r),n=t.map(C=>C.y-i);let o=0,l=0,u=0,d=0,p=0,f=0,m=0;for(let C=0;C<s.length;C++){const T=s[C],O=n[C],P=T*T,D=O*O;o+=P,l+=D,u+=T*O,d+=P*T,p+=D*O,f+=T*D,m+=O*P}const y=.5*(d+f),g=.5*(p+m),v=o*l-u*u,_=(y*l-g*u)/v,S=(o*g-u*y)/v,M=Gt(_+r,S+i);return{radius:Math.sqrt(_*_+S*S+(o+l)/t.length),center:M}}function vu(t){const{native:e}=t,{pointerId:r,button:i,pointerType:s}=e;return s==="mouse"?`${r}:${i}`:`${s}`}let Jae=class extends Wt{constructor(e={},r=Vh){super(!1),this._clock=r,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Gt(0,0),this._pointerState=new Map,this._parameters=i3(e),this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new nb({start:(i,s)=>this._dragStart(i,s),update:(i,s)=>this._dragUpdate(s),end:(i,s)=>this._dragEnd(s)}),this.registerIncoming("drag",i=>this._dragEventSeparator.handle(i)),this.registerIncoming("pointer-down",i=>this._handlePointerDown(i)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=He(e.doubleTapTimeout)})}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(e){const r=this._pointerState.get(e);r&&(r.doubleTapTimeout=He(r.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,r){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:s}=r,{center:n}=i;this._dragStartCenter=n;const o=E1("begin",Gt(0,0),i);this._doubleTapDrag.emit(o,void 0,s),r.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:r,modifiers:i}=e,{center:s}=r,n=E1("update",Gt(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r);this._doubleTapDrag.emit(n,void 0,i),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:r,modifiers:i}=e,{center:s}=r,n=E1("end",Gt(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r);this._doubleTapDrag.emit(n,void 0,i),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:r}=e,i=vu(r),s=this._pointerState.get(i),{pointerType:n}=r.native;if(s){const o=n==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;this._clearPointerDown(i),jv(s.event.data,r)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:r}=e,{pointerType:i}=r.native,s=vu(r),n=i==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(s),n);this._pointerState.set(s,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}};function E1(t,e,r){const{button:i,buttons:s,pointer:n,pointers:o,pointerType:l,timestamp:u}=r;return{action:t,delta:e,button:i,buttons:s,pointer:n,pointers:o,pointerType:l,timestamp:u}}let Yae=class extends Wt{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,r,i,s){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:r.buttons,timestamp:s,pointers:Kae(this._activePointerMap),pointer:r,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(e){const r=e.native.pointerId,i=ig(this._activePointerMap).angle,s={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(r,s);const n=T0(s,M6(this._activePointerMap));s.initialAngle=n,s.lastAngle=n,this._updatePointerAngles(i)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const r=e.native.pointerId,i=this._activePointerMap.get(r);i?i.event=e:this._addPointer(e)}_removePointer(e){const r=ig(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(r)}_updatePointerAngles(e){const r=ig(this._activePointerMap);this._activePointerMap.forEach(i=>{i.initialAngle=T0(i,r)-e,i.lastAngle=T0(i,r)-e})}_emitEvent(e,r,i){const s=ig(this._activePointerMap);this._drag.emit(this._createPayload(e,r,s,i),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const r=e.data.native.pointerId,i=e.timestamp;this._activePointerMap.get(r)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,i),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(r)):(this._removePointer(r),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const r=e.data,i=r.currentEvent,s=e.timestamp;switch(r.action){case"start":case"update":this._isDragging?this._activePointerMap.has(i.native.pointerId)?(this._updatePointer(i),!this._isCurrentDragSuppressed&&this._emitEvent("update",i,s)):(this._addPointer(i),this._emitEvent("added",i,s),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(i),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",i,s))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function M6(t){const e=[];return t.forEach(r=>{e.push(Gt(r.event.x,r.event.y))}),Zae(e)}function ig(t){const e=M6(t);let r=0;return t.forEach(i=>{let s=T0(i,e),n=s-i.lastAngle;for(;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;s=i.lastAngle+n,i.lastAngle=s;const o=s-i.initialAngle;r+=o}),r/=t.size||1,{angle:r,radius:e.radius,center:e.center}}function Kae(t){const e=new Map;return t.forEach((r,i)=>e.set(i,r.event)),e}function T0(t,e){const r=t.event,i=r.x-e.center.x,s=r.y-e.center.y;return Math.atan2(s,i)}let Qae=class extends Wt{constructor(e={},r=Vh){super(!1),this._clock=r,this._pointerState=new Map,this._parameters=i3(e),this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const r=e.data,i=vu(r);if(!this._pointerState.has(i)){const s={downButton:r.native.button,x:r.x,y:r.y,immediateDoubleClick:null};this._pointerState.set(i,s),this.startCapturingPointer(r.native)}}_handlePointerUp(e){const r=e.data,i=vu(r),s=this._pointerState.get(i);if(s&&s.downButton===r.native.button){const n=s.immediateDoubleClick,o=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;n?(n.timeoutHandle.remove(),jv(n,e.data)>o?this._startImmediateDoubleClick(e,s):(this._immediateDoubleClick.emit(e.data,void 0,n.modifiers),this._removeState(r))):jv(s,e.data)>o?this._removeState(r):this._startImmediateDoubleClick(e,s)}}_startImmediateDoubleClick(e,r){const i=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay;r.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),i)}}_removeState(e){const r=vu(e);this._pointerState.delete(r),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},Xae=class extends Wt{constructor(e={},r=Vh){super(!1),this._clock=r,this._pointerState=new Map,this._parameters=Hae(e),this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",i=>this._handlePointerDown(i)),this.registerIncoming("pointer-up",i=>this._handlePointerLoss(i,"pointer-up")),this.registerIncoming("pointer-capture-lost",i=>this._handlePointerLoss(i,"pointer-capture-lost")),this.registerIncoming("pointer-cancel",i=>this._handlePointerLoss(i,"pointer-cancel")),this._moveHandle=this.registerIncoming("pointer-move",i=>this._handlePointerMove(i)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=He(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const r=e.data,i=r.native.pointerId;let s=null;this._pointerState.size===0&&(s=this._clock.setTimeout(()=>{const o=this._pointerState.get(i);if(o){if(!o.isDragging){const l=o.previousEvent;this._pointerHold.emit(l,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._parameters.holdDelay));const n={startEvent:r,previousEvent:r,startTimestamp:e.timestamp,isDragging:!1,downButton:r.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(i,n),this.startCapturingPointer(r.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const r=e.data,i=r.native.pointerId,s=this._pointerState.get(i);s&&(s.isDragging?this._pointerDrag.emit(sg("update",s,r),void 0,s.modifiers):Wae(r,s.startEvent)>this._getDragThreshold(r.native.pointerType)&&this._startDragging(e),s.previousEvent=r)}_getDragThreshold(e){switch(e){case"touch":return this._parameters.movementUntilTouchDrag;case"pen":return this._parameters.movementUntilPenDrag;default:return this._parameters.movementUntilMouseDrag}}_startDragging(e){const r=e.data,i=r.native.pointerId;this._pointerState.forEach(s=>{s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=e.modifiers,s.isDragging=!0,i===s.startEvent.native.pointerId?this._pointerDrag.emit(sg("start",s,r)):this._pointerDrag.emit(sg("start",s,s.previousEvent),e.timestamp))})}_handlePointerLoss(e,r){const i=e.data,s=i.native.pointerId,n=this._pointerState.get(s);n&&(n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging?this._pointerDrag.emit(sg("end",n,r==="pointer-up"?i:n.previousEvent),void 0,n.modifiers):r==="pointer-up"&&n.downButton===i.native.button&&e.timestamp-n.startTimestamp<=this._parameters.maximumClickDelay&&!n.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(s),this.stopCapturingPointer(i.native),this._pointerState.size===0&&this._moveHandle.pause())}};function sg(t,e,r){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:r}}let ele=class extends Wt{constructor(e={},r=Vh){super(!1),this._clock=r,this._pointerState=new Map,this._parameters=i3(e),this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",i=>this._handleImmediateClick(i)),this.registerIncoming("pointer-down",i=>this._handlePointerDown(i))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=He(e.doubleClickTimer))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,r){const i=this._pointerState.get(e);i&&(i.doubleClickTimer=He(i.doubleClickTimer),r&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const r=this._pointerState.get(e);r.pointerDownCount===1&&this._click.emit(r.event.data,void 0,r.event.modifiers),r.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const r=e.data,{pointerType:i}=r.native,s=tle(r);if(!this._pointerState.has(s))return void this._startClick(e);const n=this._pointerState.get(s),{data:o,modifiers:l}=n.event,u=i==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;jv(o,r)>u?(this._clearDoubleClickTimer(s,!0),this._startClick(e)):(this._clearDoubleClickTimer(s,!1),n.pointerDownCount===2&&this._doubleClick.emit(o,void 0,l))}_handlePointerDown(e){const r=vu(e.data),i=this._pointerState.get(r);i&&(i.pointerDownCount+=1)}_startClick(e){const{data:r}=e,{native:{pointerType:i}}=r,s=vu(r),n=i==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(s),n);this._pointerState.set(s,{event:e,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};function tle(t){const{pointerId:e,pointerType:r,button:i}=t.native;return r==="mouse"?`${e}:${i}`:`${r}`}const ng={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},Dk=Symbol("handles");let Fc=class extends X{initialize(){const e=()=>this.view?.ready;this.addHandles([qi(()=>!e(),()=>this._disconnect()),qi(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerInfo(){return this._inputManager?.latestPointerInfo}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(Dk),this._inputManager=Ke(this._inputManager)}_connect(){const e=this.view.surface,r=new Gae(e,this.view.input),i=[new Qae,new Xae,new ele,new Yae(this.view.navigation),new Jae],s=new Ps({eventSource:r,recognizers:i}),n=new Noe(this.view,["primary"]),o=new Doe(this.view,["secondary"]);s.installHandlers("prevent-context-menu",[new Bae],No.INTERNAL),s.installHandlers("navigation",[new Lae(this.view),new Mae(this.view),new Rae(this.view),new Ck(this.view),new Ck(this.view,[ng.counter]),n,new kae(this.view,ng.pan),new Pae(this.view,ng.zoom),new Cae(this.view,ng.rotate),o,new Foe(this.view,"touch")],No.INTERNAL),this.view.viewEvents.connect(s),this._source=r,this._inputManager=s,this.addHandles([ne(()=>this.view?.navigation?.browserTouchPanEnabled,l=>{this._source&&(this._source.browserTouchPanningEnabled=!l)},Et),ne(()=>{const{actionMap:l}=this.view.navigation;return{panActions:kk("pan",l),rotateActions:kk("rotate",l)}},({panActions:l,rotateActions:u})=>{n.pointerActions=l,o.pointerActions=u},xr)],Dk)}get test(){}};a([c()],Fc.prototype,"view",void 0),a([c()],Fc.prototype,"latestPointerInfo",null),a([c()],Fc.prototype,"multiTouchActive",null),Fc=a([b("esri.views.2d.input.MapViewInputManager")],Fc);const rle=Fc,ile=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.goToManager=new x0({view:this}),this.animationsEnabled=!0,this.inputManager=new rle({view:this}),this.addHandles([this.on("resize",s=>this.stateManager.resize(s.width,s.height))])}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}on(i,s,n,o){return this.viewEvents.on(i,s,n,o)||super.on(i,s)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}goTo(i,s){return this.goToManager.goTo(i,s)}toMap(i){if(!this.ready)return null;const s=Tj(i)?xj(this,i):i;return this.stateManager.toMap(s)}};return a([c()],r.prototype,"goToManager",void 0),a([c({readOnly:!0})],r.prototype,"interacting",null),a([c()],r.prototype,"stationary",null),a([c()],r.prototype,"animationsEnabled",void 0),a([c({readOnly:!0})],r.prototype,"inputManager",void 0),r=a([b("esri.views.Viewport2DMixin")],r),r};let jk=class{constructor(e){this._view=e,this.viewpoint=new ps({targetGeometry:new ee,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,r]=this._view.size;return Math.sqrt(e*e+r*r)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return Kj(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,r){r.pan=XL(this.center,e.center);let i=Math.abs(e.rotation-this.rotation);i=i>=180?360-i:i,r.rotate=ny(i),r.sourceZoom=this.scale,r.targetZoom=e.scale}interpolate(e,r,i){const{pan:s,rotate:n,zoom:o,zoomOffset:l}=i,{center:u}=this;u.spatialReference=e.center.spatialReference,u.x=Bp(e.center.x,r.center.x,s),u.y=Bp(e.center.y,r.center.y,s),this.viewpoint.scale=Bp(e.scale,r.scale+l,o);let d=e.rotation;const p=r.rotation;Math.abs(p-d)>=180&&(d+=360*(d<p?1:-1)),this.viewpoint.rotation=Bp(d,p,n)}copyFrom(e){kr(this.viewpoint,e.viewpoint),this._view=e.view}};function Ep(t,e,r,i){const s=3*t,n=3*(r-t)-s,o=1-s-n,l=3*e,u=3*(i-e)-l,d=1-l-u;function p(g){return((o*g+n)*g+s)*g}function f(g){return((d*g+u)*g+l)*g}function m(g){return(3*o*g+2*n)*g+s}function y(g,v){let _,S,M,C,T,O;for(M=g,O=0;O<8;O++){if(C=p(M)-g,Math.abs(C)<v)return M;if(T=m(M),Math.abs(T)<1e-6)break;M-=C/T}if(_=0,S=1,M=g,M<_)return _;if(M>S)return S;for(;_<S;){if(C=p(M),Math.abs(C-g)<v)return M;g>C?_=M:S=M,M=.5*(S-_)+_}return M}return function(g,v=1e-6){return f(y(g,v))}}const is={};is.ease=Ep(.25,.1,.25,1),is.linear=Ep(0,0,1,1),is.easeIn=is["ease-in"]=Ep(.42,0,1,1),is.easeOut=is["ease-out"]=Ep(0,0,.58,1),is.easeInOut=is["ease-in-out"]=Ep(.42,0,.58,1);const sle=t=>t,Rm=t=>t*t,Vv=t=>1-Rm(1-t),Vk=t=>t<.5?Rm(2*t)/2:(Vv(2*(t-.5))+1)/2,zv=t=>t*t*t,b$=t=>1-zv(1-t),zk=t=>t<.5?zv(2*t)/2:(b$(2*(t-.5))+1)/2,Uv=t=>t*t*t*t,_$=t=>1-Uv(1-t),Uk=t=>t<.5?Uv(2*t)/2:(_$(2*(t-.5))+1)/2,qv=t=>t*t*t*t*t,S$=t=>1-qv(1-t),qk=t=>t<.5?qv(2*t)/2:(S$(2*(t-.5))+1)/2,Gv=t=>1-Math.cos(t*Math.PI/2),$$=t=>1-Gv(1-t),Gk=t=>t<.5?Gv(2*t)/2:($$(2*(t-.5))+1)/2,Bv=t=>2**(10*(t-1)),Hv=t=>1-Bv(1-t),Bk=t=>t<.5?Bv(2*t)/2:(Hv(2*(t-.5))+1)/2,Wv=t=>-(Math.sqrt(1-t*t)-1),x$=t=>1-Wv(1-t),Hk=t=>t<.5?Wv(2*t)/2:(x$(2*(t-.5))+1)/2;function vs(t){const e=2*(t-Math.sqrt((t-1)*t)),r=e/2/t;return i=>i<r?t*i*i:e*i-e+1}function ws(t,e){return(r,i)=>r<e?e*t(r/e,i):1-t((1-r)/(1-e),i)*(1-e)}const Wk=ws(vs(1),1),Zk=ws(vs(1),0),Zv=ws(vs(1),.5),Jk=ws(vs(2),1),Yk=ws(vs(2),0),Kk=ws(vs(2),.5),Qk=ws(vs(3),1),Xk=ws(vs(3),0),eC=ws(vs(3),.5),tC=ws(vs(4),1),rC=ws(vs(4),0),iC=ws(vs(4),.5),sC={linear:sle,"in-quad":Rm,"out-quad":Vv,"in-out-quad":Vk,"in-coast-quad":Wk,"out-coast-quad":Zk,"in-out-coast-quad":Zv,"in-cubic":zv,"out-cubic":b$,"in-out-cubic":zk,"in-coast-cubic":Jk,"out-coast-cubic":Yk,"in-out-coast-cubic":Kk,"in-quart":Uv,"out-quart":_$,"in-out-quart":Uk,"in-coast-quart":Qk,"out-coast-quart":Xk,"in-out-coast-quart":eC,"in-quint":qv,"out-quint":S$,"in-out-quint":qk,"in-coast-quint":tC,"out-coast-quint":rC,"in-out-coast-quint":iC,"in-sine":Gv,"out-sine":$$,"in-out-sine":Gk,"in-expo":Bv,"out-expo":Hv,"in-out-expo":Bk,"in-circ":Wv,"out-circ":x$,"in-out-circ":Hk,"quad-in":Rm,"quad-out":Vv,"quad-in-out":Vk,"quad-in-coast":Wk,"quad-out-coast":Zk,"quad-in-out-coast":Zv,"cubic-in":zv,"cubic-out":b$,"cubic-in-out":zk,"cubic-in-coast":Jk,"cubic-out-coast":Yk,"cubic-in-out-coast":Kk,"quart-in":Uv,"quart-out":_$,"quart-in-out":Uk,"quart-in-coast":Qk,"quart-out-coast":Xk,"quart-in-out-coast":eC,"quint-in":qv,"quint-out":S$,"quint-in-out":qk,"quint-in-coast":tC,"quint-out-coast":rC,"quint-in-out-coast":iC,"sine-in":Gv,"sine-out":$$,"sine-in-out":Gk,"expo-in":Bv,"expo-out":Hv,"expo-in-out":Bk,"circ-in":Wv,"circ-out":x$,"circ-in-out":Hk,ease:t=>is.ease(t),"ease-in":t=>is.easeIn(t),"ease-out":t=>is.easeOut(t),"ease-in-out":t=>is.easeInOut(t)};let nle=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const Jv={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},I6={maxDuration:4e3};let ole=class E6{constructor(e){this._createCamera=e,this.compared=new nle,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:Jv.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new E6(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,r,i){this.source!==e&&this.source.copyFrom(e),this.target!==r&&this.target.copyFrom(r),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=i.desiredScreenFlow??Jv.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const r=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/r}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>Kr()}get hasFov(){return Math.abs(this.compared.fov)>Kr()}get hasRotate(){return this.compared.rotate>Kr()}},ale=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},lle=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,r)=>e+r.time,0)}interpolateComponentsAt(e,r){e=Math.min(Math.max(e,0),1),e*=this.time;let i=0,s=0;const n=this.definition,o=this.segments.reduce((l,u)=>l||u.definition.hasZoom,!1);for(let l=0;l<this.segments.length;l++){const u=this.segments[l],d=u.definition;if(e<=u.time||l===this.segments.length-1){if(this.segmentInterpolateComponentsAt(u,u.time===0?0:e/u.time,r),n.hasPan&&!isNaN(r.pan)&&isFinite(n.compared.pan)?r.pan=(i+d.compared.pan*r.pan)/n.compared.pan:r.pan=1,n.hasRotate&&!isNaN(r.rotate)&&isFinite(n.compared.rotate)?r.rotate=(s+d.compared.rotate*r.rotate)/n.compared.rotate:r.rotate=1,o&&!isNaN(r.zoom)&&isFinite(d.compared.targetZoom)){const{sourceZoom:p,targetZoom:f}=d.compared,m=r.zoom*(f-p)+p,y=this.segments[0].definition.compared.sourceZoom,g=this.segments[this.segments.length-1].definition.compared.targetZoom,v=Math.abs(f-y)>Math.abs(p-y)?f:p;r.zoomOffset=v-g,r.zoom=(m-y)/(v-y)}else r.zoom=1;return r}e-=u.time,i+=d.compared.pan,s+=d.compared.rotate}}segmentInterpolateComponentsAt(e,r,i){e.interpolateComponentsAt(r,i)}},O1=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,r=e.compared,i=r.sourceZoom,s=r.targetZoom;this._zoomSign=i>s?1:-1,this._panPixelsAtSource=r.pan*e.source.pixelsPerPanAtZoom(i);const n=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=r.rotate*n}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom,{hasZoom:i,hasPan:s,hasRotate:n}=this.definition;let o=0,l=0;i&&(s&&(o=(r/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),n&&(l=this._zoomSign*(Math.log(e/r)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const u=this.definition.desiredPixelFlow;if(i&&s&&n){const d=o+l+o*l;this._zoomPixelFlow=o*l/d*u,this._panPixelFlow=l/d*u,this._rotatePixelFlow=o/d*u}else if(i&&s){const d=1+o;this._zoomPixelFlow=o/d*u,this._panPixelFlow=1/d*u}else if(i&&n){const d=1+l;this._zoomPixelFlow=l/d*u,this._rotatePixelFlow=1/d*u}else if(s&&n){const d=this._panPixelsAtSource/this._rotatePixels,p=1+d;this._panPixelFlow=d/p*u,this._rotatePixelFlow=1/p*u}else s?this._panPixelFlow=u:i?this._zoomPixelFlow=u:n&&(this._rotatePixelFlow=u);if(this._time=Math.max(this.rotateTime,this.zoomTime,this.panTime),this.fovTime>this._time){const d=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=d,this._panPixelFlow/=d,this._rotatePixelFlow/=d}}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:0}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/ule:0}get panTime(){if(!this.definition.hasPan)return 0;if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,r=e*this._panPixelsAtSource;return Math.log(r*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const r=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom;return(r*(r/i)**-e-r)/(i-r)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:r,segmentEnd:i}=this.definition;return r+e*(i-r)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const r=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(r*e*this._time)-1))/(r*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,r){e=Math.min(Math.max(e,0),1),r.zoom=this._interpolateComponentsZoom(e),r.pan=this._interpolateComponentsPan(e),r.rotate=this._interpolateComponentsRotate(e),r.zoomOffset=0,r.fov=this._interpolateComponentsFov(e)}};const ule=ny(45);function cle(t,e,r){const i=e-t.compared.sourceZoom,s=t.halfWindowPanAtZoom(i);return-t.halfWindowSize*(r.ascensionFactor*Math.LN2*t.compared.pan+s)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*s)}function dle(t,e,r){const i=1/e,s=Math.log(t.compared.sourceZoom*i),n=1/t.desiredPixelFlow,o=1/Math.LN2,l=e-t.compared.sourceZoom,u=1/l,d=(r.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(l))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*i*n*o*u*d-t.halfWindowSize*s*n*o*u+t.halfWindowSize*s*n*o*d/(l*l)}function hle(t,e,r){const i=e-t.compared.sourceZoom,s=1/i,n=1/e,o=Math.log(t.compared.sourceZoom*n),l=(r.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(i))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*(-2*s*n*l+2*s*o+2*n-2*o*l/(i*i)-l/(e*e))/(t.desiredPixelFlow*Math.LN2)}function ple(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function fle(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function mle(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function yle(t,e,r){return-t.compared.pan*t.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function gle(t,e,r){return t.compared.pan*t.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function vle(t,e,r){return-2*t.compared.pan*t.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function wle(t,e,r){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-r.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function ble(t,e,r){const i=Math.log(e/t.compared.targetZoom),s=1/t.desiredPixelFlow,n=1/Math.LN2,o=-e+t.compared.targetZoom,l=1/o,u=(-t.halfWindowPanAtZoom(e)-r.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*i*s*n*l+t.halfWindowSize*i*s*n*u/(o*o)+t.halfWindowSize*s*n*l*u/e}function _le(t,e,r){const i=e-t.compared.targetZoom,s=1/i,n=1/e,o=Math.log(e/t.compared.targetZoom),l=(t.halfWindowPanAtZoom(e)+r.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*(-2*s*n*l-2*s*o+2*n+2*o*l/(i*i)-l/(e*e))/(t.desiredPixelFlow*Math.LN2)}function Sle(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function $le(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function xle(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function Tle(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const r=Math.LN2*t.compared.pan,i=e,s=t.halfWindowPanAtZoom(i),n=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*s);return t.compared.sourceZoom<=t.compared.targetZoom?n*(r-s):n*(r+s)}function Mle(t,e){let r=Ile(t,e);const i={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},s=i.ascensionFactor===0,n=i.descensionFactor===0,o=s?ple:cle,l=s?fle:dle,u=s?mle:hle,d=n?Sle:wle,p=n?$le:ble,f=n?xle:_le,m=O=>o(t,O,i)+yle(t,O,i)+d(t,O,i),y=O=>l(t,O,i)+gle(t,O,i)+p(t,O,i),g=O=>u(t,O,i)+vle(t,O,i)+f(t,O,i);let v=m(r);const _=Tle(t);let S;const M=e.maximumIterations||20,C=e.maximumDistance!=null?e.maximumDistance:1/0;for(S=0;S<M;S++){const O=e.desiredSlope??1e-6;let P=y(r);Math.abs(P)>O&&(P+=O);const D=P/g(r);if(isNaN(D)||r>=C&&D<0){if(!isFinite(C))return null;r=C,v=m(r);break}if(r-=D,r<=t.compared.sourceZoom||r<=t.compared.targetZoom)return null;const z=m(r);if(Math.abs(z-v)/v<=.005)break;v=z}return isNaN(v)||v>_*(1-.3)||r<=t.compared.sourceZoom||r<=t.compared.targetZoom?null:r}function Ile(t,e){const r=Math.max(t.compared.sourceZoom,t.compared.targetZoom),i=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return i<r?e.maximumDistance!=null?r+(e.maximumDistance-r)/2:1.5*r:e.maximumDistance?Math.min(e.maximumDistance,i):i}let Ele=class extends lle{constructor(e,r){super(),this._preallocSegments=[new O1,new O1,new O1],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,r)}update(e,r){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const i=r?.apex?Mle(e,r.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,i?this._updateWithApex(i,r?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,r,i){e.interpolateComponentsAt(r,i),e===this._ascensionSegment?i.zoom=Vv(i.zoom):e===this._descensionSegment&&(i.zoom=Rm(i.zoom))}_updateWithApex(e,r){const[i,s,n]=this._preallocSegments,o=r?.ascensionFactor??.5,l=Math.min(1-o,r?.ascensionFactor!=null&&r.descensionFactor!=null?r.descensionFactor:.5),u=1-o-l;i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.compared.targetZoom=e,i.definition.compared.pan=this.definition.compared.pan*o,i.definition.compared.rotate=this.definition.compared.rotate*o,i.definition.segmentEnd=o,i.update(),this._ascensionSegment=i,this.segments.push(i),u>0&&(s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.copyFrom(this.definition),s.definition.compared.sourceZoom=e,s.definition.compared.targetZoom=e,s.definition.compared.pan=this.definition.compared.pan*u,s.definition.compared.rotate=this.definition.compared.rotate*u,s.definition.segmentStart=i.definition.segmentEnd,s.definition.segmentEnd=i.definition.segmentEnd+u,s.update(),this.segments.push(s)),n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.compared.sourceZoom=e,n.definition.compared.pan=this.definition.compared.pan*l,n.definition.compared.rotate=this.definition.compared.rotate*l,n.definition.segmentStart=o+u,n.update(),this._descensionSegment=n,this.segments.push(n)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const Ole=new ale;let kle=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=0,this._easing=Zv,this.definition=new ole(e),this.path=new Ele}update(e,r,i){this.definition.update(e,r,i),this.path.update(this.definition,i),this._time=this._applyTimeSettings(mq(isFinite(this.path.time)?this.path.time:0),i),this._easing=i.easing??(this._time>=1e3?Zv:Hv)}cameraAt(e,r){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const i=this.path.interpolateComponentsAt(e,Ole);r.interpolate(this.definition.source,this.definition.target,i)}_normalizedEasing(e){const r=this._easing(0,this._time),i=this._easing(1,this._time);return(this._easing(e,this._time)-r)/(i-r)}_applyTimeSettings(e,r){const i=r.speedFactor!=null?r.speedFactor:1,s=r.minDuration??Jv.minDuration/i,n=r.maxDuration??Jv.maxDuration/i;return e=r.duration!=null?r.duration:Math.min(Math.max(e/i,s),n)}};const Cle=2e3,Ple=64;let Ale=class{constructor(e){this._view=e,this._animation=new kle(()=>new jk(this._view)),this._current=new jk(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,r,i={}){kr(this._current.viewpoint,e),kr(this._source.viewpoint,e),kr(this._target.viewpoint,r),this._animation.update(this._source,this._target,i)}applyRatio(e,r){this._animation.cameraAt(r,this._current),kr(e,this._current.viewpoint)}},Nc=class extends X{constructor(e){super(e),this._animation=null,this._destinationViewState=new t3,this.updateFunction=null,this.easing=sC.ease,this.viewpoint=new ps({targetGeometry:new ee,scale:0,rotation:0}),this._updateTask=vh({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new Ale(e.view)}destroy(){this._updateTask=He(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,r,i){this.stop();const s=this.viewpoint;kr(s,r);const n=e.target;this._transition.update(this.viewpoint,n,{apex:{maximumDistance:Math.min(Math.min(r.scale,n.scale)*Ple,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:i?.duration,maxDuration:i?.animationMode==="auto"?1/0:i?.maxDuration??I6.maxDuration,speedFactor:i?.speedFactor,easing:(typeof i?.easing=="string"?sC[i.easing]:i?.easing)||this.easing}),i?.animationMode==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=n,Rle(this._transition.animation,i,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,n,{duration:0}));const o=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,r){this.stop(),this.updateFunction=r,this.viewpoint=e;const i=new v$({target:e.clone()}),s=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const r=this.animation;if(r&&r.state!==v$.state.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),this.animation?.update(this.viewpoint);else{const i=performance.now()-this._startTime,s=this._transition.duration,n=s>0?i/s:1,o=n>=1;this._transition.applyRatio(this.viewpoint,n),o&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function Rle(t,e,r,i){if(e?.duration!=null)return!0;const{time:s,isLinear:n}=t,o=e?.speedFactor||1;if(s>(e?.maxDuration??I6.maxDuration/o))return!1;if(n){const u=lt(),d=Gt(...i.toScreen(u,...r.center)),p=Gt(...r.toScreen(u,...i.center)),f=p!=null&&p.x>-1*r.size[0]&&p.x<(1.5+.5)*r.size[0]&&p.y>-1*r.size[1]&&p.y<(1.5+.5)*r.size[1],m=d!=null&&d.x>-1*i.size[0]&&d.x<(1.5+.5)*i.size[0]&&d.y>-1*i.size[1]&&d.y<(1.5+.5)*i.size[1];if(s>Cle/o&&!f&&!m)return!1}return!0}a([c()],Nc.prototype,"easing",void 0),a([c()],Nc.prototype,"view",void 0),a([c()],Nc.prototype,"viewpoint",void 0),Nc=a([b("esri.views.2d.AnimationManager")],Nc);const Lle=Nc;function Ze(){return Promise.all([N(()=>import("./webglDeps-k3PfyBd5.js"),__vite__mapDeps([194,161,195,196,197,4,55])),N(()=>import("./mapViewDeps-C99TyUM3.js"),__vite__mapDeps([198,123,92,93,87,31,4,94,91,95,84,199,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,204,96,97,205,206,21,194,207,108,208,209,140,210,150,151,211,72,82,86,38,37,212,98,213,90,15,16,17,214,100,105,80,215,216,217,218,157,219,220]))])}const Op=()=>Ze().then(()=>N(()=>import("./TileLayerView2D-DTSxT-Mw.js"),__vite__mapDeps([221,91,92,93,87,31,4,94,95,84,205,123,206,21,203,202,83,54,196,197,55,160,161,113,141,144,33,34,207,200,195,152,201,88,108,208,209,140,72,199,85,89,99,96,97,150,151,214,82,86,38,37,100,105,80,222,223,224,218,225,226,216,217,227,228,229,230,231,232,233,234]))),ml=()=>Ze().then(()=>N(()=>import("./FeatureLayerView2D-BT5n2D8K.js").then(t=>t.F),__vite__mapDeps([235,199,92,93,87,31,4,94,91,95,84,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,236,237,238,38,45,225,217,218,108,73,71,72,106,100,204,239,165,47,102,230,233,227,228,234]))),nC={"base-dynamic":()=>Ze().then(()=>N(()=>import("./BaseDynamicLayerView2D-DMf3-c73.js"),__vite__mapDeps([240,241,202,83,84,54,196,197,4,55,160,161,113,203,141,144,33,31,34,223,200,195,152,224,225,242,227,228]))),"base-tile":Op,"bing-maps":Op,catalog:()=>Ze().then(()=>N(()=>import("./CatalogLayerView2D-GIQZhZUV.js"),__vite__mapDeps([243,225,203,227]))),"catalog-dynamic-group":()=>Ze().then(()=>N(()=>import("./CatalogDynamicGroupLayerView2D-BE3-gmTz.js"),__vite__mapDeps([244,225,203,227]))),"catalog-footprint":()=>Ze().then(()=>N(()=>import("./CatalogFootprintLayerView2D-DwhePhh_.js"),__vite__mapDeps([245,235,199,92,93,87,31,4,94,91,95,84,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,236,237,238,38,45,225,217,218,108,73,71,72,106,100,204,239,165,47,102,230,233,227,228,234]))),csv:ml,"geo-rss":()=>Ze().then(()=>N(()=>import("./GeoRSSLayerView2D-CRzkbMeu.js"),__vite__mapDeps([246,225,203,215,216,217,4,85,83,84,54,195,161,218,202,196,197,55,160,113,141,144,33,31,34,199,92,93,87,94,91,95,200,152,201,88,89,99,214,205,123,206,21,82,86,38,37,100,105,80,227]))),feature:ml,geojson:ml,parquet:ml,graphics:()=>Ze().then(()=>N(()=>import("./GraphicsLayerView2D-IPyuIkXo.js"),__vite__mapDeps([247,225,203,215,216,217,4,85,83,84,54,195,161,218,202,196,197,55,160,113,141,144,33,31,34,199,92,93,87,94,91,95,200,152,201,88,89,99,214,205,123,206,21,82,86,38,37,100,105,80,227,234]))),group:()=>Ze().then(()=>N(()=>import("./GroupLayerView2D-C4g95uzX.js"),__vite__mapDeps([248,225,203,227]))),imagery:()=>Ze().then(()=>N(()=>import("./ImageryLayerView2D-CuLis2un.js"),__vite__mapDeps([249,250,197,4,55,160,161,54,128,202,83,84,196,113,203,141,144,33,31,34,122,120,225,214,92,93,87,94,91,95,205,123,206,21,82,85,86,88,38,37,199,200,195,152,201,89,99,100,105,80,226,216,217,218,241,223,224,242,126,190,236,233,227,228,234]))),"imagery-tile":()=>Ze().then(()=>N(()=>import("./ImageryTileLayerView2D-CzXOILYW.js"),__vite__mapDeps([251,252,250,197,4,55,160,161,54,128,202,83,84,196,113,203,141,144,33,31,34,122,120,225,125,253,218,200,195,152,213,201,88,224,254,126,234,190,236,233,227,228]))),kml:()=>Ze().then(()=>N(()=>import("./KMLLayerView2D-BbTz5Jsq.js"),__vite__mapDeps([255,256,223,203,200,161,195,196,152,224,241,202,83,84,54,197,4,55,160,113,141,144,33,31,34,225,215,216,217,85,218,199,92,93,87,94,91,95,201,88,89,99,214,205,123,206,21,82,86,38,37,100,105,80,227,15,16,17,126,210,194,150,151,208,253]))),"knowledge-graph":()=>Ze().then(()=>N(()=>import("./KnowledgeGraphLayerView2D-LN7a8epb.js"),__vite__mapDeps([257,225,203,227]))),"link-chart":()=>Ze().then(()=>N(()=>import("./KnowledgeGraphLayerView2D-LN7a8epb.js"),__vite__mapDeps([257,225,203,227]))),"knowledge-graph-sublayer":ml,"map-image":()=>Ze().then(()=>N(()=>import("./MapImageLayerView2D-Dl6ubmBK.js"),__vite__mapDeps([258,241,202,83,84,54,196,197,4,55,160,161,113,203,141,144,33,31,34,223,200,195,152,224,225,214,92,93,87,94,91,95,205,123,206,21,82,85,86,88,38,37,199,201,89,99,100,105,80,226,216,217,218,242,227,259,230,232,236,228,229,231,233,234]))),"map-notes":()=>Ze().then(()=>N(()=>import("./MapNotesLayerView2D-C9soGUVb.js"),__vite__mapDeps([260,225,203,215,216,217,4,85,83,84,54,195,161,218,202,196,197,55,160,113,141,144,33,31,34,199,92,93,87,94,91,95,200,152,201,88,89,99,214,205,123,206,21,82,86,38,37,100,105,80,227,234]))),media:()=>Ze().then(()=>N(()=>import("./MediaLayerView2D-3bulBHRV.js"),__vite__mapDeps([261,262,105,91,92,93,87,31,4,94,95,84,205,123,206,21,203,202,83,54,196,197,55,160,161,113,141,144,33,34,207,200,195,152,201,88,108,208,209,140,72,199,85,89,99,96,97,150,151,214,82,86,38,37,100,80,212,98,263,213,225,227]))),"ogc-feature":()=>Ze().then(()=>N(()=>import("./OGCFeatureLayerView2D-CMIvhaF8.js"),__vite__mapDeps([264,235,199,92,93,87,31,4,94,91,95,84,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,236,237,238,38,45,225,217,218,108,73,71,72,106,100,204,239,165,47,102,230,233,227,228,234]))),"open-street-map":Op,"oriented-imagery":ml,route:()=>Ze().then(()=>N(()=>import("./RouteLayerView2D-CAN_6_Mw.js"),__vite__mapDeps([265,266,267,225,203,215,216,217,4,85,83,84,54,195,161,218,202,196,197,55,160,113,141,144,33,31,34,199,92,93,87,94,91,95,200,152,201,88,89,99,214,205,123,206,21,82,86,38,37,100,105,80,227,234]))),stream:()=>Ze().then(()=>N(()=>import("./StreamLayerView2D-BsIfaGCo.js"),__vite__mapDeps([268,235,199,92,93,87,31,4,94,91,95,84,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,236,237,238,38,45,225,217,218,108,73,71,72,106,100,204,239,165,47,102,230,233,227,228,234]))),"subtype-group":()=>Ze().then(()=>N(()=>import("./SubtypeGroupLayerView2D-D_f0vfm-.js"),__vite__mapDeps([269,235,199,92,93,87,31,4,94,91,95,84,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,236,237,238,38,45,225,217,218,108,73,71,72,106,100,204,239,165,47,102,230,233,227,228,234]))),tile:Op,"vector-tile":()=>Ze().then(()=>N(()=>import("./VectorTileLayerView2D-CUkepym1.js"),__vite__mapDeps([270,95,72,4,91,140,209,141,94,161,197,55,160,202,83,84,54,196,113,203,144,33,31,34,218,36,142,143,123,225,227,228]))),video:()=>Ze().then(()=>N(()=>import("./VideoLayerView2D-1-kWZAVY.js"),__vite__mapDeps([271,272,273,174,173,263,113,202,83,84,54,196,197,4,55,160,161,203,141,144,33,31,34,199,92,93,87,94,91,95,200,195,152,85,201,88,89,99,213,274,225,215,216,217,218,214,205,123,206,21,82,86,38,37,100,105,80,227]))),wcs:()=>Ze().then(()=>N(()=>import("./ImageryTileLayerView2D-CzXOILYW.js"),__vite__mapDeps([251,252,250,197,4,55,160,161,54,128,202,83,84,196,113,203,141,144,33,31,34,122,120,225,125,253,218,200,195,152,213,201,88,224,254,126,234,190,236,233,227,228]))),"web-tile":Op,wfs:ml,wms:()=>Ze().then(()=>N(()=>import("./WMSLayerView2D-Bsrlxr3W.js"),__vite__mapDeps([275,241,202,83,84,54,196,197,4,55,160,161,113,203,141,144,33,31,34,223,200,195,152,224,225,242,227,228,276,236]))),wmts:()=>Ze().then(()=>N(()=>import("./WMTSLayerView2D-BySrRSBF.js"),__vite__mapDeps([277,222,223,203,200,161,195,196,152,224,202,83,84,54,197,4,55,160,113,141,144,33,31,34,218,225,227,228]))),"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"gaussian-splat":null,"integrated-mesh-3dtiles":null,"integrated-mesh":null,"line-of-sight":null,"point-cloud":null,scene:null,unknown:null,unsupported:null,viewshed:null,voxel:null};function Fle(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",r=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new x(`${r}:view-not-supported`,`${e} is not supported in 2D`)}const oC={hasLayerViewModule:t=>nC[t.type]!=null,importLayerView:t=>{const e=nC[t.type];if(e==null)throw Fle(t);return e(t)}};var Ri;let sp=(Ri=class{static getId(e,r,i,s){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${r}/${i}/${s}`}constructor(e,r,i,s){this.set(e,r,i,s)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,r=4095&this.col,i=63&this.level;return(3&this.world)<<30|r<<22|e<<8|i}acquire(e,r,i,s){this.set(e,r,i,s)}contains(e){const r=e.level-this.level;return r>=0&&this.row===e.row>>r&&this.col===e.col>>r&&this.world===e.world}containsChild(e){const r=e.level-this.level;return r>0&&this.row===e.row>>r&&this.col===e.col>>r&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new Ri(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,r,i,s){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[n,o,l,u]=e.split("/");this.level=parseFloat(n),this.row=parseFloat(o),this.col=parseFloat(l),this.world=parseFloat(u)}else this.level=+e,this.row=+r,this.col=+i,this.world=+s||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new Ri(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(e,r,i){const s=this.clone();return s.col+=e,s.row+=r,i.normalizeKey(s),s}getChildKeys(){const e=this.level+1,r=this.row<<1,i=this.col<<1,s=this.world;return[new Ri(e,r,i,s),new Ri(e,r,i+1,s),new Ri(e,r+1,i,s),new Ri(e,r+1,i+1,s)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}},Ri.pool=new Uh(()=>new Ri(""),null,null,25,50),Ri);function ac(t,e){return[t,e]}function yl(t,e,r){return t[0]=e,t[1]=r,t}function Nle(t,e,r,i,s){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t}const ks=new sp("0/0/0/0");let Dle=class O6{static create(e,r,i=null){const s=Yr(e.spatialReference),n=r.origin||ac(e.origin.x,e.origin.y),o=ac(e.size[0]*r.resolution,e.size[1]*r.resolution),l=ac(-1/0,-1/0),u=ac(1/0,1/0),d=ac(1/0,1/0);i!=null&&(yl(l,Math.max(0,Math.floor((i.xmin-n[0])/o[0])),Math.max(0,Math.floor((n[1]-i.ymax)/o[1]))),yl(u,Math.max(0,Math.floor((i.xmax-n[0])/o[0])),Math.max(0,Math.floor((n[1]-i.ymin)/o[1]))),yl(d,u[0]-l[0]+1,u[1]-l[1]+1));const{cols:p,rows:f}=r;let m,y,g,v;return!i&&p&&f&&(yl(l,p[0],f[0]),yl(u,p[1],f[1]),yl(d,p[1]-p[0]+1,f[1]-f[0]+1)),e.isWrappable?(m=ac(Math.ceil(Math.round((s.valid[1]-s.valid[0])/r.resolution)/e.size[0]),d[1]),y=!0,g=s.origin,v=s.valid):(m=d,y=!1),new O6(r.level,r.resolution,r.scale,n,l,u,d,o,m,y,g,v)}constructor(e,r,i,s,n,o,l,u,d,p,f,m){this.level=e,this.resolution=r,this.scale=i,this.origin=s,this.first=n,this.last=o,this.size=l,this.norm=u,this.worldSize=d,this.wrap=p,this._spatialReferenceOrigin=f,this._spatialReferenceValid=m}normalizeCol(e){if(!this.wrap)return e;const r=this.worldSize[0];return e<0?r-1-Math.abs((e+1)%r):e%r}normalizeKey(e){if(!this.wrap)return;const r=this.worldSize[0],i=e.col;i<0?(e.col=i+r,e.world-=1):i>=r&&(e.col=i-r,e.world+=1)}denormalizeCol(e,r){return this.wrap?this.worldSize[0]*r+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){const r=this.origin[0]+e*this.norm[0],i=this._spatialReferenceOrigin,s=this._spatialReferenceValid;return this.wrap&&i&&s?r===i[0]?s[0]:this.origin[0]===i[0]&&e===this.worldSize[0]?s[1]:r:r}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,r,i=!1){ks.set(r);const s=i?ks.col:this.denormalizeCol(ks.col,ks.world),n=ks.row;return Nle(e,this.getXForColumn(s),this.getYForRow(n+1),this.getXForColumn(s+1),this.getYForRow(n)),e}getTileCoords(e,r,i=!1){ks.set(r);const s=i?ks.col:this.denormalizeCol(ks.col,ks.world);return Array.isArray(e)?yl(e,this.getXForColumn(s),this.getYForRow(ks.row)):(e.x=this.getXForColumn(s),e.y=this.getYForRow(ks.row)),e}};var $u;let s3=($u=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}*keys(){const e=this.lodInfo;for(const{row:r,colFrom:i,colTo:s}of this.spans)for(let n=i;n<=s;n++){const o=e.getWorldForColumn(n);yield new sp(e.level,r,e.normalizeCol(n),o)}}forEach(e,r){const{spans:i,lodInfo:s}=this,{level:n}=s;if(i.length!==0)for(const{row:o,colFrom:l,colTo:u}of i)for(let d=l;d<=u;d++)e.call(r,n,o,s.normalizeCol(d),s.getWorldForColumn(d))}},$u.pool=new Uh(()=>new $u),$u),k1=class{constructor(e,r,i){this.row=e,this.colFrom=r,this.colTo=i}};const Qe=new sp("0/0/0/0");let jle=class k6{static create(e,r){e[1]>r[1]&&([e,r]=[r,e]);const[i,s]=e,[n,o]=r,l=n-i,u=o-s,d=u!==0?l/u:0,p=(Math.ceil(s)-s)*d,f=(Math.floor(s)-s)*d;return new k6(i,Math.floor(s),Math.ceil(o),d,l<0?p:f,l<0?f:p,l<0?n:i,l<0?i:n)}constructor(e,r,i,s,n,o,l,u){this.x=e,this.ymin=r,this.ymax=i,this.invM=s,this.leftAdjust=n,this.rightAdjust=o,this.leftBound=l,this.rightBound=u}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const Si=[[0,0],[0,0],[0,0],[0,0]],Vle=1e-6;let zle=class{constructor(e,r=null,i=e.lods[0].level,s=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=r,this.scales=[],this._infoByScale={},this._infoByLevel={};const n=e.lods.filter(l=>l.level>=i&&l.level<=s);this.minScale=n[0].scale,this.maxScale=n[n.length-1].scale;const o=this._lodInfos=n.map(l=>Dle.create(e,l,r));n.forEach((l,u)=>{this._infoByLevel[l.level]=o[u],this._infoByScale[l.scale]=o[u],this.scales[u]=l.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,r,i=!1){Qe.set(r);const s=this._infoByLevel[Qe.level];return s?s.getTileBounds(e,Qe,i):e}getTileCoords(e,r,i=!1){Qe.set(r);const s=this._infoByLevel[Qe.level];return s?s.getTileCoords(e,Qe,i):e}getTileCoverage(e,r=192,i=!0,s="closest"){if(!i&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const n=s==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),o=s3.pool.acquire(n),l=this._wrap;let u,d,p,f=1/0,m=-1/0;const y=o.spans;Si[0][0]=Si[0][1]=Si[1][1]=Si[3][0]=-r,Si[1][0]=Si[2][0]=e.size[0]+r,Si[2][1]=Si[3][1]=e.size[1]+r;for(const S of Si)e.toMap(S,S),S[0]=n.getColumnForX(S[0]),S[1]=n.getRowForY(S[1]);const g=[];let v=3;for(let S=0;S<4;S++){if(Si[S][1]===Si[v][1]){v=S;continue}const M=jle.create(Si[S],Si[v]);f=Math.min(M.ymin,f),m=Math.max(M.ymax,m),g[M.ymin]===void 0&&(g[M.ymin]=[]),g[M.ymin].push(M),v=S}if(f==null||m==null||m-f>100)return null;let _=[];for(u=f;u<m;){g[u]!=null&&(_=_.concat(g[u])),d=1/0,p=-1/0;for(let S=_.length-1;S>=0;S--){const M=_[S];d=Math.min(d,M.getLeftCol()),p=Math.max(p,M.getRightCol())}if(d=Math.floor(d),p=Math.floor(p),u>=n.first[1]&&u<=n.last[1])if(l)if(n.size[0]<n.worldSize[0]){const S=Math.floor(p/n.worldSize[0]);for(let M=Math.floor(d/n.worldSize[0]);M<=S;M++)y.push(new k1(u,Math.max(n.getFirstColumnForWorld(M),d),Math.min(n.getLastColumnForWorld(M),p)))}else y.push(new k1(u,d,p));else d>n.last[0]||p<n.first[0]||(d=Math.max(d,n.first[0]),p=Math.min(p,n.last[0]),y.push(new k1(u,d,p)));u+=1;for(let S=_.length-1;S>=0;S--){const M=_[S];M.ymax>=u?M.incrRow():_.splice(S,1)}}return o}getTileParentId(e){Qe.set(e);const r=this._infoByLevel[Qe.level],i=this._lodInfos.indexOf(r)-1;return i<0?null:(this._getTileIdAtLOD(Qe,this._lodInfos[i],Qe),Qe.id)}getTileResolution(e){const r=this._infoByLevel[typeof e=="object"?e.level:e];return r?r.resolution:-1}getTileScale(e){const r=this._infoByLevel[e.level];return r?r.scale:-1}intersects(e,r){Qe.set(r);const i=this._infoByLevel[Qe.level],s=e.lodInfo;if(s.resolution>i.resolution){this._getTileIdAtLOD(Qe,s,Qe);const o=s.denormalizeCol(Qe.col,Qe.world);for(const l of e.spans)if(l.row===Qe.row&&l.colFrom<=o&&l.colTo>=o)return!0}if(s.resolution<i.resolution){const[o,l,u,d]=e.spans.reduce((v,_)=>(v[0]=Math.min(v[0],_.row),v[1]=Math.max(v[1],_.row),v[2]=Math.min(v[2],_.colFrom),v[3]=Math.max(v[3],_.colTo),v),[1/0,-1/0,1/0,-1/0]),p=i.denormalizeCol(Qe.col,Qe.world),f=s.getColumnForX(i.getXForColumn(p)),m=s.getRowForY(i.getYForRow(Qe.row)),y=s.getColumnForX(i.getXForColumn(p+1))-1,g=s.getRowForY(i.getYForRow(Qe.row+1))-1;return!(f>d||y<u||m>l||g<o)}const n=s.denormalizeCol(Qe.col,Qe.world);return e.spans.some(o=>o.row===Qe.row&&o.colFrom<=n&&o.colTo>=n)}normalizeBounds(e,r,i){if(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],this._wrap){const s=Yr(this.tileInfo.spatialReference),n=-i*(s.valid[1]-s.valid[0]);e[0]+=n,e[2]+=n}return e}getSmallestInfoForScale(e){const r=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>r[0])return this._infoByScale[r[0]];for(let i=1;i<r.length-1;i++)if(e>r[i]+Vle)return this._infoByScale[r[i-1]];return this._infoByScale[r[r.length-1]]}getClosestInfoForScale(e){const r=this.scales;return this._infoByScale[e]||(e=r.reduce((i,s)=>Math.abs(s-e)<Math.abs(i-e)?s:i,r[0])),this._infoByScale[e]}scaleToLevel(e){const r=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let i=r.length-1;i>=0;i--)if(e<r[i])return i===r.length-1?this._infoByScale[r[r.length-1]].level:this._infoByScale[r[i]].level+(r[i]-e)/(r[i]-r[i+1]);return this._infoByScale[r[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}zoomToScale(e){return this.tileInfo.zoomToScale(e)}_getTileIdAtLOD(e,r,i){const s=this._infoByLevel[i.level];return e.set(i),r.resolution<s.resolution?null:(r.resolution===s.resolution||(e.level=r.level,e.col=Math.floor(i.col*s.resolution/r.resolution+.01),e.row=Math.floor(i.row*s.resolution/r.resolution+.01)),e)}},Ule=class{constructor(e,r){this.item=e,this.controller=r,this.promise=null}},qle=class{constructor(e){this._schedule=null,this._task=null,this._deferreds=new Nd,this._controllers=new Nd,this._processingItems=new Nd,this._pausedSignal=kh(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new Om(e.peeker),this.process=e.process;const r=e.scheduler;e.priority&&r&&(this._task=r.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=He(this._schedule),this._task=He(this._task)}get updating(){return!!this._task?.updating||this.readyToRun}get length(){return this._processingItems.size+this._queue.length}abort(e){const r=this._controllers.get(e);r&&r.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(r=>e.push(r)),this._controllers.clear(),e.forEach(r=>r.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((r,i)=>e(i))}get(e){const r=this._deferreds.get(e);return r?r.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,r){const i=this.get(e);if(i)return i;const s=new AbortController;let n=null;r&&(n=ys(r,()=>s.abort()));const o=()=>{const p=this._processingItems.get(e);p&&p.controller.abort(),l(),d.reject(Fe())},l=()=>{u.remove(),n?.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},u=pT(s.signal,o),d=wi();return this._deferreds.set(e,d),this._controllers.set(e,s),d.promise.then(l,l),this._queue.push(e),this._scheduleNext(),d.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){const e=this._queue.popLast();return e&&(this._deferreds.get(e)?.reject(Fe()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const r of e)this._queue.push(r.item),r.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get readyToRun(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=Bh(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,r){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(r))}_processError(e,r){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(r))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let r;const i=new AbortController,s=new Ule(e,i);this._processingItems.set(e,s);try{r=this.process(e,i.signal)}catch(n){this._processError(s,n)}Pr(r)?(s.promise=r,r.then(n=>this._processResult(s,n),n=>this._processError(s,n))):this._processResult(s,r)}get test(){}};const aC=[0,0];let no=class extends X{constructor(e){super(e),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:e,process:r,scheduler:i,priority:s}=this;this._queue=new qle({concurrency:e,scheduler:i,priority:s,process:(n,o)=>{const l=this._keyToItem.get(n);return r(l,{signal:o})},peeker:n=>this._peek(n)})}destroy(){this.clear(),this._queue=Ke(this._queue)}get length(){return this._queue?this._queue.length:0}abort(e){const r=typeof e=="string"?e:e.id;this._queue.abort(r)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}pause(){this._queue.pause()}push(e){const r=e.key.id;if(this._queue.has(r))return this._queue.get(r);const i=this._queue.push(r),s=this.tileInfoView.getTileScale(e.key),n=jh(this._tilesByScale,s,()=>new Set),o=()=>{n.delete(e.key),n.size===0&&this._tilesByScale.delete(s),this._keyToItem.delete(r)};return n.add(e.key),this._keyToItem.set(r,e),i.then(o,o),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(e){if(!this.state)return e.values().next().value;const r=new Set;for(const o of e)r.add(this._keyToItem.get(o).key);const i=this.state.scale;let s,n=Number.POSITIVE_INFINITY;for(const[o,l]of this._tilesByScale)if(eL(l,u=>r.has(u))){const u=Math.abs(o-i);u<n&&(s=l,n=u)}return this._getClosestTileKey(s,e).id}_getClosestTileKey(e,r){const i=this.tileInfoView,s=this.state.center;let n,o=Number.POSITIVE_INFINITY;for(const l of e)if(r.has(l.id)){i.getTileCoords(aC,l);const u=zw(aC,s);u<o&&(o=u,n=l)}return n}};a([c({constructOnly:!0})],no.prototype,"concurrency",void 0),a([c({constructOnly:!0})],no.prototype,"priority",void 0),a([c({constructOnly:!0})],no.prototype,"process",void 0),a([c({constructOnly:!0})],no.prototype,"scheduler",void 0),a([c()],no.prototype,"state",void 0),a([c({constructOnly:!0})],no.prototype,"tileInfoView",void 0),no=a([b("esri.views.2d.tiling.TileQueue")],no);const xTe=no;let Gle=class{constructor(e,r,i){this.maxSize=e,this._tileInfoView=r,this._removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const r=this._tilePerId.get(e);if(!r)return;const i=r.key.level,s=this._tileKeysPerLevel[i];lC(this._tilePerId,e);for(let n=0;n<s.length;n++)if(s[n].id===e){s.splice(n,1);break}return r.visible=!0,r}add(e){e.visible=!1;const r=e.key,i=r.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,e);const s=r.level;this._tileKeysPerLevel[s]||(this._tileKeysPerLevel[s]=[]),this._tileKeysPerLevel[s].push(r)}prune(e,r,i){let s=this._tilePerId.size;if(s<=this.maxSize)return;let n=this._tileKeysPerLevel.length-1;for(;s>this.maxSize&&n>=0;)n!==e&&(s=this._pruneAroundCenterTile(s,r,i,n)),n--;s>this.maxSize&&(s=this._pruneAroundCenterTile(s,r,i,e))}_pruneAroundCenterTile(e,r,i,s){const n=this._tileKeysPerLevel[s];if(!n||n.length===0)return e;const{size:o,origin:l}=this._tileInfoView.tileInfo,u=i*o[0],d=i*o[1],p=[0,0],f=[0,0];for(n.sort((m,y)=>(p[0]=l.x+u*(m.col+.5),p[1]=l.y-d*(m.row+.5),f[0]=l.x+u*(y.col+.5),f[1]=l.y-d*(y.row+.5),$m(p,r)-$m(f,r)));n.length>0;){const m=n.pop();if(this._removeTile(m.id),--e===this.maxSize)break}return e}_removeTile(e){const r=this._tilePerId.get(e);this._removedFunc&&r&&this._removedFunc(r),lC(this._tilePerId,e)}};function lC(t,e){t.delete(e)}const gl=new sp(0,0,0,0),Bn=new Map,kp=[],C1=[];let MTe=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new Gle(e.cacheSize,this.tileInfoView,r=>{this.releaseTile(r)}))}destroy(){this.tileIndex.clear()}update(e){const{resampling:r,tileIndex:i}=this,{scale:s,center:n,resolution:o}=e.state,{minScale:l,maxScale:u}=this.tileInfoView,d=!e.stationary&&s>this._previousScale;if(this._previousScale=s,!r&&(s>l||s<u))return this.tiles.length=0,void this.clear();const p=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!p)return this.tiles.length=0,void this.clear();const{spans:f,lodInfo:m}=p,{level:y}=m;this.tiles.length=0,i.forEach(S=>S.visible=!0);let g=0,v=0;if(f.length>0)for(const{row:S,colFrom:M,colTo:C}of f)for(let T=M;T<=C;T++){g++;const O=gl.set(y,S,m.normalizeCol(T),m.getWorldForColumn(T)).id;let P=i.get(O);if(P)P.isReady?(Bn.set(O,P),v++):d||this._addParentTile(O,Bn);else{if(this._tileCache?.has(O)){if(P=this._tileCache.pop(O),this.tileIndex.set(O,P),P.isReady){Bn.set(O,P),v++;continue}}else P=this.acquireTile(gl),this.tileIndex.set(O,P);d||this._addParentTile(O,Bn)}}const _=v===g;for(const[S,M]of i){if(Bn.has(S))continue;gl.set(S);const C=this.tileInfoView.intersects(p,gl),T=this.cachePolicy==="purge"?gl.level!==y:gl.level>y;!C||!d&&_?!T&&C||kp.push(M):M.isReady?T&&this.cachePolicy==="purge"&&this._hasReadyAncestor(gl,y)?kp.push(M):C1.push(M):T&&kp.push(M)}for(const S of C1)S.isReady&&Bn.set(S.key.id,S);for(const S of kp)this._tileCache?this._tileCache.add(S):this.releaseTile(S),i.delete(S.key.id);for(const S of Bn.values())this.tiles.push(S);for(const S of i.values())Bn.has(S.key.id)||(S.visible=!1);this._tileCache?.prune(y,n,o),s3.pool.release(p),C1.length=0,kp.length=0,Bn.clear()}clear(){const{tileIndex:e}=this;for(const r of e.values())this.releaseTile(r);e.clear()}refresh(e){for(const r of this.tileIndex.values())e(r);this._tileCache?.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,r){let i=e,s=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(s=this.tileIndex.get(i),s?.isReady){r.has(s.key.id)||r.set(s.key.id,s);break}}else if(this._tileCache?.has(i)&&(s=this._tileCache.pop(i),this.tileIndex.set(i,s),s?.isReady)){r.has(s.key.id)||r.set(s.key.id,s);break}}_hasReadyAncestor(e,r){const i=mi();this.tileInfoView.getTileBounds(i,e,!0);for(const s of this.tileIndex.values())if(s.isReady&&s.key.level>=r&&s.key.level<e.level){const n=mi();if(this.tileInfoView.getTileBounds(n,s.key,!0),iY(n,i))return!0}return!1}};const Ble={"area-measurement":null,dimension:null,"direct-line-measurement":null,"elevation-profile":()=>N(()=>import("./ElevationProfileAnalysisView2D-Dx7DFNGw.js"),__vite__mapDeps([278,123,168,272,279,220,280,281,282,283,284,285,17,286,287,288,289,290,111,112,291,292,293,14,294,295,135,65,117,118,131,170,63,296,104,144,149,130])),"line-of-sight":null,slice:null,viewshed:null,"volume-measurement":null};function Hle(t){const e=Ble[t.type];if(!e)throw new x("analysis-view-module-import-utils:analysis-not-supported",`Analysis "${t.type}" is not supported`);return e()}let Wle=class{constructor(e,r={}){this.events=new _L,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,e!=null?(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform"),e.contains(this._canvas)||e.appendChild(this._canvas)):r.canvas!=null&&(this._canvas=r.canvas);const i={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};let s=this._canvas.getContext("webgl2",i);s||(s=this._canvas.getContext("webgl2",{...i,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=s,this._handles=Uu([zh(this._canvas,"webglcontextlost",n=>this.events.emit("webgl-context-lost",n))])}destroy(){this._canvas.remove(),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}get canvas(){return this._canvas}render(e,r){if(this._hasMajorPerformanceCaveat||k("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=k("esri-performance-mode-frames-between-render")&&(r(),this._lastRenderViewState=e.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[i,s,n,o,l,u]=this._computeViewTransform(this._lastRenderViewState,e.state);this._canvas.style.transform=`matrix(${i}, ${s}, ${n}, ${o}, ${l}, ${u})`}}else r()}resize(e){const r=this._canvas,i=r.style,{state:{size:s},pixelRatio:n}=e,o=s[0],l=s[1],u=Math.round(o*n),d=Math.round(l*n);r.width===u&&r.height===d||(r.width=u,r.height=d),i.width=o+"px",i.height=l+"px"}_computeViewTransform(e,r){const[i,s]=e.center,[n,o]=r.center,[l,u]=e.toScreen([0,0],n,o),[d,p]=e.toScreen([0,0],i,s),f=d-l,m=p-u,y=e.scale/r.scale,g=r.rotation-e.rotation,v=Ln();return Dj(v),rb(v,v,[y,y]),vy(v,v,ny(g)),Ah(v,v,[f,m]),v}};function Zle(t,e,r,i,s){C6(t,e,r||0,i||t.length-1,s||Jle)}function C6(t,e,r,i,s){for(;i>r;){if(i-r>600){var n=i-r+1,o=e-r+1,l=Math.log(n),u=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*u*(n-u)/n)*(o-n/2<0?-1:1);C6(t,e,Math.max(r,Math.floor(e-o*u/n+d)),Math.min(i,Math.floor(e+(n-o)*u/n+d)),s)}var p=t[e],f=r,m=i;for(Cp(t,r,e),s(t[i],p)>0&&Cp(t,r,i);f<m;){for(Cp(t,f,m),f++,m--;s(t[f],p)<0;)f++;for(;s(t[m],p)>0;)m--}s(t[r],p)===0?Cp(t,r,m):Cp(t,++m,i),m<=e&&(r=m+1),e<=m&&(i=m-1)}}function Cp(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function Jle(t,e){return t<e?-1:t>e?1:0}function Yv(t,e){if(!(this instanceof Yv))return new Yv(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function Yle(t,e,r){if(!r)return e.indexOf(t);for(var i=0;i<e.length;i++)if(r(t,e[i]))return i;return-1}function lc(t,e){mf(t,0,t.children.length,e,t)}function mf(t,e,r,i,s){s||(s=Dc(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var n,o=e;o<r;o++)n=t.children[o],yf(s,t.leaf?i(n):n);return s}function yf(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function uC(t,e){return t.minX-e.minX}function cC(t,e){return t.minY-e.minY}function P1(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function og(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Kle(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function Qle(t,e){var r=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),n=Math.min(t.maxY,e.maxY);return Math.max(0,s-r)*Math.max(0,n-i)}function A1(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function ag(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Dc(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function dC(t,e,r,i,s){for(var n,o=[e,r];o.length;)(r=o.pop())-(e=o.pop())<=i||(n=e+Math.ceil((r-e)/i/2)*i,Zle(t,n,e,r,s),o.push(e,n,n,r))}Yv.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],i=this.toBBox;if(!ag(t,e))return r;for(var s,n,o,l,u=[];e;){for(s=0,n=e.children.length;s<n;s++)o=e.children[s],ag(t,l=e.leaf?i(o):o)&&(e.leaf?r.push(o):A1(t,l)?this._all(o,r):u.push(o));e=u.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!ag(t,e))return!1;for(var i,s,n,o,l=[];e;){for(i=0,s=e.children.length;i<s;i++)if(n=e.children[i],ag(t,o=e.leaf?r(n):n)){if(e.leaf||A1(t,o))return!0;l.push(n)}e=l.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var s=this.data;this.data=i,i=s}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t!=null&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Dc([]),this},remove:function(t,e){if(t==null)return this;for(var r,i,s,n,o=this.data,l=this.toBBox(t),u=[],d=[];o||u.length;){if(o||(o=u.pop(),i=u[u.length-1],r=d.pop(),n=!0),o.leaf&&(s=Yle(t,o.children,e))!==-1)return o.children.splice(s,1),u.push(o),this._condense(u),this;n||o.leaf||!A1(o,l)?i?(r++,o=i.children[r],n=!1):o=null:(u.push(o),d.push(r),r=0,i=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:uC,compareMinY:cC,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,i){var s,n=r-e+1,o=this._maxEntries;if(n<=o)return lc(s=Dc(t.slice(e,r+1)),this.toBBox),s;i||(i=Math.ceil(Math.log(n)/Math.log(o)),o=Math.ceil(n/Math.pow(o,i-1))),(s=Dc([])).leaf=!1,s.height=i;var l,u,d,p,f=Math.ceil(n/o),m=f*Math.ceil(Math.sqrt(o));for(dC(t,e,r,m,this.compareMinX),l=e;l<=r;l+=m)for(dC(t,l,d=Math.min(l+m-1,r),f,this.compareMinY),u=l;u<=d;u+=f)p=Math.min(u+f-1,d),s.children.push(this._build(t,u,p,i-1));return lc(s,this.toBBox),s},_chooseSubtree:function(t,e,r,i){for(var s,n,o,l,u,d,p,f;i.push(e),!e.leaf&&i.length-1!==r;){for(p=f=1/0,s=0,n=e.children.length;s<n;s++)u=P1(o=e.children[s]),(d=Kle(t,o)-u)<f?(f=d,p=u<p?u:p,l=o):d===f&&u<p&&(p=u,l=o);e=l||e.children[0]}return e},_insert:function(t,e,r){var i=this.toBBox,s=r?t:i(t),n=[],o=this._chooseSubtree(s,this.data,e,n);for(o.children.push(t),yf(o,s);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(s,n,e)},_split:function(t,e){var r=t[e],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);var n=this._chooseSplitIndex(r,s,i),o=Dc(r.children.splice(n,r.children.length-n));o.height=r.height,o.leaf=r.leaf,lc(r,this.toBBox),lc(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(r,o)},_splitRoot:function(t,e){this.data=Dc([t,e]),this.data.height=t.height+1,this.data.leaf=!1,lc(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var i,s,n,o,l,u,d,p;for(u=d=1/0,i=e;i<=r-e;i++)o=Qle(s=mf(t,0,i,this.toBBox),n=mf(t,i,r,this.toBBox)),l=P1(s)+P1(n),o<u?(u=o,p=i,d=l<d?l:d):o===u&&l<d&&(d=l,p=i);return p},_chooseSplitAxis:function(t,e,r){var i=t.leaf?this.compareMinX:uC,s=t.leaf?this.compareMinY:cC;this._allDistMargin(t,e,r,i)<this._allDistMargin(t,e,r,s)&&t.children.sort(i)},_allDistMargin:function(t,e,r,i){t.children.sort(i);var s,n,o=this.toBBox,l=mf(t,0,e,o),u=mf(t,r-e,r,o),d=og(l)+og(u);for(s=e;s<r-e;s++)n=t.children[s],yf(l,t.leaf?o(n):n),d+=og(l);for(s=r-e-1;s>=e;s--)n=t.children[s],yf(u,t.leaf?o(n):n),d+=og(u);return d},_adjustParentBBoxes:function(t,e,r){for(var i=r;i>=0;i--)yf(e[i],t)},_condense:function(t){for(var e,r=t.length-1;r>=0;r--)t[r].children.length===0?r>0?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():lc(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};function Xle(t,{timeZone:e,timeExtent:r}){return{$view:{scale:t,timeZone:e,timeProperties:{currentStart:r?.start,currentEnd:r?.end}}}}let hC=class P6{constructor(e,r){this.key=new sp(0,0,0,0),this.bounds=mi(),this.objectIds=new Set,this.key.set(r);const i=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.level=i.level,this.scale=i.scale,this.minScale=e.zoomToScale(i.level-1),this.maxScale=e.zoomToScale(i.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return eY(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(e){return Xle(this.scale,e)}createChildTiles(){const e=this.key.getChildKeys(),r=Gr.acquire();for(let i=0;i<e.length;i++)r[i]=new P6(this.tileInfoView,e[i]);return r}getQuantizationParameters(){return _a.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const vl={added:[],removed:[]},R1=new Set,eue=new sp(0,0,0,0);function tue(t,e){const r=Yr(e);if(!r)return null;const[i,s]=r.valid;return t[2]>s?[mi([t[0],t[1],s,t[3]]),mi([i,t[1],i+t[2]-s,t[3]])]:t[0]<i?[mi([i,t[1],t[2],t[3]]),mi([s-(i-t[0]),t[1],s,t[3]])]:null}let rue=class extends bL{constructor(e){super(),this._tiles=new Map,this._index=Yv(9,k("esri-csp-restrictions")?r=>({minX:r.bounds[0],minY:r.bounds[1],maxX:r.bounds[2],maxY:r.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){super.destroy(),this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||lM(e)===0||uM(e)===0)return[];const r=tue(e,this.tileScheme.spatialReference);return r!=null?[...new Set([...this.boundsIntersections(r[0]),...this.boundsIntersections(r[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const r={added:[],removed:[]};for(const i of e.added)if(!this.has(i)){const s=new hC(this.tileScheme,i);this._tiles.set(i,s),this._index.insert(s),r.added.push(s)}for(const i of e.removed)if(this.has(i)){const s=this.get(i);this._tiles.delete(i),this._index.remove(s),r.removed.push(s)}this.tiles.length=0,this._tiles.forEach(i=>this.tiles.push(i)),(r.added.length||r.removed.length)&&this.emit("update",r)}setViewState(e){const r=this.tileScheme.getTileCoverage(e,0);if(!r)return;const{spans:i,lodInfo:s}=r,{level:n}=s;if(i.length>0)for(const{row:o,colFrom:l,colTo:u}of i)for(let d=l;d<=u;d++){const p=eue.set(n,o,s.normalizeCol(d),s.getWorldForColumn(d)).id;if(R1.add(p),!this.has(p)){const f=new hC(this.tileScheme,p);this._tiles.set(p,f),this._index.insert(f),this.tiles.push(f),vl.added.push(f)}}for(let o=this.tiles.length-1;o>=0;o--){const l=this.tiles[o];R1.has(l.id)||(this._tiles.delete(l.id),this.tiles.splice(o,1),this._index.remove(l),vl.removed.push(l))}(vl.added.length||vl.removed.length)&&this.emit("update",vl),s3.pool.release(r),R1.clear(),vl.added.length=0,vl.removed.length=0}};const kTe=1e-30,pC=512,lg=16777216,CTe=8,PTe=29,ATe=24,RTe=4,LTe=0,FTe=0,NTe=0,DTe=1,jTe=2,VTe=3,zTe=4,UTe=5,qTe=6,GTe=12,BTe=13,HTe=5,iue=6,WTe=5,ZTe=6,A6=6,sue=1<<A6,JTe=sue<<1,YTe=1.05,KTe=3,QTe=1,XTe=3,eMe=3,tMe=5,rMe=6,iMe=1.15,nue=4,sMe=128,oue=256,nMe=oue-2*nue,oMe=2,aMe=128,lMe=1,uMe=10,cMe=1024,dMe=128,hMe=4,pMe=1,fMe=1<<20,mMe=.75,yMe=10,gMe=.75,vMe=256,wMe=32,bMe=512,_Me=0,SMe=1,aue=1,$Me=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],xMe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Pp=256,lue=()=>L.getLogger("esri.views.webgl.checkWebGLError");function R6(t){switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const L6=!!k("enable-feature:webgl-debug");function F6(){return L6}function TMe(){return L6}function wl(t,e=F6()){if(e){const r=R6(t);if(r){const i=new Error().stack;lue().error(new x("webgl-error","WebGL error occurred",{message:r,stack:i}))}}}const MMe={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},bl={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131},ie={RGBA4:32854,R16F:33325,RG16F:33327,RGB32F:34837,RGBA16F:34842,R32F:33326,RG32F:33328,RGBA32F:34836,R11F_G11F_B10F:35898,RGB8:32849,RGBA8:32856,RGB5_A1:32855,R8:33321,RG8:33323,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,RGB16F:34843,RGB9_E5:35901,SRGB8:35905,SRGB8_ALPHA8:35907,RGB565:36194,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2:32857,RGB10_A2UI:36975},uue=Object.values(ie),Kv={DEPTH24_STENCIL8:35056,DEPTH32F_STENCIL8:36013},nm={DEPTH_COMPONENT16:33189,DEPTH_COMPONENT24:33190,DEPTH_COMPONENT32F:36012},T$={FLOAT:bl.FLOAT,UNSIGNED_BYTE:bl.UNSIGNED_BYTE,UNSIGNED_INT_24_8:34042,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,BYTE:bl.BYTE,UNSIGNED_SHORT:bl.UNSIGNED_SHORT,SHORT:bl.SHORT,UNSIGNED_INT:bl.UNSIGNED_INT,INT:bl.INT,HALF_FLOAT:5131,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269},IMe=33984,fC={Texture:0,TileTexture:1,BufferObject:2,VertexArrayObject:3,Shader:4,Program:5,FramebufferObject:6,Renderbuffer:7,TransformFeedback:8,Sync:9,UNCOUNTED:10,LinesOfCode:10,Uniform:11,COUNT:12},EMe=1029,OMe=0,kMe=36064,CMe=36065,PMe=36066,AMe=36067,RMe=33306,LMe=36096,FMe=36128,br={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497};function NMe(t,e,r,i=0){const s=t.gl;t.bindBuffer(r);for(const n of r.layout){const o=e.get(n.name);if(o==null){console.warn(`There is no location for vertex attribute '${n.name}' defined.`);continue}const l=i*n.stride;if(n.count<=4)s.vertexAttribPointer(o,n.count,n.type,n.normalized,n.stride,n.offset+l),s.enableVertexAttribArray(o),n.divisor>0&&s.vertexAttribDivisor(o,n.divisor);else if(n.count===9)for(let u=0;u<3;u++)s.vertexAttribPointer(o+u,3,n.type,n.normalized,n.stride,n.offset+12*u+l),s.enableVertexAttribArray(o+u),n.divisor>0&&s.vertexAttribDivisor(o+u,n.divisor);else if(n.count===16)for(let u=0;u<4;u++)s.vertexAttribPointer(o+u,4,n.type,n.normalized,n.stride,n.offset+16*u+l),s.enableVertexAttribArray(o+u),n.divisor>0&&s.vertexAttribDivisor(o+u,n.divisor);else console.error("Unsupported vertex attribute element count: "+n.count);if(F6()){const u=R6(t.gl);u&&console.error(`Unable to bind vertex attribute "${n.name}" with baseInstanceOffset ${l}:`,u,n)}}}function DMe(t){switch(t){case 6406:case 6409:case 6403:case 36244:case 6402:case 34041:return 1;case 6410:case 33319:case 33320:return 2;case 6407:case 36248:return 3;case 6408:case 36249:return 4}return 0}function cue(t){switch(t){case 6406:case 6409:case 6403:case 36244:case ie.R8:case ie.R8I:case ie.R8UI:case ie.R8_SNORM:case 36168:return 1;case 6410:case 33319:case 33320:case ie.RGBA4:case ie.R16F:case ie.R16I:case ie.R16UI:case ie.RG8:case ie.RG8I:case ie.RG8UI:case ie.RG8_SNORM:case ie.RGB565:case ie.RGB5_A1:case nm.DEPTH_COMPONENT16:return 2;case 6407:case 36248:case ie.RGB8:case ie.RGB8I:case ie.RGB8UI:case ie.RGB8_SNORM:case ie.SRGB8:case nm.DEPTH_COMPONENT24:return 3;case 6408:case 36249:case ie.RGBA8:case ie.R32F:case ie.R11F_G11F_B10F:case ie.RG16F:case ie.R32I:case ie.R32UI:case ie.RG16I:case ie.RG16UI:case ie.RGBA8I:case ie.RGBA8UI:case ie.RGBA8_SNORM:case ie.SRGB8_ALPHA8:case ie.RGB9_E5:case ie.RGB10_A2UI:case ie.RGB10_A2:case nm.DEPTH_COMPONENT32F:case Kv.DEPTH24_STENCIL8:return 4;case Kv.DEPTH32F_STENCIL8:return 5;case ie.RGB16F:case ie.RGB16I:case ie.RGB16UI:return 6;case ie.RG32F:case ie.RG32I:case ie.RG32UI:case ie.RGBA16F:case ie.RGBA16I:case ie.RGBA16UI:return 8;case ie.RGB32F:case ie.RGB32I:case ie.RGB32UI:return 12;case ie.RGBA32F:case ie.RGBA32I:case ie.RGBA32UI:return 16;case br.COMPRESSED_RGB_S3TC_DXT1_EXT:case br.COMPRESSED_RGBA_S3TC_DXT1_EXT:return .5;case br.COMPRESSED_RGBA_S3TC_DXT3_EXT:case br.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case br.COMPRESSED_R11_EAC:case br.COMPRESSED_SIGNED_R11_EAC:case br.COMPRESSED_RGB8_ETC2:case br.COMPRESSED_SRGB8_ETC2:case br.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case br.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return .5;case br.COMPRESSED_RG11_EAC:case br.COMPRESSED_SIGNED_RG11_EAC:case br.COMPRESSED_RGBA8_ETC2_EAC:case br.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}let N6=class{constructor(e=0,r=e){this.width=e,this.height=r,this.type=0,this.target=3553,this.pixelFormat=6408,this.dataType=T$.UNSIGNED_BYTE,this.samplingMode=9729,this.wrapMode=10497,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.compareEnabled=!1,this.linearFilterDepth=!1,this.depth=1,this.isImmutable=!1}};function due(t){return t.width<=0||t.height<=0||t.depth<=0?0:Math.round(t.width*t.height*t.depth*(t.hasMipmap?4/3:1)*(t.internalFormat==null?4:cue(t.internalFormat))*(t.target===34067?6:1))}const Ap=()=>L.getLogger("esri/views/webgl/textureUtils");function Rp(t){const{width:e,height:r,depth:i}=t;(e!=null&&e<0||r!=null&&r<0||i!=null&&i<0)&&Ap().error("Negative dimension parameters are not allowed!");const{internalFormat:s}=t;if(s&&(D6(s)||j6(s))){const{linearFilterDepth:n,compareEnabled:o,samplingMode:l,hasMipmap:u}=t;u&&Ap().error("Depth textures cannot have mipmaps"),n?l!==9729&&l!==9728&&Ap().error("Depth textures cannot sample mipmaps"):(l!==9728&&Ap().error("Depth textures without filtering must use NEAREST filtering"),o&&Ap().error("Depth textures without filtering cannot use compare function"))}}function hue(t){return uue.includes(t)}function D6(t){return hw(nm,t)}function j6(t){return hw(Kv,t)}function pue(t){return t!=null&&hw(br,t)}function jc(t){return t!=null&&"type"in t&&t.type==="compressed"}function fue(t){return t!=null&&"byteLength"in t}function mC(t){return t!=null&&!jc(t)&&!fue(t)}function uc(t){return t===32879||t===35866}function yC(t,e,r,i=1){let s=Math.max(e,r);return t===32879&&(s=Math.max(s,i)),Math.floor(Math.log2(s))+1}function ug(t){if(t.internalFormat!=null)return t.internalFormat;switch(t.dataType){case T$.FLOAT:switch(t.pixelFormat){case 6408:return ie.RGBA32F;case 6407:return ie.RGB32F;default:throw new x("texture:unknown-format","Unable to derive format")}case T$.UNSIGNED_BYTE:switch(t.pixelFormat){case 6408:return ie.RGBA8;case 6407:return ie.RGB8}}const{pixelFormat:e}=t;return t.internalFormat=e===34041?Kv.DEPTH24_STENCIL8:e===6402?nm.DEPTH_COMPONENT24:e,t.internalFormat}function mue(t){let e="width"in t?t.width:t.codedWidth,r="height"in t?t.height:t.codedHeight;return t instanceof HTMLVideoElement&&(e=t.videoWidth,r=t.videoHeight),{width:e,height:r,depth:1}}let yue=class V6 extends N6{constructor(e,r){switch(super(),this.context=e,Object.assign(this,r),this.internalFormat){case ie.R16F:case ie.R32F:case ie.R8_SNORM:case ie.R8:this.pixelFormat=6403;break;case ie.R8I:case ie.R8UI:case ie.R16I:case ie.R16UI:case ie.R32I:case ie.R32UI:this.pixelFormat=36244}}static validate(e,r){return new V6(e,r)}};const gue=!!k("esri-tests-disable-gpu-memory-measurements"),Hn=()=>L.getLogger("esri/views/webgl/Texture");var kt;let vue=(kt=class{constructor(e,r=null,i=null){if(this.type=1,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._shadowFilterDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,i=r;else{const s=yue.validate(e,r);if(!s)throw new x("texture:invalid-descriptor","Texture descriptor invalid");this._descriptor=s}this._descriptor.target===34067?this._setDataCubeMap(i):this.setData(i)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return gue?0:due(this._descriptor)}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty||this._shadowFilterDirty}get hasWebGLTextureObject(){return!!this._glName}dispose(){this.abortCompression(),this.hasWebGLTextureObject&&this._descriptor.context?.gl&&(this._descriptor.context.instanceCounter.decrement(fC.Texture,this),this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null,this._descriptor=null)}release(){this.dispose()}[Symbol.dispose](){this.dispose()}resize(e,r){const i=this._descriptor;if(i.width!==e||i.height!==r){if(this._wasImmutablyAllocated)throw new x("texture:immutable-resize","Immutable textures can't be resized!");i.width=e,i.height=r,this._descriptor.target===34067?this._setDataCubeMap(null):this.setData(null)}}enableCompression(e){this._descriptor.compress=e}disableCompression(){this._descriptor.compress=void 0}setData(e){this.abortCompression(),!jc(e)&&this._descriptor.internalFormat&&hw(br,this._descriptor.internalFormat)&&(this._descriptor.internalFormat=void 0),this._setData(e),!jc(e)&&this._descriptor.compress&&this._compressOnWorker(e)}updateData(e,r,i,s,n,o,l=0){o||Hn().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||Hn().error("An attempt to update uninitialized texture!");const u=this._descriptor;u.internalFormat=ug(u);const{context:d,pixelFormat:p,dataType:f,target:m,isImmutable:y}=u;if(y&&!this._wasImmutablyAllocated)throw new x("texture:uninitialized","Cannot update immutable texture before allocation!");const g=d.bindTexture(this,kt.TEXTURE_UNIT_FOR_UPDATES,!0);(r<0||i<0||r+s>u.width||i+n>u.height)&&Hn().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:v}=d;l&&(s&&n||Hn().warn("Must pass width and height if `UNPACK_SKIP_ROWS` is used"),v.pixelStorei(v.UNPACK_SKIP_ROWS,l)),mC(o)?v.texSubImage2D(m,e,r,i,s,n,p,f,o):jc(o)?v.compressedTexSubImage2D(m,e,r,i,s,n,u.internalFormat,o.levels[e]):v.texSubImage2D(m,e,r,i,s,n,p,f,o),l&&v.pixelStorei(v.UNPACK_SKIP_ROWS,0),d.bindTexture(g,kt.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,r,i,s,n,o,l,u){u||Hn().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||Hn().error("An attempt to update an uninitialized texture!");const d=this._descriptor;d.internalFormat=ug(d);const{context:p,pixelFormat:f,dataType:m,isImmutable:y,target:g}=d;if(y&&!this._wasImmutablyAllocated)throw new x("texture:uninitialized","Cannot update immutable texture before allocation!");uc(g)||Hn().warn("Attempting to set 3D texture data on a non-3D texture");const v=p.bindTexture(this,kt.TEXTURE_UNIT_FOR_UPDATES);p.setActiveTexture(kt.TEXTURE_UNIT_FOR_UPDATES),(r<0||i<0||s<0||r+n>d.width||i+o>d.height||s+l>d.depth)&&Hn().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:_}=p;if(jc(u))u=u.levels[e],_.compressedTexSubImage3D(g,e,r,i,s,n,o,l,d.internalFormat,u);else{const S=u;_.texSubImage3D(g,e,r,i,s,n,o,l,f,m,S)}p.bindTexture(v,kt.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(e.width===0||e.height===0)return;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new x("texture:immutable-change","Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,Rp(e)}e.samplingMode===9729?(this._samplingModeDirty=!0,e.samplingMode=9985):e.samplingMode===9728&&(this._samplingModeDirty=!0,e.samplingMode=9984);const r=this._descriptor.context.bindTexture(this,kt.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(kt.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(r,kt.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new x("texture:immutable-change","Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,Rp(e)}e.samplingMode===9985?(this._samplingModeDirty=!0,e.samplingMode=9729):e.samplingMode===9984&&(this._samplingModeDirty=!0,e.samplingMode=9728)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,Rp(this._descriptor),this._wrapModeDirty=!0)}setShadowFiltering(e){e!==this._descriptor.linearFilterDepth&&(this._descriptor.linearFilterDepth=this._descriptor.compareEnabled=e,this.setSamplingMode(e?9729:9728),Rp(this._descriptor),this._shadowFilterDirty=!0)}applyChanges(){this._samplingModeDirty&&(this._applySamplingMode(),this._samplingModeDirty=!1),this._wrapModeDirty&&(this._applyWrapMode(),this._wrapModeDirty=!1),this._shadowFilterDirty&&(this._applyShadowMode(),this._shadowFilterDirty=!1)}abortCompression(){this._compressionAbortController=jo(this._compressionAbortController)}_setData(e,r){const i=this._descriptor,s=i.context?.gl;if(!s)return;wl(s),this.hasWebGLTextureObject||(this._glName=s.createTexture(),i.context.instanceCounter.increment(fC.Texture,this)),Rp(i);const n=i.context.bindTexture(this,kt.TEXTURE_UNIT_FOR_UPDATES);i.context.setActiveTexture(kt.TEXTURE_UNIT_FOR_UPDATES),this._configurePixelStorage(),wl(s);const o=r??i.target,l=uc(o);if(mC(e))this._setDataFromTexImageSource(e,o);else{const{width:u,height:d,depth:p}=i;if(u==null||d==null)throw new x("texture:missing-size","Width and height must be specified!");if(l&&p==null)throw new x("texture:missing-depth","Depth must be specified!");if(i.internalFormat=ug(i),i.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(o,i.internalFormat,i.hasMipmap,u,d,p),jc(e)){if(!pue(i.internalFormat))throw new x("texture:format-mismatch","Attempting to use compressed data with an uncompressed format!");this._setDataFromCompressedSource(e,i.internalFormat,o)}else this._texImage(o,0,i.internalFormat,u,d,p,e),wl(s),i.hasMipmap&&this.generateMipmap()}this._applySamplingMode(),this._applyWrapMode(),this._applyAnisotropicFilteringParameters(),this._applyShadowMode(),wl(s),i.context.bindTexture(n,kt.TEXTURE_UNIT_FOR_UPDATES)}_setDataCubeMap(e=null){for(let r=34069;r<=34074;r++)this._setData(e,r)}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:r,flipped:i,preMultiplyAlpha:s}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s?1:0)}_setDataFromTexImageSource(e,r){const{gl:i}=this._descriptor.context,s=this._descriptor;s.internalFormat=ug(s);const n=uc(r),{width:o,height:l,depth:u}=mue(e);s.width&&s.height,s.width||(s.width=o),s.height||(s.height=l),n&&s.depth,n&&(s.depth=u),s.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(r,s.internalFormat,s.hasMipmap,o,l,u),this._texImage(r,0,s.internalFormat,o,l,u,e),wl(i),s.hasMipmap&&(this.generateMipmap(),wl(i))}_setDataFromCompressedSource(e,r,i){const s=this._descriptor,{width:n,height:o,depth:l}=s,u=e.levels,d=yC(i,n,o,l),p=Math.min(d,u.length)-1;this._descriptor.context.gl.texParameteri(s.target,33085,p),this._forEachMipmapLevel((f,m,y,g)=>{const v=u[Math.min(f,u.length-1)];this._compressedTexImage(i,f,r,m,y,g,v)},p)}_texStorage(e,r,i,s,n,o){const{gl:l}=this._descriptor.context;if(!hue(r)&&!D6(r)&&!j6(r))throw new x("texture:missing-format","Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const u=i?yC(e,s,n,o):1;if(uc(e)){if(o==null)throw new x("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texStorage3D(e,u,r,s,n,o)}else l.texStorage2D(e,u,r,s,n);this._wasImmutablyAllocated=!0}_texImage(e,r,i,s,n,o,l){const u=this._descriptor.context.gl,d=uc(e),{isImmutable:p,pixelFormat:f,dataType:m}=this._descriptor;if(p){if(l!=null){const y=l;if(d){if(o==null)throw new x("texture:missing-depth","Missing depth dimension for 3D texture upload");u.texSubImage3D(e,r,0,0,0,s,n,o,f,m,y)}else u.texSubImage2D(e,r,0,0,s,n,f,m,y)}}else{const y=l;if(d){if(o==null)throw new x("texture:missing-depth","Missing depth dimension for 3D texture upload");u.texImage3D(e,r,i,s,n,o,0,f,m,y)}else u.texImage2D(e,r,i,s,n,0,f,m,y)}}_compressedTexImage(e,r,i,s,n,o,l){const u=this._descriptor.context.gl,d=uc(e);if(this._descriptor.isImmutable){if(l!=null)if(d){if(o==null)throw new x("texture:missing-depth","Missing depth dimension for 3D texture upload");u.compressedTexSubImage3D(e,r,0,0,0,s,n,o,i,l)}else u.compressedTexSubImage2D(e,r,0,0,s,n,i,l)}else if(d){if(o==null)throw new x("texture:missing-depth","Missing depth dimension for 3D texture upload");u.compressedTexImage3D(e,r,i,s,n,o,0,l)}else u.compressedTexImage2D(e,r,i,s,n,0,l)}async _compressOnWorker(e){const{width:r,height:i,context:s,flipped:n,preMultiplyAlpha:o,hasMipmap:l}=this._descriptor,u=this._descriptor.compress?.compressionTracker,d=this._descriptor.compress?.compressionCallback,{compressedTextureETC:p,compressedTextureS3TC:f}=s.capabilities;if(!kt.compressionWorkerHandle?.isCompressible(e,this._descriptor)||!p&&!f)return;this.abortCompression();const m=new AbortController;let y;this._compressionAbortController=m,u?.increment();try{e instanceof Uint8Array?y=e.buffer:(y=await createImageBitmap(e,{imageOrientation:n?"flipY":"none"}),We(m));const g={data:y,width:r,height:i,needsFlip:e instanceof Uint8Array&&this.descriptor.flipped,components:this._descriptor.pixelFormat===6408?4:3,preMultiplyAlpha:o,hasMipmap:l,hasETC:!!p,hasS3TC:!!f},v=await kt.compressionWorkerHandle.invoke(g,m.signal,"low");if(We(m),v.compressedTexture&&this.hasWebGLTextureObject){const _=this.usedMemory;this._descriptor.internalFormat=v.internalFormat,this._setData(v.compressedTexture),d?.(_-this.usedMemory)}}catch(g){sr(g)||Hn().error("Texture compression failed!")}finally{u?.decrement(),this._compressionAbortController?.signal.aborted&&(this._compressionAbortController=null),y instanceof ImageBitmap&&y.close()}}_forEachMipmapLevel(e,r=1/0){let{width:i,height:s,depth:n,hasMipmap:o,target:l}=this._descriptor;const u=l===32879;if(i==null||s==null||u&&n==null)throw new x("texture:missing-size","Missing texture dimensions for mipmap calculation");for(let d=0;e(d,i,s,n),o&&(i!==1||s!==1||u&&n!==1)&&!(d>=r);++d)i=Math.max(1,i>>1),s=Math.max(1,s>>1),u&&(n=Math.max(1,n>>1))}_applySamplingMode(){const e=this._descriptor,r=e.context?.gl;let i=e.samplingMode,s=e.samplingMode;i===9985||i===9987?(i=9729,e.hasMipmap||(s=9729)):i!==9984&&i!==9986||(i=9728,e.hasMipmap||(s=9728)),r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,i),r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,s)}_applyWrapMode(){const e=this._descriptor,r=e.context?.gl;typeof e.wrapMode=="number"?(r.texParameteri(e.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,e.wrapMode)):(r.texParameteri(e.target,r.TEXTURE_WRAP_S,e.wrapMode.s),r.texParameteri(e.target,r.TEXTURE_WRAP_T,e.wrapMode.t))}_applyShadowMode(){const e=this._descriptor,r=e.context?.gl,i=e.compareEnabled?r.COMPARE_REF_TO_TEXTURE:r.NONE;r.texParameteri(e.target,r.TEXTURE_COMPARE_MODE,i),e.compareEnabled&&r.texParameteri(e.target,r.TEXTURE_COMPARE_FUNC,r.GREATER),wl(r)}_applyAnisotropicFilteringParameters(){const e=this._descriptor,r=e.context.capabilities.textureFilterAnisotropic;r&&e.context.gl.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}},kt.TEXTURE_UNIT_FOR_UPDATES=0,kt.compressionWorkerHandle=null,kt);const L1=()=>L.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function wue(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const bue=[0,0,0,0];let z6=class{constructor(){this.type="single",this._highlightOptions=new qa,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*Pp),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,r){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,iue),r.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<A6)-1,activeGradient:this}]}_updateGradientTexture(e){const r=_ue(this._highlightOptions);if(r===this._optionsShadeTexKey)return;this._optionsShadeTexKey=r,wue(this._highlightOptions,this._convertedHighlightOptions);const i=this._convertedHighlightOptions,s=i.outlinePosition-i.outlineWidth/2-i.outerHaloWidth,n=i.outlinePosition-i.outlineWidth/2,o=i.outlinePosition+i.outlineWidth/2,l=i.outlinePosition+i.outlineWidth/2+i.innerHaloWidth,u=Math.sqrt(Math.PI/2)*aue,d=Math.abs(s)>u?Math.round(10*(Math.abs(s)-u))/10:0,p=Math.abs(l)>u?Math.round(10*(Math.abs(l)-u))/10:0;let f;d&&!p?L1().error("The outer rim of the highlight is "+d+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!d&&p?L1().error("The inner rim of the highlight is "+p+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):d&&p&&L1().error("The highlight is "+Math.max(d,p)+"px away from the edge of the feature; consider reducing some width values.");const m=[void 0,void 0,void 0,void 0];function y(v,_,S){m[0]=(1-S)*v[0]+S*_[0],m[1]=(1-S)*v[1]+S*_[1],m[2]=(1-S)*v[2]+S*_[2],m[3]=(1-S)*v[3]+S*_[3]}const{_texelData:g}=this;for(let v=0;v<Pp;++v)f=s+v/(Pp-1)*(l-s),f<s?(m[0]=0,m[1]=0,m[2]=0,m[3]=0):f<n?y(bue,i.outlineColor,(f-s)/(n-s)):f<o?[m[0],m[1],m[2],m[3]]=i.outlineColor:f<l?y(i.outlineColor,i.fillColor,(f-o)/(l-o)):[m[0],m[1],m[2],m[3]]=i.fillColor,g[4*v]=255*m[0],g[4*v+1]=255*m[1],g[4*v+2]=255*m[2],g[4*v+3]=255*m[3];if(this._minMaxDistance[0]=s,this._minMaxDistance[1]=l,!this._shadeTex){const v=new N6(Pp,1);v.wrapMode=33071,this._shadeTex=new vue(e,v)}this._shadeTex.updateData(0,0,0,Pp,1,this._texelData)}};function _ue(t){return`${t.color};${t.haloColor};${t.haloOpacity};${t.fillOpacity};${t.haloWidth};${t.haloBlur}`}let Sue=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let r=0;r<e.length;r++)this.gradients[r]||(this.gradients[r]=new z6),this.gradients[r].setHighlightOptions(e[r]);for(let r=e.length+1;r<this.gradients.length;r++)this.gradients[r].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const r=[];for(let i=0;i<this.gradients.length;i++){const s=this.gradients[i];r.push({activeReasons:e,activeGradient:s}),e<<=1}return r}};const U6={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{compare:514,mask:255,op:{fail:7680,zFail:7680,zPass:7681}}}},$ue={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},xue={...U6,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function Tue({pixelRatio:t,state:e,displayLevel:r,requiredLevel:i},s){const n=1/2**(r-s.key.level),o=1/2**(i-s.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:s.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:s.transforms.tileMat3,displayZoomFactor:n,requiredZoomFactor:o,tileOffset:[s.x,s.y],currentScale:e.scale,currentZoom:r,metersPerSRUnit:Bi(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function q6(t){return t.passOptions?.type==="highlight"}function G6(t){return t.passOptions?.type==="hittest"}function Mue(t){if(!G6(t))return null;const{position:e,distance:r,smallSymbolDistance:i,smallSymbolSizeThreshold:s}=t.passOptions;return{position:e,distance:r,smallSymbolDistance:i,smallSymbolSizeThreshold:s}}function Iue(t){if(!q6(t))return null;const{activeReasons:e,highlightAll:r}=t.passOptions;return{activeReasons:e,highlightAll:r?1:0}}function UMe(t,e,r){const i={};for(const s in r)typeof r[s]!="function"?i[s]=r[s]:i[s]=r[s](t,e);return i}function qMe(t,e){const{attributeView:r,context:i}=t;return{storage:r.getUniforms(i),view:Tue(t,e),hittestRequest:Mue(t),highlight:Iue(t)}}function GMe(t){return{inside:t.selection===2,outside:t.selection===3}}function Eue(t){return G6(t)?$ue:q6(t)&&t.passOptions.stepType==="clear"?xue:U6}function BMe(t){const{row:e,col:r}=t.key,i=r*pC,s=e*pC;return{tileOffsetFromLocalOrigin:[i%lg,s%lg],maxIntsToLocalOrigin:[Math.floor(i/lg),Math.floor(s/lg)]}}const Oue=new $e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function HMe(t){return Oue.toJSON(t)}function WMe(t){const{bandCount:e,attributeTable:r,colormap:i,pixelType:s}=t.raster.rasterInfo;return e===1&&(r!=null||i!=null||s==="u8"||s==="s8")}function kue(t,e){return e==null?(t?.destroy(),null):(t?.type==="single"&&Array.isArray(e)&&(t.destroy(),t=null),t?.type!=="multi"||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new Sue:new z6),Array.isArray(e)?t.type==="multi"&&t.setHighlightOptions(e):t.type==="single"&&t.setHighlightOptions(e),t)}function ZMe(t,e,r,i){const{painter:s,highlightGradient:n}=t,{highlight:o}=s.effects;if(!n)return;const l=t.passOptions,u=n.getReasonsWithGradients();for(let d=0;d<u.length;d++){const p={...t,passOptions:{type:"highlight",activeGradient:u[d].activeGradient,activeReasons:u[d].activeReasons,stepType:"burn",highlightAll:e}};if(o.bind(p),r(p),d<u.length-1){let m=0;for(let y=d+1;y<u.length;y++)m|=u[y].activeReasons;r({...t,passOptions:{type:"highlight",activeGradient:u[d].activeGradient,activeReasons:m,stepType:"clear",highlightAll:e}})}const f={...t,passOptions:{type:"highlight",activeGradient:u[d].activeGradient,activeReasons:u[d].activeReasons,stepType:"draw",highlightAll:e}};s.setPipelineState(Eue(t)),s.updatePipelineState(t.context),o.draw(f),o.unbind()}t.passOptions=l}const cg=t=>parseFloat(t)/100;function Cue(t,e,r){const i=typeof t.left=="string"?cg(t.left)*e:t.left,s=typeof t.right=="string"?cg(t.right)*e:t.right,n=typeof t.top=="string"?cg(t.top)*r:t.top,o=typeof t.bottom=="string"?cg(t.bottom)*r:t.bottom,l=n;return{xmin:i,xmax:Math.max(e-s,i),ymin:l,ymax:Math.max(r-o,n)}}function B6(t,e,r,i){switch(e.type){case"rect":{const{width:s,height:n}=t,{xmin:o,xmax:l,ymin:u,ymax:d}=Cue(e,s,n),{x:p,y:f}=r;return p>o&&p<l&&f>u&&f<d}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||zT(e.path,[r.x,r.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?VT(e.geometry,i):ty(e.geometry,i))}}function Pue(t){if(!t.highlights)return null;const e=t.highlights.findIndex(r=>r.name==="default");return e===-1?null:t.highlights.items[e]}function Aue(t,e){if(!t.highlights){if(!e)return;t.highlights=new H([new qa])}const r=t.highlights.findIndex(i=>i.name==="default");e?t.highlights.items[r].assignFrom(e):(t.highlights.removeAt(r),t.highlights.length===0&&(t.highlights=null))}async function Rue(t,e,r){const i=Tj(e)?xj(t,e):e;if(!t.ready||isNaN(i.x)||isNaN(i.y))return{screenPoint:i,results:[]};let s=new Set;const n=new Set;let o=!1,l=null,u=null;r?.include?vC(r.include,gC(t,m=>{s.add(m),F1(m,y=>n.add(y))},(m,y)=>{n.add(m),s.add(y)},m=>{l||(l=new Set),l.add(m)},m=>s.add(m),()=>o=!0)):(o=!0,s=new Set(t.allLayerViews),s.forEach(m=>{F1(m,y=>n.add(y))})),r?.exclude&&vC(r.exclude,gC(t,m=>{s.delete(m),F1(m,y=>n.delete(y))},m=>n.delete(m),m=>{u||(u=new Set),u.add(m)}));const d=t.toMap(i),p=t.allLayerViews.filter(m=>!m.suspended&&s.has(m)&&m.clips.every(y=>B6(t,y,i,d))).reverse();let f=[...o?t.graphicsView.hitTest(d).map(m=>({type:"graphic",graphic:m,layer:null,mapPoint:d})):[],...await Promise.all(p.map(m=>m.hitTest(d,i)).toArray())].filter(hs).flat().filter(hs);return f=f.filter(m=>m.type!=="graphic"||m.layer?.type!=="subtype-group"||n.has(m.graphic.layer)),l&&(f=f.filter(m=>!("graphic"in m)||!m.graphic||l?.has(M$(m.graphic)))),u&&(f=f.filter(m=>!("graphic"in m)||!m.graphic||!u?.has(M$(m.graphic)))),{screenPoint:i,results:f}}function gC(t,e,r,i,s,n){return o=>{if(o instanceof st){if(o.layer===t)n?.();else{const l=t.allLayerViews.find(u=>u.layer===o.layer);l&&s?.(l)}i(M$(o))}else if(!("layer"in o&&"element"in o))if(o.type==="subtype-sublayer"){const l=t.allLayerViews.find(u=>u.layer===o.parent);l&&r(o,l)}else{const l=t.allLayerViews.find(u=>u.layer===o);l&&e(l)}}}function vC(t,e){if(t)if(rv(t))for(const r of t)if(rv(r))for(const i of r)e(i);else e(r);else e(t)}function M$(t){const e=t.getObjectId();return e?`${t.layer?.uid??t.sourceLayer?.uid??"MapView"}/${e}`:`"MapView/${t.uid}`}function F1(t,e){const r=t.layer;r?.type==="subtype-group"&&r.sublayers.forEach(i=>{e(i)})}let Lp=null,Qv=!0;function Lue(t,e,r){if(!t||!e)throw new Error("Cannot construct image data without dimensions");if(Qv)try{return new ImageData(t,e)}catch{Qv=!1}return H6(t,e,r)}function JMe(t,e,r,i){if(!e||!r)throw new Error("Cannot construct image data without dimensions");if(Qv)try{return new ImageData(t,e,r)}catch{Qv=!1}const s=H6(e,r,i);return s.data.set(t,0),s}function Fue(){return Lp||(Lp=document.createElement("canvas"),Lp.width=1,Lp.height=1),Lp}function H6(t,e,r){return r||(r=Fue()),r.getContext("2d").createImageData(t,e)}async function Nue(t,e){const r=window.URL.createObjectURL(t);try{const{data:i}=await Ae(r,{...e,responseType:"image"});return i}catch(i){throw sr(i)?i:new x("invalid-image",`Could not fetch requested image at ${r}`)}finally{window.URL.revokeObjectURL(r)}}async function YMe(t,e){const{arrayBuffer:r,mediaType:i}=await Due(t,e),s=i==="image/png";if(i==="image/gif"){const{isAnimatedGIF:n,parseGif:o}=await N(()=>import("./gif-B5PURgCy.js"),[]);if(n(r))return o(r,e)}if(s){const{isAnimatedPNG:n,parseApng:o}=await N(()=>import("./apng-BU8upGLc.js"),__vite__mapDeps([297,28]));if(n(r))return o(r,e)}return Nue(new Blob([r],{type:i}),e)}async function Due(t,e){const r=mh(t);if(r?.isBase64)return{arrayBuffer:rR(r.data),mediaType:r.mediaType};const i=await Ae(t,{responseType:"array-buffer",...e});return{arrayBuffer:i.data,mediaType:i.getHeader?.("Content-Type")??""}}function W6(t,e,r){const{ctx:i,canvas:s}=J6(t,r),n=i.getImageData(0,0,t.width,t.height),o=K6(s,e);return Y6(s),{dataUrl:o,data:n}}function Z6(t,e){const{ctx:r,canvas:i}=J6(t,e),s=r.getImageData(0,0,t.width,t.height);return Y6(i),s}function J6(t,e){const r=jue();e.premultipliedAlpha&&que(t),r.width=t.width,r.height=t.height;const i=r.getContext("2d",{willReadFrequently:!0});return i.putImageData(t,0,0),e.flipY&&Uue(i),{ctx:i,canvas:r}}function Y6(t){t.width=0,t.height=0}function jue(){return N1==null&&(N1=document.createElement("canvas")),N1}let N1=null;function K6(t,e){const r=Gue[e.format],i=e.quality/100;return t.toDataURL(r,i)}function Q6(t,e){const r=zue(t),i=Hue[r];return{format:r,quality:Gi(e??i,0,100)}}function X6(t,e){return e/Math.max(t[0],t[1])}function Vue(t,e,r,i=0,s=0,n=t.width-i,o=t.height-s,l=!1){const{data:u}=t,{width:d,height:p,data:f}=e,m=n/d,y=o/p,g=Math.ceil(m/2),v=Math.ceil(y/2),_=t.width;for(let S=0;S<p;S++)for(let M=0;M<d;M++){const C=4*(M+(l?p-S-1:S)*d);let T=0,O=0,P=0,D=0,z=0,B=0;const G=(S+.5)*y;for(let Q=Math.floor(S*y);Q<(S+1)*y;Q++){const oe=Math.abs(G-(Q+.5))/v,Pe=(M+.5)*m,fe=oe*oe;for(let Ft=Math.floor(M*m);Ft<(M+1)*m;Ft++){const _i=Math.abs(Pe-(Ft+.5))/g,nr=Math.sqrt(fe+_i*_i);if(nr>=1)continue;let Ne=2*nr*nr*nr-3*nr*nr+1;const bs=4*(i+Ft+(s+Q)*_);B+=Ne*u[bs+3],O+=Ne,!r&&u[bs+3]<255&&(Ne=Ne*u[bs+3]/255),P+=Ne*u[bs],D+=Ne*u[bs+1],z+=Ne*u[bs+2],T+=Ne}}f[C]=P/T,f[C+1]=D/T,f[C+2]=z/T,f[C+3]=B/O}return e}function zue(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return Bue}}function Uue(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function que(t){const e=t.data,r=e.length;for(let i=0;i<r;i+=4){const s=e[i+3];if(s!==255&&s>0){const n=255/s;e[i]=e[i]*n,e[i+1]=e[i+1]*n,e[i+2]=e[i+2]*n}}}const Gue={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},wC=98,Bue="png",Hue={png:100,jpg:wC,jpeg:wC},KMe=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:Lue,encode:W6,encodeData:Z6,getFormatAndQuality:Q6,getMaximumResolutionScale:X6,resampleHermite:Vue,toDataUrl:K6},Symbol.toStringTag,{value:"Module"})),e8={flipY:!0,premultipliedAlpha:!0};async function Wue(t,e){const r=await t8(t,e),{format:i,quality:s}=Q6(e?.format,e?.quality);return W6(r,{format:i,quality:s},e8)}async function Zue(t,e){const r=await t8(t,e);return Z6(r,e8)}function t8(t,e){const r=Kue(e||{},Yue(t.stage,t.size),t.size,t.padding),i=Jue(e,t.allLayerViews);return t.stage.takeScreenshot(r,i,t.backgroundColor,e?.rotation)}function Jue(t={},e){if(!t.layers)return;const r=[];return t.layers.forEach(i=>{const s=e.find(n=>n.layer.id===i.id);s?.container&&r.push(s.container)}),r}function Yue(t,e){return Math.min(4,X6(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function Kue(t,e,r,i){t.ignorePadding&&(i={left:0,right:0,top:0,bottom:0});let s=null;t.width!=null&&t.height!=null?s=[t.width,t.height]:t.width==null&&t.height!=null?s=[t.height,t.height]:t.width!=null&&t.height==null?s=[t.width,t.width]:t.width==null&&t.height==null&&(s=null);const n=r[0]-(i.left+i.right),o=r[1]-(i.top+i.bottom);let l,u,d=t.area||{x:0,y:0,width:n,height:o};if(s){const p=n/o,f=s[0]/s[1];if(f>p){const m=d.width/f;d={x:d.x,y:Math.round(d.y+(d.height-m)/2),width:d.width,height:Math.round(m)}}else{const m=d.height*f;d={x:Math.round(d.x+(d.width-m)/2),y:d.y,width:Math.round(m),height:d.height}}}else s=[d.width,d.height];return s[0]>d.width?(l=Math.min(s[0]/d.width,e),u=s[0]/d.width/l):(l=1,u=s[0]/d.width),{cropArea:{x:Math.round((d.x+i.left)*l),y:Math.round((d.y+i.top)*l),width:Math.round(d.width*l),height:Math.round(d.height*l)},outputScale:u,resolutionScale:l}}const Que=t=>t.includes("Brush");let r8=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),Que(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};const bC=Symbol("analyses-owner-handles");let pa=class extends X{constructor(e){super(e),this._allAnalysisViews=new H,this._creatingViewCount=0,this._attachedToViewResolver=_C(),this._items=new Map,this._moduleMap=new Map,this._scheduledUpdateHandle=null,this._emitOnView=(r,i)=>this.view.emit(r,i)}destroy(){this._disconnectOwners(),this._attachedToViewResolver.reject(Fe("AnalysisViewManager was destroyed")),this._set("view",null)}attach(){this._connectOwners(),this._attachedToViewResolver.resolve()}detach(){this._disconnectOwners(),this._attachedToViewResolver.reject(Fe()),this._attachedToViewResolver=_C()}get updating(){return!this.view.ready||this._creatingViewCount!==0||this._allAnalysisViews.some(e=>e.updating)}get testInfo(){}async whenAnalysisView(e){await this._attachedToViewResolver.promise;const r=this._items.get(e);if(r==null||r.state.list===1)throw new x("AnalysisViewManager:no-analysis-view-for-analysis","The analysis does not exist in view.analyses",{analysis:e});return r.createAnalysisViewTask.promise}_connectOwners(){this.addHandles(this._connectAnalysesCollection(this.view.analyses),bC)}_disconnectOwners(){this.removeHandles(bC),this._update(),this._creatingViewCount=0}_connectAnalysesCollection(e){for(const s of e)this._addAnalysis(s);const r=e.on("after-add",s=>this._addAnalysis(s.item)),i=e.on("after-remove",s=>this._removeAnalysis(s.item));return Te(()=>{r.remove(),i.remove();for(const s of e)this._removeAnalysis(s)})}_addAnalysis(e){const r=this._items.get(e);if(r==null){const i={state:{view:0,list:0},analysis:e,view:null,createAnalysisViewTask:null};this._items.set(e,i),i.createAnalysisViewTask=ey(s=>this._createAnalysisViewPromise(i,s).then(n=>(this._emitOnView("analysis-view-create",{analysis:e,analysisView:n}),n),n=>{throw this._emitOnView("analysis-view-create-error",{analysis:e,error:n}),n}))}else r.state.list=0}_removeAnalysis(e){const r=this._items.get(e);r!=null?(r.state.list=1,this._scheduleUpdate()):L.getLogger(this).error("Trying to remove analysis which was not added")}_scheduleUpdate(){this._scheduledUpdateHandle==null&&(this._scheduledUpdateHandle=Bh(()=>this._update()))}_update(){this._scheduledUpdateHandle=He(this._scheduledUpdateHandle),this._items.forEach(e=>{if(e.state.list!==1)return;const{analysis:r,view:i}=e;switch(this._items.delete(r),e.state.view){case 0:e.createAnalysisViewTask=jo(e.createAnalysisViewTask);break;case 1:i!=null&&(this._allAnalysisViews.remove(i),e.view=Ke(i),e.createAnalysisViewTask=null,this._emitOnView("analysis-view-destroy",{analysis:r,analysisView:i}))}})}async _createAnalysisViewPromise(e,r){const{analysis:i}=e;if(this._creatingViewCount+=1,!this._moduleMap.has(i.type))try{this._moduleMap.set(i.type,await this.importAnalysisViewModule(i))}catch{throw this._creatingViewCount-=1,new x("AnalysisViewManager:no-analysis-view-for-analysis",`Analysis of type "${i.type}" is not supported`)}if(Cr(r))throw this._creatingViewCount-=1,Fe("AnalysisView creation aborted");const s=new(this._moduleMap.get(i.type)).default({analysis:i,view:this.view});let n=!0;ys(r,()=>{n&&this._destroyAnalysisView(i,s)});try{await s.when()}catch(o){throw n=!1,this._destroyAnalysisView(i,s),o}if(Cr(r))throw Fe();return n=!1,e.view=s,e.state.view=1,this._allAnalysisViews.add(s),this._creatingViewCount-=1,s}_destroyAnalysisView(e,r){r.destroyed||(this._creatingViewCount-=1,r.destroy(),this._emitOnView("analysis-view-destroy",{analysis:e,analysisView:r}))}};a([c()],pa.prototype,"updating",null),a([c({constructOnly:!0})],pa.prototype,"importAnalysisViewModule",void 0),a([c({constructOnly:!0})],pa.prototype,"view",void 0),a([c()],pa.prototype,"_allAnalysisViews",void 0),a([c()],pa.prototype,"_creatingViewCount",void 0),pa=a([b("esri.views.support.AnalysisViewManager")],pa);const Xue=pa;function _C(){const t=wi();return t.promise.catch(()=>{}),t}let ece=class{constructor(e){this.getUnmaskedRenderer=e}};function tce(t){const e=t.getExtension("WEBGL_debug_renderer_info");return e?new ece(()=>t.getParameter(e.UNMASKED_RENDERER_WEBGL)):null}let SC;function rce(){return SC??=nce(),SC}let ice=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}};function sce(t){if(typeof WebGL2RenderingContext>"u")return null;const e=document.createElement("canvas");if(!e)return null;let r=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(r==null&&(r=e.getContext("webgl2"),r!=null&&(t.majorPerformanceCaveat=!0,t.unmaskedRenderer=tce(r)?.getUnmaskedRenderer()??"unknown")),r==null)return r;t.available=!0,t.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const i=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);return i&&(t.supportsHighPrecisionFragment=i.precision>0),r}function nce(){const t=new ice,e=sce(t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null),t}function oce(t){const e=rce();return e.available?t==="3d"&&e.majorPerformanceCaveat?new x("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new x("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new x("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new x("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function ace(t){return t&&"nodeType"in t}function lce(t){return t&&typeof t.render=="function"}const $C={component:"esri-component"};let Vl=class extends X{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(e){this._set("id",e)}set node(e){const r=this._get("node");e!==r&&(e&&e.classList.add($C.component),r&&r.classList.remove($C.component),this._set("node",e))}castNode(e){return this.widget?.destroy(),e?typeof e=="string"||ace(e)?(this._set("widget",null),$M(e)):(lce(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};a([c()],Vl.prototype,"id",null),a([c()],Vl.prototype,"node",null),a([Ce("node")],Vl.prototype,"castNode",null),a([c({readOnly:!0})],Vl.prototype,"widget",void 0),Vl=a([b("esri.views.ui.Component")],Vl);const M0=Vl,uce=(t,e)=>{let r=t;for(;r;){if(r===e)return!0;if(!r.parentNode)return!1;r.parentNode instanceof ShadowRoot?r=r.parentNode.host:r=r.parentNode}return!1},i3e=(t,e,r)=>{const i=cce(e).subscribe;return i(s=>{s.some(o=>uce(t,o.target))&&r()})},D1={},cce=t=>{const e=t.join(","),r=D1[e];if(r!==void 0)return r;const i=new Set,s=new MutationObserver(o=>i.forEach(l=>l(o)));globalThis.document&&s.observe(document.documentElement,{attributes:!0,attributeFilter:t,subtree:!0});const n={subscribe:o=>(i.add(o),()=>{i.delete(o),i.size===0&&(s.disconnect(),D1[e]=void 0)})};return D1[e]=n,n},i8=(t,e)=>{let r=t;for(;r;){const i=r.closest?.(e);if(i)return i;const s=r.getRootNode?.();if(s===globalThis.document)return;r=s.host}};function dce(t){const e=i8(t,".calcite-mode-dark, .calcite-mode-light, .calcite-mode-auto");return e?.classList.contains("calcite-mode-dark")||e?.classList.contains("calcite-mode-auto")&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}const s3e=(t,e,r)=>i8(t,`[${e}]`)?.getAttribute(e)??r,hce="--esri-calcite-mode-name";function pce(){const t=getComputedStyle(document.body).getPropertyValue(hce).replaceAll(/\W/g,"").toLowerCase();return t==="dark"||t==="light"?t:void 0}const s8="calcite-mode-";function n8(t){return pce()??dce(t??document.body)}function n3e(t){return n8(t)==="dark"}function fce(t){return`${s8}${n8(t)}`}function mce(t){const e=fce(t);yce(t),t.classList.add(e)}function yce(t){Array.from(t.classList).forEach(e=>{e.startsWith(s8)&&t.classList.remove(e)})}const ob=new Map;function o8(){ob.clear()}function gce(t){return ob.get(t)}function vce(t,e){ob.set(t,e)}function j1(t){ob.delete(t)}function wce(...t){const e=Gr.acquire();for(let i=0;i<t.length;i++){const s=t[i],n=typeof s;if(n==="string")e.push(s);else if(Array.isArray(s))e.push.apply(e,s);else if(n==="object")for(const o in s)s[o]&&e.push(o)}const r=e.join(" ");return Gr.release(e),r}(()=>{const t=new Map,e=new ResizeObserver(i=>{o8();for(const s of i)t.get(s.target)?.(s)}),r=(i,s,n)=>(t.set(i,s),e.observe(i,n),Te(()=>{e.unobserve(i),t.delete(i)}));return(i,s,n)=>{let o=null;return Uu([ne(()=>typeof i=="function"?i():i,l=>{o?.remove(),l&&(o=r(l,s,n))},xr),Te(()=>o?.remove())])}})();function bce(t){const e=t?.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function o3e(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function a3e(t){const e="data-node-ref";this[t.getAttribute(e)]=t}function _ce(t){return t==="Enter"||t===" "}async function Sce(t,e){await XR(Zm(e));const r=typeof t=="function"?t():t;r&&("setFocus"in r&&typeof r.setFocus=="function"?await r.setFocus():r instanceof HTMLElement&&r.focus())}const $ce={left:0,top:0,bottom:0,right:0},a8={bottom:30,top:15,right:15,left:15},Wn="esri-ui",Xr={ui:Wn,corner:`${Wn}-corner`,innerContainer:`${Wn}-inner-container`,manualContainer:`${Wn}-manual-container`,cornerContainer:`${Wn}-corner-container`,topLeft:`${Wn}-top-left`,topRight:`${Wn}-top-right`,bottomLeft:`${Wn}-bottom-left`,bottomRight:`${Wn}-bottom-right`};function xce(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function dg(t){return t===0?"0":`${t}px`}function V1(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function z1(t,{top:e,bottom:r,left:i,right:s}){t.style.top=e,t.style.bottom=r,t.style.left=i,t.style.right=s}let mn=class extends Zh{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=gi(),this.view=null,this._applyViewPadding=()=>{const r=this.container;r&&z1(r,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const r=this._innerContainer;r&&z1(r,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([ne(()=>[this.view?.padding,this.container],this._applyViewPadding,Et),ne(()=>this.padding,this._applyUIPadding,Et),ne(()=>[this.container,this._locale],([e,r])=>{e&&e.setAttribute("lang",r)},Et),aF(e=>{this._locale=e})])}destroy(){this.removeAllHandles(),this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear(),this.view=null,this._set("view",null)}set container(e){const r=this._get("container");e!==r&&(e&&(e.classList.add(Xr.ui),mce(e),this._attachContainers(e)),r&&(r.classList.remove(Xr.ui),z1(r,{top:"",bottom:"",left:"",right:""}),r.textContent=""),this._set("container",e))}get height(){const e=this.view?.height??0;if(e===0)return e;const r=this._getViewPadding(),{top:i,bottom:s}=r;return Math.max(e-i-s,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...a8,...e}}get width(){const e=this.view?.width??0;if(e===0)return e;const r=this._getViewPadding(),{left:i,right:s}=r;return Math.max(e-i-s,0)}add(e,r){let i,s,n;if(Array.isArray(e))return void e.forEach(l=>this.add(l,r));const o=V1(e);o&&({index:i,position:r,component:e,key:s}=o),r&&typeof r=="object"&&({index:i,key:s,position:r,internal:n}=r),!e||r&&!this._isValidPosition(r)||this._add(e,r,i??this._getNumComponentsAtPosition(r),s,n)}remove(e,r){if(!e)return;if(Array.isArray(e))return e.map(s=>this.remove(s,r));const i=this._find(e);if(i){const s=this._componentMap.get(i);if(!s||s.key!==r)return;const n=this._components.indexOf(i);return i.node.parentNode?.removeChild(i.node),this._componentMap.delete(i),i.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.forEach(l=>{const u=this._componentMap.get(l);u&&u.position===s.position&&u.index>s.index&&u.index--}),this._components.splice(n,1)[0]}}empty(e,r={removeInternal:!1}){if(Array.isArray(e)){for(const n of e)this.empty(n,r);return}const i=this._positionNameToContainerLookup[e??"manual"],s=Array.prototype.slice.call(i.children).map(n=>this._findByNode(n)).filter(n=>n==null?!1:!(this._componentMap.get(n)?.internal??!1)||r.removeInternal);for(const n of s)this.remove(n)}move(e,r){if(Array.isArray(e)&&e.forEach(o=>this.move(o,r)),!e)return;let i;const s=V1(e)||V1(r);if(s&&(i=s.index,r=s.position,e=s.component||e),r&&!this._isValidPosition(r))return;const n=this.remove(e);n&&this.add(n,{position:r,index:i})}find(e){if(!e)return null;const r=this._findById(e);return r&&(r.widget||r.node)}getComponents(e,r={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap(i=>this._getComponentsAtPosition(i,r)):this._getComponentsAtPosition(e,r):this._components.filter(i=>r.includeInternal||!this._componentMap.get(i)?.internal).map(({widget:i,node:s})=>i??s)}getPosition(e){for(const r in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[r].contains(e))return r;return null}_add(e,r,i,s,n){e instanceof M0||(e=new M0({node:e}));const{widget:o}=e;o!=null&&o instanceof X&&o.addHandles(Te(()=>{queueMicrotask(()=>this.remove(e))}),this._removeWidgetHandleKey);const l=this._positionNameToContainerLookup[r];this._components.some(u=>{const d=this._componentMap.get(u)?.position,p=d?this._positionNameToContainerLookup[d]:null;return l===p&&this._componentMap.get(u)?.index===i})&&this._components.forEach(u=>{const d=this._componentMap.get(u),p=d?.position,f=p?this._positionNameToContainerLookup[p]:null;d&&f===l&&d.index>=i&&d.index++}),this._place({component:e,position:r,index:i}),this._components.push(e),this._componentMap.set(e,{key:s,position:r,internal:n,index:i})}_find(e){return e?e instanceof M0?this._findByComponent(e):typeof e=="string"?this._findById(e):"domNode"in e?this._findByNode(e.domNode):this._findByNode(e):null}_getViewPadding(){return this.view?.padding??$ce}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Xr.innerContainer,Xr.cornerContainer);const r=document.createElement("div");r.classList.add(Xr.innerContainer,Xr.manualContainer);const i=document.createElement("div");i.classList.add(Xr.topLeft,Xr.corner),e.appendChild(i);const s=document.createElement("div");s.classList.add(Xr.topRight,Xr.corner),e.appendChild(s);const n=document.createElement("div");n.classList.add(Xr.bottomLeft,Xr.corner),e.appendChild(n);const o=document.createElement("div");o.classList.add(Xr.bottomRight,Xr.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=r;const l=bce();this._cornerNameToContainerLookup={"top-left":i,"top-right":s,"bottom-left":n,"bottom-right":o,"top-leading":l?s:i,"top-trailing":l?i:s,"bottom-leading":l?o:n,"bottom-trailing":l?n:o},this._positionNameToContainerLookup={manual:r,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const r=e.position??"manual",{component:i,index:s}=e,n=this._positionNameToContainerLookup[r],o=s!=null&&s>-1;if(xce(i.widget)&&i.widget.startup(),!o)return void n.appendChild(i.node);const l=Array.from(n.children);if(l.length!==0){for(const u of l){const d=this._findByNode(u);if(d&&s<(this._componentMap.get(d)?.index??0))return void u.parentNode?.insertBefore(i.node,u)}n.appendChild(i.node)}else n.appendChild(i.node)}_toPixelPosition(e){return{top:dg(e.top),left:dg(e.left),right:dg(e.right),bottom:dg(e.bottom)}}_findByComponent(e){return this._components.find(r=>r===e)??null}_findById(e){return this._components.find(({id:r})=>r===e)??null}_findByNode(e){return e?this._components.find(({node:r})=>r===e):null}_getComponentsAtPosition(e,r){const i=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(i.children).map(s=>this._findByNode(s)).filter(hs).filter(s=>r.includeInternal||!this._componentMap.get(s)?.internal).map(({widget:s,node:n})=>s??n)}_getNumComponentsAtPosition(e){return this._positionNameToContainerLookup[e]?.children.length??0}};a([c()],mn.prototype,"_locale",void 0),a([c()],mn.prototype,"container",null),a([c()],mn.prototype,"height",null),a([c({value:a8})],mn.prototype,"padding",null),a([Ce("padding")],mn.prototype,"castPadding",null),a([c()],mn.prototype,"view",void 0),a([c()],mn.prototype,"width",null),mn=a([b("esri.views.ui.UI")],mn);const Tce=mn,Mce={handleInterceptedEvent:(t,e,r,i)=>(t.scheduleRender(),e.properties[`on${i.type}`].apply(e.properties.bind||r,[i]))},Ice={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,r)=>{e.startsWith("-")?t.style.setProperty(e,r):t.style[e]=r}},Ece=t=>({...Ice,...t}),Oce=(t,e)=>{const r=[];for(;t&&t!==e;)r.push(t),t=t.parentNode;return r},kce=(t,e)=>t.find(e),xC=(t,e,r=!1)=>{let i=t;return e.forEach((s,n)=>{const o=i?.children?kce(i.children,l=>l.domNode===s):void 0;r&&!o&&n!==e.length-1||(i=o)}),i},Cce=t=>{let e;const r={...Mce,...t},i=Ece(r),s=i.performanceLogger;let n,o=!0,l=!1;const u=[],d=[],p=(m,y,g)=>{let v;i.eventHandlerInterceptor=(S,M,C,T)=>function(O){let P;s("domEvent",O);const D=Oce(O.currentTarget,v.domNode),z=D.some(G=>customElements.get(G?.tagName?.toLowerCase()));if(O.eventPhase===Event.CAPTURING_PHASE||!z)D.reverse(),P=xC(v.getLastRender(),D);else{const G=O.composedPath(),Q=G.slice(G.indexOf(O.currentTarget),G.indexOf(v.domNode)).reverse();P=xC(v.getLastRender(),Q,!0)}let B;return P&&(B=r.handleInterceptedEvent(e,P,this,O)),s("domEventProcessed",O),B},r.postProcessProjectionOptions?.(i);const _=g();v=m(y,_,i),i.eventHandlerInterceptor=void 0,u.push(v),d.push(g),r.afterFirstVNodeRendered&&r.afterFirstVNodeRendered(v,_)};let f=()=>{if(n=void 0,o){o=!1,s("renderStart",void 0);for(let m=0;m<u.length;m++){const y=d[m]();s("rendered",void 0);try{u[m].update(y)}catch(g){console.error(g)}s("patched",void 0)}s("renderDone",void 0),o=!0}};return r.modifyDoRenderImplementation&&(f=r.modifyDoRenderImplementation(f,u,d)),e={renderNow:f,scheduleRender:()=>{n||l||(n=requestAnimationFrame(f))},stop:()=>{n&&(cancelAnimationFrame(n),n=void 0),l=!0},resume:()=>{l=!1,o=!0,e.scheduleRender()},append:(m,y)=>{p(La.append,m,y)},insertBefore:(m,y)=>{p(La.insertBefore,m,y)},merge:(m,y)=>{p(La.merge,m,y)},replace:(m,y)=>{p(La.replace,m,y)},detach:m=>{for(let y=0;y<d.length;y++)if(d[y]===m)return d.splice(y,1),u.splice(y,1)[0];throw new Error("renderFunction was not found")}},e},ot=(t,e,...r)=>{try{return t?.call(e,...r)}catch(i){console.error(i,t)}},I$=async(t,e,...r)=>{try{return await t?.call(e,...r)}catch(i){console.error(i,t)}},n3=Symbol.for("controller"),Pce=t=>typeof t=="object"&&t!==null&&(n3 in t||"hostConnected"in t||"hostDisconnected"in t||"hostUpdate"in t||"hostUpdated"in t),u3e=t=>typeof t?.then=="function";let gf;const vf=t=>{gf!==t&&(gf=t,queueMicrotask(()=>gf===t?gf=void 0:0))},ab=t=>gf;let zl=[];const Ace=t=>{if(t===void 0){zl=[];return}const e=zl.indexOf(t);zl=e===-1?[...zl,t]:zl.slice(0,e+1),queueMicrotask(()=>zl=[])},Rce=()=>zl;let gd;const c3e=t=>{gd!==t&&(gd=t,queueMicrotask(()=>gd===t?gd=void 0:0))},Lce=()=>{const t=gd;return gd=void 0,t},Fce=async(t,e)=>{const r=o3(t);if(r===void 0)return t;if(await r.ready,typeof e=="function"){const i=r.watchExports(s=>e(s,i))}return r.exports},Nce=async t=>{const e=o3(t);return await e.ready,e},o3=t=>{const r=ab().manager.X(t);if(r!==void 0)return r;if(Pce(t))return t;const i=Lce();if(i!==void 0)return i};let E$=!1;const d3e=t=>{E$=!0;try{return t()}finally{E$=!1}};const I0=globalThis,a3=I0.ShadowRoot&&(I0.ShadyCSS===void 0||I0.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,l3=Symbol(),TC=new WeakMap;let l8=class{constructor(e,r,i){if(this._$cssResult$=!0,i!==l3)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=r}get styleSheet(){let e=this.o;const r=this.t;if(a3&&e===void 0){const i=r!==void 0&&r.length===1;i&&(e=TC.get(r)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&TC.set(r,e))}return e}toString(){return this.cssText}};const Dce=t=>new l8(typeof t=="string"?t:t+"",void 0,l3),p3e=(t,...e)=>{const r=t.length===1?t[0]:e.reduce((i,s,n)=>i+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[n+1],t[0]);return new l8(r,t,l3)},jce=(t,e)=>{if(a3)t.adoptedStyleSheets=e.map(r=>r instanceof CSSStyleSheet?r:r.styleSheet);else for(const r of e){const i=document.createElement("style"),s=I0.litNonce;s!==void 0&&i.setAttribute("nonce",s),i.textContent=r.cssText,t.appendChild(i)}},MC=a3?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let r="";for(const i of e.cssRules)r+=i.cssText;return Dce(r)})(t):t;const{is:Vce,defineProperty:zce,getOwnPropertyDescriptor:Uce,getOwnPropertyNames:qce,getOwnPropertySymbols:Gce,getPrototypeOf:Bce}=Object,lb=globalThis,IC=lb.trustedTypes,Hce=IC?IC.emptyScript:"",Wce=lb.reactiveElementPolyfillSupport,om=(t,e)=>t,O$={toAttribute(t,e){switch(e){case Boolean:t=t?Hce:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let r=t;switch(e){case Boolean:r=t!==null;break;case Number:r=t===null?null:Number(t);break;case Object:case Array:try{r=JSON.parse(t)}catch{r=null}}return r}},u3=(t,e)=>!Vce(t,e),EC={attribute:!0,type:String,converter:O$,reflect:!1,useDefault:!1,hasChanged:u3};Symbol.metadata??=Symbol("metadata"),lb.litPropertyMetadata??=new WeakMap;let Vc=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,r=EC){if(r.state&&(r.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((r=Object.create(r)).wrapped=!0),this.elementProperties.set(e,r),!r.noAccessor){const i=Symbol(),s=this.getPropertyDescriptor(e,i,r);s!==void 0&&zce(this.prototype,e,s)}}static getPropertyDescriptor(e,r,i){const{get:s,set:n}=Uce(this.prototype,e)??{get(){return this[r]},set(o){this[r]=o}};return{get:s,set(o){const l=s?.call(this);n?.call(this,o),this.requestUpdate(e,l,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??EC}static _$Ei(){if(this.hasOwnProperty(om("elementProperties")))return;const e=Bce(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(om("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(om("properties"))){const r=this.properties,i=[...qce(r),...Gce(r)];for(const s of i)this.createProperty(s,r[s])}const e=this[Symbol.metadata];if(e!==null){const r=litPropertyMetadata.get(e);if(r!==void 0)for(const[i,s]of r)this.elementProperties.set(i,s)}this._$Eh=new Map;for(const[r,i]of this.elementProperties){const s=this._$Eu(r,i);s!==void 0&&this._$Eh.set(s,r)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const r=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const s of i)r.unshift(MC(s))}else e!==void 0&&r.push(MC(e));return r}static _$Eu(e,r){const i=r.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,r=this.constructor.elementProperties;for(const i of r.keys())this.hasOwnProperty(i)&&(e.set(i,this[i]),delete this[i]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return jce(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,r,i){this._$AK(e,i)}_$ET(e,r){const i=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,i);if(s!==void 0&&i.reflect===!0){const n=(i.converter?.toAttribute!==void 0?i.converter:O$).toAttribute(r,i.type);this._$Em=e,n==null?this.removeAttribute(s):this.setAttribute(s,n),this._$Em=null}}_$AK(e,r){const i=this.constructor,s=i._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const n=i.getPropertyOptions(s),o=typeof n.converter=="function"?{fromAttribute:n.converter}:n.converter?.fromAttribute!==void 0?n.converter:O$;this._$Em=s;const l=o.fromAttribute(r,n.type);this[s]=l??this._$Ej?.get(s)??l,this._$Em=null}}requestUpdate(e,r,i,s=!1,n){if(e!==void 0){const o=this.constructor;if(s===!1&&(n=this[e]),i??=o.getPropertyOptions(e),!((i.hasChanged??u3)(n,r)||i.useDefault&&i.reflect&&n===this._$Ej?.get(e)&&!this.hasAttribute(o._$Eu(e,i))))return;this.C(e,r,i)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,r,{useDefault:i,reflect:s,wrapped:n},o){i&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??r??this[e]),n!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||i||(r=void 0),this._$AL.set(e,r)),s===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(r){Promise.reject(r)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,n]of this._$Ep)this[s]=n;this._$Ep=void 0}const i=this.constructor.elementProperties;if(i.size>0)for(const[s,n]of i){const{wrapped:o}=n,l=this[s];o!==!0||this._$AL.has(s)||l===void 0||this.C(s,void 0,n,l)}}let e=!1;const r=this._$AL;try{e=this.shouldUpdate(r),e?(this.willUpdate(r),this._$EO?.forEach(i=>i.hostUpdate?.()),this.update(r)):this._$EM()}catch(i){throw e=!1,this._$EM(),i}e&&this._$AE(r)}willUpdate(e){}_$AE(e){this._$EO?.forEach(r=>r.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(r=>this._$ET(r,this[r])),this._$EM()}updated(e){}firstUpdated(e){}};Vc.elementStyles=[],Vc.shadowRootOptions={mode:"open"},Vc[om("elementProperties")]=new Map,Vc[om("finalized")]=new Map,Wce?.({ReactiveElement:Vc}),(lb.reactiveElementVersions??=[]).push("2.1.2");const c3=globalThis,OC=t=>t,Xv=c3.trustedTypes,kC=Xv?Xv.createPolicy("lit-html",{createHTML:t=>t}):void 0,u8="$lit$",Ea=`lit$${Math.random().toFixed(9).slice(2)}$`,c8="?"+Ea,Zce=`<${c8}>`,Du=document,Lm=()=>Du.createComment(""),Fm=t=>t===null||typeof t!="object"&&typeof t!="function",d3=Array.isArray,Jce=t=>d3(t)||typeof t?.[Symbol.iterator]=="function",U1=`[ 	
\f\r]`,Fp=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,CC=/-->/g,PC=/>/g,_l=RegExp(`>|${U1}(?:([^\\s"'>=/]+)(${U1}*=${U1}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),AC=/'/g,RC=/"/g,d8=/^(?:script|style|textarea|title)$/i,h8=t=>(e,...r)=>({_$litType$:t,strings:e,values:r}),m3e=h8(1),y3e=h8(2),rl=Symbol.for("lit-noChange"),bt=Symbol.for("lit-nothing"),LC=new WeakMap,lu=Du.createTreeWalker(Du,129);function p8(t,e){if(!d3(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return kC!==void 0?kC.createHTML(e):e}const Yce=(t,e)=>{const r=t.length-1,i=[];let s,n=e===2?"<svg>":e===3?"<math>":"",o=Fp;for(let l=0;l<r;l++){const u=t[l];let d,p,f=-1,m=0;for(;m<u.length&&(o.lastIndex=m,p=o.exec(u),p!==null);)m=o.lastIndex,o===Fp?p[1]==="!--"?o=CC:p[1]!==void 0?o=PC:p[2]!==void 0?(d8.test(p[2])&&(s=RegExp("</"+p[2],"g")),o=_l):p[3]!==void 0&&(o=_l):o===_l?p[0]===">"?(o=s??Fp,f=-1):p[1]===void 0?f=-2:(f=o.lastIndex-p[2].length,d=p[1],o=p[3]===void 0?_l:p[3]==='"'?RC:AC):o===RC||o===AC?o=_l:o===CC||o===PC?o=Fp:(o=_l,s=void 0);const y=o===_l&&t[l+1].startsWith("/>")?" ":"";n+=o===Fp?u+Zce:f>=0?(i.push(d),u.slice(0,f)+u8+u.slice(f)+Ea+y):u+Ea+(f===-2?l:y)}return[p8(t,n+(t[r]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),i]};let k$=class f8{constructor({strings:e,_$litType$:r},i){let s;this.parts=[];let n=0,o=0;const l=e.length-1,u=this.parts,[d,p]=Yce(e,r);if(this.el=f8.createElement(d,i),lu.currentNode=this.el.content,r===2||r===3){const f=this.el.content.firstChild;f.replaceWith(...f.childNodes)}for(;(s=lu.nextNode())!==null&&u.length<l;){if(s.nodeType===1){if(s.hasAttributes())for(const f of s.getAttributeNames())if(f.endsWith(u8)){const m=p[o++],y=s.getAttribute(f).split(Ea),g=/([.?@])?(.*)/.exec(m);u.push({type:1,index:n,name:g[2],strings:y,ctor:g[1]==="."?Qce:g[1]==="?"?Xce:g[1]==="@"?ede:cb}),s.removeAttribute(f)}else f.startsWith(Ea)&&(u.push({type:6,index:n}),s.removeAttribute(f));if(d8.test(s.tagName)){const f=s.textContent.split(Ea),m=f.length-1;if(m>0){s.textContent=Xv?Xv.emptyScript:"";for(let y=0;y<m;y++)s.append(f[y],Lm()),lu.nextNode(),u.push({type:2,index:++n});s.append(f[m],Lm())}}}else if(s.nodeType===8)if(s.data===c8)u.push({type:2,index:n});else{let f=-1;for(;(f=s.data.indexOf(Ea,f+1))!==-1;)u.push({type:7,index:n}),f+=Ea.length-1}n++}}static createElement(e,r){const i=Du.createElement("template");return i.innerHTML=e,i}};function Lh(t,e,r=t,i){if(e===rl)return e;let s=i!==void 0?r._$Co?.[i]:r._$Cl;const n=Fm(e)?void 0:e._$litDirective$;return s?.constructor!==n&&(s?._$AO?.(!1),n===void 0?s=void 0:(s=new n(t),s._$AT(t,r,i)),i!==void 0?(r._$Co??=[])[i]=s:r._$Cl=s),s!==void 0&&(e=Lh(t,s._$AS(t,e.values),s,i)),e}let Kce=class{constructor(e,r){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=r}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:r},parts:i}=this._$AD,s=(e?.creationScope??Du).importNode(r,!0);lu.currentNode=s;let n=lu.nextNode(),o=0,l=0,u=i[0];for(;u!==void 0;){if(o===u.index){let d;u.type===2?d=new ub(n,n.nextSibling,this,e):u.type===1?d=new u.ctor(n,u.name,u.strings,this,e):u.type===6&&(d=new tde(n,this,e)),this._$AV.push(d),u=i[++l]}o!==u?.index&&(n=lu.nextNode(),o++)}return lu.currentNode=Du,s}p(e){let r=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,r),r+=i.strings.length-2):i._$AI(e[r])),r++}},ub=class m8{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,r,i,s){this.type=2,this._$AH=bt,this._$AN=void 0,this._$AA=e,this._$AB=r,this._$AM=i,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const r=this._$AM;return r!==void 0&&e?.nodeType===11&&(e=r.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,r=this){e=Lh(this,e,r),Fm(e)?e===bt||e==null||e===""?(this._$AH!==bt&&this._$AR(),this._$AH=bt):e!==this._$AH&&e!==rl&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Jce(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==bt&&Fm(this._$AH)?this._$AA.nextSibling.data=e:this.T(Du.createTextNode(e)),this._$AH=e}$(e){const{values:r,_$litType$:i}=e,s=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=k$.createElement(p8(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===s)this._$AH.p(r);else{const n=new Kce(s,this),o=n.u(this.options);n.p(r),this.T(o),this._$AH=n}}_$AC(e){let r=LC.get(e.strings);return r===void 0&&LC.set(e.strings,r=new k$(e)),r}k(e){d3(this._$AH)||(this._$AH=[],this._$AR());const r=this._$AH;let i,s=0;for(const n of e)s===r.length?r.push(i=new m8(this.O(Lm()),this.O(Lm()),this,this.options)):i=r[s],i._$AI(n),s++;s<r.length&&(this._$AR(i&&i._$AB.nextSibling,s),r.length=s)}_$AR(e=this._$AA.nextSibling,r){for(this._$AP?.(!1,!0,r);e!==this._$AB;){const i=OC(e).nextSibling;OC(e).remove(),e=i}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},cb=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,r,i,s,n){this.type=1,this._$AH=bt,this._$AN=void 0,this.element=e,this.name=r,this._$AM=s,this.options=n,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=bt}_$AI(e,r=this,i,s){const n=this.strings;let o=!1;if(n===void 0)e=Lh(this,e,r,0),o=!Fm(e)||e!==this._$AH&&e!==rl,o&&(this._$AH=e);else{const l=e;let u,d;for(e=n[0],u=0;u<n.length-1;u++)d=Lh(this,l[i+u],r,u),d===rl&&(d=this._$AH[u]),o||=!Fm(d)||d!==this._$AH[u],d===bt?e=bt:e!==bt&&(e+=(d??"")+n[u+1]),this._$AH[u]=d}o&&!s&&this.j(e)}j(e){e===bt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},Qce=class extends cb{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===bt?void 0:e}},Xce=class extends cb{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==bt)}},ede=class extends cb{constructor(e,r,i,s,n){super(e,r,i,s,n),this.type=5}_$AI(e,r=this){if((e=Lh(this,e,r,0)??bt)===rl)return;const i=this._$AH,s=e===bt&&i!==bt||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,n=e!==bt&&(i===bt||s);s&&this.element.removeEventListener(this.name,this,i),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},tde=class{constructor(e,r,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=r,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){Lh(this,e)}};const $3e={I:ub},rde=c3.litHtmlPolyfillSupport;rde?.(k$,ub),(c3.litHtmlVersions??=[]).push("3.3.2");const ide=(t,e,r)=>{const i=r?.renderBefore??e;let s=i._$litPart$;if(s===void 0){const n=r?.renderBefore??null;i._$litPart$=s=new ub(e.insertBefore(Lm(),n),n,void 0,r??{})}return s._$AI(t),s};const h3=globalThis;let Dd=class extends Vc{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=ide(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return rl}};Dd._$litElement$=!0,Dd.finalized=!0,h3.litElementHydrateSupport?.({LitElement:Dd});const sde=h3.litElementPolyfillSupport;sde?.({LitElement:Dd});(h3.litElementVersions??=[]).push("4.2.2");class Nm{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}const nde=(t,e)=>{const r=e/ode;let i=0;const s=setInterval(()=>{i+=r,i>=e&&(clearInterval(s),t())},r);return s},ode=4,ade=(t,e,r)=>{const i=Object.keys(t),s=i.length;vd===void 0&&queueMicrotask(db),vd??=new Map;let n=vd.get(t);return n===void 0&&(n={callbacks:[],keyCount:s},vd.set(t,n)),n.keyCount!==s&&(n.callbacks.forEach(o=>o(i)),n.callbacks=[],n.keyCount=s),n.callbacks.push(o=>{const l=d=>ot(e,null,d),u=o[s];u===void 0?l(void 0):t[u]===r?l(u):l(void 0)}),r};let vd;const db=()=>{vd?.forEach(({callbacks:t},e)=>{const r=Object.keys(e);t.forEach(i=>i(r))}),vd=void 0},lde=(t,e,r)=>{const i=t.manager;return i.V!==bt&&i.V!==r&&i.S(void 0,void 0),i.T.length===0&&queueMicrotask(()=>i.S(void 0,void 0)),i.V=r,i.T.push((s,n)=>ot(e,void 0,r===n?s:void 0)),r},ude=(t=[ab(),...Rce()],e,r)=>{const i=Array.isArray(t)?t:[t];let s=i.length+1;const n=o=>{s-=1,o!==void 0&&(s=Math.min(s,0)),s===0&&e(o)};i.forEach(o=>ade(o,l=>n(l===void 0?void 0:{key:l,host:o,isReactive:!1}),r));for(const o of i)if("manager"in o&&o.manager.component===o){lde(o,l=>n(l===void 0?void 0:{key:l,host:o,isReactive:!0}),r);break}return r},cde=(t="",e={},r=ab())=>{const i={emit:s=>{t===""&&db();const n=new CustomEvent(t,{detail:s,cancelable:!0,bubbles:!0,composed:!0,...e});return r.el.dispatchEvent(n),n}};return t===""&&ude(void 0,s=>t=s.key,i),i},T3e=cde.bind(null,"");var y8;y8=n3;class dde{constructor(e){this.#r=[],this.#e=[],this.#i=[],this.#l=[],this.#u=[],this.#c=[],this.#d=[],this.#h=[],this.#o=[],this.#a=!1,this.P=new Nm,this.connectedCalled=!1,this.loadedCalled=!1,this[y8]=!0,this.#n=[];const r=this,i=e??ab();r.#t=i,r.ready=r.P.promise,r.#s=NC(r),r.component=i,r.#t.addController(r),r.#t.manager===void 0||(Ace(r),queueMicrotask(()=>r.catchUpLifecycle()))}#r;#e;#i;#l;#u;#c;#d;#h;#o;#a;#t;catchUpLifecycle(){const{manager:e}=this.#t;e.connectedCalled&&!this.connectedCalled&&this.triggerConnected(),e.#a&&this.triggerLoad().then(()=>e.loadedCalled&&this.triggerLoaded()).catch(console.error)}#s;get exports(){return this.#s}set exports(e){const r=this.#s;r!==e&&(this.#s=e,this.#n.forEach(ot),this.connectedCalled&&this.O!==!1&&this.#t.requestUpdate(this.O,r)),this.P.resolve(e)}setProvisionalExports(e,r=!0){this.#s=r?NC(e):e,this.#n.forEach(ot)}#n;watchExports(e){const r=()=>e(this.#s);return this.#n.push(r),()=>{this.#n.splice(this.#n.indexOf(r),1)}}get use(){return vf(this.#t),Fce}get useRef(){return vf(this.#t),Nce}get useRefSync(){return vf(this.#t),o3}controllerRemoved(){this.#t.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(e){this.#r.push(e)}onDisconnected(e){this.#e.push(e)}onLoad(e){this.#i.push(e)}onLoaded(e){this.#l.push(e)}onUpdate(e){this.#u.push(e)}onUpdated(e){this.#c.push(e)}onDestroy(e){this.#d.push(e)}onLifecycle(e){this.#h.push(e),this.connectedCalled&&this.#t.el.isConnected&&this.#p(e)}triggerConnected(){const e=this;e.hostConnected&&ot(e.hostConnected,e),e.#r.forEach(ot),e.triggerLifecycle(),e.connectedCalled=!0}triggerDisconnected(){const e=this;e.hostDisconnected&&ot(e.hostDisconnected,e),e.#e.forEach(ot),e.#o.forEach(ot),e.#o=[]}async triggerLoad(){if(this.#a)return;this.#a=!0;const e=this;e.hostLoad&&await I$(e.hostLoad,e),this.#i.length>0&&await Promise.allSettled(this.#i.map(I$)),this.P.resolve(this.#s)}triggerLoaded(){this.loadedCalled||(this.hostLoaded&&ot(this.hostLoaded,this),this.#l.forEach(ot),this.loadedCalled=!0)}triggerUpdate(e){this.hostUpdate&&ot(this.hostUpdate,this,e),this.#u.forEach(FC,e)}triggerUpdated(e){this.hostUpdated&&ot(this.hostUpdated,this,e),this.#c.forEach(FC,e)}triggerDestroy(){this.hostDestroy&&ot(this.hostDestroy,this),this.#d.forEach(ot)}triggerLifecycle(){this.hostLifecycle&&this.#p(()=>this.hostLifecycle()),this.#h.forEach(this.#p,this)}#p(e){vf(this.#t);const r=ot(e);(Array.isArray(r)?r:[r]).forEach(s=>{typeof s=="function"?this.#o.push(s):typeof s=="object"&&typeof s.remove=="function"&&this.#o.push(s.remove)})}}function FC(t){ot(t,void 0,this)}const hde=dde,NC=t=>{if(typeof t!="object"&&typeof t!="function"||t===null)return t;const e={get(i,s,n){if(!((s==="exports"||s==="_exports")&&s in i&&i[s]===r)&&(s in i||s in Promise.prototype||typeof s=="symbol"))return typeof i=="function"?i[s]:Reflect.get(i,s,n)}},r=new Proxy(t,e);return r},pde=t=>t.replace(fde,(e,r)=>`${r===0?"":"-"}${e.toLowerCase()}`),fde=/[A-Z]+(?![a-z])|[A-Z]/gu,mde=1,yde=2,gde=4,vde=8,wde=16,bde=32,_de=64,g8=t=>{let e=t;for(;e=e.parentNode??e.host;)if(e?.constructor?.lumina){const r=e;return r.manager?.loadedCalled||(r.J??r._offspring).push(t),(r.I??r._postLoad).promise}return!1},DC={};function v8(){}const E0=Object.defineProperty,Sde=globalThis.HTMLElement??v8;var li,ko,nh,Gm,C$;const V3=class V3 extends Sde{constructor(){var s;super();Ss(this,Gm);Ss(this,li);Ss(this,ko);Ss(this,nh);$s(this,ko,{}),$s(this,nh,[]),this.I=new Nm,this.H=new Nm,this.J=[];const r=this,i=r.constructor;r._offspring=r.J,r._postLoad=r.I,i.C?.forEach(n=>{Object.hasOwn(r,n)&&(je(r,ko)[n]=r[n],delete r[n])}),i.A?hp(s=r,Gm,C$).call(s,{a:i.A}):i.B.then(async n=>{var o;await i.K.p,hp(o=r,Gm,C$).call(o,await(n.default?.then(l=>typeof l=="function"?{a:l}:l)??n))}).catch(n=>{r.H.reject(n),setTimeout(()=>{throw n})})}static F(){for(const r of this.C??[])E0(this.prototype,r,{configurable:!0,enumerable:!0,get(){return je(this,ko)[r]},set(i){je(this,ko)[r]=i}});for(const r of this.E??[])E0(this.prototype,r,{async value(...i){return je(this,li)||await this.H.promise,await je(this,li)[r](...i)},configurable:!0});for(const r of this.D??[])E0(this.prototype,r,{value(...i){return je(this,li)[r](...i)},configurable:!0})}get manager(){return je(this,li)?.manager}attributeChangedCallback(r,i,s){je(this,li)?.attributeChangedCallback(r,i,s),je(this,li)||je(this,nh).push(r)}connectedCallback(){je(this,li)?je(this,li).connectedCallback?.():queueMicrotask(()=>this.G=g8(this))}disconnectedCallback(){je(this,li)?.disconnectedCallback?.()}async componentOnReady(){return await this.H.promise,this}addController(){}requestUpdate(){je(this,li)?.requestUpdate()}};li=new WeakMap,ko=new WeakMap,nh=new WeakMap,Gm=new WeakSet,C$=function(r){const i=this.constructor,s=i.L,n=je(this,ko),o=Object.values(r).find(m=>m.L===s),l=`${s}--lazy`;let u=o;for(;u&&!Object.hasOwn(u,"lumina");)u=Object.getPrototypeOf(u);xde(u),!i.A&&(i.A=o,customElements.define(l,o)),o.N=this;const p=document.createElement(l);o.N=void 0,$s(this,li,p),$s(this,ko,p),je(this,nh).forEach(m=>p.attributeChangedCallback(m,null,this.getAttribute(m))),Object.entries(n).forEach($de,p);const f=this.isConnected;(f||this.G)&&(p.connectedCallback?.(),f||p.disconnectedCallback())},V3.lumina=!0;let jC=V3;function $de([t,e]){this[t]=e}const xde=t=>{const e=t.prototype,r=Element.prototype;Object.hasOwn(e,"isConnected")||(e.setAttribute=function(s,n){r.setAttribute.call(this.el,s,n)},e.removeAttribute=function(s){r.removeAttribute.call(this.el,s)},E0(e,"isConnected",{get(){return Reflect.get(r,"isConnected",this.el)}}))};const w8={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},b8=t=>(...e)=>({_$litDirective$:t,values:e});let _8=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,r,i){this._$Ct=e,this._$AM=r,this._$Ci=i}_$AS(e,r){return this.update(e,r)}update(e,r){return this.render(...r)}};const Tde=b8(class extends _8{constructor(t){if(super(t),t.type!==w8.ATTRIBUTE||t.name!=="class"||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter(e=>t[e]).join(" ")+" "}update(t,[e]){if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(i=>i!=="")));for(const i in e)e[i]&&!this.nt?.has(i)&&this.st.add(i);return this.render(e)}const r=t.element.classList;for(const i of this.st)i in e||(r.remove(i),this.st.delete(i));for(const i in e){const s=!!e[i];s===this.st.has(i)||this.nt?.has(i)||(s?(r.add(i),this.st.add(i)):(r.remove(i),this.st.delete(i)))}return rl}});const S8="important",Mde=" !"+S8,Ide=b8(class extends _8{constructor(t){if(super(t),t.type!==w8.ATTRIBUTE||t.name!=="style"||t.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce((e,r)=>{const i=t[r];return i==null?e:e+`${r=r.includes("-")?r:r.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${i};`},"")}update(t,[e]){const{style:r}=t.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(e)),this.render(e);for(const i of this.ft)e[i]==null&&(this.ft.delete(i),i.includes("-")?r.removeProperty(i):r[i]=null);for(const i in e){const s=e[i];if(s!=null){this.ft.add(i);const n=typeof s=="string"&&s.endsWith(Mde);i.includes("-")||n?r.setProperty(i,n?s.slice(0,-11):s,n?S8:""):r[i]=s}}return rl}});class Ede extends hde{constructor(e){super(e),this.destroyed=!1,this.R=!1,this.V=bt,this.T=[],this.#i=new WeakMap,this.#e=e,this.exports=void 0,this.hasDestroy=P$ in e&&typeof e.destroy=="function",Dd.prototype.addController.call(e,{hostConnected:()=>{if(this.destroyed){const r=e.el.localName;throw e.el.remove(),new Error(`The ${r} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${P$} prop.`)}this.#r!==void 0&&clearTimeout(this.#r),db();for(const r of e.M)"triggerConnected"in r?r.triggerConnected():ot(r.hostConnected,r)},hostDisconnected:()=>{for(const r of e.M)"triggerDisconnected"in r?r.triggerDisconnected():ot(r.hostDisconnected,r);this.hasDestroy&&!this.destroyed&&this.U()},hostUpdate:()=>{for(const r of e.M)"triggerUpdate"in r?r.triggerUpdate(this.Q):ot(r.hostUpdate,r,this.Q)},hostUpdated:()=>{for(const r of e.M)"triggerUpdated"in r?r.triggerUpdated(this.Q):ot(r.hostUpdated,r,this.Q);this.Q=void 0}}),queueMicrotask(()=>this.R=!0),vf(e)}#r;#e;async destroy(){if(!this.destroyed){this.#e.el.isConnected&&(this.hasDestroy=!1,this.#e.el.remove()),this.#r=void 0,this.destroyed=!0;for(const e of this.#e.M)"triggerDestroy"in e?e.triggerDestroy():ot(e.hostDestroy,e);this.#e.M.splice(0)}}U(){if(this.#r!==void 0&&clearTimeout(this.#r),!this.#e.el.isConnected&&!this.#e.autoDestroyDisabled){const e=()=>{this.#e.destroy()};this.#r=nde(e,Ode)}}S(e,r){const i=this.T;this.V=bt,this.T=[],i.forEach(s=>s(e,r))}#i;W(e,r){(typeof r=="object"&&r!==null||typeof r=="function")&&this.#i.set(r,e)}X(e){if(typeof e=="object"&&e!==null||typeof e=="function")return this.#i.get(e)}}let Ode=1e3;const P$="autoDestroyDisabled";var cu,Bm,Hm,du,Tn,Fh,$8,x8;const hm=class hm extends Dd{constructor(){super();Ss(this,Fh);Ss(this,cu);Ss(this,Bm);Ss(this,Hm);Ss(this,du);Ss(this,Tn);this.M=[],this.manager=new Ede(this);const r=this,i=r.constructor,s=i.N,n=i.K.o,o=hm.prototype.shouldUpdate;$s(r,du,s?.H??new Nm),r.I=s?.I??new Nm,r.J=s?.J??[],r._offspring=r.J,r._postLoad=r.I,r.el=s??r,$s(r,Hm,r.enableUpdating),r.enableUpdating=v8,r.shouldUpdate!==o&&($s(r,Bm,r.shouldUpdate),r.shouldUpdate=o),n&&($s(r,cu,new Map),i.elementProperties.forEach((l,u)=>je(r,cu).set(u,n())))}static finalizeStyles(r){const i=super.finalizeStyles(r),s=this.shadowRootOptions===DC;return this.K?.commonStyles===void 0||s?i:[this.K.commonStyles,...i]}static createProperty(r,i){const s=typeof i=="number"?i:Array.isArray(i)?i[0]:0,n=Array.isArray(i)?i[1]:void 0,o=n?.hasChanged??u3,l={attribute:s&mde&&typeof r=="string"?pde(r):!1,reflect:!!(s&yde),type:s&gde?Boolean:s&vde?Number:void 0,state:!!(s&wde),readOnly:!!(s&bde),noAccessor:!!(s&_de),c:!1,...n,hasChanged(u,d){const p=o(u,d);return l.c=p,p}};super.createProperty(r,l)}static getPropertyDescriptor(r,i,s){const n=this.K,o=super.getPropertyDescriptor(r,i,s);return s.d=o,{...o,get(){return n.t?.(je(this,cu).get(r)),o.get?.call(this)},set(l){const u=this.manager;if(s.readOnly&&!E$&&(u.R||u.connectedCalled))throw Error(`Cannot assign to read-only property "${r}" of ${this.el.localName}. Trying to assign "${l}"`);o.set.call(this,l??void 0),s.c&&je(this,cu)?.get(r)?.notify(),u.T.length>0&&(db(),u?.S(r,l))}}}connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const r=this.constructor.K.c?.(()=>this.requestUpdate());$s(this,Tn,r);const i=!this.manager.connectedCalled;super.connectedCallback(),i?queueMicrotask(()=>hp(this,Fh,x8).call(this).catch(s=>{je(this,du).reject(s),setTimeout(()=>{throw s})})):r&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),je(this,Tn)?.destroy(),$s(this,Tn,void 0)}createRenderRoot(){const r=this.el.shadowRoot,i=this.constructor,s=i.shadowRootOptions,o=r??(s===DC?this.el:this.el.attachShadow(s));if(this.isConnected){const l=o.getRootNode();l.adoptedStyleSheets=[...l.adoptedStyleSheets,...i.elementStyles.map(u=>"styleSheet"in u?u.styleSheet:u)]}return o}shouldUpdate(r){var i;return this.manager.Q=r,((i=je(this,Bm))==null?void 0:i.call(this,r))??!0}update(r){je(this,Tn)?hp(this,Fh,$8).call(this,r):super.update(r)}listen(r,i,s){const n=i?.bind(this)??i;this.manager.onLifecycle(()=>(this.el.addEventListener(r,n,s),()=>this.el.removeEventListener(r,n,s)))}listenOn(r,i,s,n){const o=s?.bind(this)??s;this.manager.onLifecycle(()=>(r.addEventListener(i,o,n),()=>r.removeEventListener(i,o,n)))}async componentOnReady(){return await je(this,du).promise,this}addController(r){this.M.push(r),!(n3 in r)&&this.renderRoot&&this.el.isConnected&&r.hostConnected?.()}removeController(r){this.M.splice(this.M.indexOf(r),1),r.controllerRemoved?.()}};cu=new WeakMap,Bm=new WeakMap,Hm=new WeakMap,du=new WeakMap,Tn=new WeakMap,Fh=new WeakSet,$8=function(r){try{je(this,Tn).clear(),this.constructor.K.r(je(this,Tn),()=>Y3(hm.prototype,this,"update").call(this,r))}catch(i){throw je(this,Tn).clear(),i}},x8=async function(){const r=this.el.G??g8(this.el);r&&await r;const i=[];for(const n of this.M)"triggerLoad"in n?i.push(n.triggerLoad()):i.push(I$(n.hostLoad,n));await Promise.all(i),await this.load?.(),this.manager.hasDestroy&&this.manager.onUpdate(n=>n.has(P$)&&this.manager.U()),je(this,Hm).call(this,!0),this.performUpdate(),this.I.resolve(),await Promise.resolve();const s=this.J.filter(n=>!n.manager?.loadedCalled);s.length&&await Promise.allSettled(s.map(async n=>await n.componentOnReady())),this.J.length=0,this.el.setAttribute(this.constructor.K.hydratedAttribute,"");for(const n of this.M)"triggerLoaded"in n?n.triggerLoaded():ot(n.hostLoaded,n);this.loaded?.(),je(this,du).resolve()},hm.lumina=!0;let VC=hm;const kde=t=>{let e;const r=s=>{e=new URL(s,globalThis.location?.href||void 0).href},i={...t,getAssetPath(s){const n=new URL(s,e);return n.origin!==globalThis.location?.origin?n.href:n.pathname},setAssetPath:r,customElement(s,n){n.K=i,n.L=s,customElements.get(s)||customElements.define(s,n)}};return r(t.defaultAssetPath),i},I3e=t=>typeof t=="object"&&t!=null?Tde(t):t,E3e=t=>typeof t=="object"&&t!=null?Ide(t):t,O3e=bt;function k3e(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}const C3e={toAttribute:t=>t===!0?"":t===!1?null:t},Cde="calcite-mode-auto",Pde="calcite-mode-dark",P3e={rtl:"calcite--rtl"},A3e={filter:250,nextTick:0,resize:150,reposition:100},R3e=25;function zC(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,r=()=>t.contains(Pde)||t.contains(Cde)&&e?"dark":"light",i=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),s=o=>{n!==o&&i(o),n=o};let n=r();i(n),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>s(o.matches?"dark":"light")),new MutationObserver(()=>s(r())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const am=globalThis.calciteConfig,L3e=am?.focusTrapStack||[],F3e=am?.logLevel||"info",UC="3.3.3",Ade="2025-10-08",Rde="7391af08e";function Lde(){if(am&&am.version)return;console.info(`Using Calcite Components ${UC} [Date: ${Ade}, Revision: ${Rde}]`);const t=am||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:UC,writable:!1}),globalThis.calciteConfig=t}document.readyState==="interactive"?zC():document.addEventListener("DOMContentLoaded",zC,{once:!0});queueMicrotask(Lde);const Fde=kde({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.3.3/",hydratedAttribute:"calcite-hydrated"}),{customElement:N3e,getAssetPath:D3e,setAssetPath:Nde}=Fde;let T8=!1;const Dde=t=>{T8=!0,Nde(t)};let M8;function jde(){T8||Dde(as(nt(M8)))}function by(t){const e=[];for(const r of Object.keys(t))customElements.get(`calcite-${r}`)||e.push(t[r]?.());return e.length>0?Promise.all(e):null}M8="components/assets";const I8=Symbol("widget"),E8=Symbol("widget-test-data"),Vde=[],zde={},ew=new WeakMap;function O8(t,e){let r=e.children;if(r?.length)for(let s=0;s<r.length;++s)r[s]=O8(t,r[s]);else r=Vde;const i=e.vnodeSelector;if(tw(i)){const s=e.properties||zde,n=s.key||i,o={key:n,afterCreate:Ude,afterUpdate:qde,afterRemoved:k8,parentWidget:t,widgetConstructor:i,widgetProperties:{...s,key:n,children:r}};return{vnodeSelector:i.vnodeSelector,properties:o,children:void 0,text:void 0,domNode:null}}return e}function Ude(t,e,r,{parentWidget:i,widgetConstructor:s,widgetProperties:n}){const o=new s(n);o.container=t,ew.set(t,o),o.afterCreate?.(o,t),i.addHandles(Te(()=>k8(t))),queueMicrotask(()=>{o[E8].projector?.renderNow()})}function qde(t,e,r,{widgetProperties:i}){const s=ew.get(t);s&&(s.set(i),s.afterUpdate?.(s,t))}function k8(t){const e=ew.get(t);e&&(e.afterRemoved?.(e,t),e.destroy(),ew.delete(t))}function tw(t){return typeof t=="function"&&t[I8]}const qC=new Set;function Gde(t){qC.add(t),t.finally(()=>qC.delete(t))}function Bde(t){return Te()}var GC;let Hde=0;function C8(t,e){const r=Object.prototype.hasOwnProperty;for(const i in e)r.call(e,i)&&r.call(t,i)&&(t[i]!=null&&e[i]!=null&&typeof t[i]=="object"&&typeof e[i]=="object"?C8(t[i],e[i]):t[i]=e[i]);return t}const Wde=Cce({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,r=/capture$/i;t.eventHandlerInterceptor=(i,s,n,o)=>{const l=e?.(i,s,n,o),u=r.test(i);if(!((i=i.replace(r,"")).toLowerCase()in n)||u){const d=i[2].toLowerCase()+i.slice(3),p=y=>l?.call(n,y);n.addEventListener(d,p,u);const f=()=>n.removeEventListener(d,p,u),m=o.afterRemoved;o.afterRemoved=y=>{m?.(y),f()}}return l}},handleInterceptedEvent(t,e,r,i){const{eventPhase:s,type:n}=i,o=s===Event.CAPTURING_PHASE;let l=`on${n}${o?"capture":""}`;const u=e.properties;(u&&l in u||(l=`on${n[0].toUpperCase()}${n.slice(1)}${o?"Capture":""}`,u&&l in u))&&(o8(),t.scheduleRender(),u[l].call(u.bind||r,i))}});let q1=!1;var xu;let Qt=(xu=class extends kT(Zh){constructor(e,r){super(e,r),this._attached=!1,this._projector=Wde,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=mT(async()=>{if(this._messageBundleProps?.length){const u=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:d,propertyName:p})=>{if(this.destroyed)return;let f=await cF(d);this.destroyed||(this.uiStrings&&Object.keys(this.uiStrings)&&(f=C8(E(f),this.uiStrings)),this[p]=f)}));if(this.destroyed)return;for(const d of u)d.status==="rejected"&&L.getLogger(this).error("widget-intl:locale-error",this.declaredClass,d.reason)}await this.loadLocale()}),this.addHandles(Bde()),jde();const i="esri-widget-uid-"+ep(),s=this.render.bind(this);this._trackingTarget=new vw(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const n=()=>({vnodeSelector:"div",properties:{key:`${i}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),o=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const u=s()??n(),d=u.properties??={};if(d.key??=i,tw(u.vnodeSelector)){if(!this.visible)return n()}else this.visible?d.styles||(d.styles={}):(d.class="",d.styles={display:"none"}),d.styles.display??="";let p=0;return u.children?.forEach(f=>{tw(f.vnodeSelector)||(f.properties??={},f.properties.key??=`${this.id}--${p++}`)}),O8(this,u)};this.render=()=>{if(q1)return o();let u=gce(this)??null;if(u)return u;this._trackingTarget.clear(),q1=!0;try{u=zo(this._trackingTarget,o)}catch(d){throw L.getLogger(this).error(d),d}finally{q1=!1}return u&&vce(this,u),u};const l=this.beforeFirstRender();l?this._resourcesFetch=l.then(()=>{this.destroyed||(this._readyForTrueRender=!0,this._postInitialize())}):(this._resourcesFetch=Promise.resolve().then(()=>{this.destroyed||this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),Gde(this._resourcesFetch)}normalizeCtorArgs(e,r){const i={...e};return r&&(i.container=r),i}postInitialize(){}beforeFirstRender(){const e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(lI):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(Ke(this._trackingTarget),Ke(this.viewModel),this._detach(this.container),this._set("container",null),this.render=()=>null,this._projector=null,j1(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return $M(e)}get destroyed(){return super.destroyed}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+Hde++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(GC=I8,E8)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(j1(this),this._projector.scheduleRender())}classes(...e){return wce.apply(this,e)}renderNow(){j1(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(ne(()=>this.viewModel,(r,i)=>{i&&this.removeHandles("delegated-events"),r&&fw(r)&&this.addHandles(this._delegatedEventNames.map(s=>zh(r,s,n=>{this.emit(s,n)})),"delegated-events")},xr)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(lI),this.scheduleRender()};this.addHandles([aF(e),ne(()=>this.uiStrings,e)]),this.addHandles(qi(()=>this.container,r=>{this.destroyed||this._attach(r)},{initial:!0,once:!0}))}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}},xu[GC]=!0,xu.vnodeSelector="div",xu);a([c()],Qt.prototype,"_readyForTrueRender",void 0),a([c({value:null})],Qt.prototype,"container",null),a([Ce("container")],Qt.prototype,"castContainer",null),a([c()],Qt.prototype,"icon",null),a([c()],Qt.prototype,"id",null),a([c()],Qt.prototype,"label",null),a([c()],Qt.prototype,"renderable",null),a([c()],Qt.prototype,"uiStrings",void 0),a([c()],Qt.prototype,"viewModel",void 0),a([c({value:!0})],Qt.prototype,"visible",null),a([c()],Qt.prototype,"key",void 0),a([c()],Qt.prototype,"children",void 0),a([c()],Qt.prototype,"afterCreate",void 0),a([c()],Qt.prototype,"afterUpdate",void 0),a([c()],Qt.prototype,"afterRemoved",void 0),Qt=a([b("esri.widgets.Widget")],Qt);const np=Qt,Zde=new Map;function Jde(t){return Zde.get(t)}function BC(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function Yde(t,e){return t.length!==e.length||t.some((r,i)=>r.text!==e[i].text)}function hg(t,e,r){!r||!e||t.find(i=>i.layerView===e&&i.text===r)||t.push({text:r,layerView:e})}function Kde(t){return t.type==="bing-maps"}const an=[];let zc=class extends X{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new H,this.view=null,this._allLayerViewsChange=r=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const i=this.view?.allLayerViews;i&&(this.addHandles(i.map(s=>ne(()=>[s.suspended,s.layer?.attributionVisible],()=>this._updateAttributionItems())).toArray(),"suspension"),i.forEach(s=>{s.declaredClass==="esri.views.3d.layers.IntegratedMesh3DTilesLayerView3D"&&this.addHandles(s.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),r?.removed&&r.removed.forEach(s=>{this._pendingAttributions.delete(s),this._fetchedAttributionData.delete(s)}),this._updateAttributionItems()},this.addHandles([Lu(()=>this.view?.allLayerViews,"change",r=>this._allLayerViewsChange(r),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),qi(()=>this.view?.stationary===!0,()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,r=e?.allLayerViews;an.length=0;let i=!1,s=null;if(!e||!r)return void this._clear();r.forEach(o=>{if(o.suspended||!o.layer?.attributionVisible)return;const l=o.layer;if(BC(l,"user"))return void hg(an,o,l.copyright);if(l.type==="integrated-mesh-3dtiles"&&l.hasGoogleUrl&&(i=!0,s=o),l.hasAttributionData){if(this._fetchedAttributionData.has(o)){const d=this._fetchedAttributionData.get(o);return void(d?hg(an,o,this._getDynamicAttribution(d,e,l)):BC(l)&&hg(an,o,l.copyright))}return void this._fetchAttributionData(o)}const u="portalItem"in l?l.portalItem?.accessInformation:void 0;hg(an,o,u||l.copyright)});const n=r.find(o=>o.layer?.type==="integrated-mesh-3dtiles");if(this.view&&n){const o=Jde(this.view);if(o){const l=o.getAttributionText();for(let u=l.length-1;u>-1;--u)an.unshift({text:l[u],layerView:n})}}i&&s&&an.unshift({text:"Google Maps",layerView:s}),Yde(this.items,an)&&(this.items.removeAll(),this.items.addMany(an)),an.length=0,this.notifyChange("state")}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const r=await Sw(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const i=r.ok?this._createContributionIndex(r.value,Kde(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,i)}this._updateAttributionItems()}_createContributionIndex(e,r){const i=e.contributors,s={};if(!i)return s;for(let n=0;n<i.length;n++){const o=i[n],l=o.coverageAreas;if(!l)return;for(const u of l){const d=u.bbox,p=u.zoomMin-(r&&u.zoomMin?1:0),f=u.zoomMax-(r&&u.zoomMax?1:0),m=new he({xmin:d[1],ymin:d[0],xmax:d[3],ymax:d[2],spatialReference:Z.WGS84}),y={extent:za(m),attribution:o.attribution||"",score:u.score!=null?u.score:100,id:n};for(let g=p;g<=f;g++)s[g]??=[],s[g].push(y)}}return s.maxKey=Math.max.apply(null,Object.keys(s)),s}_getDynamicAttribution(e,r,i){const{extent:s,scale:n}=r;let o=i.tileInfo?.scaleToZoom(n)??0;if(o=Math.min(e.maxKey??0,Math.round(o)),!s||o==null||o<=-1)return"";const l=e[o],u=Mw(s.center.clone().normalize(),Z.WebMercator),d=new Set;return l?l.filter(p=>{const f=p.id,m=!d.has(f)&&u&&p.extent&&ty(p.extent,u);return m&&d.add(f),m}).sort((p,f)=>f.score-p.score||p.objectId-f.objectId).map(p=>p.attribution).join(", "):""}};a([c({readOnly:!0,type:H})],zc.prototype,"items",void 0),a([c({readOnly:!0})],zc.prototype,"state",null),a([c()],zc.prototype,"view",void 0),zc=a([b("esri.widgets.Attribution.AttributionViewModel")],zc);const P8=zc,fs={button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",empty:"esri-widget__content--empty",heading:"esri-widget__heading",interactive:"esri-interactive",panel:"esri-widget--panel",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button"};function Qde(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:ehe(t[e])}}}function Xde(t){const e=t?.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function ehe(t){return function(e,...r){Xde(e)?_ce(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...r)}}function ju(t){return(e,r)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:r})}}var the=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},A8=function(t,e){for(var r=0,i=t.length;r<i;r++){var s=t[r];Array.isArray(s)?A8(s,e):s!=null&&s!==!1&&(s.hasOwnProperty("vnodeSelector")||(s=the(s)),e.push(s))}},rhe=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(r.length===1&&typeof r[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:r[0],domNode:null};var s=[];return A8(r,s),{vnodeSelector:t,properties:e||void 0,children:s,text:void 0,domNode:null}};function Ie(t,e,...r){return typeof t!="function"||tw(t)?rhe(t,e??null,...r):t(e,...r)}function V3e(...t){return t}const cc="esri-attribution",dc={base:cc,poweredBy:`${cc}__powered-by`,sources:`${cc}__sources`,open:`${cc}--open`,sourcesOpen:`${cc}__sources--open`,link:`${cc}__link`};let Nr=class extends np{constructor(e,r){super(e,r),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._sourcesNode=null,this._overflowRequestAnimationFrame=null,this._resizeObserver=new ResizeObserver(i=>{i.forEach(({target:s})=>{this._scheduleOverflowCheck(s)})}),this._mutationObserver=new MutationObserver(i=>{let s=!1;for(const n of i)if(n.type==="childList"||n.type==="characterData"||n.type==="attributes"){s=!0;break}s&&this._sourcesNode&&this._scheduleOverflowCheck(this._sourcesNode)}),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new P8}initialize(){this.addHandles(Lu(()=>this.viewModel?.items,"change",()=>this.scheduleRender()))}destroy(){this._resizeObserver?.disconnect(),this._mutationObserver?.disconnect(),this._overflowRequestAnimationFrame!=null&&(cancelAnimationFrame(this._overflowRequestAnimationFrame),this._overflowRequestAnimationFrame=null)}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}_scheduleOverflowCheck(e){this._overflowRequestAnimationFrame==null&&(this._overflowRequestAnimationFrame=requestAnimationFrame(()=>{this._overflowRequestAnimationFrame=null,this._checkSourceTextOverflow(e)}))}get attributionText(){return this.viewModel.items.reduce((e,r)=>(e.includes(r.text)||e.push(r.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[dc.open]:this._isOpen};return Ie("div",{bind:this,class:this.classes(dc.base,fs.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return Ie("div",{class:dc.poweredBy},"Powered by"," ",Ie("a",{class:dc.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,r=this._isInteractive,i=r?0:void 0,{attributionText:s}=this,n={[dc.sourcesOpen]:e,[fs.interactive]:r};return Ie("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(dc.sources,n),innerHTML:s,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._sourcesNode=e,this._resizeObserver.observe(e),this._mutationObserver.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0}),this._scheduleOverflowCheck(e)}_checkSourceTextOverflow(e){let r=!1;const{clientHeight:i,clientWidth:s,scrollWidth:n}=e,o=n>s,l=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,l&&(r=!0),this._isOpen){const u=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,u&&(this._isOpen=!1,r=!0)}r&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};a([c()],Nr.prototype,"_isOpen",void 0),a([c()],Nr.prototype,"_isInteractive",null),a([c()],Nr.prototype,"_attributionTextOverflowed",void 0),a([c()],Nr.prototype,"_prevSourceNodeHeight",void 0),a([c({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],Nr.prototype,"attributionText",null),a([c()],Nr.prototype,"icon",null),a([c()],Nr.prototype,"itemDelimiter",void 0),a([c()],Nr.prototype,"label",null),a([c(),ju("esri/widgets/Attribution/t9n/Attribution")],Nr.prototype,"messages",void 0),a([c()],Nr.prototype,"view",null),a([c({type:P8})],Nr.prototype,"viewModel",void 0),a([Qde()],Nr.prototype,"_toggleState",null),Nr=a([b("esri.widgets.Attribution")],Nr);const ihe=Nr;function she(){const t=k("mapview-essential-goto-duration");return t==null?t:t}function nhe(t){return t?.spatialReference?.isWebMercator||t?.spatialReference?.isGeographic||!1}function ohe(t,e,r){return t.goTo(e,r)}const R8=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:s}=this;return bR(s),this.goToOverride?this.goToOverride(s,i):ohe(s,i.target,i.options)}};return a([c()],r.prototype,"goToOverride",void 0),a([c()],r.prototype,"view",void 0),r=a([b("esri.widgets.support.GoTo")],r),r};let Ul=class extends R8(X){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(Et)}destroy(){this.view=null}get canShowNorth(){return nhe(this.view)}get state(){return!this.view?.ready||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&(this.view?.type==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:she()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const r=-e.heading;this._set("orientation",{x:0,y:0,z:r})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles(e.type==="2d"?ne(()=>e?.rotation,this._updateForRotation,Et):ne(()=>e?.camera,this._updateForCamera,Et))}_watchForView(e){this.addHandles(ne(()=>this.view,this._updateRotationWatcher,e))}};a([c({readOnly:!0})],Ul.prototype,"canShowNorth",null),a([c({readOnly:!0})],Ul.prototype,"orientation",void 0),a([c({readOnly:!0})],Ul.prototype,"state",null),a([c()],Ul.prototype,"view",void 0),Ul=a([b("esri.widgets.Compass.CompassViewModel")],Ul);const L8=Ul,HC="esri-compass",WC={base:HC,iconContainer:`${HC}__icon-container`};let oo=class extends np{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new L8,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=i=>({transform:`rotateZ(${i.z}deg)`})}loadDependencies(){return by({button:()=>N(()=>import("./index-B0oBcKDl.js"),__vite__mapDeps([298,299,300,301,302,303,304,305,306,307,308,309,310,311,312])),icon:()=>N(()=>import("./index-DB3XEWBz.js").then(e=>e.i),__vite__mapDeps([303,304,305]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:r}=this.viewModel,{messages:i}=this;return Ie("div",{class:this.classes(WC.base,fs.widget)},Ie("calcite-button",{class:fs.widgetButton,disabled:r==="disabled",kind:"neutral",label:i.reset,onclick:this._reset,round:!0,scale:"s",title:i.reset},Ie("div",{"aria-hidden":"true",class:WC.iconContainer,title:i.reset},Ie("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};a([c()],oo.prototype,"goToOverride",null),a([c()],oo.prototype,"icon",null),a([c()],oo.prototype,"label",null),a([c(),ju("esri/widgets/Compass/t9n/Compass")],oo.prototype,"messages",void 0),a([c()],oo.prototype,"view",null),a([c({type:L8})],oo.prototype,"viewModel",void 0),oo=a([b("esri.widgets.Compass")],oo);const ahe=oo,ZC="esri-navigation-toggle",JC={base:ZC,isLayoutHorizontal:`${ZC}--horizontal`};let Uc=class extends X{constructor(e){super(e),this._navigationMode="pan",this.view=null,e?.isDefaultViewModel||q7(L.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.33"})}normalizeCtorArgs(e={}){const{isDefaultViewModel:r,...i}=e;return i}initialize(){this.addHandles(qi(()=>this.view?.navigation?.actionMap,()=>this._updateNavigationActionMap()))}destroy(){this.view=null}get state(){return this.view?.ready&&this.view?.type==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(e){this._navigationMode=e,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){const e=this.view?.navigation?.actionMap;if(!e)return;const r=this._navigationMode==="pan";e.dragPrimary=r?"pan":"rotate",e.dragSecondary=r?"rotate":"pan"}};a([c({readOnly:!0})],Uc.prototype,"state",null),a([c()],Uc.prototype,"_navigationMode",void 0),a([c()],Uc.prototype,"view",void 0),Uc=a([b("esri.widgets.NavigationToggle.NavigationToggleViewModel")],Uc);const F8=Uc;let ao=class extends np{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new F8({isDefaultViewModel:!0}),this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const i=this.viewModel?.navigationMode==="pan"?this._rotateButton:this._panButton;Sce(i),this.toggle()},e?.isDefaultUI||RR(L.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.32"})}normalizeCtorArgs(e={}){const{isDefaultUI:r,...i}=e;return i}loadDependencies(){return by({button:()=>N(()=>import("./index-B0oBcKDl.js"),__vite__mapDeps([298,299,300,301,302,303,304,305,306,307,308,309,310,311,312]))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.viewModel?.state==="disabled",r=this.viewModel?.navigationMode==="pan",i=this.messages.toggle;return Ie("div",{class:this.classes(JC.base,fs.widget,{[JC.isLayoutHorizontal]:this.layout==="horizontal"})},Ie("calcite-button",{afterCreate:s=>{this._panButton=s},appearance:r?"outline-fill":"solid",class:fs.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:r?void 0:-1,title:i}),Ie("calcite-button",{afterCreate:s=>{this._rotateButton=s},appearance:r?"solid":"outline-fill",class:fs.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:r?-1:void 0,title:i}))}};a([c()],ao.prototype,"icon",null),a([c()],ao.prototype,"label",null),a([c({value:"vertical"})],ao.prototype,"layout",null),a([c(),ju("esri/widgets/NavigationToggle/t9n/NavigationToggle")],ao.prototype,"messages",void 0),a([c()],ao.prototype,"view",null),a([c({type:F8})],ao.prototype,"viewModel",void 0),ao=a([b("esri.widgets.NavigationToggle")],ao);const lhe=ao;let ql=class extends X{get canZoomIn(){if(!this.view?.ready)return!1;const r=this.view?.constraints?.effectiveMaxScale;return r===0||this._scale>r}get canZoomOut(){const{view:e}=this;if(!e?.ready)return!1;const i=e.constraints?.effectiveMinScale;return i===0||this._scale<i}get _scale(){const e=this.view?.animation?.target;return(e&&"then"in e?void 0:e?.scale)??this.view?.scale??0}};a([c({readOnly:!0})],ql.prototype,"canZoomIn",null),a([c({readOnly:!0})],ql.prototype,"canZoomOut",null),a([c()],ql.prototype,"view",void 0),a([c()],ql.prototype,"_scale",null),ql=a([b("esri.widgets.Zoom.ZoomConditions2D")],ql);const uhe=ql;let qc=class extends X{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};a([c({readOnly:!0})],qc.prototype,"canZoomIn",null),a([c({readOnly:!0})],qc.prototype,"canZoomOut",null),a([c()],qc.prototype,"view",void 0),qc=a([b("esri.widgets.Zoom.ZoomConditions3D")],qc);const che=qc;let fa=class extends X{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){return this._zoomConditions!=null&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new uhe({view:e}):e.type==="3d"&&(this._zoomConditions=new che({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&(e.type==="2d"?e.mapViewNavigation.zoomIn():yh(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&(e.type==="2d"?e.mapViewNavigation.zoomOut():yh(e.goTo({zoomFactor:.5})))}};a([c()],fa.prototype,"_zoomConditions",void 0),a([c()],fa.prototype,"canZoomIn",null),a([c()],fa.prototype,"canZoomOut",null),a([c({readOnly:!0})],fa.prototype,"state",null),a([c()],fa.prototype,"view",null),fa=a([b("esri.widgets.Zoom.ZoomViewModel")],fa);const N8=fa,YC={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let lo=class extends np{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new N8,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return by({button:()=>N(()=>import("./index-B0oBcKDl.js"),__vite__mapDeps([298,299,300,301,302,303,304,305,306,307,308,309,310,311,312]))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[YC.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:r,canZoomOut:i}=this.viewModel,{zoomIn:s,zoomOut:n}=this.messages;return Ie("div",{class:this.classes(YC.base,fs.widget,e)},Ie("calcite-button",{class:fs.widgetButton,disabled:!r,iconStart:"plus",kind:"neutral",label:s,onclick:this.zoomIn,title:s}),Ie("calcite-button",{class:fs.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:n,onclick:this.zoomOut,title:n}))}};a([c()],lo.prototype,"icon",null),a([c()],lo.prototype,"label",null),a([c({value:"vertical"})],lo.prototype,"layout",null),a([c(),ju("esri/widgets/Zoom/t9n/Zoom")],lo.prototype,"messages",void 0),a([c()],lo.prototype,"view",null),a([c({type:N8})],lo.prototype,"viewModel",void 0),lo=a([b("esri.widgets.Zoom")],lo);const dhe=lo;function hhe(t){return t?.view!==void 0}let O0=class extends Tce{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=r=>{this.components.forEach(i=>{const s=this._find(i),n=s?.widget;hhe(n)&&(n.view=r)})},this._componentsWatcher=(r,i)=>{this._removeComponents(i),this._addComponents(r),this._adjustPadding(r)}}initialize(){this.addHandles([ne(()=>this.components,this._componentsWatcher,Et),ne(()=>this.view,this._updateViewAwareWidgets,Et)])}_add(e,r,i,s,n){let o=e;if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;o=this._createComponent(e)}super._add(o,r,i,s,n)}_removeComponents(e){e.forEach(r=>{const i=this._find(r);i&&(this.remove(i),i.destroy())})}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:r}=this.padding;this.padding=r}}_addComponents(e){this.constructed&&e.forEach(r=>this.add(this._createComponent(r),this._defaultPositionLookup[r]))}_createComponent(e){const r=this._createWidget(e);return new M0({id:e,node:r})}_createWidget(e){const r=this.view;switch(e){case"attribution":return new ihe({view:r});case"compass":return new ahe({view:r});case"navigation-toggle":return new lhe({view:r,isDefaultUI:!0});case"zoom":return new dhe({view:r})}}};a([c()],O0.prototype,"components",void 0),O0=a([b("esri.views.ui.DefaultUI")],O0);const D8=O0;let k0=class extends D8{constructor(e){super(e),this.components=["attribution","zoom"]}};a([c()],k0.prototype,"components",void 0),k0=a([b("esri.views.ui.2d.DefaultUI2D")],k0);const j8=k0;let phe=class{constructor(e={},r={},i=8,s=1/0){this.disabledExtensions=e,this.debugWebGLExtensions=r,this.maxAnisotropy=i,this.maxPreferredTexturePixels=s}},V8=class A${constructor(e,r,i=""){this.major=e,this.minor=r,this._context=i}lessThan(e,r){return this.major<e||e===this.major&&this.minor<r}greaterEqual(e,r){return!this.lessThan(e,r)}validate(e){if(this.major!==e.major){const r=this._context&&this._context+":",i=this._context&&this._context+" ";throw new x(r+"unsupported-version",`Required major ${i}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new A$(this.major,this.minor,this._context)}static parse(e,r=""){const[i,s]=e.split("."),n=/^\s*\d+\s*$/;if(!i?.match||!n.test(i))throw new x((r&&r+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!s?.match||!n.test(s))throw new x((r&&r+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const o=parseInt(i,10),l=parseInt(s,10);return new A$(o,l,r)}},fhe=class extends V8{constructor(e,r){super(e,r,"webmap")}};function G1(t){return t!=null&&typeof t=="object"&&"declaredClass"in t&&t.declaredClass==="esri.WebMap"}new fhe(2,35);var R$;let C0=R$=class extends F{constructor(t){super(t),this.color=new ue([0,0,0,1])}clone(){return new R$(E({color:this.color}))}};a([c({type:ue,json:{write:!0}})],C0.prototype,"color",void 0),C0=R$=a([b("esri.webmap.background.ColorBackground")],C0);const mhe=C0;let z8,U8,q8,G8,B8,H8,W8;async function yhe(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:r,MapViewNavigation:i,MagnifierView2D:s,GridView2D:n,Stage:o}]=await Promise.all([N(()=>import("./webglDeps-k3PfyBd5.js"),__vite__mapDeps([194,161,195,196,197,4,55])),N(()=>import("./mapViewDeps-C99TyUM3.js"),__vite__mapDeps([198,123,92,93,87,31,4,94,91,95,84,199,200,161,195,196,152,85,201,88,197,55,160,54,202,83,113,203,141,144,33,34,89,99,204,96,97,205,206,21,194,207,108,208,209,140,210,150,151,211,72,82,86,38,37,212,98,213,90,15,16,17,214,100,105,80,215,216,217,218,157,219,220]))]);U8=t,q8=e,G8=r,B8=i,H8=s,W8=n,z8=o}var oh;let be=(oh=class extends ile(Roe(lee(Ate(vte(ane))))){get timeZone(){return super.timeZone}set timeZone(e){super.timeZone=e}constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new Zs({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new tb({actionMap:new GM({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.analyses=new Oh,this.analysisViewManager=new Xue({importAnalysisViewModule:r=>Hle(r),view:this}),this.floors=new H,this.grid=null,this.map=null,this.timeline=new r8,this.type="2d",this.view2dType=null,this.ui=new j8,this.animationsEnabled=!0,this.test={takeScreenshot:async r=>Zue(this._getScreenshotView(r),r)},this.padding={top:0,right:0,bottom:0,left:0},see()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=Ke(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new rue(this.featuresTilingScheme)}get constraintsInfo(){const e=this.defaultsFromMap?.tileInfo,r=this.spatialReference;return{lods:e?.spatialReference?.equals(r)?e.lods:null,spatialReference:r}}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:e,constraints:r,center:i,viewpoint:s,extent:n}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!n&&(r?.effectiveLODs||(o=-1),(!i||e===0&&o===-1)&&(s?.targetGeometry==null||s.targetGeometry.type!=="extent"&&!s.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const r=e.targetGeometry,i=this.spatialReference;return qN(r.spatialReference,i)}get background(){return G1(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){return this.stateManager?.center??null}set center(e){this.stateManager.center=e}get constraints(){return super.constraints}set constraints(e){super.constraints=e}get highlightOptions(){return Pue(this)}set highlightOptions(e){Aue(this,e)}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){return this.stage?.renderRequested??!1}get resizeAlign(){return super.resizeAlign}set resizeAlign(e){super.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return super.rotation}set rotation(e){super.rotation=e}get scale(){return this.stateManager?.scale??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get spatialReference(){return super.spatialReference}set spatialReference(e){super.spatialReference=e}get spatialReferenceLocked(){return this._get("spatialReferenceLocked")}set spatialReferenceLocked(e){this.stage&&L.getLogger(this).warn("spatialReferenceLocked cannot be changed after the view has become ready"),this._set("spatialReferenceLocked",e)}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const e=!(!this.magnifier.visible||this.magnifier.position===null||!this._magnifierView?.updatingHandles.updating),r=!this.destroyed&&(!this.analysisViewManager||!this.layerViewManager||!this.labelManager||!this.graphicsView||this.analysisViewManager.updating===!0||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(i=>!i.destroyed&&!("layerViews"in i)&&i.updating===!0)||e);if(k("esri-2d-log-updating")){const i=this.allLayerViews.reduce((s,n)=>({...s,[`${n.layer.id}(${n.layer.type})`]:!n.destroyed&&!("layerViews"in n)&&n.updating}),{});console.log(`Updating MapView: ${r}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${this.layerViewManager?.updating}
-> labelManager.updating: ${this.labelManager?.updating}
-> graphicsView.updating: ${this.graphicsView?.updating}
-> allLayerViews: ${JSON.stringify(i)}
-> updatingMagnifier: ${e}
`)}return r}get viewpoint(){return super.viewpoint}set viewpoint(e){super.viewpoint=e}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new Be({rings:[e.map(r=>[r[0],r[1]])],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return this.mapViewNavigation?.interacting??!1}async hitTest(e,r){return Rue(this,e,r)}async takeScreenshot(e){return Wue(this._getScreenshotView(e),e)}toScreen(e,r){return this.stateManager.toScreen(e,r)}async whenAnalysisView(e){if(e.parent==null)throw new x("view:no-analysisview-for-analysis","The analysis does not exist in view.analyses",{analysis:e});return this.analysisViewManager.whenAnalysisView(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return G1(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return G1(this.map)?this.map.initialViewProperties.timeExtent:null}getSurface(){return this.surface}hasLayerViewModule(e){return oC.hasLayerViewModule(e)}importLayerView(e){return oC.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(L.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){const r=this.toMap(e),i=await this.hitTest(e),s=this.allLayerViews.toArray().filter(d=>d.clips.every(p=>B6(this,p,e,r))).reverse(),n=new globalThis.Map(s.map(d=>[d.layer.uid,d])),o=[];let l=0,u=0;for(;l<i.results.length||u<s.length;){const d=i.results.at(l);if(d&&d.type!=="graphic"){++l;continue}const p=n.get((d?.layer??d?.graphic.layer)?.uid);if((!d||p)&&u<s.length&&s.at(u)!==p){const f=s.at(u);"fetchPopupFeaturesAtLocation"in f&&o.push({mapPoint:r,layerView:f}),++u}else d&&(o.push({graphic:d.graphic,layerView:p}),++l)}return{hits:o,location:r}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=oce(this.type);if(k("safari")&&k("safari")<9&&(e=new x("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:k("safari")})),e!=null)throw L.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return yhe()}_getDefaultViewpoint(){const{constraints:e,initialExtent:r,map:i,padding:s,size:n}=this;if(!e)return null;const o=i&&"initialViewProperties"in i?i.initialViewProperties:void 0,l=this.stateManager.getUserStartupOptions(this.size),u=o?.viewpoint,d=u?.targetGeometry?.extent??r,p=d?.center,f=u?.rotation??0,m=u?.scale||d&&ib(d,[n[0]-s.left-s.right,n[1]-s.top-s.bottom]),y=l.center??p,g=l.rotation??f,v=l.scale??m;return y&&v?new ps({targetGeometry:y,scale:v,rotation:g}):null}_startup(){this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const r=new Wle(this.surface),i=new z8(this.surface,{canvas:this.renderCanvas,contextOptions:new phe(this.deactivatedWebGLExtensions,this.debugWebGLExtensions),renderingOptions:this.renderingOptions,timeline:this.timeline},r);this.stage=i,this._magnifierView=new H8,this._magnifierView.magnifier=this.magnifier,this._gridView=new W8;const s=new G8({view:this});this._set("labelManager",s);const n=new Lle({view:this});this._set("animationManager",n);const o=new B8({view:this,animationManager:n});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),i.on("webgl-error",u=>this.fatalError=u.error),ne(()=>this.stationary,u=>i.stationary=u,xr),ne(()=>this.background,u=>{i.backgroundColor=u?.color,this._magnifierView.backgroundColor=u?.color},xr),ne(()=>this.magnifier,u=>this._magnifierView.magnifier=u,xr),ne(()=>this.grid,u=>this._gridView.grid=u,xr),ne(()=>this.renderingOptions,u=>i.renderingOptions=u,xr),ne(()=>this.highlights.items.map(u=>({name:u.name,options:{fillColor:u.color,haloColor:u.haloColor,fillOpacity:u.fillOpacity,haloOpacity:u.haloOpacity,haloWidth:u.haloWidth,haloBlur:u.haloBlur}})),()=>{i.highlightGradient=kue(i.highlightGradient,this.highlights.items)},xr),ne(()=>this.state.id,()=>i.state=this.state,xr),ne(()=>this.animationsEnabled,u=>{this.stage.animationsEnabled=u},xr)],"map-view"),this._updateStageChildren();const l=this._resolveWhenReady;this._resolveWhenReady=[],l.forEach(u=>u(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(r=>{this.stage.addChild(r.container)});const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new zle(Fr.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const r=new U8({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new q8(e)});this._set("graphicsView",r)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){const{allLayerViews:r,padding:i,size:s,stage:n}=this;return{allLayerViews:r,backgroundColor:e?.ignoreBackground?null:this.background?.color,padding:i,size:s,stage:n}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const r of this.allLayerViews)r.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const r of this.allLayerViews)r.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}},oh.type="2d",oh);a([c({constructOnly:!0})],be.prototype,"deactivatedWebGLExtensions",void 0),a([c({constructOnly:!0})],be.prototype,"debugWebGLExtensions",void 0),a([c({readOnly:!0})],be.prototype,"featuresTilingScheme",void 0),a([c({readOnly:!0})],be.prototype,"graphicsTileStore",null),a([c()],be.prototype,"graphicsView",void 0),a([c()],be.prototype,"constraintsInfo",null),a([c()],be.prototype,"initialExtentRequired",null),a([c()],be.prototype,"labelManager",void 0),a([c({type:tb,nonNullable:!0})],be.prototype,"navigation",void 0),a([c({constructOnly:!0})],be.prototype,"renderCanvas",void 0),a([c()],be.prototype,"renderingOptions",void 0),a([c({constructOnly:!0})],be.prototype,"supersampleScreenshotsEnabled",void 0),a([c()],be.prototype,"defaultsFromMapSettings",null),a([c({readOnly:!0})],be.prototype,"typeSpecificPreconditionsReady",null),a([c(AS(Oh,"analyses"))],be.prototype,"analyses",void 0),a([c()],be.prototype,"analysisViewManager",void 0),a([c({type:mhe})],be.prototype,"background",null),a([c()],be.prototype,"center",null),a([c({type:H})],be.prototype,"floors",void 0),a([c()],be.prototype,"grid",void 0),a([c({type:qa})],be.prototype,"highlightOptions",null),a([c()],be.prototype,"map",void 0),a([c()],be.prototype,"padding",null),a([c({readOnly:!0})],be.prototype,"rendering",null),a([c({readOnly:!0})],be.prototype,"resolution",null),a([c()],be.prototype,"scale",null),a([c({type:Boolean,value:!1})],be.prototype,"spatialReferenceLocked",null),a([c({readOnly:!0})],be.prototype,"tileInfo",null),a([c({type:r8,readOnly:!0})],be.prototype,"timeline",void 0),a([c({readOnly:!0})],be.prototype,"type",void 0),a([c({readOnly:!0})],be.prototype,"updating",null),a([c({readOnly:!0})],be.prototype,"view2dType",void 0),a([c({readOnly:!0})],be.prototype,"visibleArea",null),a([c()],be.prototype,"zoom",null),a([c({readOnly:!0})],be.prototype,"navigating",null),a([c(),Ce(t=>t instanceof D8?t:Hh(j8,t))],be.prototype,"ui",void 0),a([c()],be.prototype,"animationsEnabled",void 0),be=a([b("esri.views.View2D")],be);const ghe=be;let P0=class extends ghe{constructor(e){super(e),this.view2dType="map"}};a([c({readOnly:!0})],P0.prototype,"view2dType",void 0),P0=a([b("esri.views.MapView")],P0);const vhe=P0;let whe=class Z8{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(T_),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const r=new Z8,i=this._originStores[0];i&&i.forEach((s,n)=>{r.set(n,E(s),0)});for(let s=2;s<T_;s++){const n=this._originStores[s];n&&n.forEach((o,l)=>{e&&e.has(l)||r.set(l,E(o),s)})}return r}get(e,r){const i=r===void 0?this._values:this._originStores[r];return i?i.get(e):void 0}keys(e){const r=e==null?this._values:this._originStores[e];return r?[...r.keys()]:[]}set(e,r,i=7){let s=this._originStores[i];if(s||(s=new Map,this._originStores[i]=s),s.set(e,r),!this._values.has(e)||this._propertyOriginMap.get(e)<=i){const n=this._values.get(e);return this._values.set(e,r),this._propertyOriginMap.set(e,i),n!==r}return!1}delete(e,r=7){const i=this._originStores[r];if(!i)return;const s=i.get(e);if(i.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===r){this._values.delete(e);for(let n=r-1;n>=0;n--){const o=this._originStores[n];if(o&&o.has(e)){this._values.set(e,o.get(e)),this._propertyOriginMap.set(e,n);break}}}return s}has(e,r){const i=r===void 0?this._values:this._originStores[r];return!!i&&i.has(e)}revert(e,r){for(;r>0&&!this.has(e,r);)--r;const i=this._originStores[r],s=i?.get(e),n=this._values.get(e);return this._values.set(e,s),this._propertyOriginMap.set(e,r),n!==s}originOf(e){return this._propertyOriginMap.get(e)||0}isAtOrigin(e,r){return this.has(e,r)&&this.originOf(e)===r}isBelowOrigin(e,r){return!this.has(e)||this.originOf(e)<r}forEach(e){this._values.forEach(e)}};const J8=t=>{const e=t;let r=class extends e{constructor(...i){super(...i);const s=Qr(this),n=s.store,o=new whe;s.store=o,TL(s,n,o)}read(i,s){IL(this,i,s)}getAtOrigin(i,s){const n=B1(this),o=Co(s);if(typeof i=="string")return n.get(i,o);const l={};return i.forEach(u=>{l[u]=n.get(u,o)}),l}originOf(i){return mm(this.originIdOf(i))}originIdOf(i){return B1(this).originOf(i)}revert(i,s){const n=B1(this),o=Co(s),l=Qr(this);let u;u=typeof i=="string"?i==="*"?n.keys(o):[i]:i,u.forEach(d=>{l.invalidate(d),n.revert(d,o),l.commit(d)})}};return r=a([b("esri.core.ReadOnlyMultiOriginJSONSupport")],r),r};function B1(t){return Qr(t).store}J8(X);const bhe=t=>{const e=t;let r=class extends e{constructor(...i){super(...i)}clear(i,s="user"){Qr(this).clearOrigin(i,Co(s))}write(i,s){return OL(this,i=i||{},s),i}setAtOrigin(i,s,n){Qr(this).setAtOrigin(i,s,Co(n))}removeOrigin(i){const s=KC(this),n=Co(i),o=s.keys(n);for(const l of o)s.originOf(l)===n&&s.set(l,s.get(l,n),7)}updateOrigin(i,s){const n=KC(this),o=Co(s),l=Ys(this,i);for(let u=o+1;u<T_;++u)n.delete(i,u);n.set(i,l,o)}toJSON(i){return this.write({},i)}};return r=a([b("esri.core.MultiOriginJSONSupport.WriteableMultiOriginJSONSupport")],r),r.prototype.toJSON.isDefaultToJSON=!0,r};function KC(t){return Qr(t).store}const Y8=t=>{const e=bhe(J8(t));let r=class extends e{};return r=a([b("esri.core.MultiOriginJSONSupport")],r),r},tIe=Y8(X),qe=(t=>t)(["operational-layers","basemap-base-layers","basemap-ground-layers","ground"]);var L$;let Gl=L$=class extends F{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new L$({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};a([c({type:String,json:{write:!0}})],Gl.prototype,"expression",void 0),a([c({type:String,json:{write:!0}})],Gl.prototype,"name",void 0),a([c({type:["boolean","date","number","string"],json:{write:!0}})],Gl.prototype,"returnType",void 0),a([c({type:String,json:{write:!0}})],Gl.prototype,"title",void 0),Gl=L$=a([b("esri.form.ExpressionInfo")],Gl);const _he=Gl;let fi=class extends F{constructor(e){super(e),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};a([c({type:String,json:{write:!0}})],fi.prototype,"description",void 0),a([c({type:String,json:{write:!0}})],fi.prototype,"label",void 0),a([c()],fi.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],fi.prototype,"visibilityExpression",void 0),fi=a([b("esri.form.elements.Element")],fi);let A0=class extends pe(F){constructor(e){super(e),this.type=null}};a([c()],A0.prototype,"type",void 0),A0=a([b("esri.form.elements.inputs.attachments.Input")],A0);const il=A0,hb=["any","capture","upload"];let Gc=class extends il{constructor(e){super(e),this.type="audio",this.inputMethod="any",this.maxDuration=null}};a([c({type:["audio"],readOnly:!0,json:{write:!0}})],Gc.prototype,"type",void 0),a([c({type:hb,json:{write:!0}})],Gc.prototype,"inputMethod",void 0),a([c({type:Number,json:{write:!0}})],Gc.prototype,"maxDuration",void 0),Gc=a([b("esri.form.elements.inputs.attachments.AudioInput")],Gc);const QC=Gc;let wf=class extends il{constructor(e){super(e),this.type="document",this.maxFileSize=null}};a([c({type:["document"],readOnly:!0,json:{write:!0}})],wf.prototype,"type",void 0),a([c({type:Number,json:{write:!0}})],wf.prototype,"maxFileSize",void 0),wf=a([b("esri.form.elements.inputs.attachments.DocumentInput")],wf);const XC=wf;let Bc=class extends il{constructor(e){super(e),this.type="image",this.inputMethod="any",this.maxImageSize=null}};a([c({type:["image"],readOnly:!0,json:{write:!0}})],Bc.prototype,"type",void 0),a([c({type:hb,json:{write:!0}})],Bc.prototype,"inputMethod",void 0),a([c({type:Number,json:{write:!0}})],Bc.prototype,"maxImageSize",void 0),Bc=a([b("esri.form.elements.inputs.attachments.ImageInput")],Bc);const eP=Bc;let bf=class extends il{constructor(e){super(e),this.type="signature",this.inputMethod="any"}};a([c({type:["signature"],readOnly:!0,json:{write:!0}})],bf.prototype,"type",void 0),a([c({type:hb,json:{write:!0}})],bf.prototype,"inputMethod",void 0),bf=a([b("esri.form.elements.inputs.attachments.SignatureInput")],bf);const tP=bf;let Hc=class extends il{constructor(e){super(e),this.type="video",this.inputMethod="any",this.maxDuration=null}};a([c({type:["video"],readOnly:!0,json:{write:!0}})],Hc.prototype,"type",void 0),a([c({type:hb,json:{write:!0}})],Hc.prototype,"inputMethod",void 0),a([c({type:Number,json:{write:!0}})],Hc.prototype,"maxDuration",void 0),Hc=a([b("esri.form.elements.inputs.attachments.VideoInput")],Hc);const rP=Hc;function K8(t){return{nestableTypes:{base:il,key:"type",typeMap:{audio:QC,document:XC,image:eP,signature:tP,video:rP}},allTypes:{base:il,key:"type",typeMap:{attachment:t,audio:QC,document:XC,image:eP,signature:tP,video:rP}}}}function She(t,e,r){return t?t.map(i=>Nn(e.nestableTypes,i)):null}function $he(t,e,r){if(!t)return null;const i=e.nestableTypes.typeMap;return t.filter(s=>i[s.type]).map(s=>i[s.type].fromJSON(s))}function xhe(t,e,r){if(!t)return null;const i=e.nestableTypes.typeMap;return t.filter(s=>i[s.type]).map(s=>s.toJSON())}let wn=class extends il{constructor(e){super(e),this.type="attachment",this.attachmentAssociationType="exact",this.inputTypes=null}castInputs(e){return She(e,H1)}readInputs(e,r){return $he(r.inputTypes,H1)}writeInputs(e,r){r.inputTypes=xhe(e,H1)}};a([c({type:["attachment"],readOnly:!0,json:{write:!0}})],wn.prototype,"type",void 0),a([c({type:["any","exact","exactOrNone"],json:{write:!0}})],wn.prototype,"attachmentAssociationType",void 0),a([c({json:{write:{isRequired:!0}}})],wn.prototype,"inputTypes",void 0),a([Ce("inputTypes")],wn.prototype,"castInputs",null),a([V("inputTypes")],wn.prototype,"readInputs",null),a([q("inputTypes")],wn.prototype,"writeInputs",null),wn=a([b("esri.form.elements.inputs.attachments.AttachmentInput")],wn);const H1=K8(wn),The=wn;var F$;const Mhe=K8(The);let Ei=F$=class extends fi{constructor(t){super(t),this.allowUserRename=!0,this.attachmentKeyword=null,this.displayFilename=!1,this.editableExpression=null,this.filenameExpression="{attachmentKeyword}_{now}",this.input=null,this.maxAttachmentCount=null,this.minAttachmentCount=null,this.type="attachment",this.useOriginalFilename=!0}clone(){return new F$({allowUserRename:this.allowUserRename,attachmentKeyword:this.attachmentKeyword,description:this.description,displayFilename:this.displayFilename,editableExpression:this.editableExpression,filenameExpression:this.filenameExpression,input:this.input?.clone(),label:this.label,maxAttachmentCount:this.maxAttachmentCount,minAttachmentCount:this.minAttachmentCount,useOriginalFilename:this.useOriginalFilename,visibilityExpression:this.visibilityExpression})}};a([c({type:Boolean,json:{write:!0}})],Ei.prototype,"allowUserRename",void 0),a([c({type:String,json:{write:{isRequired:!0}}})],Ei.prototype,"attachmentKeyword",void 0),a([c({type:Boolean,json:{write:!0}})],Ei.prototype,"displayFilename",void 0),a([c({type:String,json:{write:!0}})],Ei.prototype,"editableExpression",void 0),a([c({type:String,json:{write:!0}})],Ei.prototype,"filenameExpression",void 0),a([c({types:Mhe.allTypes,json:{read:{source:"inputType"},write:{target:"inputType",isRequired:!0}}})],Ei.prototype,"input",void 0),a([c({type:Number,json:{write:!0}})],Ei.prototype,"maxAttachmentCount",void 0),a([c({type:Number,json:{write:!0}})],Ei.prototype,"minAttachmentCount",void 0),a([c({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],Ei.prototype,"type",void 0),a([c({type:Boolean,json:{write:!0}})],Ei.prototype,"useOriginalFilename",void 0),Ei=F$=a([b("esri.form.elements.AttachmentElement")],Ei);const iP=Ei;let R0=class extends F{constructor(e){super(e),this.type=null}};a([c()],R0.prototype,"type",void 0),R0=a([b("esri.form.elements.inputs.Input")],R0);const Bo=R0;let _f=class extends Bo{constructor(e){super(e),this.maxLength=null,this.minLength=0}};a([c({type:Number,json:{write:!0}})],_f.prototype,"maxLength",void 0),a([c({type:Number,json:{write:!0}})],_f.prototype,"minLength",void 0),_f=a([b("esri.form.elements.inputs.TextInput")],_f);const p3=_f;var N$;let L0=N$=class extends p3{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new N$({maxLength:this.maxLength,minLength:this.minLength})}};a([c({type:["barcode-scanner"],json:{read:!1,write:!0}})],L0.prototype,"type",void 0),L0=N$=a([b("esri.form.elements.inputs.BarcodeScannerInput")],L0);const Ihe=L0;var D$;let Wc=D$=class extends Bo{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new D$({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};a([c({type:String,json:{write:!0}})],Wc.prototype,"noValueOptionLabel",void 0),a([c({type:Boolean,json:{write:!0}})],Wc.prototype,"showNoValueOption",void 0),a([c({type:["combo-box"],json:{read:!1,write:!0}})],Wc.prototype,"type",void 0),Wc=D$=a([b("esri.form.elements.inputs.ComboBoxInput")],Wc);const Ehe=Wc;var j$;function sP(t){return t??null}function nP(t){return t??null}let yn=j$=class extends Bo{constructor(t){super(t),this.max=null,this.min=null,this.type="date-picker"}readMax(t,e){return sP(e.max)}writeMax(t,e){e.max=nP(t)}readMin(t,e){return sP(e.min)}writeMin(t,e){e.min=nP(t)}clone(){return new j$({max:this.max,min:this.min})}};a([c({type:String,json:{type:String,write:!0}})],yn.prototype,"max",void 0),a([V("max")],yn.prototype,"readMax",null),a([q("max")],yn.prototype,"writeMax",null),a([c({type:String,json:{type:String,write:!0}})],yn.prototype,"min",void 0),a([V("min")],yn.prototype,"readMin",null),a([q("min")],yn.prototype,"writeMin",null),a([c({type:["date-picker"],json:{read:!1,write:!0}})],yn.prototype,"type",void 0),yn=j$=a([b("esri.form.elements.inputs.DatePickerInput")],yn);const Ohe=yn;var V$;function W1(t){return t??null}function Z1(t){return t??null}let ii=V$=class extends Bo{constructor(t){super(t),this.includeTimeOffset=!0,this.max=null,this.min=null,this.timeResolution="minutes",this.type="datetimeoffset-picker"}readMax(t,e){return W1(e.max)}writeMax(t,e){e.max=Z1(t)}readMin(t,e){return W1(e.min)}writeMin(t,e){e.min=Z1(t)}readTimeResolution(t,e){return W1(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=Z1(t)}clone(){return new V$({includeTimeOffset:this.includeTimeOffset,max:this.max,min:this.min,timeResolution:this.timeResolution})}};a([c({type:Boolean,json:{write:!0}})],ii.prototype,"includeTimeOffset",void 0),a([c({type:String,json:{type:String,write:!0}})],ii.prototype,"max",void 0),a([V("max")],ii.prototype,"readMax",null),a([q("max")],ii.prototype,"writeMax",null),a([c({type:String,json:{type:String,write:!0}})],ii.prototype,"min",void 0),a([V("min")],ii.prototype,"readMin",null),a([q("min")],ii.prototype,"writeMin",null),a([c({type:String,json:{type:String,write:!0}})],ii.prototype,"timeResolution",void 0),a([V("timeResolution")],ii.prototype,"readTimeResolution",null),a([q("timeResolution")],ii.prototype,"writeTimeResolution",null),a([c({type:["datetimeoffset-picker"],json:{read:!1,write:!0}})],ii.prototype,"type",void 0),ii=V$=a([b("esri.form.elements.inputs.DateTimeOffsetPickerInput")],ii);const khe=ii;var z$;function oP(t){return t!=null?new Date(t):null}function aP(t){return t?t.getTime():null}let Ls=z$=class extends Bo{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return oP(e.max)}writeMax(t,e){e.max=aP(t)}readMin(t,e){return oP(e.min)}writeMin(t,e){e.min=aP(t)}clone(){return new z$({includeTime:this.includeTime,max:this.max,min:this.min})}};a([c({type:Boolean,json:{write:!0}})],Ls.prototype,"includeTime",void 0),a([c({type:Date,json:{type:Number,write:!0}})],Ls.prototype,"max",void 0),a([V("max")],Ls.prototype,"readMax",null),a([q("max")],Ls.prototype,"writeMax",null),a([c({type:Date,json:{type:Number,write:!0}})],Ls.prototype,"min",void 0),a([V("min")],Ls.prototype,"readMin",null),a([q("min")],Ls.prototype,"writeMin",null),a([c({type:["datetime-picker"],json:{read:!1,write:!0}})],Ls.prototype,"type",void 0),Ls=z$=a([b("esri.form.elements.inputs.DateTimePickerInput")],Ls);const Che=Ls;var U$;let Zc=U$=class extends Bo{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new U$({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};a([c({type:String,json:{write:!0}})],Zc.prototype,"noValueOptionLabel",void 0),a([c({type:Boolean,json:{write:!0}})],Zc.prototype,"showNoValueOption",void 0),a([c({type:["radio-buttons"],json:{read:!1,write:!0}})],Zc.prototype,"type",void 0),Zc=U$=a([b("esri.form.elements.inputs.RadioButtonsInput")],Zc);const Phe=Zc;var q$;let Jc=q$=class extends Bo{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new q$({offValue:this.offValue,onValue:this.onValue})}};a([c({type:[String,Number],json:{write:!0}})],Jc.prototype,"offValue",void 0),a([c({type:[String,Number],json:{write:!0}})],Jc.prototype,"onValue",void 0),a([c({type:["switch"],json:{read:!1,write:!0}})],Jc.prototype,"type",void 0),Jc=q$=a([b("esri.form.elements.inputs.SwitchInput")],Jc);const Ahe=Jc;var G$;let F0=G$=class extends p3{constructor(t){super(t),this.type="text-area"}clone(){return new G$({maxLength:this.maxLength,minLength:this.minLength})}};a([c({type:["text-area"],json:{read:!1,write:!0}})],F0.prototype,"type",void 0),F0=G$=a([b("esri.form.elements.inputs.TextAreaInput")],F0);const Rhe=F0;var B$;let N0=B$=class extends p3{constructor(t){super(t),this.type="text-box"}clone(){return new B$({maxLength:this.maxLength,minLength:this.minLength})}};a([c({type:["text-box"],json:{read:!1,write:!0}})],N0.prototype,"type",void 0),N0=B$=a([b("esri.form.elements.inputs.TextBoxInput")],N0);const Lhe=N0;var H$;function J1(t){return t??null}function Y1(t){return t??null}let Oi=H$=class extends Bo{constructor(t){super(t),this.max=null,this.min=null,this.timeResolution="minutes",this.type="time-picker"}readMax(t,e){return J1(e.max)}writeMax(t,e){e.max=Y1(t)}readMin(t,e){return J1(e.min)}writeMin(t,e){e.min=Y1(t)}readTimeResolution(t,e){return J1(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=Y1(t)}clone(){return new H$({max:this.max,min:this.min,timeResolution:this.timeResolution})}};a([c({type:String,json:{type:String,write:!0}})],Oi.prototype,"max",void 0),a([V("max")],Oi.prototype,"readMax",null),a([q("max")],Oi.prototype,"writeMax",null),a([c({type:String,json:{type:String,write:!0}})],Oi.prototype,"min",void 0),a([V("min")],Oi.prototype,"readMin",null),a([q("min")],Oi.prototype,"writeMin",null),a([c({type:String,json:{type:String,write:!0}})],Oi.prototype,"timeResolution",void 0),a([V("timeResolution")],Oi.prototype,"readTimeResolution",null),a([q("timeResolution")],Oi.prototype,"writeTimeResolution",null),a([c({type:["time-picker"],json:{read:!1,write:!0}})],Oi.prototype,"type",void 0),Oi=H$=a([b("esri.form.elements.inputs.TimePickerInput")],Oi);const Fhe=Oi,Nhe=Ihe,Dhe=Ehe,jhe=Ohe,Vhe=khe,zhe=Che,Uhe=Phe,qhe=Ahe,Ghe=Rhe,Bhe=Lhe,Hhe=Fhe,Whe={base:Bo,key:"type",typeMap:{"barcode-scanner":Nhe,"combo-box":Dhe,"date-picker":jhe,"datetime-picker":zhe,"datetimeoffset-picker":Vhe,"radio-buttons":Uhe,switch:qhe,"text-area":Ghe,"text-box":Bhe,"time-picker":Hhe}};var W$;let Ai=W$=class extends fi{constructor(t){super(t),this.domain=null,this.editable=null,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}clone(){return new W$({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};a([c({types:yj,json:{read:{reader:eb},write:!0}})],Ai.prototype,"domain",void 0),a([c({type:Boolean,json:{write:!0}})],Ai.prototype,"editable",void 0),a([c({type:String,json:{write:!0}})],Ai.prototype,"editableExpression",void 0),a([c({type:String,json:{write:!0}})],Ai.prototype,"fieldName",void 0),a([c({type:String,json:{write:!0}})],Ai.prototype,"hint",void 0),a([c({types:Whe,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Ai.prototype,"input",void 0),a([c({type:String,json:{write:!0}})],Ai.prototype,"requiredExpression",void 0),a([c({type:String,json:{read:!1,write:!0}})],Ai.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],Ai.prototype,"valueExpression",void 0),Ai=W$=a([b("esri.form.elements.FieldElement")],Ai);var Z$;let uo=Z$=class extends fi{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editableExpression=null,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new Z$({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editableExpression:this.editableExpression,label:this.label,orderByFields:E(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};a([c({type:Number,json:{write:!0}})],uo.prototype,"displayCount",void 0),a([c({type:["list"],json:{write:!0}})],uo.prototype,"displayType",void 0),a([c({type:String,json:{write:!0}})],uo.prototype,"editableExpression",void 0),a([c({type:[RM],json:{write:!0}})],uo.prototype,"orderByFields",void 0),a([c({type:Number,json:{write:!0}})],uo.prototype,"relationshipId",void 0),a([c({type:["relationship"],json:{read:!1,write:!0}})],uo.prototype,"type",void 0),uo=Z$=a([b("esri.form.elements.RelationshipElement")],uo);const lP=uo;var J$;let Yc=J$=class extends fi{constructor(t){super(t),this.text=null,this.textFormat="plain-text",this.type="text"}clone(){return new J$({text:this.text,textFormat:this.textFormat,visibilityExpression:this.visibilityExpression})}};a([c({type:String,json:{write:!0}})],Yc.prototype,"text",void 0),a([c({type:String,json:{write:!0}})],Yc.prototype,"textFormat",void 0),a([c({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],Yc.prototype,"type",void 0),Yc=J$=a([b("esri.form.elements.TextElement")],Yc);const uP=Yc;let Kc=class extends pe(fi){constructor(e){super(e),this.associationTypes=null,this.editableExpression=null,this.type="utilityNetworkAssociations"}};a([c({type:[q4],json:{write:{isRequired:!0}}})],Kc.prototype,"associationTypes",void 0),a([c({type:String,json:{write:!0}})],Kc.prototype,"editableExpression",void 0),a([c({type:["utilityNetworkAssociations"],json:{read:!1,write:!0}})],Kc.prototype,"type",void 0),Kc=a([b("esri.form.elements.UtilityNetworkAssociationsElement")],Kc);const cP=Kc,Zhe=t=>t.type==="field",Jhe=t=>t.type==="group",Yhe=t=>t.type==="text";function Q8(t){return{typesWithGroup:{base:fi,key:"type",typeMap:{attachment:iP,field:Ai,group:t,relationship:lP,text:uP,utilityNetworkAssociations:cP}},typesWithoutGroup:{base:fi,key:"type",typeMap:{attachment:iP,field:Ai,relationship:lP,text:uP,utilityNetworkAssociations:cP}}}}function X8(t,e,r=!0){if(!t)return null;const i=r?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(s=>i[s.type]).map(s=>i[s.type].fromJSON(s))}function e9(t,e,r=!0){if(!t)return null;const i=r?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(s=>i[s.type]).map(s=>s.toJSON())}function t9(t,e,r=!0){return t?t.map(i=>Nn(r?e.typesWithGroup:e.typesWithoutGroup,i)):null}var Y$;let bn=Y$=class extends fi{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return t9(t,K1,!1)}readElements(t,e){return X8(e.formElements,K1,!1)}writeElements(t,e){e.formElements=e9(t,K1,!1)}clone(){return new Y$({description:this.description,elements:E(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};a([c({json:{write:!0}})],bn.prototype,"elements",void 0),a([Ce("elements")],bn.prototype,"castElements",null),a([V("elements",["formElements"])],bn.prototype,"readElements",null),a([q("elements")],bn.prototype,"writeElements",null),a([c({type:["collapsed","expanded"],json:{write:!0}})],bn.prototype,"initialState",void 0),a([c({type:String,json:{read:!1,write:!0}})],bn.prototype,"type",void 0),bn=Y$=a([b("esri.form.elements.GroupElement")],bn);const K1=Q8(bn),Khe=bn;var K$;const Q1=Q8(Khe);let Fs=K$=class extends F{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(t){return t9(t,Q1)}readElements(t,e){return X8(e.formElements,Q1)}writeElements(t,e){e.formElements=e9(t,Q1)}clone(){return new K$({description:this.description,expressionInfos:E(this.expressionInfos),elements:E(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}async getFieldsUsed(t,e){const r=new Set,{description:i,elements:s,expressionInfos:n,title:o}=this;if(lm(r,t,i),lm(r,t,o),!s)return[];const l=Qhe(s,n).map(u=>Lr(r,t,null,u));await Promise.all(l);for(const u of s)r9(r,{fieldsIndex:t,relationships:e},u);return Array.from(r).sort()}};function r9(t,e,r){const{fieldsIndex:i}=e;if(!i||i.fields.length!==t.size)switch(lm(t,i,r.label),lm(t,i,r.description),r.type){case"field":Ar(t,i,r.fieldName);break;case"group":r.elements.forEach(s=>r9(t,e,s));break;case"relationship":if(e.relationships){const s=e.relationships.find(n=>n.id===r.relationshipId);s&&Ar(t,i,s.keyField)}Nu(t,i,r.orderByFields?.map(s=>s.field));break;case"text":lm(t,i,r.text)}}function Qhe(t,e){if(!e||e.length===0)return[];const r=i9(t),i=[];for(const s of e)r.has(s.name)&&i.push(s.expression);return i}function i9(t){const e=new Set;for(const r of t)if(TI(e,r.visibilityExpression),!Yhe(r)){if(Jhe(r))uv(e,i9(r.elements));else if(TI(e,r.editableExpression),Zhe(r)){const{requiredExpression:i,valueExpression:s}=r;uv(e,[i,s])}}return e}function lm(t,e,r){Nu(t,e,kM(r))}a([c({type:String,json:{write:!0}})],Fs.prototype,"description",void 0),a([c({json:{write:!0}})],Fs.prototype,"elements",void 0),a([Ce("elements")],Fs.prototype,"castElements",null),a([V("elements",["formElements"])],Fs.prototype,"readElements",null),a([q("elements")],Fs.prototype,"writeElements",null),a([c({type:[_he],json:{write:!0}})],Fs.prototype,"expressionInfos",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],Fs.prototype,"preserveFieldValuesWhenHidden",void 0),a([c({type:String,json:{write:!0}})],Fs.prototype,"title",void 0),Fs=K$=a([b("esri.form.FormTemplate")],Fs);const Xhe=Symbol("getSliceableSymbol");let Dm=class{};Dm=a([b("esri.graphic.GraphicOrigin")],Dm);const epe=Symbol("isFeatureGraphicOrigin");var dP;let tpe=class extends Dm{get[(dP=epe,dy)](){return this.layer}get[NM](){return this.layer}get[Xhe](){return this.layer}constructor(e){super(),this[dP]=!0,this.type="feature",this.layer=e}get id(){return this.layer.id}};function hP(t,e,r){if(t.hasM==null||t.hasZ)for(const i of e)for(const s of i)s.length>2&&(s[2]*=r)}function rpe(t,e,r){if(!t&&!e||!r)return;const i=bv(r);pP(t,r,i),pP(e,r,i)}function pP(t,e,r){if(t)for(const i of t)ipe(i.geometry,e,r)}function ipe(t,e,r){if(!t?.spatialReference||Ht(t.spatialReference,e))return;const i=bv(t.spatialReference)/r;if(i!==1){if("x"in t)t.z!=null&&(t.z*=i);else if("rings"in t)hP(t,t.rings,i);else if("paths"in t)hP(t,t.paths,i);else if("points"in t&&(t.hasM==null||t.hasZ))for(const s of t.points)s.length>2&&(s[2]*=i)}}function fP(t,e,r){if(!r?.features||!r.hasZ)return;const i=zN(r.geometryType,e,t.outSpatialReference);if(i!=null)for(const s of r.features)i(s.geometry)}var Q$;const X$=new $e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let Vt=Q$=class extends F{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){return this.readFeaturesWithClass(t,e,st)}writeGeometryType(t,e,r,i){if(t)return void X$.write(t,e,r,i);const{features:s}=this;if(s){for(const n of s)if(n?.geometry!=null)return void X$.write(n.geometry.type,e,r,i)}}readQueryGeometry(t,e){if(!t)return null;const r=!!t.spatialReference,i=tl(t);return i&&!r&&e.spatialReference&&(i.spatialReference=Z.fromJSON(e.spatialReference)),i}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:r}=this;if(r){for(const i of r)if(i&&i.geometry!=null&&i.geometry.spatialReference)return void(e.spatialReference=i.geometry.spatialReference.toJSON())}}clone(){return new Q$(this.cloneProperties())}cloneProperties(){return E({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let r=0;r<e.features.length;r++){const i=e.features[r];if(i.geometry){const s=t?.[r];i.geometry=s?.toJSON()||i.geometry}}return e}quantize(t){const{scale:[e,r],translate:[i,s]}=t,n=d=>Math.round((d-i)/e),o=d=>Math.round((s-d)/r),l=this.features,u=this._getQuantizationFunction(this.geometryType,n,o);for(let d=0,p=l.length;d<p;d++)u?.(l[d].geometry)||(l.splice(d,1),d--,p--);return this.transform=t,this}unquantize(){const{geometryType:t,features:e,transform:r}=this;if(!r)return this;const{translate:[i,s],scale:[n,o]}=r,l=m=>m*n+i,u=m=>s-m*o;let d=null,p=null;if(this.hasZ&&r?.scale?.[2]!=null){const{translate:[,,m],scale:[,,y]}=r;d=g=>g*y+m}if(this.hasM&&r?.scale?.[3]!=null){const{translate:[,,,m],scale:[,,,y]}=r;p=g=>g==null?g:g*y+m}const f=this._getHydrationFunction(t,l,u,d,p);for(const{geometry:m}of e)m!=null&&f&&f(m);return this.transform=null,this}readFeaturesWithClass(t,e,r){const i=Z.fromJSON(e.spatialReference),s=[];for(let n=0;n<t.length;n++){const o=t[n],l=r.fromJSON(o),u=o.geometry?.spatialReference;l.geometry==null||u||(l.geometry.spatialReference=i);const d=o.aggregateGeometries,p=l.aggregateGeometries;if(d&&p!=null)for(const f in p){const m=p[f],y=d[f],g=y?.spatialReference;m==null||g||(m.spatialReference=i)}s.push(l)}return s}_quantizePoints(t,e,r){let i,s;const n=[];for(let o=0,l=t.length;o<l;o++){const u=t[o];if(o>0){const d=e(u[0]),p=r(u[1]);d===i&&p===s||(n.push([d-i,p-s]),i=d,s=p)}else i=e(u[0]),s=r(u[1]),n.push([i,s])}return n.length>0?n:null}_getQuantizationFunction(t,e,r){return t==="point"?i=>(i.x=e(i.x),i.y=r(i.y),i):t==="polyline"||t==="polygon"?i=>{const s=Fd(i)?i.rings:i.paths,n=[];for(let o=0,l=s.length;o<l;o++){const u=s[o],d=this._quantizePoints(u,e,r);d&&n.push(d)}return n.length>0?(Fd(i)?i.rings=n:i.paths=n,i):null}:t==="multipoint"?i=>{const s=this._quantizePoints(i.points,e,r);return s&&s.length>0?(i.points=s,i):null}:t==="extent"?i=>i:null}_getHydrationFunction(t,e,r,i,s){return t==="point"?n=>{n.x=e(n.x),n.y=r(n.y),i&&(n.z=i(n.z))}:t==="polyline"||t==="polygon"?n=>{const o=Fd(n)?n.rings:n.paths;let l,u;for(let d=0,p=o.length;d<p;d++){const f=o[d];for(let m=0,y=f.length;m<y;m++){const g=f[m];m>0?(l+=g[0],u+=g[1]):(l=g[0],u=g[1]),g[0]=e(l),g[1]=r(u)}}if(i&&s)for(let d=0,p=o.length;d<p;d++){const f=o[d];for(let m=0,y=f.length;m<y;m++){const g=f[m];g[2]=i(g[2]),g[3]=s(g[3])}}else if(i)for(let d=0,p=o.length;d<p;d++){const f=o[d];for(let m=0,y=f.length;m<y;m++){const g=f[m];g[2]=i(g[2])}}else if(s)for(let d=0,p=o.length;d<p;d++){const f=o[d];for(let m=0,y=f.length;m<y;m++){const g=f[m];g[2]=s(g[2])}}}:t==="extent"?n=>{n.xmin=e(n.xmin),n.ymin=r(n.ymin),n.xmax=e(n.xmax),n.ymax=r(n.ymax),i&&n.zmax!=null&&n.zmin!=null&&(n.zmax=i(n.zmax),n.zmin=i(n.zmin)),s&&n.mmax!=null&&n.mmin!=null&&(n.mmax=s(n.mmax),n.mmin=s(n.mmin))}:t==="multipoint"?n=>{const o=n.points;let l,u;for(let d=0,p=o.length;d<p;d++){const f=o[d];d>0?(l+=f[0],u+=f[1]):(l=f[0],u=f[1]),f[0]=e(l),f[1]=r(u)}if(i&&s)for(let d=0,p=o.length;d<p;d++){const f=o[d];f[2]=i(f[2]),f[3]=s(f[3])}else if(i)for(let d=0,p=o.length;d<p;d++){const f=o[d];f[2]=i(f[2])}else if(s)for(let d=0,p=o.length;d<p;d++){const f=o[d];f[2]=s(f[2])}}:null}};a([c({type:String,json:{write:!0}})],Vt.prototype,"displayFieldName",void 0),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Vt.prototype,"exceededTransferLimit",void 0),a([c({type:[st],json:{write:!0}})],Vt.prototype,"features",void 0),a([V("features")],Vt.prototype,"readFeatures",null),a([c({type:[tr],json:{write:!0}})],Vt.prototype,"fields",void 0),a([c({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:X$.read}}})],Vt.prototype,"geometryType",void 0),a([q("geometryType")],Vt.prototype,"writeGeometryType",null),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Vt.prototype,"hasM",void 0),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Vt.prototype,"hasZ",void 0),a([c({types:uy,json:{write:!0}})],Vt.prototype,"queryGeometry",void 0),a([V("queryGeometry")],Vt.prototype,"readQueryGeometry",null),a([c({type:Z,json:{write:!0}})],Vt.prototype,"spatialReference",void 0),a([q("spatialReference")],Vt.prototype,"writeSpatialReference",null),a([c({json:{write:!0}})],Vt.prototype,"transform",void 0),Vt=Q$=a([b("esri.rest.support.FeatureSet")],Vt),Vt.prototype.toJSON.isDefaultToJSON=!0;let spe=0,wo=class extends kL(kT(H)){constructor(e){super(e),this._idToClientGeometry=null,this.type="memory"}load(e){const r=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(r)),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null}get _workerGeometryType(){const e=this.layer?.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(e){return this.load().then(()=>this._applyEdits(e))}openPorts(){return this.load().then(()=>this._connection.openPorts())}async queryFeatures(e,r={}){await this.load(r);const i=await this._connection.invoke("queryFeatures",e?e.toJSON():null,r);fP(e,this.layer.spatialReference,i);const s=Vt.fromJSON(i);if(!this._requiresClientGraphicMapping()||!this._idToClientGeometry)return s;const n=this.layer.objectIdField;for(const o of s.features){const l=o.attributes[n],u=this._idToClientGeometry.get(l);u!==void 0&&(o.geometry=u)}return s.geometryType=this.layer.geometryType,s}async queryFeaturesJSON(e,r={}){if(this._requiresClientGraphicMapping())throw new x("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(r);const i=await this._connection.invoke("queryFeatures",e?e.toJSON():null,r);return fP(e,this.layer.spatialReference,i),i}queryFeatureCount(e,r={}){return this.load(r).then(()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,r))}queryObjectIds(e,r={}){return this.load(r).then(()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,r))}queryExtent(e,r={}){return this.load(r).then(()=>this._connection.invoke("queryExtent",e?e.toJSON():null,r)).then(i=>({count:i.count,extent:he.fromJSON(i.extent)}))}querySnapping(e,r={}){return this.load(r).then(()=>this._connection.invoke("querySnapping",e,r))}async queryAttributeBins(e,r={}){return await this.load(),this._connection.invoke("queryAttributeBins",e?.toJSON(),r)}async _applyEdits(e){if(!this._connection)throw new x("feature-layer-source:edit-failure","Memory source not loaded");const r=this.layer.objectIdField;let i=null;const s=[],n=[];await Promise.all([this._prepareClientMapping(e.addFeatures,null),this._prepareClientMapping(e.updateFeatures,null)]);const o=p=>"objectId"in p&&p.objectId!=null?p.objectId:"attributes"in p&&p.attributes[r]!=null?p.attributes[r]:null;if(e.addFeatures&&(i=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(const p of e.deleteFeatures){const f=o(p);f!=null&&s.push(f)}const l=e.updateFeatures&&this._idToClientGeometry?new Map:null;if(e.updateFeatures){for(const p of e.updateFeatures)if(n.push(this._serializeFeature(p)),l&&p.geometry!=null){const f=o(p);f!=null&&l.set(f,p)}}rpe(i?i.features:null,n,this.layer.spatialReference);const{fullExtent:u,featureEditResults:d}=await this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:n,deletes:s});return this.fullExtent=u,i&&i.finish(d.uidToObjectId),this._updateIdToClientGeometries(l,d),this._createEditsResult(d)}async _prepareClientMapping(e,r){if(this._layerOrSourceGeometryType!=="mesh"||e==null)return;const i=[];for(const{geometry:s}of e)s==null||s.type!=="mesh"||s.hasExtent||s.loaded||i.push(s.load({signal:r}));i.length&&await Promise.all(i)}_updateIdToClientGeometries(e,r){if(this._idToClientGeometry){if(e)for(const i of r.updateResults){if(!i.success)continue;const s=e.get(i.objectId);s!=null&&this._addIdToClientGeometry(s)}for(const i of r.deleteResults)i.success&&this._idToClientGeometry.delete(i.objectId)}}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const r=e.success===!0?null:e.error||{code:void 0,description:""};return{objectId:e.objectId,globalId:e.globalId,error:r?new x("feature-layer-source:edit-failure",r.description,{code:r.code}):null}}_prepareAddFeatures(e){const r=new Map,i=new Array(e.length);let s=null;for(let o=0;o<e.length;o++){const l=e[o],u=this._serializeFeature(l);s||l.geometry==null||(s=l.geometry.type),i[o]=u,r.set(`${u.uid}`,l)}const n=this;return{features:i,inferredGeometryType:s,finish(o){const l=n.sourceJSON.objectIdField;for(const u in o){const d=o[u],p=r.get(u);p&&(p.attributes||(p.attributes={}),d===-1?delete p.attributes[l]:p.attributes[l]=d,n._addIdToClientGeometry(p))}}}}_addIdToClientGeometry(e){if(!this._idToClientGeometry)return;const r=this.sourceJSON.objectIdField,i=e.attributes?.[r];i!=null&&this._idToClientGeometry.set(i,e.geometry??null)}get _layerOrSourceGeometryType(){return this.layer?.geometryType??this.sourceJSON?.geometryType}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}_geometryTypeRequiresClientGraphicMapping(e){return e==="mesh"||e==="multipatch"||e==="extent"}_serializeFeature(e){const{attributes:r}=e,i=this._geometryForSerialization(e),s=(spe++).toString();return i?{uid:s,geometry:i.toJSON(),attributes:r}:{uid:s,attributes:r}}_geometryForSerialization(e){const{geometry:r}=e;return r==null?null:this._geometryRequiresClientGraphicMapping(r)?r.extent?Be.fromExtent(r.extent):null:r}async _startWorker(e){this._connection=await nee("MemorySourceWorker",{strategy:k("feature-layers-workers")?"dedicated":"local",signal:e,registryTarget:this});const{fields:r,spatialReference:i,objectIdField:s,hasM:n,hasZ:o,timeInfo:l,dateFieldsTimeZone:u}=this.layer,d=this.layer.originOf("spatialReference")==="defaults";await this._prepareClientMapping(this.items,e);const p=this._prepareAddFeatures(this.items);this.addHandles(this.on("before-changes",g=>{L.getLogger(this).error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),g.preventDefault()}));const f={features:p.features,fields:r?.map(g=>g.toJSON()),geometryType:pO.toJSON(this._workerGeometryType),hasM:this._layerOrSourceGeometryType!=="mesh"&&n,hasZ:this._layerOrSourceGeometryType==="mesh"||o,objectIdField:s,spatialReference:d?null:i&&i.toJSON(),timeInfo:l?.toJSON()??null,dateFieldsTimeZone:u},m=await this._connection.invoke("load",f,{signal:e});for(const g of m.warnings)L.getLogger(this.layer).warn("#load()",`${g.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:g});m.featureErrors.length&&L.getLogger(this.layer).warn("#load()",`Encountered ${m.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:m.featureErrors});const y=m.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(p.inferredGeometryType)&&(y.geometryType=pO.toJSON(p.inferredGeometryType)),this.sourceJSON=y,this._requiresClientGraphicMapping()&&(this._idToClientGeometry=new Map),p.finish(m.assignedObjectIds)}};a([OT({Type:st,ensureType:ut(st)})],wo.prototype,"itemType",void 0),a([c()],wo.prototype,"type",void 0),a([c({constructOnly:!0})],wo.prototype,"layer",void 0),a([c({readOnly:!0})],wo.prototype,"_workerGeometryType",null),a([c()],wo.prototype,"sourceJSON",void 0),wo=a([b("esri.layers.graphics.sources.MemorySource")],wo);function npe(t){return"portalItem"in t}const ope=t=>{const e=t;let r=class extends e{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):npe(this)?this.portalItem?.apiKey:null}set apiKey(i){i!=null?this._override("apiKey",i):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return a([c({type:String})],r.prototype,"apiKey",null),r=a([b("esri.layers.mixins.APIKeyMixin")],r),r},ape=t=>{const e=t;let r=class extends e{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const i=nl(this.url);if(i?.title)return i.title}return this._get("title")||""}set title(i){this._set("title",i)}set url(i){this._set("url",g7(i,L.getLogger(this)))}};return a([c()],r.prototype,"title",null),a([c({type:String})],r.prototype,"url",null),r=a([b("esri.layers.mixins.ArcGISService")],r),r};let mP=class extends SyntaxError{constructor(e,r,i,s){super(e),this.expected=r,this.found=i,this.location=s,this.name="SyntaxError"}format(e){let r="Error: "+this.message;if(this.location){let i=null;const s=e.find(u=>u.source===this.location.source);s&&(i=s.text.split(/\r\n|\n|\r/g));const n=this.location.start,o=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(n):n,l=this.location.source+":"+o.line+":"+o.column;if(i){const u=this.location.end,d="".padEnd(o.line.toString().length," "),p=i[n.line-1],f=(n.line===u.line?u.column:p.length+1)-n.column||1;r+=`
 --> `+l+`
`+d+` |
`+o.line+" | "+p+`
`+d+" | "+"".padEnd(n.column-1," ")+"".padEnd(f,"^")}else r+=`
 at `+l}return r}static buildMessage(e,r){function i(m){return m.codePointAt(0).toString(16).toUpperCase()}const s=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function n(m){return s?m.replace(s,y=>"\\u{"+i(y)+"}"):m}function o(m){return n(m.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,y=>"\\x0"+i(y)).replace(/[\x10-\x1F\x7F-\x9F]/g,y=>"\\x"+i(y)))}function l(m){return n(m.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,y=>"\\x0"+i(y)).replace(/[\x10-\x1F\x7F-\x9F]/g,y=>"\\x"+i(y)))}const u={literal:m=>'"'+o(m.text)+'"',class(m){const y=m.parts.map(g=>Array.isArray(g)?l(g[0])+"-"+l(g[1]):l(g));return"["+(m.inverted?"^":"")+y.join("")+"]"+(m.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:m=>m.description};function d(m){return u[m.type](m)}function p(m){const y=m.map(d);if(y.sort(),y.length>0){let g=1;for(let v=1;v<y.length;v++)y[v-1]!==y[v]&&(y[g]=y[v],g++);y.length=g}switch(y.length){case 1:return y[0];case 2:return y[0]+" or "+y[1];default:return y.slice(0,-1).join(", ")+", or "+y[y.length-1]}}function f(m){return m?'"'+o(m)+'"':"end of input"}return"Expected "+p(e)+" but "+f(r)+" found."}};function lpe(t,e){const r={},i=(e=e!==void 0?e:{}).grammarSource,s={start:H3};let n=H3;const o="none",l=")",u=",",d="(",p="%",f="px",m="cm",y="mm",g="in",v="pt",_="pc",S="deg",M="rad",C="grad",T="turn",O="#",P=".",D="e",z=/^[ \t\n\r]/,B=/^[a-z\-]/,G=/^[0-9a-fA-F]/,Q=/^[+\-]/,oe=/^[0-9]/,Pe=Wo("none"),fe=Zt("none",!1),Ft=Zt(")",!1),_i=Zt(",",!1),nr=dp([" ","	",`
`,"\r"],!1,!1,!1),Ne=Wo("function"),bs=Zt("(",!1),XV=Wo("identifier"),z3=dp([["a","z"],"-"],!1,!1,!1),ez=Wo("percentage"),tz=Zt("%",!1),rz=Wo("length"),iz=Zt("px",!1),sz=Zt("cm",!1),nz=Zt("mm",!1),oz=Zt("in",!1),az=Zt("pt",!1),lz=Zt("pc",!1),uz=Wo("angle"),cz=Zt("deg",!1),dz=Zt("rad",!1),hz=Zt("grad",!1),pz=Zt("turn",!1),fz=Wo("number"),mz=Wo("color"),yz=Zt("#",!1),U3=dp([["0","9"],["a","f"],["A","F"]],!1,!1,!1),q3=dp(["+","-"],!1,!1,!1),Ho=dp([["0","9"]],!1,!1,!1),gz=Zt(".",!1),vz=Zt("e",!1);function wz(){return[]}function bz($,A){return{type:"function",name:$,parameters:A||[]}}function _z($,A){return A.length>0?eU($,A,3):[$]}function Sz($){return{type:"quantity",value:$.value,unit:$.unit}}function $z($){return{type:"color",colorType:$.type,value:$.value}}function Owe($){return $}function xz(){return Ty()}function Tz($){return{value:$,unit:"%"}}function Mz($){return{value:$,unit:"px"}}function Iz($){return{value:$,unit:"cm"}}function Ez($){return{value:$,unit:"mm"}}function Oz($){return{value:$,unit:"in"}}function kz($){return{value:$,unit:"pt"}}function Cz($){return{value:$,unit:"pc"}}function Pz($){return{value:$,unit:"deg"}}function Az($){return{value:$,unit:"rad"}}function Rz($){return{value:$,unit:"grad"}}function Lz($){return{value:$,unit:"turn"}}function Fz($){return{value:$,unit:null}}function Nz(){return{type:"hex",value:Ty()}}function Dz($){return{type:"function",value:$}}function jz(){return{type:"named",value:Ty()}}function Vz(){return parseFloat(Ty())}let R=0|e.peg$currPos,it=R;const Yu=[{line:1,column:1}];let cp,_s=R,xy=e.peg$maxFailExpected||[],ae=0|e.peg$silentFails;if(e.startRule){if(!(e.startRule in s))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');n=s[e.startRule]}function Ty(){return t.substring(it,R)}function zz($=R){const A=t.codePointAt($);return A===void 0?"":String.fromCodePoint(A)}function Zt($,A){return{type:"literal",text:$,ignoreCase:A}}function dp($,A,U,ce){return{type:"class",parts:$,inverted:A,ignoreCase:U,unicode:ce}}function Uz(){return{type:"end"}}function Wo($){return{type:"other",description:$}}function G3($){let A,U=Yu[$];if(U)return U;if($>=Yu.length)A=Yu.length-1;else for(A=$;!Yu[--A];);for(U=Yu[A],U={line:U.line,column:U.column};A<$;)t.charCodeAt(A)===10?(U.line++,U.column=1):U.column++,A++;return Yu[$]=U,U}function B3($,A,U){const ce=G3($),De=G3(A);return{source:i,start:{offset:$,line:ce.line,column:ce.column},end:{offset:A,line:De.line,column:De.column}}}function ye($){R<_s||(R>_s&&(_s=R,xy=[]),xy.push($))}function qz($,A,U){return new mP(mP.buildMessage($,A),$,A,U)}function H3(){let $;return $=Gz(),$===r&&($=Bz()),$}function Gz(){let $,A;return ae++,$=R,Jt(),t.substr(R,4)===o?(A=o,R+=4):(A=r,ae===0&&ye(fe)),A!==r?(Jt(),it=$,$=wz()):(R=$,$=r),ae--,$===r&&ae===0&&ye(Pe),$}function Bz(){let $,A;if($=[],A=xb(),A!==r)for(;A!==r;)$.push(A),A=xb();else $=r;return $}function xb(){let $,A,U,ce;return $=R,Jt(),A=Wz(),A!==r?(Jt(),U=Hz(),U===r&&(U=null),Jt(),t.charCodeAt(R)===41?(ce=l,R++):(ce=r,ae===0&&ye(Ft)),ce!==r?(Jt(),it=$,$=bz(A,U)):(R=$,$=r)):(R=$,$=r),$}function Hz(){let $,A,U,ce,De,ht,Nt,pr;if($=R,A=Tb(),A!==r){for(U=[],ce=R,De=Jt(),t.charCodeAt(R)===44?(ht=u,R++):(ht=r,ae===0&&ye(_i)),ht===r&&(ht=null),Nt=Jt(),pr=Tb(),pr!==r?(De=[De,ht,Nt,pr],ce=De):(R=ce,ce=r);ce!==r;)U.push(ce),ce=R,De=Jt(),t.charCodeAt(R)===44?(ht=u,R++):(ht=r,ae===0&&ye(_i)),ht===r&&(ht=null),Nt=Jt(),pr=Tb(),pr!==r?(De=[De,ht,Nt,pr],ce=De):(R=ce,ce=r);it=$,$=_z(A,U)}else R=$,$=r;return $}function Tb(){let $,A;return $=R,A=Zz(),A===r&&(A=Jz(),A===r&&(A=Yz(),A===r&&(A=Kz()))),A!==r&&(it=$,A=Sz(A)),$=A,$===r&&($=R,A=Qz(),A!==r&&(it=$,A=$z(A)),$=A),$}function Jt(){let $,A;for(ae++,$=[],A=t.charAt(R),z.test(A)?R++:(A=r,ae===0&&ye(nr));A!==r;)$.push(A),A=t.charAt(R),z.test(A)?R++:(A=r,ae===0&&ye(nr));return ae--,$}function Wz(){let $,A,U;return ae++,$=R,A=W3(),A!==r?(t.charCodeAt(R)===40?(U=d,R++):(U=r,ae===0&&ye(bs)),U!==r?(it=$,$=A):(R=$,$=r)):(R=$,$=r),ae--,$===r&&(A=r,ae===0&&ye(Ne)),$}function W3(){let $,A,U;if(ae++,$=R,A=[],U=t.charAt(R),B.test(U)?R++:(U=r,ae===0&&ye(z3)),U!==r)for(;U!==r;)A.push(U),U=t.charAt(R),B.test(U)?R++:(U=r,ae===0&&ye(z3));else A=r;return A!==r&&(it=$,A=xz()),$=A,ae--,$===r&&(A=r,ae===0&&ye(XV)),$}function Zz(){let $,A,U;return ae++,$=R,Jt(),A=Hi(),A!==r?(t.charCodeAt(R)===37?(U=p,R++):(U=r,ae===0&&ye(tz)),U!==r?(it=$,$=Tz(A)):(R=$,$=r)):(R=$,$=r),ae--,$===r&&ae===0&&ye(ez),$}function Jz(){let $,A,U;return ae++,$=R,Jt(),A=Hi(),A!==r?(t.substr(R,2)===f?(U=f,R+=2):(U=r,ae===0&&ye(iz)),U!==r?(it=$,$=Mz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,Jt(),A=Hi(),A!==r?(t.substr(R,2)===m?(U=m,R+=2):(U=r,ae===0&&ye(sz)),U!==r?(it=$,$=Iz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,Jt(),A=Hi(),A!==r?(t.substr(R,2)===y?(U=y,R+=2):(U=r,ae===0&&ye(nz)),U!==r?(it=$,$=Ez(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,Jt(),A=Hi(),A!==r?(t.substr(R,2)===g?(U=g,R+=2):(U=r,ae===0&&ye(oz)),U!==r?(it=$,$=Oz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,Jt(),A=Hi(),A!==r?(t.substr(R,2)===v?(U=v,R+=2):(U=r,ae===0&&ye(az)),U!==r?(it=$,$=kz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,Jt(),A=Hi(),A!==r?(t.substr(R,2)===_?(U=_,R+=2):(U=r,ae===0&&ye(lz)),U!==r?(it=$,$=Cz(A)):(R=$,$=r)):(R=$,$=r)))))),ae--,$===r&&ae===0&&ye(rz),$}function Yz(){let $,A,U;return ae++,$=R,A=Hi(),A!==r?(t.substr(R,3)===S?(U=S,R+=3):(U=r,ae===0&&ye(cz)),U!==r?(it=$,$=Pz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,A=Hi(),A!==r?(t.substr(R,3)===M?(U=M,R+=3):(U=r,ae===0&&ye(dz)),U!==r?(it=$,$=Az(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,A=Hi(),A!==r?(t.substr(R,4)===C?(U=C,R+=4):(U=r,ae===0&&ye(hz)),U!==r?(it=$,$=Rz(A)):(R=$,$=r)):(R=$,$=r),$===r&&($=R,A=Hi(),A!==r?(t.substr(R,4)===T?(U=T,R+=4):(U=r,ae===0&&ye(pz)),U!==r?(it=$,$=Lz(A)):(R=$,$=r)):(R=$,$=r)))),ae--,$===r&&(A=r,ae===0&&ye(uz)),$}function Kz(){let $,A;return ae++,$=R,Jt(),A=Hi(),A!==r?(it=$,$=Fz(A)):(R=$,$=r),ae--,$===r&&ae===0&&ye(fz),$}function Qz(){let $,A,U,ce;if(ae++,$=R,t.charCodeAt(R)===35?(A=O,R++):(A=r,ae===0&&ye(yz)),A!==r){if(U=[],ce=t.charAt(R),G.test(ce)?R++:(ce=r,ae===0&&ye(U3)),ce!==r)for(;ce!==r;)U.push(ce),ce=t.charAt(R),G.test(ce)?R++:(ce=r,ae===0&&ye(U3));else U=r;U!==r?(it=$,$=Nz()):(R=$,$=r)}else R=$,$=r;return $===r&&($=R,A=xb(),A!==r&&(it=$,A=Dz(A)),$=A,$===r&&($=R,A=W3(),A!==r&&(it=$,A=jz()),$=A)),ae--,$===r&&(A=r,ae===0&&ye(mz)),$}function Hi(){let $,A,U,ce,De,ht,Nt,pr;for($=R,A=t.charAt(R),Q.test(A)?R++:(A=r,ae===0&&ye(q3)),A===r&&(A=null),U=R,ce=[],De=t.charAt(R),oe.test(De)?R++:(De=r,ae===0&&ye(Ho));De!==r;)ce.push(De),De=t.charAt(R),oe.test(De)?R++:(De=r,ae===0&&ye(Ho));if(t.charCodeAt(R)===46?(De=P,R++):(De=r,ae===0&&ye(gz)),De!==r){if(ht=[],Nt=t.charAt(R),oe.test(Nt)?R++:(Nt=r,ae===0&&ye(Ho)),Nt!==r)for(;Nt!==r;)ht.push(Nt),Nt=t.charAt(R),oe.test(Nt)?R++:(Nt=r,ae===0&&ye(Ho));else ht=r;ht!==r?(ce=[ce,De,ht],U=ce):(R=U,U=r)}else R=U,U=r;if(U===r)if(U=[],ce=t.charAt(R),oe.test(ce)?R++:(ce=r,ae===0&&ye(Ho)),ce!==r)for(;ce!==r;)U.push(ce),ce=t.charAt(R),oe.test(ce)?R++:(ce=r,ae===0&&ye(Ho));else U=r;if(U!==r){if(ce=R,t.charCodeAt(R)===101?(De=D,R++):(De=r,ae===0&&ye(vz)),De!==r){if(ht=t.charAt(R),Q.test(ht)?R++:(ht=r,ae===0&&ye(q3)),ht===r&&(ht=null),Nt=[],pr=t.charAt(R),oe.test(pr)?R++:(pr=r,ae===0&&ye(Ho)),pr!==r)for(;pr!==r;)Nt.push(pr),pr=t.charAt(R),oe.test(pr)?R++:(pr=r,ae===0&&ye(Ho));else Nt=r;Nt!==r?(De=[De,ht,Nt],ce=De):(R=ce,ce=r)}else R=ce,ce=r;ce===r&&(ce=null),it=$,$=Vz()}else R=$,$=r;return $}function Xz($,A){return $.map(function(U){return U[A]})}function eU($,A,U){return[$].concat(Xz(A,U))}cp=n();const Mb=cp!==r&&R===t.length;function Z3(){throw cp!==r&&R<t.length&&ye(Uz()),qz(xy,_s<t.length?zz(_s):null,_s<t.length?B3(_s,_s+1):B3(_s,_s))}return e.peg$library?{peg$result:cp,peg$currPos:R,peg$FAILED:r,peg$maxFailExpected:xy,peg$maxFailPos:_s,peg$success:Mb,peg$throw:Mb?void 0:Z3}:Mb?cp:void Z3()}function s9(t){if(!t||t.length===0)return null;if(typeof t=="string"){const r=yP(t);return r&&r.length!==0?r:null}const e=t.map(r=>{if(!Number.isFinite(r.scale)||r.scale<=0)throw new x("effect:invalid-scale","scale must be finite and greater than 0",{stop:r});return{scale:r.scale,effects:yP(r.value)}});e.sort((r,i)=>i.effects.length-r.effects.length);for(let r=0;r<e.length-1;r++){if(!bX(e[r].effects,e[r+1].effects))throw new x("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[r].effects,b:e[r+1].effects});_X(e[r].effects,e[r+1].effects)}return e.sort((r,i)=>i.scale-r.scale),e}function yP(t){let e;if(!t)return[];try{e=lpe(t)}catch(r){throw new x("effect:invalid-syntax","Invalid effect syntax",{value:t,error:r})}return e.map(r=>upe(r))}function upe(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return cpe(t);case"opacity":return dpe(t);case"hue-rotate":return hpe(t);case"blur":return ppe(t);case"drop-shadow":return fpe(t);case"bloom":return mpe(t)}}catch(e){throw e.details.filter=t,e}throw new x("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function cpe(t){let e=1;return op(t.parameters,1),t.parameters.length===1&&(e=Gs(t.parameters[0])),new MS(t.name,e)}function dpe(t){let e=1;return op(t.parameters,1),t.parameters.length===1&&(e=Gs(t.parameters[0])),new yD(e)}function hpe(t){let e=0;return op(t.parameters,1),t.parameters.length===1&&(e=_pe(t.parameters[0])),new fD(e)}function ppe(t){let e=0;return op(t.parameters,1),t.parameters.length===1&&(e=y3(t.parameters[0]),_y(e,t.parameters[0])),new uD(e)}function fpe(t){const e=[];let r=null;for(const i of t.parameters)if(i.type==="color"){if(e.length&&Object.freeze(e),r)throw new x("effect:type-error","Accepts only one color",{});r=Spe(i)}else{const s=y3(i);if(Object.isFrozen(e))throw new x("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(s),e.length===3&&_y(s,i)}if(e.length<2||e.length>3)throw new x("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new hD(e[0],e[1],e[2]||0,r||n9("black"))}function mpe(t){let e=1,r=0,i=0;return op(t.parameters,3),t.parameters[0]&&(e=Gs(t.parameters[0])),t.parameters[1]&&(r=y3(t.parameters[1]),_y(r,t.parameters[1])),t.parameters[2]&&(i=Gs(t.parameters[2])),new aD(e,r,i)}function op(t,e){if(t.length>e)throw new x("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function pb(t){if(t.type==="color")return"<color>";if(t.unit){if(t.unit in m3)return"<length>";if(t.unit in f3)return"<angle>";if(t.unit==="%")return"<percentage>"}return"<double>"}function _y(t,e){if(t<0)throw new x("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function ype(t){if(t.type!=="quantity"||t.unit!==null)throw new x("effect:type-error",`Expected <double>, Actual: ${pb(t)}`,{term:t})}function gpe(t){if(t.type!=="quantity"||t.unit!==null&&t.unit!=="%")throw new x("effect:type-error",`Expected <double> or <percentage>, Actual: ${pb(t)}`,{term:t})}const f3={deg:1,grad:.9,rad:180/Math.PI,turn:360};function vpe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&f3[t.unit]!=null))throw new x("effect:type-error",`Expected <angle>, Actual: ${pb(t)}`,{term:t})}const m3={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function wpe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&m3[t.unit]!=null))throw new x("effect:type-error",`Expected <length>, Actual: ${pb(t)}`,{term:t})}function Gs(t){gpe(t);const e=t.value;return _y(e,t),t.unit==="%"?.01*e:e}function bpe(t){return ype(t),_y(t.value,t),t.value}function _pe(t){return vpe(t),t.value*f3[t.unit]||0}function y3(t){return wpe(t),t.value*m3[t.unit]||0}function Spe(t){switch(t.colorType){case"hex":return cJ(t.value);case"named":return n9(t.value);case"function":return Tpe(t.value)}}function n9(t){if(!k5(t))throw new x("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return uJ(t)}const $pe=/^rgba?/i,xpe=/^hsla?/i;function Tpe(t){if(op(t.parameters,4),$pe.test(t.name))return[Gs(t.parameters[0]),Gs(t.parameters[1]),Gs(t.parameters[2]),t.parameters[3]?Gs(t.parameters[3]):1];if(xpe.test(t.name))return C5(bpe(t.parameters[0]),Gs(t.parameters[1]),Gs(t.parameters[2]),t.parameters[3]?Gs(t.parameters[3]):1);throw new x("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}function jm(t,e,r){try{return Ipe(t)}catch(i){r?.messages?.push(i)}return null}function Vm(t,e,r,i){try{const s=Mpe(t);Bt(r,s,e)}catch(s){i.messages&&i.messages.push(s)}}function Mpe(t){const e=s9(t);return e?SX(e)?e.map(r=>r.toJSON()):e.map(({scale:r,effects:i})=>({scale:r,value:i.map(s=>s.toJSON())})):null}function Ipe(t){if(!t||t.length===0)return null;if(Epe(t)){const e=[];for(const r of t)e.push({scale:r.scale,value:gP(r.value)});return e}return gP(t)}function Epe(t){const e=t[0];return!!e&&"scale"in e}function gP(t){if(!t?.length)return"";const e=[];for(const r of t){let i=[];switch(r.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":i=[Zn(r,"amount")];break;case"blur":i=[Zn(r,"radius","pt")];break;case"hue-rotate":i=[Zn(r,"angle","deg")];break;case"drop-shadow":i=[Zn(r,"xoffset","pt"),Zn(r,"yoffset","pt"),Zn(r,"blurRadius","pt"),Ope(r,"color")];break;case"bloom":i=[Zn(r,"strength"),Zn(r,"radius","pt"),Zn(r,"threshold")]}const s=`${r.type}(${i.filter(Boolean).join(" ")})`;s9(s),e.push(s)}return e.join(" ")}function Zn(t,e,r){if(t[e]==null)throw new x("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return r?t[e]+r:""+t[e]}function Ope(t,e){if(t[e]==null)throw new x("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const r=t[e];return`rgba(${r[0]||0}, ${r[1]||0}, ${r[2]||0}, ${r[3]/255||0})`}const kpe={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:{layerContainerTypes:qe}},"portal-item":{read:!0,write:{layerContainerTypes:qe}}}}},vP={read:{reader:jm},write:{allowNull:!0,writer:Vm,layerContainerTypes:qe}},Cpe={json:{read:!1,write:!1,origins:{"web-map":vP,"portal-item":vP}}},Ppe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return a([c(kpe)],r.prototype,"blendMode",void 0),a([c(Cpe)],r.prototype,"effect",void 0),r=a([b("esri.layers.mixins.BlendLayer")],r),r},Ape=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.customParameters=null}};return a([c({type:Object,json:{write:{overridePolicy:i=>({enabled:!!(i&&Object.keys(i).length>0)})}}})],r.prototype,"customParameters",void 0),r=a([b("esri.layers.mixins.CustomParametersMixin")],r),r},o9=96;function gIe(t,e){const r=t.extent,i=t.width,s=Bi(r?.spatialReference);return r&&i?r.width/i*s*BL*o9:0}function Rpe(t,e){return t/(Bi(e)*BL*o9)}function Lpe(t,e){const r=t.extent,i=t.width-(t.padding?t.padding.left+t.padding.right:0),s=Rpe(e,r.spatialReference);return r.clone().expand(s*i/r.width)}function vIe(t,e,r){return Fpe(t,e)&&Npe(t,r)}function Fpe(t,e){return e===0||zi(t,e)||t<e}function Npe(t,e){return e===0||zi(t,e)||t>e}function Dpe(t,e){return zi(t,e)?0:(t||Number.POSITIVE_INFINITY)>(e||Number.POSITIVE_INFINITY)?1:-1}const wP={write:{overridePolicy:(t,e,r)=>({enabled:!r||r.filterMode==="scale"})}};let bo=class extends pe(F){constructor(e){super(e),this.id=ep(),this.maxScale=0,this.minScale=0,this.title="",this.where=null}};a([c({type:String,json:{write:!0}})],bo.prototype,"id",void 0),a([c({type:Number,json:wP})],bo.prototype,"maxScale",void 0),a([c({type:Number,json:wP})],bo.prototype,"minScale",void 0),a([c({type:String,json:{write:!0}})],bo.prototype,"title",void 0),a([c({type:String,json:{write:!0}})],bo.prototype,"where",void 0),bo=a([b("esri.layers.support.DisplayFilter")],bo);function jpe(t,e){return{...e,filterMode:t.mode}}function bIe(t,e){return a9(t,e).next().value??null}function _Ie(t,e,r){const i=Vpe(t);if(i&&(j5(e,i[0])||aS(r,i[1])))return"";const s=Array.from(a9(t,e,r)),n=zpe(s,e,r)?"1=1":s.map(o=>o.where||"1=1").reduce((o,l)=>jte(o,l),"");return n&&n!=="1=1"?n:""}function Vpe(t){if(l9(t)==="manual")return null;const e=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:r,maxScale:i}of t.filters)e[0]=Math.max(e[0],zm(r)),e[1]=Math.min(e[1],rw(i));return e}function*a9(t,e,r){if(l9(t)==="manual"){const i=t.filters.find(s=>s.id===t.activeFilterId);i&&(yield i)}else{typeof e=="object"&&(e=e.scale);for(const i of t.filters)Upe(i.minScale,i.maxScale,e,r)&&(yield i)}}function zpe(t,e,r){if(t.length===0)return!0;const i=zm(t.at(0)?.minScale),s=rw(t.at(-1)?.maxScale);if(aS(i,e)||j5(s,r))return!0;for(let n=0;n<t.length-1;n++){const o=t[n],l=t[n+1];if(aS(zm(l.minScale),rw(o.maxScale)))return!0}return!1}function Upe(t,e,r,i){return t=zm(t),r=zm(r),e=rw(e),!(!zi(r,t)&&(i??r)>t)&&!pJ(e,r)&&(i===void 0||!zi(i,t))}function l9(t){return"mode"in t?t.mode:t.filterMode}function zm(t){return t||Number.POSITIVE_INFINITY}function rw(t){return t||0}let Bl=class extends pe(F){constructor(e){super(e),this.activeFilterId=null,this.filters=new(H.ofType(bo)),this.mode="manual"}writeFilters(e,r,i,s){const n=e.toArray();this.mode==="scale"&&n.sort((o,l)=>{const u=Dpe(l.minScale,o.minScale),d=o.maxScale-l.maxScale;return u===0?d:u}),r[i]=n.map(o=>o.toJSON(s))}write(e,r){return super.write(e,jpe(this,r))}};a([c({type:String,json:{write:{overridePolicy:(t,e,r)=>({enabled:r.filterMode==="manual",isRequired:!0})}}})],Bl.prototype,"activeFilterId",void 0),a([c({type:H.ofType(bo),nonNullable:!0,json:{write:!0}})],Bl.prototype,"filters",void 0),a([q("filters")],Bl.prototype,"writeFilters",null),a([c({type:["manual","scale"],nonNullable:!0,json:{name:"filterMode",write:!0}})],Bl.prototype,"mode",void 0),Bl=a([b("esri.layers.support.DisplayFilterInfo")],Bl);const qpe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.displayFilterEnabled=!0,this.displayFilterInfo=null}};return a([c(Gpe)],r.prototype,"displayFilterEnabled",void 0),a([c(Bpe)],r.prototype,"displayFilterInfo",void 0),r=a([b("esri.layers.mixins.DisplayFilteredLayer")],r),r},Gpe={type:Boolean,json:{name:"layerDefinition.disableDisplayFilter",read:{reader:t=>!t},write:{layerContainerTypes:qe,writer(t,e,r){Bt(r,!t,e)}},origins:{"web-scene":{write:!1,read:!1}}}},Bpe={type:Bl,json:{name:"layerDefinition.displayFilterInfo",write:{enabled:!0,allowNull:!0,layerContainerTypes:qe},origins:{"web-scene":{write:!1,read:!1}}}},Hpe=vJ(),u9=new Map,c9=new Map;async function $Ie(t,e,r){if(!t||!r)return!1;if(!e)return!0;const i=new URL(t).host;let s=u9.get(i);if(!s){const n=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");s=(await Ae(n,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return s===e}async function xIe(t,e,r=!1){if(!t||!e)return!0;const i=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),s=c9.get(i)?.entries();if(s){for(const[n,o]of s)if(o.name===e){const l=!o.stack?.hasForwardEdits();if(!l&&r){const[{deleteForwardEdits:u},{default:d}]=await Promise.all([N(()=>import("./deleteForwardEdits-BquErfsL.js"),[]),N(()=>import("./DeleteForwardEditsParameters-D_KMDOzl.js"),[])]),p=await u(i,n,new d({sessionId:Hpe,moment:o.moment}));return p.success&&o.stack?.clearForwardEdits(),p.success}return l}}return!0}function Wpe(t,e){if(!t)return!1;const r=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),i=c9.get(r)?.entries();if(i){for(const[s,n]of i)if(n.name===e)return n.lockType==="edit"}return!1}const g3=new _L;function Zpe(t){return g3.on("apply-edits",new WeakRef(t))}function Jpe(t){return g3.on("update-moment",new WeakRef(t))}function TIe(t,e,r=null,i=!1){const s=wi();return i=e==null||i,g3.emit("apply-edits",{serviceUrl:t,layerId:e,gdbVersion:r,mayReceiveServiceEdits:i,result:s.promise}),s}const d9=Symbol();function MIe(t){return t!=null&&typeof t=="object"&&d9 in t}function Np(t){return t!=null&&typeof t=="object"&&"gdbVersion"in t}function X1(t,e,r){const i=new URL(t).host,s=u9.get(i),n=o=>!o||o===s;return n(e)&&n(r)||e===r}const Ype=t=>{var s;var e;const r=t;let i=(s=class extends r{constructor(...n){super(...n),this[e]=!0,this._applyEditsHandler=o=>{const{serviceUrl:l,layerId:u,gdbVersion:d,mayReceiveServiceEdits:p,result:f}=o,m=l===this.url,y=u!=null&&this.layerId!=null&&u===this.layerId,g=Np(this),v=Np(this)&&X1(l,d,this.gdbVersion);if(!m||g&&!v||!y&&!p)return;const _=f.then(S=>{if(this.lastEditsEventDate=new Date,y&&(S.addedFeatures.length||S.updatedFeatures.length||S.deletedFeatures.length||S.addedAttachments.length||S.updatedAttachments.length||S.deletedAttachments.length))return this.emit("edits",E(S)),S;const M=S.editedFeatures?.find(({layerId:T})=>T===this.layerId);if(M){const{adds:T,updates:O,deletes:P}=M.editedFeatures,D={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:T?T.map(({attributes:z})=>({objectId:this.objectIdField&&z[this.objectIdField],globalId:this.globalIdField&&z[this.globalIdField]})):[],deletedFeatures:P?P.map(({attributes:z})=>({objectId:this.objectIdField&&z[this.objectIdField],globalId:this.globalIdField&&z[this.globalIdField]})):[],updatedFeatures:O?O.map(({current:{attributes:z}})=>({objectId:this.objectIdField&&z[this.objectIdField],globalId:this.globalIdField&&z[this.globalIdField]})):[],editedFeatures:E(S.editedFeatures),exceededTransferLimit:!1,historicMoment:E(S.historicMoment)};return this.emit("edits",D),D}const C={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:E(S.editedFeatures),exceededTransferLimit:!1,historicMoment:E(S.historicMoment)};return"historicMoment"in this&&this._shouldUpdateHistoricMoment(l,d,C.historicMoment)&&this.emit("edits",C),C}).then(S=>("historicMoment"in this&&this._shouldUpdateHistoricMoment(l,d,S.historicMoment)&&(this.historicMoment=S.historicMoment),S));this.emit("apply-edits",{result:_})},this._updateMomentHandler=o=>{const{serviceUrl:l,gdbVersion:u,moment:d}=o,p=l===this.url,f=Np(this),m=Np(this)&&X1(l,u,this.gdbVersion),y=Np(this)&&!X1(l,this.gdbVersion,null);p&&f&&m&&y&&"historicMoment"in this&&this.historicMoment!==d&&(this.historicMoment=d)},this.when().then(()=>{this.addHandles(Zpe(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(Jpe(this._updateMomentHandler))},()=>{})}_shouldUpdateHistoricMoment(n,o,l){return"historicMoment"in this&&this.historicMoment!==l&&Wpe(n,o)}},e=d9,s);return a([c()],i.prototype,"lastEditsEventDate",void 0),i=a([b("esri.layers.mixins.EditBusLayer")],i),i};var ex;const e_=new $e({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),t_=new $e({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let gn=ex=class extends F{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:r,spatialRelationship:i,timeExtent:s,objectIds:n,units:o,distance:l}=this;return new re({geometry:E(r),objectIds:E(n),spatialRelationship:i,timeExtent:E(s),where:e,units:o,distance:l,...t})}clone(){const{where:t,geometry:e,spatialRelationship:r,timeExtent:i,objectIds:s,units:n,distance:o}=this;return new ex({geometry:E(e),objectIds:E(s),spatialRelationship:r,timeExtent:E(i),where:t,units:n,distance:o})}};a([c({type:String,json:{write:!0}})],gn.prototype,"where",void 0),a([c({types:uy,json:{write:!0}})],gn.prototype,"geometry",void 0),a([c({type:e_.apiValues,json:{name:"spatialRel",read:{reader:e_.read},write:{allowNull:!1,writer:e_.write,overridePolicy(){return{enabled:this.geometry!=null}}}}})],gn.prototype,"spatialRelationship",void 0),a([c({type:Number,json:{write:{overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],gn.prototype,"distance",void 0),a([c({type:[Number],json:{write:!0}})],gn.prototype,"objectIds",void 0),a([c({type:t_.apiValues,json:{read:t_.read,write:{writer:t_.write,overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],gn.prototype,"units",void 0),a([c({type:It,json:{write:!0}})],gn.prototype,"timeExtent",void 0),gn=ex=a([b("esri.layers.support.FeatureFilter")],gn);const Kpe=gn;var tx;const bP={read:{reader:jm},write:{writer:Vm,overridePolicy(){return{allowNull:this.excludedEffect!=null,isRequired:this.excludedEffect==null}}}},_P={read:{reader:jm},write:{writer:Vm,overridePolicy(){return{allowNull:this.includedEffect!=null,isRequired:this.includedEffect==null}}}},SP={name:"showExcludedLabels",default:!0};let Hl=tx=class extends F{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(t,e){const r=super.write(t,e);if(e?.origin){if(r.filter){const i=Object.keys(r.filter);if(i.length>1||i[0]!=="where")return e.messages?.push(new x("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:e.layer,effect:this})),null}if("showExcludedLabels"in r)return e.messages?.push(new x("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:e.layer,effect:this})),null}return r}clone(){return new tx({filter:this.filter!=null?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};a([c({type:Kpe,json:{write:{allowNull:!0,writer(t,e,r,i){const s=t?.write({},i);s&&Object.keys(s).length!==0?Bt(r,s,e):Bt(r,null,e)}}}})],Hl.prototype,"filter",void 0),a([c({json:{read:jm,write:{writer:Vm,allowNull:!0},origins:{"web-map":bP,"portal-item":bP}}})],Hl.prototype,"includedEffect",void 0),a([c({json:{read:jm,write:{writer:Vm,allowNull:!0},origins:{"web-map":_P,"portal-item":_P}}})],Hl.prototype,"excludedEffect",void 0),a([c({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":SP,"portal-item":SP}}})],Hl.prototype,"excludedLabelsVisible",void 0),Hl=tx=a([b("esri.layers.support.FeatureEffect")],Hl);const $P={write:{allowNull:!0}},Qpe={type:Hl,json:{origins:{"web-map":$P,"portal-item":$P}}},Xpe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.featureEffect=null}};return a([c(Qpe)],r.prototype,"featureEffect",void 0),r=a([b("esri.layers.mixins.FeatureEffectLayer")],r),r};var rx;let Sf=rx=class extends F{constructor(t){super(t),this.expression=void 0,this.title=void 0}async collectRequiredFields(t,e){return Lr(t,e,null,this.expression)}clone(){return new rx({expression:this.expression,title:this.title})}equals(t){return this.expression===t.expression&&this.title===t.title}};a([c({type:String,json:{write:{isRequired:!0}}})],Sf.prototype,"expression",void 0),a([c({type:String,json:{write:!0}})],Sf.prototype,"title",void 0),Sf=rx=a([b("esri.symbols.support.FeatureExpressionInfo")],Sf);const xP=Sf,fb={unknown:1,inches:yt(1,"meters","inches"),feet:yt(1,"meters","feet"),"us-feet":yt(1,"meters","us-feet"),yards:yt(1,"meters","yards"),miles:yt(1,"meters","miles"),"nautical-miles":yt(1,"meters","nautical-miles"),millimeters:yt(1,"meters","millimeters"),centimeters:yt(1,"meters","centimeters"),decimeters:yt(1,"meters","decimeters"),meters:yt(1,"meters","meters"),kilometers:yt(1,"meters","kilometers"),"decimal-degrees":1/kB(1,"meters",ct.radius)};function IIe(t){return!!t&&fb[t]!=null}function EIe(t){return 1/(fb[t]||1)}function efe(){const t=Object.keys(fb);return Qx(t,"decimal-degrees"),t.sort(),t}const tfe=efe(),pg=Lt()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),TP=new $e({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let co=class extends pe(F){constructor(e){super(e),this.featureExpressionInfo=void 0,this.offset=null}readFeatureExpressionInfo(e,r){return e!=null?e.expression?e:void 0:r.featureExpression&&r.featureExpression.value===0?{expression:"0"}:void 0}writeFeatureExpressionInfo(e,r,i,s){r[i]=e.write({},s),e.expression==="0"&&(r.featureExpression={value:0})}get mode(){const{offset:e,featureExpressionInfo:r}=this;return this._isOverridden("mode")?this._get("mode"):e!=null||r?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,r){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,r):null}equals(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&l7(this.featureExpressionInfo,e.featureExpressionInfo)}};a([c({type:xP,json:{write:!0}})],co.prototype,"featureExpressionInfo",void 0),a([V("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],co.prototype,"readFeatureExpressionInfo",null),a([q("featureExpressionInfo",{featureExpressionInfo:{type:xP},"featureExpression.value":{type:[0]}})],co.prototype,"writeFeatureExpressionInfo",null),a([c({type:pg.apiValues,nonNullable:!0,json:{type:pg.jsonValues,read:pg.read,write:{writer:pg.write,isRequired:!0}}})],co.prototype,"mode",null),a([c({type:Number,json:{write:!0}})],co.prototype,"offset",void 0),a([c({type:tfe,json:{type:String,read:TP.read,write:TP.write}})],co.prototype,"unit",null),co=a([b("esri.symbols.support.ElevationInfo")],co);let Qc=class extends F{constructor(e){super(e),this.description=null,this.label=null,this.type=null}};a([c({type:String,json:{write:!0}})],Qc.prototype,"description",void 0),a([c({type:String,json:{write:!0}})],Qc.prototype,"label",void 0),a([c()],Qc.prototype,"type",void 0),Qc=a([b("esri.tables.elements.AttributeTableElement")],Qc);const ap=Qc;let $f=class extends pe(ap){constructor(e){super(e),this.displayType="auto",this.type="attachment"}clone(){return super.clone()}};a([c({type:["auto"],json:{write:!0}})],$f.prototype,"displayType",void 0),a([c({type:["attachment"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],$f.prototype,"type",void 0),$f=a([b("esri.tables.elements.AttributeTableAttachmentElement")],$f);const h9=$f;let Wl=class extends pe(ap){constructor(e){super(e),this.description=null,this.fieldName=null,this.label=null,this.type="field"}clone(){return super.clone()}};a([c({type:String,json:{read:!1,write:!1}})],Wl.prototype,"description",void 0),a([c({type:String,json:{write:{enabled:!0,isRequired:!0}}})],Wl.prototype,"fieldName",void 0),a([c({type:String,json:{read:!1,write:!1}})],Wl.prototype,"label",void 0),a([c({type:["field"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],Wl.prototype,"type",void 0),Wl=a([b("esri.tables.elements.AttributeTableFieldElement")],Wl);const p9=Wl;let xf=class extends pe(ap){constructor(e){super(e),this.relationshipId=null,this.type="relationship"}clone(){return super.clone()}};a([c({type:Number,json:{type:xe,write:{enabled:!0,isRequired:!0}}})],xf.prototype,"relationshipId",void 0),a([c({type:["relationship"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],xf.prototype,"type",void 0),xf=a([b("esri.tables.elements.AttributeTableRelationshipElement")],xf);const f9=xf,m9={base:ap,key:"type",typeMap:{attachment:h9,field:p9,relationship:f9}};function rfe(t){return{typesWithGroup:{base:ap,key:"type",typeMap:{attachment:h9,field:p9,group:t,relationship:f9}},typesWithoutGroup:m9}}let Tf=class extends pe(ap){constructor(e){super(e),this.elements=null,this.type="group"}clone(){return super.clone()}};a([c({types:[m9],json:{name:"attributeTableElements",write:!0}})],Tf.prototype,"elements",void 0),a([c({type:["group"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],Tf.prototype,"type",void 0),Tf=a([b("esri.tables.elements.AttributeTableGroupElement")],Tf);const ife=Tf;let Mf=class extends pe(F){constructor(e){super(e),this.field=null,this.order=null}};a([c({type:String,json:{write:!0}})],Mf.prototype,"field",void 0),a([c({type:["asc","desc"],json:{write:!0}})],Mf.prototype,"order",void 0),Mf=a([b("esri.tables.support.FieldOrder")],Mf);const sfe=Mf;var ix;const nfe=rfe(ife);let If=ix=class extends F{constructor(t){super(t),this.elements=null,this.orderByFields=null}clone(){return new ix({elements:E(this.elements),orderByFields:E(this.orderByFields)})}};a([c({types:[nfe.typesWithGroup],json:{name:"attributeTableElements",write:!0}})],If.prototype,"elements",void 0),a([c({type:[sfe],json:{write:!0}})],If.prototype,"orderByFields",void 0),If=ix=a([b("esri.tables.AttributeTableTemplate")],If);const ofe=If,afe={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:qe}}},mb={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,r){e[r]=!t}}}},yb={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:qe}}},lfe={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:Iu}}},ufe={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:qe}}},cfe={value:null,type:co,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:qe}}};function FIe(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const y9={write:{enabled:!0,layerContainerTypes:qe},read:!0},sx={type:Number,json:{origins:{"web-document":y9,"portal-item":{write:{layerContainerTypes:qe}}}}},dfe={...sx,json:{...sx.json,origins:{"web-document":{...y9,write:{enabled:!0,layerContainerTypes:qe,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,r)=>r&&r.origin!=="service"||!e.drawingInfo||e.drawingInfo.transparency===void 0?e.layerDefinition?.drawingInfo&&e.layerDefinition.drawingInfo.transparency!==void 0?_m(e.layerDefinition.drawingInfo.transparency):void 0:_m(e.drawingInfo.transparency)}}},NIe={type:he,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const r=he.fromJSON(t);return e.spatialReference!=null&&typeof e.spatialReference=="object"&&(r.spatialReference=Z.fromJSON(e.spatialReference)),r}}}},read:!1}},hfe={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},pfe={type:Number,json:{origins:{service:{write:{enabled:!1}}},name:"layerDefinition.minScale",write:{layerContainerTypes:qe}}},ffe={type:Number,json:{origins:{service:{write:{enabled:!1}}},name:"layerDefinition.maxScale",write:{layerContainerTypes:qe}}},g9={json:{write:{ignoreOrigin:!0,layerContainerTypes:qe},origins:{"web-map":{read:!1,write:!1}}}},mfe={type:ofe,json:{name:"attributeTableInfo",write:!0}};let ho=class extends pe(F){constructor(e){super(e),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.timeZone=null}};a([c()],ho.prototype,"creatorField",void 0),a([c()],ho.prototype,"creationDateField",void 0),a([c()],ho.prototype,"editorField",void 0),a([c()],ho.prototype,"editDateField",void 0),a([c()],ho.prototype,"realm",void 0),a([c(Mv("dateFieldsTimeReference",!0))],ho.prototype,"timeZone",void 0),ho=a([b("esri.layers.support.EditFieldsInfo")],ho);let _n=class extends pe(F){constructor(e){super(e)}};a([c({constructOnly:!0,json:{write:!0}})],_n.prototype,"name",void 0),a([c({constructOnly:!0,json:{write:!0}})],_n.prototype,"fields",void 0),a([c({constructOnly:!0,json:{write:!0}})],_n.prototype,"isAscending",void 0),a([c({constructOnly:!0,json:{write:!0}})],_n.prototype,"indexType",void 0),a([c({constructOnly:!0,json:{write:!0}})],_n.prototype,"isUnique",void 0),a([c({constructOnly:!0,json:{write:!0}})],_n.prototype,"description",void 0),_n=a([b("esri.layers.support.FeatureIndex")],_n);async function yfe(t,e,r){e=e.clone(),t.capabilities.query.supportsMaxRecordCountFactor&&(e.maxRecordCountFactor=v9(t));const i=gfe(t),s=t.capabilities.query.supportsPagination;e.start=0,e.num=i;let n=null;for(;;){const o=await t.source.queryFeaturesJSON(e,r);if(n==null?n=o:n.features=n.features.concat(o.features),n.exceededTransferLimit=o.exceededTransferLimit,!s||!o.exceededTransferLimit)break;e.start+=i}return n}function gfe(t){return v9(t)*vfe(t)}function vfe(t){return t.capabilities.query.maxRecordCount||2e3}function v9(t){return t.capabilities.query.supportsMaxRecordCountFactor?re.MAX_MAX_RECORD_COUNT_FACTOR:1}var nx;let Ef=nx=class extends F{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new nx({minValue:this.minValue,maxValue:this.maxValue})}};a([c({type:Number,json:{write:!0}})],Ef.prototype,"minValue",void 0),a([c({type:Number,json:{write:!0}})],Ef.prototype,"maxValue",void 0),Ef=nx=a([b("esri.renderers.support.AuthoringInfoClassBreakInfo")],Ef);var ox;let Sa=ox=class extends F{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=new Array}clone(){return new ox({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:E(this.classBreakInfos)})}};a([c({type:String,json:{write:!0}})],Sa.prototype,"field",void 0),a([c({type:String,json:{write:!0}})],Sa.prototype,"normalizationField",void 0),a([c({type:String,json:{write:!0}})],Sa.prototype,"label",void 0),a([c({type:[Ef],json:{write:!0}})],Sa.prototype,"classBreakInfos",void 0),Sa=ox=a([b("esri.renderers.support.AuthoringInfoFieldInfo")],Sa);var ax;let Xc=ax=class extends F{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new ax({label:this.label,value:this.value,size:this.size})}};a([c({type:String,json:{write:!0}})],Xc.prototype,"label",void 0),a([c({type:Number,json:{write:!0}})],Xc.prototype,"size",void 0),a([c({type:Number,json:{write:!0}})],Xc.prototype,"value",void 0),Xc=ax=a([b("esri.renderers.support.AuthoringInfoSizeStop")],Xc);const wfe=Xc;var lx;const fg=new $e({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),mg=new $e({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),MP={key:t=>typeof t=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},IP=["high-to-low","above-and-below","centered-on","extremes"],EP=[...new Set(["high-to-low","above-and-below","centered-on","extremes","above","below","high-to-low","above-and-below","above","below","reference-size","spike"])],OP=["seconds","minutes","hours","days","months","years"],bfe=["circle","diamond","hexagon-flat","hexagon-pointy","square"],_fe=["triangle-closed-outline","triangle-gradient-fill-closed","triangle-gradient-fill-closed-outline","triangle-gradient-fill-open","triangle-gradient-fill-open-outline","triangle-open-outline","triangle-solid-fill-closed","triangle-solid-fill-closed-outline","triangle-solid-fill-open","triangle-solid-fill-open-outline"];let Dt=lx=class extends F{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return typeof t=="string"||typeof t=="number"?t:null}get normalizationField(){return this.theme==="reference-size"||this.theme==="spike"?this._get("normalizationField"):null}set normalizationField(t){this._set("normalizationField",t)}get referenceSizeScale(){return this.theme==="reference-size"?this._get("referenceSizeScale"):null}set referenceSizeScale(t){this._set("referenceSizeScale",t)}get referenceSizeSymbolStyle(){return this.theme==="reference-size"?this._get("referenceSizeSymbolStyle"):null}set referenceSizeSymbolStyle(t){this._set("referenceSizeSymbolStyle",t)}get spikeSymbolStyle(){return this.theme==="spike"?this._get("spikeSymbolStyle"):null}set spikeSymbolStyle(t){this._set("spikeSymbolStyle",t)}castStartTime(t){return typeof t=="string"||typeof t=="number"?t:null}get sizeStops(){return this.theme==="reference-size"||this.theme==="spike"?this._get("sizeStops"):null}set sizeStops(t){this._set("sizeStops",t)}get style(){return this.type==="color"?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new lx({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,normalizationField:this.normalizationField,referenceSizeScale:this.referenceSizeScale,referenceSizeSymbolStyle:this.referenceSizeSymbolStyle,spikeSymbolStyle:this.spikeSymbolStyle,sizeStops:E(this.sizeStops),startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};a([c({types:MP,json:{write:!0}})],Dt.prototype,"endTime",void 0),a([Ce("endTime")],Dt.prototype,"castEndTime",null),a([c({type:String,json:{write:!0}})],Dt.prototype,"field",void 0),a([c({type:Number,json:{write:!0}})],Dt.prototype,"maxSliderValue",void 0),a([c({type:Number,json:{write:!0}})],Dt.prototype,"minSliderValue",void 0),a([c({type:String,json:{origins:{"web-scene":{write:!1}},write:!0}})],Dt.prototype,"normalizationField",null),a([c({type:Number,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],Dt.prototype,"referenceSizeScale",null),a([c({type:bfe,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],Dt.prototype,"referenceSizeSymbolStyle",null),a([c({type:_fe,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],Dt.prototype,"spikeSymbolStyle",null),a([c({types:MP,json:{write:!0}})],Dt.prototype,"startTime",void 0),a([Ce("startTime")],Dt.prototype,"castStartTime",null),a([c({type:[wfe],json:{origins:{"web-scene":{write:!1}},write:!0}})],Dt.prototype,"sizeStops",null),a([c({type:fg.apiValues,value:null,json:{type:fg.jsonValues,read:fg.read,write:fg.write}})],Dt.prototype,"style",null),a([c({type:EP,value:null,json:{type:EP,origins:{"web-scene":{type:IP,write:{writer:(t,e)=>{IP.includes(t)&&(e.theme=t)}}}},write:!0}})],Dt.prototype,"theme",null),a([c({type:mg.apiValues,json:{type:mg.jsonValues,read:mg.read,write:mg.write}})],Dt.prototype,"type",void 0),a([c({type:OP,json:{type:OP,write:!0}})],Dt.prototype,"units",void 0),Dt=lx=a([b("esri.renderers.support.AuthoringInfoVisualVariable")],Dt);const Sfe=Dt;let jd=class extends F{constructor(e){super(e),this.type=null}};a([c({readOnly:!0,json:{read:!1,write:!0}})],jd.prototype,"type",void 0),jd=a([b("esri.rest.support.ColorRamp")],jd);var ux;let Eo=ux=class extends jd{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new ux({fromColor:E(this.fromColor),toColor:E(this.toColor),algorithm:this.algorithm})}};a([se({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],Eo.prototype,"algorithm",void 0),a([c({type:ue,json:{type:[xe],write:{isRequired:!0}}})],Eo.prototype,"fromColor",void 0),a([c({type:ue,json:{type:[xe],write:{isRequired:!0}}})],Eo.prototype,"toColor",void 0),a([c({type:["algorithmic"],json:{write:{isRequired:!0}}})],Eo.prototype,"type",void 0),Eo=ux=a([b("esri.rest.support.AlgorithmicColorRamp")],Eo);var cx;let _o=cx=class extends jd{constructor(t){super(t),this.colorRamps=null,this.type="multipart",this.weights=void 0}writeColorRamps(t,e,r,i){const s=t?.map(o=>o.toJSON(i)),{weights:n}=this;if(s&&n?.length&&s.length===n?.length){const o=100/n.reduce((u,d)=>u+d);let l=0;s.forEach((u,d)=>{u.start=l,l+=n[d]*o,u.stop=l})}e.colorRamps=s}readWeights(t,e){const r=e.colorRamps?.map(({start:i,stop:s})=>i==null||s==null?-1:s-i);if(!r?.some(i=>i<0))return r}clone(){return new cx({colorRamps:E(this.colorRamps)})}};a([c({type:[Eo],json:{write:{isRequired:!0}}})],_o.prototype,"colorRamps",void 0),a([q("colorRamps")],_o.prototype,"writeColorRamps",null),a([c({type:["multipart"],json:{write:{isRequired:!0}}})],_o.prototype,"type",void 0),a([c({type:[Number]})],_o.prototype,"weights",void 0),a([V("weights",["colorRamps"])],_o.prototype,"readWeights",null),_o=cx=a([b("esri.rest.support.MultipartColorRamp")],_o);const $fe={key:"type",base:jd,typeMap:{algorithmic:Eo,multipart:_o}};function xfe(t){return t?.type?t.type==="algorithmic"?Eo.fromJSON(t):t.type==="multipart"?_o.fromJSON(t):null:null}var dx;const Sl=new $e({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),yg=new $e({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),kP=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers"],Tfe=["high-to-low","above-and-below","above","below"],Mfe=["flow-line","wave-front"],Ife=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let et=dx=class extends F{constructor(t){super(t),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&e!=="relationship"?e==="class-breaks-size"||e==="class-breaks-color"?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){return t?xfe(t):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(t){this._set("field2",t)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(t){this._set("flowTheme",t)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&t!=="relationship"&&t!=="class-breaks-size"&&t!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;t==="classed-size"?e="class-breaks-size":t==="classed-color"&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){return new dx({classificationMethod:this.classificationMethod,colorRamp:E(this.colorRamp),fadeRatio:E(this.fadeRatio),fields:this.fields?.slice(),field1:E(this.field1),field2:E(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(t=>t.clone()),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};a([c({type:Sl.apiValues,value:null,json:{type:Sl.jsonValues,read:Sl.read,write:Sl.write,origins:{"web-document":{default:"manual",type:Sl.jsonValues,read:Sl.read,write:Sl.write}}}})],et.prototype,"classificationMethod",null),a([c({types:$fe,json:{write:!0}})],et.prototype,"colorRamp",void 0),a([V("colorRamp")],et.prototype,"readColorRamp",null),a([c({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],et.prototype,"fadeRatio",void 0),a([c({type:[String],value:null,json:{write:!0}})],et.prototype,"fields",null),a([c({type:Sa,value:null,json:{write:!0}})],et.prototype,"field1",null),a([c({type:Sa,value:null,json:{write:!0}})],et.prototype,"field2",null),a([c({type:Mfe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],et.prototype,"flowTheme",null),a([c({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],et.prototype,"focus",null),a([c({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],et.prototype,"isAutoGenerated",void 0),a([c({type:Number,value:null,json:{type:xe,write:!0}})],et.prototype,"numClasses",null),a([c({type:kP,json:{type:kP,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],et.prototype,"lengthUnit",void 0),a([c({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],et.prototype,"maxSliderValue",void 0),a([c({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],et.prototype,"minSliderValue",void 0),a([c({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],et.prototype,"statistics",null),a([c({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],et.prototype,"standardDeviationInterval",null),a([c({type:yg.apiValues,value:null,json:{type:yg.jsonValues,read:yg.read,write:yg.write}})],et.prototype,"type",null),a([c({type:[Sfe],json:{write:!0}})],et.prototype,"visualVariables",void 0),a([c({type:Ife,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],et.prototype,"univariateSymbolStyle",null),a([c({type:Tfe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],et.prototype,"univariateTheme",null),et=dx=a([b("esri.renderers.support.AuthoringInfo")],et);const r_=new $e({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let Di=class extends F{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const r=new Set;return await this.collectRequiredFields(r,e),Array.from(r).sort()}getSymbol(e,r){}async getSymbolAsync(e,r){}get symbols(){return[]}get arcadeRequired(){return!1}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};a([c({type:et,json:{write:!0}})],Di.prototype,"authoringInfo",void 0),a([c({type:r_.apiValues,readOnly:!0,json:{type:r_.jsonValues,read:!1,write:{writer:r_.write,ignoreOrigin:!0,isRequired:!0}}})],Di.prototype,"type",void 0),Di=a([b("esri.renderers.Renderer")],Di);let Of=class extends pe(F){constructor(){super(...arguments),this.showLegend=null,this.title=null}};a([c({type:Boolean,json:{write:!0}})],Of.prototype,"showLegend",void 0),a([c({type:String,json:{write:!0}})],Of.prototype,"title",void 0),Of=a([b("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],Of);const w9=Of,i_=new $e({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let Sr=class extends F{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return e==null?e:typeof e=="function"?(L.getLogger(this).error(".field: field must be a string value"),null):Km(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};a([c()],Sr.prototype,"index",void 0),a([c({type:i_.apiValues,readOnly:!0,json:{read:i_.read,write:{writer:i_.write,isRequired:!0}}})],Sr.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],Sr.prototype,"field",void 0),a([Ce("field")],Sr.prototype,"castField",null),a([c({type:String,json:{write:!0}})],Sr.prototype,"valueExpression",void 0),a([c({type:String,json:{write:!0}})],Sr.prototype,"valueExpressionTitle",void 0),a([c({readOnly:!0})],Sr.prototype,"arcadeRequired",null),a([c({type:w9,json:{write:!0}})],Sr.prototype,"legendOptions",void 0),Sr=a([b("esri.renderers.visualVariables.VisualVariable")],Sr);var hx;let Zl=hx=class extends F{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,r){e[r]=t??0}clone(){return new hx({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};a([c({type:ue,json:{type:[xe],write:{isRequired:!0}}})],Zl.prototype,"color",void 0),a([c({type:String,json:{write:!0}})],Zl.prototype,"label",void 0),a([c({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],Zl.prototype,"value",void 0),a([q("value")],Zl.prototype,"writeValue",null),Zl=hx=a([b("esri.renderers.visualVariables.support.ColorStop")],Zl);const Efe=Zl;var px;let $a=px=class extends Sr{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,r)=>e.value-r.value),this._set("stops",t)}clone(){return new px({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(t=>t.clone()),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};a([c({readOnly:!0})],$a.prototype,"cache",null),a([c({type:["color"],json:{type:["colorInfo"]}})],$a.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],$a.prototype,"normalizationField",void 0),a([c({type:[Efe],json:{write:!0}})],$a.prototype,"stops",null),$a=px=a([b("esri.renderers.visualVariables.ColorVariable")],$a);var fx;let ma=fx=class extends F{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return _m(e.transparency)}writeOpacity(t,e,r){e[r]=Nw(t)}clone(){return new fx({label:this.label,opacity:this.opacity,value:this.value})}};a([c({type:String,json:{write:!0}})],ma.prototype,"label",void 0),a([c({type:Number,json:{type:xe,write:{target:"transparency",isRequired:!0}}})],ma.prototype,"opacity",void 0),a([V("opacity",["transparency"])],ma.prototype,"readOpacity",null),a([q("opacity")],ma.prototype,"writeOpacity",null),a([c({type:Number,json:{write:{isRequired:!0}}})],ma.prototype,"value",void 0),ma=fx=a([b("esri.renderers.visualVariables.support.OpacityStop")],ma);const Ofe=ma;var mx;let Oo=mx=class extends Sr{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,r)=>e.value-r.value),this._set("stops",t)}clone(){return new mx({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(t=>t.clone()),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};a([c({readOnly:!0})],Oo.prototype,"cache",null),a([c({type:["opacity"],json:{type:["transparencyInfo"]}})],Oo.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],Oo.prototype,"normalizationField",void 0),a([c({type:[Ofe],json:{write:!0}})],Oo.prototype,"stops",null),Oo=mx=a([b("esri.renderers.visualVariables.OpacityVariable")],Oo);var yx;let xa=yx=class extends Sr{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic"}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}clone(){return new yx({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions?.clone()})}};a([c({readOnly:!0})],xa.prototype,"cache",null),a([c({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],xa.prototype,"axis",void 0),a([c({type:["rotation"],json:{type:["rotationInfo"]}})],xa.prototype,"type",void 0),a([c({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],xa.prototype,"rotationType",void 0),xa=yx=a([b("esri.renderers.visualVariables.RotationVariable")],xa);function kfe(t){return Me(t)}var gx;let Bs=gx=class extends F{constructor(t){super(t),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new gx({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};a([c({type:String,json:{write:!0}})],Bs.prototype,"label",void 0),a([c({type:Number,cast:Me,json:{write:{isRequired:!0}}})],Bs.prototype,"size",void 0),a([c({type:Number,json:{write:{isRequired:!0}}})],Bs.prototype,"value",void 0),a([c({type:Boolean,json:{write:!1}})],Bs.prototype,"useMinValue",void 0),a([c({type:Boolean,json:{write:!1}})],Bs.prototype,"useMaxValue",void 0),Bs=gx=a([b("esri.renderers.visualVariables.support.SizeStop")],Bs);let D0=class extends w9{constructor(){super(...arguments),this.customValues=null}};a([c({type:[Number],json:{write:!0}})],D0.prototype,"customValues",void 0),D0=a([b("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],D0);const Cfe=D0;function wd(t){return t&&t.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function Vu(t){return t!=null&&!isNaN(t)&&isFinite(t)}function b9(t){return t.valueExpression?"expression":t.field&&typeof t.field=="string"?"field":"unknown"}function Pfe(t,e){const r=e||b9(t),i=t.valueUnit||"unknown";return r==="unknown"?"constant":t.stops?"stops":t.minSize!=null&&t.maxSize!=null&&t.minDataValue!=null&&t.maxDataValue!=null?"clamped-linear":i==="unknown"?t.minSize!=null&&t.minDataValue!=null?t.minSize&&t.minDataValue?"proportional":"additive":"identity":"real-world-size"}const _9=()=>L.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),gb=t=>_9().warn(`The visualVariable should be an instance of esri.renderers.visualVariables.${t}`),vb=()=>_9().error("Use of arcade expressions requires an arcade context"),CP=new st,j0=Math.PI,S9=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function $9(t,e,r){const i="visualVariables"in t?t.visualVariables?.find(g=>g.type==="color"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void gb("ColorVariable");const s=typeof e=="number",n=s?null:e,o=n?.attributes;let l=s?e:null;const u=i.field,{ipData:d,hasExpression:p}=i.cache;let f=i.cache.compiledFunc;if(!u&&!p){const g=i.stops;return g&&g[0]&&g[0].color}if(typeof l!="number")if(p){if(r?.arcade==null)return void vb();const g={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,_=v.getViewInfo(g),S=v.createExecContext(n,_,r.timeZone);if(!f){const M=v.createSyntaxTree(i.valueExpression);f=v.createFunction(M),i.cache.compiledFunc=f}l=v.executeFunction(f,S)}else o&&(l=o[u]);const m=i.normalizationField,y=o!=null&&m!=null?parseFloat(o[m]):void 0;if(l!=null&&(!m||s||!isNaN(y)&&y!==0)){Vu(y)&&!s&&(l/=y);const g=v3(l,d);if(g){const v=g[0],_=g[1],S=v===_?i.stops[v].color:ue.blendColors(i.stops[v].color,i.stops[_].color,g[2],r?.color);return new ue(S)}}}function x9(t,e,r){const i="visualVariables"in t?t.visualVariables?.find(g=>g.type==="opacity"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void gb("OpacityVariable");const s=typeof e=="number",n=s?null:e,o=n?.attributes;let l=s?e:null;const u=i.field,{ipData:d,hasExpression:p}=i.cache;let f=i.cache.compiledFunc;if(!u&&!p){const g=i.stops;return g&&g[0]&&g[0].opacity}if(typeof l!="number")if(p){if(r?.arcade==null)return void vb();const g={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,_=v.getViewInfo(g),S=v.createExecContext(n,_,r.timeZone);if(!f){const M=v.createSyntaxTree(i.valueExpression);f=v.createFunction(M),i.cache.compiledFunc=f}l=v.executeFunction(f,S)}else o&&(l=o[u]);const m=i.normalizationField,y=o!=null&&m!=null?parseFloat(o[m]):void 0;if(l!=null&&(!m||s||!isNaN(y)&&y!==0)){Vu(y)&&!s&&(l/=y);const g=v3(l,d);if(g){const v=g[0],_=g[1];if(v===_)return i.stops[v].opacity;{const S=i.stops[v].opacity;return S+(i.stops[_].opacity-S)*g[2]}}}}function T9(t,e,r){const i="visualVariables"in t?t.visualVariables?.find(y=>y.type==="rotation"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void gb("RotationVariable");const s=i.axis||"heading",n=s==="heading"&&i.rotationType==="arithmetic"?90:0,o=s==="heading"&&i.rotationType==="arithmetic"?-1:1,l=typeof e=="number"?null:e,u=l?.attributes,d=i.field,{hasExpression:p}=i.cache;let f=i.cache.compiledFunc,m=null;if(!d&&!p)return m;if(p){if(r?.arcade==null)return void vb();const y={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},g=r.arcade.arcadeUtils,v=g.getViewInfo(y),_=g.createExecContext(l,v,r.timeZone);if(!f){const S=g.createSyntaxTree(i.valueExpression);f=g.createFunction(S),i.cache.compiledFunc=f}m=g.executeFunction(f,_)}else u&&(m=u[d]);return m=typeof m!="number"||isNaN(m)?null:n+o*m,m}function Afe(t,e,r){const i=typeof e=="number",s=i?null:e,n=s?.attributes;let o=i?e:null;const{isScaleDriven:l}=t.cache;let u=t.cache.compiledFunc;if(l){const p=r?.scale,f=r?.view;o=p==null||f==="3d"?Rfe(t):p}else if(!i)switch(t.inputValueType){case"expression":{if(r?.arcade==null)return void vb();const p={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},f=r.arcade.arcadeUtils,m=f.getViewInfo(p),y=f.createExecContext(s,m,r.timeZone);if(!u){const g=f.createSyntaxTree(t.valueExpression);u=f.createFunction(g),t.cache.compiledFunc=u}o=f.executeFunction(u,y);break}case"field":n&&(o=n[t.field]);break;case"unknown":o=null}if(!Vu(o))return null;if(i||!t.normalizationField)return o;const d=n?parseFloat(n[t.normalizationField]):null;return Vu(d)&&d!==0?o/d:null}function Rfe(t){let e=null,r=null;const i=t.stops;return i?(e=i[0].value,r=i[i.length-1].value):(e=t.minDataValue||0,r=t.maxDataValue||0),(e+r)/2}function wb(t,e,r){const i="visualVariables"in t?t.visualVariables?.find(n=>n.type==="size"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void gb("SizeVariable");const s=I9(Afe(i,e,r),i,e,r,i.cache.ipData);return s==null||isNaN(s)?void 0:s}function vi(t,e,r){return t==null?null:wd(t)?wb(t,e,r):Vu(t)?t:null}function M9(t,e,r){return Vu(r)&&t>r?r:Vu(e)&&t<e?e:t}function Lfe(t,e,r,i){const s=vi(e.minSize,r,i)||e.minDataValue;return t==null&&s==null?null:(t??0)+(s??0)}function Ffe(t,e,r){const i=t.stops;let s=i?.length&&i[0].size;return s==null&&(s=t.minSize),vi(s,e,r)}function Nfe(t,e,r,i){const s=vi(e.minSize,r,i);if(t==null)return s;const{minDataValue:n,maxDataValue:o}=e;if(n==null||o==null)return null;const l=(t-n)/(o-n),u=vi(e.maxSize,r,i),d=i?.shape;if(t<=n)return s;if(t>=o)return u;if(s==null||u==null)return null;if(e.scaleBy==="area"&&d){const p=d==="circle",f=p?j0*(s/2)**2:s*s,m=f+l*((p?j0*(u/2)**2:u*u)-f);return p?2*Math.sqrt(m/j0):Math.sqrt(m)}return s+l*(u-s)}function Dfe(t,e,r,i){const s=vi(e.minSize,r,i);if(t==null||s==null)return s;const n=i?.shape,{minDataValue:o}=e;if(o==null)return null;const l=t/o,u=vi(e.maxSize,r,i);let d=null;return d=n==="circle"?2*Math.sqrt(l*(s/2)**2):n==="square"||n==="diamond"||n==="image"?Math.sqrt(l*s**2):l*s,M9(d,s,u)}function jfe(t,e,r,i,s){if(t==null)return null;const[n,o,l]=v3(t,s);if(n===o)return vi(e.stops?.[n].size,r,i);{const u=vi(e.stops?.[n].size,r,i),d=vi(e.stops?.[o].size,r,i);return u==null||d==null?null:u+(d-u)*l}}function Vfe(t,e,r,i){const s=(i?.resolution??1)*fb[e.valueUnit],n=vi(e.minSize,r,i),o=vi(e.maxSize,r,i),{valueRepresentation:l}=e;if(t==null)return n;let u=null;return u=l==="area"?2*Math.sqrt(t/j0)/s:l==="radius"||l==="distance"?2*t/s:t/s,M9(u,n,o)}function I9(t,e,r,i,s){switch(e.transformationType){case"additive":return Lfe(t,e,r,i);case"constant":return Ffe(e,r,i);case"clamped-linear":return Nfe(t,e,r,i);case"proportional":return Dfe(t,e,r,i);case"stops":return jfe(t,e,r,i,s);case"real-world-size":return Vfe(t,e,r,i);case"identity":return t;case"unknown":return null}}function zfe(t,e,r){const{isScaleDriven:i}=t.cache;if(!(i&&r==="3d"||e))return null;const s={scale:e,view:r};let n=vi(t.minSize,CP,s),o=vi(t.maxSize,CP,s);if(n!=null||o!=null){if(n>o){const l=o;o=n,n=l}return{minSize:n,maxSize:o}}}function Ufe(t,e,r){if(!t.visualVariables)return;const i=[],s=[],n=[],o=[],l=[];for(const u of t.visualVariables)switch(u.type){case"color":s.push(u);break;case"opacity":n.push(u);break;case"rotation":l.push(u);break;case"size":o.push(u)}return s.forEach(u=>{const d=$9(u,e,r);i.push({variable:u,value:d})}),n.forEach(u=>{const d=x9(u,e,r);i.push({variable:u,value:d})}),l.forEach(u=>{const d=T9(u,e,r);i.push({variable:u,value:d})}),o.forEach(u=>{const d=wb(u,e,r);i.push({variable:u,value:d})}),i}function v3(t,e){if(!e)return;let r=0,i=e.length-1;return e.some((s,n)=>t<s?(i=n,!0):(r=n,!1)),[r,i,(t-e[r])/(e[i]-e[r])]}function qfe(t,e,r){const i=["proportional","proportional","proportional"];for(const s of t){const n=s.useSymbolValue?"symbol-value":wb(s,e,r)??"proportional";switch(s.axis){case"width":i[0]=n;break;case"depth":i[1]=n;break;case"height":i[2]=n;break;case"width-and-depth":i[0]=n,i[1]=n;break;case"all":case void 0:case null:i[0]=n,i[1]=n,i[2]=n;break;default:s.axis}}return i}const BIe=Object.freeze(Object.defineProperty({__proto__:null,getAllSizes:qfe,getColor:$9,getOpacity:x9,getRotationAngle:T9,getSize:wb,getSizeForValue:I9,getSizeFromNumberOrVariable:vi,getSizeRangeAtScale:zfe,getVisualVariableValues:Ufe,viewScaleRE:S9},Symbol.toStringTag,{value:"Module"}));var vx;const gg=new $e({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),wx=new $e({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});function PP(t){if(t!=null)return typeof t=="string"||typeof t=="number"?kfe(t):t.type==="size"?wd(t)?t:(delete(t={...t}).type,new Ee(t)):void 0}function AP(t,e,r){if(typeof t!="object")return t;const i=new Ee;return i.read(t,r),i}let Ee=vx=class extends Sr{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&S9.test(this.valueExpression)}}set index(t){wd(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),wd(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return b9(this)}set maxDataValue(t){t&&this.stops&&(L.getLogger(this).warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(L.getLogger(this).warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return PP(t)}readMaxSize(t,e,r){return AP(t,e,r)}set minDataValue(t){t&&this.stops&&(L.getLogger(this).warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(L.getLogger(this).warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return PP(t)}readMinSize(t,e,r){return AP(t,e,r)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(t){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,r)=>e.value-r.value):t&&(L.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return Pfe(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,r,i){if(t==="$view.scale"){if(i?.messages){const s=this.index,n=typeof s=="string"?s:`visualVariables[${s}]`;i.messages.push(new x("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:n+".valueExpression",context:i}))}}else e[r]=t}readValueUnit(t){return t?wx.read(t):null}clone(){return new vx({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:wd(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:wd(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops?.map(t=>t.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions?.clone()})}flipSizes(){if(this.transformationType==="clamped-linear"){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if(this.transformationType==="stops"){const t=this.stops;if(!t)return this;const e=t.map(i=>i.size).reverse(),r=t.length;for(let i=0;i<r;i++)t[i].size=e[i];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops?.map(t=>t.value||0)}};a([c({readOnly:!0})],Ee.prototype,"cache",null),a([c({type:gg.apiValues,json:{type:gg.jsonValues,origins:{"web-map":{read:!1}},read:gg.read,write:gg.write}})],Ee.prototype,"axis",void 0),a([c()],Ee.prototype,"index",null),a([c({type:String,readOnly:!0})],Ee.prototype,"inputValueType",null),a([c({type:Cfe,json:{write:!0}})],Ee.prototype,"legendOptions",void 0),a([c({type:Number,value:null,json:{write:!0}})],Ee.prototype,"maxDataValue",null),a([c({type:Number,value:null,json:{write:!0}})],Ee.prototype,"maxSize",null),a([Ce("maxSize")],Ee.prototype,"castMaxSize",null),a([V("maxSize")],Ee.prototype,"readMaxSize",null),a([c({type:Number,value:null,json:{write:!0}})],Ee.prototype,"minDataValue",null),a([c({type:Number,value:null,json:{write:!0}})],Ee.prototype,"minSize",null),a([Ce("minSize")],Ee.prototype,"castMinSize",null),a([V("minSize")],Ee.prototype,"readMinSize",null),a([c({type:String,json:{write:!0}})],Ee.prototype,"normalizationField",void 0),a([c({readOnly:!0})],Ee.prototype,"arcadeRequired",null),a([c({type:String})],Ee.prototype,"scaleBy",void 0),a([c({type:[Bs],value:null,json:{write:!0}})],Ee.prototype,"stops",null),a([c({type:["outline"],json:{write:!0}})],Ee.prototype,"target",void 0),a([c({type:String,readOnly:!0})],Ee.prototype,"transformationType",null),a([c({type:["size"],json:{type:["sizeInfo"]}})],Ee.prototype,"type",void 0),a([c({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],Ee.prototype,"useSymbolValue",void 0),a([c({type:String,json:{write:!0}})],Ee.prototype,"valueExpression",void 0),a([V("valueExpression",["valueExpression","expression"])],Ee.prototype,"readValueExpression",null),a([q("web-scene","valueExpression")],Ee.prototype,"writeValueExpressionWebScene",null),a([c({type:["radius","diameter","area","width","distance"],json:{write:!0}})],Ee.prototype,"valueRepresentation",void 0),a([c({type:wx.apiValues,json:{write:wx.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],Ee.prototype,"valueUnit",void 0),a([V("valueUnit")],Ee.prototype,"readValueUnit",null),Ee=vx=a([b("esri.renderers.visualVariables.SizeVariable")],Ee);const Gfe={color:$a,size:Ee,opacity:Oo,rotation:xa},Bfe=new $e({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),Hfe=/^\[([^\]]+)\]$/i;let V0=class extends X{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),e=e?.filter(r=>!!r),e?.length){for(const r of e)switch(r.type){case"color":this.colorVariables.push(r);break;case"opacity":this.opacityVariables.push(r);break;case"rotation":this.rotationVariables.push(r);break;case"size":this.sizeVariables.push(r)}this.sizeVariables.length&&this.sizeVariables.some(r=>!!r.target)&&e.sort((r,i)=>{let s=null;return s=r.target===i.target?0:r.target?1:-1,s});for(let r=0;r<e.length;r++)e[r].index=r;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,r,i){const{rotationExpression:s,rotationType:n}=r,o=s?.match(Hfe),l=o?.[1];if(l&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:n,field:l})),e)return e.map(u=>{const d=Bfe.read(u.type),p=Gfe[d];p||(L.getLogger(this).warn(`Unknown variable type: ${d}`),i?.messages&&i.messages.push(new Ui("visual-variable:unsupported",`visualVariable of type '${d}' is not supported`,{definition:u,context:i})));const f=new p;return f.read(u,i),f})}writeVariables(e,r){const i=[];for(const s of e){const n=s.toJSON(r);n&&i.push(n)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};a([c()],V0.prototype,"visualVariables",null),V0=a([b("esri.renderers.visualVariables.VisualVariableFactory")],V0);const Wfe={base:Sr,key:"type",typeMap:{opacity:Oo,color:$a,rotation:xa,size:Ee}},lp=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this._vvFactory=new V0}set visualVariables(i){this._vvFactory.visualVariables=i,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(i,s,n){return this._vvFactory.readVariables(i,s,n)}writeVisualVariables(i,s,n,o){s[n]=this._vvFactory.writeVariables(i,o)}get arcadeRequiredForVisualVariables(){return this.visualVariables?.some(({arcadeRequired:i})=>i)??!1}hasVisualVariables(i,s){return i?this.getVisualVariablesForType(i,s).length>0:this.getVisualVariablesForType("size",s).length>0||this.getVisualVariablesForType("color",s).length>0||this.getVisualVariablesForType("opacity",s).length>0||this.getVisualVariablesForType("rotation",s).length>0}getVisualVariablesForType(i,s){return this.visualVariables?.filter(n=>n.type===i&&(typeof s=="string"?n.target===s:s!==!1||!n.target))??[]}async collectVVRequiredFields(i,s){let n=[];this.visualVariables&&(n=n.concat(this.visualVariables));for(const o of n)o&&(o.field&&Ar(i,s,o.field),o.normalizationField&&Ar(i,s,o.normalizationField),o.valueExpression&&(Zfe(o.valueExpression,i,s)||await Lr(i,s,null,o.valueExpression)))}};return a([c({types:[Wfe],value:null,json:{write:!0}})],r.prototype,"visualVariables",null),a([V("visualVariables",["visualVariables","rotationType","rotationExpression"])],r.prototype,"readVisualVariables",null),a([q("visualVariables")],r.prototype,"writeVisualVariables",null),r=a([b("esri.renderers.mixins.VisualVariablesMixin")],r),r};function Zfe(t,e,r){const i=ere(t);return i!=null&&(Ar(e,r,i),!0)}const w3=[252,146,31,255],Jfe=[153,153,153,255],Yfe={type:"esriSMS",style:"esriSMSCircle",size:6,color:w3,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},Kfe={type:"esriSLS",style:"esriSLSSolid",width:.75,color:w3},Qfe={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},Xfe={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},eme={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},tme={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},rme={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null},iw=qt.fromJSON(Yfe),b3=wt.fromJSON(Kfe),E9=pi.fromJSON(Qfe),ime=Le.fromJSON(Xfe);function WIe(t){if(t==null)return null;switch(t.type){case"mesh":return null;case"point":case"multipoint":return iw;case"polyline":return b3;case"polygon":case"extent":return E9}return null}const ZIe=qt.fromJSON(eme),JIe=wt.fromJSON(tme),YIe=pi.fromJSON(rme),sme=Hr.fromSimpleMarkerSymbol(iw),nme=Xs.fromSimpleLineSymbol(b3),ome=ds.fromSimpleFillSymbol(E9),ame=new Po({symbolLayers:new H([new qr({material:{color:w3},edges:new B4({size:gs(1),color:new ue(Jfe)})})])}),lme=new Xs({symbolLayers:new H([new Ur({material:{color:new ue([0,0,0])},size:gs(1)})])}),ume=new ds({symbolLayers:new H([new qr({outline:{color:new ue([0,0,0]),size:gs(1)}})])});function KIe(t){if(t==null)return null;switch(t.type){case"mesh":return ame;case"point":case"multipoint":return sme;case"polyline":return nme;case"polygon":case"extent":return ome}return null}const RP="#useCIMFallbackSymbology()",hc={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function cme(t,e=hc){if(!t)return{symbol:null};const{retainId:r=hc.retainId,ignoreDrivers:i=hc.ignoreDrivers,hasLabelingContext:s=hc.hasLabelingContext,retainCIM:n=hc.retainCIM,cimFallbackEnabled:o=hc.cimFallbackEnabled}=e;let l=null;if(hj(t))l=t.clone();else if(t.type==="web-style")l=t.clone();else if(t.type==="cim"){const u=t.data?.symbol?.type;switch(u){case"CIMPointSymbol":l=n?t.clone():Hr.fromCIMSymbol(t);break;case"CIMLineSymbol":o&&(l=lme.clone(),e?.logWarning?.(RP,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":o&&(l=ume.clone(),e?.logWarning?.(RP,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!l)return{error:new x("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${u||"unknown"}' is unsupported in 3D`,{symbol:t})}}else if(t instanceof wt)l=Xs.fromSimpleLineSymbol(t);else if(t instanceof qt)l=Hr.fromSimpleMarkerSymbol(t);else if(t instanceof _r)l=Hr.fromPictureMarkerSymbol(t);else if(t instanceof pi)l=e.geometryType&&e.geometryType==="mesh"?Po.fromSimpleFillSymbol(t):ds.fromSimpleFillSymbol(t);else{if(!(t instanceof Le))return{error:new x("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};l=s?Us.fromTextSymbol(t):Hr.fromTextSymbol(t)}return r&&l&&l.type!=="cim"&&(l.id=t.id),!i||l.type==="cim"||l instanceof dr||l.symbolLayers.forEach(u=>u.ignoreDrivers=!0),{symbol:l}}function sw(t,e,r,i){const s=O9(t,{},{context:i,isLabelSymbol:!1});s!=null&&Bt(r,s,e)}function LP(t,e,r,i){const s=O9(t,{},{context:i,isLabelSymbol:!0});s!=null&&(e[r]=s)}function FP(t){return hj(t)||t instanceof dr}function dme(t){return t?.type==="polygon-3d"||t?.type==="line-3d"}function O9(t,e,r){if(t==null)return null;const{context:i,isLabelSymbol:s}=r,n=i?.origin,o=i?.messages;if(n==="web-scene"&&!FP(t)){const l=cme(t,{retainCIM:!0,hasLabelingContext:s});return l.symbol!=null?l.symbol.write(e,i):(o?.push(new x("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:i,error:l.error})),null)}return nS(i?.layer)&&dme(t)?(o?.push(new x("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported on layers of type '${i?.layer?.declaredClass}'.`,{symbol:t,context:i})),null):(n==="web-map"||n==="portal-item"&&!nS(i?.layer))&&FP(t)?(o?.push(new x("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:t,context:i})),null):t.write(e,i)}function QIe(t,e){return Kie(t,null,e)}const bb={types:pj,json:{write:{writer:sw},origins:{"web-scene":{types:nk,write:{writer:sw},read:{reader:Wh({types:nk})}}}}},_3=iT({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},bb),S3={types:{base:_t,key:"type",typeMap:{"simple-fill":Fa.typeMap["simple-fill"],"picture-fill":Fa.typeMap["picture-fill"],"polygon-3d":Fa.typeMap["polygon-3d"],cim:Fa.typeMap.cim}},json:{write:{writer:sw},origins:{"web-scene":{type:ds,write:{writer:sw}}}}},z0={cast:t=>t==null||typeof t=="string"||typeof t=="number"?t:`${t}`,json:{type:String,write:{writer:(t,e)=>{e.value=t?.toString()}}}};var bx;let Wr=bx=class extends lp(Di){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.symbols.map(r=>r.collectRequiredFields(t,e)))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}get symbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){return this.symbols.reduce((t,e)=>t+JSON.stringify(e),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new bx({description:this.description,label:this.label,symbol:E(this.symbol),visualVariables:E(this.visualVariables),authoringInfo:E(this.authoringInfo)})}};a([c({type:String,json:{write:!0}})],Wr.prototype,"description",void 0),a([c({type:String,json:{write:!0}})],Wr.prototype,"label",void 0),a([c(_3)],Wr.prototype,"symbol",void 0),a([se({simple:"simple"})],Wr.prototype,"type",void 0),Wr=bx=a([b("esri.renderers.SimpleRenderer")],Wr);const hme=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function _x(t){return t instanceof X}function NP(t){return t instanceof H?Object.keys(t.items):_x(t)?Qr(t).keys():t?Object.keys(t):[]}function vg(t,e){return t instanceof H?t.items[e]:t[e]}function pme(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function um(t){return t?t.declaredClass:null}function k9(t,e){const r=t.diff;if(r&&typeof r=="function")return r(t,e);const i=NP(t),s=NP(e);if(i.length===0&&s.length===0)return;if(!i.length||!s.length||pme(t,e))return{type:"complete",oldValue:t,newValue:e};const n=s.filter(f=>!i.includes(f)),o=i.filter(f=>!s.includes(f)),l=i.filter(f=>s.includes(f)&&vg(t,f)!==vg(e,f)).concat(n,o).sort(),u=um(t);if(u&&hme.has(u)&&l.length)return{type:"complete",oldValue:t,newValue:e};let d;const p=_x(t)&&_x(e);for(const f of l){const m=vg(t,f),y=vg(e,f);let g;if((p||typeof m!="function"&&typeof y!="function")&&m!==y&&(m!=null||y!=null)){if(r&&r[f]&&typeof r[f]=="function")g=r[f]?.(m,y);else if(m instanceof Date&&y instanceof Date){if(m.getTime()===y.getTime())continue;g={type:"complete",oldValue:m,newValue:y}}else g=typeof m=="object"&&typeof y=="object"&&um(m)===um(y)?k9(m,y):{type:"complete",oldValue:m,newValue:y};g!=null&&(d!=null?d.diff[f]=g:d={type:"partial",diff:{[f]:g}})}}return d}function XIe(t,e){if(t==null)return!1;const r=e.split(".");let i=t;for(const s of r){if(i.type==="complete")return!0;if(i.type!=="partial")return!1;{const n=i.diff[s];if(!n)return!1;i=n}}return!0}function fme(t,e){if(typeof t!="function"&&typeof e!="function"&&(t!=null||e!=null))return t==null||e==null||typeof t=="object"&&typeof e=="object"&&um(t)!==um(e)?{type:"complete",oldValue:t,newValue:e}:k9(t,e)}function wg(t){if(t==null)return!0;switch(t.type){case"complete":return!1;case"collection":{const e=t;for(const r of e.added)if(!wg(r))return!1;for(const r of e.removed)if(!wg(r))return!1;for(const r of e.changed)if(!wg(r))return!1;return!0}case"partial":for(const e in t.diff)if(!wg(t.diff[e]))return!1;return!0}}var Sx;const mme=Lt()({ascendingValues:"ascending-values",descendingValues:"descending-values"});let kf=Sx=class extends pe(F){static from(t){return Hh(Sx,t)}constructor(t){super(t),this.title=null,this.order=null}};a([c({type:String,json:{write:!0}})],kf.prototype,"title",void 0),a([se(mme)],kf.prototype,"order",void 0),kf=Sx=a([b("esri.renderers.support.RendererLegendOptions")],kf);const $3=kf;let Js=class extends pe(F){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};a([c(z0)],Js.prototype,"value",void 0),a([c(z0)],Js.prototype,"value2",void 0),a([c(z0)],Js.prototype,"value3",void 0),Js=a([b("esri.renderers.support.UniqueValue")],Js);let So=class extends pe(F){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(e==null)return null;const r=typeof(e=Array.isArray(e)?e:[e])[0];return r==="string"||r==="number"?e.map(i=>new Js({value:i})):r==="object"?e[0]instanceof Js?e:e.map(i=>new Js(i)):null}};a([c({type:String,json:{write:!0}})],So.prototype,"description",void 0),a([c({type:String,json:{write:!0}})],So.prototype,"label",void 0),a([c(bb)],So.prototype,"symbol",void 0),a([c({type:[Js],json:{type:[[String]],read:{reader:t=>t?t.map(e=>new Js({value:e[0],value2:e[1],value3:e[2]})):null},write:{writer:(t,e)=>{const r=[];for(const i of t){const s=[i.value,i.value2,i.value3].filter(hs).map(n=>n.toString());r.push(s)}e.values=r}}}})],So.prototype,"values",void 0),a([Ce("values")],So.prototype,"castValues",null),So=a([b("esri.renderers.support.UniqueValueClass")],So);let uu=class extends pe(F){constructor(e){super(e),this.heading=null,this.classes=null}};a([c({type:String,json:{write:!0}})],uu.prototype,"heading",void 0),a([c({type:[So],json:{write:{isRequired:!0}}})],uu.prototype,"classes",void 0),uu=a([b("esri.renderers.support.UniqueValueGroup")],uu);var $x;let Ws=$x=class extends F{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new $x({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol?.toJSON());return`${this.value}.${t}`}};a([c({type:String,json:{write:!0}})],Ws.prototype,"description",void 0),a([c({type:String,json:{write:!0}})],Ws.prototype,"label",void 0),a([c(_3)],Ws.prototype,"symbol",void 0),a([c(z0)],Ws.prototype,"value",void 0),Ws=$x=a([b("esri.renderers.support.UniqueValueInfo")],Ws);const DP=new Map;async function yme(t,e){try{return{data:(await bme(t,e)).data,baseUrl:HU(t),styleUrl:t}}catch(r){return Mn(r),null}}function gme(t,e,r){const i=e.portal!=null?e.portal:j.getDefault();let s;const n=`${i.url} - ${i.user?.username} - ${t}`,o=DP.get(n);if(o)return o;const l=vme(t,i,r).then(u=>(s=u,u.fetchData())).then(u=>({data:u,baseUrl:s.itemUrl??"",styleName:t}));return DP.set(n,l),l}function vme(t,e,r){return e.load(r).then(()=>{const i=new gt({disableExtraQuery:!0,query:`owner:${jP} AND type:${VP} AND typekeywords:"${t}"`});return e.queryItems(i,r)}).then(({results:i})=>{let s=null;const n=t.toLowerCase();if(i&&Array.isArray(i)){for(const o of i)if(o.typeKeywords?.some(u=>u.toLowerCase()===n)&&o.type===VP&&o.owner===jP){s=o;break}}if(!s)throw new x("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return s.load(r)})}function wme(t,e,r){return t?.styleUrl!=null?yme(t.styleUrl,r):t?.styleName!=null?gme(t.styleName,e,r):Promise.reject(new x("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function iEe(t){return t===null||t.type==="CIMSymbolReference"?t:{type:"CIMSymbolReference",symbol:t}}function sEe(t,e){for(const r of e)switch(r){case"cim":if(t.cimRef)return{format:r,url:encodeURI(t.cimRef)};break;case"web-gltf-basisu":{const i=s_(t,"gltf_basisu");if(i)return{format:r,url:i};break}case"web-gltf":{const i=s_(t,"gltf");if(i)return{format:r,url:i};break}case"web":{const i=s_(t,"gltf");if(i)return{format:"web-gltf",url:i};if(t.webRef)return{format:r,url:encodeURI(t.webRef)};break}}}function s_(t,e){if(!k("enable-feature:force-wosr"))return t.formatInfos?.find(r=>r.type===e)?.href}function bme(t,e){const r={responseType:"json",query:{f:"json"},...e};return Ae(en(t),r)}const jP="esri_en",VP="Style",nEe="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var Cf;const zP="uvInfos-watcher",UP="uvGroups-watcher",_me=",",Sme=ut(Ws);function $me(t){const{field1:e,field2:r,field3:i,fieldDelimiter:s,uniqueValueInfos:n,valueExpression:o}=t,l=!(!e||!r);return[{classes:(n??[]).map(u=>{const{symbol:d,label:p,value:f,description:m}=u,[y,g,v]=l?f?.toString()?.split(s||"")||[]:[f],_=[];return(e||o)&&_.push(y),r&&_.push(g),i&&_.push(v),{symbol:d,label:p,values:[_],description:m}})}]}function pc(t){return t!=null&&t!==""&&(typeof t!="string"||t.trim()!==""&&t.toLowerCase()!=="<null>")||(t=null),t+""}let Ge=Cf=class extends lp(Di){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,r){if(!e&&!r)return;if(!e||!r)return{type:"complete",oldValue:e,newValue:r};let i=!1;const s={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let n=0;n<r.length;n++){const o=e.find(l=>l.value===r[n].value);o?fme(o,r[n])?(s.changed.push({type:"complete",oldValue:o,newValue:r[n]}),i=!0):s.unchanged.push({oldValue:o,newValue:r[n]}):(s.added.push(r[n]),i=!0)}for(let n=0;n<e.length;n++)r.find(o=>o.value===e[n].value)||(s.removed.push(e[n]),i=!0);return i?s:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(t){this._set("field",t),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(t){return t==null||typeof t=="function"?t:Km(t)}writeField(t,e,r,i){typeof t=="string"?e[r]=t:i?.messages?i.messages.push(new x("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):L.getLogger(this).error(".field: cannot write field to JSON since it's not a string value")}set field2(t){this._set("field2",t),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(t){this._set("field3",t),this._updateUniqueValues()}set valueExpression(t){this._set("valueExpression",t),this._updateUniqueValues()}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}set fieldDelimiter(t){this._set("fieldDelimiter",t),this._updateUniqueValues()}readPortal(t,e,r){return r.portal||j.getDefault()}readStyleOrigin(t,e,r){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const i=qu(e.styleUrl,r);return Object.freeze({styleUrl:i})}}writeStyleOrigin(t,e,r,i){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=Mu(t.styleUrl,i))}set uniqueValueGroups(t){this.styleOrigin?L.getLogger(this).error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",t),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(t){this.styleOrigin?L.getLogger(this).error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(t,e){if(this.styleOrigin)return void L.getLogger(this).error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let r;r=typeof t=="object"?Sme(t):new Ws({value:t,symbol:fj(e)}),this.uniqueValueInfos?.push(r),this._valueInfoMap[pc(r.value)]=r,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(t){if(this.styleOrigin)return void L.getLogger(this).error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const e=this.uniqueValueInfos;if(e)for(let r=0;r<e.length;r++){const i=e[r];if(String(i.value)===String(t)){delete this._valueInfoMap[pc(t)],e.splice(r,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(t,e){let r=e;return this.valueExpression&&e?.arcade==null&&(r={...r,arcade:await Fu()}),this._getUniqueValueInfo(t,r)}getSymbol(t,e){return this.valueExpression&&e?.arcade==null?void L.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used"):this._getUniqueValueInfo(t,e)?.symbol||this.defaultSymbol}async getSymbolAsync(t,e){let r=e;if(this.valueExpression&&r?.arcade==null){const s=await Fu(),{arcadeUtils:n}=s;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),r={...r,arcade:s}}return this._getUniqueValueInfo(t,r)?.symbol||this.defaultSymbol}get symbols(){const t=[];if(this._isInfosSource)for(const e of this.uniqueValueInfos??[])e.symbol&&t.push(e.symbol);else for(const e of this.uniqueValueGroups??[])for(const r of e.classes??[])r.symbol&&t.push(r.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),r=this.uniqueValueInfos?.reduce((i,s)=>i+s.getMeshHash(),"");return`${t}.${e}.${r}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const t=new Cf({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:E(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:E(this.visualVariables),legendOptions:E(this.legendOptions),authoringInfo:E(this.authoringInfo),backgroundFillSymbol:E(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=E(this.uniqueValueInfos),r=E(this.uniqueValueGroups);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(E(this.styleOrigin))),Object.freeze(e),Object.freeze(r)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t._set("uniqueValueGroups",r),t._isInfosSource=this._isInfosSource,t._watchUniqueValueInfosAndGroups(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const r=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(r)}async collectSymbolFields(t,e){const r=[...this.symbols.map(i=>i.collectRequiredFields(t,e)),Lr(t,e,null,this.valueExpression)];Ar(t,e,this.field),Ar(t,e,this.field2),Ar(t,e,this.field3),await Promise.all(r)}populateFromStyle(){return wme(this.styleOrigin,{portal:this.portal}).then(t=>{const e=[];return this._valueInfoMap={},t?.data&&Array.isArray(t.data.items)&&t.data.items.forEach(r=>{const i=new dr({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:r.name});this.defaultSymbol||r.name!==t.data.defaultItem||(this.defaultSymbol=i,this._isDefaultSymbolDerived=!0);const s=new Ws({value:r.name,symbol:i});e.push(s),this._valueInfoMap[pc(r.name)]=s}),this._set("uniqueValueInfos",Object.freeze(e)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&this.uniqueValueInfos?.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this})}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",_me)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:t}=this;if(t)for(const e of t)this._valueInfoMap[pc(e.value)]=e}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(zP);const{uniqueValueInfos:t}=this;if(t){const e=[];for(const r of t)e.push(ne(()=>({symbol:r.symbol,value:r.value,label:r.label,description:r.description}),(i,s)=>{i!==s&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)},{sync:!0}));this.addHandles(e,zP)}}_watchUniqueValueGroups(){this.removeHandles(UP);const{uniqueValueGroups:t}=this;if(t){const e=[];for(const r of t){e.push(ne(()=>({classes:r.classes}),(i,s)=>{i!==s&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}));for(const i of r.classes??[])e.push(ne(()=>({symbol:i.symbol,values:i.values,label:i.label,description:i.description}),(s,n)=>{s!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}))}this.addHandles(e,UP)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const t=[],{field:e,field2:r,field3:i,fieldDelimiter:s,uniqueValueGroups:n,valueExpression:o}=this;if(!e&&!o)return this._set("uniqueValueInfos",t),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const l=!(!e||!r);for(const u of n)for(const d of u.classes??[]){const{symbol:p,label:f,values:m,description:y}=d;for(const g of m??[]){const{value:v,value2:_,value3:S}=g,M=[v];r&&M.push(_),i&&M.push(S);const C=l?M.join(s||""):M[0]??void 0;t.push(new Ws({symbol:p,label:f,value:C,description:y}))}}this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(t=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:e,field2:r,valueExpression:i,fieldDelimiter:s,uniqueValueInfos:n}=this;if(!e&&!i||!n.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!e||!r),l=n.map(d=>{const{symbol:p,label:f,value:m,description:y}=d,[g,v,_]=o?m?.toString()?.split(s||"")||[]:[m];return new So({symbol:p,label:f,description:y,values:[new Js({value:g,value2:v,value3:_})]})}),u=[new uu({classes:l})];t&&Object.freeze(u),this._set("uniqueValueGroups",u),this._watchUniqueValueGroups()}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:r,scale:i,spatialReference:s,arcade:n,timeZone:o}=e??{};let l=this._cache.compiledFunc;const u=n.arcadeUtils;if(!l){const p=u.createSyntaxTree(this.valueExpression);l=u.createFunction(p),this._cache.compiledFunc=l}const d=u.executeFunction(l,u.createExecContext(t,u.getViewInfo({viewingMode:r,scale:i,spatialReference:s}),o));return this._valueInfoMap[pc(d)]}_getUnqiueValueInfoForFields(t){const e=this.field,r=t.attributes;let i;if(this.field2){const s=this.field2,n=this.field3,o=[];e&&o.push(r[e]),s&&o.push(r[s]),n&&o.push(r[n]),i=o.join(this.fieldDelimiter||"")}else e&&(i=r[e]);return this._valueInfoMap[pc(i)]}static fromPortalStyle(t,e){const r=new Cf(e?.properties);r._set("styleOrigin",Object.freeze({styleName:t})),r._set("portal",e?.portal||j.getDefault());const i=r.populateFromStyle();return i.catch(s=>{L.getLogger(this.prototype).error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",s)}),i}static fromStyleUrl(t,e){const r=new Cf(e?.properties);r._set("styleOrigin",Object.freeze({styleUrl:t}));const i=r.populateFromStyle();return i.catch(s=>{L.getLogger(this.prototype).error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",s)}),i}};a([c({readOnly:!0})],Ge.prototype,"_cache",null),a([se({uniqueValue:"unique-value"})],Ge.prototype,"type",void 0),a([c(S3)],Ge.prototype,"backgroundFillSymbol",void 0),a([c({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],Ge.prototype,"field",null),a([Ce("field")],Ge.prototype,"castField",null),a([q("field")],Ge.prototype,"writeField",null),a([c({type:String,value:null,json:{write:!0}})],Ge.prototype,"field2",null),a([c({type:String,value:null,json:{write:!0}})],Ge.prototype,"field3",null),a([c({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],Ge.prototype,"orderByClassesEnabled",void 0),a([c({type:String,value:null,json:{write:!0}})],Ge.prototype,"valueExpression",null),a([c({type:String,json:{write:!0}})],Ge.prototype,"valueExpressionTitle",void 0),a([c({type:$3,json:{write:!0}})],Ge.prototype,"legendOptions",void 0),a([c({type:String,json:{write:!0}})],Ge.prototype,"defaultLabel",void 0),a([c(iT({...bb},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],Ge.prototype,"defaultSymbol",null),a([c({type:String,value:null,json:{write:!0}})],Ge.prototype,"fieldDelimiter",null),a([c({type:j,readOnly:!0})],Ge.prototype,"portal",void 0),a([V("portal",["styleName"])],Ge.prototype,"readPortal",null),a([c({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],Ge.prototype,"styleOrigin",void 0),a([V("styleOrigin",["styleName","styleUrl"])],Ge.prototype,"readStyleOrigin",null),a([q("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],Ge.prototype,"writeStyleOrigin",null),a([c({type:[uu],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(t,e,r)=>(e.uniqueValueGroups||$me(e)).map(i=>uu.fromJSON(i,r))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],Ge.prototype,"uniqueValueGroups",null),a([c({type:[Ws],json:{read:!1,write:{isRequired:!0,overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0,isRequired:!0}}}}})],Ge.prototype,"uniqueValueInfos",null),Ge=Cf=a([b("esri.renderers.UniqueValueRenderer")],Ge);var xx,ah;let jt=(ah=class extends F{constructor(e){super(e),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.orderByFields=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(e,r){r.resultOffset=this.start,r.resultRecordCount=this.num||10}clone(){return new xx(E({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}},xx=ah,ah);a([c({type:[String],json:{write:!0}})],jt.prototype,"attachmentTypes",void 0),a([c({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],jt.prototype,"attachmentsWhere",void 0),a([c({type:Boolean,json:{write:!0}})],jt.prototype,"cacheHint",void 0),a([c({type:[String],json:{write:!0}})],jt.prototype,"keywords",void 0),a([c({type:[String],json:{write:!0}})],jt.prototype,"globalIds",void 0),a([c({json:{write:!0}})],jt.prototype,"name",void 0),a([c({type:Number,json:{read:{source:"resultRecordCount"}}})],jt.prototype,"num",void 0),a([c({type:[Number],json:{write:!0}})],jt.prototype,"objectIds",void 0),a([c({type:[String],json:{write:!0}})],jt.prototype,"orderByFields",void 0),a([c({type:Boolean,json:{default:!1,write:!0}})],jt.prototype,"returnMetadata",void 0),a([c({type:[Number],json:{write:!0}})],jt.prototype,"size",void 0),a([c({type:Number,json:{read:{source:"resultOffset"}}})],jt.prototype,"start",void 0),a([q("start"),q("num")],jt.prototype,"writeStart",null),a([c({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],jt.prototype,"where",void 0),jt=xx=a([b("esri.rest.support.AttachmentQuery")],jt),jt.from=ut(jt);const C9=Lt()({naturalLog:"natural-log",squareRoot:"square-root",percentOfTotal:"percent-of-total",log:"log",field:"field"}),qP="percent-of-total",GP="field",oEe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.normalizationField=null,this.normalizationMaxValue=null,this.normalizationMinValue=null,this.normalizationTotal=null}get normalizationType(){let i=this._get("normalizationType");const s=!!this.normalizationField,n=this.normalizationTotal!=null;return s||n?(i=s&&GP||n&&qP||null,s&&n&&L.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):i!==GP&&i!==qP||(i=null),i}set normalizationType(i){this._set("normalizationType",i)}};return a([c({type:String,json:{name:"parameters.normalizationField",write:!0}})],r.prototype,"normalizationField",void 0),a([c({type:Number,json:{name:"parameters.normalizationMaxValue",write:!0}})],r.prototype,"normalizationMaxValue",void 0),a([c({type:Number,json:{name:"parameters.normalizationMinValue",write:!0}})],r.prototype,"normalizationMinValue",void 0),a([c({type:Number,json:{name:"parameters.normalizationTotal",write:!0}})],r.prototype,"normalizationTotal",void 0),a([se(C9,{name:"parameters.normalizationType"})],r.prototype,"normalizationType",null),r=a([b("esri.rest.support.NormalizationBinParametersMixin")],r),r};var Tx,lh;let Je=(lh=class extends F{constructor(e){super(e),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(e,r){r.historicMoment=e&&e.getTime()}writeStart(e,r){r.resultOffset=this.start,r.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(r.definitionExpression="1=1")}clone(){return new Tx(E({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}},Tx=lh,lh);a([c({type:Boolean,json:{write:!0}})],Je.prototype,"cacheHint",void 0),a([c({type:qs,json:{write:!0}})],Je.prototype,"dynamicDataSource",void 0),a([c({type:String,json:{write:!0}})],Je.prototype,"gdbVersion",void 0),a([c({type:Number,json:{write:!0}})],Je.prototype,"geometryPrecision",void 0),a([c({type:Date})],Je.prototype,"historicMoment",void 0),a([q("historicMoment")],Je.prototype,"_writeHistoricMoment",null),a([c({type:Number,json:{write:!0}})],Je.prototype,"maxAllowableOffset",void 0),a([c({json:{write:!0}})],Je.prototype,"objectIds",void 0),a([c({type:[String],json:{write:!0}})],Je.prototype,"orderByFields",void 0),a([c({type:[String],json:{write:!0}})],Je.prototype,"outFields",void 0),a([c({type:Z,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Je.prototype,"outSpatialReference",void 0),a([c({json:{write:!0}})],Je.prototype,"relationshipId",void 0),a([c({type:Number,json:{read:{source:"resultOffset"}}})],Je.prototype,"start",void 0),a([q("start"),q("num")],Je.prototype,"writeStart",null),a([c({type:Number,json:{read:{source:"resultRecordCount"}}})],Je.prototype,"num",void 0),a([c({json:{write:!0}})],Je.prototype,"returnGeometry",void 0),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Je.prototype,"returnM",void 0),a([c({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Je.prototype,"returnZ",void 0),a([c({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],Je.prototype,"where",void 0),Je=Tx=a([b("esri.rest.support.RelationshipQuery")],Je),Je.from=ut(Je);const aEe=Object.freeze(Object.defineProperty({__proto__:null,get default(){return Je}},Symbol.toStringTag,{value:"Module"})),Mx=new $e({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function xme(t,e,r,i){const s=await hl(t);if(await x3(t,e,i),!s.addAttachment)throw new x(i,"Layer source does not support addAttachment capability");return s.addAttachment(e,r)}function x3(t,e,r){const{attributes:i}=e,{objectIdField:s}=t;return t.capabilities?.data?.supportsAttachment?e?i?s&&i[s]?Promise.resolve():Promise.reject(new x(r,`feature is missing the identifying attribute ${s}`)):Promise.reject(new x(r,"'attributes' are required on a feature to query attachments")):Promise.reject(new x(r,"A feature is required to add/delete/update attachments")):Promise.reject(new x(r,"this layer doesn't support attachments"))}async function Tme(t,e,r,i,s){const n=await hl(t);if(await x3(t,e,s),!n.updateAttachment)throw new x(s,"Layer source does not support updateAttachment capability");return n.updateAttachment(e,r,i)}async function Mme(t,e,r){const{applyEdits:i}=await N(()=>import("./editingSupport-CW7VabYY.js"),[]),s=await t.load();let n=r;return s.type==="feature"&&s.infoFor3D&&e.deleteFeatures!=null&&s.globalIdField!=null&&(n={...n,globalIdToObjectId:await Zme(s,e.deleteFeatures,s.globalIdField)}),i(s,s.source,e,r)}async function Ime(t,e,r){const{uploadAssets:i}=await N(()=>import("./editingSupport-CW7VabYY.js"),[]),s=await t.load();return i(s,s.source,e,r)}async function Eme(t,e,r,i){const s=await hl(t);if(await x3(t,e,i),!s.deleteAttachments)throw new x(i,"Layer source does not support deleteAttachments capability");return s.deleteAttachments(e,r)}async function Ome(t,e,r){const i=(await t.load({signal:e?.signal})).source;if(!i.fetchRecomputedExtents)throw new x(r,"Layer source does not support fetchUpdates capability");return i.fetchRecomputedExtents(e)}async function kme(t,e,r,i){e=jt.from(e),await t.load();const s=t.source,n=t.capabilities;if(!n?.data?.supportsAttachment)throw new x(i,"this layer doesn't support attachments");const{attachmentTypes:o,objectIds:l,globalIds:u,num:d,size:p,start:f,where:m}=e;if(!n?.operations?.supportsQueryAttachments&&(o?.length>0||u?.length>0||p?.length>0||d||f||m))throw new x(i,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(l?.length||u?.length||m))throw new x(i,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!s.queryAttachments)throw new x(i,"Layer source does not support queryAttachments capability",e);return!n?.attachment?.supportsOrderByFields&&e.orderByFields?.length&&((e=e.clone()).orderByFields=null),s.queryAttachments(e)}async function Cme(t,e,r,i){const s=await hl(t);if(!s.queryObjectIds)throw new x(i,"Layer source does not support queryObjectIds capability");return s.queryObjectIds(re.from(e)??t.createQuery(),r)}async function Pme(t,e,r,i){const s=await hl(t);if(!s.queryFeatureCount)throw new x(i,"Layer source does not support queryFeatureCount capability");return s.queryFeatureCount(re.from(e)??t.createQuery(),r)}async function Ame(t,e,r,i){const s=await hl(t);if(!s.queryExtent)throw new x(i,"Layer source does not support queryExtent capability");return s.queryExtent(re.from(e)??t.createQuery(),r)}async function Rme(t,e,r,i){const s=await hl(t);if(!s.queryRelatedFeatures)throw new x(i,"Layer source does not support queryRelatedFeatures capability");return s.queryRelatedFeatures(Je.from(e),r)}async function Lme(t,e,r,i){const s=await hl(t);if(!s.queryRelatedFeaturesCount)throw new x(i,"Layer source does not support queryRelatedFeaturesCount capability");return s.queryRelatedFeaturesCount(Je.from(e),r)}async function Fme(t){const e=t.source;if(e?.refresh)try{const{dataChanged:r,updates:i}=await e.refresh();if(i!=null&&(t.sourceJSON={...t.sourceJSON,...i},t.read(i,{origin:"service",url:t.parsedUrl})),r)return!0}catch{}if(t.definitionExpression)try{return(await i4(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function Nme(t){const e=new re;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,e.outFields=["*"],e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null;const r=t.capabilities?.query;r&&(e.compactGeometryEnabled=r.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=r.supportsDefaultSpatialReference);const i=t.capabilities?.data;i?.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),i?.supportsM&&t.returnM!=null&&(e.returnM=t.returnM);const{timeOffset:s,timeExtent:n}=t;return e.timeExtent=s!=null&&n!=null?n.offset(-s.value,s.unit):n||null,e}function P9(t){const{globalIdField:e,fields:r}=t;if(e)return e;if(r){for(const i of r)if(i.type==="esriFieldTypeGlobalID")return i.name}}function A9(t){const{objectIdField:e,fields:r}=t;if(e)return e;if(r){for(const i of r)if(i.type==="esriFieldTypeOID")return i.name}}function Dme(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}function jme(t,e,r,i){const s=r?.feature,n=!!t.subtypes?.length;if(n&&!r?.excludeImpliedDomains){const u=zme(t,e);if(u)return u}const o=n&&Vme(t,s);if(o){const u=o?.domains?.[e];return u?.type==="inherited"?i:u}const l=F9(t.types,t.typeIdField,s);if(l){const u=l.domains&&l.domains[e];if(u&&u?.type!=="inherited")return u}if(i)return i;if(!r?.excludeImpliedDomains){const u=Ume(t,e);if(u)return u}return null}function Vme(t,e){const{subtypes:r,subtypeField:i}=t;if(!e?.attributes||!r?.length||!i)return null;const s=e.attributes[i];return s==null?null:r.find(n=>n.code===s)}function zme(t,e){const{fieldsIndex:r,subtypeField:i}=t,{name:s,type:n}=r.get(e)??{};if(!s)return null;if((i&&r.get(i)?.name)===s&&t.subtypes?.length){const o=t.subtypes.map(l=>new ou({code:R9(l.code,n),name:l.name}));if(o?.length)return new Da({codedValues:o})}return null}function Ume(t,e){const{fieldsIndex:r}=t,{name:i,type:s}=r.get(e)??{};if(!i)return null;if(("typeIdField"in t?r.get(t.typeIdField)?.name:null)===i&&"types"in t&&t.types?.length){const n=t.types.map(o=>new ou({code:R9(o.id,s),name:o.name}));return new Da({codedValues:n})}return null}function R9(t,e){return e?g4({type:e})&&typeof t=="number"?`${t}`:Ere({type:e})&&typeof t=="string"?Number.parseInt(t,10):t:t}async function hl(t){return(await t.load()).source}async function lEe(t,e){if(!Se)return;const r=Se.findCredential(t);if(r)return r.userId;let i;try{const s=await iM(t,e);s&&(i=await Se.checkSignInStatus(`${s}/sharing`))}catch{}return i?i.userId:null}async function L9(t,e){if(!Se||Se.findCredential(t))return;let r;try{const i=await iM(t,e);i&&(r=await Se.checkSignInStatus(`${i}/sharing`))}catch{}if(r)try{const i=e!=null?e.signal:null;await Se.getCredential(t,{signal:i})}catch{}}async function qme(t,e,r){const i=t.parsedUrl?.path;i&&t.authenticationTriggerEvent===e&&await L9(i,r)}async function uEe(t){const e=t.parsedUrl?.path;e&&Gme(t)&&await L9(e)}function Gme(t){return Bme(t)&&("serviceDefinitionExpression"in t&&nw(t.serviceDefinitionExpression)||"definitionExpression"in t&&nw(t.definitionExpression))}function Bme(t){return!(!E5(t)||!t.capabilities?.query.supportsCurrentUser)}function nw(t){return!!t?.toLowerCase().includes("current_user")}function Hme(t){return!U0(t)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const n_=Wh({types:pj});function T3(t,e){if(t.defaultSymbol)return t.types?.length?new Ge({defaultSymbol:n_(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map(r=>({id:r.id,symbol:n_(r.symbol,r,e)}))}):new Wr({symbol:n_(t.defaultSymbol,t,e)})}function Wme(t){let e=t.sourceJSON?.cacheMaxAge;if(!e)return!1;const r=t.editingInfo?.lastEditDate?.getTime();return r==null||(e*=1e3,Date.now()-r<e)}async function Zme(t,e,r){if(e==null)return null;const i=[],{objectIdField:s}=t;if(e.forEach(d=>{let p=null;if("attributes"in d){const{attributes:f}=d;p={globalId:f[r],objectId:f[s]!=null&&f[s]!==-1?f[s]:null}}else p={globalId:d.globalId,objectId:d.objectId!=null&&d.objectId!==-1?d.objectId:null};p.globalId!=null&&(p.objectId!=null&&p.objectId!==-1||i.push(p.globalId))}),i.length===0)return null;const n=t.createQuery();n.where=i.map(d=>`${r}='${d}'`).join(" OR "),n.returnGeometry=!1,n.outFields=[s,r],n.cacheHint=!1;const o=await BG(yfe(t,n));if(!o.ok)return null;const l=new Map,u=o.value.features;for(const d of u){const p=d.attributes[r],f=d.attributes[s];p!=null&&f!=null&&f!==-1&&l.set(wJ(p),f)}return l}function F9(t,e,r){if(!e||!r||!t)return null;const i=r.getAttribute(e);return i==null?null:t.find(s=>{const{id:n}=s;return n!=null&&n.toString()===i.toString()})??null}function U0(t){return t.sourceJSON?.isMultiServicesView||Jme(t)}function Jme(t){return!!t.sourceJSON?.capabilities?.toLowerCase().split(",").map(e=>e.trim()).includes("map")}function Yme(t,e,r){const i=e?.queryAttributeBins;if(!e?.operations?.supportsQueryBins||!i)throw new x(r,"Layer source does not support binning");switch(t.binParameters.type){case"auto-interval":if(!i.supportsAutoInterval)throw new x(r,"Layer source does not support auto-interval binning");if(t.binParameters.normalizationType&&(!i.supportsNormalization||!BP(t.binParameters.normalizationType,i.supportedNormalizationTypes)))throw new x(r,"Layer source does not support normalization binning");break;case"date":if(!i.supportsDate)throw new x(r,"Layer source does not support date binning");if(t.binParameters.snapToData&&!i.supportsSnapToData)throw new x(r,"Layer source does not support snapToData binning");if(t.binParameters.returnFullIntervalBin&&!i.supportsReturnFullIntervalBin)throw new x(r,"Layer source does not support returnFullIntervalBin binning");break;case"fixed-boundaries":if(!i.supportsFixedBoundaries)throw new x(r,"Layer source does not support fixed-boundaries binning");break;case"fixed-interval":if(!i.supportsFixedInterval)throw new x(r,"Layer source does not support fixed-interval binning");if(t.binParameters.normalizationType&&(!i.supportsNormalization||!BP(t.binParameters.normalizationType,i.supportedNormalizationTypes)))throw new x(r,"Layer source does not support normalization binning")}if(t.binParameters.stackBy&&!i.supportsStackBy)throw new x(r,"Layer source does not support stackBy binning");if(t.binParameters.splitBy&&!i.supportsSplitBy)throw new x(r,"Layer source does not support splitBy binning");if(t.binParameters.firstDayOfWeek&&!i.supportsFirstDayOfWeek)throw new x(r,"Layer source does not support firstDayOfWeek binning");const s=i?.supportedStatistics;if(t.outStatistics&&s){const n=new Map([["count","count"],["sum","sum"],["min","min"],["max","max"],["avg","avg"],["stddev","stddev"],["var","var"],["percentile-continuous","percentileContinuous"],["percentile-discrete","percentileDiscrete"],["centroid-aggregate","centroid"],["convex-hull-aggregate","convexHull"],["envelope-aggregate","envelope"]]);for(const{statisticType:o}of t.outStatistics){const l=n.get(o);if(l&&!s[l])throw new x(r,`Layer source does not support ${o} statistic type`)}}}function BP(t,e){return t!=null&&!!e?.[C9.toJSON(t)]}let ed=class extends pe(F){constructor(e){super(e),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};a([c({type:String,json:{read:{source:"shapeAreaFieldName"}}})],ed.prototype,"shapeAreaField",void 0),a([c({type:String,json:{read:{source:"shapeLengthFieldName"}}})],ed.prototype,"shapeLengthField",void 0),a([c({type:String,json:{read:t=>NB.read(t)||DB.read(t)}})],ed.prototype,"units",void 0),ed=a([b("esri.layers.support.GeometryFieldsInfo")],ed);var Ix;let td=Ix=class extends F{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new H}clone(){return new Ix({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};a([c({type:String,json:{write:{isRequired:!0}}})],td.prototype,"floorField",void 0),a([c({json:{read:!1,write:!1}})],td.prototype,"viewAllMode",void 0),a([c({json:{read:!1,write:!1}})],td.prototype,"viewAllLevelIds",void 0),td=Ix=a([b("esri.layers.support.LayerFloorInfo")],td);function Kme(t){const{nonStandardUrlAllowed:e=!1,separator:r}=t??{},i=E(lfe),s=i.json?.write;return typeof s=="object"&&s&&(s.writer=function(n,o,l,u){w7(this,n,r,o,u)}),{...i,set:function(n){if(n==null)return void this._set("url",n);const o=v7({layer:this,url:n,nonStandardUrlAllowed:e,logger:L.getLogger(this)});this._set("url",o.url),o.layerId!=null&&this._set("layerId",o.layerId)}}}function Qme(t,e){const{separator:r}=e??{},i=Rr(t.url);return i!=null&&(t.dynamicDataSource!=null?i.path=Tu(i.path,"dynamicLayer"):t.layerId!=null&&(i.path=Tu(i.path,r??"",t.layerId.toString()))),i}const HP=new $e({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),WP=new $e({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let ki=class extends pe(F){constructor(e){super(e),this.cardinality=null,this.catalogId=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};a([c({json:{read:HP.read,write:HP.write}})],ki.prototype,"cardinality",void 0),a([c({json:{name:"catalogID"}})],ki.prototype,"catalogId",void 0),a([c({json:{read:!0,write:!0}})],ki.prototype,"composite",void 0),a([c({json:{read:!0,write:!0}})],ki.prototype,"id",void 0),a([c({json:{read:!0,write:!0}})],ki.prototype,"keyField",void 0),a([c({json:{read:!0,write:!0}})],ki.prototype,"keyFieldInRelationshipTable",void 0),a([c({json:{read:!0,write:!0}})],ki.prototype,"name",void 0),a([c({json:{read:!0,write:!0}})],ki.prototype,"relatedTableId",void 0),a([c({json:{read:!0,write:!0}})],ki.prototype,"relationshipTableId",void 0),a([c({json:{read:WP.read,write:WP.write}})],ki.prototype,"role",void 0),ki=a([b("esri.layers.support.Relationship")],ki);const Xme=[["binary","application/octet-stream","bin",""]];function hEe(t,e){return V9(e.name,t?.supportedFormats??[])!=null}function pEe(t,e){if(!t)return!1;const r=eye(e,t.supportedFormats??[]);return r!=null&&t.editFormats.includes(r)}function N9(t,e){return I3(sye(t,e))}function D9(t,e){return I3(V9(t,e))}function fEe(t,e){return z9(iye(t,e))}function eye(t,e){return D9(t.name,e)??N9(t.type,e)}function _b(t,e,r){return N9(t,r)??D9(e,r)}function j9({supportedFormats:t}){return _b("model/gltf-binary","glb",t)}function mEe(t){const e=j9(t);return e!=null&&t.editFormats.includes(e)}function tye({supportedFormats:t}){return _b("model/gltf+json","gltf",t)}function rye(t){if(!t)return null;const e=j9(t),r=tye(t);let i=null;for(const s of t.queryFormats){if(s===e)return s;s===r&&(i=s)}return i}function yEe({supportedFormats:t}){return _b("application/esri3do-SR_world","wld",t)}function gEe({supportedFormats:t}){return _b("application/esri3do-SR_prj","prj",t)}function M3(t){return[...Xme,...t]}function iye(t,e){return M3(e).find(r=>I3(r)===t)}function sye(t,e){const r=t.toLowerCase();return M3(e).find(i=>z9(i)===r)}function V9(t,e){const r=t.toLowerCase();return M3(e).find(i=>nye(i).some(s=>r.endsWith(s)))}function I3(t){return t?.[0]}function z9(t){return t?.[1].toLowerCase()}function nye(t){return t?.[2].split(",").map(e=>e.toLowerCase())??[]}function vEe(t){return t.tables?.find(e=>e.role==="assetMaps")}function W(t,e,r){return!!U9(t,e,r)}function rd(t,e,r){return U9(t,e,r)}function U9(t,e,r){return t&&t.hasOwnProperty(e)?t[e]:r}const oye={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function aye(t){const e=t?.supportedSpatialAggregationStatistics?.map(r=>r.toLowerCase());return{envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function Sy(t,e){return!!t?.supportedOperationsWithCacheHint?.map(i=>i.toLowerCase())?.includes(e.toLowerCase())}function lye(t){const e=t?.supportedStatisticTypes?.map(r=>r.toLowerCase());return{count:!!e?.includes("count"),sum:!!e?.includes("sum"),min:!!e?.includes("min"),max:!!e?.includes("max"),avg:!!e?.includes("avg"),var:!!e?.includes("var"),stddev:!!e?.includes("stddev"),percentileContinuous:!!e?.includes("percentile_cont"),percentileDiscrete:!!e?.includes("percentile_disc"),envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function uye(t){const e=t?.supportedNormalizationTypes?.map(r=>r.toLowerCase());return{field:!!e?.includes("field"),log:!!e?.includes("log"),naturalLog:!!e?.includes("naturallog"),percentOfTotal:!!e?.includes("percentoftotal"),squareRoot:!!e?.includes("squareroot")}}function q9(t,e){return{analytics:cye(t),attachment:dye(t),data:hye(t),metadata:pye(t),operations:fye(t.capabilities,t,e),query:mye(t,e),queryAttributeBins:vye(t),queryRelated:yye(t),queryTopFeatures:gye(t),editing:wye(t)}}function cye(t){return{supportsCacheHint:Sy(t.advancedQueryCapabilities,"queryAnalytics")}}function dye(t){const e=t.attachmentProperties,r={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:Sy(t.advancedQueryCapabilities,"queryAttachments"),supportsOrderByFields:W(t.advancedQueryCapabilities,"supportsQueryAttachmentOrderByFields",!1),supportsResize:W(t,"supportsAttachmentsResizing",!1),supportsTypeWildcard:W(t.advancedQueryCapabilities,"supportsQueryAttachmentWithTypeWildcard",!1)};return e&&Array.isArray(e)&&e.forEach(i=>{const s=oye[i.name];s&&(r[s]=!!i.isEnabled)}),r}function hye(t){return{isVersioned:W(t,"isDataVersioned",!1),isBranchVersioned:W(t,"isDataBranchVersioned",!1),supportsAttachment:W(t,"hasAttachments",!1),supportsM:W(t,"hasM",!1),supportsZ:W(t,"hasZ",!1)}}function pye(t){return{supportsAdvancedFieldProperties:W(t,"supportsFieldDescriptionProperty",!1)}}function fye(t,e,r){const i=t?.toLowerCase().split(",").map(m=>m.trim())??[],s=r?nl(r):null,n=i.includes(s?.serverType==="MapServer"?"data":"query"),o=i.includes("editing")&&!e.datesInUnknownTimezone&&e.uniqueIdInfo?.OIDFieldContainsHashValue!==!0;let l=o&&i.includes("create"),u=o&&i.includes("delete"),d=o&&i.includes("update");const p=i.includes("changetracking"),f=e.advancedQueryCapabilities;return o&&!(l||u||d)&&(l=u=d=!0),{supportsCalculate:W(e,"supportsCalculate",!1),supportsTruncate:W(e,"supportsTruncate",!1),supportsValidateSql:W(e,"supportsValidateSql",!1),supportsAdd:l,supportsDelete:u,supportsEditing:o,supportsChangeTracking:p,supportsQuery:n,supportsQueryAnalytics:W(f,"supportsQueryAnalytic",!1),supportsQueryAttachments:W(f,"supportsQueryAttachments",!1),supportsQueryBins:W(f,"supportsQueryBins",!1)||!!e.queryBinsCapabilities,supportsQueryPivot:W(f,"supportsQueryPivot",!1),supportsQueryTopFeatures:W(f,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:W(e,"supportsAttachmentsResizing",!1),supportsSync:i.includes("sync"),supportsUpdate:d,supportsExceedsLimitStatistics:W(e,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:W(e,"supportsAsyncConvert3D",!1)}}function mye(t,e){const r=t.advancedQueryCapabilities,i=t.ownershipBasedAccessControlForFeatures,s=t.archivingInfo,n=t.currentVersion,o=e?.includes("MapServer"),l=!o||n>=k("mapserver-pbf-version-support"),u=Q0(e),d=new Set((t.supportedQueryFormats??"").split(",").map(p=>p.toLowerCase().trim()));return{maxRecordCount:rd(t,"maxRecordCount",void 0),maxRecordCountFactor:rd(t,"maxRecordCountFactor",void 0),maxUniqueIDCount:rd(t,"maxUniqueIDCount",void 0),standardMaxRecordCount:rd(t,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:aye(r),supportsCacheHint:W(r,"supportsQueryWithCacheHint",!1)||Sy(r,"query"),supportsCentroid:W(r,"supportsReturningGeometryCentroid",!1),supportsCentroidOnDegeneratedQuantizedGeometry:u||e==null,supportsCompactGeometry:u,supportsCurrentUser:W(r,"supportsCurrentUserQueries",!1),supportsDefaultSpatialReference:W(r,"supportsDefaultSR",!1),supportsDegeneratedQuantizedGeometry:W(r,"supportsDegeneratedQuantizedGeometry",!1),supportsDisjointSpatialRelationship:W(r,"supportsDisjointSpatialRel",!1),supportsDistance:W(r,"supportsQueryWithDistance",!1),supportsDistinct:W(r,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:W(r,"supportsReturningQueryExtent",!1),supportsFormatPBF:l&&d.has("pbf"),supportsFullTextSearch:W(r,"supportsFullTextSearch",!1),supportsGeometryProperties:W(r,"supportsReturningGeometryProperties",!1),supportsHavingClause:W(r,"supportsHavingClause",!1),supportsHistoricMoment:W(s,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:W(r,"supportsMaxRecordCountFactor",!1),supportsOrderBy:W(r,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:W(r,"supportsPagination",!1),supportsPaginationOnAggregatedQueries:W(r,"supportsPaginationOnAggregatedQueries",!1),supportsPercentileStatistics:W(r,"supportsPercentileStatistics",!1),supportsQuantization:W(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:W(t,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:W(i,"allowAnonymousToQuery",!0),supportsQueryByOthers:W(i,"allowOthersToQuery",!0),supportsQueryGeometry:W(t,"supportsReturningQueryGeometry",!1),supportsResultType:W(r,"supportsQueryWithResultType",!1),supportsReturnMesh:!!rye(t.infoFor3D),supportsSpatialAggregationStatistics:W(r,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:W(r,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:W(t,"useStandardizedQueries",!1),supportsStatistics:W(r,"supportsStatistics",t.supportsStatistics),supportsTopFeaturesQuery:W(r,"supportsTopFeaturesQuery",!1),supportsTrueCurve:W(r,"supportsTrueCurve",!1),tileMaxRecordCount:rd(t,"tileMaxRecordCount",void 0)}}function yye(t){const e=t.advancedQueryCapabilities,r=W(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:W(e,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r,supportsCacheHint:Sy(e,"queryRelated")}}function gye(t){return{supportsCacheHint:Sy(t.advancedQueryCapabilities,"queryTopFilter")}}function vye(t){const e=t?t.queryBinsCapabilities:void 0;return{supportsDate:W(e,"supportsDateBin",!1),supportsFixedInterval:W(e,"supportsFixedIntervalBin",!1),supportsAutoInterval:W(e,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:W(e,"supportsFixedBoundariesBin",!1),supportsStackBy:W(e,"supportsStackBy",!1),supportsSplitBy:W(e,"supportsSplitBy",!1),supportsSnapToData:W(e,"supportsSnapToData",!1),supportsReturnFullIntervalBin:W(e,"supportsReturnFullIntervalBin",!1),supportsFirstDayOfWeek:W(e,"supportsFirstDayOfWeek",!1),supportsNormalization:W(e,"supportsNormalization",!1),supportedStatistics:lye(e),supportedNormalizationTypes:uye(e)}}function wye(t){const e=t.ownershipBasedAccessControlForFeatures,r=t?t.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:W(t,"allowGeometryUpdates",!0),supportsGlobalId:W(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:W(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:W(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:W(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:W(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:W(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:W(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:W(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:W(e,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:W(r,"supportsAsyncApplyEdits",!1),zDefault:rd(t,"zDefault",void 0)}}function wEe(t){return{operations:{supportsAppend:W(t,"supportsAppend",!1),supportsCoverageQuery:t?.playbackInfo?.klv["0601"]??!1,supportsExportClip:W(t,"supportsExportClip",!1),supportsExportFrameset:W(t,"supportsExportFrameset",!1),supportsMensuration:W(t,"supportsMensuration",!1),supportsPreviews:W(t,"supportsPreviews",!1),supportsUpdate:W(t,"supportsUpdate",!1)}}}let po=class extends pe(F){constructor(e){super(e),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(e){if(!e)return null;const r={};for(const i of Object.keys(e))r[i]=eb(e[i]);return r}writeDomains(e,r){if(!e)return;const i={};for(const s of Object.keys(e))e[s]&&(i[s]=e[s]?.toJSON());r.domains=i}};a([c({type:Number,json:{write:!0}})],po.prototype,"code",void 0),a([c({type:Object,json:{write:!0}})],po.prototype,"defaultValues",void 0),a([c({json:{write:!0}})],po.prototype,"domains",void 0),a([V("domains")],po.prototype,"readDomains",null),a([q("domains")],po.prototype,"writeDomains",null),a([c({type:String,json:{write:!0}})],po.prototype,"name",void 0),po=a([b("esri.layers.support.Subtype")],po);async function bye(t){const e=t.spatialReference;if(e.isWGS84)return t.clone();if(e.isWebMercator)return ud(t);const r=Z.WGS84;return await SM(e,r),ll(t,r)}function _ye(t,e){if(!E3(t,e)){const r=t.typeKeywords;r?r.push(e):t.typeKeywords=[e]}}function E3(t,e){return!!t.typeKeywords?.includes(e)}function _Ee(t){return E3(t,G9.HOSTED_SERVICE)}function Sye(t,e){const r=t.typeKeywords;if(r){const i=r.indexOf(e);i>-1&&r.splice(i,1)}}function SEe(t,e,r){r?_ye(t,e):Sye(t,e)}async function $Ee(t){const e=t.clone().normalize();let r;if(e.length>1)for(const i of e)r?i.width>r.width&&(r=i):r=i;else r=e[0];return bye(r)}const G9={CHARTS:"Charts",DYNAMIC:"Dynamic",GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function $ye(t){const{portal:e,isOrgItem:r,itemControl:i}=t,s=e.user?.privileges;let n=!s||s.includes("features:user:edit"),o=!!r&&!!s?.includes("features:user:fullEdit");const l=i==="update"||i==="admin";return l?o=n=!0:o&&(n=!0),{features:{edit:n,fullEdit:o},content:{updateItem:l}}}const xye=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.copyright=null,this.capabilities=null,this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.definitionExpression=null,this.displayField=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.fieldsIndex=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.globalIdField=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.indexes=new(H.ofType(_n)),this.isTable=!1,this.layerId=void 0,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.preferredTimeZone=null,this.relationships=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.sourceJSON=null,this.spatialReference=Z.WGS84,this.subtypeField=null,this.subtypes=null,this.trackIdField=null,this.uniqueIdFields=null,this.url=null,this.version=void 0,this._isUrlHostModified=!1,this._isUrlHostModificationEnabled=!1}getFieldDomain(i,s){throw new Error("Not implemented")}getField(i){return this.fieldsIndex.get(i)}get authenticationTriggerEvent(){if(!this.url)return null;const{capabilities:i}=this;if(i){const{query:n,operations:o,editing:l}=i;if(!n.supportsQueryByOthers||!n.supportsQueryByAnonymous||o.supportsEditing&&!(l.supportsUpdateByOthers&&l.supportsUpdateByAnonymous&&l.supportsDeleteByOthers&&l.supportsDeleteByAnonymous))return"load"}if(nw(this.serviceDefinitionExpression)||nw(this.definitionExpression))return"load";if(this.userHasUpdateItemPrivileges){if(Wme(this))return"load";if(this.hasUpdateItemRestrictions)return i.operations.supportsQuery?"editing":"load"}if(this.userHasFullEditingPrivileges&&this.hasFullEditingRestrictions)return"editing";const s=this.editFieldsInfo;return(s?.creatorField||s?.editorField)&&i?.operations.supportsEditing?"editing":null}readCapabilitiesFromService(i,s){return q9(s,this.url)}readEditingInfo(i,s){const{editingInfo:n}=s;return n?{lastEditDate:n.lastEditDate!=null?new Date(n.lastEditDate):null}:null}get effectiveCapabilities(){const i=this.capabilities;if(!i)return null;const s=E(i),{operations:n,editing:o}=s;return U0(this)?(this.userHasUpdateItemPrivileges&&(n.supportsQuery=!0),s):this.userHasUpdateItemPrivileges?(n.supportsAdd=n.supportsDelete=n.supportsEditing=n.supportsQuery=n.supportsUpdate=o.supportsDeleteByOthers=o.supportsGeometryUpdate=o.supportsUpdateByOthers=!0,s):(this.userHasFullEditingPrivileges&&n.supportsEditing&&(n.supportsAdd=n.supportsDelete=n.supportsUpdate=o.supportsGeometryUpdate=!0),s)}get effectiveEditingEnabled(){return!1}readGlobalIdFieldFromService(i,s){return P9(s)}get hasFullEditingRestrictions(){const i=this.capabilities;if(!i||U0(this))return!1;const{operations:s,editing:n}=i;return s.supportsEditing&&!(s.supportsAdd&&s.supportsDelete&&s.supportsUpdate&&n.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){const i=this.capabilities;if(!i)return!1;const{operations:s,editing:n}=i;return U0(this)?!s.supportsQuery:!(s.supportsAdd&&s.supportsDelete&&s.supportsEditing&&s.supportsQuery&&s.supportsUpdate&&n.supportsDeleteByOthers&&n.supportsGeometryUpdate&&n.supportsUpdateByOthers)}readIsTableFromService(i,s){return s.type==="Table"}readMaxScale(i,s){return s.effectiveMaxScale||i||0}readMinScale(i,s){return s.effectiveMinScale||i||0}readObjectIdFieldFromService(i,s){return A9(s)}get parsedUrl(){return Qme(this)}readServiceDefinitionExpression(i,s){return s.definitionQuery||s.definitionExpression}readUniqueIdFields(i,s){return s.uniqueIdInfo?.OIDFieldContainsHashValue?s.uniqueIdInfo.fields:null}readVersion(i,s){return Dme(s)}get isUrlHostModified(){const{loaded:i,url:s,_isUrlHostModified:n}=this;if(n)return!0;if(!i||!s||this.originIdOf("url")<7)return!1;const o=this.sourceJSON?.preferredHost;if(!o||!Cn(s,`https://${o}`,!0))return!1;for(let l=6;l>=3;l--){const u=this.getAtOrigin("url",mm(l));if(u)return!Cn(s,u,!0)}return!1}applyPreferredHost(i){const{url:s,portalItem:n}=this;!s||oS(n)}applyHostFromPortalItem(){const{url:i,portalItem:s}=this;if(!i||this.originIdOf("url")===7||!s?.url||!oS(s)||!E3(s,G9.HOSTED_SERVICE)||Cn(i,s.url,!0)||!this._isUrlHostModificationEnabled)return;const n=KU(s.url);this._set("url",dR(i,n)),this._isUrlHostModified=!0}};return a([c({readOnly:!0})],r.prototype,"authenticationTriggerEvent",null),a([c({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],r.prototype,"copyright",void 0),a([c({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","isDataBranchVersioned","isDataVersioned","maxRecordCount","maxRecordCountFactor","maxUniqueIDCount","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],r.prototype,"capabilities",void 0),a([V("service","capabilities")],r.prototype,"readCapabilitiesFromService",null),a([c(Mv("dateFieldsTimeReference"))],r.prototype,"dateFieldsTimeZone",void 0),a([c({type:Boolean})],r.prototype,"datesInUnknownTimezone",void 0),a([c({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],r.prototype,"definitionExpression",void 0),a([c({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],r.prototype,"displayField",void 0),a([c({readOnly:!0,type:ho})],r.prototype,"editFieldsInfo",void 0),a([c({readOnly:!0})],r.prototype,"editingInfo",void 0),a([V("editingInfo")],r.prototype,"readEditingInfo",null),a([c({readOnly:!0})],r.prototype,"effectiveCapabilities",null),a([c()],r.prototype,"effectiveEditingEnabled",null),a([c((()=>{const i=E(cfe),s=i.json.origins;return s["web-map"]={read:!1,write:!1},s["portal-item"]={read:!1,write:!1},i})())],r.prototype,"elevationInfo",void 0),a([c()],r.prototype,"fieldsIndex",void 0),a([c({type:td,json:{name:"layerDefinition.floorInfo",write:{layerContainerTypes:qe}}})],r.prototype,"floorInfo",void 0),a([c({type:he,json:{origins:{service:{read:{source:"extent"}}}}})],r.prototype,"fullExtent",void 0),a([c()],r.prototype,"gdbVersion",void 0),a([c({readOnly:!0,type:ed,json:{read:{source:"geometryProperties"}}})],r.prototype,"geometryFieldsInfo",void 0),a([c({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:Mx.read}}}})],r.prototype,"geometryType",void 0),a([c({type:String})],r.prototype,"globalIdField",void 0),a([V("service","globalIdField",["globalIdField","fields"])],r.prototype,"readGlobalIdFieldFromService",null),a([c({readOnly:!0})],r.prototype,"hasFullEditingRestrictions",null),a([c({type:Boolean,json:{origins:{service:{read:!0}}}})],r.prototype,"hasM",void 0),a([c({readOnly:!0})],r.prototype,"hasUpdateItemRestrictions",null),a([c({type:Boolean,json:{origins:{service:{read:!0}}}})],r.prototype,"hasZ",void 0),a([c({readOnly:!0,type:zr})],r.prototype,"heightModelInfo",void 0),a([c({type:Date})],r.prototype,"historicMoment",void 0),a([c({type:H.ofType(_n),readOnly:!0})],r.prototype,"indexes",void 0),a([c({readOnly:!0})],r.prototype,"isTable",void 0),a([V("service","isTable",["type"])],r.prototype,"readIsTableFromService",null),a([c({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],r.prototype,"layerId",void 0),a([c(ffe)],r.prototype,"maxScale",void 0),a([V("service","maxScale",["maxScale","effectiveMaxScale"])],r.prototype,"readMaxScale",null),a([c(pfe)],r.prototype,"minScale",void 0),a([V("service","minScale",["minScale","effectiveMinScale"])],r.prototype,"readMinScale",null),a([c({type:String})],r.prototype,"objectIdField",void 0),a([V("service","objectIdField",["objectIdField","fields"])],r.prototype,"readObjectIdFieldFromService",null),a([c({readOnly:!0})],r.prototype,"parsedUrl",null),a([c(Mv("preferredTimeReference"))],r.prototype,"preferredTimeZone",void 0),a([c({type:[ki],readOnly:!0})],r.prototype,"relationships",void 0),a([c({type:Boolean})],r.prototype,"returnM",void 0),a([c({type:Boolean})],r.prototype,"returnZ",void 0),a([c({readOnly:!0,json:{write:!1}})],r.prototype,"serverGens",void 0),a([c({readOnly:!0})],r.prototype,"serviceDefinitionExpression",void 0),a([V("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],r.prototype,"readServiceDefinitionExpression",null),a([c({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],r.prototype,"serviceItemId",void 0),a([c()],r.prototype,"sourceJSON",void 0),a([c({type:Z,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],r.prototype,"spatialReference",void 0),a([c({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],r.prototype,"subtypeField",void 0),a([c({type:[po],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],r.prototype,"subtypes",void 0),a([c({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],r.prototype,"trackIdField",void 0),a([c({type:[String],readOnly:!0})],r.prototype,"uniqueIdFields",void 0),a([V("service","uniqueIdFields",["uniqueIdInfo.OIDFieldContainsHashValue","uniqueIdInfo.fields"])],r.prototype,"readUniqueIdFields",null),a([c(Kme({nonStandardUrlAllowed:!0}))],r.prototype,"url",void 0),a([c({json:{origins:{service:{read:!0}},read:!1}})],r.prototype,"version",void 0),a([V("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],r.prototype,"readVersion",null),a([c({readOnly:!0})],r.prototype,"isUrlHostModified",null),r=a([b("esri.layers.mixins.FeatureLayerBase")],r),r};let Tye=class extends Dm{constructor(e){super(),this.type="aggregate",this.featureReductionProvider=e}get id(){return this.featureReductionProvider.id}get[dy](){const e=this.featureReductionProvider.featureReduction;return e&&"popupTemplate"in e?e:null}},Oa=class extends pe(F){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};a([c({type:String,json:{write:!0}})],Oa.prototype,"expression",void 0),a([c({type:String,json:{write:!0}})],Oa.prototype,"title",void 0),a([c({type:String,json:{write:!0}})],Oa.prototype,"returnType",void 0),Oa=a([b("esri.layers.support.ExpressionInfo")],Oa);var Ex,uh;let Mr=(uh=class extends F{constructor(e){super(e),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new Ex({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:E(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}},Ex=uh,uh);a([c({type:Boolean,json:{write:!0}})],Mr.prototype,"isAutoGenerated",void 0),a([c({type:String,json:{write:!0}})],Mr.prototype,"name",void 0),a([c({type:String,json:{write:!0}})],Mr.prototype,"alias",void 0),a([c({type:String,json:{write:!0}})],Mr.prototype,"onStatisticField",void 0),a([c({type:Oa,json:{write:!0}})],Mr.prototype,"onStatisticExpression",void 0),a([c({type:String,json:{write:!0}})],Mr.prototype,"statisticType",void 0),Mr=Ex=a([b("esri.layers.support.AggregateField")],Mr);let Ga=class extends F{constructor(){super(...arguments),this.type=null}};a([c({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],Ga.prototype,"type",void 0),Ga=a([b("esri.layers.support.FeatureReduction")],Ga);const O3="__begin__",k3="__end__",Mye=new RegExp(O3,"ig"),Iye=new RegExp(k3,"ig"),ZP=new RegExp("^"+O3,"i"),JP=new RegExp(k3+"$","i"),ow='"',Eye=ow+" + ",Oye=" + "+ow;function kye(t){return t.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function Cye(t){return t.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function C3(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):t.labelExpression!=null&&(e.expression=kye(t.labelExpression),e.type="conventional"),e}function Pye(t){const e=C3(t);if(!e)return null;switch(e.type){case"conventional":return Ox(e.expression);case"arcade":return e.expression}return null}function Aye(t){const e=C3(t);if(!e)return null;switch(e.type){case"conventional":return Lye(e.expression);case"arcade":return B9(e.expression)}return null}function Ox(t){let e;return t?(e=sl(t,r=>O3+'$feature["'+r+'"]'+k3),e=ZP.test(e)?e.replace(ZP,""):ow+e,e=JP.test(e)?e.replace(JP,""):e+ow,e=e.replaceAll(Mye,Eye).replaceAll(Iye,Oye)):e='""',e}const Rye=/^\s*\{([^}]+)\}\s*$/i;function Lye(t){return t?.match(Rye)?.[1].trim()||null}const Fye=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,Nye=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,Dye=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function B9(t){if(!t)return null;let e=Fye.exec(t)||Nye.exec(t);return e?e[1]||e[3]:(e=Dye.exec(t),e?e[2]:null)}var kx,ch;let $o=(ch=class extends F{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(e,r){return r.value?Ox(r.value):e}writeExpression(e,r,i){this.value!=null&&(e=Ox(this.value)),e!=null&&(r[i]=e)}clone(){return new kx({expression:this.expression,title:this.title,value:this.value})}},kx=ch,ch);a([c({type:String,json:{write:{writerEnsuresNonNull:!0}}})],$o.prototype,"expression",void 0),a([V("expression",["expression","value"])],$o.prototype,"readExpression",null),a([q("expression")],$o.prototype,"writeExpression",null),a([c({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],$o.prototype,"title",void 0),a([c({json:{read:!1,write:!1}})],$o.prototype,"value",void 0),$o=kx=a([b("esri.layers.support.LabelExpressionInfo")],$o);var Cx;const bg=new $e({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function _g(t,e,r){return{enabled:!nS(r?.layer)}}function H9(t){return!t||t.origin!=="service"&&t.layer?.type!=="map-image"}function jye(t){return t?.type==="map-image"}function W9(t){return!!jye(t)&&!!t.capabilities?.exportMap?.supportsArcadeExpressionForLabeling}function Vye(t){return H9(t)||W9(t?.layer)}var dh;let Ye=(dh=class extends F{static evaluateWhere(e,r){const i=(s,n,o)=>{switch(n){case"=":return s==o;case"<>":return s!=o;case">":return s>o;case">=":return s>=o;case"<":return s<o;case"<=":return s<=o}return!1};try{if(e==null)return!0;const s=e.split(" ");if(s.length===3)return i(r[s[0]],s[1],s[2]);if(s.length===7){const n=i(r[s[0]],s[1],s[2]),o=s[3],l=i(r[s[4]],s[5],s[6]);switch(o){case"AND":return n&&l;case"OR":return n||l}}return!1}catch{}}constructor(e){super(e),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=ime,this.useCodedValues=void 0,this.where=null}readLabelExpression(e,r){const i=r.labelExpressionInfo;if(!i||!i.value&&!i.expression)return e}writeLabelExpression(e,r,i){if(this.labelExpressionInfo){if(this.labelExpressionInfo.value!=null)e=Cye(this.labelExpressionInfo.value);else if(this.labelExpressionInfo.expression!=null){const s=B9(this.labelExpressionInfo.expression);s&&(e="["+s+"]")}}e!=null&&(r[i]=e)}writeLabelExpressionInfo(e,r,i,s){if(e==null&&this.labelExpression!=null&&H9(s))e=new $o({expression:this.getLabelExpressionArcade()});else if(!e)return;const n=e.toJSON(s);n.expression&&(r[i]=n)}writeMaxScale(e,r){(e||this.minScale)&&(r.maxScale=e)}writeMinScale(e,r){(e||this.maxScale)&&(r.minScale=e)}getLabelExpression(){return C3(this)}getLabelExpressionArcade(){return Pye(this)}getLabelExpressionSingleField(){return Aye(this)}hash(){return JSON.stringify(this)}clone(){return new Cx({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:E(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:E(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}},Cx=dh,dh);a([c({type:String,json:{write:!0}})],Ye.prototype,"name",void 0),a([c({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:_g}}}}})],Ye.prototype,"allowOverrun",void 0),a([c({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:_g}}}}})],Ye.prototype,"deconflictionStrategy",void 0),a([c({type:String,json:{write:{overridePolicy(t,e,r){return this.labelExpressionInfo&&r?.origin==="service"&&W9(r.layer)?{enabled:!1}:{allowNull:!0}}}}})],Ye.prototype,"labelExpression",void 0),a([V("labelExpression")],Ye.prototype,"readLabelExpression",null),a([q("labelExpression")],Ye.prototype,"writeLabelExpression",null),a([c({type:$o,json:{write:{overridePolicy:(t,e,r)=>Vye(r)?{allowNull:!0}:{enabled:!1}}}})],Ye.prototype,"labelExpressionInfo",void 0),a([q("labelExpressionInfo")],Ye.prototype,"writeLabelExpressionInfo",null),a([c({type:bg.apiValues,json:{type:bg.jsonValues,read:bg.read,write:bg.write}})],Ye.prototype,"labelPlacement",void 0),a([c({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],Ye.prototype,"labelPosition",void 0),a([c({type:Number})],Ye.prototype,"maxScale",void 0),a([q("maxScale")],Ye.prototype,"writeMaxScale",null),a([c({type:Number})],Ye.prototype,"minScale",void 0),a([q("minScale")],Ye.prototype,"writeMinScale",null),a([c({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:_g}}}}})],Ye.prototype,"repeatLabel",void 0),a([c({type:Number,cast:Me,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:_g}}}}})],Ye.prototype,"repeatLabelDistance",void 0),a([c({types:Qie,json:{origins:{"web-scene":{types:Xie,write:LP,default:null}},write:LP,default:null}})],Ye.prototype,"symbol",void 0),a([c({type:Boolean,json:{write:!0}})],Ye.prototype,"useCodedValues",void 0),a([c({type:String,json:{write:!0}})],Ye.prototype,"where",void 0),Ye=Cx=a([b("esri.layers.support.LabelClass")],Ye);var Px;let Hs=Px=class extends F{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new Px({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?.clone()??null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};a([c({type:String,json:{write:!0}})],Hs.prototype,"description",void 0),a([c({type:String,json:{write:!0}})],Hs.prototype,"label",void 0),a([c({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],Hs.prototype,"minValue",void 0),a([c({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],Hs.prototype,"maxValue",void 0),a([c(_3)],Hs.prototype,"symbol",void 0),Hs=Px=a([b("esri.renderers.support.ClassBreakInfo")],Hs);var Ax;const Z9="log",q0="percent-of-total",G0="field",Sg=new $e({esriNormalizeByLog:Z9,esriNormalizeByPercentOfTotal:q0,esriNormalizeByField:G0}),zye=ut(Hs);let xt=Ax=class extends lp(Di){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,r){if(!Array.isArray(t))return;let i=e.minValue;return t.map(s=>{const n=new Hs;return n.read(s,r),n.minValue==null&&(n.minValue=i),n.maxValue==null&&(n.maxValue=n.minValue),i=n.maxValue,n})}writeClassBreakInfos(t,e,r,i){const s=t.map(n=>n.write({},i));this._areClassBreaksConsecutive()&&s.forEach(n=>delete n.classMinValue),e[r]=s}castField(t){return t==null?t:typeof t=="function"?(L.getLogger(this).error(".field: field must be a string value"),null):Km(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,r=this.normalizationTotal!=null;return e||r?(t=e&&G0||r&&q0||null,e&&r&&L.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==G0&&t!==q0||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,r){let i=null;i=typeof t=="number"?new Hs({minValue:t,maxValue:e,symbol:fj(r)}):zye(E(t)),this.classBreakInfos.push(i),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const r=this.classBreakInfos.length;for(let i=0;i<r;i++){const s=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(s[0]===t&&s[1]===e){this.classBreakInfos.splice(i,1);break}}}getBreakIndex(t,e){return this.valueExpression&&e?.arcade==null&&L.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let r=e;this.valueExpression&&e?.arcade==null&&(r={...r,arcade:await Fu()});const i=this.getBreakIndex(t,r);return i!==-1?this.classBreakInfos[i]:null}getSymbol(t,e){if(this.valueExpression&&e?.arcade==null)return void L.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const r=this.getBreakIndex(t,e);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let r=e;if(this.valueExpression&&e?.arcade==null){const s=await Fu(),{arcadeUtils:n}=s;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),r={...r,arcade:s}}const i=this.getBreakIndex(t,r);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}get symbols(){const t=[];return this.classBreakInfos.forEach(e=>{e.symbol&&t.push(e.symbol)}),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),r=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce((i,s)=>i+s.getMeshHash(),"")}.${r}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new Ax({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:E(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:E(this.visualVariables),legendOptions:E(this.legendOptions),authoringInfo:E(this.authoringInfo)})}async collectRequiredFields(t,e){const r=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(r)}async collectSymbolFields(t,e){const r=[...this.symbols.map(i=>i.collectRequiredFields(t,e)),Lr(t,e,null,this.valueExpression)];Ar(t,e,this.field),Ar(t,e,this.normalizationField),await Promise.all(r)}_getBreakIndexForExpression(t,e){const{viewingMode:r,scale:i,spatialReference:s,arcade:n,timeZone:o}=e??{},{valueExpression:l}=this;let u=this._compiledValueExpression.valueExpression===l?this._compiledValueExpression.compiledFunction:null;const d=n.arcadeUtils;if(!u){const f=d.createSyntaxTree(l);u=d.createFunction(f),this._compiledValueExpression.compiledFunction=u}this._compiledValueExpression.valueExpression=l;const p=d.executeFunction(u,d.createExecContext(t,d.getViewInfo({viewingMode:r,scale:i,spatialReference:s}),o));return this._getBreakIndexfromInfos(p)}_getBreakIndexForField(t){const e=this.field,r=t.attributes,i=this.normalizationType;let s=parseFloat(r[e]);if(i){const n=this.normalizationTotal,o=parseFloat(this.normalizationField?r[this.normalizationField]:void 0);if(i===Z9)s=Math.log(s)*Math.LOG10E;else if(i!==q0||n==null||isNaN(n)){if(i===G0&&!isNaN(o)){if(isNaN(s)||isNaN(o))return-1;s/=o}}else s=s/n*100}return this._getBreakIndexfromInfos(s)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(t!=null&&typeof t=="number"&&!isNaN(t))for(let r=0;r<this.classBreakInfos.length;r++){const i=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(i[0]<=t&&(e?t<=i[1]:t<i[1]))return r}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let r=1;r<e;r++)if(t[r-1].maxValue!==t[r].minValue)return!1;return!0}};a([c(S3)],xt.prototype,"backgroundFillSymbol",void 0),a([c({type:[Hs],json:{write:{isRequired:!0}}})],xt.prototype,"classBreakInfos",void 0),a([V("classBreakInfos")],xt.prototype,"readClassBreakInfos",null),a([q("classBreakInfos")],xt.prototype,"writeClassBreakInfos",null),a([c({type:String,json:{write:!0}})],xt.prototype,"defaultLabel",void 0),a([c(bb)],xt.prototype,"defaultSymbol",void 0),a([c({type:String,json:{write:!0}})],xt.prototype,"field",void 0),a([Ce("field")],xt.prototype,"castField",null),a([c({type:Boolean})],xt.prototype,"isMaxInclusive",void 0),a([c({type:$3,json:{write:!0}})],xt.prototype,"legendOptions",void 0),a([c({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],xt.prototype,"minValue",null),a([c({type:String,json:{write:!0}})],xt.prototype,"normalizationField",void 0),a([c({type:Number,json:{write:!0}})],xt.prototype,"normalizationTotal",void 0),a([c({type:Sg.apiValues,value:null,json:{type:Sg.jsonValues,read:Sg.read,write:Sg.write}})],xt.prototype,"normalizationType",null),a([se({classBreaks:"class-breaks"})],xt.prototype,"type",void 0),a([c({type:String,json:{write:!0}})],xt.prototype,"valueExpression",void 0),a([c({type:String,json:{write:!0}})],xt.prototype,"valueExpressionTitle",void 0),xt=Ax=a([b("esri.renderers.ClassBreaksRenderer")],xt);const Rx=-3,Uye=Rx-1,qye=!!k("esri-tests-disable-gpu-memory-measurements");let Gye=class{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._users=new Map,this._sizeLimits=new Map}destroy(){this.clearAll(),this._sizeLimits.clear(),this._users.clear(),this._db=null}register(e){this._users.set(e.id.slice(0,-1),e)}deregister(e){this.clear(e),this._sizeLimits.delete(e),this._users.delete(e.id.slice(0,-1))}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,r){return this._db.get(e.id+r)?.size??0}put(e,r,i,s,n){r=e.id+r;const o=this._db.get(r);if(o&&(this._size-=o.size,e.size-=o.size,this._db.delete(r),o.entry!==i&&this._notifyRemove(r,o.entry,o.size,0)),s>this._maxSize)return void this._notifyRemove(r,i,s,0);if(i===void 0)return void console.warn("Refusing to cache undefined entry ");if(!s||s<0)return qye||console.warn(`Refusing to cache entry with size ${s} for key ${r}`),void this._notifyRemove(r,i,0,0);const l=1+Math.max(n,Uye)-Rx;this._db.set(r,new Bye(i,s,l)),this._size+=s,e.size+=s,this._checkSize()}updateSize(e,r){r=e.id+r;const i=this._db.get(r);if(!i)return;this._size-=i.size,e.size-=i.size;let s=i.entry.usedMemory;for(;s>this._maxSize;){const n=this._notifyRemove(r,i.entry,s,1);if(!(n!=null&&n>0))return void this._db.delete(r);s=n}i.size=s,this._size+=s,e.size+=s,this._checkSize()}pop(e,r){r=e.id+r;const i=this._db.get(r);if(i)return this._size-=i.size,e.size-=i.size,this._db.delete(r),++this._hit,i.entry;++this._miss}get(e,r){r=e.id+r;const i=this._db.get(r);if(i!==void 0)return this._db.delete(r),i.lives=i.lifetime,this._db.set(r,i),++this._hit,i.entry;++this._miss}peek(e,r){const i=this._db.get(e.id+r);return i?++this._hit:++this._miss,i?.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},r={},i=new Array;this._db.forEach((o,l)=>{const u=o.lifetime;i[u]=(i[u]||0)+o.size,this._users.forEach(d=>{const{id:p,name:f}=d;if(l.startsWith(p)){const m=r[f]||0;r[f]=m+o.size}})});const s={};this._users.forEach(o=>{const l=o.name;if("hitRate"in o&&typeof o.hitRate=="number"&&!isNaN(o.hitRate)&&o.hitRate>0){const u=r[l]||0;r[l]=u,s[l]=Math.round(100*o.hitRate)+"%"}else s[l]="0%"});const n=Object.keys(r);n.sort((o,l)=>r[l]-r[o]),n.forEach(o=>e[o]=Math.round(r[o]/2**20)+"MB / "+s[o]);for(let o=i.length-1;o>=0;--o){const l=i[o];l&&(e["Priority "+(o+Rx-1)]=Math.round(l/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forEach(e=>e.resetHitRate())}clear(e){const r=e.id;this._db.forEach((i,s)=>{s.startsWith(r)&&(this._size-=i.size,this._db.delete(s),this._notifyRemove(s,i.entry,i.size,0))}),e.size=0}clearAll(){this._db.forEach((e,r)=>this._notifyRemove(r,e.entry,e.size,0)),this._users.forEach(e=>e.size=0),this._size=0,this._db.clear()}*values(e){for(const[r,i]of this._db)r.startsWith(e.id)&&(yield i.entry)}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,r,i,s){const n=this._users.get(e.split(o_)[0])?.removeFunc,o=n?.(r,s,i);return typeof o=="number"?o:null}_checkSize(){this._sizeLimits.forEach((e,r)=>this._checkSizeLimits(e,r)),this._checkSizeLimits(this.maxSize)}setMaxSize(e,r){r==null||r<=0?this._sizeLimits.delete(e):this._sizeLimits.set(e,r)}_checkSizeLimits(e,r){const i=r??this;if(i.size<=e)return;const s=r?.id;let n=!0;for(;n;){n=!1;for(const[o,l]of this._db)if(l.lifetime===0&&(!s||o.startsWith(s))){const u=r??this._users.get(o.split(o_)[0]);if(this._purgeItem(o,l,u),i.size<=.9*e)return;n||=this._db.has(o)}}for(const[o,l]of this._db)if(!s||o.startsWith(s)){const u=r??this._users.get(o.split(o_)[0]);if(this._purgeItem(o,l,u),i.size<=.9*e)return}}_purgeItem(e,r,i){if(this._db.delete(e),r.lives<=1){this._size-=r.size,i&&(i.size-=r.size);const s=this._notifyRemove(e,r.entry,r.size,1);s!=null&&s>0&&(this._size+=s,i&&(i.size+=s),r.lives=r.lifetime,r.size=s,this._db.set(e,r))}else--r.lives,this._db.set(e,r)}},Bye=class{constructor(e,r,i){this.entry=e,this.size=r,this.lifetime=i,this.lives=i}};const o_=":";let Hye=class{constructor(e,r){this.removeFunc=r,this._storage=new Gye,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this)}destroy(){this._storage.deregister(this),this._storage.destroy(),this._storage=null}put(e,r,i=1){this._storage.put(this,e,r,i,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}},YP=class J9{static parse(e,r,i){const s=[],n=[],o=e.split(";");for(let l=0;l<o.length;l++){const u=o[l];if(u){if(u.includes("po:")){const d=u.slice(3).split("|");if(d.length===3){const[p,f,m]=d,y=Zye(p,f,m);y&&n.push(y)}continue}if(u.includes("|")){for(const d of u.split("|"))if(r.has(d)){s.push(d);break}}else if(r.has(u))s.push(u);else if(l===0){s.length=0,s.push(Jye(i));break}}}return new J9(s,n)}constructor(e,r){this.partNames=e,this.overrides=r}};function Wye(t,e){if(t==="DashTemplate")return e.split(" ").map(r=>Number(r));if(t==="Color"){const r=new ue(e).toRgba();return[r[0],r[1],r[2],255*r[3]]}return Number(e)}function Zye(t,e,r){return{primitiveName:t,propertyName:e,value:Wye(e,r),defaultValue:null}}function Jye(t){switch(t){case"esriGeometryPolyline":return"Invalid_L";case"esriGeometryPolygon":return"Invalid_A";default:return"Invalid_P"}}var hh;let En=(hh=class{},hh.instance=new bi("Etc/UTC"),hh);function Yye(t){return t instanceof Hu?t===En.instance:t?.toString().toLowerCase()==="unknown"}function kEe(t){return Yye(t)?En.instance:t}function Kye(t){return"timeZone"in t}function Qye(t){return"timeZone"in t}function Xye(t){return"dateFieldsTimeZone"in t}const ege=new Map;let aw=class B0{static fromJSON(e){return new B0(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new B0(e.fields??[],QP(e))}static fromLayerJSON(e){return new B0(e.fields??[],QP(e))}constructor(e=[],r){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=r?new Map(r):null;const i=[];for(const s of this.fields){const n=s?.name,o=KP(n);if(n&&o){const l=Ql(n);this._fieldsMap.set(n,s),this._fieldsMap.set(l,s),this._normalizedFieldsMap.set(o,s),i.push(`${l}:${s.type}:${this._timeZoneByFieldName?.get(n)}`),v4(s)?(this.dateFields.push(s),this._dateFieldsSet.add(s)):OM(s)&&(this._numericFieldsSet.add(s),this.numericFields.push(s)),GO(s)||BO(s)||(s.editable=s.editable==null||!!s.editable,s.nullable=s.nullable==null||!!s.nullable)}}i.sort(),this.uid=i.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)GO(e)||BO(e)||e.nullable||vre(e)!==void 0||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return this.get(e)!=null}get(e){if(!e)return;let r=this._fieldsMap.get(e);return r||(r=this._fieldsMap.get(Ql(e))??this._normalizedFieldsMap.get(KP(e)),r&&this._fieldsMap.set(e,r),r)}getTimeZone(e){const r=this.get(e&&typeof e!="string"?e.name:e);return r?this._timeZoneByFieldName?this._timeZoneByFieldName.get(r.name):r.type==="date"||r.type==="esriFieldTypeDate"?(L.getLogger("esri.layers.support.FieldsIndex").errorOnce(new x("getTimeZone:no-timezone-information",`no time zone information for field '${r.name}'`)),Qa):Y9.has(r.type)?Ka:null:null}getLuxonTimeZone(e){const r=this.getTimeZone(e);return r?r===Ka?En.instance:r===Qa?Rt.utcInstance:jh(ege,r,()=>bi.create(r)):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return w4(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map(e=>pm(e)?e.toJSON():e),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}};function Ql(t){return t.trim().toLowerCase()}function KP(t){return sre(t)?.toLowerCase()??""}const Y9=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function QP(t){const e=new Map;if(!t.fields)return e;const r=t.datesInUnknownTimezone===!0,{timeInfo:i,editFieldsInfo:s}=t,n=(i?"startField"in i?i.startField:i.startTimeField:"")??"",o=(i?"endField"in i?i.endField:i.endTimeField:"")??"",l=Xye(t)?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?Ug(t.dateFieldsTimeReference):null,u=s?Kye(s)?s.timeZone??l:s.dateFieldsTimeReference?Ug(s.dateFieldsTimeReference):l??Qa:null,d=i?Qye(i)?i.timeZone??l:i.timeReference?Ug(i.timeReference):l:null,p=new Map([[Ql(s?.creationDateField??""),u],[Ql(s?.editDateField??""),u],[Ql(n),d],[Ql(o),d]]);for(const{name:f,type:m}of t.fields)if(Y9.has(m))e.set(f,Ka);else if(m!=="date"&&m!=="esriFieldTypeDate")e.set(f,null);else if(r)e.set(f,Ka);else{const y=p.get(Ql(f??""))??l;e.set(f,y)}return e}const K9={TypeNotAllowedInFeature:"Feature attributes only support dates, numbers, strings, guids.",LogicError:"Logic error - {reason}",CannotCompareDateAndTime:"Cannot compare date or dateonly with timeonly types",NeverReach:"Encountered unreachable logic",AsyncNotEnabled:"Async Arcade must be enabled for this script",ModuleAccessorMustBeString:"Module accessor must be a string",ModuleExportNotFound:"Module has no export with provided identifier",ModulesNotSupported:"Current profile does not support modules",ArrayAccessMustBeNumber:"Array accessor must be a number",FunctionNotFound:"Function not found",FieldNotFound:"Key not found - {key}",CircularModules:"Circular module dependencies are not allowed",Cancelled:"Execution cancelled",UnsupportedHashType:"Type not supported in hash function",IllegalResult:"Value is not a supported return type",PortalRequired:"Portal is required",InvalidParameter:"Invalid parameter",WrongNumberOfParameters:"Call with wrong number of parameters",Unrecognized:"Unrecognized code structure",UnrecognizedType:"Unrecognized type",WrongSpatialReference:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",BooleanConditionRequired:"Conditions must use booleans",NoFunctionInDictionary:"Dictionaries cannot contain functions.",NoFunctionInArray:"Arrays cannot contain functions.",NoFunctionInTemplateLiteral:"Template Literals do not expect functions by value.",KeyAccessorMustBeString:"Accessor must be a string",KeyMustBeString:"Object keys must be a string",Immutable:"Object is immutable",UnexpectedToken:"Unexpected token",MemberOfNull:"Cannot access property of null object",MaximumCallDepth:"Exceeded maximum function depth",OutOfBounds:"Out of bounds",InvalidIdentifier:"Identifier not recognized",CallNonFunction:"Expression is not a function",InvalidMemberAccessKey:"Cannot access value using a key of this type",AssignModuleFunction:"Cannot assign function to module variable",UnsupportUnaryOperator:"Unsupported unary operator",UnsupportedOperator:"Unsupported operator",LogicalExpressionOnlyBoolean:"Logical expressions must be boolean",LogicExpressionOrAnd:"Logical expression can only be combined with || or &&",CannotChangeTimeZoneTime:"Cannot change the timezone of a Time",CannotChangeTimeZoneDateOnly:"Cannot change the timezone of a DateOnly",FeatureSetDoesNotHaveSubtypes:"FeatureSet does not have subtypes"};let tge=class extends Error{constructor(...e){super(...e)}},XP=class Q9 extends tge{constructor(e,r){super(P3(r)+e.message,{cause:e}),this.loc=null,Error.captureStackTrace&&Error.captureStackTrace(this,Q9),r?.loc&&(this.loc=r.loc)}},rge=class X9 extends Error{constructor(e,r,i,s){super("Execution error - "+P3(i)+sl(K9[r],s)),this.loc=null,this.declaredRootClass="esri.arcade.arcadeexecutionerror",Error.captureStackTrace&&Error.captureStackTrace(this,X9),i?.loc&&(this.loc=i.loc)}};function P3(t){return t&&t.loc?`Line : ${t.loc.start?.line}, ${t.loc.start?.column}: `:""}let PEe=class eV extends Error{constructor(e,r,i,s){super("Compilation error - "+P3(i)+sl(K9[r],s)),this.loc=null,this.declaredRootClass="esri.arcade.arcadecompilationerror",Error.captureStackTrace&&Error.captureStackTrace(this,eV),i?.loc&&(this.loc=i.loc)}},AEe=class tV extends Error{constructor(){super("Uncompilable code structures"),this.declaredRootClass="esri.arcade.arcadeuncompilableerror",Error.captureStackTrace&&Error.captureStackTrace(this,tV)}};function REe(t,e,r){return r.declaredRootClass==="esri.arcade.arcadeexecutionerror"||r.declaredRootClass==="esri.arcade.arcadecompilationerror"?r.loc===null&&e?.loc?new XP(r,{cause:r}):r:(r.declaredRootClass==="esri.arcade.featureset.support.featureseterror"||r.declaredRootClass==="esri.arcade.featureset.support.sqlerror"||r.declaredRootClass,e?.loc?new XP(r,{cause:r}):r)}const ige={UnrecognizedUri:"Unrecognized uri - {uri}",UnsupportedUriProtocol:"Unrecognized uri protocol"};let LEe=class rV extends Error{constructor(e,r){super(sl(ige[e],r)),this.declaredRootClass="esri.arcade.arcademoduleerror",Error.captureStackTrace&&Error.captureStackTrace(this,rV)}};function H0(t){return t.toLowerCase().replaceAll(/[\s-]+/g,"")}let FEe=class{constructor(e,r){const i=new Map;for(const s of e){const n=H0(s);if(i.has(n))throw new Error(`${s} already added as ${i.get(n)}`);i.set(n,s)}if(r!=null)for(const[s,n]of r){const o=H0(s);if(i.has(o))throw new Error(`${s} already associated with ${i.get(o)}`);i.set(o,n)}this._enumMap=i}lookup(e){return this._enumMap.get(H0(e))}get(e){const r=this.lookup(e);if(r==null)throw new rge(null,"InvalidParameter",null);return r}};const sge={TimeZoneNotRecognized:"Timezone identifier has not been recognized."};let nge=class iV extends Error{constructor(e,r){super(sl(sge[e],r)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,iV)}};function fc(t,e,r){return t<e?t-e:t>r?t-r:0}function mc(t,e,r){return t<e?e:t>r?r:t}let Ao=class St{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,r=1,i=1,s=0,n=0,o=0,l=0,u){if(isNaN(e)||isNaN(r)||isNaN(i)||isNaN(s)||isNaN(n)||isNaN(o)||isNaN(l))return null;const d=Y.local(e,r).daysInMonth;let p=Y.fromObject({day:mc(i,1,d),year:e,month:mc(r,1,12),hour:mc(s,0,23),minute:mc(n,0,59),second:mc(o,0,59),millisecond:mc(l,0,999)},{zone:$n(u)});return p=p.plus({months:fc(r,1,12),days:fc(i,1,d),hours:fc(s,0,23),minutes:fc(n,0,59),seconds:fc(o,0,59),milliseconds:fc(l,0,999)}),new St(p)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,r){const i=$n(r);return e.isUnknownTimeZone||i===En.instance?St.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,i):new St(e._date.setZone(i))}static dateJSToArcadeDate(e){return new St(Y.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,r="system"){const i=$n(r);return new St(Y.fromJSDate(e,{zone:i}))}static unknownEpochToArcadeDate(e){return new St(Y.fromMillis(e,{zone:En.instance}))}static unknownDateJSToArcadeDate(e){return new St(Y.fromMillis(e.getTime(),{zone:En.instance}))}static epochToArcadeDate(e,r="system"){const i=$n(r);return new St(Y.fromMillis(e,{zone:i}))}static dateTimeToArcadeDate(e){return new St(e)}clone(){return new St(this._date)}changeTimeZone(e){const r=$n(e);return St.dateTimeToArcadeDate(this._date.setZone(r))}static dateTimeAndZoneToArcadeDate(e,r){const i=$n(r);return e.zone===En.instance||i===En.instance?St.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,i):new St(e.setZone(i))}static nowToArcadeDate(e){const r=$n(e);return new St(Y.fromJSDate(new Date,{zone:r}))}static nowUTCToArcadeDate(){return new St(Y.utc())}get isSystem(){return this.timeZone==="system"||this.timeZone===St.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===En.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if(this._date.zone.type==="system")return"system";const e=this.zone;return e.type==="fixed"?e.fixed===0?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new St(this._date.plus(e))}diff(e,r){return this._date.diff(e._date,r)[r]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,r){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:r&&!this.isUnknownTimeZone})}toFormat(e,r){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,r)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new St(this._date.toUTC())}toLocal(){return new St(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const r=Y.fromISO(e,{setZone:!0});return new St(r)}};function $n(t,e=!0){if(t instanceof Hu)return t;switch(H0(t)){case"system":return"system";case"utc":return"UTC";case"unknown":return En.instance}if(/^[+-]?[0-9]{1,2}(:[0-9]{2})?$/.test(t)){const i=Rt.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(i)return i}const r=bi.create(t);if(!r.isValid){if(e)throw new nge("TimeZoneNotRecognized");return null}return r}function eA(t){t=t.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$&]");let e="";const r=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const i of t.match(r)||[])switch(i){case"D":e+="d";break;case"DD":e+="dd";break;case"DDD":e+="o";break;case"d":e+="c";break;case"ddd":e+="ccc";break;case"dddd":e+="cccc";break;case"M":e+="L";break;case"MM":e+="LL";break;case"MMM":e+="LLL";break;case"MMMM":e+="LLLL";break;case"YY":e+="yy";break;case"Y":case"YYYY":e+="yyyy";break;case"Q":e+="q";break;case"X":case"x":e+=i;break;default:i.length>=2&&i.startsWith("[")&&i.endsWith("]")?e+=`'${i.slice(1,-1)}'`:e+=`'${i}'`}return e}const tA="esri.core.sql.dateonly";let oge=class Ci{constructor(e,r,i){this._year=e,this._month=r,this._day=i,this.declaredRootClass=tA}static isDateOnly(e){return typeof e=="object"&&e!=null&&"declaredRootClass"in e&&e.declaredRootClass===tA}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(e){return Ci.isDateOnly(e)&&e.day===this.day&&e.month===this.month&&e.year===this.year}clone(){return new Ci(this._year,this._month,this._day)}toDateTime(e){return Y.fromObject({day:this.day,month:this.month,year:this.year},{zone:$n(e)})}toDateTimeLuxon(e){return Y.fromObject({day:this.day,month:this.month,year:this.year},{zone:$n(e)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(e=null,r=!0){if(e===null||e==="")return this.toString();if(r&&(e=eA(e)),!e)return"";const i=this.toDateTime("unknown");return Ao.dateTimeToArcadeDate(i).toFormat(e,{locale:gi(),numberingSystem:"latn"})}toArcadeDate(){const e=this.toDateTime("unknown");return Ao.dateTimeToArcadeDate(e)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(e,r){return Ci.fromDateTime(this.toUTCDateTime().plus({[e]:r}))}toUTCDateTime(){return Y.utc(this.year,this.month,this.day,0,0,0,0)}difference(e,r){switch(r.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return r==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}static fromMilliseconds(e){const r=Y.fromMillis(e,{zone:Rt.utcInstance});return r.isValid?Ci.fromParts(r.year,r.month,r.day):null}static fromSeconds(e){const r=Y.fromSeconds(e,{zone:Rt.utcInstance});return r.isValid?Ci.fromParts(r.year,r.month,r.day):null}static fromReader(e){if(!e)return null;const r=e.split("-");return r.length!==3?null:new Ci(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10))}static fromParts(e,r,i){const s=new Ci(e,r,i);return s.isValid===!1?null:s}static fromDateJS(e){return Ci.fromParts(e.getFullYear(),e.getMonth()+1,e.getDay())}static fromDateTime(e){return Ci.fromParts(e.year,e.month,e.day)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,r=null){if(e===""||e===null)return null;const i=[];if(r)(r=eA(r))&&i.push(r);else if(r===null||r===""){const s=Y.fromISO(e,{setZone:!0});return s.isValid?Ci.fromParts(s.year,s.month,s.day):null}for(const s of i){const n=Y.fromFormat(e,r??s);if(n.isValid)return new Ci(n.year,n.month,n.day)}return null}static fromNow(e="system"){const r=Y.fromJSDate(new Date).setZone($n(e));return new Ci(r.year,r.month,r.day)}};function DEe(t){if(t==null)return null;switch(t.type){case"polygon":case"multipoint":case"polyline":return t.extent;case"point":return new he({xmin:t.x,ymin:t.y,xmax:t.x,ymax:t.y,spatialReference:t.spatialReference});case"extent":return t}return null}function jEe(t){if(t==null)return null;const e=t.clone();return t.cache._geVersion!==void 0&&(e.cache._geVersion=t.cache._geVersion),e}function $g(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function rA(t){if(!t)return"";const e=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let r="";for(const i of t.match(e)||[])switch(i){case"SSS":case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":r+=i;break;case"A":case"a":r+="a";break;default:r+=`'${i}'`}return r}const iA="esri.core.sql.timeonly";let age=class vn{constructor(e,r,i,s){this._hour=e,this._minute=r,this._second=i,this._millisecond=s,this.declaredRootClass=iA}static isTimeOnly(e){return typeof e=="object"&&e!=null&&"declaredRootClass"in e&&e.declaredRootClass===iA}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(e){return vn.isTimeOnly(e)&&e.hour===this.hour&&e.minute===this.minute&&e.second===this.second&&e.millisecond===this.millisecond}clone(){return new vn(this.hour,this.minute,this.second,this.millisecond)}isValid(){return $g(this.hour)&&$g(this.minute)&&$g(this.second)&&$g(this.millisecond)&&this.hour>=0&&this.hour<24&&this.minute>=0&&this.minute<60&&this.second>=0&&this.second<60&&this.millisecond>=0&&this.millisecond<1e3}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(e=null){return e===null||e===""?this.toString():(e=rA(e))?Y.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(e,{locale:gi(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1e3*this.second+1e3*this.minute*60+60*this.hour*60*1e3}static fromParts(e,r,i,s){const n=new vn(e,r,i,s);return n.isValid()?n:null}static fromReader(e){if(!e)return null;const r=e.split(":");return r.length!==3?null:new vn(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10),0)}static fromMilliseconds(e){if(e>864e5||e<0)return null;const r=Math.floor(e/1e3%60),i=Math.floor(e/6e4%60),s=Math.floor(e/36e5%24),n=Math.floor(e%1e3);return new vn(s,i,r,n)}static fromDateJS(e){return new vn(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}static fromDateTime(e){return new vn(e.hour,e.minute,e.second,e.millisecond)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,r=null){if(e===""||e===null)return null;const i=[];r?(r=rA(r))&&i.push(r):r!==null&&r!==""||(i.push("HH:mm:ss"),i.push("HH:mm:ss.SSS"),i.push("hh:mm:ss a"),i.push("hh:mm:ss.SSS a"),i.push("HH:mm"),i.push("hh:mm a"),i.push("H:mm"),i.push("h:mm a"),i.push("H:mm:ss"),i.push("h:mm:ss a"),i.push("H:mm:ss.SSS"),i.push("h:mm:ss.SSS a"));for(const s of i){const n=Y.fromFormat(e,s);if(n.isValid)return new vn(n.hour,n.minute,n.second,n.millisecond)}return null}plus(e,r){switch(e){case"days":case"years":case"months":return this.clone();case"hours":case"minutes":case"seconds":case"milliseconds":return vn.fromDateTime(this.toUTCDateTime().plus({[e]:r}))}return null}toUTCDateTime(){return Y.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(e,r){switch(r.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return r==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}};const lge=["geometry","scale","timeProperties"];function VEe(t,e){if(e!=null)for(const r of lge)e.hasArcadeDependency(r)&&t.add(r);return t}function zEe(t,e){return sV.create(t,e,null,["$feature","$view"])}function uge(t,e,r){return sV.create(t,e,r,["$feature","$view","$config"])}let sV=class nV{static async create(e,r,i,s){const{arcade:n,Dictionary:o}=await Fu();let l;try{l=n.parseScript(e)}catch(y){throw new x("arcade-bad-expression","Failed to parse arcade script",{script:e,error:y})}const u=n.scriptUsesGeometryEngine(l);u&&await n.enableGeometrySupport(),await n.loadDependentModules(new Set,l,null,!1,u);const d={vars:s.reduce((y,g)=>({...y,[g]:null}),{}),spatialReference:r,useAsync:!1},p=n.compileScript(l,d);let f=null;i!=null&&(f=new o(i),f.immutable=!0);const m=new o;return m.immutable=!1,m.setField("scale",0),new nV(e,n,l,p,r,m,f,o)}constructor(e,r,i,s,n,o,l,u){this.script=e,this._arcade=r,this._syntaxTree=i,this._compiled=s,this._spatialReference=n,this._viewDict=o,this._configDict=l,this._dictionaryCtor=u,this._dependencies=new Map,this._featureReader=new oV,this._dependencies.set("geometry",r.scriptTouchesGeometry(this._syntaxTree)),this._dependencies.set("scale",this._arcade.referencesMember(this._syntaxTree,"scale")),this._dependencies.set("timeProperties",this._arcade.scriptUsesViewProperties(this._syntaxTree,["timeProperties"]))}evaluate(e,r){const i=r.$view?.timeZone;if(r.$view){let s;if(this._viewDict.setField("scale",r.$view.scale),r.$view.timeProperties!=null){const{currentStart:n,currentEnd:o}=r.$view.timeProperties;s=new this._dictionaryCtor({currentStart:n!=null?i!=null?Ao.epochToArcadeDate(n,i):Ao.unknownEpochToArcadeDate(n):void 0,currentEnd:o!=null?i!=null?Ao.epochToArcadeDate(o,i):Ao.unknownEpochToArcadeDate(o):void 0,startIncluded:!0,endIncluded:!0})}this._viewDict.setField("timeProperties",s)}return this._compiled({vars:{$view:this._viewDict,$config:this._configDict,$feature:e},spatialReference:this._spatialReference,timeZone:i})}repurposeFeature(e,r){return this._featureReader.bind(e,r,this._spatialReference),this._featureReader}references(e){return this._dependencies.get(e)??!1}},oV=class{constructor(){this._boundTarget=null,this._boundSchema={fields:null,fieldsIndex:null,spatialReference:null,get geometryType(){return null},get objectIdField(){return null}},this.arcadeDeclaredClass="esri.arcade.Feature",this._contextTimeZone=null}bind(e,r,i){const s=r??new aw(aV(e.attributes));this._boundTarget=e,this._boundSchema.fields=s.fields,this._boundSchema.fieldsIndex=s,this._boundSchema.spatialReference=i}_getField(e){return this._boundSchema.fieldsIndex.get(e)}get contextTimeZone(){return this._contextTimeZone}set contextTimeZone(e){this._contextTimeZone=e}readArcadeFeature(){return this}hasField(e){return this._boundSchema.fieldsIndex.has(e)}geometry(){if("fromJSON"in this._boundTarget)return this._boundTarget.geometry;const e=tl(this._boundTarget.geometry);if(e){if(!this._boundSchema.spatialReference)throw new Error("InternalError: Expected spatial reference to be defined");e.spatialReference=this._boundSchema.spatialReference}return e}_hasGeometry(){return this._boundTarget.geometry!=null}isUnknownDateTimeField(e){return this._boundSchema.fieldsIndex.getTimeZone(e)===Ka}field(e,r=!0){const i=this._getField(e);if(i){const s=this._boundTarget.attributes[i.name];if(s==null)return null;switch(i.type){case"date-only":case"esriFieldTypeDateOnly":return oge.fromReader(s);case"time-only":case"esriFieldTypeTimeOnly":return age.fromReader(s);case"esriFieldTypeTimestampOffset":case"timestamp-offset":return Ao.fromReaderAsTimeStampOffset(s);case"date":case"esriFieldTypeDate":return this.isUnknownDateTimeField(e)?Ao.unknownEpochToArcadeDate(s):Ao.epochToArcadeDate(s,this.contextTimeZone??rn);default:return s}}if(r)throw new Error(`Field ${e} does not exist`);return null}setField(e,r){throw new Error("Unable to update feature attribute values, feature is readonly")}keys(){return this._boundSchema.fieldsIndex.fields.map(e=>e.name)}isEmpty(){return this._boundSchema.fields.length<=0&&!this._hasGeometry()}castToText(e=!1){return JSON.stringify(this._boundTarget)}gdbVersion(){return null}fullSchema(){return this._boundSchema}castAsJson(e=null){return{attributes:this._boundTarget.attributes,geometry:e?.keepGeometryType===!0?this.geometry():this.geometry()?.toJSON()??null}}castAsJsonAsync(e=null,r=null){return Promise.resolve(this.castAsJson(r))}};function aV(t){const e=[];for(const r in t)e.push({name:r,alias:r,type:typeof t[r]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"});return e}let cge=class lV{static async from(e,r,i){const s=e.dictionary_version?V8.parse(e.dictionary_version):null,n=new Set(e.itemsNames),o={};if(r)for(const f in r)o[f]=r[f];if(e.authoringInfo.configuration)for(const f of e.authoringInfo.configuration)o.hasOwnProperty(f.name)||(o[f.name]=f.value);const l=new Set(e.authoringInfo.symbol);for(const f of Object.keys(i))l.delete(f);l.size&&L.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("missing-fields: fieldMap entries for the following symbol fields are missing",{symbolFields:l});const u=await uge(e.expression,null,o);if(!u)throw new x("dictionary-renderer:expression-error","Unable to create dictionary renderer expression");const d=!s||!s.greaterEqual(4,0);d&&L.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("Dictionary script does not support native field types. Applying fallback",{version:s});const p=new dge(i,d);return new lV(d,n,u,p)}constructor(e,r,i,s){this._requiresFieldCoercionToString=e,this._itemNames=r,this._compiled=i,this._reader=s}get itemNames(){return this._itemNames}evaluate(e,r,i,s){try{return this._reader.bind(e,i,s),this._compiled.evaluate(this._reader,{$view:{scale:r}})}catch(n){L.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("arcade: dictionary script evaluation failed",{error:n})}return null}createDictionaryFieldsIndex(e){if(!this._requiresFieldCoercionToString)return new aw(e);const r=e.map(i=>({...i,type:"esriFieldTypeString"}));return new aw(r)}},dge=class extends oV{constructor(e,r){super(),this._fieldMap=e,this._requiresFieldCoercionToString=r}_getField(e){const r=this._fieldMap[e]??e;return this._boundSchema.fieldsIndex.get(r)}field(e){if(!this._requiresFieldCoercionToString)return super.field(e,!1);const r=this._getField(e);return r==null||this._boundTarget.attributes[r.name]==null?"":""+this._boundTarget.attributes[r.name]}};const sA={Relative:0,Absolute:1},hge={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},Lx={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1,gradientMethod:"AcrossLine",gradientSize:75,gradientSizeUnits:sA.Relative,gradientType:"Discrete",interval:5},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGradientFill:{enable:!0,angle:90,gradientMethod:"Linear",gradientSize:75,gradientSizeUnits:sA.Relative,gradientType:"Discrete",interval:5},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRadial:{angle:0,length:5},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:"Loop",repeatdelay:0,easing:"Linear"},CIMSymbolAnimationSize:{tosize:10},CIMSymbolAnimationScale:{scalefactor:1},CIMSymbolAnimationColor:{tocolor:[255,255,255,1]},CIMSymbolAnimationTransparency:{totransparency:0},CIMSymbolAnimationRotation:{torotation:0,rotateclockwise:!1},CIMSymbolAnimationOffset:{offsetx:0,offsety:0},CIMSymbolAnimationMoveAlongLine:{speed:30,distanceAlong:100}};function pge(t){return typeof t=="function"}function GEe(t,e,r,i){return pge(t)?t(e,r,i):t}function BEe(t){return[t.r,t.g,t.b,t.a]}const fge=` /-,
`;function nA(t){let e=t.length;for(;e--;)if(!fge.includes(t.charAt(e)))return!1;return!0}function HEe(t,e){const r=[];let i=0,s=-1;do if(s=t.indexOf("[",i),s>=i){if(s>i){const n=t.slice(i,s);r.push([n,null,nA(n)])}if(i=s+1,s=t.indexOf("]",i),s>=i){if(s>i){const n=e[t.slice(i,s)];n&&r.push([null,n,!1])}i=s+1}}while(s!==-1);if(i<t.length){const n=t.slice(i);r.push([n,null,nA(n)])}return r}function WEe(t,e,r){let i="",s=null;for(const n of e){const[o,l,u]=n;if(o!=null&&o!=="")u?s=o:(s!=null&&(i+=s,s=null),i+=o);else{const d=t.readAttribute(l);d!=null&&d!==""&&(s!==null&&(i+=s,s=null),i+=d)}}return uV(i,r)}function ZEe(t,e,r,i){let s="",n=null;for(const o of e){const[l,u,d]=o;if(l!=null&&l!=="")d?n=l:(n!=null&&(s+=n,n=null),s+=l);else{let p=u;r!=null&&(p=Sge(u,r));const f=t.attributes[p];f!=null&&f!==""&&(n!=null&&(s+=n,n=null),s+=f)}}return uV(s,i)}function uV(t,e){switch(typeof t!="string"&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function JEe(t,e,r,i,s,n,o=!0){const l=e/s,u=r/n,d=Math.ceil(l/2),p=Math.ceil(u/2);for(let f=0;f<n;f++)for(let m=0;m<s;m++){const y=4*(m+(o?n-f-1:f)*s);let g=0,v=0,_=0,S=0,M=0,C=0,T=0;const O=(f+.5)*u;for(let P=Math.floor(f*u);P<(f+1)*u;P++){const D=Math.abs(O-(P+.5))/p,z=(m+.5)*l,B=D*D;for(let G=Math.floor(m*l);G<(m+1)*l;G++){let Q=Math.abs(z-(G+.5))/d;const oe=Math.sqrt(B+Q*Q);oe>=-1&&oe<=1&&(g=2*oe*oe*oe-3*oe*oe+1,g>0&&(Q=4*(G+P*e),T+=g*t[Q+3],_+=g,t[Q+3]<255&&(g=g*t[Q+3]/250),S+=g*t[Q],M+=g*t[Q+1],C+=g*t[Q+2],v+=g))}}i[y]=S/v,i[y+1]=M/v,i[y+2]=C/v,i[y+3]=T/_}}function mge(t){return t?[t[0],t[1],t[2],t[3]/255]:[0,0,0,0]}function YEe(t){return t.data?.symbol??null}function KEe(t){return t.type==="CIMVectorMarker"||t.type==="CIMPictureMarker"||t.type==="CIMBarChartMarker"||t.type==="CIMCharacterMarker"||t.type==="CIMPieChartMarker"||t.type==="CIMStackedBarChartMarker"}function QEe(t){return t.type==="CIMGradientStroke"||t.type==="CIMPictureStroke"||t.type==="CIMSolidStroke"}function XEe(t){return t!=null&&(t.type==="CIMGradientFill"||t.type==="CIMHatchFill"||t.type==="CIMPictureFill"||t.type==="CIMSolidFill"||t.type==="CIMWaterFill")}function yge(t){return t!=null&&(t.type==="CIMMarkerPlacementAlongLineRandomSize"||t.type==="CIMMarkerPlacementAlongLineSameSize"||t.type==="CIMMarkerPlacementAlongLineVariableSize"||t.type==="CIMMarkerPlacementAtExtremities"||t.type==="CIMMarkerPlacementAtMeasuredUnits"||t.type==="CIMMarkerPlacementAtRatioPositions"||t.type==="CIMMarkerPlacementOnLine"||t.type==="CIMMarkerPlacementOnVertices")}const eOe=(t,e=0)=>t==null||isNaN(t)?e:t,tOe=(t,e)=>t??e,rOe=(t,e)=>t??e,iOe=t=>t.tintColor?mge(t.tintColor):[255,255,255,1];let gge=class{constructor(e){this._import=e}getImportPromise(){return this._promise==null&&(this._promise=this._import().then(e=>this.module=e)),this._promise}};function nOe(t){return new gge(t)}function oOe(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function aOe(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function lOe(t){let e="normal",r="normal";if(t){const i=t.toLowerCase();i.includes("italic")?e="italic":i.includes("oblique")&&(e="oblique"),i.includes("bold")?r="bold":i.includes("light")&&(r="lighter")}return{style:e,weight:r}}function uOe(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function oA(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const r=oA(e);if(r!=null)return r}break;case"CIMTextSymbol":return oA(t.symbol);case"CIMSolidFill":return t.color}return null}function aA(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const r of e){const i=aA(r);if(i!=null)return i}break}case"CIMTextSymbol":return aA(t.symbol);case"CIMSolidStroke":return t.color}}function cOe(t){for(const e of t)if(e.enable)switch(e.type){case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return!0}return!1}function lA(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const r=lA(e);if(r!==void 0)return r}break;case"CIMTextSymbol":return lA(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function dOe(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function hOe(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function pOe(t){return(t?Object.keys(t):[]).map(e=>({name:e,alias:e,type:typeof t[e]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"}))}const fOe=t=>t.includes("data:image/svg+xml");function mOe(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function Sb(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function yOe(t,e,r,i,s,n,o=!0){const{infos:l}=n;let u=1,d=0,p=0,f=0,m=1;for(const{absoluteAnchorPoint:v,offsetX:_,offsetY:S,rotation:M,size:C,frameHeight:T,rotateClockWise:O,scaleSymbolsProportionally:P}of l)m=v?1:u,p=cA(_,S,d,m,p),f=uA(_,S,d,m,f),T&&(P||o)&&(u*=C/T),d=dA(M,O,d);const y=cA(i,s,d,m,p),g=uA(i,s,d,m,f);return{size:t*u,rotation:dA(e,r,d),offsetX:y,offsetY:g}}function vge(t){if(t==null)return!1;if(Array.isArray(t))return t.every(e=>vge(e));switch(typeof t){case"string":return!!t;case"number":return!isNaN(t)}}function wge(t,e){if(e==="color"||e==="outlinecolor"||e==="backgroundcolor"||e==="borderlinecolor"||e==="tintcolor")return[...hge[e]];const r=Lx[t];if(!r)throw new Error(`InternalError: default value for type ${t}.`);return r[e]}function bge(t){return t.split(" ").map(e=>Number(e))}function _ge(t){return typeof t=="string"?bge(t):t}function gOe(t){return t?.dashTemplate&&(t.dashTemplate=_ge(t.dashTemplate)),t}function Fx(t){if(t==null)return"Normal";switch(t.type){case"CIMTextSymbol":return t.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const e=t.symbolLayers;if(!e)return"Normal";for(const r of e)if(r.type==="CIMVectorMarker")return Fx(r)}break;case"CIMVectorMarker":{const e=t.markerGraphics;if(!e)return"Normal";for(const r of e)if(r.symbol)return Fx(r.symbol)}}return"Normal"}function vOe(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":{let e=0;if(t.symbolLayers){for(const r of t.symbolLayers)if(r)switch(r.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const i=r.size??Lx.CIMVectorMarker.size;i>e&&(e=i);break}}}return e}case"CIMLineSymbol":case"CIMPolygonSymbol":{let e=0;if(t.symbolLayers){for(const r of t.symbolLayers)if(r)switch(r.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const i=r.width;i!=null&&i>e&&(e=i);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(r.markerPlacement&&yge(r.markerPlacement)){const i=r.size??Lx.CIMVectorMarker.size;i>e&&(e=i)}break;case"CIMPictureFill":{const i=r.height;i!=null&&i>e&&(e=i)}}}return e}}}function Sge(t,e){if(e!==null){const r=e.get(t);return r?r.name:t}return t}function wOe(t){return t.map(e=>({...e,propertyName:Sb(e.propertyName)}))}function bOe(t){const e={};for(const r in t){const i=t[r];e[Sb(r)]=i}return e}function uA(t,e,r,i,s){const n=r*Math.PI/180;if(n){const o=Math.cos(n);return(Math.sin(n)*t+o*e)*i+s}return e*i+s}function cA(t,e,r,i,s){const n=r*Math.PI/180;return n?(Math.cos(n)*t-Math.sin(n)*e)*i+s:t*i+s}function dA(t,e,r){return e?r-t:r+t}function _Oe(t,e,r){const i=r==="Color"||r==="TintColor"||r==="ToColor",s=r==="Rotation"||r==="Angle"||r==="ToRotation";let n=e[Sb(r)];if(n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]/255]:s&&(n*=Math.PI/180)),n==null&&(n=wge(e.type,r.toLowerCase()),n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]]:s&&(n*=Math.PI/180))),e.primitiveName!=null){const o=t[e.primitiveName];if(o!=null){const l=o[r];l==null||(typeof l=="string"||typeof l=="number"||Array.isArray(l)?(n=l,n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]/255]:s&&(n*=Math.PI/180))):(n={valueExpressionInfo:l,defaultValue:n},n!=null&&(i?n={type:"Process",op:"ArcadeColor",value:n}:s&&(n={type:"Process",op:"Divide",left:n,right:180/Math.PI}))))}}if(n==null)throw new Error(`Failed to derive a value or an expression for "${r}".`);return n}function SOe(t,e,r){if(e[Sb(r)]!=null)return!0;if(e.primitiveName!=null){const i=t[e.primitiveName];if(i!=null&&i[r]!=null)return!0}return!1}function $Oe(t,e){return Math.max(Math.min((t??e)/100,1),0)}const $ge={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let cV=class{constructor(e,r,i,s){this.url=e,this.fieldMap=i,this.dictionaryInfo=s,this._symbolPartCache=new Hye(100);const n=async()=>cge.from(await s,r,i);this._evaluator=n()}async getSymbolAsync(e,r,i=!0){const s=await this._evaluator,n=r?.fields??aV(e.attributes),o=s.createDictionaryFieldsIndex(n),l=s.evaluate(e,r?.scale??0,o,r?.spatialReference);if(l==null)return null;const u=rp(e.geometry),d=YP.parse(l,s.itemNames,u),p=u==="esriGeometryPoint"&&!e.geometry?.hasZ;return await this._cimPartsToCIMSymbol(e,d.partNames,d.overrides,p,r,i,o)}async getSymbolForControlString(e,r,i){const s=await this._evaluator,n=YP.parse(e,s.itemNames,r),o=r==="esriGeometryPoint"&&!i,l=hA(await Promise.all(n.partNames.map(u=>this._getSymbolPart(u))),n.overrides,o);return new Ir({data:l})}async _cimPartsToCIMSymbol(e,r,i,s,n,o,l){const u=r.map(f=>this._getSymbolPart(f,n));let d=await Promise.all(u);if(o&&this.fieldMap&&d.length>0){const{OverrideHelper:f}=await N(()=>import("./OverrideHelper-BVVS96oC.js"),__vite__mapDeps([205,123,206,21]));d=E(d);for(const m of d)f.applyDictionaryTextOverrides(m,e,this.fieldMap,l,Fx(m))}const p=hA(d,i,s);return new Ir({data:p})}async _fetchSymbolPart(e,r){const i=await this.dictionaryInfo,s=(this.url+"/"+i.cimRefTemplateUrl).replaceAll(/\{itemName\}/gi,e),{data:n}=await Ae(s,{responseType:"json",query:{f:"json"},...r});return n}async _getSymbolPart(e,r){let i=this._symbolPartCache.get(e);return i||(i=this._fetchSymbolPart(e,r),this._symbolPartCache.put(e,i)),i}};function hA(t,e,r){if(!t||t.length===0)return null;const i={...t[0]};if(t.length>1){i.effects=null,i.symbolLayers=[];for(const s of t){const n=s;if(n.effects!=null)for(const o of n.symbolLayers)o.effects==null?o.effects=n.effects:o.effects.unshift(...n.effects);i.symbolLayers.unshift(...n.symbolLayers)}}return r&&(i.callout=$ge),{type:"CIMSymbolReference",symbol:i,primitiveOverrides:e}}var Nx;let Ns=Nx=class extends lp(Di){constructor(t){super(t),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){const t=this.getDictionaryInfo();return new cV(this.url,this.config,this.fieldMap??{},t)}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,r,i){i?.origin||super.writeVisualVariables(t,e,r,i)}clone(){return new Nx({config:E(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:E(this.fieldMap),url:E(this.url),visualVariables:E(this.visualVariables)})}async getSymbolAsync(t,e,r=!0){return this._loader.getSymbolAsync(t,e,r)}async getSymbolForControlString(t,e,r){return this._loader.getSymbolForControlString(t,e,r)}getDictionaryInfo(){return this._dictionaryInfoPromise||(this._dictionaryInfoPromise=this._fetchDictionaryInfo()),this._dictionaryInfoPromise}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await Lr(t,e,null,this.scaleExpression);for(const r in this.fieldMap){const i=this.fieldMap[r];e.has(i)&&t.add(i)}}get arcadeRequired(){return!0}getSymbol(){return null}get symbols(){return[]}getAttributeHash(){return this.visualVariables?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}async _fetchDictionaryInfo(){const{data:t}=await Ae(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"}});return t}};a([c({type:cV})],Ns.prototype,"_loader",null),a([c({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],Ns.prototype,"config",void 0),a([c({type:Object,json:{write:!0}})],Ns.prototype,"fieldMap",void 0),a([c({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],Ns.prototype,"scaleExpression",void 0),a([q("scaleExpression")],Ns.prototype,"writeData",null),a([c({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],Ns.prototype,"scaleExpressionTitle",void 0),a([c({type:String,json:{write:!0}})],Ns.prototype,"url",void 0),a([q("visualVariables")],Ns.prototype,"writeVisualVariables",null),Ns=Nx=a([b("esri.renderers.DictionaryRenderer")],Ns);var Dx;let fo=Dx=class extends F{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return t==null?t:typeof t=="function"?(L.getLogger(this).error(".field: field must be a string value"),null):Km(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new Dx({color:this.color?.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};a([c({type:ue,json:{type:[Number],write:!0}})],fo.prototype,"color",void 0),a([c({type:String,json:{write:!0}})],fo.prototype,"field",void 0),a([Ce("field")],fo.prototype,"castField",null),a([c({type:String,json:{write:!0}})],fo.prototype,"label",void 0),a([c({type:String,json:{write:!0}})],fo.prototype,"valueExpression",void 0),a([c({type:String,json:{write:!0}})],fo.prototype,"valueExpressionTitle",void 0),fo=Dx=a([b("esri.renderers.support.AttributeColorInfo")],fo);const dV=fo;var jx;let W0=jx=class extends F{constructor(){super(...arguments),this.unit=null}clone(){return new jx({unit:this.unit})}};a([c({type:String,json:{write:!0}})],W0.prototype,"unit",void 0),W0=jx=a([b("esri.renderers.support.DotDensityLegendOptions")],W0);const xge=W0;var Vx;let si=Vx=class extends lp(Di){constructor(t){super(t),this.attributes=null,this.backgroundColor=new ue([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new wt,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}set visualVariables(t){super.visualVariables=t}calculateDotValue(t){if(this.referenceScale==null)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new pi({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new Vx({attributes:E(this.attributes),backgroundColor:E(this.backgroundColor),dotBlendingEnabled:E(this.dotBlendingEnabled),dotShape:E(this.dotShape),dotSize:E(this.dotSize),dotValue:E(this.dotValue),legendOptions:E(this.legendOptions),outline:E(this.outline),referenceScale:E(this.referenceScale),seed:E(this.seed),visualVariables:E(this.visualVariables),authoringInfo:E(this.authoringInfo)})}getControllerHash(){return`${this.attributes?.map(e=>e.field||e.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const r of this.attributes??[])r.valueExpression&&await Lr(t,e,null,r.valueExpression),r.field&&t.add(r.field)}};a([c({type:[dV],json:{write:!0}})],si.prototype,"attributes",void 0),a([c({type:ue,json:{write:!0}})],si.prototype,"backgroundColor",void 0),a([c({type:Boolean,json:{write:!0}})],si.prototype,"dotBlendingEnabled",void 0),a([c({type:String,json:{write:!1}})],si.prototype,"dotShape",void 0),a([c({type:Number,json:{write:!0}})],si.prototype,"dotSize",void 0),a([c({type:xge,json:{write:!0}})],si.prototype,"legendOptions",void 0),a([c({type:wt,json:{default:null,write:!0}})],si.prototype,"outline",void 0),a([c({type:Number,json:{write:!0}})],si.prototype,"dotValue",void 0),a([c({type:Number,json:{write:!0}})],si.prototype,"referenceScale",void 0),a([c({type:Number,json:{write:!0}})],si.prototype,"seed",void 0),a([se({dotDensity:"dot-density"})],si.prototype,"type",void 0),si=Vx=a([b("esri.renderers.DotDensityRenderer")],si);var zx;let ja=zx=class extends F{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new zx({color:this.color&&this.color.clone(),ratio:this.ratio})}};a([c({type:ue,json:{type:[xe],default:null,write:{isRequired:!0}}})],ja.prototype,"color",void 0),a([c({type:Number,json:{write:{isRequired:!0}}})],ja.prototype,"ratio",void 0),ja=zx=a([b("esri.renderers.support.HeatmapColorStop")],ja);let id=class extends pe(F){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};a([c({type:String,json:{write:!0}})],id.prototype,"minLabel",void 0),a([c({type:String,json:{write:!0}})],id.prototype,"maxLabel",void 0),a([c({type:String,json:{write:!0}})],id.prototype,"title",void 0),id=a([b("esri.renderers.support.HeatmapLegendOptions")],id);function Tge(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Mge(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Ige(t,e,r,i,s){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t}function Ege(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function hV(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function pV(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function fV(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Oge(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function kge(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Cge(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Pge(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function Age(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Rge(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function Lge(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t}function mV(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],n=e[3]-t[3];return Math.sqrt(r*r+i*i+s*s+n*n)}function yV(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],n=e[3]-t[3];return r*r+i*i+s*s+n*n}function gV(t){const e=t[0],r=t[1],i=t[2],s=t[3];return Math.sqrt(e*e+r*r+i*i+s*s)}function vV(t){const e=t[0],r=t[1],i=t[2],s=t[3];return e*e+r*r+i*i+s*s}function Fge(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function Nge(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Dge(t,e){const r=e[0],i=e[1],s=e[2],n=e[3];let o=r*r+i*i+s*s+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=r*o,t[1]=i*o,t[2]=s*o,t[3]=n*o),t}function jge(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function wV(t,e,r,i){const s=e[0],n=e[1],o=e[2],l=e[3];return t[0]=s+i*(r[0]-s),t[1]=n+i*(r[1]-n),t[2]=o+i*(r[2]-o),t[3]=l+i*(r[3]-l),t}function Vge(t,e=1){const r=Vw;let i,s,n,o,l,u;do i=2*r()-1,s=2*r()-1,l=i*i+s*s;while(l>=1);do n=2*r()-1,o=2*r()-1,u=n*n+o*o;while(u>=1);const d=Math.sqrt((1-l)/u);return t[0]=e*i,t[1]=e*s,t[2]=e*n*d,t[3]=e*o*d,t}function zge(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3];return t[0]=r[0]*i+r[4]*s+r[8]*n+r[12]*o,t[1]=r[1]*i+r[5]*s+r[9]*n+r[13]*o,t[2]=r[2]*i+r[6]*s+r[10]*n+r[14]*o,t[3]=r[3]*i+r[7]*s+r[11]*n+r[15]*o,t}function Uge(t,e,r){const i=e[0],s=e[1],n=e[2],o=r[0],l=r[1],u=r[2],d=r[3],p=d*i+l*n-u*s,f=d*s+u*i-o*n,m=d*n+o*s-l*i,y=-o*i-l*s-u*n;return t[0]=p*d+y*-o+f*-u-m*-l,t[1]=f*d+y*-l+m*-o-p*-u,t[2]=m*d+y*-u+p*-l-f*-o,t[3]=e[3],t}function qge(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Gge(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Bge(t,e){const r=t[0],i=t[1],s=t[2],n=t[3],o=e[0],l=e[1],u=e[2],d=e[3],p=Kr();return Math.abs(r-o)<=p*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-l)<=p*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-u)<=p*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(n-d)<=p*Math.max(1,Math.abs(n),Math.abs(d))}const Hge=hV,Wge=pV,Zge=fV,Jge=mV,Yge=yV,Kge=gV,Qge=vV;Object.freeze(Object.defineProperty({__proto__:null,add:Ege,ceil:Oge,copy:Tge,copyVec3:Mge,dist:Jge,distance:mV,div:Zge,divide:fV,dot:jge,equals:Bge,exactEquals:Gge,floor:kge,inverse:Nge,len:Kge,length:gV,lerp:wV,max:Pge,min:Cge,mul:Wge,multiply:pV,negate:Fge,normalize:Dge,random:Vge,round:Age,scale:Rge,scaleAndAdd:Lge,set:Ige,sqrDist:Yge,sqrLen:Qge,squaredDistance:yV,squaredLength:vV,str:qge,sub:Hge,subtract:hV,transformMat4:zge,transformQuat:Uge},Symbol.toStringTag,{value:"Module"}));function $b(){return[0,0,0,0]}function Xge(t){return[t[0],t[1],t[2],t[3]]}function up(t,e,r,i){return[t,e,r,i]}function e0e(t,e,r,i){return[t,e,r,i]}function t0e(t,e=$b()){const r=Math.min(4,t.length);for(let i=0;i<r;++i)e[i]=t[i];return e}function bV(){return $b()}function _V(){return up(1,1,1,1)}function SV(){return up(1,0,0,0)}function $V(){return up(0,1,0,0)}function xV(){return up(0,0,1,0)}function TV(){return up(0,0,0,1)}const r0e=bV(),i0e=_V(),s0e=SV(),n0e=$V(),o0e=xV(),a0e=TV();Object.freeze(Object.defineProperty({__proto__:null,ONES:i0e,UNIT_W:a0e,UNIT_X:s0e,UNIT_Y:n0e,UNIT_Z:o0e,ZEROS:r0e,clone:Xge,create:$b,freeze:e0e,fromArray:t0e,fromValues:up,ones:_V,unitW:TV,unitX:SV,unitY:$V,unitZ:xV,zeros:bV},Symbol.toStringTag,{value:"Module"}));const A3=2.4;function l0e(t){return gs(t*A3)}function u0e(t){return SQ(t)/A3}function c0e(t,e,r,i){let{color:s,ratio:n}=e,{color:o,ratio:l}=r;l===n&&(l===1?n-=1e-6:l+=1e-6);const u=Gi((i-n)/(l-n),0,1);wV(t,s.toArray(),o.toArray(),u)}function MOe(t){const r=new Uint8ClampedArray(2048);if(t=t.filter(({ratio:l})=>l>=0&&l<=1).sort((l,u)=>l.ratio-u.ratio).map(({color:l,ratio:u})=>({color:l,ratio:Math.max(u,.001)})),t.length<1)return r;let i=t[0],s=t[0],n=1;const o=$b();for(let l=0;l<512;l++){const u=(l+.5)/512;for(;u>s.ratio&&n<t.length;)i=s,s=t[n++];c0e(o,i,s,u),r.set(o,4*l)}return r}function IOe(t,e,r){const i=Math.sqrt(t**2+e**2)/r;return i>1?0:3/(Math.PI*r**2)*(1-i**2)**2}function EOe(t){return typeof t=="function"?t:t?e=>+e[t]:()=>1}var Ux;function pA(t){if(t!=null){const{maxDensity:e,minDensity:r,radius:i}=t;if(e!=null||r!=null||i!=null){const{blurRadius:s,maxPixelIntensity:n,minPixelIntensity:o,...l}=t;return l}}return t}let zt=Ux=class extends Di{constructor(t){super(t),this.authoringInfo=null,this.colorStops=[new ja({ratio:0,color:new ue("rgba(255, 140, 0, 0)")}),new ja({ratio:.75,color:new ue("rgba(255, 140, 0, 1)")}),new ja({ratio:.9,color:new ue("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(t){return pA(t)}get blurRadius(){return u0e(this.radius)}set blurRadius(t){const e=this.maxPixelIntensity,r=this.minPixelIntensity;this._set("radius",l0e(t)),this._set("maxDensity",e*this._pixelIntensityToDensity),this._set("minDensity",r*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(t){this._set("maxDensity",t*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(t){this._set("minDensity",t*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(A3**2*this.blurRadius**4)}read(t,e){t=pA(t),super.read(t,e)}getSymbol(){return new qt}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}async collectRequiredFields(t,e){const r=this.field,i=this.valueExpression;r&&typeof r=="string"&&Ar(t,e,r),i&&typeof i=="string"&&await Lr(t,e,null,i)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new Ux({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:E(this.colorStops),field:this.field,legendOptions:E(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};a([c({type:et,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],zt.prototype,"authoringInfo",void 0),a([c({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],zt.prototype,"blurRadius",null),a([c({type:[ja],json:{write:{isRequired:!0}}})],zt.prototype,"colorStops",void 0),a([c({type:String,json:{write:!0}})],zt.prototype,"field",void 0),a([c({type:id,json:{write:!0}})],zt.prototype,"legendOptions",void 0),a([c({type:Number,json:{write:!0}})],zt.prototype,"maxDensity",void 0),a([c({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],zt.prototype,"maxPixelIntensity",null),a([c({type:Number,json:{write:!0}})],zt.prototype,"minDensity",void 0),a([c({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],zt.prototype,"minPixelIntensity",null),a([c({type:Number,cast:Me,json:{write:!0}})],zt.prototype,"radius",void 0),a([c({type:Number,range:{min:0},json:{default:0,write:!0}})],zt.prototype,"referenceScale",void 0),a([se({heatmap:"heatmap"})],zt.prototype,"type",void 0),a([c({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],zt.prototype,"valueExpression",void 0),a([c({type:String})],zt.prototype,"valueExpressionTitle",void 0),a([c({readOnly:!0})],zt.prototype,"_pixelIntensityToDensity",null),zt=Ux=a([b("esri.renderers.HeatmapRenderer")],zt);let Xl=class extends pe(F){constructor(){super(...arguments),this.color=new ue([0,0,0,0]),this.label=null,this.threshold=0}};a([c({type:ue,json:{write:!0}})],Xl.prototype,"color",void 0),a([c({type:String,json:{write:!0}})],Xl.prototype,"label",void 0),a([c({type:Number,range:{min:0,max:1},json:{write:!0}})],Xl.prototype,"threshold",void 0),Xl=a([b("esri.renderers.support.OthersCategory")],Xl);const d0e={base:Sr,key:"type",typeMap:{size:Ee,opacity:Oo}};let ni=class extends lp(pe(Di)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new ue([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new Xl,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart",this.visualVariables=null}getSymbol(){return new qt({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(hs)}getAttributeHash(){return this.visualVariables?.reduce((e,r)=>e+r.getAttributeHash(),"")??""}getMeshHash(){return this.symbols.reduce((e,r)=>e+JSON.stringify(r),"")}async collectRequiredFields(e,r){await this.collectVVRequiredFields(e,r);for(const i of this.attributes)i.valueExpression&&await Lr(e,r,null,i.valueExpression),i.field&&e.add(i.field)}};a([c({type:[dV],json:{write:!0}})],ni.prototype,"attributes",void 0),a([c(S3)],ni.prototype,"backgroundFillSymbol",void 0),a([c({type:ue,json:{write:!0}})],ni.prototype,"defaultColor",void 0),a([c({type:String,json:{write:!0}})],ni.prototype,"defaultLabel",void 0),a([c({type:Number,range:{min:0,max:1},json:{write:!0}})],ni.prototype,"holePercentage",void 0),a([c({type:Xl,json:{write:!0}})],ni.prototype,"othersCategory",void 0),a([c({type:$3,json:{write:!0}})],ni.prototype,"legendOptions",void 0),a([c({type:wt,json:{default:null,write:!0}})],ni.prototype,"outline",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],ni.prototype,"size",void 0),a([se({pieChart:"pie-chart"})],ni.prototype,"type",void 0),a([c({types:[d0e]})],ni.prototype,"visualVariables",void 0),ni=a([b("esri.renderers.PieChartRenderer")],ni);const $y={key:"type",base:Di,typeMap:{heatmap:zt,simple:Wr,"unique-value":Ge,"class-breaks":xt,"dot-density":si,dictionary:Ns,"pie-chart":ni},errorContext:"renderer"},h0e={key:"type",base:Di,typeMap:{simple:Wr,"unique-value":Ge,"class-breaks":xt,heatmap:zt},errorContext:"renderer",validate:p0e};function p0e(t){switch(t.type){case"simple":return f0e(t);case"unique-value":return m0e(t);case"class-breaks":return y0e(t);case"heatmap":return t}}function f0e(t){if(t.symbol)return t;L.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function m0e(t){const e=t.uniqueValueInfos,r=e?.filter(({symbol:i,label:s},n)=>(i||L.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${n}] ${s}) without a symbol from web scene.`),!!i));return r?.length!==e?.length&&(t.uniqueValueInfos=r),t}function y0e(t){const e=t.classBreakInfos,r=e?.filter(({symbol:i,label:s},n)=>(i||L.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${n}] ${s}) without a symbol from web scene.`),!!i));return r?.length!==e?.length&&(t.classBreakInfos=r),t}function COe(t,e){return Um(t,null,e)}const g0e=Wh({types:$y});function Um(t,e,r){return t?t&&(t.styleName||t.styleUrl)&&t.type!=="uniqueValue"?(r?.messages&&r.messages.push(new Ui("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:r})),null):g0e(t,e,r):null}var qx;let ur=qx=class extends Ga{constructor(t){super(t),this.type="binning",this.binType="geohash",this.fixedBinLevel=null,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.size=Me("12px"),this.fields=[],this.renderer=null}writeFields(t,e,r){const i=t.filter(s=>s.statisticType!=="avg_angle").map(s=>s.toJSON());Bt(r,i,e)}readRenderer(t,e,r){const i=e.drawingInfo?.renderer;return i?Um(i,e,r)??void 0:T3(e,r)}clone(){return new qx({fields:E(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:E(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:E(this.popupTemplate),renderer:E(this.renderer),binType:E(this.binType),size:this.size})}};a([se({binning:"binning"})],ur.prototype,"type",void 0),a([se({geohash:"geohash",square:"square"}),c({type:["geohash","square"]})],ur.prototype,"binType",void 0),a([c({type:Number,json:{write:!0}})],ur.prototype,"fixedBinLevel",void 0),a([c({type:[Ye],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],ur.prototype,"labelingInfo",void 0),a([c(yb)],ur.prototype,"labelsVisible",void 0),a([c({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],ur.prototype,"maxScale",void 0),a([c(mb)],ur.prototype,"popupEnabled",void 0),a([c({type:Vn,json:{name:"popupInfo",write:!0}})],ur.prototype,"popupTemplate",void 0),a([c({cast:t=>t==="auto"?t:Br(Me(t))})],ur.prototype,"size",void 0),a([c({type:[Mr],json:{write:!0}})],ur.prototype,"fields",void 0),a([q("fields")],ur.prototype,"writeFields",null),a([c({types:$y,json:{write:{target:"drawingInfo.renderer"}}})],ur.prototype,"renderer",void 0),a([V("renderer",["drawingInfo.renderer"])],ur.prototype,"readRenderer",null),ur=qx=a([b("esri.layers.support.FeatureReductionBinning")],ur);var Gx;function fA(t){return t.type==="simple"&&!t.visualVariables?.length}let Tt=Gx=class extends F{constructor(t){super(t),this.type="cluster",this.clusterRadius=Me("80px"),this.clusterMinSize=Me("12px"),this.clusterMaxSize=Me("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(t,e,r){const i=e.drawingInfo?.renderer;return i?.authoringInfo?.isAutoGenerated?null:i?fA(i)?null:Um(i,e,r)??void 0:T3(e,r)}readSymbol(t,e,r){const i=e.drawingInfo?.renderer;return i?.authoringInfo?.isAutoGenerated?null:i&&fA(i)?Um(i,e,r)?.symbol:null}writeSymbol(t,e,r,i){const s=this.renderer?.authoringInfo?.isAutoGenerated;if(!this.renderer||s){const n=new Wr({symbol:t});e.drawingInfo={renderer:n.write({},i)}}}writeFields(t,e,r){const i=t.filter(s=>s.statisticType!=="avg_angle").map(s=>s.toJSON());Bt(r,i,e)}readFields(t,e,r){return t.filter(i=>!i.isAutoGenerated).map(i=>Mr.fromJSON(i))}clone(){return new Gx({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:E(this.labelingInfo),labelsVisible:this.labelsVisible,fields:E(this.fields),maxScale:this.maxScale,renderer:E(this.renderer),symbol:E(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:E(this.popupTemplate)})}};a([c({type:["cluster"],readOnly:!0,json:{write:!0}})],Tt.prototype,"type",void 0),a([c({cast:t=>t==="auto"?t:Br(Me(t)),json:{write:!0}})],Tt.prototype,"clusterRadius",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],Tt.prototype,"clusterMinSize",void 0),a([c({type:Number,cast:Me,json:{write:!0}})],Tt.prototype,"clusterMaxSize",void 0),a([c({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Tt.prototype,"maxScale",void 0),a([c(mb)],Tt.prototype,"popupEnabled",void 0),a([c({type:Vn,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],Tt.prototype,"popupTemplate",void 0),a([c({types:$y,json:{write:{target:"drawingInfo.renderer"}}})],Tt.prototype,"renderer",void 0),a([V("renderer",["drawingInfo.renderer"])],Tt.prototype,"readRenderer",null),a([c({types:Yie})],Tt.prototype,"symbol",void 0),a([V("symbol",["drawingInfo.renderer"])],Tt.prototype,"readSymbol",null),a([q("symbol")],Tt.prototype,"writeSymbol",null),a([c({type:[Ye],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Tt.prototype,"labelingInfo",void 0),a([c(yb)],Tt.prototype,"labelsVisible",void 0),a([c({type:[Mr],json:{write:!0}})],Tt.prototype,"fields",void 0),a([q("fields")],Tt.prototype,"writeFields",null),a([V("fields")],Tt.prototype,"readFields",null),Tt=Gx=a([b("esri.layers.support.FeatureReductionCluster")],Tt);var Bx;let cm=Bx=class extends Ga{constructor(t){super(t),this.type="selection"}clone(){return new Bx}};a([c({type:["selection"]})],cm.prototype,"type",void 0),cm=Bx=a([b("esri.layers.support.FeatureReductionSelection")],cm);const mA={key:"type",base:Ga,typeMap:{cluster:Tt,binning:ur}},v0e={types:{key:"type",base:Ga,typeMap:{selection:cm,cluster:Tt,binning:ur}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:mA},"portal-item":{types:mA},"web-scene":{types:{key:"type",base:Ga,typeMap:{selection:cm}},name:"layerDefinition.featureReduction",write:{allowNull:!0,layerContainerTypes:qe}}}}},w0e=()=>L.getLogger("esri.views.2d.layers.support.clusterUtils");k.add("esri-cluster-arcade-enabled",!0);const b0e=k("esri-cluster-arcade-enabled"),_0e=new Set(["simple-line","simple-fill","picture-fill"]);function yA(t,e){let r=e.clone();if(!S0e(r))return r;if(e.symbols.some(i=>_0e.has(i.type))&&(r=new Wr({symbol:new qt})),r.authoringInfo||(r.authoringInfo=new et),r.authoringInfo.isAutoGenerated=!0,"visualVariables"in r){const i=(r.visualVariables||[]).filter(s=>s.valueExpression!=="$view.scale");i.forEach(s=>{s.type==="rotation"?s.field?s.field=$l(t,s.field,"avg_angle","number"):s.valueExpression&&(s.field=Dp(t,s.valueExpression,"avg_angle","number"),s.valueExpression=null):s.normalizationField?(s.field=$l(t,s.field,"avg_norm","number",s.normalizationField),s.normalizationField=null):s.field?s.field=$l(t,s.field,"avg","number"):s.valueExpression&&(s.field=Dp(t,s.valueExpression,"avg","number"),s.valueExpression=null)}),r.visualVariables=i}switch(r.type){case"simple":break;case"pie-chart":for(const i of r.attributes)i.field?i.field=$l(t,i.field,"sum","number"):i.valueExpression&&(i.field=Dp(t,i.valueExpression,"sum","number"),i.valueExpression=null);break;case"unique-value":r.field?r.field=$l(t,r.field,"mode","string"):r.valueExpression&&(r.field=Dp(t,r.valueExpression,"mode","string"),r.valueExpression=null);break;case"class-breaks":r.normalizationField?(r.field=$l(t,r.field,"avg_norm","number",r.normalizationField),r.normalizationField=null):r.field?r.field=$l(t,r.field,"avg","number"):r.valueExpression&&(r.field=Dp(t,r.valueExpression,"avg","number"),r.valueExpression=null)}return r}const S0e=t=>{const e=r=>w0e().error(new x("Unsupported-renderer",r,{renderer:t}));if(!t)return!1;switch(t.type){case"unique-value":if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(t.normalizationField){const r=t.normalizationType;if(r!=="field")return e(`FeatureReductionCluster does not support a normalizationType of ${r}`),!1}break;case"simple":case"pie-chart":break;default:return e(`FeatureReductionCluster does not support renderers of type ${t.type}`),!1}if(!b0e){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some(r=>!(!("valueExpression"in r)||!r.valueExpression)))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function $0e(t,e,r){switch(t){case"sum":return`cluster_sum_${e}`;case"avg":case"avg_angle":return`cluster_avg_${e}`;case"mode":return`cluster_type_${e}`;case"avg_norm":{const i=r,s="field",n=e.toLowerCase()+",norm:"+s+","+i.toLowerCase();return"cluster_avg_"+oM(n)}}}function Dp(t,e,r,i){const s=oM(e),n=r==="mode"?`cluster_type_${s}`:r==="sum"?`cluster_sum_${s}`:`cluster_avg_${s}`;return t.some(o=>o.name===n)||t.push(new Mr({name:n,isAutoGenerated:!0,onStatisticExpression:new Oa({expression:e,returnType:i}),statisticType:r})),n}function $l(t,e,r,i,s){if(e==="cluster_count"||t.some(o=>o.name===e))return e;const n=$0e(r,e,s);return t.some(o=>o.name===n)||(r==="avg_norm"?t.push(new Mr({name:n,isAutoGenerated:!0,onStatisticExpression:new Oa({expression:`$feature.${e} / $feature.${s}`,returnType:i}),statisticType:"avg"})):t.push(new Mr({name:n,isAutoGenerated:!0,onStatisticField:e,statisticType:r}))),n}const x0e=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.aggregateGraphicOrigin=new Tye(this),this.addHandles(ne(()=>this.renderer,()=>{if(this.featureReduction){const s=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",s)}},jn))}set featureReduction(i){const s=this._normalizeFeatureReduction(i);this._set("featureReduction",s)}set renderer(i){}_withClusterVariable(i,s,n){const o=i.clone();return"visualVariables"in o&&(o.visualVariables||(o.visualVariables=[]),o.visualVariables.some(l=>l.type==="size")||o.visualVariables.push(new Ee({field:"cluster_count",stops:[new Bs({value:1}),new Bs({useMinValue:!0,size:s}),new Bs({useMaxValue:!0,size:n})]}))),o}_normalizeFeatureReduction(i){if(i?.type!=="cluster")return i;const s=i.clone(),n=[new Mr({name:"cluster_count",alias:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],o=(s.fields??[]).filter(m=>!m.isAutoGenerated),l=i.renderer&&!i.renderer.authoringInfo?.isAutoGenerated,{clusterMinSize:u,clusterMaxSize:d}=s;if(l){s.fields=[...n,...o];const m=this._withClusterVariable(s.renderer,u,d);return s.effectiveFeatureRenderer=m,s.effectiveClusterRenderer=m,s}if(i.symbol){if(s.fields=[...n,...o],s.renderer=null,!this.renderer)return s.effectiveFeatureRenderer=null,s.effectiveClusterRenderer=null,s;const m=yA(n,this.renderer),y=this._withClusterVariable(m,u,d),g="visualVariables"in y&&y.visualVariables?y.visualVariables:[],v=new Wr({symbol:i.symbol,visualVariables:g});return s.fields=[...n,...o],s.effectiveFeatureRenderer=y,s.effectiveClusterRenderer=v,s}if(!this.renderer)return i;const p=yA(n,this.renderer);s.fields=[...n,...o],s.renderer=p;const f=this._withClusterVariable(p,u,d);return s.effectiveFeatureRenderer=f,s.effectiveClusterRenderer=f,s}};return a([c({readOnly:!0,clonable:!1})],r.prototype,"aggregateGraphicOrigin",void 0),a([c(v0e)],r.prototype,"featureReduction",null),r=a([b("esri.layers.mixins.FeatureReductionLayer")],r),r},gA={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,ArcGISVideoLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,ParquetLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},vA={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},wA={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},T0e={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GaussianSplatLayer:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,Object3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,ViewshedLayer:!0,Voxel:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap-base-layers":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap-ground-layers":{IntegratedMesh3DTilesLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":gA,"web-map/basemap-base-layers":vA,"web-map/tables":wA,"link-chart/operational-layers":{...gA,LinkChartLayer:!0},"link-chart/basemap-base-layers":vA,"link-chart/tables":wA,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0,WCS:!0},"portal-item/tables":{ArcGISFeatureLayer:!0,SubtypeGroupTable:!0}},M0e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(i,s,n){return n?.portalItem?.type==="Group Layer"?void 0:i}writeListMode(i,s,n,o){(o&&o.layerContainerType==="ground"||i&&FG(this,n,{},o))&&(s[n]=i)}writeOperationalLayerType(i,s,n){i&&(s[n]=i)}writeTitle(i,s){s.title=i??"Layer"}readVisibilityTimeExtent(i){return i?It.fromArray(i):null}writeVisibilityTimeExtent(i,s,n,o){i&&o.layerContainerType!=="tables"&&(i.isEmpty?o?.messages&&o.messages.push(new x("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):s[n]=i.toArray())}read(i,s){s&&(s.layer=this),AG(this,i,n=>super.read(i,n),s)}write(i,s){if(!this.persistenceEnabled&&!s?.ignorePersistenceEnabled)return null;if(s?.origin){const l=`${s.origin}/${s.layerContainerType||"operational-layers"}`;let d=!!T0e[l]?.[this.operationalLayerType];if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&l==="web-scene/operational-layers"&&(d=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&l==="web-map/operational-layers"&&(d=!1),!d)return s.messages?.push(new x("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${l}'`,{layer:this})),null}const n=super.write(i,{...s,layer:this}),o=!!s&&!!s.messages&&!!s.messages.filter(l=>l instanceof x&&l.name==="web-document-write:property-required").length;return Dh(n?.url)?(s?.messages?.push(new x("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&o?null:n}beforeSave(){}};return a([c({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],r.prototype,"id",void 0),a([V("id",["id"])],r.prototype,"readId",null),a([c(g9)],r.prototype,"listMode",void 0),a([q("listMode")],r.prototype,"writeListMode",null),a([c({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:qe,isRequired:!0}}}}})],r.prototype,"operationalLayerType",void 0),a([q("operationalLayerType")],r.prototype,"writeOperationalLayerType",null),a([c(sx)],r.prototype,"opacity",void 0),a([c({type:Boolean,readOnly:!1})],r.prototype,"persistenceEnabled",void 0),a([c({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],r.prototype,"title",void 0),a([q("title"),q(["web-scene"],"title")],r.prototype,"writeTitle",null),a([c({type:It,json:{origins:{"web-scene":{write:{layerContainerTypes:qe}}}}})],r.prototype,"visibilityTimeExtent",void 0),a([V("visibilityTimeExtent")],r.prototype,"readVisibilityTimeExtent",null),a([q(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[xe,bw]]}})],r.prototype,"writeVisibilityTimeExtent",null),a([c({type:Boolean,json:{name:"visibility",write:{layerContainerTypes:qe}}})],r.prototype,"visible",void 0),r=a([b("esri.layers.mixins.OperationalLayer")],r),r};var Hx;const xg=new $e({asc:"ascending",desc:"descending"});var ph;let eu=(ph=class extends F{constructor(e){super(e),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new Hx({field:this.field,valueExpression:this.valueExpression,order:this.order})}},Hx=ph,ph);a([c({type:String,json:{write:!0}})],eu.prototype,"field",void 0),a([c({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],eu.prototype,"valueExpression",void 0),a([c({type:xg.apiValues,json:{type:xg.jsonValues,read:xg.read,write:xg.write}})],eu.prototype,"order",void 0),eu=Hx=a([b("esri.layers.support.OrderByInfo")],eu);function I0e(t,e,r){if(!t)return null;const i=t.find(n=>!!n.field);if(!i)return null;const s=new eu;return s.read(i,r),[s]}function E0e(t,e,r,i){const s=t.find(n=>!!n.field);s&&Bt(r,[s.toJSON()],e)}const O0e={type:[eu],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:I0e},write:{writer:E0e}}},k0e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.orderBy=null}};return a([c(O0e)],r.prototype,"orderBy",void 0),r=a([b("esri.layers.mixins.OrderedLayer")],r),r},C0e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=Ke(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(i){i!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",i))}readPortalItem(i,s,n){if(s.itemId)return new de({id:s.itemId,portal:n?.portal})}writePortalItem(i,s){i?.id&&(s.itemId=i.id)}async loadFromPortal(i,s){if(this.portalItem?.id)try{const{load:n}=await N(()=>import("./layersLoader-DVIXxcyw.js"),__vite__mapDeps([313,8,9,7,314]));return We(s),await n({instance:this,supportedTypes:i.supportedTypes,validateItem:i.validateItem,supportsData:i.supportsData,layerModuleTypeMap:i.layerModuleTypeMap,populateGroupLayer:i.populateGroupLayer},s)}catch(n){throw sr(n)||L.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${n}`),n}}async finishLoadEditablePortalLayer(i){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(i).catch(s=>(Mn(s),!0)))}async setUserPrivileges(i,s){if(!_e.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(s);if(this.url)try{const{features:{edit:n,fullEdit:o},content:{updateItem:l}}=await this._fetchUserPrivileges(i,s);this._set("userHasEditingPrivileges",n),this._set("userHasFullEditingPrivileges",o),this._set("userHasUpdateItemPrivileges",l)}catch(n){Mn(n)}}async _fetchUserPrivileges(i,s){let n=this.portalItem;if(!i||!n||!n.loaded||n.sourceUrl)return this._fetchFallbackUserPrivileges(s);const o=!Se?.findCredential(this.url),l=i===n.id;if(l&&n.portal.user)return this._getUserPrivileges(n,o);let u,d;if(l)u=n.portal.url;else try{u=await iM(this.url,s)}catch(y){Mn(y)}if(!u||!FU(u,n.portal.url))return this._fetchFallbackUserPrivileges(s);try{const y=s!=null?s.signal:null;d=await Se?.getCredential(`${u}/sharing`,{prompt:!1,signal:y})}catch(y){Mn(y)}const p=!0,f=!1,m=!1;if(!d)return{features:{edit:p,fullEdit:f},content:{updateItem:m}};try{if(l?await n.reload():(n=new de({id:i,portal:{url:u}}),await n.load(s)),n.portal.user)return this._getUserPrivileges(n,o)}catch(y){Mn(y)}return{features:{edit:p,fullEdit:f},content:{updateItem:m}}}_getUserPrivileges(i,s){const n=$ye(i);return s&&(n.features.edit=!0),n}async _fetchFallbackUserPrivileges(i){let s=!0;try{s=await this._fetchUserHasEditingPrivileges(i)}catch(n){Mn(n)}return{features:{edit:s,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(i){const s=this.url?Se?.findCredential(this.url):null;if(!s)return!0;const n=Tg.credential===s?Tg.user:await this._fetchEditingUser(i);return Tg.credential=s,Tg.user=n,n?.privileges==null||n.privileges.includes("features:user:edit")}async _fetchEditingUser(i){const s=this.portalItem?.portal?.user;if(s)return s;const n=Se?.findServerInfo(this.url??"");if(!n?.owningSystemUrl)return null;const o=`${n.owningSystemUrl}/sharing/rest`,l=j.getDefault();if(l&&l.loaded&&en(l.restUrl)===en(o))return l.user;const u=`${o}/community/self`,d=i!=null?i.signal:null,p=await Sw(Ae(u,{authMode:"no-prompt",query:{f:"json"},signal:d}));return p.ok?Ve.fromJSON(p.value.data):null}read(i,s){s&&(s.layer=this),super.read(i,s)}write(i,s){const n=s?.portal,o=this.portalItem?.id&&(this.portalItem.portal||j.getDefault());return n&&o&&!lR(o.restUrl,n.restUrl)?(s.messages&&s.messages.push(new x("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(i,{...s,layer:this})}};return a([c({type:de})],r.prototype,"portalItem",null),a([V("web-document","portalItem",["itemId"])],r.prototype,"readPortalItem",null),a([q("web-document","portalItem",{itemId:{type:String}})],r.prototype,"writePortalItem",null),a([c({clonable:!1})],r.prototype,"resourceReferences",void 0),a([c({type:Boolean,readOnly:!0})],r.prototype,"userHasEditingPrivileges",void 0),a([c({type:Boolean,readOnly:!0})],r.prototype,"userHasFullEditingPrivileges",void 0),a([c({type:Boolean,readOnly:!0})],r.prototype,"userHasUpdateItemPrivileges",void 0),r=a([b("esri.layers.mixins.PortalLayer")],r),r},Tg={credential:null,user:null};let Pf=class extends X{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};a([c()],Pf.prototype,"updating",void 0),a([c()],Pf.prototype,"status",void 0),Pf=a([b("esri.layers.support.PublishingInfo")],Pf);const P0e=Symbol(),A0e=t=>{var s;var e;const r=t;let i=(s=class extends r{constructor(){super(...arguments),this[e]=!0}get publishingInfo(){if(this.destroyed)return null;const n=this._get("publishingInfo");if(n)return n;const o=new Pf;return this._checkPublishingStatus(o),o}_checkPublishingStatus(n){let u=0;const d=async f=>{let m;n.updating=!0;try{m=await this.fetchPublishingStatus()}catch{m="unavailable"}m!=="published"&&m!=="unavailable"||(n.status==="publishing"&&this.refresh(),p.remove()),n.status=m,n.updating=!1,p.removed||(u=setTimeout(d,f,f+125))},p={removed:!1,remove(){this.removed=!0,clearTimeout(u)}};this.when().catch(()=>p.remove()),d(250),this.addHandles(p)}},e=P0e,s);return a([c({readOnly:!0,clonable:!1})],i.prototype,"publishingInfo",null),i=a([b("esri.layers.mixins.PublishableLayer")],i),i},Va=new H,dm=new WeakMap;function R0e(t){F0e(t)&&Va.push(new WeakRef(t))}function L0e(t){const e=Va.find(r=>r.deref()===t);e&&Va.remove(e)}function F0e(t){return t!=null&&typeof t=="object"&&"refreshInterval"in t&&"refresh"in t}function MV(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:MV(e,t%e):0}let a_=0,Mg=0;function N0e(){const t=Date.now();let e=!1;for(const r of Va){const i=r.deref();i?i.refreshInterval&&t-(dm.get(i)??0)+5>=6e4*i.refreshInterval&&(dm.set(i,t),i.refresh(t)):e=!0}if(e)for(let r=Va.length-1;r>=0;r--)Va.at(r).deref()||Va.removeAt(r)}iL(()=>{const t=Date.now();let e=0;for(const r of Va){const i=r.deref();i&&(e=MV(Math.round(6e4*i.refreshInterval),e),i.refreshInterval?dm.get(i)||dm.set(i,t):dm.delete(i))}if(e!==Mg){if(Mg=e,clearInterval(a_),Mg===0)return void(a_=0);a_=setInterval(N0e,Mg)}},jn);const bA=.1,D0e=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=mT(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||R0e(this)},()=>{})}destroy(){L0e(this)}castRefreshInterval(i){return i>=bA?i:i<=0?0:bA}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(i=Date.now()){yh(this._debounceHasDataChanged()).then(s=>{s&&this._set("refreshTimestamp",i),this.emit("refresh",{dataChanged:s})},s=>{L.getLogger(this).error(s),this.emit("refresh",{dataChanged:!1,error:s})})}async hasDataChanged(){return!0}get test(){}};return a([c({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:qe}}}}})],r.prototype,"refreshInterval",void 0),a([Ce("refreshInterval")],r.prototype,"castRefreshInterval",null),a([c({readOnly:!0})],r.prototype,"refreshTimestamp",void 0),a([c({readOnly:!0})],r.prototype,"refreshParameters",null),r=a([b("esri.layers.mixins.RefreshableLayer")],r),r},j0e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const i={minScale:this.minScale,maxScale:this.maxScale},s=this.parent;s?.effectiveScaleRange!==void 0&&V0e(i,s.effectiveScaleRange);const n=this._get("effectiveScaleRange");return n&&n.minScale===i.minScale&&n.maxScale===i.maxScale?n:i}};return a([c({type:Number,nonNullable:!0,json:{write:!0}})],r.prototype,"minScale",void 0),a([c({type:Number,nonNullable:!0,json:{write:!0}})],r.prototype,"maxScale",void 0),a([c({readOnly:!0})],r.prototype,"effectiveScaleRange",null),r=a([b("esri.layers.mixins.ScaleRangeLayer")],r),r};function V0e(t,e){return t.minScale=t.minScale>0?e.minScale>0?Math.min(t.minScale,e.minScale):t.minScale:e.minScale,t.maxScale=t.maxScale>0?e.maxScale>0?Math.max(t.maxScale,e.maxScale):t.maxScale:e.maxScale,t}const IV=Lt()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let Ro=class extends pe(F){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return T5(this.value,this.unit,"milliseconds")}};a([se(IV,{nonNullable:!0})],Ro.prototype,"unit",void 0),a([c({type:Number,json:{write:!0},nonNullable:!0})],Ro.prototype,"value",void 0),Ro=a([b("esri.time.TimeInterval")],Ro);function _A(t,e){return Ro.fromJSON({value:t,unit:e})}let Xt=class extends pe(F){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(e,r){return r.timeExtent&&Array.isArray(r.timeExtent)&&r.timeExtent.length===2?It.fromArray(r.timeExtent):null}writeFullTimeExtent(e,r){e?.start!=null&&e.end!=null?r.timeExtent=e.toArray():r.timeExtent=null}readInterval(e,r){return r.timeInterval&&r.timeIntervalUnits?_A(r.timeInterval,r.timeIntervalUnits):r.defaultTimeInterval&&r.defaultTimeIntervalUnits?_A(r.defaultTimeInterval,r.defaultTimeIntervalUnits):null}writeInterval(e,r){r.timeInterval=e?.toJSON().value??null,r.timeIntervalUnits=e?.toJSON().unit??null}};a([c({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],Xt.prototype,"cumulative",void 0),a([c({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],Xt.prototype,"endField",void 0),a([c({type:It,json:{write:{enabled:!0,allowNull:!0}}})],Xt.prototype,"fullTimeExtent",void 0),a([V("fullTimeExtent",["timeExtent"])],Xt.prototype,"readFullTimeExtent",null),a([q("fullTimeExtent")],Xt.prototype,"writeFullTimeExtent",null),a([c({type:Boolean,json:{write:!0}})],Xt.prototype,"hasLiveData",void 0),a([c({type:Ro,json:{write:{enabled:!0,allowNull:!0}}})],Xt.prototype,"interval",void 0),a([V("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],Xt.prototype,"readInterval",null),a([q("interval")],Xt.prototype,"writeInterval",null),a([c({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],Xt.prototype,"startField",void 0),a([c(Mv("timeReference",!0))],Xt.prototype,"timeZone",void 0),a([c({type:String,json:{write:{enabled:!0,allowNull:!0}}})],Xt.prototype,"trackIdField",void 0),a([c({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],Xt.prototype,"useTime",void 0),a([c({type:[Date],json:{read:!1}})],Xt.prototype,"stops",void 0),Xt=a([b("esri.layers.support.TimeInfo")],Xt);const z0e={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:qe}}},U0e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(i,s){const n=s.timeInfo.exportOptions;if(!n)return null;const o=n.timeOffset,l=IV.fromJSON(n.timeOffsetUnits);return o&&l?new Ro({value:o,unit:l}):null}set timeInfo(i){l4(i,this.fieldsIndex),this._set("timeInfo",i)}};return a([c({type:It,json:{write:!1}})],r.prototype,"timeExtent",void 0),a([c({type:Ro})],r.prototype,"timeOffset",void 0),a([V("service","timeOffset",["timeInfo.exportOptions"])],r.prototype,"readOffset",null),a([c({value:null,type:Xt,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],r.prototype,"timeInfo",null),a([c(z0e)],r.prototype,"useViewTime",void 0),r=a([b("esri.layers.mixins.TemporalLayer")],r),r};let q0e=class extends Dm{constructor(e){super(),this.type="track",this.trackInfoProvider=e}get id(){return this.trackInfoProvider.id}get[dy](){return this.trackInfoProvider.trackInfo}},os=class extends pe(F){constructor(e){super(e),this.labelingInfo=null,this.labelsVisible=!0,this.renderer=null,this.visible=!0}};a([c({type:[Ye],json:{write:!0}})],os.prototype,"labelingInfo",void 0),a([c(yb)],os.prototype,"labelsVisible",void 0),a([c({types:$y,json:{write:!0}})],os.prototype,"renderer",void 0),a([c({type:Boolean,json:{write:!0}})],os.prototype,"visible",void 0),os=a([b("esri.layers.support.TrackPartInfo")],os);let oi=class extends pe(F){constructor(e){super(e),this.enabled=!0,this.fields=[],this.latestObservations=new os({renderer:new Wr({symbol:iw.clone()})}),this.maxDisplayDuration=null,this.maxDisplayObservationsPerTrack=0,this.popupEnabled=!0,this.popupTemplate=null,this.previousObservations=new os({renderer:new Wr({symbol:iw.clone()})}),this.trackLines=new os({renderer:new Wr({symbol:b3.clone()})}),this.timeField="startTimeField"}writeFields(e,r,i){const s=e.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());Bt(i,s,r)}};a([c({type:Boolean,json:{write:!0}})],oi.prototype,"enabled",void 0),a([c({type:[Mr],json:{write:!0}})],oi.prototype,"fields",void 0),a([q("fields")],oi.prototype,"writeFields",null),a([c({type:os,json:{write:!0}})],oi.prototype,"latestObservations",void 0),a([c({type:Ro,json:{write:!0}})],oi.prototype,"maxDisplayDuration",void 0),a([c({type:Number,json:{write:!0}})],oi.prototype,"maxDisplayObservationsPerTrack",void 0),a([c(mb)],oi.prototype,"popupEnabled",void 0),a([c({type:Vn,json:{name:"popupInfo",write:!0}})],oi.prototype,"popupTemplate",void 0),a([c({type:os,json:{write:!0}})],oi.prototype,"previousObservations",void 0),a([c({type:os,json:{write:!0}})],oi.prototype,"trackLines",void 0),a([c({type:["timeReceived","startTimeField","endTimeField"],json:{read:!0,write:!0}})],oi.prototype,"timeField",void 0),oi=a([b("esri.layers.support.TrackInfo")],oi);const G0e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.trackGraphicOrigin=new q0e(this),this.trackInfo=null}};return a([c({readOnly:!0,clonable:!1})],r.prototype,"trackGraphicOrigin",void 0),a([c({type:oi})],r.prototype,"trackInfo",void 0),r=a([b("esri.layers.mixins.TrackableLayer")],r),r},SA=new $e({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let xn=class extends pe(F){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};a([c({json:{write:!0}})],xn.prototype,"name",void 0),a([c({json:{write:!0}})],xn.prototype,"description",void 0),a([c({json:{read:SA.read,write:SA.write}})],xn.prototype,"drawingTool",void 0),a([c({json:{write:!0}})],xn.prototype,"prototype",void 0),a([c({json:{write:!0}})],xn.prototype,"thumbnail",void 0),xn=a([b("esri.layers.support.FeatureTemplate")],xn);let Sn=class extends pe(F){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const r={};for(const i of Object.keys(e))r[i]=eb(e[i]);return r}writeDomains(e,r){const i={};for(const s of Object.keys(e))e[s]&&(i[s]=e[s]?.toJSON());r.domains=i}};a([c({json:{write:!0}})],Sn.prototype,"id",void 0),a([c({json:{write:!0}})],Sn.prototype,"name",void 0),a([c({json:{write:!0}})],Sn.prototype,"domains",void 0),a([V("domains")],Sn.prototype,"readDomains",null),a([q("domains")],Sn.prototype,"writeDomains",null),a([c({type:[xn],json:{write:!0}})],Sn.prototype,"templates",void 0),Sn=a([b("esri.layers.support.FeatureType")],Sn);let ka=class extends pe(F){constructor(e){super(e),this.alias=null,this.name=void 0,this.fieldFormat=null}};a([c({type:String,json:{write:!0}})],ka.prototype,"alias",void 0),a([c({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],ka.prototype,"name",void 0),a([c({types:M4,json:{write:!0}})],ka.prototype,"fieldFormat",void 0),ka=a([b("esri.layers.support.FieldConfiguration")],ka);function B0e(t){const{popupTemplate:e,fieldsIndex:r}=t,i=e?.fieldInfos;if(!i?.length||!r)return;const s=[];for(const n of i){const{fieldName:o,label:l}=n,u=r.get(o);if(!u)continue;const d=l&&l!==u.alias?l:null,p=Gre(n,u);(d||p)&&s.push(new ka({name:u.name,alias:d,fieldFormat:p}))}return s.length?s:null}function H0e(t){const{fields:e}=t;if(!e?.length)return;const r=[];for(const i of e){const s=Ju(i)?Zf(i):null;s&&r.push(new ka({name:i.name,fieldFormat:s}))}return r.length?r:null}function W0e(t,e){const{popupTemplate:r,fieldsIndex:i}=t;if(!r||!i)return;const s=Z0e(t,e,r.fieldInfos);if(!s)return;const n=r.clone();return n.fieldInfos=s,n}function Z0e(t,e,r){e??=[],r=E(r)??[];let i=!1;const s=new Map;for(const n of e){const o=t.fieldsIndex.get(n.name);o&&s.set(o.name,n)}for(const n of r){const o=t.fieldsIndex.get(n.fieldName);if(!o)continue;const l=s.get(o.name);n.label=l?.alias||o.alias,n.format=Ju(o)&&l?.fieldFormat?PM(l.fieldFormat,o):null,i=!0,s.delete(o.name)}for(const n of s.values()){const o=J0e(t,n);o&&(r.push(o),i=!0)}return i?r:null}function J0e(t,e){const{name:r,alias:i,fieldFormat:s}=e,n=t.fieldsIndex.get(r);if(!n||!i&&!s)return;const o=i||n.alias,l=Ju(n)&&s?PM(s,n):null;return new Kw({fieldName:n.name,label:o,format:l,visible:!1,isEditable:h4(n,t)})}function Y0e(){return{fields:{type:[tr],value:null,set:function(t){if(t&&k("big-integer-warning-enabled")){const e=t.filter(r=>r.type==="big-integer"||r.type==="oid"&&(r.length||0)>=8);if(e.length){const r=e.map(i=>`'${i.name}'`).join(", ");L.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${r}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",t)}},fieldsIndex:{readOnly:!0,get(){return aw.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){const t=this._userOutFields;if(!t?.length)return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const e of t)this.fieldsIndex?.has(e)||L.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${e} found in outFields`,{layer:this,outFields:t});return Jw(this.fieldsIndex,t)}}}}const l_=()=>L.getLogger("esri.layers.support.labelingInfo"),K0e=/\[([^[\]]+)\]/gi;function $A(t,e,r){return t?t.map(i=>{const s=new Ye;if(s.read(i,r),s.labelExpression){const n=e.fields||e.layerDefinition?.fields||this.fields;s.labelExpression=s.labelExpression.replaceAll(K0e,(o,l)=>`[${Q0e(l,n)}]`)}return s}):null}function Q0e(t,e){if(!e)return t;const r=t.toLowerCase();for(let i=0;i<e.length;i++){const s=e[i].name;if(s.toLowerCase()===r)return s}return t}const xA=["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],X0e={esriGeometryPoint:xA,esriGeometryMultiPatch:["always-horizontal"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along","above-along","below-along"],esriGeometryMultipoint:xA,esriGeometryEnvelope:null};function zOe(t,e){const r=[];for(const i of t){const s=i.labelPlacement,n=X0e[e];if(!i.symbol)return l_().warn("No ILabelClass symbol specified."),[];if(!n)return l_().error(new x("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${e}' is not supported`)),[];if(n.includes(s))r.push(i);else{const o=n[0];s&&l_().warn(`Found invalid label placement type ${s} for ${e}. Defaulting to ${o}`);const l=i.clone();l.labelPlacement=o,r.push(l)}}return r}const eve="relationships/",tve="expression/",rve=/<br\s*\/*>/gi;let Dr=class extends X{constructor(e){super(e),this._featureUtils=null,this.effectivePopupTemplate=null}get _arcadeTask(){return this.expressionsUsedInTitle.length>0?this._get("_arcadeTask")||ey(()=>Fu()):null}get featureUtilsPromise(){return this._get("featureUtilsPromise")??N(()=>import("./featureUtils-P7c0_6a4.js"),__vite__mapDeps([172,22])).then(e=>this._featureUtils=e)}get calculatedExpressions(){const e=new H;if(!this.expressionsUsedInTitle.length)return e;if(!this._arcadeTask?.value){for(const r of this.expressionsUsedInTitle??[])e.push({name:r.name,invalid:!0});return e}for(const r of this.expressionsUsedInTitle)try{const i=this._arcadeTask.value.arcade.parseScript(r.expression,["$layer","$map","$datastore"]);if(i.isAsync){e.push({name:r.name,invalid:!0});break}e.push({name:r.name,syntax:i,invalid:!1,func:this._arcadeTask.value.arcade.compileScript(i,{vars:{$feature:"any"}})})}catch{e.push({name:r.name,invalid:!0});break}return e}get expressionsUsedInTitle(){let e=this.effectivePopupTemplate?.title??"";return typeof e!="string"?[]:(e=e.toLowerCase(),this.effectivePopupTemplate?.expressionInfos?.filter(r=>e.includes(`{expression/${r.name.toLowerCase()}}`))??[])}get fieldInfoMap(){return this._featureUtils?this._createFieldInfoMap(this._featureUtils.getAllFieldInfos(this.effectivePopupTemplate)):null}get hasBadExpressions(){return this.calculatedExpressions.some(e=>e.invalid===!0)}get requiredFields(){const e=new Set;if(this._arcadeTask?.value&&!this.hasBadExpressions)for(const i of this.calculatedExpressions?.toArray()??[])try{const s=this._arcadeTask.value.arcade.extractFieldLiterals(i.syntax);for(const n of s){const o=n.split("."),l=this.fieldsIndex.get(o.at(-1)??"");l&&e.add(l.name)}}catch{}const r=this._extractFieldNames(this.workingTitle);for(const i of r){const s=this.fieldsIndex.get(i);s&&e.add(s.name)}return this.objectIdField!=null&&e.add(this.objectIdField),e}get titleFromDisplayField(){let e="";return this.displayField&&(e=this.fieldsIndex.get(this.displayField)?.name??""),e||(e=this.fieldsIndex.get(this.objectIdField)?.name??""),e?`{${e}}`:""}get workingTitle(){const e=this.effectivePopupTemplate?this.effectivePopupTemplate.title:"";return e===""||e==null||this.hasBadExpressions||typeof e!="string"?this.titleFromDisplayField:e}async getTitle(e,r,i){const s=r.getObjectId()??r.attributes[e.objectIdField];return(await this.getTitles(e,[r],i)).get(s)??""}async getTitles(e,r,i){const s=new Map,n=i?.timeZone??"system";try{const[{substituteFieldsInLinksAndAttributes:o}]=await Promise.all([this.featureUtilsPromise,this._arcadeTask?.promise]);i?.fetchMissingFields&&(r=await this._checkAndReQueryGraphics(e,r));const{fieldInfoMap:l,workingTitle:u}=this,d=u&&l;r.forEach(p=>{const f=p.getObjectId()??p.attributes[e.objectIdField];let m=d?o({attributes:p.attributes,expressionAttributes:null,fieldInfoMap:l,globalAttributes:this._createFormattedAttributes(e,p,n).global,layer:e,text:u}):"";i?.removeHTML&&(m=ite.sanitize(m).replaceAll(rve," ")),s.set(f,m)})}catch{}return s}async _checkAndReQueryGraphics(e,r){const i=r.map(s=>s.getObjectId()??s.attributes[e.objectIdField]).filter(hs);if(i.length!==r.length)return r;if(r.some(s=>!Dre(s,this.requiredFields))){const s=e.createQuery();s.where="1=1",s.outFields=[...this.requiredFields],s.objectIds=i;const n=await e.queryFeatures(s);if(n?.features.length===r.length)return n.features}return r}_createFieldInfoMap(e){const r=new Map;if(!e)return r;for(const i of e){if(!i.fieldName)continue;const s=this.fieldsIndex.get(i.fieldName),n=s?.name??i.fieldName;i.fieldName=n,r.set(n.toLowerCase(),i)}return r}_createFormattedAttributes(e,r,i="system"){const s=this.effectivePopupTemplate?.fieldInfos??[],n={};if(!this._featureUtils)return{};if(!this.hasBadExpressions&&this.calculatedExpressions.length>0&&this._arcadeTask?.value){const l=this._arcadeTask.value.Feature.createFromGraphicLikeObject(r.geometry,r.attributes,e,null);for(const u of this.calculatedExpressions)try{n[`expression/${u.name}`]=u.func({vars:{$feature:l}})}catch{}}const o={...r.attributes,...n};return{global:this._featureUtils.formatAttributes({fieldInfos:s,attributes:o,graphic:r,timeZone:i,layer:e,fieldInfoMap:this.fieldInfoMap}),content:[]}}_extractFieldNames(e){return kM(e).filter(r=>!(r.startsWith(eve)||r.startsWith(tve)))}};a([c({readOnly:!0})],Dr.prototype,"_arcadeTask",null),a([c()],Dr.prototype,"_featureUtils",void 0),a([c({readOnly:!0})],Dr.prototype,"featureUtilsPromise",null),a([c({readOnly:!0})],Dr.prototype,"calculatedExpressions",null),a([c()],Dr.prototype,"displayField",void 0),a([c()],Dr.prototype,"effectivePopupTemplate",void 0),a([c()],Dr.prototype,"expressionsUsedInTitle",null),a([c()],Dr.prototype,"fieldsIndex",void 0),a([c()],Dr.prototype,"fieldInfoMap",null),a([c()],Dr.prototype,"fields",void 0),a([c()],Dr.prototype,"objectIdField",void 0),a([c()],Dr.prototype,"requiredFields",null),Dr=a([b("esri.layers.support.TitleCreator")],Dr);const sd=[];function ive(t,e){if(Q0(t.url??""))return!0;const{wkid:r}=e;for(const i of sd){if((t.version??0)>=i[0])return!0;if(typeof i[1]=="function"&&(i[1]=i[1]()),i[1].has(r))return!1}return!0}sd.push([10.91,()=>{const t=new Set([9709,9716,9741,9761,9766]);for(let e=9712;e<=9713;e++)t.add(e);for(let e=9748;e<=9749;e++)t.add(e);for(let e=20904;e<=20932;e++)t.add(e);for(let e=21004;e<=21032;e++)t.add(e);for(let e=21207;e<=21264;e++)t.add(e);for(let e=21307;e<=21364;e++)t.add(e);for(let e=23301;e<=23333;e++)t.add(e);for(let e=102759;e<=102760;e++)t.add(e);for(let e=102934;e<=102955;e++)t.add(e);return t}]),sd.push([10.9,()=>{const t=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let e=9356;e<=9360;e++)t.add(e);for(let e=9404;e<=9407;e++)t.add(e);for(let e=9476;e<=9482;e++)t.add(e);for(let e=9487;e<=9494;e++)t.add(e);for(let e=9697;e<=9699;e++)t.add(e);return t}]),sd.push([10.81,()=>{const t=new Set([9265,9333,103598,103699]);for(let e=9248;e<=9254;e++)t.add(e);for(let e=9271;e<=9273;e++)t.add(e);for(let e=9284;e<=9285;e++)t.add(e);for(let e=21453;e<=21463;e++)t.add(e);return t}]),sd.push([10.8,()=>{const t=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let e=8035;e<=8036;e++)t.add(e);for(let e=8455;e<=8456;e++)t.add(e);for(let e=8518;e<=8529;e++)t.add(e);for(let e=8533;e<=8536;e++)t.add(e);for(let e=8538;e<=8540;e++)t.add(e);for(let e=8677;e<=8679;e++)t.add(e);for(let e=8902;e<=8903;e++)t.add(e);for(let e=8907;e<=8910;e++)t.add(e);for(let e=8949;e<=8951;e++)t.add(e);for(let e=8972;e<=8987;e++)t.add(e);for(let e=9039;e<=9040;e++)t.add(e);for(let e=9068;e<=9069;e++)t.add(e);for(let e=9140;e<=9141;e++)t.add(e);for(let e=9148;e<=9150;e++)t.add(e);for(let e=9153;e<=9159;e++)t.add(e);for(let e=9205;e<=9218;e++)t.add(e);for(let e=9221;e<=9222;e++)t.add(e);for(let e=54098;e<=54101;e++)t.add(e);return t}]),sd.push([10.71,()=>{const t=new Set([6316]);for(let e=8351;e<=8353;e++)t.add(e);for(let e=9294;e<=9297;e++)t.add(e);for(let e=22619;e<=22621;e++)t.add(e);for(let e=103586;e<=103594;e++)t.add(e);return t}]);async function sve(t,e,r){const i=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(i&&i.type==="unique-value"&&i.styleOrigin){const s=await Sw(i.populateFromStyle());if(We(r),s.ok===!1){const n=s.error;e?.messages&&e.messages.push(new Ui("renderer:style-reference",`Failed to create unique value renderer from style reference: ${n.message}`,{error:n,context:e})),t.clear("renderer",e?.origin)}}}function nve({displayField:t,editFieldsInfo:e,fields:r,objectIdField:i,title:s},n){if(!r)return null;const o=uve({editFieldsInfo:e,fields:r,objectIdField:i},n);if(!o.length)return null;const l=hve({titleBase:s,fields:r,displayField:t}),u=dve();return new Vn({title:l,content:u,fieldInfos:o})}const ove=(t,e)=>e.visibleFieldNames?e.visibleFieldNames.has(t.name):gre(t,e);function ave({fields:t,ignoreFieldTypes:e,sortDisabled:r}){const i=t;return e&&(t=t.filter(s=>!e.includes(s.type))),t===i&&(t=t.slice()),r!==!0&&t.sort(lve),t}function lve(t,e){return t.type==="oid"?-1:e.type==="oid"?1:TA(t)?-1:TA(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function uve(t,e){const r=e?.visibleFieldNames;return ave({fields:t.fields??[],ignoreFieldTypes:e?.ignoreFieldTypes||pve,sortDisabled:e?.sortDisabled}).map(i=>new Kw({fieldName:i.name,isEditable:h4(i,t),label:i.alias,format:cve(i),visible:ove(i,{...t,visibleFieldNames:r})}))}function cve(t){switch(t.type){case"small-integer":case"integer":return new Do({digitSeparator:!0,places:0});case"single":case"double":return new Do({digitSeparator:!0,places:2});case"string":return Vre(t.name)?new Do({digitSeparator:!0,places:0}):void 0;default:return}}function dve(){return[new Ph,new Ch]}function hve(t){const e=are(t),{titleBase:r}=t;return e?`${r}: {${e.trim()}}`:r??""}function TA(t){return(t.name&&t.name.toLowerCase())==="name"?!0:t.alias?.toLowerCase()==="name"}const pve=["geometry","blob","raster","guid","xml"],Kt="FeatureLayer";function Ig(t,e){return new x("layer:unsupported",`Layer (${t.title}, ${t.id}) of type '${t.declaredClass}' ${e}`,{layer:t})}function MA(t){return t&&t instanceof H}const u_=Y0e();function c_(t,e,r){const i=!!r?.writeLayerSchema;return{enabled:i,ignoreOrigin:i}}let K=class extends xye(x0e(Xpe(A0e(Ype(qpe(Ppe(k0e(U0e(G0e(j0e(D0e(ape(M0e(C0e(Y8(Ape(ope(pe(tt))))))))))))))))))){constructor(...t){super(...t),this.attributeTableTemplate=null,this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.graphicOrigin=new tpe(this),this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="ArcGISFeatureLayer",this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.resourceInfo=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=Z.WGS84,this.subtypeCode=null,this.supportedSourceTypes=new Set(["Feature Layer","Oriented Imagery Layer","Table","Catalog Layer"]),this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0,this._debouncedSaveOperations=mT(async(e,r,i)=>{const{save:s,saveAs:n}=await N(()=>import("./featureLayerUtils-CEwBzlPJ.js"),__vite__mapDeps([315,316,317,314,318,8]));switch(e){case 0:return s(this,r);case 1:return n(this,i,r)}})}destroy(){this.source?.destroy()}normalizeCtorArgs(t,e){return typeof t=="string"?{url:t,...e}:t}load(t){const e=t!=null?t.signal:null;if(this.portalItem?.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(e).then(i=>this.initLayerProperties(i))),Promise.resolve(this);const r=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},t).catch(Mn).then(async()=>{if(this.url&&this.layerId==null&&/FeatureServer|MapServer\/*$/i.test(this.url)){const i=await this._fetchFirstValidLayerId(e);i!=null&&(this.layerId=i)}if(!this.url&&!this._hasMemorySource())throw new x("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(e))}).then(()=>qme(this,"load",t));return this.addResolvingPromise(r),Promise.resolve(this)}get _titleCreator(){const t=this._get("_titleCreator");return Ke(t),new Dr({fieldsIndex:this.fieldsIndex,objectIdField:this.objectIdField,fields:this.fields,displayField:this.displayField,effectivePopupTemplate:this.popupTemplate??this.defaultPopupTemplate})}readCapabilities(t,e){return e=e.layerDefinition||e,q9(e,this.url)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){return!(this.loaded&&!this.capabilities?.operations.supportsEditing)&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(t){this._overrideIfSome("editingEnabled",t)}readEditingEnabled(t,e){return this._readEditingEnabled(e,!1)}readEditingEnabledFromWebMap(t,e,r){return this._readEditingEnabled(e,!0,r)}writeEditingEnabled(t,e){this._writeEditingEnabled(t,e,!1)}writeEditingEnabledToWebMap(t,e,r,i){this._writeEditingEnabled(t,e,!0,i)}get effectiveEditingEnabled(){return Hme(this)}get featureTitleFields(){return[...this._titleCreator.requiredFields]}set fieldConfigurations(t){if(this._hasMemorySource()||(this._override("fieldConfigurations",t),!this.loaded))return;const e=W0e(this,t);e&&this._set("popupTemplate",e)}get fieldConfigurations(){if(!this._hasMemorySource())return this._isOverridden("fieldConfigurations")?this._get("fieldConfigurations"):B0e(this)||null}readIsTable(t,e){return(e=e?.layerDefinition??e).type==="Table"||!e.geometryType}writeIsTable(t,e,r,i){i?.writeLayerSchema&&Bt(r,t?"Table":"Feature Layer",e)}readGlobalIdField(t,e){return P9(e.layerDefinition||e)}readObjectIdField(t,e){return A9(e.layerDefinition||e)}writePopupTemplate(t,e,r,i){t&&(e[r]=t.toJSON({...i,writeFieldFormat:!i?.writeLayerSchema}))}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(t){UO(t,this.fieldsIndex),this._set("renderer",t)}readRenderer(t,e,r){e=e.layerDefinition||e;const i=e.drawingInfo?.renderer;if(i){const s=Um(i,e,r)??void 0;return s||L.getLogger(this).error("Failed to create renderer",{rendererDefinition:e.drawingInfo.renderer,layer:this,context:r}),s}return T3(e,r)}set source(t){const e=this._get("source");e!==t&&(MA(e)&&this._resetMemorySource(e),MA(t)&&this._initMemorySource(t),this._set("source",t))}castSource(t){return t?Array.isArray(t)||t instanceof H?new wo({layer:this,items:t}):t:null}readSource(t,e){const r=Vt.fromJSON(e.featureSet);return new wo({layer:this,items:r?.features??[]})}readTemplates(t,e){const r=e.editFieldsInfo,i=r?.creatorField,s=r?.editorField;return t=t?.map(n=>xn.fromJSON(n)),this._fixTemplates(t,i),this._fixTemplates(t,s),t}readTitle(t,e){const r=e.layerDefinition?.name??e.name,i=e.title||e.layerDefinition?.title;if(r){const s=this.portalItem?.title;if(this.sublayerTitleMode==="item-title")return this.url?y7(this.url,r):r;let n=r;if(!n&&this.url){const o=nl(this.url);o!=null&&(n=o.title)}return n?(this.sublayerTitleMode==="item-title-and-service-name"&&s&&s!==n&&(n=s+" - "+n),gT(n)):void 0}if(this.sublayerTitleMode==="item-title"&&i)return i}readTitleFromWebMap(t,e){return e.title||e.layerDefinition?.name}readTypeIdField(t,e){let r=(e=e.layerDefinition||e).typeIdField;if(r&&e.fields){r=r.toLowerCase();const i=e.fields.find(s=>s.name.toLowerCase()===r);i&&(r=i.name)}return r}readTypes(t,e){t=(e=e.layerDefinition||e).types;const r=e.editFieldsInfo,i=r?.creatorField,s=r?.editorField;return t?.map(n=>(n=Sn.fromJSON(n),this._fixTemplates(n.templates,i),this._fixTemplates(n.templates,s),n))}readVisible(t,e){return e.layerDefinition?.defaultVisibility!=null?!!e.layerDefinition.defaultVisibility:e.visibility!=null?!!e.visibility:void 0}async addAttachment(t,e){const r=await xme(this,t,e,Kt);return this.lastEditsEventDate=new Date,r}async updateAttachment(t,e,r){const i=await Tme(this,t,e,r,Kt);return this.lastEditsEventDate=new Date,i}async applyEdits(t,e){return Mme(this,t,e)}async uploadAssets(t,e){return Ime(this,t,e)}createFieldConfigurations(){return H0e(this)}createPopupTemplate(t){return nve(this,t)}async createGraphicsSource(t){if(this._hasMemorySource()&&this.source)return this.source.load({signal:t});const{default:e}=await _R(N(()=>import("./FeatureLayerSource-sZYUGFwk.js"),__vite__mapDeps([319,61,66,320,321,111,112,322,323,48,43,324,325,73,71,72,4,31,34,175,33])),t);return new e({layer:this,supportedSourceTypes:this.supportedSourceTypes}).load({signal:t})}createQuery(){const t=Nme(this);t.dynamicDataSource=this.dynamicDataSource;const e=this.subtypeCode!=null?`${this.subtypeField} = ${this.subtypeCode}`:null,r=Dte(this.definitionExpression,e);return t.where=r||"1=1",t}async deleteAttachments(t,e){const r=await Eme(this,t,e,Kt);return this.lastEditsEventDate=new Date,r}async fetchRecomputedExtents(t){return Ome(this,t,Kt)}async getFeatureTitle(t,e){return this._titleCreator.getTitle(this,t,e)}async getFeatureTitles(t,e){return this._titleCreator.getTitles(this,t,e)}getFeatureType(t){return F9(this.types,this.typeIdField,t)}getFieldAlias(t){const e=this.getField(t);if(e)return this.getFieldConfiguration(e.name)?.alias||e.alias}getFieldConfiguration(t){return t=t.toLowerCase(),this.fieldConfigurations?.find(e=>e.name.toLowerCase()===t)}getFieldDomain(t,e){return jme(this,t,e,this.getField(t)?.domain??null)}async queryAttachments(t,e){return kme(this,t,e,Kt)}async queryFeatures(t,e){const r=await this.load(),i=await r.source.queryFeatures(re.from(t)??r.createQuery(),e),s=this.graphicOrigin;if(i?.features)for(const n of i.features)n.layer=n.sourceLayer=r,n.origin=s;return i}async queryObjectIds(t,e){return await Cme(this,t,e,Kt)}async queryFeatureCount(t,e){return Pme(this,t,e,Kt)}async queryExtent(t,e){return Ame(this,t,e,Kt)}async queryRelatedFeatures(t,e){return Rme(this,t,e,Kt)}async queryRelatedFeaturesCount(t,e){return Lme(this,t,e,Kt)}async queryPivot(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryPivot||!i?.operations?.supportsQueryPivot)throw new x(Kt,"Layer source does not support queryPivot capability");const s=await N(()=>import("./PivotQuery-C1Aoij9s.js").then(o=>o.P),[]),n=await r.queryPivot(s.default.from(t),e);if(n?.features)for(const o of n.features)o.layer=o.sourceLayer=this;return n}async queryTopFeatures(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryTopFeatures||!i?.query?.supportsTopFeaturesQuery)throw new x(Kt,"Layer source does not support queryTopFeatures capability");const s=await N(()=>import("./TopFeaturesQuery-BhpuLvzR.js"),[]),n=await r.queryTopFeatures(s.default.from(t),e);if(n?.features)for(const o of n.features)o.layer=o.sourceLayer=this;return n}async queryAttributeBins(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryAttributeBins)throw new x(Kt,"Layer source does not support queryAttributeBins capability");Yme(t,i,Kt);const s=await N(()=>import("./AttributeBinsQuery-Dk5u1ssg.js"),__vite__mapDeps([238,38,45])),n=await r.queryAttributeBins(s.default.from(t),e);if(n.features)for(const o of n.features)o.layer=o.sourceLayer=this;return n}async queryTopObjectIds(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryTopObjectIds||!i?.query.supportsTopFeaturesQuery)throw new x(Kt,"Layer source does not support queryTopObjectIds capability");const s=await N(()=>import("./TopFeaturesQuery-BhpuLvzR.js"),[]);return(await r.queryTopObjectIds(s.default.from(t),e)).filter(Ute)}async queryTopFeaturesExtent(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryTopExtents||!i?.query?.supportsTopFeaturesQuery)throw new x(Kt,"Layer source does not support queryTopExtents capability");const s=await N(()=>import("./TopFeaturesQuery-BhpuLvzR.js"),[]);return r.queryTopExtents(s.default.from(t),e)}async queryTopFeatureCount(t,e){const{source:r,capabilities:i}=await this.load();if(!r.queryTopCount||!i?.query?.supportsTopFeaturesQuery)throw new x(Kt,"Layer source does not support queryFeatureCount capability");const s=await N(()=>import("./TopFeaturesQuery-BhpuLvzR.js"),[]);return r.queryTopCount(s.default.from(t),e)}read(t,e){const r=t.featureCollection;if((r||t.type==="Feature Collection")&&(this.resourceInfo=t),r){const{layers:i,showLegend:s}=r;i?.length===1&&(super.read(i[0],e),s!=null&&super.read({showLegend:s},e))}super.read(t,e),e&&e.origin==="service"&&(this.revert(["objectIdField","fields","timeInfo","dateFieldsTimeZone"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))}write(t,e){e={...e,origin:e?.origin??void 0,writeLayerSchema:e?.writeLayerSchema??this._hasMemorySource()};const{origin:r,layerContainerType:i,messages:s}=e;if(this.dynamicDataSource)return s?.push(Ig(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if((r==="web-map"||r==="web-scene")&&i!=="tables")return s?.push(Ig(this,`a table source can only be written to tables, not ${i}`)),null;if(this._hasMemorySource())return s?.push(Ig(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&(r==="web-map"||r==="web-scene")&&i==="tables")return s?.push(Ig(this,"using a non-table source cannot be written to tables in web maps or web scenes")),null;return super.write(t,e)}clone(){if(this._hasMemorySource())throw new x(Kt,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(t){return!!this.loaded&&(this.source?.type==="memory"||ive(this,t))}async save(t){return this._debouncedSaveOperations(0,t)}async saveAs(t,e){return this._debouncedSaveOperations(1,e,t)}_readEditingEnabled(t,e,r){let i=t.layerDefinition?.capabilities;return i?this._hasEditingCapability(i):(i=t.capabilities,e&&r?.origin==="web-map"&&!this._hasMemorySource()&&i?this._hasEditingCapability(i):void 0)}_hasEditingCapability(t){return t.toLowerCase().split(",").map(e=>e.trim()).includes("editing")}_writeEditingEnabled(t,e,r,i){if(!t){const s=this.capabilities?.operations?.supportsSync?"Query,Sync":"Query";Bt("layerDefinition.capabilities",s,e),r&&!i?.writeLayerSchema&&(e.capabilities=s)}}_fetchFirstValidLayerId(t){return Ae(this.url??"",{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:t}).then(e=>{const r=e.data;if(r)return this.applyPreferredHost(r),this.findFirstValidLayerId(r)})}async initLayerProperties(t){return this._set("source",t),t.sourceJSON&&(this.sourceJSON=t.sourceJSON,this.read(t.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:this.portalItem?.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),UO(this.renderer,this.fieldsIndex),l4(this.timeInfo,this.fieldsIndex),this._hasMemorySource()&&this.geometryType==="mesh"&&(this.capabilities.query.supportsReturnMesh=!0),sve(this,{origin:"service"})}async hasDataChanged(){return Fme(this)}async fetchPublishingStatus(){const t=this.source;return t?.fetchPublishingStatus?t.fetchPublishingStatus():"unavailable"}_verifyFields(){const t=this.parsedUrl?.path??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+t+")"),this.isTable||this._hasMemorySource()||t.search(/\/FeatureServer\//i)!==-1||this.fields?.some(e=>e.type==="geometry")||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+t+")")}_fixTemplates(t,e){t&&t.forEach(r=>{const i=r.prototype?.attributes;i&&e&&delete i[e]})}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new x("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new x("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(t){t.forEach(e=>{e.layer=this,e.sourceLayer=this}),this.addHandles([t.on("after-add",e=>{e.item.layer=this,e.item.sourceLayer=this}),t.on("after-remove",e=>{e.item.layer=null,e.item.sourceLayer=null})],"fl-source")}_resetMemorySource(t){t.forEach(e=>{e.layer=null,e.sourceLayer=null}),this.removeHandles("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}findFirstValidLayerId(t){return Array.isArray(t.layers)&&t.layers.length>0?t.layers[0].id:Array.isArray(t.tables)&&t.tables.length>0?t.tables[0].id:void 0}};a([c({clonable:!1,readOnly:!0})],K.prototype,"_titleCreator",null),a([c(mfe)],K.prototype,"attributeTableTemplate",void 0),a([V("service","capabilities")],K.prototype,"readCapabilities",null),a([c({json:{origins:{"web-scene":{write:!1}},write:!0}})],K.prototype,"charts",void 0),a([c({readOnly:!0})],K.prototype,"createQueryVersion",null),a([c({json:{read:{source:"layerDefinition.copyrightText"}}})],K.prototype,"copyright",void 0),a([c({json:{read:{source:"layerDefinition.displayField"}}})],K.prototype,"displayField",void 0),a([c({types:Fa,readOnly:!0})],K.prototype,"defaultSymbol",void 0),a([c({type:qs})],K.prototype,"dynamicDataSource",void 0),a([c({type:Boolean})],K.prototype,"editingEnabled",null),a([V(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],K.prototype,"readEditingEnabled",null),a([V("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],K.prototype,"readEditingEnabledFromWebMap",null),a([q(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],K.prototype,"writeEditingEnabled",null),a([q("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],K.prototype,"writeEditingEnabledToWebMap",null),a([c({readOnly:!0})],K.prototype,"effectiveEditingEnabled",null),a([c({clonable:!1,readOnly:!0})],K.prototype,"featureTitleFields",null),a([c({type:[ka],json:{name:"layerDefinition.fieldConfigurations",write:{overridePolicy(t,e,r){return{enabled:!r?.writeLayerSchema,ignoreOrigin:this.originIdOf(e)===1}}}}})],K.prototype,"fieldConfigurations",null),a([c({...u_.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:c_}}}}})],K.prototype,"fields",void 0),a([c(u_.fieldsIndex)],K.prototype,"fieldsIndex",void 0),a([c({type:Fs,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],K.prototype,"formTemplate",void 0),a([c({json:{read:{source:"layerDefinition.extent"}}})],K.prototype,"fullExtent",void 0),a([c({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:c_,writer(t,e,r){const i=t?Mx.toJSON(t):null;i&&Bt(r,i,e)}}}},read:{source:"layerDefinition.geometryType",reader:Mx.read}}})],K.prototype,"geometryType",void 0),a([c({readOnly:!0,clonable:!1})],K.prototype,"graphicOrigin",void 0),a([c({json:{read:{source:"layerDefinition.hasM"}}})],K.prototype,"hasM",void 0),a([c({json:{read:{source:"layerDefinition.hasZ"}}})],K.prototype,"hasZ",void 0),a([c(hfe)],K.prototype,"id",void 0),a([c({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],K.prototype,"infoFor3D",void 0),a([c({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],K.prototype,"isTable",void 0),a([V("service","isTable",["type","geometryType"]),V("isTable",["layerDefinition.type","layerDefinition.geometryType"])],K.prototype,"readIsTable",null),a([q("web-map","isTable")],K.prototype,"writeIsTable",null),a([c(yb)],K.prototype,"labelsVisible",void 0),a([c({type:[Ye],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:$A,write:!1}},name:"layerDefinition.drawingInfo.labelingInfo",read:$A,write:{layerContainerTypes:qe}}})],K.prototype,"labelingInfo",void 0),a([c((()=>{const t=E(dfe);return t.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(e,r,i){Bt(i,Nw(e),r)}}},t})())],K.prototype,"opacity",void 0),a([c(ufe)],K.prototype,"legendEnabled",void 0),a([c({type:["show","hide"],json:(()=>{const t=E(g9.json);return t.origins["portal-item"]={read:!1,write:!1},t})()})],K.prototype,"listMode",void 0),a([V("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],K.prototype,"readGlobalIdField",null),a([c({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:c_}}}}})],K.prototype,"objectIdField",void 0),a([V("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],K.prototype,"readObjectIdField",null),a([c({type:["ArcGISFeatureLayer"],json:{write:{target:"layerType",ignoreOrigin:!0,layerContainerTypes:qe}}})],K.prototype,"operationalLayerType",void 0),a([c(u_.outFields)],K.prototype,"outFields",void 0),a([c({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],K.prototype,"path",void 0),a([c(mb)],K.prototype,"popupEnabled",void 0),a([c({type:Vn,json:{name:"popupInfo",write:!0}})],K.prototype,"popupTemplate",void 0),a([q("popupTemplate")],K.prototype,"writePopupTemplate",null),a([c({readOnly:!0})],K.prototype,"defaultPopupTemplate",null),a([c({types:$y,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:h0e,name:"layerDefinition.drawingInfo.renderer",write:{layerContainerTypes:qe,overridePolicy:(t,e,r)=>({ignoreOrigin:r?.writeLayerSchema,layerContainerTypes:qe})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,r)=>({ignoreOrigin:r?.writeLayerSchema,layerContainerTypes:qe})}}})],K.prototype,"renderer",null),a([V("service","renderer",["drawingInfo.renderer","defaultSymbol"]),V("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],K.prototype,"readRenderer",null),a([c()],K.prototype,"resourceInfo",void 0),a([c((()=>{const t=E(afe);return t.json.origins["portal-item"]={read:!1,write:!1},t})())],K.prototype,"screenSizePerspectiveEnabled",void 0),a([c({clonable:!1})],K.prototype,"source",null),a([Ce("source")],K.prototype,"castSource",null),a([V("portal-item","source",["featureSet"]),V("web-map","source",["featureSet"])],K.prototype,"readSource",null),a([c({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],K.prototype,"spatialReference",void 0),a([c({type:Number})],K.prototype,"subtypeCode",void 0),a([c({type:[xn]})],K.prototype,"templates",void 0),a([V("templates",["editFieldsInfo","creatorField","editorField","templates"])],K.prototype,"readTemplates",null),a([c({type:Xt})],K.prototype,"timeInfo",void 0),a([c()],K.prototype,"title",void 0),a([V("service","title",["name"]),V("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],K.prototype,"readTitle",null),a([V("web-map","title",["layerDefinition.name","title"])],K.prototype,"readTitleFromWebMap",null),a([c({type:String})],K.prototype,"sublayerTitleMode",void 0),a([c({json:{read:!1}})],K.prototype,"type",void 0),a([c({type:String})],K.prototype,"typeIdField",void 0),a([V("service","typeIdField"),V("typeIdField",["layerDefinition.typeIdField"])],K.prototype,"readTypeIdField",null),a([c({type:[Sn]})],K.prototype,"types",void 0),a([V("service","types",["types"]),V("types",["layerDefinition.types"])],K.prototype,"readTypes",null),a([c({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility",layerContainerTypes:qe}}}}})],K.prototype,"visible",void 0),a([V("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],K.prototype,"readVisible",null),K=a([b("esri.layers.FeatureLayer")],K);const qOe=Object.freeze(Object.defineProperty({__proto__:null,get default(){return K}},Symbol.toStringTag,{value:"Module"})),yc="esri-search",xl={base:yc,autocomplete:`${yc}__autocomplete`,dropdown:`${yc}__dropdown`,container:`${yc}__container`,form:`${yc}__form`,submitButton:`${yc}__submit-button`},IA="esri-search-result-renderer",EA={base:IA,moreResults:`${IA}--more-results`};function OA(t){switch(t?.type){case"point":return t;case"extent":return t.center;case"polygon":{const e=Q5(t);return e?ee.fromJSON(e):null}case"multipoint":case"polyline":return t.extent?.center;default:return null}}async function fve(t,e){if(t.hasZ||e.type==="2d")return t;const r=e.map?.ground;return r?.layers.length?(await r.queryElevation(t,{cache:e.basemapTerrain?.elevationQueryCache})).geometry:t}function Wx(t,e,r){return EV(t.center,e,r)}function R3(t,e,r){switch(t?.type){case"extent":return t;case"multipoint":case"polygon":case"polyline":return t.extent;case"point":return EV(t,e,r);default:return null}}function EV(t,e,r){const i=t.hasZ?t.z:void 0;if(e?.map)return(r!=null?Lpe(e,r):e.extent).clone().centerAt(t).set({zmax:i,zmin:i});const{x:s,y:n,spatialReference:o}=t;return new he({xmin:s-.25,ymin:n-.25,xmax:s+.25,ymax:n+.25,spatialReference:o,zmin:i,zmax:i})}function mve(t){return t&&typeof t.highlight=="function"}function yve(t,e,r){return t==null||t>=r&&(e===0||t<=e)}function GOe(t,e){if(e&&t){const{minScale:r,maxScale:i}=t;if(gve(r,i))return yve(e,r,i)}return!0}function gve(t,e){return t!=null&&t>0||e!=null&&e>0}function BOe(t){return!t?.minScale||!t.maxScale||t.minScale>=t.maxScale}const HOe=()=>!k("disable-feature:layer-based-scale-visibility");let $t=class extends Lw(F){constructor(t){super(t),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suffix="",this.suggestionsEnabled=null,this.withinViewEnabled=!1,this.zoomScale=null}};a([c()],$t.prototype,"autoNavigate",void 0),a([c()],$t.prototype,"filter",void 0),a([c()],$t.prototype,"getResults",void 0),a([c()],$t.prototype,"getSuggestions",void 0),a([c()],$t.prototype,"maxResults",void 0),a([c()],$t.prototype,"maxSuggestions",void 0),a([c()],$t.prototype,"minSuggestCharacters",void 0),a([c()],$t.prototype,"outFields",void 0),a([c()],$t.prototype,"placeholder",void 0),a([c()],$t.prototype,"popupEnabled",void 0),a([c({type:Vn})],$t.prototype,"popupTemplate",void 0),a([c()],$t.prototype,"prefix",void 0),a([c()],$t.prototype,"resultGraphicEnabled",void 0),a([c()],$t.prototype,"resultSymbol",void 0),a([c()],$t.prototype,"suffix",void 0),a([c()],$t.prototype,"suggestionsEnabled",void 0),a([c()],$t.prototype,"withinViewEnabled",void 0),a([c()],$t.prototype,"zoomScale",void 0),$t=a([b("esri.widgets.Search.SearchSource")],$t);const L3=$t,vve=/https?:\/\/services.*\.arcgis\.com/i,wve=/(?:\{([^}]+)\})/g,Vd=()=>L.getLogger("esri.widgets.Search.support.layerSearchUtils");function bve(t,e){const{exactMatch:r=!1,location:i,maxResults:s,spatialReference:n,source:o,sourceIndex:l,suggestResult:u,view:d}=t,{layer:p,filter:f,zoomScale:m}=o,y=d?.scale,g=OV(o,d),v=e?.signal;return CV(p).then(()=>{const _=p.popupTemplate;return _?_.getRequiredFields(p.fieldsIndex):null}).then(_=>{const{objectIdField:S,returnZ:M}=p,C=NV(o);if(!F3(p,C))throw Vd().error("invalid-field: displayField is invalid."),new x("getResults():invalid-field","displayField is invalid.");const T=_?.length?_:[C],O=o.outFields||T,P=kV(O);if(O.includes(S)||P||O.push(S),p.floorInfo?.floorField&&O.push(p.floorInfo.floorField),!(P||lw(p,O)))throw Vd().error("invalid-field: outField is invalid."),new x("getResults():invalid-field","outField is invalid.");const D=p.createQuery(),{orderByFields:z}=o;if(z&&(D.orderByFields=z),n){D.outSpatialReference=n;const Q=1/Bi(n);Q&&(D.maxAllowableOffset=Q)}const B=p.geometryType==="mesh"||p.geometryType==="multipatch",G=p.capabilities?.data?.supportsZ&&!B;if(D.returnZ=G&&M!==!1,D.returnGeometry=!0,D.multipatchOption=B?"xyFootprint":null,O&&(D.outFields=O),i)D.geometry=i;else if(u.key)D.objectIds=[u.key];else{const Q=o.searchFields||[C];if(!lw(p,Q))throw Vd().error("invalid-field: search field is invalid."),new x("getResults():invalid-field","search field is invalid.");if(FV(p)&&(D.num=s),g&&(D.geometry=g),!u.text?.trim())return[];const Pe=u.text,{prefix:fe="",suffix:Ft=""}=o,_i=DV(`${fe}${Pe}${Ft}`);LV(p)&&AV(p,Q)&&!r&&Pe&&(D.fullText=RV({text:Pe,searchFields:Q}));const nr=jV({searchTerm:_i,layer:p,searchFields:Q,filter:f,exactMatch:r,query:D,type:"search"});if(D.where=nr,!PV(D))return[]}return p.queryFeatures(D,{signal:v}).then(Q=>Ave(Q,d,o,l,C,y,m))})}function _ve(t,e){const{source:r,spatialReference:i,view:s,suggestTerm:n,maxSuggestions:o,sourceIndex:l,exactMatch:u}=t,{layer:d,filter:p}=r,f=e?.signal,m=OV(r,s);return CV(d).then(()=>{if(!FV(d))return[];const y=NV(r),g=r.searchFields||[y],v=[];r.suggestionTemplate?r.suggestionTemplate.replaceAll(wve,(G,Q)=>(v.push(Q),G)):v.push(y);const _=kV(v);v.includes(d.objectIdField)||_||v.push(d.objectIdField);const S=F3(d,y),M=_||lw(d,v),C=lw(d,g);if(!S)throw Vd().error("invalid-field: displayField is invalid."),new x("getSuggestions():invalid-field","displayField is invalid.");if(!M)throw Vd().error("invalid-field: outField is invalid."),new x("getSuggestions():invalid-field","outField is invalid.");if(!C)throw Vd().error("invalid-field: search field is invalid."),new x("getSuggestions():invalid-field","search field is invalid.");const T=d.createQuery(),{orderByFields:O}=r;if(O&&(T.orderByFields=O),T.outSpatialReference=i,T.returnGeometry=!1,T.num=o,T.outFields=v,m&&(T.geometry=m),!n.trim())return[];const{prefix:P="",suffix:D=""}=r,z=DV(`${P}${n}${D}`);LV(d)&&AV(d,g)&&!u&&n&&(T.fullText=RV({text:n,searchFields:g}));const B=jV({searchTerm:z,layer:d,searchFields:g,filter:p,exactMatch:u,query:T,type:"suggest"});return T.where=B,PV(T)?d.queryFeatures(T,{signal:f}).then(G=>kve(G,r,l,y)):[]})}function OV(t,e){const{filter:r,withinViewEnabled:i}=t,s=e?.extent;return r?.geometry??(i&&s?s:void 0)}function kV(t){return t&&t.includes("*")}async function CV(t){t&&await t.load()}function PV(t){return!(!t.fullText&&!t.where)}function AV(t,e){const r=t?.indexes;return!r||!e?.length?!1:r.filter(i=>i.indexType==="FullText").some(i=>{const s=i.fields?.split(",").map(n=>n.trim().toLowerCase())||[];return e.every(n=>s.includes(n.toLowerCase()))})}function RV({text:t,searchFields:e}){return t.trim().split(" ").filter(r=>!!r.trim()).map(r=>new gj({onFields:e,searchTerm:r,searchType:"prefix"}))}function LV(t){return t?.capabilities?.query?.supportsFullTextSearch??!1}function FV(t){return t?.capabilities?.query?.supportsPagination??!1}function Sve(t){return t?.fieldsIndex?.fields?.find(e=>e.type==="string")?.name??""}function NV(t){return t.displayField||t.layer.displayField||Sve(t.layer)}function lw(t,e){return!(!t||!e?.length)&&e.every(r=>F3(t,r))}function F3(t,e){return!!t.getField(e)}function $ve(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!0;return!1}function xve({codedValues:t},e,r){return K0(t??[],i=>{const s=i.name,n=r?s:s.toLowerCase();return(r?e:e.toLowerCase())===n?i.code.toString():null})??null}function DV(t){return t.replaceAll("'","''")}function jp(t,e){const r=e?.where;return r?`(${t}) AND (${r})`:t}function Tve({currentTerm:t,field:e,filter:r,exactMatch:i,url:s,type:n}){const o=e?.type,l=e?.name;if(o==="string"||o==="date"||o==="global-id"){const u=vve.test(s??""),d=u&&$ve(t)?"N":"";return jp(i&&n==="search"?`${l} = ${d}'${t}'`:u?`${l} LIKE ${d}${`'${t}%'`}`:`${`LOWER(${l})`} LIKE ${d}${`'${t.toLowerCase()}%'`}`,r)}if(o==="oid"||o==="small-integer"||o==="integer"||o==="single"||o==="double"){const u=Number(t);return isNaN(u)?null:jp(`${l} = ${u}`,r)}return jp(`${l} = ${t}`,r)}function Mve(t,e){return t?` OR (${e})`:`(${e})`}function jV({searchTerm:t,layer:e,searchFields:r,filter:i,exactMatch:s,query:n,type:o}){const{definitionExpression:l,url:u}=e;let d="";return!n.fullText&&t&&r&&r.forEach(p=>{const f=e.getField(p),m=e.getFieldDomain?.(p,{excludeImpliedDomains:k("esri-widget-legacy-field-domain-calculation")}),y=(m&&m.type==="coded-value"?xve(m,t,s):null)||t||null;if(y!==null){const g=Tve({currentTerm:y,field:f,filter:i,exactMatch:s,url:u,type:o});g&&(d+=Mve(d,g))}}),l&&d?`(${l}) AND (${d})`:l||d}function Ive(t,e){let r=null;const{codedValues:i}=t;return i&&i.length&&i.some(s=>s.code===e&&(r=s.name,!0)),r}function Eve(t,e){return t[e]??t[Object.keys(t).find(r=>r.toLowerCase()===e.toLowerCase())]}function VV(t,e,r){const i=t.sourceLayer,{attributes:s}=t,n=i.getFieldDomain?.(r,{feature:t,excludeImpliedDomains:k("esri-widget-legacy-field-domain-calculation")});if(e)return XT(e,s);if(r&&s){const o=i.getField(r),l=Eve(s,r);return l==null?"":n&&n.type==="coded-value"?Ive(n,l)??"":o?.type==="date"?Xa(new Date(l)):typeof l=="number"?l.toString():typeof l!="string"?"":l.trim()}return""}function Ove(t,e,r,i){const s=t.sourceLayer,{attributes:n}=t,{objectIdField:o}=s,l=o?n[o]:null;return{text:VV(t,e.suggestionTemplate,i),key:l,sourceIndex:r}}function kve(t,e,r,i){return t.features.map(s=>Ove(s,e,r,i))}function Cve(t){return t!=null&&t.minScale!=null&&t.maxScale!=null}function Pve(t,e,r,i,s,n,o){const l=t.clone();l.layer=t.layer;const u=t.sourceLayer,d=u?.objectIdField,p=d?t.attributes[d]:null,f=VV(t,r.searchTemplate,s);n!=null&&Cve(u)&&(u.minScale&&u.minScale<n?n=u.minScale:u.maxScale&&u.maxScale>n&&(n=u.maxScale));const m=l.geometry?R3(l.geometry,e??void 0,n??void 0):void 0,y=typeof o=="number"&&m?Wx(E(m),e??void 0,o):m,g=t.clone();return g.layer=t.layer,y!=null&&(g.geometry=Be.fromExtent(y)),{extent:y,target:g,feature:l,key:p,name:f,sourceIndex:i}}function Ave(t,e,r,i,s,n,o){return t.features.map(l=>Pve(l,e,r,i,s,n,o))}var Zx;let Ds=Zx=class extends L3{constructor(t){super(t),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,r)=>bve({source:this,...e},r),this.getSuggestions=(e,r)=>_ve({source:this,...e},r)}set layer(t){this._set("layer",t),t&&t.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(t){this._overrideIfSome("name",t)}clone(){return new Zx({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?E(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?E(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){return this.layer.fieldsIndex?.fields.find(t=>t.type==="string")?.name??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:t,searchFields:e}=this;if(!t.loaded)return"";const r=e||[this._getDisplayField()],i=ZZ(t);return`: ${r.map(s=>{const n=t.getField(s);return(i?t.getFieldAlias(s):n?.alias)||s}).join(", ")}`}_getLayerTitle(){const{layer:t}=this;if(!t)return;const{title:e}=t;return e?`${e}${this._getSearchFieldsString()}`:void 0}};a([c({json:{read:{source:"field.name"},write:{target:"field.name"}}})],Ds.prototype,"displayField",void 0),a([c({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],Ds.prototype,"exactMatch",void 0),a([c({value:null})],Ds.prototype,"layer",null),a([c()],Ds.prototype,"name",null),a([c({type:[String],json:{write:!0}})],Ds.prototype,"orderByFields",void 0),a([c()],Ds.prototype,"searchFields",void 0),a([c()],Ds.prototype,"searchTemplate",void 0),a([c()],Ds.prototype,"suggestionTemplate",void 0),Ds=Zx=a([b("esri.widgets.Search.LayerSearchSource")],Ds);const nd=Ds;function Rve(t){return!!t&&typeof t.x=="number"&&typeof t.y=="number"}function Lve(t){return t&&typeof t.xmin=="number"&&typeof t.ymin=="number"&&typeof t.xmax=="number"&&typeof t.ymax=="number"}let ya=class extends F{constructor(e){super(e),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};a([c({type:String,json:{write:!0}})],ya.prototype,"address",void 0),a([c({type:Object,json:{write:!0}})],ya.prototype,"attributes",void 0),a([c({type:he,json:{write:!0}})],ya.prototype,"extent",void 0),a([c({type:ee,json:{write:!0}})],ya.prototype,"location",void 0),a([c({type:Number,json:{write:!0}})],ya.prototype,"score",void 0),ya=a([b("esri.rest.support.AddressCandidate")],ya);const zV=ya,N3={type:String,json:{read:{source:"token"},write:{target:"token"}}};let ar=class extends F{constructor(e){super(e),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};a([c({type:Object,json:{write:!0}})],ar.prototype,"address",void 0),a([c(N3)],ar.prototype,"apiKey",void 0),a([c({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],ar.prototype,"categories",void 0),a([c({type:String,json:{write:!0}})],ar.prototype,"countryCode",void 0),a([c({type:Boolean,json:{write:!0}})],ar.prototype,"forStorage",void 0),a([c({type:ee,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],ar.prototype,"location",void 0),a([c({type:["rooftop","street"],json:{write:!0}})],ar.prototype,"locationType",void 0),a([c({type:String,json:{write:!0}})],ar.prototype,"magicKey",void 0),a([c({type:Number,json:{write:!0}})],ar.prototype,"maxLocations",void 0),a([c({type:[String],json:{write:{writer:(t,e)=>{e.outFields=t?t.join(","):null}}}})],ar.prototype,"outFields",void 0),a([c({type:Z,json:{read:{source:"outSR"},write:{target:"outSR"}}})],ar.prototype,"outSpatialReference",void 0),a([c({type:he,json:{write:{writer:(t,e)=>{const r=t?t.shiftCentralMeridian():null;e.searchExtent=r}}}})],ar.prototype,"searchExtent",void 0),ar=a([b("esri.rest.support.AddressToLocationsParameters")],ar),ar.from=ut(ar);const UV=ar;async function Fve(t,e,r){e=UV.from(e);const i=wy(t),{address:s,...n}=e.toJSON(),o={...s,...n,f:"json"},l=ZM({...i.query,...o}),u=WM(l,r),d=`${i.path}/findAddressCandidates`;return Ae(d,u).then(Nve)}function Nve({data:t}){if(!t)return[];const{candidates:e,spatialReference:r}=t;return e?e.map(i=>{if(!i)return;const{extent:s,location:n}=i,o=!s||Lve(s);return Rve(n)&&o?(s&&(s.spatialReference=r),n&&(n.spatialReference=r),zV.fromJSON(i)):void 0}):[]}const Dve=Lt()({DistanceMarker:"distance-marker",Locality:"locality",POI:"poi",PointAddress:"point-address",Postal:"postal",StreetAddress:"street-address",StreetInt:"street-intersection",StreetName:"street-name",Subaddress:"sub-address"}),jve=Lt()({localCity:"local-city",postalCity:"postal-city"});var Jx;let jr=Jx=class extends F{constructor(t){super(t),this.apiKey=null,this.featureTypes=null,this.forStorage=null,this.language=null,this.location=null,this.locationType=null,this.outFields=null,this.outSpatialReference=null,this.preferredLabelValues=null,this.returnInputLocation=null}writeFeatureTypes(t,e){t?.length&&(e.featureTypes=t.map(r=>Dve.toJSON(r)))}writeLocation(t,e){e.location=t?.clone().normalize().toJSON()}static from(t){return Hh(Jx,t)}};a([c(N3)],jr.prototype,"apiKey",void 0),a([c({type:[["distance-marker","locality","poi","point-address","postal","street-address","street-intersection","street-name","sub-address"]],json:{write:!0}})],jr.prototype,"featureTypes",void 0),a([q("featureTypes")],jr.prototype,"writeFeatureTypes",null),a([c({type:Boolean,json:{write:!0}})],jr.prototype,"forStorage",void 0),a([c({type:String,json:{name:"langCode",write:!0}})],jr.prototype,"language",void 0),a([c({type:ee,json:{write:!0}})],jr.prototype,"location",void 0),a([q("location")],jr.prototype,"writeLocation",null),a([c({type:["street","rooftop"],json:{write:!0}})],jr.prototype,"locationType",void 0),a([c({type:[String],json:{write:!0}})],jr.prototype,"outFields",void 0),a([c({type:Z,json:{name:"outSR",write:!0}})],jr.prototype,"outSpatialReference",void 0),a([se(jve)],jr.prototype,"preferredLabelValues",void 0),a([c({type:Boolean,json:{write:!0}})],jr.prototype,"returnInputLocation",void 0),jr=Jx=a([b("esri.rest.support.LocationToAddressParameters")],jr);const qV=jr;async function Vve(t,e,r){const i=wy(t),{path:s,query:n}=i,o=qV.from(e);if(!o.location)throw new x("location-to-address:location-required","The location parameter is required");const l={...r,query:{...n,...zve(o),f:"json"}},u=`${s}/reverseGeocode`,{data:d}=await Ae(u,l),{address:p,location:f}=d;return zV.fromJSON({address:p?.Match_addr??"",attributes:p,location:f,score:100})}function zve(t){const e=t.toJSON(),{featureTypes:r,forStorage:i,langCode:s,location:n,locationType:o,outFields:l,outSR:u,preferredLabelValues:d,returnInputLocation:p,token:f}=e;return{featureTypes:r?.join(","),forStorage:i,langCode:s,location:JSON.stringify(n),locationType:o,outFields:l?.join(","),outSR:u?.wkid??void 0,preferredLabelValues:d,returnInputLocation:p,token:f}}let od=class extends F{constructor(t){super(t),this.isCollection=null,this.magicKey=null,this.text=null}};a([c({type:Boolean,json:{write:!0}})],od.prototype,"isCollection",void 0),a([c({type:String,json:{write:!0}})],od.prototype,"magicKey",void 0),a([c({type:String,json:{write:!0}})],od.prototype,"text",void 0),od=a([b("esri.rest.support.SuggestionCandidate")],od);const Uve=od;let Pi=class extends F{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};a([c(N3)],Pi.prototype,"apiKey",void 0),a([c({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Pi.prototype,"categories",void 0),a([c({type:String,json:{write:!0}})],Pi.prototype,"countryCode",void 0),a([c({type:ee,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Pi.prototype,"location",void 0),a([c({type:Number,json:{write:!0}})],Pi.prototype,"maxSuggestions",void 0),a([c({type:Z,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Pi.prototype,"outSpatialReference",void 0),a([c({type:he,json:{write:{writer:(t,e)=>{const r=t?t.shiftCentralMeridian():null;e.searchExtent=JSON.stringify(r)}}}})],Pi.prototype,"searchExtent",void 0),a([c({type:String,json:{write:!0}})],Pi.prototype,"text",void 0),Pi=a([b("esri.rest.support.SuggestLocationsParameters")],Pi),Pi.from=ut(Pi);const GV=Pi;async function qve(t,e,r){const i=wy(t),s={...(e=GV.from(e)).toJSON(),f:"json"},n=ZM({...i.query,...s}),o=WM(n,r),l=`${i.path}/suggest`;return Ae(l,o).then(Gve)}function Gve(t){const{data:e}=t;if(!e)return[];const{suggestions:r}=e;return r?r.map(i=>new Uve(i)):[]}const Bve="Single Line Input",Hve=3e5;function Wve(t,e){return t.location?Qve(t,e):Xve(t,e)}function BV(t,e){if(e.localSearchDisabled)return null;const r=t?.scale;return typeof r=="number"&&r<=Hve?t?.extent?.center:null}async function Zve(t,e){const{source:r,spatialReference:i,view:s,suggestTerm:n,maxSuggestions:o,sourceIndex:l}=t,u=new GV,{apiKey:d,url:p}=r,f=HV(r,s),m=e?.signal;if(!p)return null;d&&(u.apiKey=d),r.categories&&(u.categories=r.categories),i&&(u.outSpatialReference=i);const y=BV(s,r);if(y&&(u.location=y),!n.trim())return null;const{prefix:g="",suffix:v=""}=r,_=`${g}${n}${v}`;return u.text=_,f&&(u.searchExtent=f),u.maxSuggestions=o,r.countryCode&&(u.countryCode=r.countryCode),qve(p,u,{signal:m}).then(S=>twe(S,l))}function Jve(t){return!!t&&/(?:geocode-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}function Yve(t){return!!t&&/(?:\/servers\/[\da-z.-]+\/rest\/services\/world\/geocodeserver).*/i.test(t)}function kA(t){return!!t&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}const Kve="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";async function Qve(t,e){const{location:r,source:i,sourceIndex:s,spatialReference:n,view:o}=t,{apiKey:l,defaultZoomScale:u,language:d,url:p,zoomScale:f}=i;if(p==null)return[];const m=o?.scale,y=e?.signal,g=new qV({language:d,location:r,apiKey:l,outSpatialReference:n});try{return WV([await Vve(p,g,{signal:y})],{defaultZoomScale:u,scale:m,sourceIndex:s,view:o,zoomScale:f})}catch{return[]}}function HV(t,e){const{filter:r,withinViewEnabled:i}=t,s=e?.scale,n=e?.extent,o=r?.geometry;return(o?R3(o,e??void 0,s):void 0)||(i&&n?n:void 0)}async function Xve(t,e){const{source:r,suggestResult:i,spatialReference:s,view:n,maxResults:o,sourceIndex:l}=t,u=r?.zoomScale,d=r?.defaultZoomScale;if(!i.text?.trim())return null;const f=!i.key&&r.prefix?r.prefix:"",m=!i.key&&r.suffix?r.suffix:"",y=`${f}${i.text}${m}`,g=new UV,{apiKey:v,url:_}=r,S=n?.scale,M=HV(r,n),C=e?.signal;if(v&&(g.apiKey=v),!_)return null;r.categories&&(g.categories=r.categories),r.locationType&&(g.locationType=r.locationType),s&&(g.outSpatialReference=s);const T=BV(n,r);T&&(g.location=T),g.maxLocations=o,M&&(g.searchExtent=M),r.countryCode&&(g.countryCode=r.countryCode);const{key:O}=i,P=`${O}`;return O&&(g.magicKey=P),g.address={},g.address[r.singleLineFieldName||Bve]=y,r.outFields&&(g.outFields=r.outFields),Fve(_,g,{signal:C}).then(D=>WV(D,{key:P,scale:S,sourceIndex:l,view:n,zoomScale:u,defaultZoomScale:d}))}function ewe(t,e){return{text:t.text,key:t.magicKey,sourceIndex:e}}function twe(t,e){return t.map(r=>ewe(r,e))}function rwe(t,e){const{key:r,scale:i,sourceIndex:s,view:n,zoomScale:o,defaultZoomScale:l}=e,{attributes:u,extent:d,location:p,address:f}=t,m=new st({geometry:p,attributes:u}),y=d||p,g=y?R3(y,n??void 0,i??void 0):void 0,v=g?typeof o=="number"?Wx(g,n??void 0,o):typeof l=="number"&&y?.type==="point"?Wx(g,n??void 0,l):g:null,_=p?`${p.x},${p.y}`:"",S=f||_,M=m.clone();return v!=null&&(M.geometry=Be.fromExtent(v)),{extent:v,feature:m,target:M,key:r,name:S,sourceIndex:s}}function WV(t,e){return t.filter(Boolean).map(r=>rwe(r,e))}var Yx;let lr=Yx=class extends L3{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.language=null,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(e,r)=>Wve({source:this,...e},r),this.getSuggestions=(e,r)=>Zve({source:this,...e},r)}clone(){return new Yx({apiKey:this.apiKey,autoNavigate:this.autoNavigate,categories:this.categories?E(this.categories):null,countryCode:this.countryCode,filter:this.filter,language:this.language,locationType:this.locationType,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?E(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?.clone()??null,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,suffix:this.suffix,suggestionsEnabled:this.suggestionsEnabled,url:this.url,withinViewEnabled:this.withinViewEnabled,zoomScale:this.zoomScale})}};a([c()],lr.prototype,"apiKey",void 0),a([c()],lr.prototype,"categories",void 0),a([c()],lr.prototype,"countryCode",void 0),a([c({json:{write:!0}})],lr.prototype,"defaultZoomScale",void 0),a([c()],lr.prototype,"localSearchDisabled",void 0),a([c()],lr.prototype,"language",void 0),a([c()],lr.prototype,"locationType",void 0),a([c({json:{write:!0}})],lr.prototype,"name",void 0),a([c({json:{write:!0}})],lr.prototype,"placeholder",void 0),a([c()],lr.prototype,"searchTemplate",void 0),a([c({json:{write:!0}})],lr.prototype,"singleLineFieldName",void 0),a([c({json:{read:{source:"suggest"},write:{target:"suggest"}}})],lr.prototype,"suggestionsEnabled",void 0),a([c({json:{write:!0}})],lr.prototype,"url",void 0),a([c({json:{write:!0}})],lr.prototype,"zoomScale",void 0),lr=Yx=a([b("esri.widgets.Search.LocatorSearchSource")],lr);const ZV=lr;let Ta=class extends F{constructor(e){super(e),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(s=>s.toJSON()),r=this.geometries[0],i={};return i.outSR=vv(this.outSpatialReference),i.inSR=vv(r.spatialReference),i.geometries=JSON.stringify({geometryType:rp(r),geometries:e}),this.transformation&&(i.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(i.transformForward=this.transformForward),i}};a([c()],Ta.prototype,"geometries",void 0),a([c({type:Z,json:{read:{source:"outSR"}}})],Ta.prototype,"outSpatialReference",void 0),a([c()],Ta.prototype,"transformation",void 0),a([c()],Ta.prototype,"transformForward",void 0),Ta=a([b("esri.rest.support.ProjectParameters")],Ta);const iwe=ut(Ta);async function swe(t,e,r){e=iwe(e);const i=wy(t),s={...i.query,f:"json",...e.toJSON()},n=e.outSpatialReference,o=rp(e.geometries[0]),l=WM(s,r);return Ae(i.path+"/project",l).then(({data:{geometries:u}})=>Gj(u,o,n))}const JV=()=>L.getLogger("esri.widgets.support.geolocationUtils"),nwe={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function owe(){const t=!!k("esri-geolocation");return t||JV().warn("geolocation-unsupported","Geolocation unsupported."),t}function awe(){const t=window.isSecureContext;return t||JV().warnOnce("insecure-context","Geolocation requires a secure origin."),t}function CA(){return owe()&&awe()}function lwe(t){return t??=nwe,new Promise((r,i)=>{setTimeout(()=>i(new x("geolocation:timeout","getting the current geolocation position timed out")),15e3),navigator.geolocation.getCurrentPosition(r,i,t??void 0)})}function uwe(t,e){const{position:r,view:i}=t,s=cwe(r),n=s?.coords;if(!n)throw new x("geometry-service:no-coords","Geolocation has no coordinates");return hwe(dwe(n),i,e)}function cwe(t){const e=t&&t.coords||{},r={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed,toJSON:()=>({})};return t&&{coords:r,timestamp:t.timestamp,toJSON:()=>({})}}function dwe({longitude:t,latitude:e,altitude:r}){return new ee({longitude:t,latitude:e,z:r||void 0,spatialReference:{wkid:4326}})}function hwe(t,e,r){if(!e)return Promise.resolve(t);const i=e.spatialReference;return i.isWGS84?Promise.resolve(t):i.isWebMercator?Promise.resolve(za(t)):pwe(r).then(s=>{if(!s)throw new x("geometry-service:missing-url","Geometry service URL is missing");const n=new Ta({geometries:[t],outSpatialReference:i});return swe(s,n,r).then(o=>o[0])})}function pwe(t){if(_e.geometryServiceUrl)return Promise.resolve(_e.geometryServiceUrl);const e=j.getDefault();return e.load(t).catch(()=>{}).then(()=>e.helperServices?.geometry?.url)}function vr(t,e){return t.hasOwnProperty(e)&&t[e]!=null&&t[e]!==""}const PA="highlight",Z0=H.ofType({key:t=>t.layer?"layer":"locator",base:L3,typeMap:{layer:nd,locator:ZV}}),AA=Z.WGS84,fwe="esri/images/search/search-symbol-32.png",mwe=/<[\s\S]*?>/g,gc=-1;var fh;let ve=(fh=class extends R8(Zh){constructor(e){super(e),this._defaultPopupTemplate=new Vn({content:"{Match_addr}"}),this._gotoController=null,this._searching=null,this._updatingPromise=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultSources=new Z0,this.defaultSymbols={point:new _r({url:nt(fwe),size:24,width:24,height:24}),polyline:new wt({color:[130,130,130,1],width:2}),polygon:new pi({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=j.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new Z0,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){this.addHandles([ne(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),Et),ne(()=>this.messages,()=>{this._defaultPopupTemplate.title=this.messages?.searchResult??"",this._update()},Et)])}destroy(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return this.allSources.length===1||!this.searchAllEnabled?0:gc}set activeSourceIndex(e){this._overrideIfSome("activeSourceIndex",e)}get allPlaceholder(){return this.messages?.allPlaceholder}set allPlaceholder(e){this._overrideIfSome("allPlaceholder",e)}get allSources(){const{sources:e,defaultSources:r,includeDefaultSources:i}=this,s=typeof i=="function"?i.call(null,{sources:e,defaultSources:r}):i?r.concat(e):e,n=this._get("allSources")||new Z0;return n.removeAll(),n.addMany(s.filter(Boolean)),n}get defaultPopupTemplate(){return this._defaultPopupTemplate}set defaultPopupTemplate(e){this._overrideIfSome("defaultPopupTemplate",e)}get locationEnabled(){return this._get("locationEnabled")||CA()}set locationEnabled(e){if(e===void 0)return void this._clearOverride("locationEnabled");const r=CA();if(e&&!r){const i=new x("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});L.getLogger(this).error(i)}this._override("locationEnabled",!!e&&r)}get placeholder(){const{allSources:e,activeSourceIndex:r,allPlaceholder:i}=this;return r===gc?i??"":e.at(r)?.placeholder??""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),e===""&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":this.allSources.length===0?"disabled":"ready"}get updating(){return this._updatingPromise!=null}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup();const{view:e,resultGraphic:r}=this;e&&r&&e.graphics.remove(r),this._set("resultGraphic",null)}search(e,r){this.emit("search-start"),this.clearGraphics();const i=this._createSuggestionForSearch(e),s=(async()=>{try{await this.when();const n=await this._getResultsFromSources(i,r);if(r?.signal?.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:i.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(o,n,i);const l=this._getFirstResult(o.results),u=i.location&&l?l.name:i.text,d=u?.replaceAll(mwe,"");return this._set("searchTerm",d),(i.key&&typeof i.sourceIndex=="number"||i.location)&&this._set("selectedSuggestion",i),this._set("results",o.results),this._set("resultCount",o.results.reduce((p,f)=>p+(f.results?.length??0),0)),this.emit("search-complete",o),await this._selectFirstResult(l),o}finally{this._clearSearching()}})();return this._searching=s,s}async searchNearby(e){if(!this.locationEnabled){const i=new x("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});throw L.getLogger(this).error(i),i}const r=(async()=>{try{const i=await lwe(),s=await uwe({position:i,view:this.view},e);return await this.search(s,e)}finally{this._clearSearching()}})();return this._searching=r,r}async select(e){if(this.clearGraphics(),!e){const G=new x("select:missing-parameter","Cannot select without a searchResult.",{value:e});throw L.getLogger(this).error(G),G}const{view:r}=this,i=vr(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),s=i!=null?this.allSources.at(i):null;if(!s){const G=new x("select:missing-source","Cannot select without a source.",{source:s});throw L.getLogger(this).error(G),G}const n=s instanceof nd?this._getLayerSourcePopupTemplate(s):s.popupTemplate,o=s.resultSymbol||this._getDefaultSymbol(e),l=vr(s,"resultGraphicEnabled")?s.resultGraphicEnabled:this.resultGraphicEnabled,u=vr(s,"autoNavigate")?s.autoNavigate:this.autoNavigate,d=vr(s,"popupEnabled")?s.popupEnabled:this.popupEnabled,p=d?n||this.popupTemplate||this.defaultPopupTemplate:null,{feature:f}=e;if(!f){const G=new x("select:missing-feature","Cannot select without a feature.",{feature:f});throw L.getLogger(this).error(G),G}const{attributes:m,geometry:y,layer:g,sourceLayer:v}=f,_=y?OA(y):null,S={layerViewQuery:this._getLayerView(f),elevationQuery:r&&_!=null?fve(_,r):Promise.resolve(_)},M=await tu(S),C=M.layerViewQuery.value,T=M.elevationQuery.value;o instanceof Le&&(o.text=e.name);const O=r&&u?e.target||e.extent:null;await(O!=null?this._goToSearchResult(O):Promise.resolve());const D=C?f:new st({geometry:y,symbol:o,attributes:m,layer:g,sourceLayer:v,popupTemplate:p}),z=zS(r),B=z&&d&&D.getEffectivePopupTemplate(z.defaultPopupTemplateEnabled);return B&&await r?.openPopup({features:[D],location:T}),C&&mve(C)&&!B&&this._highlightFeature({graphic:D,layerView:C}),!C&&l&&r&&r.graphics.push(D),this._setResultFloor(e),this._set("selectedResult",e),this._set("resultGraphic",D),this.emit("select-result",{result:e,source:s,sourceIndex:i}),e}async suggest(e,r,i){const s=e||this.searchTerm;this.emit("suggest-start",{searchTerm:s}),await this._suggestTimer(r,i);const n=await this._suggestImmediate(s,i);return this._set("suggestions",n?.results),this._set("suggestionCount",n?.results.reduce((o,l)=>o+(l.results?.length??0),0)??null),this.emit("suggest-complete",n),n}async when(e,r){await Rw(()=>!this.updating)}async _update(){const{portal:e,view:r}=this;if(this.includeDefaultSources){const i=this._updatingPromise=tu([e?.load(),r?.when()]);if(this.destroyed||(await i,i!==this._updatingPromise))return}this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){const e=this.portal?.helperServices?.geocode;return e?e.map(r=>{if(r.placefinding===!1)return;const i=kA(r.url)&&OR(r.url)?{url:Kve}:null,s=ZV.fromJSON({...r,...i}),n=s.url;if(kA(n)||Yve(n)||Jve(n)){const o=s.outFields??["Addr_type","Match_addr","StAddr","City"],l=(s.placeholder||this.messages?.placeholder)??"",u=typeof s.defaultZoomScale=="number"?s.defaultZoomScale:2500;s.singleLineFieldName="SingleLine",s.outFields=o,s.placeholder=l,s.defaultZoomScale=u}return s.singleLineFieldName?s:void 0}).filter(hs):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(e=>e?.destroy()),this._createdFeatureLayers=[]}_getLayerSources(e,r){const i=this.view?.map;return e.map(s=>{const n=i.findLayerById(s.id);if(!n)return;const o=this._getLayerJSON(s),l=nd.fromJSON(o);return l.placeholder=r,this._getLayer(n,o).then(u=>{l.layer=u}),l}).filter(hs).toArray()}_getTableSources(e,r){const i=this.view?.map;return e.map(s=>{if(!s.id)return;const n=i.findTableById(s.id);if(!n)return;const o=this._getLayerJSON(s),l=nd.fromJSON(o);return l.placeholder=r,this._getLayer(n,o).then(u=>{l.layer=u}),l}).filter(hs).toArray()}_convertApplicationProperties(){const e=this.view?.map,r=e?.applicationProperties?.viewing?.search;if(!r)return[];const{enabled:i,hintText:s,layers:n,tables:o}=r;return i?[...this._getLayerSources(n,s),...this._getTableSources(o,s)]:[]}async _getSubLayer(e,r){if(await e.load(),!e.allSublayers)throw new Error;const i=e.allSublayers.find(n=>n.id===r.subLayer);if(!i)throw new Error;const s=await i.createFeatureLayer?.();if(!s)throw new Error;return this._createdFeatureLayers.push(s),s}async _getBuildingSubLayer(e,r){await e.load();const i=e.allSublayers.find(s=>s.id===r.subLayer);if(i?.type!=="building-component")throw new Error;if(await i.load(),i.associatedLayer==null)throw new Error;return await i.associatedLayer.load(),i}async _getLayer(e,r){if(e.type==="feature"||e.type==="scene"||e.type==="csv"||e.type==="geojson"||e.type==="ogc-feature")return e;if(e.type==="map-image")try{return await this._getSubLayer(e,r)}catch{const s=new x("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return L.getLogger(this).error(s),null}return e.type==="building-scene"?this._getBuildingSubLayer(e,r):null}_getLayerJSON(e){return typeof e.toJSON=="function"?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:r}=this;this._destroyFeatureLayers(),e.removeAll(),r&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){const e=zS(this.view),{resultGraphic:r}=this;if(!e||!r)return;const i="selectedFeature"in e,s=i?e.selectedFeature:null;i&&s&&s===r&&e4(this.view?.popup,this.view?.popupElement)}_suggestTimer(e,r){const i=e??this.suggestionDelay;return fT(i,null,r?.signal)}_createLocationForSearch(e){return e instanceof st&&e.geometry?OA(e.geometry):e instanceof ee?e:Array.isArray(e)&&e.length===2?new ee({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&vr(e,"key")&&vr(e,"text")&&vr(e,"sourceIndex"))return e;const r=this._createLocationForSearch(e),i=typeof e=="string"?e:this.searchTerm,{selectedSuggestion:s,selectedResult:n}=this,o=!e&&s&&n,l=o&&s.key===n.key&&s.sourceIndex===n.sourceIndex,u=o&&s.location;return l||u?s:{location:r,text:r?"":i,sourceIndex:null,key:null}}_getFirstResult(e){return K0(e,({results:r})=>r?.[0])??null}async _selectFirstResult(e){return this.autoSelect&&e?this.select(e):null}async _suggestImmediate(e,r){await this.when();const i=await this._getSuggestionsFromSources(e,r);if(r?.signal?.aborted)return null;const s={activeSourceIndex:this.activeSourceIndex,searchTerm:e??"",numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(s,i),s}_formatSourceResponse(e,r,i){const s=r?.value||[],n=r?.error,o=this.allSources.at(i);if(n){const l={sourceIndex:i,source:o,error:n};e.errors.push(l),L.getLogger(this).error(n),e.numErrors++}else{const l={sourceIndex:i,source:o,results:s};e.results.push(l),e.numResults+=s.length}}_formatResponse(e,r,i){if(r)if(e.activeSourceIndex===gc){const s=i&&vr(i,"sourceIndex")&&i.sourceIndex!==-1?i.sourceIndex:void 0;r.forEach((n,o)=>{const l=s!==void 0?s:o;this._formatSourceResponse(e,n,l)})}else this._formatSourceResponse(e,r[0],e.activeSourceIndex)}async _getResultsFromSources(e,r){const{allSources:i}=this,s=!e.location&&vr(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,n=[];if(!i.length){const o=new x("search:no-sources-defined","At least one source is required.",{allSources:i});throw L.getLogger(this).error(o),o}return s===gc?i.forEach((o,l)=>{n.push(this._getResultsFromSource(e,l,r))}):n.push(this._getResultsFromSource(e,s,r)),tu(n)}async _getSuggestionsFromSources(e,r){const{allSources:i,activeSourceIndex:s}=this,n=[];if(!i.length){const o=new x("suggest:no-sources-defined","At least one source is required.",{allSources:i});throw L.getLogger(this).error(o),o}return s===gc?i.forEach((o,l)=>{n.push(this._getSuggestionsFromSource(e,l,r))}):n.push(this._getSuggestionsFromSource(e,s,r)),tu(n)}async _getResultsFromSource(e,r,i){const s=r!=null?this.allSources.at(r):null;if(!s)return null;const{location:n=null}=e,o=this.view?.spatialReference??AA,l=vr(s,"maxResults")?s.maxResults:this.maxResults,u=!!(s instanceof nd&&vr(s,"exactMatch"))&&s.exactMatch,{view:d}=this;return s.getResults?.({exactMatch:u,location:n,maxResults:l,sourceIndex:r,spatialReference:o,suggestResult:e,view:d},i)}async _getSuggestionsFromSource(e,r,i){const s=this.allSources.at(r);if(!s)return null;e??="";const n=vr(s,"suggestionsEnabled")?s.suggestionsEnabled:this.suggestionsEnabled,o=e?.length,l=vr(s,"minSuggestCharacters")?s.minSuggestCharacters:this.minSuggestCharacters;if(n&&e.trim()&&o>=l){const u=this.view?.spatialReference||AA,d=vr(s,"maxSuggestions")?s.maxSuggestions:this.maxSuggestions,{view:p}=this,f=!!(s instanceof nd&&vr(s,"exactMatch"))&&s.exactMatch;return s.getSuggestions?.({view:p,sourceIndex:r,suggestTerm:e,spatialReference:u,maxSuggestions:d,exactMatch:f},i)}return null}_getLayerSourcePopupTemplate(e){const{layer:r}=e;if(r)return vr(e,"popupTemplate")?e.popupTemplate:r.popupTemplate}_getSourceIndexOfResult(e){return K0(this.results??[],({results:r,sourceIndex:i})=>r?.includes(e)?i:null)??null}async _goToSearchResult(e){this._abortGoTo();const r=new AbortController;this._gotoController=r;const i={target:{target:e},options:{signal:r.signal}};e||(i.options.animate=!1),await this.callGoTo(i),this._gotoController=null}_getDefaultSymbol(e){const{defaultSymbols:r}=this,i=e.feature?.geometry;if(i==null)return null;switch(i.type){case"point":case"multipoint":return r.point;case"polyline":return r.polyline;case"extent":case"polygon":return r.polygon;default:return null}}_removeHighlight(){this.removeHandles(PA)}async _getLayerView(e){const{view:r}=this;if(!e||!r)return null;const{layer:i,sourceLayer:s}=e,n=i??s;return n&&n.type!=="building-component"&&n.type!=="subtype-sublayer"?(await r.when(),r.whenLayerView(n)):null}_highlightFeature(e){const{graphic:r,layerView:i}=e,{attributes:s,layer:n,sourceLayer:o}=r,l=n??o,{objectIdField:u}=l,d=(u&&s?.[u])??null,p=i.highlight(d??r);this.addHandles(p,PA)}_setResultFloor(e){const{view:r}=this,i=e.feature?.attributes,s=e.feature?.sourceLayer;if(s&&"floorInfo"in s&&s?.floorInfo?.floorField&&i){const n=i[s.floorInfo.floorField];r?.emit("select-result-floor",n)}}},fh.ALL_INDEX=gc,fh);a([c()],ve.prototype,"_searching",void 0),a([c()],ve.prototype,"_updatingPromise",void 0),a([c({readOnly:!0,value:null})],ve.prototype,"activeSource",null),a([c()],ve.prototype,"activeSourceIndex",null),a([c()],ve.prototype,"allPlaceholder",null),a([c({readOnly:!0})],ve.prototype,"allSources",null),a([c()],ve.prototype,"autoNavigate",void 0),a([c()],ve.prototype,"autoSelect",void 0),a([c({type:Vn})],ve.prototype,"defaultPopupTemplate",null),a([c({readOnly:!0})],ve.prototype,"defaultSources",void 0),a([c()],ve.prototype,"defaultSymbols",void 0),a([c()],ve.prototype,"includeDefaultSources",void 0),a([c()],ve.prototype,"locationEnabled",null),a([c()],ve.prototype,"maxInputLength",void 0),a([c()],ve.prototype,"maxResults",void 0),a([c()],ve.prototype,"maxSuggestions",void 0),a([c()],ve.prototype,"messages",void 0),a([c()],ve.prototype,"minSuggestCharacters",void 0),a([c({readOnly:!0})],ve.prototype,"placeholder",null),a([c()],ve.prototype,"popupEnabled",void 0),a([c({type:Vn})],ve.prototype,"popupTemplate",void 0),a([c({type:j})],ve.prototype,"portal",void 0),a([c()],ve.prototype,"resultCount",void 0),a([c()],ve.prototype,"resultGraphicEnabled",void 0),a([c({readOnly:!0})],ve.prototype,"resultGraphic",void 0),a([c({readOnly:!0})],ve.prototype,"results",void 0),a([c({readOnly:!0})],ve.prototype,"selectedSuggestion",void 0),a([c()],ve.prototype,"searchAllEnabled",void 0),a([c({readOnly:!0})],ve.prototype,"selectedResult",void 0),a([c()],ve.prototype,"searchTerm",null),a([c({type:Z0})],ve.prototype,"sources",void 0),a([c({readOnly:!0})],ve.prototype,"state",null),a([c()],ve.prototype,"suggestionDelay",void 0),a([c()],ve.prototype,"suggestionCount",void 0),a([c({readOnly:!0})],ve.prototype,"suggestions",void 0),a([c()],ve.prototype,"suggestionsEnabled",void 0),a([c({readOnly:!0})],ve.prototype,"updating",null),a([c()],ve.prototype,"view",void 0),a([c()],ve.prototype,"clear",null),ve=a([b("esri.widgets.Search.SearchViewModel")],ve);const bd=ve;let ad=class extends np{constructor(t,e){super(t,e),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}loadDependencies(){return by({block:()=>N(()=>import("./index-C1awwGCk.js"),__vite__mapDeps([326,299,300,301,302,327,306,305,304,303,328,329,330,309,331,332,333,312,311,334,335,308,336,337,338,339,340,307,341])),list:()=>N(()=>import("./index-BI5GxQgU.js"),__vite__mapDeps([342,299,300,301,302,327,306,305,304,335,303,343,344,307,308,309,331,310,311,312,345,346,330,347])),"list-item":()=>N(()=>import("./index-BiXHCN3-.js"),__vite__mapDeps([348,303,304,305,328,306,329,330,300,309,331,332,333,312,302,311,299,301,334,335,308,336,337,338,339,347,349])),"list-item-group":()=>N(()=>import("./index-CcAMG5K3.js"),__vite__mapDeps([350,309,349]))})}destroy(){this.viewModel=null}render(){return Ie("div",{class:this.classes(EA.base,fs.widget)},this.viewModel?.selectedResult?.name??"",this._renderMoreResults())}_renderMoreResults(){if(!this.viewModel)return null;const{resultCount:t,results:e}=this.viewModel;return!t||t<2||!e?null:Ie("calcite-block",{class:EA.moreResults,collapsible:!0,expanded:this.showMoreResultsOpen,heading:XT(this.messages.showMoreResults,{count:t-1}),onCalciteBlockClose:()=>this._toggleShowMoreResults(!1),onCalciteBlockOpen:()=>this._toggleShowMoreResults(!0)},e.map(r=>this._renderMoreResultsList(r,e?.length>1)))}_renderListItem(t){return Ie("calcite-list-item",{key:`result-${t.sourceIndex}-${t.key}`,label:t.name,onCalciteListItemSelect:()=>this._selectResult(t)})}_renderMoreResultsList(t,e){const{results:r}=t;if(!(r?.length??0)||!r)return null;const i=this.viewModel?.selectedResult,s=this._getSourceName(t.source,t.sourceIndex),n=r.filter(o=>o!==i).map(o=>this._renderListItem(o));return Ie("calcite-list",{label:s},e?Ie("calcite-list-item-group",{heading:s,key:`group-${t.sourceIndex}`},n):n)}_selectResult(t){this.showMoreResultsOpen=!1,this.viewModel?.select(t)}_toggleShowMoreResults(t){this.showMoreResultsOpen=t;const e=zS(this.viewModel?.view);e&&"reposition"in e&&typeof e.reposition=="function"&&e.reposition()}_getSourceName(t,e){return e===bd.ALL_INDEX?this.messages.all:t.name}};a([c(),ju("esri/widgets/Search/t9n/Search")],ad.prototype,"messages",void 0),a([c()],ad.prototype,"showMoreResultsOpen",void 0),a([c()],ad.prototype,"viewModel",void 0),ad=a([b("esri.widgets.Search.SearchResultRenderer")],ad);const ywe=ad;function gwe(t){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const r=e._delegatedEventNames;t=Array.isArray(t)?t:vwe(t),r.push(...t)}}function vwe(t){return t.split(",").map(e=>e.trim())}let we=class extends np{constructor(t,e){super(t,e),this._currentLocationValue=`${this.id}-search-use-current-location`,this._autocompleteNode=null,this._focusAbortController=null,this._searchResultRenderer=new ywe,this._suggestController=null,this._searchController=null,this._lastSearchTerm="",this._locateFailed=!1,this._showNoResults=!1,this.disabled=!1,this.messages=null,this.messagesCommon=null,this.viewModel=new bd,this._renderSearchResultsContent=()=>this._searchResultRenderer,RR(L.getLogger(this),"Search","arcgis-search",{version:"4.33"}),this.addHandles([ne(()=>this.viewModel,r=>this._searchResultRenderer.viewModel=r,Et),ne(()=>this.viewModel.results,()=>this._searchResultRenderer.showMoreResultsOpen=!1),ne(()=>this.messages,r=>this.viewModel.messages=r),ne(()=>this.viewModel?.defaultPopupTemplate,r=>{r&&(r.content=this._renderSearchResultsContent)},Et),ne(()=>this.viewModel?.view?.popupElement&&this.viewModel?.defaultPopupTemplate,()=>{if(this.viewModel?.defaultPopupTemplate&&this.viewModel?.view?.popupElement){const r=document.createElement("arcgis-search-result-renderer");r.viewModel=this.viewModel,r.messages=this.messages,this.viewModel.defaultPopupTemplate.content=r}},Et)])}loadDependencies(){return by({autocomplete:()=>N(()=>import("./index-Db5Q8yTA.js"),__vite__mapDeps([351,303,304,305,343,344,306,335,307,302,308,309,331,310,311,301,312,329,330,332,300,346,345])),"autocomplete-item-group":()=>N(()=>import("./index-q3M1EL8L.js"),[]),"autocomplete-item":()=>N(()=>import("./index-D44McEJw.js"),__vite__mapDeps([352,303,304,305,311,309,300])),button:()=>N(()=>import("./index-B0oBcKDl.js"),__vite__mapDeps([298,299,300,301,302,303,304,305,306,307,308,309,310,311,312])),dropdown:()=>N(()=>import("./index-2anqfirs.js"),__vite__mapDeps([328,306,304,329,330,300,309,331,305,332,333,312,302,311])),"dropdown-group":()=>N(()=>import("./index-DbOvxA8w.js"),__vite__mapDeps([338,305,337])),"dropdown-item":()=>N(()=>import("./index-DIsXsLJN.js"),__vite__mapDeps([336,303,304,305,306,311,309,312,302,337])),notice:()=>N(()=>import("./index-CxvW438j.js"),__vite__mapDeps([353,303,304,305,306,332,311,301,302,312]))})}destroy(){this._cancelQueries(),this._searchResultRenderer=Ke(this._searchResultRenderer),this._focusAbortController?.abort()}get _isDisabled(){const{state:t}=this.viewModel;return t==="disabled"||t==="loading"||this.disabled}get _showCurrentLocation(){return this.locationEnabled&&!this.searchTerm?.trim()}get _effectiveActiveMenu(){const{activeMenu:t}=this;return this._isDisabled?"none":t==="warning"?"suggestion":t}get activeMenu(){return"none"}set activeMenu(t){t==="warning"&&G7(L.getLogger(this),"activeMenu","warning",{replacement:"Use the value 'suggestion' instead",version:"4.32",warnOnce:!0}),this._overrideIfSome("activeMenu",t)}get activeSource(){return this.viewModel?.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(t){this.viewModel.activeSourceIndex=t}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(t){this.viewModel.allPlaceholder=t}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(t){this.viewModel.autoNavigate=t}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(t){this.viewModel.autoSelect=t}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return"search"}set icon(t){this._overrideIfSome("icon",t)}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(t){this.viewModel.includeDefaultSources=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(t){this.viewModel.locationEnabled=t}get maxResults(){return this.viewModel.maxResults}set maxResults(t){this.viewModel.maxResults=t}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(t){this.viewModel.maxSuggestions=t}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(t){this.viewModel.minSuggestCharacters=t}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(t){this.viewModel.popupEnabled=t}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(t){this.viewModel.popupTemplate=t}get portal(){return this.viewModel?.portal}set portal(t){this.viewModel&&(this.viewModel.portal=t)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(t){this.viewModel.resultGraphic=t}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(t){this.viewModel.resultGraphicEnabled=t}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(t){this.viewModel.searchAllEnabled=t}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(t){this.viewModel.searchTerm=t}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(t){this.viewModel.sources=t}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(t){this.viewModel.suggestionsEnabled=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}clear(){this._locateFailed=!1,this.viewModel.clear()}focus(){this._handleFocus(),this._emitFocus()}blur(){this._autocompleteNode?.blur(),this._emitBlur()}async search(t){this._cancelQueries();const e=new AbortController,{signal:r}=e;this._searchController=e;try{const i=await this.viewModel.search(t,{signal:r});return this._searchController!==e?void 0:(i?.numResults||(this._showNoResults=!0,this.activeMenu="suggestion"),this._searchController=null,i)}catch{return this._searchController!==e?void 0:void(this._searchController=null)}}async suggest(t){this._cancelSuggest();const e=new AbortController,{signal:r}=e;this._suggestController=e;try{const i=await this.viewModel.suggest(t,null,{signal:r});return this._suggestController!==e?void 0:(this._suggestController=null,i?.numResults&&(this.activeMenu="suggestion",this._scrollToTopSuggestion()),i)}catch{return this._suggestController!==e||(this._suggestController=null),null}}render(){return Ie("div",{class:this.classes(xl.base,fs.widget)},Ie("div",{class:xl.container},this._renderSourcesMenu(),this._renderForm()))}_handleInputKeydown(t){t.key==="Tab"&&this._cancelSuggest()}_emitFocus(){this.emit("search-focus")}_emitBlur(){this.emit("search-blur")}async _handleFocus(){this._focusAbortController?.abort(),this._focusAbortController=new AbortController;const t=this._focusAbortController.signal;await yh(XR(t)),this._autocompleteNode?.setFocus()}_renderSourcesMenu(){const{messages:t,_isDisabled:e,_effectiveActiveMenu:r}=this,{allSources:i,searchAllEnabled:s}=this.viewModel;return i.length>1?Ie("calcite-dropdown",{bind:this,class:xl.dropdown,disabled:e,open:r==="source",overlayPositioning:"fixed",onCalciteDropdownClose:this._handleSourceClose,onCalciteDropdownOpen:this._handleSourceOpen,onCalciteDropdownSelect:this._handleSourceSelect},Ie("calcite-button",{appearance:"outline-fill",iconStart:"caret-down",kind:"neutral",label:t.searchIn,slot:"trigger"}),Ie("calcite-dropdown-group",{groupTitle:t.searchIn},s?this._renderSource(bd.ALL_INDEX):null,i.map((n,o)=>this._renderSource(o)).toArray())):null}_renderUseCurrentLocation(){const{_currentLocationValue:t}=this;return Ie("calcite-autocomplete-item",{heading:this.messages.useCurrentLocation,iconStart:"gps-on",key:t,value:t})}_handleAutocompleteCreate(t){this._autocompleteNode=t}_handleCalciteAutocompleteTextInput(t){const e=t.target.inputValue;e!==this.viewModel.searchTerm&&(this.viewModel.searchTerm=e,e||this.clear(),this.suggest())}_handleAutocompleteOpen(){this.activeMenu="suggestion"}_handleAutocompleteClose(){this.activeMenu==="suggestion"&&(this.activeMenu="none")}_handleCalciteAutocompleteChange(t){const e=t.target.value;if(e===this._currentLocationValue)return void this._useCurrentLocation();const r=JSON.parse(e),i=this.viewModel.suggestions?.find(({sourceIndex:s})=>s===r.sourceIndex)?.results?.find(({key:s})=>`${s}`==`${r.key}`);i&&this.search(i)}_renderAutocomplete(){const{_effectiveActiveMenu:t,messages:e,_isDisabled:r}=this,{maxInputLength:i,placeholder:s,searchTerm:n,state:o}=this.viewModel,l=this.label??e.searchButtonTitle??"";return Ie("calcite-autocomplete",{afterCreate:this._handleAutocompleteCreate,autocomplete:"off",bind:this,class:xl.autocomplete,disabled:r,icon:this.icon||!1,inputValue:n,label:l,loading:o==="searching",maxLength:i,name:this.id,onblur:this._emitBlur,onfocus:this._emitFocus,onkeydown:this._handleInputKeydown,open:t==="suggestion",overlayPositioning:"fixed",placeholder:s,title:n?"":s,onCalciteAutocompleteChange:this._handleCalciteAutocompleteChange,onCalciteAutocompleteClose:this._handleAutocompleteClose,onCalciteAutocompleteOpen:this._handleAutocompleteOpen,onCalciteAutocompleteTextChange:this._handleCalciteAutocompleteTextInput,onCalciteAutocompleteTextInput:this._handleCalciteAutocompleteTextInput},this._renderSuggestions(),this._renderNotices())}_renderForm(){return Ie("form",{bind:this,class:xl.form,disabled:this._isDisabled,key:xl.form,onsubmit:this._formSubmit,role:"search"},this._renderAutocomplete(),Ie("button",{class:xl.submitButton,type:"submit"},this.label??this.messages.searchButtonTitle??""))}_renderSuggestGroup(t){return t.results?.map(e=>this._renderSuggestion(e))}_renderSuggestions(){const{suggestions:t}=this.viewModel;return this._showNoResults?null:this._showCurrentLocation?this._renderUseCurrentLocation():t?.map(e=>this._renderSuggestResults(e))}_renderSuggestResults(t){const{allSources:e,activeSourceIndex:r}=this.viewModel,{sourceIndex:i}=t,s=t.results?.length,n=e.length>1&&r===bd.ALL_INDEX,o=this._getSourceName(i);return s&&n?Ie("calcite-autocomplete-item-group",{heading:o,key:`suggestion-group-${o}-${i}`},this._renderSuggestGroup(t)):this._renderSuggestGroup(t)}_renderSuggestion({key:t,sourceIndex:e,text:r}){const i={key:t,sourceIndex:e};return Ie("calcite-autocomplete-item",{heading:r??this.messages.untitledResult,key:`suggestion_${t}`,value:JSON.stringify(i)})}_renderSource(t){const e=this._getSourceName(t);return Ie("calcite-dropdown-item",{"data-source-index":`${t}`,key:`source-${e}-${t}`,selected:t===this.viewModel.activeSourceIndex},e)}_renderNoResultsWarning(t){const{messages:e}=this,r=t?XT(e.noResultsFoundForValue,{value:`"${t}"`}):e.noResultsFound;return Ie("calcite-notice",{icon:"exclamation-mark-triangle",key:"no-results-warning",kind:"warning",open:!0,slot:"content-bottom"},Ie("div",{slot:"title"},e.noResults),Ie("div",{slot:"message"},r))}_renderLocateError(){return Ie("calcite-notice",{icon:"exclamation-mark-circle",key:"locate-warning",kind:"danger",open:!0,slot:"content-bottom"},Ie("div",{slot:"message"},this.messages.locateError))}_renderNotices(){return this._locateFailed?this._renderLocateError():this._showNoResults?this._renderNoResultsWarning(this._lastSearchTerm??this.viewModel.searchTerm):null}async _useCurrentLocation(){this._cancelQueries();const t=new AbortController,{signal:e}=t;this._searchController=t;try{await this.viewModel.searchNearby({signal:e})}catch(r){sr(r)||(this._locateFailed=!0,this.activeMenu="suggestion")}finally{this._searchController=null}}_handleSourceOpen(){this.activeMenu="source"}_handleSourceClose(){this.activeMenu==="source"&&(this.activeMenu="none")}_handleSourceSelect(t){const e=t.target.selectedItems[0].getAttribute("data-source-index");e&&(this.viewModel.activeSourceIndex=parseInt(e,10))}_cancelSuggest(){this.activeMenu="none",this._locateFailed=!1,this._showNoResults=!1,this._suggestController=jo(this._suggestController)}_cancelQueries(){this._cancelSuggest(),this._searchController=jo(this._searchController)}_scrollToTopSuggestion(){this._autocompleteNode?.scrollContentTo({top:0})}_formSubmit(t){t.preventDefault(),this.activeMenu="none",this._lastSearchTerm=this.searchTerm,this.searchTerm&&this.search()}_getSourceName(t){const{messages:e}=this,{allSources:r}=this.viewModel,i=r.at(t);return t===bd.ALL_INDEX?e.all:i?.name||e.untitledSource}};a([c()],we.prototype,"_locateFailed",void 0),a([c()],we.prototype,"_showNoResults",void 0),a([c()],we.prototype,"_isDisabled",null),a([c()],we.prototype,"_showCurrentLocation",null),a([c()],we.prototype,"_effectiveActiveMenu",null),a([c()],we.prototype,"activeMenu",null),a([c({readOnly:!0})],we.prototype,"activeSource",null),a([c()],we.prototype,"activeSourceIndex",null),a([c()],we.prototype,"allPlaceholder",null),a([c({readOnly:!0})],we.prototype,"allSources",null),a([c()],we.prototype,"autoNavigate",null),a([c()],we.prototype,"autoSelect",null),a([c({readOnly:!0})],we.prototype,"defaultSources",null),a([c()],we.prototype,"disabled",void 0),a([c()],we.prototype,"goToOverride",null),a([c()],we.prototype,"icon",null),a([c()],we.prototype,"includeDefaultSources",null),a([c()],we.prototype,"label",null),a([c()],we.prototype,"locationEnabled",null),a([c()],we.prototype,"maxResults",null),a([c()],we.prototype,"maxSuggestions",null),a([c(),ju("esri/widgets/Search/t9n/Search")],we.prototype,"messages",void 0),a([c(),ju("esri/t9n/common")],we.prototype,"messagesCommon",void 0),a([c()],we.prototype,"minSuggestCharacters",null),a([c()],we.prototype,"popupEnabled",null),a([c()],we.prototype,"popupTemplate",null),a([c()],we.prototype,"portal",null),a([c()],we.prototype,"resultGraphic",null),a([c()],we.prototype,"resultGraphicEnabled",null),a([c({readOnly:!0})],we.prototype,"results",null),a([c()],we.prototype,"searchAllEnabled",null),a([c()],we.prototype,"searchTerm",null),a([c({readOnly:!0})],we.prototype,"selectedResult",null),a([c()],we.prototype,"sources",null),a([c({readOnly:!0})],we.prototype,"suggestions",null),a([c()],we.prototype,"suggestionsEnabled",null),a([c()],we.prototype,"view",null),a([gwe(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),c({type:bd})],we.prototype,"viewModel",void 0),we=a([b("esri.widgets.Search")],we);const wwe=we;_e.assetsPath="https://js.arcgis.com/4.30/@arcgis/core/assets";const bwe="https://services8.arcgis.com/jzdN07B7ZhRTxuzU/arcgis/rest/services/Streetlights_Inspections/FeatureServer/0";document.querySelector("#app").innerHTML=`
  <div id="app-container">
    <div id="sidebar">
      <h2>Streetlight Web Map</h2>
      <p class="subtitle">Internal-style GIS operations viewer</p>

      <div class="section">
        <label style="display:flex; gap:8px; align-items:center;">
          <input id="toggleLayer" type="checkbox" checked />
          <span>Show Streetlights Layer</span>
        </label>
        <div class="info" id="statusText">Loading</div>
      </div>

      <div class="section">
        <div style="font-size:13px; margin-bottom:8px;">Filter</div>

        <!--  IMPORTANT: values MUST match domain codes: High/Medium/Low -->
        <select id="priorityFilter">
          <option value="All" selected>All</option>
          <option value="High">High Priority</option>
          <option value="Medium">Medium Priority</option>
          <option value="Low">Low Priority</option>
        </select>

        <button id="clearFilterBtn">Clear filter</button>
        <button id="resetViewBtn">Reset view</button>
      </div>

      <div class="section">
        <label style="display:flex; gap:8px; align-items:center;">
          <input id="clusterToggle" type="checkbox" checked />
          <span>Cluster points</span>
        </label>
        <div class="hint">Tip: Use Search (top-left) to jump to an address.</div>
      </div>
    </div>

    <div id="viewDiv"></div>
  </div>
`;const _we=document.getElementById("statusText"),RA=document.getElementById("toggleLayer"),D3=document.getElementById("priorityFilter"),Swe=document.getElementById("clearFilterBtn"),$we=document.getElementById("resetViewBtn"),YV=document.getElementById("clusterToggle");function Kx(t){_we.textContent=t}const xwe={type:"simple",symbol:{type:"simple-marker",style:"circle",size:12,color:[239,68,68,1],outline:{color:[255,255,255,1],width:1.5}}},ms=new K({url:bwe,outFields:["*"],title:"Streetlights",renderer:xwe,popupEnabled:!0,popupTemplate:{title:"Streetlight {LightID}",content:[{type:"fields",fieldInfos:[{fieldName:"Status",label:"Status"},{fieldName:"Priority",label:"Priority"},{fieldName:"Condition",label:"Condition"},{fieldName:"Inspector",label:"Inspector"},{fieldName:"Notes",label:"Notes"},{fieldName:"LastUpdated",label:"Last Updated"}]}]}}),Twe=new vD({basemap:"streets-navigation-vector",layers:[ms]}),qm=new vhe({container:"viewDiv",map:Twe,center:[-96.7026,40.8136],zoom:13}),Mwe=new wwe({view:qm});qm.ui.add(Mwe,"top-left");const Iwe={type:"cluster",clusterRadius:"60px",popupTemplate:{title:"Cluster summary",content:"This cluster represents {cluster_count} streetlights."}};function KV(){ms.featureReduction=YV.checked?Iwe:null}function Ewe(t){return`'${String(t).replaceAll("'","''")}'`}function QV(){const t=D3.value;if(t==="All"){ms.definitionExpression=null;return}ms.definitionExpression=`Priority = ${Ewe(t)}`}async function j3(){try{const t=ms.createQuery();t.where=ms.definitionExpression||"1=1",t.returnGeometry=!1;const e=await ms.queryFeatureCount(t);Kx(`Loaded: ${e} features`)}catch(t){console.error(t),Kx("Loaded (count failed  check console)")}}RA.addEventListener("change",()=>{ms.visible=RA.checked});D3.addEventListener("change",async()=>{QV(),await j3()});Swe.addEventListener("click",async()=>{D3.value="All",ms.definitionExpression=null,await j3()});$we.addEventListener("click",()=>{qm.goTo({center:[-96.7026,40.8136],zoom:13})});YV.addEventListener("change",()=>{KV()});ms.when(async()=>{await qm.whenLayerView(ms),KV(),QV(),await j3();const t=await ms.queryExtent();t?.extent&&await qm.goTo(t.extent.expand(1.2))}).catch(t=>{console.error("Layer failed to load:",t),Kx("Layer failed to load  check console")});export{IK as $,bt as A,_b as B,Yfe as C,Kfe as D,G9 as E,k as F,E as G,pae as H,Rr as I,Vt as J,QZ as K,VC as L,j as M,hs as N,n_e as O,wy as P,o_e as Q,oS as R,Qfe as S,re as T,pe as U,F as V,a_e as W,al as X,OK as Y,tp as Z,N as _,E3 as a,$e as a$,HQ as a0,iD as a1,jM as a2,oX as a3,a as a4,c as a5,b as a6,MIe as a7,TIe as a8,wi as a9,Bge as aA,jge as aB,Tge as aC,Ege as aD,Wu as aE,Vw as aF,joe as aG,ny as aH,PK as aI,AK as aJ,RK as aK,D5 as aL,BQ as aM,dae as aN,SD as aO,Fd as aP,$D as aQ,_D as aR,W2e as aS,rk as aT,T$e as aU,XJ as aV,bR as aW,Uh as aX,dU as aY,lse as aZ,TZ as a_,H as aa,Vne as ab,st as ac,KZ as ad,JZ as ae,L as af,x_e as ag,mh as ah,mEe as ai,O2e as aj,Jh as ak,Ht as al,ku as am,Dn as an,Ige as ao,Kr as ap,Gge as aq,$6 as ar,Xoe as as,_ae as at,w$ as au,Dge as av,vV as aw,Rge as ax,wV as ay,gV as az,I3e as b,YG as b$,se as b0,Z as b1,tl as b2,uy as b3,Rs as b4,use as b5,It as b6,ut as b7,b8,_8 as b9,Sb as bA,ue as bB,up as bC,Uwe as bD,jA as bE,bD as bF,sMe as bG,nue as bH,Nd as bI,kh as bJ,Om as bK,He as bL,ys as bM,pT as bN,Fe as bO,Bh as bP,Pr as bQ,yt as bR,bSe as bS,vSe as bT,wSe as bU,Hh as bV,Be as bW,YMe as bX,Rh as bY,s6 as bZ,KA as b_,D3e as ba,Mn as bb,Se as bc,SM as bd,zs as be,ll as bf,At as bg,fC as bh,wl as bi,bl as bj,VA as bk,UA as bl,qA as bm,Dwe as bn,Pwe as bo,Tbe as bp,NMe as bq,ZMe as br,gOe as bs,bOe as bt,wOe as bu,pOe as bv,aw as bw,zEe as bx,HEe as by,ZEe as bz,Sye as c,x1e as c$,m1e as c0,PL as c1,Yr as c2,pm as c3,rg as c4,fSe as c5,qj as c6,mi as c7,au as c8,zJ as c9,Fr as cA,uI as cB,sr as cC,nee as cD,Te as cE,Qx as cF,Tu as cG,pR as cH,jf as cI,$c as cJ,Qm as cK,le as cL,YEe as cM,KEe as cN,QEe as cO,yge as cP,mge as cQ,tr as cR,Y as cS,age as cT,Ao as cU,oge as cV,CX as cW,MB as cX,EB as cY,IB as cZ,OB as c_,Hbe as ca,A6 as cb,Hye as cc,j1e as cd,Xa as ce,ZZ as cf,Vre as cg,H1e as ch,B1e as ci,Iv as cj,Gre as ck,Dre as cl,sl as cm,w4 as cn,V1e as co,Fu as cp,z1e as cq,G1e as cr,q1e as cs,U1e as ct,v4 as cu,Ore as cv,kre as cw,Qa as cx,y3e as cy,V as cz,K3 as d,AS as d$,T1e as d0,Gi as d1,D_ as d2,tm as d3,zle as d4,xTe as d5,ge as d6,MTe as d7,sp as d8,Lw as d9,COe as dA,Vn as dB,Eb as dC,_e as dD,hy as dE,w2 as dF,ySe as dG,a$e as dH,I$e as dI,Pn as dJ,$L as dK,X as dL,Dte as dM,vIe as dN,ne as dO,Et as dP,Zs as dQ,xr as dR,Lt as dS,JR as dT,d_ as dU,Zle as dV,NA as dW,Ppe as dX,j0e as dY,tt as dZ,co as d_,kT as da,Zh as db,yu as dc,Ke as dd,BOe as de,Lu as df,Mj as dg,T2e as dh,Jw as di,sre as dj,qi as dk,sU as dl,b_e as dm,he as dn,vc as dp,at as dq,Bi as dr,NL as ds,Kg as dt,Ag as du,QG as dv,ie as dw,N6 as dx,T$ as dy,vue as dz,m3e as e,Cn as e$,nM as e0,$be as e1,ey as e2,Cr as e3,yh as e4,Sbe as e5,k1e as e6,y6 as e7,m6 as e8,ebe as e9,_L as eA,x$e as eB,Z_e as eC,d_e as eD,GA as eE,N5 as eF,qL as eG,sse as eH,vre as eI,E2e as eJ,rp as eK,OM as eL,Cre as eM,C2e as eN,Fi as eO,g4 as eP,k2e as eQ,v_e as eR,as as eS,Mw as eT,tae as eU,Ute as eV,Ui as eW,kbe as eX,H7 as eY,Lbe as eZ,zU as e_,tbe as ea,nn as eb,ly as ec,Em as ed,S6 as ee,w6 as ef,zoe as eg,_6 as eh,NT as ei,DT as ej,dB as ek,hB as el,xw as em,Tw as en,WM as eo,ZM as ep,rge as eq,gi as er,rbe as es,Obe as et,jh as eu,uB as ev,DE as ew,EOe as ex,IOe as ey,SQ as ez,N3e as f,Q0 as f$,dT as f0,LX as f1,e0e as f2,cl as f3,nae as f4,NQ as f5,Voe as f6,b6 as f7,mae as f8,y_e as f9,D0e as fA,hfe as fB,ufe as fC,wt as fD,_t as fE,qt as fF,_r as fG,pi as fH,qu as fI,jn as fJ,Y1e as fK,kJ as fL,mm as fM,Co as fN,Mu as fO,yi as fP,q as fQ,U0e as fR,mT as fS,gIe as fT,BL as fU,CL as fV,ive as fW,Mv as fX,xe as fY,hr as fZ,fm as f_,cw as fa,dw as fb,wR as fc,Ta as fd,swe as fe,Ce as ff,fEe as fg,ube as fh,ybe as fi,fP as fj,vv as fk,ep as fl,Ibe as fm,tu as fn,ape as fo,M0e as fp,C0e as fq,Y8 as fr,Ape as fs,ope as ft,lfe as fu,cfe as fv,Hoe as fw,Woe as fx,yae as fy,zr as fz,C3e as g,xS as g$,w1e as g0,v1e as g1,f$e as g2,O$e as g3,Vo as g4,K as g5,No as g6,i7 as g7,Sm as g8,aN as g9,DEe as gA,ud as gB,qo as gC,el as gD,y2e as gE,za as gF,k3e as gG,_R as gH,u7 as gI,h_ as gJ,mOe as gK,w8 as gL,rl as gM,hQ as gN,M1e as gO,fbe as gP,Xm as gQ,qme as gR,rpe as gS,xIe as gT,Wpe as gU,$Ie as gV,Hpe as gW,fT as gX,Bt as gY,vEe as gZ,Lg as g_,lt as ga,Ir as gb,gs as gc,I_e as gd,$h as ge,U_e as gf,i1 as gg,nSe as gh,qw as gi,pM as gj,fM as gk,sSe as gl,pSe as gm,Hw as gn,SY as go,mne as gp,qN as gq,JM as gr,Rpe as gs,cae as gt,m2e as gu,REe as gv,p2e as gw,cy as gx,Ut as gy,f2e as gz,uw as h,zK as h$,ld as h0,Iw as h1,gSe as h2,Gu as h3,Dne as h4,E_e as h5,M_e as h6,mSe as h7,vK as h8,L_e as h9,QL as hA,Br as hB,HU as hC,bme as hD,iEe as hE,QIe as hF,em as hG,Mo as hH,wme as hI,sEe as hJ,nEe as hK,YY as hL,w_e as hM,jY as hN,oae as hO,A1e as hP,BI as hQ,zL as hR,UL as hS,ct as hT,g_e as hU,kQ as hV,rD as hW,Sie as hX,Koe as hY,sD as hZ,aB as h_,VJ as ha,V_ as hb,nt as hc,YTe as hd,S$e as he,c$e as hf,j_e as hg,hj as hh,q$e as hi,Ni as hj,d1e as hk,CK as hl,e1 as hm,_Ie as hn,eY as ho,Uu as hp,HE as hq,Kpe as hr,qh as hs,zh as ht,Gt as hu,Fa as hv,EIe as hw,E1e as hx,gB as hy,CB as hz,p3e as i,FMe as i$,LQ as i0,VK as i1,Bw as i2,zN as i3,Cwe as i4,Cg as i5,Gwe as i6,aae as i7,Yoe as i8,zge as i9,_d as iA,WU as iB,Fn as iC,en as iD,A3e as iE,_Y as iF,zE as iG,yve as iH,GZ as iI,$m as iJ,bh as iK,jEe as iL,_a as iM,$3e as iN,Ace as iO,c3e as iP,ude as iQ,Rce as iR,d3e as iS,s3e as iT,i3e as iU,dde as iV,vf as iW,u3e as iX,cue as iY,kMe as iZ,F6 as i_,Z4 as ia,l$e as ib,EM as ic,bv as id,t$e as ie,e$e as ig,$ie as ih,Y5 as ii,Je as ij,oee as ik,Rbe as il,Kme as im,y7 as io,gT as ip,Qme as iq,t0e as ir,ol as is,kX as it,EX as iu,MX as iv,t1 as iw,Qr as ix,YN as iy,Q5 as iz,m7 as j,fS as j$,Kv as j0,RMe as j1,nm as j2,LMe as j3,$0 as j4,MMe as j5,Mxe as j6,pN as j7,xm as j8,vS as j9,w as jA,kB as jB,mB as jC,Ln as jD,Ene as jE,BM as jF,qJ as jG,P_e as jH,ov as jI,$b as jJ,H0 as jK,uK as jL,kK as jM,Goe as jN,bae as jO,Sae as jP,ZY as jQ,lB as jR,jN as jS,EK as jT,Boe as jU,g6 as jV,i$e as jW,r$e as jX,br as jY,uM as jZ,lM as j_,UY as ja,yN as jb,Lx as jc,p_e as jd,lMe as je,Mbe as jf,Sq as jg,RO as jh,Dh as ji,Dm as jj,Xhe as jk,Wr as jl,s1e as jm,phe as jn,jo,oT as jp,e7 as jq,N_e as jr,uQ as js,zY as jt,Od as ju,fN as jv,ir as jw,Qwe as jx,Qj as jy,dM as jz,T3e as k,k0e as k$,D_e as k0,J_e as k1,Le as k2,JE as k3,l7 as k4,GN as k5,tIe as k6,Rt as k7,Cbe as k8,WD as k9,jTe as kA,DTe as kB,qY as kC,lI as kD,NTe as kE,zT as kF,rH as kG,hJ as kH,eT as kI,Zwe as kJ,tT as kK,Jwe as kL,gy as kM,Ed as kN,hne as kO,_7 as kP,DMe as kQ,mq as kR,Wbe as kS,gEe as kT,yEe as kU,j9 as kV,N9 as kW,dy as kX,NM as kY,Iu as kZ,mw as k_,FG as ka,R3e as kb,oK as kc,WIe as kd,PSe as ke,ISe as kf,mve as kg,pn as kh,Hwe as ki,Wwe as kj,Bwe as kk,zu as kl,DU as km,Sw as kn,qs as ko,rye as kp,s9 as kq,bX as kr,_X as ks,bL as kt,qTe as ku,UTe as kv,zTe as kw,VTe as kx,BTe as ky,GTe as kz,$Ee as l,JMe as l$,qpe as l0,x0e as l1,Xpe as l2,G0e as l3,UO as l4,l4 as l5,nve as l6,Yme as l7,mfe as l8,yb as l9,v6 as lA,c_e as lB,pne as lC,TMe as lD,XB as lE,oH as lF,ty as lG,R1e as lH,BG as lI,ST as lJ,Xbe as lK,Qbe as lL,wJ as lM,Iq as lN,Mq as lO,B_e as lP,z_e as lQ,eu as lR,t7 as lS,Fs as lT,xye as lU,Ype as lV,Mme as lW,F9 as lX,Fme as lY,tR as lZ,lR as l_,$A as la,Ye as lb,sx as lc,mb as ld,h0e as le,$y as lf,afe as lg,xn as lh,Y0e as li,g7 as lj,_w as lk,Rw as ll,ibe as lm,VM as ln,u$e as lo,o$e as lp,pO as lq,Sn as lr,Um as ls,T3 as lt,ffe as lu,pfe as lv,dfe as lw,doe as lx,hoe as ly,V8 as lz,MJ as m,Sce as m$,Me as m0,Wh as m1,xt as m2,Ge as m3,Di as m4,Dr as m5,Nme as m6,zme as m7,E9 as m8,b3 as m9,bc as mA,r_e as mB,wN as mC,vN as mD,fK as mE,Zg as mF,J5 as mG,K_e as mH,mM as mI,Sc as mJ,VSe as mK,zSe as mL,USe as mM,cSe as mN,lSe as mO,iSe as mP,FY as mQ,aSe as mR,hK as mS,K1e as mT,C_e as mU,jSe as mV,ixe as mW,fu as mX,Fwe as mY,iY as mZ,fce as m_,iw as ma,ofe as mb,qe as mc,Hme as md,xme as me,Tme as mf,Eme as mg,Ome as mh,Vme as mi,kme as mj,Cme as mk,Pme as ml,Ame as mm,Rme as mn,Lme as mo,Xt as mp,g1e as mq,Wm as mr,np as ms,by as mt,Ie as mu,XT as mv,ju as mw,V3e as mx,fs as my,TI as mz,O3e as n,DQ as n$,hU as n0,cbe as n1,eR as n2,pw as n3,mbe as n4,pC as n5,HJ as n6,BJ as n7,Yv as n8,eN as n9,gY as nA,qa as nB,kue as nC,GOe as nD,Pue as nE,Aue as nF,LR as nG,h2e as nH,$n as nI,_Ee as nJ,q9 as nK,xT as nL,Oc as nM,jt as nN,zOe as nO,td as nP,I0e as nQ,ki as nR,FEe as nS,oEe as nT,loe as nU,JTe as nV,L3e as nW,Kwe as nX,bie as nY,OQ as nZ,CQ as n_,XTe as na,KTe as nb,QTe as nc,sue as nd,JIe as ne,YIe as nf,ZIe as ng,rn as nh,Ka as ni,Nu as nj,Lse as nk,PN as nl,R_e as nm,M1 as nn,Zm as no,Pbe as np,wEe as nq,x_ as nr,Cpe as ns,sw as nt,zw as nu,NSe as nv,FSe as nw,oN as nx,sN as ny,mY as nz,_ye as o,tce as o$,Hr as o0,go as o1,Ia as o2,Ct as o3,Gie as o4,Bp as o5,goe as o6,RTe as o7,Ro as o8,qf as o9,GQ as oA,Qoe as oB,qQ as oC,kL as oD,Iie as oE,mN as oF,f_e as oG,rM as oH,SR as oI,dbe as oJ,dS as oK,eie as oL,Xwe as oM,t4 as oN,yS as oO,axe as oP,oxe as oQ,fne as oR,$3 as oS,Efe as oT,UT as oU,y1e as oV,oM as oW,tc as oX,aU as oY,F_ as oZ,EMe as o_,jme as oa,v2e as ob,Zme as oc,pEe as od,HN as oe,hEe as of,cm as og,Ga as oh,_m as oi,z0e as oj,zA as ok,lbe as ol,cR as om,GL as on,nI as oo,xR as op,rce as oq,kEe as or,Hu as os,En as ot,Yye as ou,__e as ov,n$e as ow,s$e as ox,uT as oy,WQ as oz,nl as p,xa as p$,OMe as p0,IMe as p1,R6 as p2,s3 as p3,fme as p4,XIe as p5,Gr as p6,GY as p7,Ep as p8,l_e as p9,N3 as pA,ou as pB,Da as pC,QT as pD,Ebe as pE,zwe as pF,Kj as pG,yOe as pH,bMe as pI,wMe as pJ,PTe as pK,ATe as pL,Vj as pM,r6 as pN,Ah as pO,In as pP,hM as pQ,tN as pR,oy as pS,wbe as pT,Dj as pU,vy as pV,lp as pW,et as pX,xfe as pY,$fe as pZ,Ee as p_,Xle as pa,i4 as pb,g2e as pc,kye as pd,WEe as pe,vMe as pf,VEe as pg,uMe as ph,sA as pi,FIe as pj,HG as pk,H4 as pl,NIe as pm,Ai as pn,$o as po,Eh as pp,kpe as pq,Gpe as pr,Bpe as ps,Qpe as pt,v0e as pu,O0e as pv,G$e as pw,B$e as px,H$e as py,Ys as pz,hbe as q,gne as q$,qfe as q0,T9 as q1,Hs as q2,Ws as q3,_o as q4,sxe as q5,G1 as q6,X1e as q7,Cv as q8,zi as q9,ps as qA,sb as qB,Loe as qC,Zbe as qD,Yj as qE,Xj as qF,Bne as qG,Exe as qH,eoe as qI,Oxe as qJ,wQ as qK,t_e as qL,O1e as qM,Po as qN,qr as qO,s_e as qP,bbe as qQ,qle as qR,GJ as qS,jwe as qT,Lwe as qU,ZA as qV,$1e as qW,S1e as qX,$_e as qY,gR as qZ,Pse as q_,fae as qa,xY as qb,wv as qc,I1e as qd,lY as qe,Q1e as qf,rr as qg,er as qh,r0e as qi,k$e as qj,A$e as qk,E$e as ql,i0e as qm,$q as qn,xbe as qo,ul as qp,eF as qq,dne as qr,TY as qs,MY as qt,Wg as qu,A_e as qv,iL as qw,hY as qx,pY as qy,she as qz,de as r,aA as r$,jj as r0,G6 as r1,Ywe as r2,fMe as r3,mMe as r4,yMe as r5,gMe as r6,tMe as r7,iMe as r8,rMe as r9,S2e as rA,M2e as rB,Ar as rC,HMe as rD,uEe as rE,eI as rF,w2e as rG,DJ as rH,nOe as rI,O_e as rJ,ZJ as rK,F_e as rL,R$e as rM,aoe as rN,XEe as rO,vOe as rP,eOe as rQ,fOe as rR,ls as rS,$Oe as rT,q_e as rU,eMe as rV,uOe as rW,lOe as rX,dOe as rY,hOe as rZ,oA as r_,Cue as ra,tB as rb,W1e as rc,nxe as rd,wce as re,XR as rf,_1e as rg,b1e as rh,TB as ri,bce as rj,mce as rk,MSe as rl,fb as rm,MOe as rn,CTe as ro,Hl as rp,bIe as rq,jte as rr,d2e as rs,lEe as rt,uie as ru,I2e as rv,b2e as rw,$2e as rx,_2e as ry,x2e as rz,x as s,o3e as s$,lA as s0,aOe as s1,oOe as s2,rs as s3,cMe as s4,DB as s5,NB as s6,C1e as s7,Hq as s8,_Oe as s9,r8 as sA,vh as sB,pMe as sC,Wle as sD,pbe as sE,BY as sF,GK as sG,kY as sH,W_e as sI,dxe as sJ,XQ as sK,nN as sL,LN as sM,eL as sN,sm as sO,gbe as sP,QQ as sQ,GSe as sR,cge as sS,H_e as sT,BX as sU,hC as sV,nU as sW,Rwe as sX,Awe as sY,cK as sZ,zre as s_,SOe as sa,tOe as sb,BEe as sc,cOe as sd,iOe as se,wge as sf,rOe as sg,Fx as sh,aMe as si,vge as sj,_ge as sk,oMe as sl,JEe as sm,yue as sn,nMe as so,LTe as sp,FTe as sq,dMe as sr,hMe as ss,_Me as st,SMe as su,HTe as sv,$Me as sw,xMe as sx,iue as sy,aue as sz,sve as t,DY as t$,a3e as t0,Kw as t1,ja as t2,Jre as t3,n3e as t4,Cm as t5,Am as t6,Ph as t7,qre as t8,sbe as t9,Jr as tA,cU as tB,wae as tC,Nwe as tD,b$e as tE,_$e as tF,JY as tG,uX as tH,lX as tI,RN as tJ,_V as tK,qte as tL,RQ as tM,PQ as tN,AQ as tO,JQ as tP,aX as tQ,yV as tR,ESe as tS,une as tT,VQ as tU,Ixe as tV,Txe as tW,F3e as tX,P3e as tY,E3e as tZ,PEe as t_,yfe as ta,rie as tb,iie as tc,FM as td,R8 as te,OA as tf,gwe as tg,PMe as th,AMe as ti,h_e as tj,CMe as tk,WMe as tl,GMe as tm,BMe as tn,qMe as to,UMe as tp,Eue as tq,q6 as tr,ZTe as ts,WTe as tt,Tue as tu,kTe as tv,oSe as tw,xo as tx,gS as ty,Y_e as tz,SEe as u,G_e as u$,Q_e as u0,tSe as u1,dSe as u2,X_e as u3,rSe as u4,hSe as u5,pK as u6,uv as u7,AEe as u8,LEe as u9,vbe as uA,wg as uB,cO as uC,H2e as uD,Us as uE,KIe as uF,dr as uG,Rx as uH,HOe as uI,wxe as uJ,y$e as uK,MQ as uL,GEe as uM,pd as uN,Tie as uO,u_e as uP,Y2e as uQ,h$e as uR,m_e as uS,wY as uT,xie as uU,aF as uV,cF as uW,CSe as uX,v$e as uY,kSe as uZ,OSe as u_,Xge as ua,pQ as ub,k_e as uc,py as ud,fy as ue,my as uf,IIe as ug,Yse as uh,vxe as ui,Ufe as uj,hc as uk,cme as ul,M$e as um,p$e as un,g$e as uo,m$e as up,nbe as uq,j$e as ur,D$e as us,qwe as ut,d$e as uu,V_e as uv,$$e as uw,kte as ux,voe as uy,u6 as uz,ee as v,bM as v0,_be as v1,w$e as v2,FQ as v3,_ie as v4,ZQ as v5,_Se as v6,$Se as v7,KMe as v8,BIe as v9,aEe as va,qOe as vb,i_e as w,Ae as x,We as y,eye as z};
