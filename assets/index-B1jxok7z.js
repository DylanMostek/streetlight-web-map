const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ElevationLayer-D_qCcAXd.js","assets/ArcGISCachedService-DDo0GuEP.js","assets/TileInfoTilemapCache-_ugJpbrD.js","assets/TilemapCache-BdMbVS_5.js","assets/WorkerHandle-BeszgkKS.js","assets/portalLayers-CD2sNtfV.js","assets/associatedFeatureServiceUtils-D9nV0Aun.js","assets/fetchService-D4VJQ5c9.js","assets/loadUtils-7Q2Q7qz0.js","assets/lazyLayerLoader-dDd4j-Tp.js","assets/arcgisLayers-BOgo3j1f.js","assets/layersCreator-4rKmFUn3.js","assets/ElevationQuery-Bol74dYN.js","assets/GeometryDescriptor-DQTgwPWp.js","assets/projectOperator-BuZcAX0A.js","assets/operatorProject-i8eOMppb.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/projectOperator-DdP0tmpb.js","assets/statsWorker-C_u2u7st.js","assets/utils-BFfyYzEp.js","assets/utils-CbRn1-mR.js","assets/ClassBreaksDefinition-BsL1vcA-.js","assets/geometryEngineWorker-BkMQzpX8.js","assets/geometryEngineJSON-B_JiqPb-.js","assets/geometryEngineBase-BQTefT4Y.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/CSVSourceWorker-BmMdzKN4.js","assets/date-DCujAECq.js","assets/OptimizedFeature-DbGXpSlG.js","assets/FeatureStore-ff93iUr2.js","assets/featureConversionUtils-Dkco9sJV.js","assets/OptimizedFeatureSet-BR8EEvDc.js","assets/BoundsStore-CUnvSjtf.js","assets/PooledRBush-CbKcy3Yr.js","assets/timeSupport-DsxGxC25.js","assets/queryUtils-DGsNy5N1.js","assets/optimizedFeatureQueryEngineAdapter-CdxzKP7Q.js","assets/QueryEngine-ANauUtrD.js","assets/WhereClauseCache-RYqzS1G-.js","assets/WhereClause-Csl7O9vI.js","assets/QueryEngineCapabilities-DJC_YILC.js","assets/SnappingCandidate-DGkpYqI6.js","assets/FixedIntervalBinParameters-BjW5S8EZ.js","assets/number-b-pRPz4C.js","assets/locationUtils-D-jN3SZh.js","assets/clientSideDefaults-Ba9UnMmF.js","assets/EdgeProcessingWorker-Df869KeA.js","assets/workerHelper-DUmQwBys.js","assets/InterleavedLayout-BTBK-mnj.js","assets/BufferView-DPUhhogC.js","assets/types-BKo2foNY.js","assets/VertexElementDescriptor-BLyltQyJ.js","assets/VertexAttributeLocations-BfZbt_DV.js","assets/edgeProcessing-YaThdqQ4.js","assets/deduplicate-DMQU0F3J.js","assets/Indices-CMO6JRmM.js","assets/Normals-D0PoZ4U_.js","assets/ElevationSamplerWorker-DKRmtnle.js","assets/MeshLocalVertexSpace-BFzLYULe.js","assets/vertexSpaceConversion-ioO0F3Mp.js","assets/spatialReferenceEllipsoidUtils-BP5SSv8y.js","assets/computeTranslationToOriginAndRotation-CGjRKrqs.js","assets/projectPointToVector-PEVlL9C1.js","assets/meshVertexSpaceUtils-Q4fQeduO.js","assets/vec3-CEi-e88i.js","assets/vec4-DEVlhv6b.js","assets/FeatureServiceSnappingSourceWorker-CV5XmX8A.js","assets/symbologySnappingCandidates-B7Y8AQ2E.js","assets/pbfQueryUtils-KFkMjlQm.js","assets/pbf-BkybbJBW.js","assets/query-Blp_Mz8x.js","assets/GeoJSONSourceWorker-D5tRcisS.js","assets/geojson-DgjmVZTi.js","assets/sourceUtils-C1_JGpK8.js","assets/MemorySourceWorker-CV6qsSZj.js","assets/objectIdUtils-BmFjqQA3.js","assets/PBFDecoderWorker-Cg2ohY7p.js","assets/dehydratedFeatures-CSol30N7.js","assets/FeaturePipelineWorker-hTo_Sqe7.js","assets/AttributeStore-BCpIuKsV.js","assets/Utils-CfbQXSWS.js","assets/UpdateTracking2D-CCI-i20V.js","assets/FeatureStoreQueryAdapter-Di4-_ZL1.js","assets/constants-BBnGEY1d.js","assets/streamLayerUtils-DFlbJ4P1.js","assets/MeshWriterRegistry-DM-gTCLn.js","assets/TexturedLineMeshWriter-C9-At9bQ.js","assets/TurboLine-D3EP57R5.js","assets/grouping-CIX5IWhI.js","assets/QueueProcessor-CfrQlkQB.js","assets/FeatureMetadata-Dknx8_lu.js","assets/SourceChunkStore-ClVq6Z4x.js","assets/parquet-D5P1Bdtf.js","assets/operatorGeodeticDensify-LAmZ5GYK.js","assets/geodeticCurveType-CirnHLSB.js","assets/normalizeUtilsSync-D3bxbYp9.js","assets/FeatureIdInfo-sWBWAQiA.js","assets/ogcFeatureUtils-gzTlkKaX.js","assets/CircularArray-CujHzHWW.js","assets/createConnection-D4p4XnCs.js","assets/PointCloudWorker-ly0aThLz.js","assets/quat-DVxZlAgk.js","assets/quatf64-aQ5IuZRd.js","assets/vec3f32-WCVSSNPR.js","assets/PointCloudUniqueValueRenderer-oS7g71ea.js","assets/I3SBinaryReader-DhhsXero.js","assets/orientedBoundingBox-IvDbUZpg.js","assets/plane-Bqnf8SVD.js","assets/vectorStacks-DgTU5mjR.js","assets/RasterWorker-BKVk1kB2.js","assets/PixelBlock-0NFJCBOu.js","assets/RasterSymbolizer-CPDIQrby.js","assets/vectorFieldUtils-CbjSTl93.js","assets/rasterFunctionHelper-tGX5FkVp.js","assets/clipUtils-g5rFyHan.js","assets/rasterProjectionHelper-CwixXMKf.js","assets/PolynomialTransform-XJm1XWDr.js","assets/dataUtils-nguZ1GxF.js","assets/SceneLayerSnappingSourceWorker-CVwbUjNt.js","assets/lineSegment-DsaCJx9t.js","assets/sphere-DHILQEAo.js","assets/Octree-BQqK1LxU.js","assets/frustum-D2iUPpln.js","assets/SceneLayerWorker-Co4xFbeU.js","assets/projectVectorToVector-DnMnTc03.js","assets/WFSSourceWorker-Bge17csS.js","assets/wfsUtils-Cu92nmm4.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-DsWE-dUk.js","assets/constants-BHYAGdRm.js","assets/config-BOD8--da.js","assets/SourceLayerData-CRyyjsfP.js","assets/StyleRepository-DI_qmsZ-.js","assets/earcut-D9gy186-.js","assets/Feature3DPipelineWorker-DObTngp0.js","assets/HUDMaterial.glsl-7gJC9BGu.js","assets/hydratedFeatures-ZpI93V02.js","assets/OutputColorHighlightOID.glsl-NI4I-Y2n.js","assets/triangle-Mxw2E1Tg.js","assets/renderState-CKc66y4x.js","assets/glsl-B5bJgrnA.js","assets/ShaderBuilder-NYZGbWXL.js","assets/placementUtils-Dn5j-Bgq.js","assets/sdfPrimitives-BlKXSSzN.js","assets/Texture-DK9amrHc.js","assets/videoUtils-CD5Dyu0w.js","assets/requestImageUtils-WXNX1cRa.js","assets/primitiveObjectSymbolUtils-DUQRVjLf.js","assets/RealisticTree.glsl-BUIUedEp.js","assets/VertexBuffer-D9bIwQYh.js","assets/BufferObject-TTKnHXtb.js","assets/boundedPlane-DJWyzvBw.js","assets/FlowWorker-B9jjt7xA.js","assets/ParquetSourceWorker-DGjIBGWG.js","assets/parquetUtils-9YHPhQ-U.js","assets/PanoramicMeshWorker-CewunH9C.js","assets/Popup-CPvhBigH.js","assets/throttle-loc2N167.js","assets/unitFormatUtils-BrxczuRc.js","assets/quantityUtils-VFsLc-Gi.js","assets/AttachmentInfo-BBHwYhlt.js","assets/featureUtils-C2ddgZGL.js","assets/executeQueryJSON-BswJrPVg.js","assets/shared-B3FE4O6B.js","assets/isImageryGraphicOrigin-Ccuhb4eK.js","assets/isImageryTileGraphicOrigin-ZR-gBf9D.js","assets/NetworkElement-BkvxRIyP.js","assets/ReactiveSet-vtUAzAXw.js","assets/arcadeUtils-CHK-5Ybm.js","assets/arcade-BQCc5Ntl.js","assets/arcadeEnvironment-DL7kHRZj.js","assets/Dictionary-D1onrrvj.js","assets/ImmutableArray-BPVd6ESQ.js","assets/Feature-B_KKLgSu.js","assets/aiServices-DtW0mbT4.js","assets/unitConversion-CmavgNYD.js","assets/rasterFieldUtils-CzNi4HTt.js","assets/batchExec-3EmCZjyR.js","assets/webglDeps-BP9SI3Fi.js","assets/FramebufferObject-CHnNnreL.js","assets/ProgramTemplate-B-fFSHht.js","assets/VertexArrayObject-nyk1EFP-.js","assets/mapViewDeps-ouTdldM0.js","assets/FeatureCommandQueue-C3e-wFZr.js","assets/GraphShaderModule-DTFIRBSV.js","assets/utils-DX7I_RZS.js","assets/WGLContainer-Coa3QmRb.js","assets/Container-tuwfMwZn.js","assets/SDFHelper-DF0I0htl.js","assets/GridShader-Biz8kw0T.js","assets/testSVGPremultipliedAlpha-DHFsZrwW.js","assets/SymbolFader-C0LuKUly.js","assets/RenderingContext-CelOI5Ix.js","assets/utils-rZHHreKL.js","assets/utils-DDjZAYSk.js","assets/GraphicsView2D-DQieqQFP.js","assets/densifyCurvedGeometry-BFZz5kAA.js","assets/GraphicContainer-BXd6VnT3.js","assets/AGraphicContainer-B3wr7vYo.js","assets/TechniqueInstance-BP47_Rkz.js","assets/TileContainer-BMCNP5FG.js","assets/gridUtils-BnzYfai_.js","assets/geodesicUtils-DGTGtRoa.js","assets/TileLayerView2D-Cv8iARrd.js","assets/imageUtils-t4W8UNFy.js","assets/BitmapTechnique-C_u59Alj.js","assets/bitmapUtils-BMlgC2JU.js","assets/LayerView2D-D0xWnkZe.js","assets/HighlightGraphicContainer-BhARZ1uq.js","assets/LayerView-CxlA7J_C.js","assets/RefreshableLayerView-BKnkXBla.js","assets/MapServiceLayerViewHelper-B0ZZ5I1y.js","assets/drapedUtils-DsAXNmz7.js","assets/popupUtils-CqwdQPXZ.js","assets/highlightOptionsUtils-CM0gyxzj.js","assets/FeatureLayerView2D-3pACPP-4.js","assets/timeSupport-DHUaS2CH.js","assets/AttributeBinsFeatureSet-CuHXKJAu.js","assets/AttributeBinsQuery-BlTyGnZi.js","assets/constants-SxxbBSOD.js","assets/BaseDynamicLayerView2D-B-95tiVD.js","assets/BitmapContainer-CoXG4Zcq.js","assets/ExportStrategy-CSFFKP4q.js","assets/CatalogLayerView2D-DGu17JIV.js","assets/CatalogDynamicGroupLayerView2D-DCBJRR7w.js","assets/CatalogFootprintLayerView2D-CgQga-e1.js","assets/GeoRSSLayerView2D-C84MJVX1.js","assets/GraphicsLayerView2D-DQGUMMwg.js","assets/GroupLayerView2D-BFHJD3om.js","assets/ImageryLayerView2D-CT6ryj12.js","assets/RasterVFDisplayObject-FUZ5jutn.js","assets/ImageryTileLayerView2D-BjiCjcHQ.js","assets/datasetUtils-9a2-M5a1.js","assets/rasterUtils-BkGPHwzm.js","assets/RawBlockCache-ConBeKa9.js","assets/KMLLayerView2D-Do7tqv6D.js","assets/kmlUtils-RSUGyGS1.js","assets/KnowledgeGraphLayerView2D-21wdpQKB.js","assets/MapImageLayerView2D-tuTj_5mm.js","assets/MapNotesLayerView2D-Ch51MwoO.js","assets/MediaLayerView2D-BiWcTZOG.js","assets/mediaLayerUtils-Cqc1LLJa.js","assets/OverlayContainer-nMP3VMWP.js","assets/OGCFeatureLayerView2D-O86hKs-6.js","assets/RouteLayerView2D-CgV-i12m.js","assets/Stop-yuBClei3.js","assets/networkEnums-iKpHR2gX.js","assets/StreamLayerView2D-DcK9bPHY.js","assets/SubtypeGroupLayerView2D-D7AaXhvK.js","assets/VectorTileLayerView2D-Ch1i0Zg1.js","assets/VideoLayerView2D-D0iEnDmt.js","assets/GraphicsLayer-B-bzT4pJ.js","assets/videoUtils-CupOdc75.js","assets/ControlPoint-CgNPKGYf.js","assets/WMSLayerView2D-DhZ4o2ED.js","assets/ExportWMSImageParameters-q8XDC94G.js","assets/WMTSLayerView2D-Dd1v2KLg.js","assets/ElevationProfileAnalysisView2D-DVFoeTHi.js","assets/createUtils-DaOh98B4.js","assets/distanceOperator-D4brJT0N.js","assets/Point2D-CE_8fSwp.js","assets/Distance2DCalculator-CXhBP-8I-BBog0v29.js","assets/ProjectionTransformation-yNEZb9UF.js","assets/Envelope2D-B-iKXdqf.js","assets/Transformation2D-DQXtCBWc.js","assets/OperatorDefinitions-DP7_WWTp.js","assets/apiConverter-7c5s36vn.js","assets/jsonConverter-BSCiJKcO.js","assets/simplifyOperator-DNMpvOtP.js","assets/operatorSimplify-Ds7knktB.js","assets/mapCollectionUtils-D13toteg.js","assets/elevationInfoUtils-PQ0WhQlf.js","assets/getDefaultUnitForView-DsOFdPLN.js","assets/SketchViewModel-D8BMCV7q.js","assets/hitTestSelectUtils-D9T2YoxA.js","assets/geodeticLengthOperator-CwDdVv1S.js","assets/apng-dOeebzRc.js","assets/index-QMIhu610.js","assets/index-DbXHfktg.js","assets/guid-LcV_DAvu.js","assets/useT9n-CSj0CLbN.js","assets/index-Cmp1vh1M.js","assets/index-CROBEgSo.js","assets/dom-yxfQT3DA.js","assets/observers-BD1ILDqE.js","assets/ref-kimQXf4a.js","assets/static-DK7trYiG.js","assets/form-TxEp8wNQ.js","assets/interactive-C3Hjg-Fl.js","assets/label-CL22-fae.js","assets/component-DXdqgJWg.js","assets/useSetFocus-D-LSGIXj.js","assets/layersLoader-CNXVnAMW.js","assets/jsonContext-BnsIPdZM.js","assets/featureLayerUtils-D0nCDIZI.js","assets/originUtils-C6hvo_uy.js","assets/utils-NncM6p7U.js","assets/saveUtils-CzVhGhly.js","assets/FeatureLayerSource-CG5Fldy_.js","assets/External-CYDeoPAs.js","assets/MeshTransform-DtbVhp3n.js","assets/axisAngleDegrees-DXWlBBZf.js","assets/editingSupport-BH_vRt3P.js","assets/QueryTask-BLmoADhG.js","assets/executeForIds-B0Nm-2Oy.js","assets/previewSymbol2D-zgbYXEFa.js","assets/bufferOperator-n-Wjtv1g.js","assets/operatorBuffer-BQGQoLD-.js","assets/Bufferer-Dw9Qi4T1-C0uKu6ha.js","assets/GeometryCleaner-BEJM7I4l-IBn3R6b8.js","assets/OperatorSimplifyOGC-CCZ4Pu-T.js","assets/OperatorGeneralize-DcNGx1ga.js","assets/convexHullOperator-BY0hFZn-.js","assets/operatorConvexHull-C_9SOHBd.js","assets/lengthOperator-DSCZAWEp.js","assets/generalizeOperator-DJ-GPQra.js","assets/operatorGeneralize-Bu2r_C6l.js","assets/graphicBufferOperator-VOZ-nDCF.js","assets/offsetOperator-CGjLy633.js","assets/operatorOffset-N-pm2t4M.js","assets/simplifyOperator-DXSlJQjq.js","assets/index-BnoFR9kl.js","assets/customElement-KhuSelW3.js","assets/repeat-cLQ1XYUJ.js","assets/array-bGYQmELK.js","assets/index-CT2beQaK.js","assets/index-BdQQ8ic0.js","assets/keyed-Cy_9eBd3.js","assets/index-CIC5MAaM.js","assets/index-BcXLn2Hw.js","assets/floating-ui-CGYpYwOL.js","assets/debounce-D0Dr7phT.js","assets/openCloseComponent-Db7ne4Zn.js","assets/FloatingArrow-CpBSMHDz.js","assets/useFocusTrap-hLOgymnZ.js","assets/key-Cyh_1epf.js","assets/customElement-Dij0kEMK.js","assets/customElement-BgED0rOD.js","assets/index-CL2ntcgm.js","assets/usePreventDocumentScroll-ah3C48vL.js","assets/dynamicClasses-6uzzLOUQ.js","assets/index-6NnuGRWV.js","assets/index-CEFSOEwK.js","assets/index-iSFRQJ-i.js","assets/resources7-v6zOX8CA.js","assets/index-xL-40f0N.js","assets/_sortable-CiaCJf7j.js","assets/index-DXIv5ycB.js","assets/index-BitsRHnv.js","assets/index-Bk7IrJhI.js","assets/escapeRegExp-CkRNPaSc.js","assets/useCancelable-D6Qq1xab.js","assets/utils2-D0x6gqlp.js","assets/index-C0x0PH20.js","assets/resources5-DhgIM17F.js","assets/index-q34aSAzT.js","assets/index-k9jXQ34J.js","assets/index-CejbJuga.js","assets/index-K1ZD-NXY.js"])))=>i.map(i=>d[i]);
var LY=Object.getPrototypeOf;var AY=Reflect.get;var uA=t=>{throw TypeError(t)};var wx=(t,e,r)=>e.has(t)||uA("Cannot "+r);var nt=(t,e,r)=>(wx(t,e,"read from private field"),r?r.call(t):e.get(t)),wn=(t,e,r)=>e.has(t)?uA("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),_n=(t,e,r,i)=>(wx(t,e,"write to private field"),i?i.call(t,r):e.set(t,r),r),fy=(t,e,r)=>(wx(t,e,"access private method"),r);var cA=(t,e,r)=>AY(LY(t),r,e);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();function u(t,e,r,i){var s=arguments.length,n=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(n=(s<3?o(n):s>3?o(e,r,n):o(e,r))||n);return s>3&&n&&Object.defineProperty(e,r,n),n}function tRe(t,e){return function(r,i){e(r,i,t)}}function rRe(t,e,r,i){function s(n){return n instanceof r?n:new r(function(o){o(n)})}return new(r||(r=Promise))(function(n,o){function a(d){try{c(i.next(d))}catch(p){o(p)}}function l(d){try{c(i.throw(d))}catch(p){o(p)}}function c(d){d.done?n(d.value):s(d.value).then(a,l)}c((i=i.apply(t,e||[])).next())})}function iRe(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var i,s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=e[Symbol.asyncDispose]}if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=e[Symbol.dispose],r&&(s=i)}if(typeof i!="function")throw new TypeError("Object not disposable.");s&&(i=function(){try{s.call(this)}catch(n){return Promise.reject(n)}}),t.stack.push({value:e,dispose:i,async:r})}else r&&t.stack.push({async:!0});return e}var RY=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var i=new Error(r);return i.name="SuppressedError",i.error=t,i.suppressed=e,i};function sRe(t){function e(n){t.error=t.hasError?new RY(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}var r,i=0;function s(){for(;r=t.stack.pop();)try{if(!r.async&&i===1)return i=0,t.stack.push(r),Promise.resolve().then(s);if(r.dispose){var n=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(n).then(s,function(o){return e(o),s()})}else i|=1}catch(o){e(o)}if(i===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return s()}const OY="modulepreload",FY=function(t){return"/streetlight-web-map/"+t},hA={},q=function(e,r,i){let s=Promise.resolve();if(r&&r.length>0){let l=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");s=l(r.map(c=>{if(c=FY(c),c in hA)return;hA[c]=!0;const d=c.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${p}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":OY,d||(m.as="script"),m.crossOrigin="",m.href=c,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((y,g)=>{m.addEventListener("load",y),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&n(a.reason);return e().catch(n)})};let Ou;const qr=globalThis;function z(t){return typeof Ou[t]=="function"?Ou[t]=Ou[t](qr):Ou[t]}Ou=qr.dojoConfig?.has||qr.esriConfig?.has?{...qr.dojoConfig?.has,...qr.esriConfig?.has}:{},z.add=(t,e,r,i)=>{(i||Ou[t]===void 0)&&(Ou[t]=e),r&&z(t)},z.cache=Ou,z.add("big-integer-warning-enabled",!0),z.add("esri-deprecation-warnings",!0),z.add("esri-tests-disable-screenshots",!1),z.add("esri-tests-use-full-window",!1),z.add("esri-tests-post-to-influx",!0),z.add("esri-cim-animations-enable-status","enabled"),z.add("esri-cim-animations-spotlight",!1),z.add("esri-cim-animations-freeze-time",!1),(()=>{z.add("host-webworker",qr.WorkerGlobalScope!==void 0&&self instanceof qr.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(z.add("host-browser",t),z.add("host-node",!(typeof qr.process!="object"||!qr.process.versions?.node||!qr.process.versions.v8)),z.add("dom",t),z("host-browser")){const e=navigator,r=e.userAgent,i=e.appVersion,s=parseFloat(i);if(z.add("wp",parseFloat(r.split("Windows Phone")[1])||void 0),z.add("msapp",parseFloat(r.split("MSAppHost/")[1])||void 0),z.add("khtml",i.includes("Konqueror")?s:void 0),z.add("edge",parseFloat(r.split("Edge/")[1])||void 0),z.add("opr",parseFloat(r.split("OPR/")[1])||void 0),z.add("webkit",!z("wp")&&!z("edge")&&parseFloat(r.split("WebKit/")[1])||void 0),z.add("chrome",!z("edge")&&!z("opr")&&parseFloat(r.split("Chrome/")[1])||void 0),z.add("android",!z("wp")&&parseFloat(r.split("Android ")[1])||void 0),z.add("safari",!i.includes("Safari")||z("wp")||z("chrome")||z("android")||z("edge")||z("opr")?void 0:parseFloat(i.split("Version/")[1])),z.add("mac",i.includes("Macintosh")),!z("wp")&&/(iPhone|iPod|iPad)/.test(r)){const n=RegExp.$1.replace(/P/,"p"),o=/OS ([\d_]+)/.test(r)?RegExp.$1:"1",a=parseFloat(o.replace(/_/,".").replaceAll("_",""));z.add(n,a),z.add("ios",a)}z("webkit")||(!r.includes("Gecko")||z("wp")||z("khtml")||z("edge")||z.add("mozilla",s),z("mozilla")&&z.add("ff",parseFloat(r.split("Firefox/")[1]||r.split("Minefield/")[1])||void 0))}})(),(()=>{if(qr.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),r=/iPhone/i.test(t);e&&z.add("esri-mobile",e),r&&z.add("esri-iPhone",r),z.add("esri-geolocation",!!navigator.geolocation)}z.add("esri-wasm","WebAssembly"in qr),z.add("esri-performance-mode-frames-between-render",20),z.add("esri-force-performance-mode",!1),z.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in qr,e=qr.crossOriginIsolated===!1;return t&&!e}),z.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),z.add("esri-atomics","Atomics"in qr),z.add("esri-workers","Worker"in qr),z.add("web-feat:cache","caches"in qr),z.add("esri-workers-arraybuffer-transfer",!z("safari")||Number(z("safari"))>=12),z.add("workers-pool-size",8),z.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),z.add("featurelayer-simplify-payload-size-factors",[1,1,4]),z.add("featurelayer-fast-triangulation-enabled",!0),z.add("featurelayer-animation-enabled",!0),z.add("featurelayer-snapshot-enabled",!0),z.add("featurelayer-snapshot-initial-tolerance",0),z.add("featurelayer-snapshot-point-min-threshold",8e4),z.add("featurelayer-snapshot-point-max-threshold",4e5),z.add("featurelayer-snapshot-multipoint-min-threshold",2e4),z.add("featurelayer-snapshot-multipoint-max-threshold",1e5),z.add("featurelayer-snapshot-polygon-min-threshold",2e3),z.add("featurelayer-snapshot-polygon-max-threshold",2e3),z.add("featurelayer-snapshot-polyline-min-threshold",2e3),z.add("featurelayer-snapshot-polyline-max-threshold",2e3),z.add("featurelayer-snapshot-max-vertex-count",25e4),z.add("featurelayer-snapshot-non-hosted-exceedslimit-enabled",!0),z.add("featurelayer-snapshot-concurrency",4),z.add("featurelayer-snapshot-coverage",.1),z.add("featurelayer-query-max-depth",4),z.add("featurelayer-query-pausing-enabled",!1),z.add("featurelayer-query-tile-concurrency",4),z.add("featurelayer-query-tile-max-features",6e5),z.add("featurelayer-advanced-symbols",!1),z.add("featurelayer-pbf",!0),z.add("featurelayer-pbf-statistics",!1),z.add("feature-layers-workers",!0),z.add("feature-polyline-generalization-factor",1),z.add("parquetlayer-full-query-feature-count",2e4),z.add("parquetlayer-hittest-max-feature-count",1),z.add("parquetlayer-persistence-enabled",!1),z.add("mapview-transitions-duration",200),z.add("mapview-essential-goto-duration",200),z.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),z.add("mapserver-pbf-version-support",10.81),z.add("mapservice-popup-identify-max-tolerance",20),z.add("request-queue-concurrency-hosted",16),z.add("request-queue-concurrency-non-hosted",4),z.add("curve-densification-coarse-segments",128),z.add("curve-densification-max-segments",2e3),z.add("curve-densification-min-segments",3),z.add("curve-densification-pixel-deviation",.5),z.add("view-readyState-waiting-delay",1e3),z.add("gradient-depth-bias",.01),z.add("gradient-depth-epsilon",1e-8),z.add("enable-feature:esri-compress-textures",!0),z("host-webworker")||z("host-browser")&&(z.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),z.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();function nRe(t){}function NY(t){return()=>t}function oRe(t){return t}var ns;let kC=(ns=class{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*ns._m}getInt(){return this._seed=(ns._a*this._seed+ns._c)%ns._m,this._seed}getFloat(){return this.getInt()/(ns._m-1)}getIntRange(e,r){return Math.round(this.getFloatRange(e,r))}getFloatRange(e,r){const i=r-e;return e+this.getInt()/ns._m*i}},ns._m=2147483647,ns._a=48271,ns._c=0,ns);const DY=1.5,aRe=1/DY,lRe=.5;function ez(t){return t}function zY(t,e=ez){if(!t||t.length===0)return;let r=t[0],i=e(r);for(let s=1;s<t.length;++s){const n=t[s],o=Number(e(n));o>i&&(i=o,r=n)}return r}function uRe(t,e=ez){return zY(t,r=>-e(r))}function cRe(t,e){return e?t.filter((r,i,s)=>s.findIndex(e.bind(null,r))===i):Array.from(new Set(t))}function jY(t,e,r,i,s,n,o){if(t==null&&i==null)return!0;e=Math.max(0,e),s=Math.max(0,s),r=Math.max(0,r<0?(t?.length??0)+r:r),n=Math.max(0,n<0?(i?.length??0)+n:n);const a=r-e;if(t==null||i==null||a!==n-s)return!1;if(o){for(let l=0;l<a;l++)if(!o(t[e+l],i[s+l]))return!1}else for(let l=0;l<a;l++)if(t[e+l]!==i[s+l])return!1;return!0}function DS(t,e,r){return jY(t,0,t?.length??0,e,0,e?.length??0,r)}function hRe(){return(t,e)=>{if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}}function dA(t,e,r){let i,s;return r?(i=e.filter(n=>!t.some(o=>r(o,n))),s=t.filter(n=>!e.some(o=>r(o,n)))):(i=e.filter(n=>!t.includes(n)),s=t.filter(n=>!e.includes(n))),{added:i,removed:s}}function dRe(t){return t&&typeof t.length=="number"}function pRe(t,e){const r=t.length;if(r===0)return[];const i=[];for(let s=0;s<r;s+=e)i.push(t.slice(s,s+e));return i}let tz=class{constructor(){this.last=0}};const rz=new tz;function xM(t,e,r,i){i=i||rz;const s=Math.max(0,i.last-10);for(let o=s;o<r;++o)if(t[o]===e)return i.last=o,o;const n=Math.min(s,r);for(let o=0;o<n;++o)if(t[o]===e)return i.last=o,o;return-1}function $M(t,e,r,i){const s=t.length,n=xM(t,e,s,i);if(n!==-1)return t[n]=t[s-1],t.pop(),e}const bn=new Set;function VY(t,e,r=t.length,i=e.length,s,n){if(i===0||r===0)return r;bn.clear();for(let a=0;a<i;++a)bn.add(e[a]);s=s||rz;const o=Math.max(0,s.last-10);for(let a=o;a<r;++a)if(bn.has(t[a])&&(n?.push(t[a]),bn.delete(t[a]),t[a]=t[r-1],--r,--a,bn.size===0||r===0))return bn.clear(),r;for(let a=0;a<o;++a)if(bn.has(t[a])&&(n?.push(t[a]),bn.delete(t[a]),t[a]=t[r-1],--r,--a,bn.size===0||r===0))return bn.clear(),r;return bn.clear(),r}function UY(t,e){let r=0;for(let i=0;i<t.length;++i){const s=t[i];e(s,i)&&(t[r]=s,r++)}return t.length=r,t}function mRe(t,e,r){const i=t.length;if(e>=i)return t.slice();const s=LC(r),n=new Set,o=[];for(;o.length<e;){const a=Math.floor(s()*i);n.has(a)||(n.add(a),o.push(t[a]))}return o}function LC(t){return t?(pA.seed=t,()=>pA.getFloat()):Math.random}const pA=new kC;function iz(t,e){if(!t)return t;const r=LC(e);for(let i=t.length-1;i>0;i--){const s=Math.floor(r()*(i+1)),n=t[i];t[i]=t[s],t[s]=n}return t}function AC(t,e){const r=t.indexOf(e);return r!==-1?(t.splice(r,1),e):null}function fr(t,e){return t!=null}const yRe=[];function gRe(t){return t instanceof ArrayBuffer}function RC(t){return t?.constructor?.name==="Int8Array"}function sz(t){return t?.constructor?.name==="Uint8Array"}function nz(t){return t?.constructor?.name==="Uint8ClampedArray"}function OC(t){return t?.constructor?.name==="Int16Array"}function oz(t){return t?.constructor?.name==="Uint16Array"}function FC(t){return t?.constructor?.name==="Int32Array"}function az(t){return t?.constructor?.name==="Uint32Array"}function GY(t){return t?.constructor?.name==="Float16Array"}function zS(t){return t?.constructor?.name==="Float32Array"}function jS(t){return t?.constructor?.name==="Float64Array"}function lz(t){return"buffer"in t}const uz=1024;function vRe(t){return jS(t)||zS(t)||FC(t)||OC(t)||RC(t)}function wRe(t){return jS(t)||zS(t)}function _Re(t){return jS(t)?179769e303:GY(t)?65504:zS(t)?3402823e32:az(t)?4294967295:oz(t)?65535:sz(t)||nz(t)?255:FC(t)?2147483647:OC(t)?32767:RC(t)?127:256}const bRe=-32768,SRe=-2147483648;function xRe(t){return t}function qY(t,e){let r;for(r in t)t.hasOwnProperty(r)&&t[r]===void 0&&delete t[r];return t}function O(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=dz(t);if(e!=null)return e;if(Yg(t))return t.clone();if(cz(t))return t.map(O);if(hz(t))throw new Error("Trying to clone an unclonable Accessor instance");const r={};for(const i of Object.getOwnPropertyNames(t))r[i]=O(t[i]);return r}function MM(t,e){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const r=dz(t);if(r!=null)return r;if(cz(t)){let s=!0;const n=t.map(o=>{const a=MM(o,e);return o!=null&&a==null&&(s=!1),a});return s?n:null}if(Yg(t))return t.clone(e);if(t instanceof File||t instanceof Blob)return t;if(hz(t))return null;const i=new(Object.getPrototypeOf(t)).constructor;for(const s of Object.getOwnPropertyNames(t)){const n=t[s],o=MM(n);if(n!=null&&o==null)return null;i[s]=o}return i}function Yg(t){return typeof t.clone=="function"}function cz(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function hz(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function fA(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function dz(t){if(RC(t)||sz(t)||nz(t)||OC(t)||oz(t)||FC(t)||az(t)||zS(t)||jS(t))return t.slice();if(t instanceof Date)return new Date(t);if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[r,i]of t)e.set(r,O(i));return e}if(t instanceof Set){const e=new Set;for(const r of t)e.add(O(r));return e}return null}function NC(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof t?.getTime=="function"&&typeof e?.getTime=="function"&&t.getTime()===e.getTime()||!1}function pz(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&DS(t,e):t instanceof Set?e instanceof Set&&HY(t,e):t instanceof Map?e instanceof Map&&WY(t,e):!!fA(t)&&fA(e)&&BY(t,e))}function BY(t,e){if(t===null||e===null)return!1;const r=Object.keys(t);if(e===null||Object.keys(e).length!==r.length)return!1;for(const i of r)if(t[i]!==e[i]||!Object.prototype.hasOwnProperty.call(e,i))return!1;return!0}function HY(t,e){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}function WY(t,e){if(t.size!==e.size)return!1;for(const[r,i]of t){const s=e.get(r);if(s!==i||s===void 0&&!e.has(r))return!1}return!0}function DC(t,e,r=!1){return mz(t,e,r)}function Sv(t,e){if(e!=null)return e[t]||fz(t.split("."),!1,e)}function Ir(t,e,r){const i=t.split("."),s=i.pop(),n=fz(i,!0,r);n&&s&&(n[s]=e)}function mA(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const r=e;if(t.length!==r.length)return!0;for(let i=0;i<t.length;i++)if(mA(t[i],r[i]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const r in t)if(mA(t[r],e[r]))return!0;return!1}return t!==e}function fz(t,e,r){let i=r;for(const s of t){if(i==null)return;if(!(s in i)){if(!e)return;i[s]={}}i=i[s]}return i}function mz(t,e,r){return e?Object.keys(e).reduce((i,s)=>{if(s==="__proto__")return i;let n=i[s],o=e[s];return n===o?i:n===void 0?(i[s]=O(o),i):(Array.isArray(o)||Array.isArray(i)?(n=n?Array.isArray(n)?i[s]=n.slice():i[s]=[n]:i[s]=[],o&&(Array.isArray(o)||(o=[o]),r?o.forEach(a=>{n.includes(a)||n.push(a)}):i[s]=o.slice())):o&&typeof o=="object"?i[s]=mz(n,o,r):i.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(i[s]=o),i)},t||{}):t}function $Re(t,e){for(const r of Object.entries(t))if(e===r[1])return r[0]}function VS(t,e){return Object.values(t).includes(e)}const De={apiKey:void 0,apiKeys:{scopes:[]},applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(DC(De,globalThis.esriConfig,!0),delete De.has),!De.assetsPath){{const t="4.34";De.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}De.defaultAssetsPath=De.assetsPath}const ZY=/\{([^}]+)\}/g;function yA(t){return t??""}function dc(t,e){return e?t.replaceAll(ZY,typeof e=="object"?(r,i)=>yA(Sv(i,e)):(r,i)=>yA(e(i))):t}function MRe(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,r=>e?.includes(r)?r:`\\${r}`)}function yz(t){let e=0;for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return e}let gA;function JY(t){return gA??=new DOMParser,gA.parseFromString(t||"","text/html").body.innerText||""}function TRe(t,e){return new RegExp(`{${e}}`,"ig").test(t)}function IRe(t,...e){let r=t[0];for(let i=0;i<e.length;++i)r+=e[i]+t[i+1];return r}const vA={info:0,warn:1,error:2,none:3};var or;let U=(or=class{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,or._loggers.set(this.module,this);const r=this.module.lastIndexOf(".");r!==-1&&(this._parent=or.getLogger(this.module.slice(0,r)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,or._loggers.get(e)||new or({module:e})}_log(e,r,...i){if(this._matchLevel(e)){if(r!=="always"&&!or._throttlingDisabled){const s=XY(i),n=this._loggedMessages[e].get(s);if(r==="once"&&n!=null||r==="oncePerTick"&&n&&n>=or._tickCounter)return;this._loggedMessages[e].set(s,or._tickCounter),or._scheduleTickCounterIncrement()}for(const s of De.log.interceptors)if(s(e,this.module,...i))return;this._inheritedWriter()(e,this.module,...i)}}_parentWithMember(e,r){let i=this;for(;i!=null;){const s=i[e];if(s!=null)return s;i=i.parent}return r}_inheritedWriter(){return this._parentWithMember("writer",YY)}_matchLevel(e){const r=De.log.level||"warn";return vA[this._parentWithMember("level",r)]<=vA[e]}static _scheduleTickCounterIncrement(){or._tickCounterScheduled||(or._tickCounterScheduled=!0,Promise.resolve().then(()=>{or._tickCounter++,or._tickCounterScheduled=!1}))}},or._loggers=new Map,or._tickCounter=0,or._tickCounterScheduled=!1,or._throttlingDisabled=!1,or);function YY(t,e,...r){console[t](`[${e}]`,...r)}function XY(...t){return yz(JSON.stringify(t,(r,i)=>typeof i!="object"||Array.isArray(i)?i:"[Object]"))}function KY(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,(r,i)=>i===""?"$":(Sv(i,e)??"").toString())}let gz=class{constructor(e,r,i=void 0){this.name=e,this.details=i,this.message=(r&&KY(r,i))??""}toString(){return"["+this.name+"]: "+this.message}},R=class vz extends gz{constructor(e,r,i){super(e,r,i)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,r)=>{if(r&&typeof r=="object"&&typeof r.toJSON=="function")return r;try{return O(r)}catch{return"[object]"}}))}}catch(e){throw U.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new vz(e.name,e.message,e.details)}};R.prototype.type="error";function L0(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}const QY=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,eX={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function wA(t){const e=t?.match(QY);if(!e)return null;const[,r,i,s]=e;if(!r)return null;let n=null,o=null,a=null;const{devext:l,qaext:c,www:d}=eX;if(i)if(n=r,s)switch(s.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qa":({customBaseUrl:o,portalHostname:a}=c);break;default:return null}else({customBaseUrl:o,portalHostname:a}=d);else switch(r.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qaext":({customBaseUrl:o,portalHostname:a}=c);break;case"www":({customBaseUrl:o,portalHostname:a}=d);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:n}}function wz(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function _z(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,r=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,i=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):r.test(t)?t=t.replace(r,"https://devext.arcgis.com"):i.test(t)&&(t=t.replace(i,"https://qaext.arcgis.com")),t}function bz(t){const e=atob(t),r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r.buffer}function tX(t){const e=new Uint8Array(t);let r="";for(let i=0;i<e.length;i++)r+=String.fromCharCode(e[i]);return btoa(r)}const rX=()=>U.getLogger("esri.core.urlUtils"),Rm=De.request,_A="esri/config: esriConfig.request.proxyUrl is not set.",Sz=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,xz=/^\s*http:/i,iX=/^\s*https:/i,sX=/^\s*file:/i,$z=/:\d+$/,nX=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,oX=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),aX=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let mf=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let r=this.uri.match(oX);this.scheme=r[2]||(r[1]?"":null),this.authority=r[4]||(r[3]?"":null),this.path=r[5],this.query=r[7]||(r[6]?"":null),this.fragment=r[9]||(r[8]?"":null),this.authority!=null&&(r=this.authority.match(aX),this.user=r[3]||null,this.password=r[4]||null,this.host=r[6]||r[7],this.port=r[9]||null)}toString(){return this.uri}};const aw={},lX=new mf(De.applicationUrl);let _i=lX;const uX=cX();let zC=uX;const jC=()=>_i,PRe=()=>zC;function cX(){const t=_i.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${_i.scheme}://${_i.host}${_i.port!=null?`:${_i.port}`:""}`}${e}`}function Er(t){if(!t)return null;const e={path:null,query:null},r=new mf(t),i=t.indexOf("?");return r.query===null?e.path=t:(e.path=t.slice(0,i),e.query=VC(r.query)),r.fragment&&(e.hash=r.fragment,r.query===null&&(e.path=e.path.slice(0,e.path.length-(r.fragment.length+1)))),e}function VC(t){const e=t.split("&"),r={};for(const i of e){if(!i)continue;const s=i.indexOf("=");let n,o;s<0?(n=decodeURIComponent(i),o=""):(n=decodeURIComponent(i.slice(0,s)),o=decodeURIComponent(i.slice(s+1)));let a=r[n];typeof a=="string"&&(a=r[n]=[a]),Array.isArray(a)?a.push(o):r[n]=o}return r}function A0(t,e){return t?Object.keys(t).map(r=>{const i=t[r];if(i==null)return"";const s=encodeURIComponent(r)+"=",n=e?.[r];return n?s+encodeURIComponent(n(i)):Array.isArray(i)?i.map(o=>L0(o)?s+encodeURIComponent(JSON.stringify(o)):s+encodeURIComponent(o)).join("&"):L0(i)?s+encodeURIComponent(JSON.stringify(i)):s+encodeURIComponent(i)}).filter(r=>r).join("&"):""}function Mz(t=!1){let e,r=Rm.proxyUrl;if(typeof t=="string"){e=gX(t);const i=US(t);i&&(r=i.proxyUrl)}else e=!!t;if(!r)throw rX().warn(_A),new R("urlUtils:proxy-not-set",_A);return e&&IM()&&(r=HC(r)),Er(r)}function kRe(t,e=!1){const r=US(t);let i,s;if(r){const n=UC(r.proxyUrl);i=n.path,s=n.query?VC(n.query):null}else if(e){const n=Mz(t);i=n.path,s=n.query}if(i){const n=Er(t);t=i+"?"+n.path;const o=A0({...s,...n.query});o&&(t=`${t}?${o}`)}return t}const my={path:"",query:""};function UC(t){const e=t.indexOf("?");return e!==-1?(my.path=t.slice(0,e),my.query=t.slice(e+1)):(my.path=t,my.query=null),my}function Tz(t){return t=(t=l1(t=SX(t=UC(t).path),!0)).toLowerCase()}function hX(t){const e={proxyUrl:t.proxyUrl,urlPrefix:Tz(t.urlPrefix)},r=Rm.proxyRules,i=e.urlPrefix;let s=r.length;for(let n=0;n<r.length;n++){const o=r[n].urlPrefix;if(i.startsWith(o)){if(i.length===o.length)return-1;s=n;break}o.startsWith(i)&&(s=n+1)}return r.splice(s,0,e),s}function US(t){const e=Rm.proxyRules,r=Tz(t);for(let i=0;i<e.length;i++)if(r.startsWith(e[i].urlPrefix))return e[i]}function dX(t,e){if(!t||!e)return!1;t=a1(t),e=a1(e);const r=wA(t),i=wA(e);return r!=null&&i!=null?r.portalHostname===i.portalHostname:r==null&&i==null&&aa(t,e,!0)}function Iz(t,e){return t=a1(t),e=a1(e),l1(t)===l1(e)}function a1(t){const e=(t=Qn(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function TM(t,e=Rm.interceptors){const r=i=>i instanceof RegExp?i.test(t):typeof i=="string"?t.startsWith(i):i==null;if(e){for(const i of e)if(Array.isArray(i.urls)){if(i.urls.some(r))return i}else if(r(i.urls))return i}return null}function aa(t,e,r=!1){if(!t||!e)return!1;const i=CM(t),s=CM(e);return!(!r&&i.scheme!==s.scheme)&&i.host!=null&&s.host!=null&&i.host.toLowerCase()===s.host.toLowerCase()&&i.port===s.port}function GC(t){if(typeof t=="string"){if(!cs(t))return!0;t=CM(t)}if(aa(t,_i))return!0;const e=Rm.trustedServers||[];for(let r=0;r<e.length;r++){const i=pX(e[r]);for(let s=0;s<i.length;s++)if(aa(t,i[s]))return!0}return!1}function pX(t){return aw[t]||(BC(t)||fa(t)?aw[t]=[new mf(an(t))]:aw[t]=[new mf(`http://${t}`),new mf(`https://${t}`)]),aw[t]}function an(t,e=zC,r){return fa(t)?r?.preserveProtocolRelative?t:_i.scheme==="http"&&_i.authority===Fs(t).slice(2)?`http:${t}`:`https:${t}`:BC(t)?t:ed(t.startsWith("/")?bX(e):e,t)}function qC(t,e=zC,r){if(t==null||!cs(t))return t;const i=Qn(t),s=i.toLowerCase(),n=Qn(e).toLowerCase().replace(/\/+$/,""),o=r?Qn(r).toLowerCase().replace(/\/+$/,""):null;if(o&&!n.startsWith(o))return t;const a=(p,m,y)=>(y=p.indexOf(m,y))===-1?p.length:y;let l=a(s,"/",s.indexOf("//")+2),c=-1;for(;s.slice(0,l+1)===n.slice(0,l)+"/"&&(c=l+1,l!==s.length);)l=a(s,"/",l+1);if(c===-1||o&&c<o.length)return t;t=i.slice(c);const d=n.slice(c-1).replaceAll(/[^/]+/g,"").length;if(d>0)for(let p=0;p<d;p++)t=`../${t}`;else t=`./${t}`;return t}function Qn(t){return t=MX(t=$X(t=xX(t=an(t=t.trim()))))}function ed(...t){const e=t.filter(fr);if(!e?.length)return;const r=[];if(cs(e[0])){const s=e[0],n=s.indexOf("//");n!==-1&&(r.push(s.slice(0,n+1)),wX(e[0])&&(r[0]+="/"),e[0]=s.slice(n+2))}else e[0].startsWith("/")&&r.push("");const i=e.reduce((s,n)=>n?s.concat(n.split("/")):s,[]);for(let s=0;s<i.length;s++){const n=i[s];n===".."&&r.length>0&&r[r.length-1]!==".."?r.pop():(!n&&s===i.length-1||n&&(n!=="."||r.length===0))&&r.push(n)}return r.join("/")}function Fs(t,e=!1){if(t==null||Om(t)||fd(t))return null;let r=t.indexOf("://");if(r===-1&&fa(t))r=2;else{if(r===-1)return null;r+=3}const i=t.indexOf("/",r);return i!==-1&&(t=t.slice(0,i)),e&&(t=l1(t,!0)),t}function cs(t){return fa(t)||BC(t)}function Om(t){return t!=null&&t.startsWith("blob:")}function fd(t){return t!=null&&t.startsWith("data:")}function fX(t){const e=cm(t);return e?.isBase64?bz(e.data):null}function LRe(t){return tX(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const mX=/^data:(.*?)(;base64)?,(.*)$/;function cm(t){const e=t.match(mX);if(!e)return null;const[,r,i,s]=e;return{mediaType:r,isBase64:!!i,data:s}}function Ez(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function yX(t){return(await fetch(t)).blob()}function ARe(t){const e=fX(t);if(!e)return null;const r=cm(t);return new Blob([e],{type:r.mediaType})}function fa(t){return t!=null&&t.startsWith("/")&&t[1]==="/"}function BC(t){return t!=null&&Sz.test(t)}function gX(t){return t!=null&&iX.test(t)||_i.scheme==="https"&&fa(t)}function vX(t){return t!=null&&xz.test(t)||_i.scheme==="http"&&fa(t)}function wX(t){return t!=null&&sX.test(t)}function HC(t){return fa(t)?`https:${t}`:t.replace(xz,"https:")}function _X(){return _i.scheme==="http"}function IM(){return _i.scheme==="https"}function l1(t,e=!1){return fa(t)?t.slice(2):(t=t.replace(Sz,""),e&&t.length>1&&t.startsWith("/")&&t[1]==="/"&&(t=t.slice(2)),t)}function bX(t){const e=t.indexOf("//"),r=t.indexOf("/",e+2);return r===-1?t:t.slice(0,r)}function WC(t){let e=0;if(cs(t)){const i=t.indexOf("//");i!==-1&&(e=i+2)}const r=t.lastIndexOf("/");return r<e?t:t.slice(0,r+1)}function RRe(t,e){if(!t)return"";const r=Er(t).path.replace(/\/+$/,""),i=r.slice(r.lastIndexOf("/")+1);if(!e?.length)return i;const s=new RegExp(`\\.(${e.join("|")})$`,"i");return i.replace(s,"")}function SX(t){return t.endsWith("/")?t:`${t}/`}function Cz(t){return t.replace(/\/+$/,"")}function xX(t){if(/^https?:\/\//i.test(t)){const e=UC(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function $X(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function MX(t){const e=Rm.httpsDomains;if(!vX(t))return t;const r=t.indexOf("/",7);let i;if(i=r===-1?t:t.slice(0,r),i=i.toLowerCase().slice(7),$z.test(i)){if(!i.endsWith(":80"))return t;i=i.slice(0,-3),t=t.replace(":80","")}return _X()&&i===_i.authority&&!nX.test(t)||(IM()&&i===_i.authority||e&&e.some(s=>i===s||i.endsWith(`.${s}`))||IM()&&!US(t))&&(t=HC(t)),t}function EM(t,e,r){if(!(e&&r&&t&&cs(t)))return t;const i=t.indexOf("//"),s=t.indexOf("/",i+2),n=t.indexOf(":",i+2),o=Math.min(s<0?t.length:s,n<0?t.length:n);return t.slice(i+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,i+2)}${r}${t.slice(o)}`}function Pz(t,e){const r=new URL(t);return r.host=e,r.port&&!$z.test(e)&&(r.port=""),r.toString()}function TX(t){return new URL(t).host}function CM(t){return typeof t=="string"?new mf(an(t)):(t.scheme||(t.scheme=_i.scheme),t)}function ORe(t){return EX.test(t)}function kz(t,e){const r=Er(t),i=Object.keys(r.query||{});return i.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${i.join(", ")}.`),r.path}function IX(t,e,r){const i=Er(t),s=i.query||{};return s[e]=String(r),`${i.path}?${A0(s)}`}function I_(t,e){if(!e)return t;const r=Er(t),i=r.query||{};for(const[n,o]of Object.entries(e))o!=null&&(i[n]=o);const s=A0(i);return s?`${r.path}?${s}`:r.path}function Lz(t){if(t==null)return null;const e=t.match(Az);return e?e[2]:null}function bA(t){if(t==null)return null;const e=t.match(Az);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function FRe(t){return typeof t=="string"?cm(t)??{data:t}:new Promise((e,r)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=()=>e(cm(i.result)),i.onerror=s=>r(s)})}const Az=/([^.]*)\.([^/]*)$/,EX=/(^data:image\/svg|\.svg$)/i,Rz="20251114",Oz="ec088c999de2dac6fb9478a47da1bad775545540";Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");const CX="4.34";let Fe,ZC=CX;function NRe(t){Fe=t}function PX(t){const e=Fe?.findCredential(t);return e?.token?IX(t,"token",e.token):t}ZC="4.34.8",z("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),z("host-webworker");function kX(t,e){for(const r of t.values())if(e(r))return!0;return!1}function DRe(t,e){for(const r of t.values())if(!e(r))return!1;return!0}function zRe(t,e){for(const r of t.values())if(e(r))return r;return null}function Fm(t,e,r){const i=t.get(e);if(i!==void 0)return i;const s=r();return t.set(e,s),s}function jRe(t){const e=new Map;return r=>(e.has(r)||e.set(r,t(r)),e.get(r))}const LX={remove:()=>{}};function je(t){return t?{remove(){t&&(t(),t=void 0)}}:LX}function Fz(t){t.forEach(e=>e?.remove())}function VRe(t){Fz(t),t.length=0}function md(t){return je(()=>Fz(t))}function URe(t){return je(()=>t()?.remove())}function AX(t){return je(()=>t?.abort())}function GRe(t){return je(t!=null?()=>t.destroy():void 0)}function RX(t){return typeof t=="object"&&!!t&&"remove"in t&&typeof t.remove=="function"}function qRe(t){RX(t)&&t.remove()}function BRe(t){return{[Symbol.dispose](){t.remove()}}}function OX(t){return{setTimeout:(e,r)=>{const i=t.setTimeout(e,r);return je(()=>t.clearTimeout(i))}}}const Nm=OX(globalThis);function GS(t){return FX(t)||Nz(t)}function FX(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function Nz(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function Dm(t,e,r){if(!GS(t))throw new TypeError("target is not a Evented or EventTarget object");return Nz(t)?NX(t,e,r):t.on(e,r)}function NX(t,e,r,i){if(Array.isArray(e)){const s=e.slice();for(const n of s)t.addEventListener(n,r,i);return je(()=>{for(const n of s)t.removeEventListener(n,r,i)})}return t.addEventListener(e,r,i),je(()=>t.removeEventListener(e,r,i))}function Dz(t,e,r){if(!GS(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,r);const i=Dm(t,e,s=>{i.remove(),r.call(t,s)});return i}function xv(t,e){if(t==null)throw new Error(e??"value is None")}function xt(t){return t?.destroy(),null}function HRe(t){return t?.dispose(),null}function yt(t){return t?.remove(),null}function Tl(t){return t?.abort(),null}function WRe(t){return t?.release(),null}function DX(t,e,r){return t!=null&&e!=null?r!=null?r(t,e):t.equals(e):t===e}function u1(t,e){let r;return t.some((i,s)=>(r=e(i,s),r!=null)),r??void 0}function it(t="Aborted"){return new R("AbortError",t)}function gt(t,e="Aborted"){if(xi(t))throw it(e)}function $v(t){return t instanceof AbortSignal?t:t?.signal??void 0}function xi(t){const e=$v(t);return e!=null&&e.aborted}function Po(t){if(Ur(t))throw t}function SA(t){if(!Ur(t))throw t}function mn(t,e){const r=$v(t);if(r!=null){if(!r.aborted)return Dz(r,"abort",()=>e());e()}}function JC(t,e){const r=$v(t);if(r!=null)return gt(r),Dz(r,"abort",()=>e(it()))}function zz(t,e){return $v(e)==null?t:new Promise((r,i)=>{let s=mn(e,()=>i(it()));const n=()=>{s=yt(s)};t.then(n,n),t.then(r,i)})}function Ur(t){return t?.name==="AbortError"}async function hm(t){try{return await t}catch(e){if(!Ur(e))throw e;return}}async function Ch(t){if(!t)return;if(typeof t.forEach!="function"){const r=Object.keys(t),i=r.map(o=>t[o]),s=await Ch(i),n={};return r.map((o,a)=>n[o]=s[a]),n}const e=t;return Promise.allSettled(e).then(r=>Array.from(e,(i,s)=>{const n=r[s];return n.status==="fulfilled"?{promise:i,value:n.value}:{promise:i,error:n.reason}}))}async function zX(t){return(await Promise.allSettled(t)).filter(e=>e.status==="fulfilled").map(e=>e.value)}async function ZRe(t){return(await Promise.allSettled(t)).filter(e=>e.status==="rejected").map(e=>e.reason)}function YC(t,e=void 0,r){const i=new AbortController;return mn(r,()=>i.abort()),new Promise((s,n)=>{let o=setTimeout(()=>{o=0,s(e)},t);mn(i,()=>{o&&(clearTimeout(o),n(it()))})})}function JRe(t,e,r,i){const s=r&&"abort"in r?r:null;i!=null||s||(i=r);let n=setTimeout(()=>{n=0,s?.abort()},e);const o=()=>i||new R("promiseUtils:timeout","The wrapped promise did not resolve within "+e+" ms");return t.then(a=>{if(n===0)throw o();return clearTimeout(n),a},a=>{throw clearTimeout(n),n===0?o():a})}function jX(t,e){const r=new AbortController,i=setTimeout(()=>r.abort(),e);return mn(t,()=>{r.abort(),clearTimeout(i)}),{...t,signal:r.signal}}function $i(t){return t&&typeof t.then=="function"}function PM(t){return $i(t)?t:Promise.resolve(t)}function qS(t,e=-1){let r,i,s,n,o=null;const a=(...l)=>{if(r){i=l,n&&n.reject(it()),n=ps();const m=n.promise;if(o){const y=o;o=null,y.abort()}return m}if(s=n||ps(),n=null,e>0){const m=new AbortController;r=PM(t(...l,m.signal));const y=r;YC(e).then(()=>{r===y&&(n?m.abort():o=m)})}else r=1,r=PM(t(...l));const c=()=>{const m=i;i=s=r=o=null,m!=null&&a(...m)},d=r,p=s;return d.then(c,c),d.then(p.resolve,p.reject),p.promise};return a}function ps(){let t,e;const r=new Promise((s,n)=>{t=s,e=n}),i=s=>{t(s)};return i.resolve=s=>t(s),i.reject=s=>e(s),i.timeout=(s,n)=>Nm.setTimeout(()=>i.reject(n),s),i.promise=r,i}function YRe(t,e){e.then(t.resolve,t.reject)}async function xA(t){await Promise.resolve(),gt(t)}function Il(t,e){const r=e?.url?.path;if(t&&r&&(t=an(t,r,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const i=qC(t,e.portalItem.itemUrl);i!=null&&i.startsWith(VX)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(i).path)}return(t=kM(t,e?.portal))&&HS.test(t)?XC(t):t}function td(t,e,r=0){if((t=t&&HS.test(t)?Gz(t):t)==null)return t;!cs(t)&&e?.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let i=an(t);if(e){const s=e.verifyItemRelativeUrls?.rootPath||e.url?.path;if(s){const n=kM(s,e.portal),o=kM(i,e.portal);i=qC(o,n,n),i!=null&&i!==o&&i!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(i)}}return i=Uz(i,e?.portal),cs(i)&&(i=Qn(i)),e?.resources&&e?.portalItem&&!cs(i)&&!fd(i)&&r===0&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(i),compress:!1}),i}function BS(t,e,r){return Il(t,r)}function rd(t,e,r,i){const s=td(t,i);s!==void 0&&(e[r]=s)}const HS=/\/items\/([^/]+)\/resources\/(.*)/,VX="./resources/";function jz(t){return(t?.match(HS)??null)?.[1]??null}function Vz(t){const e=t?.match(HS)??null;if(e==null)return null;const r=e[2],i=r.lastIndexOf("/");if(i===-1){const{path:o,extension:a}=bA(r);return{prefix:null,filename:o,extension:a}}const{path:s,extension:n}=bA(r.slice(i+1));return{prefix:r.slice(0,i),filename:s,extension:n}}function Uz(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?EM(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function kM(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const r=`${e.urlKey}.${e.customBaseUrl}`,i=jC();return aa(i,`${i.scheme}://${r}`)?EM(t,e.portalHostname,r):EM(t,r,e.portalHostname)}function XC(t){if(!t)return t||null;let e=t;return e&&Fe&&!Fe.findCredential(e)&&(e=_z(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function Gz(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Fe&&!Fe.findCredential(e)&&(e=_z(e)),e}const UX=Object.freeze(Object.defineProperty({__proto__:null,ensureMainOnlineDomain:Uz,fromCDNUrl:Gz,fromJSON:Il,itemIdFromResourceUrl:jz,prefixAndFilenameFromResourceUrl:Vz,read:BS,toCDNUrl:XC,toJSON:td,write:rd},Symbol.toStringTag,{value:"Module"})),qz={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},Bz=Object.values(qz),Hz=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${Bz.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),GX=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${Bz.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),qX=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function XRe(t){return Hz.test(t)}function pc(t){if(t==null)return null;const e=Er(t),r=e?.path.match(Hz)||e?.path.match(GX);if(!r)return null;const[,i,s,n,o]=r,a=s.indexOf("/");return{title:KC(a!==-1?s.slice(a+1):s),serverType:qz[n.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:i}}}function BX(t){const e=Er(t).path.match(qX);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function KC(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function HX(t,e){const r=[];if(t){const i=pc(t);i!=null&&i.title&&r.push(i.title)}if(e){const i=KC(e);r.push(i)}if(r.length===2){if(r[0].toLowerCase().includes(r[1].toLowerCase()))return r[0];if(r[1].toLowerCase().includes(r[0].toLowerCase()))return r[1]}return r.join(" - ")}function c1(t){let e=Fs(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")||/^[a-z\d-]+\.svcs[a-z\d-]*\./.test(e)))}function WX(t,e){return t&&Cz(kz(t,e))}function ZX(t){let{url:e}=t;if(!e)return{url:e};e=kz(e,t.logger);const r=Er(e),i=pc(r.path);let s;if(i!=null)i.sublayer!=null&&t.layer.layerId==null&&(s=i.sublayer),e=i.url.path;else if(t.nonStandardUrlAllowed){const n=BX(r.path);n!=null&&(e=n.serviceUrl,s=n.sublayerId)}return{url:Cz(e),layerId:s}}function JX(t,e,r,i,s){rd(e,i,"url",s),i.url&&t.layerId!=null&&(i.url=ed(i.url,r,t.layerId.toString()))}function KRe(t){if(!t)return!1;const e=t.toLowerCase(),r=e.includes("/services/"),i=e.includes("/mapserver/wmsserver"),s=e.includes("/imageserver/wmsserver"),n=e.includes("/wmsserver");return r&&(i||s||n)}const YX=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function QC(t){if(!eP(t))return null;const e=i=>i instanceof RegExp?i.test(t):typeof i=="string"&&t.startsWith(i),r=De.apiKeys;if(Array.isArray(r.scopes)){for(const i of r.scopes)if(Array.isArray(i.urls)){if(i.urls.some(e))return i.token}else if(e(i.urls))return i.token}return r.basemapStyles&&/^https?:\/\/(i?basemaps|basemapstyles)-api\.arcgis\.com\//i.test(t)?r.basemapStyles:De.apiKey&&/^https?:\/\/.+\.arcgis\.com(\/|$)/i.test(t)?De.apiKey:null}function LM(){return De.apiKey!=null||De.apiKeys.basemapStyles!=null}function Wz(t,e){return e?eP(t):QC(t)!=null}function eP(t){const e=Fs(t,!0);return!!e&&!YX.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function XX(t,e,r=!1,i){return new Promise((s,n)=>{if(xi(i))return void n($A());let o=()=>{c(),n(new Error(`Unable to load ${e}`))},a=async()=>{const d=t;try{await d.decode()}catch{}c(),s(d)},l=()=>{if(!t)return;const d=t;c(),d.src="",n($A())};const c=()=>{t&&(t.removeEventListener("error",o),t.removeEventListener("load",a),o=null,a=null,t=null,i?.removeEventListener("abort",l),l=null,r&&URL.revokeObjectURL(e))};i?.addEventListener("abort",l),t.addEventListener("error",o),t.addEventListener("load",a)})}function $A(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const Zz="Timeout exceeded";function KX(){return new Error(Zz)}function QRe(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===Zz}function QX(t){De.request.crossOriginNoCorsDomains||(De.request.crossOriginNoCorsDomains={});const e=De.request.crossOriginNoCorsDomains;for(let r of t)r=r.toLowerCase(),/^https?:\/\//.test(r)?e[Fs(r)??""]=0:(e[Fs("http://"+r)??""]=0,e[Fs("https://"+r)??""]=0)}function eK(t){const e=De.request.crossOriginNoCorsDomains;if(e){let r=Fs(t);if(r)return r=r.toLowerCase(),!aa(r,jC())&&e[r]<Date.now()-36e5}return!1}async function tK(t){const e=Er(t);t=e.path,e.query?.f==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const r=De.request.crossOriginNoCorsDomains,i=Fs(t);r&&i&&(r[i.toLowerCase()]=Date.now())}const AM=new Map;function rK(t,e){const r=e?.preferredHost;if(!r||aa(t,`https://${r}`,!0))return;const i=pc(t);if(!i||i.serverType!=="FeatureServer"||wz(t))return;const s=i.url.path.toLowerCase();AM.has(s)||AM.set(s,r)}function MA(t){const e=pc(t)?.url.path.toLowerCase();if(!e)return t;const r=AM.get(e);return r?Pz(t,r):t}async function Be(t,e){t instanceof URL&&(t=t.toString()),e?.query instanceof URLSearchParams&&(e.query=VC(e.query.toString().replaceAll("+"," ")));const r=fd(t),i=Om(t);i||r||(t=Qn(t));const s={url:t,requestOptions:{...e}},n=y=>({data:y,getAllHeaders:dm,getHeader:dm,httpStatus:200,requestOptions:s.requestOptions,url:s.url}),o=TM(t,rn.internalInterceptors);if(o){const y=await IA(o,s);if(y!=null)return n(y)}let a=TM(t);if(a){const y=await IA(a,s);if(y!=null)return n(y);a.after||a.error||(a=null)}if(t=s.url,(e=s.requestOptions).responseType==="image"&&(z("host-webworker")||z("host-node")))throw eo("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),s);if(e.method==="head"){if(e.body)throw eo("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),s);if(r||i)throw eo("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),s)}if(await aK(),h1)return h1.execute(t,e);const l=new AbortController,c=mn(e,()=>l.abort()),d={controller:l,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:a,params:s,redoRequest:!1,useIdentity:rn.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},p=e.useRequestQueue?dK(d):OM(d),m=await p.finally(()=>c?.remove());return a?.after?.(m),m}let h1,Jz=!1;const rn=De.request,Yz="FormData"in globalThis,iK=new Set([499,498,403,401]),sK=new Set(["COM_0056","COM_0057","SB_0008"]),nK=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],dm=()=>null,d1=Symbol();function oK(t){const e=Fs(t);e&&!Be._corsServers.includes(e)&&Be._corsServers.push(e)}function TA(t){const e=Fs(t);return!e||e.endsWith(".arcgis.com")||Be._corsServers.includes(e)||GC(e)}function eo(t,e,r,i){let s;const n={url:r.url,requestOptions:r.requestOptions,getAllHeaders:dm,getHeader:dm,ssl:!1};if(e instanceof R)return e.details?(e.details=O(e.details),e.details.url=r.url,e.details.requestOptions=r.requestOptions):e.details=n,e;if(e){const o=i&&(()=>Array.from(i.headers)),a=i&&(d=>i.headers.get(d)),l=i?.status,c=e.message;c&&(s=c),o&&a&&(n.getAllHeaders=o,n.getHeader=a),n.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||l||0,n.subCode=e.subcode,n.messageCode=e.messageCode,typeof e.details=="string"?(n.messages=[e.details],s??=e.details):(n.messages=e.details,s??=n.messages?.[0]),n.raw=d1 in e?e[d1]:e}return s??="Error",Ur(e)?it():new R(t,s,n)}async function aK(){z("host-webworker")&&(!h1&&globalThis.invokeStaticMessage?h1=await q(()=>import("./request-0BPcM9i4.js"),[]):Jz=!0)}async function RM(){Fe||await q(()=>import("./IdentityManager-CdJBTlkb.js"),[])}async function lK(t){const e=t.params.url,r=t.params.requestOptions,i=t.controller.signal,s=r.body;let n=null,o=null;if(Yz&&"HTMLFormElement"in globalThis&&(s instanceof FormData?n=s:s instanceof HTMLFormElement&&(n=new FormData(s))),typeof s=="string"&&(o=s),t.fetchOptions={cache:r.cacheBust?"no-cache":"default",credentials:"same-origin",headers:r.headers||{},keepalive:r.keepAlive??!1,method:r.method==="head"?"HEAD":"GET",mode:"cors",priority:rn.priority,redirect:"follow",signal:i},(n||o)&&(t.fetchOptions.body=n||o),(Jz||r.authMode==="anonymous")&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||r.query?.token||n?.get("token")),!t.hasToken){const a=QC(e);a&&(r.query??={},r.query.token=a,t.hasToken=!0)}if(t.useIdentity&&!t.hasToken&&!t.credential&&!t.credentialToken&&!Xz(e)&&!xi(i)){let a;r.authMode==="immediate"?(await RM(),a=await Fe.getCredential(e,{signal:i})):r.authMode==="no-prompt"?(await RM(),a=await Fe.getCredential(e,{prompt:!1,signal:i}).catch(()=>{})):Fe&&(a=Fe.findCredential(e)),a&&(t.credential=a,t.credentialToken=a.token,t.useSSL=!!a.ssl)}}function Xz(t){return nK.some(e=>e.test(t))}async function uK(t){let e=t.params.url,r=MA(e);const i=t.params.requestOptions,s=t.fetchOptions??{},n=Om(e)||fd(e),o=i.responseType||"json",a=n?0:i.timeout!=null?i.timeout:rn.timeout;let l=!1;if(!n){t.useSSL&&(e=HC(e));let y={...i.query};t.credentialToken&&(y.token=t.credentialToken);let g=A0(y);z("esri-url-encodes-apostrophe")&&(g=g.replaceAll("'","%27"));const v=r.length+1+g.length;let w;l=i.method==="delete"||i.method==="post"||i.method==="put"||!!i.body||v>rn.maxUrlLength;const _=i.useProxy||!!US(e);if(_){const x=Mz(e);w=x.path,!l&&w.length+1+v>rn.maxUrlLength&&(l=!0),x.query&&(y={...x.query,...y})}if(s.method==="HEAD"&&(l||_)){if(l)throw v>rn.maxUrlLength?eo("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):eo("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(_)throw eo("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}l?(s.method=i.method==="delete"?"DELETE":i.method==="put"?"PUT":"POST",i.body?e=I_(e,y):(s.body=A0(y),s.headers||(s.headers={}),s.headers["Content-Type"]="application/x-www-form-urlencoded")):e=I_(e,y),_&&(t.useProxy=!0,e=`${w}?${e}`),y.token&&Yz&&s.body instanceof FormData&&!wz(e)&&s.body.set("token",y.token),i.hasOwnProperty("withCredentials")?t.withCredentials=i.withCredentials:aa(e,jC())||(GC(e)||Fe&&Fe.findServerInfo(e)?.webTierAuth)&&(t.withCredentials=!0),t.withCredentials&&(s.credentials="include",eK(e)&&await tK(l?I_(e,y):e)),r=MA(e)}let c,d,p=0,m=!1;a>0&&(p=setTimeout(()=>{m=!0,t.controller.abort()},a));try{if(i.responseType==="native-request-init")d=s,d.url=r,i.signal?d.signal=i.signal:delete d.signal;else if(i.responseType!=="image"||s.cache!=="default"||s.keepalive||s.method!=="GET"||l||cK(i.headers)||!n&&!t.useProxy&&rn.proxyUrl&&!TA(e)){if(Be._beforeFetch&&await Be._beforeFetch(e,s),c=await fetch(r,s),Be._afterFetch&&await Be._afterFetch(c),t.useProxy||oK(e),i.responseType==="native")d=c;else if(s.method!=="HEAD")if(c.ok){switch(o){case"array-buffer":d=await c.arrayBuffer();break;case"blob":case"image":d=await c.blob();break;default:d=await c.text()}if(p&&(clearTimeout(p),p=0),o==="json"||o==="xml"||o==="document")if(d)switch(o){case"json":d=JSON.parse(d);break;case"xml":d=EA(d,"application/xml");break;case"document":d=EA(d,"text/html")}else d=null;if(d){if(o==="array-buffer"||o==="blob"){const y=c.headers.get("Content-Type");if(y&&/application\/json|text\/plain/i.test(y)&&d[o==="blob"?"size":"byteLength"]<=750)try{const g=await new Response(d).json();g.error&&(d=g)}catch{}}o==="image"&&d instanceof Blob&&(d=await CA(URL.createObjectURL(d),t,!0))}}else{d=await c.text();try{d=JSON.parse(d)}catch{}}}else d=await CA(r,t)}catch(y){if(y.name==="AbortError")throw m?KX():it("Request canceled");if(!(!c&&y instanceof TypeError&&rn.proxyUrl)||i.body||i.method==="delete"||i.method==="head"||i.method==="post"||i.method==="put"||t.useProxy||TA(e))throw y;t.redoRequest=!0,hX({proxyUrl:rn.proxyUrl,urlPrefix:Fs(e)??""})}finally{p&&clearTimeout(p)}return[c,d]}async function IA(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let r,i;try{i=await t.before(e)}catch(s){r=eo("request:interceptor",s,e)}if((i instanceof Error||i instanceof R)&&(r=eo("request:interceptor",i,e)),r)throw t.error&&t.error(r),r;return i}}function cK(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function EA(t,e){let r;try{r=new DOMParser().parseFromString(t,e)}catch{}if(!r||r.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return r}Be._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],Be._beforeFetch=void 0,Be._afterFetch=void 0;const hK=new Map;async function dK(t){const e=fK(t.params.url);if(!e)return OM(t);const{QueueProcessor:r}=await q(()=>import("./QueueProcessor-CfrQlkQB.js"),[]);return Fm(hK,e.origin,()=>{const s=e.isHosted?z("request-queue-concurrency-hosted"):z("request-queue-concurrency-non-hosted");return new r({concurrency:s,process:n=>{if(xi(n.params.requestOptions))throw eo("",it("Request canceled"),n.params);return OM(n)}})}).push(t)}async function OM(t){let e,r;await lK(t);try{do[e,r]=await uK(t);while(!await pK(t,e,r))}catch(n){const o=eo("request:server",n,t.params,e);throw o.details.ssl=t.useSSL,t.interceptor?.error&&t.interceptor.error(o),o}const i=t.params.url;if(r)if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(i)){if(!t.hasToken&&!t.credentialToken&&r.user?.username&&!GC(i)){const n=Fs(i,!0);n&&rn.trustedServers.push(n)}Array.isArray(r.authorizedCrossOriginNoCorsDomains)&&QX(r.authorizedCrossOriginNoCorsDomains)}else(t.params.requestOptions.responseType||"json")==="json"&&rK(i,r);const s=t.credential;if(s&&Fe){let o=Fe.findServerInfo(s.server)?.owningSystemUrl;if(o){o=o.replace(/\/?$/,"/sharing");const a=Fe.findCredential(o,s.userId);a&&Fe._getIdenticalSvcIdx(o,a)===-1&&a.resources.unshift(o)}}return{data:r,getAllHeaders:e?()=>Array.from(e.headers):dm,getHeader:e?n=>e.headers.get(n):dm,httpStatus:e?.status??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function pK(t,e,r){if(t.redoRequest)return t.redoRequest=!1,!1;const i=t.params.requestOptions;if(!e||i.responseType==="native"||i.responseType==="native-request-init")return!0;let s,n;if(r&&(r.error&&typeof r.error=="object"?s=r.error:r.status==="error"&&Array.isArray(r.messages)&&(s={...r},s[d1]=r,s.details=r.messages)),!s&&!e.ok)throw s=new Error(`Unable to load ${e.url} status: ${e.status}`),s[d1]=r,s;let o,a=null;s&&(n=Number(s.code),a=s.hasOwnProperty("subcode")?Number(s.subcode):null,o=s.messageCode,o=o?.toUpperCase());const l=i.authMode;if(n===403&&(a===4||s.message?.toLowerCase().includes("ssl")&&!s.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(l!=="no-prompt"||n===498)&&n!==void 0&&iK.has(n)&&!Xz(t.params.url)&&(n!==403||(!o||!sK.has(o))&&(a==null||a===2&&t.credentialToken))){await RM();try{const c=await Fe.getCredential(t.params.url,{error:eo("request:server",s,t.params),credential:t.credential,prompt:l!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=c,t.credentialToken=c.token,t.useSSL=t.useSSL||c.ssl,!1}catch(c){if(l==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;s=c}}if(s)throw s;return!0}function CA(t,e,r=!1){const i=e.controller.signal,s=new Image;return e.withCredentials?s.crossOrigin="use-credentials":s.crossOrigin="anonymous",s.alt="",s.fetchPriority=rn.priority,s.src=t,XX(s,t,r,i)}function fK(t){let e,r;return typeof t=="string"?(e=Fs(t,!0),r=c1(t)):(e=t.origin,r=c1(t.toString())),e==null?null:{origin:e,isHosted:r}}function mK(t){return t?.release&&typeof t.release=="function"}function yK(t){return t?.acquire&&typeof t.acquire=="function"}var Ku;let yd=(Ku=class{constructor(e,r,i,s=1,n=0){this._creator=e,this._acquireFunction=r,this._releaseFunction=i,this.allocationSize=s,this._pool=new Array(n),this._initialSize=n;for(let o=0;o<n;o++)this._pool[o]=this._creator();this.allocationSize=Math.max(s,1)}destroy(){this.prune(0)}acquire(...e){let r;if(Ku.test.disabled)r=this._creator();else{if(this._pool.length===0){const i=this.allocationSize;for(let s=0;s<i;s++)this._pool[s]=this._creator()}r=this._pool.pop()}return this._acquireFunction?this._acquireFunction(r,...e):yK(r)&&r.acquire(...e),r}release(e){e&&!Ku.test.disabled&&(this._releaseFunction?this._releaseFunction(e):mK(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let r=e;r<this._pool.length;++r){const i=this._pool[r];this._dispose(i)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}},Ku.test={disabled:!!z("esri-tests-disable-memory-pools")},Ku);function gK(t){t.length=0}let Di=class{constructor(e=50,r=50){this._pool=new yd(()=>[],void 0,gK,r,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return _x.acquire()}static release(e){return _x.release(e)}static prune(){_x.prune()}};const _x=new Di(100),PA=new WeakMap;function vK(t,e,r=!1){const i=` DEPRECATED - ${e}`;if(!r)return void t.warn(i);let s=PA.get(t);s||(s=new Set,PA.set(t,s)),s.has(e)||(s.add(e),t.warn(i))}const p1="https://www.esriurl.com/";function WS(t,e,r,i={}){z("esri-deprecation-warnings")&&El(t,`This widget is deprecated. Use the ${e} component instead.`,{see:[`${e} component reference: ${p1}${r}/`,`Esri's move to web components: ${p1}components-transition-plan/`],replacement:`<${r}></${r}>`,warnOnce:!0,...i})}function wK(t,e,r,i={}){z("esri-deprecation-warnings")&&El(t,`This view model is deprecated. Use the ${e} component directly instead.`,{see:[`${e} component reference: ${p1}${r}/`,`Esri's move to web components: ${p1}components-transition-plan/`],replacement:`<${r}></${r}>`,warnOnce:!0,...i})}function tOe(t,e,r={}){z("esri-deprecation-warnings")&&El(t,`Module: ${e}`,r)}function Kz(t,e,r={}){if(z("esri-deprecation-warnings")){const{moduleName:i}=r;El(t,`Function: ${(i?i+"::":"")+e+"()"}`,r)}}function FM(t,e,r={}){if(z("esri-deprecation-warnings")){const{moduleName:i}=r;El(t,`Property: ${(i?i+"::":"")+e}`,r)}}function _K(t,e,r,i={}){if(z("esri-deprecation-warnings")){const{moduleName:s}=i;El(t,`'${(s?s+"::":"")+e}' value: ${r}`,i)}}function bK(t,e,r={}){z("esri-deprecation-warnings")&&El(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...r})}function El(t,e,r={}){if(z("esri-deprecation-warnings")){const{replacement:i,version:s,see:n,warnOnce:o}=r;let a=e;if(i&&(a+=`
	 Replacement: ${i}`),s&&(a+=`
	 Version: ${s}`),n)if(Array.isArray(n)){a+=`
	 See for more details:`;for(const l of n)a+=`
		${l}`}else a+=`
	 See ${n} for more details.`;vK(t,a,o)}}function rOe(t){const e=[];return function*(){yield*e;let r,i=e.length;for(;!(r=t.next()).done;)for(e.push(r.value),yield r.value;++i<e.length;)yield e[i]}}function SK(t,e){for(const r of t)if(r!=null&&e(r))return r}function f1(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let zm=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(r=>{e+=r.length}),e}add(e,r){if(f1(e)){const i=this._getOrCreateGroup(r);for(const s of e)LA(s)&&i.push(s)}else LA(e)&&this._getOrCreateGroup(r).push(e);return this}forEach(e,r){if(typeof e=="function")this._groups.forEach(i=>i.forEach(e));else{const i=this._getGroup(e);i&&r&&i.forEach(r)}}has(e){return this._groups.has(lw(e))}remove(e){if(typeof e!="string"&&f1(e)){for(const r of e)this.remove(r);return this}return this.has(e)?(kA(this._getGroup(e)),this._groups.delete(lw(e)),this):this}removeAll(){return this._groups.forEach(kA),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const r=[];return this._groups.set(lw(e),r),r}_getGroup(e){return this._groups.get(lw(e))}};function lw(t){return t||"_default_"}function kA(t){for(const e of t)e instanceof zm?e.removeAll():e.remove()}function LA(t){return t!=null&&(!!t.remove||t instanceof zm)}const Qz=Symbol("Accessor-beforeDestroy");function Hi(t){return t.__accessor__??null}function xK(t,e){return t?.metadata?.[e]!=null}function E_(t,e,r){return r?m1(t,e,{policy:r,path:""}):m1(t,e,null)}function m1(t,e,r){return e?Object.keys(e).reduce((i,s)=>{const n=s;if(n==="__proto__")return i;let o=null,a="merge";if(r&&(o=r.path?`${r.path}.${s}`:s,a=r.policy(o)),a==="replace"||a==="replace-arrays"&&Array.isArray(i[n]))return i[n]=e[n],i;if(i[n]===void 0)return i[n]=O(e[n]),i;let l=i[n],c=e[n];if(l===c)return i;if(Array.isArray(c)||Array.isArray(i))l=l?Array.isArray(l)?i[n]=l.slice():i[n]=[l]:i[n]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach(d=>{l.includes(d)||l.push(d)}));else if(c&&typeof c=="object")if(r){const d=r.path;r.path=o,i[n]=m1(l,c,r),r.path=d}else i[n]=m1(l,c,null);else i.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(i[n]=c);return i},t||{}):t}function e6(t){return Array.isArray(t)?t:t.split(".")}function AA(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function $K(t){if(Array.isArray(t)){const e=[];for(const r of t)e.push(...AA(r));return e}return AA(t)}function t6(t,e,r,i){const s=$K(e);if(s.length!==1){const n=s.map(o=>i(t,o,r));return md(n)}return i(t,s[0],r)}function r6(t,e){const r=t.endsWith("?")?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const s=parseInt(r,10);if(!isNaN(s))return Array.isArray(e)?e[s]:e.at(s)}const i=Hi(e);return xK(i,r)?i.get(r):e[r]}function i6(t,e,r){if(t==null)return t;const i=r6(e[r],t);return!i&&r<e.length-1?void 0:r===e.length-1?i:i6(i,e,r+1)}function Mv(t,e,r=0){return typeof e!="string"||e.includes(".")?i6(t,e6(e),r):r6(e,t)}function ln(t,e){return Mv(t,e)}function RA(t,e){return Mv(e,t)!==void 0}const Ls={INITIALIZING:0,CONSTRUCTING:1,CONSTRUCTED:2,DESTROYING:3,DESTROYED:4};function jm(t){let e=t.constructor.__accessorMetadata__;const r=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!r){e=Object.create(e);for(const i in e)e[i]=O(e[i]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function Tv(t,e){const r=jm(t);let i=r[e];return i||(i=r[e]={}),i}function MK(t,e){return E_(t,e,IK)}const TK=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function IK(t){return TK.test(t)?"replace":"merge"}let EK=class{constructor(e,r){this._observers=e,this._observer=r}remove(){AC(this._observers,this._observer)}},s6=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return CK;this._observers==null&&(this._observers=[]);const r=this._observers;let i=!1,s=!1;const n=r.length;for(let o=0;o<n;++o){const a=r[o];if(a.destroyed)s=!0;else if(a===e){i=!0;break}}return i||(r.push(e),s&&this._removeDestroyedObservers()),new EK(r,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const r=e.length;let i=0;for(let s=0;s<r;++s){for(;s+i<r&&e[s+i].destroyed;)++i;if(i>0){if(!(s+i<r))break;e[s]=e[s+i]}}e.length=r-i}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const r of e)r.onCommitted();this._observers=null}}};const CK=je(),Ct={Dirty:1,Overridden:2,Computing:4,NonNullable:8,HasDefaultValue:16,DepTrackingInitialized:32,AutoTracked:64,ExplicitlyTracking:128};let ZS=class{constructor(e){this.accessed=void 0,this._handles=void 0,this._observer=e}destroy(){this.accessed?.clear(),this.clear()}onAccessed(e){this._observer!=null&&e!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(e))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach(e=>{this._handles.push(e.observe(this._observer))}),this.accessed.clear()))}clear(){if(this._handles!=null){for(let e=0;e<this._handles.length;++e)this._handles[e].remove();this._handles.length=0}}};const y1=new ZS,Ky=[];let Xg=y1;function _e(t){Xg.onAccessed(t)}let C_=!1,P_=!1;function Cl(t,e,r){if(C_)return tP(t,e,r);let i=null;return n6(t),i=e.call(r),o6(),i}function PK(t,e){return Cl(y1,t,e)}function tP(t,e,r){const i=C_;C_=!0,n6(t);let s=null;try{s=e.call(r)}catch(n){P_&&U.getLogger("esri.core.accessorSupport.tracking").error(n)}return o6(),C_=i,s}function n6(t){Xg=t,Ky.push(t)}function o6(){const t=Ky.length;if(t>1){const e=Ky.pop();Xg=Ky[t-2],e.onTrackingEnd()}else if(t===1){const e=Ky.pop();Xg=y1,e.onTrackingEnd()}else Xg=y1}function a6(t,e){if(e.flags&Ct.DepTrackingInitialized)return;e.flags|=Ct.DepTrackingInitialized;const r=P_;P_=!1,e.flags&Ct.AutoTracked?tP(e.trackingTarget,e.metadata.get,t):l6(t,e),P_=r}const kK=[];function l6(t,e){e.flags&Ct.ExplicitlyTracking||(e.flags|=Ct.ExplicitlyTracking,tP(e.trackingTarget,()=>{const r=e.metadata.dependsOn||kK;for(const i of r)if(typeof i!="string"||i.includes(".")){const s=e6(i);for(let n=0,o=t;n<s.length&&o!=null&&typeof o=="object";++n)o=OA(o,s[n],n!==s.length-1)}else OA(t,i,!1)}),e.flags&=-129)}function OA(t,e,r){const i=e.endsWith("?")?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const n=parseInt(i,10);if(!isNaN(n))return Array.isArray(t)?t[n]:t.at(n)}const s=Hi(t);if(s){const n=s.propertiesByName.get(i);n&&(_e(n),a6(t,n))}return r?t[i]:void 0}let FA=class extends s6{constructor(e,r){super(),this.propertyName=e,this.metadata=r,this.trackingTarget=new ZS(this),this.flags=0,this.flags=Ct.Dirty|(r.nonNullable?Ct.NonNullable:0)|(r.hasOwnProperty("value")?Ct.HasDefaultValue:0)|(r.get===void 0?Ct.DepTrackingInitialized:0)|(r.dependsOn===void 0?Ct.AutoTracked:0)}destroy(){this.flags&Ct.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(e){e.mutable&&_e(this);const r=e.store,i=this.propertyName,s=this.flags,n=r.get(i);if(s&Ct.Computing||~s&Ct.Dirty&&r.has(i))return n;this.flags|=Ct.Computing;const o=e.host;let a;s&Ct.AutoTracked?a=Cl(this.trackingTarget,this.metadata.get,o):(l6(o,this),a=this.metadata.get.call(o)),this.flags|=Ct.DepTrackingInitialized,r.set(i,a,1);const l=r.get(i);return l===n?this.flags&=-2:PK(this.commit,this),this.flags&=-5,l}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=-2,this.onCommitted()}onInvalidated(){~this.flags&Ct.Overridden&&(this.flags|=Ct.Dirty);const e=this._observers;if(e&&e.length>0)for(const r of e)r.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const r=e.slice();for(const i of r)i.onCommitted()}}};const NM=8;function ml(t){switch(t){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"link-chart":return 6;case"user":return 7;default:return null}}function R0(t){switch(t){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"link-chart";case 7:return"user"}}function LK(t){return R0(t)}let AK=class u6{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const r=new u6;return this._values.forEach((i,s)=>{e&&e.has(s)||r.set(s,O(i))}),r}get(e){return this._values.get(e)}originOf(){return 7}keys(){return[...this._values.keys()]}set(e,r){this._values.set(e,r)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}isAtOrigin(e,r){return this.has(e)}isBelowOrigin(e,r){return!this.has(e)}forEach(e){this._values.forEach(e)}};function kd(t,e,r){return t!==void 0}function NA(t,e,r,i){return t!==void 0&&(!(r==null&&t.flags&Ct.NonNullable)||(i.lifecycle,!1))}let RK=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=Ls.INITIALIZING,this.store=new AK,this.mutable=!0,this._origin=7;const r=this.host.constructor.__accessorMetadata__;for(const i in r){const s=new FA(i,r[i]);this.propertiesByName.set(i,s)}this.metadata=r}initialize(){this.lifecycle=Ls.CONSTRUCTING}constructed(){this.lifecycle=Ls.CONSTRUCTED}destroy(){this.lifecycle=Ls.DESTROYED,this.propertiesByName.forEach(e=>e.destroy())}get initialized(){return this.lifecycle!==Ls.INITIALIZING}get(e){const r=this.propertiesByName.get(e);if(!kd(r))return;if(r.metadata.get)return r.getComputed(this);this.mutable&&_e(r);const i=this.store;return i.has(e)?i.get(e):r.metadata.value}originOf(e){const r=this.store.originOf(e);if(r===void 0){const i=this.propertiesByName.get(e);if(i!==void 0&&i.flags&Ct.HasDefaultValue)return"defaults"}return R0(r)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const r=this.propertiesByName.get(e);if(kd(r))return this.store.has(e)?this.store.get(e):r.metadata.value}internalSet(e,r){const i=this.propertiesByName.get(e);kd(i)&&this._internalSet(i,r)}getDependsInfo(e,r,i){const s=this.propertiesByName.get(r);if(!kd(s))return"";const n=new ZS,o=Cl(n,()=>s.metadata.get?.call(e));let a=`${i}${e.declaredClass.split(".").pop()}.${r}: ${o}
`;const l=n.accessed??new Set;if(l.size===0)return a;i+="  ";for(const c of l)c instanceof FA&&(a+=`${i}${c.propertyName}: undefined
`);return a}setAtOrigin(e,r,i){const s=this.propertiesByName.get(e);if(kd(s))return this._setAtOrigin(s,r,i)}isOverridden(e){const r=this.propertiesByName.get(e);return r!==void 0&&!!(r.flags&Ct.Overridden)}clearOrigin(e,r){const i=this.store,s=this.propertiesByName.get(e);if(!kd(s))return;const n=i.isAtOrigin(e,r)&&!(s.flags&Ct.Overridden);i.delete(e,r),n&&s.notifyChange()}clearOverride(e){const r=this.propertiesByName.get(e);r&&r.flags&Ct.Overridden&&(r.flags&=-3,r.notifyChange())}override(e,r){const i=this.propertiesByName.get(e);if(!NA(i,e,r,this))return;const s=i.metadata.cast;if(s){const n=this._cast(s,r),{valid:o,value:a}=n;if(bx.release(n),!o)return;r=a}i.flags|=Ct.Overridden,this._internalSet(i,r)}set(e,r){const i=this.propertiesByName.get(e);if(!NA(i,e,r,this))return;const s=i.metadata.cast;if(s){const o=this._cast(s,r),{valid:a,value:l}=o;if(bx.release(o),!a)return;r=l}const n=i.metadata.set;n?n.call(this.host,r):this._internalSet(i,r)}setDefaultOrigin(e){this._origin=ml(e)}getDefaultOrigin(){return R0(this._origin)}notifyChange(e){const r=this.propertiesByName.get(e);r!==void 0&&r.notifyChange()}invalidate(e){const r=this.propertiesByName.get(e);r!==void 0&&r.invalidate()}commit(e){const r=this.propertiesByName.get(e);r!==void 0&&r.commit()}_internalSet(e,r){const i=this.lifecycle!==Ls.INITIALIZING?this._origin:0;this._setAtOrigin(e,r,i)}_setAtOrigin(e,r,i){const s=this.store,n=e.propertyName;if(s.isAtOrigin(n,i)&&NC(r,s.get(n))&&~e.flags&Ct.Overridden)return;const o=s.isBelowOrigin(n,i)||s.isAtOrigin(n,i);o&&e.invalidate(),s.set(n,r,i),o&&e.commit(),a6(this.host,e)}_cast(e,r){const i=bx.acquire();return i.valid=!0,i.value=r,e&&(i.value=e.call(this.host,r,i)),i}},OK=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const bx=new yd(()=>new OK);function g1(t,e,r){if(t&&e)if(typeof e=="object")for(const i of Object.getOwnPropertyNames(e))g1(t,i,e[i]);else{if(e.includes(".")){const s=e.split("."),n=s.splice(-1,1)[0];return void g1(ln(t,s),n,r)}const i=t.__accessor__;i!=null&&FK(e,i),t[e]=r}}function FK(t,e){if(z("esri-unknown-property-errors")&&!NK(t,e))throw new R("set:unknown-property",DK(t,e))}function NK(t,e){return e.metadata[t]!=null}function DK(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let zK;function jK(){return zK}let c6=class extends yd{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const r=super.acquire(...e);return this._set.delete(r),r}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const uw=[];function v1(t){uw.push(t),uw.length===1&&queueMicrotask(()=>{const e=uw.slice();uw.length=0;for(const r of e)r()})}let Kg=class{constructor(e,r=30){this.name=e,this._counter=0,this._samples=new Array(r)}push(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}set(e){e!=null&&(this._samples[this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,r)=>e-r)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,r)=>e+r,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};const w1=(t,e,r,i)=>{let s=e,n=e;const o=r>>>1,a=t[s-1];for(;n<=o;){n=s<<1,n<r&&i(t[n-1],t[n])<0&&++n;const l=t[n-1];if(i(l,a)<=0)break;t[s-1]=l,s=n}t[s-1]=a},h6=(t,e)=>t<e?-1:t>e?1:0;function VK(t,e,r,i){r===void 0&&(r=t.length),i===void 0&&(i=h6);for(let n=r>>>1;n>e;n--)w1(t,n,r,i);const s=e+1;for(let n=r-1;n>e;n--){const o=t[e];t[e]=t[n],t[n]=o,w1(t,s,n,i)}}function*UK(t,e,r,i){r===void 0&&(r=t.length),i===void 0&&(i=h6);for(let n=r>>>1;n>e;n--)w1(t,n,r,i),yield;const s=e+1;for(let n=r-1;n>e;n--){const o=t[e];t[e]=t[n],t[n]=o,w1(t,s,n,i),yield}}const GK=1.5,qK=1.1;let d6=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new tz,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>DA(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const r=new Array;for(let i=0;i<this._length;i++){const s=this.data[i];e(s)&&r.push(s)}return r}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,r){const i=this.data.indexOf(e,r);return i!==-1&&i<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let r=e;r<this._length;++r)this.data[r]=this._deallocator(this.data[r]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,r=e.length){for(let i=0;i<r;i++)this.data[this._length++]=e[i]}fill(e,r){for(let i=0;i<r;i++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,DA(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const r=xM(this.data,e,this.length,this._hint);if(r!==-1)return this.data.splice(r,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(xM(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,r=e.length,i){this.length=VY(this.data,e,this.length,r,this._hint,i),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,r){if(e>=this.length||r>=this.length||e===r)return;const i=this.data[e];this.data[e]=this.data[r],this.data[r]=i}sort(e){VK(this.data,0,this.length,e)}iterableSort(e){return UK(this.data,0,this.length,e)}some(e,r){for(let i=0;i<this.length;++i)if(e.call(r,this.data[i],i,this.data))return!0;return!1}find(e,r){const{data:i,length:s}=this;for(let n=0;n<s;++n)if(e.call(r,i[n]))return i[n]}filterInPlace(e,r){let i=0;for(let s=0;s<this._length;++s){const n=this.data[s];e.call(r,n,s,this.data)&&(this.data[s]=this.data[i],this.data[i]=n,i++)}if(this._deallocator)for(let s=i;s<this._length;s++)this.data[s]=this._deallocator(this.data[s]);return this._length=i,this._shrink(),this}forAll(e,r){const{data:i,length:s}=this;for(let n=0;n<s;++n)e.call(r,i[n],n,i)}forEach(e,r){this.data.slice(0,this.length).forEach(e,r)}map(e,r){const i=new Array(this.length);for(let s=0;s<this.length;++s)i[s]=e.call(r,this.data[s],s,this.data);return i}reduce(e,r){let i=r;for(let s=0;s<this.length;++s)i=e(i,this.data[s],s,this.data);return i}has(e){const r=this.length,i=this.data;for(let s=0;s<r;++s)if(i[s]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function DA(t){t.data.length>GK*t.length&&(t.data.length=Math.floor(t.length*qK))}function pOe(t){return t}function BK(t){return 1e3*t}function fOe(t){return t}function mOe(t){return .001*t}let HK=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},WK=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},DM=0;const yy={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},zM=["prepare","preRender","render","postRender","update","finish"],jM=[],id=new d6;let ZK=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1,p6()}};function JK(){Vh!=null&&(cancelAnimationFrame(Vh),Vh=requestAnimationFrame(rP))}function p6(){Vh==null&&(DM=performance.now(),Vh=requestAnimationFrame(rP))}const _1={frameTasks:id,willDispatch:!1,clearFrameTasks:YK,dispatch:m6,executeFrameTasks:XK,reschedule:JK};function Vm(t){const e=new WK(t);return jM.push(e),_1.willDispatch||(_1.willDispatch=!0,v1(m6)),e}function pm(t){const e=new HK(t);return id.push(e),p6(),new ZK(e)}let Vh=null;function YK(t=!1){id.forAll(e=>{e.removed=!0}),t&&f6()}function rP(){const t=performance.now();Vh=null,Vh=id.some(r=>!r.paused&&!r.removed)?requestAnimationFrame(rP):null,_1.executeFrameTasks(t)}function XK(t){const e=t-DM;DM=t;const r=1e3/60,i=Math.max(0,e-r);yy.time=t,yy.frameDuration=r-i;for(let s=0;s<zM.length;s++){const n=performance.now(),o=zM[s];id.forAll(a=>{a.paused||a.removed||(s===0&&a.ticks++,a.phases[o]&&(yy.elapsedFrameTime=performance.now()-t,yy.deltaTime=a.ticks===0?0:e,a.phases[o]?.call(a,yy)))}),eQ[s].push(performance.now()-n)}f6(),tQ.push(performance.now()-t)}const cw=new d6;function f6(){id.forAll(t=>{t.removed&&cw.push(t)}),id.removeUnorderedMany(cw.data,cw.length),cw.clear()}function m6(){for(;jM.length;){const t=jM.shift();t.isActive&&t.callback()}_1.willDispatch=!1}function KK(t=1,e){const r=ps(),i=()=>{xi(e)?r.reject(it()):t===0?r():(--t,v1(()=>i()))};return i(),r.promise}function QK(t){return KK(1,t)}async function y6(t){await QK(t),await new Promise(e=>requestAnimationFrame(()=>{t?.aborted||e()}))}const eQ=zM.map(t=>new Kg(t)),tQ=new Kg("total");function g6(t,e){for(const r of t.values())if(e(r))return!0;return!1}function b1(t,e){if(!e)return t;for(const r of e)r!=null&&t.add(r);return t}function zA(t,e){return e!=null&&t.add(e),t}function iP(t,e){const r=new Set;return b1(r,t),b1(r,e),r}function rQ(t,e){const r=new Set;for(const i of e)t.has(i)&&r.add(i);return r}function wOe(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const r of t)if(!e.has(r))return!1;return!0}function _Oe(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}function iQ(t,e){const r=new Set(t);for(const i of e)r.delete(i);return r}function sQ(t,e){return iQ(iP(t,e),rQ(t,e))}let nQ=0;function k_(){return++nQ}let JS=class extends ZS{constructor(e){super(new oQ(e)),this._observer&&jA.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&jA.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}},oQ=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=aQ}};const jA=new FinalizationRegistry(t=>{t.deref()?.destroy()});function aQ(){}let yf=!1;const S1=[];function v6(t,e){let r=new JS(n),i=null,s=!1;function n(){if(!r||s)return;if(yf)return void b6(n);const a=i;r.clear(),yf=!0,s=!0,i=Cl(r,t),s=!1,yf=!1,e(i,a),S6()}function o(){r&&(r.destroy(),r=null,i=null)}return s=!0,i=Cl(r,t),s=!1,je(o)}function w6(t,e){let r=new JS(s),i=null;function s(){e(i,o)}function n(){r&&(r.destroy(),r=null),i=null}function o(){return r?(r.clear(),i=Cl(r,t),i):null}return o(),je(n)}function _6(t,e){let r=!1,i=!1;const s=!!e?.sync;let n=new JS(()=>{r||i||(i=!0,s?o():queueMicrotask(o))});function o(){i=!1,n&&!r&&(yf?b6(o):(n.clear(),yf=!0,r=!0,Cl(n,t),r=!1,yf=!1,S6()))}function a(){n&&(n.destroy(),n=null)}return r=!0,Cl(n,t),r=!1,je(a)}function b6(t){S1.includes(t)||S1.unshift(t)}function S6(){for(;S1.length;)S1.pop()()}var Zh;let sP=(Zh=class{constructor(){this.uid=k_(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,r,i,s,n){return this.pool.acquire(0,e,r,i,s,n,NC)}static acquireTracked(e,r,i,s){return this.pool.acquire(1,e,r,i,null,null,s)}notify(e,r){this.type===0?this.callback.call(this.target,e,r,this.path,this.target):this.callback.call(null,e,r,void 0,void 0)}acquire(e,r,i,s,n,o,a){this.uid=k_(),this.removed=!1,this.type=e,this.oldValue=r,this.callback=i,this.getValue=s,this.target=n,this.path=o,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=k_(),this.removed=!0}},Zh.pool=new c6(()=>new Zh),Zh);const L_=new Di,bl=new Set;let x1;function $1(t){bl.delete(t),bl.add(t),x6()}function x6(){x1||(x1=Vm(cQ))}function lQ(t){if(t.removed)return;const e=t.oldValue,r=t.getValue();t.equals(e,r)||(t.oldValue=r,t.notify(r,e))}function uQ(t){for(const e of bl.values())e.target===t&&(e.removed=!0)}function cQ(){let t=10;for(;x1&&t--;){x1=null;const e=hQ(),r=L_.acquire();for(const i of e){const s=i.uid;lQ(i),s===i.uid&&i.removed&&r.push(i)}for(const i of bl)i.removed&&(r.push(i),bl.delete(i));for(const i of r)sP.pool.release(i);L_.release(r),L_.release(e),VM.forEach(i=>i())}}function hQ(){const t=L_.acquire();t.length=bl.size;let e=0;for(const r of bl)t[e]=r,++e;return bl.clear(),t}const VM=new Set;function dQ(t){return VM.add(t),je(()=>VM.delete(t))}function pQ(t,e,r){let i=t6(t,e,r,(s,n,o)=>{let a,l,c=w6(()=>Mv(s,n),(d,p)=>{s.__accessor__?.lifecycle===Ls.DESTROYED||a&&a.uid!==l?i.remove():(a||(a=sP.acquireUntracked(d,o,p,s,n),l=a.uid),$1(a))});return je(()=>{c.remove(),a&&(a.uid!==l||a.removed||(a.removed=!0,$1(a)),a=null),i=c=null})});return i}function fQ(t,e,r){const i=t6(t,e,r,(s,n,o)=>{let a=!1;return v6(()=>Mv(s,n),(l,c)=>{s.__accessor__.lifecycle!==Ls.DESTROYED?a||(a=!0,NC(c,l)||o.call(s,l,c,n,s),a=!1):i.remove()})});return i}function mQ(t,e,r,i=!1){return t.__accessor__&&t.__accessor__.lifecycle!==Ls.DESTROYED?i?fQ(t,e,r):pQ(t,e,r):je()}function yQ(t,e,r){let i,s,n=w6(t,(o,a)=>{i&&i.uid!==s?n.remove():(i||(i=sP.acquireTracked(o,e,a,r),s=i.uid),$1(i))});return je(()=>{n.remove(),i&&(i.uid!==s||i.removed||(i.removed=!0,$1(i)),i=null),n=null})}function gQ(t,e,r){let i=!1;return v6(t,(s,n)=>{i||(i=!0,r(n,s)||e(s,n),i=!1)})}function vQ(t,e,r=!1,i=pz){return r?gQ(t,e,i):yQ(t,e,i)}function VA(t){return g6(bl,e=>e.oldValue===t)}const Uh=()=>U.getLogger("esri.core.accessorSupport.ensureTypes");function wQ(t){if(t==null)return t;const e=new Date(t);return isNaN(e.getTime())?(Uh().error("Accessor#set",`Invalid date value: '${t}', falling back to current date`),new Date):e}function _Q(t){return t==null?t:!!t}function Iv(t){return t==null?t:t.toString()}function zi(t,e=0){return t==null?t:(t=parseFloat(t),isNaN(t)?e:t)}function nP(t){return t==null?t:Math.round(parseFloat(t))}function bQ(t){return null}function SQ(t,e){return r=>{let i=t(r);return e.step!=null&&(i=Math.round(i/e.step)*e.step),e.min!=null&&(i=Math.max(e.min,i)),e.max!=null&&(i=Math.min(e.max,i)),i}}function $6(t){return t?.constructor&&t.constructor.__accessorMetadata__!==void 0}function M1(t,e){return e!=null&&t&&!(e instanceof t)}function M6(t){return t&&"isCollection"in t}function UA(t){return t?.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function xQ(t,e){if(!e?.constructor||!M6(e.constructor))return UM(t,e)?e:new t(e);const r=UA(t.prototype.itemType),i=UA(e.constructor.prototype.itemType);return r?i?r===i?e:r.prototype.isPrototypeOf(i.prototype)?new t(e):(UM(t,e),e):new t(e):e}function UM(t,e){return!!$6(e)&&(Uh().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+YS(t)+"'"),!0)}function Um(t,e){return e==null?e:M6(t)?xQ(t,e):M1(t,e)?UM(t,e)?e:new t(e):e}function YS(t){return t?.prototype?.declaredClass||"unknown"}const $Q=new WeakMap;function MQ(t){switch(t){case Number:return e=>zi(e);case Ue:return nP;case Boolean:return _Q;case String:return Iv;case Date:return wQ;case XS:return bQ;default:return Fm($Q,t,()=>Um.bind(null,t))}}function jt(t,e){const r=MQ(t);return arguments.length===1?r:r(e)}function O0(t,e,r){return arguments.length===1?O0.bind(null,t):e&&(Array.isArray(e)?e.map(i=>t(i,r)):[t(e,r)])}function TQ(t,e){return arguments.length===1?O0(r=>jt(t,r)):O0(r=>jt(t,r),e)}function T6(t,e,r){return e!==0&&Array.isArray(r)?r.map(i=>T6(t,e-1,i)):t(r)}function T1(t,e,r){if(arguments.length===2)return n=>T1(t,e,n);if(!r)return r;r=T6(t,e,r);let i=e,s=r;for(;i>0&&Array.isArray(s);)i--,s=s[0];if(s!==void 0)for(let n=0;n<i;n++)r=[r];return r}function IQ(t,e,r){return arguments.length===2?T1(i=>jt(t,i),e):T1(i=>jt(t,i),e,r)}function I6(t){return!!Array.isArray(t)&&!t.some(e=>{const r=typeof e;return!(r==="string"||r==="number"||r==="function"&&t.length>1)})}function GM(t,e){if(arguments.length===2)return GM(t).call(null,e);const r=new Set,i=t.filter(a=>typeof a!="function"),s=t.filter(a=>typeof a=="function");for(const a of t)typeof a!="string"&&typeof a!="number"||r.add(a);let n=null,o=null;return(a,l)=>{if(a==null)return a;const c=typeof a,d=c==="string"||c==="number";return d&&(r.has(a)||s.some(p=>c==="string"&&p===String||c==="number"&&p===Number))||c==="object"&&s.some(p=>!M1(p,a))?a:(d&&i.length?(n||(n=i.map(p=>typeof p=="string"?`'${p}'`:`${p}`).join(", ")),Uh().error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${n}`)):typeof a=="object"&&s.length?(o||(o=s.map(p=>YS(p)).join(", ")),Uh().error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${o}`)):Uh().error("Accessor#set",`'${a}' is not a valid value for this property`),l&&(l.valid=!1),null)}}function ma(t,e){if(arguments.length===2)return ma(t).call(null,e);const r={},i=[],s=[];for(const l in t.typeMap){const c=t.typeMap[l];r[l]=jt(c),i.push(YS(c)),s.push(l)}const n=()=>`'${i.join("', '")}'`,o=()=>`'${s.join("', '")}'`,a=typeof t.key=="string"?l=>l[t.key]:t.key;return l=>{if(t.base&&!M1(t.base,l)||l==null)return l;const c=a(l)||t.defaultKeyValue,d=r[c];if(!d)return Uh().error("Accessor#set",`Invalid property value, value needs to be one of ${n()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!M1(t.typeMap[c],l))return l;if(typeof t.key=="string"&&!$6(l)){const p={};for(const m in l)m!==t.key&&(p[m]=l[m]);return d(p)}return d(l)}}let Ue=class{},XS=class{};const MOe={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function EQ(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function E6(t){switch(t.type){case"native":return jt(t.value);case"array":return O0(E6(t.value));case"one-of":return CQ(t);default:return null}}function CQ(t){let e=null;return(r,i)=>BM(r,t)?r:(e==null&&(e=qM(t)),Uh().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),i&&(i.valid=!1),null)}function qM(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Ue:return"integer";case Date:return"date";case XS:return"null";default:return YS(t.value)}case"array":return`array of ${qM(t.value)}`;case"one-of":{const e=t.values.map(r=>qM(r));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function BM(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case Ue:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case XS:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(r=>!BM(r,e.value));case"one-of":return e.values.some(r=>BM(t,r))}}function h(t={}){return(e,r)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${r}. Accessor does not support static properties.`);const i=Object.getOwnPropertyDescriptor(e,r),s=Tv(e,r);i&&(i.get||i.set?(s.get=i.get||s.get,s.set=i.set||s.set):"value"in i&&("value"in t&&U.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${r}" on "${e.constructor.name}" already defined in the metadata`,t),s.value=t.value=i.value)),t.readOnly!=null&&(s.readOnly=t.readOnly);const n=t.aliasOf;if(n){const l=typeof n=="string"?n:n.source,c=typeof n=="string"?null:n.overridable===!0;let d;s.dependsOn=[l],s.get=function(){let p=ln(this,l);if(typeof p=="function"){d||(d=l.split(".").slice(0,-1).join("."));const m=ln(this,d);m&&(p=p.bind(m))}return p},s.readOnly||(s.set=c?function(p){this._override(r,p)}:function(p){g1(this,l,p)})}const o=t.type,a=t.types;if(!s.cast){let l;o?l=PQ(o):a&&(l=Array.isArray(a)?O0(ma(a[0])):ma(a)),t.cast=kQ(t.cast,l)}MK(s,t),t.range&&(s.cast=SQ(s.cast,t.range))}}function oP(t,e,r){const i=Tv(t,r);i.json||(i.json={});let s=i.json;return e!==void 0&&(s.origins||(s.origins={}),s.origins[e]||(s.origins[e]={}),s=s.origins[e]),s}function PQ(t){let e=0,r=t;if(EQ(t))return E6(t);for(;Array.isArray(r)&&r.length===1&&typeof r[0]!="string"&&typeof r[0]!="number";)r=r[0],e++;const i=r;if(I6(i))return e===0?GM(i):T1(GM(i),e);if(e===1)return TQ(i);if(e>1)return IQ(i,e);const s=t;return s.from?s.from:jt(s)}function kQ(t,e){if(t||e)return t?e?(r,i)=>e(t(r,i),i):t:e}function LQ(t){if(t.json&&t.json.origins){const e=t.json.origins,r={"web-document":["web-scene","web-map"]};for(const i in r)if(e[i]){const s=e[i];r[i].forEach(n=>{e[n]=s}),delete e[i]}}}let zs=class extends gz{constructor(e,r,i){super(e,r,i)}};zs.prototype.type="warning";function C6(t){return!!t&&t.prototype?.declaredClass&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}function AQ(t,e){return aP(t,"any",e?.origin)}function I1(t,e){return aP(t,"read",e?.origin)}function P6(t,e){return aP(t,"write",e?.origin)}function aP(t,e,r){let i=t?.json;if(i?.origins&&r){let s;s=r==="link-chart"?i.origins[r]&&(e==="any"||e in i.origins[r])?i.origins[r]:i.origins["web-map"]:i.origins[r],s&&(e==="any"||e in s)&&(i=s)}return i}const HM=()=>U.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function GA(t,e,r){t&&(!r&&!e.read||e.read?.reader||e.read?.enabled===!1||FQ(t)&&Ir("read.reader",Gm(t),e))}function Gm(t){const e=t.ndimArray??0;if(e>1)return OQ(t);if(e===1)return qA(t);if("type"in t&&L6(t.type)){const r=t.type.prototype?.itemType?.Type,i=qA(typeof r=="function"?{type:r}:{types:r});return(s,n,o)=>{const a=i(s,n,o);return a&&new t.type(a)}}return lP(t)}function lP(t){return"type"in t?RQ(t.type):NQ(t.types)}function RQ(t){return t.prototype.read?(e,r,i)=>{if(e==null)return e;const s=typeof e;if(s!=="object")return void HM().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${s}'`);const n=new t;return n.read(e,i),n}:t.fromJSON}function k6(t,e,r,i){return i!==0&&Array.isArray(e)?e.map(s=>k6(t,s,r,i-1)):t(e,void 0,r)}function OQ(t){const e=lP(t),r=k6.bind(null,e),i=t.ndimArray??0;return(s,n,o)=>{if(s==null)return s;s=r(s,o,i);let a=i,l=s;for(;a>0&&Array.isArray(l);)a--,l=l[0];if(l!==void 0)for(let c=0;c<a;c++)s=[s];return s}}function qA(t){const e=lP(t);return(r,i,s)=>{if(r==null)return r;if(Array.isArray(r)){const o=[];for(const a of r){const l=e(a,void 0,s);l!==void 0&&o.push(l)}return o}const n=e(r,void 0,s);return n!==void 0?[n]:void 0}}function L6(t){if(!C6(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?uP(e.Type):A6(e.Type))}function FQ(t){return"types"in t?A6(t.types):uP(t.type)}function uP(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||L6(t))}function A6(t){for(const e in t.typeMap)if(!uP(t.typeMap[e]))return!1;return!0}function NQ(t){let e=null;const r=t.errorContext??"type",i=t.validate;return(s,n,o)=>{if(s==null)return s;const a=typeof s;if(a!=="object")return void HM().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);e||(e=zQ(t));const l=t.key;if(typeof l!="string")return;const c=s[DQ(l,e,o)],d=c?e[c]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!d){const m=`Type '${c||"unknown"}' is not supported`;return o?.messages&&s&&o.messages.push(new zs(`${r}:unsupported`,m,{definition:s,context:o})),void HM().error(m)}const p=new d;return p.read(s,o),i?i(p):p}}function DQ(t,e,r){const i=Object.values(e)[0],s=jm(i.prototype)[t],n=I1(s,r),o=n?.read?.source;return o&&typeof o=="string"?o:t}function zQ(t){const e={};for(const r in t.typeMap){const i=t.typeMap[r],s=jm(i.prototype);if(typeof t.key=="function")continue;const n=s[t.key];if(!n)continue;if(n.json?.type&&Array.isArray(n.json.type)&&n.json.type.length===1&&typeof n.json.type[0]=="string"){e[n.json.type[0]]=i;continue}const o=n.json?.write;if(!o?.writer){e[r]=i;continue}const a=o.target,l=typeof a=="string"?a:t.key,c={};o.writer(r,c,l),c[l]&&(e[c[l]]=i)}return e}function jQ(t){if(t.json||(t.json={}),HA(t.json),WA(t.json),BA(t.json),t.json.origins)for(const e in t.json.origins)HA(t.json.origins[e]),WA(t.json.origins[e]),BA(t.json.origins[e]);return!0}function BA(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function HA(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function WA(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function ZA(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const r=t?.ndimArray??0;t&&(r===1||"type"in t&&C6(t.type))?e.write.writer=GQ:r>1?e.write.writer=qQ(r):e.types?Array.isArray(e.types)?e.write.writer=UQ(e.types[0]):e.write.writer=VQ(e.types):e.write.writer=F0}function VQ(t){return(e,r,i,s)=>e?R6(e,t,s)?F0(e,r,i,s):void 0:F0(e,r,i,s)}function R6(t,e,r){for(const i in e.typeMap)if(t instanceof e.typeMap[i])return!0;if(r?.messages){const i=e.errorContext??"type",s=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;r&&r.messages&&t&&r.messages.push(new R(`${i}:unsupported`,s,{definition:t,context:r})),U.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(s)}return!1}function UQ(t){return(e,r,i,s)=>!e||!Array.isArray(e)?F0(e,r,i,s):F0(e.filter(n=>R6(n,t,s)),r,i,s)}function F0(t,e,r,i){Ir(r,E1(t,i),e)}function E1(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?C1(t):t}function C1(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function GQ(t,e,r,i){let s;t===null?s=null:t&&typeof t.map=="function"?(s=t.map(n=>E1(n,i)),typeof s.toArray=="function"&&(s=s.toArray())):s=[E1(t,i)],Ir(r,s,e)}function O6(t,e,r){return r!==0&&Array.isArray(t)?t.map(i=>O6(i,e,r-1)):E1(t,e)}function qQ(t){return(e,r,i,s)=>{let n;if(e===null)n=null;else{n=O6(e,s,t);let o=t,a=n;for(;o>0&&Array.isArray(a);)o--,a=a[0];if(a!==void 0)for(let l=0;l<o;l++)n=[n]}Ir(i,n,r)}}function BQ(t){const e=HQ(t);if(t.json.origins)for(const r in t.json.origins){const i=t.json.origins[r],s=i.types?WQ(i):e;GA(s,i,!1),i.types&&!i.write&&t.json.write?.enabled&&(i.write={...t.json.write}),ZA(s,i)}GA(e,t.json,!0),ZA(e,t.json)}function HQ(t){return t.json.types?WM(t.json):t.type?F6(t):WM(t)}function WQ(t){return t.type?F6(t):WM(t)}function F6(t){if(!t.type)return;let e=0,r=t.type;for(;Array.isArray(r)&&!I6(r);)r=r[0],e++;return{type:r,ndimArray:e}}function WM(t){if(!t.types)return;let e=0,r=t.types;for(;Array.isArray(r);)r=r[0],e++;return{types:r,ndimArray:e}}function ZQ(t){jQ(t)&&(LQ(t),BQ(t))}const Sx=new Set,xx=new Set;function E(t){return e=>{t??="esri.core.Accessor",e.prototype.declaredClass=t,YQ(e);const r=[],i=[];let s=e.prototype;for(;s;)s.hasOwnProperty("initialize")&&!Sx.has(s.initialize)&&(Sx.add(s.initialize),r.push(s.initialize)),s.hasOwnProperty("destroy")&&!xx.has(s.destroy)&&(xx.add(s.destroy),i.push(s.destroy)),s=Object.getPrototypeOf(s);Sx.clear(),xx.clear();const n=class extends e{constructor(...a){if(super(...a),this.constructor===n&&typeof this.postscript=="function"){if(r.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let l=r.length-1;l>=0;l--)r[l].call(this)}}),i.length){let l=!1;const c=this[Qz];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!l){this.__accessor__.lifecycle=Ls.DESTROYING,l=!0,c.call(this);for(let d=0;d<i.length;d++)i[d].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};n.__accessorMetadata__=jm(e.prototype),n.prototype.declaredClass=t;const o=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(n,"name",{value:o,configurable:!0}),n}}function JQ(t,e){return e.get==null?function(){const r=this.__accessor__,i=r.propertiesByName.get(t);if(i===void 0)return;r.mutable&&_e(i);const s=r.store;return s.has(t)?s.get(t):i.metadata.value}:function(){const r=this.__accessor__,i=r.propertiesByName.get(t);if(i!==void 0)return i.getComputed(r)}}function YQ(t){const e=t.prototype,r=jm(e),i={};for(const s of Object.getOwnPropertyNames(r)){const n=r[s];ZQ(n),i[s]={enumerable:!0,configurable:!0,get:JQ(s,n),set(o){const a=this.__accessor__;if(a!==void 0){if(a.mutable)return a.initialized&&n.readOnly?JA("read-only",s):a.lifecycle===Ls.CONSTRUCTED&&n.constructOnly?JA("construct-only",s):void a.set(s,o)}else Object.defineProperty(this,s,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(t.prototype,i)}const JA=(t,e)=>{U.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)};var YA,XA;function XQ(t){if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor?.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const ql=Symbol("Accessor-Handles"),$x=Symbol("Accessor-Initialized");var Qu;let le=(Qu=class{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:r,declaredClass:i,constructor:s}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const n=this;class o extends n{constructor(...l){super(...l),this.inherited=null,s&&s.apply(this,l)}}jm(o.prototype);for(const a in e){const l=e[a];o.prototype[a]=typeof l=="function"?function(...c){const d=this.inherited;let p;this.inherited=function(...m){if(n.prototype[a])return n.prototype[a].apply(this,m)};try{p=l.apply(this,c)}catch(m){throw this.inherited=d,m}return this.inherited=d,p}:e[a]}for(const a in r){const l=XQ(r[a]);h(l)(o.prototype,a)}return E(i)(o)}static freeze(e){return e instanceof Qu?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof Qu?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){if(this[YA]=null,this[XA]=!1,this.constructor===Qu)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const r=new RK(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:r}),e.length>0&&(r.ctorArgs=this.normalizeCtorArgs?.apply(this,e)??e[0])}postscript(){const e=this.__accessor__,r=e.ctorArgs;e.initialize(),r&&(this.set(r),e.ctorArgs=null),e.constructed(),this.initialize(),this[$x]=!0}initialize(){}[Qz](){this[ql]=xt(this[ql])}destroy(){this.destroyed||(uQ(this),this.__accessor__.destroy(),jK()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[$x]}get destroyed(){return this.__accessor__?.lifecycle===Ls.DESTROYED||!1}get destroying(){return this.__accessor__?.lifecycle===Ls.DESTROYING||!1}commitProperty(e){ln(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,r){return g1(this,e,r),this}watch(e,r,i){return Kz(U.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://arcg.is/1vaqf42#watch",warnOnce:!0}),mQ(this,e,r,i)}addHandles(e,r){if(this.destroyed){const i=Array.isArray(e)?e:[e];for(const s of i)s.remove();return}(this[ql]??=new zm).add(e,r)}removeHandles(e){this[ql]?.remove(e)}removeAllHandles(){this[ql]?.removeAll()}removeHandlesReference(e){this[ql]?.removeReference(e)}hasHandles(e){return this[ql]?.has(e)===!0}_override(e,r){r===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,r)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,r){r==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,r)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,r){return this.__accessor__.internalSet(e,r),this}},YA=ql,XA=$x,Qu);const KS=t=>{const e=t;class r extends e{constructor(){super(...arguments),this._listenersMap=null}clearEvents(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clearEvents()}emit(s,n){let o=this._listenersMap?.get(s);if(!o)return!1;let a=!1;for(const l of o.slice()){const c="deref"in l?l.deref():l;c?c?.call(this,n):a=!0}return a&&(o=o.filter(l=>!("deref"in l)||l.deref()!=null),this._listenersMap.set(s,o)),o.length>0}on(s,n){if(Array.isArray(s)){const a=s.map(l=>this.on(l,n));return md(a)}if(s.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const o=this._listenersMap.get(s)||[];return o.push(n),this._listenersMap.set(s,o),je(()=>{const a=this._listenersMap?.get(s),l=a?.indexOf(n)??-1;l>=0&&a.splice(l,1)})}once(s,n){const o=this.on(s,a=>{o.remove(),("deref"in n?n.deref():n)?.call(null,a)});return o}hasEventListener(s){const n=this._listenersMap?.get(s);return n!=null&&n.length>0}}return r},N6=KS(class{}),D6=N6,qm=KS(le);function cP(t){return(e,r)=>{e[r]=t}}let Ev=class extends s6{notify(){const e=this._observers;if(e&&e.length>0){const r=e.slice();for(const i of r)i.onInvalidated(),i.onCommitted()}}};var La;let KQ=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},QQ=class{constructor(e,r,i,s,n){this.target=e,this.added=r,this.removed=i,this.start=s,this.deleteCount=n}};const Gs=new yd(()=>new KQ,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1});function KA(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function Mx(t){return t?t instanceof bu?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function Tx(t){if(t?.length)return t[0]}function eee(t,e,r,i){const s=Math.min(t.length-r,e.length-i);let n=0;for(;n<s&&t[r+n]===e[i+n];)n++;return n}function z6(t,e,r,i){e&&e.forEach((s,n,o)=>{t.push(s),z6(t,r.call(i,s,n,o),r,i)})}const Bl=new Set,Hl=new Set,Wl=new Set,Ix=new Map;let tee=0,bu=La=class extends qm{static ofType(t){if(!t)return La;if(Ix.has(t))return Ix.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const i in t.typeMap){const s=t.typeMap[i].prototype.declaredClass;e?e+=` | ${s}`:e=s}let r=class extends La{};return u([cP({Type:t,ensureType:typeof t=="function"?jt(t):ma(t)})],r.prototype,"itemType",void 0),r=u([E(`esri.core.Collection<${e}>`)],r),Ix.set(t,r),r}static isCollection(t){return t!=null&&t instanceof La}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new Ev,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:tee++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof La?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),super.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return _e(this._observable),this._items}set items(t){this._emitBeforeChanges(1)||(this._splice(0,this.length,Mx(t)),this._emitAfterChanges(1))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:super.hasEventListener(t))}on(t,e){if(this.destroyed)return je();if(t==="change"){const r=this._chgListeners,i={removed:!1,callback:e};return r.push(i),this._notifications&&this._notifications.push({listeners:r.slice(),items:this._items.slice(),changes:[]}),je(()=>{i.removed=!0,r.splice(r.indexOf(i),1)})}return super.on(t,e)}once(t,e){const r="deref"in e?()=>e.deref():()=>e,i=this.on(t,s=>{r()?.call(null,s),i.remove()});return i}add(t,e){if(_e(this._observable),this._emitBeforeChanges(1))return this;const r=this.getNextIndex(e??null);return this._splice(r,0,[t]),this._emitAfterChanges(1),this}addMany(t,e=this._items.length){if(_e(this._observable),!t?.length)return this;if(this._emitBeforeChanges(1))return this;const r=this.getNextIndex(e);return this._splice(r,0,Mx(t)),this._emitAfterChanges(1),this}at(t){if(_e(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(_e(this._observable),!this.length||this._emitBeforeChanges(2))return[];const t=this._removeAllRaw();return this._emitAfterChanges(2),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return _e(this._observable),this._createNewInstance({items:this._items.map(O)})}concat(...t){_e(this._observable);const e=t.map(Mx);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(_e(this._observable),!this.length||this._emitBeforeChanges(2))return;const r=this._splice(0,this.length),i=r.length;for(let s=0;s<i;s++)t.call(e,r[s],s,r);this._emitAfterChanges(2)}destroyAll(){this.drain(KA)}destroyMany(t){const e=this.removeMany(t);return e.forEach(KA),e}every(t,e){return _e(this._observable),this._items.every(t,e)}filter(t,e){_e(this._observable);const r=arguments.length===2?this._items.filter(t,e):this._items.filter(t);return this._createNewInstance({items:r})}find(t,e){return _e(this._observable),this._items.find(t,e)}findIndex(t,e){return _e(this._observable),this._items.findIndex(t,e)}flatten(t,e){_e(this._observable);const r=[];return z6(r,this,t,e),new La(r)}forEach(t,e){return _e(this._observable),this._items.forEach(t,e)}getItemAt(t){return _e(this._observable),this._items[t]}getNextIndex(t){_e(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return _e(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return _e(this._observable),this._items.indexOf(t,e)}join(t=","){return _e(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return _e(this._observable),this._items.lastIndexOf(t,e)}map(t,e){_e(this._observable);const r=this._items.map(t,e);return new La({items:r})}reorder(t,e=this.length-1){_e(this._observable);const r=this.indexOf(t);if(r!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),r!==e){if(this._emitBeforeChanges(4))return t;this._splice(r,1),this._splice(e,0,[t]),this._emitAfterChanges(4)}return t}}pop(){if(_e(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Tx(this._splice(this.length-1,1));return this._emitAfterChanges(2),t}push(...t){return _e(this._observable),this._emitBeforeChanges(1)||(this._splice(this.length,0,t),this._emitAfterChanges(1)),this.length}reduce(t,e){_e(this._observable);const r=this._items;return arguments.length===2?r.reduce(t,e):r.reduce(t)}reduceRight(t,e){_e(this._observable);const r=this._items;return arguments.length===2?r.reduceRight(t,e):r.reduceRight(t)}remove(t){return _e(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(_e(this._observable),t<0||t>=this.length||this._emitBeforeChanges(2))return;const e=Tx(this._splice(t,1));return this._emitAfterChanges(2),e}removeMany(t){if(_e(this._observable),!t?.length||this._emitBeforeChanges(2))return[];const e=t instanceof La?t.toArray():t,r=this._items,i=[],s=e.length;for(let n=0;n<s;n++){const o=e[n],a=r.indexOf(o);if(a>-1){const l=1+eee(e,r,n+1,a+1),c=this._splice(a,l);c&&c.length>0&&i.push.apply(i,c),n+=l-1}}return this._emitAfterChanges(2),i}reverse(){if(_e(this._observable),this._emitBeforeChanges(4))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(4),this}shift(){if(_e(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Tx(this._splice(0,1));return this._emitAfterChanges(2),t}slice(t=0,e=this.length){return _e(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return _e(this._observable),this._items.some(t,e)}sort(t){if(_e(this._observable),!this.length||this._emitBeforeChanges(4)||!this._requiresSort(t))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(4),this}_requiresSort(t=(e,r)=>e===r?0:e<r?-1:1){const e=this.length-1;for(let r=0;r<e;r++)if(t(this.items[r],this.items[r+1])>0)return!0;return!1}splice(t,e,...r){_e(this._observable),arguments.length===1&&(e=this.length),e??=0;const i=(e?2:0)|(r.length?1:0);if(this._emitBeforeChanges(i))return[];const s=this._splice(t,e,r)||[];return this._emitAfterChanges(i),s}toArray(){return _e(this._observable),this._items.slice()}toJSON(t){return _e(this._observable),this.toArray().map(e=>L0(e)?e.toJSON(t):e)}toLocaleString(){return _e(this._observable),this._items.toLocaleString()}toString(){return _e(this._observable),this._items.toString()}unshift(...t){return _e(this._observable),!t.length||this._emitBeforeChanges(1)||(this._splice(0,0,t),this._emitAfterChanges(1)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,r){const i=this._items,s=this.itemType;let n,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=Vm(()=>this._dispatchChange())),t<0&&(t+=this.length),e){if(o=i.splice(t,e),this.hasEventListener("before-remove")){const a=Gs.acquire();a.target=this,a.cancellable=!0;for(let l=0,c=o.length;l<c;l++)n=o[l],a.reset(n),this.emit("before-remove",a),a.defaultPrevented&&(o.splice(l,1),i.splice(t,0,n),t+=1,l-=1,c-=1);Gs.release(a)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const a=Gs.acquire();a.target=this,a.cancellable=!1;const l=o.length;for(let c=0;c<l;c++)a.reset(o[c]),this.emit("after-remove",a);Gs.release(a)}}if(r?.length){if(s){const d=[];for(const p of r){const m=s.ensureType(p);m==null&&p!=null||d.push(m)}r=d}const a=this.hasEventListener("before-add"),l=this.hasEventListener("after-add"),c=t===this.length;if(a||l){const d=Gs.acquire();d.target=this,d.cancellable=!0;const p=Gs.acquire();p.target=this,p.cancellable=!1;for(const m of r)a?(d.reset(m),this.emit("before-add",d),d.defaultPrevented||(c?i.push(m):i.splice(t++,0,m),this._set("length",i.length),l&&(p.reset(m),this.emit("after-add",p)))):(c?i.push(m):i.splice(t++,0,m),this._set("length",i.length),p.reset(m),this.emit("after-add",p));Gs.release(p),Gs.release(d)}else{if(c)for(const d of r)i.push(d);else i.splice(t,0,...r);this._set("length",i.length)}}if((r?.length||o?.length)&&this._notifyChangeEvent(r,o),this.hasEventListener("after-splice")){const a=new QQ(this,r,o,t,e);this.emit("after-splice",a)}return o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const r=Gs.acquire();r.target=this,r.cancellable=!0,r.type=t,this.emit("before-changes",r),e=r.defaultPrevented,Gs.release(r)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Gs.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Gs.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const r=e.changes;Bl.clear(),Hl.clear(),Wl.clear();for(const{added:l,removed:c}of r){if(l)if(Wl.size===0&&Hl.size===0)for(const d of l)Bl.add(d);else for(const d of l)Hl.has(d)?(Wl.add(d),Hl.delete(d)):Wl.has(d)||Bl.add(d);if(c)if(Wl.size===0&&Bl.size===0)for(const d of c)Hl.add(d);else for(const d of c)Bl.has(d)?Bl.delete(d):(Wl.delete(d),Hl.add(d))}const i=Di.acquire();Bl.forEach(l=>{i.push(l)});const s=Di.acquire();Hl.forEach(l=>{s.push(l)});const n=this._items,o=e.items,a=Di.acquire();if(Wl.forEach(l=>{o.indexOf(l)!==n.indexOf(l)&&a.push(l)}),e.listeners&&(i.length||s.length||a.length)){const l={target:this,added:i,removed:s,moved:a},c=e.listeners.length;for(let d=0;d<c;d++){const p=e.listeners[d];p.removed||p.callback.call(this,l)}}Di.release(i),Di.release(s),Di.release(a)}Bl.clear(),Hl.clear(),Wl.clear()}};u([h()],bu.prototype,"_updating",void 0),u([h()],bu.prototype,"length",void 0),u([h()],bu.prototype,"items",null),u([h({readOnly:!0})],bu.prototype,"updating",null),bu=La=u([E("esri.core.Collection")],bu);const se=bu;function la(t,e,r=se){return e||(e=new r),e===t||e.destroyed||(e.removeAll(),ree(t)?e.addMany(t):t&&e.add(t)),e}function j6(t){return t}function ree(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}let iee=class V6{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const r=new V6;return this._values.forEach((i,s)=>{e&&e.has(s)||r.set(s,O(i.value),i.origin)}),r}get(e,r){r=this._normalizeOrigin(r);const i=this._values.get(e);return r==null||i?.origin===r?i?.value:void 0}originOf(e){return this._values.get(e)?.origin??7}keys(e){e=this._normalizeOrigin(e);const r=[...this._values.keys()];return e==null?r:r.filter(i=>this._values.get(i)?.origin===e)}set(e,r,i){if((i=this._normalizeOrigin(i))===0){const s=this._values.get(e);if(s?.origin!=null&&s.origin>i)return}this._values.set(e,new see(r,i))}delete(e,r){(r=this._normalizeOrigin(r))!=null&&this._values.get(e)?.origin!==r||this._values.delete(e)}has(e,r){return(r=this._normalizeOrigin(r))!=null?this._values.get(e)?.origin===r:this._values.has(e)}isAtOrigin(e,r){return r=this._normalizeOrigin(r),this.has(e,r)&&this.originOf(e)===r}isBelowOrigin(e,r){return r=this._normalizeOrigin(r),!this.has(e)||this.originOf(e)<r}forEach(e){this._values.forEach(({value:r},i)=>e(r,i))}_normalizeOrigin(e){if(e!=null)return e===0?e:7}},see=class{constructor(e,r){this.value=e,this.origin=r}};function U6(t,e,r){e.keys().forEach(s=>{r.set(s,e.get(s),0)});const i=t.metadata;Object.keys(i).forEach(s=>{t.internalGet(s)&&r.set(s,t.internalGet(s),0)})}function nee(t,e,r){if(!t?.read||t.read.enabled===!1||!t.read.source)return!1;const i=t.read.source;if(typeof i=="string"){if(i===e||i.includes(".")&&i.startsWith(e)&&RA(i,r))return!0}else for(const s of i)if(s===e||s.includes(".")&&s.startsWith(e)&&RA(s,r))return!0;return!1}function oee(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function aee(t,e,r,i,s){let n=I1(e[r],s);oee(n)&&(t[r]=!0);for(const o of Object.getOwnPropertyNames(e))n=I1(e[o],s),nee(n,r,i)&&(t[o]=!0)}function lee(t,e,r,i){const s=r.metadata,n=AQ(s[e],i),o=n?.default;if(o===void 0)return;const a=typeof o=="function"?o.call(t,e,i):o;a!==void 0&&r.set(e,a)}const G6={origin:"service"};function q6(t,e,r=G6){if(!e||typeof e!="object")return;const i=Hi(t),s=i.metadata,n={};for(const o of Object.getOwnPropertyNames(e))aee(n,s,o,e,r);i.setDefaultOrigin(r.origin);for(const o of Object.getOwnPropertyNames(n)){const a=I1(s[o],r).read,l=a?.source;let c;c=l&&typeof l=="string"?Mv(e,l):e[o],a?.reader&&(c=a.reader.call(t,c,e,r)),c!==void 0&&i.set(o,c)}if(!r||!r.ignoreDefaults){i.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(s))n[o]||lee(t,o,i,r)}i.setDefaultOrigin("user")}function uee(t,e,r,i=G6){const s={...i,messages:[]};r(s),s.messages?.forEach(n=>{n.type!=="warning"||t.loaded?i?.messages&&i.messages.push(n):t.loadWarnings.push(n)})}function cee(t,e,r,i,s){const n={};return e.write?.writer?.call(t,i,n,r,s),n}function B6(t,e,r,i,s,n){if(!i?.write)return!1;const o=ln(t,r);if(!s&&i.write.overridePolicy){const a=i.write.overridePolicy.call(t,o,r,n??void 0);a!==void 0&&(s=a)}if(s||(s=i.write),!s||s.enabled===!1||s.layerContainerTypes&&n?.layerContainerType&&!s.layerContainerTypes.includes(n.layerContainerType))return!1;if((o===null&&!s.allowNull&&!s.writerEnsuresNonNull||o===void 0)&&s.isRequired){const a=new R("web-document-write:property-required",`Missing value for required property '${r}' on '${t.declaredClass}'`,{propertyName:r,target:t});return a&&n?.messages?n.messages.push(a):a&&!n&&U.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!s.allowNull&&!s.writerEnsuresNonNull||!s.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(r)===0)&&hee(t,r,n,i,o)||!s.ignoreOrigin&&n?.origin&&e.store.multipleOriginsSupported&&e.store.originOf(r)<ml(n.origin))}function hee(t,e,r,i,s){const n=i.default;if(n===void 0)return!1;if(i.defaultEquals!=null)return i.defaultEquals(s);if(typeof n=="function"){if(Array.isArray(s)){const o=n.call(t,e,r??void 0);return DS(o,s)}return!1}return n===s}function dee(t,e,r,i){const s=Hi(t),n=s.metadata,o=P6(n[e],i);return!!o&&B6(t,s,e,o,r,i)}function H6(t,e,r){if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return E_(e,t.toJSON(r));const i=Hi(t),s=i.metadata;for(const n in s){const o=P6(s[n],r);if(!B6(t,i,n,o,void 0,r))continue;const a=ln(t,n),l=cee(t,o,o.write&&typeof o.write.target=="string"?o.write.target:n,a,r);Object.keys(l).length>0&&(e=E_(e,l),r?.resources?.pendingOperations?.length&&r.resources.pendingOperations.push(Promise.all(r.resources.pendingOperations).then(()=>E_(e,l,()=>"replace-arrays"))),r?.writtenProperties&&r.writtenProperties.push({target:t,propName:n,oldOrigin:LK(i.store.originOf(n)),newOrigin:r.origin}))}return e}const fc=t=>{const e=t;let r=class extends e{constructor(...i){super(...i);const s=Hi(this),n=s.store,o=new iee;s.store=o,U6(s,n,o)}read(i,s){q6(this,i,s)}write(i,s){return H6(this,i??{},s)}toJSON(i){return this.write({},i)}static fromJSON(i,s){return pee.call(this,i,s)}};return r=u([E("esri.core.JSONSupport")],r),r.prototype.toJSON.isDefaultToJSON=!0,r};function pee(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const r=new this;return r.read(t,e),r}const W=fc(le);let fee=class{constructor(){this._resolver=ps(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=1,this._cleanUp()},()=>{this._status=2,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===1}isRejected(){return this._status===2}isFulfilled(){return this._status!==0}abort(){this._resolver.reject(it())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=ps(),r=[...this._resolvingPromises,e.promise],i=this._allPromise=Promise.all(r);i.then(()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve()},s=>{this.isFulfilled()||this._allPromise!==i||Ur(s)||this._resolver.reject(s)}),e.resolve()}};const hP=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this._promiseProps=new fee,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(i,s){return this._promiseProps.promise.then(()=>this).then(i,s)}catch(i){return this.when(null,i)}addResolvingPromise(i){i&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in i?i.when():i)}addResolvingTask(i){i&&!this._promiseProps.isFulfilled()&&(this.addHandles(AX(i)),this._promiseProps.addResolvingPromise(i.promise))}};return r=u([E("esri.core.Promise")],r),r},dP=hP(le),mee="not-loaded",yee="loading",gee="failed",QA="loaded",W6=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(s=>{const n=this.load.bind(this);this.load=o=>{const a=new Promise((l,c)=>{const d=JC(o,c);this.destroyed&&c(new R("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(l,c).finally(()=>{d&&d.remove()})});if(this.loadStatus===mee){this._set("loadStatus",yee);const l=this._loadController=new AbortController;n({signal:l.signal})}return s(),a}})),this.when(()=>{this._set("loadStatus",QA),this._loadController=null},s=>{this.destroyed||(this._set("loadStatus",gee),this._set("loadError",s),this._loadController=null)})}destroy(){this._loadController&&(this._loadController=Tl(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===QA}get loadWarnings(){return this._get("loadWarnings")}load(i){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new R("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return u([h({readOnly:!0})],r.prototype,"loaded",null),u([h({readOnly:!0})],r.prototype,"loadError",void 0),u([h({clonable:!1})],r.prototype,"loadStatus",void 0),u([h({type:[zs],readOnly:!0})],r.prototype,"loadWarnings",null),r=u([E("esri.core.Loadable")],r),r},Cv=W6(dP);function ZM(t){return!(!t||!t.load)}function vee(t,e,r){return Ch(t.map((i,s)=>e.apply(r,[i,s])))}async function wee(t,e,r){return(await Ch(t.map((i,s)=>e.apply(r,[i,s])))).map(i=>i.value)}function pP(t){return{ok:!0,value:t}}function fP(t){return{ok:!1,error:t}}function _ee(t){return t!=null&&t.ok===!0?t.value:null}function bee(t){return t!=null&&t.ok===!1?t.error:null}async function QS(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return pP(await t)}catch(e){return fP(e)}}async function See(t){try{return pP(await t)}catch(e){return Po(e),fP(e)}}function Pv(t,e){return new nu(t,e)}let nu=class extends le{get value(){return _ee(this._result)}get error(){return bee(this._result)}get finished(){return this._result!=null}constructor(e,r){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=Tl(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:i}=this._abortController;this.promise=e(i),this.promise.then(s=>{this._result=pP(s),this._cleanup()},s=>{this._result=fP(s),this._cleanup()}),this._abortHandle=mn(r,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=yt(this._abortHandle),this._abortController=null}};u([h()],nu.prototype,"value",null),u([h()],nu.prototype,"error",null),u([h()],nu.prototype,"finished",null),u([h()],nu.prototype,"promise",void 0),u([h()],nu.prototype,"_result",void 0),nu=u([E("esri.core.asyncUtils.ReactiveTask")],nu);async function Z6(t,e){return await t.load(),xee(t,e)}async function xee(t,e){const r=[],i=(...n)=>{for(const o of n)o!=null&&(Array.isArray(o)?i(...o):se.isCollection(o)?o.forEach(a=>i(a)):ZM(o)&&r.push(o))};e(i);let s=null;if(await wee(r,async n=>{const o=await QS($ee(n)?n.loadAll():n.load());o.ok!==!1||s||(s=o)}),s)throw s.error;return t}function $ee(t){return"loadAll"in t&&typeof t.loadAll=="function"}function te(t,e,r){let i,s;return e===void 0?(s=t,i=[void 0]):typeof e!="string"?(s=t,i=[void 0],r=e):(s=e,i=Array.isArray(t)?t:[t]),(n,o)=>{const a=n.constructor.prototype;for(const l of i){const c=oP(n,l,s);c.write&&typeof c.write=="object"||(c.write={}),r&&(c.write.target=r),c.write.writer=a[o]}}}let Ne=class{constructor(e,r={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=r,this.apiValues=[],this.jsonValues=[],this._apiToJSON=Mee(e),this.apiValues=eR(this._apiToJSON),this.jsonValues=eR(this._jsonToAPI),this.read=i=>this.fromJSON(i),this.write=(i,s,n)=>{const o=this.toJSON(i);o!==void 0&&Ir(n,o,s)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const r=this._apiToJSON[e];return this._options.useNumericKeys?+r:r}return this._options.ignoreUnknown?null:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function Mee(t){const e={};for(const r in t)e[t[r]]=r;return e}function eR(t){const e=[];for(const r in t)e.push(r);return e.sort(),e}function yr(){return function(t,e){return new Ne(t,{ignoreUnknown:!0,...e})}}let mP=class{constructor(e,r,i,s,n,o){this.semiMajorAxis=e,this.flattening=r,this.outerAtmosphereRimWidth=i,this.atmosphereHeight=s,this.scaleHeight=n;const a=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*a,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=o||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const Vt=new mP(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),ua=new mP(3396190,1/169.8944472236118,23e4,6e4,.111),tc=new mP(1737400,0,0,0,0);function St(t){if(!De.assetsPath)throw U.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new R("assets:path-not-set","config.assetsPath is not set");return ed(De.assetsPath,t)}let Ex,D=null;function J6(){return!!D}function Tee(){return!!z("esri-wasm")}function Iee(){return Ex||(Ex=q(async()=>{const{default:t}=await import("./pe-wasm-B87Q3u4k.js");return{default:t}},[]).then(({default:t})=>t({locateFile:e=>St(`esri/geometry/support/${e}`)})).then(t=>{tj(t)}),Ex)}const A_={geogToProj(t,e,r){D.ensureCache.prepare();const i=sd(r),s=r===i,n=D.ensureFloat64(i),o=D._pe_geog_to_proj(D.getPointer(t),e,n);return o&&rc(r,e,n,s),o},projGeog(t,e,r,i){switch(i){case Dt.PE_TRANSFORM_P_TO_G:return A_.projToGeog(t,e,r);case Dt.PE_TRANSFORM_G_TO_P:return A_.geogToProj(t,e,r)}return 0},projToGeog:(t,e,r)=>A_.projToGeogCenter(t,e,r,0),projToGeogCenter(t,e,r,i){D.ensureCache.prepare();const s=sd(r),n=r===s,o=D.ensureFloat64(s),a=D._pe_proj_to_geog_center(D.getPointer(t),e,o,i);return a&&rc(r,e,o,n),a}};let Dt=class We{static init(){We.PE_BUFFER_MAX=D.PeDefs.prototype.PE_BUFFER_MAX,We.PE_NAME_MAX=D.PeDefs.prototype.PE_NAME_MAX,We.PE_MGRS_MAX=D.PeDefs.prototype.PE_MGRS_MAX,We.PE_USNG_MAX=D.PeDefs.prototype.PE_USNG_MAX,We.PE_DD_MAX=D.PeDefs.prototype.PE_DD_MAX,We.PE_DDM_MAX=D.PeDefs.prototype.PE_DDM_MAX,We.PE_DMS_MAX=D.PeDefs.prototype.PE_DMS_MAX,We.PE_UTM_MAX=D.PeDefs.prototype.PE_UTM_MAX,We.PE_PARM_MAX=D.PeDefs.prototype.PE_PARM_MAX,We.PE_TYPE_NONE=D.PeDefs.prototype.PE_TYPE_NONE,We.PE_TYPE_GEOGCS=D.PeDefs.prototype.PE_TYPE_GEOGCS,We.PE_TYPE_PROJCS=D.PeDefs.prototype.PE_TYPE_PROJCS,We.PE_TYPE_GEOGTRAN=D.PeDefs.prototype.PE_TYPE_GEOGTRAN,We.PE_TYPE_COORDSYS=D.PeDefs.prototype.PE_TYPE_COORDSYS,We.PE_TYPE_UNIT=D.PeDefs.prototype.PE_TYPE_UNIT,We.PE_TYPE_LINUNIT=D.PeDefs.prototype.PE_TYPE_LINUNIT,We.PE_STR_OPTS_NONE=D.PeDefs.prototype.PE_STR_OPTS_NONE,We.PE_STR_AUTH_NONE=D.PeDefs.prototype.PE_STR_AUTH_NONE,We.PE_STR_AUTH_TOP=D.PeDefs.prototype.PE_STR_AUTH_TOP,We.PE_STR_NAME_CANON=D.PeDefs.prototype.PE_STR_NAME_CANON,We.PE_STR_FMT_WKT=D.PeDefs.prototype.PE_STR_FMT_WKT,We.PE_STR_FMT_WKT2=D.PeDefs.prototype.PE_STR_FMT_WKT2,We.PE_PARM_X0=D.PeDefs.prototype.PE_PARM_X0,We.PE_PARM_ND=D.PeDefs.prototype.PE_PARM_ND,We.PE_TRANSFORM_1_TO_2=D.PeDefs.prototype.PE_TRANSFORM_1_TO_2,We.PE_TRANSFORM_2_TO_1=D.PeDefs.prototype.PE_TRANSFORM_2_TO_1,We.PE_TRANSFORM_P_TO_G=D.PeDefs.prototype.PE_TRANSFORM_P_TO_G,We.PE_TRANSFORM_G_TO_P=D.PeDefs.prototype.PE_TRANSFORM_G_TO_P,We.PE_HORIZON_RECT=D.PeDefs.prototype.PE_HORIZON_RECT,We.PE_HORIZON_POLY=D.PeDefs.prototype.PE_HORIZON_POLY,We.PE_HORIZON_LINE=D.PeDefs.prototype.PE_HORIZON_LINE,We.PE_HORIZON_DELTA=D.PeDefs.prototype.PE_HORIZON_DELTA}},Y6=null;const tR={},rR={},iR=t=>{const e=t.getType();switch(e){case Dt.PE_TYPE_GEOGCS:t=D.castObject(t,D.PeGeogcs);break;case Dt.PE_TYPE_PROJCS:t=D.castObject(t,D.PeProjcs);break;case Dt.PE_TYPE_GEOGTRAN:t=D.castObject(t,D.PeGeogtran);break;default:e&Dt.PE_TYPE_UNIT&&(t=D.castObject(t,D.PeUnit))}return t},sp={initialize(){D.PeFactory.prototype.initialize(null)},coordsys:t=>sp.factoryByType(Dt.PE_TYPE_COORDSYS,t),factoryByType(t,e){let r=null,i=tR[t];if(i||(i={},tR[t]=i),i.hasOwnProperty(String(e))&&(r=i[e],D.compare(r,D.NULL)&&(r=null)),!r){const s=D.PeFactory.prototype.factoryByType(t,e);D.compare(s,D.NULL)||(r=iR(s),i[e]=r)}return r},fromString(t,e){let r=null,i=rR[t];if(i||(i={},rR[t]=i),i.hasOwnProperty(e)&&(r=i[e],D.compare(r,D.NULL)&&(r=null)),!r){const s=D.PeFactory.prototype.fromString(t,e);D.compare(s,D.NULL)||(r=iR(s),i[e]=r)}return r},geogcs:t=>sp.factoryByType(Dt.PE_TYPE_GEOGCS,t),geogtran:t=>sp.factoryByType(Dt.PE_TYPE_GEOGTRAN,t),getCode:t=>D.PeFactory.prototype.getCode(t),projcs:t=>sp.factoryByType(Dt.PE_TYPE_PROJCS,t),unit:t=>sp.factoryByType(Dt.PE_TYPE_UNIT,t)};let sR,X6=null;const yP={PE_GTLIST_OPTS_COMMON:0,init(){yP.PE_GTLIST_OPTS_COMMON=D.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,sR=D._pe_getPeGTlistExtendedEntrySize()},getGTlist(t,e,r,i,s,n){let o=null;const a=new D.PeInteger(n);try{const l=D.PeGTlistExtended.prototype.getGTlist(t,e,r,i,s,a);if((n=a.val)&&(o=[l],n>1)){const c=D.getPointer(l);for(let d=1;d<n;d++)o.push(D.wrapPointer(c+sR*d,D.PeGTlistExtendedEntry))}}finally{D.destroy(a)}return o}},Eee={destroy(t){if(t?.length){for(const e of t)Dn(e),e.getEntries().forEach(r=>{Dn(r);const i=r.getGeogtran();Dn(i),i.getParameters().forEach(Dn),[i.getGeogcs1(),i.getGeogcs2()].forEach(s=>{Dn(s);const n=s.getDatum();Dn(n),Dn(n.getSpheroid()),Dn(s.getPrimem()),Dn(s.getUnit())})});D.PeGTlistExtendedEntry.prototype.Delete(t[0])}}},Cee={geogToGeog(t,e,r,i,s){D.ensureCache.prepare();const n=sd(r),o=r===n,a=D.ensureFloat64(n);let l=0;i&&(l=D.ensureFloat64(i));const c=D._pe_geog_to_geog(D.getPointer(t),e,a,l,s);return c&&rc(r,e,a,o),c}},Pee={geodesicCoordinate(t,e,r,i,s,n,o,a){D.PeLineType.prototype.geodesic_coordinate(t,e,r,i,s,n,o,a)},geodeticCoordinate(t,e,r,i,s,n,o,a,l){D.PeLineType.prototype.geodetic_coordinate(t,e,r,i,s,n,o,a,l)},geodeticDistance(t,e,r,i,s,n,o,a,l,c){D.PeLineType.prototype.geodetic_distance(t,e,r,i,s,n,o,a,l,c)},greatEllipticDistance(t,e,r,i,s,n,o,a,l){D.PeLineType.prototype.great_elliptic_distance(t,e,r,i,s,n,o,a,l)}},kee={phiToEta:(t,e)=>D.PeMath.prototype.phi_to_eta(t,e),etaToPhi:(t,e)=>D.PeMath.prototype.eta_to_phi(t,e),phiToPhig:(t,e)=>D.PeMath.prototype.phi_to_phig(t,e),q:(t,e,r)=>D.PeMath.prototype.q(t,e,r),q90:(t,e)=>D.PeMath.prototype.q90(t,e)},Cx=(t,e,r,i,s,n)=>{let o,a;switch(D.ensureCache.prepare(),t){case"dd":o=D._pe_geog_to_dd,a=Dt.PE_DD_MAX;break;case"ddm":o=D._pe_geog_to_ddm,a=Dt.PE_DDM_MAX;break;case"dms":o=D._pe_geog_to_dms,a=Dt.PE_DMS_MAX}let l=0;e&&(l=D.getPointer(e));const c=sd(i),d=D.ensureFloat64(c),p=e2(r,a),m=o(l,r,d,s,D.ensureInt32(p));if(m)for(let y=0;y<r;y++)n[y]=D.UTF8ToString(p[y]);return m},Px=(t,e,r,i,s)=>{let n;switch(D.ensureCache.prepare(),t){case"dd":n=D._pe_dd_to_geog;break;case"ddm":n=D._pe_ddm_to_geog;break;case"dms":n=D._pe_dms_to_geog}let o=0;e&&(o=D.getPointer(e));const a=i.map(p=>D.ensureString(p)),l=D.ensureInt32(a),c=D.ensureFloat64(new Array(2*r)),d=n(o,r,l,c);return d&&rc(s,r,c),d},Lee={geogToDms:(t,e,r,i,s)=>Cx("dms",t,e,r,i,s),dmsToGeog:(t,e,r,i)=>Px("dms",t,e,r,i),geogToDdm:(t,e,r,i,s)=>Cx("ddm",t,e,r,i,s),ddmToGeog:(t,e,r,i)=>Px("ddm",t,e,r,i),geogToDd:(t,e,r,i,s)=>Cx("dd",t,e,r,i,s),ddToGeog:(t,e,r,i)=>Px("dd",t,e,r,i)};let K6=class np{static init(){np.PE_MGRS_STYLE_NEW=D.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,np.PE_MGRS_STYLE_OLD=D.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,np.PE_MGRS_STYLE_AUTO=D.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,np.PE_MGRS_180_ZONE_1_PLUS=D.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,np.PE_MGRS_ADD_SPACES=D.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}static geogToMgrsExtended(e,r,i,s,n,o,a){D.ensureCache.prepare();let l=0;e&&(l=D.getPointer(e));const c=sd(i),d=D.ensureFloat64(c),p=e2(r,Dt.PE_MGRS_MAX),m=D.ensureInt32(p),y=D._pe_geog_to_mgrs_extended(l,r,d,s,n,o,m);if(y)for(let g=0;g<r;g++)a[g]=D.UTF8ToString(p[g]);return y}static mgrsToGeogExtended(e,r,i,s,n){D.ensureCache.prepare();let o=0;e&&(o=D.getPointer(e));const a=i.map(p=>D.ensureString(p)),l=D.ensureInt32(a),c=D.ensureFloat64(new Array(2*r)),d=D._pe_mgrs_to_geog_extended(o,r,l,s,c);return d&&rc(n,r,c),d}};const Aee={geogToUsng(t,e,r,i,s,n,o){D.ensureCache.prepare();let a=0;t&&(a=D.getPointer(t));const l=sd(r),c=D.ensureFloat64(l),d=e2(e,Dt.PE_MGRS_MAX),p=D.ensureInt32(d),m=D._pe_geog_to_usng(a,e,c,i,s,n,p);if(m)for(let y=0;y<e;y++)o[y]=D.UTF8ToString(d[y]);return m},usngToGeog(t,e,r,i){D.ensureCache.prepare();let s=0;t&&(s=D.getPointer(t));const n=r.map(c=>D.ensureString(c)),o=D.ensureInt32(n),a=D.ensureFloat64(new Array(2*e)),l=D._pe_usng_to_geog(s,e,o,a);return l&&rc(i,e,a),l}};let Q6=class R_{static init(){R_.PE_UTM_OPTS_NONE=D.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,R_.PE_UTM_OPTS_ADD_SPACES=D.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,R_.PE_UTM_OPTS_NS=D.PeNotationUtm.prototype.PE_UTM_OPTS_NS}static geogToUtm(e,r,i,s,n){D.ensureCache.prepare();let o=0;e&&(o=D.getPointer(e));const a=sd(i),l=D.ensureFloat64(a),c=e2(r,Dt.PE_UTM_MAX),d=D.ensureInt32(c),p=D._pe_geog_to_utm(o,r,l,s,d);if(p)for(let m=0;m<r;m++)n[m]=D.UTF8ToString(c[m]);return p}static utmToGeog(e,r,i,s,n){D.ensureCache.prepare();let o=0;e&&(o=D.getPointer(e));const a=i.map(p=>D.ensureString(p)),l=D.ensureInt32(a),c=D.ensureFloat64(new Array(2*r)),d=D._pe_utm_to_geog(o,r,l,s,c);return d&&rc(n,r,c),d}};var os;let ej=(os=class{static init(){os.PE_PCSINFO_OPTION_NONE=D.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,os.PE_PCSINFO_OPTION_DOMAIN=D.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,os.PE_POLE_OUTSIDE_BOUNDARY=D.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,os.PE_POLE_POINT=D.PePCSInfo.prototype.PE_POLE_POINT}static generate(e,r=os.PE_PCSINFO_OPTION_DOMAIN){let i=null,s=null;return os.cache.has(e)&&(s=os.cache.get(e),s[r]&&(i=s[r])),i||(i=D.PePCSInfo.prototype.generate(e,r),s||(s=[],os.cache.set(e,s)),s[r]=i),i}},os.cache=new Map,os);const Ree={versionString:()=>D.PeVersion.prototype.version_string()};function tj(t){function e(n,o,a){n[o]=a(n[o])}D=t,Dt.init(),yP.init(),K6.init(),Q6.init(),ej.init(),Y6=class extends D.PeDouble{constructor(n=NaN){super(n)}destroy(){D.destroy(this)}[Symbol.dispose](){this.destroy()}},X6=class extends D.PeGCSExtent{destroy(){D.destroy(this)}[Symbol.dispose](){this.destroy()}};const r=[D.PeAngunit,D.PeDatum,D.PeGeogcs,D.PeGeogtran,D.PeObject,D.PeParameter,D.PePrimem,D.PeProjcs,D.PeSpheroid,D.PeUnit];for(const n of r)e(n.prototype,"getName",o=>function(){return o.call(this,new Array(Dt.PE_NAME_MAX))});for(const n of[D.PeGeogtran,D.PeProjcs])e(n.prototype,"getParameters",o=>function(){const a=new Array(Dt.PE_PARM_MAX);let l=o.call(this);for(let c=0;c<a.length;c++){const d=D.getValue(l,"*");a[c]=d?D.wrapPointer(d,D.PeParameter):null,l+=Int32Array.BYTES_PER_ELEMENT}return a});e(D.PeHorizon.prototype,"getCoord",n=>function(o=!1){const a=this.getSize();if(!a)return null;const l=[];return rc(l,a,n.call(this),o),l}),e(D.PeGTlistExtendedEntry.prototype,"getEntries",n=>{const o=D._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const l=n.call(this);if(!D.compare(l,D.NULL)){a=[l];const c=this.getSteps();if(c>1){const d=D.getPointer(l);for(let p=1;p<c;p++)a.push(D.wrapPointer(d+o*p,D.PeGTlistExtendedGTs))}}return a}});const i=D._pe_getPeHorizonSize(),s=n=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(n))return o.get(n);let a=null;const l=n.call(this);if(!D.compare(l,D.NULL)){a=[l];const c=l.getNump();if(c>1){const d=D.getPointer(l);for(let p=1;p<c;p++)a.push(D.wrapPointer(d+i*p,D.PeHorizon))}}return o.set(n,a),a};e(D.PeProjcs.prototype,"horizonGcsGenerate",s),e(D.PeProjcs.prototype,"horizonPcsGenerate",s),D.PeObject.prototype.toString=function(n=Dt.PE_STR_OPTS_NONE){D.ensureCache.prepare();const o=D.getPointer(this),a=D.ensureInt8(new Array(Dt.PE_BUFFER_MAX));return D.UTF8ToString(D._pe_object_to_string_ext(o,n,a))},D.PeGeogcs.prototype.destroy=function(){this.Delete(),Dn(this),this.ptr=0},D.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},D.PeProjcs.prototype.destroy=function(){this.Delete(),Dn(this),this.ptr=0},D.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function Dn(t){if(!t)return;const e=D.getClass(t);if(!e)return;const r=D.getCache(e);if(!r)return;const i=D.getPointer(t);i&&delete r[i]}function e2(t,e){const r=[],i=new Array(e);for(let s=0;s<t;s++)r.push(D.ensureInt8(i));return r}function sd(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function rc(t,e,r,i=!1){if(i)for(let s=0;s<2*e;s++)t[s]=D.getValue(r+s*Float64Array.BYTES_PER_ELEMENT,"double");else{const s=t.length===0;for(let n=0;n<e;n++)s&&(t[n]=new Array(2)),t[n][0]=D.getValue(r,"double"),t[n][1]=D.getValue(r+Float64Array.BYTES_PER_ELEMENT,"double"),r+=2*Float64Array.BYTES_PER_ELEMENT}}const OOe=Object.freeze(Object.defineProperty({__proto__:null,PeCSTransformations:A_,PeDefs:Dt,get PeDouble(){return Y6},PeFactory:sp,get PeGCSExtent(){return X6},PeGTTransformations:Cee,PeGTlistExtended:yP,PeGTlistExtendedEntry:Eee,PeLineType:Pee,PeMath:kee,PeNotationDms:Lee,PeNotationMgrs:K6,PeNotationUsng:Aee,PeNotationUtm:Q6,PePCSInfo:ej,PeVersion:Ree,_init:tj,get _pe(){return D},isLoaded:J6,isSupported:Tee,load:Iee},Symbol.toStringTag,{value:"Module"}));let f;const I={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,10592:0,10594:0,10596:0,10598:0,10601:0,10603:0,10626:0,10632:0,10641:0,10665:0,10674:0,10744:0,10745:0,10759:0,10773:0,10802:0,10820:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,65061:2,65062:2,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1,103978:2,103979:0,103980:2,103981:0};for(f=2e3;f<=2045;f++)I[f]=0;for(f=2056;f<=2065;f++)I[f]=0;for(f=2067;f<=2135;f++)I[f]=0;for(f=2137;f<=2154;f++)I[f]=0;for(f=2161;f<=2170;f++)I[f]=0;for(f=2172;f<=2193;f++)I[f]=0;for(f=2195;f<=2198;f++)I[f]=0;for(f=2200;f<=2203;f++)I[f]=0;for(f=2205;f<=2217;f++)I[f]=0;for(f=2222;f<=2224;f++)I[f]=1;for(f=2225;f<=2250;f++)I[f]=2;for(f=2251;f<=2253;f++)I[f]=1;for(f=2257;f<=2264;f++)I[f]=2;for(f=2274;f<=2279;f++)I[f]=2;for(f=2280;f<=2282;f++)I[f]=1;for(f=2283;f<=2289;f++)I[f]=2;for(f=2290;f<=2292;f++)I[f]=0;for(f=2308;f<=2313;f++)I[f]=0;for(f=2315;f<=2491;f++)I[f]=0;for(f=2494;f<=2866;f++)I[f]=0;for(f=2867;f<=2869;f++)I[f]=1;for(f=2870;f<=2888;f++)I[f]=2;for(f=2891;f<=2895;f++)I[f]=2;for(f=2896;f<=2898;f++)I[f]=1;for(f=2902;f<=2908;f++)I[f]=2;for(f=2915;f<=2920;f++)I[f]=2;for(f=2921;f<=2923;f++)I[f]=1;for(f=2924;f<=2930;f++)I[f]=2;for(f=2931;f<=2962;f++)I[f]=0;for(f=2964;f<=2968;f++)I[f]=2;for(f=2969;f<=2973;f++)I[f]=0;for(f=2975;f<=2991;f++)I[f]=0;for(f=2995;f<=3051;f++)I[f]=0;for(f=3054;f<=3079;f++)I[f]=0;for(f=3081;f<=3088;f++)I[f]=0;for(f=3092;f<=3101;f++)I[f]=0;for(f=3106;f<=3138;f++)I[f]=0;for(f=3146;f<=3151;f++)I[f]=0;for(f=3153;f<=3166;f++)I[f]=0;for(f=3168;f<=3172;f++)I[f]=0;for(f=3174;f<=3203;f++)I[f]=0;for(f=3294;f<=3358;f++)I[f]=0;for(f=3367;f<=3403;f++)I[f]=0;for(f=3408;f<=3416;f++)I[f]=0;for(f=3417;f<=3438;f++)I[f]=2;for(f=3441;f<=3446;f++)I[f]=2;for(f=3447;f<=3450;f++)I[f]=0;for(f=3451;f<=3459;f++)I[f]=2;for(f=3460;f<=3478;f++)I[f]=0;for(f=3554;f<=3559;f++)I[f]=0;for(f=3560;f<=3570;f++)I[f]=2;for(f=3571;f<=3581;f++)I[f]=0;for(f=3594;f<=3597;f++)I[f]=0;for(f=3601;f<=3604;f++)I[f]=0;for(f=3637;f<=3639;f++)I[f]=0;for(f=3665;f<=3667;f++)I[f]=0;for(f=3693;f<=3695;f++)I[f]=0;for(f=3701;f<=3727;f++)I[f]=0;for(f=3728;f<=3739;f++)I[f]=2;for(f=3740;f<=3751;f++)I[f]=0;for(f=3753;f<=3760;f++)I[f]=2;for(f=3761;f<=3773;f++)I[f]=0;for(f=3775;f<=3777;f++)I[f]=0;for(f=3779;f<=3781;f++)I[f]=0;for(f=3783;f<=3785;f++)I[f]=0;for(f=3788;f<=3791;f++)I[f]=0;for(f=3797;f<=3802;f++)I[f]=0;for(f=3814;f<=3816;f++)I[f]=0;for(f=3825;f<=3829;f++)I[f]=0;for(f=3832;f<=3841;f++)I[f]=0;for(f=3844;f<=3852;f++)I[f]=0;for(f=3873;f<=3885;f++)I[f]=0;for(f=3890;f<=3893;f++)I[f]=0;for(f=3907;f<=3912;f++)I[f]=0;for(f=3942;f<=3950;f++)I[f]=0;for(f=3968;f<=3970;f++)I[f]=0;for(f=3973;f<=3976;f++)I[f]=0;for(f=3986;f<=3989;f++)I[f]=0;for(f=3994;f<=3997;f++)I[f]=0;for(f=4048;f<=4051;f++)I[f]=0;for(f=4056;f<=4063;f++)I[f]=0;for(f=4093;f<=4096;f++)I[f]=0;for(f=4390;f<=4398;f++)I[f]=0;for(f=4399;f<=4413;f++)I[f]=2;for(f=4418;f<=4433;f++)I[f]=2;for(f=4455;f<=4457;f++)I[f]=2;for(f=4484;f<=4489;f++)I[f]=0;for(f=4491;f<=4554;f++)I[f]=0;for(f=4568;f<=4589;f++)I[f]=0;for(f=4652;f<=4656;f++)I[f]=0;for(f=4766;f<=4800;f++)I[f]=0;for(f=5014;f<=5016;f++)I[f]=0;for(f=5069;f<=5072;f++)I[f]=0;for(f=5105;f<=5130;f++)I[f]=0;for(f=5167;f<=5188;f++)I[f]=0;for(f=5253;f<=5259;f++)I[f]=0;for(f=5269;f<=5275;f++)I[f]=0;for(f=5292;f<=5311;f++)I[f]=0;for(f=5329;f<=5331;f++)I[f]=0;for(f=5343;f<=5349;f++)I[f]=0;for(f=5355;f<=5357;f++)I[f]=0;for(f=5387;f<=5389;f++)I[f]=0;for(f=5459;f<=5463;f++)I[f]=0;for(f=5479;f<=5482;f++)I[f]=0;for(f=5518;f<=5520;f++)I[f]=0;for(f=5530;f<=5539;f++)I[f]=0;for(f=5550;f<=5552;f++)I[f]=0;for(f=5562;f<=5583;f++)I[f]=0;for(f=5623;f<=5625;f++)I[f]=2;for(f=5631;f<=5639;f++)I[f]=0;for(f=5649;f<=5653;f++)I[f]=0;for(f=5663;f<=5680;f++)I[f]=0;for(f=5682;f<=5685;f++)I[f]=0;for(f=5875;f<=5877;f++)I[f]=0;for(f=5896;f<=5899;f++)I[f]=0;for(f=5921;f<=5940;f++)I[f]=0;for(f=6050;f<=6125;f++)I[f]=0;for(f=6244;f<=6275;f++)I[f]=0;for(f=6328;f<=6348;f++)I[f]=0;for(f=6350;f<=6356;f++)I[f]=0;for(f=6366;f<=6372;f++)I[f]=0;for(f=6381;f<=6387;f++)I[f]=0;for(f=6393;f<=6404;f++)I[f]=0;for(f=6480;f<=6483;f++)I[f]=0;for(f=6511;f<=6514;f++)I[f]=0;for(f=6579;f<=6581;f++)I[f]=0;for(f=6619;f<=6624;f++)I[f]=0;for(f=6625;f<=6627;f++)I[f]=2;for(f=6628;f<=6632;f++)I[f]=0;for(f=6634;f<=6637;f++)I[f]=0;for(f=6669;f<=6692;f++)I[f]=0;for(f=6707;f<=6709;f++)I[f]=0;for(f=6720;f<=6723;f++)I[f]=0;for(f=6732;f<=6738;f++)I[f]=0;for(f=6931;f<=6933;f++)I[f]=0;for(f=6956;f<=6959;f++)I[f]=0;for(f=7005;f<=7007;f++)I[f]=0;for(f=7057;f<=7070;f++)I[f]=2;for(f=7074;f<=7082;f++)I[f]=0;for(f=7109;f<=7118;f++)I[f]=0;for(f=7119;f<=7127;f++)I[f]=1;for(f=7374;f<=7376;f++)I[f]=0;for(f=7528;f<=7586;f++)I[f]=0;for(f=7587;f<=7645;f++)I[f]=2;for(f=7692;f<=7696;f++)I[f]=0;for(f=7755;f<=7787;f++)I[f]=0;for(f=7791;f<=7795;f++)I[f]=0;for(f=7799;f<=7801;f++)I[f]=0;for(f=7803;f<=7805;f++)I[f]=0;for(f=7825;f<=7831;f++)I[f]=0;for(f=7845;f<=7859;f++)I[f]=0;for(f=8013;f<=8032;f++)I[f]=0;for(f=8065;f<=8068;f++)I[f]=1;for(f=8518;f<=8529;f++)I[f]=2;for(f=8533;f<=8536;f++)I[f]=2;for(f=8538;f<=8540;f++)I[f]=2;for(f=8677;f<=8679;f++)I[f]=0;for(f=8836;f<=8840;f++)I[f]=0;for(f=8857;f<=8859;f++)I[f]=0;for(f=8908;f<=8910;f++)I[f]=0;for(f=9154;f<=9159;f++)I[f]=0;for(f=9205;f<=9218;f++)I[f]=0;for(f=9271;f<=9273;f++)I[f]=0;for(f=9295;f<=9297;f++)I[f]=0;for(f=9356;f<=9360;f++)I[f]=0;for(f=9404;f<=9407;f++)I[f]=0;for(f=9476;f<=9482;f++)I[f]=0;for(f=9487;f<=9494;f++)I[f]=0;for(f=9697;f<=9699;f++)I[f]=0;for(f=9821;f<=9865;f++)I[f]=0;for(f=10285;f<=10291;f++)I[f]=0;for(f=10314;f<=10317;f++)I[f]=0;for(f=10448;f<=10465;f++)I[f]=0;for(f=10726;f<=10729;f++)I[f]=0;for(f=10731;f<=10733;f++)I[f]=0;for(f=11114;f<=11118;f++)I[f]=0;for(f=20004;f<=20032;f++)I[f]=0;for(f=20047;f<=20049;f++)I[f]=0;for(f=20062;f<=20092;f++)I[f]=0;for(f=20135;f<=20138;f++)I[f]=0;for(f=20248;f<=20258;f++)I[f]=0;for(f=20348;f<=20358;f++)I[f]=0;for(f=20436;f<=20440;f++)I[f]=0;for(f=20822;f<=20824;f++)I[f]=0;for(f=20904;f<=20932;f++)I[f]=0;for(f=20934;f<=20936;f++)I[f]=0;for(f=21004;f<=21032;f++)I[f]=0;for(f=21035;f<=21037;f++)I[f]=0;for(f=21095;f<=21097;f++)I[f]=0;for(f=21148;f<=21150;f++)I[f]=0;for(f=21207;f<=21264;f++)I[f]=0;for(f=21307;f<=21364;f++)I[f]=0;for(f=21413;f<=21423;f++)I[f]=0;for(f=21453;f<=21463;f++)I[f]=0;for(f=21473;f<=21483;f++)I[f]=0;for(f=21780;f<=21782;f++)I[f]=0;for(f=21891;f<=21894;f++)I[f]=0;for(f=21896;f<=21899;f++)I[f]=0;for(f=22171;f<=22177;f++)I[f]=0;for(f=22181;f<=22187;f++)I[f]=0;for(f=22191;f<=22197;f++)I[f]=0;for(f=22207;f<=22222;f++)I[f]=0;for(f=22229;f<=22232;f++)I[f]=0;for(f=22234;f<=22236;f++)I[f]=0;for(f=22243;f<=22250;f++)I[f]=0;for(f=22262;f<=22265;f++)I[f]=0;for(f=22307;f<=22322;f++)I[f]=0;for(f=22348;f<=22357;f++)I[f]=0;for(f=22407;f<=22422;f++)I[f]=0;for(f=22462;f<=22465;f++)I[f]=0;for(f=22521;f<=22525;f++)I[f]=0;for(f=22607;f<=22622;f++)I[f]=0;for(f=22641;f<=22646;f++)I[f]=0;for(f=22648;f<=22657;f++)I[f]=0;for(f=22707;f<=22722;f++)I[f]=0;for(f=22762;f<=22765;f++)I[f]=0;for(f=22807;f<=22822;f++)I[f]=0;for(f=22991;f<=22994;f++)I[f]=0;for(f=23028;f<=23038;f++)I[f]=0;for(f=23301;f<=23333;f++)I[f]=2;for(f=23830;f<=23853;f++)I[f]=0;for(f=23866;f<=23872;f++)I[f]=0;for(f=23877;f<=23884;f++)I[f]=0;for(f=23886;f<=23894;f++)I[f]=0;for(f=23946;f<=23948;f++)I[f]=0;for(f=24311;f<=24313;f++)I[f]=0;for(f=24342;f<=24347;f++)I[f]=0;for(f=24370;f<=24374;f++)I[f]=10;for(f=24375;f<=24381;f++)I[f]=0;for(f=24718;f<=24721;f++)I[f]=0;for(f=24817;f<=24821;f++)I[f]=0;for(f=24877;f<=24882;f++)I[f]=0;for(f=24891;f<=24893;f++)I[f]=0;for(f=25391;f<=25395;f++)I[f]=0;for(f=25828;f<=25838;f++)I[f]=0;for(f=26191;f<=26195;f++)I[f]=0;for(f=26391;f<=26393;f++)I[f]=0;for(f=26701;f<=26722;f++)I[f]=0;for(f=26729;f<=26799;f++)I[f]=2;for(f=26801;f<=26803;f++)I[f]=2;for(f=26811;f<=26813;f++)I[f]=2;for(f=26847;f<=26870;f++)I[f]=2;for(f=26891;f<=26899;f++)I[f]=0;for(f=26901;f<=26923;f++)I[f]=0;for(f=26929;f<=26946;f++)I[f]=0;for(f=26948;f<=26998;f++)I[f]=0;for(f=27037;f<=27040;f++)I[f]=0;for(f=27205;f<=27232;f++)I[f]=0;for(f=27258;f<=27260;f++)I[f]=0;for(f=27391;f<=27398;f++)I[f]=0;for(f=27561;f<=27564;f++)I[f]=0;for(f=27571;f<=27574;f++)I[f]=0;for(f=27581;f<=27584;f++)I[f]=0;for(f=27591;f<=27594;f++)I[f]=0;for(f=27700;f<=27707;f++)I[f]=0;for(f=28191;f<=28193;f++)I[f]=0;for(f=28348;f<=28358;f++)I[f]=0;for(f=28402;f<=28432;f++)I[f]=0;for(f=28462;f<=28492;f++)I[f]=0;for(f=29118;f<=29122;f++)I[f]=0;for(f=29168;f<=29172;f++)I[f]=0;for(f=29177;f<=29185;f++)I[f]=0;for(f=29187;f<=29195;f++)I[f]=0;for(f=29900;f<=29903;f++)I[f]=0;for(f=30161;f<=30179;f++)I[f]=0;for(f=30491;f<=30494;f++)I[f]=0;for(f=30729;f<=30732;f++)I[f]=0;for(f=31251;f<=31259;f++)I[f]=0;for(f=31265;f<=31268;f++)I[f]=0;for(f=31275;f<=31279;f++)I[f]=0;for(f=31281;f<=31297;f++)I[f]=0;for(f=31461;f<=31469;f++)I[f]=0;for(f=31491;f<=31495;f++)I[f]=0;for(f=31917;f<=31922;f++)I[f]=0;for(f=31965;f<=32e3;f++)I[f]=0;for(f=32001;f<=32003;f++)I[f]=2;for(f=32005;f<=32031;f++)I[f]=2;for(f=32033;f<=32060;f++)I[f]=2;for(f=32064;f<=32067;f++)I[f]=2;for(f=32074;f<=32077;f++)I[f]=2;for(f=32081;f<=32086;f++)I[f]=0;for(f=32107;f<=32130;f++)I[f]=0;for(f=32133;f<=32159;f++)I[f]=0;for(f=32164;f<=32167;f++)I[f]=2;for(f=32180;f<=32199;f++)I[f]=0;for(f=32201;f<=32260;f++)I[f]=0;for(f=32301;f<=32360;f++)I[f]=0;for(f=32401;f<=32460;f++)I[f]=0;for(f=32501;f<=32560;f++)I[f]=0;for(f=32601;f<=32662;f++)I[f]=0;for(f=32664;f<=32667;f++)I[f]=2;for(f=32701;f<=32761;f++)I[f]=0;for(f=53001;f<=53004;f++)I[f]=0;for(f=53008;f<=53019;f++)I[f]=0;for(f=53021;f<=53032;f++)I[f]=0;for(f=53034;f<=53037;f++)I[f]=0;for(f=53042;f<=53046;f++)I[f]=0;for(f=53074;f<=53080;f++)I[f]=0;for(f=54001;f<=54004;f++)I[f]=0;for(f=54008;f<=54019;f++)I[f]=0;for(f=54021;f<=54032;f++)I[f]=0;for(f=54034;f<=54037;f++)I[f]=0;for(f=54042;f<=54046;f++)I[f]=0;for(f=54048;f<=54053;f++)I[f]=0;for(f=54074;f<=54080;f++)I[f]=0;for(f=54090;f<=54096;f++)I[f]=0;for(f=54098;f<=54101;f++)I[f]=0;for(f=65161;f<=65163;f++)I[f]=0;for(f=102001;f<=102040;f++)I[f]=0;for(f=102042;f<=102063;f++)I[f]=0;for(f=102065;f<=102067;f++)I[f]=0;for(f=102070;f<=102117;f++)I[f]=0;for(f=102122;f<=102216;f++)I[f]=0;for(f=102221;f<=102377;f++)I[f]=0;for(f=102382;f<=102388;f++)I[f]=0;for(f=102389;f<=102398;f++)I[f]=2;for(f=102399;f<=102444;f++)I[f]=0;for(f=102445;f<=102447;f++)I[f]=2;for(f=102448;f<=102458;f++)I[f]=0;for(f=102459;f<=102468;f++)I[f]=2;for(f=102469;f<=102499;f++)I[f]=0;for(f=102500;f<=102519;f++)I[f]=1;for(f=102520;f<=102524;f++)I[f]=0;for(f=102525;f<=102529;f++)I[f]=2;for(f=102530;f<=102588;f++)I[f]=0;for(f=102590;f<=102598;f++)I[f]=0;for(f=102601;f<=102603;f++)I[f]=0;for(f=102605;f<=102628;f++)I[f]=0;for(f=102629;f<=102646;f++)I[f]=2;for(f=102648;f<=102700;f++)I[f]=2;for(f=102701;f<=102703;f++)I[f]=0;for(f=102707;f<=102730;f++)I[f]=2;for(f=102733;f<=102758;f++)I[f]=2;for(f=102767;f<=102900;f++)I[f]=0;for(f=102901;f<=102933;f++)I[f]=2;for(f=102934;f<=102950;f++)I[f]=13;for(f=102951;f<=102963;f++)I[f]=0;for(f=102965;f<=102969;f++)I[f]=0;for(f=102971;f<=102973;f++)I[f]=0;for(f=102975;f<=102989;f++)I[f]=0;for(f=102990;f<=102992;f++)I[f]=1;for(f=102997;f<=103002;f++)I[f]=0;for(f=103003;f<=103008;f++)I[f]=2;for(f=103009;f<=103011;f++)I[f]=0;for(f=103012;f<=103014;f++)I[f]=2;for(f=103019;f<=103021;f++)I[f]=0;for(f=103022;f<=103024;f++)I[f]=2;for(f=103029;f<=103031;f++)I[f]=0;for(f=103032;f<=103034;f++)I[f]=2;for(f=103065;f<=103068;f++)I[f]=0;for(f=103074;f<=103076;f++)I[f]=0;for(f=103077;f<=103079;f++)I[f]=1;for(f=103080;f<=103082;f++)I[f]=0;for(f=103083;f<=103085;f++)I[f]=2;for(f=103090;f<=103093;f++)I[f]=0;for(f=103097;f<=103099;f++)I[f]=0;for(f=103100;f<=103102;f++)I[f]=2;for(f=103107;f<=103109;f++)I[f]=0;for(f=103110;f<=103112;f++)I[f]=2;for(f=103113;f<=103116;f++)I[f]=0;for(f=103117;f<=103120;f++)I[f]=2;for(f=103153;f<=103157;f++)I[f]=0;for(f=103158;f<=103162;f++)I[f]=2;for(f=103163;f<=103165;f++)I[f]=0;for(f=103166;f<=103168;f++)I[f]=1;for(f=103169;f<=103171;f++)I[f]=2;for(f=103186;f<=103188;f++)I[f]=0;for(f=103189;f<=103191;f++)I[f]=2;for(f=103192;f<=103195;f++)I[f]=0;for(f=103196;f<=103199;f++)I[f]=2;for(f=103200;f<=103224;f++)I[f]=0;for(f=103225;f<=103227;f++)I[f]=1;for(f=103232;f<=103237;f++)I[f]=0;for(f=103238;f<=103243;f++)I[f]=2;for(f=103244;f<=103246;f++)I[f]=0;for(f=103247;f<=103249;f++)I[f]=2;for(f=103254;f<=103256;f++)I[f]=0;for(f=103257;f<=103259;f++)I[f]=2;for(f=103264;f<=103266;f++)I[f]=0;for(f=103267;f<=103269;f++)I[f]=2;for(f=103300;f<=103375;f++)I[f]=0;for(f=103381;f<=103383;f++)I[f]=0;for(f=103384;f<=103386;f++)I[f]=1;for(f=103387;f<=103389;f++)I[f]=0;for(f=103390;f<=103392;f++)I[f]=2;for(f=103397;f<=103399;f++)I[f]=0;for(f=103400;f<=103471;f++)I[f]=2;for(f=103476;f<=103478;f++)I[f]=0;for(f=103479;f<=103481;f++)I[f]=2;for(f=103486;f<=103488;f++)I[f]=0;for(f=103489;f<=103491;f++)I[f]=2;for(f=103492;f<=103495;f++)I[f]=0;for(f=103496;f<=103499;f++)I[f]=2;for(f=103528;f<=103543;f++)I[f]=0;for(f=103544;f<=103548;f++)I[f]=2;for(f=103549;f<=103551;f++)I[f]=0;for(f=103552;f<=103554;f++)I[f]=1;for(f=103555;f<=103557;f++)I[f]=2;for(f=103558;f<=103560;f++)I[f]=0;for(f=103571;f<=103573;f++)I[f]=0;for(f=103574;f<=103576;f++)I[f]=2;for(f=103577;f<=103580;f++)I[f]=0;for(f=103581;f<=103583;f++)I[f]=2;for(f=103595;f<=103694;f++)I[f]=0;for(f=103696;f<=103699;f++)I[f]=0;for(f=103700;f<=103793;f++)I[f]=2;for(f=103794;f<=103890;f++)I[f]=0;for(f=103891;f<=103896;f++)I[f]=2;for(f=103900;f<=103971;f++)I[f]=2;for(f=103972;f<=103977;f++)I[f]=0;for(f=112e3;f<=112101;f++)I[f]=0;const rj=[102100,102113,3857,3785,900913],Oee=[104905,104971],Fee=[104903],Nee=[4326,...rj,...Oee,...Fee],N0=[-20037508342788905e-9,20037508342788905e-9],JM=[-20037508342787e-6,20037508342787e-6],kx={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:N0,origin:JM,dx:1e-5},ij={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:N0,origin:JM,dx:1e-5},102100:kx,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:N0,origin:JM,dx:1e-5},3857:kx,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:kx,104903:{wkTemplate:'GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400,0,AUTHORITY["ESRI","107903"]],AUTHORITY["ESRI","106903"]],PRIMEM["Reference_Meridian",0,AUTHORITY["ESRI","108900"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["ESRI","104903"]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function Cr(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const r=t.wkid,i=e.wkid;if(r!=null||i!=null){if(r===i||ya(t)&&ya(e))return!0;const o=t.latestWkid;if(o!=null&&i===o)return!0;const a=e.latestWkid;return a!=null&&r===a}let s,n;return t.wkt2&&e.wkt2?(s=t.wkt2,n=e.wkt2):t.wkt&&e.wkt&&(s=t.wkt,n=e.wkt),!(!s||!n)&&s.toUpperCase()===n.toUpperCase()}function qi(t){const e=t?.wkid;return e!=null&&e>=2e3&&ij[e]||null}function P1(t){if(!t)return;const{wkid:e,vcsWkid:r}=t;if(e)return r?JSON.stringify({wkid:e,vcsWkid:r}):String(e);const i=t.wkt||t.wkt2;return JSON.stringify(i?r?{wkt:i,vcsWkid:r}:{wkt:i}:{})}function Bm(t){if(!Rs(t))return!1;const{wkid:e}=t;if(e)return I[e]==null;const r=t.wkt2||t.wkt;return!!r&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(r)}function Dee(t){return!(sj(t)||nj(t))}function nd(t){return t?.wkid===4326}function FOe(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function nR(t){return t?.wkid===4490}function ya(t){const e=t?.wkid;return e!=null&&e>=2e3&&rj.includes(e)}function zee(t){return t?.wkid===32662}function t2(t){return t===104971||t===104905}function sj(t){return t2(t?.wkid)}function r2(t){return t===104903}function nj(t){return r2(t?.wkid)}function jee(t){const e=t?.wkid;return e!=null&&e>=2e3&&Nee.includes(e)}function Rs(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const oj={wkid:4326,wkt:dc(ij[4326].wkTemplate,{Central_Meridian:"0.0"})},aj={wkid:102100,latestWkid:3857},Vee={wkid:32662};function gP(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const Uee=gP(Vt),vP=gP(ua),wP=gP(tc),Gee={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${Vt.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},qee=vP.wkt.toUpperCase(),Bee=wP.wkt.toUpperCase();function Hee(t){if(t!=null&&Rs(t)){const e=t.wkid,r=t.wkt2??t.wkt;if(t2(e))return ua;const i=r?.toUpperCase();if(r&&i===qee)return ua;if(r2(e)||i&&i===Bee)return tc}return Vt}function NOe(t){return t2(t)?ua:r2(t)?tc:Vt}function k1(t){return Cr(t,Uee)}function ic(t){return k1(t)||Cr(t,vP)||Cr(t,wP)}const lj=39.37,Wee=Vt.radius*Math.PI/200,uj=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,fm=I,cj=/UNIT\[([^\]]+)]/i,Zee=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),Jee=yr()({millimeter:"millimeters",centimeter:"centimeters",meter:"meters",meter_german:"german-meters",kilometer:"kilometers",decimeter:"decimeters",micrometer:"micrometers",nanometer:"nanometers","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",fathom:"fathoms",nautical_mile:"nautical-miles",chain_us:"us-chains",link_us:"us-links",mile_us:"us-miles",yard_clarke:"clarke-yards",chain_clarke:"clarke-chains",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",link_sears:"sears-links",yard_benoit_1895_a:"benoit-1895-a-yards",foot_benoit_1895_a:"benoit-1895-a-feet",chain_benoit_1895_a:"benoit-1895-a-chains",link_benoit_1895_a:"benoit-1895-a-links",yard_benoit_1895_b:"benoit-1895-b-yards",foot_benoit_1895_b:"benoit-1895-b-feet",chain_benoit_1895_b:"benoit-1895-b-chains",link_benoit_1895_b:"benoit-1895-b-links",foot_1865:"1865-feet",foot_indian:"indian-feet",foot_indian_1937:"indian-1937-feet",foot_indian_1962:"indian-1962-feet",foot_indian_1975:"indian-1975-feet",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",yard_indian_1962:"indian-1962-yards",yard_indian_1975:"indian-1975-yards",statute_mile:"statute-miles",foot_gold_coast:"gold-coast-feet",foot_british_1936:"british-1936-feet",yard:"yards",chain:"chains",link:"links",yard_sears_1922_truncated:"sears-1922-truncated-yards",foot_sears_1922_truncated:"sears-1922-truncated-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",link_sears_1922_truncated:"sears-1922-truncated-links",yard_us:"us-yards",inch:"inches",inch_us:"us-inches",rod:"rods",rod_us:"us-rods",nautical_mile_us:"us-nautical-miles",nautical_mile_uk:"uk-nautical-miles",smoot:"smoots",vara_tx:"tx-vara",point:"points"}),Sn=t=>t*t,Zl=t=>t*t*t,D0={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},meters:{inBaseUnits:1},feet:{inBaseUnits:.3048},"us-feet":{inBaseUnits:.3048006096012192},"clarke-feet":{inBaseUnits:.3047972654},fathoms:{inBaseUnits:1.8288},"nautical-miles":{inBaseUnits:1852},"german-meters":{inBaseUnits:1.0000135965},"us-chains":{inBaseUnits:20.11684023368047},"us-links":{inBaseUnits:.2011684023368047},"us-miles":{inBaseUnits:1609.347218694438},kilometers:{inBaseUnits:1e3},"clarke-yards":{inBaseUnits:.9143917962},"clarke-chains":{inBaseUnits:20.1166195164},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"sears-links":{inBaseUnits:.2011676512155263},"benoit-1895-a-yards":{inBaseUnits:.9143992},"benoit-1895-a-feet":{inBaseUnits:.3047997333333333},"benoit-1895-a-chains":{inBaseUnits:20.1167824},"benoit-1895-a-links":{inBaseUnits:.201167824},"benoit-1895-b-yards":{inBaseUnits:.9143992042898124},"benoit-1895-b-feet":{inBaseUnits:.3047997347632708},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"benoit-1895-b-links":{inBaseUnits:.2011678249437587},"1865-feet":{inBaseUnits:.3048008333333334},"indian-feet":{inBaseUnits:.3047995102481469},"indian-1937-feet":{inBaseUnits:.30479841},"indian-1962-feet":{inBaseUnits:.3047996},"indian-1975-feet":{inBaseUnits:.3047995},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"indian-1962-yards":{inBaseUnits:.9143988},"indian-1975-yards":{inBaseUnits:.9143985},miles:{inBaseUnits:1609.344},"statute-miles":{inBaseUnits:1609.344},"gold-coast-feet":{inBaseUnits:.3047997101815088},"british-1936-feet":{inBaseUnits:.3048007491},yards:{inBaseUnits:.9144},chains:{inBaseUnits:20.1168},links:{inBaseUnits:.201168},"sears-1922-truncated-yards":{inBaseUnits:.914398},"sears-1922-truncated-feet":{inBaseUnits:.3047993333333334},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"sears-1922-truncated-links":{inBaseUnits:.20116756},"us-yards":{inBaseUnits:.9144018288036576},decimeters:{inBaseUnits:.1},inches:{inBaseUnits:.0254},"us-inches":{inBaseUnits:.0254000508001016},rods:{inBaseUnits:5.0292},"us-rods":{inBaseUnits:5.029210058420118},"us-nautical-miles":{inBaseUnits:1853.248},"uk-nautical-miles":{inBaseUnits:1853.184},smoots:{inBaseUnits:1.7018},"tx-vara":{inBaseUnits:.8466683600033867},points:{inBaseUnits:.0003527777777777778},micrometers:{inBaseUnits:1e-6},nanometers:{inBaseUnits:1e-9},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:Sn(.001)},"square-centimeters":{inBaseUnits:Sn(.01)},"square-decimeters":{inBaseUnits:Sn(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:Sn(1e3)},"square-inches":{inBaseUnits:Sn(.0254)},"square-feet":{inBaseUnits:Sn(.3048)},"square-yards":{inBaseUnits:Sn(.9144)},"square-miles":{inBaseUnits:Sn(1609.344)},"square-nautical-miles":{inBaseUnits:Sn(1852)},"square-us-feet":{inBaseUnits:Sn(1200/3937)},acres:{inBaseUnits:.0015625*Sn(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*Zl(.001)},"cubic-centimeters":{inBaseUnits:1e3*Zl(.01)},"cubic-decimeters":{inBaseUnits:1e3*Zl(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*Zl(1e3)},"cubic-inches":{inBaseUnits:1e3*Zl(.0254)},"cubic-feet":{inBaseUnits:1e3*Zl(.3048)},"cubic-yards":{inBaseUnits:1e3*Zl(.9144)},"cubic-miles":{inBaseUnits:1e3*Zl(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},Yee=(()=>{const t={};for(const e in D0)for(const r in D0[e].units)t[r]=e;return t})();function Xee(t,e,r){return t*D0[r].units[e].inBaseUnits}function Kee(t,e,r){return t/D0[r].units[e].inBaseUnits}const Qee=["inches","feet","yards","miles","nautical-miles","us-feet","millimeters","centimeters","decimeters","meters","kilometers"],ete=["metric","imperial"],hj=[...ete,...Qee],tte=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function YM(t){const e=Yee[t];if(!e)throw new Error("unknown type");return e}function oR(t,e=null){return e=e||YM(t),D0[e].baseUnit===t}function Zt(t,e,r){if(e===r)return t;const i=YM(e);if(i!==YM(r))throw new Error("incompatible units");const s=oR(e,i)?t:Xee(t,e,i);return oR(r,i)?s:Kee(s,r,i)}function DOe(t,e,r,i=!1){if(!i&&Bm(e))throw new Error("Unable to convert from an angular unit to a linear unit.");const s=gd(e);return s!==r&&(t=s?Zt(t,s,r):Zt(t*=Vs(e),"meters",r)),t}function zOe(t,e,r,i=!1){if(!i&&Bm(r))throw new Error("Unable to convert from a linear unit to an angular unit.");const s=gd(r);return e!==s&&(t=s?Zt(t,e,s):Zt(t,e,"meters")/Vs(r)),t}function rte(t){switch(t){case"metric":return"meters";case"imperial":return"feet";default:return t}}function jOe(t){return rte(t)}function VOe(t){switch(t){case"metric":return"square-meters";case"imperial":return"square-feet";default:return t}}function UOe(t,e,r){switch(r){case"metric":return ite(t,e);case"imperial":return nte(t,e);default:return r}}function GOe(t,e,r){switch(r){case"metric":return ste(t,e);case"imperial":return ote(t,e);default:return r}}function ite(t,e){const r=Zt(t,e,"meters");return Math.abs(r)<3e3?"meters":"kilometers"}function ste(t,e){const r=Zt(t,e,"meters");return Math.abs(r)<1e5?"meters":"kilometers"}function nte(t,e){const r=Zt(t,e,"feet");return Math.abs(r)<1e3?"feet":"miles"}function ote(t,e){const r=Zt(t,e,"feet");return Math.abs(r)<1e5?"feet":"miles"}function qOe(t,e){const r=Zt(t,e,"square-meters");return Math.abs(r)<3e6?"square-meters":"square-kilometers"}function BOe(t,e){const r=Zt(t,e,"square-feet");return Math.abs(r)<1e6?"square-feet":"square-miles"}function ate(t,e,r){return Zt(t,e,"meters")/(r*Math.PI/180)}function _P(t){return Jee.fromJSON(t.toLowerCase())||null}function L1(t){if(t!=null&&!Dee(t))return 1;const e=Vs(t);return e>1e5?1:e}function dj(t){return Vs(t)>=Hee(t).metersPerDegree?"meters":gd(t)}function Vs(t,e=Vt.metersPerDegree){return lte(t,!0)??e}function lte(t,e=!1){const r=t?.wkid??null,i=t?.wkt2??t?.wkt??null;let s=null;if(r){if(t2(r))return ua.metersPerDegree;if(r2(r))return tc.metersPerDegree;s=fm.values[fm[r]],!s&&e&&Zee.has(r)&&(s=Wee)}else i&&(mj(i)?s=aR(uj.exec(i),s):fj(i)&&(s=aR(cj.exec(i),s)));return s}function HOe(t){return Bm(t)?1:Vs(t)}function aR(t,e){return t?.[1]?pj(t[1]):e}function pj(t){return parseFloat(t.split(",")[1])}function gd(t){const e=t?.wkid??null,r=t?.wkt2??t?.wkt??null;let i=null;if(e)i=fm.units[fm[e]];else if(r){const s=mj(r)?uj:fj(r)?cj:null;if(s){const n=s.exec(r);n?.[1]&&(i=cte(n[1]))}}return i!=null?_P(i):null}function WOe(t){const e=gd(t);return e!=null&&hj.includes(e)?e:null}function ZOe(t){const e=dj(t);return e!=null&&hj.includes(e)?e:null}function JOe(t){const e=gd(t);return e==null?null:tte.get(e)}function fj(t){return/^GEOCCS/i.test(t)}function mj(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const ute=1e-7;function cte(t){let r=/[\\"']([^\\"']+)/.exec(t)?.[1];if(!r||!_P(r)){const i=pj(t);r=null;const s=fm.values;for(let n=0;n<s.length;++n)if(Math.abs(i-s[n])<ute){r=fm.units[n];break}}return r}function YOe(t){const e=gd(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"fathoms":case"nautical-miles":case"us-chains":case"us-links":case"us-miles":case"clarke-yards":case"clarke-chains":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"sears-links":case"benoit-1895-a-yards":case"benoit-1895-a-feet":case"benoit-1895-a-chains":case"benoit-1895-a-links":case"benoit-1895-b-yards":case"benoit-1895-b-feet":case"benoit-1895-b-chains":case"benoit-1895-b-links":case"1865-feet":case"indian-feet":case"indian-1937-feet":case"indian-1962-feet":case"indian-1975-feet":case"indian-yards":case"indian-1937-yards":case"indian-1962-yards":case"indian-1975-yards":case"statute-miles":case"gold-coast-feet":case"british-1936-feet":case"yards":case"chains":case"links":case"sears-1922-truncated-yards":case"sears-1922-truncated-feet":case"sears-1922-truncated-chains":case"sears-1922-truncated-links":case"us-yards":case"inches":case"us-inches":case"rods":case"us-rods":case"us-nautical-miles":case"uk-nautical-miles":case"smoots":case"tx-vara":case"points":return"imperial";case"millimeters":case"centimeters":case"meters":case"german-meters":case"kilometers":case"decimeters":case"micrometers":case"nanometers":case"50-kilometers":case"150-kilometers":return"metric"}return null}const hte={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},dte={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},pte={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},fte=yr()(hte),mte=yr()(dte),XOe=yr()(pte);var uo,Ao;let ne=(Ao=class extends W{static fromJSON(e){if(!e)return null;if(e?.wkid===102100)return uo.WebMercator;if(e?.wkid===4326)return uo.WGS84;const r=new uo;return r.read(e),r}constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(e){return e&&typeof e=="object"?e:{[typeof e=="string"?"wkt":"wkid"]:e}}get isWGS84(){return nd(this)}get isWebMercator(){return ya(this)}get isGeographic(){return Bm(this)}get isWrappable(){return jee(this)}get metersPerUnit(){return Vs(this)}get unit(){return gd(this)||(this.isGeographic?"degrees":null)}writeWkt(e,r){this.wkid||(r.wkt=e)}clone(){if(this===uo.WGS84)return new uo(oj);if(this===uo.WebMercator)return new uo(aj);const e=new uo;return this.wkid!=null?(e.wkid=this.wkid,this.latestWkid!=null&&(e.latestWkid=this.latestWkid),this.vcsWkid!=null&&(e.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(e.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(e.wkt=this.wkt),this.wkt2!=null&&(e.wkt2=this.wkt2)),this.imageCoordinateSystem&&(e.imageCoordinateSystem=O(this.imageCoordinateSystem)),e}equals(e){if(e==null)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(this.imageCoordinateSystem==null||e.imageCoordinateSystem==null)return!1;const{id:r,referenceServiceName:i}=e.imageCoordinateSystem,{geodataXform:s}=e.imageCoordinateSystem,n=this.imageCoordinateSystem;return r==null||s?JSON.stringify(n)===JSON.stringify(e.imageCoordinateSystem):i?n.id===r&&n.referenceServiceName===i:n.id===r}return Cr(this,e)}toJSON(e){return this.write(void 0,e)}},uo=Ao,Ao.GCS_NAD_1927=null,Ao.WGS84=null,Ao.WebMercator=null,Ao.PlateCarree=null,Ao);u([h({readOnly:!0})],ne.prototype,"isWGS84",null),u([h({readOnly:!0})],ne.prototype,"isWebMercator",null),u([h({readOnly:!0})],ne.prototype,"isGeographic",null),u([h({readOnly:!0})],ne.prototype,"isWrappable",null),u([h({type:Ue,json:{write:!0}})],ne.prototype,"latestWkid",void 0),u([h({readOnly:!0})],ne.prototype,"metersPerUnit",null),u([h({readOnly:!0})],ne.prototype,"unit",null),u([h({type:Ue,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],ne.prototype,"wkid",void 0),u([h({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],ne.prototype,"wkt",void 0),u([te("wkt"),te("web-scene","wkt")],ne.prototype,"writeWkt",null),u([h({type:String,json:{write:!1}})],ne.prototype,"wkt2",void 0),u([h({type:Ue,json:{write:!0}})],ne.prototype,"vcsWkid",void 0),u([h({type:Ue,json:{write:!0}})],ne.prototype,"latestVcsWkid",void 0),u([h()],ne.prototype,"imageCoordinateSystem",void 0),ne=uo=u([E("esri.geometry.SpatialReference")],ne),ne.prototype.toJSON.isDefaultToJSON=!0,ne.GCS_NAD_1927=le.freeze(new ne({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),ne.WGS84=le.freeze(new ne(oj)),ne.WebMercator=le.freeze(new ne(aj)),ne.PlateCarree=le.freeze(new ne(Vee));function X(t,e,r){let i,s;return e===void 0||Array.isArray(e)?(s=t,r=e,i=[void 0]):(s=e,i=Array.isArray(t)?t:[t]),(n,o)=>{const a=n.constructor.prototype;i.forEach(l=>{const c=oP(n,l,s);c.read&&typeof c.read=="object"||(c.read={}),c.read.reader=a[o],r&&(c.read.source=(c.read.source||[]).concat(r))})}}let Mr=class extends W{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=ne.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,r){if(e instanceof ne)return e;if(e!=null){const i=new ne;return i.read(e,r),i}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,r){this.cache[e]=r}};u([h()],Mr.prototype,"type",void 0),u([h({readOnly:!0})],Mr.prototype,"cache",null),u([h({readOnly:!0})],Mr.prototype,"extent",null),u([h({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Mr.prototype,"hasM",void 0),u([h({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Mr.prototype,"hasZ",void 0),u([h({type:ne,json:{write:!0},value:ne.WGS84})],Mr.prototype,"spatialReference",void 0),u([X("spatialReference")],Mr.prototype,"readSpatialReference",null),Mr=u([E("esri.geometry.Geometry")],Mr);const yte=Object.prototype.toString;function gte(t){const e="__accessorMetadata__"in t?jt(t):t;return function(...r){if(r.push(e),typeof r[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return vte.apply(this,r)}}function vte(t,e,r,i){Tv(t,e).cast=i}function wte(t){return(e,r)=>{Tv(e,t).cast=e[r]}}function He(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&yte.call(t[0])==="[object Function]"?gte(t[0]):t.length===1&&typeof t[0]=="string"?wte(t[0]):void 0}function mm(t){if(t&&typeof t=="object"&&"type"in t&&t.type==="mesh")throw new R("internal:mesh","Mesh geometries are not supported for this operation")}function _te(t){t.forEach(mm)}const bte=57.29577951308232,Ste=.017453292519943;function lR(t){return t*bte}function uR(t){return t*Ste}function QOe(t){return Math.PI/2-2*Math.atan(Math.exp(-t/Vt.radius))}function XM(t){return t.wkid!=null||t.wkt!=null}const Lx=[0,0];function A1(t,e,r,i,s){const n=t,o=s;if(o.spatialReference=r,"x"in n&&"x"in o)[o.x,o.y]=e(n.x,n.y,Lx,i);else if("xmin"in n&&"xmin"in o)[o.xmin,o.ymin]=e(n.xmin,n.ymin,Lx,i),[o.xmax,o.ymax]=e(n.xmax,n.ymax,Lx,i);else if("paths"in n&&"paths"in o||"rings"in n&&"rings"in o){const a="paths"in n?n.paths:n.rings,l=[];let c;for(let d=0;d<a.length;d++){const p=a[d];c=[],l.push(c);for(let m=0;m<p.length;m++)c.push(e(p[m][0],p[m][1],[0,0],i)),p[m].length>2&&c[m].push(p[m][2]),p[m].length>3&&c[m].push(p[m][3])}"paths"in o?o.paths=l:o.rings=l}else if("points"in n&&"points"in o){const a=n.points,l=[];for(let c=0;c<a.length;c++)l[c]=e(a[c][0],a[c][1],[0,0],i),a[c].length>2&&l[c].push(a[c][2]),a[c].length>3&&l[c].push(a[c][3]);o.points=l}return s}function O_(t,e){const r=t&&(XM(t)?t:t.spatialReference),i=e&&(XM(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!r||!i)&&(!!Cr(i,r)||ya(i)&&nd(r)||ya(r)&&nd(i))}function i2(t,e){if(t==null)return null;const r=t.spatialReference,i=e&&(XM(e)?e:e.spatialReference);return O_(r,i)?Cr(r,i)?O(t):ya(i)?A1(t,Xp,ne.WebMercator,!1,O(t)):nd(i)?A1(t,s2,ne.WGS84,!1,O(t)):null:null}function Xp(t,e,r=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const i=uR(e);return r[0]=uR(t)*Vt.radius,r[1]=Vt.halfSemiMajorAxis*Math.log((1+Math.sin(i))/(1-Math.sin(i))),r}function s2(t,e,r=[0,0],i=!1){if(t===N0[0])r[0]=-180;else if(t===N0[1])r[0]=180;else{const s=lR(t/Vt.radius);r[0]=i?s:s-360*Math.floor((s+180)/360)}return r[1]=lR(Math.PI/2-2*Math.atan(Math.exp(-e/Vt.radius))),r}function Bu(t,e=!1,r=O(t)){return mm(t),mm(r),A1(t,Xp,ne.WebMercator,e,r)}function Kp(t,e=!1,r=O(t)){return mm(t),mm(r),A1(t,s2,ne.WGS84,e,r)}function yj(t,e){const r=t.x-e.x,i=t.y-e.y,s=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(r*r+i*i+s*s)}function xte(t){return gj(t,vj)?.[0]??null}function $te(t){return gj(t,vj)?.[1]??null}function gj({x:t,y:e,spatialReference:r},i=[0,0]){if(r){if(ya(r))return s2(t,e,i);if(Bm(r))return i[0]=t,i[1]=e,i}return null}const vj=[0,0];var F_;const Ax=[0,0];function cR(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let de=F_=class extends Mr{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const r=t._get("spatialReference");e._set("spatialReference",le.isFrozen(r)?r:r.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,r,i,s){let n;if(Array.isArray(t))n=t,s=e,t=n[0],e=n[1],r=n[2],i=n[3];else if(t&&typeof t=="object"){if(n=t,t=n.x!=null?n.x:n.longitude,e=n.y!=null?n.y:n.latitude,r=n.z,i=n.m,(s=n.spatialReference)&&s.declaredClass!=="esri.geometry.SpatialReference"&&(s=new ne(s)),n.longitude!=null||n.latitude!=null){if(n.longitude==null)U.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(n.latitude==null)U.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!n.declaredClass&&s?.isWebMercator){const a=Xp(n.longitude,n.latitude,Ax);t=a[0],e=a[1]}}}else cR(r)?(s=r,r=null):cR(i)&&(s=i,i=null);const o={x:t,y:e};return o.x==null&&o.y!=null?U.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&U.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),s!=null&&(o.spatialReference=s),r!=null&&(o.z=r),i!=null&&(o.m=i),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return $te(this)}set latitude(t){const{spatialReference:e,x:r}=this;t!=null&&e&&(e.isWebMercator?this._set("y",Xp(r,t,Ax)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return xte(this)}set longitude(t){const{y:e,spatialReference:r}=this;t!=null&&r&&(r.isWebMercator?this._set("x",Xp(t,e,Ax)[0]):r.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,r){e[r]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new F_;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return F_.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:r,z:i,m:s,spatialReference:n}=this,{z:o,m:a}=t;let{x:l,y:c,spatialReference:d}=t;if(!n.equals(d))if(n.isWebMercator&&d.isWGS84)[l,c]=Xp(l,c),d=n;else{if(!n.isWGS84||!d.isWebMercator)return!1;[l,c]=s2(l,c),d=n}return e===l&&r===c&&i===o&&s===a&&n.wkid===d.wkid}offset(t,e,r){return this.x+=t,this.y+=e,r!=null&&(this.z=(this.z??0)+r),this}normalize(){if(!this.spatialReference)return this;const t=qi(this.spatialReference);if(!t)return this;let e=this.x;const[r,i]=t.valid,s=2*i;let n;return e>i?(n=Math.ceil(Math.abs(e-i)/s),e-=n*s):e<r&&(n=Math.ceil(Math.abs(e-r)/s),e+=n*s),this._set("x",e),this}distance(t){return yj(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};u([h({readOnly:!0})],de.prototype,"cache",null),u([h({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],de.prototype,"hasM",null),u([h({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],de.prototype,"hasZ",null),u([h({type:Number})],de.prototype,"latitude",null),u([h({type:Number})],de.prototype,"longitude",null),u([h({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),He(t=>isNaN(t)?t:zi(t))],de.prototype,"x",void 0),u([te("x")],de.prototype,"writeX",null),u([X("x")],de.prototype,"readX",null),u([h({type:Number,json:{write:!0}})],de.prototype,"y",void 0),u([h({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],de.prototype,"z",void 0),u([h({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],de.prototype,"m",void 0),de=F_=u([E("esri.geometry.Point")],de),de.prototype.toJSON.isDefaultToJSON=!0;const Rx=[0,0];function kv(t,e){return e!=null&&Ai(t,e.x,e.y,e.z)}function e5e(t,e){if(!e.points?.length)return!1;for(const r of e.points)if(!ym(t,r))return!1;return!0}function Mte(t,e){const{xmin:r,ymin:i,zmin:s,xmax:n,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?Ai(t,r,i,s)&&Ai(t,r,o,s)&&Ai(t,n,o,s)&&Ai(t,n,i,s)&&Ai(t,r,i,a)&&Ai(t,r,o,a)&&Ai(t,n,o,a)&&Ai(t,n,i,a):Ai(t,r,i)&&Ai(t,r,o)&&Ai(t,n,o)&&Ai(t,n,i)}function ym(t,e){return Ai(t,e[0],e[1])}function Tte(t,e){return Ai(t,e[0],e[1],e[2])}function Ai(t,e,r,i){return e>=t.xmin&&e<=t.xmax&&r>=t.ymin&&r<=t.ymax&&(i==null||!t.hasZ||i>=t.zmin&&i<=t.zmax)}function bP(t,e){return Rx[1]=e.y,Rx[0]=e.x,Ite(t,Rx)}function Ite(t,e){return SP(t.rings,e)}function SP(t,e){if(!t||t.length<1)return!1;if(Ete(t))return hR(!1,t,e);let r=!1;for(let i=0,s=t.length;i<s;i++)r=hR(r,t[i],e);return r}function Ete(t){return!Array.isArray(t[0][0])}function hR(t,e,r){const[i,s]=r;let n=t,o=0;for(let a=0,l=e.length;a<l;a++){o++,o===l&&(o=0);const[c,d]=e[a],[p,m]=e[o];(d<s&&m>=s||m<s&&d>=s)&&c+(s-d)/(m-d)*(p-c)<i&&(n=!n)}return n}function Cte(t,e){return kv(t,e)}function Pte(t,e){const r=t.hasZ&&e.hasZ;let i,s,n;if(t.xmin<=e.xmin){if(i=e.xmin,t.xmax<i)return!1}else if(i=t.xmin,e.xmax<i)return!1;if(t.ymin<=e.ymin){if(s=e.ymin,t.ymax<s)return!1}else if(s=t.ymin,e.ymax<s)return!1;if(r&&e.hasZ){if(t.zmin<=e.zmin){if(n=e.zmin,t.zmax<n)return!1}else if(n=t.zmin,e.zmax<n)return!1}return!0}function kte(t,e){const{points:r,hasZ:i}=e,s=i?Tte:ym;for(const n of r)if(s(t,n))return!0;return!1}const od=[0,0],ad=[0,0],ld=[0,0],ud=[0,0],Lte=[od,ad,ld,ud],wj=[[ld,od],[od,ad],[ad,ud],[ud,ld]];function Ate(t,e){return Rte(t,e.rings)}function Rte(t,e){od[0]=t.xmin,od[1]=t.ymax,ad[0]=t.xmax,ad[1]=t.ymax,ld[0]=t.xmin,ld[1]=t.ymin,ud[0]=t.xmax,ud[1]=t.ymin;for(const r of Lte)if(SP(e,r))return!0;for(const r of e){if(!r.length)continue;let i=r[0];if(ym(t,i))return!0;for(let s=1;s<r.length;s++){const n=r[s];if(ym(t,n)||_j(i,n,wj))return!0;i=n}}return!1}function Ote(t,e){od[0]=t.xmin,od[1]=t.ymax,ad[0]=t.xmax,ad[1]=t.ymax,ld[0]=t.xmin,ld[1]=t.ymin,ud[0]=t.xmax,ud[1]=t.ymin;const r=e.paths;for(const i of r){if(!r.length)continue;let s=i[0];if(ym(t,s))return!0;for(let n=1;n<i.length;n++){const o=i[n];if(ym(t,o)||_j(s,o,wj))return!0;s=o}}return!1}const Ar=[0,0];function Fte(t){for(let e=0;e<t.length;e++){const r=t[e];for(let s=0;s<r.length-1;s++){const n=r[s],o=r[s+1];for(let a=e+1;a<t.length;a++)for(let l=0;l<t[a].length-1;l++){const c=t[a][l],d=t[a][l+1];if(R1(n,o,c,d,Ar)&&!(Ar[0]===n[0]&&Ar[1]===n[1]||Ar[0]===c[0]&&Ar[1]===c[1]||Ar[0]===o[0]&&Ar[1]===o[1]||Ar[0]===d[0]&&Ar[1]===d[1]))return!0}}const i=r.length;if(!(i<=4))for(let s=0;s<i-3;s++){let n=i-1;s===0&&(n=i-2);const o=r[s],a=r[s+1];for(let l=s+2;l<n;l++){const c=r[l],d=r[l+1];if(R1(o,a,c,d,Ar)&&!(Ar[0]===o[0]&&Ar[1]===o[1]||Ar[0]===c[0]&&Ar[1]===c[1]||Ar[0]===a[0]&&Ar[1]===a[1]||Ar[0]===d[0]&&Ar[1]===d[1]))return!0}}}return!1}function _j(t,e,r){for(let i=0;i<r.length;i++)if(R1(t,e,r[i][0],r[i][1]))return!0;return!1}function R1(t,e,r,i,s){const[n,o]=t,[a,l]=e,[c,d]=r,[p,m]=i,y=p-c,g=n-c,v=a-n,w=m-d,_=o-d,x=l-o,$=w*v-y*x;if($===0)return!1;const T=(y*_-w*g)/$,C=(v*_-x*g)/$;return T>=0&&T<=1&&C>=0&&C<=1&&(s&&(s[0]=n+T*(a-n),s[1]=o+T*(l-o)),!0)}function Nte(t){switch(t){case"esriGeometryEnvelope":case"extent":return Pte;case"esriGeometryMultipoint":case"multipoint":return kte;case"esriGeometryPoint":case"point":return Cte;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return Ate;case"esriGeometryPolyline":case"polyline":return Ote}}var Cn;function Dte(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function Jl(t,e,r){return e==null?r:r==null?e:t(e,r)}let Te=Cn=class extends Mr{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,r,i,s){return Dte(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?ne.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:r,ymax:i,spatialReference:s??ne.WGS84}}static fromPoint(t){return new Cn({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new de({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new Cn;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,r=t.spatialReference;return e&&r&&!e.equals(r)&&O_(e,r)&&(t=e.isWebMercator?Bu(t):Kp(t,!0)),t.type==="point"?kv(this,t):t.type==="extent"&&Mte(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,r=t.spatialReference;return e&&r&&!e.equals(r)&&O_(e,r)&&(t=e.isWebMercator?Bu(t):Kp(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),r=this.width*e,i=this.height*e;if(this.xmin+=r,this.ymin+=i,this.xmax-=r,this.ymax-=i,this.hasZ){const s=(this.zmax-this.zmin)*e;this.zmin+=s,this.zmax-=s}if(this.hasM){const s=(this.mmax-this.mmin)*e;this.mmin+=s,this.mmax-=s}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,r=t.spatialReference;return e&&r&&!Cr(e,r)&&O_(e,r)&&(t=e.isWebMercator?Bu(t):Kp(t,!0)),Nte(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,r){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,r!=null&&(this.zmin+=r,this.zmax+=r),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Jl(Math.min,this.zmin,t.zmin),this.zmax=Jl(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Jl(Math.min,this.mmin,t.mmin),this.mmax=Jl(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Jl(Math.max,this.zmin,t.zmin),this.zmax=Jl(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Jl(Math.max,this.mmin,t.mmin),this.mmax=Jl(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=qi(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,r=this._getCM(t);if(r){const i=e.isWebMercator?Kp(r):r;this.xmin-=r.x,this.xmax-=r.x,e.isWebMercator||(i.x=Ox(i.x,t).x),this.spatialReference=new ne(dc((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:i.x}))}return this}_getCM(t){let e=null;const[r,i]=t.valid,s=this.xmin,n=this.xmax;return s>=r&&s<=i&&n>=r&&n<=i||(e=this.center),e}_normalize(t,e,r){const i=this.spatialReference;if(!i)return this;const s=r??qi(i);if(s==null)return this;const n=this._getParts(s).map(l=>l.extent);if(n.length<2)return n[0]||this;if(n.length>2)return t?this._shiftCM(s):this.set({xmin:s.valid[0],xmax:s.valid[1]});if(t)return this._shiftCM(s);if(e)return n;let o=!0,a=!0;return n.forEach(l=>{l.hasZ||(o=!1),l.hasM||(a=!1)}),{rings:n.map(l=>{const c=[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]];if(o){const d=(l.zmax-l.zmin)/2;for(let p=0;p<c.length;p++)c[p].push(d)}if(a){const d=(l.mmax-l.mmin)/2;for(let p=0;p<c.length;p++)c[p].push(d)}return c}),hasZ:o,hasM:a,spatialReference:i}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:s,ymax:n,spatialReference:o}=this,a=this.width,l=this.xmin,c=this.xmax;let d;t=t||qi(o);const[p,m]=t.valid;d=Ox(this.xmin,t);const y=d.x,g=d.frameId;d=Ox(this.xmax,t);const v=d.x,w=d.frameId,_=y===v&&a>0;if(a>2*m){const x=new Cn(l<c?y:v,s,m,n,o),$=new Cn(p,s,l<c?v:y,n,o),T=new Cn(0,s,m,n,o),C=new Cn(p,s,0,n,o),P=[],A=[];x.contains(T)&&P.push(g),x.contains(C)&&A.push(g),$.contains(T)&&P.push(w),$.contains(C)&&A.push(w);for(let F=g+1;F<w;F++)P.push(F),A.push(F);e.push({extent:x,frameIds:[g]},{extent:$,frameIds:[w]},{extent:T,frameIds:P},{extent:C,frameIds:A})}else y>v||_?e.push({extent:new Cn(y,s,m,n,o),frameIds:[g]},{extent:new Cn(p,s,v,n,o),frameIds:[w]}):e.push({extent:new Cn(y,s,v,n,o),frameIds:[g]});this.cache._parts=e}const r=this.hasZ,i=this.hasM;if(r||i){const s={};r&&(s.zmin=this.zmin,s.zmax=this.zmax),i&&(s.mmin=this.mmin,s.mmax=this.mmax);for(let n=0;n<e.length;n++)e[n].extent.set(s)}return e}};function Ox(t,e){const[r,i]=e.valid,s=2*i;let n,o=0;return t>i?(n=Math.ceil(Math.abs(t-i)/s),t-=n*s,o=n):t<r&&(n=Math.ceil(Math.abs(t-r)/s),t+=n*s,o=-n),{x:t,frameId:o}}u([h({readOnly:!0})],Te.prototype,"cache",null),u([h({readOnly:!0})],Te.prototype,"center",null),u([h({readOnly:!0})],Te.prototype,"extent",null),u([h({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Te.prototype,"hasM",null),u([h({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Te.prototype,"hasZ",null),u([h({readOnly:!0})],Te.prototype,"height",null),u([h({readOnly:!0})],Te.prototype,"width",null),u([h({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Te.prototype,"xmin",void 0),u([h({type:Number,json:{write:!0}})],Te.prototype,"ymin",void 0),u([h({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],Te.prototype,"mmin",void 0),u([h({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Te.prototype,"zmin",void 0),u([h({type:Number,json:{write:!0}})],Te.prototype,"xmax",void 0),u([h({type:Number,json:{write:!0}})],Te.prototype,"ymax",void 0),u([h({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],Te.prototype,"mmax",void 0),u([h({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Te.prototype,"zmax",void 0),Te=Cn=u([E("esri.geometry.Extent")],Te),Te.prototype.toJSON.isDefaultToJSON=!0;let Qg;const zte=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,KM=globalThis.document?.documentElement;function bj(){const t=KM?.getAttribute("lang"),e=globalThis.navigator?.language;return zte??t??e??"en"}function hs(){return Qg===void 0&&(Qg=bj()),Qg}const jte=/^(?<language>[a-z]{2,3})(?:-(?<extlang>[a-z]{3}))?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function xP(t=hs()){return xj(t)?.language}function Sj(t=hs()){const e=xj(t);return e?.language&&e?.extlang?t.replace(`${e.language}-`,""):t}function xj(t=hs()){return jte.exec(t)?.groups}const N_=[];function $P(t){return N_.push(t),je(()=>{N_.splice(N_.indexOf(t),1)})}const D_=[];function MP(t){return D_.push(t),je(()=>D_.splice(D_.indexOf(t),1))}function dR(){const t=bj();Qg!==t&&([...D_].forEach(e=>e(t)),Qg=t,[...N_].forEach(e=>e(t)))}globalThis.addEventListener?.("languagechange",dR),KM&&new MutationObserver(()=>{dR()}).observe(KM,{attributeFilter:["lang"]});let hw;function Vte(t){return hw&&!hw.destroyed||(hw=t()),hw}var QM;const Ute=new Ne({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let Jt=QM=class extends le{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new QM({categories:this.categories?O(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let r=[];this.categories&&(r=this.categories.map(o=>Array.isArray(o)?JSON.stringify(o):o));let i="";if(this.extent){const o=i2(this.extent,ne.WGS84);o!=null&&(i=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let s=this.query;!this.disableExtraQuery&&t.extraQuery&&(s="("+s+")"+t.extraQuery);const n={categories:r,bbox:i,q:s,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(n.sortField=this.sortField.split(",").map(o=>Ute.toJSON(o.trim())).join(","),n.sortOrder=this.sortOrder),{query:{...e,...n}}}};u([h()],Jt.prototype,"categories",void 0),u([h()],Jt.prototype,"disableExtraQuery",void 0),u([h({type:Te})],Jt.prototype,"extent",void 0),u([h()],Jt.prototype,"filter",void 0),u([h()],Jt.prototype,"num",void 0),u([h()],Jt.prototype,"query",void 0),u([h()],Jt.prototype,"sortField",void 0),u([h()],Jt.prototype,"sortOrder",null),u([h()],Jt.prototype,"start",void 0),Jt=QM=u([E("esri.portal.PortalQueryParams")],Jt);var eT;let Bt=eT=class extends W{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e&&this.portal?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.portal?.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then(e=>{const r=e.categorySchema||[];return r.some(i=>i.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):r})}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new R("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new eT({sourceJSON:t});return e.read(t),e}queryItems(t,e){let r=jt(Jt,t);const i=this.portal;return parseFloat(i.currentVersion)>5?(r=r||new Jt,i.queryPortal(`/content/groups/${this.id}/search`,r,"PortalItem",e)):(r=r?r.clone():new Jt,r.query="group:"+this.id+(r.query?" "+r.query:""),i.queryItems(r,e))}_fetchCategorySchemaSet(t,e){const r=this.portal;return r.fetchSelf(r.authMode,!0,e).then(i=>{const s=i.contentCategorySetsGroupQuery;if(s){const n=new Jt({disableExtraQuery:!0,num:1,query:s});return r.queryGroups(n,e)}throw new R("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(i=>{if(i.total){const s=i.results[0],n=new Jt({num:1,query:`typekeywords:"${t}"`});return s.queryItems(n,e)}throw new R("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(i=>i.total?i.results[0].fetchData("json",e).then(s=>{const n=s?.categorySchema;return n?.length?n:[]}):[])}};u([h()],Bt.prototype,"access",void 0),u([h({type:Date})],Bt.prototype,"created",void 0),u([h()],Bt.prototype,"description",void 0),u([h()],Bt.prototype,"id",void 0),u([h()],Bt.prototype,"isInvitationOnly",void 0),u([h({type:Date})],Bt.prototype,"modified",void 0),u([h()],Bt.prototype,"owner",void 0),u([h()],Bt.prototype,"portal",void 0),u([h()],Bt.prototype,"snippet",void 0),u([h()],Bt.prototype,"sortField",void 0),u([h()],Bt.prototype,"sortOrder",void 0),u([h()],Bt.prototype,"sourceJSON",void 0),u([h()],Bt.prototype,"tags",void 0),u([h()],Bt.prototype,"thumbnail",void 0),u([h({readOnly:!0})],Bt.prototype,"thumbnailUrl",null),u([h()],Bt.prototype,"title",void 0),u([h({readOnly:!0})],Bt.prototype,"url",null),Bt=eT=u([E("esri.portal.PortalGroup")],Bt);let zc=class extends le{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};u([h()],zc.prototype,"nextQueryParams",void 0),u([h()],zc.prototype,"queryParams",void 0),u([h()],zc.prototype,"results",void 0),u([h()],zc.prototype,"total",void 0),zc=u([E("esri.portal.PortalQueryResult")],zc);let Aa=class extends W{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.portal?.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new R("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};u([h({type:Date})],Aa.prototype,"created",void 0),u([h()],Aa.prototype,"id",void 0),u([h()],Aa.prototype,"portal",void 0),u([h()],Aa.prototype,"title",void 0),u([h({readOnly:!0})],Aa.prototype,"url",null),u([h()],Aa.prototype,"username",void 0),Aa=u([E("esri.portal.PortalFolder")],Aa);var tT;let ot=tT=class extends W{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.id=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.id}`:null}get url(){const t=this.portal?.restUrl;return t?`${t}/community/users/${this.id}`:null}addItem(t){const e=t&&t.item,r=t?.data,i=t?.folder,s={method:"post"};e&&(s.query=e.createPostQuery(),r!=null&&(typeof r=="string"?s.query.text=r:typeof r=="object"&&(s.query.text=JSON.stringify(r))));let n=this.userContentUrl;return i&&(n+="/"+(typeof i=="string"?i:i.id)),this.portal.request(n+"/addItem",s).then(o=>(e.id=o.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}async deleteItem(t,e=!1){let r=this.userContentUrl;t.ownerFolder&&(r+="/"+t.ownerFolder);const i=e?{permanentDelete:!0}:{};await this.portal.request(r+`/items/${t.id}/delete`,{method:"post",query:i}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const r=this.userContentUrl+"/deleteItems",i=[],s=t.map(n=>n.id);if(s.length){const n={method:"post",query:{items:s.join(","),permanentDelete:e}},o=await this.portal.request(r,n);for(const a of o.results){const l=t.find(p=>a.itemId===p.id),c=a.success;let d=null;c?(l.id=null,l.portal=null):a.error&&(d=new R("portal:delete-item-failed",a.error.message,a.error)),i.push({item:l,success:c,error:d})}}return i}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let r;return r=e&&e.folders?e.folders.map(i=>{const s=Aa.fromJSON(i);return s.portal=this.portal,s}):[],r})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(r=>{const i=Bt.fromJSON(r);return i.portal=this.portal,i}):[],e})}async fetchItems(t){t??={};let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:r}=await q(()=>Promise.resolve().then(()=>$j),void 0),i={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},s=await this.portal.request(e,{query:i});let n;return s?.items?(n=s.items.map(o=>{const a=r.fromJSON(o);return a.portal=this.portal,a}),await Promise.all(n.map(o=>o.load())),{items:n,nextStart:s.nextStart,total:s.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new Bt({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new R("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const r=this.userContentUrl,i=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(r+`/items/${t.id}/restore`,{method:"post",query:i})}toJSON(){throw new R("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new tT({sourceJSON:t});return e.read(t),e}};u([h()],ot.prototype,"access",void 0),u([h({type:Date})],ot.prototype,"created",void 0),u([h()],ot.prototype,"culture",void 0),u([h()],ot.prototype,"description",void 0),u([h()],ot.prototype,"email",void 0),u([h()],ot.prototype,"favGroupId",void 0),u([h()],ot.prototype,"fullName",void 0),u([h()],ot.prototype,"id",void 0),u([h({type:Date})],ot.prototype,"modified",void 0),u([h()],ot.prototype,"orgId",void 0),u([h()],ot.prototype,"portal",void 0),u([h()],ot.prototype,"preferredView",void 0),u([h()],ot.prototype,"privileges",void 0),u([h()],ot.prototype,"region",void 0),u([h()],ot.prototype,"role",void 0),u([h()],ot.prototype,"roleId",void 0),u([h()],ot.prototype,"sourceJSON",void 0),u([h()],ot.prototype,"thumbnail",void 0),u([h({readOnly:!0})],ot.prototype,"thumbnailUrl",null),u([h()],ot.prototype,"units",void 0),u([h({readOnly:!0})],ot.prototype,"userContentUrl",null),u([h({readOnly:!0})],ot.prototype,"url",null),u([h()],ot.prototype,"username",void 0),u([h()],ot.prototype,"userLicenseTypeId",void 0),u([h()],ot.prototype,"userType",void 0),ot=tT=u([E("esri.portal.PortalUser")],ot);var gs;let gy;const pR={PortalGroup:()=>Promise.resolve({default:Bt}),PortalItem:()=>q(()=>Promise.resolve().then(()=>$j),void 0),PortalUser:()=>Promise.resolve({default:ot})};var Ro;let J=(Ro=class extends fc(Cv){constructor(e){super(e),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.g3DTilesGalleryGroupQuery=null,this.g3dTilesEnabled=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=De.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e}destroy(){fR.unregister(this),this.defaultBasemap=xt(this.defaultBasemap),this.defaultDevBasemap=xt(this.defaultDevBasemap),this.defaultVectorBasemap=xt(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=yt(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const r of e)De.request.trustedServers.includes(r)||De.request.trustedServers.push(r);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){const e=this.user?.orgId,r=!e||this.canSearchPublic;return this.id&&!r?` AND orgid:${this.id}`:null}get hasAPIKey(){return Wz(this.restUrl)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get loaded(){return super.loaded}get restUrl(){let e=this.url;if(e){const r=e.indexOf("/sharing");e=r>0?e.slice(0,r):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,r=this.thumbnail;return e&&r?this._normalizeSSL(e+"/portals/self/resources/"+r):null}readUrlKey(e){return e&&e.toLowerCase()}readUser(e){let r=null;return e&&(r=ot.fromJSON(e),r.portal=this),r}load(e){const r=q(async()=>{const{default:i}=await Promise.resolve().then(()=>Bse);return{default:i}},void 0).then(({default:i})=>{gt(e),gy=i}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,e)).then(i=>{if(!this.hasAPIKey&&Fe){const s=Fe;this.credential=s.findCredential(this.restUrl),this.credential||this.authMode!==gs.AUTH_MODE_AUTO&&this.authMode!==gs.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=s.on("credential-create",Gte(new WeakRef(this))),fR.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(r),Promise.resolve(this)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),r=(await q(async()=>{const{default:i}=await import("./ElevationLayer-D_qCcAXd.js");return{default:i}},__vite__mapDeps([0,1,2,3,4]))).default;return e?e.map(i=>new r({id:i.id,url:i.url})):[]}async fetchBasemaps(e,r){const i=await this._fetchBasemaps(e,r);if(r?.include3d===!0&&this.use3dBasemaps!==!1){const s=await this._fetchBasemaps3D(e,r);i.unshift(...s)}return i}async fetchDefault3DBasemap(e){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const r=new Jt;r.query=this.default3DBasemapQuery,r.disableExtraQuery=!0;const i=(await this.queryItems(r,e)).results.find(s=>s.type==="Web Scene");return i?new gy({portalItem:i}):null}fetchCategorySchema(e){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",e).then(r=>r.categorySchema):xi(e)?Promise.reject(it()):Promise.resolve([])}async fetchClassificationSchema(e){return this.hasClassificationSchema?this.request(this.restUrl+"/portals/self/classification/classificationSchema",e).then(r=>r.classificationSchema):null}fetchFeaturedGroups(e){const r=this.featuredGroups,i=new Jt({num:100,sortField:"title"});if(r?.length){const s=[];for(const n of r)s.push(`(title:"${n.title}" AND owner:${n.owner})`);return i.query=s.join(" OR "),this.queryGroups(i,e).then(n=>n.results)}return xi(e)?Promise.reject(it()):Promise.resolve([])}fetchRegions(e){const r=this.user?.culture||this.culture||hs();return this.request(this.restUrl+"/portals/regions",{...e,query:{culture:r}})}fetchSettings(e){const r=this.user?.culture||this.culture||hs();return this.request(this.restUrl+"/portals/self/settings",{...e,query:{culture:r}})}static getDefault(){return Vte(()=>new gs)}queryGroups(e,r){return this.queryPortal("/community/groups",e,"PortalGroup",r)}queryItems(e,r){return this.queryPortal("/search",e,"PortalItem",r)}queryUsers(e,r){return e.sortField||(e.sortField="username"),this.queryPortal("/community/users",e,"PortalUser",r)}fetchSelf(e=this.authMode,r=!1,i){const s=this.restUrl+"/portals/self",n={authMode:e,query:{culture:hs().toLowerCase()},withCredentials:!0,...i};return n.authMode==="auto"&&(n.authMode="no-prompt"),r&&(n.query.default=!0),this.request(s,n)}queryPortal(e,r,i,s){const n=jt(Jt,r),o=a=>this.request(this.restUrl+e,{...n.toRequestOptions(this),...s}).then(l=>{const c=n.clone();return c.start=l.nextStart,new zc({nextQueryParams:c,queryParams:n,total:l.total,results:gs._resultsToTypedArray(a,{portal:this},l,s)})}).then(l=>Promise.all(l.results.map(c=>typeof c.when=="function"?c.when():l)).then(()=>l,c=>(Po(c),l)));return i&&pR[i]?pR[i]().then(({default:a})=>(gt(s),o(a))):o()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new R("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")});if(this.authMode===gs.AUTH_MODE_ANONYMOUS||this.authMode===gs.AUTH_MODE_NO_PROMPT&&!Fe)return Promise.reject(new R("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const e=r=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(r||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=r,this.fetchSelf("immediate"))):this.user&&this.credential===r?null:(this.credential=r,this.fetchSelf("immediate"))).then(i=>{i&&(this.sourceJSON=i,this.read(i))});return Fe?Fe.getCredential(this.restUrl,{prompt:this.authMode!==gs.AUTH_MODE_NO_PROMPT}).then(r=>e(r)):e(this.credential)}normalizeUrl(e){const r=this.credential?.token;return this._normalizeSSL(r?e+(e.includes("?")?"&":"?")+"token="+r:e)}requestToTypedArray(e,r,i){return this.request(e,r).then(s=>{const n=gs._resultsToTypedArray(i,{portal:this},s);return Promise.all(n.map(o=>typeof o.when=="function"?o.when():s)).then(()=>n,()=>n)})}request(e,r={}){const i={f:"json",...r.query},{authMode:s=this.authMode===gs.AUTH_MODE_ANONYMOUS||this.authMode===gs.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:n=null,cacheBust:o=!1,method:a="auto",responseType:l="json",signal:c}=r,d={authMode:s,body:n,cacheBust:o,method:a,query:i,responseType:l,timeout:0,signal:c};return r.withCredentials&&(d.withCredentials=!0),Be(this._normalizeSSL(e),d).then(p=>p.data)}toJSON(){throw new R("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new gs({sourceJSON:e})}_getHelperService(e){const r=this.helperServices?.[e];if(!r)throw new R("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return r}async _fetchBasemaps(e,r){const i=new Jt;i.query=e||(LM()?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0;const s=await this.queryGroups(i,r);if(!s.total)return[];const n=s.results[0];i.num=100,i.query='type:"Web Map" -type:"Web Application"',i.sortField=n.sortField||"name",i.sortOrder=n.sortOrder||"desc";const o=await n.queryItems(i,r);return o.total?o.results.filter(a=>a.type==="Web Map").map(a=>new gy({portalItem:a})):[]}async _fetchBasemaps3D(e,r){const i=e||this.basemapGalleryGroupQuery3D;if(!i)return[];if(LM())return[];const s=new Jt({query:i,disableExtraQuery:!0}),n=await this.queryGroups(s,r);if(!n.total)return[];const o=n.results[0];s.num=100,s.query='type:"Web Scene"',s.sortField=o.sortField||"name",s.sortOrder=o.sortOrder||"desc";const a=await o.queryItems(s,r);return a.total?a.results.filter(l=>l.type==="Web Scene").map(l=>new gy({portalItem:l})):[]}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(e){if(e){const r=gy.fromJSON(e);return r.portalItem={portal:this},r}return null}static _resultsToTypedArray(e,r,i,s){let n;if(i){const o=s!=null?s.signal:null;n=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(e||r)&&(n=n.map(a=>{const l=Object.assign(e?e.fromJSON(a):a,r);return typeof l.load=="function"&&l.load(o),l}))}else n=[];return n}},gs=Ro,Ro.AUTH_MODE_ANONYMOUS="anonymous",Ro.AUTH_MODE_AUTO="auto",Ro.AUTH_MODE_IMMEDIATE="immediate",Ro.AUTH_MODE_NO_PROMPT="no-prompt",Ro);u([h()],J.prototype,"access",void 0),u([h()],J.prototype,"allSSL",void 0),u([h()],J.prototype,"authMode",void 0),u([h()],J.prototype,"authorizedCrossOriginDomains",void 0),u([X("authorizedCrossOriginDomains")],J.prototype,"readAuthorizedCrossOriginDomains",null),u([h()],J.prototype,"basemapGalleryGroupQuery",void 0),u([h({json:{name:"3DBasemapGalleryGroupQuery"}})],J.prototype,"basemapGalleryGroupQuery3D",void 0),u([h({json:{name:"g3DTilesGalleryGroupQuery"}})],J.prototype,"g3DTilesGalleryGroupQuery",void 0),u([h({json:{name:"g3dTilesEnabled"}})],J.prototype,"g3dTilesEnabled",void 0),u([h()],J.prototype,"bingKey",void 0),u([h()],J.prototype,"canListApps",void 0),u([h()],J.prototype,"canListData",void 0),u([h()],J.prototype,"canListPreProvisionedItems",void 0),u([h()],J.prototype,"canProvisionDirectPurchase",void 0),u([h()],J.prototype,"canSearchPublic",void 0),u([h()],J.prototype,"canShareBingPublic",void 0),u([h()],J.prototype,"canSharePublic",void 0),u([h()],J.prototype,"canSignInArcGIS",void 0),u([h()],J.prototype,"canSignInIDP",void 0),u([h()],J.prototype,"colorSetsGroupQuery",void 0),u([h()],J.prototype,"commentsEnabled",void 0),u([h({type:Date})],J.prototype,"created",void 0),u([h()],J.prototype,"credential",void 0),u([h()],J.prototype,"culture",void 0),u([h()],J.prototype,"currentVersion",void 0),u([h()],J.prototype,"customBaseUrl",void 0),u([h()],J.prototype,"default3DBasemapQuery",void 0),u([h()],J.prototype,"defaultBasemap",void 0),u([X("defaultBasemap")],J.prototype,"readDefaultBasemap",null),u([h()],J.prototype,"defaultDevBasemap",void 0),u([X("defaultDevBasemap")],J.prototype,"readDefaultDevBasemap",null),u([h({type:Te})],J.prototype,"defaultExtent",void 0),u([h()],J.prototype,"defaultVectorBasemap",void 0),u([X("defaultVectorBasemap")],J.prototype,"readDefaultVectorBasemap",null),u([h()],J.prototype,"description",void 0),u([h()],J.prototype,"devBasemapGalleryGroupQuery",void 0),u([h()],J.prototype,"eueiEnabled",void 0),u([h({readOnly:!0})],J.prototype,"extraQuery",null),u([h()],J.prototype,"featuredGroups",void 0),u([h()],J.prototype,"featuredItemsGroupQuery",void 0),u([h()],J.prototype,"galleryTemplatesGroupQuery",void 0),u([h()],J.prototype,"layoutGroupQuery",void 0),u([h()],J.prototype,"livingAtlasGroupQuery",void 0),u([h({readOnly:!0})],J.prototype,"hasAPIKey",null),u([h()],J.prototype,"hasCategorySchema",void 0),u([h()],J.prototype,"hasClassificationSchema",void 0),u([h()],J.prototype,"helpBase",void 0),u([h()],J.prototype,"helperServices",void 0),u([h()],J.prototype,"helpMap",void 0),u([h()],J.prototype,"homePageFeaturedContent",void 0),u([h()],J.prototype,"homePageFeaturedContentCount",void 0),u([h()],J.prototype,"httpPort",void 0),u([h()],J.prototype,"httpsPort",void 0),u([h()],J.prototype,"id",void 0),u([h()],J.prototype,"ipCntryCode",void 0),u([h({readOnly:!0})],J.prototype,"isOrganization",null),u([h()],J.prototype,"isPortal",void 0),u([h()],J.prototype,"isReadOnly",void 0),u([h({readOnly:!0})],J.prototype,"itemPageUrl",null),u([h()],J.prototype,"layerTemplatesGroupQuery",void 0),u([h()],J.prototype,"maxTokenExpirationMinutes",void 0),u([h({type:Date})],J.prototype,"modified",void 0),u([h()],J.prototype,"name",void 0),u([h()],J.prototype,"portalHostname",void 0),u([h()],J.prototype,"portalMode",void 0),u([h()],J.prototype,"portalProperties",void 0),u([h()],J.prototype,"region",void 0),u([h()],J.prototype,"recycleBinEnabled",void 0),u([h({readOnly:!0})],J.prototype,"restUrl",null),u([h()],J.prototype,"rotatorPanels",void 0),u([h()],J.prototype,"showHomePageDescription",void 0),u([h()],J.prototype,"sourceJSON",void 0),u([h()],J.prototype,"staticImagesUrl",void 0),u([h({json:{name:"2DStylesGroupQuery"}})],J.prototype,"stylesGroupQuery2d",void 0),u([h({json:{name:"stylesGroupQuery"}})],J.prototype,"stylesGroupQuery3d",void 0),u([h()],J.prototype,"supportsHostedServices",void 0),u([h()],J.prototype,"symbolSetsGroupQuery",void 0),u([h()],J.prototype,"templatesGroupQuery",void 0),u([h()],J.prototype,"thumbnail",void 0),u([h({readOnly:!0})],J.prototype,"thumbnailUrl",null),u([h()],J.prototype,"units",void 0),u([h()],J.prototype,"url",void 0),u([h()],J.prototype,"urlKey",void 0),u([X("urlKey")],J.prototype,"readUrlKey",null),u([h()],J.prototype,"user",void 0),u([X("user")],J.prototype,"readUser",null),u([h()],J.prototype,"use3dBasemaps",void 0),u([h()],J.prototype,"useDefault3dBasemap",void 0),u([h()],J.prototype,"useStandardizedQuery",void 0),u([h()],J.prototype,"useVectorBasemaps",void 0),u([h()],J.prototype,"vectorBasemapGalleryGroupQuery",void 0),J=gs=u([E("esri.portal.Portal")],J);const fR=new FinalizationRegistry(t=>{t.remove()});function Gte(t){const e=Fe;return()=>{const r=t.deref();r&&e.findCredential(r.restUrl)&&r.signIn().catch(()=>{})}}let Ra=class extends le{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e?.portalItem&&e.path?{...e,path:mR(e.path,e.portalItem)}:e}set path(e){e!=null&&cs(e)?U.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return mR(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",r){const i=this.cdnUrl;if(i==null)throw new R("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(i,{responseType:e,query:{token:this.portalItem.apiKey,_ts:r?.cacheBust?Date.now():null},signal:r?.signal})}async update(e,r){const{addOrUpdateResources:i}=await q(()=>import("./resourceUtils-BcwkHnHQ.js"),[]);return await i(this.portalItem,[{resource:this,content:e,compress:r?.compress,access:r?.access}],"update",r),this}hasPath(){return this.path!=null}};function mR(t,e){return t==null?t:(t=t.replace(/^\/+/,""),e!=null&&cs(t)&&(t=qC(t,e.itemUrl)),t?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}u([h()],Ra.prototype,"portalItem",void 0),u([h({type:String,value:null})],Ra.prototype,"path",null),u([He("path")],Ra.prototype,"_castPath",null),u([h({type:String,readOnly:!0})],Ra.prototype,"url",null),u([h({type:String,readOnly:!0})],Ra.prototype,"cdnUrl",null),u([h({type:String,readOnly:!0})],Ra.prototype,"itemRelativeUrl",null),Ra=u([E("esri.portal.PortalItemResource")],Ra);let Ph=class extends le{constructor(e){super(e),this.created=null,this.rating=null}};u([h({type:Date})],Ph.prototype,"created",void 0),u([h()],Ph.prototype,"rating",void 0),Ph=u([E("esri.portal.PortalRating")],Ph);var jc;const qte=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Knowledge Graph Layer","Map Service","Media Layer","Scene Service","Stream Service","Video Service","Vector Tile Service","WCS","WFS","WMS","WMTS"]),Bte=new Set(["KML","GeoJson","CSV"]);let Me=jc=class extends fc(Cv){static from(t){return Um(jc,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let r=t;return t==="Feature Service"||t==="Feature Collection"?r=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?r=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?r="Scene Layer":t==="Video Service"?r="Video Layer":t==="Scene Package"?r="Scene Layer Package":t==="Stream Service"?r="Feature Layer":t==="Geoprocessing Service"?r=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geoenrichment Service"?r="GeoEnrichment Service":t==="Geocoding Service"?r="Locator":t==="Microsoft Powerpoint"?r="Microsoft PowerPoint":t==="GeoJson"?r="GeoJSON":t==="Globe Service"?r="Globe Layer":t==="Vector Tile Service"?r="Tile Layer":t==="netCDF"?r="NetCDF":t==="Map Service"?r=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t?.toLowerCase().includes("add in")?r=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?r="Big Data File Share":t==="Compact Tile Package"?r="Tile Package (tpkx)":t==="Raster function template"?r="Raster Function Template":t==="OGCFeatureServer"?r="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?r="Instant App":t==="Insights Page"?r="Insights Report":t==="Excalibur Imagery Project"?r="Excalibur Project":t==="3DTiles Service"?r="3D tiles layer":t==="3DTiles Package"&&(r="3D tiles package"),r}readExtent(t){return t&&t.length?new Te(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type?.toLowerCase()||"",e=this.typeKeywords||[],r="esri/images/portal/",i="16";let s,n=!1,o=!1,a=!1,l=!1,c=!1,d=!1,p=!1,m=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(n=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(o=e.includes("Table"),a=e.includes("Route Layer"),l=e.includes("Markup"),c=e.includes("Spatiotemporal"),d=e.includes("UtilityNetwork"),s=c&&o?"spatiotemporaltable":o?"table":a?"routelayer":l?"markup":c?"spatiotemporal":d?"utilitynetwork":n?"featureshosted":"features"):t==="map service"||t==="wms"||t==="wmts"?(c=e.includes("Spatiotemporal"),p=e.includes("Relational"),s=c||p?"mapimages":n||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages"):s=t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":t==="3dtiles service"?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":e.includes("GaussianSplat")?"gaussiansplatlayer":"3dtileslayer":"layers"):t==="web map"||t==="cityengine web scene"?s="maps":t==="web scene"?s=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?s="instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?s="apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?s="mapsgray":t==="service definition"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?s="datafiles":t==="360 vr experience"?s="360vr":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?s="appsgray":t==="arcgis pro add in"||t==="arcgis pro configuration"?s="addindesktop":t==="pdf"?s="pdf":t==="microsoft word"?s="word":t==="microsoft excel"?s="excel":t==="microsoft powerpoint"?s="ppt":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?s="datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?s="toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?s="layersgray":t==="analysis model"?s="analysismodel":t==="scene package"?s="scenepackage":t==="3dtiles package"?s="3dtileslayerpackage":t==="3dtiles service"?s="3dtileslayer":t==="mobile scene package"?s="mobilescenepackage":t==="tile package"||t==="compact tile package"?s="tilepackage":t==="task file"?s="taskfile":t==="report template"?s="report-template":t==="statistical data collection"?s="statisticaldatacollection":t==="insights workbook"?s="workbook":t==="insights model"?s="insightsmodel":t==="insights page"?s="insightspage":t==="insights theme"?s="insightstheme":t==="hub initiative"?s="hubinitiative":t==="hub page"?s="hubpage":t==="hub site application"?s="hubsite":t==="hub event"?s="hubevent":t==="hub project"?s="hubproject":t==="relational database connection"?s="relationaldatabaseconnection":t==="big data file share"?s="datastorecollection":t==="image collection"?s="imagecollection":t==="desktop style"?s="desktopstyle":t==="style"?s=e.includes("Dictionary")?"dictionarystyle":"style":t==="dashboard"?s="dashboard":t==="raster function template"?s="rasterprocessingtemplate":t==="vector tile package"?s="vectortilepackage":t==="ortho mapping project"?s="orthomappingproject":t==="ortho mapping template"?s="orthomappingtemplate":t==="solution"?s="solutions":t==="geopackage"?s="geopackage":t==="deep learning package"?s="deeplearningpackage":t==="real time analytic"?s="realtimeanalytics":t==="reality mapping project"?s="realitymappingproject":t==="big data analytic"?s="bigdataanalytics":t==="feed"?s="feed":t==="excalibur imagery project"?s="excaliburimageryproject":t==="notebook"?s="notebook":t==="storymap"?s="storymap":t==="survey123 add in"?s="survey123addin":t==="mission"?s="mission":t==="mission report"?s="missionreport":t==="mission template"?s="missiontemplate":t==="quickcapture project"?s="quickcaptureproject":t==="pro report"?s="proreport":t==="pro report template"?s="proreporttemplate":t==="urban model"?s="urbanmodel":t==="urban project"?s="urbanproject":t==="web experience"?s="experiencebuilder":t==="web experience template"?s="webexperiencetemplate":t==="experience builder widget"?s="experiencebuilderwidget":t==="experience builder widget package"?s="experiencebuilderwidgetpackage":t==="workflow"?s="workflow":t==="kernel gateway connection"?s="kernelgatewayconnection":t==="insights script"?s="insightsscript":t==="hub initiative template"?s="hubinitiativetemplate":t==="storymap theme"?s="storymaptheme":t==="knowledge graph"?s="knowledgegraph":t==="knowledge graph layer"?s="knowledgegraphlayer":t==="knowledge studio project"?s="knowledgestudio":t==="native application"?s="nativeapp":t==="native application installer"?s="nativeappinstaller":t==="web link chart"?s="linkchart":t==="knowledge graph web investigation"?s="investigation":t==="ogcfeatureserver"?s="features":t==="pro presentation"?s="propresentation":t==="pro project"?s="proproject":t==="insights workbook package"?s="insightsworkbookpackage":t==="apache parquet"?s="apacheparquet":t==="notebook code snippet library"?s="notebookcodesnippets":t==="suitability model"?s="suitabilitymodel":t==="esri classifier definition"?s="classifierdefinition":t==="esri classification schema"?s="classificationschema":t==="insights data engineering workbook"?s="dataengineeringworkbook":t==="insights data engineering model"?s="dataengineeringmodel":t==="deep learning studio project"?s="deeplearningproject":t==="discussion"?s="discussion":t==="allsource project"?s="allsourceproject":t==="api key"?s="apikey":t==="data pipeline"?s="datapipelines":t==="group layer"?(m=e.includes("Map"),s=m?"layergroup2d":"layergroup"):s=t==="media layer"?"onlinemedialayer":t==="form"?e.includes("Survey123")?"survey":"datafilesgray":t==="csv"?"csv":t==="image"?"image":t==="xr experience"?"xrexperience":"maps",s?St(r+s+i+".png"):null}get isLayer(){return this.type!=null&&qte.has(this.type)}get itemCdnUrl(){return XC(this.itemUrl)}get itemPageUrl(){const t=this.portal?.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){const t=this.portal?.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get loaded(){return super.loaded}get thumbnailUrl(){const t=this.itemUrl,e=this.thumbnail;return t&&e?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`)??null:null}get userItemUrl(){const t=this.portal?.restUrl;if(!t)return null;const e=this.owner||this.portal?.user?.id;return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=J.getDefault()),r=e.load(t).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{}).then(i=>{this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(r),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}},r=t instanceof Ph?t.rating:t;return r==null||isNaN(r)||typeof t!="number"||(e.query.rating=r),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new Ph({rating:r,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:O(this.applicationProxies),avgRating:this.avgRating,categories:O(this.categories),classification:O(this.classification),created:O(this.created),culture:this.culture,description:this.description,extent:O(this.extent),groupCategories:O(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:O(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:O(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:O(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:O(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new jc({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){const t=this.toJSON();for(const e of["tags","typeKeywords","categories"])t[e]=t[e]?.join(", ");for(const e of["extent","classification"]){const r=t[e];r&&(t[e]=JSON.stringify(r))}return t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new Ph(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},jc)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.applicationProxies&&!Object.hasOwn(t,"appProxies")&&(this.applicationProxies=null),this.sourceJSON=t,this.read(t),this))}update(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t?.data,r={method:"post"};r.query=this.createPostQuery();for(const i in r.query)r.query[i]===null&&(r.query[i]="");return r.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?r.query.text=e:typeof e=="object"&&(r.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,r).then(()=>this.reload())}):Promise.reject(new R("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new R("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:r}=this;await e.signIn();const{copyResources:i,folder:s,tags:n,title:o}=t||{},a={method:"post",query:{copyPrivateResources:i==="all",folder:typeof s=="string"?s:s?.id,includeResources:!!i,tags:n?.join(","),title:o}},{itemId:l}=await e.request(`${r}/copy`,a);return new jc({id:l,portal:e})}updateThumbnail(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t.thumbnail,r=t.filename,i={method:"post"};if(typeof e=="string")fd(e)?i.query={data:e}:i.query={url:an(e)},r!=null&&(i.query.filename=r);else{const s=new FormData;r!=null?s.append("file",e,r):s.append("file",e),i.body=s}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,i).then(()=>this.reload())}):Promise.reject(new R("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:r}=await q(()=>import("./resourceUtils-BcwkHnHQ.js"),[]);return r(this,t,e)}async addResource(t,e,r){const{addOrUpdateResources:i}=await q(()=>import("./resourceUtils-BcwkHnHQ.js"),[]);return t.portalItem=this,await i(this,[{resource:t,content:e,compress:r?.compress,access:r?.access}],"add",r),t}async removeResource(t,e){const{removeResource:r}=await q(()=>import("./resourceUtils-BcwkHnHQ.js"),[]);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new R("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return r(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await q(()=>import("./resourceUtils-BcwkHnHQ.js"),[]);return e(this,t)}resourceFromPath(t){return new Ra({portalItem:this,path:t})}toJSON(){const t=this.extent,e={accessInformation:this.accessInformation,categories:O(this.categories),classification:O(this.classification),created:this.created?.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:O(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:O(this.typeKeywords),url:this.url};return qY(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new jc({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};u([h({type:["private","shared","org","public"]})],Me.prototype,"access",void 0),u([h()],Me.prototype,"accessInformation",void 0),u([h({type:String})],Me.prototype,"apiKey",void 0),u([h({json:{read:{source:"appProxies"}}})],Me.prototype,"applicationProxies",void 0),u([h()],Me.prototype,"avgRating",void 0),u([h()],Me.prototype,"categories",void 0),u([h()],Me.prototype,"classification",void 0),u([h({type:Date})],Me.prototype,"created",void 0),u([h()],Me.prototype,"culture",void 0),u([h()],Me.prototype,"description",void 0),u([h({readOnly:!0})],Me.prototype,"displayName",null),u([h({type:Te})],Me.prototype,"extent",void 0),u([X("extent")],Me.prototype,"readExtent",null),u([h()],Me.prototype,"groupCategories",void 0),u([h({readOnly:!0})],Me.prototype,"iconUrl",null),u([h()],Me.prototype,"id",void 0),u([h({readOnly:!0})],Me.prototype,"isLayer",null),u([h({type:Boolean,readOnly:!0})],Me.prototype,"isOrgItem",void 0),u([h()],Me.prototype,"itemControl",void 0),u([h({readOnly:!0})],Me.prototype,"itemPageUrl",null),u([h({readOnly:!0})],Me.prototype,"itemUrl",null),u([h()],Me.prototype,"licenseInfo",void 0),u([h({type:Date})],Me.prototype,"modified",void 0),u([h()],Me.prototype,"name",void 0),u([h()],Me.prototype,"numComments",void 0),u([h()],Me.prototype,"numRatings",void 0),u([h()],Me.prototype,"numViews",void 0),u([h()],Me.prototype,"owner",void 0),u([h()],Me.prototype,"ownerFolder",void 0),u([h({type:J})],Me.prototype,"portal",void 0),u([h()],Me.prototype,"screenshots",void 0),u([h()],Me.prototype,"size",void 0),u([h()],Me.prototype,"snippet",void 0),u([h()],Me.prototype,"sourceJSON",void 0),u([h({type:String})],Me.prototype,"sourceUrl",void 0),u([h({type:String})],Me.prototype,"spatialReference",void 0),u([h()],Me.prototype,"tags",void 0),u([h()],Me.prototype,"thumbnail",void 0),u([h({readOnly:!0})],Me.prototype,"thumbnailUrl",null),u([h()],Me.prototype,"title",void 0),u([h()],Me.prototype,"type",void 0),u([h()],Me.prototype,"typeKeywords",void 0),u([h({type:String,json:{read(t,e){if(Bte.has(e.type)){const r=this.portal?.restUrl;t||=r&&this.id?`${r}/content/items/${this.id}/data`:null}return t}}})],Me.prototype,"url",void 0),u([h({readOnly:!0})],Me.prototype,"userItemUrl",null),Me=jc=u([E("esri.portal.PortalItem")],Me);const $j=Object.freeze(Object.defineProperty({__proto__:null,get default(){return Me}},Symbol.toStringTag,{value:"Module"})),Mj={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,nn:"no",pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function Hte(t){return t in Mj}function yR(t){if(Hte(t)){const e=Mj[t];return e===!0?t:e}return null}const Qy=[],gf=new Map;function gR(t){for(const e of gf.keys())Ej(t.pattern,e)&&gf.delete(e)}function Wte(t){return Qy.includes(t)||(gR(t),Qy.unshift(t)),je(()=>{const e=Qy.indexOf(t);e>-1&&(Qy.splice(e,1),gR(t))})}async function Tj(t){const e=hs();gf.has(t)||gf.set(t,Zte(t,e));const r=gf.get(t);return r&&await Jte.add(r),r}function Ij(t){const e=xP(t);return e?yR(t)??yR(e):null}async function Zte(t,e){const r=[];for(const i of Qy)if(Ej(i.pattern,t))try{return await i.fetchMessageBundle(t,e)}catch(s){r.push(s)}throw r.length?new R("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:r}):new R("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function Ej(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}MP(()=>{gf.clear()});const Jte=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=ps())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function Yte(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,r=await Tj("esri/t9n/basemaps");return r[t]||r[e]}const rT={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return St("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return St("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return St("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-hillshade",url:"https://services.arcgisonline.com/ArcGIS/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1},{id:"terrain-base",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/33064a20de0c48d2bb61efa8faca93a8/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Terrain Base"},{id:"terrain-reference",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/14fbc125ccc9488888b014db09f35f67/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Reference Reference",isReference:!0}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return St("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/94329802cbfa44a18f423e6f1a0b875c/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return St("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return St("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return St("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return St("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return St("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return St("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return St("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return St("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return St("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return St("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return St("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return St("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Buildings_v1/SceneServer",itemId:"cd33b09dde0a419c986ca1a78a5fc06d",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return St("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]}},to="system",sc="unknown",ga="UTC",Xte=Intl.DateTimeFormat().resolvedOptions().timeZone,vR=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class vd extends Error{}class Kte extends vd{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class Qte extends vd{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class ere extends vd{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class Qp extends vd{}class Cj extends vd{constructor(e){super(`Invalid unit ${e}`)}}class di extends vd{}class Yl extends vd{constructor(){super("Zone is an abstract class")}}const ae="numeric",ro="short",Ns="long",O1={year:ae,month:ae,day:ae},Pj={year:ae,month:ro,day:ae},tre={year:ae,month:ro,day:ae,weekday:ro},kj={year:ae,month:Ns,day:ae},Lj={year:ae,month:Ns,day:ae,weekday:Ns},Aj={hour:ae,minute:ae},Rj={hour:ae,minute:ae,second:ae},Oj={hour:ae,minute:ae,second:ae,timeZoneName:ro},Fj={hour:ae,minute:ae,second:ae,timeZoneName:Ns},Nj={hour:ae,minute:ae,hourCycle:"h23"},Dj={hour:ae,minute:ae,second:ae,hourCycle:"h23"},zj={hour:ae,minute:ae,second:ae,hourCycle:"h23",timeZoneName:ro},jj={hour:ae,minute:ae,second:ae,hourCycle:"h23",timeZoneName:Ns},Vj={year:ae,month:ae,day:ae,hour:ae,minute:ae},Uj={year:ae,month:ae,day:ae,hour:ae,minute:ae,second:ae},Gj={year:ae,month:ro,day:ae,hour:ae,minute:ae},qj={year:ae,month:ro,day:ae,hour:ae,minute:ae,second:ae},rre={year:ae,month:ro,day:ae,weekday:ro,hour:ae,minute:ae},Bj={year:ae,month:Ns,day:ae,hour:ae,minute:ae,timeZoneName:ro},Hj={year:ae,month:Ns,day:ae,hour:ae,minute:ae,second:ae,timeZoneName:ro},Wj={year:ae,month:Ns,day:ae,weekday:Ns,hour:ae,minute:ae,timeZoneName:Ns},Zj={year:ae,month:Ns,day:ae,weekday:Ns,hour:ae,minute:ae,second:ae,timeZoneName:Ns};class wd{get type(){throw new Yl}get name(){throw new Yl}get ianaName(){return this.name}get isUniversal(){throw new Yl}offsetName(e,r){throw new Yl}formatOffset(e,r){throw new Yl}offset(e){throw new Yl}equals(e){throw new Yl}get isValid(){throw new Yl}}let Fx=null;class n2 extends wd{static get instance(){return Fx===null&&(Fx=new n2),Fx}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:r,locale:i}){return nV(e,r,i)}formatOffset(e,r){return e0(this.offset(e),r)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}const iT=new Map;function ire(t){let e=iT.get(t);return e===void 0&&(e=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),iT.set(t,e)),e}const sre={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function nre(t,e){const r=t.format(e).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(r),[,s,n,o,a,l,c,d]=i;return[o,s,n,a,l,c,d]}function ore(t,e){const r=t.formatToParts(e),i=[];for(let s=0;s<r.length;s++){const{type:n,value:o}=r[s],a=sre[n];n==="era"?i[a]=o:Ce(a)||(i[a]=parseInt(o,10))}return i}const Nx=new Map;class fs extends wd{static create(e){let r=Nx.get(e);return r===void 0&&Nx.set(e,r=new fs(e)),r}static resetCache(){Nx.clear(),iT.clear()}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=fs.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:r,locale:i}){return nV(e,r,i,this.name)}formatOffset(e,r){return e0(this.offset(e),r)}offset(e){if(!this.valid)return NaN;const r=new Date(e);if(isNaN(r))return NaN;const i=ire(this.name);let[s,n,o,a,l,c,d]=i.formatToParts?ore(i,r):nre(i,r);a==="BC"&&(s=-Math.abs(s)+1);const m=a2({year:s,month:n,day:o,hour:l===24?0:l,minute:c,second:d,millisecond:0});let y=+r;const g=y%1e3;return y-=g>=0?g:1e3+g,(m-y)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let wR={};function are(t,e={}){const r=JSON.stringify([t,e]);let i=wR[r];return i||(i=new Intl.ListFormat(t,e),wR[r]=i),i}const sT=new Map;function nT(t,e={}){const r=JSON.stringify([t,e]);let i=sT.get(r);return i===void 0&&(i=new Intl.DateTimeFormat(t,e),sT.set(r,i)),i}const oT=new Map;function lre(t,e={}){const r=JSON.stringify([t,e]);let i=oT.get(r);return i===void 0&&(i=new Intl.NumberFormat(t,e),oT.set(r,i)),i}const aT=new Map;function ure(t,e={}){const{base:r,...i}=e,s=JSON.stringify([t,i]);let n=aT.get(s);return n===void 0&&(n=new Intl.RelativeTimeFormat(t,e),aT.set(s,n)),n}let eg=null;function cre(){return eg||(eg=new Intl.DateTimeFormat().resolvedOptions().locale,eg)}const lT=new Map;function Jj(t){let e=lT.get(t);return e===void 0&&(e=new Intl.DateTimeFormat(t).resolvedOptions(),lT.set(t,e)),e}const uT=new Map;function hre(t){let e=uT.get(t);if(!e){const r=new Intl.Locale(t);e="getWeekInfo"in r?r.getWeekInfo():r.weekInfo,"minimalDays"in e||(e={...Yj,...e}),uT.set(t,e)}return e}function dre(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const r=t.indexOf("-u-");if(r===-1)return[t];{let i,s;try{i=nT(t).resolvedOptions(),s=t}catch{const l=t.substring(0,r);i=nT(l).resolvedOptions(),s=l}const{numberingSystem:n,calendar:o}=i;return[s,n,o]}}function pre(t,e,r){return(r||e)&&(t.includes("-u-")||(t+="-u"),r&&(t+=`-ca-${r}`),e&&(t+=`-nu-${e}`)),t}function fre(t){const e=[];for(let r=1;r<=12;r++){const i=ue.utc(2009,r,1);e.push(t(i))}return e}function mre(t){const e=[];for(let r=1;r<=7;r++){const i=ue.utc(2016,11,13+r);e.push(t(i))}return e}function dw(t,e,r,i){const s=t.listingMode();return s==="error"?null:s==="en"?r(e):i(e)}function yre(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||Jj(t.locale).numberingSystem==="latn"}class gre{constructor(e,r,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;const{padTo:s,floor:n,...o}=i;if(!r||Object.keys(o).length>0){const a={useGrouping:!1,...i};i.padTo>0&&(a.minimumIntegerDigits=i.padTo),this.inf=lre(e,a)}}format(e){if(this.inf){const r=this.floor?Math.floor(e):e;return this.inf.format(r)}else{const r=this.floor?Math.floor(e):PP(e,3);return dr(r,this.padTo)}}}class vre{constructor(e,r,i){this.opts=i,this.originalZone=void 0;let s;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&fs.create(a).valid?(s=a,this.dt=e):(s="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,s=e.zone.name):(s="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const n={...this.opts};n.timeZone=n.timeZone||s,this.dtf=nT(r,n)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(r=>{if(r.type==="timeZoneName"){const i=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...r,value:i}}else return r}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class wre{constructor(e,r,i){this.opts={style:"long",...i},!r&&iV()&&(this.rtf=ure(e,i))}format(e,r){return this.rtf?this.rtf.format(e,r):Vre(r,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,r){return this.rtf?this.rtf.formatToParts(e,r):[]}}const Yj={firstDay:1,minimalDays:4,weekend:[6,7]};class at{static fromOpts(e){return at.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,r,i,s,n=!1){const o=e||Yt.defaultLocale,a=o||(n?"en-US":cre()),l=r||Yt.defaultNumberingSystem,c=i||Yt.defaultOutputCalendar,d=hT(s)||Yt.defaultWeekSettings;return new at(a,l,c,d,o)}static resetCache(){eg=null,sT.clear(),oT.clear(),aT.clear(),lT.clear(),uT.clear()}static fromObject({locale:e,numberingSystem:r,outputCalendar:i,weekSettings:s}={}){return at.create(e,r,i,s)}constructor(e,r,i,s,n){const[o,a,l]=dre(e);this.locale=o,this.numberingSystem=r||a||null,this.outputCalendar=i||l||null,this.weekSettings=s,this.intl=pre(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=yre(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),r=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&r?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:at.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,hT(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,r=!1){return dw(this,e,lV,()=>{const i=this.intl==="ja"||this.intl.startsWith("ja-");r&=!i;const s=r?{month:e,day:"numeric"}:{month:e},n=r?"format":"standalone";if(!this.monthsCache[n][e]){const o=i?a=>this.dtFormatter(a,s).format():a=>this.extract(a,s,"month");this.monthsCache[n][e]=fre(o)}return this.monthsCache[n][e]})}weekdays(e,r=!1){return dw(this,e,hV,()=>{const i=r?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},s=r?"format":"standalone";return this.weekdaysCache[s][e]||(this.weekdaysCache[s][e]=mre(n=>this.extract(n,i,"weekday"))),this.weekdaysCache[s][e]})}meridiems(){return dw(this,void 0,()=>dV,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[ue.utc(2016,11,13,9),ue.utc(2016,11,13,19)].map(r=>this.extract(r,e,"dayperiod"))}return this.meridiemCache})}eras(e){return dw(this,e,pV,()=>{const r={era:e};return this.eraCache[e]||(this.eraCache[e]=[ue.utc(-40,1,1),ue.utc(2017,1,1)].map(i=>this.extract(i,r,"era"))),this.eraCache[e]})}extract(e,r,i){const s=this.dtFormatter(e,r),n=s.formatToParts(),o=n.find(a=>a.type.toLowerCase()===i);return o?o.value:null}numberFormatter(e={}){return new gre(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,r={}){return new vre(e,this.intl,r)}relFormatter(e={}){return new wre(this.intl,this.isEnglish(),e)}listFormatter(e={}){return are(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||Jj(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:sV()?hre(this.locale):Yj}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let Dx=null;class mr extends wd{static get utcInstance(){return Dx===null&&(Dx=new mr(0)),Dx}static instance(e){return e===0?mr.utcInstance:new mr(e)}static parseSpecifier(e){if(e){const r=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r)return new mr(l2(r[1],r[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${e0(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${e0(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,r){return e0(this.fixed,r)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class _re extends wd{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Pu(t,e){if(Ce(t)||t===null)return e;if(t instanceof wd)return t;if(Tre(t)){const r=t.toLowerCase();return r==="default"?e:r==="local"||r==="system"?n2.instance:r==="utc"||r==="gmt"?mr.utcInstance:mr.parseSpecifier(r)||fs.create(t)}else return Hu(t)?mr.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new _re(t)}const TP={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},_R={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},bre=TP.hanidec.replace(/[\[|\]]/g,"").split("");function Sre(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);if(t[r].search(TP.hanidec)!==-1)e+=bre.indexOf(t[r]);else for(const s in _R){const[n,o]=_R[s];i>=n&&i<=o&&(e+=i-n)}}return parseInt(e,10)}else return e}const cT=new Map;function xre(){cT.clear()}function xn({numberingSystem:t},e=""){const r=t||"latn";let i=cT.get(r);i===void 0&&(i=new Map,cT.set(r,i));let s=i.get(e);return s===void 0&&(s=new RegExp(`${TP[r]}${e}`),i.set(e,s)),s}let bR=()=>Date.now(),SR="system",xR=null,$R=null,MR=null,TR=60,IR,ER=null;class Yt{static get now(){return bR}static set now(e){bR=e}static set defaultZone(e){SR=e}static get defaultZone(){return Pu(SR,n2.instance)}static get defaultLocale(){return xR}static set defaultLocale(e){xR=e}static get defaultNumberingSystem(){return $R}static set defaultNumberingSystem(e){$R=e}static get defaultOutputCalendar(){return MR}static set defaultOutputCalendar(e){MR=e}static get defaultWeekSettings(){return ER}static set defaultWeekSettings(e){ER=hT(e)}static get twoDigitCutoffYear(){return TR}static set twoDigitCutoffYear(e){TR=e%100}static get throwOnInvalid(){return IR}static set throwOnInvalid(e){IR=e}static resetCaches(){at.resetCache(),fs.resetCache(),ue.resetCache(),xre()}}class Yn{constructor(e,r){this.reason=e,this.explanation=r}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const Xj=[0,31,59,90,120,151,181,212,243,273,304,334],Kj=[0,31,60,91,121,152,182,213,244,274,305,335];function un(t,e){return new Yn("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function IP(t,e,r){const i=new Date(Date.UTC(t,e-1,r));t<100&&t>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);const s=i.getUTCDay();return s===0?7:s}function Qj(t,e,r){return r+(Lv(t)?Kj:Xj)[e-1]}function eV(t,e){const r=Lv(t)?Kj:Xj,i=r.findIndex(n=>n<e),s=e-r[i];return{month:i+1,day:s}}function EP(t,e){return(t-e+7)%7+1}function F1(t,e=4,r=1){const{year:i,month:s,day:n}=t,o=Qj(i,s,n),a=EP(IP(i,s,n),r);let l=Math.floor((o-a+14-e)/7),c;return l<1?(c=i-1,l=z0(c,e,r)):l>z0(i,e,r)?(c=i+1,l=1):c=i,{weekYear:c,weekNumber:l,weekday:a,...u2(t)}}function CR(t,e=4,r=1){const{weekYear:i,weekNumber:s,weekday:n}=t,o=EP(IP(i,1,e),r),a=vf(i);let l=s*7+n-o-7+e,c;l<1?(c=i-1,l+=vf(c)):l>a?(c=i+1,l-=vf(i)):c=i;const{month:d,day:p}=eV(c,l);return{year:c,month:d,day:p,...u2(t)}}function zx(t){const{year:e,month:r,day:i}=t,s=Qj(e,r,i);return{year:e,ordinal:s,...u2(t)}}function PR(t){const{year:e,ordinal:r}=t,{month:i,day:s}=eV(e,r);return{year:e,month:i,day:s,...u2(t)}}function kR(t,e){if(!Ce(t.localWeekday)||!Ce(t.localWeekNumber)||!Ce(t.localWeekYear)){if(!Ce(t.weekday)||!Ce(t.weekNumber)||!Ce(t.weekYear))throw new Qp("Cannot mix locale-based week fields with ISO-based week fields");return Ce(t.localWeekday)||(t.weekday=t.localWeekday),Ce(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),Ce(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function $re(t,e=4,r=1){const i=o2(t.weekYear),s=cn(t.weekNumber,1,z0(t.weekYear,e,r)),n=cn(t.weekday,1,7);return i?s?n?!1:un("weekday",t.weekday):un("week",t.weekNumber):un("weekYear",t.weekYear)}function Mre(t){const e=o2(t.year),r=cn(t.ordinal,1,vf(t.year));return e?r?!1:un("ordinal",t.ordinal):un("year",t.year)}function tV(t){const e=o2(t.year),r=cn(t.month,1,12),i=cn(t.day,1,N1(t.year,t.month));return e?r?i?!1:un("day",t.day):un("month",t.month):un("year",t.year)}function rV(t){const{hour:e,minute:r,second:i,millisecond:s}=t,n=cn(e,0,23)||e===24&&r===0&&i===0&&s===0,o=cn(r,0,59),a=cn(i,0,59),l=cn(s,0,999);return n?o?a?l?!1:un("millisecond",s):un("second",i):un("minute",r):un("hour",e)}function Ce(t){return typeof t>"u"}function Hu(t){return typeof t=="number"}function o2(t){return typeof t=="number"&&t%1===0}function Tre(t){return typeof t=="string"}function Ire(t){return Object.prototype.toString.call(t)==="[object Date]"}function iV(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function sV(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function Ere(t){return Array.isArray(t)?t:[t]}function LR(t,e,r){if(t.length!==0)return t.reduce((i,s)=>{const n=[e(s),s];return i&&r(i[0],n[0])===i[0]?i:n},null)[1]}function Cre(t,e){return e.reduce((r,i)=>(r[i]=t[i],r),{})}function gm(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function hT(t){if(t==null)return null;if(typeof t!="object")throw new di("Week settings must be an object");if(!cn(t.firstDay,1,7)||!cn(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!cn(e,1,7)))throw new di("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function cn(t,e,r){return o2(t)&&t>=e&&t<=r}function Pre(t,e){return t-e*Math.floor(t/e)}function dr(t,e=2){const r=t<0;let i;return r?i="-"+(""+-t).padStart(e,"0"):i=(""+t).padStart(e,"0"),i}function Su(t){if(!(Ce(t)||t===null||t===""))return parseInt(t,10)}function $c(t){if(!(Ce(t)||t===null||t===""))return parseFloat(t)}function CP(t){if(!(Ce(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function PP(t,e,r="round"){const i=10**e;switch(r){case"expand":return t>0?Math.ceil(t*i)/i:Math.floor(t*i)/i;case"trunc":return Math.trunc(t*i)/i;case"round":return Math.round(t*i)/i;case"floor":return Math.floor(t*i)/i;case"ceil":return Math.ceil(t*i)/i;default:throw new RangeError(`Value rounding ${r} is out of range`)}}function Lv(t){return t%4===0&&(t%100!==0||t%400===0)}function vf(t){return Lv(t)?366:365}function N1(t,e){const r=Pre(e-1,12)+1,i=t+(e-r)/12;return r===2?Lv(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][r-1]}function a2(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function AR(t,e,r){return-EP(IP(t,1,e),r)+e-1}function z0(t,e=4,r=1){const i=AR(t,e,r),s=AR(t+1,e,r);return(vf(t)-i+s)/7}function dT(t){return t>99?t:t>Yt.twoDigitCutoffYear?1900+t:2e3+t}function nV(t,e,r,i=null){const s=new Date(t),n={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(n.timeZone=i);const o={timeZoneName:e,...n},a=new Intl.DateTimeFormat(r,o).formatToParts(s).find(l=>l.type.toLowerCase()==="timezonename");return a?a.value:null}function l2(t,e){let r=parseInt(t,10);Number.isNaN(r)&&(r=0);const i=parseInt(e,10)||0,s=r<0||Object.is(r,-0)?-i:i;return r*60+s}function oV(t){const e=Number(t);if(typeof t=="boolean"||t===""||!Number.isFinite(e))throw new di(`Invalid unit value ${t}`);return e}function D1(t,e){const r={};for(const i in t)if(gm(t,i)){const s=t[i];if(s==null)continue;r[e(i)]=oV(s)}return r}function e0(t,e){const r=Math.trunc(Math.abs(t/60)),i=Math.trunc(Math.abs(t%60)),s=t>=0?"+":"-";switch(e){case"short":return`${s}${dr(r,2)}:${dr(i,2)}`;case"narrow":return`${s}${r}${i>0?`:${i}`:""}`;case"techie":return`${s}${dr(r,2)}${dr(i,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function u2(t){return Cre(t,["hour","minute","second","millisecond"])}const kre=["January","February","March","April","May","June","July","August","September","October","November","December"],aV=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Lre=["J","F","M","A","M","J","J","A","S","O","N","D"];function lV(t){switch(t){case"narrow":return[...Lre];case"short":return[...aV];case"long":return[...kre];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const uV=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],cV=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Are=["M","T","W","T","F","S","S"];function hV(t){switch(t){case"narrow":return[...Are];case"short":return[...cV];case"long":return[...uV];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const dV=["AM","PM"],Rre=["Before Christ","Anno Domini"],Ore=["BC","AD"],Fre=["B","A"];function pV(t){switch(t){case"narrow":return[...Fre];case"short":return[...Ore];case"long":return[...Rre];default:return null}}function Nre(t){return dV[t.hour<12?0:1]}function Dre(t,e){return hV(e)[t.weekday-1]}function zre(t,e){return lV(e)[t.month-1]}function jre(t,e){return pV(e)[t.year<0?0:1]}function Vre(t,e,r="always",i=!1){const s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},n=["hours","minutes","seconds"].indexOf(t)===-1;if(r==="auto"&&n){const p=t==="days";switch(e){case 1:return p?"tomorrow":`next ${s[t][0]}`;case-1:return p?"yesterday":`last ${s[t][0]}`;case 0:return p?"today":`this ${s[t][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),l=a===1,c=s[t],d=i?l?c[1]:c[2]||c[1]:l?s[t][0]:t;return o?`${a} ${d} ago`:`in ${a} ${d}`}function RR(t,e){let r="";for(const i of t)i.literal?r+=i.val:r+=e(i.val);return r}const Ure={D:O1,DD:Pj,DDD:kj,DDDD:Lj,t:Aj,tt:Rj,ttt:Oj,tttt:Fj,T:Nj,TT:Dj,TTT:zj,TTTT:jj,f:Vj,ff:Gj,fff:Bj,ffff:Wj,F:Uj,FF:qj,FFF:Hj,FFFF:Zj};class bi{static create(e,r={}){return new bi(e,r)}static parseFormat(e){let r=null,i="",s=!1;const n=[];for(let o=0;o<e.length;o++){const a=e.charAt(o);a==="'"?((i.length>0||s)&&n.push({literal:s||/^\s+$/.test(i),val:i===""?"'":i}),r=null,i="",s=!s):s||a===r?i+=a:(i.length>0&&n.push({literal:/^\s+$/.test(i),val:i}),i=a,r=a)}return i.length>0&&n.push({literal:s||/^\s+$/.test(i),val:i}),n}static macroTokenToFormatOpts(e){return Ure[e]}constructor(e,r){this.opts=r,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,r){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...r}).format()}dtFormatter(e,r={}){return this.loc.dtFormatter(e,{...this.opts,...r})}formatDateTime(e,r){return this.dtFormatter(e,r).format()}formatDateTimeParts(e,r){return this.dtFormatter(e,r).formatToParts()}formatInterval(e,r){return this.dtFormatter(e.start,r).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,r){return this.dtFormatter(e,r).resolvedOptions()}num(e,r=0,i=void 0){if(this.opts.forceSimple)return dr(e,r);const s={...this.opts};return r>0&&(s.padTo=r),i&&(s.signDisplay=i),this.loc.numberFormatter(s).format(e)}formatDateTimeFromString(e,r){const i=this.loc.listingMode()==="en",s=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",n=(y,g)=>this.loc.extract(e,y,g),o=y=>e.isOffsetFixed&&e.offset===0&&y.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,y.format):"",a=()=>i?Nre(e):n({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(y,g)=>i?zre(e,y):n(g?{month:y}:{month:y,day:"numeric"},"month"),c=(y,g)=>i?Dre(e,y):n(g?{weekday:y}:{weekday:y,month:"long",day:"numeric"},"weekday"),d=y=>{const g=bi.macroTokenToFormatOpts(y);return g?this.formatWithSystemDefault(e,g):y},p=y=>i?jre(e,y):n({era:y},"era"),m=y=>{switch(y){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return s?n({day:"numeric"},"day"):this.num(e.day);case"dd":return s?n({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return s?n({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return s?n({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return s?n({month:"numeric"},"month"):this.num(e.month);case"MM":return s?n({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return s?n({year:"numeric"},"year"):this.num(e.year);case"yy":return s?n({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return s?n({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return s?n({year:"numeric"},"year"):this.num(e.year,6);case"G":return p("short");case"GG":return p("long");case"GGGGG":return p("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return d(y)}};return RR(bi.parseFormat(r),m)}formatDurationFromString(e,r){const i=this.opts.signMode==="negativeLargestOnly"?-1:1,s=d=>{switch(d[0]){case"S":return"milliseconds";case"s":return"seconds";case"m":return"minutes";case"h":return"hours";case"d":return"days";case"w":return"weeks";case"M":return"months";case"y":return"years";default:return null}},n=(d,p)=>m=>{const y=s(m);if(y){const g=p.isNegativeDuration&&y!==p.largestUnit?i:1;let v;return this.opts.signMode==="negativeLargestOnly"&&y!==p.largestUnit?v="never":this.opts.signMode==="all"?v="always":v="auto",this.num(d.get(y)*g,m.length,v)}else return m},o=bi.parseFormat(r),a=o.reduce((d,{literal:p,val:m})=>p?d:d.concat(m),[]),l=e.shiftTo(...a.map(s).filter(d=>d)),c={isNegativeDuration:l<0,largestUnit:Object.keys(l.values)[0]};return RR(o,n(l,c))}}const fV=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Hm(...t){const e=t.reduce((r,i)=>r+i.source,"");return RegExp(`^${e}$`)}function Wm(...t){return e=>t.reduce(([r,i,s],n)=>{const[o,a,l]=n(e,s);return[{...r,...o},a||i,l]},[{},null,1]).slice(0,2)}function Zm(t,...e){if(t==null)return[null,null];for(const[r,i]of e){const s=r.exec(t);if(s)return i(s)}return[null,null]}function mV(...t){return(e,r)=>{const i={};let s;for(s=0;s<t.length;s++)i[t[s]]=Su(e[r+s]);return[i,null,r+s]}}const yV=/(?:([Zz])|([+-]\d\d)(?::?(\d\d))?)/,Gre=`(?:${yV.source}?(?:\\[(${fV.source})\\])?)?`,kP=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,gV=RegExp(`${kP.source}${Gre}`),LP=RegExp(`(?:[Tt]${gV.source})?`),qre=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Bre=/(\d{4})-?W(\d\d)(?:-?(\d))?/,Hre=/(\d{4})-?(\d{3})/,Wre=mV("weekYear","weekNumber","weekDay"),Zre=mV("year","ordinal"),Jre=/(\d{4})-(\d\d)-(\d\d)/,vV=RegExp(`${kP.source} ?(?:${yV.source}|(${fV.source}))?`),Yre=RegExp(`(?: ${vV.source})?`);function wf(t,e,r){const i=t[e];return Ce(i)?r:Su(i)}function Xre(t,e){return[{year:wf(t,e),month:wf(t,e+1,1),day:wf(t,e+2,1)},null,e+3]}function Jm(t,e){return[{hours:wf(t,e,0),minutes:wf(t,e+1,0),seconds:wf(t,e+2,0),milliseconds:CP(t[e+3])},null,e+4]}function Av(t,e){const r=!t[e]&&!t[e+1],i=l2(t[e+1],t[e+2]),s=r?null:mr.instance(i);return[{},s,e+3]}function Rv(t,e){const r=t[e]?fs.create(t[e]):null;return[{},r,e+1]}const Kre=RegExp(`^T?${kP.source}$`),Qre=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function eie(t){const[e,r,i,s,n,o,a,l,c]=t,d=e[0]==="-",p=l&&l[0]==="-",m=(y,g=!1)=>y!==void 0&&(g||y&&d)?-y:y;return[{years:m($c(r)),months:m($c(i)),weeks:m($c(s)),days:m($c(n)),hours:m($c(o)),minutes:m($c(a)),seconds:m($c(l),l==="-0"),milliseconds:m(CP(c),p)}]}const tie={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function AP(t,e,r,i,s,n,o){const a={year:e.length===2?dT(Su(e)):Su(e),month:aV.indexOf(r)+1,day:Su(i),hour:Su(s),minute:Su(n)};return o&&(a.second=Su(o)),t&&(a.weekday=t.length>3?uV.indexOf(t)+1:cV.indexOf(t)+1),a}const rie=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function iie(t){const[,e,r,i,s,n,o,a,l,c,d,p]=t,m=AP(e,s,i,r,n,o,a);let y;return l?y=tie[l]:c?y=0:y=l2(d,p),[m,new mr(y)]}function sie(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const nie=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,oie=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,aie=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function OR(t){const[,e,r,i,s,n,o,a]=t;return[AP(e,s,i,r,n,o,a),mr.utcInstance]}function lie(t){const[,e,r,i,s,n,o,a]=t;return[AP(e,a,r,i,s,n,o),mr.utcInstance]}const uie=Hm(qre,LP),cie=Hm(Bre,LP),hie=Hm(Hre,LP),die=Hm(gV),wV=Wm(Xre,Jm,Av,Rv),pie=Wm(Wre,Jm,Av,Rv),fie=Wm(Zre,Jm,Av,Rv),mie=Wm(Jm,Av,Rv);function yie(t){return Zm(t,[uie,wV],[cie,pie],[hie,fie],[die,mie])}function gie(t){return Zm(sie(t),[rie,iie])}function vie(t){return Zm(t,[nie,OR],[oie,OR],[aie,lie])}function wie(t){return Zm(t,[Qre,eie])}const _ie=Wm(Jm);function bie(t){return Zm(t,[Kre,_ie])}const Sie=Hm(Jre,Yre),xie=Hm(vV),$ie=Wm(Jm,Av,Rv);function Mie(t){return Zm(t,[Sie,wV],[xie,$ie])}const FR="Invalid Duration",_V={weeks:{days:7,hours:168,minutes:10080,seconds:10080*60,milliseconds:10080*60*1e3},days:{hours:24,minutes:1440,seconds:1440*60,milliseconds:1440*60*1e3},hours:{minutes:60,seconds:3600,milliseconds:3600*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},Tie={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:2184*60,seconds:2184*60*60,milliseconds:2184*60*60*1e3},months:{weeks:4,days:30,hours:720,minutes:720*60,seconds:720*60*60,milliseconds:720*60*60*1e3},..._V},qs=146097/400,Ld=146097/4800,Iie={years:{quarters:4,months:12,weeks:qs/7,days:qs,hours:qs*24,minutes:qs*24*60,seconds:qs*24*60*60,milliseconds:qs*24*60*60*1e3},quarters:{months:3,weeks:qs/28,days:qs/4,hours:qs*24/4,minutes:qs*24*60/4,seconds:qs*24*60*60/4,milliseconds:qs*24*60*60*1e3/4},months:{weeks:Ld/7,days:Ld,hours:Ld*24,minutes:Ld*24*60,seconds:Ld*24*60*60,milliseconds:Ld*24*60*60*1e3},..._V},kh=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],Eie=kh.slice(0).reverse();function xa(t,e,r=!1){const i={values:r?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new Je(i)}function bV(t,e){let r=e.milliseconds??0;for(const i of Eie.slice(1))e[i]&&(r+=e[i]*t[i].milliseconds);return r}function NR(t,e){const r=bV(t,e)<0?-1:1;kh.reduceRight((i,s)=>{if(Ce(e[s]))return i;if(i){const n=e[i]*r,o=t[s][i],a=Math.floor(n/o);e[s]+=a*r,e[i]-=a*o*r}return s},null),kh.reduce((i,s)=>{if(Ce(e[s]))return i;if(i){const n=e[i]%1;e[i]-=n,e[s]+=n*t[i][s]}return s},null)}function DR(t){const e={};for(const[r,i]of Object.entries(t))i!==0&&(e[r]=i);return e}class Je{constructor(e){const r=e.conversionAccuracy==="longterm"||!1;let i=r?Iie:Tie;e.matrix&&(i=e.matrix),this.values=e.values,this.loc=e.loc||at.create(),this.conversionAccuracy=r?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(e,r){return Je.fromObject({milliseconds:e},r)}static fromObject(e,r={}){if(e==null||typeof e!="object")throw new di(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new Je({values:D1(e,Je.normalizeUnit),loc:at.fromObject(r),conversionAccuracy:r.conversionAccuracy,matrix:r.matrix})}static fromDurationLike(e){if(Hu(e))return Je.fromMillis(e);if(Je.isDuration(e))return e;if(typeof e=="object")return Je.fromObject(e);throw new di(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,r){const[i]=wie(e);return i?Je.fromObject(i,r):Je.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,r){const[i]=bie(e);return i?Je.fromObject(i,r):Je.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,r=null){if(!e)throw new di("need to specify a reason the Duration is invalid");const i=e instanceof Yn?e:new Yn(e,r);if(Yt.throwOnInvalid)throw new ere(i);return new Je({invalid:i})}static normalizeUnit(e){const r={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!r)throw new Cj(e);return r}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,r={}){const i={...r,floor:r.round!==!1&&r.floor!==!1};return this.isValid?bi.create(this.loc,i).formatDurationFromString(this,e):FR}toHuman(e={}){if(!this.isValid)return FR;const r=e.showZeros!==!1,i=kh.map(s=>{const n=this.values[s];return Ce(n)||n===0&&!r?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:s.slice(0,-1)}).format(n)}).filter(s=>s);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=PP(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const r=this.toMillis();return r<0||r>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},ue.fromMillis(r,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?bV(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const r=Je.fromDurationLike(e),i={};for(const s of kh)(gm(r.values,s)||gm(this.values,s))&&(i[s]=r.get(s)+this.get(s));return xa(this,{values:i},!0)}minus(e){if(!this.isValid)return this;const r=Je.fromDurationLike(e);return this.plus(r.negate())}mapUnits(e){if(!this.isValid)return this;const r={};for(const i of Object.keys(this.values))r[i]=oV(e(this.values[i],i));return xa(this,{values:r},!0)}get(e){return this[Je.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const r={...this.values,...D1(e,Je.normalizeUnit)};return xa(this,{values:r})}reconfigure({locale:e,numberingSystem:r,conversionAccuracy:i,matrix:s}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:r}),matrix:s,conversionAccuracy:i};return xa(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return NR(this.matrix,e),xa(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=DR(this.normalize().shiftToAll().toObject());return xa(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>Je.normalizeUnit(o));const r={},i={},s=this.toObject();let n;for(const o of kh)if(e.indexOf(o)>=0){n=o;let a=0;for(const c in i)a+=this.matrix[c][o]*i[c],i[c]=0;Hu(s[o])&&(a+=s[o]);const l=Math.trunc(a);r[o]=l,i[o]=(a*1e3-l*1e3)/1e3}else Hu(s[o])&&(i[o]=s[o]);for(const o in i)i[o]!==0&&(r[n]+=o===n?i[o]:i[o]/this.matrix[n][o]);return NR(this.matrix,r),xa(this,{values:r},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const r of Object.keys(this.values))e[r]=this.values[r]===0?0:-this.values[r];return xa(this,{values:e},!0)}removeZeros(){if(!this.isValid)return this;const e=DR(this.values);return xa(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function r(i,s){return i===void 0||i===0?s===void 0||s===0:i===s}for(const i of kh)if(!r(this.values[i],e.values[i]))return!1;return!0}}const Ad="Invalid Interval";function Cie(t,e){return!t||!t.isValid?Ht.invalid("missing or invalid start"):!e||!e.isValid?Ht.invalid("missing or invalid end"):e<t?Ht.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class Ht{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,r=null){if(!e)throw new di("need to specify a reason the Interval is invalid");const i=e instanceof Yn?e:new Yn(e,r);if(Yt.throwOnInvalid)throw new Qte(i);return new Ht({invalid:i})}static fromDateTimes(e,r){const i=vy(e),s=vy(r),n=Cie(i,s);return n??new Ht({start:i,end:s})}static after(e,r){const i=Je.fromDurationLike(r),s=vy(e);return Ht.fromDateTimes(s,s.plus(i))}static before(e,r){const i=Je.fromDurationLike(r),s=vy(e);return Ht.fromDateTimes(s.minus(i),s)}static fromISO(e,r){const[i,s]=(e||"").split("/",2);if(i&&s){let n,o;try{n=ue.fromISO(i,r),o=n.isValid}catch{o=!1}let a,l;try{a=ue.fromISO(s,r),l=a.isValid}catch{l=!1}if(o&&l)return Ht.fromDateTimes(n,a);if(o){const c=Je.fromISO(s,r);if(c.isValid)return Ht.after(n,c)}else if(l){const c=Je.fromISO(i,r);if(c.isValid)return Ht.before(a,c)}}return Ht.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",r){if(!this.isValid)return NaN;const i=this.start.startOf(e,r);let s;return r?.useLocaleWeeks?s=this.end.reconfigure({locale:i.locale}):s=this.end,s=s.startOf(e,r),Math.floor(s.diff(i,e).get(e))+(s.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:r}={}){return this.isValid?Ht.fromDateTimes(e||this.s,r||this.e):this}splitAt(...e){if(!this.isValid)return[];const r=e.map(vy).filter(o=>this.contains(o)).sort((o,a)=>o.toMillis()-a.toMillis()),i=[];let{s}=this,n=0;for(;s<this.e;){const o=r[n]||this.e,a=+o>+this.e?this.e:o;i.push(Ht.fromDateTimes(s,a)),s=a,n+=1}return i}splitBy(e){const r=Je.fromDurationLike(e);if(!this.isValid||!r.isValid||r.as("milliseconds")===0)return[];let{s:i}=this,s=1,n;const o=[];for(;i<this.e;){const a=this.start.plus(r.mapUnits(l=>l*s));n=+a>+this.e?this.e:a,o.push(Ht.fromDateTimes(i,n)),i=n,s+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const r=this.s>e.s?this.s:e.s,i=this.e<e.e?this.e:e.e;return r>=i?null:Ht.fromDateTimes(r,i)}union(e){if(!this.isValid)return this;const r=this.s<e.s?this.s:e.s,i=this.e>e.e?this.e:e.e;return Ht.fromDateTimes(r,i)}static merge(e){const[r,i]=e.sort((s,n)=>s.s-n.s).reduce(([s,n],o)=>n?n.overlaps(o)||n.abutsStart(o)?[s,n.union(o)]:[s.concat([n]),o]:[s,o],[[],null]);return i&&r.push(i),r}static xor(e){let r=null,i=0;const s=[],n=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),o=Array.prototype.concat(...n),a=o.sort((l,c)=>l.time-c.time);for(const l of a)i+=l.type==="s"?1:-1,i===1?r=l.time:(r&&+r!=+l.time&&s.push(Ht.fromDateTimes(r,l.time)),r=null);return Ht.merge(s)}difference(...e){return Ht.xor([this].concat(e)).map(r=>this.intersection(r)).filter(r=>r&&!r.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:Ad}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=O1,r={}){return this.isValid?bi.create(this.s.loc.clone(r),e).formatInterval(this):Ad}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:Ad}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Ad}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:Ad}toFormat(e,{separator:r="  "}={}){return this.isValid?`${this.s.toFormat(e)}${r}${this.e.toFormat(e)}`:Ad}toDuration(e,r){return this.isValid?this.e.diff(this.s,e,r):Je.invalid(this.invalidReason)}mapEndpoints(e){return Ht.fromDateTimes(e(this.s),e(this.e))}}class pw{static hasDST(e=Yt.defaultZone){const r=ue.now().setZone(e).set({month:12});return!e.isUniversal&&r.offset!==r.set({month:6}).offset}static isValidIANAZone(e){return fs.isValidZone(e)}static normalizeZone(e){return Pu(e,Yt.defaultZone)}static getStartOfWeek({locale:e=null,locObj:r=null}={}){return(r||at.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:r=null}={}){return(r||at.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:r=null}={}){return(r||at.create(e)).getWeekendDays().slice()}static months(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null,outputCalendar:n="gregory"}={}){return(s||at.create(r,i,n)).months(e)}static monthsFormat(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null,outputCalendar:n="gregory"}={}){return(s||at.create(r,i,n)).months(e,!0)}static weekdays(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null}={}){return(s||at.create(r,i,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:r=null,numberingSystem:i=null,locObj:s=null}={}){return(s||at.create(r,i,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return at.create(e).meridiems()}static eras(e="short",{locale:r=null}={}){return at.create(r,null,"gregory").eras(e)}static features(){return{relative:iV(),localeWeek:sV()}}}function zR(t,e){const r=s=>s.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=r(e)-r(t);return Math.floor(Je.fromMillis(i).as("days"))}function Pie(t,e,r){const i=[["years",(l,c)=>c.year-l.year],["quarters",(l,c)=>c.quarter-l.quarter+(c.year-l.year)*4],["months",(l,c)=>c.month-l.month+(c.year-l.year)*12],["weeks",(l,c)=>{const d=zR(l,c);return(d-d%7)/7}],["days",zR]],s={},n=t;let o,a;for(const[l,c]of i)r.indexOf(l)>=0&&(o=l,s[l]=c(t,e),a=n.plus(s),a>e?(s[l]--,t=n.plus(s),t>e&&(a=t,s[l]--,t=n.plus(s))):t=a);return[t,s,a,o]}function kie(t,e,r,i){let[s,n,o,a]=Pie(t,e,r);const l=e-s,c=r.filter(p=>["hours","minutes","seconds","milliseconds"].indexOf(p)>=0);c.length===0&&(o<e&&(o=s.plus({[a]:1})),o!==s&&(n[a]=(n[a]||0)+l/(o-s)));const d=Je.fromObject(n,i);return c.length>0?Je.fromMillis(l,i).shiftTo(...c).plus(d):d}const Lie="missing Intl.DateTimeFormat.formatToParts support";function tt(t,e=r=>r){return{regex:t,deser:([r])=>e(Sre(r))}}const Aie="",SV=`[ ${Aie}]`,xV=new RegExp(SV,"g");function Rie(t){return t.replace(/\./g,"\\.?").replace(xV,SV)}function jR(t){return t.replace(/\./g,"").replace(xV," ").toLowerCase()}function $n(t,e){return t===null?null:{regex:RegExp(t.map(Rie).join("|")),deser:([r])=>t.findIndex(i=>jR(r)===jR(i))+e}}function VR(t,e){return{regex:t,deser:([,r,i])=>l2(r,i),groups:e}}function fw(t){return{regex:t,deser:([e])=>e}}function Oie(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Fie(t,e){const r=xn(e),i=xn(e,"{2}"),s=xn(e,"{3}"),n=xn(e,"{4}"),o=xn(e,"{6}"),a=xn(e,"{1,2}"),l=xn(e,"{1,3}"),c=xn(e,"{1,6}"),d=xn(e,"{1,9}"),p=xn(e,"{2,4}"),m=xn(e,"{4,6}"),y=w=>({regex:RegExp(Oie(w.val)),deser:([_])=>_,literal:!0}),v=(w=>{if(t.literal)return y(w);switch(w.val){case"G":return $n(e.eras("short"),0);case"GG":return $n(e.eras("long"),0);case"y":return tt(c);case"yy":return tt(p,dT);case"yyyy":return tt(n);case"yyyyy":return tt(m);case"yyyyyy":return tt(o);case"M":return tt(a);case"MM":return tt(i);case"MMM":return $n(e.months("short",!0),1);case"MMMM":return $n(e.months("long",!0),1);case"L":return tt(a);case"LL":return tt(i);case"LLL":return $n(e.months("short",!1),1);case"LLLL":return $n(e.months("long",!1),1);case"d":return tt(a);case"dd":return tt(i);case"o":return tt(l);case"ooo":return tt(s);case"HH":return tt(i);case"H":return tt(a);case"hh":return tt(i);case"h":return tt(a);case"mm":return tt(i);case"m":return tt(a);case"q":return tt(a);case"qq":return tt(i);case"s":return tt(a);case"ss":return tt(i);case"S":return tt(l);case"SSS":return tt(s);case"u":return fw(d);case"uu":return fw(a);case"uuu":return tt(r);case"a":return $n(e.meridiems(),0);case"kkkk":return tt(n);case"kk":return tt(p,dT);case"W":return tt(a);case"WW":return tt(i);case"E":case"c":return tt(r);case"EEE":return $n(e.weekdays("short",!1),1);case"EEEE":return $n(e.weekdays("long",!1),1);case"ccc":return $n(e.weekdays("short",!0),1);case"cccc":return $n(e.weekdays("long",!0),1);case"Z":case"ZZ":return VR(new RegExp(`([+-]${a.source})(?::(${i.source}))?`),2);case"ZZZ":return VR(new RegExp(`([+-]${a.source})(${i.source})?`),2);case"z":return fw(/[a-z_+-/]{1,256}?/i);case" ":return fw(/[^\S\n\r]/);default:return y(w)}})(t)||{invalidReason:Lie};return v.token=t,v}const Nie={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function Die(t,e,r){const{type:i,value:s}=t;if(i==="literal"){const l=/^\s+$/.test(s);return{literal:!l,val:l?" ":s}}const n=e[i];let o=i;i==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=r.hour12?"hour12":"hour24");let a=Nie[o];if(typeof a=="object"&&(a=a[n]),a)return{literal:!1,val:a}}function zie(t){return[`^${t.map(r=>r.regex).reduce((r,i)=>`${r}(${i.source})`,"")}$`,t]}function jie(t,e,r){const i=t.match(e);if(i){const s={};let n=1;for(const o in r)if(gm(r,o)){const a=r[o],l=a.groups?a.groups+1:1;!a.literal&&a.token&&(s[a.token.val[0]]=a.deser(i.slice(n,n+l))),n+=l}return[i,s]}else return[i,{}]}function Vie(t){const e=n=>{switch(n){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let r=null,i;return Ce(t.z)||(r=fs.create(t.z)),Ce(t.Z)||(r||(r=new mr(t.Z)),i=t.Z),Ce(t.q)||(t.M=(t.q-1)*3+1),Ce(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),Ce(t.u)||(t.S=CP(t.u)),[Object.keys(t).reduce((n,o)=>{const a=e(o);return a&&(n[a]=t[o]),n},{}),r,i]}let jx=null;function Uie(){return jx||(jx=ue.fromMillis(1555555555555)),jx}function Gie(t,e){if(t.literal)return t;const r=bi.macroTokenToFormatOpts(t.val),i=IV(r,e);return i==null||i.includes(void 0)?t:i}function $V(t,e){return Array.prototype.concat(...t.map(r=>Gie(r,e)))}class MV{constructor(e,r){if(this.locale=e,this.format=r,this.tokens=$V(bi.parseFormat(r),e),this.units=this.tokens.map(i=>Fie(i,e)),this.disqualifyingUnit=this.units.find(i=>i.invalidReason),!this.disqualifyingUnit){const[i,s]=zie(this.units);this.regex=RegExp(i,"i"),this.handlers=s}}explainFromTokens(e){if(this.isValid){const[r,i]=jie(e,this.regex,this.handlers),[s,n,o]=i?Vie(i):[null,null,void 0];if(gm(i,"a")&&gm(i,"H"))throw new Qp("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:r,matches:i,result:s,zone:n,specificOffset:o}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function TV(t,e,r){return new MV(t,r).explainFromTokens(e)}function qie(t,e,r){const{result:i,zone:s,specificOffset:n,invalidReason:o}=TV(t,e,r);return[i,s,n,o]}function IV(t,e){if(!t)return null;const i=bi.create(e,t).dtFormatter(Uie()),s=i.formatToParts(),n=i.resolvedOptions();return s.map(o=>Die(o,t,n))}const Vx="Invalid DateTime",UR=864e13;function tg(t){return new Yn("unsupported zone",`the zone "${t.name}" is not supported`)}function Ux(t){return t.weekData===null&&(t.weekData=F1(t.c)),t.weekData}function Gx(t){return t.localWeekData===null&&(t.localWeekData=F1(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function Mc(t,e){const r={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new ue({...r,...e,old:r})}function EV(t,e,r){let i=t-e*60*1e3;const s=r.offset(i);if(e===s)return[i,e];i-=(s-e)*60*1e3;const n=r.offset(i);return s===n?[i,s]:[t-Math.min(s,n)*60*1e3,Math.max(s,n)]}function mw(t,e){t+=e*60*1e3;const r=new Date(t);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:r.getUTCHours(),minute:r.getUTCMinutes(),second:r.getUTCSeconds(),millisecond:r.getUTCMilliseconds()}}function z_(t,e,r){return EV(a2(t),e,r)}function GR(t,e){const r=t.o,i=t.c.year+Math.trunc(e.years),s=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,n={...t.c,year:i,month:s,day:Math.min(t.c.day,N1(i,s))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=Je.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=a2(n);let[l,c]=EV(a,r,t.zone);return o!==0&&(l+=o,c=t.zone.offset(l)),{ts:l,o:c}}function Rd(t,e,r,i,s,n){const{setZone:o,zone:a}=r;if(t&&Object.keys(t).length!==0||e){const l=e||a,c=ue.fromObject(t,{...r,zone:l,specificOffset:n});return o?c:c.setZone(a)}else return ue.invalid(new Yn("unparsable",`the input "${s}" can't be parsed as ${i}`))}function yw(t,e,r=!0){return t.isValid?bi.create(at.create("en-US"),{allowZ:r,forceSimple:!0}).formatDateTimeFromString(t,e):null}function qx(t,e,r){const i=t.c.year>9999||t.c.year<0;let s="";if(i&&t.c.year>=0&&(s+="+"),s+=dr(t.c.year,i?6:4),r==="year")return s;if(e){if(s+="-",s+=dr(t.c.month),r==="month")return s;s+="-"}else if(s+=dr(t.c.month),r==="month")return s;return s+=dr(t.c.day),s}function qR(t,e,r,i,s,n,o){let a=!r||t.c.millisecond!==0||t.c.second!==0,l="";switch(o){case"day":case"month":case"year":break;default:if(l+=dr(t.c.hour),o==="hour")break;if(e){if(l+=":",l+=dr(t.c.minute),o==="minute")break;a&&(l+=":",l+=dr(t.c.second))}else{if(l+=dr(t.c.minute),o==="minute")break;a&&(l+=dr(t.c.second))}if(o==="second")break;a&&(!i||t.c.millisecond!==0)&&(l+=".",l+=dr(t.c.millisecond,3))}return s&&(t.isOffsetFixed&&t.offset===0&&!n?l+="Z":t.o<0?(l+="-",l+=dr(Math.trunc(-t.o/60)),l+=":",l+=dr(Math.trunc(-t.o%60))):(l+="+",l+=dr(Math.trunc(t.o/60)),l+=":",l+=dr(Math.trunc(t.o%60)))),n&&(l+="["+t.zone.ianaName+"]"),l}const CV={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Bie={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Hie={ordinal:1,hour:0,minute:0,second:0,millisecond:0},j_=["year","month","day","hour","minute","second","millisecond"],Wie=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],Zie=["year","ordinal","hour","minute","second","millisecond"];function V_(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new Cj(t);return e}function BR(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return V_(t)}}function Jie(t){if(rg===void 0&&(rg=Yt.now()),t.type!=="iana")return t.offset(rg);const e=t.name;let r=pT.get(e);return r===void 0&&(r=t.offset(rg),pT.set(e,r)),r}function HR(t,e){const r=Pu(e.zone,Yt.defaultZone);if(!r.isValid)return ue.invalid(tg(r));const i=at.fromObject(e);let s,n;if(Ce(t.year))s=Yt.now();else{for(const l of j_)Ce(t[l])&&(t[l]=CV[l]);const o=tV(t)||rV(t);if(o)return ue.invalid(o);const a=Jie(r);[s,n]=z_(t,a,r)}return new ue({ts:s,zone:r,loc:i,o:n})}function WR(t,e,r){const i=Ce(r.round)?!0:r.round,s=Ce(r.rounding)?"trunc":r.rounding,n=(a,l)=>(a=PP(a,i||r.calendary?0:2,r.calendary?"round":s),e.loc.clone(r).relFormatter(r).format(a,l)),o=a=>r.calendary?e.hasSame(t,a)?0:e.startOf(a).diff(t.startOf(a),a).get(a):e.diff(t,a).get(a);if(r.unit)return n(o(r.unit),r.unit);for(const a of r.units){const l=o(a);if(Math.abs(l)>=1)return n(l,a)}return n(t>e?-0:0,r.units[r.units.length-1])}function ZR(t){let e={},r;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],r=Array.from(t).slice(0,t.length-1)):r=Array.from(t),[e,r]}let rg;const pT=new Map;class ue{constructor(e){const r=e.zone||Yt.defaultZone;let i=e.invalid||(Number.isNaN(e.ts)?new Yn("invalid input"):null)||(r.isValid?null:tg(r));this.ts=Ce(e.ts)?Yt.now():e.ts;let s=null,n=null;if(!i)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(r))[s,n]=[e.old.c,e.old.o];else{const a=Hu(e.o)&&!e.old?e.o:r.offset(this.ts);s=mw(this.ts,a),i=Number.isNaN(s.year)?new Yn("invalid input"):null,s=i?null:s,n=i?null:a}this._zone=r,this.loc=e.loc||at.create(),this.invalid=i,this.weekData=null,this.localWeekData=null,this.c=s,this.o=n,this.isLuxonDateTime=!0}static now(){return new ue({})}static local(){const[e,r]=ZR(arguments),[i,s,n,o,a,l,c]=r;return HR({year:i,month:s,day:n,hour:o,minute:a,second:l,millisecond:c},e)}static utc(){const[e,r]=ZR(arguments),[i,s,n,o,a,l,c]=r;return e.zone=mr.utcInstance,HR({year:i,month:s,day:n,hour:o,minute:a,second:l,millisecond:c},e)}static fromJSDate(e,r={}){const i=Ire(e)?e.valueOf():NaN;if(Number.isNaN(i))return ue.invalid("invalid input");const s=Pu(r.zone,Yt.defaultZone);return s.isValid?new ue({ts:i,zone:s,loc:at.fromObject(r)}):ue.invalid(tg(s))}static fromMillis(e,r={}){if(Hu(e))return e<-UR||e>UR?ue.invalid("Timestamp out of range"):new ue({ts:e,zone:Pu(r.zone,Yt.defaultZone),loc:at.fromObject(r)});throw new di(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,r={}){if(Hu(e))return new ue({ts:e*1e3,zone:Pu(r.zone,Yt.defaultZone),loc:at.fromObject(r)});throw new di("fromSeconds requires a numerical input")}static fromObject(e,r={}){e=e||{};const i=Pu(r.zone,Yt.defaultZone);if(!i.isValid)return ue.invalid(tg(i));const s=at.fromObject(r),n=D1(e,BR),{minDaysInFirstWeek:o,startOfWeek:a}=kR(n,s),l=Yt.now(),c=Ce(r.specificOffset)?i.offset(l):r.specificOffset,d=!Ce(n.ordinal),p=!Ce(n.year),m=!Ce(n.month)||!Ce(n.day),y=p||m,g=n.weekYear||n.weekNumber;if((y||d)&&g)throw new Qp("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(m&&d)throw new Qp("Can't mix ordinal dates with month/day");const v=g||n.weekday&&!y;let w,_,x=mw(l,c);v?(w=Wie,_=Bie,x=F1(x,o,a)):d?(w=Zie,_=Hie,x=zx(x)):(w=j_,_=CV);let $=!1;for(const V of w){const Z=n[V];Ce(Z)?$?n[V]=_[V]:n[V]=x[V]:$=!0}const T=v?$re(n,o,a):d?Mre(n):tV(n),C=T||rV(n);if(C)return ue.invalid(C);const P=v?CR(n,o,a):d?PR(n):n,[A,F]=z_(P,c,i),j=new ue({ts:A,zone:i,o:F,loc:s});return n.weekday&&y&&e.weekday!==j.weekday?ue.invalid("mismatched weekday",`you can't specify both a weekday of ${n.weekday} and a date of ${j.toISO()}`):j.isValid?j:ue.invalid(j.invalid)}static fromISO(e,r={}){const[i,s]=yie(e);return Rd(i,s,r,"ISO 8601",e)}static fromRFC2822(e,r={}){const[i,s]=gie(e);return Rd(i,s,r,"RFC 2822",e)}static fromHTTP(e,r={}){const[i,s]=vie(e);return Rd(i,s,r,"HTTP",r)}static fromFormat(e,r,i={}){if(Ce(e)||Ce(r))throw new di("fromFormat requires an input string and a format");const{locale:s=null,numberingSystem:n=null}=i,o=at.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0}),[a,l,c,d]=qie(o,e,r);return d?ue.invalid(d):Rd(a,l,i,`format ${r}`,e,c)}static fromString(e,r,i={}){return ue.fromFormat(e,r,i)}static fromSQL(e,r={}){const[i,s]=Mie(e);return Rd(i,s,r,"SQL",e)}static invalid(e,r=null){if(!e)throw new di("need to specify a reason the DateTime is invalid");const i=e instanceof Yn?e:new Yn(e,r);if(Yt.throwOnInvalid)throw new Kte(i);return new ue({invalid:i})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,r={}){const i=IV(e,at.fromObject(r));return i?i.map(s=>s?s.val:null).join(""):null}static expandFormat(e,r={}){return $V(bi.parseFormat(e),at.fromObject(r)).map(s=>s.val).join("")}static resetCache(){rg=void 0,pT.clear()}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Ux(this).weekYear:NaN}get weekNumber(){return this.isValid?Ux(this).weekNumber:NaN}get weekday(){return this.isValid?Ux(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?Gx(this).weekday:NaN}get localWeekNumber(){return this.isValid?Gx(this).weekNumber:NaN}get localWeekYear(){return this.isValid?Gx(this).weekYear:NaN}get ordinal(){return this.isValid?zx(this.c).ordinal:NaN}get monthShort(){return this.isValid?pw.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?pw.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?pw.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?pw.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,r=6e4,i=a2(this.c),s=this.zone.offset(i-e),n=this.zone.offset(i+e),o=this.zone.offset(i-s*r),a=this.zone.offset(i-n*r);if(o===a)return[this];const l=i-o*r,c=i-a*r,d=mw(l,o),p=mw(c,a);return d.hour===p.hour&&d.minute===p.minute&&d.second===p.second&&d.millisecond===p.millisecond?[Mc(this,{ts:l}),Mc(this,{ts:c})]:[this]}get isInLeapYear(){return Lv(this.year)}get daysInMonth(){return N1(this.year,this.month)}get daysInYear(){return this.isValid?vf(this.year):NaN}get weeksInWeekYear(){return this.isValid?z0(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?z0(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:r,numberingSystem:i,calendar:s}=bi.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:r,numberingSystem:i,outputCalendar:s}}toUTC(e=0,r={}){return this.setZone(mr.instance(e),r)}toLocal(){return this.setZone(Yt.defaultZone)}setZone(e,{keepLocalTime:r=!1,keepCalendarTime:i=!1}={}){if(e=Pu(e,Yt.defaultZone),e.equals(this.zone))return this;if(e.isValid){let s=this.ts;if(r||i){const n=e.offset(this.ts),o=this.toObject();[s]=z_(o,n,e)}return Mc(this,{ts:s,zone:e})}else return ue.invalid(tg(e))}reconfigure({locale:e,numberingSystem:r,outputCalendar:i}={}){const s=this.loc.clone({locale:e,numberingSystem:r,outputCalendar:i});return Mc(this,{loc:s})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const r=D1(e,BR),{minDaysInFirstWeek:i,startOfWeek:s}=kR(r,this.loc),n=!Ce(r.weekYear)||!Ce(r.weekNumber)||!Ce(r.weekday),o=!Ce(r.ordinal),a=!Ce(r.year),l=!Ce(r.month)||!Ce(r.day),c=a||l,d=r.weekYear||r.weekNumber;if((c||o)&&d)throw new Qp("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&o)throw new Qp("Can't mix ordinal dates with month/day");let p;n?p=CR({...F1(this.c,i,s),...r},i,s):Ce(r.ordinal)?(p={...this.toObject(),...r},Ce(r.day)&&(p.day=Math.min(N1(p.year,p.month),p.day))):p=PR({...zx(this.c),...r});const[m,y]=z_(p,this.o,this.zone);return Mc(this,{ts:m,o:y})}plus(e){if(!this.isValid)return this;const r=Je.fromDurationLike(e);return Mc(this,GR(this,r))}minus(e){if(!this.isValid)return this;const r=Je.fromDurationLike(e).negate();return Mc(this,GR(this,r))}startOf(e,{useLocaleWeeks:r=!1}={}){if(!this.isValid)return this;const i={},s=Je.normalizeUnit(e);switch(s){case"years":i.month=1;case"quarters":case"months":i.day=1;case"weeks":case"days":i.hour=0;case"hours":i.minute=0;case"minutes":i.second=0;case"seconds":i.millisecond=0;break}if(s==="weeks")if(r){const n=this.loc.getStartOfWeek(),{weekday:o}=this;o<n&&(i.weekNumber=this.weekNumber-1),i.weekday=n}else i.weekday=1;if(s==="quarters"){const n=Math.ceil(this.month/3);i.month=(n-1)*3+1}return this.set(i)}endOf(e,r){return this.isValid?this.plus({[e]:1}).startOf(e,r).minus(1):this}toFormat(e,r={}){return this.isValid?bi.create(this.loc.redefaultToEN(r)).formatDateTimeFromString(this,e):Vx}toLocaleString(e=O1,r={}){return this.isValid?bi.create(this.loc.clone(r),e).formatDateTime(this):Vx}toLocaleParts(e={}){return this.isValid?bi.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:r=!1,suppressMilliseconds:i=!1,includeOffset:s=!0,extendedZone:n=!1,precision:o="milliseconds"}={}){if(!this.isValid)return null;o=V_(o);const a=e==="extended";let l=qx(this,a,o);return j_.indexOf(o)>=3&&(l+="T"),l+=qR(this,a,r,i,s,n,o),l}toISODate({format:e="extended",precision:r="day"}={}){return this.isValid?qx(this,e==="extended",V_(r)):null}toISOWeekDate(){return yw(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:r=!1,includeOffset:i=!0,includePrefix:s=!1,extendedZone:n=!1,format:o="extended",precision:a="milliseconds"}={}){return this.isValid?(a=V_(a),(s&&j_.indexOf(a)>=3?"T":"")+qR(this,o==="extended",r,e,i,n,a)):null}toRFC2822(){return yw(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return yw(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?qx(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:r=!1,includeOffsetSpace:i=!0}={}){let s="HH:mm:ss.SSS";return(r||e)&&(i&&(s+=" "),r?s+="z":e&&(s+="ZZ")),yw(this,s,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():Vx}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const r={...this.c};return e.includeConfig&&(r.outputCalendar=this.outputCalendar,r.numberingSystem=this.loc.numberingSystem,r.locale=this.loc.locale),r}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,r="milliseconds",i={}){if(!this.isValid||!e.isValid)return Je.invalid("created by diffing an invalid DateTime");const s={locale:this.locale,numberingSystem:this.numberingSystem,...i},n=Ere(r).map(Je.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,l=o?e:this,c=kie(a,l,n,s);return o?c.negate():c}diffNow(e="milliseconds",r={}){return this.diff(ue.now(),e,r)}until(e){return this.isValid?Ht.fromDateTimes(this,e):this}hasSame(e,r,i){if(!this.isValid)return!1;const s=e.valueOf(),n=this.setZone(e.zone,{keepLocalTime:!0});return n.startOf(r,i)<=s&&s<=n.endOf(r,i)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const r=e.base||ue.fromObject({},{zone:this.zone}),i=e.padding?this<r?-e.padding:e.padding:0;let s=["years","months","days","hours","minutes","seconds"],n=e.unit;return Array.isArray(e.unit)&&(s=e.unit,n=void 0),WR(r,this.plus(i),{...e,numeric:"always",units:s,unit:n})}toRelativeCalendar(e={}){return this.isValid?WR(e.base||ue.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(ue.isDateTime))throw new di("min requires all arguments be DateTimes");return LR(e,r=>r.valueOf(),Math.min)}static max(...e){if(!e.every(ue.isDateTime))throw new di("max requires all arguments be DateTimes");return LR(e,r=>r.valueOf(),Math.max)}static fromFormatExplain(e,r,i={}){const{locale:s=null,numberingSystem:n=null}=i,o=at.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0});return TV(o,e,r)}static fromStringExplain(e,r,i={}){return ue.fromFormatExplain(e,r,i)}static buildFormatParser(e,r={}){const{locale:i=null,numberingSystem:s=null}=r,n=at.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});return new MV(n,e)}static fromFormatParser(e,r,i={}){if(Ce(e)||Ce(r))throw new di("fromFormatParser requires an input string and a format parser");const{locale:s=null,numberingSystem:n=null}=i,o=at.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0});if(!o.equals(r.locale))throw new di(`fromFormatParser called with a locale of ${o}, but the format parser was created for ${r.locale}`);const{result:a,zone:l,specificOffset:c,invalidReason:d}=r.explainFromTokens(e);return d?ue.invalid(d):Rd(a,l,i,`format ${r.format}`,e,c)}static get DATE_SHORT(){return O1}static get DATE_MED(){return Pj}static get DATE_MED_WITH_WEEKDAY(){return tre}static get DATE_FULL(){return kj}static get DATE_HUGE(){return Lj}static get TIME_SIMPLE(){return Aj}static get TIME_WITH_SECONDS(){return Rj}static get TIME_WITH_SHORT_OFFSET(){return Oj}static get TIME_WITH_LONG_OFFSET(){return Fj}static get TIME_24_SIMPLE(){return Nj}static get TIME_24_WITH_SECONDS(){return Dj}static get TIME_24_WITH_SHORT_OFFSET(){return zj}static get TIME_24_WITH_LONG_OFFSET(){return jj}static get DATETIME_SHORT(){return Vj}static get DATETIME_SHORT_WITH_SECONDS(){return Uj}static get DATETIME_MED(){return Gj}static get DATETIME_MED_WITH_SECONDS(){return qj}static get DATETIME_MED_WITH_WEEKDAY(){return rre}static get DATETIME_FULL(){return Bj}static get DATETIME_FULL_WITH_SECONDS(){return Hj}static get DATETIME_HUGE(){return Wj}static get DATETIME_HUGE_WITH_SECONDS(){return Zj}}function vy(t){if(ue.isDateTime(t))return t;if(t&&t.valueOf&&Hu(t.valueOf()))return ue.fromJSDate(t);if(t&&typeof t=="object")return ue.fromObject(t);throw new di(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const Yie="shortOffset";function Xie(t){return"timeZoneIANA"in t}function Kie(t){return t.startsWith("UTC")}function z1(t,e=!1){return{json:{read:{source:t,reader:(r,i)=>i[t]?U_(i[t]):null},write:!!e&&{allowNull:!0,writer(r,i){i[t]=r?Qie(r):null}}}}}function U_(t,e=to){return t?Xie(t)?t.timeZoneIANA:ese(t,e):e}function Qie(t){return{timeZoneIANA:t}}function ese(t,e=to){if(!t||!vR.has(t.timeZone))return e;const r=vR.get(t.timeZone);return Kie(t.timeZone)||t.respectsDaylightSaving?r:tse(r)}function tse(t){const e=ue.local().setZone(t),r=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return r===0?"Etc/UTC":`Etc/GMT${mr.instance(-r).formatOffset(0,"narrow")}`}function rse(t,e,r,i,s){if(e&&s==="date")return{timeZone:ga,timeZoneName:void 0};const n=i.hour,o=r===sc;return{timeZone:o?s==="timestamp-offset"?void 0:t??ga:r,timeZoneName:o&&n?Yie:void 0}}function ise(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),r=new Set(Intl.supportedValuesOf("timeZone").map(i=>i.toLowerCase()));return t===to||t===sc||e.has(t.toLowerCase())||r.has(t.toLowerCase())}const sse={dateStyle:void 0,year:void 0,month:void 0,day:void 0,weekday:void 0},nse={timeStyle:void 0,hour12:void 0,hourCycle:void 0,hour:void 0,minute:void 0,second:void 0},PV={timeZone:ga},no={year:"numeric",month:"numeric",day:"numeric"},wy={year:"numeric",month:"long",day:"numeric"},_y={year:"numeric",month:"short",day:"numeric"},by={year:"numeric",month:"long",weekday:"long",day:"numeric"},xu={hour:"numeric",minute:"numeric"},Vc={...xu,second:"numeric"},kV={hourCycle:"h23"},Sy={...xu,...kV},xy={...Vc,...kV},LV={"short-date":no,"short-date-short-time":{...no,...xu},"short-date-short-time-24":{...no,...Sy},"short-date-long-time":{...no,...Vc},"short-date-long-time-24":{...no,...xy},"short-date-le":no,"short-date-le-short-time":{...no,...xu},"short-date-le-short-time-24":{...no,...Sy},"short-date-le-long-time":{...no,...Vc},"short-date-le-long-time-24":{...no,...xy},"long-month-day-year":wy,"long-month-day-year-short-time":{...wy,...xu},"long-month-day-year-short-time-24":{...wy,...Sy},"long-month-day-year-long-time":{...wy,...Vc},"long-month-day-year-long-time-24":{...wy,...xy},"day-short-month-year":_y,"day-short-month-year-short-time":{..._y,...xu},"day-short-month-year-short-time-24":{..._y,...Sy},"day-short-month-year-long-time":{..._y,...Vc},"day-short-month-year-long-time-24":{..._y,...xy},"long-date":by,"long-date-short-time":{...by,...xu},"long-date-short-time-24":{...by,...Sy},"long-date-long-time":{...by,...Vc},"long-date-long-time-24":{...by,...xy},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":xu,"long-time":Vc},ose=yr()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),AV={ar:"ar-u-nu-latn-ca-gregory",nn:"no-NN"},ase=new Intl.DateTimeFormat("bs",{month:"long"}).formatToParts(new Date(2025,2)),lse=ase.find(({type:t})=>t==="month")?.value.toLowerCase();function RV(){const t=xP();return(t&&AV[t])??Sj()}lse!=="mart"&&(AV.bs="sr-Latn-CS");let fT=new WeakMap;const c2=LV["short-date-short-time"];function use(t){let e=fT.get(t);if(!e){const r=RV(),i=RP(t.timeZone??to),s={...t,timeZone:i};e=new Intl.DateTimeFormat(r,s),fT.set(t,e)}return e}function $y(t){return LV[t]}function cse(t){const{dateStyle:e,timeStyle:r,hour12:i,year:s,month:n}=t,o={};return e?o.dateStyle=e:s&&(o.year=s,o.month=n||void 0),r&&!o.year&&(o.timeStyle=r,o.hour12=i==="auto"?void 0:i==="always"),o}function hn(t,e=c2){return use(e).format(t)}function hse(t,e=c2){return hn(new Date(t),{...e,...PV,...nse})}function dse(t,e=c2){return hn(new Date(`1970-01-01T${t}Z`),{...e,...PV,...sse})}function pse(t,e=c2){if(e.timeZone)return hn(new Date(t),e);const r=ue.fromISO(t,{setZone:!0}),i=r.offset===0?ga:e.timeZone,s={...e,timeZone:i};return r.toLocaleString(s,{locale:RV()})}function RP(t){switch(t){case to:return Xte;case sc:return ga;default:return t}}MP(()=>{fT=new WeakMap});const fse={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let G_=new WeakMap,OV={};function mT(t){const e=t||OV;if(!G_.has(e)){const r=xP(),i=r&&fse[r]||Sj();G_.set(e,new Intl.NumberFormat(i,t))}return G_.get(e)}function mse(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function yse(t){const{minimumFractionDigits:e,maximumFractionDigits:r,useGrouping:i}=t;return{minimumFractionDigits:e,maximumFractionDigits:r,useGrouping:i==="auto"?"auto":i==="always"}}function nc(t,e){return Object.is(t,-0)&&(t=0),mT(e).format(t)}function n5e(t,e=hs()){if(!t)return null;let r=JR.get(e);if(!r){const i=mT().formatToParts(12345.6),s=[...mT({useGrouping:!1}).format(9876543210)].reverse(),n=new Map(s.map((p,m)=>[p,m])),o=new RegExp(`[${i.find(p=>p.type==="group")?.value}]`,"g"),a=new RegExp(`[${i.find(p=>p.type==="decimal")?.value}]`),l=new RegExp(`[${s.join("")}]`,"g"),c=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,d=/[-\u2212\u2013\u2014\u2015]/g;r=p=>{if((p=p.trim().replaceAll(o,"").replace(a,".").replace(l,y=>String(n.get(y))).replaceAll(c,"").replaceAll(d,"-"))==="")return null;const m=Number(p);return isNaN(m)?null:m},JR.set(e,r)}return r(t)}MP(()=>{G_=new WeakMap,OV={}});const JR=new Map,FV=()=>U.getLogger("esri.intl.substitute");function va(t,e,r={}){const{format:i={}}=r;return dc(t,s=>gse(s,e,i))}function gse(t,e,r){let i,s;const n=t.indexOf(":");if(n===-1?i=t.trim():(i=t.slice(0,n).trim(),s=t.slice(n+1).trim()),!i)return"";const o=Sv(i,e);if(o==null)return"";const a=(s?r?.[s]:null)??r?.[i];return a?vse(o,a):s?wse(o,s):OP(o)}function vse(t,e){switch(e.type){case"date":return hn(t,e.intlOptions);case"number":return nc(t,e.intlOptions);default:return FV().warn("missing format descriptor for key {key}"),OP(t)}}function wse(t,e){switch(e.toLowerCase()){case"dateformat":return hn(t);case"numberformat":return nc(t);default:return FV().warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?hn(t):/^numberformat/i.test(e)?nc(t):OP(t)}}function OP(t){switch(typeof t){case"string":return t;case"number":return nc(t);case"boolean":return""+t;default:return t instanceof Date?hn(t):""}}async function _se(t,e,r,i){const s=e.exec(r);if(!s)throw new R("esri-intl:invalid-bundle",`Bundle id "${r}" is not compatible with the pattern "${e}"`);const n=s[1]?`${s[1]}/`:"",o=s[2],a=Ij(i),l=`${n}${o}.json`,c=a?`${n}${o}_${a}.json`:l;let d;try{d=await YR(t(c))}catch(p){if(c===l)throw new R("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:p});try{d=await YR(t(l))}catch(m){throw new R("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:m})}}return d}async function YR(t){if(XR.fetchBundleAsset!=null)return XR.fetchBundleAsset(t);const e=await Be(t,{responseType:"text"});return JSON.parse(e.data)}let bse=class{constructor({base:e="",pattern:r,location:i=new URL(window.location.href)}){let s;s=typeof i=="string"?n=>new URL(n,new URL(i,window.location.href)).href:i instanceof URL?n=>new URL(n,i).href:i,this.pattern=typeof r=="string"?new RegExp(`^${r}`):r,this.getAssetUrl=s,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,r){return _se(this.getAssetUrl,this.matcher,e,r)}};function Sse(t){return new bse(t)}const XR={};Wte(Sse({pattern:"esri/",location:St}));let Oa=class extends le{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const e=this.language;let r=e==="local"||e==="global"?e:Ij(e??hs())??"global";return r=r==="no"?"nb":r,r}};u([h()],Oa.prototype,"apiKey",void 0),u([h()],Oa.prototype,"id",void 0),u([h()],Oa.prototype,"language",void 0),u([h()],Oa.prototype,"places",void 0),u([h()],Oa.prototype,"serviceUrl",void 0),u([h()],Oa.prototype,"worldview",void 0),Oa=u([E("esri.support.BasemapStyle")],Oa);const xse=Oa,NV=Symbol("BasemapInstance");function l5e(t){return t!=null&&typeof t=="object"&&NV in t}function ie(t,e,r={}){return FP(t,e,r,DV)}function Ti(t,e,r={}){return FP(t,e,r,zV)}function FP(t,e,r={},i){let s=null;const n=r.once?(o,a)=>{i(o)&&(yt(s),e(o,a))}:(o,a)=>{i(o)&&e(o,a)};if(s=vQ(t,n,r.sync,r.equals),r.initial){const o=t();n(o,o)}return s}function pn(t,e,r,i={}){let s=null,n=null,o=null;function a(){s&&n&&(n.remove(),i.onListenerRemove?.(s),s=null,n=null)}function l(d){i.once&&i.once&&yt(o),r(d)}const c=ie(t,(d,p)=>{a(),GS(d)&&(s=d,n=Dm(d,e,l),i.onListenerAdd?.(d))},{sync:i.sync,initial:!0});return o=je(()=>{c.remove(),a()}),o}function Ov(t,e){return $se(t,zV,e)}function $se(t,e,r){if(xi(r))return Promise.reject(it());const i=t();if(e?.(i))return Promise.resolve(i);let s=null;function n(){s=yt(s)}return new Promise((o,a)=>{s=md([mn(r,()=>{n(),a(it())}),FP(t,l=>{n(),o(l)},{sync:!1,once:!0},e??DV)])})}function DV(t){return!0}function zV(t){return!!t}function Mse(t,e,r={}){let i=!1;const s=ie(t,(n,o)=>{i||e(n,o)},r);return{remove(){s.remove()},pause(){i=!0},resume(){i=!1}}}const wa={sync:!0},ft={initial:!0},pi={sync:!0,initial:!0};let jV=0;const h2=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+jV++})}};return r=u([E("esri.core.Identifiable")],r),r},NP=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:jV++})}};return r=u([E("esri.core.Identifiable.NumericIdentifiable")],r),r};h2(class{});async function Tse(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:r}=await q(async()=>{const{fromItem:i}=await import("./portalLayers-CD2sNtfV.js");return{fromItem:i}},__vite__mapDeps([5,6,7,8,9]));try{return await r(e)}catch(i){const s=e?.portalItem,n=s?.id||"unset",o=s?.portal?.url||De.portalUrl;throw U.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+o+"', id: '"+n+"')",i),i}}const yT={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function Bx(t,e,r,i=to){const s=new fs(RP(i)),n=ue.fromJSDate(t,{zone:s}),o=r==="decades"||r==="centuries"?"year":UV(r);return r==="decades"&&(e*=10),r==="centuries"&&(e*=100),n.plus({[o]:e}).toJSDate()}function u5e(t,e,r="milliseconds"){const i=t.getTime(),s=VV(e,r,"milliseconds");return new Date(i+s)}function KR(t,e,r=to){const i=new fs(RP(r)),s=ue.fromJSDate(t,{zone:i});if(e==="decades"||e==="centuries"){const o=s.startOf("year"),{year:a}=o,l=a-a%(e==="decades"?10:100);return o.set({year:l}).toJSDate()}const n=UV(e);return s.startOf(n).toJSDate()}function VV(t,e,r){return t===0?0:t*yT[e]/yT[r]}function c5e(t,e){return t&&e?t.intersection(e):t||e}function UV(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var Bs,Ff;let ar=(Ff=class extends W{static get allTime(){return QR}static get empty(){return Ise}static fromArray(e){return new Bs({start:e[0]!=null?new Date(e[0]):e[0],end:e[1]!=null?new Date(e[1]):e[1]})}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,r){return r.end!=null?new Date(r.end):null}writeEnd(e,r){r.end=e?.getTime()??null}get isAllTime(){return this.equals(Bs.allTime)}get isEmpty(){return this.equals(Bs.empty)}readStart(e,r){return r.start!=null?new Date(r.start):null}writeStart(e,r){r.start=e?.getTime()??null}clone(){return new Bs({end:this.end,start:this.start})}equals(e){if(!e)return!1;const r=this.start?.getTime()??this.start,i=this.end?.getTime()??this.end,s=e.start?.getTime()??e.start,n=e.end?.getTime()??e.end;return r===s&&i===n}expandTo(e,r=to){if(this.isEmpty||this.isAllTime)return this.clone();let i=this.start;i&&(i=KR(i,e,r));let s=this.end;if(s){const n=KR(s,e,r);s=s.getTime()===n.getTime()?n:Bx(n,1,e,r)}return new Bs({start:i,end:s})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return Bs.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const r=this.start?.getTime()??-1/0,i=this.end?.getTime()??1/0,s=e.start?.getTime()??-1/0,n=e.end?.getTime()??1/0;let o,a;return s>=r&&s<=i?o=s:r>=s&&r<=n&&(o=r),i>=s&&i<=n?a=i:n>=r&&n<=i&&(a=n),o==null||a==null||isNaN(o)||isNaN(a)?Bs.empty:new Bs({start:o===-1/0?null:new Date(o),end:a===1/0?null:new Date(a)})}offset(e,r,i=to){if(this.isEmpty||this.isAllTime)return this.clone();const s=new Bs,{start:n,end:o}=this;return n!=null&&(s.start=Bx(n,e,r,i)),o!=null&&(s.end=Bx(o,e,r,i)),s}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return QR.clone();const r=this.start!=null&&e.start!=null?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,i=this.end!=null&&e.end!=null?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new Bs({start:r,end:i})}},Bs=Ff,Ff);u([h({type:Date,json:{write:{allowNull:!0}}})],ar.prototype,"end",void 0),u([X("end")],ar.prototype,"readEnd",null),u([te("end")],ar.prototype,"writeEnd",null),u([h({readOnly:!0,json:{read:!1}})],ar.prototype,"isAllTime",null),u([h({readOnly:!0,json:{read:!1}})],ar.prototype,"isEmpty",null),u([h({type:Date,json:{write:{allowNull:!0}}})],ar.prototype,"start",void 0),u([X("start")],ar.prototype,"readStart",null),u([te("start")],ar.prototype,"writeStart",null),ar=Bs=u([E("esri.time.TimeExtent")],ar);const QR=new ar,Ise=new ar({start:void 0,end:void 0});let Ese=0,Et=class extends KS(h2(Cv)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Te(-180,-90,180,90,ne.WGS84),this.id=Date.now().toString(16)+"-layer-"+Ese++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=ne.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const r=typeof e=="string"?{url:e}:e;return(await q(async()=>{const{fromUrl:i}=await import("./arcgisLayers-BOgo3j1f.js");return{fromUrl:i}},__vite__mapDeps([10,6,7,9]))).fromUrl(r)}static fromPortalItem(e){return Tse(e)}initialize(){this.when().catch(e=>{Ur(e)||U.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const{parent:e}=this;e&&(this.parent=null,e.removeChildLayer?.(this))}get effectiveVisible(){return this.visible&&(this.parent?.effectiveVisible??!0)}get hasAttributionData(){return this.attributionDataUrl!=null}get loaded(){return super.loaded}removeFromParent(){const{parent:e}=this;e&&(e.removeChildLayer?.(this),this.parent=null)}get parsedUrl(){return Er(this.url)}createLayerView(e,r){return Promise.reject(new R("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await Be(e,{query:{f:"json"},responseType:"json"})).data;throw new R("layer:no-attribution-data","Layer does not have attribution data")}};u([h({type:String})],Et.prototype,"attributionDataUrl",void 0),u([h({readOnly:!0})],Et.prototype,"effectiveVisible",null),u([h({type:Te})],Et.prototype,"fullExtent",void 0),u([h({readOnly:!0})],Et.prototype,"hasAttributionData",null),u([h({type:String,clonable:!1})],Et.prototype,"id",void 0),u([h({type:Boolean,nonNullable:!0})],Et.prototype,"legendEnabled",void 0),u([h({type:["show","hide","hide-children"]})],Et.prototype,"listMode",void 0),u([h({type:Number,range:{min:0,max:1},nonNullable:!0})],Et.prototype,"opacity",void 0),u([h({clonable:!1})],Et.prototype,"parent",void 0),u([h({readOnly:!0})],Et.prototype,"parsedUrl",null),u([h({type:Boolean,readOnly:!0})],Et.prototype,"persistenceEnabled",void 0),u([h({type:Boolean})],Et.prototype,"popupEnabled",void 0),u([h({type:Boolean})],Et.prototype,"attributionVisible",void 0),u([h({type:ne})],Et.prototype,"spatialReference",void 0),u([h({type:String})],Et.prototype,"title",void 0),u([h({readOnly:!0,json:{read:!1}})],Et.prototype,"type",void 0),u([h()],Et.prototype,"url",void 0),u([h({type:ar})],Et.prototype,"visibilityTimeExtent",void 0),u([h({type:Boolean,nonNullable:!0})],Et.prototype,"visible",void 0),Et=u([E("esri.layers.Layer")],Et);const gw=new WeakMap;function GV(t){return!t.destroyed&&(gw.has(t)||t.addHandles([ie(()=>{const{parent:e}=t;return!!(e&&e instanceof Et)&&(e.type==="catalog-dynamic-group"||GV(e))},e=>gw.set(t,e),pi),je(()=>gw.delete(t))]),gw.get(t))}function qV(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function d5e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="graphics"}function Cse(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="map-image"}function Pse(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph"&&"layers"in t}function p5e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph-sublayer"}function eO(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="subtype-group"&&"sublayers"in t}function op(t){return t?.type==="subtype-sublayer"}const f5e={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function gT(t){const e=t?.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function m5e(t){return t.type==="integrated-mesh"||t.type==="integrated-mesh-3dtiles"}function d2(t){return t?.type==="feature"&&!t.url&&t.source?.type==="memory"}function y5e(t){const e=t?.type;return(e==="feature"||e==="subtype-group"||e==="oriented-imagery")&&t?.source?.type==="feature-layer"}function kse(t){return t?.type==="feature"&&t.source?.type==="feature-layer"}function DP(t){return qV(t)&&kse(t)}async function zP(t,e){const r=Fe?.findServerInfo(t);if(r?.currentVersion!=null)return r.owningSystemUrl||null;const i=t.toLowerCase().indexOf("/rest/services");if(i===-1)return null;const s=`${t.slice(0,i)}/rest/info`,n=e!=null?e.signal:null,{data:o}=await Be(s,{query:{f:"json"},responseType:"json",signal:n});return o?.owningSystemUrl||null}function BV(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function Lse(t){return BV(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function Ase(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"knowledge-graph-sublayer":return!0;default:return!1}}function Rse(t){return!!Ase(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}function Ose(t,e){return null}function g5e(t){return null}function vT(t){return!t||t.type==="Feature Service"&&!t.sourceUrl}function v5e(t,e){!e||!vT(t)||Ose(t.url)}const Fse=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wcs","wms","wmts"]),Nse=new Set(["integrated-mesh-3dtiles"]),HV=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","parquet","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","video","web-tile","wcs","wfs","wms","wmts"]),Dse=new Set([...HV,"link-chart"]);function zse(t){switch(t.layerContainerType){case"basemap-base-layers":return Fse;case"basemap-ground-layers":return Nse;case"operational-layers":return t.origin==="link-chart"?Dse:HV;default:return null}}function jse(t,e){if(e.restrictedWebMapWriting){const r=zse(e);return r==null||r.has(t.type)&&!d2(t)}return!0}function Vse(t,e){if(e)if(d2(t)){const r=Sv("featureCollection.layers",e),i=r?.[0]?.layerDefinition;i&&tO(t,i)}else t.type!=="group"&&tO(t,e)}function tO(t,e){"maxScale"in t&&(e.maxScale=C1(t.maxScale)??void 0),"minScale"in t&&(e.minScale=C1(t.minScale)??void 0)}function Use(t,e){if(Vse(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=C1(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(d2(t)){const r=e.featureCollection;r&&(r.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function Hx(t,e,r){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return r?.messages&&r.messages.push(new R("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(d2(t)&&!t.isTable)e=t.resourceInfo;else if(jse(t,r)){const i={};return t.write(i,r)?i:null}return e!=null&&Use(t,e=O(e)),e}var rO,ap,Jh;let Zi=(Jh=class extends fc(Cv){constructor(e){super(e),this[rO]=!0,this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.type="Basemap",this.id=Date.now().toString(16)+"-basemap-"+ap.idCounter++,this.baseLayers=new se,this.referenceLayers=new se,this.groundLayers=new se;const r=a=>{const{parent:l}=a;l&&l!==this&&"remove"in l&&l.remove?.(a),a.parent=this,a.type!=="elevation"&&a.type!=="integrated-mesh-3dtiles"||U.getLogger(this).error(`Layer '${a.title}, id:${a.id}' of type '${a.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=a=>{const{parent:l}=a;l&&l!==this&&"remove"in l&&l.remove?.(a),a.parent=this},s=a=>{const l=a.item;return l.parent===this?(U.getLogger(this).error(`Layer '${l.title}, id:${l.id}' of type '${l.type}' already a ground layer, second add will be ignored.`),void a.preventDefault()):l.type!=="integrated-mesh-3dtiles"&&l.type!=="integrated-mesh"?(U.getLogger(this).error(`Layer '${l.title}, id:${l.id}' of type '${l.type}' is not supported as a ground layer and will therefore be ignored.`),void a.preventDefault()):void 0},n=a=>{a.parent=null},o=a=>{a.parent===this&&(a.parent=null)};this.addHandles([this.baseLayers.on("after-add",a=>r(a.item)),this.baseLayers.on("after-remove",a=>n(a.item)),this.referenceLayers.on("after-add",a=>r(a.item)),this.referenceLayers.on("after-remove",a=>n(a.item)),this.groundLayers.on("before-add",s),this.groundLayers.on("after-add",a=>i(a.item)),this.groundLayers.on("after-remove",a=>o(a.item))])}initialize(){this.when().catch(e=>{U.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const s of e)s.destroyed||s.destroy();const r=this.groundLayers.toArray();for(const s of r)s.destroyed||s.destroy();const i=this.referenceLayers.toArray();for(const s of i)s.destroyed||s.destroy();this.baseLayers.destroy(),this.groundLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=xt(this.portalItem)}removeChildLayer(e){for(const r of[this.baseLayers,this.referenceLayers,this.groundLayers])r.remove(e)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",la(e,this._get("baseLayers")))}_writeBaseLayers(e,r,i){const s=[];e&&(i={...i,layerContainerType:"basemap-base-layers"},this.baseLayers.forEach(n=>{const o=Hx(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);o!=null&&s.push(o)}),this.referenceLayers.forEach(n=>{const o=Hx(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);o!=null&&(n.type!=="scene"&&(o.isReference=!0),s.push(o))})),r.baseMapLayers=s}set groundLayers(e){this._set("groundLayers",la(e,this._get("groundLayers")))}_writeGroundLayers(e,r,i){const s=[];e&&(i={...i,layerContainerType:"basemap-ground-layers"},this.groundLayers.forEach(n=>{const o=Hx(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);o!=null&&s.push(o)}),s.length>0&&(r.groundLayers=s))}get loaded(){return super.loaded}set referenceLayers(e){this._set("referenceLayers",la(e,this._get("referenceLayers")))}writeTitle(e,r){r.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return Z6(this,e=>{e(this.baseLayers,this.groundLayers,this.referenceLayers)})}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(r=>Yg(r)?r.clone():r),groundLayers:this.groundLayers.map(r=>Yg(r)?r.clone():r),referenceLayers:this.referenceLayers.map(r=>Yg(r)?r.clone():r)};return this.loaded&&(e.loadStatus="loaded"),new ap({resourceInfo:this.resourceInfo}).set(e)}read(e,r){this.resourceInfo||this._set("resourceInfo",{data:e,context:r}),super.read(e,r)}write(e,r){return e=e||{},r?.origin||(r={origin:"web-map",...r}),super.write(e,r),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(i=>{const s=O(i);return s.url&&fa(s.url)&&(s.url=`https:${s.url}`),s.templateUrl&&fa(s.templateUrl)&&(s.templateUrl=`https:${s.templateUrl}`),s})),e}async _loadFromSource(e){const{resourceInfo:r,portalItem:i,style:s}=this;gt(e);const n=[];if(r){const o=r.context?r.context.url:null;if(n.push(this._loadLayersFromJSON(r.data,o,e)),r.data.id&&!r.data.title){const a=r.data.id;n.push(Yte(a).then(l=>{l&&this.read({title:l},r.context)}))}}else i?n.push(this._loadFromItem(i,e)):s&&n.push(this._loadFromStylesService(s,e));await Promise.all(n)}async _loadLayersFromJSON(e,r,i){const s=this.resourceInfo?.context,n=this.portalItem?.portal||s?.portal||null,o=qse[s?.origin||""]??"web-map",{populateOperationalLayers:a}=await q(async()=>{const{populateOperationalLayers:c}=await import("./layersCreator-4rKmFUn3.js");return{populateOperationalLayers:c}},__vite__mapDeps([11,8,7,6,9,5])),l=[];if(gt(i),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const c={context:{...s,origin:o,url:r,portal:n,layerContainerType:"basemap-base-layers"},defaultLayerType:"DefaultTileLayer"},d=y=>o==="web-scene"&&y.layerType==="ArcGISSceneServiceLayer"||y.isReference,p=a(this.baseLayers,e.baseMapLayers.filter(y=>!d(y)),c);l.push(p);const m=a(this.referenceLayers,e.baseMapLayers.filter(d),c);l.push(m)}if(e.groundLayers&&Array.isArray(e.groundLayers)){const c={context:{...s,origin:o,url:r,portal:n,layerContainerType:"basemap-ground-layers"},defaultLayerType:"IntegratedMesh3DTilesLayer"},d=a(this.groundLayers,e.groundLayers,c);l.push(d)}await Promise.allSettled(l)}async _loadFromItem(e,r){const i=await e.load(r),s=await i.fetchData("json",r),n=Er(e.itemUrl??"");return this._set("resourceInfo",{data:s.baseMap??{},context:{origin:Gse[e.type||""]??"web-map",portal:e.portal||J.getDefault(),url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:s.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||J.getDefault(),url:n}),this._loadLayersFromJSON(this.resourceInfo.data,n,r)}async _loadFromStylesService(e,r){const i=e.serviceUrl.endsWith("/webmaps")?e.serviceUrl.slice(0,-8):e.serviceUrl,s=`${i}/styles/${e.id}/self`,n=`${i}/webmaps/${e.id}`,o=e.apiKey??De.apiKeys.basemapStyles,[a,l]=await Promise.all([(await Be(s,{query:{token:o},signal:r?.signal})).data,(await Be(n,{query:{language:e.languageParameter,places:e.places,worldview:e.worldview,token:o},signal:r?.signal})).data]);this.thumbnailUrl??=a.thumbnailUrl;const c=Er(n);if(this._set("resourceInfo",{data:l.baseMap??{},context:{origin:"web-map",url:c}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:l.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,c,r),o)for(const d of[...this.baseLayers,...this.groundLayers,...this.referenceLayers])"apiKey"in d&&(d.apiKey=o)}static fromId(e){const r=rT[e];return r?r.itemId?new ap({portalItem:{id:r.itemId,portal:{url:"https://www.arcgis.com"}}}):ap.fromJSON(r,r.is3d?{origin:"web-scene",portal:new J({url:"https://www.arcgis.com"})}:{origin:"web-map"}):null}},rO=NV,ap=Jh,Jh.idCounter=0,Jh);u([h({json:{read:!1,write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,r,i){this._writeBaseLayers(t,e,i)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:se}},writer(t,e,r,i){this._writeBaseLayers(t,e,i)}}}}}})],Zi.prototype,"baseLayers",null),u([h({json:{read:!1,write:{ignoreOrigin:!0,target:"groundLayers",writer(t,e,r,i){this._writeGroundLayers(t,e,i)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{groundLayers:{type:se}},writer(t,e,r,i){this._writeGroundLayers(t,e,i)}}}}}})],Zi.prototype,"groundLayers",null),u([h({type:String,json:{origins:{"web-scene":{write:!0}}}})],Zi.prototype,"id",void 0),u([h({type:Me})],Zi.prototype,"portalItem",void 0),u([h()],Zi.prototype,"referenceLayers",null),u([h({readOnly:!0})],Zi.prototype,"resourceInfo",void 0),u([h({type:ne})],Zi.prototype,"spatialReference",void 0),u([h({type:xse})],Zi.prototype,"style",void 0),u([h()],Zi.prototype,"thumbnailUrl",void 0),u([h({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],Zi.prototype,"title",void 0),u([te("title")],Zi.prototype,"writeTitle",null),Zi=ap=u([E("esri.Basemap")],Zi);const Gse={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},qse={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},t0=Zi,Bse=Object.freeze(Object.defineProperty({__proto__:null,default:t0},Symbol.toStringTag,{value:"Module"})),j1={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function WV(t){return!!j1[t]||!!j1[t.toLowerCase()]}function jP(t){return j1[t]??j1[t.toLowerCase()]}function Hse(t){return[...jP(t)]}function Wx(t,e,r){r<0&&++r,r>1&&--r;const i=6*r;return i<1?t+(e-t)*i:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}function ZV(t,e,r,i=1){const s=(t%360+360)%360/360,n=r<=.5?r*(e+1):r+e-r*e,o=2*r-n;return[Math.round(255*Wx(o,n,s+1/3)),Math.round(255*Wx(o,n,s)),Math.round(255*Wx(o,n,s-1/3)),i]}function Wse(t){const e=t.length>5,r=e?8:4,i=(1<<r)-1,s=e?1:17,n=e?t.length===9:t.length===5;let o=+("0x"+t.slice(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return n&&(l=o&i,o>>=r,a[3]=s*l/255),l=o&i,o>>=r,a[2]=s*l,l=o&i,o>>=r,a[1]=s*l,l=o&i,o>>=r,a[0]=s*l,a}function JV(t){if(!t.startsWith("#")||isNaN(+`0x${t.slice(1)}`))return null;switch(t.length){case 4:case 5:{const e=parseInt(t.slice(1,2),16),r=parseInt(t.slice(2,3),16),i=parseInt(t.slice(3,4),16),s=t.length===4?15:parseInt(t.slice(4),16);return[e+16*e,r+16*r,i+16*i,(s+16*s)/255]}case 7:case 9:return[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16),(t.length===7?255:parseInt(t.slice(7),16))/255];default:return null}}function YV(t){const e=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(e){const r=e[2].split(/\s*,\s*/),i=e[1];if(i==="rgb"&&r.length===3||i==="rgba"&&r.length===4){if(r[0].endsWith("%")){const s=r.map(n=>2.56*parseFloat(n));return r.length===4&&(s[3]=parseFloat(r[3])),iO(s)}return iO(r.map(s=>parseFloat(s)))}if(i==="hsl"&&r.length===3||i==="hsla"&&r.length===4)return ZV(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100,parseFloat(r[3]??"1"))}return null}function iO(t){return t[0]=_f(t[0]),t[1]=_f(t[1]),t[2]=_f(t[2]),t[3]=t.length===4?KV(t[3]):1,t}function XV(t){let e=WV(t)?jP(t):null;return e??=YV(t),e??=JV(t),e}function w5e(t){const e=XV(t);return e!=null?[e[0]/255,e[1]/255,e[2]/255,e[3]]:null}function KV(t){return QV(t,0,1)}function _f(t){return Math.round(QV(t,0,255))}function QV(t,e,r){return t=Number(t),isNaN(t)?r:t<e?e:t>r?r:t}const e8=2.2,Zse=1/e8;function _5e(t){return t**e8}function b5e(t){return t**Zse}const sO=new Float32Array(1);function S5e(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function Qr(t,e,r){return Math.min(Math.max(t,e),r)}function x5e(t){return!(t&t-1)}function Jse(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function ig(t,e,r){return t+(e-t)*r}function $5e(t,e,r,i,s){return ig(i,s,(t-e)/(r-e))}function Ym(t){return t*Math.PI/180}function t8(t){return 180*t/Math.PI}function M5e(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function T5e(t){return Math.acos(Qr(t,-1,1))}function Yse(t){return Math.asin(Qr(t,-1,1))}function Ds(t,e,r=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=r}function r8(t,e,r=1e-6){return!Ds(t,e,r)&&t>e}function wT(t,e,r=1e-6){return!Ds(t,e,r)&&t<e}function Xse(t,e,r=1e-6){return Ds(t,e,r)||t>e}const V1=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function _T(t){return V1.setFloat64(0,t),V1.getBigInt64(0)}function Kse(t){return V1.setBigInt64(0,t),V1.getFloat64(0)}const q_=1000000n,Qse=i8(1);function i8(t){const e=_T(t=Math.abs(t)),r=Kse(e<=q_?q_:e-q_);return Math.abs(t-r)}function I5e(t,e,r=Qse){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(r!=null&&i8(Math.min(Math.abs(t),Math.abs(e)))<r)return Math.abs(t-e)<=r;const i=_T(t),s=_T(e);return i<0!=s<0?!1:!((i<s?s-i:i-s)>q_)}function s8(t,e,r=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;const i=Math.abs(t-e),s=Math.abs(t),n=Math.abs(e);if(t===0||e===0||s<1e-12&&n<1e-12){if(i>.01*r)return!1}else if(i/(s+n)>r)return!1;return!0}function E5e(t){return n8(Math.max(-nO,Math.min(t,nO)))}function n8(t){return sO[0]=t,sO[0]}function C5e(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],i=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(Ds(e,1)&&Ds(r,1)&&Ds(i,1))}function P5e(t,e){return(t%e+e)%e}const nO=n8(34028234663852886e22);function k5e(t,e,r){if(r===void 0||+r==0)return Math[t](e);if(e=+e,r=+r,isNaN(e)||typeof r!="number"||r%1!=0)return NaN;let i=e.toString().split("e");return i=(e=Math[t](+(i[0]+"e"+(i[1]?+i[1]-r:-r)))).toString().split("e"),+(i[0]+"e"+(i[1]?+i[1]+r:r))}function vw(t){return Qr(nP(t),0,255)}function ww(t,e){const r=t.toString(16).padStart(2,"0");return e?r.slice(0,1):r}let K=class Hs{static blendColors(e,r,i,s=new Hs){return s.r=Math.round(e.r+(r.r-e.r)*i),s.g=Math.round(e.g+(r.g-e.g)*i),s.b=Math.round(e.b+(r.b-e.b)*i),s.a=e.a+(r.a-e.a)*i,s._sanitize()}static fromRgb(e,r){const i=YV(e);return i?Hs.fromArray(i,r):null}static fromHex(e,r=new Hs){const i=JV(e);return i?Hs.fromArray(i,r):null}static fromArray(e,r=new Hs){return r._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(r.a)&&(r.a=1),r._sanitize()}static fromString(e,r){const i=XV(e);return i?Hs.fromArray(i,r):null}static fromJSON(e){return e!=null?new Hs([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e,r){return e==null?null:(r??=[0,0,0,0],r[0]=e.r/255,r[1]=e.g/255,r[2]=e.b/255,r[3]=e.a!=null?e.a:1,r)}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?Hs.fromString(e,this):Array.isArray(e)?Hs.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof Hs||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const r=e?.capitalize??!1,i=e?.digits??6,s=i===3||i===4,n=i===4||i===8,o=`#${ww(this.r,s)}${ww(this.g,s)}${ww(this.b,s)}${n?ww(Math.round(255*this.a),s):""}`;return r?o.toUpperCase():o}toCss(e=!1){const r=this.r+", "+this.g+", "+this.b;return e?`rgba(${r}, ${this.a})`:`rgb(${r})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=0){const r=vw(this.r),i=vw(this.g),s=vw(this.b);return e===0||this.a!==1?[r,i,s,vw(255*this.a)]:[r,i,s]}clone(){return new Hs(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=_f(this.r),this.g=_f(this.g),this.b=_f(this.b),this.a=KV(this.a),this}_set(e,r,i,s){this.r=e,this.g=r,this.b=i,this.a=s}};K.prototype.declaredClass="esri.Color";let Zn=class extends se{constructor(e){super(e),this.getCollections=null}initialize(){this.addHandles(_6(()=>this._refresh(),wa))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections?.();if(e==null)return void this.removeAll();let r=0;for(const i of e)i!=null&&(r=this._processCollection(r,i));this.splice(r)}_createNewInstance(e){return new se(e)}_processCollection(e,r){if(!r)return e;const i=this.itemFilterFunction??(s=>!!s);for(const s of r)if(s){if(i(s)){const n=this.indexOf(s,e);n>=0?n!==e&&this.reorder(s,e):this.add(s,e),++e}if(this.getChildrenFunction){const n=this.getChildrenFunction(s);if(Array.isArray(n))for(const o of n)e=this._processCollection(e,o);else e=this._processCollection(e,n)}}return e}};u([h()],Zn.prototype,"getCollections",void 0),u([h()],Zn.prototype,"getChildrenFunction",void 0),u([h()],Zn.prototype,"itemFilterFunction",void 0),Zn=u([E("esri.core.CollectionFlattener")],Zn);function ye(t,e={}){const r=t instanceof Ne?t:new Ne(t,e),{alwaysWriteDefaults:i,default:s,ignoreUnknown:n=!0,name:o,nonNullable:a,readOnly:l=!1}=e;return h({type:n?r.apiValues:String,json:{type:r.jsonValues,default:s,name:o,read:!l&&{reader:r.read},write:{writer:r.write,alwaysWriteDefaults:i}},nonNullable:a,readOnly:l})}var bT;let B_=bT=class extends W{constructor(t){super(t),this.type="none"}clone(){return new bT({type:this.type})}};u([ye({none:"none",stayAbove:"stay-above"}),h({json:{write:{isRequired:!0}}})],B_.prototype,"type",void 0),B_=bT=u([E("esri.ground.NavigationConstraint")],B_);const o8=Symbol("GroundInstance");function A5e(t){return t!=null&&typeof t=="object"&&o8 in t}function p2(t){const e=nP(100*(1-t));return Math.max(0,Math.min(e,100))}function j0(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var oO,ST,Q4;let Ws=ST=(Q4=class extends fc(Cv){constructor(t){super(t),this[oO]=!0,this.parent=null,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new se;const e=i=>{const{parent:s}=i;s&&s!==this&&"remove"in s&&s.remove?.(i),i.parent=this,i.type!=="elevation"&&i.type!=="base-elevation"&&U.getLogger(this).error(`Layer '${i.title}, id:${i.id}' of type '${i.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},r=i=>{i.parent=null};this.addHandles([this.layers.on("after-add",i=>e(i.item)),this.layers.on("after-remove",i=>r(i.item))]),this.allLayers=new Zn({getCollections:()=>[this.layers,this.parent?.basemap?.groundLayers]})}removeChildLayer(t){this.layers.remove(t)}initialize(){this.when().catch(t=>{Ur(t)||U.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}get integratedMeshGround(){const t=this.parent?.basemap?.groundLayers.at(0);return t?.replacesTerrain?t:null}destroy(){const t=this.layers.removeAll();for(const e of t)xt(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}get loaded(){return super.loaded}get layers(){return this._get("layers")}set layers(t){this._set("layers",la(t,this._get("layers")))}writeLayers(t,e,r,i){const s=[];t&&(i={...i,layerContainerType:"ground"},t.forEach(n=>{if("write"in n){const o={};NY(n)().write(o,i)&&s.push(o)}else i?.messages&&i.messages.push(new R("layer:unsupported",`Layers (${n.title}, ${n.id}) of type '${n.declaredClass}' cannot be persisted in the ground`,{layer:n}))})),e.layers=s}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return Z6(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e?.signal});const{queryAll:r}=await q(()=>import("./ElevationQuery-Bol74dYN.js"),__vite__mapDeps([12,13]));return gt(e),r(this.layers.filter(aO).toArray(),t,e)}async createElevationSampler(t,e){await this.load({signal:e?.signal});const{createSampler:r}=await q(()=>import("./ElevationQuery-Bol74dYN.js"),__vite__mapDeps([12,13]));return gt(e),r(this.layers.filter(aO).toArray(),t,e)}clone(){const t={opacity:this.opacity,surfaceColor:O(this.surfaceColor),navigationConstraint:O(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new ST({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,r){const i=e?.origin||"web-scene",s=e?.portal||null,n=e?.url||null,{populateOperationalLayers:o}=await q(async()=>{const{populateOperationalLayers:l}=await import("./layersCreator-4rKmFUn3.js");return{populateOperationalLayers:l}},__vite__mapDeps([11,8,7,6,9,5]));gt(r);const a=[];if(t.layers&&Array.isArray(t.layers)){const l={context:{origin:i,url:n,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,t.layers,l))}await Promise.allSettled(a)}},oO=o8,Q4);function aO(t){return t&&"createElevationSampler"in t}u([h()],Ws.prototype,"parent",void 0),u([h()],Ws.prototype,"integratedMeshGround",null),u([h({json:{read:!1,write:{isRequired:!0}}})],Ws.prototype,"layers",null),u([h()],Ws.prototype,"allLayers",void 0),u([te("layers")],Ws.prototype,"writeLayers",null),u([h({readOnly:!0})],Ws.prototype,"resourceInfo",void 0),u([h({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:Ue,read:{reader:j0,source:"transparency"},write:{writer:(t,e)=>{e.transparency=p2(t)},target:"transparency"}}})],Ws.prototype,"opacity",void 0),u([h({type:K,json:{type:[Ue],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],Ws.prototype,"surfaceColor",void 0),u([h({type:B_,json:{write:!0}})],Ws.prototype,"navigationConstraint",void 0),Ws=ST=u([E("esri.Ground")],Ws);const U1=Ws,ene=Symbol("ClonableMixin"),Ie=t=>{var s;var e;const r=t;let i=(s=class extends r{constructor(){super(...arguments),this[e]=!0}clone(n){const o=Hi(this);xv(o,"unable to clone instance of non-accessor class");const a=o.metadata,l=o.store,c={},d=new Map;for(const m in a){const y=a[m],g=l?.originOf(m),v=y.clonable;if(y.readOnly||v===!1||g!==7&&g!==0&&g!==5&&g!==4)continue;const w=this[m];let _=null;if(typeof v=="function")_=v(w,n);else if(v==="reference")_=w;else if(_=MM(w,n),w!=null&&_==null)continue;g===0?d.set(m,_):c[m]=_}const p=new(Object.getPrototypeOf(this)).constructor(c);if(d.size){const m=Hi(p)?.store;if(m)for(const[y,g]of d)m.set(y,g,0)}return p}},e=ene,s);return i=u([E("esri.core.Clonable")],i),i},VP=Ie(le),tne="randomUUID"in crypto;function Xm(){if(tne)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=r=>t[r].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function R5e(){return`{${Xm().toUpperCase()}}`}function rne(){return`{${Xm()}}`}function ine(t){const e=t.toUpperCase();return t.startsWith("{")?e:`{${e}}`}const Od={Base64:0,Hex:1,String:2,Raw:3},bf=8,a8=(1<<bf)-1;function Fu(t,e){const r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function sne(t){const e=[];for(let r=0,i=t.length*bf;r<i;r+=bf)e[r>>5]|=(t.charCodeAt(r/bf)&a8)<<r%32;return e}function nne(t){const e=[];for(let r=0,i=32*t.length;r<i;r+=bf)e.push(String.fromCharCode(t[r>>5]>>>r%32&a8));return e.join("")}function one(t){const e="0123456789abcdef",r=[];for(let i=0,s=4*t.length;i<s;i++)r.push(e.charAt(t[i>>2]>>i%4*8+4&15)+e.charAt(t[i>>2]>>i%4*8&15));return r.join("")}function ane(t){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[];for(let s=0,n=4*t.length;s<n;s+=3){const o=(t[s>>2]>>s%4*8&255)<<16|(t[s+1>>2]>>(s+1)%4*8&255)<<8|t[s+2>>2]>>(s+2)%4*8&255;for(let a=0;a<4;a++)8*s+6*a>32*t.length?i.push("="):i.push(r.charAt(o>>6*(3-a)&63))}return i.join("")}function lne(t,e){return t<<e|t>>>32-e}function f2(t,e,r,i,s,n){return Fu(lne(Fu(Fu(e,t),Fu(i,n)),s),r)}function ri(t,e,r,i,s,n,o){return f2(e&r|~e&i,t,e,s,n,o)}function ii(t,e,r,i,s,n,o){return f2(e&i|r&~i,t,e,s,n,o)}function si(t,e,r,i,s,n,o){return f2(e^r^i,t,e,s,n,o)}function ni(t,e,r,i,s,n,o){return f2(r^(e|~i),t,e,s,n,o)}function une(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let r=1732584193,i=-271733879,s=-1732584194,n=271733878;for(let o=0;o<t.length;o+=16){const a=r,l=i,c=s,d=n;r=ri(r,i,s,n,t[o],7,-680876936),n=ri(n,r,i,s,t[o+1],12,-389564586),s=ri(s,n,r,i,t[o+2],17,606105819),i=ri(i,s,n,r,t[o+3],22,-1044525330),r=ri(r,i,s,n,t[o+4],7,-176418897),n=ri(n,r,i,s,t[o+5],12,1200080426),s=ri(s,n,r,i,t[o+6],17,-1473231341),i=ri(i,s,n,r,t[o+7],22,-45705983),r=ri(r,i,s,n,t[o+8],7,1770035416),n=ri(n,r,i,s,t[o+9],12,-1958414417),s=ri(s,n,r,i,t[o+10],17,-42063),i=ri(i,s,n,r,t[o+11],22,-1990404162),r=ri(r,i,s,n,t[o+12],7,1804603682),n=ri(n,r,i,s,t[o+13],12,-40341101),s=ri(s,n,r,i,t[o+14],17,-1502002290),i=ri(i,s,n,r,t[o+15],22,1236535329),r=ii(r,i,s,n,t[o+1],5,-165796510),n=ii(n,r,i,s,t[o+6],9,-1069501632),s=ii(s,n,r,i,t[o+11],14,643717713),i=ii(i,s,n,r,t[o],20,-373897302),r=ii(r,i,s,n,t[o+5],5,-701558691),n=ii(n,r,i,s,t[o+10],9,38016083),s=ii(s,n,r,i,t[o+15],14,-660478335),i=ii(i,s,n,r,t[o+4],20,-405537848),r=ii(r,i,s,n,t[o+9],5,568446438),n=ii(n,r,i,s,t[o+14],9,-1019803690),s=ii(s,n,r,i,t[o+3],14,-187363961),i=ii(i,s,n,r,t[o+8],20,1163531501),r=ii(r,i,s,n,t[o+13],5,-1444681467),n=ii(n,r,i,s,t[o+2],9,-51403784),s=ii(s,n,r,i,t[o+7],14,1735328473),i=ii(i,s,n,r,t[o+12],20,-1926607734),r=si(r,i,s,n,t[o+5],4,-378558),n=si(n,r,i,s,t[o+8],11,-2022574463),s=si(s,n,r,i,t[o+11],16,1839030562),i=si(i,s,n,r,t[o+14],23,-35309556),r=si(r,i,s,n,t[o+1],4,-1530992060),n=si(n,r,i,s,t[o+4],11,1272893353),s=si(s,n,r,i,t[o+7],16,-155497632),i=si(i,s,n,r,t[o+10],23,-1094730640),r=si(r,i,s,n,t[o+13],4,681279174),n=si(n,r,i,s,t[o],11,-358537222),s=si(s,n,r,i,t[o+3],16,-722521979),i=si(i,s,n,r,t[o+6],23,76029189),r=si(r,i,s,n,t[o+9],4,-640364487),n=si(n,r,i,s,t[o+12],11,-421815835),s=si(s,n,r,i,t[o+15],16,530742520),i=si(i,s,n,r,t[o+2],23,-995338651),r=ni(r,i,s,n,t[o],6,-198630844),n=ni(n,r,i,s,t[o+7],10,1126891415),s=ni(s,n,r,i,t[o+14],15,-1416354905),i=ni(i,s,n,r,t[o+5],21,-57434055),r=ni(r,i,s,n,t[o+12],6,1700485571),n=ni(n,r,i,s,t[o+3],10,-1894986606),s=ni(s,n,r,i,t[o+10],15,-1051523),i=ni(i,s,n,r,t[o+1],21,-2054922799),r=ni(r,i,s,n,t[o+8],6,1873313359),n=ni(n,r,i,s,t[o+15],10,-30611744),s=ni(s,n,r,i,t[o+6],15,-1560198380),i=ni(i,s,n,r,t[o+13],21,1309151649),r=ni(r,i,s,n,t[o+4],6,-145523070),n=ni(n,r,i,s,t[o+11],10,-1120210379),s=ni(s,n,r,i,t[o+2],15,718787259),i=ni(i,s,n,r,t[o+9],21,-343485551),r=Fu(r,a),i=Fu(i,l),s=Fu(s,c),n=Fu(n,d)}return[r,i,s,n]}function UP(t,e=Od.Hex){const r=e||Od.Base64,i=une(sne(t),t.length*bf);switch(r){case Od.Raw:return i;case Od.Hex:return one(i);case Od.String:return nne(i);case Od.Base64:return ane(i)}}function cne(t){return t&&"getAtOrigin"in t&&"originOf"in t}function xT(t){return GP[hne(t)]||pne}function hne(t){return t.type==="json"?"application/json":t.type==="blob"?t.blob.type:dne(t.url)}function dne(t){const e=Lz(t);return $T[e]||l8}const GP={},l8="text/plain",pne=GP[l8],$T={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const t in $T)GP[$T[t]]=t;function fne(t){const e=t?.origins??[void 0];return(r,i)=>{const s=mne(t,r,i);for(const n of e){const o=oP(r,n,i);for(const a in s)o[a]=s[a]}}}function mne(t,e,r){if(t?.type==="resource")return yne(t,e,r);switch(t?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:i,write:s}=UX;return{read:i,write:s}}}}function yne(t,e,r){const i=Tv(e,r);return{type:String,read:(s,n,o)=>{const a=BS(s,n,o);return i.type===String?a:typeof i.type=="function"?new i.type({url:a}):void 0},write:{isRequired:i.json?.write?.isRequired,writer(s,n,o,a){if(!a?.resources)return typeof s=="string"?void(n[o]=td(s,a)):void(n[o]=s.write({},a));const l=wne(s),c=td(l,{...a,verifyItemRelativeUrls:a?.verifyItemRelativeUrls?{writtenUrls:a.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},1),d=i.type!==String&&(!cne(this)||a?.origin&&this.originIdOf(r)>ml(a.origin)),p={object:this,propertyName:r,value:s,targetUrl:c,dest:n,targetPropertyName:o,context:a,params:t};a?.portalItem&&c&&!cs(c)?d&&t?.contentAddressed?MT(p):d?gne(p):vne(p):a?.portalItem&&(c==null||jz(c)!=null||Om(c)||d)?MT(p):n[o]=c}}}}function MT(t){const{targetUrl:e,params:r,value:i,context:s,dest:n,targetPropertyName:o}=t;if(!s.portalItem)return;const a=Vz(e),l=c8(i,e,s);if(r?.contentAddressed&&l.type!=="json")return void s.messages?.push(new R("persistable:contentAddressingUnsupported",`Property "${o}" is trying to serializing a resource with content of type ${l.type} with content addressing. Content addressing is only supported for json resources.`,{content:l}));const c=r?.contentAddressed&&l.type==="json"?UP(l.jsonString):a?.filename??Xm(),d=ed(r?.prefix??a?.prefix,c),p=`${d}.${xT(l)}`;if(r?.contentAddressed&&s.resources&&l.type==="json"){const g=s.resources.toKeep.find(({resource:v})=>v.path===p)??s.resources.toAdd.find(({resource:v})=>v.path===p);if(g)return void(n[o]=g.resource.itemRelativeUrl)}const m=s.portalItem.resourceFromPath(p);Om(e)&&s.resources&&s.resources.pendingOperations.push(yX(e).then(g=>{m.path=`${d}.${xT({type:"blob",blob:g})}`,n[o]=m.itemRelativeUrl}).catch(()=>{}));const y=r?.compress??!1;s.resources&&u8({...t,resource:m,content:l,compress:y,updates:s.resources.toAdd}),n[o]=m.itemRelativeUrl}function gne(t){const{context:e,targetUrl:r,params:i,value:s,dest:n,targetPropertyName:o}=t;if(!e.portalItem)return;const a=e.portalItem.resourceFromPath(r),l=c8(s,r,e),c=xT(l),d=Lz(a.path),p=i?.compress??!1;c===d?(e.resources&&u8({...t,resource:a,content:l,compress:p,updates:e.resources.toUpdate}),n[o]=r):MT(t)}function vne({context:t,targetUrl:e,dest:r,targetPropertyName:i}){t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(e),compress:!1}),r[i]=e)}function u8({object:t,propertyName:e,updates:r,resource:i,content:s,compress:n}){const o=a=>{_ne(t,e,a)};r.push({resource:i,content:s,compress:n,finish:o})}function c8(t,e,r){return typeof t=="string"?{type:"url",url:e}:{type:"json",jsonString:JSON.stringify(t.toJSON(r))}}function wne(t){return t==null?null:typeof t=="string"?t:t.url}function _ne(t,e,r){typeof t[e]=="string"?t[e]=r.url:t[e].url=r.url}let H_=class extends Ie(W){constructor(e){super(e),this.color=null}};u([h({type:K,json:{type:[Ue],write:!0}})],H_.prototype,"color",void 0),H_=u([E("esri.effects.FocusAreaOutline")],H_);const bne=H_;function m2(t){const e=[];for(t.reset();t.nextPath();){const r=[];for(;t.nextPoint();)r.push([t.x,t.y]);e.push(r)}return t.reset(),e}function Wu(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}function F5e(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,r=t.hasM;if(t.type==="point")return r&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:r?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice();if(t.type==="polyline")return t.paths.slice();if(t.type==="multipoint")return t.points.map(i=>[i]);if(t.type==="extent"){const i=t.clone().normalize();if(!i)return null;let s=!1,n=!1;return i.forEach(o=>{o.hasZ&&(s=!0),o.hasM&&(n=!0)}),i.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(s&&o.hasZ){const l=.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(l)}if(n&&o.hasM){const l=.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(l)}return a})}return null}function y2(t,e){const r=e[0]-t[0],i=e[1]-t[1];if(t.length>2&&e.length>2){const s=t[2]-e[2];return Math.sqrt(r*r+i*i+s*s)}return Math.sqrt(r*r+i*i)}function h8(t,e,r){const i=t[0]+r*(e[0]-t[0]),s=t[1]+r*(e[1]-t[1]);return t.length>2&&e.length>2?[i,s,t[2]+r*(e[2]-t[2])]:[i,s]}function Sne(t,e,r,i){return d8(t,e,r[i],r[i+1])}function d8(t,e,r,i){const[s,n]=e,[o,a]=r,[l,c]=i,d=l-o,p=c-a,m=d*d+p*p,y=(s-o)*d+(n-a)*p,g=Math.min(1,Math.max(0,y/m));return t[0]=o+d*g,t[1]=a+p*g,t}function xne(t,e,r,i,s,n){let o=r,a=i,l=s-o,c=n-a;if(l!==0||c!==0){const d=((t-o)*l+(e-a)*c)/(l*l+c*c);d>1?(o=s,a=n):d>0&&(o+=l*d,a+=c*d)}return l=t-o,c=e-a,l*l+c*c}function p8(t,e){return h8(t,e,.5)}function $ne(t){const e=t.length;let r=0;for(let i=0;i<e-1;++i)r+=y2(t[i],t[i+1]);return r}function N5e(t,e){if(e<=0)return t[0];const r=t.length;let i=0;for(let s=0;s<r-1;++s){const n=y2(t[s],t[s+1]);if(e-i<n){const o=(e-i)/n;return h8(t[s],t[s+1],o)}i+=n}return t[r-1]}function f8(t,e=0,r=1){let i=0;const s=t.length;let n=t[0];for(let o=1;o<s;o++){const a=t[o];i+=(a[e]-n[e])*(a[r]+n[r]),n=a}if(m8(t)){const o=t[0];i+=(o[e]-n[e])*(o[r]+n[r])}return i>=0}function m8(t){const e=t.length;return e>0&&!DS(t[0],t[e-1])}function D5e(t){"rings"in t&&(Mne(t),Tne(t))}function Mne(t){if("rings"in t)for(const e of t.rings)m8(e)&&e.push(e[0].slice())}function Tne(t){if(!("rings"in t)||t.rings.length===0||f8(t.rings[0]))return!1;for(const e of t.rings)e.reverse();return!0}function z5e(t){return t.type!=="polygon"&&t.type!=="polyline"||Ine(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function Ine(t,e){const r=qi(e);if(!r)return;const i=r.valid[0],s=r.valid[1],n=s-i;for(const o of t){let a=1/0,l=-1/0;for(const d of o){const p=Ene(d[0],i,s);a=Math.min(a,p),l=Math.max(l,p),d[0]=p}const c=l-a;n-c<c&&o.forEach(d=>{d[0]<0&&(d[0]+=n)})}}function Ene(t,e,r){const i=r-e;return t<e?r-(e-t)%i:t>r?e+(t-e)%i:t}function j5e(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[r,i]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return r.length===i.length&&r.every((s,n)=>s.length===i[n].length)}function V5e(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function y8(t){return Cne(t.rings,t.hasZ??!1)}function g8(t){const e=y8(t);if(!e)return null;const{hasZ:r,spatialReference:i}=t,[s,n,o]=e;return isNaN(s)||isNaN(n)||r&&isNaN(o)?null:{x:s,y:n,z:r?o:void 0,spatialReference:i}}function Cne(t,e){if(!t?.length)return null;const r=[],i=[],s=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let n=0,o=t.length;n<o;n++){const a=v8(t[n],e,s);a&&i.push(a)}if(i.sort((n,o)=>{let a=n[2]-o[2];return a===0&&e&&(a=n[4]-o[4]),a}),i.length&&(r[0]=i[0][0],r[1]=i[0][1],e&&(r[2]=i[0][3]),(r[0]<s[0]||r[0]>s[1]||r[1]<s[2]||r[1]>s[3]||e&&(r[2]<s[4]||r[2]>s[5]))&&(r.length=0)),!r.length){const n=t[0]&&t[0].length?kne(t[0],e):null;if(!n)return null;r[0]=n[0],r[1]=n[1],e&&n.length>2&&(r[2]=n[2])}return r}function v8(t,e,r){let i=0,s=0,n=0,o=0,a=0;const l=t.length?t[0][0]:0,c=t.length?t[0][1]:0,d=t.length&&e?t[0][2]:0;for(let m=0;m<t.length;m++){const y=t[m],g=t[(m+1)%t.length],[v,w,_]=y,x=v-l,$=w-c,[T,C,P]=g,A=T-l,F=C-c,j=x*F-A*$;if(o+=j,i+=(x+A)*j,s+=($+F)*j,e&&y.length>2&&g.length>2){const V=_-d,Z=P-d,Y=x*Z-A*V;n+=(V+Z)*Y,a+=Y}v<r[0]&&(r[0]=v),v>r[1]&&(r[1]=v),w<r[2]&&(r[2]=w),w>r[3]&&(r[3]=w),e&&(_<r[4]&&(r[4]=_),_>r[5]&&(r[5]=_))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const p=[i/(6*o)+l,s/(6*o)+c,o];return e&&(r[4]===r[5]||a===0?(p[3]=(r[4]+r[5])/2,p[4]=0):(p[3]=n/(6*a)+d,p[4]=a)),p}function Pne(t,e){let r=0,i=0,s=0;t.nextPoint();const n=t.pathSize?t.x:0,o=t.pathSize?t.y:0;for(let a=0;a<t.pathSize;a++){t.seekInPath(a);const l=[t.x,t.y];t.seekInPath((a+1)%t.pathSize);const c=[t.x,t.y],[d,p]=l,m=d-n,y=p-o,[g,v]=c,w=g-n,_=v-o,x=m*_-w*y;s+=x,r+=(m+w)*x,i+=(y+_)*x,d<e[0]&&(e[0]=d),d>e[1]&&(e[1]=d),p<e[2]&&(e[2]=p),p>e[3]&&(e[3]=p)}return s>0&&(s*=-1),s?(s*=.5,[r/(6*s)+n,i/(6*s)+o,s]):null}function kne(t,e){const r=e?[0,0,0]:[0,0],i=e?[0,0,0]:[0,0];let s=0,n=0,o=0,a=0;for(let l=0,c=t.length;l<c-1;l++){const d=t[l],p=t[l+1];if(d&&p){r[0]=d[0],r[1]=d[1],i[0]=p[0],i[1]=p[1],e&&d.length>2&&p.length>2&&(r[2]=d[2],i[2]=p[2]);const m=y2(r,i);if(m){s+=m;const y=p8(d,p);n+=m*y[0],o+=m*y[1],e&&y.length>2&&(a+=m*y[2])}}}return s>0?e?[n/s,o/s,a/s]:[n/s,o/s]:t.length?t[0]:null}function w8(t){const{hasZ:e,totalSize:r}=t;if(r===0)return null;const i=[],s=[],n=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const o=v8(Wu(t),t.hasZ,n);o&&s.push(o)}if(s.sort((o,a)=>{let l=o[2]-a[2];return l===0&&e&&(l=o[4]-a[4]),l}),s.length&&(i[0]=s[0][0],i[1]=s[0][1],e&&(i[2]=s[0][3]),(i[0]<n[0]||i[0]>n[1]||i[1]<n[2]||i[1]>n[3]||e&&(i[2]<n[4]||i[2]>n[5]))&&(i.length=0)),!i.length){t.reset(),t.nextPath();const o=t.pathSize?Lne(t):null;if(!o)return null;i[0]=o[0],i[1]=o[1],e&&o.length>2&&(i[2]=o[2])}return i}function Lne(t){const{hasZ:e}=t,r=e?[0,0,0]:[0,0],i=e?[0,0,0]:[0,0];let s=0,n=0,o=0,a=0;if(t.nextPoint()){let l=t.x,c=t.y,d=t.z;for(;t.nextPoint();){const p=t.x,m=t.y,y=t.z;r[0]=l,r[1]=c,i[0]=p,i[1]=m,e&&(r[2]=d,i[2]=y);const g=y2(r,i);if(g){s+=g;const v=p8(r,i);n+=g*v[0],o+=g*v[1],e&&v.length>2&&(a+=g*v[2])}l=p,c=m,d=y}}return s>0?e?[n/s,o/s,a/s]:[n/s,o/s]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const Ane=1e-6;function Rne(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<Ane){const s=w8(t);return s?[s[0],s[1]]:null}const r=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const i=[t.x,t.y];for(t.reset();t.nextPath();)Fne(r,i,t);return r[0]*=1/e,r[1]*=1/e,r[0]+=i[0],r[1]+=i[1],r}const One=1/3;function Fne(t,e,r){if(!t||!r||r.pathSize<3)return null;r.nextPoint();const i=r.x,s=r.y;r.nextPoint();let n,o=r.x-i,a=r.y-s,l=0,c=0;for(;r.nextPoint();)l=r.x-i,c=r.y-s,n=.5*One*(l*a-c*o),t[0]+=n*(o+l),t[1]+=n*(a+c),o=l,a=c;const d=r.getCurrentRingArea(),p=[i,s];return p[0]-=e[0],p[1]-=e[1],p[0]*=d,p[1]*=d,t[0]+=p[0],t[1]+=p[1],t}function lr(t=Gne){return[t[0],t[1],t[2],t[3]]}function _8(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function b8(t,e,r,i,s=lr()){return s[0]=t,s[1]=e,s[2]=r,s[3]=i,s}function U5e(t,e=lr()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function Nne(t,e,r=new Te){return r.xmin=t[0],r.ymin=t[1],r.xmax=t[2],r.ymax=t[3],r.spatialReference=e,r}function Kr(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Dne(t,e){e<t[0]&&(t[0]=e),e>t[2]&&(t[2]=e)}function zne(t,e){e<t[1]&&(t[1]=e),e>t[3]&&(t[3]=e)}function G5e(t,e,r){if(e!=null)if("length"in e)IT(e)?(r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r[2]=Math.max(t[2],e[2]),r[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r[2]=Math.max(t[2],e[0]),r[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":r[0]=Math.min(t[0],e.xmin),r[1]=Math.min(t[1],e.ymin),r[2]=Math.max(t[2],e.xmax),r[3]=Math.max(t[3],e.ymax);break;case"point":r[0]=Math.min(t[0],e.x),r[1]=Math.min(t[1],e.y),r[2]=Math.max(t[2],e.x),r[3]=Math.max(t[3],e.y)}else _8(r,t)}function q5e(t,e,r=t){const i=e.length;let s=t[0],n=t[1],o=t[2],a=t[3];for(let l=0;l<i;l++){const c=e[l];s=Math.min(s,c[0]),n=Math.min(n,c[1]),o=Math.max(o,c[0]),a=Math.max(a,c[1])}return r[0]=s,r[1]=n,r[2]=o,r[3]=a,r}function B5e(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function g2(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function v2(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function H5e(t){return g2(t)*v2(t)}function lO(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function jne(t){const e=g2(t),r=v2(t);return Math.sqrt(e*e+r*r)}function W5e(t,e){return!!t&&TT(t,e.x,e.y)}function TT(t,e,r){return e>=t[0]&&r>=t[1]&&e<=t[2]&&r<=t[3]}function Z5e(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function J5e(t,e,r){return Math.max(e[0],t[0])-r<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])-r<=Math.min(e[3],t[3])}function Vne(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function Y5e(t,e,r,i){return i??=t,i[0]=t[0]+e,i[1]=t[1]+r,i[2]=t[2]+e,i[3]=t[3]+r,i}function Une(t){return t?_8(t,uO):lr(uO)}function IT(t){return t!=null&&t.length===4}function X5e(t,e){return IT(t)&&IT(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const uO=[1/0,1/0,-1/0,-1/0],Gne=[0,0,0,0];let qP=1e-6;function Bi(){return qP}function qne(t){qP=t}const w2=Math.random,Bne=Math.PI/180,Hne=180/Math.PI;function BP(t){return t*Bne}function Wne(t){return t*Hne}function Zne(t,e){return Math.abs(t-e)<=qP*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:w2,equals:Zne,getEpsilon:Bi,setEpsilon:qne,toDegree:Wne,toRadian:BP},Symbol.toStringTag,{value:"Module"}));function Sf(t,e){return t[0]=e[0],t[1]=e[1],t}function Xt(t,e,r){return t[0]=e,t[1]=r,t}function S8(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function V0(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function x8(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function $8(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function Jne(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function Yne(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function Xne(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function Kne(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function Qne(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function Fv(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function eoe(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t}function _2(t,e){const r=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(r*r+i*i)}function U0(t,e){const r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i}function G1(t){const e=t[0],r=t[1];return Math.sqrt(e*e+r*r)}function M8(t){const e=t[0],r=t[1];return e*e+r*r}function T8(t,e){return t[0]=-e[0],t[1]=-e[1],t}function toe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function ET(t,e){const r=e[0],i=e[1];let s=r*r+i*i;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s),t}function I8(t,e){return t[0]*e[0]+t[1]*e[1]}function E8(t,e,r){const i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t}function roe(t,e,r,i){const s=e[0],n=e[1];return t[0]=s+i*(r[0]-s),t[1]=n+i*(r[1]-n),t}function ioe(t,e=1){const r=2*w2()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function soe(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[2]*s,t[1]=r[1]*i+r[3]*s,t}function gi(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[2]*s+r[4],t[1]=r[1]*i+r[3]*s+r[5],t}function W_(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[3]*s+r[6],t[1]=r[1]*i+r[4]*s+r[7],t}function noe(t,e,r){const i=e[0],s=e[1];return t[0]=r[0]*i+r[4]*s+r[12],t[1]=r[1]*i+r[5]*s+r[13],t}function ooe(t,e,r,i){const s=e[0]-r[0],n=e[1]-r[1],o=Math.sin(i),a=Math.cos(i);return t[0]=s*a-n*o+r[0],t[1]=s*o+n*a+r[1],t}function aoe(t,e){const r=t[0],i=t[1],s=e[0],n=e[1];let o=r*r+i*i;o>0&&(o=1/Math.sqrt(o));let a=s*s+n*n;a>0&&(a=1/Math.sqrt(a));const l=(r*s+i*n)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function loe(t){return"vec2("+t[0]+", "+t[1]+")"}function uoe(t,e){return t[0]===e[0]&&t[1]===e[1]}function coe(t,e){const r=t[0],i=t[1],s=e[0],n=e[1],o=Bi();return Math.abs(r-s)<=o*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-n)<=o*Math.max(1,Math.abs(i),Math.abs(n))}function hoe(t,e,r,i,s){let n=e[0]-r[0],o=e[1]-r[1];const a=(i[0]*n+i[1]*o)*(s-1);return n=i[0]*a,o=i[1]*a,t[0]=e[0]+n,t[1]=e[1]+o,t}const doe=G1,HP=V0,poe=x8,foe=$8,moe=_2,yoe=U0,goe=M8;Object.freeze(Object.defineProperty({__proto__:null,add:S8,angle:aoe,ceil:Jne,copy:Sf,cross:E8,dist:moe,distance:_2,div:foe,divide:$8,dot:I8,equals:coe,exactEquals:uoe,floor:Yne,inverse:toe,len:doe,length:G1,lerp:roe,max:Kne,min:Xne,mul:poe,multiply:x8,negate:T8,normalize:ET,projectAndScale:hoe,random:ioe,rotate:ooe,round:Qne,scale:Fv,scaleAndAdd:eoe,set:Xt,sqrDist:yoe,sqrLen:goe,squaredDistance:U0,squaredLength:M8,str:loe,sub:HP,subtract:V0,transformMat2:soe,transformMat2d:gi,transformMat3:W_,transformMat4:noe},Symbol.toStringTag,{value:"Module"}));function ll(t,e,r,i){return t[0]=e[0]*(1-i)+r[0]*i,t[1]=e[1]*(1-i)+r[1]*i,t}function Gi(t,e){return U0(t,e)}function K5e(t,e,r){const i=Gi(e,r);if(i===0)return Gi(e,t);const s=(e[0]-t[0])*(r[1]-t[1])-(e[1]-t[1])*(r[0]-t[0]);return s*s/i}function voe(t,e,r,i,s){const[n,o]=e,[a,l]=r,[c,d]=i,[p,m]=s,y=(n-a)*(d-m)-(o-l)*(c-p);if(y===0)return null;const g=(n*l-o*a)*(c-p)-(n-a)*(c*m-d*p),v=(n*l-o*a)*(d-m)-(o-l)*(c*m-d*p);return t[0]=g/y,t[1]=v/y,t}const Xn=2*Math.PI;function Gh(t,e){const r=Math.atan2(t,e);return r<0?r+Xn:r}function C8(t){return Math.abs(t)%Xn}function cO(t){const e=C8(t);return e<Math.PI?e:Xn-e}function b2(t,e){return{min:Math.min(t,e),max:Math.max(t,e)}}function P8(t,e,r,i){if(Ds(C8(t-e),0))return r?[t,t]:[t,i?t-Xn:t+Xn];const[s,n]=i?[t-Xn,t]:[t,t+Xn];return[t,Nv({min:s,max:n},e)]}function Nv({min:t,max:e},r){let i;return i=e-r,i>=Xn?(i-=i%Xn,r+i):(i=r-t,i>=Xn?(i-=i%Xn,r-i):r)}function woe(t,e){const r=Nv(t,e);return r>t.min&&r<t.max?r:cO(r-t.min)<cO(r-t.max)?t.min:t.max}function k8(t,e,r,i=10){return e.map(s=>{let n=s;for(let o=0;o<i;o++){const[a,l,c,d,p,m]=r(n),y=t[0]-a,g=t[1]-l,v=-c,w=-d;n+=-(2*y*v+2*g*w)/(2*v*v+2*y*-p+2*w*w+2*g*-m||1e-6)}return n})}const _oe=[0,0];function L8(t){const e=1-t,r=e*e,i=t*t;return[r*e,3*t*r,3*i*e,i*t]}function CT(t,e,r,i,s){const[n,o,a,l]=L8(s);return[t[0]*n+e[0]*o+r[0]*a+i[0]*l,t[1]*n+e[1]*o+r[1]*a+i[1]*l]}function hO(t,e,r,i,s){const[n,o,a,l]=L8(s);return t*n+e*o+r*a+i*l}function Q5e(t,e,r){const i=t,[s,n,o]=e.b;return CT(i,n,o,s,r)}function boe(t,e,r){const i=t,[s,n,o]=e.b,a=ll([0,0],i,n,r),l=ll(_oe,n,o,r),c=ll([0,0],o,s,r),d=ll([0,0],a,l,r),p=ll([0,0],l,c,r);return[{b:[ll([],d,p,r),a,d]},{b:[[...s],p,c]}]}function eFe(t,e,r){const i=t,[s,n,o]=e.b,a=k8(r,[.1,.5,.9],p=>{const m=1-p,[y,g]=CT(i,n,o,s,p);return[y,g,3*m*m*(n[0]-i[0])+6*m*p*(o[0]-n[0])+3*p*p*(s[0]-o[0]),3*m*m*(n[1]-i[1])+6*m*p*(o[1]-n[1])+3*p*p*(s[1]-o[1]),6*m*(o[0]-2*n[0]+i[0])+6*p*(s[0]-2*o[0]+n[0]),6*m*(o[1]-2*n[1]+i[1])+6*p*(s[1]-2*o[1]+n[1])]}).map(p=>Math.min(1,Math.max(0,p)));a.push(0,1);let l=1/0;const c=a.map(p=>{const m=CT(i,n,o,s,p),[y,g]=m,v=r[0]-y,w=r[1]-g,_=Math.sqrt(v*v+w*w);return l=Math.min(_,l),{t:p,curvePoint:m,distance:_}}),d=[];for(const p of c){const{t:m,distance:y}=p;s8(y,l)&&!d.some(({t:g})=>Ds(g,m))&&d.push(p)}return d}function Soe(t,e,r){const i=e,[s,n,o]=r.b;if(Kr(t,i),Kr(t,s),TT(t,n[0],n[1])&&TT(t,o[0],o[1]))return t;for(const a of dO(i[0],n[0],o[0],s[0]))a>0&&a<1&&Dne(t,hO(i[0],n[0],o[0],s[0],a));for(const a of dO(i[1],n[1],o[1],s[1]))a>0&&a<1&&zne(t,hO(i[1],n[1],o[1],s[1],a));return t}function dO(t,e,r,i){const s=3*(3*(e-r)-t+i),n=6*(t-2*e+r),o=3*(e-t);if(s===0)return n!==0?[-o/n]:[];const a=Math.sqrt(n*n-4*s*o);return[(-n+a)/(2*s),(-n-a)/(2*s)]}function tFe(t,e,r){let s=0,n=[e];for(let o=0;o<16;o++){let a=t;const l=[];for(const d of n)l.push(...boe(a,d,.5)),a=d.b[0];n=l,a=t,s=0;let c=0;for(const d of n){const[p,m,y]=d.b,g=Math.sqrt(Gi(a,p));s+=(g+(Math.sqrt(Gi(a,m))+Math.sqrt(Gi(m,y))+Math.sqrt(Gi(y,p))))/2,c+=g,a=p}if(s-c<r)return s}return s}function xoe(t,e,r){const[i,s]=t,[n,o]=e,[a,l]=r,[c,d]=[n-i,o-s];let p=c*(a-i)+d*(l-s);p/=c**2+d**2,p=Qr(p,0,1);const m=ll([0,0],t,e,p);return{t:p,curvePoint:m,distance:Math.sqrt(Gi(m,r))}}let A8=class{constructor(e,r,i,s,n,o){this.cx=e,this.cy=r,this.radius=i,this.thetaStart=s,this.thetaEnd=n,this.isInvalid=o}get startPoint(){const{cx:e,cy:r,radius:i,thetaStart:s}=this;return[e+i*Math.cos(s),r+i*Math.sin(s)]}get endPoint(){const{cx:e,cy:r,radius:i,thetaEnd:s}=this;return[e+i*Math.cos(s),r+i*Math.sin(s)]}};function q1(t,e){const{cx:r,cy:i,radius:s}=t;return[r+s*Math.cos(e),i+s*Math.sin(e)]}function Z_(t,e){if(t.isInvalid)return ll([0,0],t.startPoint,t.endPoint,e);const{thetaStart:r,thetaEnd:i}=t;return q1(t,r*(1-e)+i*e)}function iFe(t,e){if(t.isInvalid)return xoe(t.startPoint,t.endPoint,e);const{cx:r,cy:i,thetaStart:s,thetaEnd:n}=t,[o,a]=e,l=woe(b2(s,n),Math.atan2(a-i,o-r)),c=q1(t,l);return{t:(l-s)/(n-s),curvePoint:c,distance:Math.sqrt(Gi(e,c))}}function pO(t,e){if(e.isInvalid)return Kr(t,e.startPoint),Kr(t,e.endPoint),t;const{cx:r,cy:i,radius:s,thetaStart:n,thetaEnd:o}=e;Kr(t,q1(e,n)),Kr(t,q1(e,o));const a=b2(n,o),l=Math.PI/2;let c=0;for(const d of[[r+s,i],[r,i+s],[r-s,i],[r,i-s]])c=Nv(a,c),c>a.min&&c<a.max&&Kr(t,d),c+=l;return t}function sFe(t){if(t.isInvalid)return 2*t.radius;const{radius:e,thetaStart:r,thetaEnd:i}=t;return e*Math.abs(i-r)}function $oe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Moe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function xf(t,e,r,i,s,n,o,a,l,c){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=n,t[5]=o,t[6]=a,t[7]=l,t[8]=c,t}function R8(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function O8(t,e){if(t===e){const r=e[1],i=e[2],s=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=i,t[7]=s}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function F8(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],p=d*o-a*c,m=-d*n+a*l,y=c*n-o*l;let g=r*p+i*m+s*y;return g?(g=1/g,t[0]=p*g,t[1]=(-d*i+s*c)*g,t[2]=(a*i-s*o)*g,t[3]=m*g,t[4]=(d*r-s*l)*g,t[5]=(-a*r+s*n)*g,t[6]=y*g,t[7]=(-c*r+i*l)*g,t[8]=(o*r-i*n)*g,t):null}function Toe(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8];return t[0]=o*d-a*c,t[1]=s*c-i*d,t[2]=i*a-s*o,t[3]=a*l-n*d,t[4]=r*d-s*l,t[5]=s*n-r*a,t[6]=n*c-o*l,t[7]=i*l-r*c,t[8]=r*o-i*n,t}function J_(t){const e=t[0],r=t[1],i=t[2],s=t[3],n=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*(c*n-o*l)+r*(-c*s+o*a)+i*(l*s-n*a)}function G0(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],c=e[6],d=e[7],p=e[8],m=r[0],y=r[1],g=r[2],v=r[3],w=r[4],_=r[5],x=r[6],$=r[7],T=r[8];return t[0]=m*i+y*o+g*c,t[1]=m*s+y*a+g*d,t[2]=m*n+y*l+g*p,t[3]=v*i+w*o+_*c,t[4]=v*s+w*a+_*d,t[5]=v*n+w*l+_*p,t[6]=x*i+$*o+T*c,t[7]=x*s+$*a+T*d,t[8]=x*n+$*l+T*p,t}function PT(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],c=e[6],d=e[7],p=e[8],m=r[0],y=r[1];return t[0]=i,t[1]=s,t[2]=n,t[3]=o,t[4]=a,t[5]=l,t[6]=m*i+y*o+c,t[7]=m*s+y*a+d,t[8]=m*n+y*l+p,t}function N8(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],c=e[6],d=e[7],p=e[8],m=Math.sin(r),y=Math.cos(r);return t[0]=y*i+m*o,t[1]=y*s+m*a,t[2]=y*n+m*l,t[3]=y*o-m*i,t[4]=y*a-m*s,t[5]=y*l-m*n,t[6]=c,t[7]=d,t[8]=p,t}function Ioe(t,e,r){const i=r[0],s=r[1],n=r[2];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=n*e[6],t[7]=n*e[7],t[8]=n*e[8],t}function Eoe(t,e,r){const i=r[0],s=r[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t}function Coe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Poe(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=-r,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function koe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Loe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Aoe(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=r+r,a=i+i,l=s+s,c=r*o,d=i*o,p=i*a,m=s*o,y=s*a,g=s*l,v=n*o,w=n*a,_=n*l;return t[0]=1-p-g,t[3]=d-_,t[6]=m+w,t[1]=d+_,t[4]=1-c-g,t[7]=y-v,t[2]=m-w,t[5]=y+v,t[8]=1-c-p,t}function Roe(t,e){const r=e[0],i=e[1],s=e[2],n=e[4],o=e[5],a=e[6],l=e[8],c=e[9],d=e[10],p=d*o-a*c,m=-d*n+a*l,y=c*n-o*l,g=r*p+i*m+s*y;if(!g)return null;const v=1/g;return t[0]=p*v,t[1]=(-d*i+s*c)*v,t[2]=(a*i-s*o)*v,t[3]=m*v,t[4]=(d*r-s*l)*v,t[5]=(-a*r+s*n)*v,t[6]=y*v,t[7]=(-c*r+i*l)*v,t[8]=(o*r-i*n)*v,t}function Ooe(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],p=e[9],m=e[10],y=e[11],g=e[12],v=e[13],w=e[14],_=e[15],x=r*a-i*o,$=r*l-s*o,T=r*c-n*o,C=i*l-s*a,P=i*c-n*a,A=s*c-n*l,F=d*v-p*g,j=d*w-m*g,V=d*_-y*g,Z=p*w-m*v,Y=p*_-y*v,re=m*_-y*w;let Q=x*re-$*Y+T*Z+C*V-P*j+A*F;return Q?(Q=1/Q,t[0]=(a*re-l*Y+c*Z)*Q,t[1]=(l*V-o*re-c*j)*Q,t[2]=(o*Y-a*V+c*F)*Q,t[3]=(s*Y-i*re-n*Z)*Q,t[4]=(r*re-s*V+n*j)*Q,t[5]=(i*V-r*Y-n*F)*Q,t[6]=(v*A-w*P+_*C)*Q,t[7]=(w*T-g*A-_*$)*Q,t[8]=(g*P-v*T+_*x)*Q,t):null}function Foe(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Noe(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Doe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function zoe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function D8(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function joe(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function Voe(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t}function Uoe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Goe(t,e){const r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=t[6],c=t[7],d=t[8],p=e[0],m=e[1],y=e[2],g=e[3],v=e[4],w=e[5],_=e[6],x=e[7],$=e[8],T=Bi();return Math.abs(r-p)<=T*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(i-m)<=T*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-y)<=T*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(n-g)<=T*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(o-v)<=T*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(a-w)<=T*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(l-_)<=T*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(c-x)<=T*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(d-$)<=T*Math.max(1,Math.abs(d),Math.abs($))}function qoe(t){const e=Bi(),r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=t[6],c=t[7],d=t[8];return Math.abs(1-(r*r+n*n+l*l))<=e&&Math.abs(1-(i*i+o*o+c*c))<=e&&Math.abs(1-(s*s+a*a+d*d))<=e}const Boe=G0,Hoe=D8;Object.freeze(Object.defineProperty({__proto__:null,add:zoe,adjoint:Toe,copy:Moe,determinant:J_,equals:Goe,exactEquals:Uoe,frob:Doe,fromMat2d:Loe,fromMat4:$oe,fromQuat:Aoe,fromRotation:Poe,fromScaling:koe,fromTranslation:Coe,identity:R8,invert:F8,isOrthoNormal:qoe,mul:Boe,multiply:G0,multiplyScalar:joe,multiplyScalarAndAdd:Voe,normalFromMat4:Ooe,normalFromMat4Legacy:Roe,projection:Foe,rotate:N8,scale:Ioe,scaleByVec2:Eoe,set:xf,str:Noe,sub:Hoe,subtract:D8,translate:PT,transpose:O8},Symbol.toStringTag,{value:"Module"}));function _d(){return[1,0,0,0,1,0,0,0,1]}function Woe(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function Zoe(t,e,r,i,s,n,o,a,l){return[t,e,r,i,s,n,o,a,l]}const Joe=_d();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:Joe,clone:Woe,create:_d,fromValues:Zoe},Symbol.toStringTag,{value:"Module"}));const Fd=_d();function Yoe(t,e,r){const[i,s]=t,[n,o]=e,[a,l]=r;xf(Fd,i,n,a,s,o,l,1,1,1);const c=J_(Fd),d=4*c/(Gi(t,e)+Gi(e,r)+Gi(r,t));if(!isFinite(d)||Math.abs(d)<1e-8)return null;const p=i**2+s**2,m=n**2+o**2,y=a**2+l**2;xf(Fd,p,m,y,s,o,l,1,1,1);const g=J_(Fd);return xf(Fd,p,m,y,i,n,a,1,1,1),[g/c*.5,J_(Fd)/c*-.5]}function z8(t,e){const[r,i]=e.c,s=Yoe(t,i,r),n=s==null,o=s??ll([],t,r,.5),[a,l]=t,[c,d]=i,[p,m]=r,[y,g]=o,v=a-y,w=l-g,_=Math.sqrt(v*v+w*w),x=Gh(l-g,a-y),$=Gh(d-g,c-y);let T=Gh(m-g,p-y);return($-x)*(T-$)<0&&(T+=2*Math.sign(x-T)*Math.PI),new A8(y,g,_,x,T,n)}function nFe(t,e,r){const i=Z_(t,r/2),s=Z_(t,r),n=Z_(t,(r+1)/2);return[{c:[s,i]},{c:[[...e.c[0]],n]}]}function oFe(t,e){const[r]=e.c,{cx:i,cy:s,thetaStart:n,thetaEnd:o,radius:a,isInvalid:l}=z8(t,e);return{a:[r,[i,s],Math.abs(o-n)<Math.PI?1:0,n>o?1:0,l?n:0,a,l?0:1]}}function aFe(t){return"curveRings"in t&&!!t.curveRings?.length||"curvePaths"in t&&!!t.curvePaths?.length}function lFe(t){return"curveRings"in t?t.curveRings:t.curvePaths}function WP(t){return"b"in t}function ZP(t){return"c"in t}function S2(t){return Array.isArray(t)}function uFe(t){return"a"in t}function j8(t){return"a"in t&&t.a.length===4}function Xoe(t){return"a"in t&&t.a.length===7}function Zx(t){return S2(t)?t:WP(t)?t.b[0]:ZP(t)?t.c[0]:t.a[0]}function Koe(t){if(WP(t)){const[e,r,i]=t.b;return{b:[[...e],[...r],[...i]]}}if(ZP(t)){const[e,r]=t.c;return{c:[[...e],[...r]]}}if(S2(t))return[...t];if(j8(t)){const[e,r,i,s]=t.a;return{a:[[...e],[...r],i,s]}}if(Xoe(t)){const[e,r,i,s,n,o,a]=t.a;return{a:[[...e],[...r],i,s,n,o,a]}}return t}function Qoe(t,e){const[r,i,s,n]=e.a,[o,a]=t,[l,c]=r,[d,p]=i,m=o-d,y=a-p,g=Math.sqrt(m*m+y*y),v=l-d,w=c-p,_=Math.sqrt(v*v+w*w),x=g===0||_===0||!s8(g,_),$=g,[T,C]=P8(Gh(a-p,o-d),Math.atan2(c-p,l-d),s,n);return new A8(d,p,$,T,C,x)}function cFe(t,e,r){const{cx:i,cy:s,thetaStart:n,thetaEnd:o}=t,[a,l,c,d]=e.a,p=n*(1-r)+o*r;return[{a:[Z_(t,r),[i,s],Math.abs(p-n)<Math.PI?1:0,d]},{a:[[...a],[i,s],Math.abs(o-p)<Math.PI?1:0,d]}]}let eae=class{constructor(e,r,i,s,n,o,a,l,c){this.cx=e,this.cy=r,this.a=i,this.b=s,this.cosR=n,this.sinR=o,this.u1=a,this.u2=l,this.isInvalid=c}};function JP(t,e){const[r,i,s,n,o,a,l]=e.a,[c,d]=t,[p,m]=r,[y,g]=i,v=a*l,w=Math.cos(o),_=Math.sin(o),[x,$]=P8(Gh(1/v*(d-g)*w-1/v*(c-y)*_,1/a*(d-g)*_+1/a*(c-y)*w),Math.atan2(1/v*(m-g)*w-1/v*(p-y)*_,1/a*(m-g)*_+1/a*(p-y)*w),s,n);return new eae(y,g,a,v,w,_,x,$,a===0||v===0)}function q0(t,e){const{a:r,b:i,cosR:s,sinR:n,cx:o,cy:a}=t,l=Math.cos(e),c=Math.sin(e);return[r*l*s-i*c*n+o,r*l*n+i*c*s+a]}function lp(t,e){const{u1:r,u2:i}=t;return q0(t,r*(1-e)+i*e)}function dFe(t,e,r){if(r<0||r>1)return[];if(r===0||r===1)return[Koe(e)];const[i,[s,n],o,a,l,c,d]=e.a,{u1:p,u2:m}=t,y=p*(1-r)+m*r;return[{a:[[...lp(t,r)],[s,n],Math.abs(y-p)<Math.PI?1:0,a,l,c,d]},{a:[[...i],[s,n],Math.abs(m-y)<Math.PI?1:0,a,l,c,d]}]}function pFe(t,e){const{a:r,b:i,cosR:s,sinR:n,u1:o,u2:a}=t,l=Math.PI/6,c=k8(e,[1*l,2*l,4*l,5*l,7*l,8*l,10*l,11*l],v=>{const w=Math.cos(v),_=Math.sin(v),[x,$]=q0(t,v);return[x,$,-r*s*_-i*n*w,-r*n*_+i*s*w,-r*s*w+i*n*_,-r*n*w-i*s*_]}),d=b2(o,a),p=new Set(c.map(v=>Nv(d,v)).filter(v=>v>d.min&&v<d.max));p.add(o),p.add(a);let m,y,g=1/0;for(const v of p){const w=q0(t,v),[_,x]=w,$=e[0]-_,T=e[1]-x,C=$*$+T*T;C<g&&(m=(v-o)/(a-o),y=w,g=C)}return{t:m,curvePoint:y,distance:Math.sqrt(g)}}function tae(t,e,r){const i=JP(e,r),{a:s,b:n,u1:o,u2:a,cosR:l,sinR:c,isInvalid:d}=i,p=r.a[0];if(Kr(t,e),Kr(t,p),d)return t;const m=Math.atan2(-n*c,s*l),y=m+Math.PI,g=Math.atan2(n*l,s*c),v=g+Math.PI,w=b2(o,a);for(const _ of[m,y,g,v].map(x=>Nv(w,x)))_>w.min&&_<w.max&&Kr(t,q0(i,_));return t}function fFe(t,e,r){const[i,s,n,o,a,l,c]=e.a,d=JP(t,e),{u1:p,u2:m,isInvalid:y}=d,g=m-p;if(y)return Math.sqrt(Gi(t,i));const v=14,w=[0,0];let _=0,x=[lp(d,0),lp(d,.25),lp(d,.5),lp(d,.75),lp(d,1)];for(let $=0;$<v;$++){const T=x.length-1,C=g/(2*T),P=[];for(let F=0;F<T;F++)P.push(x[F]),P.push(q0(d,p+(2*F+1)*C));P.push(x[x.length-1]),x=P,_=0;let A=0;for(let F=1;F<x.length;F++){const j=x[F-1],V=x[F];if(_+=Math.sqrt(Gi(j,V)),F>1){const Z=x[F-2],Y=voe(w,Z,j,s,V);A+=Y?Math.sqrt(Gi(j,Y)):Math.abs(V[0]-j[0])+Math.abs(V[1]-j[1])}else A+=_}if(A-_<r)return _}return _}const fO=_d(),_w=_d(),mO=_d(),Xl=_d();function mFe(t,e,r){const[i,s,n,o,a,l,c]=e.a,d=JP(t,e),{cosR:p,sinR:m,a:y,b:g,cx:v,cy:w}=d,_=W_([0,0],i,r),x=W_([0,0],s,r),$=r[0]*r[4]<0?1-o:o;{const T=y*y*m*m+g*g*p*p,C=2*(g*g-y*y)*m*p,P=y*y*p*p+g*g*m*m,A=-2*T*v-C*w,F=-C*v-2*P*w;xf(fO,T,C/2,A/2,C/2,P,F/2,A/2,F/2,T*v*v+C*v*w+P*w*w-y*y*g*g)}if(F8(_w,r),_w==null){const T=W_([0,0],t,r);return{a:[_,x,n,o,Gh(_[1],_[0]),Math.sqrt(Gi(_,T))/2,0]}}O8(mO,_w),G0(Xl,G0(Xl,mO,fO),_w);{const T=Xl[0],C=2*Xl[1],P=Xl[4],A=2*Xl[2],F=2*Xl[5],j=C*C-4*T*P,V=2*(T*F*F+P*A*A-C*A*F+j*Xl[8]),Z=Math.sqrt((T-P)**2+C*C),Y=-Math.sqrt(V*(T+P+Z))/j,re=-Math.sqrt(V*(T+P-Z))/j;return{a:[_,x,n,$,.5*Gh(-C,P-T),Y,re/Y]}}}function rae(t,e,r){if(S2(r))return Kr(t,e),Kr(t,r),t;if(WP(r))return Soe(t,e,r);if(ZP(r)){const i=z8(e,r);return pO(t,i)}if(j8(r)){const i=Qoe(e,r);return pO(t,i)}return tae(t,e,r)}function V8(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function U8(t){return t.points!==void 0}function G8(t){return t.x!==void 0&&t.y!==void 0}function q8(t){return t.paths!==void 0}function B8(t){return t.rings!==void 0}function H8(t){function e(r,i){return r==null?i:i==null?r:t(r,i)}return e}const Nu=H8(Math.min),Du=H8(Math.max);function YP(t,e){return q8(e)?vm(t,e.curvePaths??e.paths,!1,!1)??t:B8(e)?vm(t,e.curveRings??e.rings,!1,!1)??t:U8(e)?XP(t,e.points,!1,!1,!1,!1):V8(e)?Z8(t,e):(G8(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function Dv(t){let e,r,i,s;for(t.reset(),e=i=1/0,r=s=-1/0;t.nextPath();){const n=W8(t);e=Math.min(n[0],e),i=Math.min(n[1],i),r=Math.max(n[2],r),s=Math.max(n[3],s)}return lr([e,i,r,s])}function W8(t){let e,r,i,s;for(e=i=1/0,r=s=-1/0;t.nextPoint();)e=Math.min(t.x,e),i=Math.min(t.y,i),r=Math.max(t.x,r),s=Math.max(t.y,s);return lr([e,i,r,s])}function yFe(t,e){return q8(e)?vm(t,e.curvePaths??e.paths,!0,!1)??t:B8(e)?vm(t,e.curveRings??e.rings,!0,!1)??t:U8(e)?XP(t,e.points,!0,!1,!0,!1):V8(e)?Z8(t,e,!0,!1,!0,!1):(G8(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function vm(t,e,r,i){const s=r?3:2;if(!e.length||!e[0].length)return null;let n,o,a,l,[c,d]=Zx(e[0][0]),p=c,m=d;for(let y=0;y<e.length;y++){const g=e[y];for(let v=0;v<g.length;v++){const w=Zx(g[v]),[_,x]=w;if(c=Nu(c,_),d=Nu(d,x),p=Du(p,_),m=Du(m,x),r&&w.length>2){const P=w[2];n=Nu(n,P),o=Du(o,P)}if(i&&w.length>s){const P=w[s];a=Nu(n,P),l=Du(o,P)}const $=g[v];if(S2($)||v<1)continue;const T=Zx(g[v-1]),C=b8(c,d,p,m);[c,d,p,m]=rae(C,T,$)}}return r?i?(t[0]=c,t[1]=d,t[2]=n,t[3]=a,t[4]=p,t[5]=m,t[6]=o,t[7]=l,t.length=8,t):(t[0]=c,t[1]=d,t[2]=n,t[3]=p,t[4]=m,t[5]=o,t.length=6,t):i?(t[0]=c,t[1]=d,t[2]=a,t[3]=p,t[4]=m,t[5]=l,t.length=6,t):(t[0]=c,t[1]=d,t[2]=p,t[3]=m,t.length=4,t)}function Z8(t,e,r,i,s,n){const o=e.xmin,a=e.xmax,l=e.ymin,c=e.ymax;let d=e.zmin,p=e.zmax,m=e.mmin,y=e.mmax;return s?(d=d||0,p=p||0,n?(m=m||0,y=y||0,t[0]=o,t[1]=l,t[2]=d,t[3]=m,t[4]=a,t[5]=c,t[6]=p,t[7]=y,t):(t[0]=o,t[1]=l,t[2]=d,t[3]=a,t[4]=c,t[5]=p,t)):n?(m=m||0,y=y||0,t[0]=o,t[1]=l,t[2]=m,t[3]=a,t[4]=c,t[5]=y,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=c,t)}function XP(t,e,r,i,s,n){const o=r?3:2,a=i&&n,l=r&&s;if(!e.length||!e[0].length)return null;let c,d,p,m,[y,g]=e[0],[v,w]=e[0];for(let _=0;_<e.length;_++){const x=e[_],[$,T]=x;if(y=Nu(y,$),g=Nu(g,T),v=Du(v,$),w=Du(w,T),l&&x.length>2){const C=x[2];c=Nu(c,C),d=Du(d,C)}if(a&&x.length>o){const C=x[o];p=Nu(c,C),m=Du(d,C)}}return s?(c=c||0,d=d||0,n?(p=p||0,m=m||0,t[0]=y,t[1]=g,t[2]=c,t[3]=p,t[4]=v,t[5]=w,t[6]=d,t[7]=m,t):(t[0]=y,t[1]=g,t[2]=c,t[3]=v,t[4]=w,t[5]=d,t)):n?(p=p||0,m=m||0,t[0]=y,t[1]=g,t[2]=p,t[3]=v,t[4]=w,t[5]=m,t):(t[0]=y,t[1]=g,t[2]=v,t[3]=w,t)}function iae(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function sae(t){return t.points!==void 0}function nae(t){return t.x!==void 0&&t.y!==void 0}function oae(t){return t.paths!==void 0}function aae(t){return t.rings!==void 0}const KP=[];function J8(t,e,r,i){return{xmin:t,ymin:e,xmax:r,ymax:i}}function Y8(t,e,r,i,s,n){return{xmin:t,ymin:e,zmin:r,xmax:i,ymax:s,zmax:n}}function X8(t,e,r,i,s,n){return{xmin:t,ymin:e,mmin:r,xmax:i,ymax:s,mmax:n}}function K8(t,e,r,i,s,n,o,a){return{xmin:t,ymin:e,zmin:r,mmin:i,xmax:s,ymax:n,zmax:o,mmax:a}}function QP(t,e=!1,r=!1){return e?r?K8(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):Y8(t[0],t[1],t[2],t[3],t[4],t[5]):r?X8(t[0],t[1],t[2],t[3],t[4],t[5]):J8(t[0],t[1],t[2],t[3])}function gFe(t){return t?iae(t)?t:nae(t)?lae(t):aae(t)?e9(t):oae(t)?t9(t):sae(t)?Q8(t):null:null}function Q8(t){const{hasZ:e,hasM:r,points:i}=t,s=XP(KP,i,e??!1,r??!1,e??!1,r??!1);return s?QP(s,e,r):null}function lae(t){const{x:e,y:r,z:i,m:s}=t,n=s!=null;return i!=null?n?K8(e,r,i,s,e,r,i,s):Y8(e,r,i,e,r,i):n?X8(e,r,s,e,r,s):J8(e,r,e,r)}function e9(t){const{hasZ:e,hasM:r,rings:i,curveRings:s}=t,n=vm(KP,s??i,e??!1,r??!1);return n?QP(n,e,r):null}function t9(t){const{hasZ:e,hasM:r,paths:i,curvePaths:s}=t,n=vm(KP,s??i,e??!1,r??!1);return n?QP(n,e,r):null}function wm(t,e,r=!1){let{hasM:i,hasZ:s}=t;Array.isArray(e)?e.length!==4||i||s?e.length===3&&r&&!i?(s=!0,i=!1):e.length===3&&i&&s&&(i=!1,s=!1):(i=!0,s=!0):(s=!s&&e.hasZ&&(!i||e.hasM),i=!i&&e.hasM&&(!s||e.hasZ)),t.hasZ=s,t.hasM=i}var Y_;function yO(t){return!Array.isArray(t[0])}function uae(t){return typeof t[0]?.[0]=="number"}function cae(t){if(!t)return;let{rings:e,hasM:r,hasZ:i,spatialReference:s}=t;switch(e??=[],uae(e)&&(e=[e]),e[0]?.[0]?.length){case 4:i??=!0,r??=!0;break;case 3:i??=r!==!0,r??=!i;break;default:i??=!1,r??=!1}return s??=ne.WGS84,{...t,hasM:r,hasZ:i,rings:e,spatialReference:s}}let dt=Y_=class extends Mr{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:r}=t;let i=!1,s=!1;for(const o of e)o.hasZ&&(i=!0),o.hasM&&(s=!0);const n={rings:e.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(i&&o.hasZ){const l=o.zmin+.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(l)}if(s&&o.hasM){const l=o.mmin+.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(l)}return a}),spatialReference:r};return i&&(n.hasZ=!0),s&&(n.hasM=!0),new Y_(n)}constructor(t){super(cae(t)),this.curveRings=void 0,this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("curveRings"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("rings"),this.commitProperty("spatialReference"),{}}get centroid(){FM(U.getLogger(this),"centroid",{replacement:"Please use centroidOperator.execute() instead.",version:"4.34",warnOnce:!0});const t=g8(this);return t?de.fromJSON(t):null}writeCurveRings(t,e){e.curveRings=O(t)}get extent(){const t=e9(this),{spatialReference:e}=this;return t?new Te({...t,spatialReference:e}):null}get isSelfIntersecting(){return FM(U.getLogger(this),"isSelfIntersecting",{replacement:"Please use simplifyOperator.isSimple() instead.",version:"4.33",warnOnce:!0}),Fte(this.rings)}writeRings(t,e){e.rings=O(this.rings)}addRing(t){if(!t)return;const e=this.rings,r=e.length;if(yO(t)){const i=[];for(let s=0,n=t.length;s<n;s++)i[s]=t[s].toArray();e[r]=i}else e[r]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new Y_;return t.spatialReference=this.spatialReference,t.rings=O(this.rings),t.curveRings=O(this.curveRings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,r=t.spatialReference;if(e!=null!=(r!=null)||e!=null&&r!=null&&!e.equals(r)||this.rings.length!==t.rings.length)return!1;const i=([s,n,o,a],[l,c,d,p])=>s===l&&n===c&&(o==null&&d==null||o===d)&&(a==null&&p==null||a===p);for(let s=0;s<this.rings.length;s++){const n=this.rings[s],o=t.rings[s];if(!DS(n,o,i))return!1}return!0}contains(t){if(!t)return!1;const e=i2(t,this.spatialReference);return bP(this,e??t)}isClockwise(t){const e=yO(t)?t.map(r=>this.hasZ?this.hasM?[r.x,r.y,r.z,r.m]:[r.x,r.y,r.z]:[r.x,r.y]):t;return f8(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const r=this.rings[t][e],i=this.hasZ,s=this.hasM;return i&&!s?new de(r[0],r[1],r[2],void 0,this.spatialReference):s&&!i?new de(r[0],r[1],void 0,r[2],this.spatialReference):i&&s?new de(r[0],r[1],r[2],r[3],this.spatialReference):new de(r[0],r[1],this.spatialReference)}insertPoint(t,e,r){return this._validateInputs(t,e,!0)?(wm(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[t].splice(e,0,r),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const r=new de(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),r}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],r=this.spatialReference,i=e.map(s=>new de(s,r));return this.notifyChange("rings"),i}setPoint(t,e,r){return this._validateInputs(t,e)?(wm(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[t][e]=r,this.notifyChange("rings"),this):this}_validateInputs(t,e,r=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const i=this.rings[t];if(r&&(e<0||e>i.length)||!r&&(e<0||e>=i.length))return!1}return!0}toJSON(t){return this.write({},t)}};u([h({readOnly:!0})],dt.prototype,"cache",null),u([h({readOnly:!0})],dt.prototype,"centroid",null),u([h({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],dt.prototype,"curveRings",void 0),u([te("curveRings")],dt.prototype,"writeCurveRings",null),u([h({readOnly:!0})],dt.prototype,"extent",null),u([h({readOnly:!0})],dt.prototype,"isSelfIntersecting",null),u([h({type:[[[Number]]],json:{write:{isRequired:!0}}})],dt.prototype,"rings",void 0),u([te("rings")],dt.prototype,"writeRings",null),dt=Y_=u([E("esri.geometry.Polygon")],dt),dt.prototype.toJSON.isDefaultToJSON=!0;function mc(){return[0,0,0]}function hae(t){return[t[0],t[1],t[2]]}function Km(t,e,r){return[t,e,r]}function dae(t,e,r){return[t,e,r]}function pae(t,e=mc()){const r=Math.min(3,t.length);for(let i=0;i<r;++i)e[i]=t[i];return e}function r9(){return mc()}function i9(){return Km(1,1,1)}function s9(){return Km(1,0,0)}function n9(){return Km(0,1,0)}function o9(){return Km(0,0,1)}const fae=r9(),a9=i9(),mae=s9(),yae=n9(),gae=o9();Object.freeze(Object.defineProperty({__proto__:null,ONES:a9,UNIT_X:mae,UNIT_Y:yae,UNIT_Z:gae,ZEROS:fae,clone:hae,create:mc,freeze:dae,fromArray:pae,fromValues:Km,ones:i9,unitX:s9,unitY:n9,unitZ:o9,zeros:r9},Symbol.toStringTag,{value:"Module"}));var kT;function vae(t){if(!t)return;let{points:e,hasM:r,hasZ:i,spatialReference:s}=t;switch(e??=[],e?.at(0)?.length){case 4:i??=!0,r??=!0;break;case 3:i??=r!==!0,r??=!i;break;default:i??=!1,r??=!1}return s??=ne.WGS84,{...t,hasM:r,hasZ:i,points:e,spatialReference:s}}let jn=kT=class extends Mr{constructor(t){super(vae(t)),this.points=[],this.type="multipoint"}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=Q8(this);return t?new Te({...t,spatialReference:this.spatialReference}):null}writePoints(t,e){e.points=O(this.points)}clone(){const{points:t,spatialReference:e,hasM:r,hasZ:i}=this;return new kT({points:O(t),spatialReference:e.clone(),hasM:r,hasZ:i})}addPoint(t){return wm(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],r={x:e[0],y:e[1],spatialReference:this.spatialReference};let i=2;return this.hasZ&&(r.z=e[2],i=3),this.hasM&&(r.m=e[i]),new de(r)}removePoint(t){if(!this._validateInputs(t))return null;const e=new de(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(wm(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};u([h({readOnly:!0})],jn.prototype,"cache",null),u([h({readOnly:!0})],jn.prototype,"extent",null),u([h({type:[[Number]],json:{write:{isRequired:!0}}})],jn.prototype,"points",void 0),u([te("points")],jn.prototype,"writePoints",null),jn=kT=u([E("esri.geometry.Multipoint")],jn),jn.prototype.toJSON.isDefaultToJSON=!0;var LT;function wae(t){return!Array.isArray(t[0])}function _ae(t){return typeof t[0]?.[0]=="number"}function bae(t){if(!t)return;let{paths:e,hasM:r,hasZ:i,spatialReference:s}=t;switch(e??=[],_ae(e)&&(e=[e]),e[0]?.[0]?.length){case 4:i??=!0,r??=!0;break;case 3:i??=r!==!0,r??=!i;break;default:i??=!1,r??=!1}return s??=ne.WGS84,{...t,hasM:r,hasZ:i,paths:e,spatialReference:s}}let pr=LT=class extends Mr{constructor(t){super(bae(t)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(t,e){e.curvePaths=O(t)}get extent(){const t=t9(this),{spatialReference:e}=this;return t?new Te({...t,spatialReference:e}):null}writePaths(t,e){e.paths=O(this.paths)}addPath(t){if(!t)return;const e=this.paths,r=e.length;if(wae(t)){const i=[];for(let s=0,n=t.length;s<n;s++)i[s]=t[s].toArray();e[r]=i}else e[r]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new LT;return t.spatialReference=this.spatialReference,t.paths=O(this.paths),t.curvePaths=O(this.curvePaths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const r=this.paths[t][e],i=this.hasZ,s=this.hasM;return i&&!s?new de(r[0],r[1],r[2],void 0,this.spatialReference):s&&!i?new de(r[0],r[1],void 0,r[2],this.spatialReference):i&&s?new de(r[0],r[1],r[2],r[3],this.spatialReference):new de(r[0],r[1],this.spatialReference)}insertPoint(t,e,r){return this._validateInputs(t,e,!0)?(wm(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t].splice(e,0,r),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],r=this.spatialReference,i=e.map(s=>new de(s,r));return this.notifyChange("paths"),i}removePoint(t,e){if(!this._validateInputs(t,e))return null;const r=new de(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),r}setPoint(t,e,r){return this._validateInputs(t,e)?(wm(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t][e]=r,this.notifyChange("paths"),this):this}_validateInputs(t,e,r=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const i=this.paths[t];if(r&&(e<0||e>i.length)||!r&&(e<0||e>=i.length))return!1}return!0}toJSON(t){return this.write({},t)}};u([h({readOnly:!0})],pr.prototype,"cache",null),u([h({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],pr.prototype,"curvePaths",void 0),u([te("curvePaths")],pr.prototype,"writeCurvePaths",null),u([h({readOnly:!0})],pr.prototype,"extent",null),u([h({type:[[[Number]]],json:{write:{isRequired:!0}}})],pr.prototype,"paths",void 0),u([te("paths")],pr.prototype,"writePaths",null),pr=LT=u([E("esri.geometry.Polyline")],pr),pr.prototype.toJSON.isDefaultToJSON=!0;var AT;let up=AT=class extends le{constructor(t){super(t),this.isInverse=!1,this.wkt=null,this.wkid=null}getInverse(){return new AT({isInverse:!this.isInverse,wkid:this.wkid,wkt:this.wkt})}};u([h()],up.prototype,"isInverse",void 0),u([h()],up.prototype,"wkt",void 0),u([h()],up.prototype,"wkid",void 0),up=AT=u([E("esri.geometry.operators.support.GeographicTransformationStep")],up);var RT;let r0=RT=class extends le{constructor(t){super(t),this.steps=[]}getInverse(){const t=new RT;for(let e=this.steps.length-1;e>=0;e--){const r=this.steps[e];t.steps.push(r.getInverse())}return t}};u([h({type:[up],nonNullable:!0})],r0.prototype,"steps",void 0),r0=RT=u([E("esri.geometry.operators.support.GeographicTransformation")],r0);const vFe=Math.PI/180,wFe=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,Kl=Vt.radius,Mn=Vt.eccentricitySquared,Sae={a1:Kl*Mn,a2:Kl*Mn*Kl*Mn,a3:Kl*Mn*Mn/2,a4:Kl*Mn*Kl*Mn*2.5,a5:Kl*Mn+Kl*Mn*Mn/2,a6:1-Mn},_Fe={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:Vt.radius,f:Vt.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:tc.radius,f:tc.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:ua.radius,f:ua.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:ua.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}},xae={2:{5:Tt,7:null,9:null,10:Tt,1:s0,6:null,8:null,0:null,3:$f,11:Mf,2:Tt,4:Ef},5:{5:Tt,7:null,9:null,10:Tt,1:s0,6:null,8:null,0:null,3:$f,11:Mf,2:Tt,4:Ef},7:{5:null,7:Tt,9:null,10:Tt,1:null,6:wO,8:null,0:null,3:null,11:null,2:null,4:null},9:{5:null,7:null,9:Tt,10:Tt,1:null,6:null,8:vO,0:null,3:null,11:null,2:null,4:null},3:{5:i0,7:null,9:null,10:i0,1:Mae,6:null,8:null,0:null,3:Tt,11:Eae,2:i0,4:Tae},4:{5:Cf,7:null,9:null,10:Cf,1:Nae,6:null,8:null,0:null,3:Dae,11:Cae,2:Cf,4:Tt},1:{5:If,7:null,9:null,10:If,1:Tt,6:null,8:null,0:null,3:Rae,11:Pae,2:If,4:Oae},6:{5:null,7:bO,9:null,10:bO,1:null,6:Tt,8:null,0:null,3:null,11:null,2:null,4:null},8:{5:null,7:null,9:_O,10:_O,1:null,6:null,8:Tt,0:null,3:null,11:null,2:null,4:null},0:{5:null,7:null,9:null,10:null,1:null,6:null,8:null,0:Tt,3:null,11:null,2:null,4:null},10:{5:Tt,7:Tt,9:Tt,10:Tt,1:s0,6:wO,8:vO,0:null,3:$f,11:Mf,2:Tt,4:Ef},11:{5:Tf,7:null,9:null,10:Tf,1:kae,6:null,8:null,0:null,3:Lae,11:Tt,2:Tf,4:Aae}};function l9(t,e){return $ae(t,e)?.projector}function $ae(t,e){if(t==null||e==null)return null;if($a.source.spatialReference===t&&$a.dest.spatialReference===e)return $a;const r=gO(t,$a.source),i=gO(e,$a.dest);return r===0&&i===0?Cr(t,e)?$a.projector=Tt:$a.projector=null:$a.projector=xae[r][i],$a}function gO(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=Vs(t,1)),k1(t)?e.spatialReferenceId=1:nd(t)?e.spatialReferenceId=2:ya(t)?e.spatialReferenceId=3:zee(t)?e.spatialReferenceId=11:t.wkt===Gee.wkt?e.spatialReferenceId=4:t.wkid===4490?e.spatialReferenceId=5:t.wkt===vP.wkt?e.spatialReferenceId=6:t.wkt===wP.wkt?e.spatialReferenceId=8:sj(t)?e.spatialReferenceId=7:nj(t)?e.spatialReferenceId=9:e.spatialReferenceId=0):0}function Tt(t,e,r,i){t!==r&&(r[i++]=t[e++],r[i++]=t[e++],r[i]=t[e])}function i0(t,e,r,i){r[i]=bm*(t[e]/qh),r[i+1]=bm*(u9-2*Math.atan(Math.exp(-t[e+1]/qh))),r[i+2]=t[e+2]}function Mae(t,e,r,i){const s=t[e]/qh,n=u9-2*Math.atan(Math.exp(-t[e+1]/qh)),o=qh+t[e+2],a=Math.cos(n)*o;r[i]=Math.cos(s)*a,r[i+1]=Math.sin(s)*a,r[i+2]=Math.sin(n)*o}function Tae(t,e,r,i){i0(t,e,r,i),Ef(r,i,r,i)}function Iae(t,e,r,i,s){const n=.4999999*Math.PI,o=Qr(_m*t[e+1],-n,n),a=Math.sin(o);r[i++]=_m*t[e]*s.radius,r[i++]=s.halfSemiMajorAxis*Math.log((1+a)/(1-a)),r[i]=t[e+2]}function $f(t,e,r,i){Iae(t,e,r,i,Vt)}function Mf(t,e,r,i){r[i]=t[e]*SO,r[i+1]=t[e+1]*SO,r[i+2]=t[e+2]}function Tf(t,e,r,i){r[i]=t[e]*xO,r[i+1]=t[e+1]*xO,r[i+2]=t[e+2]}function Eae(t,e,r,i){i0(t,e,r,i),Mf(r,i,r,i)}function Cae(t,e,r,i){Cf(t,e,r,i),Mf(r,i,r,i)}function Pae(t,e,r,i){If(t,e,r,i),Mf(r,i,r,i)}function kae(t,e,r,i){Tf(t,e,r,i),s0(r,i,r,i)}function Lae(t,e,r,i){Tf(t,e,r,i),$f(r,i,r,i)}function Aae(t,e,r,i){Tf(t,e,r,i),Ef(r,i,r,i)}function ek(t,e,r,i,s){const n=s+t[e+2],o=_m*t[e+1],a=_m*t[e],l=Math.cos(o)*n;r[i]=Math.cos(a)*l,r[i+1]=Math.sin(a)*l,r[i+2]=Math.sin(o)*n}function vO(t,e,r,i){ek(t,e,r,i,tc.radius)}function wO(t,e,r,i){ek(t,e,r,i,ua.radius)}function s0(t,e,r,i){ek(t,e,r,i,Vt.radius)}function tk(t,e,r,i,s){const n=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(n*n+o*o+a*a),c=Yse(a/(l===0?1:l)),d=Math.atan2(o,n);r[i++]=bm*d,r[i++]=bm*c,r[i]=l-s}function _O(t,e,r,i){tk(t,e,r,i,tc.radius)}function bO(t,e,r,i){tk(t,e,r,i,ua.radius)}function If(t,e,r,i){tk(t,e,r,i,Vt.radius)}function Rae(t,e,r,i){If(t,e,r,i),$f(r,i,r,i)}function Oae(t,e,r,i){If(t,e,r,i),Ef(r,i,r,i)}function Fae(t,e,r,i,s){const n=_m*t[e],o=_m*t[e+1],a=t[e+2],l=Math.sin(o),c=Math.cos(o),d=s.radius/Math.sqrt(1-s.eccentricitySquared*l*l);r[i++]=(d+a)*c*Math.cos(n),r[i++]=(d+a)*c*Math.sin(n),r[i++]=(d*(1-s.eccentricitySquared)+a)*l}function Ef(t,e,r,i){Fae(t,e,r,i,Vt)}function Cf(t,e,r,i){const s=Sae,n=t[e],o=t[e+1],a=t[e+2];let l,c,d,p,m,y,g,v,w,_,x,$,T,C,P,A,F,j,V,Z,Y;l=Math.abs(a),c=n*n+o*o,d=Math.sqrt(c),p=c+a*a,m=Math.sqrt(p),Z=Math.atan2(o,n),y=a*a/p,g=c/p,C=s.a2/m,P=s.a3-s.a4/m,g>.3?(v=l/m*(1+g*(s.a1+C+y*P)/m),V=Math.asin(v),_=v*v,w=Math.sqrt(1-_)):(w=d/m*(1-y*(s.a5-C-g*P)/m),V=Math.acos(w),_=1-w*w,v=Math.sqrt(_)),x=1-Vt.eccentricitySquared*_,$=Vt.radius/Math.sqrt(x),T=s.a6*$,C=d-$*w,P=l-T*v,F=w*C+v*P,A=w*P-v*C,j=A/(T/x+F),V+=j,Y=F+A*j/2,a<0&&(V=-V),r[i++]=bm*Z,r[i++]=bm*V,r[i]=Y}function Nae(t,e,r,i){Cf(t,e,r,i),s0(r,i,r,i)}function Dae(t,e,r,i){Cf(t,e,r,i),$f(r,i,r,i)}const $a={source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:Tt},_m=Ym(1),bm=t8(1),u9=.5*Math.PI,qh=Vt.radius,SO=qh*Math.PI/180,xO=180/(qh*Math.PI);function zv(t,e,r,i,s,n,o=Math.floor(t.length/3)){const a=l9(e,s);if(a==null)return!1;if(a===Tt){if(t===i&&r===n)return!0;const c=r+3*o;for(let d=r,p=n;d<c;d++,p++)i[p]=t[d];return!0}const l=r+3*o;for(let c=r,d=n;c<l;c+=3,d+=3)a(t,c,i,d);return!0}const bFe=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:zv},Symbol.toStringTag,{value:"Module"}));function $O(t,e,r,i,s,n){return bw[0]=t,bw[1]=e,bw[2]=r,zv(bw,i,0,s,n,0)}const bw=mc();function c9(t,e,r){if(e==null||r==null||r.vcsWkid||Cr(e,r)||ic(e)||ic(r))return null;const i=L1(e)/L1(r);if(i===1)return null;switch(t){case"point":case"esriGeometryPoint":return s=>zae(s,i);case"polyline":case"esriGeometryPolyline":return s=>Vae(s,i);case"polygon":case"esriGeometryPolygon":return s=>jae(s,i);case"multipoint":case"esriGeometryMultipoint":return s=>Uae(s,i);case"extent":case"esriGeometryEnvelope":return s=>Gae(s,i);default:return null}}function zae(t,e){t?.z!=null&&(t.z*=e)}function jae(t,e){if(t)for(const r of t.rings)for(const i of r)i.length>2&&(i[2]*=e)}function Vae(t,e){if(t)for(const r of t.paths)for(const i of r)i.length>2&&(i[2]*=e)}function Uae(t,e){if(t)for(const r of t.points)r.length>2&&(r[2]*=e)}function Gae(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}let n0=null,B0=null,H0=null,Sm=null,OT={};const rk=new Ev;function Rl(){return!!(B0?.isLoaded()&&H0?.isLoaded()&&Sm?.isLoaded())}function h9(){return!!Rl()||(_e(rk),oc(),!1)}function d9(t,e){return!t||!e||io(t,e)||h9()}function qae(t,e){return!io(t,e)&&!Rl()}async function oc(t){n0==null&&(n0=Promise.all([q(()=>import("./projectOperator-BuZcAX0A.js"),__vite__mapDeps([14,15,16])).then(e=>(B0=e,B0.load())),q(()=>import("./projectOperator-DdP0tmpb.js"),__vite__mapDeps([17,15,16])).then(e=>(H0=e,H0.load())),q(()=>import("./geographicTransformationUtils-ynnXAFsM.js"),[]).then(e=>(Sm=e,Sm.load()))])),await n0,gt(t),rk.notify()}function yc(t,e,r){return Array.isArray(t)?t.length===0?[]:(_te(t),FT(t,t[0].spatialReference,e,r)):(mm(t),FT([t],t.spatialReference,e,r)[0])}function FT(t,e,r,i){if(e==null||r==null)return t;if(io(e,r,i))return t.map(s=>X_(s,e,r));if(i?.geographicTransformation==null&&k1(e))return t.map(s=>X_(s,e,ne.WGS84)).map(s=>W0(s,r));if(i?.geographicTransformation==null&&k1(r))return t.map(s=>W0(s,ne.WGS84)).map(s=>X_(s,ne.WGS84,r));if(!Rl())throw new f9;if(!i?.geographicTransformation){if(i?.extendedParams)i={...i,geographicTransformation:Sm.getTransformation(e,r,i.areaOfInterestExtent)||new r0};else if(!i?.areaOfInterestExtent){const s=Bae(e,r);let n=OT[s];n||(n=Sm.getTransformation(e,r)||new r0,OT[s]=n),i={geographicTransformation:n}}}return t[0].spatialReference||(t[0].spatialReference=e),t[0]instanceof Mr?B0.executeMany(t,r,i):H0.executeMany(t,r,i)}function Bae(t,e){return[t.wkid?.toString()??"-1",t.wkt?.toString()??"",t.wkt2?.toString()??"",e.wkid?.toString()??"-1",e.wkt?.toString()??"",e.wkt2?.toString()??""].join()}function Hae(t,e){const r=p9([t],e);return r.pending!=null?{pending:r.pending,geometry:null}:r.geometries!=null?{pending:null,geometry:r.geometries[0]}:{pending:null,geometry:null}}function p9(t,e){if(!Rl()){for(const r of t)if(r!=null&&!Cr(r.spatialReference,e)&&Rs(r.spatialReference)&&Rs(e)&&!io(r.spatialReference,e))return _e(rk),{pending:oc(),geometries:null}}return{pending:null,geometries:t.map(r=>r==null?null:Cr(r.spatialReference,e)?r:Rs(r.spatialReference)&&Rs(e)?W0(r,e):null)}}let f9=class extends R{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function Wae(){n0=null,B0=null,H0=null,Sm=null,OT={}}const Zae={get loadPromise(){return n0}};function W0(t,e){try{const r=yc(t,e);if(r==null)return null;"xmin"in t&&"xmin"in r&&(r.zmin=t.zmin,r.zmax=t.zmax);const i=c9(r.type,t.spatialReference,e);return i?.(r),r}catch(r){if(!(r instanceof f9))throw r;return null}}async function m9(t,e,r){const i=t.spatialReference;return i!=null&&e!=null&&await ik(i,e,null,r),W0(t,e)}function io(t,e,r){return!(r?.areaOfInterestExtent||r?.extendedParams||r?.geographicTransformation)&&(!!Cr(t,e)||Rs(t)&&Rs(e)&&!!l9(t,e))}function Jae(t,e){if(Cr(t,e))return!0;if(!Rs(t)||!Rs(e))return!1;const r=nd(t)||ya(t)||nR(t),i=nd(e)||ya(e)||nR(e);return r&&i}async function ik(t,e,r,i){if(Rl())return xA(i);if(Array.isArray(t)){for(const{source:s,dest:n,options:o}of t)if(s&&n&&!io(s,n,o))return oc(i)}else if(t&&e&&!io(t,e,r))return oc(i);return xA(i)}function X_(t,e,r){return t?"x"in t?y9(t,e,new de,r,0):"xmin"in t?b9(t,e,new Te,r,0):"rings"in t?_9(t,e,new dt,r,0):"paths"in t?v9(t,e,new pr,r,0):"points"in t?g9(t,e,new jn,r,0):null:null}function Yae(t,e,r=e.spatialReference,i=0){return r!=null&&t.spatialReference!=null&&y9(t,t.spatialReference,e,r,i)!=null}function y9(t,e,r,i,s){fi[0]=t.x,fi[1]=t.y;const n=t.z;return fi[2]=n!==void 0?n:s,zv(fi,e,0,fi,i,0)?(r.x=fi[0],r.y=fi[1],r.spatialReference=i,n!==void 0||ic(i)?(r.z=fi[2],r.hasZ=!0):(r.z=void 0,r.hasZ=!1),t.m===void 0?(r.m=void 0,r.hasM=!1):(r.m=t.m,r.hasM=!0),r):null}function Xae(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&g9(t,t.spatialReference,e,r,i)!=null}function g9(t,e,r,i,s){const{points:n,hasZ:o,hasM:a}=t,l=[],c=n.length,d=[];for(const m of n)d.push(m[0],m[1],o?m[2]:s);if(!zv(d,e,0,d,i,0,c))return null;const p=o||ic(i);for(let m=0;m<c;++m){const y=3*m,g=d[y],v=d[y+1];p&&a?l.push([g,v,d[y+2],n[m][3]]):p?l.push([g,v,d[y+2]]):a?l.push([g,v,n[m][2]]):l.push([g,v])}return r.points=l,r.spatialReference=i,r.hasZ=o,r.hasM=a,r}function Kae(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&v9(t,t.spatialReference,e,r,i)!=null}function v9(t,e,r,i,s){const{paths:n,hasZ:o,hasM:a}=t,l=[];if(!S9(n,o??!1,a??!1,e,l,i,s))return null;const c=o||ic(i);return r.paths=l,r.spatialReference=i,r.hasZ=c,r.hasM=a,r}function w9(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&_9(t,t.spatialReference,e,r,i)!=null}function _9(t,e,r,i,s){const{rings:n,hasZ:o,hasM:a}=t,l=[];if(!S9(n,o??!1,a??!1,e,l,i,s))return null;const c=o||ic(i);return r.rings=l,r.spatialReference=i,r.hasZ=c,r.hasM=a,r}function Qae(t,e,r=e.spatialReference,i=0){return t.spatialReference!=null&&r!=null&&b9(t,t.spatialReference,e,r,i)!=null}function b9(t,e,r,i,s){const{xmin:n,ymin:o,xmax:a,ymax:l,hasZ:c,hasM:d}=t,p=c?t.zmin:s;if(!$O(n,o,p,e,fi,i))return null;const m=c||ic(i);r.xmin=fi[0],r.ymin=fi[1],m&&(r.zmin=fi[2]);const y=c?t.zmax:s;return $O(a,l,y,e,fi,i)?(r.xmax=fi[0],r.ymax=fi[1],m&&(r.zmax=fi[2]),d&&(r.mmin=t.mmin,r.mmax=t.mmax),r.spatialReference=i,r):null}function S9(t,e,r,i,s,n,o=0){const a=new Array;for(const d of t)for(const p of d)a.push(p[0],p[1],e?p[2]:o);if(!zv(a,i,0,a,n,0))return!1;let l=0;s.length=0;const c=e||ic(n);for(const d of t){const p=new Array;for(const m of d)c&&r?p.push([a[l++],a[l++],a[l++],m[3]]):c?p.push([a[l++],a[l++],a[l++]]):r?(p.push([a[l++],a[l++],m[2]]),l++):(p.push([a[l++],a[l++]]),l++);s.push(p)}return!0}const fi=mc(),xFe=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:io,initializeProjection:ik,isEqualBaseGCS:Jae,isLoaded:Rl,isLoadedOrLoad:h9,isLoadedOrLoadFor:d9,load:oc,project:yc,projectExtent:Qae,projectMany:FT,projectMultipoint:Xae,projectOrLoad:Hae,projectOrLoadMany:p9,projectPoint:Yae,projectPolygon:w9,projectPolyline:Kae,projectWithZConversion:m9,projectWithoutEngine:X_,requiresLoad:qae,test:Zae,tryProjectWithZConversion:W0,unload:Wae},Symbol.toStringTag,{value:"Module"}));var K_;let NT=K_=class extends fc(se.ofType(dt)){constructor(t){super(t)}clone(){return new K_(this.items.map(t=>t.clone()))}write(t,e){return this.toJSON(e)}toJSON(t){const e=t?.layer?.spatialReference;return e?this.toArray().map(r=>{if(!e.equals(r.spatialReference)){if(!io(r.spatialReference,e))return t?.messages?.push(new zs("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:t.layer.spatialReference,context:t})),null;const s=new dt;w9(r,s,e),r=s}const i=r.toJSON(t);return delete i.spatialReference,i}).filter(r=>r!=null):this.toArray().map(r=>r.toJSON(t))}static fromJSON(t,e){const r=new K_;return t.forEach(i=>r.add(dt.fromJSON(i,e))),r}};NT=K_=u([E("esri.layers.support.PolygonCollection")],NT);const o0=NT;let Fa=class extends fc(VP){constructor(e){super(e),this.id=`focusarea-${Xm()}`,this.title=null,this.enabled=!0,this.outline=null,this.geometries=new o0}readGeometries(e,r,i){Array.isArray(e)?this.geometries=o0.fromJSON(e,i):i.origin!=="web-scene"&&i.origin!=="portal-item"||i.hooks?.onAfterLoad?.(()=>this._loadGeometries(Il(e,i),i))}async _loadGeometries(e,r){const i=await Be(e,{responseType:"json"});this.geometries=o0.fromJSON(i.data,r)}};u([h({type:String,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),h()],Fa.prototype,"id",void 0),u([h({type:String,json:{write:!0}})],Fa.prototype,"title",void 0),u([h({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],Fa.prototype,"enabled",void 0),u([h({type:bne,json:{write:!0}})],Fa.prototype,"outline",void 0),u([h({type:o0,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new o0(t.items.map(e=>e.clone()))}),fne({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],Fa.prototype,"geometries",void 0),u([X(["web-scene","portal-item","service"],"geometries")],Fa.prototype,"readGeometries",null),Fa=u([E("esri.effects.FocusArea")],Fa);const ele=Fa;let sg=class extends fc(VP){constructor(e){super(e),this.areas=new se,this.style="bright"}};u([h({type:se.ofType(ele),nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new se(t.items.map(e=>e.clone()))})],sg.prototype,"areas",void 0),u([h({type:["bright","dark"],nonNullable:!0,json:{write:!0}})],sg.prototype,"style",void 0),sg=u([E("esri.effects.FocusAreas")],sg);const x9=sg;function tle(t){return typeof t=="object"&&t!=null&&"loaded"in t&&t.loaded===!0&&"type"in t}function rle(t){return!(!tle(t)||!Lse(t)?.operations?.supportsEditing||"editingEnabled"in t&&!Rse(t)||GV(t))}const ile=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,sle="screenUtils.toPt: input not recognized!",$9=96;function Pe(t){return t?t/72*$9:0}function Ke(t){return t?72*t/$9:0}function ze(t){if(typeof t=="string"){const e=t.match(ile);if(e){const r=Number(e[1]),i=e[3]&&e[3].toLowerCase(),s=t.startsWith("-"),n=i==="px"?Ke(r):r;return s?-n:n}return console.warn(sle),null}return t}function Tr(t=0,e=0){return{x:t,y:e}}function TFe(t){return t?Tr(t.x,t.y):null}function IFe(t=0,e=0){return[t,e]}function EFe(t=0,e=0,r=0){return[t,e,r]}function CFe(t){return t}function PFe(t){return t}function kFe(t){return t}function LFe(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function x2(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function nle(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ole(t,e,r,i,s,n,o,a,l,c,d,p,m,y,g,v){const w=new Float32Array(16);return w[0]=t,w[1]=e,w[2]=r,w[3]=i,w[4]=s,w[5]=n,w[6]=o,w[7]=a,w[8]=l,w[9]=c,w[10]=d,w[11]=p,w[12]=m,w[13]=y,w[14]=g,w[15]=v,w}const ale=x2();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:ale,clone:nle,create:x2,fromValues:ole},Symbol.toStringTag,{value:"Module"}));function M9(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function gc(t,e,r,i,s,n,o,a,l,c,d,p,m,y,g,v,w){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=n,t[5]=o,t[6]=a,t[7]=l,t[8]=c,t[9]=d,t[10]=p,t[11]=m,t[12]=y,t[13]=g,t[14]=v,t[15]=w,t}function $2(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vc(t,e){if(t===e){const r=e[1],i=e[2],s=e[3],n=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=n,t[11]=e[14],t[12]=s,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function lle(t,e){return T9(t,e)||$2(t),t}function T9(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],p=e[9],m=e[10],y=e[11],g=e[12],v=e[13],w=e[14],_=e[15],x=r*a-i*o,$=r*l-s*o,T=r*c-n*o,C=i*l-s*a,P=i*c-n*a,A=s*c-n*l,F=d*v-p*g,j=d*w-m*g,V=d*_-y*g,Z=p*w-m*v,Y=p*_-y*v,re=m*_-y*w;let Q=x*re-$*Y+T*Z+C*V-P*j+A*F;return Q?(Q=1/Q,t[0]=(a*re-l*Y+c*Z)*Q,t[1]=(s*Y-i*re-n*Z)*Q,t[2]=(v*A-w*P+_*C)*Q,t[3]=(m*P-p*A-y*C)*Q,t[4]=(l*V-o*re-c*j)*Q,t[5]=(r*re-s*V+n*j)*Q,t[6]=(w*T-g*A-_*$)*Q,t[7]=(d*A-m*T+y*$)*Q,t[8]=(o*Y-a*V+c*F)*Q,t[9]=(i*V-r*Y-n*F)*Q,t[10]=(g*P-v*T+_*x)*Q,t[11]=(p*T-d*P-y*x)*Q,t[12]=(a*j-o*Z-l*F)*Q,t[13]=(r*Z-i*j+s*F)*Q,t[14]=(v*$-g*C-w*x)*Q,t[15]=(d*C-p*$+m*x)*Q,t):null}function ule(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],p=e[9],m=e[10],y=e[11],g=e[12],v=e[13],w=e[14],_=e[15];return t[0]=a*(m*_-y*w)-p*(l*_-c*w)+v*(l*y-c*m),t[1]=-(i*(m*_-y*w)-p*(s*_-n*w)+v*(s*y-n*m)),t[2]=i*(l*_-c*w)-a*(s*_-n*w)+v*(s*c-n*l),t[3]=-(i*(l*y-c*m)-a*(s*y-n*m)+p*(s*c-n*l)),t[4]=-(o*(m*_-y*w)-d*(l*_-c*w)+g*(l*y-c*m)),t[5]=r*(m*_-y*w)-d*(s*_-n*w)+g*(s*y-n*m),t[6]=-(r*(l*_-c*w)-o*(s*_-n*w)+g*(s*c-n*l)),t[7]=r*(l*y-c*m)-o*(s*y-n*m)+d*(s*c-n*l),t[8]=o*(p*_-y*v)-d*(a*_-c*v)+g*(a*y-c*p),t[9]=-(r*(p*_-y*v)-d*(i*_-n*v)+g*(i*y-n*p)),t[10]=r*(a*_-c*v)-o*(i*_-n*v)+g*(i*c-n*a),t[11]=-(r*(a*y-c*p)-o*(i*y-n*p)+d*(i*c-n*a)),t[12]=-(o*(p*w-m*v)-d*(a*w-l*v)+g*(a*m-l*p)),t[13]=r*(p*w-m*v)-d*(i*w-s*v)+g*(i*m-s*p),t[14]=-(r*(a*w-l*v)-o*(i*w-s*v)+g*(i*l-s*a)),t[15]=r*(a*m-l*p)-o*(i*m-s*p)+d*(i*l-s*a),t}function cle(t){const e=t[0],r=t[1],i=t[2],s=t[3],n=t[4],o=t[5],a=t[6],l=t[7],c=t[8],d=t[9],p=t[10],m=t[11],y=t[12],g=t[13],v=t[14],w=t[15];return(e*o-r*n)*(p*w-m*v)-(e*a-i*n)*(d*w-m*g)+(e*l-s*n)*(d*v-p*g)+(r*a-i*o)*(c*w-m*y)-(r*l-s*o)*(c*v-p*y)+(i*l-s*a)*(c*g-d*y)}function I9(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],c=e[6],d=e[7],p=e[8],m=e[9],y=e[10],g=e[11],v=e[12],w=e[13],_=e[14],x=e[15];let $=r[0],T=r[1],C=r[2],P=r[3];return t[0]=$*i+T*a+C*p+P*v,t[1]=$*s+T*l+C*m+P*w,t[2]=$*n+T*c+C*y+P*_,t[3]=$*o+T*d+C*g+P*x,$=r[4],T=r[5],C=r[6],P=r[7],t[4]=$*i+T*a+C*p+P*v,t[5]=$*s+T*l+C*m+P*w,t[6]=$*n+T*c+C*y+P*_,t[7]=$*o+T*d+C*g+P*x,$=r[8],T=r[9],C=r[10],P=r[11],t[8]=$*i+T*a+C*p+P*v,t[9]=$*s+T*l+C*m+P*w,t[10]=$*n+T*c+C*y+P*_,t[11]=$*o+T*d+C*g+P*x,$=r[12],T=r[13],C=r[14],P=r[15],t[12]=$*i+T*a+C*p+P*v,t[13]=$*s+T*l+C*m+P*w,t[14]=$*n+T*c+C*y+P*_,t[15]=$*o+T*d+C*g+P*x,t}function hle(t,e,r){const i=r[0],s=r[1],n=r[2];if(e===t)t[12]=e[0]*i+e[4]*s+e[8]*n+e[12],t[13]=e[1]*i+e[5]*s+e[9]*n+e[13],t[14]=e[2]*i+e[6]*s+e[10]*n+e[14],t[15]=e[3]*i+e[7]*s+e[11]*n+e[15];else{const o=e[0],a=e[1],l=e[2],c=e[3],d=e[4],p=e[5],m=e[6],y=e[7],g=e[8],v=e[9],w=e[10],_=e[11];t[0]=o,t[1]=a,t[2]=l,t[3]=c,t[4]=d,t[5]=p,t[6]=m,t[7]=y,t[8]=g,t[9]=v,t[10]=w,t[11]=_,t[12]=o*i+d*s+g*n+e[12],t[13]=a*i+p*s+v*n+e[13],t[14]=l*i+m*s+w*n+e[14],t[15]=c*i+y*s+_*n+e[15]}return t}function dle(t,e,r){const i=r[0],s=r[1],n=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ple(t,e,r,i){let s=i[0],n=i[1],o=i[2],a=Math.sqrt(s*s+n*n+o*o);if(a<=Bi())return void M9(t,e);a=1/a,s*=a,n*=a,o*=a;const l=Math.sin(r),c=Math.cos(r),d=1-c,p=e[0],m=e[1],y=e[2],g=e[3],v=e[4],w=e[5],_=e[6],x=e[7],$=e[8],T=e[9],C=e[10],P=e[11],A=s*s*d+c,F=n*s*d+o*l,j=o*s*d-n*l,V=s*n*d-o*l,Z=n*n*d+c,Y=o*n*d+s*l,re=s*o*d+n*l,Q=n*o*d-s*l,Ee=o*o*d+c;t[0]=p*A+v*F+$*j,t[1]=m*A+w*F+T*j,t[2]=y*A+_*F+C*j,t[3]=g*A+x*F+P*j,t[4]=p*V+v*Z+$*Y,t[5]=m*V+w*Z+T*Y,t[6]=y*V+_*Z+C*Y,t[7]=g*V+x*Z+P*Y,t[8]=p*re+v*Q+$*Ee,t[9]=m*re+w*Q+T*Ee,t[10]=y*re+_*Q+C*Ee,t[11]=g*re+x*Q+P*Ee,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15])}function fle(t,e,r){const i=Math.sin(r),s=Math.cos(r),n=e[4],o=e[5],a=e[6],l=e[7],c=e[8],d=e[9],p=e[10],m=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=n*s+c*i,t[5]=o*s+d*i,t[6]=a*s+p*i,t[7]=l*s+m*i,t[8]=c*s-n*i,t[9]=d*s-o*i,t[10]=p*s-a*i,t[11]=m*s-l*i,t}function mle(t,e,r){const i=Math.sin(r),s=Math.cos(r),n=e[0],o=e[1],a=e[2],l=e[3],c=e[8],d=e[9],p=e[10],m=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*s-c*i,t[1]=o*s-d*i,t[2]=a*s-p*i,t[3]=l*s-m*i,t[8]=n*i+c*s,t[9]=o*i+d*s,t[10]=a*i+p*s,t[11]=l*i+m*s,t}function yle(t,e,r){const i=Math.sin(r),s=Math.cos(r),n=e[0],o=e[1],a=e[2],l=e[3],c=e[4],d=e[5],p=e[6],m=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*s+c*i,t[1]=o*s+d*i,t[2]=a*s+p*i,t[3]=l*s+m*i,t[4]=c*s-n*i,t[5]=d*s-o*i,t[6]=p*s-a*i,t[7]=m*s-l*i,t}function gle(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function vle(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function wle(t,e,r){if(e===0)return $2(t);let i=r[0],s=r[1],n=r[2],o=Math.sqrt(i*i+s*s+n*n);if(o<=Bi())return null;o=1/o,i*=o,s*=o,n*=o;const a=Math.sin(e),l=Math.cos(e),c=1-l;return t[0]=i*i*c+l,t[1]=s*i*c+n*a,t[2]=n*i*c-s*a,t[3]=0,t[4]=i*s*c-n*a,t[5]=s*s*c+l,t[6]=n*s*c+i*a,t[7]=0,t[8]=i*n*c+s*a,t[9]=s*n*c-i*a,t[10]=n*n*c+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _le(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ble(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Sle(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function E9(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=i+i,l=s+s,c=n+n,d=i*a,p=i*l,m=i*c,y=s*l,g=s*c,v=n*c,w=o*a,_=o*l,x=o*c;return t[0]=1-(y+v),t[1]=p+x,t[2]=m-_,t[3]=0,t[4]=p-x,t[5]=1-(d+v),t[6]=g+w,t[7]=0,t[8]=m+_,t[9]=g-w,t[10]=1-(d+y),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function xle(t,e){const r=$le,i=-e[0],s=-e[1],n=-e[2],o=e[3],a=e[4],l=e[5],c=e[6],d=e[7],p=i*i+s*s+n*n+o*o;return p>0?(r[0]=2*(a*o+d*i+l*n-c*s)/p,r[1]=2*(l*o+d*s+c*i-a*n)/p,r[2]=2*(c*o+d*n+a*s-l*i)/p):(r[0]=2*(a*o+d*i+l*n-c*s),r[1]=2*(l*o+d*s+c*i-a*n),r[2]=2*(c*o+d*n+a*s-l*i)),E9(t,e,r),t}const $le=mc();function Mle(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Tle(t,e){const r=e[0],i=e[1],s=e[2],n=e[4],o=e[5],a=e[6],l=e[8],c=e[9],d=e[10];return t[0]=Math.sqrt(r*r+i*i+s*s),t[1]=Math.sqrt(n*n+o*o+a*a),t[2]=Math.sqrt(l*l+c*c+d*d),t}function Ile(t,e){const r=e[0]+e[5]+e[10];let i=0;return r>0?(i=2*Math.sqrt(r+1),t[3]=.25*i,t[0]=(e[6]-e[9])/i,t[1]=(e[8]-e[2])/i,t[2]=(e[1]-e[4])/i):e[0]>e[5]&&e[0]>e[10]?(i=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/i,t[0]=.25*i,t[1]=(e[1]+e[4])/i,t[2]=(e[8]+e[2])/i):e[5]>e[10]?(i=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/i,t[0]=(e[1]+e[4])/i,t[1]=.25*i,t[2]=(e[6]+e[9])/i):(i=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/i,t[0]=(e[8]+e[2])/i,t[1]=(e[6]+e[9])/i,t[2]=.25*i),t}function Ele(t,e,r,i){const s=e[0],n=e[1],o=e[2],a=e[3],l=s+s,c=n+n,d=o+o,p=s*l,m=s*c,y=s*d,g=n*c,v=n*d,w=o*d,_=a*l,x=a*c,$=a*d,T=i[0],C=i[1],P=i[2];return t[0]=(1-(g+w))*T,t[1]=(m+$)*T,t[2]=(y-x)*T,t[3]=0,t[4]=(m-$)*C,t[5]=(1-(p+w))*C,t[6]=(v+_)*C,t[7]=0,t[8]=(y+x)*P,t[9]=(v-_)*P,t[10]=(1-(p+g))*P,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Cle(t,e,r,i,s){const n=e[0],o=e[1],a=e[2],l=e[3],c=n+n,d=o+o,p=a+a,m=n*c,y=n*d,g=n*p,v=o*d,w=o*p,_=a*p,x=l*c,$=l*d,T=l*p,C=i[0],P=i[1],A=i[2],F=s[0],j=s[1],V=s[2],Z=(1-(v+_))*C,Y=(y+T)*C,re=(g-$)*C,Q=(y-T)*P,Ee=(1-(m+_))*P,et=(w+x)*P,lt=(g+$)*A,Ve=(w-x)*A,vr=(1-(m+v))*A;return t[0]=Z,t[1]=Y,t[2]=re,t[3]=0,t[4]=Q,t[5]=Ee,t[6]=et,t[7]=0,t[8]=lt,t[9]=Ve,t[10]=vr,t[11]=0,t[12]=r[0]+F-(Z*F+Q*j+lt*V),t[13]=r[1]+j-(Y*F+Ee*j+Ve*V),t[14]=r[2]+V-(re*F+et*j+vr*V),t[15]=1,t}function Ple(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=r+r,a=i+i,l=s+s,c=r*o,d=i*o,p=i*a,m=s*o,y=s*a,g=s*l,v=n*o,w=n*a,_=n*l;return t[0]=1-p-g,t[1]=d+_,t[2]=m-w,t[3]=0,t[4]=d-_,t[5]=1-c-g,t[6]=y+v,t[7]=0,t[8]=m+w,t[9]=y-v,t[10]=1-c-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function kle(t,e,r,i,s,n,o){const a=1/(r-e),l=1/(s-i),c=1/(n-o);return t[0]=2*n*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*n*l,t[6]=0,t[7]=0,t[8]=(r+e)*a,t[9]=(s+i)*l,t[10]=(o+n)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*n*2*c,t[15]=0,t}function Lle(t,e,r,i,s){const n=1/Math.tan(e/2);let o;return t[0]=n/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(o=1/(i-s),t[10]=(s+i)*o,t[14]=2*s*i*o):(t[10]=-1,t[14]=-2*i),t}function Ale(t,e,r,i){const s=Math.tan(e.upDegrees*Math.PI/180),n=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),c=2/(s+n);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(s-n)*c*.5,t[10]=i/(r-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*r/(r-i),t[15]=0,t}function Rle(t,e,r,i,s,n,o){const a=1/(e-r),l=1/(i-s),c=1/(n-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*a,t[13]=(s+i)*l,t[14]=(o+n)*c,t[15]=1,t}function Ole(t,e,r,i){const s=e[0],n=e[1],o=e[2];let a=s-r[0],l=n-r[1],c=o-r[2];const d=Bi();if(Math.abs(a)<d&&Math.abs(l)<d&&Math.abs(c)<d)return void $2(t);let p=1/Math.sqrt(a*a+l*l+c*c);a*=p,l*=p,c*=p;const m=i[0],y=i[1],g=i[2];let v=y*c-g*l,w=g*a-m*c,_=m*l-y*a;p=Math.sqrt(v*v+w*w+_*_),p?(p=1/p,v*=p,w*=p,_*=p):(v=0,w=0,_=0);let x=l*_-c*w,$=c*v-a*_,T=a*w-l*v;p=Math.sqrt(x*x+$*$+T*T),p?(p=1/p,x*=p,$*=p,T*=p):(x=0,$=0,T=0),t[0]=v,t[1]=x,t[2]=a,t[3]=0,t[4]=w,t[5]=$,t[6]=l,t[7]=0,t[8]=_,t[9]=T,t[10]=c,t[11]=0,t[12]=-(v*s+w*n+_*o),t[13]=-(x*s+$*n+T*o),t[14]=-(a*s+l*n+c*o),t[15]=1}function Fle(t,e,r,i){const s=e[0],n=e[1],o=e[2],a=i[0],l=i[1],c=i[2];let d=s-r[0],p=n-r[1],m=o-r[2],y=d*d+p*p+m*m;y>0&&(y=1/Math.sqrt(y),d*=y,p*=y,m*=y);let g=l*m-c*p,v=c*d-a*m,w=a*p-l*d;return y=g*g+v*v+w*w,y>0&&(y=1/Math.sqrt(y),g*=y,v*=y,w*=y),t[0]=g,t[1]=v,t[2]=w,t[3]=0,t[4]=p*w-m*v,t[5]=m*g-d*w,t[6]=d*v-p*g,t[7]=0,t[8]=d,t[9]=p,t[10]=m,t[11]=0,t[12]=s,t[13]=n,t[14]=o,t[15]=1,t}function Nle(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Dle(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function zle(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function C9(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function jle(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function Vle(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t[9]=e[9]+r[9]*i,t[10]=e[10]+r[10]*i,t[11]=e[11]+r[11]*i,t[12]=e[12]+r[12]*i,t[13]=e[13]+r[13]*i,t[14]=e[14]+r[14]*i,t[15]=e[15]+r[15]*i,t}function Ule(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Gle(t,e){if(t===e)return!0;const r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=t[6],c=t[7],d=t[8],p=t[9],m=t[10],y=t[11],g=t[12],v=t[13],w=t[14],_=t[15],x=e[0],$=e[1],T=e[2],C=e[3],P=e[4],A=e[5],F=e[6],j=e[7],V=e[8],Z=e[9],Y=e[10],re=e[11],Q=e[12],Ee=e[13],et=e[14],lt=e[15],Ve=Bi();return Math.abs(r-x)<=Ve*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(i-$)<=Ve*Math.max(1,Math.abs(i),Math.abs($))&&Math.abs(s-T)<=Ve*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(n-C)<=Ve*Math.max(1,Math.abs(n),Math.abs(C))&&Math.abs(o-P)<=Ve*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(a-A)<=Ve*Math.max(1,Math.abs(a),Math.abs(A))&&Math.abs(l-F)<=Ve*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(c-j)<=Ve*Math.max(1,Math.abs(c),Math.abs(j))&&Math.abs(d-V)<=Ve*Math.max(1,Math.abs(d),Math.abs(V))&&Math.abs(p-Z)<=Ve*Math.max(1,Math.abs(p),Math.abs(Z))&&Math.abs(m-Y)<=Ve*Math.max(1,Math.abs(m),Math.abs(Y))&&Math.abs(y-re)<=Ve*Math.max(1,Math.abs(y),Math.abs(re))&&Math.abs(g-Q)<=Ve*Math.max(1,Math.abs(g),Math.abs(Q))&&Math.abs(v-Ee)<=Ve*Math.max(1,Math.abs(v),Math.abs(Ee))&&Math.abs(w-et)<=Ve*Math.max(1,Math.abs(w),Math.abs(et))&&Math.abs(_-lt)<=Ve*Math.max(1,Math.abs(_),Math.abs(lt))}function qle(t){const e=Bi(),r=t[0],i=t[1],s=t[2],n=t[4],o=t[5],a=t[6],l=t[8],c=t[9],d=t[10];return Math.abs(1-(r*r+n*n+l*l))<=e&&Math.abs(1-(i*i+o*o+c*c))<=e&&Math.abs(1-(s*s+a*a+d*d))<=e}function Ble(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const Hle=I9,Wle=C9;Object.freeze(Object.defineProperty({__proto__:null,add:zle,adjoint:ule,copy:M9,determinant:cle,equals:Gle,exactEquals:Ule,frob:Dle,fromQuat:Ple,fromQuat2:xle,fromRotation:wle,fromRotationTranslation:E9,fromRotationTranslationScale:Ele,fromRotationTranslationScaleOrigin:Cle,fromScaling:vle,fromTranslation:gle,fromXRotation:_le,fromYRotation:ble,fromZRotation:Sle,frustum:kle,getRotation:Ile,getScale:Tle,getTranslation:Mle,hasIdentityRotation:Ble,identity:$2,invert:T9,invertOrIdentity:lle,isOrthoNormal:qle,lookAt:Ole,mul:Hle,multiply:I9,multiplyScalar:jle,multiplyScalarAndAdd:Vle,ortho:Rle,perspective:Lle,perspectiveFromFieldOfView:Ale,rotate:ple,rotateX:fle,rotateY:mle,rotateZ:yle,scale:dle,set:gc,str:Nle,sub:Wle,subtract:C9,targetTo:Fle,translate:hle,transpose:vc},Symbol.toStringTag,{value:"Module"}));const Zle=(t,e)=>{const r=gc(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return vc(r,r)},Jle=(t,e)=>{const r=gc(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return vc(r,r)},Yle=(t,e)=>{const r=1-e,i=gc(t,.2126+.7874*r,.7152-.7152*r,.0722-.0722*r,0,.2126-.2126*r,.7152+.2848*r,.0722-.0722*r,0,.2126-.2126*r,.7152-.7152*r,.0722+.9278*r,0,0,0,0,1);return vc(i,i)},Xle=(t,e)=>{const r=Math.sin(e*Math.PI/180),i=Math.cos(e*Math.PI/180),s=gc(t,.213+.787*i-.213*r,.715-.715*i-.715*r,.072-.072*i+.928*r,0,.213-.213*i+.143*r,.715+.285*i+.14*r,.072-.072*i-.283*r,0,.213-.213*i-.787*r,.715-.715*i+.715*r,.072+.928*i+.072*r,0,0,0,0,1);return vc(s,s)},Kle=(t,e)=>{const r=1-2*e,i=gc(t,r,0,0,e,0,r,0,e,0,0,r,e,0,0,0,1);return vc(i,i)},Qle=(t,e)=>{const r=gc(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return vc(r,r)},eue=(t,e)=>{const r=1-e,i=gc(t,.393+.607*r,.769-.769*r,.189-.189*r,0,.349-.349*r,.686+.314*r,.168-.168*r,0,.272-.272*r,.534-.534*r,.131+.869*r,0,0,0,0,1);return vc(i,i)};let P9=class k9{constructor(e,r,i){this.strength=e,this.radius=r,this.threshold=i,this.type="bloom"}interpolate(e,r,i){this.strength=as(e.strength,r.strength,i),this.radius=as(e.radius,r.radius,i),this.threshold=as(e.threshold,r.threshold,i)}clone(){return new k9(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:a0(this.radius),strength:this.strength,threshold:this.threshold}}},L9=class A9{constructor(e){this.radius=e,this.type="blur"}interpolate(e,r,i){this.radius=Math.round(as(e.radius,r.radius,i))}clone(){return new A9(this.radius)}toJSON(){return{type:"blur",radius:a0(this.radius)}}},DT=class R9{constructor(e,r){this.type=e,this.amount=r,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,r,i){this.amount=as(e.amount,r.amount,i),this._updateMatrix()}clone(){return new R9(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const e=this._colorMatrix||x2();switch(this.type){case"brightness":this._colorMatrix=Zle(e,this.amount);break;case"contrast":this._colorMatrix=Jle(e,this.amount);break;case"grayscale":this._colorMatrix=Yle(e,this.amount);break;case"invert":this._colorMatrix=Kle(e,this.amount);break;case"saturate":this._colorMatrix=Qle(e,this.amount);break;case"sepia":this._colorMatrix=eue(e,this.amount)}}},O9=class F9{constructor(e,r,i,s){this.offsetX=e,this.offsetY=r,this.blurRadius=i,this.color=s,this.type="drop-shadow"}interpolate(e,r,i){this.offsetX=as(e.offsetX,r.offsetX,i),this.offsetY=as(e.offsetY,r.offsetY,i),this.blurRadius=as(e.blurRadius,r.blurRadius,i),this.color[0]=Math.round(as(e.color[0],r.color[0],i)),this.color[1]=Math.round(as(e.color[1],r.color[1],i)),this.color[2]=Math.round(as(e.color[2],r.color[2],i)),this.color[3]=as(e.color[3],r.color[3],i)}clone(){return new F9(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const e=[...this.color];return e[3]*=255,{type:"drop-shadow",xoffset:a0(this.offsetX),yoffset:a0(this.offsetY),blurRadius:a0(this.blurRadius),color:e}}},N9=class D9{constructor(e){this.angle=e,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,r,i){this.angle=as(e.angle,r.angle,i),this._updateMatrix()}clone(){return new D9(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const e=this._colorMatrix||x2();this._colorMatrix=Xle(e,this.angle)}},z9=class j9{constructor(e){this.amount=e,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(e,r,i){this.amount=as(e.amount,r.amount,i)}clone(){return new j9(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function as(t,e,r){return t+(e-t)*r}function a0(t){return Math.round(1e3*Ke(t))/1e3}function tue(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new DT(t.type,0);case"saturate":case"brightness":case"contrast":return new DT(t.type,1);case"opacity":return new z9(1);case"hue-rotate":return new N9(0);case"blur":return new L9(0);case"drop-shadow":return new O9(0,0,0,[...jP("transparent")]);case"bloom":return new P9(0,0,1)}}function V9(t,e){const r=t.length>e.length?t:e;return(t.length>e.length?e:t).every((i,s)=>i.type===r[s].type)}function U9(t,e){const r=t.length>e.length?t:e,i=t.length>e.length?e:t;for(let s=i.length;s<r.length;s++)i.push(tue(r[s]))}function rue(t){const e=t[0];return!!e&&"type"in e}const Jx=()=>U.getLogger("esri.support.basemapUtils");function iue(){return{}}function sue(t){for(const e in t){const r=t[e];r&&!r.destroyed&&r.destroy(),delete t[e]}}function nue(t,e){let r;if(typeof t=="string"){const i=t in rT,s=!i&&t.includes("/");if(!i&&!s){if(LM())Jx().warn(`Unable to find basemap definition for: ${t}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const n=Object.entries(rT).filter(([o,a])=>a.classic||a.is3d).map(([o])=>`"${o}"`).sort().join(", ");Jx().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${n}`)}return null}e&&(r=e[t]),r||(r=i?t0.fromId(t):new t0({style:{id:t}}),e&&(e[t]=r))}else r=jt(t0,t);return r?.destroyed&&(Jx().warn("The provided basemap is already destroyed",{basemap:r}),r=null),r}function oue(t){return new Zn({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const r=[];return"tables"in e&&r.push(e.tables),"layers"in e&&r.push(e.layers),r},itemFilterFunction:e=>{const r=e.parent;return!!r&&"tables"in r&&r.tables.includes(e)}})}function Sw(t){for(const e of t.values())e?.destroy();t.clear()}const MO={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function aue(t){let e=null;if(typeof t=="string")if(t in MO){const r=MO[t];e=new U1({resourceInfo:{data:{layers:[r]}}})}else U.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=jt(U1,t);return e}function zT(t,e,r){let i,s;if(t)for(let n=0,o=t.length;n<o;n++){if(i=t.at(n),i?.[e]===r)return i;if(i?.type==="group"&&(s=zT(i.layers,e,r),s))return s}}const lue=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.layers=new se;const s=a=>{a.parent&&a.removeFromParent()},n=a=>{a.parent=this,this.layerAdded(a),a.type!=="elevation"&&a.type!=="base-elevation"||U.getLogger(this).error(`Layer 'title:${a.title}, id:${a.id}' of type '${a.type}' is not supported as an operational layer and will therefore be ignored.`)},o=a=>{a.parent=null,this.layerRemoved(a)};this.addHandles([this.layers.on("before-add",a=>{if(a.item===this)return a.preventDefault(),void U.getLogger(this).error("#add()","Cannot add layer to itself.");s(a.item)}),this.layers.on("after-add",a=>n(a.item)),this.layers.on("after-remove",a=>o(a.item))])}destroy(){const i=this.layers.toArray();for(const s of i)s.destroy();this.layers.destroy()}removeChildLayer(i){this.layers.remove(i),super.removeChildLayer?.(i)}set layers(i){this._set("layers",la(i,this._get("layers")))}add(i,s){const n=this.layers;if(s=n.getNextIndex(s),i instanceof Et){const o=i;o.parent===this?this.reorder(o,s):n.add(o,s)}else $i(i)?i.then(o=>{this.destroyed||this.add(o,s)}):U.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(i,s){const n=this.layers;let o=n.getNextIndex(s);i.slice().forEach(a=>{a.parent!==this?(n.add(a,o),o+=1):this.reorder(a,o)})}findLayerById(i){return zT(this.layers,"id",i)}findLayerByUid(i){return zT(this.layers,"uid",i)}remove(i){return this.layers.remove(i)}removeMany(i){return this.layers.removeMany(i)}removeAll(){return this.layers.removeAll()}reorder(i,s){return this.layers.reorder(i,s)}layerAdded(i){}layerRemoved(i){}};return u([h()],r.prototype,"layers",null),r=u([E("esri.support.LayersMixin")],r),r},uue=new Set(["feature","subtype-group"]);function jT(t,e,r){if(t)for(let i=0,s=t.length;i<s;i++){const n=t.at(i);if(n[e]===r)return n;if(n?.type==="group"){const o=jT(n.tables,e,r);if(o)return o}}}const cue=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.tables=new se,this.addHandles([this.tables.on("after-add",s=>{const n=s.item;n.parent&&n.parent!==this&&n.removeFromParent(),n.parent=this,uue.has(n.type)||U.getLogger(this).error(`Layer 'title:${n.title}, id:${n.id}' of type '${n.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",s=>{s.item.parent=null})])}destroy(){const i=this.tables.toArray();for(const s of i)s.destroy();this.tables.destroy()}removeChildLayer(i){this.tables.remove(i),super.removeChildLayer?.(i)}set tables(i){this._set("tables",la(i,this._get("tables")))}findTableById(i){return jT(this.tables,"id",i)}findTableByUid(i){return jT(this.tables,"uid",i)}};return u([h()],r.prototype,"tables",null),r=u([E("esri.support.TablesMixin")],r),r};let Zs=class extends cue(lue(qm)){constructor(e){super(e),this.allLayers=new Zn({getCollections:()=>[this.basemap?.baseLayers,this.basemap?.groundLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:r=>"layers"in r?r.layers:null}),this.focusAreas=new x9,this.allTables=oue(this),this.basemap=null,this.editableLayers=new Zn({getCollections:()=>[this.allLayers],itemFilterFunction:rle}),this.ground=new U1,this._basemapCache=iue(),this.addHandles(Ti(()=>this.ground,(r,i)=>{i?.parent===this&&(i.parent=null),r.parent=this},{sync:!0}))}destroy(){sue(this._basemapCache),this._basemapCache=null,this.focusAreas.destroy(),this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=xt(this.basemap),xt(this.ground),this._set("ground",null)}castBasemap(e){return nue(e,this._basemapCache)}castGround(e){return aue(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(r=>r.id===e)}findTableById(e){return this.allTables.find(r=>r.id===e)}};u([h({readOnly:!0,dependsOn:[]})],Zs.prototype,"allLayers",void 0),u([h({type:x9,nonNullable:!0,json:{write:{overridePolicy:t=>({enabled:t.areas.length>0,ignoreOrigin:!0})}}})],Zs.prototype,"focusAreas",void 0),u([h({readOnly:!0})],Zs.prototype,"allTables",void 0),u([h({type:t0,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Zs.prototype,"basemap",void 0),u([He("basemap")],Zs.prototype,"castBasemap",null),u([h({readOnly:!0})],Zs.prototype,"editableLayers",void 0),u([h({type:U1,nonNullable:!0})],Zs.prototype,"ground",void 0),u([He("ground")],Zs.prototype,"castGround",null),u([h()],Zs.prototype,"undoRedo",void 0),Zs=u([E("esri.Map")],Zs);const G9=Zs;let Uc=class extends VP{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return e!=null&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};u([h({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Uc.prototype,"row",void 0),u([h({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Uc.prototype,"column",void 0),u([h({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Uc.prototype,"rows",void 0),u([h({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Uc.prototype,"columns",void 0),Uc=u([E("esri.CameraLayout")],Uc);const q9=Uc;let M2=class{constructor(e,r){this.min=e,this.max=r,this.range=r-e}normalize(e,r=0,i=!1){return TO(this.range,this.min,this.max,e,r,i)}clamp(e,r=0){return Qr(e-r,this.min,this.max)+r}monotonic(e,r,i){return e<r?r:r+VT(this.range,e-r,i)}minimalMonotonic(e,r,i){return TO(this.range,e,e+this.range,r,i)}center(e,r,i){return r=this.monotonic(e,r,i),this.normalize((e+r)/2,i)}diff(e,r,i){return this.monotonic(e,r,i)-e}shortestSignedDiff(e,r){e=this.normalize(e);const i=(r=this.normalize(r))-e,s=r<e?this.minimalMonotonic(e,r)-e:r-this.minimalMonotonic(r,e);return Math.abs(i)<Math.abs(s)?i:s}contains(e,r,i){return r=this.minimalMonotonic(e,r),(i=this.minimalMonotonic(e,i))>e&&i<r}};function TO(t,e,r,i,s=0,n=!1){return(i-=s)<e?i+=VT(t,e-i):i>r&&(i-=VT(t,i-r)),n&&i===r&&(i=e),i+s}function VT(t,e,r=0){return Math.ceil((e-r)/t)*t+r}const FFe=new M2(0,2*Math.PI),NFe=new M2(-Math.PI,Math.PI),hue=new M2(0,360);let co=class extends Ie(W){constructor(...e){super(...e),this.position=new de([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new q9}normalizeCtorArgs(e,r,i,s){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const n={position:e};return r!=null&&(n.heading=r),i!=null&&(n.tilt=i),s!=null&&(n.fov=s),n}return e}writePosition(e,r,i,s){const n=e.clone();n.x=zi(e.x||0),n.y=zi(e.y||0),n.z=e.hasZ?zi(e.z||0):e.z,r[i]=n.write({},s)}readPosition(e,r){const i=new de;return i.read(e,r),i.x=zi(i.x||0),i.y=zi(i.y||0),i.z=i.hasZ?zi(i.z||0):i.z,i}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};u([h({type:de,json:{write:{isRequired:!0}}})],co.prototype,"position",void 0),u([te("position")],co.prototype,"writePosition",null),u([X("position")],co.prototype,"readPosition",null),u([h({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),He(t=>hue.normalize(zi(t)))],co.prototype,"heading",void 0),u([h({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),He(t=>Qr(zi(t),-180,180))],co.prototype,"tilt",void 0),u([h({type:Number,nonNullable:!0,json:{default:55,write:!0}}),He(t=>Qr(zi(t,55),1,170))],co.prototype,"fov",void 0),u([h({type:q9,nonNullable:!0,json:{read:!1,write:!1}})],co.prototype,"layout",void 0),co=u([E("esri.Camera")],co);const due=co;function Ni(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function Pf(t){return t.points!==void 0}function Z0(t){return t.x!==void 0&&t.y!==void 0}function Xr(t){return t.paths!==void 0||t.curvePaths!==void 0}function Kt(t){return t.rings!==void 0||t.curveRings!==void 0}function ac(t){return t==null?null:t instanceof Mr?t:Z0(t)?de.fromJSON(t):Xr(t)?pr.fromJSON(t):Kt(t)?dt.fromJSON(t):Pf(t)?jn.fromJSON(t):Ni(t)?Te.fromJSON(t):null}function Qm(t){return t?Z0(t)?"esriGeometryPoint":Xr(t)?"esriGeometryPolyline":Kt(t)?"esriGeometryPolygon":Ni(t)?"esriGeometryEnvelope":Pf(t)?"esriGeometryMultipoint":null:null}const pue={esriGeometryPoint:de,esriGeometryPolyline:pr,esriGeometryPolygon:dt,esriGeometryEnvelope:Te,esriGeometryMultipoint:jn,esriGeometryMultiPatch:dt};function fue(t){return t&&pue[t]||null}const mue=yr()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),IO=yr()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),jv={base:Mr,key:"type",typeMap:{extent:Te,multipoint:jn,point:de,polyline:pr,polygon:dt}};function zFe(t){return t.type==="point"}function jFe(t){return t.type==="multipoint"}function VFe(t){return t.type==="polygon"}function UFe(t){return t.type==="polyline"}var UT;let ou=UT=class extends W{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new UT({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};u([h({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Yx}}}}})],ou.prototype,"rotation",void 0),u([He("rotation")],ou.prototype,"castRotation",null),u([h({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Yx}}}}})],ou.prototype,"scale",void 0),u([h({types:jv,json:{read:ac,write:!0,origins:{"web-scene":{read:ac,write:{overridePolicy:Yx}}}}})],ou.prototype,"targetGeometry",void 0),u([h({type:due,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],ou.prototype,"camera",void 0),ou=UT=u([E("esri.Viewpoint")],ou);const fn=ou;function Yx(){return{enabled:!this.camera}}let J0=class{constructor(e=r=>r.values().next().value){this._peeker=e,this._observable=new Ev,this._items=new Set}get length(){return _e(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return _e(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const r=this.length;return this._items.forEach(i=>{e(i)||this._items.delete(i)}),r!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){_e(this._observable),yield*this._items}};const B9=new FinalizationRegistry(t=>{t.close()});function yue(t,e){B9.register(t,e,e)}function gue(t){B9.unregister(t)}function H9(t,e){return new Proxy({},{get:(r,i,s)=>(...n)=>{let o,a;const l=n[n.length-1];return vue(l)&&(o=l.signal,a=l.transferList,n.pop()),t.apply(e?`${e}.${i.toString()}`:i.toString(),n,{transferList:a,signal:o})}})}function vue(t){return typeof t=="object"&&!Array.isArray(t)&&t!=null&&("signal"in t||"transferList"in t||Object.keys(t).length===0)}const wue={statsWorker:()=>q(()=>import("./statsWorker-C_u2u7st.js"),__vite__mapDeps([18,19,20,21])),geometryEngineWorker:()=>q(()=>import("./geometryEngineWorker-BkMQzpX8.js"),__vite__mapDeps([22,23,24,25])),arcadeGeometryOperatorsWorker:()=>q(()=>import("./operatorsWorker-Du0DpQtj.js"),[]),CSVSourceWorker:()=>q(()=>import("./CSVSourceWorker-BmMdzKN4.js"),__vite__mapDeps([26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,19,20,21,41,42,43,44,45])),EdgeProcessingWorker:()=>q(()=>import("./EdgeProcessingWorker-Df869KeA.js"),__vite__mapDeps([46,47,48,49,50,51,52,53,54,55,56])),ElevationSamplerWorker:()=>q(()=>import("./ElevationSamplerWorker-DKRmtnle.js"),__vite__mapDeps([57,33,58,59,60,61,62,63,64,49,65])),FeatureServiceSnappingSourceWorker:()=>q(()=>import("./FeatureServiceSnappingSourceWorker-CV5XmX8A.js"),__vite__mapDeps([66,29,30,28,31,32,33,34,35,36,37,38,39,40,19,20,21,41,42,67,68,69,70])),GaussianSplatSortWorker:()=>q(()=>import("./GaussianSplatSortWorker-CkystscD.js"),[]),GeoJSONSourceWorker:()=>q(()=>import("./GeoJSONSourceWorker-D5tRcisS.js"),__vite__mapDeps([71,30,28,31,29,32,33,34,35,36,37,38,39,40,19,20,21,41,42,72,27,45,73])),LercWorker:()=>q(()=>import("./LercWorker-Bl3ldviC.js"),[]),MemorySourceWorker:()=>q(()=>import("./MemorySourceWorker-CV6qsSZj.js"),__vite__mapDeps([74,30,28,31,75,29,32,33,34,35,36,37,38,39,40,19,20,21,41,42,45,73,27])),PBFDecoderWorker:()=>q(()=>import("./PBFDecoderWorker-Cg2ohY7p.js"),__vite__mapDeps([76,77,30,28,31,68,69])),FeaturePipelineWorker:()=>q(()=>import("./FeaturePipelineWorker-hTo_Sqe7.js"),__vite__mapDeps([78,79,80,51,81,82,28,30,31,83,35,34,84,85,86,87,88,89,36,37,38,39,40,19,20,21,41,42,90,91,92,93,16,94,95,96,97,72,27,45,73,70,68,69,98,99])),PointCloudWorker:()=>q(()=>import("./PointCloudWorker-ly0aThLz.js"),__vite__mapDeps([100,101,102,103,104,105,106,60,61,107,108])),RasterWorker:()=>q(()=>import("./RasterWorker-BKVk1kB2.js"),__vite__mapDeps([109,110,111,25,112,113,114,115,116,117])),SceneLayerSnappingSourceWorker:()=>q(()=>import("./SceneLayerSnappingSourceWorker-CVwbUjNt.js"),__vite__mapDeps([118,119,120,108,102,121,122,107,49,53,54,55,48,50,51,52,56])),SceneLayerWorker:()=>q(()=>import("./SceneLayerWorker-Co4xFbeU.js"),__vite__mapDeps([123,58,64,124,62])),WFSSourceWorker:()=>q(()=>import("./WFSSourceWorker-Bge17csS.js"),__vite__mapDeps([125,30,28,31,29,32,33,34,35,36,37,38,39,40,19,20,21,41,42,72,27,73,126,127])),WorkerTileHandler:()=>q(()=>import("./WorkerTileHandler-DsWE-dUk.js"),__vite__mapDeps([128,129,130,69,87,131,132,52,51,133])),Lyr3DWorker:()=>q(()=>import("./Lyr3DWorker-Sg9FO4Ep.js"),[]),Feature3DPipelineWorker:()=>q(()=>import("./Feature3DPipelineWorker-DObTngp0.js"),__vite__mapDeps([134,37,30,28,31,38,39,34,35,40,19,20,21,41,42,135,63,58,124,62,136,103,137,55,49,138,120,108,102,119,139,140,122,107,106,101,60,61,52,51,48,50,141,142,143,144,145,146,147,148,149,150,33,70,68,69,151])),TextureCompressionWorker:()=>q(()=>import("./TextureCompressionWorker-B3dmd_Tm.js"),[]),FlowWorker:()=>q(()=>import("./FlowWorker-B9jjt7xA.js"),__vite__mapDeps([152,117])),ParquetSourceWorker:()=>q(()=>import("./ParquetSourceWorker-DGjIBGWG.js"),__vite__mapDeps([153,89,37,30,28,31,38,39,34,35,40,19,20,21,41,42,45,154,44,92,82,91,90])),PanoramicMeshWorker:()=>q(()=>import("./PanoramicMeshWorker-CewunH9C.js"),__vite__mapDeps([155,110]))},W9="worker:port-closed",Sl={HANDSHAKE:0,OPEN:1,OPENED:2,RESPONSE:3,INVOKE:4,ABORT:5,CLOSE:6,OPEN_PORT:7,ON:8};let _ue=0;function Z9(){return _ue++}function bue(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function B1(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function J9(t,e,r,i){if(e.type===Sl.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==Sl.INVOKE&&e.type!==Sl.RESPONSE)return void t.postMessage(e);let s;bue(r)?(s=EO(r.transferList),e.data=r.result):(s=EO(i),e.data=r),s?t.postMessage(e,s):t.postMessage(e)}function Y0(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function EO(t){if(!t?.length)return null;if(z("esri-workers-arraybuffer-transfer"))return t;const e=t.filter(r=>!Sue(r));return e.length?e:null}function Sue(t){return t instanceof ArrayBuffer||t?.constructor?.name==="ArrayBuffer"}async function qFe(t){try{return await t}catch(e){const r=e?.name===W9;if(!(Ur(e)||r))throw e;return}}const{CLOSE:xw,ABORT:GT,INVOKE:CO,RESPONSE:My,OPEN_PORT:PO,ON:kO}=Sl,xue=2;let $ue=class{constructor(e){this._invoke=e,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(e){e.type===GT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}};var sn;let xm=(sn=class{static connect(e,r){const i=new MessageChannel;let s;s=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const n=new sn(i.port1,{channel:i,client:s,schedule:r});return typeof s=="object"&&"remoteClient"in s&&(s.remoteClient=n),sn.clients.set(n,s),i.port2}static loadWorker(e){const r=wue[e];return r?r():Promise.resolve(null)}constructor(e,r,i,s){this._port=e,this._jobQueue=i,this._lowPriorityJobQueue=s,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new $ue(n=>this._onInvokeMessage(n)),this._client=r.client,this._onMessage=this._onMessage.bind(this),this._channel=r.channel,this._schedule=r.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:xw}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,r,i){return this.apply(e,[r],i)}apply(e,r,i){const s=i?.signal,n=i?.transferList;if(!this._port)return Promise.reject(new R(W9,`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:r}));const o=Z9();return new Promise((a,l)=>{if(xi(s))return this._processWork(),void l(it());const c=mn(s,()=>{const p=this._outJobs.get(o);p&&(this._outJobs.delete(o),this._processWork(),yt(p.abortHandle),this._post({type:GT,jobId:o}),l(it()))}),d={resolve:a,reject:l,abortHandle:c,debugInfo:e};this._outJobs.set(o,d),this._post({type:CO,jobId:o,methodName:e,abortable:s!=null},r,n)})}createInvokeProxy(e){return H9(this,e)}on(e,r){const i=new MessageChannel;function s(n){r(n.data)}return this._port.postMessage({type:kO,eventType:e,port:i.port2},[i.port2]),i.port1.addEventListener("message",s),i.port1.start(),je(()=>{i.port1.postMessage({type:xw}),i.port1.close(),i.port1.removeEventListener("message",s)})}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:PO,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=xue)return;const e=this._jobQueue?.pop()??this._lowPriorityJobQueue?.pop();if(!e)return;const{methodName:r,data:i,invokeOptions:s,resolver:n}=e;this.apply(r,i,s).then(o=>n.resolve(o)).catch(o=>n.reject(o))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{yt(e.abortHandle),e.reject(it(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null,this._onMessage=null,this._channel=null,this._jobQueue=void 0,this._invokeQueue=void 0,this._lowPriorityJobQueue=void 0}_onMessage(e){this._schedule!=null?this._schedule(()=>this._processMessage(e,!0)):this._processMessage(e,!1)}_processMessage(e,r){const i=Y0(e);if(i)switch(i.type){case My:this._onResponseMessage(i);break;case CO:r?this._onInvokeMessage(i):this._invokeQueue.push(i);break;case GT:this._onAbortMessage(i);break;case xw:this._onCloseMessage();break;case PO:this._onOpenPortMessage(i);break;case kO:this._onOnMessage(i)}}_onAbortMessage(e){const r=this._inJobs,i=e.jobId,s=r.get(i);this._invokeQueue.push(e),s&&(s.controller&&s.controller.abort(),r.delete(i))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&sn.clients.get(this)===e&&e.destroy(),sn.clients.delete(this),e?.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:r,jobId:i,data:s=[],abortable:n}=e,o=n?new AbortController:null,a=this._inJobs;let l,c=this._client,d=c[r];try{if(!d&&r&&r.includes(".")){const p=r.split(".");for(let m=0;m<p.length-1;m++)c=c[p[m]],d=c[p[m+1]]}if(typeof d!="function")throw new TypeError(`${r} is not a function`);s.push({client:this,signal:o?o.signal:null}),l=d.apply(c,s)}catch(p){return void this._post({type:My,jobId:i,error:B1(p)})}$i(l)?(a.set(i,{controller:o,promise:l}),l.then(p=>{a.has(i)&&(a.delete(i),this._post({type:My,jobId:i},p))},p=>{a.has(i)&&(a.delete(i),Ur(p)||this._post({type:My,jobId:i,error:B1(p||{message:`Error encountered at method ${r}`})}))})):this._post({type:My,jobId:i},l)}_onOpenPortMessage(e){new sn(e.port,{client:this._client})}_onOnMessage(e){const{port:r}=e,i=this._client.on(e.eventType,n=>{r.postMessage(n)}),s=Dm(e.port,"message",n=>{Y0(n)?.type===xw&&(s.remove(),i.remove(),r.close())})}_onResponseMessage(e){const{jobId:r,error:i,data:s}=e,n=this._outJobs;if(!n.has(r))return;const o=n.get(r);n.delete(r),this._processWork(),yt(o.abortHandle),i?o.reject(R.fromJSON(JSON.parse(i))):o.resolve(s)}_post(e,r,i){return J9(this._port,e,r,i)}},sn.kernelInfo={buildDate:Rz,fullVersion:ZC,revision:Oz},sn.clients=new Map,sn),Mue=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new J0,this._ongoingLowPriorityJobsQueue=new J0}destroy(){this.close()}get closed(){return!this._clients?.length}open(e,r){return new Promise((i,s)=>{let n=!0;const o=a=>{gt(r.signal),n&&(n=!1,a())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let a=0;a<e.length;++a){const l=e[a];$i(l)?this._clientPromises[a]=l.then(c=>(this._clients[a]=new xm(c,r,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),o(i),this._clients[a]),()=>(o(s),null)):(this._clients[a]=new xm(l,r,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),this._clientPromises[a]=Promise.resolve(this._clients[a]),o(i))}})}broadcast(e,r,i){const s=new Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n){const o=this._clientPromises[n];s[n]=o.then(a=>a?.invoke(e,r,i))}return s}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(it(`Worker closing, aborting job calling '${e.methodName}'`));for(;e=this._ongoingLowPriorityJobsQueue.pop();)e.resolver.reject(it(`Worker closing, aborting job calling '${e.methodName}'`));for(const r of this._clientPromises)r.then(i=>i?.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,gue(this)}invoke(e,r,i){return this.apply(e,[r],i)}apply(e,r,i){const s=ps();(i?.priority==="low"?this._ongoingLowPriorityJobsQueue:this._ongoingJobsQueue).push({methodName:e,data:r,invokeOptions:i,resolver:s});for(let n=0;n<this._clientPromises.length;n++){const o=this._clients[n];o?o.jobAdded():this._clientPromises[n].then(a=>a?.jobAdded())}return s.promise}createInvokeProxy(e){return H9(this,e)}on(e,r){return Promise.all(this._clientPromises).then(()=>md(this._clients.map(i=>i.on(e,r))))}openPorts(){return new Promise(e=>{const r=new Array(this._clientPromises.length);let i=r.length;for(let s=0;s<this._clientPromises.length;++s)this._clientPromises[s].then(n=>{n&&(r[s]=n.openPort()),--i===0&&e(r)})})}get test(){}};const Tue={async request(t,e){const r=t.options,i=r.responseType;r.signal=e?.signal,r.responseType=i==="native"||i==="native-request-init"?"native-request-init":i&&["blob","json","text"].includes(i)&&TM(t.url)?.after?i:"array-buffer";const s=await Be(t.url,r),n={data:s.data,httpStatus:s.httpStatus,ssl:s.ssl};switch(s.requestOptions?.responseType){case"native-request-init":return delete n.data.signal,n;case"blob":n.data=await n.data.arrayBuffer();break;case"json":n.data=new TextEncoder().encode(JSON.stringify(n.data)).buffer;break;case"text":n.data=new TextEncoder().encode(n.data).buffer}return{result:n,transferList:[n.data]}}},LO={};function Iue(t){const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages?.slice()||[],paths:{...LO.paths,...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=LO.baseUrl),e}let Eue=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(r=>{this[r]=(...i)=>e[r](...i)})}},Q_=class{constructor(){this._dispatcher=new Eue,this._workerPostMessage({type:Sl.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){v1(()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))})}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,r,i){this._dispatcher.addEventListener(e,r,i)}removeEventListener(e,r,i){this._dispatcher.removeEventListener(e,r,i)}_workerPostMessage(e){v1(()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))})}async _workerMessageHandler(e){const r=Y0(e);if(r&&r.type===Sl.OPEN){const{modulePath:i,jobId:s}=r;let n=await xm.loadWorker(i);n||(n=await import(i));const o=xm.connect(n);this._workerPostMessage({type:Sl.OPENED,jobId:s,data:o})}}};const qT=()=>U.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:Cue}=Sl,Pue='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}).finally(()=>{t&&t.removeEventListener("abort",s)})}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://esriurl.com/using-local-assets.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(e=>e||new Promise(e=>{require([o.modulePath],e)})).then(t)}):"System"in self&&"function"==typeof System.import?System.import(workerPath).then(e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath))).then(e=>e||System.import(o.modulePath)).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(e=>e||import(o.modulePath)).then(t)}):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let $w,Mw;const AO="Failed to create Worker. Fallback to execute module in main thread";async function kue(){if(!z("esri-workers"))return RO(new Q_);if(!$w&&!Mw)try{const e=Pue.split("{CONFIGURATION}").join(Lue());$w=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){Mw=e||{}}let t;if($w)try{t=new Worker($w,{name:"esri-worker-"+Aue++})}catch{qT().warn(AO,Mw),t=new Q_}else qT().warn(AO,Mw),t=new Q_;return RO(t)}async function RO(t){return new Promise(e=>{function r(s){const n=Y0(s);n&&n.type===Cue&&(t.removeEventListener("message",r),t.removeEventListener("error",i),e(t))}function i(s){s.preventDefault(),t.removeEventListener("message",r),t.removeEventListener("error",i),qT().warn("Failed to create Worker. Fallback to execute module in main thread",s),(t=new Q_).addEventListener("message",r),t.addEventListener("error",i)}t.addEventListener("message",r),t.addEventListener("error",i)})}function Lue(){let t;if(De.default!=null){const s={...De};delete s.default,t=JSON.parse(JSON.stringify(s))}else t=JSON.parse(JSON.stringify(De));t.assetsPath=an(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?an(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=hs(),t.has={"esri-csp-restrictions":z("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":z("esri-2d-update-debug"),"esri-2d-log-updating":z("esri-2d-log-updating"),"featurelayer-pbf":z("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":z("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":z("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":z("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":z("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":z("featurelayer-query-max-depth"),"featurelayer-query-tile-max-features":z("featurelayer-query-tile-max-features"),"featurelayer-query-tile-concurrency":z("featurelayer-query-tile-concurrency"),"featurelayer-query-pausing-enabled":z("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-concurrency":z("featurelayer-snapshot-concurrency"),"featurelayer-snapshot-enabled":z("featurelayer-snapshot-enabled"),"parquetlayer-full-query-feature-count":z("parquetlayer-full-query-feature-count"),"esri-atomics":z("esri-atomics"),"esri-shared-array-buffer":z("esri-shared-array-buffer"),"esri-tiles-debug":z("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":z("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":z("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=an(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=an(t.workers.workerPath):t.workers.workerPath=an(St("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=De.workers.loaderConfig,r=Iue({baseUrl:e?.baseUrl,locale:hs(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e?.has},map:{...e?.map},paths:{...e?.paths},packages:e?.packages||[]});return JSON.stringify({esriConfig:t,loaderConfig:r,kernelInfo:{buildDate:Rz,fullVersion:ZC,revision:Oz}})}let Aue=0;const{ABORT:OO,INVOKE:Rue,OPEN:Oue,OPENED:Fue,RESPONSE:Ty}=Sl;let Nue=class Y9{static async create(e){const r=await kue();return new Y9(r,e)}constructor(e,r){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=r,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",i=>{i.preventDefault(),U.getLogger("esri.core.workers.WorkerOwner").error(i)})}terminate(){this.worker.terminate()}async open(e,r={}){const{signal:i}=r,s=Z9();return new Promise((n,o)=>{const a={resolve:n,reject:o,abortHandle:JC(i,()=>{this._outJobs.delete(s),this._post({type:OO,jobId:s})})};this._outJobs.set(s,a),this._post({type:Oue,jobId:s,modulePath:e})})}_onMessage(e){const r=Y0(e);if(r)switch(r.type){case Fue:this._onOpenedMessage(r);break;case Ty:this._onResponseMessage(r);break;case OO:this._onAbortMessage(r);break;case Rue:this._onInvokeMessage(r)}}_onAbortMessage(e){const r=this._inJobs,i=e.jobId,s=r.get(i);s&&(s.controller&&s.controller.abort(),r.delete(i))}_onInvokeMessage(e){const{methodName:r,jobId:i,data:s,abortable:n}=e,o=n?new AbortController:null,a=this._inJobs,l=Tue[r];let c;try{if(typeof l!="function")throw new TypeError(`${r} is not a function`);c=l.call(null,s,{signal:o?o.signal:null})}catch(d){return void this._post({type:Ty,jobId:i,error:B1(d)})}$i(c)?(a.set(i,{controller:o,promise:c}),c.then(d=>{a.has(i)&&(a.delete(i),this._post({type:Ty,jobId:i},d))},d=>{a.has(i)&&(a.delete(i),d||(d={message:"Error encountered at method"+r}),Ur(d)||this._post({type:Ty,jobId:i,error:B1(d||{message:`Error encountered at method ${r}`})}))})):this._post({type:Ty,jobId:i},c)}_onOpenedMessage(e){const{jobId:r,data:i}=e,s=this._outJobs.get(r);s&&(this._outJobs.delete(r),yt(s.abortHandle),s.resolve(i))}_onResponseMessage(e){const{jobId:r,error:i,data:s}=e,n=this._outJobs.get(r);n&&(this._outJobs.delete(r),yt(n.abortHandle),i?n.reject(R.fromJSON(JSON.parse(i))):n.resolve(s))}_post(e,r,i){return J9(this.worker,e,r,i)}};const FO=z("host-browser")?Math.min(navigator.hardwareConcurrency-1,z("workers-pool-size")??8):0;let Lh=z("esri-mobile")?Math.min(FO,3):FO;Lh||(Lh=z("safari")&&z("mac")?7:2);let NO=0;const eb=[];function Due(){X9()}async function Tw(t,e){const r=new Mue,{registryTarget:i,...s}=e;return await r.open(t,s),i&&yue(i,r),r}async function zue(t,e={}){if(typeof t!="string")throw new R("workers:undefined-module","modulePath is missing");let r=e.strategy||"distributed";if(z("host-webworker")&&!z("esri-workers")&&(r="local"),r==="local"){let i=await xm.loadWorker(t);i||(i=await import(t)),gt(e.signal);const s=e.client||i;return Tw([xm.connect(i,e.schedule)],{...e,client:s})}if(await X9(),gt(e.signal),r==="dedicated"){const i=NO++%Lh;return Tw([await eb[i].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const i=Math.min(e.maxNumWorkers,Lh);if(i<Lh){const s=new Array(i);for(let n=0;n<i;++n){const o=NO++%Lh;s[n]=eb[o].open(t,e)}return Tw(s,e)}}return Tw(eb.map(i=>i.open(t,e)),e)}let Iw=null;async function X9(){if(Iw)return Iw;new AbortController;const t=[];for(let e=0;e<Lh;e++){const r=Nue.create(e).then(i=>(eb[e]=i,i));t.push(r)}return Iw=Promise.all(t),Iw}let l0=class extends se{constructor(e){super(e),this.addHandles([this.on("before-add",r=>{r.item==null&&r.preventDefault()}),this.on("after-add",r=>this._own(r.item)),this.on("after-remove",r=>this._release(r.item))])}get owner(){return this._get("owner")}set owner(e){this.destroyed||e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(se.ofType(this.itemType.Type))(e):new se(e)}};function BT(t,e){return{type:t,cast:j6,set(r){const i=la(r,this._get(e),t);i&&!i.destroyed&&(i.owner=this),this._set(e,i)}}}u([h()],l0.prototype,"owner",null),l0=u([E("esri.core.support.OwningCollection")],l0);var HT,Nf;let Yr=(Nf=class extends W{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new HT({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}},HT=Nf,Nf);u([h({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Yr.prototype,"cols",void 0),u([h({type:Ue,json:{write:!0}})],Yr.prototype,"level",void 0),u([h({type:String,json:{write:!0}})],Yr.prototype,"levelValue",void 0),u([h({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Yr.prototype,"origin",void 0),u([h({type:Number,json:{write:!0}})],Yr.prototype,"resolution",void 0),u([h({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Yr.prototype,"rows",void 0),u([h({type:Number,json:{write:!0}})],Yr.prototype,"scale",void 0),Yr=HT=u([E("esri.layers.support.LOD")],Yr);let jue=class K9{constructor(e,r,i,s=lr()){this._level=e,this._row=r,this._col=i,this.extent=s}get id(){return this._id??=`${this.level}/${this.row}/${this.col}`,this._id}get level(){return this._level}set level(e){this._level=e,this._id=null}get row(){return this._row}set row(e){this._row=e,this._id=null}get col(){return this._col}set col(e){this._col=e,this._id=null}toJSON(){return{level:this._level,row:this._row,col:this._col,extent:this.extent}}static fromJSON(e){return new K9(e.level,e.row,e.col,e.extent)}};var cp;const DO=new Ne({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});var Df;let Ci=(Df=class extends W{static create(e={}){const{resolutionFactor:r=1,scales:i,size:s=256,spatialReference:n=ne.WebMercator,numLODs:o=24}=e;if(!Rs(n)){const m=[];if(i)for(let y=0;y<i.length;y++){const g=i[y];m.push(new Yr({level:y,scale:g,resolution:g}))}else{let y=5e-4;for(let g=o-1;g>=0;g--)m.unshift(new Yr({level:g,scale:y,resolution:y})),y*=2}return new cp({dpi:96,lods:m,origin:new de(0,0,n),size:[s,s],spatialReference:n})}const a=qi(n),l=e.origin?new de({x:e.origin.x,y:e.origin.y,spatialReference:n}):new de(a?{x:a.origin[0],y:a.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),c=96,d=1/(Vs(n)*39.37*c),p=[];if(i)for(let m=0;m<i.length;m++){const y=i[m],g=y*d;p.push(new Yr({level:m,scale:y,resolution:g}))}else{let m=Bm(n)?512/s*5916575275917094e-7:256/s*591657527591555e-6;const y=Math.ceil(o/r);p.push(new Yr({level:0,scale:m,resolution:m*d}));for(let g=1;g<y;g++){const v=m/2**r,w=v*d;p.push(new Yr({level:g,scale:v,resolution:w})),m=v}}return new cp({dpi:c,lods:p,origin:l,size:[s,s],spatialReference:n})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:r}=this;if(e&&r){const i=qi(e);return e.isWrappable&&!!i&&Math.abs(i.origin[0]-r.x)<=i.dx}return!1}readOrigin(e,r){return de.fromJSON({spatialReference:r.spatialReference,...e})}set lods(e){let r=0,i=0;const s=[],n=this._levelToLOD={};e&&(r=-1/0,i=1/0,e.forEach(o=>{s.push(o.scale),r=o.scale>r?o.scale:r,i=o.scale<i?o.scale:i,n[o.level]=o})),this._set("scales",s),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,r){return[r.cols,r.rows]}writeSize(e,r){r.cols=e[0],r.rows=e[1]}zoomToScale(e){const r=this.scales;if(e<=0)return r[0];if(e>=r.length-1)return r[r.length-1];const i=Math.floor(e),s=i+1;return r[i]/(r[i]/r[s])**(e-i)}scaleToZoom(e){const r=this.scales,i=r.length-1;let s=0;for(;s<i;s++){const n=r[s],o=r[s+1];if(n<=e)return s;if(o===e)return s+1;if(n>e&&o<e)return s+Math.log(n/e)/Math.log(n/o)}return s}tileAt(e,r,i,s){const n=this.lodAt(e);if(!n)return null;let o,a;if(typeof r=="number")o=r,a=i;else if(Cr(r.spatialReference,this.spatialReference))o=r.x,a=r.y,s=i;else{const d=i2(r,this.spatialReference);if(d==null)return null;o=d.x,a=d.y,s=i}const l=n.resolution*this.size[0],c=n.resolution*this.size[1];return s??=new jue(0,0,0),s.level=e,s.row=Math.floor((this.origin.y-a)/c+.001),s.col=Math.floor((o-this.origin.x)/l+.001),this.updateTileInfo(s),s}updateTileInfo(e,r=0){if(!("extent"in e))return!1;let i=this.lodAt(e.level);if(!i&&r===1){const a=this.lods[this.lods.length-1];a.level<e.level&&(i=a)}if(!i)return!1;const s=e.level-i.level,n=i.resolution*this.size[0]/2**s,o=i.resolution*this.size[1]/2**s;return e.extent[0]=this.origin.x+e.col*n,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+n,e.extent[3]=e.extent[1]+o,!0}upsampleTile(e){const r=this._upsampleLevels[e.level];return!(!r||r.parentLevel===-1)&&(e.level=r.parentLevel,e.row=Math.floor(e.row/r.factor+.001),e.col=Math.floor(e.col/r.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,r){const i=this.lodAt(r.level);if(i==null)return null;const{resolution:s}=i,n=s*this.size[0],o=s*this.size[1];return e[0]=this.origin.x+r.col*n,e[1]=this.origin.y-(r.row+1)*o,e[2]=e[0]+n,e[3]=e[1]+o,e}lodAt(e){return this._levelToLOD?.[e]??null}clone(){return cp.fromJSON(this.write({}))}getCompatibleForVTL(e){if(this.size[0]!==this.size[1]||this.size[0]===256&&e===512)return null;const r=(this.size[0]===512&&e===256?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===e&&r===0)return this;const i=[],s=this.lods.length-r;for(let n=0;n<s;n++){const o=n+r,{scale:a,resolution:l}=o>=0?this.lods[o]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};i.push(new Yr({level:n,scale:a,resolution:l}))}return new cp({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let r=null;for(let i=0;i<e.length;i++){const s=e[i];this._upsampleLevels[s.level]={parentLevel:r?r.level:-1,factor:r?r.resolution/s.resolution:0},r=s}}},cp=Df,Df);u([h({type:Number,json:{write:!0}})],Ci.prototype,"compressionQuality",void 0),u([h({type:Number,json:{write:!0}})],Ci.prototype,"dpi",void 0),u([h({type:String,json:{read:DO.read,write:DO.write,origins:{"web-scene":{read:!1,write:!1}}}})],Ci.prototype,"format",void 0),u([h({readOnly:!0})],Ci.prototype,"isWrappable",null),u([h({type:de,json:{write:!0}})],Ci.prototype,"origin",void 0),u([X("origin")],Ci.prototype,"readOrigin",null),u([h({type:[Yr],value:null,json:{write:!0}})],Ci.prototype,"lods",null),u([h({readOnly:!0})],Ci.prototype,"scales",void 0),u([h({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],Ci.prototype,"size",void 0),u([X("size",["rows","cols"])],Ci.prototype,"readSize",null),u([te("size",{cols:{type:Ue},rows:{type:Ue}})],Ci.prototype,"writeSize",null),u([h({type:ne,json:{write:!0}})],Ci.prototype,"spatialReference",void 0),Ci=cp=u([E("esri.layers.support.TileInfo")],Ci);let $m=class extends l0{constructor(e){super(e),this.addHandles(this.on("before-add",r=>{r.item!=null&&r.item.parent===this.owner&&(U.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),r.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};$m=u([E("esri.support.AnalysesCollection")],$m);const tb={widthBreakpoint:{getValue(t){const e=t.viewSize[0],r=t.breakpoints,i=this.values;return e<=r.xsmall?i.xsmall:e<=r.small?i.small:e<=r.medium?i.medium:e<=r.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],r=t.breakpoints,i=this.values;return e<=r.xsmall?i.xsmall:e<=r.small?i.small:e<=r.medium?i.medium:e<=r.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,r=e[0],i=e[1],s=this.values;return i>=r?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},Xx={xsmall:544,small:768,medium:992,large:1200};function Vue(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function Kx(t,e){return e?tb[t].valueToClassName[e].split(" "):[]}const Uue=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=Xx}initialize(){this.addHandles(ie(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),ft))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i!==this._get("breakpoints")){if(!Vue(i)){const s=JSON.stringify(Xx,null,2);console.warn("provided breakpoints are not valid, using defaults:"+s),i=Xx}this._set("breakpoints",{...i})}}_updateClassNames(){if(!this.container)return;const i=Di.acquire(),s=Di.acquire();let n,o=!1;for(n in tb){const a=this[n],l=tb[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});a!==l&&(o=!0,this[n]=l,Kx(n,a).forEach(c=>s.push(c)),Kx(n,l).forEach(c=>i.push(c)))}o&&(this._applyClassNameChanges(i,s),Di.release(i),Di.release(s))}_applyClassNameChanges(i,s){const n=this.container;n&&(s.forEach(o=>n.classList.remove(o)),i.forEach(o=>n.classList.add(o)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let s;for(s in tb)Kx(s,this[s]).forEach(n=>i.classList.remove(n))}};return u([h()],r.prototype,"breakpoints",null),u([h()],r.prototype,"orientation",void 0),u([h()],r.prototype,"widthBreakpoint",void 0),u([h()],r.prototype,"heightBreakpoint",void 0),r=u([E("esri.views.BreakpointsOwner")],r),r};function sk(t){return typeof t=="string"?document.getElementById(t):t??null}function zO(t,e){for(;;){const r=t.firstChild;if(!r)break;e.appendChild(r)}}let Bh=class extends le{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(e,r,i={}){return this._installWatch(e,r,i,ie)}addWhen(e,r,i={}){return this._installWatch(e,r,i,Ti)}addOnCollectionChange(e,r,{initial:i=!1,final:s=!1}={}){const n=++this._handleId;return this.addHandles([pn(e,"after-changes",this._createSyncUpdatingCallback(),wa),pn(e,"change",r,{onListenerAdd:i?o=>r({added:o.toArray(),removed:[]}):void 0,onListenerRemove:s?o=>r({added:[],removed:o.toArray()}):void 0})],n),je(()=>this.removeHandles(n))}addPromise(e){if(e==null)return e;const r=++this._handleId;this.addHandles(je(()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this.hasHandles(Ew)||this._set("updating",!1))}),r),this._pendingPromises.add(e),this._set("updating",!0);const i=()=>this.removeHandles(r);return e.then(i,i),e}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(e,r,i={},s){const n=++this._handleId;i.sync||this._installSyncUpdatingWatch(e,n);const o=s(e,r,i);return this.addHandles(o,n),je(()=>this.removeHandles(n))}_installSyncUpdatingWatch(e,r){const i=this._createSyncUpdatingCallback(),s=ie(e,i,{sync:!0,equals:()=>!1});return this.addHandles(s,r),s}_createSyncUpdatingCallback(){return()=>{this.removeHandles(Ew),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(Vm(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(Ew))}),Ew)}}};u([h({readOnly:!0})],Bh.prototype,"updating",void 0),Bh=u([E("esri.core.support.UpdatingHandles")],Bh);const Ew=-42;var H1=function(){return H1=Object.assign||function(e){for(var r,i=1,s=arguments.length;i<s;i++){r=arguments[i];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},H1.apply(this,arguments)},WT={exports:{}},Ut={},ZT={exports:{}},bd={};function Q9(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function Gue(t,e,r){}function que(t,e,r){}var Bue=/javascript\s*\:/img;function Hue(t,e){return Bue.test(e)?"":e}bd.whiteList=Q9();bd.getDefaultWhiteList=Q9;bd.onAttr=Gue;bd.onIgnoreAttr=que;bd.safeAttrValue=Hue;var Wue={indexOf:function(t,e){var r,i;if(Array.prototype.indexOf)return t.indexOf(e);for(r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1},forEach:function(t,e,r){var i,s;if(Array.prototype.forEach)return t.forEach(e,r);for(i=0,s=t.length;i<s;i++)e.call(r,t[i],i,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},Iy=Wue;function Zue(t,e){t=Iy.trimRight(t),t[t.length-1]!==";"&&(t+=";");var r=t.length,i=!1,s=0,n=0,o="";function a(){if(!i){var d=Iy.trim(t.slice(s,n)),p=d.indexOf(":");if(p!==-1){var m=Iy.trim(d.slice(0,p)),y=Iy.trim(d.slice(p+1));if(m){var g=e(s,o.length,m,y,d);g&&(o+=g+"; ")}}}s=n+1}for(;n<r;n++){var l=t[n];if(l==="/"&&t[n+1]==="*"){var c=t.indexOf("*/",n+2);if(c===-1)break;n=c+1,s=n+1,i=!1}else l==="("?i=!0:l===")"?i=!1:l===";"?i||a():l===`
`&&a()}return Iy.trim(o)}var Jue=Zue,Cw=bd,Yue=Jue;function jO(t){return t==null}function Xue(t){var e={};for(var r in t)e[r]=t[r];return e}function eU(t){t=Xue(t||{}),t.whiteList=t.whiteList||Cw.whiteList,t.onAttr=t.onAttr||Cw.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||Cw.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||Cw.safeAttrValue,this.options=t}eU.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,r=e.options,i=r.whiteList,s=r.onAttr,n=r.onIgnoreAttr,o=r.safeAttrValue,a=Yue(t,function(l,c,d,p,m){var y=i[d],g=!1;if(y===!0?g=y:typeof y=="function"?g=y(p):y instanceof RegExp&&(g=y.test(p)),g!==!0&&(g=!1),p=o(d,p),!!p){var v={position:c,sourcePosition:l,source:m,isWhite:g};if(g){var w=s(d,p,v);return jO(w)?d+":"+p:w}else{var w=n(d,p,v);if(!jO(w))return w}}});return a};var Kue=eU;(function(t,e){var r=bd,i=Kue;function s(o,a){var l=new i(a);return l.process(o)}e=t.exports=s,e.FilterCSS=i;for(var n in r)e[n]=r[n]})(ZT,ZT.exports);var nk=ZT.exports,ok={indexOf:function(t,e){var r,i;if(Array.prototype.indexOf)return t.indexOf(e);for(r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1},forEach:function(t,e,r){var i,s;if(Array.prototype.forEach)return t.forEach(e,r);for(i=0,s=t.length;i<s;i++)e.call(r,t[i],i,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,r=e.exec(t);return r?r.index:-1}},Que=nk.FilterCSS,ece=nk.getDefaultWhiteList,W1=ok;function tU(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var rU=new Que;function tce(t,e,r){}function rce(t,e,r){}function ice(t,e,r){}function sce(t,e,r){}function iU(t){return t.replace(oce,"&lt;").replace(ace,"&gt;")}function nce(t,e,r,i){if(r=uU(r),e==="href"||e==="src"){if(r=W1.trim(r),r==="#")return"#";if(!(r.substr(0,7)==="http://"||r.substr(0,8)==="https://"||r.substr(0,7)==="mailto:"||r.substr(0,4)==="tel:"||r.substr(0,11)==="data:image/"||r.substr(0,6)==="ftp://"||r.substr(0,2)==="./"||r.substr(0,3)==="../"||r[0]==="#"||r[0]==="/"))return""}else if(e==="background"){if(Pw.lastIndex=0,Pw.test(r))return""}else if(e==="style"){if(VO.lastIndex=0,VO.test(r)||(UO.lastIndex=0,UO.test(r)&&(Pw.lastIndex=0,Pw.test(r))))return"";i!==!1&&(i=i||rU,r=i.process(r))}return r=cU(r),r}var oce=/</g,ace=/>/g,lce=/"/g,uce=/&quot;/g,cce=/&#([a-zA-Z0-9]*);?/gim,hce=/&colon;?/gim,dce=/&newline;?/gim,Pw=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,VO=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,UO=/u\s*r\s*l\s*\(.*/gi;function sU(t){return t.replace(lce,"&quot;")}function nU(t){return t.replace(uce,'"')}function oU(t){return t.replace(cce,function(r,i){return i[0]==="x"||i[0]==="X"?String.fromCharCode(parseInt(i.substr(1),16)):String.fromCharCode(parseInt(i,10))})}function aU(t){return t.replace(hce,":").replace(dce," ")}function lU(t){for(var e="",r=0,i=t.length;r<i;r++)e+=t.charCodeAt(r)<32?" ":t.charAt(r);return W1.trim(e)}function uU(t){return t=nU(t),t=oU(t),t=aU(t),t=lU(t),t}function cU(t){return t=sU(t),t=iU(t),t}function pce(){return""}function fce(t,e){typeof e!="function"&&(e=function(){});var r=!Array.isArray(t);function i(o){return r?!0:W1.indexOf(t,o)!==-1}var s=[],n=!1;return{onIgnoreTag:function(o,a,l){if(i(o))if(l.isClosing){var c="[/removed]",d=l.position+c.length;return s.push([n!==!1?n:l.position,d]),n=!1,c}else return n||(n=l.position),"[removed]";else return e(o,a,l)},remove:function(o){var a="",l=0;return W1.forEach(s,function(c){a+=o.slice(l,c[0]),l=c[1]}),a+=o.slice(l),a}}}function mce(t){for(var e="",r=0;r<t.length;){var i=t.indexOf("<!--",r);if(i===-1){e+=t.slice(r);break}e+=t.slice(r,i);var s=t.indexOf("-->",i);if(s===-1)break;r=s+3}return e}function yce(t){var e=t.split("");return e=e.filter(function(r){var i=r.charCodeAt(0);return i===127?!1:i<=31?i===10||i===13:!0}),e.join("")}Ut.whiteList=tU();Ut.getDefaultWhiteList=tU;Ut.onTag=tce;Ut.onIgnoreTag=rce;Ut.onTagAttr=ice;Ut.onIgnoreTagAttr=sce;Ut.safeAttrValue=nce;Ut.escapeHtml=iU;Ut.escapeQuote=sU;Ut.unescapeQuote=nU;Ut.escapeHtmlEntities=oU;Ut.escapeDangerHtml5Entities=aU;Ut.clearNonPrintableCharacter=lU;Ut.friendlyAttrValue=uU;Ut.escapeAttrValue=cU;Ut.onIgnoreTagStripAll=pce;Ut.StripTagBody=fce;Ut.stripCommentTag=mce;Ut.stripBlankChar=yce;Ut.cssFilter=rU;Ut.getDefaultCSSWhiteList=ece;var T2={},$u=ok;function gce(t){var e=$u.spaceIndex(t),r;return e===-1?r=t.slice(1,-1):r=t.slice(1,e+1),r=$u.trim(r).toLowerCase(),r.slice(0,1)==="/"&&(r=r.slice(1)),r.slice(-1)==="/"&&(r=r.slice(0,-1)),r}function vce(t){return t.slice(0,2)==="</"}function wce(t,e,r){var i="",s=0,n=!1,o=!1,a=0,l=t.length,c="",d="";e:for(a=0;a<l;a++){var p=t.charAt(a);if(n===!1){if(p==="<"){n=a;continue}}else if(o===!1){if(p==="<"){i+=r(t.slice(s,a)),n=a,s=a;continue}if(p===">"){i+=r(t.slice(s,n)),d=t.slice(n,a+1),c=gce(d),i+=e(n,i.length,c,d,vce(d)),s=a+1,n=!1;continue}if(p==='"'||p==="'")for(var m=1,y=t.charAt(a-m);y.trim()===""||y==="=";){if(y==="="){o=p;continue e}y=t.charAt(a-++m)}}else if(p===o){o=!1;continue}}return s<t.length&&(i+=r(t.substr(s))),i}var _ce=/[^a-zA-Z0-9\\_:.-]/gim;function bce(t,e){var r=0,i=0,s=[],n=!1,o=t.length;function a(m,y){if(m=$u.trim(m),m=m.replace(_ce,"").toLowerCase(),!(m.length<1)){var g=e(m,y||"");g&&s.push(g)}}for(var l=0;l<o;l++){var c=t.charAt(l),d,p;if(n===!1&&c==="="){n=t.slice(r,l),r=l+1,i=t.charAt(r)==='"'||t.charAt(r)==="'"?r:xce(t,l+1);continue}if(n!==!1&&l===i){if(p=t.indexOf(c,l+1),p===-1)break;d=$u.trim(t.slice(i+1,p)),a(n,d),n=!1,l=p,r=l+1;continue}if(/\s|\n|\t/.test(c))if(t=t.replace(/\s|\n|\t/g," "),n===!1)if(p=Sce(t,l),p===-1){d=$u.trim(t.slice(r,l)),a(d),n=!1,r=l+1;continue}else{l=p-1;continue}else if(p=$ce(t,l-1),p===-1){d=$u.trim(t.slice(r,l)),d=GO(d),a(n,d),n=!1,r=l+1;continue}else continue}return r<t.length&&(n===!1?a(t.slice(r)):a(n,GO($u.trim(t.slice(r))))),$u.trim(s.join(" "))}function Sce(t,e){for(;e<t.length;e++){var r=t[e];if(r!==" ")return r==="="?e:-1}}function xce(t,e){for(;e<t.length;e++){var r=t[e];if(r!==" ")return r==="'"||r==='"'?e:-1}}function $ce(t,e){for(;e>0;e--){var r=t[e];if(r!==" ")return r==="="?e:-1}}function Mce(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function GO(t){return Mce(t)?t.substr(1,t.length-2):t}T2.parseTag=wce;T2.parseAttr=bce;var Tce=nk.FilterCSS,zn=Ut,hU=T2,Ice=hU.parseTag,Ece=hU.parseAttr,rb=ok;function kw(t){return t==null}function Cce(t){var e=rb.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=rb.trim(t.slice(e+1,-1));var r=t[t.length-1]==="/";return r&&(t=rb.trim(t.slice(0,-1))),{html:t,closing:r}}function Pce(t){var e={};for(var r in t)e[r]=t[r];return e}function kce(t){var e={};for(var r in t)Array.isArray(t[r])?e[r.toLowerCase()]=t[r].map(function(i){return i.toLowerCase()}):e[r.toLowerCase()]=t[r];return e}function dU(t){t=Pce(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=zn.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=kce(t.whiteList||t.allowList):t.whiteList=zn.whiteList,t.onTag=t.onTag||zn.onTag,t.onTagAttr=t.onTagAttr||zn.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||zn.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||zn.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||zn.safeAttrValue,t.escapeHtml=t.escapeHtml||zn.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new Tce(t.css))}dU.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,r=e.options,i=r.whiteList,s=r.onTag,n=r.onIgnoreTag,o=r.onTagAttr,a=r.onIgnoreTagAttr,l=r.safeAttrValue,c=r.escapeHtml,d=e.cssFilter;r.stripBlankChar&&(t=zn.stripBlankChar(t)),r.allowCommentTag||(t=zn.stripCommentTag(t));var p=!1;r.stripIgnoreTagBody&&(p=zn.StripTagBody(r.stripIgnoreTagBody,n),n=p.onIgnoreTag);var m=Ice(t,function(y,g,v,w,_){var x={sourcePosition:y,position:g,isClosing:_,isWhite:Object.prototype.hasOwnProperty.call(i,v)},$=s(v,w,x);if(!kw($))return $;if(x.isWhite){if(x.isClosing)return"</"+v+">";var T=Cce(w),C=i[v],P=Ece(T.html,function(A,F){var j=rb.indexOf(C,A)!==-1,V=o(v,A,F,j);return kw(V)?j?(F=l(v,A,F,d),F?A+'="'+F+'"':A):(V=a(v,A,F,j),kw(V)?void 0:V):V});return w="<"+v,P&&(w+=" "+P),T.closing&&(w+=" /"),w+=">",w}else return $=n(v,w,x),kw($)?c(w):$},c);return p&&(m=p.remove(m)),m};var Lce=dU;(function(t,e){var r=Ut,i=T2,s=Lce;function n(a,l){var c=new s(l);return c.process(a)}e=t.exports=n,e.filterXSS=n,e.FilterXSS=s,(function(){for(var a in r)e[a]=r[a];for(var l in i)e[l]=i[l]})();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=t.exports)})(WT,WT.exports);var Nd=WT.exports,Ace=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},pU=(function(){function t(e,r){var i=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=H1(H1({},Nd.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(n,o,a,l){return n==="a"&&o==="href"||(n==="img"||n==="source")&&o==="src"?i.sanitizeUrl(a):Nd.safeAttrValue(n,o,a,l)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var s;e&&!r?s=e:e&&r?(s=Object.create(this.arcgisFilterOptions),s.css={whiteList:this.arcgisCSSWhiteList},Object.keys(e).forEach(function(n){if(n==="whiteList")s.whiteList=i._extendObjectOfArrays([i.arcgisWhiteList,e.whiteList||{}]);else if(n==="css"){var o=e.css.whiteList;o!=null&&e.css instanceof Object&&Object.keys(o).forEach(function(a){return s.css.whiteList[a]=o[a]})}else s[n]=e[n]})):(s=Object.create(this.arcgisFilterOptions),s.whiteList=this.arcgisWhiteList,s.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=s,this._xssFilter=new Nd.FilterXSS(s)}return t.prototype.sanitize=function(e,r){switch(r===void 0&&(r={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,r);default:return r.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,r){var i=(r??{}).isProtocolRequired,s=i===void 0?!0:i,n=this._trim(e.substring(0,e.indexOf(":"))),o=e==="/",a=/^#/.test(e),l=n&&this.allowedProtocols.indexOf(n.toLowerCase())>-1;return o||a||l?Nd.escapeAttrValue(e):!n&&!s?Nd.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,r,i,s){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,r,i,s):Nd.safeAttrValue(e,r,i,s)},t.prototype.validate=function(e,r){r===void 0&&(r={});var i=this.sanitize(e,r);return{isValid:e===i,sanitized:i}},t.prototype.encodeHTML=function(e){var r=this;return String(e).replace(/[&<>"'\/]/g,function(i){return r._entityMap[i]})},t.prototype.encodeAttrValue=function(e){var r=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(i,s){return r.test(i)?i:"&#x".concat(Number(e.charCodeAt(s)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var r={};return e.forEach(function(i){Object.keys(i).forEach(function(s){Array.isArray(i[s])&&Array.isArray(r[s])?r[s]=r[s].concat(i[s]):r[s]=i[s]})}),r},t.prototype._iterateOverObject=function(e,r){var i=this;r===void 0&&(r={});try{var s=!1,n=void 0;if(Array.isArray(e))n=e.reduce(function(a,l){var c=i.validate(l,r);return c.isValid?a.concat([l]):(s=!0,a.concat([c.sanitized]))},[]);else if(Ace(e)){var o=Object.keys(e);n=o.reduce(function(a,l){var c=e[l],d=i.validate(c,r);return d.isValid?a[l]=c:(s=!0,a[l]=d.sanitized),a},{})}else return r.allowUndefined&&typeof e>"u"?void 0:null;return s?n:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t})();const Rce=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],Oce=Rce.reduce((t,e)=>(t[e]=[],t),{}),Fce=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],fU=new pU({whiteList:Oce,onTagAttr:(t,e,r)=>{const i=`${e}="${r}"`;if(Fce.includes(e))return i},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0),Nce=new pU({whiteList:{br:[]},stripIgnoreTag:!0,escapeHtml:t=>t},!1),mU="http://www.w3.org/",I2=`${mU}2000/svg`,yU=`${mU}1999/xlink`;let qO=[],ak=(t,e)=>{let r={};return Object.keys(t).forEach(i=>{r[i]=t[i]}),e&&Object.keys(e).forEach(i=>{r[i]=e[i]}),r},lk=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),gU=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},Dce=(t,e,r)=>{if(e.vnodeSelector!==""){for(let i=r;i<t.length;i++)if(lk(t[i],e))return i}return-1},Qx=(t,e,r,i)=>{let s=t[e];if(s.vnodeSelector==="")return;let n=s.properties;if(!(n&&(n.key===void 0?n.bind:n.key))){for(let o=0;o<t.length;o++)if(o!==e){let a=t[o];if(lk(a,s))throw new Error(`${r.vnodeSelector} had a ${s.vnodeSelector} child ${i==="added"?i:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},zce=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},JT=[],YT=!1,vU=t=>{(t.children||[]).forEach(vU),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},BO=()=>{YT=!1,JT.forEach(vU),JT.length=0},HO=t=>{JT.push(t),YT||(YT=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(BO,{timeout:16}):setTimeout(BO,16))},WO=t=>{let e=t.domNode;if(t.properties){let r=t.properties.exitAnimation;if(r)return e.style.pointerEvents="none",void r(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),HO(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),HO(t))},jce=(t,e,r)=>{if(!e)return;let i=r.eventHandlerInterceptor,s=Object.keys(e),n=s.length;for(let o=0;o<n;o++){let a=s[o],l=e[a];if(a==="className")throw new Error('Property "className" is not supported, use "class".');if(a==="class")KT(t,l,!0);else if(a==="classes"){let c=Object.keys(l),d=c.length;for(let p=0;p<d;p++){let m=c[p];l[m]&&t.classList.add(m)}}else if(a==="styles"){let c=Object.keys(l),d=c.length;for(let p=0;p<d;p++){let m=c[p],y=l[m];y&&(gU(y),r.styleApplyer(t,m,y))}}else if(a!=="key"&&l!=null){let c=typeof l;c==="function"?(a.lastIndexOf("on",0)===0&&(i&&(l=i(a,l,t,e)),a==="oninput"&&(function(){let d=l;l=function(p){d.apply(this,[p]),p.target["oninput-value"]=p.target.value}})()),t[a]=l):r.namespace===I2?a==="href"?t.setAttributeNS(yU,a,l):t.setAttribute(a,l):c==="string"&&a!=="value"?a==="innerHTML"?t[a]=fU.sanitize(l):XT(t)&&a in t?t[a]=l:t.setAttribute(a,l):t[a]=l}}};function XT(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let Z1,Vce=(t,e,r)=>{if(e)for(let i of e)u0(i,t,void 0,r)},wU=(t,e,r)=>{Vce(t,e.children,r),e.text&&(t.textContent=e.text),jce(t,e.properties,r),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,r,e.vnodeSelector,e.properties,e.children])},u0=(t,e,r,i)=>{let s,n=0,o=t.vnodeSelector,a=e.ownerDocument;if(o==="")s=t.domNode=a.createTextNode(t.text),r!==void 0?e.insertBefore(s,r):e.appendChild(s);else{for(let l=0;l<=o.length;++l){let c=o.charAt(l);if(l===o.length||c==="."||c==="#"){let d=o.charAt(n-1),p=o.slice(n,l);d==="."?s.classList.add(p):d==="#"?s.id=p:(p==="svg"&&(i=ak(i,{namespace:I2})),i.namespace!==void 0?s=t.domNode=a.createElementNS(i.namespace,p):(s=t.domNode=t.domNode||a.createElement(p),p==="input"&&t.properties&&t.properties.type!==void 0&&s.setAttribute("type",t.properties.type)),r!==void 0?e.insertBefore(s,r):s.parentNode!==e&&e.appendChild(s)),n=l+1}}wU(s,t,i)}},KT=(t,e,r)=>{e&&e.split(" ").forEach(i=>{i&&t.classList.toggle(i,r)})},Uce=(t,e,r,i)=>{if(!r)return;let s=!1,n=Object.keys(r),o=n.length;for(let a=0;a<o;a++){let l=n[a],c=r[l],d=e[l];if(l==="class")d!==c&&(KT(t,d,!1),KT(t,c,!0));else if(l==="classes"){let p=t.classList,m=Object.keys(c),y=m.length;for(let g=0;g<y;g++){let v=m[g],w=!!c[v];w!==!!d[v]&&(s=!0,w?p.add(v):p.remove(v))}}else if(l==="styles"){let p=Object.keys(c),m=p.length;for(let y=0;y<m;y++){let g=p[y],v=c[g];v!==d[g]&&(s=!0,v?(gU(v),i.styleApplyer(t,g,v)):i.styleApplyer(t,g,""))}}else if(c||typeof d!="string"||(c=""),l!=="value"||XT(t)){if(c!==d){let p=typeof c;p==="function"&&i.eventHandlerInterceptor||(i.namespace===I2?l==="href"?t.setAttributeNS(yU,l,c):t.setAttribute(l,c):p==="string"?l==="innerHTML"?t[l]=fU.sanitize(c):l==="role"&&c===""?t.removeAttribute(l):XT(t)&&l in t?t[l]=c:t.setAttribute(l,c):t[l]!==c&&(t[l]=c),s=!0)}}else{let p=t[l];p!==c&&(t["oninput-value"]?p===t["oninput-value"]:c!==d)&&(t[l]=c,t["oninput-value"]=void 0),c!==d&&(s=!0)}}return s},Gce=(t,e,r,i,s)=>{if(r===i)return!1;i=i||qO;let n,o=(r=r||qO).length,a=i.length,l=0,c=0,d=!1;for(;c<a;){let p=l<o?r[l]:void 0,m=i[c];if(p!==void 0&&lk(p,m))d=Z1(p,m,s)||d,l++;else{let y=Dce(r,m,l+1);if(y>=0){for(n=l;n<y;n++)WO(r[n]),Qx(r,n,t,"removed");d=Z1(r[y],m,s)||d,l=y+1}else u0(m,e,l<o?r[l].domNode:void 0,s),zce(m),Qx(i,c,t,"added")}c++}if(o>l)for(n=l;n<o;n++)WO(r[n]),Qx(r,n,t,"removed");return d};Z1=(t,e,r)=>{let i=t.domNode,s=!1;if(t===e)return!1;let n=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let o=i.ownerDocument.createTextNode(e.text);return i.parentNode.replaceChild(o,i),e.domNode=o,s=!0,s}e.domNode=i}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(r=ak(r,{namespace:I2})),t.text!==e.text&&(n=!0,e.text===void 0?i.removeChild(i.firstChild):i.textContent=e.text),e.domNode=i,n=Gce(e,i,t.children,e.children,r)||n,n=Uce(i,t.properties,e.properties,r)||n,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[i,r,e.vnodeSelector,e.properties,e.children]);return n&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(i,e.properties,t.properties),s};let Lw=(t,e)=>({getLastRender:()=>t,update:r=>{if(t.vnodeSelector!==r.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let i=t;t=r,Z1(i,r,e)},domNode:t.domNode});const qce={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,r)=>{e.charAt(0)==="-"?t.style.setProperty(e,r):t.style[e]=r}};let ng=t=>ak(qce,t),zu={append:(t,e,r)=>(r=ng(r),u0(e,t,void 0,r),Lw(e,r)),insertBefore:(t,e,r)=>(r=ng(r),u0(e,t.parentNode,t,r),Lw(e,r)),merge:(t,e,r)=>(r=ng(r),e.domNode=t,wU(t,e,r),Lw(e,r)),replace:(t,e,r)=>(r=ng(r),u0(e,t.parentNode,t,r),t.parentNode.removeChild(t),Lw(e,r))},_U,Bce=(t,e)=>{let r=[];for(;t&&t!==e;)r.push(t),t=t.parentNode;return r};_U=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let Hce=(t,e)=>{let r=t;return e.forEach(i=>{r=r&&r.children?_U(r.children,s=>s.domNode===i):void 0}),r},Wce=(t,e,r)=>{let i=function(s){r("domEvent",s);let n=e(),o=Bce(s.currentTarget,n.domNode);o.reverse();let a,l=Hce(n.getLastRender(),o);return t.scheduleRender(),l&&(a=l.properties[`on${s.type}`].apply(l.properties.bind||this,arguments)),r("domEventProcessed",s),a};return(s,n,o,a)=>i},J1=t=>{let e,r,i=ng(t),s=i.performanceLogger,n=!0,o=!1,a=[],l=[],c=(p,m,y)=>{let g,v=()=>g;i.eventHandlerInterceptor=Wce(e,v,s),g=p(m,y(),i),a.push(g),l.push(y)},d=()=>{if(r=void 0,n){n=!1,s("renderStart",void 0);for(let p=0;p<a.length;p++){let m=l[p]();s("rendered",void 0),a[p].update(m),s("patched",void 0)}s("renderDone",void 0),n=!0}};return e={renderNow:d,scheduleRender:()=>{r||o||(r=requestAnimationFrame(d))},stop:()=>{r&&(cancelAnimationFrame(r),r=void 0),o=!0},resume:()=>{o=!1,n=!0,e.scheduleRender()},append:(p,m)=>{c(zu.append,p,m)},insertBefore:(p,m)=>{c(zu.insertBefore,p,m)},merge:(p,m)=>{c(zu.merge,p,m)},replace:(p,m)=>{c(zu.replace,p,m)},detach:p=>{for(let m=0;m<l.length;m++)if(l[m]===p)return l.splice(m,1),a.splice(m,1)[0];throw new Error("renderFunction was not found")}},e},au=class extends le{constructor(){super(...arguments),this.items=new se,this._watchUpdatingTracking=new Bh,this._callbacks=new Map,this._projector=J1(),this._hiddenProjector=J1()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,r=>{for(const i of r.added){const s=()=>i.render();this._callbacks.set(i,s),this._projector.append(this.surface,s)}for(const i of r.removed){const s=this._projector.detach(this._callbacks.get(i));this.surface.removeChild(s.domNode),this._callbacks.delete(i)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const r=this._hiddenSurface,i=this._hiddenProjector;let s;const n=()=>(s=e.render(),s);i.append(r,n),i.renderNow();const o={left:0,top:0,right:0,bottom:0};if(s?.domNode){const a=s.domNode.getBoundingClientRect();o.left=a.left,o.top=a.top,o.right=a.right,o.bottom=a.bottom}for(i.detach(n);r.firstChild;)r.removeChild(r.firstChild);return o}overlaps(e,r){const i=this.computeBoundingRect(e),s=this.computeBoundingRect(r);return Math.max(i.left,s.left)<=Math.min(i.right,s.right)&&Math.max(i.top,s.top)<=Math.min(i.bottom,s.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,r){const i=!!r?.disableDecorations;if(!this.items.some(n=>n.visible&&!(i&&n.isDecoration)))return;const s=e.getContext("2d");s.save(),s.font=this._fontString(),this.items.forEach(n=>{i&&n.isDecoration||(s.save(),n.renderCanvas(s),s.restore())}),s.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};u([h({readOnly:!0})],au.prototype,"surface",void 0),u([h({readOnly:!0})],au.prototype,"items",void 0),u([h({readOnly:!0})],au.prototype,"needsRender",null),u([h({readOnly:!0})],au.prototype,"_watchUpdatingTracking",void 0),u([h({readOnly:!0})],au.prototype,"updating",null),au=u([E("esri.views.overlay.ViewOverlay")],au);const ZO=au,e$=[0,0];function Zce(t){const e=(t.ownerDocument||window.document).defaultView,r=t.getBoundingClientRect();return e$[0]=r.left+(e?.pageXOffset??0),e$[1]=r.top+(e?.pageYOffset??0),e$}function JO(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function Jce(t){const e=document.createElement("div");return t.appendChild(e),e}const Dd=16,Ey=750,Yce=512,Xce=2,Kce=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this._freqInfo={freq:Dd,time:Ey},this._overlayRenderTaskHandle=null,this.aria={},this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([ie(()=>this.cursor,s=>{const{surface:n}=this;n&&n.setAttribute("data-cursor",s)}),ie(()=>this.navigating,s=>{const{surface:n}=this;n&&n.setAttribute("data-navigating",s.toString())}),ie(()=>[this.aria,this.surface],()=>this._updateAria(),{initial:!0})])}initialize(){const i=this;this.addHandles([ie(()=>this.ui,(s,n)=>this._handleUIChange(s,n),ft),i.on("focus",()=>this.notifyChange("focused")),i.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui?.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(i){const s=this._get("container"),n=sk(i);if(n||typeof i!="string"||U.getLogger(this).error("#container",`element with id '${i}' not found`),s===n)return;if(this._stopMeasuring(),s&&(s.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(JO(this.root),this._set("root",null)),this.userContent&&(zO(this.userContent,s),JO(this.userContent),this._set("userContent",null))),!n)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);n.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",zO(n,o),n.appendChild(o),this._set("userContent",o);const a=document.createElement("div");a.className="esri-view-root",n.insertBefore(a,n.firstChild),this._set("root",a);const l=document.createElement("div");l.className="esri-view-surface",l.setAttribute("role","application"),l.tabIndex=0,a.appendChild(l),this._set("surface",l);const c=new ZO;a.appendChild(c.surface),this._set("overlay",c),this.addHandles(ie(()=>c.needsRender,d=>{d&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=pm({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=yt(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",n),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}set ui(i){const s=this._get("ui");s!==i&&s?.destroy(),this._set("ui",i)}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(i,s,n){const o=this.position;return i-=o?o[0]:0,s-=o?o[1]:0,n?(n[0]=i,n[1]=s):n=[i,s],n}containerToPage(i,s,n){const o=this.position;return i+=o?o[0]:0,s+=o?o[1]:0,n?(n[0]=i,n[1]=s):n=[i,s],n}_updateAria(){const{surface:i,aria:s}=this;i&&(i.ariaLabelledByElements=s?.labelledByElements??null,i.ariaDescribedByElements=s?.describedByElements??null,i.ariaLabel=s?.label??null,i.ariaDescription=s?.description??null)}_handleUIChange(i,s){this.removeHandles("ui"),s&&s!==i&&s.destroy(),i&&(i.view=this,this.addHandles(ie(()=>this.root,n=>{i.container=n?Jce(n):null},ft),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=Dd,i.time=Ey;const s=pm({prepare:a=>{const l=this._measure(),c=this._freqInfo;if(c.time+=a.deltaTime,l&&(c.freq=Dd,this._get("resizing")||this._set("resizing",!0)),c.time<c.freq)return;c.time=0;const d=this._position();c.freq=d||l?Dd:Math.min(Ey,c.freq*Xce),!l&&c.freq>=Yce&&(s.pause(),this._get("resizing")&&this._set("resizing",!1))}}),n=new ResizeObserver(a=>{i.freq=Dd,i.time=Ey,s.resume()});this.container!=null&&n.observe(this.container);const o=je(()=>n.disconnect());this.addHandles([Dm(window,"resize",()=>{i.freq=Dd,i.time=Ey,s.resume()}),o,s],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,s=i?i.clientWidth:0,n=i?i.clientHeight:0;if(s===0||n===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,a=this.height;return s===o&&n===a?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",s),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:a,width:s,height:n}),!0)}_position(){const i=this.container,s=this.position,n=i&&Zce(i);return!!n&&(!s||n[0]!==s[0]||n[1]!==s[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return u([h()],r.prototype,"aria",void 0),u([h()],r.prototype,"container",null),u([h({readOnly:!0})],r.prototype,"focused",null),u([h({readOnly:!0})],r.prototype,"height",void 0),u([h()],r.prototype,"messagesCommon",void 0),u([h({type:ZO})],r.prototype,"overlay",void 0),u([h({readOnly:!0})],r.prototype,"position",void 0),u([h({readOnly:!0})],r.prototype,"resizing",void 0),u([h({readOnly:!0})],r.prototype,"root",void 0),u([h({value:null,readOnly:!0})],r.prototype,"size",null),u([h({readOnly:!0})],r.prototype,"surface",void 0),u([h({readOnly:!0})],r.prototype,"suspended",void 0),u([h({nonNullable:!0})],r.prototype,"ui",null),u([h({readOnly:!0})],r.prototype,"userContent",void 0),u([h({readOnly:!0})],r.prototype,"width",void 0),u([h()],r.prototype,"widthBreakpoint",void 0),r=u([E("esri.views.DOMContainer")],r),r},Aw="popup",YO="manual";function QT(t){const{popupElement:e,popup:r}=t||{};return e??r??null}function ca(t){return t!=null&&"open"in t&&"declaredClass"in t}function Pl(t){return!!t&&t.tagName.toLowerCase()==="arcgis-popup"&&"open"in t}function Qce(t,e,r){const[i,s,n]=e;if(r){const[o,a,l]=r;o&&ca(a)&&(a.view=null,o.remove(a,Aw),a!==s&&s&&a.destroy()),o&&l&&Pl(l)&&(l.view=null,o.remove(l,Aw),l!==n&&n&&l.remove())}i&&ca(s)&&(s.view=t,i.add(s,{key:Aw,position:YO,internal:!0})),i&&n&&Pl(n)&&(n.view=t,i.add(n,{key:Aw,position:YO,internal:!0}))}async function ehe(t,e){const{popup:r,popupElement:i}=t;ca(r)?await Rw(r,null,e):i&&Pl(i)?await Rw(null,i,e):e?.defer(async()=>{await t.setupPopup();const{popup:s,popupElement:n}=t;ca(s)&&!t.destroyed&&t.ready&&t.popupEnabled?await Rw(s,null,e):n&&Pl(n)&&await Rw(null,n,e)})}function the(t,e){const{popup:r,popupElement:i}=t;if(ca(r))return r.open(e);i&&Pl(i)&&i.open(e)}function bU(t,e){ca(t)&&t.close(),e&&Pl(e)&&(e.visible=!1)}async function Rw(t,e,r){if(ca(t)){const i=await t.viewModel.handleViewClick(r);return void(i?.promises?.length?t.open(i):t.visible&&t.close())}if(e&&Pl(e)){const i=await e.handleViewClick(r);i?.promises?.length?e.open(i):e.visible&&(e.visible=!1)}}const SU=z("mac")?"Meta":"Control",rhe=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),ihe=t=>rhe.has(t);let she=class{constructor(e,r=[]){this.eventType=e,this.keyModifiers=r}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const r=e.modifiers;for(const i of this.keyModifiers)if(!r.has(i))return!1;return!0}},Pr=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const r=this._incoming[e];for(const i of r)this._incomingEventMatches.push(i.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback(r=>this._handleEvent(r)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,r,i){let s;typeof r=="function"?(i=r,s=[]):s=r||[];const n=typeof e=="string"?new she(e,s):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},a=d=>{const p=this._incoming[d.match.eventType];if(p){const m=p.indexOf(d);p.splice(m,1),o(),this._manager&&this._manager.updateDependencies()}},l=new nhe(n,i,{onPause:a,onRemove:a,onResume:d=>{const p=this._incoming[d.match.eventType];p&&!p.includes(d)&&(p.push(d),o(),this._manager&&this._manager.updateDependencies())}});let c=this._incoming[n.eventType];return c||(c=[],this._incoming[n.eventType]=c),c.push(l),o(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const r=new ohe(e,{onEmit:(i,s,n,o)=>{this._manager?.emit(i.eventType,s,n,o)},onRemove:i=>{delete this._outgoing[i.eventType],this._manager?.updateDependencies()}});return this._outgoing[e]=r,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),r}startCapturingPointer(e){this._manager?.setPointerCapture(e,!0)}stopCapturingPointer(e){this._manager?.setPointerCapture(e,!1)}refreshHasPendingInputs(){this._manager?.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){const r=this._incoming[e.type];if(r){for(const i of r)if(i.match.matches(e)&&(i.callback?.(e),e.shouldStopPropagation()))break}}},nhe=class{constructor(e,r,i){this.match=e,this._callback=r,this._handler=i}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},ohe=class{constructor(e,r){this.eventType=e,this._removed=!1,this._handler=r}emit(e,r,i){this._removed||this._handler.onEmit(this,e,r,i)}remove(){this._removed=!0,this._handler.onRemove(this)}},ahe=class extends Pr{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this._id=null,this.registerIncoming("pointer-move",r=>this._update(r.data))}_update(e){const r=e.native.pointerType==="touch"?"touch":"mouse",{x:i,y:s,native:{pointerId:n}}=e;r===this._value&&this._x===i&&this._y===s&&this._id===n||(this._value=r,this._x=i,this._y=s,this._id=n,this._onChange(n,r,i,s))}},lhe=class{constructor(e,r){this._observable=new Ev,this._value=e,this._equalityFunction=r}get value(){return _e(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function Mm(t,e=pz){return new lhe(t,e)}let uhe=class extends Pr{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=Mm(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},che=class{constructor(e,r){this._owner=r,this._properties={},this._afterDispatchHandle=null;for(const i in e){const s=e[i],n=new c6(s,void 0,void 0,2,2);this._properties[i]={pool:n,acquired:[]}}this._afterDispatchHandle=dQ(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const r=this._properties[e];for(const i of r.acquired)VA(i)||r.pool.release(i);r.pool.destroy(),r.pool=null,r.acquired=null}this._properties=null,this._owner=null}get(e){const r=this._owner._get(e),i=this._properties[e];let s=i.pool.acquire();for(i.acquired.push(s);s===r;)s=i.pool.acquire(),i.acquired.push(s);return x6(),s}_release(){for(const e in this._properties){const r=this._properties[e];let i=0;for(const s of r.acquired)VA(s)?r.acquired[i++]=s:r.pool.release(s);r.acquired.length=i}}},hhe=class{constructor(){this.id=0,this.type="mouse",this.location=Tr()}},Pn=class extends le{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=SU,this._propertiesPool=new che({latestPointerInfo:()=>new hhe},this),this._latestPointerInfo=void 0,this._paused=!1,this._testTimestamp=void 0}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const r of e)this.uninstallHandlers(r);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get latestPointerInfo(){return this._latestPointerInfo}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,r,i=xl.INTERNAL){if(this._nameToGroup[e]||r.length===0)return;const s={name:e,handlers:r.map(n=>({handler:n,active:!0,removed:!1,priorityIndex:0,groupPriority:i,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=s;for(let n=s.handlers.length-1;n>=0;n--){const o=s.handlers[n];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(a,l,c,d,p)=>{this._emitInputEvent(o.priorityIndex+1,a,l,c,p,d)},setPointerCapture:(a,l)=>{this._setPointerCapture(s,o,a,l)},setEventCallback:a=>{o.eventCallback=a},setUninstallCallback:a=>{o.uninstallCallback=a},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const r=this._nameToGroup[e];r?(r.handlers.forEach(i=>{i.removed=!0,i.uninstallCallback?.()}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):U.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,r=new Set;this._handlersPriority=[];for(let i=this._handlers.length-1;i>=0;i--){const s=this._handlers[i];s.priorityIndex=i,this._handlersPriority.push(s)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let i=this._handlersPriority.length-1;i>=0;i--){const s=this._handlersPriority[i];s.priorityIndex=i;let n=s.handler.hasSideEffects;if(!n){for(const o of s.handler.outgoingEventTypes)if(e.has(o)){n=!0;break}}if(n)for(const o of s.handler.incomingEventMatches){e.add(o.eventType);for(const a of o.keyModifiers)ihe(a)||r.add(a)}s.active=n}this._sourceEvents=e,this._keyModifiers=r,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,r,i,s){const n=this._latestPointerInfo;if(n==null||n.id!==e||n.type!==r||n.location.x!==i||n.location.y!==s){const o=this._propertiesPool.get("latestPointerInfo");o.id=e,o.type=r,o.location.x=i,o.location.y=s,this._latestPointerInfo=o}}_onEventReceived(e,r){if(e==="pointer-capture-lost"){const n=r;this._pointerCaptures.delete(n.native.pointerId)}this._updateKeyModifiers(e,r);const i=this._testTimestamp??r.native?.timestamp,s=r.native?.cancelable;this._emitInputEventFromSource(e,r,i,s)}_updateKeyModifiers(e,r){if(!r)return;let i=!1;const s=()=>{i||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),i=!0)},n=(a,l)=>{l&&!this._activeKeyModifiers.has(a)?(s(),this._activeKeyModifiers.add(a)):!l&&this._activeKeyModifiers.has(a)&&(s(),this._activeKeyModifiers.delete(a))};if(e==="key-down"||e==="key-up"){const a=r.key;this._keyModifiers.has(a)&&n(a,e==="key-down")}const o=r.native;n("Alt",!!o?.altKey),n("Control",!!o?.ctrlKey),n("Ctrl",!!o?.ctrlKey),n("Shift",!!o?.shiftKey),n("Meta",!!o?.metaKey),n("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new ahe((e,r,i,s)=>this._setLatestPointer(e,r,i,s)),this._multiTouchHandler=new uhe,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],xl.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,xl.INTERNAL)}_setPointerCapture(e,r,i,s){const n=e.name+"-"+r.priorityIndex,o=this._pointerCaptures.get(i.pointerId)||new Set;this._pointerCaptures.set(i.pointerId,o),s?(o.add(n),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(i,!0)):o.has(n)&&(o.delete(n),o.size===0&&(this._pointerCaptures.delete(i.pointerId),this.eventSource&&this.eventSource.setPointerCapture(i,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,r,i,s){this._emitInputEvent(0,e,r,i,s)}_emitInputEvent(e,r,i,s,n,o){const a=s??this._currentPropagation?.timestamp??performance.now(),l=n??!1,c={event:new dhe(r,i,a,o||this._activeKeyModifiers,l),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(c):this._doNewPropagation(c)}_doNewPropagation(e){this._currentPropagation={events:new J0,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:r,priorityIndex:i}=e.events.pop(),s=r.data?.eventId;if(!(s!=null&&this._stoppedPropagationEventIds.has(s)))for(e.currentHandler=this._handlersPriority[i];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!r.shouldStopPropagation()&&e.currentHandler.eventCallback?.(r),r.shouldStopPropagation()){s!=null&&this._stoppedPropagationEventIds.add(s);break}if(r.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:r,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const r=new J0;r.push(e);const i=this._currentPropagation;if(i){for(;i.events.length;)r.push(i.events.pop());i.events=r,i.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,r){if(e.handler.hasSideEffects!==r.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==r.groupPriority)return e.groupPriority>r.groupPriority?-1:1;for(const i of e.handler.incomingEventMatches)for(const s of r.handler.incomingEventMatches){if(i.eventType!==s.eventType)continue;const n=i.keyModifiers.filter(o=>s.keyModifiers.includes(o));if(n.length===i.keyModifiers.length!=(n.length===s.keyModifiers.length))return i.keyModifiers.length>s.keyModifiers.length?-1:1}return e.priorityIndex>r.priorityIndex?-1:1}_sortHandlersPriority(e){const r=[];for(const i of e){let s=0;for(;s<r.length&&this._compareHandlerPriority(i,r[s])>=0;)s++;r.splice(s,0,i)}return r}get test(){}};u([h({readOnly:!0})],Pn.prototype,"hasPendingInputs",null),u([h({constructOnly:!0})],Pn.prototype,"eventSource",void 0),u([h({constructOnly:!0})],Pn.prototype,"recognizers",void 0),u([h()],Pn.prototype,"multiTouchActive",null),u([h()],Pn.prototype,"_latestPointerInfo",void 0),u([h()],Pn.prototype,"latestPointerInfo",null),u([h()],Pn.prototype,"_paused",void 0),u([h({readOnly:!0})],Pn.prototype,"updating",null),Pn=u([E("esri.views.input.InputManager")],Pn);let dhe=class{constructor(e,r,i,s,n){this.type=e,this.data=r,this.timestamp=i,this.modifiers=s,this.cancelable=n,this._propagationState=0,this._resumeCallback=null}stopPropagation(){this._propagationState|=1}shouldStopPropagation(){return!!(1&this._propagationState)}defer(e){this._propagationState|=2;const r=(i,s)=>{this._propagationState&=-3;const n=this._resumeCallback;if(this._resumeCallback=null,n&&n(),s)throw i;return i};return(typeof e=="function"?e():e).then(i=>r(i,!1),i=>r(i,!0))}shouldPausePropagation(e){return!!(2&this._propagationState)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};const xl={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3},phe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([ie(()=>[this.ui,this.popup,this.popupElement],([i,s,n],o)=>{const[a,l,c]=o??[];Qce(this,[i,s,n],[a,l,c])},pi),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&ehe(this,i)},xl.WIDGET)]),Ov(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>q(()=>import("./Popup-CPvhBigH.js").then(i=>i.P),__vite__mapDeps([156,157,158,159,160,161,162,70,68,69,28,31,163,164,165,84,166,167])))}destroy(){this.destroyed||this.closePopup()}async openPopup(i){if(ca(this.popup))return this.popup.open(i);if(this.popupElement&&Pl(this.popupElement))this.popupElement.open(i).catch(()=>{});else try{if(await this.setupPopup(),!this.popup)return void U.getLogger(this).error(new R("view:null-popup","Popup is null and can't be opened"));the(this,i)}catch{}}closePopup(){this._popupSetupTask?.abort(),bU(this.popup,this.popupElement)}async fetchPopupFeatures(i,s){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(i,s),s)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!ca(this.popup))return this._popupSetupTask=Pv(async i=>{if(!this.popupEnabled||!Pl(this.popupElement))if(this.dependencies.popup&&typeof this.dependencies.popup=="function")await this.dependencies.popup(),gt(i),customElements.get("arcgis-popup")||U.getLogger(this).error(new R("view:undefined-popup-element","`arcgis-popup` custom element is undefined and can't be opened")),this.popupElement=document.createElement("arcgis-popup");else{const{default:s}=await q(()=>import("./Popup-CPvhBigH.js").then(o=>o.P),__vite__mapDeps([156,157,158,159,160,161,162,70,68,69,28,31,163,164,165,84,166,167]));if(gt(i),!this.popup||ca(this.popup))return;const n=this.popup;if("open"in n||"close"in n){const{open:o,close:a,...l}=n;this.popup=new s({...l})}else this.popup=new s(n)}}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:i,hits:s},n){const o=[],a=[];let l=!1;const c=jX(n,z("popup-view-fetch-timeout")??mhe),d=y=>{const g=new fhe(y);return a.push(g),o.push(g.promise),g},p=y=>{const g=a.at(-1);return g&&g.layerView===y&&!l?g:d(y)};for(const y of s)"graphic"in y?(p(y.layerView).graphics.push(y.graphic),l=!1):(o.push(y.layerView.fetchPopupFeaturesAtLocation(y.mapPoint,c)),l=!0);a.forEach(y=>y.resolve(c));const m=zX(o).then(y=>y.filter(g=>!!g).flat());return{pendingFeatures:o,allGraphicsPromise:m,location:i}}async _getPopupHits(i,s){const{hits:n,location:o}=await this.popupHitTest(i);gt(s);const a=[];for(const l of n)if("graphic"in l){if(this._isValidPopupGraphic(l.graphic,s)){const c=this._isValidPopupGraphicsLayerView(l.layerView)?l.layerView:void 0;a.push({graphic:l.graphic,layerView:c})}}else this._isValidPopupLocationLayerView(l.layerView)&&a.push({mapPoint:l.mapPoint,layerView:l.layerView});return{hits:a,location:o}}_isValidPopupGraphic(i,s){return i&&!!i.getEffectivePopupTemplate(s?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(i){return!i||(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesFromGraphics"in i}_isValidPopupLocationLayerView(i){return(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesAtLocation"in i}};return u([h()],r.prototype,"popup",void 0),u([h()],r.prototype,"popupElement",void 0),u([h()],r.prototype,"popupEnabled",void 0),r=u([E("esri.views.PopupView")],r),r};let fhe=class{constructor(e){this.layerView=e,this._resolver=ps(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:r,graphics:i,_resolver:s}=this;if(!r)return s.resolve(i),s.promise;let n;return r.fetchPopupFeaturesFromGraphics(i,e).catch(o=>(n=o,null)).then(o=>{o?s.resolve(o):s.reject(n)}),s.promise}};const mhe=5e3;var og;const Y1=yr()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),xU=Y1.jsonValues.slice();$M(xU,"orthometric");const c0=yr()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let Ri=og=class extends W{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,r){return Y1.write(t,e,r)}readHeightModel(t,e,r){return Y1.read(t)||(r?.messages&&r.messages.push(yhe(t,{context:r})),null)}readHeightUnit(t,e,r){return c0.read(t)||(r?.messages&&r.messages.push(XO(t,{context:r})),null)}readHeightUnitService(t,e,r){return _P(t)||c0.read(t)||(r?.messages&&r.messages.push(XO(t,{context:r})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new og({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const r=dj(e);return new og({heightModel:t.heightModel,heightUnit:r??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new og;return e.read(t,{origin:"web-scene"}),e}};function XO(t,e){return new zs("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function yhe(t,e){return new zs("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}u([h({type:Y1.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:xU,default:"ellipsoidal",write:{isRequired:!0}}}}})],Ri.prototype,"heightModel",void 0),u([te("web-scene","heightModel")],Ri.prototype,"writeHeightModel",null),u([X(["web-scene","service"],"heightModel")],Ri.prototype,"readHeightModel",null),u([h({type:c0.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:c0.jsonValues,write:{writer:c0.write,isRequired:!0}}}}})],Ri.prototype,"heightUnit",void 0),u([X("web-scene","heightUnit")],Ri.prototype,"readHeightUnit",null),u([X("service","heightUnit")],Ri.prototype,"readHeightUnitService",null),u([h({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],Ri.prototype,"vertCRS",void 0),u([X("service","vertCRS",["vertCRS","ellipsoid","geoid"])],Ri.prototype,"readVertCRS",null),Ri=og=u([E("esri.geometry.HeightModelInfo")],Ri);let t$;async function ghe(){return t$==null&&(t$=q(()=>import("./WhereClauseCache-RYqzS1G-.js"),__vite__mapDeps([38,39])).then(t=>new t.WhereClauseCache(500,500))),t$}async function uk(t,e){const r=await ghe(),i=r.get(t,e);if(i==null)throw r.getError(t,e);return i}function $U(t,e){return t||=null,e||=null,t==="1=1"?e??t:e==="1=1"?t??e:t&&e?`(${t}) AND (${e})`:t??e}function vhe(t,e){return t||=null,e||=null,t==="1=1"||e==="1=1"||t===e?t==="1=1"?t:e:t&&e?`(${t}) OR (${e})`:t??e}function hNe(t,e){return e.length===0?null:`${t} IN (${whe(e)})`}function whe(t){return t.map(e=>typeof e=="string"?_he(e):e).join(",")}function _he(t){return`'${t.replaceAll("'","''")}'`}function cd(t){return typeof t=="number"}function dNe(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function pNe(t){return typeof t=="boolean"}function Vv(t){return typeof t=="string"||t instanceof String}function bhe(t){return t==null||Vv(t)}function fNe(t){return Array.isArray(t)}function mNe(t){return t?.declaredClass==="esri.Graphic"}function yNe(t){return t instanceof Date}const She="HH:mm",xhe="HH:mm:ss",$he="HH:mm:ss.SSS",Mhe=[$he,xhe,She,"TT"],The="yyyy-MM-dd";function KO(t){if(!t||!Vv(t))return null;const e=ue.fromFormat(t,The);return e.isValid?e:null}function QO(t){return t&&Vv(t)?u1(Mhe,e=>{const r=ue.fromFormat(t,e);return r.isValid?r:null})??null:null}function e5(t){if(!t||!Vv(t))return null;const e=ue.fromISO(t);return e.isValid?e:null}const MU=new Set(["integer","small-integer","long","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"]);function Ihe(t){return t!=null&&MU.has(t.type)}function TU(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function IU(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function EU(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}const Ehe=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);iP(MU,Ehe);function gNe(t,e){const r=t?.domain;if(!r||r.type!=="range")return;const i="range"in r?r.range[0]:r.minValue,s="range"in r?r.range[1]:r.maxValue,n=Ihe(t);return TU(t)||EU(t)||IU(t)?{...Che(t,s,i),isInteger:n}:{min:i!=null&&typeof i=="number"?i:null,max:s!=null&&typeof s=="number"?s:null,rawMin:i,rawMax:s,isInteger:n}}function Che(t,e,r){return TU(t)?{min:KO(r)?.toMillis(),max:KO(e)?.toMillis(),rawMin:r,rawMax:e}:EU(t)?{min:QO(r)?.toMillis(),max:QO(e)?.toMillis(),rawMin:r,rawMax:e}:IU(t)?{min:e5(r)?.toMillis(),max:e5(e)?.toMillis(),rawMin:r,rawMax:e}:{max:null,min:null}}function Phe(t){if(!t)return;const e=t.match(khe);return e?.groups?e.groups.doubleQuoted??e.groups.singleQuoted??e.groups.dotNotation:void 0}const khe=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-z_][a-z0-9_]*))$/i;function Lhe(t){return t.match(Ahe)?.[1]?.replaceAll("\\'","'")??null}const Ahe=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let r$;function kl(){return r$||(r$=(async()=>{const[t,e,r]=await Promise.all([q(()=>import("./arcadeUtils-CHK-5Ybm.js"),__vite__mapDeps([168,169,170,171,172,163,43,173,30,28,31,174,39,84,175,164,165,176])),q(()=>import("./batchExec-3EmCZjyR.js"),__vite__mapDeps([177,89])),q(()=>import("./aiServices-DtW0mbT4.js").then(i=>i.a),__vite__mapDeps([174,171,172,163,43,170]))]);return{arcade:t.arcade,arcadeUtils:t,batchExec:e,aiServices:r,Dictionary:t.Dictionary,Feature:t.arcadeFeature,Voxel:t.Voxel,Pixel:t.Pixel}})()),r$}const Rhe=/^([0-9_])/,Ohe=/[^a-z0-9_\u0080-\uffff]+/gi;function Fhe(t){return t==null?null:t.trim().replaceAll(Ohe,"_").replace(Rhe,"F$1")||null}const Nhe=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],Dhe=["field","normalizationField"];function t5(t,e){if(t!=null&&e!=null){for(const r of Array.isArray(t)?t:[t])if(r5(Nhe,r,e),"visualVariables"in r&&r.visualVariables)for(const i of r.visualVariables)r5(Dhe,i,e)}}function r5(t,e,r){if(t)for(const i of t){const s=Sv(i,e),n=s&&typeof s!="function"&&r.get(s);n&&Ir(i,n.name,e)}}function CU(t,e){if(t!=null&&e?.fields?.length)if("startField"in t){const r=e.get(t.startField),i=e.get(t.endField);t.startField=r?.name??null,t.endField=i?.name??null}else{const r=e.get(t.startTimeField),i=e.get(t.endTimeField);t.startTimeField=r?.name??null,t.endTimeField=i?.name??null}}const i$=new Set;function E2(t,e){return t&&e?(i$.clear(),lc(i$,t,e),Array.from(i$).sort()):[]}function lc(t,e,r){if(r)if(e?.fields?.length)if(r.includes("*"))for(const{name:i}of e.fields)t.add(i);else for(const i of r)Mi(t,e,i);else{if(r.includes("*"))return t.clear(),void t.add("*");for(const i of r)i!=null&&t.add(i)}}function Mi(t,e,r){if(typeof r=="string")if(e){const i=e.get(r);i&&t.add(i.name)}else t.add(r)}function vNe(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(r=>r.name):e}function wNe(t,e,r=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const i=E2(t,e);return i.length/t.fields.length>=r?["*"]:i}async function ei(t,e,r,i){if(!i)return;const s=Phe(i);if(s)Mi(t,e,s);else{const{arcadeUtils:n}=await kl(),o=n.extractFieldNames(i,r?.partitions??e?.fields?.map(a=>a.name));for(const a of o)Mi(t,r?.index??e,a)}}async function ck(t,e,r){if(r&&r!=="1=1"){const i=await uk(r,e);if(!i.isStandardized)throw new R("fieldUtils:collectFilterFields","Where clause is not standardized",{where:r});lc(t,e,i.fieldNames)}}function zhe({displayField:t,fields:e}){return t||(e?.length?jhe(e):null)}function jhe(t){return s$(t,"name-or-title")||s$(t,"unique-identifier")||s$(t,"type-or-category")||Vhe(t)}function Vhe(t){for(const e of t){if(!e?.name)continue;const r=e.name.toLowerCase();if(r.includes("name")||r.includes("title"))return e.name}return null}function s$(t,e){for(const r of t)if(r?.valueType&&r.valueType===e)return r.name;return null}async function _Ne(t,e){if(!e)return;const r=e.elevationInfo?.featureExpressionInfo;return r?r.collectRequiredFields(t,e.fieldsIndex):void 0}function Uhe(t,e,r){r.onStatisticExpression?ei(t,e,null,r.onStatisticExpression.expression):t.add(r.onStatisticField)}async function bNe(t,e,r){if(!e||!r||!("fields"in r))return;const i=[],s=r.popupTemplate;i.push(PU(t,e,s)),r.fields&&i.push(...r.fields.map(async n=>Uhe(t,e.fieldsIndex,n))),await Promise.all(i)}async function SNe(t,e){const{fieldsIndex:r,trackInfo:i}=e;if(!e||!i||!r)return;const s=[i.latestObservations.renderer?.collectRequiredFields(t,r),i.previousObservations.renderer?.collectRequiredFields(t,r),i.trackLines.renderer?.collectRequiredFields(t,r)];i.popupTemplate&&s.push(PU(t,e,i.popupTemplate));for(const n of[i.latestObservations.labelingInfo,i.previousObservations.labelingInfo,i.trackLines.labelingInfo])if(n)for(const o of n)s.push(RU(t,r,o));await Promise.all(s)}async function PU(t,e,r){const i=[];r?.expressionInfos&&i.push(...r.expressionInfos.map(n=>ei(t,e.fieldsIndex,null,n.expression)));const s=r?.content;if(Array.isArray(s))for(const n of s)n.type==="expression"&&n.expressionInfo&&i.push(ei(t,e.fieldsIndex,null,n.expressionInfo.expression));await Promise.all(i)}async function xNe(t,e,r){e&&(e.timeInfo&&r?.timeExtent&&lc(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&lc(t,e.fieldsIndex,[e.floorInfo.floorField]),r?.where!=null&&await ck(t,e.fieldsIndex,r.where))}async function $Ne(t,e,r){e&&r&&await Promise.all(r.map(i=>Ghe(t,e,i)))}async function Ghe(t,e,r){e&&r&&(r.valueExpression?await ei(t,e.fieldsIndex,null,r.valueExpression):r.field&&Mi(t,e.fieldsIndex,r.field))}function MNe(t){return t?E2(t.fieldsIndex,kU(t)):[]}function qhe(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?E2(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}async function TNe(t,e,r){if(!e||!r)return;const i=e.fieldsIndex;await Promise.all(r.filters.map(s=>ck(t,i,s.where)))}const Bhe=new Set(["oid","global-id","guid"]),Hhe=new Set(["oid","global-id"]),Whe=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/objectid/i,/^perimeter_/i,/_perimeter$/i,/_i$/i];function Zhe(t){const e=new Set;LU(t).forEach(i=>e.add(i)),qhe(t).forEach(i=>e.add(i.toLowerCase()));const r=t&&"infoFor3D"in t?t.infoFor3D:void 0;return r&&(Object.values(r.assetMapFieldRoles).forEach(i=>e.add(i.toLowerCase())),Object.values(r.transformFieldRoles).forEach(i=>e.add(i.toLowerCase()))),Array.from(e)}function kU(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:r,creatorField:i,editDateField:s,editorField:n}=e;return[r,i,s,n].filter(Boolean)}function LU(t){return kU(t).map(e=>e.toLowerCase())}function AU(t,e){return t.editable&&!Bhe.has(t.type)&&!LU(e).includes(t.name?.toLowerCase()??"")}function Jhe(t,e){const r=t.name?.toLowerCase()??"";return!(e?.objectIdField!=null&&r===e.objectIdField.toLowerCase()||e?.globalIdField!=null&&r===e.globalIdField.toLowerCase()||Zhe(e).includes(r)||Hhe.has(t.type)||Whe.some(i=>i.test(r)))}async function INe(t,e){const{labelingInfo:r,fieldsIndex:i}=e;r?.length&&await Promise.all(r.map(s=>RU(t,i,s)))}async function RU(t,e,r){if(!r)return;const i=r.getLabelExpression(),s=r.where;if(i.type==="arcade")await ei(t,e,null,i.expression);else{const n=i.expression.match(/{[^}]*}/g);n&&n.forEach(o=>{Mi(t,e,o.slice(1,-1))})}await ck(t,e,s)}function Yhe(t){const e=t.defaultValue;return e!==void 0&&FU(t,e)?e:t.nullable?null:void 0}function ENe(t){const e=typeof t=="string"?{type:t}:t;return DU(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function OU(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function Xhe(t){return t===null||OU(t)}function Khe(t){return t===null||Number.isInteger(t)}function Qhe(){return!0}function FU(t,e){let r;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":r=t.nullable?Khe:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":r=t.nullable?Xhe:OU;break;case"string":case"esriFieldTypeString":r=t.nullable?bhe:Vv;break;default:r=Qhe}return arguments.length===1?r:r(e)}const ede=["integer","small-integer","big-integer","long"],tde=["single","double"],rde=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"],ide=["esriFieldTypeSingle","esriFieldTypeDouble"],NU=new Set([...ede,...rde]),sde=new Set([...tde,...ide]),nde=iP(NU,sde);function ode(t){return t!=null&&NU.has(t.type)}function hk(t){return t!=null&&nde.has(t.type)}function DU(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function C2(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function zU(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function jU(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function VU(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function i5(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function s5(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function CNe(t,e){return ade(t,e)===null}function PNe(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function ade(t,e){return t==null||t.nullable&&e===null?null:FU(t,e)?hk(t)&&!lde(t.type,Number(e))?"numeric-range-validation-error::out-of-range":null:"type-validation-error::invalid-type"}function lde(t,e){const r=typeof t=="string"?UU(t):t;if(!r)return!1;const i=r.min,s=r.max;return r.isInteger?Number.isInteger(e)&&e>=i&&e<=s:e>=i&&e<=s}function UU(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return ude;case"esriFieldTypeInteger":case"esriFieldTypeLong":case"integer":case"long":return cde;case"esriFieldTypeBigInteger":case"big-integer":return hde;case"esriFieldTypeSingle":case"single":return dde;case"esriFieldTypeDouble":case"double":return pde}}const ude={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},cde={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},hde={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},Ow=(2-2**-23)*2**127,dde={min:-Ow,max:Ow,isInteger:!1,rawMin:-Ow,rawMax:Ow},pde={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function kNe(t,e,r){switch(t){case"domain-validation-error::invalid-coded-value":return`Value ${r} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"domain-validation-error::value-out-of-range":return`Value ${r} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"type-validation-error::invalid-type":return`Value ${r} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case"numeric-range-validation-error::out-of-range":{const{min:i,max:s}=UU(e.type);return`Value ${r} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${i} to ${s}`}}}function fde(t,e){return!mde(t,e,null)}function mde(t,e,r){if(!t?.attributes||!e)return!0;const i=new Set(Object.keys(t.attributes));let s=!1;for(const n of e)if(!i.has(n)&&(s=!0,r==null))break;return s}function yde(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}function dk(t){const e=t?.match(/{[^}]+}/g);return e?e.map(r=>r.slice(1,-1).split(":")[0].trim()):[]}let ib=class extends W{constructor(e){super(e),this.type=null}};u([h({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],ib.prototype,"type",void 0),ib=u([E("esri.popup.content.Content")],ib);const Ol=ib,Fw=new Ne({asc:"ascending",desc:"descending"});let ag=class extends Ie(W){constructor(e){super(e),this.field=null,this.order="ascending"}};u([h({type:String,json:{write:!0}})],ag.prototype,"field",void 0),u([h({type:Fw.apiValues,json:{type:Fw.jsonValues,read:Fw.read,write:Fw.write}})],ag.prototype,"order",void 0),ag=u([E("esri.popup.support.AttachmentsOrderByInfo")],ag);const gde=ag;let ho=class extends Ie(Ol){constructor(e){super(e),this.attachmentKeywords=null,this.attachmentTypes=null,this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};u([h({type:[String],json:{write:!0}})],ho.prototype,"attachmentKeywords",void 0),u([h({type:[["application","audio","image","model","text","video"]],json:{write:!0}})],ho.prototype,"attachmentTypes",void 0),u([h({type:String,json:{write:!0}})],ho.prototype,"description",void 0),u([h({type:["auto","preview","list"],json:{write:!0}})],ho.prototype,"displayType",void 0),u([h({type:[gde],json:{write:!0}})],ho.prototype,"orderByFields",void 0),u([h({type:String,json:{write:!0}})],ho.prototype,"title",void 0),u([h({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],ho.prototype,"type",void 0),ho=u([E("esri.popup.content.AttachmentsContent")],ho);const Tm=ho;var eI;let Gc=eI=class extends Ol{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new eI({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?O(this.outFields):null})}};u([h()],Gc.prototype,"creator",void 0),u([h()],Gc.prototype,"destroyer",void 0),u([h()],Gc.prototype,"outFields",void 0),u([h({type:["custom"],readOnly:!0})],Gc.prototype,"type",void 0),Gc=eI=u([E("esri.popup.content.CustomContent")],Gc);const vde=Gc;var tI;let hp=tI=class extends W{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new tI({title:this.title,expression:this.expression})}};u([h({type:String,json:{write:!0}})],hp.prototype,"title",void 0),u([h({type:String,json:{write:!0}})],hp.prototype,"expression",void 0),u([h({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],hp.prototype,"returnType",void 0),hp=tI=u([E("esri.popup.ElementExpressionInfo")],hp);const wde=hp;var rI;let lg=rI=class extends Ol{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new rI({expressionInfo:this.expressionInfo?.clone()})}};u([h({type:wde,json:{write:!0}})],lg.prototype,"expressionInfo",void 0),u([h({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],lg.prototype,"type",void 0),lg=rI=u([E("esri.popup.content.ExpressionContent")],lg);const P2=lg;let sb=class extends Ie(W){constructor(e){super(e),this.type=null}};u([h({type:["date-time","number"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],sb.prototype,"type",void 0),sb=u([E("esri.layers.support.FieldFormat")],sb);const pk=sb,GU="auto";let Na=class extends pk{constructor(e){super(e),this.dateStyle=null,this.hour12=GU,this.month=null,this.timeStyle=null,this.type="date-time",this.year=null}};u([h({type:["full","long","medium","short"],json:{write:!0}})],Na.prototype,"dateStyle",void 0),u([h({type:["always","auto","never"],nonNullable:!0,json:{default:GU,write:!0}})],Na.prototype,"hour12",void 0),u([h({type:["long","short"],json:{write:!0}})],Na.prototype,"month",void 0),u([h({type:["full","long","medium","short"],json:{write:!0}})],Na.prototype,"timeStyle",void 0),u([h({type:["date-time"]})],Na.prototype,"type",void 0),u([h({type:["numeric"],json:{write:!0}})],Na.prototype,"year",void 0),Na=u([E("esri.layers.support.DateTimeFieldFormat")],Na);const Zu=Na,n5={min:0,max:20},qU=2,BU=0,HU="decimal",WU="auto";let lu=class extends pk{constructor(e){super(e),this.maximumFractionDigits=qU,this.minimumFractionDigits=BU,this.style=HU,this.type="number",this.useGrouping=WU}};u([h({type:Ue,nonNullable:!0,range:n5,json:{default:qU,write:!0}})],lu.prototype,"maximumFractionDigits",void 0),u([h({type:Ue,nonNullable:!0,range:n5,json:{default:BU,write:!0}})],lu.prototype,"minimumFractionDigits",void 0),u([h({type:["decimal"],nonNullable:!0,json:{default:HU,write:!0}})],lu.prototype,"style",void 0),u([h({type:["number"]})],lu.prototype,"type",void 0),u([h({type:["always","auto","never"],nonNullable:!0,json:{default:WU,write:!0}})],lu.prototype,"useGrouping",void 0),lu=u([E("esri.layers.support.NumberFieldFormat")],lu);const X1=lu;let dp=class extends Ie(W){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};u([ye(ose)],dp.prototype,"dateFormat",void 0),u([h({type:Boolean,json:{write:!0}})],dp.prototype,"digitSeparator",void 0),u([h({type:Ue,json:{write:!0}})],dp.prototype,"places",void 0),dp=u([E("esri.popup.support.FieldInfoFormat")],dp);const ha=dp,ZU={base:pk,key:"type",errorContext:"field-configuration-field-format",typeMap:{"date-time":Zu,number:X1}};function _de(t,e){const{format:r}=t;return e&&Sd(e)?r?JU(r,e):h0(e,{hour12:"always",useGrouping:"always"}):null}function JU(t,e){const{dateFormat:r}=t;if(!e)return r?a5(t):o5(t);if(!Sd(e))return;const i={hour12:"always"};switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return YU(t);case"single":case"double":return o5(t);case"date":case"timestamp-offset":return r?a5(t):h0(e,i);case"date-only":return r?bde(t):h0(e);case"time-only":return r?Sde(t):h0(e,i)}}function Sd(t){return hk(t)||C2(t)||zU(t)||VU(t)||jU(t)}function YU(t){return new X1({useGrouping:t.digitSeparator?"always":"never"})}function o5(t){const e=YU(t),{places:r}=t;return e.minimumFractionDigits=r??0,e.maximumFractionDigits=r??2,e}function a5(t){return new Zu({dateStyle:XU(t),year:t7(t),month:QU(t),timeStyle:e7(t),hour12:KU(t)})}function bde(t){return new Zu({dateStyle:XU(t),year:t7(t),month:QU(t)})}function Sde(t){return new Zu({timeStyle:e7(t),hour12:KU(t)})}function XU(t){const{dateFormat:e}=t;return e?e.startsWith("short-date")?"short":e.startsWith("day-short-month-year")?"medium":e.startsWith("long-month-day-year")?"long":e.startsWith("long-date")?"full":null:null}function KU(t){return t.dateFormat?.endsWith("-24")?"never":"always"}function QU(t){switch(t.dateFormat){case"short-month-year":return"short";case"long-month-year":return"long";default:return null}}function e7(t){const{dateFormat:e}=t;return e?e.includes("short-time")?"short":e.includes("long-time")?"medium":null:null}function t7(t){switch(t.dateFormat){case"short-month-year":case"long-month-year":case"year":return"numeric";default:return null}}function fk(t,e){const r=t.type==="number",i=t.type==="date-time";if(!e)return r?l5(t):i?u5(t):null;if(Sd(e))switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return r?r7(t):null;case"single":case"double":return r?l5(t):null;case"date":case"timestamp-offset":return i?u5(t):null;case"date-only":return i?xde(t):null;case"time-only":return i?$de(t):null}}function r7(t){return new ha({digitSeparator:t.useGrouping!=="never"})}function l5(t){const e=r7(t);return e.places=t.maximumFractionDigits,e}function u5(t){let e;const r=i7(t),i=s7(t),s=t.hour12==="never"?"24":null,n=t.year==="numeric"?"year":null,o=n7(t);return r&&i&&s?e=`${r}-${i}-${s}`:r&&i?e=`${r}-${i}`:r?e=r:n&&o?e=`${o}-${n}`:n&&(e=n),e?new ha({dateFormat:e}):null}function xde(t){let e;const r=i7(t),i=t.year==="numeric"?"year":null,s=n7(t);return r?e=r:i&&s?e=`${s}-${i}`:i&&(e=i),e?new ha({dateFormat:e}):null}function $de(t){let e;const r=s7(t),i=t.hour12==="never"?"24":null;return r&&i?e=`short-date-${r}-${i}`:r&&(e=`short-date-${r}`),e?new ha({dateFormat:e}):null}function i7(t){switch(t.dateStyle){case"short":return"short-date";case"medium":return"day-short-month-year";case"long":return"long-month-day-year";case"full":return"long-date";default:return}}function s7(t){return t.timeStyle&&(t.timeStyle==="short"?"short-time":"long-time")}function n7(t){switch(t.month){case"short":return"short-month";case"long":return"long-month";default:return}}function h0(t,e){if(!Sd(t))return;const r=e?.useGrouping??"auto",i=e?.hour12??"auto";switch(t.type){case"integer":case"small-integer":case"big-integer":case"long":return new X1({minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:r});case"single":case"double":return new X1({minimumFractionDigits:0,maximumFractionDigits:2,useGrouping:r});case"date":case"timestamp-offset":return new Zu({dateStyle:"short",timeStyle:"short",hour12:i});case"date-only":return new Zu({dateStyle:"short"});case"time-only":return new Zu({timeStyle:"short",hour12:i})}}let vs=class extends Ie(W){constructor(e){super(e),this.fieldName=null,this.isEditable=!0,this.label=null,this.statisticType=null,this.stringFieldOption="text-box",this.tooltip=null,this.visible=!0}set fieldFormat(e){this._set("fieldFormat",e),this._set("format",e?fk(e):null)}set format(e){this._set("format",e),this._set("fieldFormat",e?JU(e):null)}readFormat(e,r){if(!r.fieldFormat)return e?ha.fromJSON(e):null}clone(){const e=super.clone();return e._set("format",this.format?.clone()),e._set("fieldFormat",this.fieldFormat?.clone()),e}};u([h({value:null,clonable:!1,types:ZU,json:{write:{overridePolicy(t,e,r){const{fieldName:i}=this;return{enabled:!!i&&!i.startsWith("expression/")&&!i.startsWith("relationships/")&&!!r?.writeFieldFormat}}}}})],vs.prototype,"fieldFormat",null),u([h({type:String,json:{write:!0}})],vs.prototype,"fieldName",void 0),u([h({value:null,clonable:!1,type:ha,json:{write:!0}})],vs.prototype,"format",null),u([X("format")],vs.prototype,"readFormat",null),u([h({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],vs.prototype,"isEditable",void 0),u([h({type:String,json:{write:!0}})],vs.prototype,"label",void 0),u([h({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],vs.prototype,"statisticType",void 0),u([ye(new Ne({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],vs.prototype,"stringFieldOption",void 0),u([h({type:String,json:{write:!0}})],vs.prototype,"tooltip",void 0),u([h({type:Boolean,json:{write:!0}})],vs.prototype,"visible",void 0),vs=u([E("esri.popup.FieldInfo")],vs);const k2=vs;var iI;let uu=iI=class extends Ol{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}clone(){return new iI(O({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};u([h({type:Object,json:{write:!0}})],uu.prototype,"attributes",void 0),u([h({type:String,json:{write:!0}})],uu.prototype,"description",void 0),u([h({type:[k2],json:{write:!0}})],uu.prototype,"fieldInfos",void 0),u([h({type:String,json:{write:!0}})],uu.prototype,"title",void 0),u([h({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],uu.prototype,"type",void 0),uu=iI=u([E("esri.popup.content.FieldsContent")],uu);const Im=uu;let qc=class extends W{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};u([h({type:String,json:{write:!0}})],qc.prototype,"altText",void 0),u([h({type:String,json:{write:!0}})],qc.prototype,"caption",void 0),u([h({type:String,json:{write:!0}})],qc.prototype,"title",void 0),u([h({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],qc.prototype,"type",void 0),qc=u([E("esri.popup.content.mixins.MediaInfo")],qc);const mk=qc;var sI;let Bc=sI=class extends le{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new sI({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};u([h()],Bc.prototype,"color",void 0),u([h()],Bc.prototype,"fieldName",void 0),u([h()],Bc.prototype,"tooltip",void 0),u([h()],Bc.prototype,"value",void 0),Bc=sI=u([E("esri.popup.content.support.ChartMediaInfoValueSeries")],Bc);const Mde=Bc;var nI;let cu=nI=class extends W{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new nI({colors:O(this.colors),fields:O(this.fields),normalizeField:this.normalizeField,series:O(this.series),tooltipField:this.tooltipField})}};u([h({type:[K],json:{type:[[Ue]],write:!0}})],cu.prototype,"colors",void 0),u([h({type:[String],json:{write:{isRequired:!0}}})],cu.prototype,"fields",void 0),u([h({type:String,json:{write:!0}})],cu.prototype,"normalizeField",void 0),u([h({type:[Mde],json:{read:!1}})],cu.prototype,"series",void 0),u([h({type:String,json:{write:!0}})],cu.prototype,"tooltipField",void 0),cu=nI=u([E("esri.popup.content.support.ChartMediaInfoValue")],cu);const Tde=cu;let ug=class extends mk{constructor(e){super(e),this.type=null,this.value=void 0}};u([h({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],ug.prototype,"type",void 0),u([h({type:Tde,json:{write:{isRequired:!0}}})],ug.prototype,"value",void 0),ug=u([E("esri.popup.content.mixins.ChartMediaInfo")],ug);const L2=ug,A2=yr()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var oI;let nb=oI=class extends L2{constructor(t){super(t),this.type="bar-chart"}clone(){return new oI({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};u([h({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:A2.write,isRequired:!0}}})],nb.prototype,"type",void 0),nb=oI=u([E("esri.popup.content.BarChartMediaInfo")],nb);const o7=nb;var aI;let ob=aI=class extends L2{constructor(t){super(t),this.type="column-chart"}clone(){return new aI({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};u([h({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:A2.write,isRequired:!0}}})],ob.prototype,"type",void 0),ob=aI=u([E("esri.popup.content.ColumnChartMediaInfo")],ob);const a7=ob;var lI;let cg=lI=class extends W{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new lI({linkURL:this.linkURL,sourceURL:this.sourceURL})}};u([h({type:String,json:{write:!0}})],cg.prototype,"linkURL",void 0),u([h({type:String,json:{write:{isRequired:!0}}})],cg.prototype,"sourceURL",void 0),cg=lI=u([E("esri.popup.content.support.ImageMediaInfoValue")],cg);const Ide=cg;var uI;let pp=uI=class extends mk{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new uI({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};u([h({type:Number,json:{write:!0}})],pp.prototype,"refreshInterval",void 0),u([h({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],pp.prototype,"type",void 0),u([h({type:Ide,json:{write:{isRequired:!0}}})],pp.prototype,"value",void 0),pp=uI=u([E("esri.popup.content.ImageMediaInfo")],pp);const l7=pp;var cI;let ab=cI=class extends L2{constructor(t){super(t),this.type="line-chart"}clone(){return new cI({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};u([h({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:A2.write,isRequired:!0}}})],ab.prototype,"type",void 0),ab=cI=u([E("esri.popup.content.LineChartMediaInfo")],ab);const u7=ab;var hI;let lb=hI=class extends L2{constructor(t){super(t),this.type="pie-chart"}clone(){return new hI({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};u([h({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:A2.write,isRequired:!0}}})],lb.prototype,"type",void 0),lb=hI=u([E("esri.popup.content.PieChartMediaInfo")],lb);const c7=lb,dI={base:mk,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":o7,"column-chart":a7,"line-chart":u7,"pie-chart":c7,image:l7}};var pI;let kn=pI=class extends Ol{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?l7.fromJSON(e):e.type==="barchart"?o7.fromJSON(e):e.type==="columnchart"?a7.fromJSON(e):e.type==="linechart"?u7.fromJSON(e):e.type==="piechart"?c7.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(r=>r.toJSON())}clone(){return new pI(O({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};u([h()],kn.prototype,"activeMediaInfoIndex",void 0),u([h({type:Object,json:{write:!0}})],kn.prototype,"attributes",void 0),u([h({type:String,json:{write:!0}})],kn.prototype,"description",void 0),u([h({types:[dI]})],kn.prototype,"mediaInfos",void 0),u([X("mediaInfos")],kn.prototype,"readMediaInfos",null),u([te("mediaInfos")],kn.prototype,"writeMediaInfos",null),u([h({type:String,json:{write:!0}})],kn.prototype,"title",void 0),u([h({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],kn.prototype,"type",void 0),kn=pI=u([E("esri.popup.content.MediaContent")],kn);const X0=kn;var fI;let hg=fI=class extends W{constructor(t){super(t),this.field=null,this.order=null}clone(){return new fI({field:this.field,order:this.order})}};u([h({type:String,json:{write:!0}})],hg.prototype,"field",void 0),u([h({type:["asc","desc"],json:{write:!0}})],hg.prototype,"order",void 0),hg=fI=u([E("esri.popup.support.RelatedRecordsInfoFieldOrder")],hg);const yk=hg;let po=class extends Ie(Ol){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};u([h({type:String,json:{write:!0}})],po.prototype,"description",void 0),u([h({type:Number,json:{type:Ue,write:!0}})],po.prototype,"displayCount",void 0),u([h({type:["list"],json:{write:{isRequired:!0}}})],po.prototype,"displayType",void 0),u([h({type:[yk],json:{write:!0}})],po.prototype,"orderByFields",void 0),u([h({type:Number,json:{type:Ue,write:{isRequired:!0}}})],po.prototype,"relationshipId",void 0),u([h({type:String,json:{write:!0}})],po.prototype,"title",void 0),u([h({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],po.prototype,"type",void 0),po=u([E("esri.popup.content.RelationshipContent")],po);const K0=po;var mI;let dg=mI=class extends Ol{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new mI({text:this.text})}};u([h({type:String,json:{write:!0}})],dg.prototype,"text",void 0),u([h({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],dg.prototype,"type",void 0),dg=mI=u([E("esri.popup.content.TextContent")],dg);const Q0=dg;let Da=class extends Ie(W){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};u([h({type:String,json:{write:!0}})],Da.prototype,"title",void 0),u([h({type:String,json:{write:!0}})],Da.prototype,"description",void 0),u([h({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],Da.prototype,"type",void 0),u([h({type:Number,json:{type:Ue,write:!0}})],Da.prototype,"associatedNetworkSourceId",void 0),u([h({type:Number,json:{type:Ue,write:!0}})],Da.prototype,"associatedAssetGroup",void 0),u([h({type:Number,json:{type:Ue,write:!0}})],Da.prototype,"associatedAssetType",void 0),Da=u([E("esri.popup.support.UtilityNetworkAssociationType")],Da);const h7=Da;let hu=class extends Ie(Ol){constructor(e){super(e),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};u([h({type:String,json:{write:!0}})],hu.prototype,"description",void 0),u([h({type:Number,json:{type:Ue,write:!0}})],hu.prototype,"displayCount",void 0),u([h({type:String,json:{write:!0}})],hu.prototype,"title",void 0),u([h({type:[h7],json:{write:!0}})],hu.prototype,"associationTypes",void 0),u([ye({utilityNetworkAssociations:"utility-network-associations"})],hu.prototype,"type",void 0),hu=u([E("esri.popup.content.UtilityNetworkAssociationsContent")],hu);const gk=hu,Ede={base:null,key:"type",typeMap:{attachment:Tm,media:X0,text:Q0,expression:P2,field:Im,relationship:K0,utilityNetworkAssociations:gk}},Cde={base:null,key:"type",typeMap:{attachment:Tm,media:X0,text:Q0,expression:P2,field:Im,relationship:K0}};var yI;let Hc=yI=class extends W{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new yI({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};u([h({type:String,json:{write:!0}})],Hc.prototype,"name",void 0),u([h({type:String,json:{write:!0}})],Hc.prototype,"title",void 0),u([h({type:String,json:{write:!0}})],Hc.prototype,"expression",void 0),u([h({type:["string","number"],json:{write:!0}})],Hc.prototype,"returnType",void 0),Hc=yI=u([E("esri.popup.ExpressionInfo")],Hc);const Pde=Hc;var gI;let pg=gI=class extends W{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new gI({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};u([h({type:Boolean,json:{write:!0}})],pg.prototype,"returnTopmostRaster",void 0),u([h({type:Boolean,json:{write:!0}})],pg.prototype,"showNoDataRecords",void 0),pg=gI=u([E("esri.popup.LayerOptions")],pg);const kde=pg;var vI;let fg=vI=class extends W{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new vI({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?O(this.orderByFields):null})}};u([h({type:Boolean,json:{write:!0}})],fg.prototype,"showRelatedRecords",void 0),u([h({type:[yk],json:{write:!0}})],fg.prototype,"orderByFields",void 0),fg=vI=u([E("esri.popup.RelatedRecordsInfo")],fg);const c5=fg;var wI;let Js=wI=class extends h2(le){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new wI({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};u([h()],Js.prototype,"active",void 0),u([h()],Js.prototype,"className",void 0),u([h()],Js.prototype,"disabled",void 0),u([h()],Js.prototype,"icon",void 0),u([h()],Js.prototype,"id",void 0),u([h()],Js.prototype,"indicator",void 0),u([h()],Js.prototype,"title",void 0),u([h()],Js.prototype,"type",void 0),u([h()],Js.prototype,"visible",void 0),Js=wI=u([E("esri.support.actions.ActionBase")],Js);const vk=Js;var _I;let ub=_I=class extends vk{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new _I({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};u([h()],ub.prototype,"image",void 0),ub=_I=u([E("esri.support.actions.ActionButton")],ub);const Lde=ub;var bI;let mg=bI=class extends vk{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new bI({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};u([h()],mg.prototype,"image",void 0),u([h()],mg.prototype,"value",void 0),mg=bI=u([E("esri.support.actions.ActionToggle")],mg);const Ade=mg,Cy="relationships/",h5="expression/",Rde=se.ofType({key:"type",defaultKeyValue:"button",base:vk,typeMap:{button:Lde,toggle:Ade}}),Ode={base:Ol,key:"type",typeMap:{media:X0,custom:vde,text:Q0,attachments:Tm,fields:Im,expression:P2,relationship:K0,utilityNetworkAssociations:gk}},d7=new Set(["attachments","fields","media","text","expression","relationship"]),Fde=new Set([...d7,"utility-network-associations"]);let ur=class extends Ie(W){constructor(e){super(e),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(r=>ma(Ode,r)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||$i(e)?e:(U.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,r){const{popupElements:i}=r;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(r.description,r.mediaInfos,i):this._readPopupInfo(r)}writeWebSceneContent(e,r,i,s){this._writePopupTemplateContent(e,r,s)}writeWebMapContent(e,r,i,s){this._writePopupTemplateContent(e,r,s)}writeFieldInfos(e,r,i,s){const{content:n}=this,o=Array.isArray(n)?n:null,{writeFieldFormat:a,...l}=s||{};if(e){const c=o?o.filter(p=>p.type==="fields"):[],d=c.length&&c.every(p=>p.fieldInfos?.length);r.fieldInfos=e.filter(Boolean).map(p=>{const m=p.toJSON(l);return d&&(m.visible=!1),m})}if(o)for(const c of o)c.type==="fields"&&this._writeFieldsContent(c,r,l)}writeLayerOptions(e,r,i,s){r[i]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(s)}writeTitle(e,r){r.title=e||""}async collectRequiredFields(e,r,i){const s=this.expressionInfos||[];await this._collectExpressionInfoFields(e,r,i,[...s,...this._getContentExpressionInfos(this.content,s)]),lc(e,r,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e,r){const i=new Set;return await this.collectRequiredFields(i,e,r),[...i].sort()}_writePopupTemplateContent(e,r,i){typeof e!="string"?Array.isArray(e)&&(r.popupElements=e.filter(s=>i?.origin==="web-scene"?d7.has(s.type):Fde.has(s.type)).map(s=>s?.toJSON(i)),r.popupElements.forEach(s=>{s.type==="attachments"?this._writeAttachmentContent(r):s.type==="media"?this._writeMediaContent(s,r):s.type==="text"?this._writeTextContent(s,r):s.type==="relationship"&&this._writeRelationshipContent(s,r)})):r.description=e}_writeFieldsContent(e,r,i){const s=e.fieldInfos;if(!Array.isArray(s)||!s.length)return;const n=r.fieldInfos;if(Array.isArray(n))for(const o of s){const a=n.find(l=>l.fieldName?.toLowerCase()===o.fieldName?.toLowerCase());a?a.visible=!0:n.push(o.toJSON(i))}else r.fieldInfos=s.map(o=>o.toJSON(i))}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,r){const i=e.orderByFields?.map(n=>this._toFieldOrderJSON(n,e.relationshipId))||[],s=[...r.relatedRecordsInfo?.orderByFields||[],...i];r.relatedRecordsInfo={showRelatedRecords:!0,...s?.length&&{orderByFields:s}}}_writeTextContent(e,r){!r.description&&e.text&&(r.description=e.text)}_writeMediaContent(e,r){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const i=O(e.mediaInfos);Array.isArray(r.mediaInfos)?r.mediaInfos=[...r.mediaInfos,...i]:r.mediaInfos=i}_readPopupInfoElements(e,r,i){const s={description:!1,mediaInfos:!1};return i.map(n=>n.type==="media"?(n.mediaInfos||!r||s.mediaInfos||(n.mediaInfos=r,s.mediaInfos=!0),X0.fromJSON(n)):n.type==="text"?(n.text||!e||s.description||(n.text=e,s.description=!0),Q0.fromJSON(n)):n.type==="attachments"?Tm.fromJSON(n):n.type==="fields"?Im.fromJSON(n):n.type==="expression"?P2.fromJSON(n):n.type==="relationship"?K0.fromJSON(n):n.type==="utilityNetworkAssociations"?gk.fromJSON(n):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:r,order:i}=e;if(!r?.startsWith(Cy))return null;const s=r.replace(Cy,"").split("/");if(s.length!==2)return null;const n=parseInt(s[0],10),o=s[1];return!Number.isNaN(n)&&o?K0.fromJSON({relationshipId:n,orderByFields:[{field:o,order:i}]}):null}_toFieldOrderJSON(e,r){const{order:i,field:s}=e;return{field:`${Cy}${r}/${s}`,order:i}}_readPopupInfo({description:e,mediaInfos:r,showAttachments:i,relatedRecordsInfo:s={showRelatedRecords:!1}}){const n=[];e?n.push(new Q0({text:e})):n.push(new Im),Array.isArray(r)&&r.length&&n.push(X0.fromJSON({mediaInfos:r})),i&&n.push(Tm.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:a}=s;return o&&a?.length&&a.forEach(l=>{const c=this._toRelationshipContent(l);c&&n.push(c)}),n.length?n:e}_getContentElementFields(e){const r=e?.type;if(r==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(r==="custom")return e.outFields||[];if(r==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(r==="media"){const i=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...i.reduce((s,n)=>[...s,...this._getMediaInfoFields(n)],[])]}return r==="text"?this._extractFieldNames(e.text):r==="relationship"||r==="utility-network-associations"?[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)]:[]}_getMediaInfoFields(e){const{caption:r,title:i,value:s}=e,n=s||{},{fields:o,normalizeField:a,tooltipField:l,sourceURL:c,linkURL:d}=n,p=[...this._extractFieldNames(i),...this._extractFieldNames(r),...this._extractFieldNames(c),...this._extractFieldNames(d),...o??[]];return a&&p.push(a),l&&p.push(l),p}_getContentExpressionInfos(e,r){return Array.isArray(e)?e.reduce((i,s)=>[...i,...s.type==="expression"&&s.expressionInfo?[s.expressionInfo]:[]],r):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((r,i)=>[...r,...this._getContentElementFields(i)],[]):[]}async _collectExpressionInfoFields(e,r,i,s){s&&await Promise.all(s.map(n=>ei(e,r,i,n.expression)))}_getFieldInfoFields(e){return e?e.filter(({fieldName:r,visible:i})=>!(i!==void 0&&!i||!r||r.startsWith(Cy)||r.startsWith(h5))).map(r=>r.fieldName):[]}_getActionsFields(e){return e?e.toArray().reduce((r,i)=>[...r,...this._getActionFields(i)],[]):[]}_getActionFields(e){const{className:r,title:i,type:s}=e,n=s==="button"||s==="toggle"?e.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(r),...this._extractFieldNames(n)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return dk(e).filter(r=>!(r.startsWith(Cy)||r.startsWith(h5)))}};u([h({type:Rde})],ur.prototype,"actions",void 0),u([h()],ur.prototype,"content",void 0),u([He("content")],ur.prototype,"castContent",null),u([X("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],ur.prototype,"readContent",null),u([te("web-scene","content",{popupElements:{type:se.ofType(Cde)},showAttachments:{type:Boolean},mediaInfos:{type:se.ofType(dI)},description:{type:String},relatedRecordsInfo:{type:c5}})],ur.prototype,"writeWebSceneContent",null),u([te("content",{popupElements:{type:se.ofType(Ede)},showAttachments:{type:Boolean},mediaInfos:{type:se.ofType(dI)},description:{type:String},relatedRecordsInfo:{type:c5}})],ur.prototype,"writeWebMapContent",null),u([h({type:[Pde],json:{write:!0}})],ur.prototype,"expressionInfos",void 0),u([h({type:[k2]})],ur.prototype,"fieldInfos",void 0),u([te("fieldInfos")],ur.prototype,"writeFieldInfos",null),u([h({type:kde})],ur.prototype,"layerOptions",void 0),u([te("layerOptions")],ur.prototype,"writeLayerOptions",null),u([h({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],ur.prototype,"lastEditInfoEnabled",void 0),u([h()],ur.prototype,"outFields",void 0),u([h()],ur.prototype,"overwriteActions",void 0),u([h()],ur.prototype,"returnGeometry",void 0),u([h({json:{type:String}})],ur.prototype,"title",void 0),u([te("title")],ur.prototype,"writeTitle",null),ur=u([E("esri.PopupTemplate")],ur);const _a=ur,wk=Symbol("idFieldsProviderSymbol");function Nde(t){return!!t&&wk in t}function d5(t){return Nde(t)?t[wk]:void 0}const Uv=Symbol("popupProvider");function HNe(t){return typeof t=="object"&&t!==null&&"popupEnabled"in t&&"popupTemplate"in t}function Dde(t){return!!t&&Uv in t}function zde(t){return Dde(t)?t[Uv]:null}function WNe(t,e){switch(e.type){case"object-id":case"unique-id-simple":return t.attributes[e.fieldName];case"unique-id-composite":{const r=[];for(const i of e.fieldNames)r.push(t.attributes[i]??null);return JSON.stringify(r)}}}function p5(t,e){if("uniqueIdFields"in e&&e.uniqueIdFields?.length){if(e.uniqueIdFields.length===1)return t.attributes?.[e.uniqueIdFields[0]];const r=e.uniqueIdFields.map(i=>t.attributes?.[i]);return JSON.stringify(r)}return"objectIdField"in e&&e.objectIdField?t.attributes?.[e.objectIdField]:null}const f5=new Ne({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let jde=0,er=class extends W{constructor(e){super(e),this.id="sym"+jde++,this.type=null,this.color=new K([0,0,0,1])}readColor(e){return e?.[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,r){}hash(){return JSON.stringify(this.toJSON())}clone(){}};u([h({type:f5.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:f5.write,isRequired:!0}}})],er.prototype,"type",void 0),u([h({type:K,json:{write:{allowNull:!0}}})],er.prototype,"color",void 0),u([X("color")],er.prototype,"readColor",null),er=u([E("esri.symbols.Symbol")],er);var SI;let yi=SI=class extends er{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){if(this.data?.type==="CIMSymbolReference"){const r=this.data.primitiveOverrides;if(r){const i=r.map(s=>{const n=s.valueExpressionInfo;return n?ei(t,e,null,n.expression):null});await Promise.all(i)}}}clone(){return new SI({data:O(this.data)})}hash(){return yz(JSON.stringify(this.data)).toString()}};u([h({json:{write:!1}})],yi.prototype,"color",void 0),u([h({json:{write:!0}})],yi.prototype,"data",void 0),u([X("data",["symbol"])],yi.prototype,"readData",null),u([te("data",{})],yi.prototype,"writeData",null),u([ye({CIMSymbolReference:"cim"},{readOnly:!0})],yi.prototype,"type",void 0),yi=SI=u([E("esri.symbols.CIMSymbol")],yi);let Ui=class extends W{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,r,i){e||(r[i]=e)}};u([h({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],Ui.prototype,"enabled",void 0),u([te("enabled")],Ui.prototype,"writeEnabled",null),u([h({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0,json:{write:{isRequired:!0}}})],Ui.prototype,"type",void 0),Ui=u([E("esri.symbols.Symbol3DLayer")],Ui);function Vde(t,e){const r=e.transparency!=null?j0(e.transparency):1,i=e.color;return i&&Array.isArray(i)?new K([i[0]||0,i[1]||0,i[2]||0,r]):null}function Ude(t,e){e.color=t.toJSON().slice(0,3);const r=p2(t.a);r!==0&&(e.transparency=r)}function wc(t){return{type:K,nonNullable:t?.nonNullable,json:{type:[Ue],default:null,read:{source:["color","transparency"],reader:Vde},write:{target:{color:{type:[Ue],isRequired:t?.colorRequiredOnWrite},transparency:{type:Ue}},writer:Ude}}}}const ba={type:Number,cast:ze,json:{write:!0}};function YNe(t){return t==="emissive"?0:1}let Wc=class extends W{constructor(e){super(e),this.color=new K([0,0,0,1]),this.extensionLength=0,this.size=Ke(1)}clone(){}cloneProperties(){return{color:O(this.color),size:this.size,extensionLength:this.extensionLength}}};u([h({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],Wc.prototype,"type",void 0),u([h(wc({colorRequiredOnWrite:!0}))],Wc.prototype,"color",void 0),u([h({...ba,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],Wc.prototype,"extensionLength",void 0),u([h(ba)],Wc.prototype,"size",void 0),Wc=u([E("esri.symbols.edges.Edges3D")],Wc);const _k=Wc;var xI;let cb=xI=class extends _k{constructor(t){super(t),this.type="sketch"}clone(){return new xI(this.cloneProperties())}};u([ye({sketch:"sketch"},{readOnly:!0})],cb.prototype,"type",void 0),cb=xI=u([E("esri.symbols.edges.SketchEdges3D")],cb);const Gde=cb;var $I;let hb=$I=class extends _k{constructor(t){super(t),this.type="solid"}clone(){return new $I(this.cloneProperties())}};u([ye({solid:"solid"},{readOnly:!0})],hb.prototype,"type",void 0),hb=$I=u([E("esri.symbols.edges.SolidEdges3D")],hb);const p7=hb,f7={types:{key:"type",base:_k,typeMap:{solid:p7,sketch:Gde}},json:{write:!0}};var MI;let ef=MI=class extends W{constructor(){super(...arguments),this.strength=null,this.source="emissive"}clone(){const t={strength:this.strength,source:this.source};return new MI(t)}};u([h({json:{write:!1}})],ef.prototype,"strength",void 0),u([h({json:{write:!1}})],ef.prototype,"source",void 0),ef=MI=u([E("esri.symbols.support.Symbol3DEmissive")],ef);var TI;let us=TI=class extends W{constructor(t){super(t),this.color=null,this.emissive=new ef({source:"emissive"})}clone(){const t={color:this.color?.clone()??null,emissive:this.emissive?.clone()??null};return new TI(t)}};u([h(wc())],us.prototype,"color",void 0),u([h({type:ef,json:{write:!1}})],us.prototype,"emissive",void 0),us=TI=u([E("esri.symbols.support.Symbol3DMaterial")],us);var II,zf;let Xa=(zf=class extends Ui{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new II({edges:this.edges?.clone(),enabled:this.enabled,material:this.material?.clone(),castShadows:this.castShadows,size:this.size})}},II=zf,zf);u([ye({Extrude:"extrude"},{readOnly:!0})],Xa.prototype,"type",void 0),u([h({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Xa.prototype,"size",void 0),u([h({type:us,json:{write:!0}})],Xa.prototype,"material",void 0),u([h({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Xa.prototype,"castShadows",void 0),u([h(f7)],Xa.prototype,"edges",void 0),Xa=II=u([E("esri.symbols.ExtrudeSymbol3DLayer")],Xa);let d0=class extends W{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};u([h({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],d0.prototype,"type",void 0),d0=u([E("esri.symbols.patterns.LinePattern3D")],d0);const qde=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var EI;const Bde=yr()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let Ah=EI=class extends d0{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new EI(t)}};u([h({type:["style"],json:{write:{isRequired:!0}}})],Ah.prototype,"type",void 0),u([ye(Bde),h({type:qde,json:{write:{isRequired:!0}}})],Ah.prototype,"style",void 0),Ah=EI=u([E("esri.symbols.patterns.LineStylePattern3D")],Ah);let p0=class extends W{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};u([h({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],p0.prototype,"type",void 0),p0=u([E("esri.symbols.patterns.Pattern3D")],p0);const Hde=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var CI;let tf=CI=class extends p0{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new CI({style:this.style})}};u([h({type:["style"],json:{write:{isRequired:!0}}})],tf.prototype,"type",void 0),u([h({type:Hde,json:{read:!0,write:{isRequired:!0}}})],tf.prototype,"style",void 0),tf=CI=u([E("esri.symbols.patterns.StylePattern3D")],tf);const Wde={types:{key:"type",base:p0,typeMap:{style:tf}},json:{write:!0}},m7={types:{key:"type",base:d0,typeMap:{style:Ah}},json:{write:!0}},f0=new K("white"),Zde=new K([255,255,255,0]);function Jde(t){return t.r===0&&t.g===0&&t.b===0}var PI;let m0=PI=class extends us{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color?.clone()??null,colorMixMode:this.colorMixMode,emissive:this.emissive?.clone()??null};return new PI(t)}};u([ye({multiply:"multiply",replace:"replace",tint:"tint"})],m0.prototype,"colorMixMode",void 0),m0=PI=u([E("esri.symbols.support.Symbol3DFillMaterial")],m0);function bk(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Yde(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function Xde(t,e,r,i,s,n,o,a,l,c,d,p,m,y,g,v){return[t,e,r,i,s,n,o,a,l,c,d,p,m,y,g,v]}const Kde=bk();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:Kde,clone:Yde,create:bk,fromValues:Xde},Symbol.toStringTag,{value:"Module"}));function Qde(t){return t<=uz?new Array(t).fill(0):new Float64Array(t)}function eDe(t){return(lz(t)?t.byteLength/8:t.length)<=uz?Array.from(t):new Float64Array(t)}function tDe(t,e,r){return Array.isArray(t)?t.slice(e,e+r):t.subarray(e,e+r)}function rDe(t){return[...t]}function iDe(t){const e=bk();for(let r=0;r<16;++r)e[r]=t[r];return e}function Gv(t=ipe){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function Sk(t,e,r,i,s,n,o=Gv()){return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o[4]=s,o[5]=n,o}function sDe(t,e=Gv()){return epe(t,0,t.length/3,e)}function epe(t,e,r,i=Gv()){return y7(i,kI),tpe(i,t,e,r),i}function nDe(t,e=Qde(24)){const[r,i,s,n,o,a]=t;return e[0]=r,e[1]=i,e[2]=s,e[3]=r,e[4]=i,e[5]=a,e[6]=r,e[7]=o,e[8]=s,e[9]=r,e[10]=o,e[11]=a,e[12]=n,e[13]=i,e[14]=s,e[15]=n,e[16]=i,e[17]=a,e[18]=n,e[19]=o,e[20]=s,e[21]=n,e[22]=o,e[23]=a,e}function oDe(t,e){const r=isFinite(t[2])||isFinite(t[5]);return new Te(r?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function aDe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function lDe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function uDe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function tpe(t,e,r=0,i=e.length/3){let s=t[0],n=t[1],o=t[2],a=t[3],l=t[4],c=t[5];for(let d=0;d<i;d++)s=Math.min(s,e[r+3*d]),n=Math.min(n,e[r+3*d+1]),o=Math.min(o,e[r+3*d+2]),a=Math.max(a,e[r+3*d]),l=Math.max(l,e[r+3*d+1]),c=Math.max(c,e[r+3*d+2]);t[0]=s,t[1]=n,t[2]=o,t[3]=a,t[4]=l,t[5]=c}function cDe(t,e,r){const i=e.length;let s=t[0],n=t[1],o=t[2],a=t[3],l=t[4],c=t[5];if(r)for(let d=0;d<i;d++){const p=e[d];s=Math.min(s,p[0]),n=Math.min(n,p[1]),o=Math.min(o,p[2]),a=Math.max(a,p[0]),l=Math.max(l,p[1]),c=Math.max(c,p[2])}else for(let d=0;d<i;d++){const p=e[d];s=Math.min(s,p[0]),n=Math.min(n,p[1]),a=Math.max(a,p[0]),l=Math.max(l,p[1])}t[0]=s,t[1]=n,t[2]=o,t[3]=a,t[4]=l,t[5]=c}function hDe(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function qv(t){return t[0]>=t[3]?0:t[3]-t[0]}function Bv(t){return t[1]>=t[4]?0:t[4]-t[1]}function Hv(t){return t[2]>=t[5]?0:t[5]-t[2]}function dDe(t){const e=qv(t),r=Hv(t),i=Bv(t);return Math.sqrt(e*e+r*r+i*i)}function pDe(t,e=[0,0,0]){return e[0]=t[0]+qv(t)/2,e[1]=t[1]+Bv(t)/2,e[2]=t[2]+Hv(t)/2,e}function fDe(t,e=[0,0,0]){return e[0]=qv(t),e[1]=Bv(t),e[2]=Hv(t),e}function mDe(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function rpe(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function yDe(t,e){return e==null||rpe(t,e)}function gDe(t,e,r,i,s=t){return s[0]=t[0]+e,s[1]=t[1]+r,s[2]=t[2]+i,s[3]=t[3]+e,s[4]=t[4]+r,s[5]=t[5]+i,s}function vDe(t,e,r=t){const i=t[0]+qv(t)/2,s=t[1]+Bv(t)/2,n=t[2]+Hv(t)/2;return r[0]=i+(t[0]-i)*e,r[1]=s+(t[1]-s)*e,r[2]=n+(t[2]-n)*e,r[3]=i+(t[3]-i)*e,r[4]=s+(t[4]-s)*e,r[5]=n+(t[5]-n)*e,r}function wDe(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function _De(t,e,r=t){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r!==t&&(r[3]=t[3],r[4]=t[4],r[5]=t[5]),r}function bDe(t,e,r=t){return r[3]=e[0],r[4]=e[1],r[5]=e[2],r!==t&&(r[0]=t[0],r[1]=t[1],r[2]=t[2]),t}function y7(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function SDe(t){return t?y7(t,kI):Gv(kI)}function xDe(t,e=lr()){return e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function $De(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function MDe(t,e,r,i,s){return t[0]=e,t[1]=r,t[2]=Number.NEGATIVE_INFINITY,t[3]=i,t[4]=s,t[5]=Number.POSITIVE_INFINITY,t}function m5(t){return t.length===6}function TDe(t){return qv(t)===0&&Bv(t)===0&&Hv(t)===0}function IDe(t,e,r){if(t==null||e==null)return t===e;if(!m5(t)||!m5(e))return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}const kI=[1/0,1/0,1/0,-1/0,-1/0,-1/0],ipe=[0,0,0,0,0,0];Gv();function EDe(t,{isPrimitive:e,width:r,depth:i,height:s}){const n=e?10:1;if(r==null&&s==null&&i==null)return[n*t[0],n*t[1],n*t[2]];const o=Km(r,i,s);let a;for(let l=0;l<3;l++){const c=o[l];if(c!=null){a=c/t[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=t[l]*a);return o}const spe=Sk(-.5,-.5,-.5,.5,.5,.5),npe=Sk(-.5,-.5,0,.5,.5,1),ope=Sk(-.5,-.5,0,.5,.5,.5);function CDe(t){switch(t){case"sphere":case"cube":case"diamond":return spe;case"cylinder":case"cone":case"inverted-cone":return npe;case"tetrahedron":return ope;default:return}}const xk=["butt","square","round"],ape=[...xk,"none"],g7=["miter","bevel","round"];var LI;let Zc=LI=class extends W{constructor(t){super(t),this.color=new K([0,0,0,1]),this.size=Ke(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new LI(t)}};u([h(wc({colorRequiredOnWrite:!0}))],Zc.prototype,"color",void 0),u([h({...ba,json:{write:{isRequired:!0}}})],Zc.prototype,"size",void 0),u([h(m7)],Zc.prototype,"pattern",void 0),u([h({type:xk,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],Zc.prototype,"patternCap",void 0),Zc=LI=u([E("esri.symbols.support.Symbol3DOutline")],Zc);var db,jf;let Fi=(jf=class extends Ui{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const e={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new db(e)}static fromSimpleFillSymbol(e){const r=e.outline&&e.outline.style&&e.outline.style!=="solid"?new Ah({style:e.outline.style}):null,i={size:e.outline?.width??0,color:(e.outline?.color??f0).clone(),pattern:r};return r&&e.outline?.cap&&(i.patternCap=e.outline.cap),new db({material:new m0({color:(e.color??Zde).clone()}),pattern:e.style&&e.style!=="solid"?new tf({style:e.style}):null,outline:i})}},db=jf,jf);u([ye({Fill:"fill"},{readOnly:!0})],Fi.prototype,"type",void 0),u([h({type:m0,json:{write:!0}})],Fi.prototype,"material",void 0),u([h(Wde)],Fi.prototype,"pattern",void 0),u([h({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Fi.prototype,"castShadows",void 0),u([h({type:Zc,json:{write:!0}})],Fi.prototype,"outline",void 0),u([h(f7)],Fi.prototype,"edges",void 0),Fi=db=u([E("esri.symbols.FillSymbol3DLayer")],Fi);var AI;const lpe=yr()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let Jc=AI=class extends W{constructor(t){super(t)}readHref(t,e,r){return t?Il(t,r):e.dataURI}writeHref(t,e,r,i){t&&(fd(t)?e.dataURI=t:(e.href=td(t,i),cs(e.href)&&(e.href=Qn(e.href))))}clone(){return new AI({href:this.href,primitive:this.primitive})}equals(t){return t.primitive===this.primitive&&t.href===this.href}};u([h({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],Jc.prototype,"href",void 0),u([X("href")],Jc.prototype,"readHref",null),u([te("href",{href:{type:String},dataURI:{type:String}})],Jc.prototype,"writeHref",null),u([ye(lpe)],Jc.prototype,"primitive",void 0),Jc=AI=u([E("esri.symbols.support.IconSymbol3DLayerResource")],Jc);const upe="circle";let pb=class extends Ie(W){constructor(e){super(e),this.mode="hidden"}equals(e){return this.mode===e.mode}};u([h({type:["adaptive","hidden","visible"],json:{write:{isRequired:!0}}})],pb.prototype,"mode",void 0),pb=u([E("esri.symbols.support.OccludedVisibility")],pb);const v7=pb;var RI;let rf=RI=class extends le{constructor(t){super(t),this.x=0,this.y=0}clone(){return new RI({x:this.x,y:this.y})}equals(t){return t.x===this.x&&t.y===this.y}};u([h({type:Number})],rf.prototype,"x",void 0),u([h({type:Number})],rf.prototype,"y",void 0),rf=RI=u([E("esri.symbols.support.Symbol3DAnchorPosition2D")],rf);var OI;let yg=OI=class extends W{constructor(t){super(t),this.color=new K([0,0,0,1]),this.size=Ke(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new OI(t)}equals(t){return t.size===this.size&&(this.color==null?t.color==null:this.color.equals(t.color))}};u([h(wc({colorRequiredOnWrite:!0}))],yg.prototype,"color",void 0),u([h({...ba,json:{write:{isRequired:!0}}})],yg.prototype,"size",void 0),yg=OI=u([E("esri.symbols.support.Symbol3DIconOutline")],yg);var fp,Vf;let zr=(Vf=class extends Ui{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0,this.occludedVisibility=null}clone(){return new fp({anchor:this.anchor,anchorPosition:O(this.anchorPosition),enabled:this.enabled,material:O(this.material),outline:O(this.outline),resource:O(this.resource),angle:this.angle,size:this.size,occludedVisibility:O(this.occludedVisibility)})}static fromSimpleMarkerSymbol(e){const r=e.color||f0,i=y5(e),s=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||f0).clone()}:null;return new fp({size:e.size,angle:e.angle,resource:{primitive:hpe(()=>U.getLogger(this.prototype),e.style)},material:{color:r},outline:s,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(e){const r=!e.color||Jde(e.color)?f0:e.color,i=y5(e);return new fp({size:e.width<=e.height?e.height:e.width,angle:e.angle,resource:{href:e.url},material:{color:r.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(e){return new fp({resource:{href:Ez({mediaType:"application/json",data:JSON.stringify(e.data)})}})}},fp=Vf,Vf);function y5(t){const e="width"in t?t.width:t.size,r="height"in t?t.height:t.size,i=g5(t.xoffset),s=g5(t.yoffset);return(i||s)&&e&&r?{x:-i/e,y:s/r}:null}function g5(t){return isFinite(t)?t:0}u([h({type:us,json:{write:!0}})],zr.prototype,"material",void 0),u([h({type:Jc,json:{write:!0}})],zr.prototype,"resource",void 0),u([ye({Icon:"icon"},{readOnly:!0})],zr.prototype,"type",void 0),u([h({...ba,json:{write:{isRequired:!0}}})],zr.prototype,"size",void 0),u([ye({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],zr.prototype,"anchor",void 0),u([h({type:rf,json:{type:[Number],read:{reader:t=>new rf({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],zr.prototype,"anchorPosition",void 0),u([h({type:yg,json:{write:!0}})],zr.prototype,"outline",void 0),u([h({type:Number,json:{write:!0,default:0}})],zr.prototype,"angle",void 0),u([h({type:v7})],zr.prototype,"occludedVisibility",void 0),zr=fp=u([E("esri.symbols.IconSymbol3DLayer")],zr);const cpe={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function hpe(t,e){return cpe[e]||(t().warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const dpe=["begin","end","begin-end"],w7=["arrow","circle","square","diamond","cross","x"];let ul=class extends Ie(W){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};u([h({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],ul.prototype,"type",void 0),u([h({type:dpe,json:{default:"begin-end",write:!0}})],ul.prototype,"placement",void 0),u([h({type:w7,json:{default:"arrow",write:!0}})],ul.prototype,"style",void 0),u([h({type:K,json:{type:[Ue],default:null,write:!0}})],ul.prototype,"color",void 0),ul=u([E("esri.symbols.LineStyleMarker3D")],ul);var fb,Uf;let Oi=(Uf=class extends Ui{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=Ke(1),this.pattern=null,this.marker=null}clone(){const e={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new fb(e)}static fromSimpleLineSymbol(e){const r={enabled:!0,size:e.width??Ke(1),cap:e.cap||"butt",join:e.join||"miter",pattern:e.style?new Ah({style:e.style}):null,material:new us({color:(e.color||f0).clone()}),marker:e.marker?new ul({placement:e.marker.placement,style:e.marker.style,color:e.marker.color?.clone()??null}):null};return new fb(r)}},fb=Uf,Uf);u([h({type:us,json:{write:!0}})],Oi.prototype,"material",void 0),u([ye({Line:"line"},{readOnly:!0})],Oi.prototype,"type",void 0),u([h({type:g7,json:{write:!0,default:"miter"}})],Oi.prototype,"join",void 0),u([h({type:xk,json:{write:!0,default:"butt"}})],Oi.prototype,"cap",void 0),u([h({...ba,json:{write:{isRequired:!0}}})],Oi.prototype,"size",void 0),u([h(m7)],Oi.prototype,"pattern",void 0),u([h({types:{key:"type",base:ul,typeMap:{style:ul}},json:{write:!0}})],Oi.prototype,"marker",void 0),Oi=fb=u([E("esri.symbols.LineSymbol3DLayer")],Oi);var FI;const ppe=yr()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let gg=FI=class extends W{clone(){return new FI({href:this.href,primitive:this.primitive})}};u([h({type:String,json:{read:BS,write:rd}})],gg.prototype,"href",void 0),u([ye(ppe)],gg.prototype,"primitive",void 0),gg=FI=u([E("esri.symbols.support.ObjectSymbol3DLayerResource")],gg);const fpe="sphere";var NI;let bh=NI=class extends le{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new NI({x:this.x,y:this.y,z:this.z})}};u([h({type:Number})],bh.prototype,"x",void 0),u([h({type:Number})],bh.prototype,"y",void 0),u([h({type:Number})],bh.prototype,"z",void 0),bh=NI=u([E("esri.symbols.support.Symbol3DAnchorPosition3D")],bh);var DI,Gf;let Nr=(Gf=class extends Ui{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new DI({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition?.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material?.clone()??null,castShadows:this.castShadows,resource:this.resource?.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}},DI=Gf,Gf);u([h({type:us,json:{write:!0}})],Nr.prototype,"material",void 0),u([h({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Nr.prototype,"castShadows",void 0),u([h({type:gg,json:{write:!0}})],Nr.prototype,"resource",void 0),u([ye({Object:"object"},{readOnly:!0})],Nr.prototype,"type",void 0),u([h({type:Number,json:{write:!0}})],Nr.prototype,"width",void 0),u([h({type:Number,json:{write:!0}})],Nr.prototype,"height",void 0),u([h({type:Number,json:{write:!0}})],Nr.prototype,"depth",void 0),u([ye({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],Nr.prototype,"anchor",void 0),u([h({type:bh,json:{type:[Number],read:{reader:t=>new bh({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Nr.prototype,"anchorPosition",void 0),u([h({type:Number,json:{write:!0}})],Nr.prototype,"heading",void 0),u([h({type:Number,json:{write:!0}})],Nr.prototype,"tilt",void 0),u([h({type:Number,json:{write:!0}})],Nr.prototype,"roll",void 0),u([h({readOnly:!0})],Nr.prototype,"isPrimitive",null),Nr=DI=u([E("esri.symbols.ObjectSymbol3DLayer")],Nr);var zI,qf;let Zr=(qf=class extends Ui{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(e,r){return e??(r.height==null&&r.size!=null?r.size:void 0)}readHeight(e,r){return e??(r.width==null&&r.size!=null?r.size:void 0)}clone(){return new zI({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}},zI=qf,qf);u([h({type:us,json:{write:!0}})],Zr.prototype,"material",void 0),u([h({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Zr.prototype,"castShadows",void 0),u([ye({Path:"path"},{readOnly:!0})],Zr.prototype,"type",void 0),u([h({type:["circle","quad"],nonNullable:!0,json:{write:!0,default:"circle"}})],Zr.prototype,"profile",void 0),u([h({type:g7,nonNullable:!0,json:{write:!0,default:"miter"}})],Zr.prototype,"join",void 0),u([h({type:ape,nonNullable:!0,json:{write:!0,default:"butt"}})],Zr.prototype,"cap",void 0),u([h({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],Zr.prototype,"width",void 0),u([X("width",["width","size","height"])],Zr.prototype,"readWidth",null),u([h({type:Number,json:{write:!0}})],Zr.prototype,"height",void 0),u([X("height",["height","size","width"])],Zr.prototype,"readHeight",null),u([h({type:["center","bottom","top"],nonNullable:!0,json:{write:!0,default:"center"}})],Zr.prototype,"anchor",void 0),u([h({type:["heading","all"],nonNullable:!0,json:{write:!0,default:"all"}})],Zr.prototype,"profileRotation",void 0),Zr=zI=u([E("esri.symbols.PathSymbol3DLayer")],Zr);const mpe=["none","underline","line-through"],ype=["normal","italic","oblique"],gpe=["normal","lighter","bold","bolder"],_7={type:Number,cast:t=>{const e=zi(t);return e===0?1:Qr(e,.1,4)},nonNullable:!0},vpe=["left","right","center"],wpe=["baseline","top","middle","bottom"],b7={type:vpe,nonNullable:!0},S7={type:wpe,nonNullable:!0},_pe=8;var jI;let Cs=jI=class extends W{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return ze(t)}clone(){return new jI({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};u([h({type:mpe,json:{default:"none",write:!0}})],Cs.prototype,"decoration",void 0),u([h({type:String,json:{write:!0}})],Cs.prototype,"family",void 0),u([h({type:Number,json:{write:{overridePolicy:(t,e,r)=>({enabled:!r||!r.textSymbol3D})}}})],Cs.prototype,"size",void 0),u([He("size")],Cs.prototype,"castSize",null),u([h({type:ype,json:{default:"normal",write:!0}})],Cs.prototype,"style",void 0),u([h({type:gpe,json:{default:"normal",write:!0}})],Cs.prototype,"weight",void 0),Cs=jI=u([E("esri.symbols.Font")],Cs);var VI;let sf=VI=class extends W{constructor(){super(...arguments),this.color=new K([0,0,0,1]),this.size=0}clone(){const t={color:O(this.color),size:this.size};return new VI(t)}};u([h(wc())],sf.prototype,"color",void 0),u([h(ba)],sf.prototype,"size",void 0),sf=VI=u([E("esri.symbols.support.Symbol3DHalo")],sf);let y0=class extends Ie(W){constructor(e){super(e),this.color=null}};u([h(wc())],y0.prototype,"color",void 0),y0=u([E("esri.symbols.support.Symbol3DTextBackground")],y0);var mb,Bf;let hr=(Bf=class extends Ui{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline",this.occludedVisibility=null}get font(){return this._get("font")||null}set font(e){e!=null&&this._userSize!=null&&(e.size=this._userSize),this._set("font",e)}writeFont(e,r,i,s){const n={...s,textSymbol3D:!0};r.font=e.write({},n),delete r.font.size}get size(){return this._userSize!=null?this._userSize:this.font?.size!=null?this.font.size:9}set size(e){this._userSize=e,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const e=new mb({enabled:this.enabled,font:O(this.font),halo:O(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:O(this.background),occludedVisibility:O(this.occludedVisibility)});return e._userSize=this._userSize,e}static fromTextSymbol(e){return new mb({font:e.font!=null?e.font.clone():new Cs,halo:bpe(e.haloColor,e.haloSize),horizontalAlignment:e.horizontalAlignment,lineHeight:e.lineHeight,material:e.color?new us({color:e.color.clone()}):null,text:e.text,verticalAlignment:e.verticalAlignment,background:e.backgroundColor?new y0({color:e.backgroundColor.clone()}):null})}},mb=Bf,Bf);function bpe(t,e){return t&&e!=null&&e>0?new sf({color:O(t),size:e}):null}u([h({type:Cs,json:{write:!0}})],hr.prototype,"font",null),u([te("font")],hr.prototype,"writeFont",null),u([h({type:sf,json:{write:!0}})],hr.prototype,"halo",void 0),u([h({...b7,json:{default:"center",write:!0}})],hr.prototype,"horizontalAlignment",void 0),u([h({..._7,json:{default:1,write:!0}})],hr.prototype,"lineHeight",void 0),u([h({type:us,json:{write:!0}})],hr.prototype,"material",void 0),u([h({type:y0,json:{write:!0}})],hr.prototype,"background",void 0),u([h(ba)],hr.prototype,"size",null),u([h({type:String,json:{write:!0}})],hr.prototype,"text",void 0),u([ye({Text:"text"},{readOnly:!0})],hr.prototype,"type",void 0),u([h({...S7,json:{default:"baseline",write:!0}})],hr.prototype,"verticalAlignment",void 0),u([h({type:v7})],hr.prototype,"occludedVisibility",void 0),hr=mb=u([E("esri.symbols.TextSymbol3DLayer")],hr);var UI,Hf;let Ka=(Hf=class extends Ui{constructor(e){super(e),this.color=GI.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new UI({color:this.color.clone(),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}},UI=Hf,Hf);u([h({type:K,nonNullable:!0,json:{type:[Ue],write:(t,e,r)=>e[r]=t.toArray(1),default:()=>GI.clone(),defaultEquals:t=>t.toCss(!0)===GI.toCss(!0)}})],Ka.prototype,"color",void 0),u([ye({Water:"water"},{readOnly:!0})],Ka.prototype,"type",void 0),u([h({type:["small","medium","large"],json:{write:!0,default:"medium"}})],Ka.prototype,"waterbodySize",void 0),u([h({type:Number,json:{write:!0,default:null}})],Ka.prototype,"waveDirection",void 0),u([h({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],Ka.prototype,"waveStrength",void 0),Ka=UI=u([E("esri.symbols.WaterSymbol3DLayer")],Ka);const GI=new K([0,119,190]);var qI;let Hn=qI=class extends le{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new qI({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};u([h({type:String})],Hn.prototype,"name",void 0),u([h({type:String})],Hn.prototype,"styleUrl",void 0),u([h({type:String})],Hn.prototype,"styleName",void 0),u([h({type:J})],Hn.prototype,"portal",void 0),Hn=qI=u([E("esri.symbols.support.StyleOrigin")],Hn);var BI;let Hh=BI=class extends le{constructor(){super(...arguments),this.url=""}clone(){return new BI({url:this.url})}};u([h({type:String})],Hh.prototype,"url",void 0),Hh=BI=u([E("esri.symbols.support.Thumbnail")],Hh);const x7={icon:zr,object:Nr,line:Oi,path:Zr,fill:Fi,extrude:Xa,text:hr,water:Ka},Spe=se.ofType({base:Ui,key:"type",typeMap:x7,errorContext:"symbol-layer"});let ss=class extends er{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const r=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,i=r?.type,s=i||se;this._set("symbolLayers",new s)}get color(){return null}set color(e){this.constructed&&U.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){la(e,this._get("symbolLayers"))}readStyleOrigin(e,r,i){if(e.styleUrl&&e.name){const s=Il(e.styleUrl,i);return new Hn({styleUrl:s,name:e.name})}if(e.styleName&&e.name)return new Hn({portal:i?.portal||J.getDefault(),styleName:e.styleName,name:e.name});i?.messages&&i.messages.push(new zs("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:i,definition:e}))}writeStyleOrigin(e,r,i,s){if(e.styleUrl&&e.name){let n=td(e.styleUrl,s);cs(n)&&(n=Qn(n)),r.styleOrigin={styleUrl:n,name:e.name}}else e.styleName&&e.name&&(e.portal&&s?.portal&&!Iz(e.portal.restUrl,s.portal.restUrl)?s?.messages&&s.messages.push(new zs("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):r.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof Ui||e&&x7[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};u([h({json:{read:!1,write:!1}})],ss.prototype,"color",null),u([h({type:Spe,nonNullable:!0,json:{write:!0}}),He(j6)],ss.prototype,"symbolLayers",null),u([h({type:Hn})],ss.prototype,"styleOrigin",void 0),u([X("styleOrigin")],ss.prototype,"readStyleOrigin",null),u([te("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],ss.prototype,"writeStyleOrigin",null),u([h({type:Hh,json:{read:!1}})],ss.prototype,"thumbnail",void 0),u([h({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],ss.prototype,"type",void 0),ss=u([E("esri.symbols.Symbol3D")],ss);let nf=class extends W{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};u([h({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],nf.prototype,"type",void 0),u([h({readOnly:!0})],nf.prototype,"visible",void 0),nf=u([E("esri.symbols.callouts.Callout3D")],nf);var HI;let yb=HI=class extends W{constructor(t){super(t),this.color=new K("white")}clone(){return new HI({color:O(this.color)})}};u([h(wc({colorRequiredOnWrite:!0}))],yb.prototype,"color",void 0),yb=HI=u([E("esri.symbols.callouts.LineCallout3DBorder")],yb);const xpe=yb;var WI;let Qa=WI=class extends nf{constructor(t){super(t),this.type="line",this.color=new K([0,0,0,1]),this.size=Ke(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new WI({color:O(this.color),size:this.size,border:O(this.border)})}};u([ye({line:"line"})],Qa.prototype,"type",void 0),u([h(wc({colorRequiredOnWrite:!0}))],Qa.prototype,"color",void 0),u([h({...ba,json:{write:{isRequired:!0}}})],Qa.prototype,"size",void 0),u([h({type:xpe,json:{write:!0}})],Qa.prototype,"border",void 0),u([h({readOnly:!0})],Qa.prototype,"visible",null),Qa=WI=u([E("esri.symbols.callouts.LineCallout3D")],Qa);function $k(t){if(!t)return!1;const e=t.verticalOffset;return!(!e||e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function $7(t){return!t||!t.supportsCallout||!t.supportsCallout()?!1:!!t.callout?.visible&&!!$k(t)}function ODe(t){return t.type==="point-3d"||t.type==="label-3d"}function FDe(t){return t.horizontalAlignment==="center"}const M7={types:{key:"type",base:nf,typeMap:{line:Qa}},json:{write:!0}};var ZI;let ku=ZI=class extends W{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new ZI({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};u([h({...ba,json:{write:{isRequired:!0}}})],ku.prototype,"screenLength",void 0),u([h({type:Number,nonNullable:!0,json:{write:!0,default:0}})],ku.prototype,"minWorldLength",void 0),u([h({type:Number,json:{write:!0}})],ku.prototype,"maxWorldLength",void 0),ku=ZI=u([E("esri.symbols.support.Symbol3DVerticalOffset")],ku);var gb;const T7=se.ofType({base:null,key:"type",typeMap:{text:hr}});let Vn=gb=class extends ss{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new T7,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return $7(this)}hasVisibleVerticalOffset(){return $k(this)}clone(){return new gb({styleOrigin:O(this.styleOrigin),symbolLayers:O(this.symbolLayers),thumbnail:O(this.thumbnail),callout:O(this.callout),verticalOffset:O(this.verticalOffset)})}static fromTextSymbol(t){return new gb({symbolLayers:new se([hr.fromTextSymbol(t)])})}};u([h({type:ku,json:{write:!0}})],Vn.prototype,"verticalOffset",void 0),u([h(M7)],Vn.prototype,"callout",void 0),u([h({json:{read:!1,write:!1}})],Vn.prototype,"styleOrigin",void 0),u([h({type:T7})],Vn.prototype,"symbolLayers",void 0),u([ye({LabelSymbol3D:"label-3d"},{readOnly:!0})],Vn.prototype,"type",void 0),Vn=gb=u([E("esri.symbols.LabelSymbol3D")],Vn);var vb;const I7=se.ofType({base:null,key:"type",typeMap:{line:Oi,path:Zr}}),$pe=se.ofType({base:null,key:"type",typeMap:{line:Oi,path:Zr}});let Kn=vb=class extends ss{constructor(t){super(t),this.symbolLayers=new I7,this.type="line-3d"}clone(){return new vb({styleOrigin:O(this.styleOrigin),symbolLayers:O(this.symbolLayers),thumbnail:O(this.thumbnail)})}static fromSimpleLineSymbol(t){return new vb({symbolLayers:new se([Oi.fromSimpleLineSymbol(t)])})}};u([h({type:I7,json:{type:$pe}})],Kn.prototype,"symbolLayers",void 0),u([ye({LineSymbol3D:"line-3d"},{readOnly:!0})],Kn.prototype,"type",void 0),Kn=vb=u([E("esri.symbols.LineSymbol3D")],Kn);var wb;const E7=se.ofType({base:null,key:"type",typeMap:{fill:Fi}});let yl=wb=class extends ss{constructor(t){super(t),this.symbolLayers=new E7,this.type="mesh-3d"}clone(){return new wb({styleOrigin:O(this.styleOrigin),symbolLayers:O(this.symbolLayers),thumbnail:O(this.thumbnail)})}static fromSimpleFillSymbol(t){return new wb({symbolLayers:new se([Fi.fromSimpleFillSymbol(t)])})}};u([h({type:E7})],yl.prototype,"symbolLayers",void 0),u([ye({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],yl.prototype,"type",void 0),yl=wb=u([E("esri.symbols.MeshSymbol3D")],yl);let vg=class extends er{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};u([ye({esriSLS:"simple-line"},{readOnly:!0})],vg.prototype,"type",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],vg.prototype,"width",void 0),vg=u([E("esri.symbols.LineSymbol")],vg);var JI;let fo=JI=class extends W{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,r,i){e[r]=i?.origin==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t?.[0]!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,r,i){i?.origin==="web-map"||(e[r]=t)}clone(){return new JI({color:O(this.color),placement:this.placement,style:this.style})}hash(){return`${this.placement}.${this.color?.hash()}.${this.style}`}};u([h({type:["begin","end","begin-end"],json:{write:!0}})],fo.prototype,"placement",void 0),u([ye({"line-marker":"line-marker"},{readOnly:!0}),h({json:{origins:{"web-map":{write:!1}}}})],fo.prototype,"type",void 0),u([h({type:w7})],fo.prototype,"style",void 0),u([te("style")],fo.prototype,"writeStyle",null),u([h({type:K,value:null,json:{write:{allowNull:!0}}})],fo.prototype,"color",null),u([X("color")],fo.prototype,"readColor",null),u([te("color")],fo.prototype,"writeColor",null),fo=JI=u([E("esri.symbols.LineSymbolMarker")],fo);const Mpe=fo;var YI;const n$=new Ne({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let Ot=YI=class extends vg{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,r,i,s,n){if(t&&typeof t!="string")return t;const o={};return t!=null&&(o.style=t),e!=null&&(o.color=e),r!=null&&(o.width=ze(r)),i!=null&&(o.cap=i),s!=null&&(o.join=s),n!=null&&(o.miterLimit=ze(n)),o}clone(){return new YI({color:O(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:this.marker?.clone()})}hash(){return`${super.hash()}.${this.color?.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${this.marker?.hash()}`}};u([ye({esriSLS:"simple-line"},{readOnly:!0})],Ot.prototype,"type",void 0),u([h({type:n$.apiValues,json:{read:n$.read,write:n$.write}})],Ot.prototype,"style",void 0),u([h({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,r)=>({enabled:t!=="round"&&r?.origin==null})}}})],Ot.prototype,"cap",void 0),u([h({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,r)=>({enabled:t!=="round"&&r?.origin==null})}}})],Ot.prototype,"join",void 0),u([h({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":Mpe}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],Ot.prototype,"marker",void 0),u([h({type:Number,json:{read:!1,write:!1}})],Ot.prototype,"miterLimit",void 0),Ot=YI=u([E("esri.symbols.SimpleLineSymbol")],Ot);let of=class extends er{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline?.hash()}`}};u([h({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Ot}},json:{default:null,write:!0}})],of.prototype,"outline",void 0),u([h({type:["simple-fill","picture-fill"],readOnly:!0})],of.prototype,"type",void 0),of=u([E("esri.symbols.FillSymbol")],of);function Tpe(t,e,r){return e.imageData?Ez({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):C7(e.url,r)}function C7(t,e){if(!cs(t)){const r=Epe(e);if(r)return ed(r,"images",t)}return Il(t,e)}function Ipe(t,e,r,i){if(fd(t)){const s=cm(t);if(!s)return;e.contentType=s.mediaType,e.imageData=s.data,r&&r.imageData===e.imageData&&r.url&&rd(r.url,e,"url",i)}else rd(t,e,"url",i)}const P7={json:{read:{source:["imageData","url"],reader:Tpe},write:{writer(t,e,r,i){Ipe(t,e,this.source,i)}}}},k7={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,r){const i={};return e.imageData&&(i.imageData=e.imageData),e.contentType&&(i.contentType=e.contentType),e.url&&(i.url=C7(e.url,r)),i}}}};function Epe(t){if(!t)return null;const{origin:e,layer:r}=t;if(e!=="service"&&e!=="portal-item")return null;const i=r?.type;return i==="feature"||i==="stream"?r.parsedUrl?.path:i==="map-image"||i==="tile"?t.url?.path:null}var XI;let rs=XI=class extends of{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,r,i){if(t&&typeof t!="string"&&t.imageData==null)return t;const s={};return t&&(s.url=t),e&&(s.outline=e),r!=null&&(s.width=ze(r)),i!=null&&(s.height=ze(i)),s}clone(){const t=new XI({color:O(this.color),height:this.height,outline:O(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",O(this.source)),t}hash(){return`${super.hash()}.${this.color?.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};u([ye({esriPFS:"picture-fill"},{readOnly:!0})],rs.prototype,"type",void 0),u([h(P7)],rs.prototype,"url",void 0),u([h({type:Number,json:{write:!0}})],rs.prototype,"xscale",void 0),u([h({type:Number,json:{write:!0}})],rs.prototype,"yscale",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],rs.prototype,"width",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],rs.prototype,"height",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],rs.prototype,"xoffset",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],rs.prototype,"yoffset",void 0),u([h(k7)],rs.prototype,"source",void 0),rs=XI=u([E("esri.symbols.PictureFillSymbol")],rs);let el=class extends er{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};u([h({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],el.prototype,"angle",void 0),u([h({type:["simple-marker","picture-marker"],readOnly:!0})],el.prototype,"type",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],el.prototype,"xoffset",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],el.prototype,"yoffset",void 0),u([h({cast:t=>t==="auto"?t:zi(ze(t)),json:{write:!0}})],el.prototype,"size",void 0),el=u([E("esri.symbols.MarkerSymbol")],el);var KI;let ci=KI=class extends el{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,r){if(t&&typeof t!="string"&&t.imageData==null)return t;const i={};return t&&(i.url=t),e!=null&&(i.width=ze(e)),r!=null&&(i.height=ze(r)),i}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new KI({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",O(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};u([h({json:{write:!1}})],ci.prototype,"color",void 0),u([ye({esriPMS:"picture-marker"},{readOnly:!0})],ci.prototype,"type",void 0),u([h(P7)],ci.prototype,"url",void 0),u([h(k7)],ci.prototype,"source",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],ci.prototype,"height",void 0),u([X("height",["height","size"])],ci.prototype,"readHeight",null),u([h({type:Number,cast:ze,json:{write:!0}})],ci.prototype,"width",void 0),u([h({json:{write:!1}})],ci.prototype,"size",void 0),ci=KI=u([E("esri.symbols.PictureMarkerSymbol")],ci);var Yc;const L7=se.ofType({base:null,key:"type",typeMap:{icon:zr,object:Nr,text:hr}});let ji=Yc=class extends ss{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new L7,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return $7(this)}hasVisibleVerticalOffset(){return $k(this)}clone(){return new Yc({verticalOffset:O(this.verticalOffset),callout:O(this.callout),styleOrigin:O(this.styleOrigin),symbolLayers:O(this.symbolLayers),thumbnail:O(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new Yc({symbolLayers:new se([zr.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new Yc({symbolLayers:new se([zr.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){if(t.data?.symbol?.type!=="CIMPointSymbol")return null;const r=t.data.symbol;return new Yc(r?.callout?{symbolLayers:new se([zr.fromCIMSymbol(t)]),callout:new Qa({size:.5,color:new K([0,0,0])}),verticalOffset:new ku({screenLength:40})}:{symbolLayers:new se([zr.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new Yc({symbolLayers:new se([hr.fromTextSymbol(t)])})}};u([h({type:ku,json:{write:!0}})],ji.prototype,"verticalOffset",void 0),u([h(M7)],ji.prototype,"callout",void 0),u([h({type:L7,json:{origins:{"web-scene":{write:!0}}}})],ji.prototype,"symbolLayers",void 0),u([ye({PointSymbol3D:"point-3d"},{readOnly:!0})],ji.prototype,"type",void 0),ji=Yc=u([E("esri.symbols.PointSymbol3D")],ji);var wg;const A7=se.ofType({base:null,key:"type",typeMap:{extrude:Xa,fill:Fi,icon:zr,line:Oi,object:Nr,text:hr,water:Ka}});let dn=wg=class extends ss{constructor(t){super(t),this.symbolLayers=new A7,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&El(U.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&El(U.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(pn(()=>this.symbolLayers,"after-add",({item:e})=>t(e),wa))}clone(){return new wg({styleOrigin:O(this.styleOrigin),symbolLayers:O(this.symbolLayers),thumbnail:O(this.thumbnail)})}static fromJSON(t){const e=new wg;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const r=e.symbolLayers.at(0),i=e.symbolLayers.at(1);!i.enabled||t.symbolLayers?.[1]&&t.symbolLayers[1].enable===!1||(r.outline={size:i.size,color:i.material!=null?i.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new wg({symbolLayers:new se([Fi.fromSimpleFillSymbol(t)])})}};u([h({type:A7,json:{write:!0}})],dn.prototype,"symbolLayers",void 0),u([ye({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],dn.prototype,"type",void 0),dn=wg=u([E("esri.symbols.PolygonSymbol3D")],dn);var QI;const o$=new Ne({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let vi=QI=class extends of{constructor(...t){super(...t),this.color=new K([0,0,0,.25]),this.outline=new Ot,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,r){if(t&&typeof t!="string")return t;const i={};return t&&(i.style=t),e&&(i.outline=e),r&&(i.color=r),i}clone(){return new QI({color:O(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};u([h()],vi.prototype,"color",void 0),u([h()],vi.prototype,"outline",void 0),u([ye({esriSFS:"simple-fill"},{readOnly:!0})],vi.prototype,"type",void 0),u([h({type:o$.apiValues,json:{read:o$.read,write:o$.write}})],vi.prototype,"style",void 0),vi=QI=u([E("esri.symbols.SimpleFillSymbol")],vi);var e3;const a$=new Ne({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Pt=e3=class extends el{constructor(...t){super(...t),this.color=new K([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Ot}normalizeCtorArgs(t,e,r,i){if(t&&typeof t!="string")return t;const s={};return t&&(s.style=t),e!=null&&(s.size=ze(e)),r&&(s.outline=r),i&&(s.color=i),s}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new e3({angle:this.angle,color:O(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${this.outline?.hash()}`}};u([h()],Pt.prototype,"color",void 0),u([te("color")],Pt.prototype,"writeColor",null),u([ye({esriSMS:"simple-marker"},{readOnly:!0})],Pt.prototype,"type",void 0),u([h()],Pt.prototype,"size",void 0),u([h({type:a$.apiValues,json:{read:a$.read,write:a$.write}})],Pt.prototype,"style",void 0),u([h({type:String,json:{write:!0}})],Pt.prototype,"path",null),u([h({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Ot}},json:{default:null,write:!0}})],Pt.prototype,"outline",void 0),Pt=e3=u([E("esri.symbols.SimpleMarkerSymbol")],Pt);var t3;let rt=t3=class extends er{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new Cs,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,r){if(t&&typeof t!="string")return t;const i={};return t&&(i.text=t),e&&(i.font=e),r&&(i.color=r),i}writeLineWidth(t,e,r,i){i&&typeof i!="string"?i.origin:e[r]=t}castLineWidth(t){return ze(t)}writeLineHeight(t,e,r,i){i&&typeof i!="string"?i.origin:e[r]=t}clone(){return new t3({angle:this.angle,backgroundColor:O(this.backgroundColor),borderLineColor:O(this.borderLineColor),borderLineSize:this.borderLineSize,color:O(this.color),font:this.font&&this.font.clone(),haloColor:O(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor?.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color?.hash()}.${this.font&&this.font.hash()}.${this.haloColor?.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};u([h({type:K,json:{write:!0}})],rt.prototype,"backgroundColor",void 0),u([h({type:K,json:{write:!0}})],rt.prototype,"borderLineColor",void 0),u([h({type:Number,json:{write:!0},cast:ze})],rt.prototype,"borderLineSize",void 0),u([h({type:Cs,json:{write:!0}})],rt.prototype,"font",void 0),u([h({...b7,json:{write:!0}})],rt.prototype,"horizontalAlignment",void 0),u([h({type:Boolean,json:{write:!0}})],rt.prototype,"kerning",void 0),u([h({type:K,json:{write:!0}})],rt.prototype,"haloColor",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],rt.prototype,"haloSize",void 0),u([h({type:Boolean,json:{write:!0}})],rt.prototype,"rightToLeft",void 0),u([h({type:Boolean,json:{write:!0}})],rt.prototype,"rotated",void 0),u([h({type:String,json:{write:!0}})],rt.prototype,"text",void 0),u([ye({esriTS:"text"},{readOnly:!0})],rt.prototype,"type",void 0),u([h({...S7,json:{write:!0}})],rt.prototype,"verticalAlignment",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],rt.prototype,"xoffset",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],rt.prototype,"yoffset",void 0),u([h({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],rt.prototype,"angle",void 0),u([h({type:Number,json:{write:!0}})],rt.prototype,"width",void 0),u([h({type:Number})],rt.prototype,"lineWidth",void 0),u([te("lineWidth")],rt.prototype,"writeLineWidth",null),u([He("lineWidth")],rt.prototype,"castLineWidth",null),u([h(_7)],rt.prototype,"lineHeight",void 0),u([te("lineHeight")],rt.prototype,"writeLineHeight",null),rt=t3=u([E("esri.symbols.TextSymbol")],rt);var r3;let Jr=r3=class extends er{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:J.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e?.portal,super.read(t,e)}clone(){return new r3({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol(t)}async fetchCIMSymbol(t){Kz(U.getLogger(this),"WebStyleSymbol.fetchCIMSymbol is deprecated in favour of WebStyleSymbol.fetchSymbol which now supports both web and cim symbology",{version:"4.33",replacement:"WebStyleSymbol.fetchSymbol",see:"https://arcg.is/0CXPTr#fetchSymbol",warnOnce:!0});const e=await this._fetchSymbol({...t,acceptedFormats:["cim"]});if(e?.type!=="cim")throw new R("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return e}async _fetchSymbol(t){const e=t!=null?t.cache:null,r=e?this._fetchCacheKey:null;if(e!=null){const o=r&&e.get(r);if(o)return o.clone()}const{resolveWebStyleSymbol:i}=await q(()=>Promise.resolve().then(()=>KIe),void 0);gt(t);const s=i(this,{portal:this.portal},t);s.catch(o=>{U.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",o)});const n=await s;return e?.set(r,n.clone()),n}};u([h({json:{write:!1}})],Jr.prototype,"color",void 0),u([h({type:String,json:{write:!0}})],Jr.prototype,"styleName",void 0),u([h({type:J,json:{write:!1}})],Jr.prototype,"portal",void 0),u([h({type:String,json:{read:BS,write:rd}})],Jr.prototype,"styleUrl",void 0),u([h({type:Hh,json:{read:!1}})],Jr.prototype,"thumbnail",void 0),u([h({type:String,json:{write:!0}})],Jr.prototype,"name",void 0),u([ye({styleSymbolReference:"web-style"},{readOnly:!0})],Jr.prototype,"type",void 0),u([h()],Jr.prototype,"_fetchCacheKey",null),Jr=r3=u([E("esri.symbols.WebStyleSymbol")],Jr);function R2(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function so(t){switch(t?.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const ju={base:er,key:"type",typeMap:{"simple-fill":vi,"picture-fill":rs,"picture-marker":ci,"simple-line":Ot,"simple-marker":Pt,text:rt,"label-3d":Vn,"line-3d":Kn,"mesh-3d":yl,"point-3d":ji,"polygon-3d":dn,"web-style":Jr,cim:yi},errorContext:"symbol"},jDe={base:er,key:"type",typeMap:{"picture-marker":ci,"simple-marker":Pt,"point-3d":ji,cim:yi},errorContext:"symbol"},VDe={base:er,key:"type",typeMap:{"simple-line":Ot,"line-3d":Kn,cim:yi},errorContext:"symbol"},UDe={base:er,key:"type",typeMap:{"simple-fill":vi,"picture-fill":rs,"polygon-3d":dn,cim:yi},errorContext:"symbol"},Cpe={base:er,key:"type",typeMap:{"picture-marker":ci,"simple-marker":Pt,text:rt,"web-style":Jr,cim:yi},errorContext:"symbol"},Ppe=Gm({types:ju}),R7={base:er,key:"type",typeMap:{"simple-fill":vi,"picture-fill":rs,"picture-marker":ci,"simple-line":Ot,"simple-marker":Pt,text:rt,"line-3d":Kn,"mesh-3d":yl,"point-3d":ji,"polygon-3d":dn,"web-style":Jr,cim:yi},errorContext:"symbol"},kpe={base:er,key:"type",typeMap:{text:rt,"label-3d":Vn},errorContext:"symbol"},v5={base:er,key:"type",typeMap:{"line-3d":Kn,"mesh-3d":yl,"point-3d":ji,"polygon-3d":dn,"web-style":Jr,cim:yi},errorContext:"symbol"},Lpe={base:er,key:"type",typeMap:{"label-3d":Vn},errorContext:"symbol"},O7=ma(ju);var i3;function Ape(t){if(!t)return null;const e={};for(const r in t){const i=ac(t[r]);i&&(e[r]=i)}return Object.keys(e).length!==0?e:null}function Rpe(t){if(t==null)return null;const e={};for(const r in t){const i=t[r];i&&(e[r]=i.toJSON())}return Object.keys(e).length!==0?e:null}var Wf;let Rt=(Wf=class extends Ie(W){constructor(e){super(e),this.isAggregate=!1,this.layer=null,this.origin=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:k_(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&bK(U.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(e){const r=this._get("aggregateGeometries");JSON.stringify(r)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const r=this._get("attributes");r!==e&&(this._set("attributes",e),this._notifyLayer("attributes",r,e))}set geometry(e){const r=this._get("geometry");r!==e&&(this._set("geometry",e),e?.type!=="mesh"&&this._notifyLayer("geometry",r,e))}set popupTemplate(e){const r=this._get("popupTemplate");r!==e&&(this._set("popupTemplate",e),this._notifyLayer("popupTemplate",r,e))}set symbol(e){const r=this._get("symbol");r!==e&&(this._set("symbol",e),this._notifyLayer("symbol",r,e))}get version(){return this._version}set visible(e){const r=this._get("visible");r!==e&&(this._set("visible",e),this._notifyLayer("visible",r,e))}cloneShallow(){return new i3({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const r=zde(this.origin);if(r)return r.popupTemplate??(e?r.defaultPopupTemplate:null)??null;const i=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const s of[i,this.sourceLayer,this.layer])if(s&&typeof s=="object"){if("popupTemplate"in s&&s.popupTemplate)return s.popupTemplate;if(e&&"defaultPopupTemplate"in s&&s.defaultPopupTemplate!=null)return s.defaultPopupTemplate}return null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,r){if(this.attributes){const i=this.getAttribute(e);this.attributes[e]=r,this._notifyLayer("attributes",i,r,e)}else this.attributes={[e]:r}}getObjectId(){const e=d5(this.origin);if(e)return p5(this,e);const r=this.sourceLayer??this.layer;return r?p5(this,r):null}getGlobalId(){const e=d5(this.origin);if(e?.globalIdField)return this.getAttribute(e.globalIdField);const r=this.sourceLayer??this.layer;return r&&"globalIdField"in r&&r.globalIdField?this.getAttribute(r.globalIdField):null}toJSON(){return{aggregateGeometries:Rpe(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:L0(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(e={}){const{geometry:r}=this;if(r?.type==="mesh"){const i={origin:r.origin,transform:r.transform};this._notifyLayer("origin-transform",i,i,e.action)}}_notifyLayer(e,r,i,s){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:e,oldValue:r,newValue:i};e==="origin-transform"&&(n.action=s),e==="attributes"&&(n.attributeName=s),this.layer.graphicChanged(n)}_watchMeshGeometryChanges(){this.addHandles([Ti(()=>this.geometry?.type==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0,({localMatrix:e,origin:r})=>{this._lastMeshTransform.localMatrix===e&&this._lastMeshTransform.origin===r||(this._lastMeshTransform.localMatrix=e,this._lastMeshTransform.origin=r,this.notifyMeshTransformChanged())}),Ti(()=>this.geometry?.type==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0,()=>{const e=this.geometry;e?.type==="mesh"&&e.vertexSpace.origin?(this._lastMeshTransform.localMatrix=e.transform?.localMatrix,this._lastMeshTransform.origin=e.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(e,r)=>e===r,sync:!0})])}},i3=Wf,Wf);u([h({value:null,json:{read:Ape}})],Rt.prototype,"aggregateGeometries",null),u([h({value:null})],Rt.prototype,"attributes",null),u([h({value:null,types:jv,json:{read:ac}})],Rt.prototype,"geometry",null),u([h({type:Boolean})],Rt.prototype,"isAggregate",void 0),u([h({clonable:!1})],Rt.prototype,"layer",void 0),u([h({clonable:"reference"})],Rt.prototype,"origin",void 0),u([h({type:_a,value:null})],Rt.prototype,"popupTemplate",null),u([h({clonable:"reference"})],Rt.prototype,"sourceLayer",void 0),u([h({value:null,types:ju})],Rt.prototype,"symbol",null),u([h({clonable:!1,json:{read:!1,write:!1}})],Rt.prototype,"_version",void 0),u([h({type:Boolean,value:!0})],Rt.prototype,"visible",null),Rt=i3=u([E("esri.Graphic")],Rt);let g0=class extends l0{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};u([cP({Type:Rt,ensureType:jt(Rt)})],g0.prototype,"itemType",void 0),g0=u([E("esri.support.GraphicsCollection")],g0);let za=class extends le{constructor(e){super(e),this.view=null,this.baseLayerViews=new se,this.groundLayerViews=new se,this.referenceLayerViews=new se,this._loadingHandle=ie(()=>this.view?.map?.basemap,r=>{r&&r.load().catch(()=>{})},ft)}destroy(){this._set("view",null),this._loadingHandle=yt(this._loadingHandle),this.baseLayerViews.destroyAll(),this.groundLayerViews.destroyAll(),this.referenceLayerViews.destroyAll()}get suspended(){return this.view?.suspended??!0}get updating(){return this.view?.suspended?!1:!!this.view?.map?.basemap?.loaded&&(this.baseLayerViews.some(r=>r.updating)||this.groundLayerViews.some(r=>r.updating)||this.referenceLayerViews.some(r=>r.updating))}};u([h({constructOnly:!0})],za.prototype,"view",void 0),u([h({readOnly:!0})],za.prototype,"baseLayerViews",void 0),u([h({readOnly:!0})],za.prototype,"groundLayerViews",void 0),u([h({readOnly:!0})],za.prototype,"referenceLayerViews",void 0),u([h({readOnly:!0})],za.prototype,"suspended",null),u([h({type:Boolean,readOnly:!0})],za.prototype,"updating",null),za=u([E("esri.views.BasemapView")],za);const Ope=za;let ws=class extends le{constructor(e){super(e),this.factor=1.5,this.offset=Tr(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};u([h({type:Number})],ws.prototype,"factor",void 0),u([h({nonNullable:!0})],ws.prototype,"offset",void 0),u([h()],ws.prototype,"position",void 0),u([h({type:Number,range:{min:0}})],ws.prototype,"size",void 0),u([h()],ws.prototype,"maskUrl",void 0),u([h()],ws.prototype,"maskEnabled",void 0),u([h()],ws.prototype,"overlayUrl",void 0),u([h()],ws.prototype,"overlayEnabled",void 0),u([h({readOnly:!0})],ws.prototype,"version",null),u([h({type:Boolean})],ws.prototype,"visible",void 0),ws=u([E("esri.views.Magnifier")],ws);const F7=ws;let kf=class{constructor(e){this._observable=new Ev,this._map=new Map(e)}get size(){return _e(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const r=this._map.delete(e);return r&&this._observable.notify(),r}entries(){return _e(this._observable),this._map.entries()}forEach(e,r){_e(this._observable),this._map.forEach((i,s)=>e.call(r,i,s,this),r)}get(e){return _e(this._observable),this._map.get(e)}has(e){return _e(this._observable),this._map.has(e)}keys(){return _e(this._observable),this._map.keys()}set(e,r){return this._map.set(e,r),this._observable.notify(),this}values(){return _e(this._observable),this._map.values()}[Symbol.iterator](){return _e(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};var s3;let Rh=s3=class extends W{constructor(t){super(t),this.name=null,this.code=null}clone(){return new s3({name:this.name,code:this.code})}};u([h({type:String,json:{write:{isRequired:!0}}})],Rh.prototype,"name",void 0),u([h({type:[String,Number],json:{write:{isRequired:!0}}})],Rh.prototype,"code",void 0),Rh=s3=u([E("esri.layers.support.CodedValue")],Rh);const Fpe=new Ne({inherited:"inherited",codedValue:"coded-value",range:"range"});let Vu=class extends W{constructor(e){super(e),this.name=null,this.type=null}};u([h({type:String,json:{write:!0}})],Vu.prototype,"name",void 0),u([ye(Fpe),h({json:{write:{isRequired:!0}}})],Vu.prototype,"type",void 0),Vu=u([E("esri.layers.support.Domain")],Vu);var n3,Zf;let Uu=(Zf=class extends Vu{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let r=null;if(this.codedValues){const i=String(e);this.codedValues.some(s=>(String(s.code)===i&&(r=s.name),!!r))}return r}clone(){return new n3({codedValues:O(this.codedValues),name:this.name})}},n3=Zf,Zf);u([h({type:[Rh],json:{write:{isRequired:!0}}})],Uu.prototype,"codedValues",void 0),u([ye({codedValue:"coded-value"})],Uu.prototype,"type",void 0),Uu=n3=u([E("esri.layers.support.CodedValueDomain")],Uu);var o3,Jf;let v0=(Jf=class extends Vu{constructor(e){super(e),this.type="inherited"}clone(){return new o3}},o3=Jf,Jf);u([ye({inherited:"inherited"})],v0.prototype,"type",void 0),v0=o3=u([E("esri.layers.support.InheritedDomain")],v0);var a3,Yf;let Sh=(Yf=class extends Vu{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new a3({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}},a3=Yf,Yf);u([h({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,r){e[r]=[this.minValue||0,t]},isRequired:!0}}})],Sh.prototype,"maxValue",void 0),u([h({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[0]},write:{target:"range",writer(t,e,r){e[r]=[t,this.maxValue||0]},isRequired:!0}}})],Sh.prototype,"minValue",void 0),u([ye({range:"range"})],Sh.prototype,"type",void 0),Sh=a3=u([E("esri.layers.support.RangeDomain")],Sh);const N7={key:"type",base:Vu,typeMap:{range:Sh,"coded-value":Uu,inherited:v0}};function O2(t){if(!t?.type)return null;switch(t.type){case"range":return Sh.fromJSON(t);case"codedValue":return Uu.fromJSON(t);case"inherited":return v0.fromJSON(t)}return null}const Npe=new Ne({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var l3;const Dpe=new Ne({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",currency:"currency",dateAndTime:"date-and-time",description:"description",emailAddress:"email-address",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",phoneNumber:"phone-number",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});var Xf;let Dr=(Xf=class extends W{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:r}){let i=null;try{i=r?JSON.parse(r):null}catch{}return i?.value??null}readValueType(e,{description:r}){let i=null;try{i=r?JSON.parse(r):null}catch{}return i?Dpe.fromJSON(i.fieldValueType):null}clone(){return new l3({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}},l3=Xf,Xf);u([h({type:String,json:{write:!0}})],Dr.prototype,"alias",void 0),u([h({type:[String,Number],json:{write:{allowNull:!0}}})],Dr.prototype,"defaultValue",void 0),u([h()],Dr.prototype,"description",void 0),u([X("description")],Dr.prototype,"readDescription",null),u([h({types:N7,json:{read:{reader:O2},write:!0}})],Dr.prototype,"domain",void 0),u([h({type:Boolean,json:{write:!0}})],Dr.prototype,"editable",void 0),u([h({type:Ue,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],Dr.prototype,"length",void 0),u([h({type:String,json:{write:!0}})],Dr.prototype,"name",void 0),u([h({type:Boolean,json:{write:!0}})],Dr.prototype,"nullable",void 0),u([ye(Npe)],Dr.prototype,"type",void 0),u([h()],Dr.prototype,"valueType",void 0),u([X("valueType",["description"])],Dr.prototype,"readValueType",null),u([h({type:Boolean,json:{read:!1}})],Dr.prototype,"visible",void 0),Dr=l3=u([E("esri.layers.support.Field")],Dr);var u3;let mp=u3=class extends W{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new u3({mapLayerId:t,gdbVersion:e})}};u([ye({mapLayer:"map-layer"}),h({json:{write:{isRequired:!0}}})],mp.prototype,"type",void 0),u([h({type:Ue,json:{write:{isRequired:!0}}})],mp.prototype,"mapLayerId",void 0),u([h({type:String,json:{write:!0}})],mp.prototype,"gdbVersion",void 0),mp=u3=u([E("esri.layers.support.source.MapLayerSource")],mp);var c3;let ja=c3=class extends W{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:r,spatialReference:i,geometryType:s}=this,n={workspaceId:t,query:e,oidFields:r,spatialReference:i?.clone()??void 0,geometryType:s};return new c3(n)}};u([ye({queryTable:"query-table"}),h({json:{write:{isRequired:!0}}})],ja.prototype,"type",void 0),u([h({type:String,json:{write:!0}})],ja.prototype,"workspaceId",void 0),u([h({type:String,json:{write:!0}})],ja.prototype,"query",void 0),u([h({type:String,json:{write:!0}})],ja.prototype,"oidFields",void 0),u([h({type:ne,json:{write:!0}})],ja.prototype,"spatialReference",void 0),u([ye(mue)],ja.prototype,"geometryType",void 0),ja=c3=u([E("esri.layers.support.source.QueryTableDataSource")],ja);var h3;let yp=h3=class extends W{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new h3({workspaceId:t,dataSourceName:e})}};u([ye({raster:"raster"}),h({json:{write:{isRequired:!0}}})],yp.prototype,"type",void 0),u([h({type:String,json:{write:!0}})],yp.prototype,"dataSourceName",void 0),u([h({type:String,json:{write:!0}})],yp.prototype,"workspaceId",void 0),yp=h3=u([E("esri.layers.support.source.RasterDataSource")],yp);var d3;let Xc=d3=class extends W{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:r}=this;return new d3({workspaceId:t,gdbVersion:e,dataSourceName:r})}};u([ye({table:"table"}),h({json:{write:{isRequired:!0}}})],Xc.prototype,"type",void 0),u([h({type:String,json:{write:!0}})],Xc.prototype,"workspaceId",void 0),u([h({type:String,json:{write:!0}})],Xc.prototype,"gdbVersion",void 0),u([h({type:String,json:{write:!0}})],Xc.prototype,"dataSourceName",void 0),Xc=d3=u([E("esri.layers.support.source.TableDataSource")],Xc);var p3,f3;const zpe=yr()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let _s=p3=class extends W{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,r){return w5()(t,e,r)}castLeftTableSource(t){return ma(m3(),t)}readRightTableSource(t,e,r){return w5()(t,e,r)}castRightTableSource(t){return ma(m3(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:r,rightTableSource:i,joinType:s}=this,n={leftTableKey:t,rightTableKey:e,leftTableSource:r?.clone()??void 0,rightTableSource:i?.clone()??void 0,joinType:s};return new p3(n)}};u([ye({joinTable:"join-table"}),h({json:{write:{isRequired:!0}}})],_s.prototype,"type",void 0),u([h({type:String,json:{write:!0}})],_s.prototype,"leftTableKey",void 0),u([h({type:String,json:{write:!0}})],_s.prototype,"rightTableKey",void 0),u([h({json:{write:!0}})],_s.prototype,"leftTableSource",void 0),u([X("leftTableSource")],_s.prototype,"readLeftTableSource",null),u([He("leftTableSource")],_s.prototype,"castLeftTableSource",null),u([h({json:{write:!0}})],_s.prototype,"rightTableSource",void 0),u([X("rightTableSource")],_s.prototype,"readRightTableSource",null),u([He("rightTableSource")],_s.prototype,"castRightTableSource",null),u([ye(zpe)],_s.prototype,"joinType",void 0),_s=p3=u([E("esri.layers.support.source.JoinTableDataSource")],_s);let l$=null;function w5(){return l$||(l$=Gm({types:m3()})),l$}let u$=null;function m3(){return u$||(u$={key:"type",base:null,typeMap:{"data-layer":Un,"map-layer":mp}}),u$}const jpe={key:"type",base:null,typeMap:{"join-table":_s,"query-table":ja,raster:yp,table:Xc}};var Kf;let Un=(Kf=class extends W{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:r}=this;return new f3({fields:e,dataSource:r})}},f3=Kf,Kf);u([ye({dataLayer:"data-layer"}),h({json:{write:{isRequired:!0}}})],Un.prototype,"type",void 0),u([h({type:[Dr],json:{write:!0}})],Un.prototype,"fields",void 0),u([h({types:jpe,json:{write:!0}})],Un.prototype,"dataSource",void 0),Un=f3=u([E("esri.layers.support.source.DataLayerSource")],Un),Un.from=jt(Un);let Kc=class extends Ie(W){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};u([h({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],Kc.prototype,"onFields",void 0),u([h({type:String,json:{write:!0}})],Kc.prototype,"operator",void 0),u([h({type:String,json:{write:!0}})],Kc.prototype,"searchTerm",void 0),u([h({type:String,json:{write:!0}})],Kc.prototype,"searchType",void 0),Kc=u([E("esri.rest.support.FullTextSearch")],Kc);const D7=Kc;var y3;const _5=new Ne({upperLeft:"upper-left",lowerLeft:"lower-left"});let Mu=y3=class extends W{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new y3(O({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};u([h({type:Te,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Mu.prototype,"extent",void 0),u([h({type:["view","edit"],json:{write:!0}})],Mu.prototype,"mode",void 0),u([h({type:String,json:{read:_5.read,write:_5.write}})],Mu.prototype,"originPosition",void 0),u([h({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Mu.prototype,"tolerance",void 0),Mu=y3=u([E("esri.rest.support.QuantizationParameters")],Mu);const Vpe=t=>{const e=t;let r=class extends e{};return r=u([E("esri.rest.support.QueryMixin")],r),r},Upe=new Ne({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var g3;const b5=new Ne({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let Ln=g3=class extends W{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=O(t))}clone(){return new g3({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:O(this.statisticParameters)})}};u([h({type:Number,json:{write:!0}})],Ln.prototype,"maxPointCount",void 0),u([h({type:Number,json:{write:!0}})],Ln.prototype,"maxRecordCount",void 0),u([h({type:Number,json:{write:!0}})],Ln.prototype,"maxVertexCount",void 0),u([h({type:String,json:{write:!0}})],Ln.prototype,"onStatisticField",void 0),u([h({type:String,json:{write:!0}})],Ln.prototype,"outStatisticFieldName",void 0),u([h({type:String,json:{read:{source:"statisticType",reader:b5.read},write:{target:"statisticType",writer:b5.write}}})],Ln.prototype,"statisticType",void 0),u([h({type:Object})],Ln.prototype,"statisticParameters",void 0),u([te("statisticParameters")],Ln.prototype,"writeStatisticParameters",null),Ln=g3=u([E("esri.rest.support.StatisticDefinition")],Ln);var _b;const Gpe=new Ne({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});var Yh;let fe=(Yh=class extends Vpe(W){static from(e){return Um(_b,e)}constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.returnTrueCurves=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(e){return typeof e=="number"||typeof e=="object"?e:null}writeHistoricMoment(e,r){r.historicMoment=e&&e.getTime()}writeParameterValues(e,r){if(e){const i={};for(const s in e){const n=e[s];Array.isArray(n)?i[s]=n.map(o=>o instanceof Date?o.getTime():o):n instanceof Date?i[s]=n.getTime():i[s]=n}r.parameterValues=i}}writeStart(e,r){r.resultOffset=this.start,r.resultRecordCount=this.num||10,r.where="1=1"}writeWhere(e,r){r.where=e||"1=1"}clone(){return new _b(O({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,returnTrueCurves:this.returnTrueCurves,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}},_b=Yh,Yh.MAX_MAX_RECORD_COUNT_FACTOR=5,Yh);u([h({json:{write:!0}})],fe.prototype,"aggregateIds",void 0),u([h({type:Boolean,json:{write:!0}})],fe.prototype,"cacheHint",void 0),u([h({type:Boolean,json:{default:!1,write:!0}})],fe.prototype,"compactGeometryEnabled",void 0),u([h({json:{write:!0}})],fe.prototype,"datumTransformation",void 0),u([He("datumTransformation")],fe.prototype,"castDatumTransformation",null),u([h({type:Boolean,json:{default:!1,write:!0}})],fe.prototype,"defaultSpatialReferenceEnabled",void 0),u([h({type:Number,json:{write:!0}})],fe.prototype,"distance",void 0),u([h({type:Un,json:{write:!0}})],fe.prototype,"dynamicDataSource",void 0),u([h({type:String,json:{write:!0}})],fe.prototype,"formatOf3DObjects",void 0),u([h({type:[D7],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],fe.prototype,"fullText",void 0),u([h({type:String,json:{write:!0}})],fe.prototype,"gdbVersion",void 0),u([h({types:jv,json:{read:ac,write:!0}})],fe.prototype,"geometry",void 0),u([h({type:Number,json:{write:!0}})],fe.prototype,"geometryPrecision",void 0),u([h({type:[String],json:{write:!0}})],fe.prototype,"groupByFieldsForStatistics",void 0),u([h({type:String,json:{write:!0}})],fe.prototype,"having",void 0),u([h({type:Date})],fe.prototype,"historicMoment",void 0),u([te("historicMoment")],fe.prototype,"writeHistoricMoment",null),u([h({type:Number,json:{write:!0}})],fe.prototype,"maxAllowableOffset",void 0),u([h({type:Number,cast:t=>t<1?1:t>fe.MAX_MAX_RECORD_COUNT_FACTOR?fe.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],fe.prototype,"maxRecordCountFactor",void 0),u([h({type:["xyFootprint"],json:{write:!0}})],fe.prototype,"multipatchOption",void 0),u([h({type:Number,json:{read:{source:"resultRecordCount"}}})],fe.prototype,"num",void 0),u([h({json:{write:!0}})],fe.prototype,"objectIds",void 0),u([h({type:[String],json:{write:!0}})],fe.prototype,"orderByFields",void 0),u([h({type:[String],json:{write:!0}})],fe.prototype,"outFields",void 0),u([h({type:ne,json:{name:"outSR",write:!0}})],fe.prototype,"outSpatialReference",void 0),u([h({type:[Ln],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],fe.prototype,"outStatistics",void 0),u([h({json:{write:!0}})],fe.prototype,"parameterValues",void 0),u([te("parameterValues")],fe.prototype,"writeParameterValues",null),u([h({type:de,json:{write:!0}})],fe.prototype,"pixelSize",void 0),u([h({type:Mu,json:{write:!0}})],fe.prototype,"quantizationParameters",void 0),u([h({type:[Object],json:{write:!0}})],fe.prototype,"rangeValues",void 0),u([h({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],fe.prototype,"relationParameter",void 0),u([h({type:String,json:{write:!0}})],fe.prototype,"resultType",void 0),u([h({type:Boolean,json:{default:!1,write:!0}})],fe.prototype,"returnCentroid",void 0),u([h({type:Boolean,json:{default:!1,write:!0}})],fe.prototype,"returnDistinctValues",void 0),u([h({type:Boolean,json:{default:!0,write:!0}})],fe.prototype,"returnExceededLimitFeatures",void 0),u([h({type:Boolean,json:{write:!0}})],fe.prototype,"returnGeometry",void 0),u([h({type:Boolean,json:{default:!1,write:!0}})],fe.prototype,"returnQueryGeometry",void 0),u([h({type:Boolean,json:{default:!1,write:!0}})],fe.prototype,"returnM",void 0),u([h({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],fe.prototype,"returnZ",void 0),u([h({type:Boolean,json:{write:!0}})],fe.prototype,"returnTrueCurves",void 0),u([h({type:ne,json:{write:!0}})],fe.prototype,"sourceSpatialReference",void 0),u([ye(Upe,{ignoreUnknown:!1,name:"spatialRel"})],fe.prototype,"spatialRelationship",void 0),u([h({type:Number,json:{read:{source:"resultOffset"}}})],fe.prototype,"start",void 0),u([te("start"),te("num")],fe.prototype,"writeStart",null),u([h({type:String,json:{write:!0}})],fe.prototype,"sqlFormat",void 0),u([h({type:String,json:{write:!0}})],fe.prototype,"text",void 0),u([h({type:ar,json:{write:!0}})],fe.prototype,"timeExtent",void 0),u([h({type:Boolean,json:{default:!1,write:!0}})],fe.prototype,"timeReferenceUnknownClient",void 0),u([ye(Gpe,{ignoreUnknown:!1}),h({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null}}}}})],fe.prototype,"units",void 0),u([h({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],fe.prototype,"where",void 0),u([te("where")],fe.prototype,"writeWhere",null),fe=_b=u([E("esri.rest.support.Query")],fe);function Ql(t){return!(t==null||typeof t!="object"||!("createQuery"in t)||!t.createQuery)}let Ys=class extends qm{constructor(e){super(e),this._selectionMap=new kf,this._sources=new se,this._trashCan=[],this._layerEditHandles=new se,this._vizTaskId=0,this.view=null,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([ie(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),ie(()=>this.view,e=>{e?.when().then(()=>this.syncSources())},ft),pn(()=>this.sources,"change",e=>{const r=this._selectionMap,i=[];for(const s of e.removed){const n=r.get(s);n&&(r.delete(s),n.highlightHandle?.remove(),i.push({layer:s,selection:[],added:[],removed:[...n.selection]}))}this._refreshListeners(),i.length&&this._onSelectionChange(i)},{onListenerAdd:()=>this._refreshListeners()})])}destroy(){this.clear(),this._layerEditHandles.drain(yt)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[r,i]=e;return{layer:r,selection:[...i.selection]}})}get count(){let e=0;for(const r of this._selectionMap.values())e+=r.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){la(e,this._sources)}syncSources(){const e=new Set,r=this.view?.map;if(!r)return;const i=s=>{Pse(s)?(s.layers?.forEach(i),s.tables?.forEach(i)):Cse(s)?(s.sublayers?.forEach(i),s.subtables?.forEach(i)):eO(s)?s.sublayers?.forEach(i):Ql(s)&&e.add(s)};r.allLayers.forEach(i),r.allTables.forEach(i),this.sources=[...e]}async getSelectedFeatures(e,r={},i="layerView"){const{view:s,selections:n}=this;if(!s&&i==="layerView")return U.getLogger(this).warn("Cannot query layer views without a view."),[];const o=(e?.length?n.filter(a=>e.includes(a.layer)):n).map(async a=>{const{layer:l,selection:c}=a;if(!c.length)return;const d=op(l)?l.parent:l;if(d!=null){if(s&&i==="layerView"&&!S5(d)&&x5(d)){const p=await s.whenLayerView(d).catch(()=>null);if(p)return $5(p,c,r)}return $5(d,c,r)}}).filter(fr);return(await Promise.all(o)).filter(fr)}updateSelection(e){const r=new Map;for(const[n,o]of this._selectionMap)r.set(n,[...o.selection]);let i=!1;const s=e.current.concat(e.added);for(const n of s){const o=n.sourceLayer,a=n.getObjectId();if(this.sources.includes(o)&&(Ql(o)||op(o))&&a!==null){const l=Fm(r,o,()=>[]);l.includes(a)||(l.push(a),i=!0)}}for(const n of e.removed){const o=n.sourceLayer,a=n.getObjectId();if(this.sources.includes(o)&&(Ql(o)||op(o))&&a!==null){const l=r.get(o),c=l?.indexOf(a);c!==void 0&&c>=0&&(l?.splice(c,1),i=!0)}}if(i){const{_selectionMap:n,_trashCan:o}=this,a=[];for(const[l,c]of r){const d=n.get(l);d!==void 0&&o.push(d),n.set(l,{selection:c}),a.push({layer:l,selection:c,...dA(d!==void 0?d.selection:[],c)})}this._onSelectionChange(a)}}setSelection(e,r){this._setSelection(e,r)}getSelection(e){return this._selectionMap.get(e)?.selection}appendToSelection(e,r){const i=this._selectionMap.get(e),s=i!==void 0?[...i.selection]:[];for(const n of r)s.includes(n)||s.push(n);this._setSelection(e,s)}removeFromSelection(e,r){const i=this._selectionMap.get(e);if(!i)return;const s=[];for(const n of i.selection)r.includes(n)||s.push(n);this._setSelection(e,s)}toggleInSelection(e,r){const i=this._selectionMap.get(e);if(!i||i.selection.length===0)return void this._setSelection(e,r);const s=new Set(i.selection),n=new Set(r),o=sQ(s,n);this._setSelection(e,Array.from(o))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const r=[];for(const[i,s]of this._selectionMap.entries())r.push({layer:i,added:[],removed:[...s.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(r)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){for(this._vizTaskId++;this._trashCan.length>0;)this._trashCan.pop()?.highlightHandle?.remove();if(this.view==null)return;const{sources:e,view:r,_selectionMap:i,showHighlight:s}=this,n=this._vizTaskId;for(const o of e){const a=i.get(o),l=op(o)?o.parent:o;if(l!=null&&x5(l)){if(S5(l))continue;r.whenLayerView(l).then(c=>{a?.highlightHandle?.remove(),a!=null&&s&&n===this._vizTaskId&&"highlight"in c&&typeof c.highlight=="function"&&a.selection.length>0&&(a.highlightHandle=c.highlight(a.selection,this.highlightName))}).catch(()=>{a?.highlightHandle?.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(yt);const e=new Set(this.sources.map(r=>op(r)?r.parent:r));for(const r of e)Ql(r)&&"on"in r&&r.on&&this._layerEditHandles.push(r.on("edits",i=>this._onLayerEdit(i,r)))}_onLayerEdit(e,r){if(eO(r))this._onParentLayerEdit(e,r);else if(e.deletedFeatures.length&&this._selectionMap.has(r)){const i=[];e.deletedFeatures.forEach(({error:s,objectId:n})=>{n!=null&&s==null&&i.push(n)}),this.removeFromSelection(r,i)}}_onParentLayerEdit(e,r){const{deletedFeatures:i,edits:s,updatedFeatures:n}=e;if(s?.updateFeatures?.forEach(o=>{const a=o.getObjectId()??o.attributes[r.objectIdField];if(a==null||n.find(d=>d.objectId===a)?.error)return;const l=r.findSublayerForFeature(o);if(!Ql(l))return;const c=r.sublayers.find(d=>!(!Ql(d)||!this.getSelection(d)?.includes(a)));Ql(c)&&c!==l&&(this.removeFromSelection(c,[a]),this.appendToSelection(l,[a]))}),i.length){const o=[];i.forEach(({error:a,objectId:l})=>{l!=null&&a==null&&o.push(l)}),r.sublayers.forEach(a=>{Ql(a)&&this._selectionMap.has(a)&&this.removeFromSelection(a,o)})}}_setSelection(e,r){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const i=this._selectionMap.get(e);if(i===void 0||!Bpe(i,{selection:r})){i!==void 0&&this._trashCan.push(i),this._selectionMap.set(e,{selection:[...r]});const s={layer:e,selection:[...r],...dA(i!==void 0?i.selection:[],r)};this._onSelectionChange([s])}}};u([h()],Ys.prototype,"_selectionMap",void 0),u([h()],Ys.prototype,"_sources",void 0),u([h({readOnly:!0,nonNullable:!0})],Ys.prototype,"selections",null),u([h({readOnly:!0,nonNullable:!0})],Ys.prototype,"count",null),u([h()],Ys.prototype,"view",void 0),u([h({readOnly:!0,nonNullable:!0})],Ys.prototype,"hasSelection",null),u([h()],Ys.prototype,"showHighlight",void 0),u([h()],Ys.prototype,"sources",null),u([h()],Ys.prototype,"highlightName",void 0),Ys=u([E("esri.views.SelectionManager")],Ys);const S5=t=>op(t)?t.parent?.isTable===!0:t.isTable,qpe=t=>t.layer!==void 0,x5=t=>t?.when!==void 0,Bpe=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const r=[...t.selection],i=[...e.selection];if(r.length!==i.length)return!1;r.sort(),i.sort();for(let s=0;s<r.length;s++)if(r[s]!==i[s])return!1}return!0},$5=async(t,e,r={})=>{let i;if(qpe(t)){const s=t;i=s===void 0?null:await s.queryFeatures(new fe({...r,objectIds:e})).then(n=>({data:n,layer:t.layer}))}else{const s=t;i=s===void 0?null:await s.queryFeatures(new fe({...r,objectIds:e})).then(n=>({data:n,layer:s}))}return i},Hpe=Ys;let _g=class extends Ie(le){constructor(e){super(e),this.accentColor=new K([255,127,0]),this.textColor=new K([255,255,255])}};u([h({type:K,nonNullable:!0})],_g.prototype,"accentColor",void 0),u([h({type:K,nonNullable:!0})],_g.prototype,"textColor",void 0),_g=u([E("esri.views.Theme")],_g);const v3=_g,z7=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],j7={};function V7(t){return!!j7[t]}function Wpe(t){for(const e of t)if(!V7(e))return!1;return!0}z7.forEach(t=>{j7[t]=!0});let U7=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:r,priority:i},s)=>this.inputManager?.installHandlers(s,[r],i))}disconnect(){this.inputManager&&this._handlers.forEach((e,r)=>this.inputManager?.uninstallHandlers(r)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,r,i,s){const n=Array.isArray(e)?e:e.split(",");if(!Wpe(n))return n.some(V7)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,a;Array.isArray(r)?a=r:(o=r,a=[]),typeof i=="function"?o=i:s=i,s=s??xl.DEFAULT;const l=this._createUniqueGroupName(),c=new Zpe(this.view,n,a,o);this._handlers.set(l,{handler:c,priority:s});for(const d of n){const p=this._handlerCounts.get(d)||0;this._handlerCounts.set(d,p+1)}return this.inputManager&&this.inputManager.installHandlers(l,[c],s),je(()=>this._removeHandler(l,n))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,r){if(this._handlers.has(e)){this._handlers.delete(e);for(const i of r){const s=this._handlerCounts.get(i);s===void 0||(s===1?this._handlerCounts.delete(i):this._handlerCounts.set(i,s-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},Zpe=class extends Pr{constructor(e,r,i,s){super(!0),this._latestDragStart=void 0,this.view=e;for(const n of r)switch(n){case"click":this.registerIncoming("click",i,o=>s(Xpe(e,o)));break;case"double-click":this.registerIncoming("double-click",i,o=>s(Kpe(e,o)));break;case"immediate-click":this.registerIncoming("immediate-click",i,o=>s(Qpe(e,o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,o=>s(efe(e,o)));break;case"hold":this.registerIncoming("hold",i,o=>s(tfe(e,o)));break;case"drag":this.registerIncoming("drag",i,o=>{const a=this._wrapDrag(o);a&&s(a)});break;case"key-down":this.registerIncoming("key-down",i,o=>s(rfe(o)));break;case"key-up":this.registerIncoming("key-up",i,o=>s(ife(o)));break;case"pointer-down":this.registerIncoming("pointer-down",i,o=>s(Py(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",i,o=>s(Py(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",i,o=>s(Py(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,o=>s(sfe(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,o=>s(nfe(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,o=>s(Py(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,o=>s(Py(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",i,o=>{s(ofe(o))});break;case"focus":this.registerIncoming("focus",i,o=>{s(Jpe(o))});break;case"blur":this.registerIncoming("blur",i,o=>{s(Ype(o))})}}_wrapDrag(e){const r=e.data,{x:i,y:s}=r.center,{action:n,pointerType:o,button:a}=r;if(n==="start"&&(this._latestDragStart=r),!this._latestDragStart)return;const l=r.pointer.native,c=r.buttons,{cancelable:d,timestamp:p}=e,m={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return n==="end"&&(this._latestDragStart=void 0),{type:"drag",action:n,x:i,y:s,origin:m,pointerType:o,button:a,buttons:c,radius:r.radius,angle:t8(r.angle),native:l,timestamp:p,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:y=>e.defer(y),preventDefault:()=>e.preventDefault()}}};function Jpe(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function Ype(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function Xpe(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:a,eventId:l}=e.data,{cancelable:c,timestamp:d}=e;return{type:"click",pointerType:r,button:i,buttons:s,x:n,y:o,native:a,timestamp:d,screenPoint:Tr(n,o),mapPoint:Wv(t,n,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),defer:p=>e.defer(p),preventDefault:()=>e.preventDefault()}}function Kpe(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:a,eventId:l}=e.data,{cancelable:c,timestamp:d}=e;return{type:"double-click",pointerType:r,button:i,buttons:s,x:n,y:o,native:a,timestamp:d,mapPoint:Wv(t,n,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),defer:p=>e.defer(p),preventDefault:()=>e.preventDefault()}}function Qpe(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:a,eventId:l}=e.data,c=a.pointerId,{cancelable:d,timestamp:p}=e;return{type:"immediate-click",pointerId:c,pointerType:r,button:i,buttons:s,x:n,y:o,native:a,timestamp:p,mapPoint:Wv(t,n,o),eventId:l,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function efe(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:a,eventId:l}=e.data,c=a.pointerId,{cancelable:d,timestamp:p}=e;return{type:"immediate-double-click",pointerId:c,pointerType:r,button:i,buttons:s,x:n,y:o,native:a,timestamp:p,mapPoint:Wv(t,n,o),eventId:l,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function tfe(t,e){const{pointerType:r,button:i,buttons:s,x:n,y:o,native:a}=e.data,{cancelable:l,timestamp:c}=e;return{type:"hold",pointerType:r,button:i,buttons:s,x:n,y:o,native:a,timestamp:c,mapPoint:Wv(t,n,o),cancelable:l,stopPropagation:()=>e.stopPropagation(),defer:d=>e.defer(d),preventDefault:()=>e.preventDefault()}}function Wv(t,e,r){return t.toMap(Tr(e,r),{exclude:[]})}function rfe(t){const{key:e,repeat:r,native:i}=t.data,{cancelable:s,timestamp:n}=t;return{type:"key-down",key:e,repeat:r,native:i,timestamp:n,cancelable:s,stopPropagation:()=>t.stopPropagation(),defer:o=>t.defer(o),preventDefault:()=>t.preventDefault()}}function ife(t){const{key:e,native:r}=t.data,{cancelable:i,timestamp:s}=t;return{type:"key-up",key:e,native:r,timestamp:s,cancelable:i,stopPropagation:()=>t.stopPropagation(),defer:n=>t.defer(n),preventDefault:()=>t.preventDefault()}}function Py(t,e){const{x:r,y:i,button:s,buttons:n,native:o,eventId:a}=t.data,l=o.pointerId,c=o.pointerType,{cancelable:d,timestamp:p}=t;return{type:e,x:r,y:i,pointerId:l,pointerType:c,button:s,buttons:n,native:o,timestamp:p,eventId:a,cancelable:d,stopPropagation:()=>t.stopPropagation(),defer:m=>t.defer(m),preventDefault:()=>t.preventDefault()}}function sfe(t){const{x:e,y:r,buttons:i,native:s,eventId:n}=t.data.currentEvent,{button:o}=t.data.startEvent,a=t.data.startEvent.native.pointerId,l=t.data.startEvent.native.pointerType,c=t.data.action,d={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:p,timestamp:m}=t;return{type:"pointer-drag",x:e,y:r,pointerId:a,pointerType:l,button:o,buttons:i,action:c,origin:d,native:s,timestamp:m,eventId:n,cancelable:p,stopPropagation:()=>t.stopPropagation(),defer:y=>t.defer(y),preventDefault:()=>t.preventDefault()}}function nfe(t){const{cancelable:e,data:r,timestamp:i}=t,{x:s,y:n,deltaY:o,native:a}=r;return{type:"mouse-wheel",x:s,y:n,deltaY:o,native:a,timestamp:i,cancelable:e,stopPropagation:()=>t.stopPropagation(),defer:l=>t.defer(l),preventDefault:()=>t.preventDefault()}}function ofe(t){const{action:e,state:r,device:i}=t.data,{cancelable:s,timestamp:n}=t,{buttons:o,axes:a}=r;return{type:"gamepad",device:i,timestamp:n,action:e,buttons:o,axes:a,cancelable:s,stopPropagation:()=>t.stopPropagation(),defer:l=>t.defer(l),preventDefault:()=>t.preventDefault()}}const afe="z",lfe="r",G7={cancel:"Escape",complete:"Enter"},QDe={...G7,redo:lfe,undo:afe,center:"Alt",constraint:"Shift",delete:["Backspace","Delete"],vertexAdd:"f",pan:" "},e4e={toggle:"Control"},t4e={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},r4e={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:SU,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0}};let i4e=class{constructor(){this._bindings=new Map}add(e,r){return this.addToggle(e,i=>{i.type==="key-down"&&r(i)})}addToggle(e,r){const i=ufe.fromDefinition(e,r),s=Fm(this._bindings,i.key,()=>[]);return s.push(i),je(()=>AC(s,i))}register(e,r=xl.WIDGET){return md([e.on("key-down",i=>this.dispatch(e.inputManager,i),r),e.on("key-up",i=>this.dispatch(e.inputManager,i),r)])}dispatch(e,r){const i=r.key,s=this._bindings.get(i);if(s)for(const n of s)n.process(e,r)}},ufe=class w3{constructor(e,r,i,s,n){this.key=e,this.modifiers=r,this.repeats=i,this.continuePropagation=s,this.callback=n}process(e,r){if(!(r.key!==this.key||"repeat"in r&&r.repeat&&!this.repeats)){for(const i of this.modifiers)if(!e.isModifierKeyDown(i))return;this.continuePropagation||r.stopPropagation(),this.callback(r)}}static fromDefinition(e,r){if(typeof e=="string")return new w3(e,[],!1,!1,r);const{key:i,modifier:s,repeats:n,continuePropagation:o}=e;return new w3(i,s?Array.isArray(s)?s:[s]:[],!!n,!!o,r)}};function cfe(t){return[t.on("before-add",e=>{const r=e.item;if(r==null||t.includes(r))return U.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();r.onAdd()}),t.on("after-remove",e=>{const r=e.item;r.active&&(r.view.activeTool=null),r.destroy()})]}function _3(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(0)&&t.getEditableFlag(1)}function hfe(t){return t.type==="key-down"&&t.key===G7.cancel}function mo(t){return Tr(t.x,t.y)}function q7(t,e){const r=(t instanceof HTMLElement?t:t.surface)?.getBoundingClientRect();return r?Tr(e.clientX-r.left,e.clientY-r.top):Tr(0,0)}function B7(t,e){return e instanceof Event?q7(t,e):mo(e)}function H7(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let bb=class extends le{constructor(){super(...arguments),this._pointerLocations=new Map,this._hoveredManipulators=new kf,this._grabbedManipulators=new kf,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1}get cursor(){return this._cursorFromMap(this._grabbedManipulators,"grabbing")??this._cursorFromMap(this._hoveredManipulators,"pointer")}get hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,r){const i=()=>e.stopPropagation();switch(e.type){case"pointer-move":M5(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(i(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!T5(e))break;const s=mo(e),n=zd(s,e.pointerType,r.tools);if(n==null)break;const o=n.manipulator,a=n.tool;o==null||a==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,e,r),o!=null&&a!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:a,start:s,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&r.activeTool==null&&(this._revertToNullActiveTool=!0,r.setActiveTool(n.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:s}),i());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,r);break;case"pointer-drag":{if(!T5(e))break;const s=this._grabbedManipulators.get(e.pointerId),n=s?.manipulator,o=s?.tool;if(n==null||o==null)break;const a=mo(e);a.x=Qr(a.x,0,r.view.width),a.y=Qr(a.y,0,r.view.height);const l=s.start,c=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(n.dragging=!0,c?n.events.emit("drag",{action:"update",start:l,screenPoint:a}):n.events.emit("drag",{action:"start",start:l,screenPoint:a,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:n,start:l}));break;case"end":n.dragging=!1,c&&n.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,r)}i();break}case"immediate-click":{const s=mo(e),n=zd(s,e.pointerType,r.tools);if(!dfe(e)){for(const c of r.tools)if((n==null||n.tool!==c||c.automaticManipulatorSelection)&&c.manipulators){let d=!1;c.manipulators.forEach(({manipulator:p})=>{p.selected&&(p.selected=!1,d=!0)}),d&&c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged()}}if(n==null)break;const{manipulator:o,tool:a}=n;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const l=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:i}),c$(o,i);break}case"click":{const s=mo(e),n=zd(s,e.pointerType,r.tools),o=n?.manipulator;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit(e.type,{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:a}),i();break}case"double-click":{const s=mo(e),n=zd(s,e.pointerType,r.tools),o=n!=null?n.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:i}),c$(o,i);break}case"immediate-double-click":{const s=mo(e),n=zd(s,e.pointerType,r.tools),o=n!=null?n.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:i}),e.pointerType==="mouse"&&c$(o,i);break}}this._onFocusChange(r.tools)}_releaseManipulatorBeforeDragging(e,r,i){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:r.pointerType,screenPoint:mo(r)}),this._grabbedManipulators.forEach(({manipulator:s},n)=>{s===e&&this._grabbedManipulators.delete(n)}),this._afterManipulatorRelease(i.setActiveTool)}_handlePointerEnd(e,r){const i=this._grabbedManipulators.get(e.pointerId)?.manipulator;i!=null&&i.grabbing&&(i.grabbing=!1,i.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:mo(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(r.setActiveTool))}_onFocusChange(e){this._updateFocusedManipulatorTools(e)}_updateFocusedManipulatorTools(e){const r=new Set,i=new Set;this._grabbedManipulators.forEach(({tool:s})=>r.add(s)),this._hoveredManipulators.forEach(({tool:s})=>i.add(s));for(const s of e){s.hasGrabbedManipulators=r.has(s),s.hasHoveredManipulators=i.has(s);const n=this._grabbedManipulators.values(),o=SK(n,({tool:a})=>a===s);s.firstGrabbedManipulator=o!=null?o.manipulator:null}}clearPointers(e,{tools:r,setActiveTool:i},s=!0,n){const o=(a,l)=>a===e&&(n==null||n===l);this._grabbedManipulators.forEach(({tool:a,manipulator:l,pointerType:c},d)=>{o(a,l)&&(this._grabbedManipulators.delete(d),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:c}))}),this._draggedManipulators.forEach(({tool:a,manipulator:l},c)=>{o(a,l)&&(this._draggedManipulators.delete(c),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))}),s&&this._hoveredManipulators.forEach(({tool:a,manipulator:l},c)=>{o(a,l)&&(this._hoveredManipulators.delete(c),l.hovering=!1)}),this._afterManipulatorRelease(i),this._onFocusChange(r)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((r,i)=>{this._updateHoveredStateForPointerAtScreenPosition(Tr(r.x,r.y),i,r.pointerType,e)})}handleHoverEvent(e,r){const i=e.type;i!=="pointer-up"&&i!=="immediate-click"&&i!=="pointer-move"||!M5(e.pointerType)||(i!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(mo(e),e.pointerId,e.pointerType,r))}_updateHoveredStateForPointerAtScreenPosition(e,r,i,s){let n=zd(e,i,s);const o=this._hoveredManipulators.get(r)?.manipulator;n==null||n.manipulator.interactive||(n=null),n!=null&&o===n.manipulator||(o!=null&&(o.hovering=!1),n!=null?(n.manipulator.hovering=!0,this._hoveredManipulators.set(r,n)):this._hoveredManipulators.delete(r),this._onFocusChange(s))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach(({manipulator:r},i)=>{e===i&&(this._hoveredManipulators.delete(e),r.hovering=!1)})}_cursorFromMap(e,r){if(!e?.size)return null;for(const{manipulator:i}of e.values())if(i?.interactive){if(i.grabbing&&i.grabCursor)return i.grabCursor;if(i.cursor)return i.cursor}return r}};function zd(t,e,r){for(const i of r){if(i.manipulators==null||!_3(i))continue;const s=i.manipulators.intersect(t,e);if(s!=null)return{tool:i,manipulator:s}}return null}function M5(t){return t==="mouse"}function T5(t){return t.pointerType!=="mouse"||t.button===0}function dfe(t){return!!t.native.shiftKey}function c$(t,e){t?.consumesClicks&&e()}u([h()],bb.prototype,"cursor",null),bb=u([E("esri.views.interactive.ToolViewManagerManipulatorState")],bb);const I5="attached",h$="tools",pfe=1e3;let yo=class extends le{constructor(e){super(e),this._updatingHandles=new Bh,this._clock=Nm,this._manipulatorState=new bb,this.tools=new se,this._interacting=!1,this._interactingTimeout=pfe,this._interactingTimeoutHandle=null}initialize(){this.addHandles([this.view.on(z7,e=>{this._handleInputEvent(e)},xl.TOOL),...cfe(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs)}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy(),this._manipulatorState.destroy()}get _manipulatorStateEventArgs(){return{tools:this.tools,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void U.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const r=this.activeTool;this._set("activeTool",e),r?.deactivate(),e?.activate(),this._removeIncompleteTools(e);for(const i of this.tools){this._updateToolEditableFlag(i);const s=_3(i);this.activeTool!=null&&s||this._manipulatorState.clearPointers(i,this._manipulatorStateEventArgs,!s)}}get cursor(){const e=this._manipulatorState.cursor;if(e!=null)return e;for(const r of this.tools)if(r.visible&&r.cursor!=null)return r.cursor;return null}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=yt(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){this.view.type==="3d"?this.addHandles([ie(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>this._forEachManipulator(e=>e.onViewChange())),this.view.elevationProvider.on("elevation-change",e=>this._forEachManipulator(r=>r.onElevationChange(e)))],I5):this.addHandles(ie(()=>this.view.extent,()=>this._forEachManipulator(e=>e.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(I5),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){for(const r of this.tools)r.manipulators&&r.manipulators.forEach(({manipulator:i})=>e(i,r))}_handleInputEvent(e){let r=!1;const i={...e,stopPropagation:()=>{r=!0,e.stopPropagation()}};if(this.activeTool!=null)this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i);else for(const s of this.tools)!r&&s.visible&&s.handleInputEvent(i);!r&&hfe(e)&&this.activeTool&&(e.stopPropagation(),e.preventDefault(),this.activeTool.cancel(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),r||this.activeTool==null||this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this.tools),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(h$);for(const e of this.tools){if(e instanceof le){const r=ie(()=>[e.cursor,e.visible,e.editable],()=>{_3(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs)});this.addHandles(r,h$)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",r=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,r.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this.tools)})],h$)}this._manipulatorState.updateHoveredStateFromKnownPointers(this.tools)}_updateToolEditableFlag(e){e.setEditableFlag?.(1,this.activeTool==null||e===this.activeTool)}_removeIncompleteTools(e){this.tools.filter(r=>(e==null||r!==e)&&!r.created&&r.removeIncompleteOnCancel).forEach(r=>{this.tools.remove(r)})}get test(){}};u([h({constructOnly:!0,nonNullable:!0})],yo.prototype,"view",void 0),u([h({value:null})],yo.prototype,"activeTool",null),u([h({readOnly:!0,type:se})],yo.prototype,"tools",void 0),u([h()],yo.prototype,"cursor",null),u([h({readOnly:!0})],yo.prototype,"updating",null),u([h()],yo.prototype,"_interacting",void 0),u([h({readOnly:!0})],yo.prototype,"interacting",null),yo=u([E("esri.views.ToolViewManager")],yo);const ffe=new K("cyan"),mfe=1,yfe=.25,gfe=new K("black"),vfe=.4,wfe=.2,a4e=.25,W7="default",_fe="temporary",bfe=new K("yellow");var b3;let bs=b3=class extends le{constructor(t){super(t),this.name=W7,this.color=ffe.clone(),this.haloColor=null,this.haloOpacity=mfe,this.fillOpacity=yfe,this.shadowColor=gfe.clone(),this.shadowOpacity=vfe,this.shadowDifference=wfe,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur&&this.shadowColor.equals(t.shadowColor)&&this.shadowOpacity===t.shadowOpacity&&this.shadowDifference===t.shadowDifference}clone(){return new b3({...this,color:this.color.clone(),haloColor:this.haloColor?.clone(),shadowColor:this.shadowColor?.clone()})}assignFrom(t){this.color=t.color.clone(),this.haloColor=t.haloColor?.clone(),this.haloOpacity=t.haloOpacity,this.fillOpacity=t.fillOpacity,this.shadowColor=t.shadowColor.clone(),this.shadowDifference=t.shadowDifference,this.shadowOpacity=t.shadowOpacity,this.haloBlur=t.haloBlur,this.haloWidth=t.haloWidth}};u([h({type:String,constructOnly:!0,nonNullable:!0})],bs.prototype,"name",void 0),u([h({type:K,nonNullable:!0})],bs.prototype,"color",void 0),u([h({type:K})],bs.prototype,"haloColor",void 0),u([h({nonNullable:!0})],bs.prototype,"haloOpacity",void 0),u([h({nonNullable:!0})],bs.prototype,"fillOpacity",void 0),u([h({type:K,nonNullable:!0})],bs.prototype,"shadowColor",void 0),u([h({nonNullable:!0})],bs.prototype,"shadowOpacity",void 0),u([h({nonNullable:!0})],bs.prototype,"shadowDifference",void 0),u([h({nonNullable:!0})],bs.prototype,"haloWidth",void 0),u([h({nonNullable:!0})],bs.prototype,"haloBlur",void 0),bs=b3=u([E("esri.views.support.HighlightOptions")],bs);const Ju=bs;function Sfe(){return new(se.ofType(Ju))([new Ju({name:W7}),new Ju({name:_fe,color:bfe})])}let gp=class extends le{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":xfe.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return $fe[this.deviceType]}};u([h({nonNullable:!0,readOnly:!0})],gp.prototype,"nativeIndex",void 0),u([h({type:String,readOnly:!0})],gp.prototype,"deviceType",null),u([h({type:Number,readOnly:!0})],gp.prototype,"axisThreshold",null),gp=u([E("esri.views.input.gamepad.GamepadInputDevice")],gp);const Mk=gp,xfe=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),$fe={standard:.15,spacemouse:.025,unknown:0};let bg=class extends le{constructor(e){super(e),this.devices=new se,this.enabledFocusMode="document"}};u([h({type:se.ofType(Mk),readOnly:!0})],bg.prototype,"devices",void 0),u([h({type:["document","view","none"]})],bg.prototype,"enabledFocusMode",void 0),bg=u([E("esri.views.input.gamepad.GamepadSettings")],bg);const Mfe=bg;let Sb=class extends le{constructor(){super(...arguments),this.gamepad=new Mfe}};u([h({readOnly:!0})],Sb.prototype,"gamepad",void 0),Sb=u([E("esri.views.input.Input")],Sb);const Tfe=Sb,d$=()=>h({type:["pan","rotate","zoom","none"],nonNullable:!0});let Qc=class extends le{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};u([d$()],Qc.prototype,"dragPrimary",void 0),u([d$()],Qc.prototype,"dragSecondary",void 0),u([d$()],Qc.prototype,"dragTertiary",void 0),u([h({type:["zoom","none"],nonNullable:!0})],Qc.prototype,"mouseWheel",void 0),Qc=u([E("esri.views.navigation.NavigationActionMap")],Qc);const Tk=Qc;let du=class extends le{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};u([h({type:Boolean,nonNullable:!0})],du.prototype,"enabled",void 0),u([h({type:Mk})],du.prototype,"device",void 0),u([h({type:["pan","zoom"],nonNullable:!0})],du.prototype,"mode",void 0),u([h({type:["forward-down","forward-up"],nonNullable:!0})],du.prototype,"tiltDirection",void 0),u([h({type:Number,nonNullable:!0})],du.prototype,"velocityFactor",void 0),du=u([E("esri.views.navigation.gamepad.GamepadSettings")],du);const Z7=du;let pu=class extends le{constructor(e){super(e),this.actionMap=new Tk,this.browserTouchPanEnabled=!0,this.gamepad=new Z7,this.momentumEnabled=!0}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(e){FM(U.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};u([h({type:Tk,nonNullable:!0})],pu.prototype,"actionMap",void 0),u([h({type:Boolean})],pu.prototype,"browserTouchPanEnabled",void 0),u([h({type:Z7,nonNullable:!0})],pu.prototype,"gamepad",void 0),u([h({type:Boolean})],pu.prototype,"momentumEnabled",void 0),u([h({type:Boolean})],pu.prototype,"mouseWheelZoomEnabled",null),pu=u([E("esri.views.navigation.Navigation")],pu);const F2=pu;function f4e(t,e,r){const i=J7(t),s=e,n=Ife(i,s,r);if(i){const o=Ri.deriveUnitFromSR(i,t.spatialReference).heightUnit;if(!r&&o!==i.heightUnit){const a=new R("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new R("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:i,error:a})}}if(!Efe(t)||n===4)return new R("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:i});switch(n){case 1:{const o=i?.heightUnit||"unknown",a=s?.heightUnit||"unknown",l=new R("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${a})`,{layerUnit:o,sceneUnit:a});return new R("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:s,error:l})}case 2:{const o=i?.heightModel||"unknown",a=s?.heightModel||"unknown",l=new R("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${a})`,{layerHeightModel:o,sceneHeightModel:a});return new R("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:s,error:l})}case 3:{const o=i?.vertCRS||"unknown",a=s?.vertCRS||"unknown",l=new R("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${a})`,{layerDatum:o,sceneDatum:a});return new R("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:s,error:l})}}return null}function Ife(t,e,r){if(!E5(t)||!E5(e))return 4;if(t==null||e==null)return 0;if(!r&&t.heightUnit!==e.heightUnit)return 1;if(t.heightModel!==e.heightModel)return 2;switch(t.heightModel){case"gravity-related-height":return 0;case"ellipsoidal":return t.vertCRS===e.vertCRS?0:3;default:return 4}}function E5(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function Efe(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!K7(t)}function J7(t){if(t.type==="integrated-mesh-3dtiles"||t.type==="gaussian-splat")return null;const e=t.url?pc(t.url):void 0;return!(t.spatialReference?.vcsWkid==null&&e!=null&&e.serverType==="ImageServer")&&Y7(t)&&t.heightModelInfo?t.heightModelInfo:K7(t)?Ri.deriveUnitFromSR(Pfe,t.spatialReference):null}function Y7(t){return"heightModelInfo"in t}function X7(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function K7(t){return X7(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):Q7(t)}function Cfe(t){return t.layers!=null||Q7(t)||X7(t)||Y7(t)}function Q7(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"gaussian-splat":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}const Pfe=new Ri({heightModel:"gravity-related-height"});let S3,p$=null;async function kfe(t){p$||(p$=q(()=>import("./geometryServiceUtils-iFzos5Hm.js"),[]).then(e=>S3=e)),await p$,gt(t)}async function eG(t,e,r,i){if(!t)return null;const s=t.spatialReference;return Rl()||io(s,e)?yc(t,e):S3?S3.projectGeometry(t,e,r,i):(await Promise.race([kfe(i),oc(i)]),eG(t,e,r,i))}async function m4e(t,e){try{return t?.spatialReference?await m9(t,e):null}catch{return null}}let ct=class extends le{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=Tl(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const e=this.map?.(),r=[];return this.priorityCollection!=null&&r.push(this.priorityCollection),r.push({parent:e?.basemap,layers:e?.basemap?.baseLayers},{parent:e?.basemap,layers:e?.basemap?.groundLayers},{layers:e?.layers},{parent:e?.ground,layers:e?.ground?.layers},{parent:e?.basemap,layers:e?.basemap?.referenceLayers}),r}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,i=>{const s=this._getSupportedSpatialReferences(i);if(s.length>0){const n=this._narrowDownSpatialReferenceCandidates(e,s);n!=null&&(e=n)}return e?.length===1})&&e?.length!==1)return{updating:!0};const r=this._pickSpatialReferenceCandidate(e);return{spatialReference:r?.spatialReference??null,viewingMode:r?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=this.map?.(),r=this.spatialReference;if(!r)return{updating:this._spatialReferenceTask.updating};let i;const s=this._collectLayers([{parent:e?.basemap,layers:e?.basemap?.baseLayers},{parent:e?.basemap,layers:e?.basemap?.groundLayers},{layers:e?.layers}],n=>!(!("tileInfo"in n)||!n.tileInfo?.spatialReference.equals(r))&&(i=n,!0),n=>"tileInfo"in n);return i?{tileInfo:i.tileInfo,updating:!1}:{updating:s}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let e={};const r=this._collectLayers(this.mapCollections,i=>{const s=J7(i);return!!s&&(e={heightModelInfo:s,vcsWkid:i.spatialReference?.vcsWkid,latestVcsWkid:i.spatialReference?.latestVcsWkid},!0)},i=>Cfe(i));return{...e,updating:r}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],r=this._collectLayers(this.mapCollections,i=>{const s="fullExtents"in i&&i.fullExtents||(i.fullExtent!=null?[i.fullExtent]:[]),n=this.requiresExtentInSpatialReference?null:s[0],o=s.find(a=>a.spatialReference.equals(this.spatialReference))??n;if(o)return e.push({extent:o,layer:i}),!0;if(this._getSupportedSpatialReferences(i).length>0)for(const a of s)e.push({extent:a,layer:i});return!1});return{candidates:e,updating:r}}get _extentTask(){const{candidates:e,updating:r}=this._extentCandidatesTask;if(r)return{updating:r};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const i=this._pickExtentCandidate(e),s=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&s.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=Tl(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:s.clone(),task:Pv(async n=>{try{const o=await eG(i.extent,s,"portalItem"in i.layer?i.layer.portalItem:void 0,n);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(xi(n))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,r){if(e==null)return r;const i=new Array;for(const s of e)for(const n of r){if(!s.spatialReference.equals(n.spatialReference))continue;const o=Afe(s.viewingMode,n.viewingMode);if(o!==!1){i.push({spatialReference:s.spatialReference,viewingMode:o});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(e){const r=this.defaultSpatialReference;return e==null||e.length<1?r?{spatialReference:r,viewingMode:null}:null:(r!=null&&e.length>1&&e.some(({spatialReference:i})=>i.equals(r))&&(e=e.filter(({spatialReference:i})=>i.equals(r))),e.length>1&&e.some(({viewingMode:i})=>i!==2)&&(e=e.filter(({viewingMode:i})=>i!==2)),e[0])}_getSupportedSpatialReferences(e){const r="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(r.length===0)return[];const i=[];for(const s of r){const n=this.getSpatialReferenceSupport(s,e);if(n!=null){const o=n.constraints??[{spatialReference:s,viewingMode:null}];for(const{spatialReference:a,viewingMode:l}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!a.equals(this.userSpatialReference)||i.push({spatialReference:a,viewingMode:l})}}return i}_pickExtentCandidate(e){const r=this.spatialReference;return e.find(({extent:i})=>r.equals(i.spatialReference))||e[0]}_collectLayers(e,r,i=()=>!0){switch(this._loadMaybe(this.map?.())){case"loading":return!0;case"failed":return!1}const s=new Lfe(i,r);for(const n of e)if(this._collectCollection(n,s),s.done||s.preloading===this.sourcePreloadCount)break;return s.updating}_collectCollection(e,r){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return r.updating=!0,void++r.preloading;case"failed":return}for(const i of e.layers)if((i.type!=="graphics"||!i.internal)&&r.layerFilter(i)){switch(this._loadMaybe(i)){case"failed":continue;case"loading":r.updating=!0,++r.preloading;break;case"loaded":if(r.updating||(r.done=r.pushLayer(i)),r.done||r.preloading===this.sourcePreloadCount)break;"layers"in i&&this._collectCollection({layers:i.layers},r)}if(r.done||r.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(r=>{Ur(r)}),"loading"):e.loadStatus:"loaded"}};u([h()],ct.prototype,"required",void 0),u([h({constructOnly:!0})],ct.prototype,"map",void 0),u([h({constructOnly:!0})],ct.prototype,"getSpatialReferenceSupport",void 0),u([h()],ct.prototype,"defaultSpatialReference",void 0),u([h()],ct.prototype,"userSpatialReference",void 0),u([h()],ct.prototype,"sourcePreloadCount",void 0),u([h()],ct.prototype,"priorityCollection",void 0),u([h()],ct.prototype,"requiresExtentInSpatialReference",void 0),u([h()],ct.prototype,"suspended",void 0),u([h({readOnly:!0})],ct.prototype,"ready",null),u([h({readOnly:!0})],ct.prototype,"heightModelInfoReady",null),u([h({readOnly:!0})],ct.prototype,"spatialReference",null),u([h({readOnly:!0})],ct.prototype,"extent",null),u([h({readOnly:!0})],ct.prototype,"heightModelInfo",null),u([h({readOnly:!0})],ct.prototype,"vcsWkid",null),u([h({readOnly:!0})],ct.prototype,"latestVcsWkid",null),u([h({readOnly:!0})],ct.prototype,"viewingMode",null),u([h({readOnly:!0})],ct.prototype,"tileInfo",null),u([h({readOnly:!0})],ct.prototype,"mapCollections",null),u([h({readOnly:!0})],ct.prototype,"_spatialReferenceTask",null),u([h({readOnly:!0})],ct.prototype,"_tileInfoTask",null),u([h({readOnly:!0})],ct.prototype,"_heightModelInfoTask",null),u([h({readOnly:!0})],ct.prototype,"_extentCandidatesTask",null),u([h()],ct.prototype,"_extentTask",null),u([h()],ct.prototype,"_projectExtentTask",void 0),ct=u([E("esri.views.support.DefaultsFromMap")],ct);let Lfe=class{constructor(e,r){this.layerFilter=e,this.pushLayer=r,this.preloading=-1,this.updating=!1,this.done=!1}};function Afe(t,e){return t!=null?e!=null?t===e&&t:t:e}function Rfe(t){return"tryRecycleWith"in t}let Ofe=class{constructor(e,r,i){this.layer=e,this.view=r,this.layerViewImporter=i,this._controller=new AbortController,this._started=!1,this.done=!1,this._deferred=ps(),this.promise=this._deferred.promise,mn(this._controller.signal,()=>{this._recycleController?.abort();const s=new R("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred?.reject(s)})}tryRecycle(e){if(!this.done||!this.layerView||!Rfe(this.layerView))return null;this._recycleController?.abort(),this._recycleController=new AbortController;const r=this.layer.type,i=this._recycleController.signal;for(let s=0;s<e.length;s++){const n=e[s];if(n.type!==r)continue;const o=this.layerView.tryRecycleWith(n,{signal:i});if(o){e.splice(s,1),this.layer=n;const a=this.layerView,l=a.view;return this.promise=o.then(()=>(gt(i),n.emit("layerview-destroy",{view:l,layerView:a}),l.emit("layerview-destroy",{view:l,layerView:a}),n.emit("layerview-create",{view:l,layerView:a}),l.emit("layerview-create",{view:l,layerView:a}),a)),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:r,view:i}=this;r.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{layer:r,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null,this.promise=null,this._deferred=null}async start(){const{view:e}=this;if(this._started||!e.map)return;this._started=!0;const{_controller:{signal:r},layer:i}=this;this._map=e.map;try{let s,n;if(await i.load({signal:r}),i.prefetchResources&&await i.prefetchResources({signal:r}),Ffe(i))s=await i.createLayerView(e,{signal:r});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new R("layer:view-not-supported","No layerview implementation was found");const l=await this.layerViewImporter.importLayerView(i);gt(r),s="default"in l?new l.default({layer:i,view:e}):new l({layer:i,view:e})}const o=()=>{n=yt(n),s.destroyed||s.destroy(),this.done=!0};n=mn(r,o),gt(r);try{await s.when()}catch(l){throw o(),l}if(!this._map?.allLayers?.includes(i))return o(),void this._deferred?.reject(new R("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=s,i.emit("layerview-create",{view:e,layerView:s}),e.emit("layerview-create",{layer:i,layerView:s}),this.done=!0,this._deferred?.resolve(s)}catch(s){i.emit("layerview-create-error",{view:e,error:s}),e.emit("layerview-create-error",{layer:i,error:s}),this.done=!0,this._deferred?.reject(new R("layerview:create-error","layerview creation failed",{layer:i,error:s}))}}};function Ffe(t){return t.createLayerView!==Et.prototype.createLayerView}function Nfe(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let Ji=class extends le{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new Bh,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const r=this.view.map?.allLayers;if(r)for(const i of r)this.layerViewFilter?.(i)!==!1&&this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=ps(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(Vm(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{if(this.destroyed)return;const{map:r}=this.view;if(!r)return void this.clear();if(this._map!==r&&(this.clear(),this._map=r),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const i=new Set,s=[],n=this.view.ready,o=d=>{if(d!=null){for(const p of d)if(p){if(this.layerViewFilter?.(p)===!1)continue;i.add(p);const m=this._layerLayerViewInfoMap.get(p);m&&n?m.start():m||this._recyclingInfoMap.has(p)||s.push(p),"layers"in p&&p.layers&&o(p.layers)}}};for(const d of this._rootCollectionNames)o(ln(this,d));const a=new Array,l=d=>{const p=d.tryRecycle(s);p?(this._recyclingInfoMap.set(d.layer,d),this.notifyChange("updating"),p.then(()=>{this._recyclingInfoMap.delete(d.layer),this._layerLayerViewInfoMap.set(d.layer,d),this._reschedule(),this.notifyChange("updating")}).catch(m=>{Ur(m)||(this._recyclingInfoMap.delete(d.layer),d.destroy(),this._reschedule(),this.notifyChange("updating"))})):a.push(d)};for(const d of this._layerLayerViewInfoMap.values())i.has(d.layer)||(this._layerLayerViewInfoMap.delete(d.layer),l(d));for(const d of this._recyclingInfoMap.values())i.has(d.layer)||(this._recyclingInfoMap.delete(d.layer),l(d));for(const d of s)this._createLayerView(d);this._refreshCollections(),a.forEach(d=>d.destroy());const c=[r?.ground?.layers,r?.basemap?.baseLayers,r?.basemap?.groundLayers,r?.basemap?.referenceLayers,r?.layers].filter(d=>!!d);i.forEach(d=>"layers"in d&&c.push(d.layers)),this.addHandles(c.map(d=>this._watchUpdatingTracking.addOnCollectionChange(()=>d,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null},this._layersToLayerViews=new Map(e.layerviewMapping)}initialize(){this.addHandles([pn(()=>this.view?.map?.allLayers,"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),ie(()=>{const e=this.view,r=e?.map;return[r?.basemap,r?.ground,r?.layers,e?.ready]},()=>this._reschedule(),pi)]),this._preloadLayerViewModules(),this._reschedule()}clearHandles(){this._watchUpdatingTracking.removeAll()}destroy(){this.clear(),Sw(this._recyclingInfoMap),Sw(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(it()),this._workPromise=null)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||kX(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const r of this._layerLayerViewInfoMap.values())r.done||++e;return e}clear(){this.destroyed||(this._clearCollections(),Sw(this._layerLayerViewInfoMap),Sw(this._recyclingInfoMap))}async whenLayerView(e){await this._reschedule();const r=this._layerLayerViewInfoMap.get(e)?.promise;if(!r){const i=this._recyclingInfoMap.get(e)?.promise;if(!i)throw new R("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return i}return r}isCreatingLayerViewsForLayer(e,r){this.commitProperty("updatingRemaining");const i=this._layerLayerViewInfoMap.get(e);if(!i?.done)return!0;const s=i.layerView;return!(!s||!r||s.parent===r)||!!(i.done&&s&&"layers"in e&&e.layers?.length)&&e.layers.some(n=>this.isCreatingLayerViewsForLayer(n,s))}_refreshCollections(){for(const[e,r]of this._layersToLayerViews)this._populateLayerViewsOwners(ln(this,e),ln(this,r),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_clearCollections(){for(const e of this._layersToLayerViews.values())ln(this,e)?.removeAll()}_populateLayerViewsOwners(e,r,i){if(!e||!r)return void r?.removeAll();let s=0;for(const n of e){const o=this._layerLayerViewInfoMap.get(n);if(!o?.layerView)continue;const{layerView:a}=o;a.layer=n,a.parent=i,r.at(s)!==a&&r.splice(s,0,a),"layers"in n&&Nfe(a)&&this._populateLayerViewsOwners(n.layers,a.layerViews,a),++s}s<r.length&&r.splice(s)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const r=new Ofe(e,this.view,this.layerViewImporter);r.promise?.then(()=>this._refreshCollections(),i=>{i&&(Ur(i)||i.name==="cancelled:layerview-create")||U.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:i}),this.destroyed||this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,r),this.view.ready&&r.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};u([h()],Ji.prototype,"_workPromise",void 0),u([h({readOnly:!0})],Ji.prototype,"_watchUpdatingTracking",void 0),u([h({readOnly:!0})],Ji.prototype,"_layersToLayerViews",void 0),u([h({constructOnly:!0})],Ji.prototype,"layerviewMapping",void 0),u([h({readOnly:!0})],Ji.prototype,"_rootCollectionNames",null),u([h({constructOnly:!0})],Ji.prototype,"layerViewFilter",void 0),u([h()],Ji.prototype,"layerViewImporter",void 0),u([h()],Ji.prototype,"supportsGround",void 0),u([h({readOnly:!0})],Ji.prototype,"updating",null),u([h({readOnly:!0})],Ji.prototype,"updatingRemaining",null),u([h({constructOnly:!0})],Ji.prototype,"view",void 0),Ji=u([E("esri.views.support.LayerViewManager")],Ji);const Dfe=Ji;let vp=class extends le{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};u([h()],vp.prototype,"featureTitleFields",void 0),u([h()],vp.prototype,"utilityNetworkFields",void 0),u([h()],vp.prototype,"globalIdField",void 0),vp=u([E("esri.views.support.RequiredFieldsOptions")],vp);const zfe=vp;var wp,ec;let pe=(ec=class extends KS(dP){constructor(e){super(e),this._userSpatialReference=null,this.handles=new zm,this.updatingHandles=new Bh,this.allLayerViews=new Zn({getCollections:()=>this.layerviewCollections,getChildrenFunction:Vfe}),this.analyses=new $m,this.basemapView=null,this.dependencies={popup:void 0},this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new g0,this.typeSpecificPreconditionsReady=!0,this.layerViews=new se,this.magnifier=new F7,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this._lowPriorityCursorHandles=new se,this._highPriorityCursorHandles=new se,this.input=new Tfe,this.navigation=new F2,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new U7(this),this.persistableViewModels=new se,this.requiredFieldsOptions=new zfe,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(ie(()=>this.preconditionsReady,r=>{const i=this.ready;if(r?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,wp.views.add(this)):(this._lockedSpatialReference=null,wp.views.remove(this)),this.notifyChange("spatialReference"),!r&&i)this.toolViewManager?.detach(),this.analysisViewManager?.detach(),this.layerViewManager?.clear(),this._teardown();else if(r&&!i){try{this._startup()}catch(s){return void queueMicrotask(()=>{this.fatalError=new R("view:startup-error","View._startup failed",s)})}this.analysisViewManager?.attach(),this.toolViewManager.attach()}},wa))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this._validateWithErrorDisplay()]).then(()=>(this._isValid=!0,Ov(()=>this.ready)))),this.basemapView=new Ope({view:this}),this.layerViewManager=new Dfe({view:this,layerViewFilter:e=>this.layerViewFilter?.(e)??!0,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},layerviewMapping:this._layerToLayerviewMapping}),this.toolViewManager=new yo({view:this}),this.selectionManager=new Hpe({view:this}),this.addHandles([Ti(()=>this.readyState==="map-content-error"&&!this.spatialReference,()=>{U.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),ie(()=>this.initialExtentRequired,e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e},pi),ie(()=>this.ready,e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)},wa),ie(()=>this._userSpatialReference,e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)},pi)])}get _layerToLayerviewMapping(){return wp._layerToLayerview}destroy(){this.destroyed||(wp.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=xt(this.graphics),this.analyses=xt(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.analysisViewManager=xt(this.analysisViewManager),this.toolViewManager=xt(this.toolViewManager),this.layerViewManager=xt(this.layerViewManager),this.selectionManager=xt(this.selectionManager),this.basemapView=xt(this.basemapView),this.layerViews?.forEach(e=>e.destroy()),this.layerViews.length=0,this.invalidate(),this.handles.destroy(),this.map=xt(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return U.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get layerviewCollections(){return[this.basemapView?.baseLayerViews,this.basemapView?.groundLayerViews,this.layerViews,this.basemapView?.referenceLayerViews]}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new ct({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(e,r)=>this.getSpatialReferenceSupport(e,r),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??Sfe()}set highlights(e){this._set("highlights",la(e,this._get("highlights"),se.ofType(Ju)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!this.destroying&&!this.destroyed&&!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||ZM(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e?.destroyed&&(U.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),ZM(e)&&e.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get readyState(){if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((this.defaultsFromMap?.ready??!1)&&!this.spatialReference){const e=!("loaded"in this.map)||this.map.loaded,r=this.map.ground.loaded,i=this.map.basemap?.loaded??!0;return e&&i&&r&&!this.map?.allLayers.length?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=Pv(s=>YC(z("view-readyState-waiting-delay"),null,s)),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),this._readyStateWaitingTask?.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=Tl(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&this.defaultsFromMap?.required?.heightModelInfo){const r=e.clone();return r.vcsWkid=this.defaultsFromMap.vcsWkid,r.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,r}return e}set spatialReference(e){const r=!Cr(e,this._get("spatialReference"));this._set("_userSpatialReference",e),r&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(e){this._userTimeExtent=e}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??to}set timeZone(e){this._userTimeZone=e,ise(e)||U.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._highPriorityCursorHandles.at(-1)?.cursor??this._lowPriorityCursorHandles.at(-1)?.cursor??"default"}acquireCursor(e,r="low"){const i=r==="high"?this._highPriorityCursorHandles:this._lowPriorityCursorHandles,s={cursor:e},n=je(()=>i.remove(s));return i.add(s),this.addHandles(n),n}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new v3}whenLayerView(e){return this.layerViewManager?.whenLayerView(e)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}getSurface(){return null}importLayerView(e){throw new R("view:importLayerView-missing","importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return this.getSpatialReferenceSupport(e)!=null}when(e,r){return this.isResolved()&&!this.ready&&U.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,r)}forceReadyCycle(){this.ready&&(Ti(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}on(e,r){return super.on(e,r)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}async _validateWithErrorDisplay(){try{await this.validate()}catch(e){const r=document.createElement("div");r.setAttribute("style","display: flex; flex-direction: column; gap: 8px; padding: 20px; height: 100%; justify-content: center; color: black; background: white; font-family: sans-serif;");const i=document.createElement("div");i.innerHTML="Unable to display map. WebGL2 support is required.",i.setAttribute("style","font-size: 24px; font-weight: bold;");const s=document.createElement("div");s.innerHTML="Ensure that your browser and hardware meet the minimum requirements.",s.setAttribute("style","font-size: 18px;");const n=document.createElement("a");n.innerHTML="https://esriurl.com/webgl-faq",n.target="_blank",n.setAttribute("style","font-size: 18px;"),n.href="https://esriurl.com/webgl-faq",r.appendChild(i),r.appendChild(s),r.appendChild(n);const o=this.getSurface();throw o&&o.appendChild(r),e}}},wp=ec,ec._layerToLayerview=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.basemap.groundLayers","view.basemapView.groundLayerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"],["view.map.layers","view.layerViews"]],ec.views=new se,ec);u([h()],pe.prototype,"_userSpatialReference",void 0),u([h()],pe.prototype,"activeTool",null),u([h({readOnly:!0})],pe.prototype,"allLayerViews",void 0),u([h({readOnly:!0})],pe.prototype,"layerviewCollections",null),u([h(BT($m,"analyses"))],pe.prototype,"analyses",void 0),u([h()],pe.prototype,"animation",null),u([h()],pe.prototype,"basemapView",void 0),u([h()],pe.prototype,"center",null),u([h()],pe.prototype,"defaultsFromMapSettings",null),u([h()],pe.prototype,"defaultsFromMap",null),u([h()],pe.prototype,"dependencies",void 0),u([h()],pe.prototype,"displayFilterEnabled",void 0),u([h({type:Te})],pe.prototype,"extent",null),u([h()],pe.prototype,"fatalError",void 0),u([h(BT(g0,"graphics"))],pe.prototype,"graphics",void 0),u([h({readOnly:!0,type:Ri})],pe.prototype,"heightModelInfo",null),u([h({type:se.ofType(Ju)})],pe.prototype,"highlights",null),u([h({readOnly:!0})],pe.prototype,"interacting",null),u([h({constructOnly:!0})],pe.prototype,"layerViewFilter",void 0),u([h({readOnly:!0})],pe.prototype,"navigating",null),u([h({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],pe.prototype,"preconditionsReady",null),u([h({readOnly:!0})],pe.prototype,"typeSpecificPreconditionsReady",void 0),u([h({type:se,readOnly:!0})],pe.prototype,"layerViews",void 0),u([h()],pe.prototype,"resolution",null),u([h({type:F7})],pe.prototype,"magnifier",void 0),u([h({value:null,type:G9})],pe.prototype,"map",null),u([h()],pe.prototype,"padding",void 0),u([h({readOnly:!0})],pe.prototype,"ready",void 0),u([h()],pe.prototype,"_readyStateWaitingTask",void 0),u([h({readOnly:!0})],pe.prototype,"readyState",null),u([h({type:ne})],pe.prototype,"spatialReference",null),u([h()],pe.prototype,"stationary",null),u([h({type:ar})],pe.prototype,"timeExtent",null),u([h({type:String,nonNullable:!0})],pe.prototype,"timeZone",null),u([h()],pe.prototype,"tools",null),u([h()],pe.prototype,"toolViewManager",void 0),u([h({readOnly:!0})],pe.prototype,"type",void 0),u([h({type:Number})],pe.prototype,"scale",void 0),u([h({readOnly:!0})],pe.prototype,"updating",void 0),u([h({readOnly:!0})],pe.prototype,"initialExtentRequired",void 0),u([h({readOnly:!0})],pe.prototype,"initialExtent",null),u([h()],pe.prototype,"cursor",null),u([h({readOnly:!0})],pe.prototype,"input",void 0),u([h({type:F2,nonNullable:!0})],pe.prototype,"navigation",void 0),u([h()],pe.prototype,"layerViewManager",void 0),u([h()],pe.prototype,"analysisViewManager",void 0),u([h()],pe.prototype,"selectionManager",void 0),u([h()],pe.prototype,"width",void 0),u([h()],pe.prototype,"height",void 0),u([h({readOnly:!0})],pe.prototype,"resizing",void 0),u([h({value:null,readOnly:!0})],pe.prototype,"size",null),u([h({readOnly:!0})],pe.prototype,"suspended",void 0),u([h({readOnly:!0})],pe.prototype,"viewEvents",void 0),u([h({readOnly:!0})],pe.prototype,"persistableViewModels",void 0),u([h()],pe.prototype,"_isValid",void 0),u([h()],pe.prototype,"_readyCycleForced",void 0),u([h()],pe.prototype,"_lockedSpatialReference",void 0),u([h()],pe.prototype,"_userTimeZone",void 0),u([h()],pe.prototype,"_lockedTimeZone",void 0),u([h()],pe.prototype,"_userTimeExtent",void 0),u([h()],pe.prototype,"_lockedTimeExtent",void 0),u([h({type:v3})],pe.prototype,"theme",void 0),u([h({readOnly:!0,type:v3})],pe.prototype,"effectiveTheme",null),pe=wp=u([E("esri.views.View")],pe);const f$=globalThis.$arcgis;f$&&!f$.views&&Object.defineProperty(f$,"views",{configurable:!1,enumerable:!0,writable:!1,value:pe.views});const jfe=pe;function Vfe(t){return t.layerViews}function zt(){return[0,0]}function Ufe(t){return[t[0],t[1]]}function Zv(t,e){return[t,e]}function Gfe(t,e){return[t,e]}function qfe(t,e=zt()){const r=Math.min(2,t.length);for(let i=0;i<r;++i)e[i]=t[i];return e}function tG(){return zt()}function rG(){return Zv(1,1)}function iG(){return Zv(1,0)}function sG(){return Zv(0,1)}const Bfe=tG(),Hfe=rG(),Wfe=iG(),Zfe=sG();Object.freeze(Object.defineProperty({__proto__:null,ONES:Hfe,UNIT_X:Wfe,UNIT_Y:Zfe,ZEROS:Bfe,clone:Ufe,create:zt,freeze:Gfe,fromArray:qfe,fromValues:Zv,ones:rG,unitX:iG,unitY:sG,zeros:tG},Symbol.toStringTag,{value:"Module"}));function Jfe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Jv(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Yfe(t,e,r,i,s,n,o){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=n,t[5]=o,t}function Ik(t,e){const r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5];let l=r*n-i*s;return l?(l=1/l,t[0]=n*l,t[1]=-i*l,t[2]=-s*l,t[3]=r*l,t[4]=(s*a-n*o)*l,t[5]=(i*o-r*a)*l,t):null}function Xfe(t){return t[0]*t[3]-t[1]*t[2]}function Lo(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],c=r[0],d=r[1],p=r[2],m=r[3],y=r[4],g=r[5];return t[0]=i*c+n*d,t[1]=s*c+o*d,t[2]=i*p+n*m,t[3]=s*p+o*m,t[4]=i*y+n*g+a,t[5]=s*y+o*g+l,t}function uc(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],c=Math.sin(r),d=Math.cos(r);return t[0]=i*d+n*c,t[1]=s*d+o*c,t[2]=i*-c+n*d,t[3]=s*-c+o*d,t[4]=a,t[5]=l,t}function Yv(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],c=r[0],d=r[1];return t[0]=i*c,t[1]=s*c,t[2]=n*d,t[3]=o*d,t[4]=a,t[5]=l,t}function da(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3],a=e[4],l=e[5],c=r[0],d=r[1];return t[0]=i,t[1]=s,t[2]=n,t[3]=o,t[4]=i*c+n*d+a,t[5]=s*c+o*d+l,t}function N2(t,e){const r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t[4]=0,t[5]=0,t}function nG(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function Ek(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function Kfe(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function Qfe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function eme(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t}function oG(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}function tme(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t}function rme(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t}function ime(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function sme(t,e){const r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],a=t[5],l=e[0],c=e[1],d=e[2],p=e[3],m=e[4],y=e[5],g=Bi();return Math.abs(r-l)<=g*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-c)<=g*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(s-d)<=g*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(n-p)<=g*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(o-m)<=g*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-y)<=g*Math.max(1,Math.abs(a),Math.abs(y))}const nme=Lo,ome=oG;Object.freeze(Object.defineProperty({__proto__:null,add:eme,copy:Jfe,determinant:Xfe,equals:sme,exactEquals:ime,frob:Qfe,fromRotation:N2,fromScaling:nG,fromTranslation:Ek,identity:Jv,invert:Ik,mul:nme,multiply:Lo,multiplyScalar:tme,multiplyScalarAndAdd:rme,rotate:uc,scale:Yv,set:Yfe,str:Kfe,sub:ome,subtract:oG,translate:da},Symbol.toStringTag,{value:"Module"}));function pa(){return[1,0,0,1,0,0]}function ame(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function lme(t,e,r,i,s,n){return[t,e,r,i,s,n]}const ume=pa();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:ume,clone:ame,create:pa,fromValues:lme},Symbol.toStringTag,{value:"Module"}));const Nw={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new pr({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:ne.WebMercator}),minus180Line:new pr({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:ne.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new pr({paths:[[[180,-180],[180,180]]],spatialReference:ne.WGS84}),minus180Line:new pr({paths:[[[-180,-180],[-180,180]]],spatialReference:ne.WGS84})}};function Oh(t,e){return Math.ceil((t-e)/(2*e))}function aG(t,e){const r=w0(t);for(const i of r)for(const s of i)s[0]+=e;return t}function w0(t){return Kt(t)?t.rings:t.paths}function Ck(t,e){return e?{...e,query:{...t,...e.query}}:{query:t}}function Xv(t){return typeof t=="string"?Er(t):O(t)}function Pk(t,e,r){const i={};for(const s in t){if(s==="declaredClass")continue;const n=t[s];if(n!=null&&typeof n!="function")if(Array.isArray(n))i[s]=n.map(o=>Pk(o));else if(typeof n=="object")if(n.toJSON){const o=n.toJSON(r?.[s]);i[s]=e?o:JSON.stringify(o)}else i[s]=e?n:JSON.stringify(n);else i[s]=n}return i}function cme(t,e){return t?e&&eP(t)?e:QC(t)??Fe?.findCredential(t)?.token:null}async function b4e(t,e,r){const i=cme(t,e);return i||(!Fe&&De.request.useIdentity&&await q(()=>import("./IdentityManager-CdJBTlkb.js"),[]),(await Fe.getCredential(t,r))?.token)}async function hme(t,e,r,i){const s=Xv(t),n=e[0].spatialReference,o={...i,responseType:"json",query:{...s.query,f:"json",sr:P1(n),target:JSON.stringify({geometryType:Qm(e[0]),geometries:e}),cutter:JSON.stringify(r)}},a=await Be(s.path+"/cut",o),{cutIndexes:l,geometries:c=[]}=a.data;return{cutIndexes:l,geometries:c.map(d=>{const p=ac(d);return p.spatialReference=n,p})}}function dme(t){return{geometryType:Qm(t[0]),geometries:t.map(e=>e.toJSON())}}function lG(t,e,r){const i=fue(e);return t.map(s=>{const n=i.fromJSON(s);return n.spatialReference=r,n})}async function pme(t,e,r){const i=typeof t=="string"?Er(t):t,s=e[0].spatialReference,n=Qm(e[0]),o={...r,query:{...i.query,f:"json",sr:P1(s),geometries:JSON.stringify(dme(e))}},{data:a}=await Be(i.path+"/simplify",o);return lG(a.geometries,n,s)}const uG=()=>U.getLogger("esri.geometry.support.normalizeUtils");function fme(t){return t.type==="polygon"}function mme(t){return t[0].type==="polygon"}function yme(t){return t[0].type==="polyline"}function C5(t){const e=[];let r=0,i=0;for(let s=0;s<t.length;s++){const n=t[s];let o=null;for(let a=0;a<n.length;a++)o=n[a],e.push(o),a===0?(r=o[0],i=r):(r=Math.min(r,o[0]),i=Math.max(i,o[0]));o&&e.push([(r+i)/2,0])}return e}function gme(t,e){if(!(t instanceof pr||t instanceof dt)){const s="straightLineDensify: the input geometry is neither polyline nor polygon";throw uG().error(s),new R("internal:geometry",s)}const r=w0(t),i=[];for(const s of r){const n=[];i.push(n),n.push([s[0][0],s[0][1]]);for(let o=0;o<s.length-1;o++){const a=s[o][0],l=s[o][1],c=s[o+1][0],d=s[o+1][1],p=Math.sqrt((c-a)*(c-a)+(d-l)*(d-l)),m=(d-l)/p,y=(c-a)/p,g=p/e;if(g>1){for(let x=1;x<=g-1;x++){const $=x*e,T=y*$+a,C=m*$+l;n.push([T,C])}const v=(p+Math.floor(g-1)*e)/2,w=y*v+a,_=m*v+l;n.push([w,_])}n.push([c,d])}}return fme(t)?new dt({rings:i,spatialReference:t.spatialReference}):new pr({paths:i,spatialReference:t.spatialReference})}function P5(t,e,r){if(e){const i=gme(t,1e6);t=Kp(i,!0)}return r&&(t=aG(t,r)),t}function k5(t,e,r){if(Array.isArray(t)){const i=t[0];if(i>e){const s=Oh(i,e);t[0]=i+s*(-2*e)}else if(i<r){const s=Oh(i,r);t[0]=i+s*(-2*r)}}else{const i=t.x;if(i>e){const s=Oh(i,e);t=t.clone().offset(s*(-2*e),0)}else if(i<r){const s=Oh(i,r);t=t.clone().offset(s*(-2*r),0)}}return t}function vme(t,e){let r=-1;for(let i=0;i<e.cutIndexes.length;i++){const s=e.cutIndexes[i],n=e.geometries[i],o=w0(n);for(let a=0;a<o.length;a++){const l=o[a];l.some(c=>{if(c[0]<180)return!0;{let d=0;for(let m=0;m<l.length;m++){const y=l[m][0];d=y>d?y:d}d=Number(d.toFixed(9));const p=-360*Oh(d,180);for(let m=0;m<l.length;m++){const y=n.getPoint(a,m);n.setPoint(a,m,y.clone().offset(p,0))}return!0}})}if(s===r){if(mme(t))for(const a of w0(n))t[s]=t[s].addRing(a);else if(yme(t))for(const a of w0(n))t[s]=t[s].addPath(a)}else r=s,t[s]=n}return t}async function wme(t,e,r){if(!Array.isArray(t))return wme([t],e);e&&typeof e!="string"&&uG().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const i=typeof e=="string"?e:e?.url??De.geometryServiceUrl;let s,n,o,a,l,c,d,p,m=0;const y=[],g=[];for(const T of t)if(T!=null)if(s||(s=T.spatialReference,n=qi(s),o=s.isWebMercator,c=o?102100:4326,a=Nw[c].maxX,l=Nw[c].minX,d=Nw[c].plus180Line,p=Nw[c].minus180Line),n)if(T.type==="mesh")g.push(T);else if(T.type==="point")g.push(k5(T.clone(),a,l));else if(T.type==="multipoint"){const C=T.clone();C.points=C.points.map(P=>k5(P,a,l)),g.push(C)}else if(T.type==="extent"){const C=T.clone()._normalize(!1,!1,n);g.push(C.rings?new dt(C):C)}else if(T.extent){const C=T.extent,P=Oh(C.xmin,l)*(2*a);let A=P===0?T.clone():aG(T.clone(),P);C.offset(P,0);let{xmin:F,xmax:j}=C;F=Number(F.toFixed(9)),j=Number(j.toFixed(9)),C.intersects(d)&&j!==a?(m=j>m?j:m,A=P5(A,o),y.push(A),g.push("cut")):C.intersects(p)&&F!==l?(m=j*(2*a)>m?j*(2*a):m,A=P5(A,o,360),y.push(A),g.push("cut")):g.push(A)}else g.push(T.clone());else g.push(T);else g.push(T);let v=Oh(m,a),w=-90;const _=v,x=new pr;for(;v>0;){const T=360*v-180;x.addPath([[T,w],[T,-1*w]]),w*=-1,v--}if(y.length>0&&_>0){const T=vme(y,await hme(i,y,x,r)),C=[],P=[];for(let j=0;j<g.length;j++){const V=g[j];if(V!=="cut")P.push(V);else{const Z=T.shift(),Y=t[j];Y!=null&&Y.type==="polygon"&&Y.rings&&Y.rings.length>1&&Z.rings.length>=Y.rings.length?(C.push(Z),P.push("simplify")):P.push(o?Bu(Z):Z)}}if(!C.length)return P;const A=await pme(i,C,r),F=[];for(let j=0;j<P.length;j++){const V=P[j];V!=="simplify"?F.push(V):F.push(o?Bu(A.shift()):A.shift())}return F}const $=[];for(let T=0;T<g.length;T++){const C=g[T];if(C!=="cut")$.push(C);else{const P=y.shift();$.push(o===!0?Bu(P):P)}}return $}function _me(t){if(!t)return null;const e=t.extent;if(!e)return null;const r=t.spatialReference&&qi(t.spatialReference);if(!r)return e;const[i,s]=r.valid,n=2*s,{width:o}=e;let a,{xmin:l,xmax:c}=e;if([l,c]=[c,l],t.type==="extent"||o===0||o<=s||o>n||l<i||c>s)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;a=C5(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;a=C5(t.paths);break;case"multipoint":a=t.points}const d=e.clone();for(let p=0;p<a.length;p++){let m=a[p][0];m<0?(m+=s,c=Math.max(m,c)):(m-=s,l=Math.min(m,l))}return d.xmin=l,d.xmax=c,d.width<o?(d.xmin-=s,d.xmax-=s,d):e}function kk(t,e,r){const i=qi(r);if(i==null)return t;const[s,n]=i.valid,o=2*n;let a=0,l=0;e>n?a=Math.ceil(Math.abs(e-n)/o):e<s&&(a=-Math.ceil(Math.abs(e-s)/o)),t>n?l=Math.ceil(Math.abs(t-n)/o):t<s&&(l=-Math.ceil(Math.abs(t-s)/o));let c=t+(a-l)*o;const d=c-e;return d>n?c-=o:d<s&&(c+=o),c}function S4e(t,e){return Lk(e)?.normalize(t)??t}function Lk(t){const e=qi(t);if(e==null)return null;const[r,i]=e.valid;return new M2(r,i)}const x4e=Lk(ne.WGS84);Lk(ne.WebMercator);const cG=96,hG=39.37,bme=180/Math.PI;function dG(t){return t.wkid?t:t.spatialReference||ne.WGS84}function Ak(t,e){return e.type?Xt(t,e.x,e.y):Sf(t,e)}function pG(t){return Vs(t)}function D2(t,e,r=0){let i=t.width,s=t.height;if(r!==0){const a=Ym(r),l=Math.abs(Math.cos(a)),c=Math.abs(Math.sin(a));i=t.width*l+t.height*c,s=t.width*c+t.height*l}const n=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(i/n,s/o)*Cme(t.spatialReference)}async function Sg(t,e,r,i){let s,n;if(!t||Array.isArray(t)&&!t.length)return null;if(se.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const a=t.every(d=>"attributes"in d),l=t.some(d=>!d.geometry);let c=t;if(a&&l&&e&&e.allLayerViews){const d=new Map;for(const g of t){const v=g.layer,w=d.get(v)||[],_=g.attributes[v.objectIdField];_!=null&&w.push(_),d.set(v,w)}const p=[];d.forEach((g,v)=>{const w=e.allLayerViews?.find(_=>_.layer.id===v.id);if(w&&"queryFeatures"in w){const _=v.createQuery();_.objectIds=g,_.returnGeometry=!0,p.push(w.queryFeatures(_))}});const m=await Promise.all(p),y=[];for(const g of m)if(g&&g.features&&g.features.length)for(const v of g.features)v.geometry!=null&&y.push(v.geometry);c=y}for(const d of c)i=await Sg(d,e,r,i);return i}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")s=new de(t);else if(t instanceof Mr)s=t;else if("geometry"in t){if(t.geometry)s=t.geometry;else if(t.layer){const a=t.layer,l=e.allLayerViews?.find(c=>c.layer.id===a.id);if(l&&"queryFeatures"in l){const c=a.createQuery();c.objectIds=[t.attributes[a.objectIdField]],c.returnGeometry=!0,s=(await l.queryFeatures(c))?.features?.[0]?.geometry}}}if(s==null)return null;switch(s.type){case"point":n=new Te({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":n=_me(s);break;default:n=s.extent}if(!n)return null;Rl()||io(n.spatialReference,r)||await oc();const o=yc(n,r);if(!o)return null;if(i){const a=o.center,l=a.clone();l.x=kk(a.x,i.center.x,r),l.x!==a.x&&o.centerAt(l),i=i.union(o)}else i=o;return i}function Sme(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer?.minScale!=null&&t.layer.maxScale!=null){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every(e=>"layer"in e)){let e=0,r=0;for(const i of t){const s=i.layer;s?.minScale&&s.maxScale&&(e=s.minScale<e?s.minScale:e,r=s.maxScale>r?s.maxScale:r)}return e&&r?{min:e,max:r}:null}}}function L5(t,e){const r=dG(t);return Cr(r,e)||r.imageCoordinateSystem||e.imageCoordinateSystem?t:yc(t,e)}async function xme(t,e){if(!t||!e)return new fn({targetGeometry:new de,scale:0,rotation:0});let r=e.spatialReference;const{constraints:i,padding:s,viewpoint:n,size:o}=e,a=[s?o[0]-s.left-s.right:o[0],s?o[1]-s.top-s.bottom:o[1]];let l=null;t instanceof fn?l=t:t.viewpoint?l=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(l=t.target);let c=null;l?.targetGeometry?c=l.targetGeometry:t instanceof Te?c=t:t instanceof Mr?c=await Sg(t,e,r):t&&(c=await Sg(t.center,e,r)||await Sg(t.target,e,r)||await Sg(t,e,r)),!c&&n?.targetGeometry?c=n.targetGeometry:!c&&e.extent&&(c=e.extent),r||(r=dG(e.spatialReference||e.extent||c)),Rl()||Cr(c.spatialReference,r)||io(c.spatialReference,r)||await oc();const d=L5(c,r),p="center"in d?d.center:d;e.pickClosestTarget!==!1&&p.type==="point"&&n.targetGeometry?.type==="point"&&(p.x=kk(p.x,n.targetGeometry.x,p.spatialReference));let m=0;l?m=l.rotation:t.hasOwnProperty("rotation")?m=t.rotation:n&&(m=n.rotation);let y=0;y=l?.targetGeometry!=null&&l.targetGeometry.type==="point"?l.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&i&&i.effectiveLODs?i.zoomToScale(t.zoom):Array.isArray(c)||c.type==="point"||c.type==="extent"&&c.width===0&&c.height===0?n.scale:D2(L5(c.extent,r),a,m);const g=Sme(t.target??t);g&&(g.min&&g.min<y?y=g.min:g.max&&g.max>y&&(y=g.max));let v=new fn({targetGeometry:p,scale:y,rotation:m});return i&&(v=i.fit(v),i.constrainByGeometry(v),i.rotationEnabled||(v.rotation=n.rotation)),v}function Si(t,e){const r=t.targetGeometry,i=e.targetGeometry;return r.x=i.x,r.y=i.y,r.spatialReference=i.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function $me(t,e,r){return r?Xt(t,.5*(e[0]-r.right+r.left),.5*(e[1]-r.bottom+r.top)):Fv(t,e,.5)}const Mme=(function(){const t=zt();return function(e,r,i){const s=r.targetGeometry;Ak(t,s);const n=.5*ey(r);return e.xmin=t[0]-n*i[0],e.ymin=t[1]-n*i[1],e.xmax=t[0]+n*i[0],e.ymax=t[1]+n*i[1],e.spatialReference=s.spatialReference,e}})();function Tme(t,e,r,i,s){return x3(t,e,r.center),t.scale=D2(r,i),s?.constraints?.constrain(t),t}function Ime(t,e,r,i){return Fk(t,e,r,i),Ik(t,t)}const fG=(function(){const t=zt();return function(e,r,i){return HP(e,Pme(e,r),$me(t,r,i))}})(),Eme=(function(){const t=pa(),e=zt();return function(r,i,s,n){const o=ey(i),a=Rk(i);return Xt(e,o,o),nG(t,e),uc(t,t,a),da(t,t,fG(e,s,n)),da(t,t,[0,n.top-n.bottom]),Xt(r,t[4],t[5])}})();function ey(t){return t.scale*mG(t.targetGeometry?.spatialReference)}function mG(t){return Rs(t)?1/(pG(t)*hG*cG):1}function Rk(t){return BP(t.rotation)||0}function Cme(t){return Rs(t)?pG(t)*hG*cG:1}function Pme(t,e){return Fv(t,e,.5)}const Ok=(function(){const t=zt(),e=zt(),r=zt();return function(i,s,n,o,a,l){return T8(t,s),Fv(e,n,.5*l),Xt(r,1/o*l,-1/o*l),Ek(i,e),a&&uc(i,i,a),Yv(i,i,r),da(i,i,t),i}})(),Fk=(function(){const t=zt();return function(e,r,i,s){const n=ey(r),o=Rk(r);return Ak(t,r.targetGeometry),Ok(e,t,i,n,o,s)}})(),kme=(function(){const t=zt();return function(e,r,i,s){const n=ey(r);return Ak(t,r.targetGeometry),Ok(e,t,i,n,0,s)}})();function yG(t){const e=qi(t);return e?e.valid[1]-e.valid[0]:0}function Lme(t,e){return Math.round(yG(t)/e)}const Ame=(function(){const t=zt(),e=zt(),r=[0,0,0];return function(i,s,n){V0(t,i,s),ET(t,t),V0(e,i,n),ET(e,e),E8(r,t,e);let o=Math.acos(I8(t,e)/(G1(t)*G1(e)))*bme;return r[2]<0&&(o=-o),isNaN(o)&&(o=0),o}})(),Rme=(function(){const t=zt();return function(e,r,i,s){const n=e.targetGeometry;return Si(e,r),Eme(t,r,i,s),n.x+=t[0],n.y+=t[1],e}})(),x3=function(t,e,r){Si(t,e);const i=t.targetGeometry;return i.x=r.x,i.y=r.y,i.spatialReference=r.spatialReference,t},Ome=(function(){const t=zt();return function(e,r,i,s,n){n||(n="center"),HP(t,i,s),Fv(t,t,.5);const o=t[0],a=t[1];switch(n){case"center":Xt(t,0,0);break;case"left":Xt(t,-o,0);break;case"top":Xt(t,0,a);break;case"right":Xt(t,o,0);break;case"bottom":Xt(t,0,-a);break;case"top-left":Xt(t,-o,a);break;case"bottom-left":Xt(t,-o,-a);break;case"top-right":Xt(t,o,a);break;case"bottom-right":Xt(t,o,-a)}return z2(e,r,t),e}})();function $4e(t,e,r){return Si(t,e),t.rotation+=r,t}function Fme(t,e,r){return Si(t,e),t.rotation=r,t}const Nme=(function(){const t=zt();return function(e,r,i,s,n){return Si(e,r),isNaN(i)||i===0||(vG(t,s,r,n),e.scale=r.scale*i,wG(t,t,e,n),z2(e,e,Xt(t,t[0]-s[0],s[1]-t[1]))),e}})();function A5(t,e,r){return Si(t,e),t.scale=r,t}const gG=(function(){const t=zt();return function(e,r,i,s,n,o){return Si(e,r),isNaN(i)||i===0||(vG(t,n,r,o),e.scale=r.scale*i,e.rotation+=s,wG(t,t,e,o),z2(e,e,Xt(t,t[0]-n[0],n[1]-t[1]))),e}})(),M4e=(function(){const t=zt(),e=zt();return function(r,i,s,n,o,a,l){return fG(e,a,l),S8(t,o,e),n?gG(r,i,s,n,t,a):Nme(r,i,s,t,a)}})(),vG=(function(){const t=pa();return function(e,r,i,s){return gi(e,r,Ime(t,i,s,1))}})(),wG=(function(){const t=pa();return function(e,r,i,s){return gi(e,r,Fk(t,i,s,1))}})(),z2=(function(){const t=zt(),e=pa();return function(r,i,s){Si(r,i);const n=ey(i),o=r.targetGeometry;return N2(e,Rk(i)),Yv(e,e,Zv(n,n)),gi(t,s,e),o.x+=t[0],o.y+=t[1],r}})();function $l(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function Dme(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function zme(t,e,r,i,s,n){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o[4]=s,o[5]=n,o}function _G(t,e,r,i){const s=e[i],n=e[i+1];t[i]=r[0]*s+r[2]*n+r[4],t[i+1]=r[1]*s+r[3]*n+r[5]}function bG(t,e,r,i=0,s=0,n=2){const o=s||e.length/n;for(let a=i;a<o;a++)_G(t,e,r,a*n)}Object.freeze(Object.defineProperty({__proto__:null,clone:Dme,create:$l,fromValues:zme,transform:_G,transformMany:bG},Symbol.toStringTag,{value:"Module"}));function xb(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function jme(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Vme(t,e,r,i,s,n,o,a,l){const c=new Float32Array(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=i,c[4]=s,c[5]=n,c[6]=o,c[7]=a,c[8]=l,c}Object.freeze(Object.defineProperty({__proto__:null,clone:jme,create:xb,fromValues:Vme},Symbol.toStringTag,{value:"Module"}));function ev(){return new Float32Array(2)}function Ume(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function hd(t,e){const r=new Float32Array(2);return r[0]=t,r[1]=e,r}function SG(){return ev()}function xG(){return hd(1,1)}function $G(){return hd(1,0)}function MG(){return hd(0,1)}const Gme=SG(),qme=xG(),Bme=$G(),Hme=MG();Object.freeze(Object.defineProperty({__proto__:null,ONES:qme,UNIT_X:Bme,UNIT_Y:Hme,ZEROS:Gme,clone:Ume,create:ev,fromValues:hd,ones:xG,unitX:$G,unitY:MG,zeros:SG},Symbol.toStringTag,{value:"Module"}));function Wme(t){return t instanceof Float32Array&&t.length>=2}function Zme(t){return Array.isArray(t)&&t.length>=2}function m$(t){return Wme(t)||Zme(t)}var $3;const Ma=[0,0];let Va=$3=class extends W{constructor(t){super(t),this._viewpoint2D={center:zt(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Te,this.id=0,this.inverseTransform=pa(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=pa(),this.transformNoRotation=pa(),this.displayMat3=xb(),this.displayViewMat3=xb(),this.viewMat3=xb(),this.viewMat2d=$l(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,r=t.targetGeometry;e.center[0]=r.x,e.center[1]=r.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=r.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,r=this.viewpoint;return r&&e?(this.viewpoint=Si(r,t.viewpoint),this._set("size",Sf(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new $3({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,r){return m$(e)?gi(t,e,this.inverseTransform):(Ma[0]=e,Ma[1]=r,gi(t,Ma,this.inverseTransform))}toScreen(t,e,r){return m$(e)?gi(t,e,this.transform):(Ma[0]=e,Ma[1]=r,gi(t,Ma,this.transform))}toScreenNoRotation(t,e,r){return m$(e)?gi(t,e,this.transformNoRotation):(Ma[0]=e,Ma[1]=r,gi(t,Ma,this.transformNoRotation))}wrapMapCoordinate(t,e){Sf(t,e);const[r]=e,[i]=this.center,{extent:s,spatialReference:n}=this;let{xmin:o,xmax:a}=s;if(n.isWrappable){const l=yG(n)/2;o=Math.max(o,i-l),a=Math.min(a,i+l)}return(r<o||r>a)&&(t[0]=kk(r,i,n)),t}getScreenTransform(t,e){const{center:r}=this._viewpoint2D,i=this._get("pixelRatio")||1,s=this._get("size");return Ok(t,r,s,e,0,i),t}_update(){const{center:t,spatialReference:e,scale:r,rotation:i}=this._viewpoint2D,s=this._get("pixelRatio")||1,n=this._get("size"),o=new fn({targetGeometry:new de(t[0],t[1],e),scale:r,rotation:i});if(this._set("viewpoint",o),!n||!e||!r)return;this.resolution=ey(o),this.rotation=i,this.scale=r,this.spatialReference=e,Sf(this.center,t);const a=n[0]!==0?2/n[0]:0,l=n[1]!==0?-2/n[1]:0;xf(this.displayMat3,a,0,0,0,l,0,-1,1,1);const c=R8(this.viewMat3),d=hd(n[0]/2,n[1]/2),p=hd(-n[0]/2,-n[1]/2),m=BP(i);PT(c,c,d),N8(c,c,m),PT(c,c,p),G0(this.displayViewMat3,this.displayMat3,c);const y=Ek(this.viewMat2d,d);return uc(y,y,m),da(y,y,p),Mme(this.extent,o,n),Fk(this.transform,o,n,s),Ik(this.inverseTransform,this.transform),kme(this.transformNoRotation,o,n,s),this.worldScreenWidth=Lme(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};u([h({readOnly:!0})],Va.prototype,"id",void 0),u([h({value:1,json:{write:!0}})],Va.prototype,"pixelRatio",null),u([h({json:{write:!0}})],Va.prototype,"size",null),u([h()],Va.prototype,"spatialReference",void 0),u([h({type:fn,json:{write:!0}})],Va.prototype,"viewpoint",null),u([h({readOnly:!0})],Va.prototype,"visibleArea",null),Va=$3=u([E("esri.views.2d.ViewState")],Va);const R5=Va;var M3,T3;let cl=M3=class extends le{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new M3({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};u([h()],cl.prototype,"left",void 0),u([h()],cl.prototype,"top",void 0),u([h()],cl.prototype,"right",void 0),u([h()],cl.prototype,"bottom",void 0),cl=M3=u([E("esri.views.2d.PaddedViewState.Padding")],cl);let _p=T3=class extends R5{constructor(...t){super(...t),this.paddedViewState=new R5,this._updateContent=(()=>{const e=zt();return()=>{const r=this._get("size"),i=this._get("padding");if(!r||!i)return;const s=this.paddedViewState;Xt(e,i.left+i.right,i.top+i.bottom),V0(e,r,e),Sf(s.size,e);const n=s.viewpoint;n&&(this.viewpoint=n)}})(),this.addHandles(ie(()=>[this.size,this.padding],()=>this._updateContent(),wa)),this.padding=new cl,this.size=[0,0]}set padding(t){this._set("padding",t||new cl)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const r=this._get("padding");r&&(e=Rme(t.clone(),t,this._get("size"),r));const{targetGeometry:i,rotation:s,scale:n}=e,{x:o,y:a,spatialReference:l}=i,c=this._viewpoint2D;c.center[0]=o,c.center[1]=a,c.rotation=s,c.scale=n,c.spatialReference=l,this._update()}}clone(){return new T3({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};u([h()],_p.prototype,"paddedViewState",void 0),u([h({type:cl})],_p.prototype,"padding",null),u([h()],_p.prototype,"viewpoint",null),_p=T3=u([E("esri.views.2d.PaddedViewState")],_p);const Nk=_p;let xg=class extends le{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};u([h()],xg.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),u([h()],xg.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),xg=u([E("esri.views.support.debugFlags")],xg);const Jme=new xg,TG=Symbol("Yield");let Yme=class{constructor(){this._tasks=new Array,this._numPendingTasks=Mm(0),this._readyToRun=Mm(!1)}get length(){return this._tasks.length}get updating(){return this._numPendingTasks.value>0}get readyToRun(){return this._readyToRun.value}_updateReadyToRun(){this._readyToRun.value=this._tasks.length>0}destroy(){this.cancelAll()}runTask(e){if(this.length===0)return TG;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,r,i){return this._addTask((s,n)=>new F5(s,n,e,r,i),Array.prototype.push)}unshift(e,r,i){return this._addTask((s,n)=>new F5(s,n,e,r,i),Array.prototype.unshift)}pushGenerator(e,r,i){return this._addTask((s,n)=>new Xme(s,n,e,r,i),Array.prototype.push)}_process(e){if(this._tasks.length===0)return!1;const r=this._tasks.shift();this._updateReadyToRun();try{if(xi(r.signal))this._cancelTask(r,it());else switch(r.type){case 0:this._processSimple(r,e);break;case 1:this._processGenerator(r,e);break;case 2:this._processIterator(r,e);break;default:}}catch(i){r.reject(i)}return!0}cancelAll(){const e=it();for(const r of this._tasks)this._cancelTask(r,e);this._tasks.length=0,this._updateReadyToRun()}_cancelTask(e,r){if(e.abortCallback){const i=e.abortCallback(r);e.type===2&&e.iterator.return&&O5(e.iterator.return()),$i(i)?i.then(e.resolve,e.reject):e.resolve(i)}else e.type===2&&e.iterator.throw&&O5(e.iterator.throw(r)),e.reject(r)}_onIteratorResult(e,r){r.done?e.resolve(r.value):(this._tasks.unshift(e),this._updateReadyToRun())}_processSimple(e,r){const i=e.callback(r);$i(i)?i.then(e.resolve,e.reject):e.resolve(i)}_processGenerator(e,r){const i=e.generatorFunction(r),s=new Kme(e.resolve,e.reject,i,e.signal,e.abortCallback);this._processIterator(s,r)}_processIterator(e,r){const i=e.iterator.next(r);$i(i)?i.then(s=>this._onIteratorResult(e,s),e.reject):this._onIteratorResult(e,i)}_addTask(e,r){return new Promise((i,s)=>{const n=e(i,s);r.call(this._tasks,n),++this._numPendingTasks.value,this._updateReadyToRun()}).finally(()=>--this._numPendingTasks.value)}};function O5(t){$i(t)?t.then(y$,y$):y$(t)}function y$(t){Ur(t)||t instanceof Error||t instanceof R||t!=null&&typeof t=="object"&&"done"in t&&t.done||U.getLogger("esri.layers.support.PromiseQueue").warn("Generator iterator was aborted, but it is not done.")}let Dk=class{constructor(e,r,i=void 0,s=void 0){this.resolve=e,this.reject=r,this.signal=i,this.abortCallback=s}},F5=class extends Dk{constructor(e,r,i,s,n){super(e,r,s,n),this.callback=i,this.type=0}},Xme=class extends Dk{constructor(e,r,i,s,n){super(e,r,s,n),this.generatorFunction=i,this.type=1}},Kme=class extends Dk{constructor(e,r,i,s,n){super(e,r,s,n),this.iterator=i,this.type=2}};function Qme(){return new sye}const Le={RESOURCE_CONTROLLER_IMMEDIATE:"immediate",RESOURCE_CONTROLLER:"schedule",SLIDE:"slide",STREAM_DATA_LOADER:"stream loader",ELEVATION_QUERY:"elevation query",TERRAIN_SURFACE:"terrain",SURFACE_GEOMETRY_UPDATES:"surface geometry updates",LOD_RENDERER:"LoD renderer",GRAPHICS_CORE:"Graphics3D",I3S_CONTROLLER:"I3S",POINT_CLOUD_LAYER:"point cloud",FEATURE_TILE_FETCHER:"feature fetcher",STREAM_CONTROLLER:"stream controller",OVERLAY:"overlay",OVERLAY_RENDERER:"overlay renderer",STAGE:"stage",GRAPHICS_DECONFLICTOR:"graphics deconflictor",FILTER_VISIBILITY:"Graphics3D filter visibility",SCALE_VISIBILITY:"Graphics3D scale visibility",FRUSTUM_VISIBILITY:"Graphics3D frustum visibility",POINT_OF_INTEREST_FREQUENT:"POI frequent",POINT_OF_INTEREST_INFREQUENT:"POI infrequent",LABELER:"labeler",FEATURE_QUERY_ENGINE:"feature query",FEATURE_TILE_TREE:"feature tile tree",FEATURE_TILE_TREE_ACTIVE:"fast feature tile tree",ELEVATION_ALIGNMENT:"elevation alignment",ELEVATION_ALIGNMENT_SCENE:"elevation alignment scene",TEXT_TEXTURE_ATLAS:"text texture atlas",TEXTURE_UNLOAD:"texture unload",LINE_OF_SIGHT_TOOL:"line of sight tool",LINE_OF_SIGHT_TOOL_INTERACTIVE:"interactive line of sight tool",ELEVATION_PROFILE:"elevation profile",SNAPPING:"snapping",SHADOW_ACCUMULATOR:"shadow accumulator",CLOUDS_GENERATOR:"clouds generator",FLOW_GENERATOR:"flow generator",MAPVIEW_FETCH_QUEUE:"mapview fetch queue",MAPVIEW_LAYERVIEW_UPDATE:"mapview layerview update",MAPVIEW_VECTOR_TILE_PARSING_QUEUE:"mapview vector tile parsing queue",NONE:0,TEST_PRIO:1},Qs=0,N5=new Map([[Le.RESOURCE_CONTROLLER_IMMEDIATE,Qs],[Le.RESOURCE_CONTROLLER,4],[Le.SLIDE,Qs],[Le.STREAM_DATA_LOADER,Qs],[Le.ELEVATION_QUERY,Qs],[Le.TERRAIN_SURFACE,1],[Le.SURFACE_GEOMETRY_UPDATES,1],[Le.LOD_RENDERER,2],[Le.GRAPHICS_CORE,2],[Le.I3S_CONTROLLER,2],[Le.POINT_CLOUD_LAYER,2],[Le.FEATURE_TILE_FETCHER,2],[Le.STREAM_CONTROLLER,2],[Le.CLOUDS_GENERATOR,2],[Le.OVERLAY,4],[Le.OVERLAY_RENDERER,4],[Le.STAGE,4],[Le.GRAPHICS_DECONFLICTOR,4],[Le.FILTER_VISIBILITY,4],[Le.SCALE_VISIBILITY,4],[Le.FRUSTUM_VISIBILITY,4],[Le.POINT_OF_INTEREST_FREQUENT,6],[Le.POINT_OF_INTEREST_INFREQUENT,30],[Le.LABELER,8],[Le.FEATURE_QUERY_ENGINE,8],[Le.FEATURE_TILE_TREE,16],[Le.FEATURE_TILE_TREE_ACTIVE,Qs],[Le.ELEVATION_ALIGNMENT,12],[Le.ELEVATION_ALIGNMENT_SCENE,14],[Le.TEXT_TEXTURE_ATLAS,12],[Le.TEXTURE_UNLOAD,12],[Le.LINE_OF_SIGHT_TOOL,16],[Le.LINE_OF_SIGHT_TOOL_INTERACTIVE,Qs],[Le.SNAPPING,Qs],[Le.SHADOW_ACCUMULATOR,30],[Le.FLOW_GENERATOR,12],[Le.MAPVIEW_FETCH_QUEUE,Qs],[Le.MAPVIEW_LAYERVIEW_UPDATE,2],[Le.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,Qs]]);function D5(t){return N5.has(t)?N5.get(t):typeof t=="number"?t:1}const eye=6.5,z5=1,tye=30,rye=1e3/30,iye=100,j5=.9;let sye=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(e=>e.needsUpdate)}constructor(){this._updating=Mm(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new Kg("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new IG,this.state=1,this._tasks=new Array,this._runQueue=new Array,this._load=0,this._forceTask=!1,this._debug=!1,this._debugHandle=ie(()=>Jme.SCHEDULER_LOG_SLOW_TASKS,e=>this._debug=e,ft);for(const e of Object.keys(Le))this.performanceInfo.tasks.set(Le[e],new Kg(String(Le[e])))}destroy(){this._tasks.forEach(e=>e.remove()),this._tasks.length=0,this._runQueue.length=0,yt(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())}))}registerTask(e,r){const i=new nye(this,e,r);return this._tasks.push(i),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new Kg(e)),i}get load(){return this._load}frame(e){if(this._startFrameTaskTimes(),this._updateBudget(e)){const r=this._budget.now();return this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-r),!0}return this._recordFrameTaskTimes(0),!1}_updateBudget(e){this._test&&(this._test.usedBudget=0),++this._frameNumber;let r=eye,i=e.frameDuration,s=z5;switch(this.state){case 2:r=0,i=Math.max(iye,e.frameDuration),s=tye;break;case 1:i=Math.max(rye,e.frameDuration)}return i=i-e.elapsedFrameTime-r,this.state!==2&&i<z5&&!this._forceTask?(this._forceTask=!0,!1):(i=Math.max(i,s),this._budget.reset(i),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case 2:this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(0),this._budget.madeProgress()}removeTask(e){$M(this._tasks,e),$M(this._runQueue,e),this._updatingChanged()}_updateTask(e){this._tasks.forEach(r=>{r.name===e&&r.setPriority(e)})}_getState(e){if(this._runQueue.some(i=>i.name===e))return"s";let r="i";return this._tasks.forEach(i=>{i.name===e&&i.needsUpdate&&(i.schedulePriority<=1?r="r":r!=="r"&&(r="w"))}),r}_getRuntime(e){let r=0;return this._tasks.forEach(i=>{i.name===e&&(r+=i.runtime)}),r}_resetRuntimes(){this._tasks.forEach(e=>e.runtime=0)}_getRunning(){const e=new Map;if(this._tasks.forEach(i=>{i.needsUpdate&&e.set(i.name,(e.get(i.name)||0)+1)}),e.size===0)return null;let r="";return e.forEach((i,s)=>{r+=i>1?` ${i}x ${s}`:` ${s}`}),r}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce((r,i)=>i.needsUpdate?++r:r,0);this._load=this._load*j5+e*(1-j5)}_schedule(){for(UY(this._runQueue,e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1)),this._tasks.forEach(e=>{e.basePriority===Qs&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)});this._runQueue.length===0;){let e=!1,r=0;if(this._tasks.forEach(i=>{i.needsUpdate&&i.schedulePriority!==0&&i.basePriority!==Qs&&i.blockFrame!==this._frameNumber&&(e=!0,r=Math.max(r,i.basePriority),i.schedulePriority===1?(i.schedulePriority=0,this._runQueue.push(i)):--i.schedulePriority)}),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do for(;this._runQueue.length>0;){const e=this._budget.now(),r=this._runQueue.pop();this._budget.resetProgress();try{r.task.runTask(this._budget)===TG&&(r.blockFrame=this._frameNumber)}catch(s){U.getLogger("esri.views.support.Scheduler").error(`Exception in task "${r.name}"`,s),r.blockFrame=this._frameNumber}!this._budget.hasProgressed&&r.blockFrame!==this._frameNumber&&r.needsUpdate&&(r.name,r.blockFrame=this._frameNumber),r.schedulePriority=r.basePriority;const i=this._budget.now()-e;if(r.runtime+=i,this._frameTaskTimes.set(r.priority,this._frameTaskTimes.get(r.priority)+i),this._budget.remaining<=0)return void this._updatingChanged()}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const e of Object.keys(Le))this._frameTaskTimes.set(Le[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach((r,i)=>this.performanceInfo.tasks.get(i).push(r)),this.performanceInfo.total.push(e)}get test(){return this._test}},nye=class{get task(){return this._task.value}get readyToRun(){return this._queue.readyToRun}get updating(){return this._queue.updating}constructor(e,r,i){this._scheduler=e,this.name=r,this.blockFrame=0,this.runtime=0,this._queue=new Yme,this._handles=new zm,this._basePriority=D5(r),this.schedulePriority=this._basePriority,this._task=Mm(i??this._queue),this._handles.add(Ti(()=>this.task.readyToRun,s=>e.taskRunningChanged(s)))}remove(){this.processQueue(_0),this._scheduler.removeTask(this),this.schedule=g$.schedule,this.reschedule=g$.reschedule,this.scheduleGenerator=g$.scheduleGenerator,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const r=D5(e);this._basePriority!==Qs&&this.schedulePriority===0||(this.schedulePriority=r),this._basePriority=r}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.readyToRun||!this.task.destroyed&&this.task.readyToRun}schedule(e,r,i){return this._queue.push(e,r,i)}reschedule(e,r,i){return this._queue.unshift(e,r,i)}scheduleGenerator(e,r,i){return this._queue.pushGenerator(e,r,i)}processQueue(e){return this._queue.runTask(e)}},IG=class{constructor(){this._begin=performance?.now()??0,this._budget=0,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(e()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e){this._begin=this.now(),this._budget=e,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}};const _0=new IG;_0.enabled=!1;let oye=class{remove(){}processQueue(){}schedule(e,r,i){try{if(xi(r)){const s=it();return i?Promise.resolve(i(s)):Promise.reject(s)}return PM(e(_0))}catch(s){return Promise.reject(s)}}reschedule(e,r,i){return this.schedule(e,r,i)}async scheduleGenerator(e,r,i){if(xi(r)){const n=it();if(i)return i(n);throw n}const s=e(_0);for(;;){const n=s.next(_0),o=$i(n)?await n:n;if(xi(r)){const a=it();if(i){const c=i(a),d=s.return(null);return $i(d)&&await hm(d),c}const l=s.throw(a);throw $i(l)&&await hm(l),a}if(o.done)return o.value}}};const g$=new oye;let aye=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=Qme(),this._schedulerHandle=Ti(()=>this._scheduler.updating,()=>this.requestFrame()),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),this.view.animation?.target==null||$i(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=r=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:i,graphicsView:s,labelManager:n,state:{id:o}}=this.view;i?.forEach(this._updateLayerView,this),n!=null&&(n.lastUpdateId!==o&&(n.viewChange(),n.lastUpdateId=o),n.updateRequested&&n.processUpdate(this._updateParameters)),s!=null&&(s.lastUpdateId!==o&&(s.viewChange(),s.lastUpdateId=o),s.updateRequested&&s.processUpdate(this._updateParameters)),this.view.graphicsTileStore?.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=0:this.view.interacting?this._scheduler.state=1:this._scheduler.state=2,this._scheduler.frame(r)||this._updateRequested||this._scheduler.state!==2||this._frameTaskHandle?.pause()}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new Nk,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=ie(()=>e.stationary,r=>{this.stationary=r,this.requestFrame()}),this._frameTaskHandle=pm(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){if(!e.attached)return void this.requestUpdate();const r=this.view.state,i=e.lastUpdateId;i!=null&&(this.stationary||e.moving)||(e.moving=!0),i!==r.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=r.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews?.forEach(this._updateLayerView,this)}};function lye(t,e){const{spatialReference:r}=e,i=[e.x,e.y];let s,n,o,a;const l=[0,0],c=uye(t);for(let m=0;m<c.length;m++){const y=c[m];for(let g=0;g<y.length-1;g++){Sne(l,i,y,g);const v=_2(i,l);(s==null||v<s)&&(s=v,n=[...l],o=m,a=g)}}if(s==null||!n||o==null||a==null)throw new R("nearest-coordinate:failed","Failed to find the nearest coordinate");const[d,p]=n;return{coordinate:new de({x:d,y:p,spatialReference:r}),distance:s}}function uye(t){switch(t.type){case"extent":return[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]];case"polygon":return t.rings;case"polyline":return t.paths}}var I3;let xh=I3=class extends NP(le){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return yc(this.geometry,this.spatialReference)}catch(t){return U.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const r=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?kv(this.normalizedGeometry,r):bP(this.normalizedGeometry,r))return t;const{coordinate:i}=lye(this.normalizedGeometry,r);return i&&(t.targetGeometry=i),t}clone(){return new I3({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};u([h({constructOnly:!0})],xh.prototype,"geometry",void 0),u([h({readOnly:!0})],xh.prototype,"normalizedGeometry",null),u([h({constructOnly:!0})],xh.prototype,"spatialReference",void 0),xh=I3=u([E("esri.views.2d.constraints.GeometryConstraint")],xh);var E3;let $g=E3=class extends NP(le){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new E3({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};u([h()],$g.prototype,"enabled",void 0),u([h()],$g.prototype,"rotationEnabled",void 0),$g=E3=u([E("esri.views.2d.constraints.RotationConstraint")],$g);const EG=$g;var C3;let Yi=C3=class extends NP(le){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:r,maxScale:i,minZoom:s,maxZoom:n}=this,o=-1,a=-1,l=!1,c=!1;if(r!==0&&i!==0&&r<i&&([r,i]=[i,r]),!e?.length)return this._set("effectiveMinScale",r),void this._set("effectiveMaxScale",i);e=e.map(d=>d.clone()),e.sort((d,p)=>p.scale-d.scale),e.forEach((d,p)=>d.level=p);for(const d of e)!l&&r>0&&r>=d.scale&&(o=d.level,l=!0),!c&&i>0&&i>=d.scale&&(a=t?t.level:-1,c=!0),t=d;s===-1&&(s=r===0?0:o),n===-1&&(n=i===0?e.length-1:a),s=Math.max(s,0),s=Math.min(s,e.length-1),n=Math.max(n,0),n=Math.min(n,e.length-1),s>n&&([s,n]=[n,s]),r=e[s].scale,i=e[n].scale,e.splice(0,s),e.splice(n-s+1),e.forEach((d,p)=>{this._lodByScale[d.scale]=d,this._scales[p]=d.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",s),this._set("effectiveMaxZoom",n),this._set("effectiveMinScale",r),this._set("effectiveMaxScale",i)}constrain(t,e){if(e&&t.scale===e.scale)return t;const r=this.effectiveMinScale,i=this.effectiveMaxScale,s=t.targetGeometry,n=e&&e.targetGeometry,o=i!==0&&t.scale<i,a=r!==0&&t.scale>r;if(o||a){const l=a?r:i;if(e&&n){const c=(l-e.scale)/(t.scale-e.scale);s.x=n.x+(s.x-n.x)*c,s.y=n.y+(s.y-n.y)*c}t.scale=l}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),r=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(r>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const r=Math.floor(t),i=Math.ceil(t);return e[r]+(t-r)*(e[i]-e[r])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let r,i;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let s=0;s<e.length-1;s++){if(r=e[s],i=e[s+1],i===t)return s+this.effectiveMinZoom+1;if(r>t&&i<t)return s+this.effectiveMinZoom+1-(t-i)/(r-i)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const r=Math.round(this.scaleToZoom(t));return this.zoomToScale(r+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const r=Math.round(this.scaleToZoom(t));return this.zoomToScale(r-1)}clone(){return new C3({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,r)=>Math.abs(r-t)<=Math.abs(e-t)?r:e,this._scales[0])),this._lodByScale[t].scale}};u([h({readOnly:!0})],Yi.prototype,"effectiveLODs",void 0),u([h({readOnly:!0})],Yi.prototype,"effectiveMinZoom",void 0),u([h({readOnly:!0})],Yi.prototype,"effectiveMaxZoom",void 0),u([h({readOnly:!0})],Yi.prototype,"effectiveMinScale",void 0),u([h({readOnly:!0})],Yi.prototype,"effectiveMaxScale",void 0),u([h()],Yi.prototype,"lods",void 0),u([h()],Yi.prototype,"minZoom",void 0),u([h()],Yi.prototype,"maxZoom",void 0),u([h()],Yi.prototype,"minScale",void 0),u([h()],Yi.prototype,"maxScale",void 0),u([h()],Yi.prototype,"snapToZoom",void 0),Yi=C3=u([E("esri.views.2d.constraints.ZoomConstraint")],Yi);const CG=Yi,cye={base:null,key:"type",typeMap:{extent:Te,polygon:dt}};let qt=class extends le{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new se}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const e=this._get("_geometry");return e&&this.geometry===e.geometry&&this.view?.constraintsInfo.spatialReference===e.spatialReference?e:new xh({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new EG({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),r=this.lods||this.view?.constraintsInfo.lods,i=this.minZoom,s=this.maxZoom,n=this.minScale,o=this.maxScale,a=this.snapToZoom;return e&&e.lods===r&&e.minZoom===i&&e.maxZoom===s&&e.minScale===n&&e.maxScale===o&&e.snapToZoom===a?e:new CG({lods:r,minZoom:i,maxZoom:s,minScale:n,maxScale:o,snapToZoom:a})}canZoomInTo(e){const r=this.effectiveMaxScale;return r===0||e>=r}canZoomOutTo(e){const r=this.effectiveMinScale;return r===0||e<=r}constrain(e,r){return this._zoom.constrain(e,r),this._rotation.constrain(e,r),this._geometry.constrain(e,r),this.customConstraints.forEach(i=>i.constrain(e,r)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(r=>r.applyPanConstraint?.(e)),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};u([h({readOnly:!0})],qt.prototype,"effectiveLODs",null),u([h({readOnly:!0})],qt.prototype,"effectiveMinScale",null),u([h({readOnly:!0})],qt.prototype,"effectiveMaxScale",null),u([h({readOnly:!0})],qt.prototype,"effectiveMinZoom",null),u([h({readOnly:!0})],qt.prototype,"effectiveMaxZoom",null),u([h({types:cye,value:null})],qt.prototype,"geometry",null),u([h({type:[Yr]})],qt.prototype,"lods",void 0),u([h()],qt.prototype,"minScale",void 0),u([h()],qt.prototype,"maxScale",void 0),u([h()],qt.prototype,"minZoom",void 0),u([h()],qt.prototype,"maxZoom",void 0),u([h()],qt.prototype,"rotationEnabled",void 0),u([h()],qt.prototype,"snapToZoom",void 0),u([h({type:se})],qt.prototype,"customConstraints",void 0),u([h()],qt.prototype,"view",void 0),u([h({readOnly:!0})],qt.prototype,"version",null),u([h({type:xh,readOnly:!0})],qt.prototype,"_geometry",null),u([h({type:EG})],qt.prototype,"_rotation",null),u([h({readOnly:!0,type:CG})],qt.prototype,"_zoom",null),qt=u([E("esri.views.2d.MapViewConstraints")],qt);const V5=qt;let ai=class extends le{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([ie(()=>this.constraints?.version,r=>{this.constraints&&r&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},wa)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:r}=this.state.paddedViewState;return this.state.commitProperty("id"),new de({x:e[0],y:e[1],spatialReference:r})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let r;try{r=this._project(e,this.state.spatialReference)}catch(s){return void U.getLogger(this).error(new R("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:s}))}const i=this.viewpoint;x3(i,i,r),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void U.getLogger(this).error(new R("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let r;try{r=this._project(e,this.state.spatialReference)}catch(s){return void U.getLogger(this).error(new R("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:s}))}const i=this.viewpoint;Tme(i,i,r,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const r=this.viewpoint;Fme(r,r,e),this.viewpoint=r}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const i=this._get("extent");return void(i&&(this._set("extent",void 0),this._set("center",i.center)))}const r=this.viewpoint;A5(r,r,e),this.viewpoint=r}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let r,i;try{r=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?i=new R("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(i=new R("mapview:invalid-viewpoint","geometry not defined"))}catch(n){i=new R("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:n})}if(i)return void U.getLogger(this).error(i);this._scaleBeforeChangingSpatialReference=null;const s=new fn({targetGeometry:new de,scale:0,rotation:0});Si(s,r),this.constraints?.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this._set("viewpoint",s)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(e){if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const s=this._get("extent");return void(s&&(this._set("extent",void 0),this._set("center",s.center)))}const r=this.constraints?.zoomToScale(e)??0;if(!r)return void this._set("zoom",-1);const i=this.viewpoint;A5(i,i,r),this.viewpoint=i,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:r,constraints:i}=this,s=this._get("center"),n=this._get("extent"),o=this._get("scale"),a=this._get("rotation"),l=this._get("viewpoint"),c=this._get("zoom"),d=c!=null&&i!=null&&i.zoomToScale(c)||void 0;let p,m,y;const g=l?.rotation,v=l?.targetGeometry;v?.type==="extent"?p=v:v?.type==="point"&&(m=v,y=l?.scale);const w=n??p;return{center:s??m??w?.center,rotation:a??g,scale:(o??d??y??(w&&D2(w,[e[0]-r.left-r.right,e[1]-r.top-r.bottom])))||void 0}}startup(e,r,i,s){const n=e.targetGeometry;try{this._project(e,i)}catch(o){U.getLogger(this).warn(new zs("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:n.toJSON(),spatialReference:i,error:o})),e.targetGeometry=s||new de({x:0,y:0,spatialReference:i})}this.constraints?.fit(e),this._set("state",new Nk({padding:this.padding,size:r,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,r],spatialReference:i,rotation:s,scale:n}=this.state.paddedViewState,o=new de({x:e,y:r,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("state",null)}changeSpatialReference(e){const r=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=r.scale;else{const l=r.viewpoint.clone();l.scale=this._scaleBeforeChangingSpatialReference,r.viewpoint=l}const i=r.clone(),[s,n]=r.center;let o=null;try{o=this._project(new de({x:s,y:n,spatialReference:r.spatialReference}),e)}catch(l){J6()||U.getLogger(this).warn(new zs("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o?.toJSON(),spatialReference:e,error:l}))}o||(o=new de({x:0,y:0,spatialReference:e}));const a=x3(new fn({targetGeometry:new de,scale:0,rotation:0}),r.viewpoint,o);i.viewpoint=a;try{const c=[r.size[0]/2,r.size[1]/2],d=[c[0]+20,c[1]],p=r.toMap([0,0],d),{x:m,y}=this._project(new de({x:p[0],y:p[1],spatialReference:r.spatialReference}),e);p[0]=m,p[1]=y,i.toScreen(p,p);const g=Ame(c,p,d),v=Math.hypot(p[0]-c[0],p[1]-c[1])/20;!Number.isFinite(v)||Math.abs(v)>4?(a.rotation=0,a.targetGeometry=new de({x:0,y:0,spatialReference:e})):(a.scale*=v,a.scale>z("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(g)?g:0)}catch{}this._get("constraints")?.constrain(a,void 0),this._get("state").viewpoint=a}resize(e,r){if(!this.ready)return;const i=this.state;let s=this.state.paddedViewState.viewpoint;const n=this.state.paddedViewState.size.slice();i.size=[e,r],Ome(s,s,n,this.state.paddedViewState.size,this.resizeAlign),s=this.constraints?.constrain(s,void 0)??s,this.state.viewpoint=s}toMap(e){if(!this.ready)return null;const r=[0,0],[i,s]=this.state.toMap(r,[e.x,e.y]),n=this.state.spatialReference;return new de({x:i,y:s,spatialReference:n})}toScreen(e,r){if(!this.ready)return null;const i=this._project(e,this.state.spatialReference),s=[i.x,i.y];return r?.pickClosestTarget===!1||this.state.paddedViewState.wrapMapCoordinate(s,s),this.state.toScreen(s,s),Tr(s[0],s[1])}_project(e,r){const i=e?.targetGeometry||e;if(!r)return e;if(!i)return null;if(r.imageCoordinateSystem||i.spatialReference?.imageCoordinateSystem||Cr(r,i.spatialReference))return e;const s=yc(i,r);if(!s)throw new R("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:r});return hye(e)?(e.targetGeometry=s,e):s}};function hye(t){return t?.declaredClass==="esri.Viewpoint"}u([h({type:de})],ai.prototype,"center",null),u([h()],ai.prototype,"constraints",void 0),u([h({type:Te})],ai.prototype,"extent",null),u([h({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],ai.prototype,"padding",null),u([h()],ai.prototype,"ready",void 0),u([h()],ai.prototype,"resizeAlign",void 0),u([h({readOnly:!0})],ai.prototype,"resolution",null),u([h({type:Number})],ai.prototype,"rotation",null),u([h({type:Number})],ai.prototype,"scale",null),u([h({readOnly:!0})],ai.prototype,"state",void 0),u([h({type:fn})],ai.prototype,"viewpoint",null),u([h({readOnly:!0})],ai.prototype,"visibleArea",null),u([h()],ai.prototype,"zoom",null),ai=u([E("esri.views.2d.ViewStateManager")],ai);const U5=160;let Mg=class extends le{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=U5&&this.clear()},U5))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};u([h()],Mg.prototype,"_timer",void 0),u([h()],Mg.prototype,"stationary",null),Mg=u([E("esri.views.2d.support.StationaryManager")],Mg);const dye=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.fullOpacity=1,this.stateManager=new ai({constraints:new V5({view:this})}),this.stationaryManager=new Mg,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new aye(this),this.viewEvents=new U7(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([ie(()=>this.viewpoint,()=>this.stationaryManager.flip(),wa)])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){return this.stateManager?.extent??null}set extent(i){this.stateManager.extent=i}get state(){return this.stateManager.state}get interacting(){return!1}get stationary(){return!this.animation&&this.stationaryManager.stationary}set animation(i){const s=this._get("animation");if(i===s)return;if(s&&s.stop(),i!==this.animationManager.animation&&this.animationManager.stop(),!i||i.isFulfilled())return void this._set("animation",null);this._set("animation",i);const n=()=>{this.destroyed||i===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};i.when(n,n)}get constraints(){return this.stateManager?.constraints}set constraints(i){i.view=this;const s=this.stateManager.constraints;this.stateManager.constraints=i,s?.destroy()}get padding(){return this.stateManager?.padding}set padding(i){this.stateManager&&(this.stateManager.padding=i)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(i){this.stateManager.resizeAlign=i}get rotation(){return this.stateManager.rotation??0}set rotation(i){const{rotationEnabled:s}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=i,this.constraints.rotationEnabled=s}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(i){this.stateManager.viewpoint=i,this.frameTask.requestFrame()}};return u([h({readOnly:!0})],r.prototype,"animationManager",void 0),u([h({readOnly:!0})],r.prototype,"fullOpacity",void 0),u([h()],r.prototype,"stateManager",void 0),u([h()],r.prototype,"constraintsInfo",null),u([h()],r.prototype,"extent",null),u([h({readOnly:!0})],r.prototype,"state",null),u([h({readOnly:!0})],r.prototype,"mapViewNavigation",void 0),u([h()],r.prototype,"renderingOptions",void 0),u([h({readOnly:!0})],r.prototype,"interacting",null),u([h()],r.prototype,"stationary",null),u([h()],r.prototype,"animation",null),u([h({type:V5})],r.prototype,"constraints",null),u([h()],r.prototype,"padding",null),u([h()],r.prototype,"resizeAlign",null),u([h()],r.prototype,"rotation",null),u([h({readOnly:!0})],r.prototype,"viewEvents",void 0),u([h({type:fn})],r.prototype,"viewpoint",null),r=u([E("esri.views.Viewport2DBaseMixin")],r),r},pye=()=>De.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;var Qf;let bp=(Qf=class extends dP{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=ps(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),this._resolver?.reject(new R("view:animation-stopped","ViewAnimation stopped")))}finish(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),this._resolver?.resolve())}update(e,r){r||(r=$i(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",r)}},Qf.state={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"},Qf);u([h({readOnly:!0})],bp.prototype,"done",null),u([h({readOnly:!0,type:String})],bp.prototype,"state",void 0),u([h()],bp.prototype,"target",void 0),bp=u([E("esri.views.ViewAnimation")],bp);const P3=bp;let $b=class extends le{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,r){if(!e)return void U.getLogger(this).error("#goTo()","target cannot be null or undefined");const i=new P3;this.view.animation=i,await Ov(()=>this.view.ready,r);const s={...r,animate:r?.animate??(!pye()&&this.view.animationsEnabled),animationMode:r?.animationMode??"auto"},{extent:n,spatialReference:o,size:a,viewpoint:l,constraints:c,padding:d,allLayerViews:p}=this.view,m=xme(e,{extent:n,spatialReference:o,size:a,viewpoint:l,constraints:c,padding:d,allLayerViews:p,pickClosestTarget:r?.pickClosestTarget??!0});return i?.update(m),this._gotoTask={},s.animate?this._gotoAnimated(m,s):this._gotoImmediate(m,s)}_gotoImmediate(e,r){const i=this._gotoTask,s=this.view.animation,n=e.then(o=>{if(gt(r),i!==this._gotoTask)throw new R("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=s.target=o,s.finish()});return this._cancellableGoTo(i,s,n,r)}_gotoAnimated(e,r){const i=this._gotoTask,s=this.view.animation;if(!s)return Promise.resolve();const n=e.then(o=>{if(gt(r),i!==this._gotoTask)throw new R("view:goto-interrupted","Goto was interrupted");return s.update(o),this.view.animationManager.animate(s,this.view.viewpoint,r),s.when().then(()=>{},()=>{})});return this._cancellableGoTo(i,s,n,r)}_cancellableGoTo(e,r,i,s){const n=()=>e===this._gotoTask;return zz(i,s).finally(()=>{n()&&(r.done||r.stop())})}};u([h({constructOnly:!0})],$b.prototype,"view",void 0),$b=u([E("esri.views.2d.GoToManager")],$b);function PG(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}function kG(t,e){return e.some(r=>PG(t,r))}function G5(t,{dragPrimary:e,dragSecondary:r,dragTertiary:i}){return[{key:"primary",value:e},{key:"secondary",value:r},{key:"tertiary",value:i}].filter(s=>s.value===t).map(s=>s.key)}let q5=class extends Pr{constructor(e,r){super(!0),this._view=e,this.registerIncoming("double-click",r,i=>this._handleDoubleClick(i,r))}_handleDoubleClick(e,r){PG(e.data,"primary")&&(e.stopPropagation(),r?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},fye=class extends Pr{constructor(e,r,i){super(!0),this.view=e,this.pointerType=r,this.registerIncoming("double-tap-drag",i,s=>this._handleDoubleTapDrag(s))}_handleDoubleTapDrag(e){const{data:r}=e,{pointerType:i}=r;if(i!==this.pointerType)return;e.stopPropagation();const{action:s,delta:n}=r,{view:o}=this,{mapViewNavigation:a}=o;switch(s){case"begin":{const{scale:l}=o;this._startScale=l,this._currentScale=l,this._previousDelta=n,a.begin();break}case"update":{if(this._previousDelta.y===n.y)return;this._previousDelta=n;const l=1.015**n.y,c=this._startScale*l,d=c/this._currentScale;a.setViewpointImmediate(d),this._currentScale=c;break}case"end":{const{constraints:l}=o,{effectiveLODs:c,snapToZoom:d}=l;if(!d||!c)return void a.end();const p=l.snapScale(this._currentScale),m=(n.y>0?Math.max(p,l.snapToPreviousScale(this._startScale)):Math.min(p,l.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(m).then(()=>{a.end()});break}}}},j2=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const r=e.data,i=r.pointers.size;switch(r.action){case"start":this._currentCount=i,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){this._startEvent=e,this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},mye=class extends Pr{constructor(e,r,i){super(!0),this.view=e,this.pointerActions=r,this.registerIncoming("drag",i,s=>this._handleDrag(s)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new j2({start:(r,i)=>{this.view.mapViewNavigation.pan.begin(this.view,i.data),i.stopPropagation()},update:(r,i)=>{this.view.mapViewNavigation.pan.update(this.view,i.data),i.stopPropagation()},end:(r,i)=>{this.view.mapViewNavigation.pan.end(this.view,i.data),i.stopPropagation()},condition:(r,i)=>r===1&&kG(i.data,this.pointerActions)})}_handleDrag(e){const r=this.view.mapViewNavigation;r.pinch.zoomMomentum||r.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},yye=class extends Pr{constructor(e,r,i){super(!0),this._view=e,this.pointerActions=r;const s=this._view.mapViewNavigation;this._dragEventSeparator=new j2({start:(n,o)=>{s.rotate.begin(this._view,o.data),o.stopPropagation()},update:(n,o)=>{s.rotate.update(this._view,o.data),o.stopPropagation()},end:(n,o)=>{s.rotate.end(),o.stopPropagation()},condition:(n,o)=>n===1&&kG(o.data,this.pointerActions)}),this.registerIncoming("drag",i,n=>this._dragEventSeparator.handle(n))}};function LG(t){const e=t[0],r=t[1],i=t[2];return Math.sqrt(e*e+r*r+i*i)}function gye(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function vye(t,e,r,i){return t[0]=e,t[1]=r,t[2]=i,t}function wye(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function AG(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function RG(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function OG(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function _ye(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function bye(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Sye(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function xye(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function $ye(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function Mye(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function Tye(t,e=0,r=1){return t[0]=Math.min(Math.max(t[0],e),r),t[1]=Math.min(Math.max(t[1],e),r),t[2]=Math.min(Math.max(t[2],e),r),t}function Iye(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function FG(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function Eye(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t}function NG(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2];return Math.sqrt(r*r+i*i+s*s)}function DG(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2];return r*r+i*i+s*s}function zG(t){const e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i}function Cye(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Pye(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function k3(t,e){const r=e[0],i=e[1],s=e[2];let n=r*r+i*i+s*s;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n),t}function jG(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function kye(t,e,r){const i=e[0],s=e[1],n=e[2],o=r[0],a=r[1],l=r[2];return t[0]=s*l-n*a,t[1]=n*o-i*l,t[2]=i*a-s*o,t}function Lye(t,e,r){const i=e[0],s=e[1],n=e[2],o=r[0],a=r[1],l=r[2],c=s*l-n*a,d=n*o-i*l,p=i*a-s*o,m=Math.sqrt(c*c+d*d+p*p);return t[0]=c/m,t[1]=d/m,t[2]=p/m,t}function Aye(t,e,r,i){const s=e[0],n=e[1],o=e[2];return t[0]=s+i*(r[0]-s),t[1]=n+i*(r[1]-n),t[2]=o+i*(r[2]-o),t}function Rye(t,e,r,i,s,n){const o=n*n,a=o*(2*n-3)+1,l=o*(n-2)+n,c=o*(n-1),d=o*(3-2*n);return t[0]=e[0]*a+r[0]*l+i[0]*c+s[0]*d,t[1]=e[1]*a+r[1]*l+i[1]*c+s[1]*d,t[2]=e[2]*a+r[2]*l+i[2]*c+s[2]*d,t}function Oye(t,e,r,i,s,n){const o=1-n,a=o*o,l=n*n,c=a*o,d=3*n*a,p=3*l*o,m=l*n;return t[0]=e[0]*c+r[0]*d+i[0]*p+s[0]*m,t[1]=e[1]*c+r[1]*d+i[1]*p+s[1]*m,t[2]=e[2]*c+r[2]*d+i[2]*p+s[2]*m,t}function Fye(t,e=1){const r=w2,i=2*r()*Math.PI,s=2*r()-1,n=Math.sqrt(1-s*s)*e;return t[0]=Math.cos(i)*n,t[1]=Math.sin(i)*n,t[2]=s*e,t}function Nye(t,e,r){const i=e[0],s=e[1],n=e[2];return t[0]=r[0]*i+r[4]*s+r[8]*n+r[12],t[1]=r[1]*i+r[5]*s+r[9]*n+r[13],t[2]=r[2]*i+r[6]*s+r[10]*n+r[14],t}function Dye(t,e,r){const i=e[0],s=e[1],n=e[2];return t[0]=i*r[0]+s*r[3]+n*r[6],t[1]=i*r[1]+s*r[4]+n*r[7],t[2]=i*r[2]+s*r[5]+n*r[8],t}function zye(t,e,r){const i=r[0],s=r[1],n=r[2],o=r[3],a=e[0],l=e[1],c=e[2],d=s*c-n*l,p=n*a-i*c,m=i*l-s*a,y=s*m-n*p,g=n*d-i*m,v=i*p-s*d,w=2*o;return t[0]=a+d*w+2*y,t[1]=l+p*w+2*g,t[2]=c+m*w+2*v,t}function jye(t,e,r,i){const s=[],n=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],n[0]=s[0],n[1]=s[1]*Math.cos(i)-s[2]*Math.sin(i),n[2]=s[1]*Math.sin(i)+s[2]*Math.cos(i),t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function Vye(t,e,r,i){const s=[],n=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],n[0]=s[2]*Math.sin(i)+s[0]*Math.cos(i),n[1]=s[1],n[2]=s[2]*Math.cos(i)-s[0]*Math.sin(i),t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function Uye(t,e,r,i){const s=[],n=[];return s[0]=e[0]-r[0],s[1]=e[1]-r[1],s[2]=e[2]-r[2],n[0]=s[0]*Math.cos(i)-s[1]*Math.sin(i),n[1]=s[0]*Math.sin(i)+s[1]*Math.cos(i),n[2]=s[2],t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function Gye(t,e){k3(B5,t),k3(H5,e);const r=jG(B5,H5);return r>1?0:r<-1?Math.PI:Math.acos(r)}const B5=mc(),H5=mc();function qye(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Bye(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Hye(t,e){if(t===e)return!0;const r=t[0],i=t[1],s=t[2],n=e[0],o=e[1],a=e[2],l=Bi();return Math.abs(r-n)<=l*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-o)<=l*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(s-a)<=l*Math.max(1,Math.abs(s),Math.abs(a))}function Wye(t,e,r){const i=r[0]-e[0],s=r[1]-e[1],n=r[2]-e[2];let o=i*i+s*s+n*n;return o>0?(o=1/Math.sqrt(o),t[0]=i*o,t[1]=s*o,t[2]=n*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const Zye=AG,Jye=RG,Yye=OG,Xye=NG,Kye=DG,Qye=LG,ege=zG;Object.freeze(Object.defineProperty({__proto__:null,abs:Sye,add:wye,angle:Gye,bezier:Oye,ceil:_ye,clamp:Tye,copy:gye,cross:kye,crossAndNormalize:Lye,direction:Wye,dist:Xye,distance:NG,div:Yye,divide:OG,dot:jG,equals:Hye,exactEquals:Bye,floor:bye,hermite:Rye,inverse:Pye,len:Qye,length:LG,lerp:Aye,max:Mye,min:$ye,mul:Jye,multiply:RG,negate:Cye,normalize:k3,random:Fye,rotateX:jye,rotateY:Vye,rotateZ:Uye,round:Iye,scale:FG,scaleAndAdd:Eye,set:vye,sign:xye,sqrDist:Kye,sqrLen:ege,squaredDistance:DG,squaredLength:zG,str:qye,sub:Zye,subtract:AG,transformMat3:Dye,transformMat4:Nye,transformQuat:zye},Symbol.toStringTag,{value:"Module"}));function Tn(t){let e=t*t;return t<0&&(e*=-1),e}function tge(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function rge(t,e,r){const i=r,s=t.state,n=t.device,o=e.tiltDirection==="forward-down"?1:-1,a=1;return n.deviceType==="standard"?(i.translation[0]=Tn(s.axes[0]),i.translation[1]=Tn(s.axes[1]),i.translation[2]=Tn(s.buttons[7])-Tn(s.buttons[6]),i.heading=Tn(s.axes[2]),i.tilt=Tn(s.axes[3])):n.deviceType==="spacemouse"&&(i.translation[0]=1.2*Tn(s.axes[0]),i.translation[1]=1.2*Tn(s.axes[1]),i.translation[2]=2*-Tn(s.axes[2]),i.heading=1.2*Tn(s.axes[5]),i.tilt=1.2*Tn(s.axes[3])),i.tilt*=o,FG(i.translation,i.translation,a),i}function ige(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let sge=class extends Pr{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new zm,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",r=>this._handleGamePadEvent(r)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([ie(()=>this._view.navigation.gamepad?.enabled,r=>{r?(this._handle.resume(),this._frameTask||(this._frameTask=pm({update:i=>this._frameUpdate(i.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},ft)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const r=this._view.navigation.gamepad.device;r&&e.data.device!==r||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,tge(this._transformation)):(this._currentDevice=e.data.device,rge(e.data,this._view.navigation.gamepad,this._transformation)),this._frameTask?.resume())}_frameUpdate(e){const r=this._transformation;if(ige(r))return void this._frameTask?.pause();const i=this._view.viewpoint.clone(),s=this._view.navigation.gamepad.velocityFactor,n=oge*s*e;z2(i,i,[r.translation[0]*n,-r.translation[1]*n]);const o=1+r.translation[2]*age*e,a=this._view.constraints.rotationEnabled?-r.heading*nge*e:0,l=this._view.size,c=[l[0]/2,l[1]];gG(i,i,o,a,c,l);const d=this._view.constraints.constrain(i,this._view.viewpoint);this._view.viewpoint=d}};const nge=.06,oge=.7,age=6e-4;function VG(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),je(()=>document.removeEventListener("visibilitychange",e))}let lge=class extends Pr{constructor(e,r,i){super(!0),this.view=e,this.keys=r,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=s=>{const n=this._keyMap[s.data.key];if(s.modifiers.has("Meta")||s.modifiers.has("Control"))return void this._stopMovement();if(n==null)return;s.stopPropagation(),s.preventDefault();const o=s.type==="key-down";if(this._pressedKeys[o?"add":"delete"](n),o){if(this._direction===n)return;this._direction=n,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const a=this._timeout===void 0,l=this._pressedKeys.size>0;a||l?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[r.left]:"left",[r.right]:"right",[r.up]:"up",[r.down]:"down"},this.registerIncoming("key-down",i,this._handleKey),this.registerIncoming("key-up",i,this._handleKey),this.registerIncoming("blur",i,this._stopMovement),this._visibilityHandle=VG(s=>s?null:this._stopMovement())}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(e){const r=this._currentDirection!=null;if(e!=null){if(r||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else r&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout(()=>{this._timeout=void 0,e()},this._stickyKeyDuration)}},uge=class extends Pr{constructor(e,r,i){super(!0),this.view=e,this.keys=r,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(r),this.registerIncoming("key-down",i,s=>this._handleKeyDown(s)),this.registerIncoming("key-up",i,s=>this._handleKeyUp(s)),this.registerIncoming("blur",i,()=>this._handleStop()),this._visibilityHandle=VG(s=>s?null:this._handleStop())}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,r){for(const i of e)this._keyToDirection.set(i,r)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,r){const i=e.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection.get(e.data.key);if(this._pressed=s!=null,this._pressed){if(e.preventDefault(),r)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},cge=class extends Pr{constructor(e,r,i){super(!0),this.view=e,this.keys=r,this._keysToZoomAction={},this.registerIncoming("key-down",i,s=>this._handleKeyDown(s)),r.zoomIn.forEach(s=>this._keysToZoomAction[s]=0),r.zoomOut.forEach(s=>this._keysToZoomAction[s]=1)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const r=e.modifiers;if(r.size>0&&!r.has("Shift"))return;const{key:i}=e.data;if(!(i in this._keysToZoomAction))return;const s=this._keysToZoomAction[i],{mapViewNavigation:n}=this.view;let o=null;switch(s){case 0:o=n.zoomIn();break;case 1:o=n.zoomOut();break;default:return}n.begin(),o.then(()=>n.end()),e.stopPropagation()}};const hge=.6;let dge=class extends Pr{constructor(e,r){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",r,i=>this._handleMouseWheel(i))}_handleMouseWheel(e){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const r=this._view.mapViewNavigation,{x:i,y:s,deltaY:n}=e.data,o=1/hge**(1/60*n),a=r.zoom(o,[i,s]);this._canZoom=!1,a.catch(()=>{}).then(()=>{this._canZoom=!0,r.end()})}},pge=class extends Pr{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",i=>this._handleDrag(i)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const r=this.view.mapViewNavigation;this._dragEventSeparator=new j2({start:(i,s)=>{r.pinch.begin(this.view,s.data),s.stopPropagation()},update:(i,s)=>{r.pinch.update(this.view,s.data),s.stopPropagation()},end:(i,s)=>{r.pinch.end(this.view),s.stopPropagation()},condition:i=>i>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function W5(t){const e=t.native;return e?{buttons:e.buttons.map(r=>r.pressed?r.value||1:0),axes:e.axes.map(r=>yge(r,t.axisThreshold))}:{buttons:[],axes:[]}}function fge(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let r=0;r<t.axes.length;r++)if(t.axes[r]!==e.axes[r])return!1;for(let r=0;r<t.buttons.length;r++)if(t.buttons[r]!==e.buttons[r])return!1;return!0}function mge(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function yge(t,e){const r=Math.abs(t);return r<e?0:Math.sign(t)*(r-e)/(1-e)}let gge=class{constructor(e,r){this._element=e,this._input=r,this._hasEventListeners=!1,this._onConnectGamepad=n=>{this._connectGamepad(n.gamepad)},this._onDisconnectGamepad=n=>{const o=n.gamepad,a=o.index,l=this._inputDevices[a];l&&(this._emitGamepadEvent(o,W5(l),!1),this._inputDevices.splice(a,1),this._latestUpdate.splice(a,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const i="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=i&&s,this.supported&&(Z5(n=>this._connectGamepad(n)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const r=new Mk(e);r.deviceType!=="unknown"&&(this._inputDevices[e.index]=r,this._input.gamepad.devices.add(r)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=pm({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),r=this._element.contains(document.activeElement),i=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!r;Z5(s=>{const n=this._inputDevices[s.index];if(!n)return;const o=this._latestUpdate[s.index],a=W5(n),l=i||mge(a);o&&(o.timestamp===s.timestamp||!o.active&&l||fge(o.state,a))||this._emitGamepadEvent(s,a,!l)})}_emitGamepadEvent(e,r,i){const s=this._latestUpdate[e.index],n=s&&s.active;if(!n&&!i)return;const o=!n&&i?"start":n&&i?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:r,active:i},this._callback&&this._callback({device:this._inputDevices[e.index],state:r,action:o})}};function vge(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function Z5(t){for(const e of navigator.getGamepads())vge(e)&&t(e)}const J5=z("edge"),wge=z("chrome"),_ge=z("ff"),bge=z("safari"),Y5="esri-view-surface",jd={touchNone:`${Y5}--touch-none`,touchPan:`${Y5}--touch-pan`};var Xh;let Sge=(Xh=class{constructor(e,r){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new gge(e,r),this._gamepadSource.onEvent=i=>this._callback("gamepad",i)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>this._releasePointerCaptureSafe(e)),this._activePointerCaptures.clear(),this._gamepadSource=xt(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const r in this._active)if(!e||!e.has(r)){const i=this._active[r];this._element.removeEventListener(v$[r],i),delete this._active[r]}e&&e.forEach(r=>{if(!this._active[r]&&v$[r]){const i=(this._eventHandlers[r]||this._handleDefault).bind(this,r);this._element.addEventListener(v$[r],i),this._active[r]=i}}),this._gamepadSource&&(this._gamepadSource.hasEventListeners=e?.has("gamepad")??!1)}setPointerCapture(e,r){r?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?jd.touchNone:jd.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?jd.touchPan:jd.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(jd.touchNone),this._element.classList.remove(jd.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,r){const i=q7(this._element,e);return Xh.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),r.x=i.x,r.y=i.y,r}_handleKey(e,r){const{key:i}=r;i&&e==="key-up"&&this._keyDownState.delete(i);const s={native:r,key:i,repeat:!!i&&this._keyDownState.has(i)};i&&e==="key-down"&&this._keyDownState.add(s.key),this._callback(e,s)}_handlePointer(e,r){const i=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,pointerType:r.pointerType,button:r.button,buttons:r.buttons,eventId:this._eventId++});this._callback(e,i)}_handlePointerPreventDefault(e,r){const i=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,pointerType:r.pointerType,button:r.button,buttons:r.buttons,eventId:this._eventId++});r.preventDefault(),this._callback(e,i)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&z("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,r){let i=this._getDeltaFromTrackpadOrMouseWheel(r);switch(r.deltaMode){case 0:J5&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}J5?i*=.7:wge||bge?i*=.6:_ge&&(i*=1.375);const s=100,n=Math.abs(i);n>s&&(i=i/n*200/(1+Math.exp(-.02*(n-s))));const o=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,deltaY:i});this._callback(e,o)}_handlePointerCaptureLost(e,r){this._activePointerCaptures.delete(r.pointerId),this._handleDefault(e,r)}_handleDefault(e,r){const i={native:r};r.preventDefault(),this._callback(e,i)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}},Xh.test={disableSubpixelCoordinates:!1},Xh);const v$={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let xge=class extends Pr{constructor(){super(!0),this.registerIncoming("context-menu",e=>e.data.native.preventDefault())}};const UG=()=>({maximumClickDelay:300}),$ge=(t={})=>({...UG(),movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,...t}),zk=(t={})=>({...UG(),maximumDoubleClickDistance:10,maximumDoubleTouchDistance:35,maximumDoubleClickDelay:250,maximumDoubleTouchDelay:350,...t});function K1(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function Mge(t,e){const r=e.x-t.x,i=e.y-t.y;return Math.sqrt(r*r+i*i)}function Tge(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Tr()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[$,T]=t,[C,P]=[T.x-$.x,T.y-$.y];return e.radius=Math.sqrt(C*C+P*P)/2,e.center.x=($.x+T.x)/2,e.center.y=($.y+T.y)/2,e}let r=0,i=0;for(let $=0;$<t.length;$++)r+=t[$].x,i+=t[$].y;r/=t.length,i/=t.length;const s=t.map($=>$.x-r),n=t.map($=>$.y-i);let o=0,a=0,l=0,c=0,d=0,p=0,m=0;for(let $=0;$<s.length;$++){const T=s[$],C=n[$],P=T*T,A=C*C;o+=P,a+=A,l+=T*C,c+=P*T,d+=A*C,p+=T*A,m+=C*P}const y=.5*(c+p),g=.5*(d+m),v=o*a-l*l,w=(y*a-g*l)/v,_=(o*g-l*y)/v,x=Tr(w+r,_+i);return{radius:Math.sqrt(w*w+_*_+(o+a)/t.length),center:x}}function Wh(t){const{native:e}=t,{pointerId:r,button:i,pointerType:s}=e;return s==="mouse"?`${r}:${i}`:`${s}`}let Ige=class extends Pr{constructor(e={},r=Nm){super(!1),this._clock=r,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Tr(0,0),this._pointerState=new Map,this._parameters=zk(e),this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new j2({start:(i,s)=>this._dragStart(i,s),update:(i,s)=>this._dragUpdate(s),end:(i,s)=>this._dragEnd(s)}),this.registerIncoming("drag",i=>this._dragEventSeparator.handle(i)),this.registerIncoming("pointer-down",i=>this._handlePointerDown(i)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=yt(e.doubleTapTimeout)})}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(e){const r=this._pointerState.get(e);r&&(r.doubleTapTimeout=yt(r.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,r){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:s}=r,{center:n}=i;this._dragStartCenter=n;const o=w$("begin",Tr(0,0),i);this._doubleTapDrag.emit(o,void 0,s),r.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:r,modifiers:i}=e,{center:s}=r,n=w$("update",Tr(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r);this._doubleTapDrag.emit(n,void 0,i),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:r,modifiers:i}=e,{center:s}=r,n=w$("end",Tr(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r);this._doubleTapDrag.emit(n,void 0,i),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:r}=e,i=Wh(r),s=this._pointerState.get(i),{pointerType:n}=r.native;if(s){const o=n==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;this._clearPointerDown(i),K1(s.event.data,r)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:r}=e,{pointerType:i}=r.native,s=Wh(r),n=i==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(s),n);this._pointerState.set(s,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}};function w$(t,e,r){const{button:i,buttons:s,pointer:n,pointers:o,pointerType:a,timestamp:l}=r;return{action:t,delta:e,button:i,buttons:s,pointer:n,pointers:o,pointerType:a,timestamp:l}}let Ege=class extends Pr{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,r,i,s){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:r.buttons,timestamp:s,pointers:Cge(this._activePointerMap),pointer:r,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(e){const r=e.native.pointerId,i=Dw(this._activePointerMap).angle,s={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(r,s);const n=Mb(s,GG(this._activePointerMap));s.initialAngle=n,s.lastAngle=n,this._updatePointerAngles(i)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const r=e.native.pointerId,i=this._activePointerMap.get(r);i?i.event=e:this._addPointer(e)}_removePointer(e){const r=Dw(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(r)}_updatePointerAngles(e){const r=Dw(this._activePointerMap);this._activePointerMap.forEach(i=>{i.initialAngle=Mb(i,r)-e,i.lastAngle=Mb(i,r)-e})}_emitEvent(e,r,i){const s=Dw(this._activePointerMap);this._drag.emit(this._createPayload(e,r,s,i),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const r=e.data.native.pointerId,i=e.timestamp;this._activePointerMap.get(r)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,i),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(r)):(this._removePointer(r),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const r=e.data,i=r.currentEvent,s=e.timestamp;switch(r.action){case"start":case"update":this._isDragging?this._activePointerMap.has(i.native.pointerId)?(this._updatePointer(i),!this._isCurrentDragSuppressed&&this._emitEvent("update",i,s)):(this._addPointer(i),this._emitEvent("added",i,s),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(i),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",i,s))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function GG(t){const e=[];return t.forEach(r=>{e.push(Tr(r.event.x,r.event.y))}),Tge(e)}function Dw(t){const e=GG(t);let r=0;return t.forEach(i=>{let s=Mb(i,e),n=s-i.lastAngle;for(;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;s=i.lastAngle+n,i.lastAngle=s;const o=s-i.initialAngle;r+=o}),r/=t.size||1,{angle:r,radius:e.radius,center:e.center}}function Cge(t){const e=new Map;return t.forEach((r,i)=>e.set(i,r.event)),e}function Mb(t,e){const r=t.event,i=r.x-e.center.x,s=r.y-e.center.y;return Math.atan2(s,i)}let Pge=class extends Pr{constructor(e={},r=Nm){super(!1),this._clock=r,this._pointerState=new Map,this._parameters=zk(e),this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const r=e.data,i=Wh(r);if(!this._pointerState.has(i)){const s={downButton:r.native.button,x:r.x,y:r.y,immediateDoubleClick:null};this._pointerState.set(i,s),this.startCapturingPointer(r.native)}}_handlePointerUp(e){const r=e.data,i=Wh(r),s=this._pointerState.get(i);if(s&&s.downButton===r.native.button){const n=s.immediateDoubleClick,o=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;n?(n.timeoutHandle.remove(),K1(n,e.data)>o?this._startImmediateDoubleClick(e,s):(this._immediateDoubleClick.emit(e.data,void 0,n.modifiers),this._removeState(r))):K1(s,e.data)>o?this._removeState(r):this._startImmediateDoubleClick(e,s)}}_startImmediateDoubleClick(e,r){const i=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay;r.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),i)}}_removeState(e){const r=Wh(e);this._pointerState.delete(r),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},kge=class extends Pr{constructor(e={},r=Nm){super(!1),this._clock=r,this._pointerState=new Map,this._parameters=$ge(e),this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",i=>this._handlePointerDown(i)),this.registerIncoming("pointer-up",i=>this._handlePointerLoss(i,"pointer-up")),this.registerIncoming("pointer-capture-lost",i=>this._handlePointerLoss(i,"pointer-capture-lost")),this.registerIncoming("pointer-cancel",i=>this._handlePointerLoss(i,"pointer-cancel")),this._moveHandle=this.registerIncoming("pointer-move",i=>this._handlePointerMove(i)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=yt(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const r=e.data,i=r.native.pointerId;let s=null;this._pointerState.size===0&&(s=this._clock.setTimeout(()=>{const o=this._pointerState.get(i);if(o){if(!o.isDragging){const a=o.previousEvent;this._pointerHold.emit(a,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._parameters.holdDelay));const n={startEvent:r,previousEvent:r,startTimestamp:e.timestamp,isDragging:!1,downButton:r.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(i,n),this.startCapturingPointer(r.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const r=e.data,i=r.native.pointerId,s=this._pointerState.get(i);s&&(s.isDragging?this._pointerDrag.emit(zw("update",s,r),void 0,s.modifiers):Mge(r,s.startEvent)>this._getDragThreshold(r.native.pointerType)&&this._startDragging(e),s.previousEvent=r)}_getDragThreshold(e){switch(e){case"touch":return this._parameters.movementUntilTouchDrag;case"pen":return this._parameters.movementUntilPenDrag;default:return this._parameters.movementUntilMouseDrag}}_startDragging(e){const r=e.data,i=r.native.pointerId;this._pointerState.forEach(s=>{s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=e.modifiers,s.isDragging=!0,i===s.startEvent.native.pointerId?this._pointerDrag.emit(zw("start",s,r)):this._pointerDrag.emit(zw("start",s,s.previousEvent),e.timestamp))})}_handlePointerLoss(e,r){const i=e.data,s=i.native.pointerId,n=this._pointerState.get(s);n&&(n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging?this._pointerDrag.emit(zw("end",n,r==="pointer-up"?i:n.previousEvent),void 0,n.modifiers):r==="pointer-up"&&n.downButton===i.native.button&&e.timestamp-n.startTimestamp<=this._parameters.maximumClickDelay&&!n.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(s),this.stopCapturingPointer(i.native),this._pointerState.size===0&&this._moveHandle.pause())}};function zw(t,e,r){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:r}}let Lge=class extends Pr{constructor(e={},r=Nm){super(!1),this._clock=r,this._pointerState=new Map,this._parameters=zk(e),this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",i=>this._handleImmediateClick(i)),this.registerIncoming("pointer-down",i=>this._handlePointerDown(i))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=yt(e.doubleClickTimer))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,r){const i=this._pointerState.get(e);i&&(i.doubleClickTimer=yt(i.doubleClickTimer),r&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const r=this._pointerState.get(e);r.pointerDownCount===1&&this._click.emit(r.event.data,void 0,r.event.modifiers),r.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const r=e.data,{pointerType:i}=r.native,s=Age(r);if(!this._pointerState.has(s))return void this._startClick(e);const n=this._pointerState.get(s),{data:o,modifiers:a}=n.event,l=i==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;K1(o,r)>l?(this._clearDoubleClickTimer(s,!0),this._startClick(e)):(this._clearDoubleClickTimer(s,!1),n.pointerDownCount===2&&this._doubleClick.emit(o,void 0,a))}_handlePointerDown(e){const r=Wh(e.data),i=this._pointerState.get(r);i&&(i.pointerDownCount+=1)}_startClick(e){const{data:r}=e,{native:{pointerType:i}}=r,s=Wh(r),n=i==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(s),n);this._pointerState.set(s,{event:e,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};function Age(t){const{pointerId:e,pointerType:r,button:i}=t.native;return r==="mouse"?`${e}:${i}`:`${r}`}const jw={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},X5=Symbol("handles");let Sp=class extends le{initialize(){const e=()=>this.view?.ready;this.addHandles([Ti(()=>!e(),()=>this._disconnect()),Ti(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerInfo(){return this._inputManager?.latestPointerInfo}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(X5),this._inputManager=xt(this._inputManager)}_connect(){const e=this.view.surface,r=new Sge(e,this.view.input),i=[new Pge,new kge,new Lge,new Ege(this.view.navigation),new Ige],s=new Pn({eventSource:r,recognizers:i}),n=new mye(this.view,["primary"]),o=new yye(this.view,["secondary"]);s.installHandlers("prevent-context-menu",[new xge],xl.INTERNAL),s.installHandlers("navigation",[new pge(this.view),new sge(this.view),new dge(this.view),new q5(this.view),new q5(this.view,[jw.counter]),n,new lge(this.view,jw.pan),new cge(this.view,jw.zoom),new uge(this.view,jw.rotate),o,new fye(this.view,"touch")],xl.INTERNAL),this.view.viewEvents.connect(s),this._source=r,this._inputManager=s,this.addHandles([ie(()=>this.view?.navigation?.browserTouchPanEnabled,a=>{this._source&&(this._source.browserTouchPanningEnabled=!a)},ft),ie(()=>{const{actionMap:a}=this.view.navigation;return{panActions:G5("pan",a),rotateActions:G5("rotate",a)}},({panActions:a,rotateActions:l})=>{n.pointerActions=a,o.pointerActions=l},pi)],X5)}get test(){}};u([h()],Sp.prototype,"view",void 0),u([h()],Sp.prototype,"latestPointerInfo",null),u([h()],Sp.prototype,"multiTouchActive",null),Sp=u([E("esri.views.2d.input.MapViewInputManager")],Sp);const Rge=Sp,Oge=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.goToManager=new $b({view:this}),this.animationsEnabled=!0,this.inputManager=new Rge({view:this}),this.addHandles([this.on("resize",s=>this.stateManager.resize(s.width,s.height))])}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}on(i,s,n,o){return this.viewEvents.on(i,s,n,o)||super.on(i,s)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}goTo(i,s){return this.goToManager.goTo(i,s)}toMap(i){if(!this.ready)return null;const s=H7(i)?B7(this,i):i;return this.stateManager.toMap(s)}};return u([h()],r.prototype,"goToManager",void 0),u([h({readOnly:!0})],r.prototype,"interacting",null),u([h()],r.prototype,"stationary",null),u([h()],r.prototype,"animationsEnabled",void 0),u([h({readOnly:!0})],r.prototype,"inputManager",void 0),r=u([E("esri.views.Viewport2DMixin")],r),r};let K5=class{constructor(e){this._view=e,this.viewpoint=new fn({targetGeometry:new de,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,r]=this._view.size;return Math.sqrt(e*e+r*r)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return mG(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,r){r.pan=yj(this.center,e.center);let i=Math.abs(e.rotation-this.rotation);i=i>=180?360-i:i,r.rotate=Ym(i),r.sourceZoom=this.scale,r.targetZoom=e.scale}interpolate(e,r,i){const{pan:s,rotate:n,zoom:o,zoomOffset:a}=i,{center:l}=this;l.spatialReference=e.center.spatialReference,l.x=ig(e.center.x,r.center.x,s),l.y=ig(e.center.y,r.center.y,s),this.viewpoint.scale=ig(e.scale,r.scale+a,o);let c=e.rotation;const d=r.rotation;Math.abs(d-c)>=180&&(c+=360*(c<d?1:-1)),this.viewpoint.rotation=ig(c,d,n)}copyFrom(e){Si(this.viewpoint,e.viewpoint),this._view=e.view}};function ky(t,e,r,i){const s=3*t,n=3*(r-t)-s,o=1-s-n,a=3*e,l=3*(i-e)-a,c=1-a-l;function d(g){return((o*g+n)*g+s)*g}function p(g){return((c*g+l)*g+a)*g}function m(g){return(3*o*g+2*n)*g+s}function y(g,v){let w,_,x,$,T,C;for(x=g,C=0;C<8;C++){if($=d(x)-g,Math.abs($)<v)return x;if(T=m(x),Math.abs(T)<1e-6)break;x-=$/T}if(w=0,_=1,x=g,x<w)return w;if(x>_)return _;for(;w<_;){if($=d(x),Math.abs($-g)<v)return x;g>$?w=x:_=x,x=.5*(_-w)+w}return x}return function(g,v=1e-6){return p(y(g,v))}}const tn={};tn.ease=ky(.25,.1,.25,1),tn.linear=ky(0,0,1,1),tn.easeIn=tn["ease-in"]=ky(.42,0,1,1),tn.easeOut=tn["ease-out"]=ky(0,0,.58,1),tn.easeInOut=tn["ease-in-out"]=ky(.42,0,.58,1);const Fge=t=>t,tv=t=>t*t,Q1=t=>1-tv(1-t),Q5=t=>t<.5?tv(2*t)/2:(Q1(2*(t-.5))+1)/2,eS=t=>t*t*t,L3=t=>1-eS(1-t),eF=t=>t<.5?eS(2*t)/2:(L3(2*(t-.5))+1)/2,tS=t=>t*t*t*t,A3=t=>1-tS(1-t),tF=t=>t<.5?tS(2*t)/2:(A3(2*(t-.5))+1)/2,rS=t=>t*t*t*t*t,R3=t=>1-rS(1-t),rF=t=>t<.5?rS(2*t)/2:(R3(2*(t-.5))+1)/2,iS=t=>1-Math.cos(t*Math.PI/2),O3=t=>1-iS(1-t),iF=t=>t<.5?iS(2*t)/2:(O3(2*(t-.5))+1)/2,sS=t=>2**(10*(t-1)),nS=t=>1-sS(1-t),sF=t=>t<.5?sS(2*t)/2:(nS(2*(t-.5))+1)/2,oS=t=>-(Math.sqrt(1-t*t)-1),F3=t=>1-oS(1-t),nF=t=>t<.5?oS(2*t)/2:(F3(2*(t-.5))+1)/2;function yn(t){const e=2*(t-Math.sqrt((t-1)*t)),r=e/2/t;return i=>i<r?t*i*i:e*i-e+1}function gn(t,e){return(r,i)=>r<e?e*t(r/e,i):1-t((1-r)/(1-e),i)*(1-e)}const oF=gn(yn(1),1),aF=gn(yn(1),0),aS=gn(yn(1),.5),lF=gn(yn(2),1),uF=gn(yn(2),0),cF=gn(yn(2),.5),hF=gn(yn(3),1),dF=gn(yn(3),0),pF=gn(yn(3),.5),fF=gn(yn(4),1),mF=gn(yn(4),0),yF=gn(yn(4),.5),gF={linear:Fge,"in-quad":tv,"out-quad":Q1,"in-out-quad":Q5,"in-coast-quad":oF,"out-coast-quad":aF,"in-out-coast-quad":aS,"in-cubic":eS,"out-cubic":L3,"in-out-cubic":eF,"in-coast-cubic":lF,"out-coast-cubic":uF,"in-out-coast-cubic":cF,"in-quart":tS,"out-quart":A3,"in-out-quart":tF,"in-coast-quart":hF,"out-coast-quart":dF,"in-out-coast-quart":pF,"in-quint":rS,"out-quint":R3,"in-out-quint":rF,"in-coast-quint":fF,"out-coast-quint":mF,"in-out-coast-quint":yF,"in-sine":iS,"out-sine":O3,"in-out-sine":iF,"in-expo":sS,"out-expo":nS,"in-out-expo":sF,"in-circ":oS,"out-circ":F3,"in-out-circ":nF,"quad-in":tv,"quad-out":Q1,"quad-in-out":Q5,"quad-in-coast":oF,"quad-out-coast":aF,"quad-in-out-coast":aS,"cubic-in":eS,"cubic-out":L3,"cubic-in-out":eF,"cubic-in-coast":lF,"cubic-out-coast":uF,"cubic-in-out-coast":cF,"quart-in":tS,"quart-out":A3,"quart-in-out":tF,"quart-in-coast":hF,"quart-out-coast":dF,"quart-in-out-coast":pF,"quint-in":rS,"quint-out":R3,"quint-in-out":rF,"quint-in-coast":fF,"quint-out-coast":mF,"quint-in-out-coast":yF,"sine-in":iS,"sine-out":O3,"sine-in-out":iF,"expo-in":sS,"expo-out":nS,"expo-in-out":sF,"circ-in":oS,"circ-out":F3,"circ-in-out":nF,ease:t=>tn.ease(t),"ease-in":t=>tn.easeIn(t),"ease-out":t=>tn.easeOut(t),"ease-in-out":t=>tn.easeInOut(t)};let Nge=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const lS={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},qG={maxDuration:4e3};let Dge=class BG{constructor(e){this._createCamera=e,this.compared=new Nge,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:lS.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new BG(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,r,i){this.source!==e&&this.source.copyFrom(e),this.target!==r&&this.target.copyFrom(r),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=i.desiredScreenFlow??lS.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const r=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/r}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>Bi()}get hasFov(){return Math.abs(this.compared.fov)>Bi()}get hasRotate(){return this.compared.rotate>Bi()}},zge=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},jge=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,r)=>e+r.time,0)}interpolateComponentsAt(e,r){e=Math.min(Math.max(e,0),1),e*=this.time;let i=0,s=0;const n=this.definition,o=this.segments.reduce((a,l)=>a||l.definition.hasZoom,!1);for(let a=0;a<this.segments.length;a++){const l=this.segments[a],c=l.definition;if(e<=l.time||a===this.segments.length-1){if(this.segmentInterpolateComponentsAt(l,l.time===0?0:e/l.time,r),n.hasPan&&!isNaN(r.pan)&&isFinite(n.compared.pan)?r.pan=(i+c.compared.pan*r.pan)/n.compared.pan:r.pan=1,n.hasRotate&&!isNaN(r.rotate)&&isFinite(n.compared.rotate)?r.rotate=(s+c.compared.rotate*r.rotate)/n.compared.rotate:r.rotate=1,o&&!isNaN(r.zoom)&&isFinite(c.compared.targetZoom)){const{sourceZoom:d,targetZoom:p}=c.compared,m=r.zoom*(p-d)+d,y=this.segments[0].definition.compared.sourceZoom,g=this.segments[this.segments.length-1].definition.compared.targetZoom,v=Math.abs(p-y)>Math.abs(d-y)?p:d;r.zoomOffset=v-g,r.zoom=(m-y)/(v-y)}else r.zoom=1;return r}e-=l.time,i+=c.compared.pan,s+=c.compared.rotate}}segmentInterpolateComponentsAt(e,r,i){e.interpolateComponentsAt(r,i)}},_$=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,r=e.compared,i=r.sourceZoom,s=r.targetZoom;this._zoomSign=i>s?1:-1,this._panPixelsAtSource=r.pan*e.source.pixelsPerPanAtZoom(i);const n=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=r.rotate*n}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom,{hasZoom:i,hasPan:s,hasRotate:n}=this.definition;let o=0,a=0;i&&(s&&(o=(r/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),n&&(a=this._zoomSign*(Math.log(e/r)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(i&&s&&n){const c=o+a+o*a;this._zoomPixelFlow=o*a/c*l,this._panPixelFlow=a/c*l,this._rotatePixelFlow=o/c*l}else if(i&&s){const c=1+o;this._zoomPixelFlow=o/c*l,this._panPixelFlow=1/c*l}else if(i&&n){const c=1+a;this._zoomPixelFlow=a/c*l,this._rotatePixelFlow=1/c*l}else if(s&&n){const c=this._panPixelsAtSource/this._rotatePixels,d=1+c;this._panPixelFlow=c/d*l,this._rotatePixelFlow=1/d*l}else s?this._panPixelFlow=l:i?this._zoomPixelFlow=l:n&&(this._rotatePixelFlow=l);if(this._time=Math.max(this.rotateTime,this.zoomTime,this.panTime),this.fovTime>this._time){const c=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=c,this._panPixelFlow/=c,this._rotatePixelFlow/=c}}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:0}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/Vge:0}get panTime(){if(!this.definition.hasPan)return 0;if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,r=e*this._panPixelsAtSource;return Math.log(r*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const r=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom;return(r*(r/i)**-e-r)/(i-r)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:r,segmentEnd:i}=this.definition;return r+e*(i-r)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const r=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(r*e*this._time)-1))/(r*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,r){e=Math.min(Math.max(e,0),1),r.zoom=this._interpolateComponentsZoom(e),r.pan=this._interpolateComponentsPan(e),r.rotate=this._interpolateComponentsRotate(e),r.zoomOffset=0,r.fov=this._interpolateComponentsFov(e)}};const Vge=Ym(45);function Uge(t,e,r){const i=e-t.compared.sourceZoom,s=t.halfWindowPanAtZoom(i);return-t.halfWindowSize*(r.ascensionFactor*Math.LN2*t.compared.pan+s)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*s)}function Gge(t,e,r){const i=1/e,s=Math.log(t.compared.sourceZoom*i),n=1/t.desiredPixelFlow,o=1/Math.LN2,a=e-t.compared.sourceZoom,l=1/a,c=(r.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(a))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*i*n*o*l*c-t.halfWindowSize*s*n*o*l+t.halfWindowSize*s*n*o*c/(a*a)}function qge(t,e,r){const i=e-t.compared.sourceZoom,s=1/i,n=1/e,o=Math.log(t.compared.sourceZoom*n),a=(r.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(i))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*(-2*s*n*a+2*s*o+2*n-2*o*a/(i*i)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function Bge(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function Hge(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function Wge(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function Zge(t,e,r){return-t.compared.pan*t.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function Jge(t,e,r){return t.compared.pan*t.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function Yge(t,e,r){return-2*t.compared.pan*t.halfWindowSize*(r.ascensionFactor+r.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function Xge(t,e,r){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-r.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function Kge(t,e,r){const i=Math.log(e/t.compared.targetZoom),s=1/t.desiredPixelFlow,n=1/Math.LN2,o=-e+t.compared.targetZoom,a=1/o,l=(-t.halfWindowPanAtZoom(e)-r.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*i*s*n*a+t.halfWindowSize*i*s*n*l/(o*o)+t.halfWindowSize*s*n*a*l/e}function Qge(t,e,r){const i=e-t.compared.targetZoom,s=1/i,n=1/e,o=Math.log(e/t.compared.targetZoom),a=(t.halfWindowPanAtZoom(e)+r.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*(-2*s*n*a-2*s*o+2*n+2*o*a/(i*i)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function e0e(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function t0e(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function r0e(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function i0e(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const r=Math.LN2*t.compared.pan,i=e,s=t.halfWindowPanAtZoom(i),n=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*s);return t.compared.sourceZoom<=t.compared.targetZoom?n*(r-s):n*(r+s)}function s0e(t,e){let r=n0e(t,e);const i={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},s=i.ascensionFactor===0,n=i.descensionFactor===0,o=s?Bge:Uge,a=s?Hge:Gge,l=s?Wge:qge,c=n?e0e:Xge,d=n?t0e:Kge,p=n?r0e:Qge,m=C=>o(t,C,i)+Zge(t,C,i)+c(t,C,i),y=C=>a(t,C,i)+Jge(t,C,i)+d(t,C,i),g=C=>l(t,C,i)+Yge(t,C,i)+p(t,C,i);let v=m(r);const w=i0e(t);let _;const x=e.maximumIterations||20,$=e.maximumDistance!=null?e.maximumDistance:1/0;for(_=0;_<x;_++){const C=e.desiredSlope??1e-6;let P=y(r);Math.abs(P)>C&&(P+=C);const A=P/g(r);if(isNaN(A)||r>=$&&A<0){if(!isFinite($))return null;r=$,v=m(r);break}if(r-=A,r<=t.compared.sourceZoom||r<=t.compared.targetZoom)return null;const F=m(r);if(Math.abs(F-v)/v<=.005)break;v=F}return isNaN(v)||v>w*(1-.3)||r<=t.compared.sourceZoom||r<=t.compared.targetZoom?null:r}function n0e(t,e){const r=Math.max(t.compared.sourceZoom,t.compared.targetZoom),i=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return i<r?e.maximumDistance!=null?r+(e.maximumDistance-r)/2:1.5*r:e.maximumDistance?Math.min(e.maximumDistance,i):i}let o0e=class extends jge{constructor(e,r){super(),this._preallocSegments=[new _$,new _$,new _$],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,r)}update(e,r){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const i=r?.apex?s0e(e,r.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,i?this._updateWithApex(i,r?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,r,i){e.interpolateComponentsAt(r,i),e===this._ascensionSegment?i.zoom=Q1(i.zoom):e===this._descensionSegment&&(i.zoom=tv(i.zoom))}_updateWithApex(e,r){const[i,s,n]=this._preallocSegments,o=r?.ascensionFactor??.5,a=Math.min(1-o,r?.ascensionFactor!=null&&r.descensionFactor!=null?r.descensionFactor:.5),l=1-o-a;i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.compared.targetZoom=e,i.definition.compared.pan=this.definition.compared.pan*o,i.definition.compared.rotate=this.definition.compared.rotate*o,i.definition.segmentEnd=o,i.update(),this._ascensionSegment=i,this.segments.push(i),l>0&&(s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.copyFrom(this.definition),s.definition.compared.sourceZoom=e,s.definition.compared.targetZoom=e,s.definition.compared.pan=this.definition.compared.pan*l,s.definition.compared.rotate=this.definition.compared.rotate*l,s.definition.segmentStart=i.definition.segmentEnd,s.definition.segmentEnd=i.definition.segmentEnd+l,s.update(),this.segments.push(s)),n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.compared.sourceZoom=e,n.definition.compared.pan=this.definition.compared.pan*a,n.definition.compared.rotate=this.definition.compared.rotate*a,n.definition.segmentStart=o+l,n.update(),this._descensionSegment=n,this.segments.push(n)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const a0e=new zge;let l0e=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=0,this._easing=aS,this.definition=new Dge(e),this.path=new o0e}update(e,r,i){this.definition.update(e,r,i),this.path.update(this.definition,i),this._time=this._applyTimeSettings(BK(isFinite(this.path.time)?this.path.time:0),i),this._easing=i.easing??(this._time>=1e3?aS:nS)}cameraAt(e,r){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const i=this.path.interpolateComponentsAt(e,a0e);r.interpolate(this.definition.source,this.definition.target,i)}_normalizedEasing(e){const r=this._easing(0,this._time),i=this._easing(1,this._time);return(this._easing(e,this._time)-r)/(i-r)}_applyTimeSettings(e,r){const i=r.speedFactor!=null?r.speedFactor:1,s=r.minDuration??lS.minDuration/i,n=r.maxDuration??lS.maxDuration/i;return e=r.duration!=null?r.duration:Math.min(Math.max(e/i,s),n)}};const u0e=2e3,c0e=64;let h0e=class{constructor(e){this._view=e,this._animation=new l0e(()=>new K5(this._view)),this._current=new K5(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,r,i={}){Si(this._current.viewpoint,e),Si(this._source.viewpoint,e),Si(this._target.viewpoint,r),this._animation.update(this._source,this._target,i)}applyRatio(e,r){this._animation.cameraAt(r,this._current),Si(e,this._current.viewpoint)}},xp=class extends le{constructor(e){super(e),this._animation=null,this._destinationViewState=new Nk,this.updateFunction=null,this.easing=gF.ease,this.viewpoint=new fn({targetGeometry:new de,scale:0,rotation:0}),this._updateTask=pm({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new h0e(e.view)}destroy(){this._updateTask=yt(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,r,i){this.stop();const s=this.viewpoint;Si(s,r);const n=e.target;this._transition.update(this.viewpoint,n,{apex:{maximumDistance:Math.min(Math.min(r.scale,n.scale)*c0e,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:i?.duration,maxDuration:i?.animationMode==="auto"?1/0:i?.maxDuration??qG.maxDuration,speedFactor:i?.speedFactor,easing:(typeof i?.easing=="string"?gF[i.easing]:i?.easing)||this.easing}),i?.animationMode==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=n,d0e(this._transition.animation,i,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,n,{duration:0}));const o=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,r){this.stop(),this.updateFunction=r,this.viewpoint=e;const i=new P3({target:e.clone()}),s=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const r=this.animation;if(r&&r.state!==P3.state.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),this.animation?.update(this.viewpoint);else{const i=performance.now()-this._startTime,s=this._transition.duration,n=s>0?i/s:1,o=n>=1;this._transition.applyRatio(this.viewpoint,n),o&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function d0e(t,e,r,i){if(e?.duration!=null)return!0;const{time:s,isLinear:n}=t,o=e?.speedFactor||1;if(s>(e?.maxDuration??qG.maxDuration/o))return!1;if(n){const l=zt(),c=Tr(...i.toScreen(l,...r.center)),d=Tr(...r.toScreen(l,...i.center)),p=d!=null&&d.x>-1*r.size[0]&&d.x<(1.5+.5)*r.size[0]&&d.y>-1*r.size[1]&&d.y<(1.5+.5)*r.size[1],m=c!=null&&c.x>-1*i.size[0]&&c.x<(1.5+.5)*i.size[0]&&c.y>-1*i.size[1]&&c.y<(1.5+.5)*i.size[1];if(s>u0e/o&&!p&&!m)return!1}return!0}u([h()],xp.prototype,"easing",void 0),u([h()],xp.prototype,"view",void 0),u([h()],xp.prototype,"viewpoint",void 0),xp=u([E("esri.views.2d.AnimationManager")],xp);const p0e=xp;function wt(){return Promise.all([q(()=>import("./webglDeps-BP9SI3Fi.js"),__vite__mapDeps([178,150,179,180,181,52])),q(()=>import("./mapViewDeps-ouTdldM0.js"),__vite__mapDeps([182,183,184,150,179,180,141,81,185,83,181,52,149,51,186,80,103,187,130,133,30,28,31,84,89,188,86,87,178,189,98,190,191,129,192,139,140,69,79,82,35,34,193,88,194,85,14,15,16,195,90,95,196,77,197,198,199,200,146,201,202]))])}const Ly=()=>wt().then(()=>q(()=>import("./TileLayerView2D-Cv8iARrd.js"),__vite__mapDeps([203,187,186,80,51,180,181,52,149,150,103,130,133,30,28,31,189,184,179,141,185,83,98,190,191,129,69,183,81,84,89,86,87,139,140,195,79,82,35,34,90,95,196,77,204,205,206,200,207,208,198,199,209,210,211,212,213,214]))),Tc=()=>wt().then(()=>q(()=>import("./FeatureLayerView2D-3pACPP-4.js").then(t=>t.F),__vite__mapDeps([215,196,30,28,31,216,217,218,35,42,207,187,199,81,80,51,179,150,200,186,180,181,52,149,103,130,133,183,184,141,185,83,84,89,98,70,68,69,96,90,188,219,154,44,92,213,209,210,214]))),vF={"base-dynamic":()=>wt().then(()=>q(()=>import("./BaseDynamicLayerView2D-B-95tiVD.js"),__vite__mapDeps([220,221,186,80,51,180,181,52,149,150,103,187,130,133,30,28,31,205,184,179,141,206,207,222,209,210]))),"base-tile":Ly,"bing-maps":Ly,catalog:()=>wt().then(()=>q(()=>import("./CatalogLayerView2D-DGu17JIV.js"),__vite__mapDeps([223,207,187,209]))),"catalog-dynamic-group":()=>wt().then(()=>q(()=>import("./CatalogDynamicGroupLayerView2D-DCBJRR7w.js"),__vite__mapDeps([224,207,187,209]))),"catalog-footprint":()=>wt().then(()=>q(()=>import("./CatalogFootprintLayerView2D-CgQga-e1.js"),__vite__mapDeps([225,215,196,30,28,31,216,217,218,35,42,207,187,199,81,80,51,179,150,200,186,180,181,52,149,103,130,133,183,184,141,185,83,84,89,98,70,68,69,96,90,188,219,154,44,92,213,209,210,214]))),csv:Tc,"geo-rss":()=>wt().then(()=>q(()=>import("./GeoRSSLayerView2D-C84MJVX1.js"),__vite__mapDeps([226,207,187,197,198,199,81,80,51,179,150,200,186,180,181,52,149,103,130,133,30,28,31,183,184,141,185,83,84,89,195,79,82,35,34,90,95,196,77,209]))),feature:Tc,geojson:Tc,parquet:Tc,graphics:()=>wt().then(()=>q(()=>import("./GraphicsLayerView2D-DQGUMMwg.js"),__vite__mapDeps([227,207,187,197,198,199,81,80,51,179,150,200,186,180,181,52,149,103,130,133,30,28,31,183,184,141,185,83,84,89,195,79,82,35,34,90,95,196,77,209,214]))),group:()=>wt().then(()=>q(()=>import("./GroupLayerView2D-BFHJD3om.js"),__vite__mapDeps([228,207,187,209]))),imagery:()=>wt().then(()=>q(()=>import("./ImageryLayerView2D-CT6ryj12.js"),__vite__mapDeps([229,230,181,52,149,150,51,117,186,80,180,103,187,130,133,30,28,31,112,110,207,195,79,81,82,83,35,34,183,184,179,141,185,84,89,90,95,196,77,208,198,199,200,221,205,206,222,115,176,216,213,209,210,214]))),"imagery-tile":()=>wt().then(()=>q(()=>import("./ImageryTileLayerView2D-BjiCjcHQ.js"),__vite__mapDeps([231,232,230,181,52,149,150,51,117,186,80,180,103,187,130,133,30,28,31,112,110,207,114,233,200,184,179,141,194,185,83,206,234,115,214,176,216,213,209,210]))),kml:()=>wt().then(()=>q(()=>import("./KMLLayerView2D-Do7tqv6D.js"),__vite__mapDeps([235,236,205,187,184,150,179,180,141,206,221,186,80,51,181,52,149,103,130,133,30,28,31,207,197,198,199,81,200,183,185,83,84,89,195,79,82,35,34,90,95,196,77,209,14,15,16,115,192,178,139,140,190,233]))),"knowledge-graph":()=>wt().then(()=>q(()=>import("./KnowledgeGraphLayerView2D-21wdpQKB.js"),__vite__mapDeps([237,207,187,209]))),"link-chart":()=>wt().then(()=>q(()=>import("./KnowledgeGraphLayerView2D-21wdpQKB.js"),__vite__mapDeps([237,207,187,209]))),"knowledge-graph-sublayer":Tc,"map-image":()=>wt().then(()=>q(()=>import("./MapImageLayerView2D-tuTj_5mm.js"),__vite__mapDeps([238,221,186,80,51,180,181,52,149,150,103,187,130,133,30,28,31,205,184,179,141,206,207,195,79,81,82,83,35,34,183,185,84,89,90,95,196,77,208,198,199,200,222,209,216,210,211,212,213,214]))),"map-notes":()=>wt().then(()=>q(()=>import("./MapNotesLayerView2D-Ch51MwoO.js"),__vite__mapDeps([239,207,187,197,198,199,81,80,51,179,150,200,186,180,181,52,149,103,130,133,30,28,31,183,184,141,185,83,84,89,195,79,82,35,34,90,95,196,77,209,214]))),media:()=>wt().then(()=>q(()=>import("./MediaLayerView2D-BiWcTZOG.js"),__vite__mapDeps([240,241,95,187,186,80,51,180,181,52,149,150,103,130,133,30,28,31,189,184,179,141,185,83,98,190,191,129,69,183,81,84,89,86,87,139,140,195,79,82,35,34,90,196,77,193,88,242,194,207,209]))),"ogc-feature":()=>wt().then(()=>q(()=>import("./OGCFeatureLayerView2D-O86hKs-6.js"),__vite__mapDeps([243,215,196,30,28,31,216,217,218,35,42,207,187,199,81,80,51,179,150,200,186,180,181,52,149,103,130,133,183,184,141,185,83,84,89,98,70,68,69,96,90,188,219,154,44,92,213,209,210,214]))),"open-street-map":Ly,"oriented-imagery":Tc,route:()=>wt().then(()=>q(()=>import("./RouteLayerView2D-CgV-i12m.js"),__vite__mapDeps([244,245,246,207,187,197,198,199,81,80,51,179,150,200,186,180,181,52,149,103,130,133,30,28,31,183,184,141,185,83,84,89,195,79,82,35,34,90,95,196,77,209,214]))),stream:()=>wt().then(()=>q(()=>import("./StreamLayerView2D-DcK9bPHY.js"),__vite__mapDeps([247,215,196,30,28,31,216,217,218,35,42,207,187,199,81,80,51,179,150,200,186,180,181,52,149,103,130,133,183,184,141,185,83,84,89,98,70,68,69,96,90,188,219,154,44,92,213,209,210,214]))),"subtype-group":()=>wt().then(()=>q(()=>import("./SubtypeGroupLayerView2D-D7AaXhvK.js"),__vite__mapDeps([248,215,196,30,28,31,216,217,218,35,42,207,187,199,81,80,51,179,150,200,186,180,181,52,149,103,130,133,183,184,141,185,83,84,89,98,70,68,69,96,90,188,219,154,44,92,213,209,210,214]))),tile:Ly,"vector-tile":()=>wt().then(()=>q(()=>import("./VectorTileLayerView2D-Ch1i0Zg1.js"),__vite__mapDeps([249,69,129,191,130,150,181,52,149,186,80,51,180,103,187,133,30,28,31,200,33,131,132,207,209,210]))),video:()=>wt().then(()=>q(()=>import("./VideoLayerView2D-D0iEnDmt.js"),__vite__mapDeps([250,251,252,242,103,186,80,51,180,181,52,149,150,187,130,133,30,28,31,183,184,179,141,81,185,83,84,89,194,253,207,197,198,199,200,195,79,82,35,34,90,95,196,77,209]))),wcs:()=>wt().then(()=>q(()=>import("./ImageryTileLayerView2D-BjiCjcHQ.js"),__vite__mapDeps([231,232,230,181,52,149,150,51,117,186,80,180,103,187,130,133,30,28,31,112,110,207,114,233,200,184,179,141,194,185,83,206,234,115,214,176,216,213,209,210]))),"web-tile":Ly,wfs:Tc,wms:()=>wt().then(()=>q(()=>import("./WMSLayerView2D-DhZ4o2ED.js"),__vite__mapDeps([254,221,186,80,51,180,181,52,149,150,103,187,130,133,30,28,31,205,184,179,141,206,207,222,209,210,255,216]))),wmts:()=>wt().then(()=>q(()=>import("./WMTSLayerView2D-Dd1v2KLg.js"),__vite__mapDeps([256,204,205,187,184,150,179,180,141,206,186,80,51,181,52,149,103,130,133,30,28,31,200,207,209,210]))),"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"gaussian-splat":null,"integrated-mesh-3dtiles":null,"integrated-mesh":null,"line-of-sight":null,"point-cloud":null,scene:null,unknown:null,unsupported:null,viewshed:null,voxel:null};function f0e(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",r=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new R(`${r}:view-not-supported`,`${e} is not supported in 2D`)}const wF={hasLayerViewModule:t=>vF[t.type]!=null,importLayerView:t=>{const e=vF[t.type];if(e==null)throw f0e(t);return e(t)}};var Ps;let ty=(Ps=class{static getId(e,r,i,s){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${r}/${i}/${s}`}constructor(e,r,i,s){this.set(e,r,i,s)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,r=4095&this.col,i=63&this.level;return(3&this.world)<<30|r<<22|e<<8|i}acquire(e,r,i,s){this.set(e,r,i,s)}contains(e){const r=e.level-this.level;return r>=0&&this.row===e.row>>r&&this.col===e.col>>r&&this.world===e.world}containsChild(e){const r=e.level-this.level;return r>0&&this.row===e.row>>r&&this.col===e.col>>r&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new Ps(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,r,i,s){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[n,o,a,l]=e.split("/");this.level=parseFloat(n),this.row=parseFloat(o),this.col=parseFloat(a),this.world=parseFloat(l)}else this.level=+e,this.row=+r,this.col=+i,this.world=+s||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new Ps(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(e,r,i){const s=this.clone();return s.col+=e,s.row+=r,i.normalizeKey(s),s}getChildKeys(){const e=this.level+1,r=this.row<<1,i=this.col<<1,s=this.world;return[new Ps(e,r,i,s),new Ps(e,r,i+1,s),new Ps(e,r+1,i,s),new Ps(e,r+1,i+1,s)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}},Ps.pool=new yd(()=>new Ps(""),null,null,25,50),Ps);function Vd(t,e){return[t,e]}function Ic(t,e,r){return t[0]=e,t[1]=r,t}function m0e(t,e,r,i,s){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t}const In=new ty("0/0/0/0");let y0e=class HG{static create(e,r,i=null){const s=qi(e.spatialReference),n=r.origin||Vd(e.origin.x,e.origin.y),o=Vd(e.size[0]*r.resolution,e.size[1]*r.resolution),a=Vd(-1/0,-1/0),l=Vd(1/0,1/0),c=Vd(1/0,1/0);i!=null&&(Ic(a,Math.max(0,Math.floor((i.xmin-n[0])/o[0])),Math.max(0,Math.floor((n[1]-i.ymax)/o[1]))),Ic(l,Math.max(0,Math.floor((i.xmax-n[0])/o[0])),Math.max(0,Math.floor((n[1]-i.ymin)/o[1]))),Ic(c,l[0]-a[0]+1,l[1]-a[1]+1));const{cols:d,rows:p}=r;let m,y,g,v;return!i&&d&&p&&(Ic(a,d[0],p[0]),Ic(l,d[1],p[1]),Ic(c,d[1]-d[0]+1,p[1]-p[0]+1)),e.isWrappable?(m=Vd(Math.ceil(Math.round((s.valid[1]-s.valid[0])/r.resolution)/e.size[0]),c[1]),y=!0,g=s.origin,v=s.valid):(m=c,y=!1),new HG(r.level,r.resolution,r.scale,n,a,l,c,o,m,y,g,v)}constructor(e,r,i,s,n,o,a,l,c,d,p,m){this.level=e,this.resolution=r,this.scale=i,this.origin=s,this.first=n,this.last=o,this.size=a,this.norm=l,this.worldSize=c,this.wrap=d,this._spatialReferenceOrigin=p,this._spatialReferenceValid=m}normalizeCol(e){if(!this.wrap)return e;const r=this.worldSize[0];return e<0?r-1-Math.abs((e+1)%r):e%r}normalizeKey(e){if(!this.wrap)return;const r=this.worldSize[0],i=e.col;i<0?(e.col=i+r,e.world-=1):i>=r&&(e.col=i-r,e.world+=1)}denormalizeCol(e,r){return this.wrap?this.worldSize[0]*r+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){const r=this.origin[0]+e*this.norm[0],i=this._spatialReferenceOrigin,s=this._spatialReferenceValid;return this.wrap&&i&&s?r===i[0]?s[0]:this.origin[0]===i[0]&&e===this.worldSize[0]?s[1]:r:r}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,r,i=!1){In.set(r);const s=i?In.col:this.denormalizeCol(In.col,In.world),n=In.row;return m0e(e,this.getXForColumn(s),this.getYForRow(n+1),this.getXForColumn(s+1),this.getYForRow(n)),e}getTileCoords(e,r,i=!1){In.set(r);const s=i?In.col:this.denormalizeCol(In.col,In.world);return Array.isArray(e)?Ic(e,this.getXForColumn(s),this.getYForRow(In.row)):(e.x=this.getXForColumn(s),e.y=this.getYForRow(In.row)),e}};var Kh;let jk=(Kh=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}*keys(){const e=this.lodInfo;for(const{row:r,colFrom:i,colTo:s}of this.spans)for(let n=i;n<=s;n++){const o=e.getWorldForColumn(n);yield new ty(e.level,r,e.normalizeCol(n),o)}}forEach(e,r){const{spans:i,lodInfo:s}=this,{level:n}=s;if(i.length!==0)for(const{row:o,colFrom:a,colTo:l}of i)for(let c=a;c<=l;c++)e.call(r,n,o,s.normalizeCol(c),s.getWorldForColumn(c))}},Kh.pool=new yd(()=>new Kh),Kh),b$=class{constructor(e,r,i){this.row=e,this.colFrom=r,this.colTo=i}};const $t=new ty("0/0/0/0");let g0e=class WG{static create(e,r){e[1]>r[1]&&([e,r]=[r,e]);const[i,s]=e,[n,o]=r,a=n-i,l=o-s,c=l!==0?a/l:0,d=(Math.ceil(s)-s)*c,p=(Math.floor(s)-s)*c;return new WG(i,Math.floor(s),Math.ceil(o),c,a<0?d:p,a<0?p:d,a<0?n:i,a<0?i:n)}constructor(e,r,i,s,n,o,a,l){this.x=e,this.ymin=r,this.ymax=i,this.invM=s,this.leftAdjust=n,this.rightAdjust=o,this.leftBound=a,this.rightBound=l}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const ms=[[0,0],[0,0],[0,0],[0,0]],v0e=1e-6;let w0e=class{constructor(e,r=null,i=e.lods[0].level,s=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=r,this.scales=[],this._infoByScale={},this._infoByLevel={};const n=e.lods.filter(a=>a.level>=i&&a.level<=s);this.minScale=n[0].scale,this.maxScale=n[n.length-1].scale;const o=this._lodInfos=n.map(a=>y0e.create(e,a,r));n.forEach((a,l)=>{this._infoByLevel[a.level]=o[l],this._infoByScale[a.scale]=o[l],this.scales[l]=a.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,r,i=!1){$t.set(r);const s=this._infoByLevel[$t.level];return s?s.getTileBounds(e,$t,i):e}getTileCoords(e,r,i=!1){$t.set(r);const s=this._infoByLevel[$t.level];return s?s.getTileCoords(e,$t,i):e}getTileCoverage(e,r=192,i=!0,s="closest"){if(!i&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const n=s==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),o=jk.pool.acquire(n),a=this._wrap;let l,c,d,p=1/0,m=-1/0;const y=o.spans;ms[0][0]=ms[0][1]=ms[1][1]=ms[3][0]=-r,ms[1][0]=ms[2][0]=e.size[0]+r,ms[2][1]=ms[3][1]=e.size[1]+r;for(const _ of ms)e.toMap(_,_),_[0]=n.getColumnForX(_[0]),_[1]=n.getRowForY(_[1]);const g=[];let v=3;for(let _=0;_<4;_++){if(ms[_][1]===ms[v][1]){v=_;continue}const x=g0e.create(ms[_],ms[v]);p=Math.min(x.ymin,p),m=Math.max(x.ymax,m),g[x.ymin]===void 0&&(g[x.ymin]=[]),g[x.ymin].push(x),v=_}if(p==null||m==null||m-p>100)return null;let w=[];for(l=p;l<m;){g[l]!=null&&(w=w.concat(g[l])),c=1/0,d=-1/0;for(let _=w.length-1;_>=0;_--){const x=w[_];c=Math.min(c,x.getLeftCol()),d=Math.max(d,x.getRightCol())}if(c=Math.floor(c),d=Math.floor(d),l>=n.first[1]&&l<=n.last[1])if(a)if(n.size[0]<n.worldSize[0]){const _=Math.floor(d/n.worldSize[0]);for(let x=Math.floor(c/n.worldSize[0]);x<=_;x++)y.push(new b$(l,Math.max(n.getFirstColumnForWorld(x),c),Math.min(n.getLastColumnForWorld(x),d)))}else y.push(new b$(l,c,d));else c>n.last[0]||d<n.first[0]||(c=Math.max(c,n.first[0]),d=Math.min(d,n.last[0]),y.push(new b$(l,c,d)));l+=1;for(let _=w.length-1;_>=0;_--){const x=w[_];x.ymax>=l?x.incrRow():w.splice(_,1)}}return o}getTileParentId(e){$t.set(e);const r=this._infoByLevel[$t.level],i=this._lodInfos.indexOf(r)-1;return i<0?null:(this._getTileIdAtLOD($t,this._lodInfos[i],$t),$t.id)}getTileResolution(e){const r=this._infoByLevel[typeof e=="object"?e.level:e];return r?r.resolution:-1}getTileScale(e){const r=this._infoByLevel[e.level];return r?r.scale:-1}intersects(e,r){$t.set(r);const i=this._infoByLevel[$t.level],s=e.lodInfo;if(s.resolution>i.resolution){this._getTileIdAtLOD($t,s,$t);const o=s.denormalizeCol($t.col,$t.world);for(const a of e.spans)if(a.row===$t.row&&a.colFrom<=o&&a.colTo>=o)return!0}if(s.resolution<i.resolution){const[o,a,l,c]=e.spans.reduce((v,w)=>(v[0]=Math.min(v[0],w.row),v[1]=Math.max(v[1],w.row),v[2]=Math.min(v[2],w.colFrom),v[3]=Math.max(v[3],w.colTo),v),[1/0,-1/0,1/0,-1/0]),d=i.denormalizeCol($t.col,$t.world),p=s.getColumnForX(i.getXForColumn(d)),m=s.getRowForY(i.getYForRow($t.row)),y=s.getColumnForX(i.getXForColumn(d+1))-1,g=s.getRowForY(i.getYForRow($t.row+1))-1;return!(p>c||y<l||m>a||g<o)}const n=s.denormalizeCol($t.col,$t.world);return e.spans.some(o=>o.row===$t.row&&o.colFrom<=n&&o.colTo>=n)}normalizeBounds(e,r,i){if(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],this._wrap){const s=qi(this.tileInfo.spatialReference),n=-i*(s.valid[1]-s.valid[0]);e[0]+=n,e[2]+=n}return e}getSmallestInfoForScale(e){const r=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>r[0])return this._infoByScale[r[0]];for(let i=1;i<r.length-1;i++)if(e>r[i]+v0e)return this._infoByScale[r[i-1]];return this._infoByScale[r[r.length-1]]}getClosestInfoForScale(e){const r=this.scales;return this._infoByScale[e]||(e=r.reduce((i,s)=>Math.abs(s-e)<Math.abs(i-e)?s:i,r[0])),this._infoByScale[e]}scaleToLevel(e){const r=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let i=r.length-1;i>=0;i--)if(e<r[i])return i===r.length-1?this._infoByScale[r[r.length-1]].level:this._infoByScale[r[i]].level+(r[i]-e)/(r[i]-r[i+1]);return this._infoByScale[r[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}zoomToScale(e){return this.tileInfo.zoomToScale(e)}_getTileIdAtLOD(e,r,i){const s=this._infoByLevel[i.level];return e.set(i),r.resolution<s.resolution?null:(r.resolution===s.resolution||(e.level=r.level,e.col=Math.floor(i.col*s.resolution/r.resolution+.01),e.row=Math.floor(i.row*s.resolution/r.resolution+.01)),e)}},_0e=class{constructor(e,r){this.item=e,this.controller=r,this.promise=null}},b0e=class{constructor(e){this._schedule=null,this._task=null,this._deferreds=new kf,this._controllers=new kf,this._processingItems=new kf,this._pausedSignal=Mm(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new J0(e.peeker),this.process=e.process;const r=e.scheduler;e.priority&&r&&(this._task=r.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=yt(this._schedule),this._task=yt(this._task)}get updating(){return!!this._task?.updating||this.readyToRun}get length(){return this._processingItems.size+this._queue.length}abort(e){const r=this._controllers.get(e);r&&r.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(r=>e.push(r)),this._controllers.clear(),e.forEach(r=>r.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((r,i)=>e(i))}get(e){const r=this._deferreds.get(e);return r?r.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,r){const i=this.get(e);if(i)return i;const s=new AbortController;let n=null;r&&(n=mn(r,()=>s.abort()));const o=()=>{const d=this._processingItems.get(e);d&&d.controller.abort(),a(),c.reject(it())},a=()=>{l.remove(),n?.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},l=JC(s.signal,o),c=ps();return this._deferreds.set(e,c),this._controllers.set(e,s),c.promise.then(a,a),this._queue.push(e),this._scheduleNext(),c.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){const e=this._queue.popLast();return e&&(this._deferreds.get(e)?.reject(it()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const r of e)this._queue.push(r.item),r.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get readyToRun(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=Vm(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,r){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(r))}_processError(e,r){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(r))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let r;const i=new AbortController,s=new _0e(e,i);this._processingItems.set(e,s);try{r=this.process(e,i.signal)}catch(n){this._processError(s,n)}$i(r)?(s.promise=r,r.then(n=>this._processResult(s,n),n=>this._processError(s,n))):this._processResult(s,r)}get test(){}};const _F=[0,0];let Ua=class extends le{constructor(e){super(e),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:e,process:r,scheduler:i,priority:s}=this;this._queue=new b0e({concurrency:e,scheduler:i,priority:s,process:(n,o)=>{const a=this._keyToItem.get(n);return r(a,{signal:o})},peeker:n=>this._peek(n)})}destroy(){this.clear(),this._queue=xt(this._queue)}get length(){return this._queue?this._queue.length:0}abort(e){const r=typeof e=="string"?e:e.id;this._queue.abort(r)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}pause(){this._queue.pause()}push(e){const r=e.key.id;if(this._queue.has(r))return this._queue.get(r);const i=this._queue.push(r),s=this.tileInfoView.getTileScale(e.key),n=Fm(this._tilesByScale,s,()=>new Set),o=()=>{n.delete(e.key),n.size===0&&this._tilesByScale.delete(s),this._keyToItem.delete(r)};return n.add(e.key),this._keyToItem.set(r,e),i.then(o,o),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(e){if(!this.state)return e.values().next().value;const r=new Set;for(const o of e)r.add(this._keyToItem.get(o).key);const i=this.state.scale;let s,n=Number.POSITIVE_INFINITY;for(const[o,a]of this._tilesByScale)if(g6(a,l=>r.has(l))){const l=Math.abs(o-i);l<n&&(s=a,n=l)}return this._getClosestTileKey(s,e).id}_getClosestTileKey(e,r){const i=this.tileInfoView,s=this.state.center;let n,o=Number.POSITIVE_INFINITY;for(const a of e)if(r.has(a.id)){i.getTileCoords(_F,a);const l=_2(_F,s);l<o&&(o=l,n=a)}return n}};u([h({constructOnly:!0})],Ua.prototype,"concurrency",void 0),u([h({constructOnly:!0})],Ua.prototype,"priority",void 0),u([h({constructOnly:!0})],Ua.prototype,"process",void 0),u([h({constructOnly:!0})],Ua.prototype,"scheduler",void 0),u([h()],Ua.prototype,"state",void 0),u([h({constructOnly:!0})],Ua.prototype,"tileInfoView",void 0),Ua=u([E("esri.views.2d.tiling.TileQueue")],Ua);const _ze=Ua;let S0e=class{constructor(e,r,i){this.maxSize=e,this._tileInfoView=r,this._removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const r=this._tilePerId.get(e);if(!r)return;const i=r.key.level,s=this._tileKeysPerLevel[i];bF(this._tilePerId,e);for(let n=0;n<s.length;n++)if(s[n].id===e){s.splice(n,1);break}return r.visible=!0,r}add(e){e.visible=!1;const r=e.key,i=r.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,e);const s=r.level;this._tileKeysPerLevel[s]||(this._tileKeysPerLevel[s]=[]),this._tileKeysPerLevel[s].push(r)}prune(e,r,i){let s=this._tilePerId.size;if(s<=this.maxSize)return;let n=this._tileKeysPerLevel.length-1;for(;s>this.maxSize&&n>=0;)n!==e&&(s=this._pruneAroundCenterTile(s,r,i,n)),n--;s>this.maxSize&&(s=this._pruneAroundCenterTile(s,r,i,e))}_pruneAroundCenterTile(e,r,i,s){const n=this._tileKeysPerLevel[s];if(!n||n.length===0)return e;const{size:o,origin:a}=this._tileInfoView.tileInfo,l=i*o[0],c=i*o[1],d=[0,0],p=[0,0];for(n.sort((m,y)=>(d[0]=a.x+l*(m.col+.5),d[1]=a.y-c*(m.row+.5),p[0]=a.x+l*(y.col+.5),p[1]=a.y-c*(y.row+.5),U0(d,r)-U0(p,r)));n.length>0;){const m=n.pop();if(this._removeTile(m.id),--e===this.maxSize)break}return e}_removeTile(e){const r=this._tilePerId.get(e);this._removedFunc&&r&&this._removedFunc(r),bF(this._tilePerId,e)}};function bF(t,e){t.delete(e)}const Ec=new ty(0,0,0,0),Ta=new Map,Ay=[],S$=[];let Sze=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new S0e(e.cacheSize,this.tileInfoView,r=>{this.releaseTile(r)}))}destroy(){this.tileIndex.clear()}update(e){const{resampling:r,tileIndex:i}=this,{scale:s,center:n,resolution:o}=e.state,{minScale:a,maxScale:l}=this.tileInfoView,c=!e.stationary&&s>this._previousScale;if(this._previousScale=s,!r&&(s>a||s<l))return this.tiles.length=0,void this.clear();const d=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!d)return this.tiles.length=0,void this.clear();const{spans:p,lodInfo:m}=d,{level:y}=m;this.tiles.length=0,i.forEach(_=>_.visible=!0);let g=0,v=0;if(p.length>0)for(const{row:_,colFrom:x,colTo:$}of p)for(let T=x;T<=$;T++){g++;const C=Ec.set(y,_,m.normalizeCol(T),m.getWorldForColumn(T)).id;let P=i.get(C);if(P)P.isReady?(Ta.set(C,P),v++):c||this._addParentTile(C,Ta);else{if(this._tileCache?.has(C)){if(P=this._tileCache.pop(C),this.tileIndex.set(C,P),P.isReady){Ta.set(C,P),v++;continue}}else P=this.acquireTile(Ec),this.tileIndex.set(C,P);c||this._addParentTile(C,Ta)}}const w=v===g;for(const[_,x]of i){if(Ta.has(_))continue;Ec.set(_);const $=this.tileInfoView.intersects(d,Ec),T=this.cachePolicy==="purge"?Ec.level!==y:Ec.level>y;!$||!c&&w?!T&&$||Ay.push(x):x.isReady?T&&this.cachePolicy==="purge"&&this._hasReadyAncestor(Ec,y)?Ay.push(x):S$.push(x):T&&Ay.push(x)}for(const _ of S$)_.isReady&&Ta.set(_.key.id,_);for(const _ of Ay)this._tileCache?this._tileCache.add(_):this.releaseTile(_),i.delete(_.key.id);for(const _ of Ta.values())this.tiles.push(_);for(const _ of i.values())Ta.has(_.key.id)||(_.visible=!1);this._tileCache?.prune(y,n,o),jk.pool.release(d),S$.length=0,Ay.length=0,Ta.clear()}clear(){const{tileIndex:e}=this;for(const r of e.values())this.releaseTile(r);e.clear()}refresh(e){for(const r of this.tileIndex.values())e(r);this._tileCache?.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,r){let i=e,s=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(s=this.tileIndex.get(i),s?.isReady){r.has(s.key.id)||r.set(s.key.id,s);break}}else if(this._tileCache?.has(i)&&(s=this._tileCache.pop(i),this.tileIndex.set(i,s),s?.isReady)){r.has(s.key.id)||r.set(s.key.id,s);break}}_hasReadyAncestor(e,r){const i=lr();this.tileInfoView.getTileBounds(i,e,!0);for(const s of this.tileIndex.values())if(s.isReady&&s.key.level>=r&&s.key.level<e.level){const n=lr();if(this.tileInfoView.getTileBounds(n,s.key,!0),Vne(n,i))return!0}return!1}};const x0e={"area-measurement":null,dimension:null,"direct-line-measurement":null,"elevation-profile":()=>q(()=>import("./ElevationProfileAnalysisView2D-DVFoeTHi.js"),__vite__mapDeps([257,157,251,258,202,259,260,261,262,263,264,16,265,266,267,268,269,101,102,270,271,272,13,273,274,124,62,107,108,120,159,60,275,94,133,138,119])),"line-of-sight":null,slice:null,viewshed:null,"volume-measurement":null};function $0e(t){const e=x0e[t.type];if(!e)throw new R("analysis-view-module-import-utils:analysis-not-supported",`Analysis "${t.type}" is not supported`);return e()}let M0e=class{constructor(e,r={}){this.events=new D6,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,e!=null?(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform"),e.contains(this._canvas)||e.appendChild(this._canvas)):r.canvas!=null&&(this._canvas=r.canvas);const i={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};let s=this._canvas.getContext("webgl2",i);s||(s=this._canvas.getContext("webgl2",{...i,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=s,this._handles=md([Dm(this._canvas,"webglcontextlost",n=>this.events.emit("webgl-context-lost",n))])}destroy(){this._canvas.remove(),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}get canvas(){return this._canvas}render(e,r){if(this._hasMajorPerformanceCaveat||z("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=z("esri-performance-mode-frames-between-render")&&(r(),this._lastRenderViewState=e.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[i,s,n,o,a,l]=this._computeViewTransform(this._lastRenderViewState,e.state);this._canvas.style.transform=`matrix(${i}, ${s}, ${n}, ${o}, ${a}, ${l})`}}else r()}resize(e){const r=this._canvas,i=r.style,{state:{size:s},pixelRatio:n}=e,o=s[0],a=s[1],l=Math.round(o*n),c=Math.round(a*n);r.width===l&&r.height===c||(r.width=l,r.height=c),i.width=o+"px",i.height=a+"px"}_computeViewTransform(e,r){const[i,s]=e.center,[n,o]=r.center,[a,l]=e.toScreen([0,0],n,o),[c,d]=e.toScreen([0,0],i,s),p=c-a,m=d-l,y=e.scale/r.scale,g=r.rotation-e.rotation,v=pa();return Jv(v),Yv(v,v,[y,y]),uc(v,v,Ym(g)),da(v,v,[p,m]),v}};function T0e(t,e,r,i,s){ZG(t,e,r||0,i||t.length-1,s||I0e)}function ZG(t,e,r,i,s){for(;i>r;){if(i-r>600){var n=i-r+1,o=e-r+1,a=Math.log(n),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(n-l)/n)*(o-n/2<0?-1:1);ZG(t,e,Math.max(r,Math.floor(e-o*l/n+c)),Math.min(i,Math.floor(e+(n-o)*l/n+c)),s)}var d=t[e],p=r,m=i;for(Ry(t,r,e),s(t[i],d)>0&&Ry(t,r,i);p<m;){for(Ry(t,p,m),p++,m--;s(t[p],d)<0;)p++;for(;s(t[m],d)>0;)m--}s(t[r],d)===0?Ry(t,r,m):Ry(t,++m,i),m<=e&&(r=m+1),e<=m&&(i=m-1)}}function Ry(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function I0e(t,e){return t<e?-1:t>e?1:0}function uS(t,e){if(!(this instanceof uS))return new uS(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function E0e(t,e,r){if(!r)return e.indexOf(t);for(var i=0;i<e.length;i++)if(r(t,e[i]))return i;return-1}function Ud(t,e){Tg(t,0,t.children.length,e,t)}function Tg(t,e,r,i,s){s||(s=$p(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var n,o=e;o<r;o++)n=t.children[o],Ig(s,t.leaf?i(n):n);return s}function Ig(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function SF(t,e){return t.minX-e.minX}function xF(t,e){return t.minY-e.minY}function x$(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Vw(t){return t.maxX-t.minX+(t.maxY-t.minY)}function C0e(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function P0e(t,e){var r=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),n=Math.min(t.maxY,e.maxY);return Math.max(0,s-r)*Math.max(0,n-i)}function $$(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Uw(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function $p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function $F(t,e,r,i,s){for(var n,o=[e,r];o.length;)(r=o.pop())-(e=o.pop())<=i||(n=e+Math.ceil((r-e)/i/2)*i,T0e(t,n,e,r,s),o.push(e,n,n,r))}uS.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],i=this.toBBox;if(!Uw(t,e))return r;for(var s,n,o,a,l=[];e;){for(s=0,n=e.children.length;s<n;s++)o=e.children[s],Uw(t,a=e.leaf?i(o):o)&&(e.leaf?r.push(o):$$(t,a)?this._all(o,r):l.push(o));e=l.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!Uw(t,e))return!1;for(var i,s,n,o,a=[];e;){for(i=0,s=e.children.length;i<s;i++)if(n=e.children[i],Uw(t,o=e.leaf?r(n):n)){if(e.leaf||$$(t,o))return!0;a.push(n)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var s=this.data;this.data=i,i=s}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t!=null&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=$p([]),this},remove:function(t,e){if(t==null)return this;for(var r,i,s,n,o=this.data,a=this.toBBox(t),l=[],c=[];o||l.length;){if(o||(o=l.pop(),i=l[l.length-1],r=c.pop(),n=!0),o.leaf&&(s=E0e(t,o.children,e))!==-1)return o.children.splice(s,1),l.push(o),this._condense(l),this;n||o.leaf||!$$(o,a)?i?(r++,o=i.children[r],n=!1):o=null:(l.push(o),c.push(r),r=0,i=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:SF,compareMinY:xF,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,i){var s,n=r-e+1,o=this._maxEntries;if(n<=o)return Ud(s=$p(t.slice(e,r+1)),this.toBBox),s;i||(i=Math.ceil(Math.log(n)/Math.log(o)),o=Math.ceil(n/Math.pow(o,i-1))),(s=$p([])).leaf=!1,s.height=i;var a,l,c,d,p=Math.ceil(n/o),m=p*Math.ceil(Math.sqrt(o));for($F(t,e,r,m,this.compareMinX),a=e;a<=r;a+=m)for($F(t,a,c=Math.min(a+m-1,r),p,this.compareMinY),l=a;l<=c;l+=p)d=Math.min(l+p-1,c),s.children.push(this._build(t,l,d,i-1));return Ud(s,this.toBBox),s},_chooseSubtree:function(t,e,r,i){for(var s,n,o,a,l,c,d,p;i.push(e),!e.leaf&&i.length-1!==r;){for(d=p=1/0,s=0,n=e.children.length;s<n;s++)l=x$(o=e.children[s]),(c=C0e(t,o)-l)<p?(p=c,d=l<d?l:d,a=o):c===p&&l<d&&(d=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,r){var i=this.toBBox,s=r?t:i(t),n=[],o=this._chooseSubtree(s,this.data,e,n);for(o.children.push(t),Ig(o,s);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(s,n,e)},_split:function(t,e){var r=t[e],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);var n=this._chooseSplitIndex(r,s,i),o=$p(r.children.splice(n,r.children.length-n));o.height=r.height,o.leaf=r.leaf,Ud(r,this.toBBox),Ud(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(r,o)},_splitRoot:function(t,e){this.data=$p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Ud(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var i,s,n,o,a,l,c,d;for(l=c=1/0,i=e;i<=r-e;i++)o=P0e(s=Tg(t,0,i,this.toBBox),n=Tg(t,i,r,this.toBBox)),a=x$(s)+x$(n),o<l?(l=o,d=i,c=a<c?a:c):o===l&&a<c&&(c=a,d=i);return d},_chooseSplitAxis:function(t,e,r){var i=t.leaf?this.compareMinX:SF,s=t.leaf?this.compareMinY:xF;this._allDistMargin(t,e,r,i)<this._allDistMargin(t,e,r,s)&&t.children.sort(i)},_allDistMargin:function(t,e,r,i){t.children.sort(i);var s,n,o=this.toBBox,a=Tg(t,0,e,o),l=Tg(t,r-e,r,o),c=Vw(a)+Vw(l);for(s=e;s<r-e;s++)n=t.children[s],Ig(a,t.leaf?o(n):n),c+=Vw(a);for(s=r-e-1;s>=e;s--)n=t.children[s],Ig(l,t.leaf?o(n):n),c+=Vw(l);return c},_adjustParentBBoxes:function(t,e,r){for(var i=r;i>=0;i--)Ig(e[i],t)},_condense:function(t){for(var e,r=t.length-1;r>=0;r--)t[r].children.length===0?r>0?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():Ud(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};function k0e(t,{timeZone:e,timeExtent:r}){return{$view:{scale:t,timeZone:e,timeProperties:{currentStart:r?.start,currentEnd:r?.end}}}}let MF=class JG{constructor(e,r){this.key=new ty(0,0,0,0),this.bounds=lr(),this.objectIds=new Set,this.key.set(r);const i=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.level=i.level,this.scale=i.scale,this.minScale=e.zoomToScale(i.level-1),this.maxScale=e.zoomToScale(i.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return Nne(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(e){return k0e(this.scale,e)}createChildTiles(){const e=this.key.getChildKeys(),r=Di.acquire();for(let i=0;i<e.length;i++)r[i]=new JG(this.tileInfoView,e[i]);return r}getQuantizationParameters(){return Mu.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const Cc={added:[],removed:[]},M$=new Set,L0e=new ty(0,0,0,0);function A0e(t,e){const r=qi(e);if(!r)return null;const[i,s]=r.valid;return t[2]>s?[lr([t[0],t[1],s,t[3]]),lr([i,t[1],i+t[2]-s,t[3]])]:t[0]<i?[lr([i,t[1],t[2],t[3]]),lr([s-(i-t[0]),t[1],s,t[3]])]:null}let R0e=class extends N6{constructor(e){super(),this._tiles=new Map,this._index=uS(9,z("esri-csp-restrictions")?r=>({minX:r.bounds[0],minY:r.bounds[1],maxX:r.bounds[2],maxY:r.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){super.destroy(),this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||g2(e)===0||v2(e)===0)return[];const r=A0e(e,this.tileScheme.spatialReference);return r!=null?[...new Set([...this.boundsIntersections(r[0]),...this.boundsIntersections(r[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const r={added:[],removed:[]};for(const i of e.added)if(!this.has(i)){const s=new MF(this.tileScheme,i);this._tiles.set(i,s),this._index.insert(s),r.added.push(s)}for(const i of e.removed)if(this.has(i)){const s=this.get(i);this._tiles.delete(i),this._index.remove(s),r.removed.push(s)}this.tiles.length=0,this._tiles.forEach(i=>this.tiles.push(i)),(r.added.length||r.removed.length)&&this.emit("update",r)}setViewState(e){const r=this.tileScheme.getTileCoverage(e,0);if(!r)return;const{spans:i,lodInfo:s}=r,{level:n}=s;if(i.length>0)for(const{row:o,colFrom:a,colTo:l}of i)for(let c=a;c<=l;c++){const d=L0e.set(n,o,s.normalizeCol(c),s.getWorldForColumn(c)).id;if(M$.add(d),!this.has(d)){const p=new MF(this.tileScheme,d);this._tiles.set(d,p),this._index.insert(p),this.tiles.push(p),Cc.added.push(p)}}for(let o=this.tiles.length-1;o>=0;o--){const a=this.tiles[o];M$.has(a.id)||(this._tiles.delete(a.id),this.tiles.splice(o,1),this._index.remove(a),Cc.removed.push(a))}(Cc.added.length||Cc.removed.length)&&this.emit("update",Cc),jk.pool.release(r),M$.clear(),Cc.added.length=0,Cc.removed.length=0}};const Tze=1e-30,TF=512,Gw=16777216,Ize=8,YG=29,XG=24,Eze=4,Cze=0,Pze=0,kze=0,Lze=1,Aze=2,Rze=3,Oze=4,Fze=5,Nze=6,Dze=12,zze=13,jze=5,O0e=6,Vze=5,Uze=6,KG=6,F0e=1<<KG,Gze=F0e<<1,qze=1.05,Bze=3,Hze=1,N0e=3,D0e=3,Wze=5,Zze=6,Jze=1.15,z0e=4,Yze=128,j0e=256,Xze=j0e-2*z0e,Kze=2,Qze=128,QG=1,e6e=10,V0e=1024,t6e=128,r6e=4,i6e=1,s6e=1<<20,n6e=.75,o6e=10,a6e=.75,l6e=256,U0e=32,G0e=512,u6e=0,c6e=1,q0e=1,h6e=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],d6e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Oy=256,B0e=()=>U.getLogger("esri.views.webgl.checkWebGLError");function eq(t){switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const tq=!!z("enable-feature:webgl-debug");function rq(){return tq}function p6e(){return tq}function Pc(t,e=rq()){if(e){const r=eq(t);if(r){const i=new Error().stack;B0e().error(new R("webgl-error","WebGL error occurred",{message:r,stack:i}))}}}const f6e={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},kc={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131},me={RGBA4:32854,R16F:33325,RG16F:33327,RGB32F:34837,RGBA16F:34842,R32F:33326,RG32F:33328,RGBA32F:34836,R11F_G11F_B10F:35898,RGB8:32849,RGBA8:32856,RGB5_A1:32855,R8:33321,RG8:33323,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,RGB16F:34843,RGB9_E5:35901,SRGB8:35905,SRGB8_ALPHA8:35907,RGB565:36194,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2:32857,RGB10_A2UI:36975},H0e=Object.values(me),cS={DEPTH24_STENCIL8:35056,DEPTH32F_STENCIL8:36013},b0={DEPTH_COMPONENT16:33189,DEPTH_COMPONENT24:33190,DEPTH_COMPONENT32F:36012},N3={FLOAT:kc.FLOAT,UNSIGNED_BYTE:kc.UNSIGNED_BYTE,UNSIGNED_INT_24_8:34042,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,BYTE:kc.BYTE,UNSIGNED_SHORT:kc.UNSIGNED_SHORT,SHORT:kc.SHORT,UNSIGNED_INT:kc.UNSIGNED_INT,INT:kc.INT,HALF_FLOAT:5131,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269},m6e=33984,IF={Texture:0,TileTexture:1,BufferObject:2,VertexArrayObject:3,Shader:4,Program:5,FramebufferObject:6,Renderbuffer:7,TransformFeedback:8,Sync:9,UNCOUNTED:10,LinesOfCode:10,Uniform:11,COUNT:12},y6e=1029,g6e=0,v6e=36064,w6e=36065,_6e=36066,b6e=36067,S6e=33306,x6e=36096,$6e=36128,ui={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497};function M6e(t,e,r,i=0){const s=t.gl;t.bindBuffer(r);for(const n of r.layout){const o=e.get(n.name);if(o==null){console.warn(`There is no location for vertex attribute '${n.name}' defined.`);continue}const a=i*n.stride;if(n.count<=4)s.vertexAttribPointer(o,n.count,n.type,n.normalized,n.stride,n.offset+a),s.enableVertexAttribArray(o),n.divisor>0&&s.vertexAttribDivisor(o,n.divisor);else if(n.count===9)for(let l=0;l<3;l++)s.vertexAttribPointer(o+l,3,n.type,n.normalized,n.stride,n.offset+12*l+a),s.enableVertexAttribArray(o+l),n.divisor>0&&s.vertexAttribDivisor(o+l,n.divisor);else if(n.count===16)for(let l=0;l<4;l++)s.vertexAttribPointer(o+l,4,n.type,n.normalized,n.stride,n.offset+16*l+a),s.enableVertexAttribArray(o+l),n.divisor>0&&s.vertexAttribDivisor(o+l,n.divisor);else console.error("Unsupported vertex attribute element count: "+n.count);if(rq()){const l=eq(t.gl);l&&console.error(`Unable to bind vertex attribute "${n.name}" with baseInstanceOffset ${a}:`,l,n)}}}function T6e(t){switch(t){case 6406:case 6409:case 6403:case 36244:case 6402:case 34041:return 1;case 6410:case 33319:case 33320:return 2;case 6407:case 36248:return 3;case 6408:case 36249:return 4}return 0}function W0e(t){switch(t){case 6406:case 6409:case 6403:case 36244:case me.R8:case me.R8I:case me.R8UI:case me.R8_SNORM:case 36168:return 1;case 6410:case 33319:case 33320:case me.RGBA4:case me.R16F:case me.R16I:case me.R16UI:case me.RG8:case me.RG8I:case me.RG8UI:case me.RG8_SNORM:case me.RGB565:case me.RGB5_A1:case b0.DEPTH_COMPONENT16:return 2;case 6407:case 36248:case me.RGB8:case me.RGB8I:case me.RGB8UI:case me.RGB8_SNORM:case me.SRGB8:case b0.DEPTH_COMPONENT24:return 3;case 6408:case 36249:case me.RGBA8:case me.R32F:case me.R11F_G11F_B10F:case me.RG16F:case me.R32I:case me.R32UI:case me.RG16I:case me.RG16UI:case me.RGBA8I:case me.RGBA8UI:case me.RGBA8_SNORM:case me.SRGB8_ALPHA8:case me.RGB9_E5:case me.RGB10_A2UI:case me.RGB10_A2:case b0.DEPTH_COMPONENT32F:case cS.DEPTH24_STENCIL8:return 4;case cS.DEPTH32F_STENCIL8:return 5;case me.RGB16F:case me.RGB16I:case me.RGB16UI:return 6;case me.RG32F:case me.RG32I:case me.RG32UI:case me.RGBA16F:case me.RGBA16I:case me.RGBA16UI:return 8;case me.RGB32F:case me.RGB32I:case me.RGB32UI:return 12;case me.RGBA32F:case me.RGBA32I:case me.RGBA32UI:return 16;case ui.COMPRESSED_RGB_S3TC_DXT1_EXT:case ui.COMPRESSED_RGBA_S3TC_DXT1_EXT:return .5;case ui.COMPRESSED_RGBA_S3TC_DXT3_EXT:case ui.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case ui.COMPRESSED_R11_EAC:case ui.COMPRESSED_SIGNED_R11_EAC:case ui.COMPRESSED_RGB8_ETC2:case ui.COMPRESSED_SRGB8_ETC2:case ui.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case ui.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return .5;case ui.COMPRESSED_RG11_EAC:case ui.COMPRESSED_SIGNED_RG11_EAC:case ui.COMPRESSED_RGBA8_ETC2_EAC:case ui.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}let iq=class{constructor(e=0,r=e){this.width=e,this.height=r,this.type=0,this.target=3553,this.pixelFormat=6408,this.dataType=N3.UNSIGNED_BYTE,this.samplingMode=9729,this.wrapMode=10497,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.compareEnabled=!1,this.linearFilterDepth=!1,this.depth=1,this.isImmutable=!1}};function Z0e(t){return t.width<=0||t.height<=0||t.depth<=0?0:Math.round(t.width*t.height*t.depth*(t.hasMipmap?4/3:1)*(t.internalFormat==null?4:W0e(t.internalFormat))*(t.target===34067?6:1))}const Fy=()=>U.getLogger("esri/views/webgl/textureUtils");function Ny(t){const{width:e,height:r,depth:i}=t;(e!=null&&e<0||r!=null&&r<0||i!=null&&i<0)&&Fy().error("Negative dimension parameters are not allowed!");const{internalFormat:s}=t;if(s&&(sq(s)||nq(s))){const{linearFilterDepth:n,compareEnabled:o,samplingMode:a,hasMipmap:l}=t;l&&Fy().error("Depth textures cannot have mipmaps"),n?a!==9729&&a!==9728&&Fy().error("Depth textures cannot sample mipmaps"):(a!==9728&&Fy().error("Depth textures without filtering must use NEAREST filtering"),o&&Fy().error("Depth textures without filtering cannot use compare function"))}}function J0e(t){return H0e.includes(t)}function sq(t){return VS(b0,t)}function nq(t){return VS(cS,t)}function Y0e(t){return t!=null&&VS(ui,t)}function Mp(t){return t!=null&&"type"in t&&t.type==="compressed"}function X0e(t){return t!=null&&"byteLength"in t}function EF(t){return t!=null&&!Mp(t)&&!X0e(t)}function Gd(t){return t===32879||t===35866}function CF(t,e,r,i=1){let s=Math.max(e,r);return t===32879&&(s=Math.max(s,i)),Math.floor(Math.log2(s))+1}function qw(t){if(t.internalFormat!=null)return t.internalFormat;switch(t.dataType){case N3.FLOAT:switch(t.pixelFormat){case 6408:return me.RGBA32F;case 6407:return me.RGB32F;default:throw new R("texture:unknown-format","Unable to derive format")}case N3.UNSIGNED_BYTE:switch(t.pixelFormat){case 6408:return me.RGBA8;case 6407:return me.RGB8}}const{pixelFormat:e}=t;return t.internalFormat=e===34041?cS.DEPTH24_STENCIL8:e===6402?b0.DEPTH_COMPONENT24:e,t.internalFormat}function K0e(t){let e="width"in t?t.width:t.codedWidth,r="height"in t?t.height:t.codedHeight;return t instanceof HTMLVideoElement&&(e=t.videoWidth,r=t.videoHeight),{width:e,height:r,depth:1}}let Q0e=class oq extends iq{constructor(e,r){switch(super(),this.context=e,Object.assign(this,r),this.internalFormat){case me.R16F:case me.R32F:case me.R8_SNORM:case me.R8:this.pixelFormat=6403;break;case me.R8I:case me.R8UI:case me.R16I:case me.R16UI:case me.R32I:case me.R32UI:this.pixelFormat=36244}}static validate(e,r){return new oq(e,r)}};const eve=!!z("esri-tests-disable-gpu-memory-measurements"),Ia=()=>U.getLogger("esri/views/webgl/Texture");var cr;let tve=(cr=class{constructor(e,r=null,i=null){if(this.type=1,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._shadowFilterDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,i=r;else{const s=Q0e.validate(e,r);if(!s)throw new R("texture:invalid-descriptor","Texture descriptor invalid");this._descriptor=s}this._descriptor.target===34067?this._setDataCubeMap(i):this.setData(i)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return eve?0:Z0e(this._descriptor)}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty||this._shadowFilterDirty}get hasWebGLTextureObject(){return!!this._glName}dispose(){this.abortCompression(),this.hasWebGLTextureObject&&this._descriptor.context?.gl&&(this._descriptor.context.instanceCounter.decrement(IF.Texture,this),this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null,this._descriptor=null)}release(){this.dispose()}[Symbol.dispose](){this.dispose()}resize(e,r){const i=this._descriptor;if(i.width!==e||i.height!==r){if(this._wasImmutablyAllocated)throw new R("texture:immutable-resize","Immutable textures can't be resized!");i.width=e,i.height=r,this._descriptor.target===34067?this._setDataCubeMap(null):this.setData(null)}}enableCompression(e){this._descriptor.compress=e}disableCompression(){this._descriptor.compress=void 0}setData(e){this.abortCompression(),!Mp(e)&&this._descriptor.internalFormat&&VS(ui,this._descriptor.internalFormat)&&(this._descriptor.internalFormat=void 0),this._setData(e),!Mp(e)&&this._descriptor.compress&&this._compressOnWorker(e)}updateData(e,r,i,s,n,o,a=0){o||Ia().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||Ia().error("An attempt to update uninitialized texture!");const l=this._descriptor;l.internalFormat=qw(l);const{context:c,pixelFormat:d,dataType:p,target:m,isImmutable:y}=l;if(y&&!this._wasImmutablyAllocated)throw new R("texture:uninitialized","Cannot update immutable texture before allocation!");const g=c.bindTexture(this,cr.TEXTURE_UNIT_FOR_UPDATES,!0);(r<0||i<0||r+s>l.width||i+n>l.height)&&Ia().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:v}=c;a&&(s&&n||Ia().warn("Must pass width and height if `UNPACK_SKIP_ROWS` is used"),v.pixelStorei(v.UNPACK_SKIP_ROWS,a)),EF(o)?v.texSubImage2D(m,e,r,i,s,n,d,p,o):Mp(o)?v.compressedTexSubImage2D(m,e,r,i,s,n,l.internalFormat,o.levels[e]):v.texSubImage2D(m,e,r,i,s,n,d,p,o),a&&v.pixelStorei(v.UNPACK_SKIP_ROWS,0),c.bindTexture(g,cr.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,r,i,s,n,o,a,l){l||Ia().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||Ia().error("An attempt to update an uninitialized texture!");const c=this._descriptor;c.internalFormat=qw(c);const{context:d,pixelFormat:p,dataType:m,isImmutable:y,target:g}=c;if(y&&!this._wasImmutablyAllocated)throw new R("texture:uninitialized","Cannot update immutable texture before allocation!");Gd(g)||Ia().warn("Attempting to set 3D texture data on a non-3D texture");const v=d.bindTexture(this,cr.TEXTURE_UNIT_FOR_UPDATES);d.setActiveTexture(cr.TEXTURE_UNIT_FOR_UPDATES),(r<0||i<0||s<0||r+n>c.width||i+o>c.height||s+a>c.depth)&&Ia().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:w}=d;if(Mp(l))l=l.levels[e],w.compressedTexSubImage3D(g,e,r,i,s,n,o,a,c.internalFormat,l);else{const _=l;w.texSubImage3D(g,e,r,i,s,n,o,a,p,m,_)}d.bindTexture(v,cr.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(e.width===0||e.height===0)return;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new R("texture:immutable-change","Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,Ny(e)}e.samplingMode===9729?(this._samplingModeDirty=!0,e.samplingMode=9985):e.samplingMode===9728&&(this._samplingModeDirty=!0,e.samplingMode=9984);const r=this._descriptor.context.bindTexture(this,cr.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(cr.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(r,cr.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new R("texture:immutable-change","Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,Ny(e)}e.samplingMode===9985?(this._samplingModeDirty=!0,e.samplingMode=9729):e.samplingMode===9984&&(this._samplingModeDirty=!0,e.samplingMode=9728)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,Ny(this._descriptor),this._wrapModeDirty=!0)}setShadowFiltering(e){e!==this._descriptor.linearFilterDepth&&(this._descriptor.linearFilterDepth=this._descriptor.compareEnabled=e,this.setSamplingMode(e?9729:9728),Ny(this._descriptor),this._shadowFilterDirty=!0)}applyChanges(){this._samplingModeDirty&&(this._applySamplingMode(),this._samplingModeDirty=!1),this._wrapModeDirty&&(this._applyWrapMode(),this._wrapModeDirty=!1),this._shadowFilterDirty&&(this._applyShadowMode(),this._shadowFilterDirty=!1)}abortCompression(){this._compressionAbortController=Tl(this._compressionAbortController)}_setData(e,r){const i=this._descriptor,s=i.context?.gl;if(!s)return;Pc(s),this.hasWebGLTextureObject||(this._glName=s.createTexture(),i.context.instanceCounter.increment(IF.Texture,this)),Ny(i);const n=i.context.bindTexture(this,cr.TEXTURE_UNIT_FOR_UPDATES);i.context.setActiveTexture(cr.TEXTURE_UNIT_FOR_UPDATES),this._configurePixelStorage(),Pc(s);const o=r??i.target,a=Gd(o);if(EF(e))this._setDataFromTexImageSource(e,o);else{const{width:l,height:c,depth:d}=i;if(l==null||c==null)throw new R("texture:missing-size","Width and height must be specified!");if(a&&d==null)throw new R("texture:missing-depth","Depth must be specified!");if(i.internalFormat=qw(i),i.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(o,i.internalFormat,i.hasMipmap,l,c,d),Mp(e)){if(!Y0e(i.internalFormat))throw new R("texture:format-mismatch","Attempting to use compressed data with an uncompressed format!");this._setDataFromCompressedSource(e,i.internalFormat,o)}else this._texImage(o,0,i.internalFormat,l,c,d,e),Pc(s),i.hasMipmap&&this.generateMipmap()}this._applySamplingMode(),this._applyWrapMode(),this._applyAnisotropicFilteringParameters(),this._applyShadowMode(),Pc(s),i.context.bindTexture(n,cr.TEXTURE_UNIT_FOR_UPDATES)}_setDataCubeMap(e=null){for(let r=34069;r<=34074;r++)this._setData(e,r)}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:r,flipped:i,preMultiplyAlpha:s}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s?1:0)}_setDataFromTexImageSource(e,r){const{gl:i}=this._descriptor.context,s=this._descriptor;s.internalFormat=qw(s);const n=Gd(r),{width:o,height:a,depth:l}=K0e(e);s.width&&s.height,s.width||(s.width=o),s.height||(s.height=a),n&&s.depth,n&&(s.depth=l),s.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(r,s.internalFormat,s.hasMipmap,o,a,l),this._texImage(r,0,s.internalFormat,o,a,l,e),Pc(i),s.hasMipmap&&(this.generateMipmap(),Pc(i))}_setDataFromCompressedSource(e,r,i){const s=this._descriptor,{width:n,height:o,depth:a}=s,l=e.levels,c=CF(i,n,o,a),d=Math.min(c,l.length)-1;this._descriptor.context.gl.texParameteri(s.target,33085,d),this._forEachMipmapLevel((p,m,y,g)=>{const v=l[Math.min(p,l.length-1)];this._compressedTexImage(i,p,r,m,y,g,v)},d)}_texStorage(e,r,i,s,n,o){const{gl:a}=this._descriptor.context;if(!J0e(r)&&!sq(r)&&!nq(r))throw new R("texture:missing-format","Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const l=i?CF(e,s,n,o):1;if(Gd(e)){if(o==null)throw new R("texture:missing-depth","Missing depth dimension for 3D texture upload");a.texStorage3D(e,l,r,s,n,o)}else a.texStorage2D(e,l,r,s,n);this._wasImmutablyAllocated=!0}_texImage(e,r,i,s,n,o,a){const l=this._descriptor.context.gl,c=Gd(e),{isImmutable:d,pixelFormat:p,dataType:m}=this._descriptor;if(d){if(a!=null){const y=a;if(c){if(o==null)throw new R("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texSubImage3D(e,r,0,0,0,s,n,o,p,m,y)}else l.texSubImage2D(e,r,0,0,s,n,p,m,y)}}else{const y=a;if(c){if(o==null)throw new R("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texImage3D(e,r,i,s,n,o,0,p,m,y)}else l.texImage2D(e,r,i,s,n,0,p,m,y)}}_compressedTexImage(e,r,i,s,n,o,a){const l=this._descriptor.context.gl,c=Gd(e);if(this._descriptor.isImmutable){if(a!=null)if(c){if(o==null)throw new R("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexSubImage3D(e,r,0,0,0,s,n,o,i,a)}else l.compressedTexSubImage2D(e,r,0,0,s,n,i,a)}else if(c){if(o==null)throw new R("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexImage3D(e,r,i,s,n,o,0,a)}else l.compressedTexImage2D(e,r,i,s,n,0,a)}async _compressOnWorker(e){const{width:r,height:i,context:s,flipped:n,preMultiplyAlpha:o,hasMipmap:a}=this._descriptor,l=this._descriptor.compress?.compressionTracker,c=this._descriptor.compress?.compressionCallback,{compressedTextureETC:d,compressedTextureS3TC:p}=s.capabilities;if(!cr.compressionWorkerHandle?.isCompressible(e,this._descriptor)||!d&&!p)return;this.abortCompression();const m=new AbortController;let y;this._compressionAbortController=m,l?.increment();try{e instanceof Uint8Array?y=e.buffer:(y=await createImageBitmap(e,{imageOrientation:n?"flipY":"none"}),gt(m));const g={data:y,width:r,height:i,needsFlip:e instanceof Uint8Array&&this.descriptor.flipped,components:this._descriptor.pixelFormat===6408?4:3,preMultiplyAlpha:o,hasMipmap:a,hasETC:!!d,hasS3TC:!!p},v=await cr.compressionWorkerHandle.invoke(g,m.signal,"low");if(gt(m),v.compressedTexture&&this.hasWebGLTextureObject){const w=this.usedMemory;this._descriptor.internalFormat=v.internalFormat,this._setData(v.compressedTexture),c?.(w-this.usedMemory)}}catch(g){Ur(g)||Ia().error("Texture compression failed!")}finally{l?.decrement(),this._compressionAbortController?.signal.aborted&&(this._compressionAbortController=null),y instanceof ImageBitmap&&y.close()}}_forEachMipmapLevel(e,r=1/0){let{width:i,height:s,depth:n,hasMipmap:o,target:a}=this._descriptor;const l=a===32879;if(i==null||s==null||l&&n==null)throw new R("texture:missing-size","Missing texture dimensions for mipmap calculation");for(let c=0;e(c,i,s,n),o&&(i!==1||s!==1||l&&n!==1)&&!(c>=r);++c)i=Math.max(1,i>>1),s=Math.max(1,s>>1),l&&(n=Math.max(1,n>>1))}_applySamplingMode(){const e=this._descriptor,r=e.context?.gl;let i=e.samplingMode,s=e.samplingMode;i===9985||i===9987?(i=9729,e.hasMipmap||(s=9729)):i!==9984&&i!==9986||(i=9728,e.hasMipmap||(s=9728)),r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,i),r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,s)}_applyWrapMode(){const e=this._descriptor,r=e.context?.gl;typeof e.wrapMode=="number"?(r.texParameteri(e.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,e.wrapMode)):(r.texParameteri(e.target,r.TEXTURE_WRAP_S,e.wrapMode.s),r.texParameteri(e.target,r.TEXTURE_WRAP_T,e.wrapMode.t))}_applyShadowMode(){const e=this._descriptor,r=e.context?.gl,i=e.compareEnabled?r.COMPARE_REF_TO_TEXTURE:r.NONE;r.texParameteri(e.target,r.TEXTURE_COMPARE_MODE,i),e.compareEnabled&&r.texParameteri(e.target,r.TEXTURE_COMPARE_FUNC,r.GREATER),Pc(r)}_applyAnisotropicFilteringParameters(){const e=this._descriptor,r=e.context.capabilities.textureFilterAnisotropic;r&&e.context.gl.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}},cr.TEXTURE_UNIT_FOR_UPDATES=0,cr.compressionWorkerHandle=null,cr);const T$=()=>U.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function rve(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const ive=[0,0,0,0];let aq=class{constructor(){this.type="single",this._highlightOptions=new Ju,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*Oy),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,r){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,O0e),r.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<KG)-1,activeGradient:this}]}_updateGradientTexture(e){const r=sve(this._highlightOptions);if(r===this._optionsShadeTexKey)return;this._optionsShadeTexKey=r,rve(this._highlightOptions,this._convertedHighlightOptions);const i=this._convertedHighlightOptions,s=i.outlinePosition-i.outlineWidth/2-i.outerHaloWidth,n=i.outlinePosition-i.outlineWidth/2,o=i.outlinePosition+i.outlineWidth/2,a=i.outlinePosition+i.outlineWidth/2+i.innerHaloWidth,l=Math.sqrt(Math.PI/2)*q0e,c=Math.abs(s)>l?Math.round(10*(Math.abs(s)-l))/10:0,d=Math.abs(a)>l?Math.round(10*(Math.abs(a)-l))/10:0;let p;c&&!d?T$().error("The outer rim of the highlight is "+c+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!c&&d?T$().error("The inner rim of the highlight is "+d+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):c&&d&&T$().error("The highlight is "+Math.max(c,d)+"px away from the edge of the feature; consider reducing some width values.");const m=[void 0,void 0,void 0,void 0];function y(v,w,_){m[0]=(1-_)*v[0]+_*w[0],m[1]=(1-_)*v[1]+_*w[1],m[2]=(1-_)*v[2]+_*w[2],m[3]=(1-_)*v[3]+_*w[3]}const{_texelData:g}=this;for(let v=0;v<Oy;++v)p=s+v/(Oy-1)*(a-s),p<s?(m[0]=0,m[1]=0,m[2]=0,m[3]=0):p<n?y(ive,i.outlineColor,(p-s)/(n-s)):p<o?[m[0],m[1],m[2],m[3]]=i.outlineColor:p<a?y(i.outlineColor,i.fillColor,(p-o)/(a-o)):[m[0],m[1],m[2],m[3]]=i.fillColor,g[4*v]=255*m[0],g[4*v+1]=255*m[1],g[4*v+2]=255*m[2],g[4*v+3]=255*m[3];if(this._minMaxDistance[0]=s,this._minMaxDistance[1]=a,!this._shadeTex){const v=new iq(Oy,1);v.wrapMode=33071,this._shadeTex=new tve(e,v)}this._shadeTex.updateData(0,0,0,Oy,1,this._texelData)}};function sve(t){return`${t.color};${t.haloColor};${t.haloOpacity};${t.fillOpacity};${t.haloWidth};${t.haloBlur}`}let nve=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let r=0;r<e.length;r++)this.gradients[r]||(this.gradients[r]=new aq),this.gradients[r].setHighlightOptions(e[r]);for(let r=e.length+1;r<this.gradients.length;r++)this.gradients[r].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const r=[];for(let i=0;i<this.gradients.length;i++){const s=this.gradients[i];r.push({activeReasons:e,activeGradient:s}),e<<=1}return r}};const lq={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{compare:514,mask:255,op:{fail:7680,zFail:7680,zPass:7681}}}},ove={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},ave={...lq,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function lve({pixelRatio:t,state:e,displayLevel:r,requiredLevel:i},s){const n=1/2**(r-s.key.level),o=1/2**(i-s.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:s.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:s.transforms.tileMat3,displayZoomFactor:n,requiredZoomFactor:o,tileOffset:[s.x,s.y],currentScale:e.scale,currentZoom:r,metersPerSRUnit:Vs(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function uq(t){return t.passOptions?.type==="highlight"}function cq(t){return t.passOptions?.type==="hittest"}function uve(t){if(!cq(t))return null;const{position:e,distance:r,smallSymbolDistance:i,smallSymbolSizeThreshold:s}=t.passOptions;return{position:e,distance:r,smallSymbolDistance:i,smallSymbolSizeThreshold:s}}function cve(t){if(!uq(t))return null;const{activeReasons:e,highlightAll:r}=t.passOptions;return{activeReasons:e,highlightAll:r?1:0}}function P6e(t,e,r){const i={};for(const s in r)typeof r[s]!="function"?i[s]=r[s]:i[s]=r[s](t,e);return i}function k6e(t,e){const{attributeView:r,context:i}=t;return{storage:r.getUniforms(i),view:lve(t,e),hittestRequest:uve(t),highlight:cve(t)}}function L6e(t){return{inside:t.selection===2,outside:t.selection===3}}function hve(t){return cq(t)?ove:uq(t)&&t.passOptions.stepType==="clear"?ave:lq}function A6e(t){const{row:e,col:r}=t.key,i=r*TF,s=e*TF;return{tileOffsetFromLocalOrigin:[i%Gw,s%Gw],maxIntsToLocalOrigin:[Math.floor(i/Gw),Math.floor(s/Gw)]}}const dve=new Ne({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function R6e(t){return dve.toJSON(t)}function O6e(t){const{bandCount:e,attributeTable:r,colormap:i,pixelType:s}=t.raster.rasterInfo;return e===1&&(r!=null||i!=null||s==="u8"||s==="s8")}function pve(t,e){return e==null?(t?.destroy(),null):(t?.type==="single"&&Array.isArray(e)&&(t.destroy(),t=null),t?.type!=="multi"||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new nve:new aq),Array.isArray(e)?t.type==="multi"&&t.setHighlightOptions(e):t.type==="single"&&t.setHighlightOptions(e),t)}function F6e(t,e,r,i){const{painter:s,highlightGradient:n}=t,{highlight:o}=s.effects;if(!n)return;const a=t.passOptions,l=n.getReasonsWithGradients();for(let c=0;c<l.length;c++){const d={...t,passOptions:{type:"highlight",activeGradient:l[c].activeGradient,activeReasons:l[c].activeReasons,stepType:"burn",highlightAll:e}};if(o.bind(d),r(d),c<l.length-1){let m=0;for(let y=c+1;y<l.length;y++)m|=l[y].activeReasons;r({...t,passOptions:{type:"highlight",activeGradient:l[c].activeGradient,activeReasons:m,stepType:"clear",highlightAll:e}})}const p={...t,passOptions:{type:"highlight",activeGradient:l[c].activeGradient,activeReasons:l[c].activeReasons,stepType:"draw",highlightAll:e}};s.setPipelineState(hve(t)),s.updatePipelineState(t.context),o.draw(p),o.unbind()}t.passOptions=a}const Bw=t=>parseFloat(t)/100;function fve(t,e,r){const i=typeof t.left=="string"?Bw(t.left)*e:t.left,s=typeof t.right=="string"?Bw(t.right)*e:t.right,n=typeof t.top=="string"?Bw(t.top)*r:t.top,o=typeof t.bottom=="string"?Bw(t.bottom)*r:t.bottom,a=n;return{xmin:i,xmax:Math.max(e-s,i),ymin:a,ymax:Math.max(r-o,n)}}function hq(t,e,r,i){switch(e.type){case"rect":{const{width:s,height:n}=t,{xmin:o,xmax:a,ymin:l,ymax:c}=fve(e,s,n),{x:d,y:p}=r;return d>o&&d<a&&p>l&&p<c}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||SP(e.path,[r.x,r.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?bP(e.geometry,i):kv(e.geometry,i))}}function mve(t){if(!t.highlights)return null;const e=t.highlights.findIndex(r=>r.name==="default");return e===-1?null:t.highlights.items[e]}function yve(t,e){if(!t.highlights){if(!e)return;t.highlights=new se([new Ju])}const r=t.highlights.findIndex(i=>i.name==="default");e?t.highlights.items[r].assignFrom(e):(t.highlights.removeAt(r),t.highlights.length===0&&(t.highlights=null))}async function gve(t,e,r){const i=H7(e)?B7(t,e):e;if(!t.ready||isNaN(i.x)||isNaN(i.y))return{screenPoint:i,results:[]};let s=new Set;const n=new Set;let o=!1,a=null,l=null;r?.include?kF(r.include,PF(t,m=>{s.add(m),I$(m,y=>n.add(y))},(m,y)=>{n.add(m),s.add(y)},m=>{a||(a=new Set),a.add(m)},m=>s.add(m),()=>o=!0)):(o=!0,s=new Set(t.allLayerViews),s.forEach(m=>{I$(m,y=>n.add(y))})),r?.exclude&&kF(r.exclude,PF(t,m=>{s.delete(m),I$(m,y=>n.delete(y))},m=>n.delete(m),m=>{l||(l=new Set),l.add(m)}));const c=t.toMap(i),d=t.allLayerViews.filter(m=>!m.suspended&&s.has(m)&&m.clips.every(y=>hq(t,y,i,c))).reverse();let p=[...o?t.graphicsView.hitTest(c).map(m=>({type:"graphic",graphic:m,layer:null,mapPoint:c})):[],...await Promise.all(d.map(m=>m.hitTest(c,i)).toArray())].filter(fr).flat().filter(fr);return p=p.filter(m=>m.type!=="graphic"||m.layer?.type!=="subtype-group"||n.has(m.graphic.layer)),a&&(p=p.filter(m=>!("graphic"in m)||!m.graphic||a?.has(D3(m.graphic)))),l&&(p=p.filter(m=>!("graphic"in m)||!m.graphic||!l?.has(D3(m.graphic)))),{screenPoint:i,results:p}}function PF(t,e,r,i,s,n){return o=>{if(o instanceof Rt){if(o.layer===t)n?.();else{const a=t.allLayerViews.find(l=>l.layer===o.layer);a&&s?.(a)}i(D3(o))}else if(!("layer"in o&&"element"in o))if(o.type==="subtype-sublayer"){const a=t.allLayerViews.find(l=>l.layer===o.parent);a&&r(o,a)}else{const a=t.allLayerViews.find(l=>l.layer===o);a&&e(a)}}}function kF(t,e){if(t)if(f1(t))for(const r of t)if(f1(r))for(const i of r)e(i);else e(r);else e(t)}function D3(t){const e=t.getObjectId();return e?`${t.layer?.uid??t.sourceLayer?.uid??"MapView"}/${e}`:`"MapView/${t.uid}`}function I$(t,e){const r=t.layer;r?.type==="subtype-group"&&r.sublayers.forEach(i=>{e(i)})}let Dy=null,hS=!0;function vve(t,e,r){if(!t||!e)throw new Error("Cannot construct image data without dimensions");if(hS)try{return new ImageData(t,e)}catch{hS=!1}return dq(t,e,r)}function N6e(t,e,r,i){if(!e||!r)throw new Error("Cannot construct image data without dimensions");if(hS)try{return new ImageData(t,e,r)}catch{hS=!1}const s=dq(e,r,i);return s.data.set(t,0),s}function wve(){return Dy||(Dy=document.createElement("canvas"),Dy.width=1,Dy.height=1),Dy}function dq(t,e,r){return r||(r=wve()),r.getContext("2d").createImageData(t,e)}async function _ve(t,e){const r=window.URL.createObjectURL(t);try{const{data:i}=await Be(r,{...e,responseType:"image"});return i}catch(i){throw Ur(i)?i:new R("invalid-image",`Could not fetch requested image at ${r}`)}finally{window.URL.revokeObjectURL(r)}}async function bve(t,e){const{arrayBuffer:r,mediaType:i}=await Sve(t,e),s=i==="image/png";if(i==="image/gif"){const{isAnimatedGIF:n,parseGif:o}=await q(()=>import("./gif-Az5T0YBf.js"),[]);if(n(r))return o(r,e)}if(s){const{isAnimatedPNG:n,parseApng:o}=await q(()=>import("./apng-dOeebzRc.js"),__vite__mapDeps([276,25]));if(n(r))return o(r,e)}return _ve(new Blob([r],{type:i}),e)}async function Sve(t,e){const r=cm(t);if(r?.isBase64)return{arrayBuffer:bz(r.data),mediaType:r.mediaType};const i=await Be(t,{responseType:"array-buffer",...e});return{arrayBuffer:i.data,mediaType:i.getHeader?.("Content-Type")??""}}function pq(t,e,r){const{ctx:i,canvas:s}=mq(t,r),n=i.getImageData(0,0,t.width,t.height),o=gq(s,e);return yq(s),{dataUrl:o,data:n}}function fq(t,e){const{ctx:r,canvas:i}=mq(t,e),s=r.getImageData(0,0,t.width,t.height);return yq(i),s}function mq(t,e){const r=xve();e.premultipliedAlpha&&Ive(t),r.width=t.width,r.height=t.height;const i=r.getContext("2d",{willReadFrequently:!0});return i.putImageData(t,0,0),e.flipY&&Tve(i),{ctx:i,canvas:r}}function yq(t){t.width=0,t.height=0}function xve(){return E$==null&&(E$=document.createElement("canvas")),E$}let E$=null;function gq(t,e){const r=Eve[e.format],i=e.quality/100;return t.toDataURL(r,i)}function vq(t,e){const r=Mve(t),i=Pve[r];return{format:r,quality:Qr(e??i,0,100)}}function wq(t,e){return e/Math.max(t[0],t[1])}function $ve(t,e,r,i=0,s=0,n=t.width-i,o=t.height-s,a=!1){const{data:l}=t,{width:c,height:d,data:p}=e,m=n/c,y=o/d,g=Math.ceil(m/2),v=Math.ceil(y/2),w=t.width;for(let _=0;_<d;_++)for(let x=0;x<c;x++){const $=4*(x+(a?d-_-1:_)*c);let T=0,C=0,P=0,A=0,F=0,j=0;const V=(_+.5)*y;for(let Z=Math.floor(_*y);Z<(_+1)*y;Z++){const Y=Math.abs(V-(Z+.5))/v,re=(x+.5)*m,Q=Y*Y;for(let Ee=Math.floor(x*m);Ee<(x+1)*m;Ee++){const et=Math.abs(re-(Ee+.5))/g,lt=Math.sqrt(Q+et*et);if(lt>=1)continue;let Ve=2*lt*lt*lt-3*lt*lt+1;const vr=4*(i+Ee+(s+Z)*w);j+=Ve*l[vr+3],C+=Ve,!r&&l[vr+3]<255&&(Ve=Ve*l[vr+3]/255),P+=Ve*l[vr],A+=Ve*l[vr+1],F+=Ve*l[vr+2],T+=Ve}}p[$]=P/T,p[$+1]=A/T,p[$+2]=F/T,p[$+3]=j/C}return e}function Mve(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return Cve}}function Tve(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function Ive(t){const e=t.data,r=e.length;for(let i=0;i<r;i+=4){const s=e[i+3];if(s!==255&&s>0){const n=255/s;e[i]=e[i]*n,e[i+1]=e[i+1]*n,e[i+2]=e[i+2]*n}}}const Eve={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},LF=98,Cve="png",Pve={png:100,jpg:LF,jpeg:LF},D6e=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:vve,encode:pq,encodeData:fq,getFormatAndQuality:vq,getMaximumResolutionScale:wq,resampleHermite:$ve,toDataUrl:gq},Symbol.toStringTag,{value:"Module"})),_q={flipY:!0,premultipliedAlpha:!0};async function kve(t,e){const r=await bq(t,e),{format:i,quality:s}=vq(e?.format,e?.quality);return pq(r,{format:i,quality:s},_q)}async function Lve(t,e){const r=await bq(t,e);return fq(r,_q)}function bq(t,e){const r=Ove(e||{},Rve(t.stage,t.size),t.size,t.padding),i=Ave(e,t.allLayerViews);return t.stage.takeScreenshot(r,i,t.backgroundColor,e?.rotation)}function Ave(t={},e){if(!t.layers)return;const r=[];return t.layers.forEach(i=>{const s=e.find(n=>n.layer.id===i.id);s?.container&&r.push(s.container)}),r}function Rve(t,e){return Math.min(4,wq(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function Ove(t,e,r,i){t.ignorePadding&&(i={left:0,right:0,top:0,bottom:0});let s=null;t.width!=null&&t.height!=null?s=[t.width,t.height]:t.width==null&&t.height!=null?s=[t.height,t.height]:t.width!=null&&t.height==null?s=[t.width,t.width]:t.width==null&&t.height==null&&(s=null);const n=r[0]-(i.left+i.right),o=r[1]-(i.top+i.bottom);let a,l,c=t.area||{x:0,y:0,width:n,height:o};if(s){const d=n/o,p=s[0]/s[1];if(p>d){const m=c.width/p;c={x:c.x,y:Math.round(c.y+(c.height-m)/2),width:c.width,height:Math.round(m)}}else{const m=c.height*p;c={x:Math.round(c.x+(c.width-m)/2),y:c.y,width:Math.round(m),height:c.height}}}else s=[c.width,c.height];return s[0]>c.width?(a=Math.min(s[0]/c.width,e),l=s[0]/c.width/a):(a=1,l=s[0]/c.width),{cropArea:{x:Math.round((c.x+i.left)*a),y:Math.round((c.y+i.top)*a),width:Math.round(c.width*a),height:Math.round(c.height*a)},outputScale:l,resolutionScale:a}}const Fve=t=>t.includes("Brush");let Sq=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),Fve(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};const AF=Symbol("analyses-owner-handles");let fu=class extends le{constructor(e){super(e),this._allAnalysisViews=new se,this._creatingViewCount=0,this._attachedToViewResolver=RF(),this._items=new Map,this._moduleMap=new Map,this._scheduledUpdateHandle=null,this._emitOnView=(r,i)=>this.view.emit(r,i)}destroy(){this._disconnectOwners(),this._attachedToViewResolver.reject(it("AnalysisViewManager was destroyed")),this._set("view",null)}attach(){this._connectOwners(),this._attachedToViewResolver.resolve()}detach(){this._disconnectOwners(),this._attachedToViewResolver.reject(it()),this._attachedToViewResolver=RF()}get updating(){return!this.view.ready||this._creatingViewCount!==0||this._allAnalysisViews.some(e=>e.updating)}get testInfo(){}async whenAnalysisView(e){await this._attachedToViewResolver.promise;const r=this._items.get(e);if(r==null||r.state.list===1)throw new R("AnalysisViewManager:no-analysis-view-for-analysis","The analysis does not exist in view.analyses",{analysis:e});return r.createAnalysisViewTask.promise}_connectOwners(){this.addHandles(this._connectAnalysesCollection(this.view.analyses),AF)}_disconnectOwners(){this.removeHandles(AF),this._update(),this._creatingViewCount=0}_connectAnalysesCollection(e){for(const s of e)this._addAnalysis(s);const r=e.on("after-add",s=>this._addAnalysis(s.item)),i=e.on("after-remove",s=>this._removeAnalysis(s.item));return je(()=>{r.remove(),i.remove();for(const s of e)this._removeAnalysis(s)})}_addAnalysis(e){const r=this._items.get(e);if(r==null){const i={state:{view:0,list:0},analysis:e,view:null,createAnalysisViewTask:null};this._items.set(e,i),i.createAnalysisViewTask=Pv(s=>this._createAnalysisViewPromise(i,s).then(n=>(this._emitOnView("analysis-view-create",{analysis:e,analysisView:n}),n),n=>{throw this._emitOnView("analysis-view-create-error",{analysis:e,error:n}),n}))}else r.state.list=0}_removeAnalysis(e){const r=this._items.get(e);r!=null?(r.state.list=1,this._scheduleUpdate()):U.getLogger(this).error("Trying to remove analysis which was not added")}_scheduleUpdate(){this._scheduledUpdateHandle==null&&(this._scheduledUpdateHandle=Vm(()=>this._update()))}_update(){this._scheduledUpdateHandle=yt(this._scheduledUpdateHandle),this._items.forEach(e=>{if(e.state.list!==1)return;const{analysis:r,view:i}=e;switch(this._items.delete(r),e.state.view){case 0:e.createAnalysisViewTask=Tl(e.createAnalysisViewTask);break;case 1:i!=null&&(this._allAnalysisViews.remove(i),e.view=xt(i),e.createAnalysisViewTask=null,this._emitOnView("analysis-view-destroy",{analysis:r,analysisView:i}))}})}async _createAnalysisViewPromise(e,r){const{analysis:i}=e;if(this._creatingViewCount+=1,!this._moduleMap.has(i.type))try{this._moduleMap.set(i.type,await this.importAnalysisViewModule(i))}catch{throw this._creatingViewCount-=1,new R("AnalysisViewManager:no-analysis-view-for-analysis",`Analysis of type "${i.type}" is not supported`)}if(xi(r))throw this._creatingViewCount-=1,it("AnalysisView creation aborted");const s=new(this._moduleMap.get(i.type)).default({analysis:i,view:this.view});let n=!0;mn(r,()=>{n&&this._destroyAnalysisView(i,s)});try{await s.when()}catch(o){throw n=!1,this._destroyAnalysisView(i,s),o}if(xi(r))throw it();return n=!1,e.view=s,e.state.view=1,this._allAnalysisViews.add(s),this._creatingViewCount-=1,s}_destroyAnalysisView(e,r){r.destroyed||(this._creatingViewCount-=1,r.destroy(),this._emitOnView("analysis-view-destroy",{analysis:e,analysisView:r}))}};u([h()],fu.prototype,"updating",null),u([h({constructOnly:!0})],fu.prototype,"importAnalysisViewModule",void 0),u([h({constructOnly:!0})],fu.prototype,"view",void 0),u([h()],fu.prototype,"_allAnalysisViews",void 0),u([h()],fu.prototype,"_creatingViewCount",void 0),fu=u([E("esri.views.support.AnalysisViewManager")],fu);const Nve=fu;function RF(){const t=ps();return t.promise.catch(()=>{}),t}let Dve=class{constructor(e){this.getUnmaskedRenderer=e}};function zve(t){const e=t.getExtension("WEBGL_debug_renderer_info");return e?new Dve(()=>t.getParameter(e.UNMASKED_RENDERER_WEBGL)):null}let OF;function jve(){return OF??=Gve(),OF}let Vve=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}};function Uve(t){if(typeof WebGL2RenderingContext>"u")return null;const e=document.createElement("canvas");if(!e)return null;let r=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(r==null&&(r=e.getContext("webgl2"),r!=null&&(t.majorPerformanceCaveat=!0,t.unmaskedRenderer=zve(r)?.getUnmaskedRenderer()??"unknown")),r==null)return r;t.available=!0,t.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const i=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);return i&&(t.supportsHighPrecisionFragment=i.precision>0),r}function Gve(){const t=new Vve,e=Uve(t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null),t}function qve(t){const e=jve();return e.available?t==="3d"&&e.majorPerformanceCaveat?new R("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new R("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new R("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new R("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function Bve(t){return t&&"nodeType"in t}function Hve(t){return t&&typeof t.render=="function"}const FF={component:"esri-component"};let eh=class extends le{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(e){this._set("id",e)}set node(e){const r=this._get("node");e!==r&&(e&&e.classList.add(FF.component),r&&r.classList.remove(FF.component),this._set("node",e))}castNode(e){return this.widget?.destroy(),e?typeof e=="string"||Bve(e)?(this._set("widget",null),sk(e)):(Hve(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};u([h()],eh.prototype,"id",null),u([h()],eh.prototype,"node",null),u([He("node")],eh.prototype,"castNode",null),u([h({readOnly:!0})],eh.prototype,"widget",void 0),eh=u([E("esri.views.ui.Component")],eh);const Tb=eh,Wve=(t,e)=>{let r=t;for(;r;){if(r===e)return!0;if(!r.parentNode)return!1;r.parentNode instanceof ShadowRoot?r=r.parentNode.host:r=r.parentNode}return!1},q6e=(t,e,r)=>{const i=Zve(e).subscribe;return i(s=>{s.some(o=>Wve(t,o.target))&&r()})},C$={},Zve=t=>{const e=t.join(","),r=C$[e];if(r!==void 0)return r;const i=new Set,s=new MutationObserver(o=>i.forEach(a=>a(o)));globalThis.document&&s.observe(document.documentElement,{attributes:!0,attributeFilter:t,subtree:!0});const n={subscribe:o=>(i.add(o),()=>{i.delete(o),i.size===0&&(s.disconnect(),C$[e]=void 0)})};return C$[e]=n,n},xq=(t,e)=>{let r=t;for(;r;){const i=r.closest?.(e);if(i)return i;const s=r.getRootNode?.();if(s===globalThis.document)return;r=s.host}};function Jve(t){const e=xq(t,".calcite-mode-dark, .calcite-mode-light, .calcite-mode-auto");return e?.classList.contains("calcite-mode-dark")||e?.classList.contains("calcite-mode-auto")&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}const B6e=(t,e,r)=>xq(t,`[${e}]`)?.getAttribute(e)??r,Yve="--esri-calcite-mode-name";function Xve(){const t=getComputedStyle(document.body).getPropertyValue(Yve).replaceAll(/\W/g,"").toLowerCase();return t==="dark"||t==="light"?t:void 0}const $q="calcite-mode-";function Mq(t){return Xve()??Jve(t??document.body)}function Tq(t){return Mq(t)==="dark"}function Kve(t){return`${$q}${Mq(t)}`}function Qve(t){const e=Kve(t);ewe(t),t.classList.add(e)}function ewe(t){Array.from(t.classList).forEach(e=>{e.startsWith($q)&&t.classList.remove(e)})}const V2=new Map;function Iq(){V2.clear()}function twe(t){return V2.get(t)}function rwe(t,e){V2.set(t,e)}function P$(t){V2.delete(t)}function af(...t){const e=Di.acquire();for(let i=0;i<t.length;i++){const s=t[i],n=typeof s;if(n==="string")e.push(s);else if(Array.isArray(s))e.push.apply(e,s);else if(n==="object")for(const o in s)s[o]&&e.push(o)}const r=e.join(" ");return Di.release(e),r}(()=>{const t=new Map,e=new ResizeObserver(i=>{Iq();for(const s of i)t.get(s.target)?.(s)}),r=(i,s,n)=>(t.set(i,s),e.observe(i,n),je(()=>{e.unobserve(i),t.delete(i)}));return(i,s,n)=>{let o=null;return md([ie(()=>typeof i=="function"?i():i,a=>{o?.remove(),a&&(o=r(a,s,n))},pi),je(()=>o?.remove())])}})();function U2(t){const e=t?.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function H6e(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function W6e(t){const e="data-node-ref";this[t.getAttribute(e)]=t}function iwe(t){return t==="Enter"||t===" "}async function swe(t,e){await y6($v(e));const r=typeof t=="function"?t():t;r&&("setFocus"in r&&typeof r.setFocus=="function"?await r.setFocus():r instanceof HTMLElement&&r.focus())}const nwe={left:0,top:0,bottom:0,right:0},Eq={bottom:30,top:15,right:15,left:15},Ea="esri-ui",Wi={ui:Ea,corner:`${Ea}-corner`,innerContainer:`${Ea}-inner-container`,manualContainer:`${Ea}-manual-container`,cornerContainer:`${Ea}-corner-container`,topLeft:`${Ea}-top-left`,topRight:`${Ea}-top-right`,bottomLeft:`${Ea}-bottom-left`,bottomRight:`${Ea}-bottom-right`};function owe(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function Hw(t){return t===0?"0":`${t}px`}function k$(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function L$(t,{top:e,bottom:r,left:i,right:s}){t.style.top=e,t.style.bottom=r,t.style.left=i,t.style.right=s}let go=class extends qm{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=hs(),this.view=null,this._applyViewPadding=()=>{const r=this.container;r&&L$(r,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const r=this._innerContainer;r&&L$(r,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([ie(()=>[this.view?.padding,this.container],this._applyViewPadding,ft),ie(()=>this.padding,this._applyUIPadding,ft),ie(()=>[this.container,this._locale],([e,r])=>{e&&e.setAttribute("lang",r)},ft),$P(e=>{this._locale=e})])}destroy(){this.removeAllHandles(),this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear(),this.view=null,this._set("view",null)}set container(e){const r=this._get("container");e!==r&&(e&&(e.classList.add(Wi.ui),Qve(e),this._attachContainers(e)),r&&(r.classList.remove(Wi.ui),L$(r,{top:"",bottom:"",left:"",right:""}),r.textContent=""),this._set("container",e))}get height(){const e=this.view?.height??0;if(e===0)return e;const r=this._getViewPadding(),{top:i,bottom:s}=r;return Math.max(e-i-s,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...Eq,...e}}get width(){const e=this.view?.width??0;if(e===0)return e;const r=this._getViewPadding(),{left:i,right:s}=r;return Math.max(e-i-s,0)}add(e,r){let i,s,n;if(Array.isArray(e))return void e.forEach(a=>this.add(a,r));const o=k$(e);o&&({index:i,position:r,component:e,key:s}=o),r&&typeof r=="object"&&({index:i,key:s,position:r,internal:n}=r),!e||r&&!this._isValidPosition(r)||this._add(e,r,i??this._getNumComponentsAtPosition(r),s,n)}remove(e,r){if(!e)return;if(Array.isArray(e))return e.map(s=>this.remove(s,r));const i=this._find(e);if(i){const s=this._componentMap.get(i);if(!s||s.key!==r)return;const n=this._components.indexOf(i);return i.node.parentNode?.removeChild(i.node),this._componentMap.delete(i),i.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.forEach(a=>{const l=this._componentMap.get(a);l&&l.position===s.position&&l.index>s.index&&l.index--}),this._components.splice(n,1)[0]}}empty(e,r={removeInternal:!1}){if(Array.isArray(e)){for(const n of e)this.empty(n,r);return}const i=this._positionNameToContainerLookup[e??"manual"],s=Array.prototype.slice.call(i.children).map(n=>this._findByNode(n)).filter(n=>n==null?!1:!(this._componentMap.get(n)?.internal??!1)||r.removeInternal);for(const n of s)this.remove(n)}move(e,r){if(Array.isArray(e)&&e.forEach(o=>this.move(o,r)),!e)return;let i;const s=k$(e)||k$(r);if(s&&(i=s.index,r=s.position,e=s.component||e),r&&!this._isValidPosition(r))return;const n=this.remove(e);n&&this.add(n,{position:r,index:i})}find(e){if(!e)return null;const r=this._findById(e);return r&&(r.widget||r.node)}getComponents(e,r={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap(i=>this._getComponentsAtPosition(i,r)):this._getComponentsAtPosition(e,r):this._components.filter(i=>r.includeInternal||!this._componentMap.get(i)?.internal).map(({widget:i,node:s})=>i??s)}getPosition(e){for(const r in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[r].contains(e))return r;return null}_add(e,r,i,s,n){e instanceof Tb||(e=new Tb({node:e}));const{widget:o}=e;o!=null&&o instanceof le&&o.addHandles(je(()=>{queueMicrotask(()=>this.remove(e))}),this._removeWidgetHandleKey);const a=this._positionNameToContainerLookup[r];this._components.some(l=>{const c=this._componentMap.get(l)?.position,d=c?this._positionNameToContainerLookup[c]:null;return a===d&&this._componentMap.get(l)?.index===i})&&this._components.forEach(l=>{const c=this._componentMap.get(l),d=c?.position,p=d?this._positionNameToContainerLookup[d]:null;c&&p===a&&c.index>=i&&c.index++}),this._place({component:e,position:r,index:i}),this._components.push(e),this._componentMap.set(e,{key:s,position:r,internal:n,index:i})}_find(e){return e?e instanceof Tb?this._findByComponent(e):typeof e=="string"?this._findById(e):"domNode"in e?this._findByNode(e.domNode):this._findByNode(e):null}_getViewPadding(){return this.view?.padding??nwe}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Wi.innerContainer,Wi.cornerContainer);const r=document.createElement("div");r.classList.add(Wi.innerContainer,Wi.manualContainer);const i=document.createElement("div");i.classList.add(Wi.topLeft,Wi.corner),e.appendChild(i);const s=document.createElement("div");s.classList.add(Wi.topRight,Wi.corner),e.appendChild(s);const n=document.createElement("div");n.classList.add(Wi.bottomLeft,Wi.corner),e.appendChild(n);const o=document.createElement("div");o.classList.add(Wi.bottomRight,Wi.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=r;const a=U2();this._cornerNameToContainerLookup={"top-left":i,"top-right":s,"bottom-left":n,"bottom-right":o,"top-leading":a?s:i,"top-trailing":a?i:s,"bottom-leading":a?o:n,"bottom-trailing":a?n:o},this._positionNameToContainerLookup={manual:r,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const r=e.position??"manual",{component:i,index:s}=e,n=this._positionNameToContainerLookup[r],o=s!=null&&s>-1;if(owe(i.widget)&&i.widget.startup(),!o)return void n.appendChild(i.node);const a=Array.from(n.children);if(a.length!==0){for(const l of a){const c=this._findByNode(l);if(c&&s<(this._componentMap.get(c)?.index??0))return void l.parentNode?.insertBefore(i.node,l)}n.appendChild(i.node)}else n.appendChild(i.node)}_toPixelPosition(e){return{top:Hw(e.top),left:Hw(e.left),right:Hw(e.right),bottom:Hw(e.bottom)}}_findByComponent(e){return this._components.find(r=>r===e)??null}_findById(e){return this._components.find(({id:r})=>r===e)??null}_findByNode(e){return e?this._components.find(({node:r})=>r===e):null}_getComponentsAtPosition(e,r){const i=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(i.children).map(s=>this._findByNode(s)).filter(fr).filter(s=>r.includeInternal||!this._componentMap.get(s)?.internal).map(({widget:s,node:n})=>s??n)}_getNumComponentsAtPosition(e){return this._positionNameToContainerLookup[e]?.children.length??0}};u([h()],go.prototype,"_locale",void 0),u([h()],go.prototype,"container",null),u([h()],go.prototype,"height",null),u([h({value:Eq})],go.prototype,"padding",null),u([He("padding")],go.prototype,"castPadding",null),u([h()],go.prototype,"view",void 0),u([h()],go.prototype,"width",null),go=u([E("esri.views.ui.UI")],go);const awe=go,lwe={handleInterceptedEvent:(t,e,r,i)=>(t.scheduleRender(),e.properties[`on${i.type}`].apply(e.properties.bind||r,[i]))},uwe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,r)=>{e.startsWith("-")?t.style.setProperty(e,r):t.style[e]=r}},cwe=t=>({...uwe,...t}),hwe=(t,e)=>{const r=[];for(;t&&t!==e;)r.push(t),t=t.parentNode;return r},dwe=(t,e)=>t.find(e),NF=(t,e,r=!1)=>{let i=t;return e.forEach((s,n)=>{const o=i?.children?dwe(i.children,a=>a.domNode===s):void 0;r&&!o&&n!==e.length-1||(i=o)}),i},pwe=t=>{let e;const r={...lwe,...t},i=cwe(r),s=i.performanceLogger;let n,o=!0,a=!1;const l=[],c=[],d=(m,y,g)=>{let v;i.eventHandlerInterceptor=(_,x,$,T)=>function(C){let P;s("domEvent",C);const A=hwe(C.currentTarget,v.domNode),F=A.some(V=>customElements.get(V?.tagName?.toLowerCase()));if(C.eventPhase===Event.CAPTURING_PHASE||!F)A.reverse(),P=NF(v.getLastRender(),A);else{const V=C.composedPath(),Z=V.slice(V.indexOf(C.currentTarget),V.indexOf(v.domNode)).reverse();P=NF(v.getLastRender(),Z,!0)}let j;return P&&(j=r.handleInterceptedEvent(e,P,this,C)),s("domEventProcessed",C),j},r.postProcessProjectionOptions?.(i);const w=g();v=m(y,w,i),i.eventHandlerInterceptor=void 0,l.push(v),c.push(g),r.afterFirstVNodeRendered&&r.afterFirstVNodeRendered(v,w)};let p=()=>{if(n=void 0,o){o=!1,s("renderStart",void 0);for(let m=0;m<l.length;m++){const y=c[m]();s("rendered",void 0);try{l[m].update(y)}catch(g){console.error(g)}s("patched",void 0)}s("renderDone",void 0),o=!0}};return r.modifyDoRenderImplementation&&(p=r.modifyDoRenderImplementation(p,l,c)),e={renderNow:p,scheduleRender:()=>{n||a||(n=requestAnimationFrame(p))},stop:()=>{n&&(cancelAnimationFrame(n),n=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(m,y)=>{d(zu.append,m,y)},insertBefore:(m,y)=>{d(zu.insertBefore,m,y)},merge:(m,y)=>{d(zu.merge,m,y)},replace:(m,y)=>{d(zu.replace,m,y)},detach:m=>{for(let y=0;y<c.length;y++)if(c[y]===m)return c.splice(y,1),l.splice(y,1)[0];throw new Error("renderFunction was not found")}},e},Nt=(t,e,...r)=>{try{return t?.call(e,...r)}catch(i){console.error(i,t)}},z3=async(t,e,...r)=>{try{return await t?.call(e,...r)}catch(i){console.error(i,t)}},Vk=Symbol.for("controller"),fwe=t=>typeof t=="object"&&t!==null&&(Vk in t||"hostConnected"in t||"hostDisconnected"in t||"hostUpdate"in t||"hostUpdated"in t),J6e=t=>typeof t?.then=="function";let Eg;const Cg=t=>{Eg!==t&&(Eg=t,queueMicrotask(()=>Eg===t?Eg=void 0:0))},G2=t=>Eg;let th=[];const mwe=t=>{if(t===void 0){th=[];return}const e=th.indexOf(t);th=e===-1?[...th,t]:th.slice(0,e+1),queueMicrotask(()=>th=[])},ywe=()=>th;let lf;const Y6e=t=>{lf!==t&&(lf=t,queueMicrotask(()=>lf===t?lf=void 0:0))},gwe=()=>{const t=lf;return lf=void 0,t},vwe=async(t,e)=>{const r=Uk(t);if(r===void 0)return t;if(await r.ready,typeof e=="function"){const i=r.watchExports(s=>e(s,i))}return r.exports},wwe=async t=>{const e=Uk(t);return await e.ready,e},Uk=t=>{const r=G2().manager.X(t);if(r!==void 0)return r;if(fwe(t))return t;const i=gwe();if(i!==void 0)return i};let j3=!1;const X6e=t=>{j3=!0;try{return t()}finally{j3=!1}};const Ib=globalThis,Gk=Ib.ShadowRoot&&(Ib.ShadyCSS===void 0||Ib.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,qk=Symbol(),DF=new WeakMap;let Cq=class{constructor(e,r,i){if(this._$cssResult$=!0,i!==qk)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=r}get styleSheet(){let e=this.o;const r=this.t;if(Gk&&e===void 0){const i=r!==void 0&&r.length===1;i&&(e=DF.get(r)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&DF.set(r,e))}return e}toString(){return this.cssText}};const _we=t=>new Cq(typeof t=="string"?t:t+"",void 0,qk),Q6e=(t,...e)=>{const r=t.length===1?t[0]:e.reduce((i,s,n)=>i+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[n+1],t[0]);return new Cq(r,t,qk)},bwe=(t,e)=>{if(Gk)t.adoptedStyleSheets=e.map(r=>r instanceof CSSStyleSheet?r:r.styleSheet);else for(const r of e){const i=document.createElement("style"),s=Ib.litNonce;s!==void 0&&i.setAttribute("nonce",s),i.textContent=r.cssText,t.appendChild(i)}},zF=Gk?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let r="";for(const i of e.cssRules)r+=i.cssText;return _we(r)})(t):t;const{is:Swe,defineProperty:xwe,getOwnPropertyDescriptor:$we,getOwnPropertyNames:Mwe,getOwnPropertySymbols:Twe,getPrototypeOf:Iwe}=Object,q2=globalThis,jF=q2.trustedTypes,Ewe=jF?jF.emptyScript:"",Cwe=q2.reactiveElementPolyfillSupport,S0=(t,e)=>t,V3={toAttribute(t,e){switch(e){case Boolean:t=t?Ewe:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let r=t;switch(e){case Boolean:r=t!==null;break;case Number:r=t===null?null:Number(t);break;case Object:case Array:try{r=JSON.parse(t)}catch{r=null}}return r}},Bk=(t,e)=>!Swe(t,e),VF={attribute:!0,type:String,converter:V3,reflect:!1,useDefault:!1,hasChanged:Bk};Symbol.metadata??=Symbol("metadata"),q2.litPropertyMetadata??=new WeakMap;let Tp=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,r=VF){if(r.state&&(r.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((r=Object.create(r)).wrapped=!0),this.elementProperties.set(e,r),!r.noAccessor){const i=Symbol(),s=this.getPropertyDescriptor(e,i,r);s!==void 0&&xwe(this.prototype,e,s)}}static getPropertyDescriptor(e,r,i){const{get:s,set:n}=$we(this.prototype,e)??{get(){return this[r]},set(o){this[r]=o}};return{get:s,set(o){const a=s?.call(this);n?.call(this,o),this.requestUpdate(e,a,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??VF}static _$Ei(){if(this.hasOwnProperty(S0("elementProperties")))return;const e=Iwe(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(S0("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(S0("properties"))){const r=this.properties,i=[...Mwe(r),...Twe(r)];for(const s of i)this.createProperty(s,r[s])}const e=this[Symbol.metadata];if(e!==null){const r=litPropertyMetadata.get(e);if(r!==void 0)for(const[i,s]of r)this.elementProperties.set(i,s)}this._$Eh=new Map;for(const[r,i]of this.elementProperties){const s=this._$Eu(r,i);s!==void 0&&this._$Eh.set(s,r)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const r=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const s of i)r.unshift(zF(s))}else e!==void 0&&r.push(zF(e));return r}static _$Eu(e,r){const i=r.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,r=this.constructor.elementProperties;for(const i of r.keys())this.hasOwnProperty(i)&&(e.set(i,this[i]),delete this[i]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return bwe(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,r,i){this._$AK(e,i)}_$ET(e,r){const i=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,i);if(s!==void 0&&i.reflect===!0){const n=(i.converter?.toAttribute!==void 0?i.converter:V3).toAttribute(r,i.type);this._$Em=e,n==null?this.removeAttribute(s):this.setAttribute(s,n),this._$Em=null}}_$AK(e,r){const i=this.constructor,s=i._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const n=i.getPropertyOptions(s),o=typeof n.converter=="function"?{fromAttribute:n.converter}:n.converter?.fromAttribute!==void 0?n.converter:V3;this._$Em=s;const a=o.fromAttribute(r,n.type);this[s]=a??this._$Ej?.get(s)??a,this._$Em=null}}requestUpdate(e,r,i,s=!1,n){if(e!==void 0){const o=this.constructor;if(s===!1&&(n=this[e]),i??=o.getPropertyOptions(e),!((i.hasChanged??Bk)(n,r)||i.useDefault&&i.reflect&&n===this._$Ej?.get(e)&&!this.hasAttribute(o._$Eu(e,i))))return;this.C(e,r,i)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,r,{useDefault:i,reflect:s,wrapped:n},o){i&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??r??this[e]),n!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||i||(r=void 0),this._$AL.set(e,r)),s===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(r){Promise.reject(r)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,n]of this._$Ep)this[s]=n;this._$Ep=void 0}const i=this.constructor.elementProperties;if(i.size>0)for(const[s,n]of i){const{wrapped:o}=n,a=this[s];o!==!0||this._$AL.has(s)||a===void 0||this.C(s,void 0,n,a)}}let e=!1;const r=this._$AL;try{e=this.shouldUpdate(r),e?(this.willUpdate(r),this._$EO?.forEach(i=>i.hostUpdate?.()),this.update(r)):this._$EM()}catch(i){throw e=!1,this._$EM(),i}e&&this._$AE(r)}willUpdate(e){}_$AE(e){this._$EO?.forEach(r=>r.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(r=>this._$ET(r,this[r])),this._$EM()}updated(e){}firstUpdated(e){}};Tp.elementStyles=[],Tp.shadowRootOptions={mode:"open"},Tp[S0("elementProperties")]=new Map,Tp[S0("finalized")]=new Map,Cwe?.({ReactiveElement:Tp}),(q2.reactiveElementVersions??=[]).push("2.1.2");const Hk=globalThis,UF=t=>t,dS=Hk.trustedTypes,GF=dS?dS.createPolicy("lit-html",{createHTML:t=>t}):void 0,Pq="$lit$",Lu=`lit$${Math.random().toFixed(9).slice(2)}$`,kq="?"+Lu,Pwe=`<${kq}>`,dd=document,rv=()=>dd.createComment(""),iv=t=>t===null||typeof t!="object"&&typeof t!="function",Wk=Array.isArray,kwe=t=>Wk(t)||typeof t?.[Symbol.iterator]=="function",A$=`[ 	
\f\r]`,zy=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,qF=/-->/g,BF=/>/g,Lc=RegExp(`>|${A$}(?:([^\\s"'>=/]+)(${A$}*=${A$}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),HF=/'/g,WF=/"/g,Lq=/^(?:script|style|textarea|title)$/i,Aq=t=>(e,...r)=>({_$litType$:t,strings:e,values:r}),tje=Aq(1),rje=Aq(2),cc=Symbol.for("lit-noChange"),Qt=Symbol.for("lit-nothing"),ZF=new WeakMap,Fh=dd.createTreeWalker(dd,129);function Rq(t,e){if(!Wk(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return GF!==void 0?GF.createHTML(e):e}const Lwe=(t,e)=>{const r=t.length-1,i=[];let s,n=e===2?"<svg>":e===3?"<math>":"",o=zy;for(let a=0;a<r;a++){const l=t[a];let c,d,p=-1,m=0;for(;m<l.length&&(o.lastIndex=m,d=o.exec(l),d!==null);)m=o.lastIndex,o===zy?d[1]==="!--"?o=qF:d[1]!==void 0?o=BF:d[2]!==void 0?(Lq.test(d[2])&&(s=RegExp("</"+d[2],"g")),o=Lc):d[3]!==void 0&&(o=Lc):o===Lc?d[0]===">"?(o=s??zy,p=-1):d[1]===void 0?p=-2:(p=o.lastIndex-d[2].length,c=d[1],o=d[3]===void 0?Lc:d[3]==='"'?WF:HF):o===WF||o===HF?o=Lc:o===qF||o===BF?o=zy:(o=Lc,s=void 0);const y=o===Lc&&t[a+1].startsWith("/>")?" ":"";n+=o===zy?l+Pwe:p>=0?(i.push(c),l.slice(0,p)+Pq+l.slice(p)+Lu+y):l+Lu+(p===-2?a:y)}return[Rq(t,n+(t[r]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),i]};let U3=class Oq{constructor({strings:e,_$litType$:r},i){let s;this.parts=[];let n=0,o=0;const a=e.length-1,l=this.parts,[c,d]=Lwe(e,r);if(this.el=Oq.createElement(c,i),Fh.currentNode=this.el.content,r===2||r===3){const p=this.el.content.firstChild;p.replaceWith(...p.childNodes)}for(;(s=Fh.nextNode())!==null&&l.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const p of s.getAttributeNames())if(p.endsWith(Pq)){const m=d[o++],y=s.getAttribute(p).split(Lu),g=/([.?@])?(.*)/.exec(m);l.push({type:1,index:n,name:g[2],strings:y,ctor:g[1]==="."?Rwe:g[1]==="?"?Owe:g[1]==="@"?Fwe:H2}),s.removeAttribute(p)}else p.startsWith(Lu)&&(l.push({type:6,index:n}),s.removeAttribute(p));if(Lq.test(s.tagName)){const p=s.textContent.split(Lu),m=p.length-1;if(m>0){s.textContent=dS?dS.emptyScript:"";for(let y=0;y<m;y++)s.append(p[y],rv()),Fh.nextNode(),l.push({type:2,index:++n});s.append(p[m],rv())}}}else if(s.nodeType===8)if(s.data===kq)l.push({type:2,index:n});else{let p=-1;for(;(p=s.data.indexOf(Lu,p+1))!==-1;)l.push({type:7,index:n}),p+=Lu.length-1}n++}}static createElement(e,r){const i=dd.createElement("template");return i.innerHTML=e,i}};function Em(t,e,r=t,i){if(e===cc)return e;let s=i!==void 0?r._$Co?.[i]:r._$Cl;const n=iv(e)?void 0:e._$litDirective$;return s?.constructor!==n&&(s?._$AO?.(!1),n===void 0?s=void 0:(s=new n(t),s._$AT(t,r,i)),i!==void 0?(r._$Co??=[])[i]=s:r._$Cl=s),s!==void 0&&(e=Em(t,s._$AS(t,e.values),s,i)),e}let Awe=class{constructor(e,r){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=r}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:r},parts:i}=this._$AD,s=(e?.creationScope??dd).importNode(r,!0);Fh.currentNode=s;let n=Fh.nextNode(),o=0,a=0,l=i[0];for(;l!==void 0;){if(o===l.index){let c;l.type===2?c=new B2(n,n.nextSibling,this,e):l.type===1?c=new l.ctor(n,l.name,l.strings,this,e):l.type===6&&(c=new Nwe(n,this,e)),this._$AV.push(c),l=i[++a]}o!==l?.index&&(n=Fh.nextNode(),o++)}return Fh.currentNode=dd,s}p(e){let r=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,r),r+=i.strings.length-2):i._$AI(e[r])),r++}},B2=class Fq{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,r,i,s){this.type=2,this._$AH=Qt,this._$AN=void 0,this._$AA=e,this._$AB=r,this._$AM=i,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const r=this._$AM;return r!==void 0&&e?.nodeType===11&&(e=r.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,r=this){e=Em(this,e,r),iv(e)?e===Qt||e==null||e===""?(this._$AH!==Qt&&this._$AR(),this._$AH=Qt):e!==this._$AH&&e!==cc&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):kwe(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Qt&&iv(this._$AH)?this._$AA.nextSibling.data=e:this.T(dd.createTextNode(e)),this._$AH=e}$(e){const{values:r,_$litType$:i}=e,s=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=U3.createElement(Rq(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===s)this._$AH.p(r);else{const n=new Awe(s,this),o=n.u(this.options);n.p(r),this.T(o),this._$AH=n}}_$AC(e){let r=ZF.get(e.strings);return r===void 0&&ZF.set(e.strings,r=new U3(e)),r}k(e){Wk(this._$AH)||(this._$AH=[],this._$AR());const r=this._$AH;let i,s=0;for(const n of e)s===r.length?r.push(i=new Fq(this.O(rv()),this.O(rv()),this,this.options)):i=r[s],i._$AI(n),s++;s<r.length&&(this._$AR(i&&i._$AB.nextSibling,s),r.length=s)}_$AR(e=this._$AA.nextSibling,r){for(this._$AP?.(!1,!0,r);e!==this._$AB;){const i=UF(e).nextSibling;UF(e).remove(),e=i}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},H2=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,r,i,s,n){this.type=1,this._$AH=Qt,this._$AN=void 0,this.element=e,this.name=r,this._$AM=s,this.options=n,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=Qt}_$AI(e,r=this,i,s){const n=this.strings;let o=!1;if(n===void 0)e=Em(this,e,r,0),o=!iv(e)||e!==this._$AH&&e!==cc,o&&(this._$AH=e);else{const a=e;let l,c;for(e=n[0],l=0;l<n.length-1;l++)c=Em(this,a[i+l],r,l),c===cc&&(c=this._$AH[l]),o||=!iv(c)||c!==this._$AH[l],c===Qt?e=Qt:e!==Qt&&(e+=(c??"")+n[l+1]),this._$AH[l]=c}o&&!s&&this.j(e)}j(e){e===Qt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},Rwe=class extends H2{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Qt?void 0:e}},Owe=class extends H2{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Qt)}},Fwe=class extends H2{constructor(e,r,i,s,n){super(e,r,i,s,n),this.type=5}_$AI(e,r=this){if((e=Em(this,e,r,0)??Qt)===cc)return;const i=this._$AH,s=e===Qt&&i!==Qt||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,n=e!==Qt&&(i===Qt||s);s&&this.element.removeEventListener(this.name,this,i),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},Nwe=class{constructor(e,r,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=r,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){Em(this,e)}};const uje={I:B2},Dwe=Hk.litHtmlPolyfillSupport;Dwe?.(U3,B2),(Hk.litHtmlVersions??=[]).push("3.3.2");const zwe=(t,e,r)=>{const i=r?.renderBefore??e;let s=i._$litPart$;if(s===void 0){const n=r?.renderBefore??null;i._$litPart$=s=new B2(e.insertBefore(rv(),n),n,void 0,r??{})}return s._$AI(t),s};const Zk=globalThis;let Lf=class extends Tp{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=zwe(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return cc}};Lf._$litElement$=!0,Lf.finalized=!0,Zk.litElementHydrateSupport?.({LitElement:Lf});const jwe=Zk.litElementPolyfillSupport;jwe?.({LitElement:Lf});(Zk.litElementVersions??=[]).push("4.2.2");class sv{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}const Vwe=(t,e)=>{const r=e/Uwe;let i=0;const s=setInterval(()=>{i+=r,i>=e&&(clearInterval(s),t())},r);return s},Uwe=4,Gwe=(t,e,r)=>{const i=Object.keys(t),s=i.length;uf===void 0&&queueMicrotask(W2),uf??=new Map;let n=uf.get(t);return n===void 0&&(n={callbacks:[],keyCount:s},uf.set(t,n)),n.keyCount!==s&&(n.callbacks.forEach(o=>o(i)),n.callbacks=[],n.keyCount=s),n.callbacks.push(o=>{const a=c=>Nt(e,null,c),l=o[s];l===void 0?a(void 0):t[l]===r?a(l):a(void 0)}),r};let uf;const W2=()=>{uf?.forEach(({callbacks:t},e)=>{const r=Object.keys(e);t.forEach(i=>i(r))}),uf=void 0},qwe=(t,e,r)=>{const i=t.manager;return i.V!==Qt&&i.V!==r&&i.S(void 0,void 0),i.T.length===0&&queueMicrotask(()=>i.S(void 0,void 0)),i.V=r,i.T.push((s,n)=>Nt(e,void 0,r===n?s:void 0)),r},Bwe=(t=[G2(),...ywe()],e,r)=>{const i=Array.isArray(t)?t:[t];let s=i.length+1;const n=o=>{s-=1,o!==void 0&&(s=Math.min(s,0)),s===0&&e(o)};i.forEach(o=>Gwe(o,a=>n(a===void 0?void 0:{key:a,host:o,isReactive:!1}),r));for(const o of i)if("manager"in o&&o.manager.component===o){qwe(o,a=>n(a===void 0?void 0:{key:a,host:o,isReactive:!0}),r);break}return r},Hwe=(t="",e={},r=G2())=>{const i={emit:s=>{t===""&&W2();const n=new CustomEvent(t,{detail:s,cancelable:!0,bubbles:!0,composed:!0,...e});return r.el.dispatchEvent(n),n}};return t===""&&Bwe(void 0,s=>t=s.key,i),i},hje=Hwe.bind(null,"");var Nq;Nq=Vk;class Wwe{constructor(e){this.#r=[],this.#e=[],this.#i=[],this.#l=[],this.#u=[],this.#c=[],this.#h=[],this.#d=[],this.#o=[],this.#a=!1,this.P=new sv,this.connectedCalled=!1,this.loadedCalled=!1,this[Nq]=!0,this.#n=[];const r=this,i=e??G2();r.#t=i,r.ready=r.P.promise,r.#s=YF(r),r.component=i,r.#t.addController(r),r.#t.manager===void 0||(mwe(r),queueMicrotask(()=>r.catchUpLifecycle()))}#r;#e;#i;#l;#u;#c;#h;#d;#o;#a;#t;catchUpLifecycle(){const{manager:e}=this.#t;e.connectedCalled&&!this.connectedCalled&&this.triggerConnected(),e.#a&&this.triggerLoad().then(()=>e.loadedCalled&&this.triggerLoaded()).catch(console.error)}#s;get exports(){return this.#s}set exports(e){const r=this.#s;r!==e&&(this.#s=e,this.#n.forEach(Nt),this.connectedCalled&&this.O!==!1&&this.#t.requestUpdate(this.O,r)),this.P.resolve(e)}setProvisionalExports(e,r=!0){this.#s=r?YF(e):e,this.#n.forEach(Nt)}#n;watchExports(e){const r=()=>e(this.#s);return this.#n.push(r),()=>{this.#n.splice(this.#n.indexOf(r),1)}}get use(){return Cg(this.#t),vwe}get useRef(){return Cg(this.#t),wwe}get useRefSync(){return Cg(this.#t),Uk}controllerRemoved(){this.#t.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(e){this.#r.push(e)}onDisconnected(e){this.#e.push(e)}onLoad(e){this.#i.push(e)}onLoaded(e){this.#l.push(e)}onUpdate(e){this.#u.push(e)}onUpdated(e){this.#c.push(e)}onDestroy(e){this.#h.push(e)}onLifecycle(e){this.#d.push(e),this.connectedCalled&&this.#t.el.isConnected&&this.#p(e)}triggerConnected(){const e=this;e.hostConnected&&Nt(e.hostConnected,e),e.#r.forEach(Nt),e.triggerLifecycle(),e.connectedCalled=!0}triggerDisconnected(){const e=this;e.hostDisconnected&&Nt(e.hostDisconnected,e),e.#e.forEach(Nt),e.#o.forEach(Nt),e.#o=[]}async triggerLoad(){if(this.#a)return;this.#a=!0;const e=this;e.hostLoad&&await z3(e.hostLoad,e),this.#i.length>0&&await Promise.allSettled(this.#i.map(z3)),this.P.resolve(this.#s)}triggerLoaded(){this.loadedCalled||(this.hostLoaded&&Nt(this.hostLoaded,this),this.#l.forEach(Nt),this.loadedCalled=!0)}triggerUpdate(e){this.hostUpdate&&Nt(this.hostUpdate,this,e),this.#u.forEach(JF,e)}triggerUpdated(e){this.hostUpdated&&Nt(this.hostUpdated,this,e),this.#c.forEach(JF,e)}triggerDestroy(){this.hostDestroy&&Nt(this.hostDestroy,this),this.#h.forEach(Nt)}triggerLifecycle(){this.hostLifecycle&&this.#p(()=>this.hostLifecycle()),this.#d.forEach(this.#p,this)}#p(e){Cg(this.#t);const r=Nt(e);(Array.isArray(r)?r:[r]).forEach(s=>{typeof s=="function"?this.#o.push(s):typeof s=="object"&&typeof s.remove=="function"&&this.#o.push(s.remove)})}}function JF(t){Nt(t,void 0,this)}const Zwe=Wwe,YF=t=>{if(typeof t!="object"&&typeof t!="function"||t===null)return t;const e={get(i,s,n){if(!((s==="exports"||s==="_exports")&&s in i&&i[s]===r)&&(s in i||s in Promise.prototype||typeof s=="symbol"))return typeof i=="function"?i[s]:Reflect.get(i,s,n)}},r=new Proxy(t,e);return r},Jwe=t=>t.replace(Ywe,(e,r)=>`${r===0?"":"-"}${e.toLowerCase()}`),Ywe=/[A-Z]+(?![a-z])|[A-Z]/gu,Xwe=1,Kwe=2,Qwe=4,e_e=8,t_e=16,r_e=32,i_e=64,Dq=t=>{let e=t;for(;e=e.parentNode??e.host;)if(e?.constructor?.lumina){const r=e;return r.manager?.loadedCalled||(r.J??r._offspring).push(t),(r.I??r._postLoad).promise}return!1},XF={};function zq(){}const Eb=Object.defineProperty,s_e=globalThis.HTMLElement??zq;var is,fl,em,wv,G3;const tA=class tA extends s_e{constructor(){var s;super();wn(this,wv);wn(this,is);wn(this,fl);wn(this,em);_n(this,fl,{}),_n(this,em,[]),this.I=new sv,this.H=new sv,this.J=[];const r=this,i=r.constructor;r._offspring=r.J,r._postLoad=r.I,i.C?.forEach(n=>{Object.hasOwn(r,n)&&(nt(r,fl)[n]=r[n],delete r[n])}),i.A?fy(s=r,wv,G3).call(s,{a:i.A}):i.B.then(async n=>{var o;await i.K.p,fy(o=r,wv,G3).call(o,await(n.default?.then(a=>typeof a=="function"?{a}:a)??n))}).catch(n=>{r.H.reject(n),setTimeout(()=>{throw n})})}static F(){for(const r of this.C??[])Eb(this.prototype,r,{configurable:!0,enumerable:!0,get(){return nt(this,fl)[r]},set(i){nt(this,fl)[r]=i}});for(const r of this.E??[])Eb(this.prototype,r,{async value(...i){return nt(this,is)||await this.H.promise,await nt(this,is)[r](...i)},configurable:!0});for(const r of this.D??[])Eb(this.prototype,r,{value(...i){return nt(this,is)[r](...i)},configurable:!0})}get manager(){return nt(this,is)?.manager}attributeChangedCallback(r,i,s){nt(this,is)?.attributeChangedCallback(r,i,s),nt(this,is)||nt(this,em).push(r)}connectedCallback(){nt(this,is)?nt(this,is).connectedCallback?.():queueMicrotask(()=>this.G=Dq(this))}disconnectedCallback(){nt(this,is)?.disconnectedCallback?.()}async componentOnReady(){return await this.H.promise,this}addController(){}requestUpdate(){nt(this,is)?.requestUpdate()}};is=new WeakMap,fl=new WeakMap,em=new WeakMap,wv=new WeakSet,G3=function(r){const i=this.constructor,s=i.L,n=nt(this,fl),o=Object.values(r).find(m=>m.L===s),a=`${s}--lazy`;let l=o;for(;l&&!Object.hasOwn(l,"lumina");)l=Object.getPrototypeOf(l);o_e(l),!i.A&&(i.A=o,customElements.define(a,o)),o.N=this;const d=document.createElement(a);o.N=void 0,_n(this,is,d),_n(this,fl,d),nt(this,em).forEach(m=>d.attributeChangedCallback(m,null,this.getAttribute(m))),Object.entries(n).forEach(n_e,d);const p=this.isConnected;(p||this.G)&&(d.connectedCallback?.(),p||d.disconnectedCallback())},tA.lumina=!0;let KF=tA;function n_e([t,e]){this[t]=e}const o_e=t=>{const e=t.prototype,r=Element.prototype;Object.hasOwn(e,"isConnected")||(e.setAttribute=function(s,n){r.setAttribute.call(this.el,s,n)},e.removeAttribute=function(s){r.removeAttribute.call(this.el,s)},Eb(e,"isConnected",{get(){return Reflect.get(r,"isConnected",this.el)}}))};const jq={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},Vq=t=>(...e)=>({_$litDirective$:t,values:e});let Uq=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,r,i){this._$Ct=e,this._$AM=r,this._$Ci=i}_$AS(e,r){return this.update(e,r)}update(e,r){return this.render(...r)}};const a_e=Vq(class extends Uq{constructor(t){if(super(t),t.type!==jq.ATTRIBUTE||t.name!=="class"||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter(e=>t[e]).join(" ")+" "}update(t,[e]){if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(i=>i!=="")));for(const i in e)e[i]&&!this.nt?.has(i)&&this.st.add(i);return this.render(e)}const r=t.element.classList;for(const i of this.st)i in e||(r.remove(i),this.st.delete(i));for(const i in e){const s=!!e[i];s===this.st.has(i)||this.nt?.has(i)||(s?(r.add(i),this.st.add(i)):(r.remove(i),this.st.delete(i)))}return cc}});const Gq="important",l_e=" !"+Gq,u_e=Vq(class extends Uq{constructor(t){if(super(t),t.type!==jq.ATTRIBUTE||t.name!=="style"||t.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce((e,r)=>{const i=t[r];return i==null?e:e+`${r=r.includes("-")?r:r.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${i};`},"")}update(t,[e]){const{style:r}=t.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(e)),this.render(e);for(const i of this.ft)e[i]==null&&(this.ft.delete(i),i.includes("-")?r.removeProperty(i):r[i]=null);for(const i in e){const s=e[i];if(s!=null){this.ft.add(i);const n=typeof s=="string"&&s.endsWith(l_e);i.includes("-")||n?r.setProperty(i,n?s.slice(0,-11):s,n?Gq:""):r[i]=s}}return cc}});class c_e extends Zwe{constructor(e){super(e),this.destroyed=!1,this.R=!1,this.V=Qt,this.T=[],this.#i=new WeakMap,this.#e=e,this.exports=void 0,this.hasDestroy=q3 in e&&typeof e.destroy=="function",Lf.prototype.addController.call(e,{hostConnected:()=>{if(this.destroyed){const r=e.el.localName;throw e.el.remove(),new Error(`The ${r} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${q3} prop.`)}this.#r!==void 0&&clearTimeout(this.#r),W2();for(const r of e.M)"triggerConnected"in r?r.triggerConnected():Nt(r.hostConnected,r)},hostDisconnected:()=>{for(const r of e.M)"triggerDisconnected"in r?r.triggerDisconnected():Nt(r.hostDisconnected,r);this.hasDestroy&&!this.destroyed&&this.U()},hostUpdate:()=>{for(const r of e.M)"triggerUpdate"in r?r.triggerUpdate(this.Q):Nt(r.hostUpdate,r,this.Q)},hostUpdated:()=>{for(const r of e.M)"triggerUpdated"in r?r.triggerUpdated(this.Q):Nt(r.hostUpdated,r,this.Q);this.Q=void 0}}),queueMicrotask(()=>this.R=!0),Cg(e)}#r;#e;async destroy(){if(!this.destroyed){this.#e.el.isConnected&&(this.hasDestroy=!1,this.#e.el.remove()),this.#r=void 0,this.destroyed=!0;for(const e of this.#e.M)"triggerDestroy"in e?e.triggerDestroy():Nt(e.hostDestroy,e);this.#e.M.splice(0)}}U(){if(this.#r!==void 0&&clearTimeout(this.#r),!this.#e.el.isConnected&&!this.#e.autoDestroyDisabled){const e=()=>{this.#e.destroy()};this.#r=Vwe(e,h_e)}}S(e,r){const i=this.T;this.V=Qt,this.T=[],i.forEach(s=>s(e,r))}#i;W(e,r){(typeof r=="object"&&r!==null||typeof r=="function")&&this.#i.set(r,e)}X(e){if(typeof e=="object"&&e!==null||typeof e=="function")return this.#i.get(e)}}let h_e=1e3;const q3="autoDestroyDisabled";var zh,_v,bv,jh,Co,Am,qq,Bq;const k0=class k0 extends Lf{constructor(){super();wn(this,Am);wn(this,zh);wn(this,_v);wn(this,bv);wn(this,jh);wn(this,Co);this.M=[],this.manager=new c_e(this);const r=this,i=r.constructor,s=i.N,n=i.K.o,o=k0.prototype.shouldUpdate;_n(r,jh,s?.H??new sv),r.I=s?.I??new sv,r.J=s?.J??[],r._offspring=r.J,r._postLoad=r.I,r.el=s??r,_n(r,bv,r.enableUpdating),r.enableUpdating=zq,r.shouldUpdate!==o&&(_n(r,_v,r.shouldUpdate),r.shouldUpdate=o),n&&(_n(r,zh,new Map),i.elementProperties.forEach((a,l)=>nt(r,zh).set(l,n())))}static finalizeStyles(r){const i=super.finalizeStyles(r),s=this.shadowRootOptions===XF;return this.K?.commonStyles===void 0||s?i:[this.K.commonStyles,...i]}static createProperty(r,i){const s=typeof i=="number"?i:Array.isArray(i)?i[0]:0,n=Array.isArray(i)?i[1]:void 0,o=n?.hasChanged??Bk,a={attribute:s&Xwe&&typeof r=="string"?Jwe(r):!1,reflect:!!(s&Kwe),type:s&Qwe?Boolean:s&e_e?Number:void 0,state:!!(s&t_e),readOnly:!!(s&r_e),noAccessor:!!(s&i_e),c:!1,...n,hasChanged(l,c){const d=o(l,c);return a.c=d,d}};super.createProperty(r,a)}static getPropertyDescriptor(r,i,s){const n=this.K,o=super.getPropertyDescriptor(r,i,s);return s.d=o,{...o,get(){return n.t?.(nt(this,zh).get(r)),o.get?.call(this)},set(a){const l=this.manager;if(s.readOnly&&!j3&&(l.R||l.connectedCalled))throw Error(`Cannot assign to read-only property "${r}" of ${this.el.localName}. Trying to assign "${a}"`);o.set.call(this,a??void 0),s.c&&nt(this,zh)?.get(r)?.notify(),l.T.length>0&&(W2(),l?.S(r,a))}}}connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const r=this.constructor.K.c?.(()=>this.requestUpdate());_n(this,Co,r);const i=!this.manager.connectedCalled;super.connectedCallback(),i?queueMicrotask(()=>fy(this,Am,Bq).call(this).catch(s=>{nt(this,jh).reject(s),setTimeout(()=>{throw s})})):r&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),nt(this,Co)?.destroy(),_n(this,Co,void 0)}createRenderRoot(){const r=this.el.shadowRoot,i=this.constructor,s=i.shadowRootOptions,o=r??(s===XF?this.el:this.el.attachShadow(s));if(this.isConnected){const a=o.getRootNode();a.adoptedStyleSheets=[...a.adoptedStyleSheets,...i.elementStyles.map(l=>"styleSheet"in l?l.styleSheet:l)]}return o}shouldUpdate(r){var i;return this.manager.Q=r,((i=nt(this,_v))==null?void 0:i.call(this,r))??!0}update(r){nt(this,Co)?fy(this,Am,qq).call(this,r):super.update(r)}listen(r,i,s){const n=i?.bind(this)??i;this.manager.onLifecycle(()=>(this.el.addEventListener(r,n,s),()=>this.el.removeEventListener(r,n,s)))}listenOn(r,i,s,n){const o=s?.bind(this)??s;this.manager.onLifecycle(()=>(r.addEventListener(i,o,n),()=>r.removeEventListener(i,o,n)))}async componentOnReady(){return await nt(this,jh).promise,this}addController(r){this.M.push(r),!(Vk in r)&&this.renderRoot&&this.el.isConnected&&r.hostConnected?.()}removeController(r){this.M.splice(this.M.indexOf(r),1),r.controllerRemoved?.()}};zh=new WeakMap,_v=new WeakMap,bv=new WeakMap,jh=new WeakMap,Co=new WeakMap,Am=new WeakSet,qq=function(r){try{nt(this,Co).clear(),this.constructor.K.r(nt(this,Co),()=>cA(k0.prototype,this,"update").call(this,r))}catch(i){throw nt(this,Co).clear(),i}},Bq=async function(){const r=this.el.G??Dq(this.el);r&&await r;const i=[];for(const n of this.M)"triggerLoad"in n?i.push(n.triggerLoad()):i.push(z3(n.hostLoad,n));await Promise.all(i),await this.load?.(),this.manager.hasDestroy&&this.manager.onUpdate(n=>n.has(q3)&&this.manager.U()),nt(this,bv).call(this,!0),this.performUpdate(),this.I.resolve(),await Promise.resolve();const s=this.J.filter(n=>!n.manager?.loadedCalled);s.length&&await Promise.allSettled(s.map(async n=>await n.componentOnReady())),this.J.length=0,this.el.setAttribute(this.constructor.K.hydratedAttribute,"");for(const n of this.M)"triggerLoaded"in n?n.triggerLoaded():Nt(n.hostLoaded,n);this.loaded?.(),nt(this,jh).resolve()},k0.lumina=!0;let QF=k0;const d_e=t=>{let e;const r=s=>{e=new URL(s,globalThis.location?.href||void 0).href},i={...t,getAssetPath(s){const n=new URL(s,e);return n.origin!==globalThis.location?.origin?n.href:n.pathname},setAssetPath:r,customElement(s,n){n.K=i,n.L=s,customElements.get(s)||customElements.define(s,n)}};return r(t.defaultAssetPath),i},pje=t=>typeof t=="object"&&t!=null?a_e(t):t,fje=t=>typeof t=="object"&&t!=null?u_e(t):t,mje=Qt;function yje(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}const gje={toAttribute:t=>t===!0?"":t===!1?null:t},p_e="calcite-mode-auto",f_e="calcite-mode-dark",vje={rtl:"calcite--rtl"},wje={filter:250,nextTick:0,resize:150,reposition:100},_je=10,bje=25;function eN(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,r=()=>t.contains(f_e)||t.contains(p_e)&&e?"dark":"light",i=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),s=o=>{n!==o&&i(o),n=o};let n=r();i(n),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>s(o.matches?"dark":"light")),new MutationObserver(()=>s(r())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const x0=globalThis.calciteConfig,Sje=x0?.focusTrapStack||[],xje=x0?.logLevel||"info",tN="3.3.3",m_e="2025-10-08",y_e="7391af08e";function g_e(){if(x0&&x0.version)return;console.info(`Using Calcite Components ${tN} [Date: ${m_e}, Revision: ${y_e}]`);const t=x0||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:tN,writable:!1}),globalThis.calciteConfig=t}document.readyState==="interactive"?eN():document.addEventListener("DOMContentLoaded",eN,{once:!0});queueMicrotask(g_e);const v_e=d_e({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.3.3/",hydratedAttribute:"calcite-hydrated"}),{customElement:$je,getAssetPath:Mje,setAssetPath:w_e}=v_e;let Hq=!1;const __e=t=>{Hq=!0,w_e(t)};let Wq;function b_e(){Hq||__e(an(St(Wq)))}function xd(t){const e=[];for(const r of Object.keys(t))customElements.get(`calcite-${r}`)||e.push(t[r]?.());return e.length>0?Promise.all(e):null}Wq="components/assets";const Zq=Symbol("widget"),Jq=Symbol("widget-test-data"),S_e=[],x_e={},pS=new WeakMap;function Yq(t,e){let r=e.children;if(r?.length)for(let s=0;s<r.length;++s)r[s]=Yq(t,r[s]);else r=S_e;const i=e.vnodeSelector;if(fS(i)){const s=e.properties||x_e,n=s.key||i,o={key:n,afterCreate:$_e,afterUpdate:M_e,afterRemoved:Xq,parentWidget:t,widgetConstructor:i,widgetProperties:{...s,key:n,children:r}};return{vnodeSelector:i.vnodeSelector,properties:o,children:void 0,text:void 0,domNode:null}}return e}function $_e(t,e,r,{parentWidget:i,widgetConstructor:s,widgetProperties:n}){const o=new s(n);o.container=t,pS.set(t,o),o.afterCreate?.(o,t),i.addHandles(je(()=>Xq(t))),queueMicrotask(()=>{o[Jq].projector?.renderNow()})}function M_e(t,e,r,{widgetProperties:i}){const s=pS.get(t);s&&(s.set(i),s.afterUpdate?.(s,t))}function Xq(t){const e=pS.get(t);e&&(e.afterRemoved?.(e,t),e.destroy(),pS.delete(t))}function fS(t){return typeof t=="function"&&t[Zq]}const rN=new Set;function T_e(t){rN.add(t),t.finally(()=>rN.delete(t))}function I_e(t){return je()}var iN;let E_e=0;function Kq(t,e){const r=Object.prototype.hasOwnProperty;for(const i in e)r.call(e,i)&&r.call(t,i)&&(t[i]!=null&&e[i]!=null&&typeof t[i]=="object"&&typeof e[i]=="object"?Kq(t[i],e[i]):t[i]=e[i]);return t}const C_e=pwe({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,r=/capture$/i;t.eventHandlerInterceptor=(i,s,n,o)=>{const a=e?.(i,s,n,o),l=r.test(i);if(!((i=i.replace(r,"")).toLowerCase()in n)||l){const c=i[2].toLowerCase()+i.slice(3),d=y=>a?.call(n,y);n.addEventListener(c,d,l);const p=()=>n.removeEventListener(c,d,l),m=o.afterRemoved;o.afterRemoved=y=>{m?.(y),p()}}return a}},handleInterceptedEvent(t,e,r,i){const{eventPhase:s,type:n}=i,o=s===Event.CAPTURING_PHASE;let a=`on${n}${o?"capture":""}`;const l=e.properties;(l&&a in l||(a=`on${n[0].toUpperCase()}${n.slice(1)}${o?"Capture":""}`,l&&a in l))&&(Iq(),t.scheduleRender(),l[a].call(l.bind||r,i))}});let R$=!1;var Qh;let Or=(Qh=class extends hP(qm){constructor(e,r){super(e,r),this._attached=!1,this._projector=C_e,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=qS(async()=>{if(this._messageBundleProps?.length){const l=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:c,propertyName:d})=>{if(this.destroyed)return;let p=await Tj(c);this.destroyed||(this.uiStrings&&Object.keys(this.uiStrings)&&(p=Kq(O(p),this.uiStrings)),this[d]=p)}));if(this.destroyed)return;for(const c of l)c.status==="rejected"&&U.getLogger(this).error("widget-intl:locale-error",this.declaredClass,c.reason)}await this.loadLocale()}),this.addHandles(I_e()),b_e();const i="esri-widget-uid-"+Xm(),s=this.render.bind(this);this._trackingTarget=new JS(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const n=()=>({vnodeSelector:"div",properties:{key:`${i}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),o=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const l=s()??n(),c=l.properties??={};if(c.key??=i,fS(l.vnodeSelector)){if(!this.visible)return n()}else this.visible?c.styles||(c.styles={}):(c.class="",c.styles={display:"none"}),c.styles.display??="";let d=0;return l.children?.forEach(p=>{fS(p.vnodeSelector)||(p.properties??={},p.properties.key??=`${this.id}--${d++}`)}),Yq(this,l)};this.render=()=>{if(R$)return o();let l=twe(this)??null;if(l)return l;this._trackingTarget.clear(),R$=!0;try{l=Cl(this._trackingTarget,o)}catch(c){throw U.getLogger(this).error(c),c}finally{R$=!1}return l&&rwe(this,l),l};const a=this.beforeFirstRender();a?this._resourcesFetch=a.then(()=>{this.destroyed||(this._readyForTrueRender=!0,this._postInitialize())}):(this._resourcesFetch=Promise.resolve().then(()=>{this.destroyed||this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),T_e(this._resourcesFetch)}normalizeCtorArgs(e,r){const i={...e};return r&&(i.container=r),i}postInitialize(){}beforeFirstRender(){const e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(SA):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(xt(this._trackingTarget),xt(this.viewModel),this._detach(this.container),this._set("container",null),this.render=()=>null,this._projector=null,P$(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return sk(e)}get destroyed(){return super.destroyed}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+E_e++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(iN=Zq,Jq)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(P$(this),this._projector.scheduleRender())}classes(...e){return af.apply(this,e)}renderNow(){P$(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(ie(()=>this.viewModel,(r,i)=>{i&&this.removeHandles("delegated-events"),r&&GS(r)&&this.addHandles(this._delegatedEventNames.map(s=>Dm(r,s,n=>{this.emit(s,n)})),"delegated-events")},pi)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(SA),this.scheduleRender()};this.addHandles([$P(e),ie(()=>this.uiStrings,e)]),this.addHandles(Ti(()=>this.container,r=>{this.destroyed||this._attach(r)},{initial:!0,once:!0}))}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}},Qh[iN]=!0,Qh.vnodeSelector="div",Qh);u([h()],Or.prototype,"_readyForTrueRender",void 0),u([h({value:null})],Or.prototype,"container",null),u([He("container")],Or.prototype,"castContainer",null),u([h()],Or.prototype,"icon",null),u([h()],Or.prototype,"id",null),u([h()],Or.prototype,"label",null),u([h()],Or.prototype,"renderable",null),u([h()],Or.prototype,"uiStrings",void 0),u([h()],Or.prototype,"viewModel",void 0),u([h({value:!0})],Or.prototype,"visible",null),u([h()],Or.prototype,"key",void 0),u([h()],Or.prototype,"children",void 0),u([h()],Or.prototype,"afterCreate",void 0),u([h()],Or.prototype,"afterUpdate",void 0),u([h()],Or.prototype,"afterRemoved",void 0),Or=u([E("esri.widgets.Widget")],Or);const gr=Or,P_e=new Map;function k_e(t){return P_e.get(t)}function sN(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function L_e(t,e){return t.length!==e.length||t.some((r,i)=>r.text!==e[i].text)}function Ww(t,e,r){!r||!e||t.find(i=>i.layerView===e&&i.text===r)||t.push({text:r,layerView:e})}function A_e(t){return t.type==="bing-maps"}const oo=[];let Ip=class extends le{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new se,this.view=null,this._allLayerViewsChange=r=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const i=this.view?.allLayerViews;i&&(this.addHandles(i.map(s=>ie(()=>[s.suspended,s.layer?.attributionVisible],()=>this._updateAttributionItems())).toArray(),"suspension"),i.forEach(s=>{s.declaredClass==="esri.views.3d.layers.IntegratedMesh3DTilesLayerView3D"&&this.addHandles(s.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),r?.removed&&r.removed.forEach(s=>{this._pendingAttributions.delete(s),this._fetchedAttributionData.delete(s)}),this._updateAttributionItems()},this.addHandles([pn(()=>this.view?.allLayerViews,"change",r=>this._allLayerViewsChange(r),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),Ti(()=>this.view?.stationary===!0,()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,r=e?.allLayerViews;oo.length=0;let i=!1,s=null;if(!e||!r)return void this._clear();r.forEach(o=>{if(o.suspended||!o.layer?.attributionVisible)return;const a=o.layer;if(sN(a,"user"))return void Ww(oo,o,a.copyright);if(a.type==="integrated-mesh-3dtiles"&&a.hasGoogleUrl&&(i=!0,s=o),a.hasAttributionData){if(this._fetchedAttributionData.has(o)){const c=this._fetchedAttributionData.get(o);return void(c?Ww(oo,o,this._getDynamicAttribution(c,e,a)):sN(a)&&Ww(oo,o,a.copyright))}return void this._fetchAttributionData(o)}const l="portalItem"in a?a.portalItem?.accessInformation:void 0;Ww(oo,o,l||a.copyright)});const n=r.find(o=>o.layer?.type==="integrated-mesh-3dtiles");if(this.view&&n){const o=k_e(this.view);if(o){const a=o.getAttributionText();for(let l=a.length-1;l>-1;--l)oo.unshift({text:a[l],layerView:n})}}i&&s&&oo.unshift({text:"Google Maps",layerView:s}),L_e(this.items,oo)&&(this.items.removeAll(),this.items.addMany(oo)),oo.length=0,this.notifyChange("state")}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const r=await QS(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const i=r.ok?this._createContributionIndex(r.value,A_e(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,i)}this._updateAttributionItems()}_createContributionIndex(e,r){const i=e.contributors,s={};if(!i)return s;for(let n=0;n<i.length;n++){const o=i[n],a=o.coverageAreas;if(!a)return;for(const l of a){const c=l.bbox,d=l.zoomMin-(r&&l.zoomMin?1:0),p=l.zoomMax-(r&&l.zoomMax?1:0),m=new Te({xmin:c[1],ymin:c[0],xmax:c[3],ymax:c[2],spatialReference:ne.WGS84}),y={extent:Bu(m),attribution:o.attribution||"",score:l.score!=null?l.score:100,id:n};for(let g=d;g<=p;g++)s[g]??=[],s[g].push(y)}}return s.maxKey=Math.max.apply(null,Object.keys(s)),s}_getDynamicAttribution(e,r,i){const{extent:s,scale:n}=r;let o=i.tileInfo?.scaleToZoom(n)??0;if(o=Math.min(e.maxKey??0,Math.round(o)),!s||o==null||o<=-1)return"";const a=e[o],l=i2(s.center.clone().normalize(),ne.WebMercator),c=new Set;return a?a.filter(d=>{const p=d.id,m=!c.has(p)&&l&&d.extent&&kv(d.extent,l);return m&&c.add(p),m}).sort((d,p)=>p.score-d.score||d.objectId-p.objectId).map(d=>d.attribution).join(", "):""}};u([h({readOnly:!0,type:se})],Ip.prototype,"items",void 0),u([h({readOnly:!0})],Ip.prototype,"state",null),u([h()],Ip.prototype,"view",void 0),Ip=u([E("esri.widgets.Attribution.AttributionViewModel")],Ip);const Qq=Ip,Vr={button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",empty:"esri-widget__content--empty",heading:"esri-widget__heading",interactive:"esri-interactive",panel:"esri-widget--panel",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button"};function R_e(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:F_e(t[e])}}}function O_e(t){const e=t?.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function F_e(t){return function(e,...r){O_e(e)?iwe(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...r)}}function js(t){return(e,r)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:r})}}var N_e=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},eB=function(t,e){for(var r=0,i=t.length;r<i;r++){var s=t[r];Array.isArray(s)?eB(s,e):s!=null&&s!==!1&&(s.hasOwnProperty("vnodeSelector")||(s=N_e(s)),e.push(s))}},D_e=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(r.length===1&&typeof r[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:r[0],domNode:null};var s=[];return eB(r,s),{vnodeSelector:t,properties:e||void 0,children:s,text:void 0,domNode:null}};function L(t,e,...r){return typeof t!="function"||fS(t)?D_e(t,e??null,...r):t(e,...r)}function Ije(...t){return t}const qd="esri-attribution",Bd={base:qd,poweredBy:`${qd}__powered-by`,sources:`${qd}__sources`,open:`${qd}--open`,sourcesOpen:`${qd}__sources--open`,link:`${qd}__link`};let Pi=class extends gr{constructor(e,r){super(e,r),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._sourcesNode=null,this._overflowRequestAnimationFrame=null,this._resizeObserver=new ResizeObserver(i=>{i.forEach(({target:s})=>{this._scheduleOverflowCheck(s)})}),this._mutationObserver=new MutationObserver(i=>{let s=!1;for(const n of i)if(n.type==="childList"||n.type==="characterData"||n.type==="attributes"){s=!0;break}s&&this._sourcesNode&&this._scheduleOverflowCheck(this._sourcesNode)}),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new Qq}initialize(){this.addHandles(pn(()=>this.viewModel?.items,"change",()=>this.scheduleRender()))}destroy(){this._resizeObserver?.disconnect(),this._mutationObserver?.disconnect(),this._overflowRequestAnimationFrame!=null&&(cancelAnimationFrame(this._overflowRequestAnimationFrame),this._overflowRequestAnimationFrame=null)}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}_scheduleOverflowCheck(e){this._overflowRequestAnimationFrame==null&&(this._overflowRequestAnimationFrame=requestAnimationFrame(()=>{this._overflowRequestAnimationFrame=null,this._checkSourceTextOverflow(e)}))}get attributionText(){return this.viewModel.items.reduce((e,r)=>(e.includes(r.text)||e.push(r.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[Bd.open]:this._isOpen};return L("div",{bind:this,class:this.classes(Bd.base,Vr.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return L("div",{class:Bd.poweredBy},"Powered by"," ",L("a",{class:Bd.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,r=this._isInteractive,i=r?0:void 0,{attributionText:s}=this,n={[Bd.sourcesOpen]:e,[Vr.interactive]:r};return L("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(Bd.sources,n),innerHTML:s,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._sourcesNode=e,this._resizeObserver.observe(e),this._mutationObserver.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0}),this._scheduleOverflowCheck(e)}_checkSourceTextOverflow(e){let r=!1;const{clientHeight:i,clientWidth:s,scrollWidth:n}=e,o=n>s,a=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,a&&(r=!0),this._isOpen){const l=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,l&&(this._isOpen=!1,r=!0)}r&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};u([h()],Pi.prototype,"_isOpen",void 0),u([h()],Pi.prototype,"_isInteractive",null),u([h()],Pi.prototype,"_attributionTextOverflowed",void 0),u([h()],Pi.prototype,"_prevSourceNodeHeight",void 0),u([h({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],Pi.prototype,"attributionText",null),u([h()],Pi.prototype,"icon",null),u([h()],Pi.prototype,"itemDelimiter",void 0),u([h()],Pi.prototype,"label",null),u([h(),js("esri/widgets/Attribution/t9n/Attribution")],Pi.prototype,"messages",void 0),u([h()],Pi.prototype,"view",null),u([h({type:Qq})],Pi.prototype,"viewModel",void 0),u([R_e()],Pi.prototype,"_toggleState",null),Pi=u([E("esri.widgets.Attribution")],Pi);const z_e=Pi;function j_e(){const t=z("mapview-essential-goto-duration");return t==null?t:t}function V_e(t){return t?.spatialReference?.isWebMercator||t?.spatialReference?.isGeographic||!1}function U_e(t,e,r){return t.goTo(e,r)}const tB=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:s}=this;return xv(s),this.goToOverride?this.goToOverride(s,i):U_e(s,i.target,i.options)}};return u([h()],r.prototype,"goToOverride",void 0),u([h()],r.prototype,"view",void 0),r=u([E("esri.widgets.support.GoTo")],r),r};let rh=class extends tB(le){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(ft)}destroy(){this.view=null}get canShowNorth(){return V_e(this.view)}get state(){return!this.view?.ready||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&(this.view?.type==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:j_e()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const r=-e.heading;this._set("orientation",{x:0,y:0,z:r})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles(e.type==="2d"?ie(()=>e?.rotation,this._updateForRotation,ft):ie(()=>e?.camera,this._updateForCamera,ft))}_watchForView(e){this.addHandles(ie(()=>this.view,this._updateRotationWatcher,e))}};u([h({readOnly:!0})],rh.prototype,"canShowNorth",null),u([h({readOnly:!0})],rh.prototype,"orientation",void 0),u([h({readOnly:!0})],rh.prototype,"state",null),u([h()],rh.prototype,"view",void 0),rh=u([E("esri.widgets.Compass.CompassViewModel")],rh);const rB=rh,nN="esri-compass",oN={base:nN,iconContainer:`${nN}__icon-container`};let Ga=class extends gr{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new rB,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=i=>({transform:`rotateZ(${i.z}deg)`})}loadDependencies(){return xd({button:()=>q(()=>import("./index-QMIhu610.js"),__vite__mapDeps([277,278,279,280,281,282,283,284,285,286,287,288,289,290,291])),icon:()=>q(()=>import("./index-CROBEgSo.js").then(e=>e.i),__vite__mapDeps([282,283,279,284]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:r}=this.viewModel,{messages:i}=this;return L("div",{class:this.classes(oN.base,Vr.widget)},L("calcite-button",{class:Vr.widgetButton,disabled:r==="disabled",kind:"neutral",label:i.reset,onclick:this._reset,round:!0,scale:"s",title:i.reset},L("div",{"aria-hidden":"true",class:oN.iconContainer,title:i.reset},L("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};u([h()],Ga.prototype,"goToOverride",null),u([h()],Ga.prototype,"icon",null),u([h()],Ga.prototype,"label",null),u([h(),js("esri/widgets/Compass/t9n/Compass")],Ga.prototype,"messages",void 0),u([h()],Ga.prototype,"view",null),u([h({type:rB})],Ga.prototype,"viewModel",void 0),Ga=u([E("esri.widgets.Compass")],Ga);const G_e=Ga,aN="esri-navigation-toggle",lN={base:aN,isLayoutHorizontal:`${aN}--horizontal`};let Ep=class extends le{constructor(e){super(e),this._navigationMode="pan",this.view=null,e?.isDefaultViewModel||wK(U.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.33"})}normalizeCtorArgs(e={}){const{isDefaultViewModel:r,...i}=e;return i}initialize(){this.addHandles(Ti(()=>this.view?.navigation?.actionMap,()=>this._updateNavigationActionMap()))}destroy(){this.view=null}get state(){return this.view?.ready&&this.view?.type==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(e){this._navigationMode=e,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){const e=this.view?.navigation?.actionMap;if(!e)return;const r=this._navigationMode==="pan";e.dragPrimary=r?"pan":"rotate",e.dragSecondary=r?"rotate":"pan"}};u([h({readOnly:!0})],Ep.prototype,"state",null),u([h()],Ep.prototype,"_navigationMode",void 0),u([h()],Ep.prototype,"view",void 0),Ep=u([E("esri.widgets.NavigationToggle.NavigationToggleViewModel")],Ep);const iB=Ep;let qa=class extends gr{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new iB({isDefaultViewModel:!0}),this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const i=this.viewModel?.navigationMode==="pan"?this._rotateButton:this._panButton;swe(i),this.toggle()},e?.isDefaultUI||WS(U.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.32"})}normalizeCtorArgs(e={}){const{isDefaultUI:r,...i}=e;return i}loadDependencies(){return xd({button:()=>q(()=>import("./index-QMIhu610.js"),__vite__mapDeps([277,278,279,280,281,282,283,284,285,286,287,288,289,290,291]))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.viewModel?.state==="disabled",r=this.viewModel?.navigationMode==="pan",i=this.messages.toggle;return L("div",{class:this.classes(lN.base,Vr.widget,{[lN.isLayoutHorizontal]:this.layout==="horizontal"})},L("calcite-button",{afterCreate:s=>{this._panButton=s},appearance:r?"outline-fill":"solid",class:Vr.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:r?void 0:-1,title:i}),L("calcite-button",{afterCreate:s=>{this._rotateButton=s},appearance:r?"solid":"outline-fill",class:Vr.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:r?-1:void 0,title:i}))}};u([h()],qa.prototype,"icon",null),u([h()],qa.prototype,"label",null),u([h({value:"vertical"})],qa.prototype,"layout",null),u([h(),js("esri/widgets/NavigationToggle/t9n/NavigationToggle")],qa.prototype,"messages",void 0),u([h()],qa.prototype,"view",null),u([h({type:iB})],qa.prototype,"viewModel",void 0),qa=u([E("esri.widgets.NavigationToggle")],qa);const q_e=qa;let ih=class extends le{get canZoomIn(){if(!this.view?.ready)return!1;const r=this.view?.constraints?.effectiveMaxScale;return r===0||this._scale>r}get canZoomOut(){const{view:e}=this;if(!e?.ready)return!1;const i=e.constraints?.effectiveMinScale;return i===0||this._scale<i}get _scale(){const e=this.view?.animation?.target;return(e&&"then"in e?void 0:e?.scale)??this.view?.scale??0}};u([h({readOnly:!0})],ih.prototype,"canZoomIn",null),u([h({readOnly:!0})],ih.prototype,"canZoomOut",null),u([h()],ih.prototype,"view",void 0),u([h()],ih.prototype,"_scale",null),ih=u([E("esri.widgets.Zoom.ZoomConditions2D")],ih);const B_e=ih;let Cp=class extends le{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};u([h({readOnly:!0})],Cp.prototype,"canZoomIn",null),u([h({readOnly:!0})],Cp.prototype,"canZoomOut",null),u([h()],Cp.prototype,"view",void 0),Cp=u([E("esri.widgets.Zoom.ZoomConditions3D")],Cp);const H_e=Cp;let mu=class extends le{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){return this._zoomConditions!=null&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new B_e({view:e}):e.type==="3d"&&(this._zoomConditions=new H_e({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&(e.type==="2d"?e.mapViewNavigation.zoomIn():hm(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&(e.type==="2d"?e.mapViewNavigation.zoomOut():hm(e.goTo({zoomFactor:.5})))}};u([h()],mu.prototype,"_zoomConditions",void 0),u([h()],mu.prototype,"canZoomIn",null),u([h()],mu.prototype,"canZoomOut",null),u([h({readOnly:!0})],mu.prototype,"state",null),u([h()],mu.prototype,"view",null),mu=u([E("esri.widgets.Zoom.ZoomViewModel")],mu);const sB=mu,uN={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let Ba=class extends gr{constructor(e,r){super(e,r),this.messages=null,this.viewModel=new sB,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return xd({button:()=>q(()=>import("./index-QMIhu610.js"),__vite__mapDeps([277,278,279,280,281,282,283,284,285,286,287,288,289,290,291]))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[uN.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:r,canZoomOut:i}=this.viewModel,{zoomIn:s,zoomOut:n}=this.messages;return L("div",{class:this.classes(uN.base,Vr.widget,e)},L("calcite-button",{class:Vr.widgetButton,disabled:!r,iconStart:"plus",kind:"neutral",label:s,onclick:this.zoomIn,title:s}),L("calcite-button",{class:Vr.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:n,onclick:this.zoomOut,title:n}))}};u([h()],Ba.prototype,"icon",null),u([h()],Ba.prototype,"label",null),u([h({value:"vertical"})],Ba.prototype,"layout",null),u([h(),js("esri/widgets/Zoom/t9n/Zoom")],Ba.prototype,"messages",void 0),u([h()],Ba.prototype,"view",null),u([h({type:sB})],Ba.prototype,"viewModel",void 0),Ba=u([E("esri.widgets.Zoom")],Ba);const W_e=Ba;function Z_e(t){return t?.view!==void 0}let Cb=class extends awe{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=r=>{this.components.forEach(i=>{const s=this._find(i),n=s?.widget;Z_e(n)&&(n.view=r)})},this._componentsWatcher=(r,i)=>{this._removeComponents(i),this._addComponents(r),this._adjustPadding(r)}}initialize(){this.addHandles([ie(()=>this.components,this._componentsWatcher,ft),ie(()=>this.view,this._updateViewAwareWidgets,ft)])}_add(e,r,i,s,n){let o=e;if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;o=this._createComponent(e)}super._add(o,r,i,s,n)}_removeComponents(e){e.forEach(r=>{const i=this._find(r);i&&(this.remove(i),i.destroy())})}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:r}=this.padding;this.padding=r}}_addComponents(e){this.constructed&&e.forEach(r=>this.add(this._createComponent(r),this._defaultPositionLookup[r]))}_createComponent(e){const r=this._createWidget(e);return new Tb({id:e,node:r})}_createWidget(e){const r=this.view;switch(e){case"attribution":return new z_e({view:r});case"compass":return new G_e({view:r});case"navigation-toggle":return new q_e({view:r,isDefaultUI:!0});case"zoom":return new W_e({view:r})}}};u([h()],Cb.prototype,"components",void 0),Cb=u([E("esri.views.ui.DefaultUI")],Cb);const nB=Cb;let Pb=class extends nB{constructor(e){super(e),this.components=["attribution","zoom"]}};u([h()],Pb.prototype,"components",void 0),Pb=u([E("esri.views.ui.2d.DefaultUI2D")],Pb);const oB=Pb;let J_e=class{constructor(e={},r={},i=8,s=1/0){this.disabledExtensions=e,this.debugWebGLExtensions=r,this.maxAnisotropy=i,this.maxPreferredTexturePixels=s}},aB=class B3{constructor(e,r,i=""){this.major=e,this.minor=r,this._context=i}lessThan(e,r){return this.major<e||e===this.major&&this.minor<r}greaterEqual(e,r){return!this.lessThan(e,r)}validate(e){if(this.major!==e.major){const r=this._context&&this._context+":",i=this._context&&this._context+" ";throw new R(r+"unsupported-version",`Required major ${i}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new B3(this.major,this.minor,this._context)}static parse(e,r=""){const[i,s]=e.split("."),n=/^\s*\d+\s*$/;if(!i?.match||!n.test(i))throw new R((r&&r+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!s?.match||!n.test(s))throw new R((r&&r+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const o=parseInt(i,10),a=parseInt(s,10);return new B3(o,a,r)}},Y_e=class extends aB{constructor(e,r){super(e,r,"webmap")}};function O$(t){return t!=null&&typeof t=="object"&&"declaredClass"in t&&t.declaredClass==="esri.WebMap"}new Y_e(2,35);var H3;let kb=H3=class extends W{constructor(t){super(t),this.color=new K([0,0,0,1])}clone(){return new H3(O({color:this.color}))}};u([h({type:K,json:{write:!0}})],kb.prototype,"color",void 0),kb=H3=u([E("esri.webmap.background.ColorBackground")],kb);const X_e=kb;let lB,uB,cB,hB,dB,pB,fB;async function K_e(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:r,MapViewNavigation:i,MagnifierView2D:s,GridView2D:n,Stage:o}]=await Promise.all([q(()=>import("./webglDeps-BP9SI3Fi.js"),__vite__mapDeps([178,150,179,180,181,52])),q(()=>import("./mapViewDeps-ouTdldM0.js"),__vite__mapDeps([182,183,184,150,179,180,141,81,185,83,181,52,149,51,186,80,103,187,130,133,30,28,31,84,89,188,86,87,178,189,98,190,191,129,192,139,140,69,79,82,35,34,193,88,194,85,14,15,16,195,90,95,196,77,197,198,199,200,146,201,202]))]);uB=t,cB=e,hB=r,dB=i,pB=s,fB=n,lB=o}var tm;let Oe=(tm=class extends Oge(dye(Uue(phe(Kce(jfe))))){get timeZone(){return super.timeZone}set timeZone(e){super.timeZone=e}constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new Zn({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new F2({actionMap:new Tk({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.analyses=new $m,this.analysisViewManager=new Nve({importAnalysisViewModule:r=>$0e(r),view:this}),this.floors=new se,this.grid=null,this.map=null,this.timeline=new Sq,this.type="2d",this.view2dType=null,this.ui=new oB,this.animationsEnabled=!0,this.test={takeScreenshot:async r=>Lve(this._getScreenshotView(r),r)},this.padding={top:0,right:0,bottom:0,left:0},Due()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=xt(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new R0e(this.featuresTilingScheme)}get constraintsInfo(){const e=this.defaultsFromMap?.tileInfo,r=this.spatialReference;return{lods:e?.spatialReference?.equals(r)?e.lods:null,spatialReference:r}}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:e,constraints:r,center:i,viewpoint:s,extent:n}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!n&&(r?.effectiveLODs||(o=-1),(!i||e===0&&o===-1)&&(s?.targetGeometry==null||s.targetGeometry.type!=="extent"&&!s.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const r=e.targetGeometry,i=this.spatialReference;return d9(r.spatialReference,i)}get background(){return O$(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){return this.stateManager?.center??null}set center(e){this.stateManager.center=e}get constraints(){return super.constraints}set constraints(e){super.constraints=e}get highlightOptions(){return mve(this)}set highlightOptions(e){yve(this,e)}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){return this.stage?.renderRequested??!1}get resizeAlign(){return super.resizeAlign}set resizeAlign(e){super.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return super.rotation}set rotation(e){super.rotation=e}get scale(){return this.stateManager?.scale??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get spatialReference(){return super.spatialReference}set spatialReference(e){super.spatialReference=e}get spatialReferenceLocked(){return this._get("spatialReferenceLocked")}set spatialReferenceLocked(e){this.stage&&U.getLogger(this).warn("spatialReferenceLocked cannot be changed after the view has become ready"),this._set("spatialReferenceLocked",e)}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const e=!(!this.magnifier.visible||this.magnifier.position===null||!this._magnifierView?.updatingHandles.updating),r=!this.destroyed&&(!this.analysisViewManager||!this.layerViewManager||!this.labelManager||!this.graphicsView||this.analysisViewManager.updating===!0||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(i=>!i.destroyed&&!("layerViews"in i)&&i.updating===!0)||e);if(z("esri-2d-log-updating")){const i=this.allLayerViews.reduce((s,n)=>({...s,[`${n.layer.id}(${n.layer.type})`]:!n.destroyed&&!("layerViews"in n)&&n.updating}),{});console.log(`Updating MapView: ${r}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${this.layerViewManager?.updating}
-> labelManager.updating: ${this.labelManager?.updating}
-> graphicsView.updating: ${this.graphicsView?.updating}
-> allLayerViews: ${JSON.stringify(i)}
-> updatingMagnifier: ${e}
`)}return r}get viewpoint(){return super.viewpoint}set viewpoint(e){super.viewpoint=e}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new dt({rings:[e.map(r=>[r[0],r[1]])],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return this.mapViewNavigation?.interacting??!1}async hitTest(e,r){return gve(this,e,r)}async takeScreenshot(e){return kve(this._getScreenshotView(e),e)}toScreen(e,r){return this.stateManager.toScreen(e,r)}async whenAnalysisView(e){if(e.parent==null)throw new R("view:no-analysisview-for-analysis","The analysis does not exist in view.analyses",{analysis:e});return this.analysisViewManager.whenAnalysisView(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return O$(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return O$(this.map)?this.map.initialViewProperties.timeExtent:null}getSurface(){return this.surface}hasLayerViewModule(e){return wF.hasLayerViewModule(e)}importLayerView(e){return wF.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(U.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){const r=this.toMap(e),i=await this.hitTest(e),s=this.allLayerViews.toArray().filter(c=>c.clips.every(d=>hq(this,d,e,r))).reverse(),n=new globalThis.Map(s.map(c=>[c.layer.uid,c])),o=[];let a=0,l=0;for(;a<i.results.length||l<s.length;){const c=i.results.at(a);if(c&&c.type!=="graphic"){++a;continue}const d=n.get((c?.layer??c?.graphic.layer)?.uid);if((!c||d)&&l<s.length&&s.at(l)!==d){const p=s.at(l);"fetchPopupFeaturesAtLocation"in p&&o.push({mapPoint:r,layerView:p}),++l}else c&&(o.push({graphic:c.graphic,layerView:d}),++a)}return{hits:o,location:r}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=qve(this.type);if(z("safari")&&z("safari")<9&&(e=new R("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:z("safari")})),e!=null)throw U.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return K_e()}_getDefaultViewpoint(){const{constraints:e,initialExtent:r,map:i,padding:s,size:n}=this;if(!e)return null;const o=i&&"initialViewProperties"in i?i.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),l=o?.viewpoint,c=l?.targetGeometry?.extent??r,d=c?.center,p=l?.rotation??0,m=l?.scale||c&&D2(c,[n[0]-s.left-s.right,n[1]-s.top-s.bottom]),y=a.center??d,g=a.rotation??p,v=a.scale??m;return y&&v?new fn({targetGeometry:y,scale:v,rotation:g}):null}_startup(){this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const r=new M0e(this.surface),i=new lB(this.surface,{canvas:this.renderCanvas,contextOptions:new J_e(this.deactivatedWebGLExtensions,this.debugWebGLExtensions),renderingOptions:this.renderingOptions,timeline:this.timeline},r);this.stage=i,this._magnifierView=new pB,this._magnifierView.magnifier=this.magnifier,this._gridView=new fB;const s=new hB({view:this});this._set("labelManager",s);const n=new p0e({view:this});this._set("animationManager",n);const o=new dB({view:this,animationManager:n});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),i.on("webgl-error",l=>this.fatalError=l.error),ie(()=>this.stationary,l=>i.stationary=l,pi),ie(()=>this.background,l=>{i.backgroundColor=l?.color,this._magnifierView.backgroundColor=l?.color},pi),ie(()=>this.magnifier,l=>this._magnifierView.magnifier=l,pi),ie(()=>this.grid,l=>this._gridView.grid=l,pi),ie(()=>this.renderingOptions,l=>i.renderingOptions=l,pi),ie(()=>this.highlights.items.map(l=>({name:l.name,options:{fillColor:l.color,haloColor:l.haloColor,fillOpacity:l.fillOpacity,haloOpacity:l.haloOpacity,haloWidth:l.haloWidth,haloBlur:l.haloBlur}})),()=>{i.highlightGradient=pve(i.highlightGradient,this.highlights.items)},pi),ie(()=>this.state.id,()=>i.state=this.state,pi),ie(()=>this.animationsEnabled,l=>{this.stage.animationsEnabled=l},pi)],"map-view"),this._updateStageChildren();const a=this._resolveWhenReady;this._resolveWhenReady=[],a.forEach(l=>l(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(r=>{this.stage.addChild(r.container)});const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new w0e(Ci.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const r=new uB({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new cB(e)});this._set("graphicsView",r)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){const{allLayerViews:r,padding:i,size:s,stage:n}=this;return{allLayerViews:r,backgroundColor:e?.ignoreBackground?null:this.background?.color,padding:i,size:s,stage:n}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const r of this.allLayerViews)r.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const r of this.allLayerViews)r.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}},tm.type="2d",tm);u([h({constructOnly:!0})],Oe.prototype,"deactivatedWebGLExtensions",void 0),u([h({constructOnly:!0})],Oe.prototype,"debugWebGLExtensions",void 0),u([h({readOnly:!0})],Oe.prototype,"featuresTilingScheme",void 0),u([h({readOnly:!0})],Oe.prototype,"graphicsTileStore",null),u([h()],Oe.prototype,"graphicsView",void 0),u([h()],Oe.prototype,"constraintsInfo",null),u([h()],Oe.prototype,"initialExtentRequired",null),u([h()],Oe.prototype,"labelManager",void 0),u([h({type:F2,nonNullable:!0})],Oe.prototype,"navigation",void 0),u([h({constructOnly:!0})],Oe.prototype,"renderCanvas",void 0),u([h()],Oe.prototype,"renderingOptions",void 0),u([h({constructOnly:!0})],Oe.prototype,"supersampleScreenshotsEnabled",void 0),u([h()],Oe.prototype,"defaultsFromMapSettings",null),u([h({readOnly:!0})],Oe.prototype,"typeSpecificPreconditionsReady",null),u([h(BT($m,"analyses"))],Oe.prototype,"analyses",void 0),u([h()],Oe.prototype,"analysisViewManager",void 0),u([h({type:X_e})],Oe.prototype,"background",null),u([h()],Oe.prototype,"center",null),u([h({type:se})],Oe.prototype,"floors",void 0),u([h()],Oe.prototype,"grid",void 0),u([h({type:Ju})],Oe.prototype,"highlightOptions",null),u([h()],Oe.prototype,"map",void 0),u([h()],Oe.prototype,"padding",null),u([h({readOnly:!0})],Oe.prototype,"rendering",null),u([h({readOnly:!0})],Oe.prototype,"resolution",null),u([h()],Oe.prototype,"scale",null),u([h({type:Boolean,value:!1})],Oe.prototype,"spatialReferenceLocked",null),u([h({readOnly:!0})],Oe.prototype,"tileInfo",null),u([h({type:Sq,readOnly:!0})],Oe.prototype,"timeline",void 0),u([h({readOnly:!0})],Oe.prototype,"type",void 0),u([h({readOnly:!0})],Oe.prototype,"updating",null),u([h({readOnly:!0})],Oe.prototype,"view2dType",void 0),u([h({readOnly:!0})],Oe.prototype,"visibleArea",null),u([h()],Oe.prototype,"zoom",null),u([h({readOnly:!0})],Oe.prototype,"navigating",null),u([h(),He(t=>t instanceof nB?t:Um(oB,t))],Oe.prototype,"ui",void 0),u([h()],Oe.prototype,"animationsEnabled",void 0),Oe=u([E("esri.views.View2D")],Oe);const Q_e=Oe;let Lb=class extends Q_e{constructor(e){super(e),this.view2dType="map"}};u([h({readOnly:!0})],Lb.prototype,"view2dType",void 0),Lb=u([E("esri.views.MapView")],Lb);const ebe=Lb;let tbe=class mB{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(NM),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const r=new mB,i=this._originStores[0];i&&i.forEach((s,n)=>{r.set(n,O(s),0)});for(let s=2;s<NM;s++){const n=this._originStores[s];n&&n.forEach((o,a)=>{e&&e.has(a)||r.set(a,O(o),s)})}return r}get(e,r){const i=r===void 0?this._values:this._originStores[r];return i?i.get(e):void 0}keys(e){const r=e==null?this._values:this._originStores[e];return r?[...r.keys()]:[]}set(e,r,i=7){let s=this._originStores[i];if(s||(s=new Map,this._originStores[i]=s),s.set(e,r),!this._values.has(e)||this._propertyOriginMap.get(e)<=i){const n=this._values.get(e);return this._values.set(e,r),this._propertyOriginMap.set(e,i),n!==r}return!1}delete(e,r=7){const i=this._originStores[r];if(!i)return;const s=i.get(e);if(i.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===r){this._values.delete(e);for(let n=r-1;n>=0;n--){const o=this._originStores[n];if(o&&o.has(e)){this._values.set(e,o.get(e)),this._propertyOriginMap.set(e,n);break}}}return s}has(e,r){const i=r===void 0?this._values:this._originStores[r];return!!i&&i.has(e)}revert(e,r){for(;r>0&&!this.has(e,r);)--r;const i=this._originStores[r],s=i?.get(e),n=this._values.get(e);return this._values.set(e,s),this._propertyOriginMap.set(e,r),n!==s}originOf(e){return this._propertyOriginMap.get(e)||0}isAtOrigin(e,r){return this.has(e,r)&&this.originOf(e)===r}isBelowOrigin(e,r){return!this.has(e)||this.originOf(e)<r}forEach(e){this._values.forEach(e)}};const yB=t=>{const e=t;let r=class extends e{constructor(...i){super(...i);const s=Hi(this),n=s.store,o=new tbe;s.store=o,U6(s,n,o)}read(i,s){q6(this,i,s)}getAtOrigin(i,s){const n=F$(this),o=ml(s);if(typeof i=="string")return n.get(i,o);const a={};return i.forEach(l=>{a[l]=n.get(l,o)}),a}originOf(i){return R0(this.originIdOf(i))}originIdOf(i){return F$(this).originOf(i)}revert(i,s){const n=F$(this),o=ml(s),a=Hi(this);let l;l=typeof i=="string"?i==="*"?n.keys(o):[i]:i,l.forEach(c=>{a.invalidate(c),n.revert(c,o),a.commit(c)})}};return r=u([E("esri.core.ReadOnlyMultiOriginJSONSupport")],r),r};function F$(t){return Hi(t).store}yB(le);const rbe=t=>{const e=t;let r=class extends e{constructor(...i){super(...i)}clear(i,s="user"){Hi(this).clearOrigin(i,ml(s))}write(i,s){return H6(this,i=i||{},s),i}setAtOrigin(i,s,n){Hi(this).setAtOrigin(i,s,ml(n))}removeOrigin(i){const s=cN(this),n=ml(i),o=s.keys(n);for(const a of o)s.originOf(a)===n&&s.set(a,s.get(a,n),7)}updateOrigin(i,s){const n=cN(this),o=ml(s),a=ln(this,i);for(let l=o+1;l<NM;++l)n.delete(i,l);n.set(i,a,o)}toJSON(i){return this.write({},i)}};return r=u([E("esri.core.MultiOriginJSONSupport.WriteableMultiOriginJSONSupport")],r),r.prototype.toJSON.isDefaultToJSON=!0,r};function cN(t){return Hi(t).store}const gB=t=>{const e=rbe(yB(t));let r=class extends e{};return r=u([E("esri.core.MultiOriginJSONSupport")],r),r},Uje=gB(le),pt=(t=>t)(["operational-layers","basemap-base-layers","basemap-ground-layers","ground"]);var W3;let sh=W3=class extends W{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new W3({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};u([h({type:String,json:{write:!0}})],sh.prototype,"expression",void 0),u([h({type:String,json:{write:!0}})],sh.prototype,"name",void 0),u([h({type:["boolean","date","number","string"],json:{write:!0}})],sh.prototype,"returnType",void 0),u([h({type:String,json:{write:!0}})],sh.prototype,"title",void 0),sh=W3=u([E("esri.form.ExpressionInfo")],sh);const ibe=sh;let ls=class extends W{constructor(e){super(e),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};u([h({type:String,json:{write:!0}})],ls.prototype,"description",void 0),u([h({type:String,json:{write:!0}})],ls.prototype,"label",void 0),u([h()],ls.prototype,"type",void 0),u([h({type:String,json:{write:!0}})],ls.prototype,"visibilityExpression",void 0),ls=u([E("esri.form.elements.Element")],ls);let Ab=class extends Ie(W){constructor(e){super(e),this.type=null}};u([h()],Ab.prototype,"type",void 0),Ab=u([E("esri.form.elements.inputs.attachments.Input")],Ab);const hc=Ab,Z2=["any","capture","upload"];let Pp=class extends hc{constructor(e){super(e),this.type="audio",this.inputMethod="any",this.maxDuration=null}};u([h({type:["audio"],readOnly:!0,json:{write:!0}})],Pp.prototype,"type",void 0),u([h({type:Z2,json:{write:!0}})],Pp.prototype,"inputMethod",void 0),u([h({type:Number,json:{write:!0}})],Pp.prototype,"maxDuration",void 0),Pp=u([E("esri.form.elements.inputs.attachments.AudioInput")],Pp);const hN=Pp;let Pg=class extends hc{constructor(e){super(e),this.type="document",this.maxFileSize=null}};u([h({type:["document"],readOnly:!0,json:{write:!0}})],Pg.prototype,"type",void 0),u([h({type:Number,json:{write:!0}})],Pg.prototype,"maxFileSize",void 0),Pg=u([E("esri.form.elements.inputs.attachments.DocumentInput")],Pg);const dN=Pg;let kp=class extends hc{constructor(e){super(e),this.type="image",this.inputMethod="any",this.maxImageSize=null}};u([h({type:["image"],readOnly:!0,json:{write:!0}})],kp.prototype,"type",void 0),u([h({type:Z2,json:{write:!0}})],kp.prototype,"inputMethod",void 0),u([h({type:Number,json:{write:!0}})],kp.prototype,"maxImageSize",void 0),kp=u([E("esri.form.elements.inputs.attachments.ImageInput")],kp);const pN=kp;let kg=class extends hc{constructor(e){super(e),this.type="signature",this.inputMethod="any"}};u([h({type:["signature"],readOnly:!0,json:{write:!0}})],kg.prototype,"type",void 0),u([h({type:Z2,json:{write:!0}})],kg.prototype,"inputMethod",void 0),kg=u([E("esri.form.elements.inputs.attachments.SignatureInput")],kg);const fN=kg;let Lp=class extends hc{constructor(e){super(e),this.type="video",this.inputMethod="any",this.maxDuration=null}};u([h({type:["video"],readOnly:!0,json:{write:!0}})],Lp.prototype,"type",void 0),u([h({type:Z2,json:{write:!0}})],Lp.prototype,"inputMethod",void 0),u([h({type:Number,json:{write:!0}})],Lp.prototype,"maxDuration",void 0),Lp=u([E("esri.form.elements.inputs.attachments.VideoInput")],Lp);const mN=Lp;function vB(t){return{nestableTypes:{base:hc,key:"type",typeMap:{audio:hN,document:dN,image:pN,signature:fN,video:mN}},allTypes:{base:hc,key:"type",typeMap:{attachment:t,audio:hN,document:dN,image:pN,signature:fN,video:mN}}}}function sbe(t,e,r){return t?t.map(i=>ma(e.nestableTypes,i)):null}function nbe(t,e,r){if(!t)return null;const i=e.nestableTypes.typeMap;return t.filter(s=>i[s.type]).map(s=>i[s.type].fromJSON(s))}function obe(t,e,r){if(!t)return null;const i=e.nestableTypes.typeMap;return t.filter(s=>i[s.type]).map(s=>s.toJSON())}let bo=class extends hc{constructor(e){super(e),this.type="attachment",this.attachmentAssociationType="exact",this.inputTypes=null}castInputs(e){return sbe(e,N$)}readInputs(e,r){return nbe(r.inputTypes,N$)}writeInputs(e,r){r.inputTypes=obe(e,N$)}};u([h({type:["attachment"],readOnly:!0,json:{write:!0}})],bo.prototype,"type",void 0),u([h({type:["any","exact","exactOrNone"],json:{write:!0}})],bo.prototype,"attachmentAssociationType",void 0),u([h({json:{write:{isRequired:!0}}})],bo.prototype,"inputTypes",void 0),u([He("inputTypes")],bo.prototype,"castInputs",null),u([X("inputTypes")],bo.prototype,"readInputs",null),u([te("inputTypes")],bo.prototype,"writeInputs",null),bo=u([E("esri.form.elements.inputs.attachments.AttachmentInput")],bo);const N$=vB(bo),abe=bo;var Z3;const lbe=vB(abe);let Ss=Z3=class extends ls{constructor(t){super(t),this.allowUserRename=!0,this.attachmentKeyword=null,this.displayFilename=!1,this.editableExpression=null,this.filenameExpression="{attachmentKeyword}_{now}",this.input=null,this.maxAttachmentCount=null,this.minAttachmentCount=null,this.type="attachment",this.useOriginalFilename=!0}clone(){return new Z3({allowUserRename:this.allowUserRename,attachmentKeyword:this.attachmentKeyword,description:this.description,displayFilename:this.displayFilename,editableExpression:this.editableExpression,filenameExpression:this.filenameExpression,input:this.input?.clone(),label:this.label,maxAttachmentCount:this.maxAttachmentCount,minAttachmentCount:this.minAttachmentCount,useOriginalFilename:this.useOriginalFilename,visibilityExpression:this.visibilityExpression})}};u([h({type:Boolean,json:{write:!0}})],Ss.prototype,"allowUserRename",void 0),u([h({type:String,json:{write:{isRequired:!0}}})],Ss.prototype,"attachmentKeyword",void 0),u([h({type:Boolean,json:{write:!0}})],Ss.prototype,"displayFilename",void 0),u([h({type:String,json:{write:!0}})],Ss.prototype,"editableExpression",void 0),u([h({type:String,json:{write:!0}})],Ss.prototype,"filenameExpression",void 0),u([h({types:lbe.allTypes,json:{read:{source:"inputType"},write:{target:"inputType",isRequired:!0}}})],Ss.prototype,"input",void 0),u([h({type:Number,json:{write:!0}})],Ss.prototype,"maxAttachmentCount",void 0),u([h({type:Number,json:{write:!0}})],Ss.prototype,"minAttachmentCount",void 0),u([h({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],Ss.prototype,"type",void 0),u([h({type:Boolean,json:{write:!0}})],Ss.prototype,"useOriginalFilename",void 0),Ss=Z3=u([E("esri.form.elements.AttachmentElement")],Ss);const yN=Ss;let Rb=class extends W{constructor(e){super(e),this.type=null}};u([h()],Rb.prototype,"type",void 0),Rb=u([E("esri.form.elements.inputs.Input")],Rb);const Fl=Rb;let Lg=class extends Fl{constructor(e){super(e),this.maxLength=null,this.minLength=0}};u([h({type:Number,json:{write:!0}})],Lg.prototype,"maxLength",void 0),u([h({type:Number,json:{write:!0}})],Lg.prototype,"minLength",void 0),Lg=u([E("esri.form.elements.inputs.TextInput")],Lg);const Jk=Lg;var J3;let Ob=J3=class extends Jk{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new J3({maxLength:this.maxLength,minLength:this.minLength})}};u([h({type:["barcode-scanner"],json:{read:!1,write:!0}})],Ob.prototype,"type",void 0),Ob=J3=u([E("esri.form.elements.inputs.BarcodeScannerInput")],Ob);const ube=Ob;var Y3;let Ap=Y3=class extends Fl{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new Y3({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};u([h({type:String,json:{write:!0}})],Ap.prototype,"noValueOptionLabel",void 0),u([h({type:Boolean,json:{write:!0}})],Ap.prototype,"showNoValueOption",void 0),u([h({type:["combo-box"],json:{read:!1,write:!0}})],Ap.prototype,"type",void 0),Ap=Y3=u([E("esri.form.elements.inputs.ComboBoxInput")],Ap);const cbe=Ap;var X3;function gN(t){return t??null}function vN(t){return t??null}let vo=X3=class extends Fl{constructor(t){super(t),this.max=null,this.min=null,this.type="date-picker"}readMax(t,e){return gN(e.max)}writeMax(t,e){e.max=vN(t)}readMin(t,e){return gN(e.min)}writeMin(t,e){e.min=vN(t)}clone(){return new X3({max:this.max,min:this.min})}};u([h({type:String,json:{type:String,write:!0}})],vo.prototype,"max",void 0),u([X("max")],vo.prototype,"readMax",null),u([te("max")],vo.prototype,"writeMax",null),u([h({type:String,json:{type:String,write:!0}})],vo.prototype,"min",void 0),u([X("min")],vo.prototype,"readMin",null),u([te("min")],vo.prototype,"writeMin",null),u([h({type:["date-picker"],json:{read:!1,write:!0}})],vo.prototype,"type",void 0),vo=X3=u([E("esri.form.elements.inputs.DatePickerInput")],vo);const hbe=vo;var K3;function D$(t){return t??null}function z$(t){return t??null}let Xi=K3=class extends Fl{constructor(t){super(t),this.includeTimeOffset=!0,this.max=null,this.min=null,this.timeResolution="minutes",this.type="datetimeoffset-picker"}readMax(t,e){return D$(e.max)}writeMax(t,e){e.max=z$(t)}readMin(t,e){return D$(e.min)}writeMin(t,e){e.min=z$(t)}readTimeResolution(t,e){return D$(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=z$(t)}clone(){return new K3({includeTimeOffset:this.includeTimeOffset,max:this.max,min:this.min,timeResolution:this.timeResolution})}};u([h({type:Boolean,json:{write:!0}})],Xi.prototype,"includeTimeOffset",void 0),u([h({type:String,json:{type:String,write:!0}})],Xi.prototype,"max",void 0),u([X("max")],Xi.prototype,"readMax",null),u([te("max")],Xi.prototype,"writeMax",null),u([h({type:String,json:{type:String,write:!0}})],Xi.prototype,"min",void 0),u([X("min")],Xi.prototype,"readMin",null),u([te("min")],Xi.prototype,"writeMin",null),u([h({type:String,json:{type:String,write:!0}})],Xi.prototype,"timeResolution",void 0),u([X("timeResolution")],Xi.prototype,"readTimeResolution",null),u([te("timeResolution")],Xi.prototype,"writeTimeResolution",null),u([h({type:["datetimeoffset-picker"],json:{read:!1,write:!0}})],Xi.prototype,"type",void 0),Xi=K3=u([E("esri.form.elements.inputs.DateTimeOffsetPickerInput")],Xi);const dbe=Xi;var Q3;function wN(t){return t!=null?new Date(t):null}function _N(t){return t?t.getTime():null}let An=Q3=class extends Fl{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return wN(e.max)}writeMax(t,e){e.max=_N(t)}readMin(t,e){return wN(e.min)}writeMin(t,e){e.min=_N(t)}clone(){return new Q3({includeTime:this.includeTime,max:this.max,min:this.min})}};u([h({type:Boolean,json:{write:!0}})],An.prototype,"includeTime",void 0),u([h({type:Date,json:{type:Number,write:!0}})],An.prototype,"max",void 0),u([X("max")],An.prototype,"readMax",null),u([te("max")],An.prototype,"writeMax",null),u([h({type:Date,json:{type:Number,write:!0}})],An.prototype,"min",void 0),u([X("min")],An.prototype,"readMin",null),u([te("min")],An.prototype,"writeMin",null),u([h({type:["datetime-picker"],json:{read:!1,write:!0}})],An.prototype,"type",void 0),An=Q3=u([E("esri.form.elements.inputs.DateTimePickerInput")],An);const pbe=An;var eE;let Rp=eE=class extends Fl{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new eE({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};u([h({type:String,json:{write:!0}})],Rp.prototype,"noValueOptionLabel",void 0),u([h({type:Boolean,json:{write:!0}})],Rp.prototype,"showNoValueOption",void 0),u([h({type:["radio-buttons"],json:{read:!1,write:!0}})],Rp.prototype,"type",void 0),Rp=eE=u([E("esri.form.elements.inputs.RadioButtonsInput")],Rp);const fbe=Rp;var tE;let Op=tE=class extends Fl{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new tE({offValue:this.offValue,onValue:this.onValue})}};u([h({type:[String,Number],json:{write:!0}})],Op.prototype,"offValue",void 0),u([h({type:[String,Number],json:{write:!0}})],Op.prototype,"onValue",void 0),u([h({type:["switch"],json:{read:!1,write:!0}})],Op.prototype,"type",void 0),Op=tE=u([E("esri.form.elements.inputs.SwitchInput")],Op);const mbe=Op;var rE;let Fb=rE=class extends Jk{constructor(t){super(t),this.type="text-area"}clone(){return new rE({maxLength:this.maxLength,minLength:this.minLength})}};u([h({type:["text-area"],json:{read:!1,write:!0}})],Fb.prototype,"type",void 0),Fb=rE=u([E("esri.form.elements.inputs.TextAreaInput")],Fb);const ybe=Fb;var iE;let Nb=iE=class extends Jk{constructor(t){super(t),this.type="text-box"}clone(){return new iE({maxLength:this.maxLength,minLength:this.minLength})}};u([h({type:["text-box"],json:{read:!1,write:!0}})],Nb.prototype,"type",void 0),Nb=iE=u([E("esri.form.elements.inputs.TextBoxInput")],Nb);const gbe=Nb;var sE;function j$(t){return t??null}function V$(t){return t??null}let xs=sE=class extends Fl{constructor(t){super(t),this.max=null,this.min=null,this.timeResolution="minutes",this.type="time-picker"}readMax(t,e){return j$(e.max)}writeMax(t,e){e.max=V$(t)}readMin(t,e){return j$(e.min)}writeMin(t,e){e.min=V$(t)}readTimeResolution(t,e){return j$(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=V$(t)}clone(){return new sE({max:this.max,min:this.min,timeResolution:this.timeResolution})}};u([h({type:String,json:{type:String,write:!0}})],xs.prototype,"max",void 0),u([X("max")],xs.prototype,"readMax",null),u([te("max")],xs.prototype,"writeMax",null),u([h({type:String,json:{type:String,write:!0}})],xs.prototype,"min",void 0),u([X("min")],xs.prototype,"readMin",null),u([te("min")],xs.prototype,"writeMin",null),u([h({type:String,json:{type:String,write:!0}})],xs.prototype,"timeResolution",void 0),u([X("timeResolution")],xs.prototype,"readTimeResolution",null),u([te("timeResolution")],xs.prototype,"writeTimeResolution",null),u([h({type:["time-picker"],json:{read:!1,write:!0}})],xs.prototype,"type",void 0),xs=sE=u([E("esri.form.elements.inputs.TimePickerInput")],xs);const vbe=xs,wbe=ube,_be=cbe,bbe=hbe,Sbe=dbe,xbe=pbe,$be=fbe,Mbe=mbe,Tbe=ybe,Ibe=gbe,Ebe=vbe,Cbe={base:Fl,key:"type",typeMap:{"barcode-scanner":wbe,"combo-box":_be,"date-picker":bbe,"datetime-picker":xbe,"datetimeoffset-picker":Sbe,"radio-buttons":$be,switch:Mbe,"text-area":Tbe,"text-box":Ibe,"time-picker":Ebe}};var nE;let Es=nE=class extends ls{constructor(t){super(t),this.domain=null,this.editable=null,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}clone(){return new nE({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};u([h({types:N7,json:{read:{reader:O2},write:!0}})],Es.prototype,"domain",void 0),u([h({type:Boolean,json:{write:!0}})],Es.prototype,"editable",void 0),u([h({type:String,json:{write:!0}})],Es.prototype,"editableExpression",void 0),u([h({type:String,json:{write:!0}})],Es.prototype,"fieldName",void 0),u([h({type:String,json:{write:!0}})],Es.prototype,"hint",void 0),u([h({types:Cbe,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Es.prototype,"input",void 0),u([h({type:String,json:{write:!0}})],Es.prototype,"requiredExpression",void 0),u([h({type:String,json:{read:!1,write:!0}})],Es.prototype,"type",void 0),u([h({type:String,json:{write:!0}})],Es.prototype,"valueExpression",void 0),Es=nE=u([E("esri.form.elements.FieldElement")],Es);var oE;let Ha=oE=class extends ls{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editableExpression=null,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new oE({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editableExpression:this.editableExpression,label:this.label,orderByFields:O(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};u([h({type:Number,json:{write:!0}})],Ha.prototype,"displayCount",void 0),u([h({type:["list"],json:{write:!0}})],Ha.prototype,"displayType",void 0),u([h({type:String,json:{write:!0}})],Ha.prototype,"editableExpression",void 0),u([h({type:[yk],json:{write:!0}})],Ha.prototype,"orderByFields",void 0),u([h({type:Number,json:{write:!0}})],Ha.prototype,"relationshipId",void 0),u([h({type:["relationship"],json:{read:!1,write:!0}})],Ha.prototype,"type",void 0),Ha=oE=u([E("esri.form.elements.RelationshipElement")],Ha);const bN=Ha;var aE;let Fp=aE=class extends ls{constructor(t){super(t),this.text=null,this.textFormat="plain-text",this.type="text"}clone(){return new aE({text:this.text,textFormat:this.textFormat,visibilityExpression:this.visibilityExpression})}};u([h({type:String,json:{write:!0}})],Fp.prototype,"text",void 0),u([h({type:String,json:{write:!0}})],Fp.prototype,"textFormat",void 0),u([h({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],Fp.prototype,"type",void 0),Fp=aE=u([E("esri.form.elements.TextElement")],Fp);const SN=Fp;let Np=class extends Ie(ls){constructor(e){super(e),this.associationTypes=null,this.editableExpression=null,this.type="utilityNetworkAssociations"}};u([h({type:[h7],json:{write:{isRequired:!0}}})],Np.prototype,"associationTypes",void 0),u([h({type:String,json:{write:!0}})],Np.prototype,"editableExpression",void 0),u([h({type:["utilityNetworkAssociations"],json:{read:!1,write:!0}})],Np.prototype,"type",void 0),Np=u([E("esri.form.elements.UtilityNetworkAssociationsElement")],Np);const xN=Np,Pbe=t=>t.type==="field",kbe=t=>t.type==="group",Lbe=t=>t.type==="text";function wB(t){return{typesWithGroup:{base:ls,key:"type",typeMap:{attachment:yN,field:Es,group:t,relationship:bN,text:SN,utilityNetworkAssociations:xN}},typesWithoutGroup:{base:ls,key:"type",typeMap:{attachment:yN,field:Es,relationship:bN,text:SN,utilityNetworkAssociations:xN}}}}function _B(t,e,r=!0){if(!t)return null;const i=r?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(s=>i[s.type]).map(s=>i[s.type].fromJSON(s))}function bB(t,e,r=!0){if(!t)return null;const i=r?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(s=>i[s.type]).map(s=>s.toJSON())}function SB(t,e,r=!0){return t?t.map(i=>ma(r?e.typesWithGroup:e.typesWithoutGroup,i)):null}var lE;let So=lE=class extends ls{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return SB(t,U$,!1)}readElements(t,e){return _B(e.formElements,U$,!1)}writeElements(t,e){e.formElements=bB(t,U$,!1)}clone(){return new lE({description:this.description,elements:O(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};u([h({json:{write:!0}})],So.prototype,"elements",void 0),u([He("elements")],So.prototype,"castElements",null),u([X("elements",["formElements"])],So.prototype,"readElements",null),u([te("elements")],So.prototype,"writeElements",null),u([h({type:["collapsed","expanded"],json:{write:!0}})],So.prototype,"initialState",void 0),u([h({type:String,json:{read:!1,write:!0}})],So.prototype,"type",void 0),So=lE=u([E("esri.form.elements.GroupElement")],So);const U$=wB(So),Abe=So;var uE;const G$=wB(Abe);let Rn=uE=class extends W{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(t){return SB(t,G$)}readElements(t,e){return _B(e.formElements,G$)}writeElements(t,e){e.formElements=bB(t,G$)}clone(){return new uE({description:this.description,expressionInfos:O(this.expressionInfos),elements:O(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}async getFieldsUsed(t,e){const r=new Set,{description:i,elements:s,expressionInfos:n,title:o}=this;if($0(r,t,i),$0(r,t,o),!s)return[];const a=Rbe(s,n).map(l=>ei(r,t,null,l));await Promise.all(a);for(const l of s)xB(r,{fieldsIndex:t,relationships:e},l);return Array.from(r).sort()}};function xB(t,e,r){const{fieldsIndex:i}=e;if(!i||i.fields.length!==t.size)switch($0(t,i,r.label),$0(t,i,r.description),r.type){case"field":Mi(t,i,r.fieldName);break;case"group":r.elements.forEach(s=>xB(t,e,s));break;case"relationship":if(e.relationships){const s=e.relationships.find(n=>n.id===r.relationshipId);s&&Mi(t,i,s.keyField)}lc(t,i,r.orderByFields?.map(s=>s.field));break;case"text":$0(t,i,r.text)}}function Rbe(t,e){if(!e||e.length===0)return[];const r=$B(t),i=[];for(const s of e)r.has(s.name)&&i.push(s.expression);return i}function $B(t){const e=new Set;for(const r of t)if(zA(e,r.visibilityExpression),!Lbe(r)){if(kbe(r))b1(e,$B(r.elements));else if(zA(e,r.editableExpression),Pbe(r)){const{requiredExpression:i,valueExpression:s}=r;b1(e,[i,s])}}return e}function $0(t,e,r){lc(t,e,dk(r))}u([h({type:String,json:{write:!0}})],Rn.prototype,"description",void 0),u([h({json:{write:!0}})],Rn.prototype,"elements",void 0),u([He("elements")],Rn.prototype,"castElements",null),u([X("elements",["formElements"])],Rn.prototype,"readElements",null),u([te("elements")],Rn.prototype,"writeElements",null),u([h({type:[ibe],json:{write:!0}})],Rn.prototype,"expressionInfos",void 0),u([h({type:Boolean,json:{default:!1,write:!0}})],Rn.prototype,"preserveFieldValuesWhenHidden",void 0),u([h({type:String,json:{write:!0}})],Rn.prototype,"title",void 0),Rn=uE=u([E("esri.form.FormTemplate")],Rn);const Obe=Symbol("getSliceableSymbol");let nv=class{};nv=u([E("esri.graphic.GraphicOrigin")],nv);const Fbe=Symbol("isFeatureGraphicOrigin");var $N;let Nbe=class extends nv{get[($N=Fbe,Uv)](){return this.layer}get[wk](){return this.layer}get[Obe](){return this.layer}constructor(e){super(),this[$N]=!0,this.type="feature",this.layer=e}get id(){return this.layer.id}};function MN(t,e,r){if(t.hasM==null||t.hasZ)for(const i of e)for(const s of i)s.length>2&&(s[2]*=r)}function Dbe(t,e,r){if(!t&&!e||!r)return;const i=L1(r);TN(t,r,i),TN(e,r,i)}function TN(t,e,r){if(t)for(const i of t)zbe(i.geometry,e,r)}function zbe(t,e,r){if(!t?.spatialReference||Cr(t.spatialReference,e))return;const i=L1(t.spatialReference)/r;if(i!==1){if("x"in t)t.z!=null&&(t.z*=i);else if("rings"in t)MN(t,t.rings,i);else if("paths"in t)MN(t,t.paths,i);else if("points"in t&&(t.hasM==null||t.hasZ))for(const s of t.points)s.length>2&&(s[2]*=i)}}function IN(t,e,r){if(!r?.features||!r.hasZ)return;const i=c9(r.geometryType,e,t.outSpatialReference);if(i!=null)for(const s of r.features)i(s.geometry)}var cE;const hE=new Ne({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let xr=cE=class extends W{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){return this.readFeaturesWithClass(t,e,Rt)}writeGeometryType(t,e,r,i){if(t)return void hE.write(t,e,r,i);const{features:s}=this;if(s){for(const n of s)if(n?.geometry!=null)return void hE.write(n.geometry.type,e,r,i)}}readQueryGeometry(t,e){if(!t)return null;const r=!!t.spatialReference,i=ac(t);return i&&!r&&e.spatialReference&&(i.spatialReference=ne.fromJSON(e.spatialReference)),i}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:r}=this;if(r){for(const i of r)if(i&&i.geometry!=null&&i.geometry.spatialReference)return void(e.spatialReference=i.geometry.spatialReference.toJSON())}}clone(){return new cE(this.cloneProperties())}cloneProperties(){return O({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let r=0;r<e.features.length;r++){const i=e.features[r];if(i.geometry){const s=t?.[r];i.geometry=s?.toJSON()||i.geometry}}return e}quantize(t){const{scale:[e,r],translate:[i,s]}=t,n=c=>Math.round((c-i)/e),o=c=>Math.round((s-c)/r),a=this.features,l=this._getQuantizationFunction(this.geometryType,n,o);for(let c=0,d=a.length;c<d;c++)l?.(a[c].geometry)||(a.splice(c,1),c--,d--);return this.transform=t,this}unquantize(){const{geometryType:t,features:e,transform:r}=this;if(!r)return this;const{translate:[i,s],scale:[n,o]}=r,a=m=>m*n+i,l=m=>s-m*o;let c=null,d=null;if(this.hasZ&&r?.scale?.[2]!=null){const{translate:[,,m],scale:[,,y]}=r;c=g=>g*y+m}if(this.hasM&&r?.scale?.[3]!=null){const{translate:[,,,m],scale:[,,,y]}=r;d=g=>g==null?g:g*y+m}const p=this._getHydrationFunction(t,a,l,c,d);for(const{geometry:m}of e)m!=null&&p&&p(m);return this.transform=null,this}readFeaturesWithClass(t,e,r){const i=ne.fromJSON(e.spatialReference),s=[];for(let n=0;n<t.length;n++){const o=t[n],a=r.fromJSON(o),l=o.geometry?.spatialReference;a.geometry==null||l||(a.geometry.spatialReference=i);const c=o.aggregateGeometries,d=a.aggregateGeometries;if(c&&d!=null)for(const p in d){const m=d[p],y=c[p],g=y?.spatialReference;m==null||g||(m.spatialReference=i)}s.push(a)}return s}_quantizePoints(t,e,r){let i,s;const n=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];if(o>0){const c=e(l[0]),d=r(l[1]);c===i&&d===s||(n.push([c-i,d-s]),i=c,s=d)}else i=e(l[0]),s=r(l[1]),n.push([i,s])}return n.length>0?n:null}_getQuantizationFunction(t,e,r){return t==="point"?i=>(i.x=e(i.x),i.y=r(i.y),i):t==="polyline"||t==="polygon"?i=>{const s=Kt(i)?i.rings:i.paths,n=[];for(let o=0,a=s.length;o<a;o++){const l=s[o],c=this._quantizePoints(l,e,r);c&&n.push(c)}return n.length>0?(Kt(i)?i.rings=n:i.paths=n,i):null}:t==="multipoint"?i=>{const s=this._quantizePoints(i.points,e,r);return s&&s.length>0?(i.points=s,i):null}:t==="extent"?i=>i:null}_getHydrationFunction(t,e,r,i,s){return t==="point"?n=>{n.x=e(n.x),n.y=r(n.y),i&&(n.z=i(n.z))}:t==="polyline"||t==="polygon"?n=>{const o=Kt(n)?n.rings:n.paths;let a,l;for(let c=0,d=o.length;c<d;c++){const p=o[c];for(let m=0,y=p.length;m<y;m++){const g=p[m];m>0?(a+=g[0],l+=g[1]):(a=g[0],l=g[1]),g[0]=e(a),g[1]=r(l)}}if(i&&s)for(let c=0,d=o.length;c<d;c++){const p=o[c];for(let m=0,y=p.length;m<y;m++){const g=p[m];g[2]=i(g[2]),g[3]=s(g[3])}}else if(i)for(let c=0,d=o.length;c<d;c++){const p=o[c];for(let m=0,y=p.length;m<y;m++){const g=p[m];g[2]=i(g[2])}}else if(s)for(let c=0,d=o.length;c<d;c++){const p=o[c];for(let m=0,y=p.length;m<y;m++){const g=p[m];g[2]=s(g[2])}}}:t==="extent"?n=>{n.xmin=e(n.xmin),n.ymin=r(n.ymin),n.xmax=e(n.xmax),n.ymax=r(n.ymax),i&&n.zmax!=null&&n.zmin!=null&&(n.zmax=i(n.zmax),n.zmin=i(n.zmin)),s&&n.mmax!=null&&n.mmin!=null&&(n.mmax=s(n.mmax),n.mmin=s(n.mmin))}:t==="multipoint"?n=>{const o=n.points;let a,l;for(let c=0,d=o.length;c<d;c++){const p=o[c];c>0?(a+=p[0],l+=p[1]):(a=p[0],l=p[1]),p[0]=e(a),p[1]=r(l)}if(i&&s)for(let c=0,d=o.length;c<d;c++){const p=o[c];p[2]=i(p[2]),p[3]=s(p[3])}else if(i)for(let c=0,d=o.length;c<d;c++){const p=o[c];p[2]=i(p[2])}else if(s)for(let c=0,d=o.length;c<d;c++){const p=o[c];p[2]=s(p[2])}}:null}};u([h({type:String,json:{write:!0}})],xr.prototype,"displayFieldName",void 0),u([h({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],xr.prototype,"exceededTransferLimit",void 0),u([h({type:[Rt],json:{write:!0}})],xr.prototype,"features",void 0),u([X("features")],xr.prototype,"readFeatures",null),u([h({type:[Dr],json:{write:!0}})],xr.prototype,"fields",void 0),u([h({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:hE.read}}})],xr.prototype,"geometryType",void 0),u([te("geometryType")],xr.prototype,"writeGeometryType",null),u([h({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],xr.prototype,"hasM",void 0),u([h({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],xr.prototype,"hasZ",void 0),u([h({types:jv,json:{write:!0}})],xr.prototype,"queryGeometry",void 0),u([X("queryGeometry")],xr.prototype,"readQueryGeometry",null),u([h({type:ne,json:{write:!0}})],xr.prototype,"spatialReference",void 0),u([te("spatialReference")],xr.prototype,"writeSpatialReference",null),u([h({json:{write:!0}})],xr.prototype,"transform",void 0),xr=cE=u([E("esri.rest.support.FeatureSet")],xr),xr.prototype.toJSON.isDefaultToJSON=!0;let jbe=0,tl=class extends W6(hP(se)){constructor(e){super(e),this._idToClientGeometry=null,this.type="memory"}load(e){const r=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(r)),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null}get _workerGeometryType(){const e=this.layer?.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(e){return this.load().then(()=>this._applyEdits(e))}openPorts(){return this.load().then(()=>this._connection.openPorts())}async queryFeatures(e,r={}){await this.load(r);const i=await this._connection.invoke("queryFeatures",e?e.toJSON():null,r);IN(e,this.layer.spatialReference,i);const s=xr.fromJSON(i);if(!this._requiresClientGraphicMapping()||!this._idToClientGeometry)return s;const n=this.layer.objectIdField;for(const o of s.features){const a=o.attributes[n],l=this._idToClientGeometry.get(a);l!==void 0&&(o.geometry=l)}return s.geometryType=this.layer.geometryType,s}async queryFeaturesJSON(e,r={}){if(this._requiresClientGraphicMapping())throw new R("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(r);const i=await this._connection.invoke("queryFeatures",e?e.toJSON():null,r);return IN(e,this.layer.spatialReference,i),i}queryFeatureCount(e,r={}){return this.load(r).then(()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,r))}queryObjectIds(e,r={}){return this.load(r).then(()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,r))}queryExtent(e,r={}){return this.load(r).then(()=>this._connection.invoke("queryExtent",e?e.toJSON():null,r)).then(i=>({count:i.count,extent:Te.fromJSON(i.extent)}))}querySnapping(e,r={}){return this.load(r).then(()=>this._connection.invoke("querySnapping",e,r))}async queryAttributeBins(e,r={}){return await this.load(),this._connection.invoke("queryAttributeBins",e?.toJSON(),r)}async _applyEdits(e){if(!this._connection)throw new R("feature-layer-source:edit-failure","Memory source not loaded");const r=this.layer.objectIdField;let i=null;const s=[],n=[];await Promise.all([this._prepareClientMapping(e.addFeatures,null),this._prepareClientMapping(e.updateFeatures,null)]);const o=d=>"objectId"in d&&d.objectId!=null?d.objectId:"attributes"in d&&d.attributes[r]!=null?d.attributes[r]:null;if(e.addFeatures&&(i=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(const d of e.deleteFeatures){const p=o(d);p!=null&&s.push(p)}const a=e.updateFeatures&&this._idToClientGeometry?new Map:null;if(e.updateFeatures){for(const d of e.updateFeatures)if(n.push(this._serializeFeature(d)),a&&d.geometry!=null){const p=o(d);p!=null&&a.set(p,d)}}Dbe(i?i.features:null,n,this.layer.spatialReference);const{fullExtent:l,featureEditResults:c}=await this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:n,deletes:s});return this.fullExtent=l,i&&i.finish(c.uidToObjectId),this._updateIdToClientGeometries(a,c),this._createEditsResult(c)}async _prepareClientMapping(e,r){if(this._layerOrSourceGeometryType!=="mesh"||e==null)return;const i=[];for(const{geometry:s}of e)s==null||s.type!=="mesh"||s.hasExtent||s.loaded||i.push(s.load({signal:r}));i.length&&await Promise.all(i)}_updateIdToClientGeometries(e,r){if(this._idToClientGeometry){if(e)for(const i of r.updateResults){if(!i.success)continue;const s=e.get(i.objectId);s!=null&&this._addIdToClientGeometry(s)}for(const i of r.deleteResults)i.success&&this._idToClientGeometry.delete(i.objectId)}}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const r=e.success===!0?null:e.error||{code:void 0,description:""};return{objectId:e.objectId,globalId:e.globalId,error:r?new R("feature-layer-source:edit-failure",r.description,{code:r.code}):null}}_prepareAddFeatures(e){const r=new Map,i=new Array(e.length);let s=null;for(let o=0;o<e.length;o++){const a=e[o],l=this._serializeFeature(a);s||a.geometry==null||(s=a.geometry.type),i[o]=l,r.set(`${l.uid}`,a)}const n=this;return{features:i,inferredGeometryType:s,finish(o){const a=n.sourceJSON.objectIdField;for(const l in o){const c=o[l],d=r.get(l);d&&(d.attributes||(d.attributes={}),c===-1?delete d.attributes[a]:d.attributes[a]=c,n._addIdToClientGeometry(d))}}}}_addIdToClientGeometry(e){if(!this._idToClientGeometry)return;const r=this.sourceJSON.objectIdField,i=e.attributes?.[r];i!=null&&this._idToClientGeometry.set(i,e.geometry??null)}get _layerOrSourceGeometryType(){return this.layer?.geometryType??this.sourceJSON?.geometryType}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}_geometryTypeRequiresClientGraphicMapping(e){return e==="mesh"||e==="multipatch"||e==="extent"}_serializeFeature(e){const{attributes:r}=e,i=this._geometryForSerialization(e),s=(jbe++).toString();return i?{uid:s,geometry:i.toJSON(),attributes:r}:{uid:s,attributes:r}}_geometryForSerialization(e){const{geometry:r}=e;return r==null?null:this._geometryRequiresClientGraphicMapping(r)?r.extent?dt.fromExtent(r.extent):null:r}async _startWorker(e){this._connection=await zue("MemorySourceWorker",{strategy:z("feature-layers-workers")?"dedicated":"local",signal:e,registryTarget:this});const{fields:r,spatialReference:i,objectIdField:s,hasM:n,hasZ:o,timeInfo:a,dateFieldsTimeZone:l}=this.layer,c=this.layer.originOf("spatialReference")==="defaults";await this._prepareClientMapping(this.items,e);const d=this._prepareAddFeatures(this.items);this.addHandles(this.on("before-changes",g=>{U.getLogger(this).error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),g.preventDefault()}));const p={features:d.features,fields:r?.map(g=>g.toJSON()),geometryType:IO.toJSON(this._workerGeometryType),hasM:this._layerOrSourceGeometryType!=="mesh"&&n,hasZ:this._layerOrSourceGeometryType==="mesh"||o,objectIdField:s,spatialReference:c?null:i&&i.toJSON(),timeInfo:a?.toJSON()??null,dateFieldsTimeZone:l},m=await this._connection.invoke("load",p,{signal:e});for(const g of m.warnings)U.getLogger(this.layer).warn("#load()",`${g.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:g});m.featureErrors.length&&U.getLogger(this.layer).warn("#load()",`Encountered ${m.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:m.featureErrors});const y=m.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(d.inferredGeometryType)&&(y.geometryType=IO.toJSON(d.inferredGeometryType)),this.sourceJSON=y,this._requiresClientGraphicMapping()&&(this._idToClientGeometry=new Map),d.finish(m.assignedObjectIds)}};u([cP({Type:Rt,ensureType:jt(Rt)})],tl.prototype,"itemType",void 0),u([h()],tl.prototype,"type",void 0),u([h({constructOnly:!0})],tl.prototype,"layer",void 0),u([h({readOnly:!0})],tl.prototype,"_workerGeometryType",null),u([h()],tl.prototype,"sourceJSON",void 0),tl=u([E("esri.layers.graphics.sources.MemorySource")],tl);function Vbe(t){return"portalItem"in t}const Ube=t=>{const e=t;let r=class extends e{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):Vbe(this)?this.portalItem?.apiKey:null}set apiKey(i){i!=null?this._override("apiKey",i):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return u([h({type:String})],r.prototype,"apiKey",null),r=u([E("esri.layers.mixins.APIKeyMixin")],r),r},Gbe=t=>{const e=t;let r=class extends e{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const i=pc(this.url);if(i?.title)return i.title}return this._get("title")||""}set title(i){this._set("title",i)}set url(i){this._set("url",WX(i,U.getLogger(this)))}};return u([h()],r.prototype,"title",null),u([h({type:String})],r.prototype,"url",null),r=u([E("esri.layers.mixins.ArcGISService")],r),r};let EN=class extends SyntaxError{constructor(e,r,i,s){super(e),this.expected=r,this.found=i,this.location=s,this.name="SyntaxError"}format(e){let r="Error: "+this.message;if(this.location){let i=null;const s=e.find(l=>l.source===this.location.source);s&&(i=s.text.split(/\r\n|\n|\r/g));const n=this.location.start,o=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(n):n,a=this.location.source+":"+o.line+":"+o.column;if(i){const l=this.location.end,c="".padEnd(o.line.toString().length," "),d=i[n.line-1],p=(n.line===l.line?l.column:d.length+1)-n.column||1;r+=`
 --> `+a+`
`+c+` |
`+o.line+" | "+d+`
`+c+" | "+"".padEnd(n.column-1," ")+"".padEnd(p,"^")}else r+=`
 at `+a}return r}static buildMessage(e,r){function i(m){return m.codePointAt(0).toString(16).toUpperCase()}const s=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function n(m){return s?m.replace(s,y=>"\\u{"+i(y)+"}"):m}function o(m){return n(m.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,y=>"\\x0"+i(y)).replace(/[\x10-\x1F\x7F-\x9F]/g,y=>"\\x"+i(y)))}function a(m){return n(m.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,y=>"\\x0"+i(y)).replace(/[\x10-\x1F\x7F-\x9F]/g,y=>"\\x"+i(y)))}const l={literal:m=>'"'+o(m.text)+'"',class(m){const y=m.parts.map(g=>Array.isArray(g)?a(g[0])+"-"+a(g[1]):a(g));return"["+(m.inverted?"^":"")+y.join("")+"]"+(m.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:m=>m.description};function c(m){return l[m.type](m)}function d(m){const y=m.map(c);if(y.sort(),y.length>0){let g=1;for(let v=1;v<y.length;v++)y[v-1]!==y[v]&&(y[g]=y[v],g++);y.length=g}switch(y.length){case 1:return y[0];case 2:return y[0]+" or "+y[1];default:return y.slice(0,-1).join(", ")+", or "+y[y.length-1]}}function p(m){return m?'"'+o(m)+'"':"end of input"}return"Expected "+d(e)+" but "+p(r)+" found."}};function qbe(t,e){const r={},i=(e=e!==void 0?e:{}).grammarSource,s={start:oA};let n=oA;const o="none",a=")",l=",",c="(",d="%",p="px",m="cm",y="mm",g="in",v="pt",w="pc",_="deg",x="rad",$="grad",T="turn",C="#",P=".",A="e",F=/^[ \t\n\r]/,j=/^[a-z\-]/,V=/^[0-9a-fA-F]/,Z=/^[+\-]/,Y=/^[0-9]/,re=Gl("none"),Q=kr("none",!1),Ee=kr(")",!1),et=kr(",",!1),lt=py([" ","	",`
`,"\r"],!1,!1,!1),Ve=Gl("function"),vr=kr("(",!1),Dl=Gl("identifier"),zl=py([["a","z"],"-"],!1,!1,!1),bc=Gl("percentage"),jl=kr("%",!1),Sc=Gl("length"),ly=kr("px",!1),Vl=kr("cm",!1),uy=kr("mm",!1),cy=kr("in",!1),hy=kr("pt",!1),xc=kr("pc",!1),Cd=Gl("angle"),VJ=kr("deg",!1),UJ=kr("rad",!1),GJ=kr("grad",!1),qJ=kr("turn",!1),BJ=Gl("number"),HJ=Gl("color"),WJ=kr("#",!1),rA=py([["0","9"],["a","f"],["A","F"]],!1,!1,!1),iA=py(["+","-"],!1,!1,!1),Ul=py([["0","9"]],!1,!1,!1),ZJ=kr(".",!1),JJ=kr("e",!1);function YJ(){return[]}function XJ(k,G){return{type:"function",name:k,parameters:G||[]}}function KJ(k,G){return G.length>0?kY(k,G,3):[k]}function QJ(k){return{type:"quantity",value:k.value,unit:k.unit}}function eY(k){return{type:"color",colorType:k.type,value:k.value}}function QAe(k){return k}function tY(){return ow()}function rY(k){return{value:k,unit:"%"}}function iY(k){return{value:k,unit:"px"}}function sY(k){return{value:k,unit:"cm"}}function nY(k){return{value:k,unit:"mm"}}function oY(k){return{value:k,unit:"in"}}function aY(k){return{value:k,unit:"pt"}}function lY(k){return{value:k,unit:"pc"}}function uY(k){return{value:k,unit:"deg"}}function cY(k){return{value:k,unit:"rad"}}function hY(k){return{value:k,unit:"grad"}}function dY(k){return{value:k,unit:"turn"}}function pY(k){return{value:k,unit:null}}function fY(){return{type:"hex",value:ow()}}function mY(k){return{type:"function",value:k}}function yY(){return{type:"named",value:ow()}}function gY(){return parseFloat(ow())}let B=0|e.peg$currPos,kt=B;const Pd=[{line:1,column:1}];let dy,vn=B,nw=e.peg$maxFailExpected||[],ge=0|e.peg$silentFails;if(e.startRule){if(!(e.startRule in s))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');n=s[e.startRule]}function ow(){return t.substring(kt,B)}function vY(k=B){const G=t.codePointAt(k);return G===void 0?"":String.fromCodePoint(G)}function kr(k,G){return{type:"literal",text:k,ignoreCase:G}}function py(k,G,ee,$e){return{type:"class",parts:k,inverted:G,ignoreCase:ee,unicode:$e}}function wY(){return{type:"end"}}function Gl(k){return{type:"other",description:k}}function sA(k){let G,ee=Pd[k];if(ee)return ee;if(k>=Pd.length)G=Pd.length-1;else for(G=k;!Pd[--G];);for(ee=Pd[G],ee={line:ee.line,column:ee.column};G<k;)t.charCodeAt(G)===10?(ee.line++,ee.column=1):ee.column++,G++;return Pd[k]=ee,ee}function nA(k,G,ee){const $e=sA(k),st=sA(G);return{source:i,start:{offset:k,line:$e.line,column:$e.column},end:{offset:G,line:st.line,column:st.column}}}function ke(k){B<vn||(B>vn&&(vn=B,nw=[]),nw.push(k))}function _Y(k,G,ee){return new EN(EN.buildMessage(k,G),k,G,ee)}function oA(){let k;return k=bY(),k===r&&(k=SY()),k}function bY(){let k,G;return ge++,k=B,Lr(),t.substr(B,4)===o?(G=o,B+=4):(G=r,ge===0&&ke(Q)),G!==r?(Lr(),kt=k,k=YJ()):(B=k,k=r),ge--,k===r&&ge===0&&ke(re),k}function SY(){let k,G;if(k=[],G=yx(),G!==r)for(;G!==r;)k.push(G),G=yx();else k=r;return k}function yx(){let k,G,ee,$e;return k=B,Lr(),G=$Y(),G!==r?(Lr(),ee=xY(),ee===r&&(ee=null),Lr(),t.charCodeAt(B)===41?($e=a,B++):($e=r,ge===0&&ke(Ee)),$e!==r?(Lr(),kt=k,k=XJ(G,ee)):(B=k,k=r)):(B=k,k=r),k}function xY(){let k,G,ee,$e,st,Gt,wr,ti;if(k=B,G=gx(),G!==r){for(ee=[],$e=B,st=Lr(),t.charCodeAt(B)===44?(Gt=l,B++):(Gt=r,ge===0&&ke(et)),Gt===r&&(Gt=null),wr=Lr(),ti=gx(),ti!==r?(st=[st,Gt,wr,ti],$e=st):(B=$e,$e=r);$e!==r;)ee.push($e),$e=B,st=Lr(),t.charCodeAt(B)===44?(Gt=l,B++):(Gt=r,ge===0&&ke(et)),Gt===r&&(Gt=null),wr=Lr(),ti=gx(),ti!==r?(st=[st,Gt,wr,ti],$e=st):(B=$e,$e=r);kt=k,k=KJ(G,ee)}else B=k,k=r;return k}function gx(){let k,G;return k=B,G=MY(),G===r&&(G=TY(),G===r&&(G=IY(),G===r&&(G=EY()))),G!==r&&(kt=k,G=QJ(G)),k=G,k===r&&(k=B,G=CY(),G!==r&&(kt=k,G=eY(G)),k=G),k}function Lr(){let k,G;for(ge++,k=[],G=t.charAt(B),F.test(G)?B++:(G=r,ge===0&&ke(lt));G!==r;)k.push(G),G=t.charAt(B),F.test(G)?B++:(G=r,ge===0&&ke(lt));return ge--,k}function $Y(){let k,G,ee;return ge++,k=B,G=aA(),G!==r?(t.charCodeAt(B)===40?(ee=c,B++):(ee=r,ge===0&&ke(vr)),ee!==r?(kt=k,k=G):(B=k,k=r)):(B=k,k=r),ge--,k===r&&(G=r,ge===0&&ke(Ve)),k}function aA(){let k,G,ee;if(ge++,k=B,G=[],ee=t.charAt(B),j.test(ee)?B++:(ee=r,ge===0&&ke(zl)),ee!==r)for(;ee!==r;)G.push(ee),ee=t.charAt(B),j.test(ee)?B++:(ee=r,ge===0&&ke(zl));else G=r;return G!==r&&(kt=k,G=tY()),k=G,ge--,k===r&&(G=r,ge===0&&ke(Dl)),k}function MY(){let k,G,ee;return ge++,k=B,Lr(),G=Us(),G!==r?(t.charCodeAt(B)===37?(ee=d,B++):(ee=r,ge===0&&ke(jl)),ee!==r?(kt=k,k=rY(G)):(B=k,k=r)):(B=k,k=r),ge--,k===r&&ge===0&&ke(bc),k}function TY(){let k,G,ee;return ge++,k=B,Lr(),G=Us(),G!==r?(t.substr(B,2)===p?(ee=p,B+=2):(ee=r,ge===0&&ke(ly)),ee!==r?(kt=k,k=iY(G)):(B=k,k=r)):(B=k,k=r),k===r&&(k=B,Lr(),G=Us(),G!==r?(t.substr(B,2)===m?(ee=m,B+=2):(ee=r,ge===0&&ke(Vl)),ee!==r?(kt=k,k=sY(G)):(B=k,k=r)):(B=k,k=r),k===r&&(k=B,Lr(),G=Us(),G!==r?(t.substr(B,2)===y?(ee=y,B+=2):(ee=r,ge===0&&ke(uy)),ee!==r?(kt=k,k=nY(G)):(B=k,k=r)):(B=k,k=r),k===r&&(k=B,Lr(),G=Us(),G!==r?(t.substr(B,2)===g?(ee=g,B+=2):(ee=r,ge===0&&ke(cy)),ee!==r?(kt=k,k=oY(G)):(B=k,k=r)):(B=k,k=r),k===r&&(k=B,Lr(),G=Us(),G!==r?(t.substr(B,2)===v?(ee=v,B+=2):(ee=r,ge===0&&ke(hy)),ee!==r?(kt=k,k=aY(G)):(B=k,k=r)):(B=k,k=r),k===r&&(k=B,Lr(),G=Us(),G!==r?(t.substr(B,2)===w?(ee=w,B+=2):(ee=r,ge===0&&ke(xc)),ee!==r?(kt=k,k=lY(G)):(B=k,k=r)):(B=k,k=r)))))),ge--,k===r&&ge===0&&ke(Sc),k}function IY(){let k,G,ee;return ge++,k=B,G=Us(),G!==r?(t.substr(B,3)===_?(ee=_,B+=3):(ee=r,ge===0&&ke(VJ)),ee!==r?(kt=k,k=uY(G)):(B=k,k=r)):(B=k,k=r),k===r&&(k=B,G=Us(),G!==r?(t.substr(B,3)===x?(ee=x,B+=3):(ee=r,ge===0&&ke(UJ)),ee!==r?(kt=k,k=cY(G)):(B=k,k=r)):(B=k,k=r),k===r&&(k=B,G=Us(),G!==r?(t.substr(B,4)===$?(ee=$,B+=4):(ee=r,ge===0&&ke(GJ)),ee!==r?(kt=k,k=hY(G)):(B=k,k=r)):(B=k,k=r),k===r&&(k=B,G=Us(),G!==r?(t.substr(B,4)===T?(ee=T,B+=4):(ee=r,ge===0&&ke(qJ)),ee!==r?(kt=k,k=dY(G)):(B=k,k=r)):(B=k,k=r)))),ge--,k===r&&(G=r,ge===0&&ke(Cd)),k}function EY(){let k,G;return ge++,k=B,Lr(),G=Us(),G!==r?(kt=k,k=pY(G)):(B=k,k=r),ge--,k===r&&ge===0&&ke(BJ),k}function CY(){let k,G,ee,$e;if(ge++,k=B,t.charCodeAt(B)===35?(G=C,B++):(G=r,ge===0&&ke(WJ)),G!==r){if(ee=[],$e=t.charAt(B),V.test($e)?B++:($e=r,ge===0&&ke(rA)),$e!==r)for(;$e!==r;)ee.push($e),$e=t.charAt(B),V.test($e)?B++:($e=r,ge===0&&ke(rA));else ee=r;ee!==r?(kt=k,k=fY()):(B=k,k=r)}else B=k,k=r;return k===r&&(k=B,G=yx(),G!==r&&(kt=k,G=mY(G)),k=G,k===r&&(k=B,G=aA(),G!==r&&(kt=k,G=yY()),k=G)),ge--,k===r&&(G=r,ge===0&&ke(HJ)),k}function Us(){let k,G,ee,$e,st,Gt,wr,ti;for(k=B,G=t.charAt(B),Z.test(G)?B++:(G=r,ge===0&&ke(iA)),G===r&&(G=null),ee=B,$e=[],st=t.charAt(B),Y.test(st)?B++:(st=r,ge===0&&ke(Ul));st!==r;)$e.push(st),st=t.charAt(B),Y.test(st)?B++:(st=r,ge===0&&ke(Ul));if(t.charCodeAt(B)===46?(st=P,B++):(st=r,ge===0&&ke(ZJ)),st!==r){if(Gt=[],wr=t.charAt(B),Y.test(wr)?B++:(wr=r,ge===0&&ke(Ul)),wr!==r)for(;wr!==r;)Gt.push(wr),wr=t.charAt(B),Y.test(wr)?B++:(wr=r,ge===0&&ke(Ul));else Gt=r;Gt!==r?($e=[$e,st,Gt],ee=$e):(B=ee,ee=r)}else B=ee,ee=r;if(ee===r)if(ee=[],$e=t.charAt(B),Y.test($e)?B++:($e=r,ge===0&&ke(Ul)),$e!==r)for(;$e!==r;)ee.push($e),$e=t.charAt(B),Y.test($e)?B++:($e=r,ge===0&&ke(Ul));else ee=r;if(ee!==r){if($e=B,t.charCodeAt(B)===101?(st=A,B++):(st=r,ge===0&&ke(JJ)),st!==r){if(Gt=t.charAt(B),Z.test(Gt)?B++:(Gt=r,ge===0&&ke(iA)),Gt===r&&(Gt=null),wr=[],ti=t.charAt(B),Y.test(ti)?B++:(ti=r,ge===0&&ke(Ul)),ti!==r)for(;ti!==r;)wr.push(ti),ti=t.charAt(B),Y.test(ti)?B++:(ti=r,ge===0&&ke(Ul));else wr=r;wr!==r?(st=[st,Gt,wr],$e=st):(B=$e,$e=r)}else B=$e,$e=r;$e===r&&($e=null),kt=k,k=gY()}else B=k,k=r;return k}function PY(k,G){return k.map(function(ee){return ee[G]})}function kY(k,G,ee){return[k].concat(PY(G,ee))}dy=n();const vx=dy!==r&&B===t.length;function lA(){throw dy!==r&&B<t.length&&ke(wY()),_Y(nw,vn<t.length?vY(vn):null,vn<t.length?nA(vn,vn+1):nA(vn,vn))}return e.peg$library?{peg$result:dy,peg$currPos:B,peg$FAILED:r,peg$maxFailExpected:nw,peg$maxFailPos:vn,peg$success:vx,peg$throw:vx?void 0:lA}:vx?dy:void lA()}function Yk(t){if(!t||t.length===0)return null;if(typeof t=="string"){const r=CN(t);return r&&r.length!==0?r:null}const e=t.map(r=>{if(!Number.isFinite(r.scale)||r.scale<=0)throw new R("effect:invalid-scale","scale must be finite and greater than 0",{stop:r});return{scale:r.scale,effects:CN(r.value)}});e.sort((r,i)=>i.effects.length-r.effects.length);for(let r=0;r<e.length-1;r++){if(!V9(e[r].effects,e[r+1].effects))throw new R("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[r].effects,b:e[r+1].effects});U9(e[r].effects,e[r+1].effects)}return e.sort((r,i)=>i.scale-r.scale),e}function CN(t){let e;if(!t)return[];try{e=qbe(t)}catch(r){throw new R("effect:invalid-syntax","Invalid effect syntax",{value:t,error:r})}return e.map(r=>Bbe(r))}function Bbe(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return Hbe(t);case"opacity":return Wbe(t);case"hue-rotate":return Zbe(t);case"blur":return Jbe(t);case"drop-shadow":return Ybe(t);case"bloom":return Xbe(t)}}catch(e){throw e.details.filter=t,e}throw new R("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function Hbe(t){let e=1;return ry(t.parameters,1),t.parameters.length===1&&(e=Gn(t.parameters[0])),new DT(t.name,e)}function Wbe(t){let e=1;return ry(t.parameters,1),t.parameters.length===1&&(e=Gn(t.parameters[0])),new z9(e)}function Zbe(t){let e=0;return ry(t.parameters,1),t.parameters.length===1&&(e=i1e(t.parameters[0])),new N9(e)}function Jbe(t){let e=0;return ry(t.parameters,1),t.parameters.length===1&&(e=Qk(t.parameters[0]),Kv(e,t.parameters[0])),new L9(e)}function Ybe(t){const e=[];let r=null;for(const i of t.parameters)if(i.type==="color"){if(e.length&&Object.freeze(e),r)throw new R("effect:type-error","Accepts only one color",{});r=s1e(i)}else{const s=Qk(i);if(Object.isFrozen(e))throw new R("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(s),e.length===3&&Kv(s,i)}if(e.length<2||e.length>3)throw new R("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new O9(e[0],e[1],e[2]||0,r||MB("black"))}function Xbe(t){let e=1,r=0,i=0;return ry(t.parameters,3),t.parameters[0]&&(e=Gn(t.parameters[0])),t.parameters[1]&&(r=Qk(t.parameters[1]),Kv(r,t.parameters[1])),t.parameters[2]&&(i=Gn(t.parameters[2])),new P9(e,r,i)}function ry(t,e){if(t.length>e)throw new R("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function J2(t){if(t.type==="color")return"<color>";if(t.unit){if(t.unit in Kk)return"<length>";if(t.unit in Xk)return"<angle>";if(t.unit==="%")return"<percentage>"}return"<double>"}function Kv(t,e){if(t<0)throw new R("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function Kbe(t){if(t.type!=="quantity"||t.unit!==null)throw new R("effect:type-error",`Expected <double>, Actual: ${J2(t)}`,{term:t})}function Qbe(t){if(t.type!=="quantity"||t.unit!==null&&t.unit!=="%")throw new R("effect:type-error",`Expected <double> or <percentage>, Actual: ${J2(t)}`,{term:t})}const Xk={deg:1,grad:.9,rad:180/Math.PI,turn:360};function e1e(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&Xk[t.unit]!=null))throw new R("effect:type-error",`Expected <angle>, Actual: ${J2(t)}`,{term:t})}const Kk={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function t1e(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&Kk[t.unit]!=null))throw new R("effect:type-error",`Expected <length>, Actual: ${J2(t)}`,{term:t})}function Gn(t){Qbe(t);const e=t.value;return Kv(e,t),t.unit==="%"?.01*e:e}function r1e(t){return Kbe(t),Kv(t.value,t),t.value}function i1e(t){return e1e(t),t.value*Xk[t.unit]||0}function Qk(t){return t1e(t),t.value*Kk[t.unit]||0}function s1e(t){switch(t.colorType){case"hex":return Wse(t.value);case"named":return MB(t.value);case"function":return a1e(t.value)}}function MB(t){if(!WV(t))throw new R("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return Hse(t)}const n1e=/^rgba?/i,o1e=/^hsla?/i;function a1e(t){if(ry(t.parameters,4),n1e.test(t.name))return[Gn(t.parameters[0]),Gn(t.parameters[1]),Gn(t.parameters[2]),t.parameters[3]?Gn(t.parameters[3]):1];if(o1e.test(t.name))return ZV(r1e(t.parameters[0]),Gn(t.parameters[1]),Gn(t.parameters[2]),t.parameters[3]?Gn(t.parameters[3]):1);throw new R("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}function ov(t,e,r){try{return u1e(t)}catch(i){r?.messages?.push(i)}return null}function av(t,e,r,i){try{const s=l1e(t);Ir(r,s,e)}catch(s){i.messages&&i.messages.push(s)}}function l1e(t){const e=Yk(t);return e?rue(e)?e.map(r=>r.toJSON()):e.map(({scale:r,effects:i})=>({scale:r,value:i.map(s=>s.toJSON())})):null}function u1e(t){if(!t||t.length===0)return null;if(c1e(t)){const e=[];for(const r of t)e.push({scale:r.scale,value:dE(r.value)});return e}return dE(t)}function c1e(t){const e=t[0];return!!e&&"scale"in e}function dE(t){if(!t?.length)return"";const e=[];for(const r of t){let i=[];switch(r.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":i=[Ca(r,"amount")];break;case"blur":i=[Ca(r,"radius","pt")];break;case"hue-rotate":i=[Ca(r,"angle","deg")];break;case"drop-shadow":i=[Ca(r,"xoffset","pt"),Ca(r,"yoffset","pt"),Ca(r,"blurRadius","pt"),h1e(r,"color")];break;case"bloom":i=[Ca(r,"strength"),Ca(r,"radius","pt"),Ca(r,"threshold")]}const s=`${r.type}(${i.filter(Boolean).join(" ")})`;Yk(s),e.push(s)}return e.join(" ")}function Ca(t,e,r){if(t[e]==null)throw new R("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return r?t[e]+r:""+t[e]}function h1e(t,e){if(t[e]==null)throw new R("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const r=t[e];return`rgba(${r[0]||0}, ${r[1]||0}, ${r[2]||0}, ${r[3]/255||0})`}const d1e={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:{layerContainerTypes:pt}},"portal-item":{read:!0,write:{layerContainerTypes:pt}}}}},PN={read:{reader:ov},write:{allowNull:!0,writer:av,layerContainerTypes:pt}},p1e={json:{read:!1,write:!1,origins:{"web-map":PN,"portal-item":PN}}},f1e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return u([h(d1e)],r.prototype,"blendMode",void 0),u([h(p1e)],r.prototype,"effect",void 0),r=u([E("esri.layers.mixins.BlendLayer")],r),r},m1e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.customParameters=null}};return u([h({type:Object,json:{write:{overridePolicy:i=>({enabled:!!(i&&Object.keys(i).length>0)})}}})],r.prototype,"customParameters",void 0),r=u([E("esri.layers.mixins.CustomParametersMixin")],r),r},TB=96;function sVe(t,e){const r=t.extent,i=t.width,s=Vs(r?.spatialReference);return r&&i?r.width/i*s*lj*TB:0}function y1e(t,e){return t/(Vs(e)*lj*TB)}function g1e(t,e){const r=t.extent,i=t.width-(t.padding?t.padding.left+t.padding.right:0),s=y1e(e,r.spatialReference);return r.clone().expand(s*i/r.width)}function v1e(t,e,r){return w1e(t,e)&&_1e(t,r)}function w1e(t,e){return e===0||Ds(t,e)||t<e}function _1e(t,e){return e===0||Ds(t,e)||t>e}function b1e(t,e){return Ds(t,e)?0:(t||Number.POSITIVE_INFINITY)>(e||Number.POSITIVE_INFINITY)?1:-1}const kN={write:{overridePolicy:(t,e,r)=>({enabled:!r||r.filterMode==="scale"})}};let rl=class extends Ie(W){constructor(e){super(e),this.id=Xm(),this.maxScale=0,this.minScale=0,this.title="",this.where=null}};u([h({type:String,json:{write:!0}})],rl.prototype,"id",void 0),u([h({type:Number,json:kN})],rl.prototype,"maxScale",void 0),u([h({type:Number,json:kN})],rl.prototype,"minScale",void 0),u([h({type:String,json:{write:!0}})],rl.prototype,"title",void 0),u([h({type:String,json:{write:!0}})],rl.prototype,"where",void 0),rl=u([E("esri.layers.support.DisplayFilter")],rl);function S1e(t,e){return{...e,filterMode:t.mode}}function x1e(t,e){return IB(t,e).next().value??null}function oVe(t,e,r){const i=$1e(t);if(i&&(r8(e,i[0])||wT(r,i[1])))return"";const s=Array.from(IB(t,e,r)),n=M1e(s,e,r)?"1=1":s.map(o=>o.where||"1=1").reduce((o,a)=>vhe(o,a),"");return n&&n!=="1=1"?n:""}function $1e(t){if(EB(t)==="manual")return null;const e=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:r,maxScale:i}of t.filters)e[0]=Math.max(e[0],lv(r)),e[1]=Math.min(e[1],mS(i));return e}function*IB(t,e,r){if(EB(t)==="manual"){const i=t.filters.find(s=>s.id===t.activeFilterId);i&&(yield i)}else{typeof e=="object"&&(e=e.scale);for(const i of t.filters)T1e(i.minScale,i.maxScale,e,r)&&(yield i)}}function M1e(t,e,r){if(t.length===0)return!0;const i=lv(t.at(0)?.minScale),s=mS(t.at(-1)?.maxScale);if(wT(i,e)||r8(s,r))return!0;for(let n=0;n<t.length-1;n++){const o=t[n],a=t[n+1];if(wT(lv(a.minScale),mS(o.maxScale)))return!0}return!1}function T1e(t,e,r,i){return t=lv(t),r=lv(r),e=mS(e),!(!Ds(r,t)&&(i??r)>t)&&!Xse(e,r)&&(i===void 0||!Ds(i,t))}function EB(t){return"mode"in t?t.mode:t.filterMode}function lv(t){return t||Number.POSITIVE_INFINITY}function mS(t){return t||0}let nh=class extends Ie(W){constructor(e){super(e),this.activeFilterId=null,this.filters=new(se.ofType(rl)),this.mode="manual"}writeFilters(e,r,i,s){const n=e.toArray();this.mode==="scale"&&n.sort((o,a)=>{const l=b1e(a.minScale,o.minScale),c=o.maxScale-a.maxScale;return l===0?c:l}),r[i]=n.map(o=>o.toJSON(s))}write(e,r){return super.write(e,S1e(this,r))}};u([h({type:String,json:{write:{overridePolicy:(t,e,r)=>({enabled:r.filterMode==="manual",isRequired:!0})}}})],nh.prototype,"activeFilterId",void 0),u([h({type:se.ofType(rl),nonNullable:!0,json:{write:!0}})],nh.prototype,"filters",void 0),u([te("filters")],nh.prototype,"writeFilters",null),u([h({type:["manual","scale"],nonNullable:!0,json:{name:"filterMode",write:!0}})],nh.prototype,"mode",void 0),nh=u([E("esri.layers.support.DisplayFilterInfo")],nh);const I1e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.displayFilterEnabled=!0,this.displayFilterInfo=null}};return u([h(E1e)],r.prototype,"displayFilterEnabled",void 0),u([h(C1e)],r.prototype,"displayFilterInfo",void 0),r=u([E("esri.layers.mixins.DisplayFilteredLayer")],r),r},E1e={type:Boolean,json:{name:"layerDefinition.disableDisplayFilter",read:{reader:t=>!t},write:{layerContainerTypes:pt,writer(t,e,r){Ir(r,!t,e)}},origins:{"web-scene":{write:!1,read:!1}}}},C1e={type:nh,json:{name:"layerDefinition.displayFilterInfo",write:{enabled:!0,allowNull:!0,layerContainerTypes:pt},origins:{"web-scene":{write:!1,read:!1}}}},P1e=rne(),CB=new Map,PB=new Map;async function lVe(t,e,r){if(!t||!r)return!1;if(!e)return!0;const i=new URL(t).host;let s=CB.get(i);if(!s){const n=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");s=(await Be(n,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return s===e}async function uVe(t,e,r=!1){if(!t||!e)return!0;const i=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),s=PB.get(i)?.entries();if(s){for(const[n,o]of s)if(o.name===e){const a=!o.stack?.hasForwardEdits();if(!a&&r){const[{deleteForwardEdits:l},{default:c}]=await Promise.all([q(()=>import("./deleteForwardEdits-1mW3IyBY.js"),[]),q(()=>import("./DeleteForwardEditsParameters-BXEccwwr.js"),[])]),d=await l(i,n,new c({sessionId:P1e,moment:o.moment}));return d.success&&o.stack?.clearForwardEdits(),d.success}return a}}return!0}function k1e(t,e){if(!t)return!1;const r=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),i=PB.get(r)?.entries();if(i){for(const[s,n]of i)if(n.name===e)return n.lockType==="edit"}return!1}const eL=new D6;function L1e(t){return eL.on("apply-edits",new WeakRef(t))}function A1e(t){return eL.on("update-moment",new WeakRef(t))}function cVe(t,e,r=null,i=!1){const s=ps();return i=e==null||i,eL.emit("apply-edits",{serviceUrl:t,layerId:e,gdbVersion:r,mayReceiveServiceEdits:i,result:s.promise}),s}const kB=Symbol();function hVe(t){return t!=null&&typeof t=="object"&&kB in t}function jy(t){return t!=null&&typeof t=="object"&&"gdbVersion"in t}function q$(t,e,r){const i=new URL(t).host,s=CB.get(i),n=o=>!o||o===s;return n(e)&&n(r)||e===r}const R1e=t=>{var s;var e;const r=t;let i=(s=class extends r{constructor(...n){super(...n),this[e]=!0,this._applyEditsHandler=o=>{const{serviceUrl:a,layerId:l,gdbVersion:c,mayReceiveServiceEdits:d,result:p}=o,m=a===this.url,y=l!=null&&this.layerId!=null&&l===this.layerId,g=jy(this),v=jy(this)&&q$(a,c,this.gdbVersion);if(!m||g&&!v||!y&&!d)return;const w=p.then(_=>{if(this.lastEditsEventDate=new Date,y&&(_.addedFeatures.length||_.updatedFeatures.length||_.deletedFeatures.length||_.addedAttachments.length||_.updatedAttachments.length||_.deletedAttachments.length))return this.emit("edits",O(_)),_;const x=_.editedFeatures?.find(({layerId:T})=>T===this.layerId);if(x){const{adds:T,updates:C,deletes:P}=x.editedFeatures,A={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:T?T.map(({attributes:F})=>({objectId:this.objectIdField&&F[this.objectIdField],globalId:this.globalIdField&&F[this.globalIdField]})):[],deletedFeatures:P?P.map(({attributes:F})=>({objectId:this.objectIdField&&F[this.objectIdField],globalId:this.globalIdField&&F[this.globalIdField]})):[],updatedFeatures:C?C.map(({current:{attributes:F}})=>({objectId:this.objectIdField&&F[this.objectIdField],globalId:this.globalIdField&&F[this.globalIdField]})):[],editedFeatures:O(_.editedFeatures),exceededTransferLimit:!1,historicMoment:O(_.historicMoment)};return this.emit("edits",A),A}const $={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:O(_.editedFeatures),exceededTransferLimit:!1,historicMoment:O(_.historicMoment)};return"historicMoment"in this&&this._shouldUpdateHistoricMoment(a,c,$.historicMoment)&&this.emit("edits",$),$}).then(_=>("historicMoment"in this&&this._shouldUpdateHistoricMoment(a,c,_.historicMoment)&&(this.historicMoment=_.historicMoment),_));this.emit("apply-edits",{result:w})},this._updateMomentHandler=o=>{const{serviceUrl:a,gdbVersion:l,moment:c}=o,d=a===this.url,p=jy(this),m=jy(this)&&q$(a,l,this.gdbVersion),y=jy(this)&&!q$(a,this.gdbVersion,null);d&&p&&m&&y&&"historicMoment"in this&&this.historicMoment!==c&&(this.historicMoment=c)},this.when().then(()=>{this.addHandles(L1e(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(A1e(this._updateMomentHandler))},()=>{})}_shouldUpdateHistoricMoment(n,o,a){return"historicMoment"in this&&this.historicMoment!==a&&k1e(n,o)}},e=kB,s);return u([h()],i.prototype,"lastEditsEventDate",void 0),i=u([E("esri.layers.mixins.EditBusLayer")],i),i};var pE;const B$=new Ne({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),H$=new Ne({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let wo=pE=class extends W{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:r,spatialRelationship:i,timeExtent:s,objectIds:n,units:o,distance:a}=this;return new fe({geometry:O(r),objectIds:O(n),spatialRelationship:i,timeExtent:O(s),where:e,units:o,distance:a,...t})}clone(){const{where:t,geometry:e,spatialRelationship:r,timeExtent:i,objectIds:s,units:n,distance:o}=this;return new pE({geometry:O(e),objectIds:O(s),spatialRelationship:r,timeExtent:O(i),where:t,units:n,distance:o})}};u([h({type:String,json:{write:!0}})],wo.prototype,"where",void 0),u([h({types:jv,json:{write:!0}})],wo.prototype,"geometry",void 0),u([h({type:B$.apiValues,json:{name:"spatialRel",read:{reader:B$.read},write:{allowNull:!1,writer:B$.write,overridePolicy(){return{enabled:this.geometry!=null}}}}})],wo.prototype,"spatialRelationship",void 0),u([h({type:Number,json:{write:{overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],wo.prototype,"distance",void 0),u([h({type:[Number],json:{write:!0}})],wo.prototype,"objectIds",void 0),u([h({type:H$.apiValues,json:{read:H$.read,write:{writer:H$.write,overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],wo.prototype,"units",void 0),u([h({type:ar,json:{write:!0}})],wo.prototype,"timeExtent",void 0),wo=pE=u([E("esri.layers.support.FeatureFilter")],wo);const O1e=wo;var fE;const LN={read:{reader:ov},write:{writer:av,overridePolicy(){return{allowNull:this.excludedEffect!=null,isRequired:this.excludedEffect==null}}}},AN={read:{reader:ov},write:{writer:av,overridePolicy(){return{allowNull:this.includedEffect!=null,isRequired:this.includedEffect==null}}}},RN={name:"showExcludedLabels",default:!0};let oh=fE=class extends W{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(t,e){const r=super.write(t,e);if(e?.origin){if(r.filter){const i=Object.keys(r.filter);if(i.length>1||i[0]!=="where")return e.messages?.push(new R("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:e.layer,effect:this})),null}if("showExcludedLabels"in r)return e.messages?.push(new R("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:e.layer,effect:this})),null}return r}clone(){return new fE({filter:this.filter!=null?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};u([h({type:O1e,json:{write:{allowNull:!0,writer(t,e,r,i){const s=t?.write({},i);s&&Object.keys(s).length!==0?Ir(r,s,e):Ir(r,null,e)}}}})],oh.prototype,"filter",void 0),u([h({json:{read:ov,write:{writer:av,allowNull:!0},origins:{"web-map":LN,"portal-item":LN}}})],oh.prototype,"includedEffect",void 0),u([h({json:{read:ov,write:{writer:av,allowNull:!0},origins:{"web-map":AN,"portal-item":AN}}})],oh.prototype,"excludedEffect",void 0),u([h({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":RN,"portal-item":RN}}})],oh.prototype,"excludedLabelsVisible",void 0),oh=fE=u([E("esri.layers.support.FeatureEffect")],oh);const ON={write:{allowNull:!0}},F1e={type:oh,json:{origins:{"web-map":ON,"portal-item":ON}}},N1e=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.featureEffect=null}};return u([h(F1e)],r.prototype,"featureEffect",void 0),r=u([E("esri.layers.mixins.FeatureEffectLayer")],r),r};var mE;let Ag=mE=class extends W{constructor(t){super(t),this.expression=void 0,this.title=void 0}async collectRequiredFields(t,e){return ei(t,e,null,this.expression)}clone(){return new mE({expression:this.expression,title:this.title})}equals(t){return this.expression===t.expression&&this.title===t.title}};u([h({type:String,json:{write:{isRequired:!0}}})],Ag.prototype,"expression",void 0),u([h({type:String,json:{write:!0}})],Ag.prototype,"title",void 0),Ag=mE=u([E("esri.symbols.support.FeatureExpressionInfo")],Ag);const FN=Ag,Y2={unknown:1,inches:Zt(1,"meters","inches"),feet:Zt(1,"meters","feet"),"us-feet":Zt(1,"meters","us-feet"),yards:Zt(1,"meters","yards"),miles:Zt(1,"meters","miles"),"nautical-miles":Zt(1,"meters","nautical-miles"),millimeters:Zt(1,"meters","millimeters"),centimeters:Zt(1,"meters","centimeters"),decimeters:Zt(1,"meters","decimeters"),meters:Zt(1,"meters","meters"),kilometers:Zt(1,"meters","kilometers"),"decimal-degrees":1/ate(1,"meters",Vt.radius)};function dVe(t){return!!t&&Y2[t]!=null}function pVe(t){return 1/(Y2[t]||1)}function D1e(){const t=Object.keys(Y2);return AC(t,"decimal-degrees"),t.sort(),t}const z1e=D1e(),Zw=yr()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),NN=new Ne({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let Wa=class extends Ie(W){constructor(e){super(e),this.featureExpressionInfo=void 0,this.offset=null}readFeatureExpressionInfo(e,r){return e!=null?e.expression?e:void 0:r.featureExpression&&r.featureExpression.value===0?{expression:"0"}:void 0}writeFeatureExpressionInfo(e,r,i,s){r[i]=e.write({},s),e.expression==="0"&&(r.featureExpression={value:0})}get mode(){const{offset:e,featureExpressionInfo:r}=this;return this._isOverridden("mode")?this._get("mode"):e!=null||r?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,r){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,r):null}equals(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&DX(this.featureExpressionInfo,e.featureExpressionInfo)}};u([h({type:FN,json:{write:!0}})],Wa.prototype,"featureExpressionInfo",void 0),u([X("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],Wa.prototype,"readFeatureExpressionInfo",null),u([te("featureExpressionInfo",{featureExpressionInfo:{type:FN},"featureExpression.value":{type:[0]}})],Wa.prototype,"writeFeatureExpressionInfo",null),u([h({type:Zw.apiValues,nonNullable:!0,json:{type:Zw.jsonValues,read:Zw.read,write:{writer:Zw.write,isRequired:!0}}})],Wa.prototype,"mode",null),u([h({type:Number,json:{write:!0}})],Wa.prototype,"offset",void 0),u([h({type:z1e,json:{type:String,read:NN.read,write:NN.write}})],Wa.prototype,"unit",null),Wa=u([E("esri.symbols.support.ElevationInfo")],Wa);let Dp=class extends W{constructor(e){super(e),this.description=null,this.label=null,this.type=null}};u([h({type:String,json:{write:!0}})],Dp.prototype,"description",void 0),u([h({type:String,json:{write:!0}})],Dp.prototype,"label",void 0),u([h()],Dp.prototype,"type",void 0),Dp=u([E("esri.tables.elements.AttributeTableElement")],Dp);const iy=Dp;let Rg=class extends Ie(iy){constructor(e){super(e),this.displayType="auto",this.type="attachment"}clone(){return super.clone()}};u([h({type:["auto"],json:{write:!0}})],Rg.prototype,"displayType",void 0),u([h({type:["attachment"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],Rg.prototype,"type",void 0),Rg=u([E("esri.tables.elements.AttributeTableAttachmentElement")],Rg);const LB=Rg;let ah=class extends Ie(iy){constructor(e){super(e),this.description=null,this.fieldName=null,this.label=null,this.type="field"}clone(){return super.clone()}};u([h({type:String,json:{read:!1,write:!1}})],ah.prototype,"description",void 0),u([h({type:String,json:{write:{enabled:!0,isRequired:!0}}})],ah.prototype,"fieldName",void 0),u([h({type:String,json:{read:!1,write:!1}})],ah.prototype,"label",void 0),u([h({type:["field"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],ah.prototype,"type",void 0),ah=u([E("esri.tables.elements.AttributeTableFieldElement")],ah);const AB=ah;let Og=class extends Ie(iy){constructor(e){super(e),this.relationshipId=null,this.type="relationship"}clone(){return super.clone()}};u([h({type:Number,json:{type:Ue,write:{enabled:!0,isRequired:!0}}})],Og.prototype,"relationshipId",void 0),u([h({type:["relationship"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],Og.prototype,"type",void 0),Og=u([E("esri.tables.elements.AttributeTableRelationshipElement")],Og);const RB=Og,OB={base:iy,key:"type",typeMap:{attachment:LB,field:AB,relationship:RB}};function j1e(t){return{typesWithGroup:{base:iy,key:"type",typeMap:{attachment:LB,field:AB,group:t,relationship:RB}},typesWithoutGroup:OB}}let Fg=class extends Ie(iy){constructor(e){super(e),this.elements=null,this.type="group"}clone(){return super.clone()}};u([h({types:[OB],json:{name:"attributeTableElements",write:!0}})],Fg.prototype,"elements",void 0),u([h({type:["group"],readOnly:!0,json:{read:!1,write:{enabled:!0,isRequired:!0}}})],Fg.prototype,"type",void 0),Fg=u([E("esri.tables.elements.AttributeTableGroupElement")],Fg);const V1e=Fg;let Ng=class extends Ie(W){constructor(e){super(e),this.field=null,this.order=null}};u([h({type:String,json:{write:!0}})],Ng.prototype,"field",void 0),u([h({type:["asc","desc"],json:{write:!0}})],Ng.prototype,"order",void 0),Ng=u([E("esri.tables.support.FieldOrder")],Ng);const U1e=Ng;var yE;const G1e=j1e(V1e);let Dg=yE=class extends W{constructor(t){super(t),this.elements=null,this.orderByFields=null}clone(){return new yE({elements:O(this.elements),orderByFields:O(this.orderByFields)})}};u([h({types:[G1e.typesWithGroup],json:{name:"attributeTableElements",write:!0}})],Dg.prototype,"elements",void 0),u([h({type:[U1e],json:{write:!0}})],Dg.prototype,"orderByFields",void 0),Dg=yE=u([E("esri.tables.AttributeTableTemplate")],Dg);const q1e=Dg,B1e={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:pt}}},X2={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,r){e[r]=!t}}}},K2={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:pt}}},H1e={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:rd}}},W1e={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:pt}}},Z1e={value:null,type:Wa,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:pt}}};function bVe(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const FB={write:{enabled:!0,layerContainerTypes:pt},read:!0},gE={type:Number,json:{origins:{"web-document":FB,"portal-item":{write:{layerContainerTypes:pt}}}}},J1e={...gE,json:{...gE.json,origins:{"web-document":{...FB,write:{enabled:!0,layerContainerTypes:pt,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,r)=>r&&r.origin!=="service"||!e.drawingInfo||e.drawingInfo.transparency===void 0?e.layerDefinition?.drawingInfo&&e.layerDefinition.drawingInfo.transparency!==void 0?j0(e.layerDefinition.drawingInfo.transparency):void 0:j0(e.drawingInfo.transparency)}}},SVe={type:Te,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const r=Te.fromJSON(t);return e.spatialReference!=null&&typeof e.spatialReference=="object"&&(r.spatialReference=ne.fromJSON(e.spatialReference)),r}}}},read:!1}},Y1e={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},X1e={type:Number,json:{origins:{service:{write:{enabled:!1}}},name:"layerDefinition.minScale",write:{layerContainerTypes:pt}}},K1e={type:Number,json:{origins:{service:{write:{enabled:!1}}},name:"layerDefinition.maxScale",write:{layerContainerTypes:pt}}},NB={json:{write:{ignoreOrigin:!0,layerContainerTypes:pt},origins:{"web-map":{read:!1,write:!1}}}},Q1e={type:q1e,json:{name:"attributeTableInfo",write:!0}};let Za=class extends Ie(W){constructor(e){super(e),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.timeZone=null}};u([h()],Za.prototype,"creatorField",void 0),u([h()],Za.prototype,"creationDateField",void 0),u([h()],Za.prototype,"editorField",void 0),u([h()],Za.prototype,"editDateField",void 0),u([h()],Za.prototype,"realm",void 0),u([h(z1("dateFieldsTimeReference",!0))],Za.prototype,"timeZone",void 0),Za=u([E("esri.layers.support.EditFieldsInfo")],Za);let xo=class extends Ie(W){constructor(e){super(e)}};u([h({constructOnly:!0,json:{write:!0}})],xo.prototype,"name",void 0),u([h({constructOnly:!0,json:{write:!0}})],xo.prototype,"fields",void 0),u([h({constructOnly:!0,json:{write:!0}})],xo.prototype,"isAscending",void 0),u([h({constructOnly:!0,json:{write:!0}})],xo.prototype,"indexType",void 0),u([h({constructOnly:!0,json:{write:!0}})],xo.prototype,"isUnique",void 0),u([h({constructOnly:!0,json:{write:!0}})],xo.prototype,"description",void 0),xo=u([E("esri.layers.support.FeatureIndex")],xo);async function eSe(t,e,r){e=e.clone(),t.capabilities.query.supportsMaxRecordCountFactor&&(e.maxRecordCountFactor=DB(t));const i=tSe(t),s=t.capabilities.query.supportsPagination;e.start=0,e.num=i;let n=null;for(;;){const o=await t.source.queryFeaturesJSON(e,r);if(n==null?n=o:n.features=n.features.concat(o.features),n.exceededTransferLimit=o.exceededTransferLimit,!s||!o.exceededTransferLimit)break;e.start+=i}return n}function tSe(t){return DB(t)*rSe(t)}function rSe(t){return t.capabilities.query.maxRecordCount||2e3}function DB(t){return t.capabilities.query.supportsMaxRecordCountFactor?fe.MAX_MAX_RECORD_COUNT_FACTOR:1}var vE;let zg=vE=class extends W{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new vE({minValue:this.minValue,maxValue:this.maxValue})}};u([h({type:Number,json:{write:!0}})],zg.prototype,"minValue",void 0),u([h({type:Number,json:{write:!0}})],zg.prototype,"maxValue",void 0),zg=vE=u([E("esri.renderers.support.AuthoringInfoClassBreakInfo")],zg);var wE;let Tu=wE=class extends W{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=new Array}clone(){return new wE({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:O(this.classBreakInfos)})}};u([h({type:String,json:{write:!0}})],Tu.prototype,"field",void 0),u([h({type:String,json:{write:!0}})],Tu.prototype,"normalizationField",void 0),u([h({type:String,json:{write:!0}})],Tu.prototype,"label",void 0),u([h({type:[zg],json:{write:!0}})],Tu.prototype,"classBreakInfos",void 0),Tu=wE=u([E("esri.renderers.support.AuthoringInfoFieldInfo")],Tu);var _E;let zp=_E=class extends W{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new _E({label:this.label,value:this.value,size:this.size})}};u([h({type:String,json:{write:!0}})],zp.prototype,"label",void 0),u([h({type:Number,json:{write:!0}})],zp.prototype,"size",void 0),u([h({type:Number,json:{write:!0}})],zp.prototype,"value",void 0),zp=_E=u([E("esri.renderers.support.AuthoringInfoSizeStop")],zp);const iSe=zp;var bE;const Jw=new Ne({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),Yw=new Ne({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),DN={key:t=>typeof t=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},zN=["high-to-low","above-and-below","centered-on","extremes"],jN=[...new Set(["high-to-low","above-and-below","centered-on","extremes","above","below","high-to-low","above-and-below","above","below","reference-size","spike"])],VN=["seconds","minutes","hours","days","months","years"],sSe=["circle","diamond","hexagon-flat","hexagon-pointy","square"],nSe=["triangle-closed-outline","triangle-gradient-fill-closed","triangle-gradient-fill-closed-outline","triangle-gradient-fill-open","triangle-gradient-fill-open-outline","triangle-open-outline","triangle-solid-fill-closed","triangle-solid-fill-closed-outline","triangle-solid-fill-open","triangle-solid-fill-open-outline"];let _r=bE=class extends W{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return typeof t=="string"||typeof t=="number"?t:null}get normalizationField(){return this.theme==="reference-size"||this.theme==="spike"?this._get("normalizationField"):null}set normalizationField(t){this._set("normalizationField",t)}get referenceSizeScale(){return this.theme==="reference-size"?this._get("referenceSizeScale"):null}set referenceSizeScale(t){this._set("referenceSizeScale",t)}get referenceSizeSymbolStyle(){return this.theme==="reference-size"?this._get("referenceSizeSymbolStyle"):null}set referenceSizeSymbolStyle(t){this._set("referenceSizeSymbolStyle",t)}get spikeSymbolStyle(){return this.theme==="spike"?this._get("spikeSymbolStyle"):null}set spikeSymbolStyle(t){this._set("spikeSymbolStyle",t)}castStartTime(t){return typeof t=="string"||typeof t=="number"?t:null}get sizeStops(){return this.theme==="reference-size"||this.theme==="spike"?this._get("sizeStops"):null}set sizeStops(t){this._set("sizeStops",t)}get style(){return this.type==="color"?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new bE({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,normalizationField:this.normalizationField,referenceSizeScale:this.referenceSizeScale,referenceSizeSymbolStyle:this.referenceSizeSymbolStyle,spikeSymbolStyle:this.spikeSymbolStyle,sizeStops:O(this.sizeStops),startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};u([h({types:DN,json:{write:!0}})],_r.prototype,"endTime",void 0),u([He("endTime")],_r.prototype,"castEndTime",null),u([h({type:String,json:{write:!0}})],_r.prototype,"field",void 0),u([h({type:Number,json:{write:!0}})],_r.prototype,"maxSliderValue",void 0),u([h({type:Number,json:{write:!0}})],_r.prototype,"minSliderValue",void 0),u([h({type:String,json:{origins:{"web-scene":{write:!1}},write:!0}})],_r.prototype,"normalizationField",null),u([h({type:Number,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],_r.prototype,"referenceSizeScale",null),u([h({type:sSe,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],_r.prototype,"referenceSizeSymbolStyle",null),u([h({type:nSe,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],_r.prototype,"spikeSymbolStyle",null),u([h({types:DN,json:{write:!0}})],_r.prototype,"startTime",void 0),u([He("startTime")],_r.prototype,"castStartTime",null),u([h({type:[iSe],json:{origins:{"web-scene":{write:!1}},write:!0}})],_r.prototype,"sizeStops",null),u([h({type:Jw.apiValues,value:null,json:{type:Jw.jsonValues,read:Jw.read,write:Jw.write}})],_r.prototype,"style",null),u([h({type:jN,value:null,json:{type:jN,origins:{"web-scene":{type:zN,write:{writer:(t,e)=>{zN.includes(t)&&(e.theme=t)}}}},write:!0}})],_r.prototype,"theme",null),u([h({type:Yw.apiValues,json:{type:Yw.jsonValues,read:Yw.read,write:Yw.write}})],_r.prototype,"type",void 0),u([h({type:VN,json:{type:VN,write:!0}})],_r.prototype,"units",void 0),_r=bE=u([E("esri.renderers.support.AuthoringInfoVisualVariable")],_r);const oSe=_r;let Af=class extends W{constructor(e){super(e),this.type=null}};u([h({readOnly:!0,json:{read:!1,write:!0}})],Af.prototype,"type",void 0),Af=u([E("esri.rest.support.ColorRamp")],Af);var SE;let hl=SE=class extends Af{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new SE({fromColor:O(this.fromColor),toColor:O(this.toColor),algorithm:this.algorithm})}};u([ye({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],hl.prototype,"algorithm",void 0),u([h({type:K,json:{type:[Ue],write:{isRequired:!0}}})],hl.prototype,"fromColor",void 0),u([h({type:K,json:{type:[Ue],write:{isRequired:!0}}})],hl.prototype,"toColor",void 0),u([h({type:["algorithmic"],json:{write:{isRequired:!0}}})],hl.prototype,"type",void 0),hl=SE=u([E("esri.rest.support.AlgorithmicColorRamp")],hl);var xE;let il=xE=class extends Af{constructor(t){super(t),this.colorRamps=null,this.type="multipart",this.weights=void 0}writeColorRamps(t,e,r,i){const s=t?.map(o=>o.toJSON(i)),{weights:n}=this;if(s&&n?.length&&s.length===n?.length){const o=100/n.reduce((l,c)=>l+c);let a=0;s.forEach((l,c)=>{l.start=a,a+=n[c]*o,l.stop=a})}e.colorRamps=s}readWeights(t,e){const r=e.colorRamps?.map(({start:i,stop:s})=>i==null||s==null?-1:s-i);if(!r?.some(i=>i<0))return r}clone(){return new xE({colorRamps:O(this.colorRamps)})}};u([h({type:[hl],json:{write:{isRequired:!0}}})],il.prototype,"colorRamps",void 0),u([te("colorRamps")],il.prototype,"writeColorRamps",null),u([h({type:["multipart"],json:{write:{isRequired:!0}}})],il.prototype,"type",void 0),u([h({type:[Number]})],il.prototype,"weights",void 0),u([X("weights",["colorRamps"])],il.prototype,"readWeights",null),il=xE=u([E("esri.rest.support.MultipartColorRamp")],il);const aSe={key:"type",base:Af,typeMap:{algorithmic:hl,multipart:il}};function lSe(t){return t?.type?t.type==="algorithmic"?hl.fromJSON(t):t.type==="multipart"?il.fromJSON(t):null:null}var $E;const Ac=new Ne({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),Xw=new Ne({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),UN=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers"],uSe=["high-to-low","above-and-below","above","below"],cSe=["flow-line","wave-front"],hSe=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let It=$E=class extends W{constructor(t){super(t),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&e!=="relationship"?e==="class-breaks-size"||e==="class-breaks-color"?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){return t?lSe(t):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(t){this._set("field2",t)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(t){this._set("flowTheme",t)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&t!=="relationship"&&t!=="class-breaks-size"&&t!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;t==="classed-size"?e="class-breaks-size":t==="classed-color"&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){return new $E({classificationMethod:this.classificationMethod,colorRamp:O(this.colorRamp),fadeRatio:O(this.fadeRatio),fields:this.fields?.slice(),field1:O(this.field1),field2:O(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(t=>t.clone()),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};u([h({type:Ac.apiValues,value:null,json:{type:Ac.jsonValues,read:Ac.read,write:Ac.write,origins:{"web-document":{default:"manual",type:Ac.jsonValues,read:Ac.read,write:Ac.write}}}})],It.prototype,"classificationMethod",null),u([h({types:aSe,json:{write:!0}})],It.prototype,"colorRamp",void 0),u([X("colorRamp")],It.prototype,"readColorRamp",null),u([h({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],It.prototype,"fadeRatio",void 0),u([h({type:[String],value:null,json:{write:!0}})],It.prototype,"fields",null),u([h({type:Tu,value:null,json:{write:!0}})],It.prototype,"field1",null),u([h({type:Tu,value:null,json:{write:!0}})],It.prototype,"field2",null),u([h({type:cSe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],It.prototype,"flowTheme",null),u([h({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],It.prototype,"focus",null),u([h({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],It.prototype,"isAutoGenerated",void 0),u([h({type:Number,value:null,json:{type:Ue,write:!0}})],It.prototype,"numClasses",null),u([h({type:UN,json:{type:UN,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],It.prototype,"lengthUnit",void 0),u([h({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],It.prototype,"maxSliderValue",void 0),u([h({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],It.prototype,"minSliderValue",void 0),u([h({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],It.prototype,"statistics",null),u([h({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],It.prototype,"standardDeviationInterval",null),u([h({type:Xw.apiValues,value:null,json:{type:Xw.jsonValues,read:Xw.read,write:Xw.write}})],It.prototype,"type",null),u([h({type:[oSe],json:{write:!0}})],It.prototype,"visualVariables",void 0),u([h({type:hSe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],It.prototype,"univariateSymbolStyle",null),u([h({type:uSe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],It.prototype,"univariateTheme",null),It=$E=u([E("esri.renderers.support.AuthoringInfo")],It);const W$=new Ne({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let Os=class extends W{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const r=new Set;return await this.collectRequiredFields(r,e),Array.from(r).sort()}getSymbol(e,r){}async getSymbolAsync(e,r){}get symbols(){return[]}get arcadeRequired(){return!1}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};u([h({type:It,json:{write:!0}})],Os.prototype,"authoringInfo",void 0),u([h({type:W$.apiValues,readOnly:!0,json:{type:W$.jsonValues,read:!1,write:{writer:W$.write,ignoreOrigin:!0,isRequired:!0}}})],Os.prototype,"type",void 0),Os=u([E("esri.renderers.Renderer")],Os);let jg=class extends Ie(W){constructor(){super(...arguments),this.showLegend=null,this.title=null}};u([h({type:Boolean,json:{write:!0}})],jg.prototype,"showLegend",void 0),u([h({type:String,json:{write:!0}})],jg.prototype,"title",void 0),jg=u([E("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],jg);const zB=jg,Z$=new Ne({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let hi=class extends W{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return e==null?e:typeof e=="function"?(U.getLogger(this).error(".field: field must be a string value"),null):Iv(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};u([h()],hi.prototype,"index",void 0),u([h({type:Z$.apiValues,readOnly:!0,json:{read:Z$.read,write:{writer:Z$.write,isRequired:!0}}})],hi.prototype,"type",void 0),u([h({type:String,json:{write:!0}})],hi.prototype,"field",void 0),u([He("field")],hi.prototype,"castField",null),u([h({type:String,json:{write:!0}})],hi.prototype,"valueExpression",void 0),u([h({type:String,json:{write:!0}})],hi.prototype,"valueExpressionTitle",void 0),u([h({readOnly:!0})],hi.prototype,"arcadeRequired",null),u([h({type:zB,json:{write:!0}})],hi.prototype,"legendOptions",void 0),hi=u([E("esri.renderers.visualVariables.VisualVariable")],hi);var ME;let lh=ME=class extends W{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,r){e[r]=t??0}clone(){return new ME({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};u([h({type:K,json:{type:[Ue],write:{isRequired:!0}}})],lh.prototype,"color",void 0),u([h({type:String,json:{write:!0}})],lh.prototype,"label",void 0),u([h({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],lh.prototype,"value",void 0),u([te("value")],lh.prototype,"writeValue",null),lh=ME=u([E("esri.renderers.visualVariables.support.ColorStop")],lh);const dSe=lh;var TE;let Iu=TE=class extends hi{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,r)=>e.value-r.value),this._set("stops",t)}clone(){return new TE({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(t=>t.clone()),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};u([h({readOnly:!0})],Iu.prototype,"cache",null),u([h({type:["color"],json:{type:["colorInfo"]}})],Iu.prototype,"type",void 0),u([h({type:String,json:{write:!0}})],Iu.prototype,"normalizationField",void 0),u([h({type:[dSe],json:{write:!0}})],Iu.prototype,"stops",null),Iu=TE=u([E("esri.renderers.visualVariables.ColorVariable")],Iu);var IE;let yu=IE=class extends W{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return j0(e.transparency)}writeOpacity(t,e,r){e[r]=p2(t)}clone(){return new IE({label:this.label,opacity:this.opacity,value:this.value})}};u([h({type:String,json:{write:!0}})],yu.prototype,"label",void 0),u([h({type:Number,json:{type:Ue,write:{target:"transparency",isRequired:!0}}})],yu.prototype,"opacity",void 0),u([X("opacity",["transparency"])],yu.prototype,"readOpacity",null),u([te("opacity")],yu.prototype,"writeOpacity",null),u([h({type:Number,json:{write:{isRequired:!0}}})],yu.prototype,"value",void 0),yu=IE=u([E("esri.renderers.visualVariables.support.OpacityStop")],yu);const pSe=yu;var EE;let dl=EE=class extends hi{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,r)=>e.value-r.value),this._set("stops",t)}clone(){return new EE({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(t=>t.clone()),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};u([h({readOnly:!0})],dl.prototype,"cache",null),u([h({type:["opacity"],json:{type:["transparencyInfo"]}})],dl.prototype,"type",void 0),u([h({type:String,json:{write:!0}})],dl.prototype,"normalizationField",void 0),u([h({type:[pSe],json:{write:!0}})],dl.prototype,"stops",null),dl=EE=u([E("esri.renderers.visualVariables.OpacityVariable")],dl);var CE;let Eu=CE=class extends hi{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic"}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}clone(){return new CE({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions?.clone()})}};u([h({readOnly:!0})],Eu.prototype,"cache",null),u([h({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],Eu.prototype,"axis",void 0),u([h({type:["rotation"],json:{type:["rotationInfo"]}})],Eu.prototype,"type",void 0),u([h({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],Eu.prototype,"rotationType",void 0),Eu=CE=u([E("esri.renderers.visualVariables.RotationVariable")],Eu);function fSe(t){return ze(t)}var PE;let qn=PE=class extends W{constructor(t){super(t),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new PE({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};u([h({type:String,json:{write:!0}})],qn.prototype,"label",void 0),u([h({type:Number,cast:ze,json:{write:{isRequired:!0}}})],qn.prototype,"size",void 0),u([h({type:Number,json:{write:{isRequired:!0}}})],qn.prototype,"value",void 0),u([h({type:Boolean,json:{write:!1}})],qn.prototype,"useMinValue",void 0),u([h({type:Boolean,json:{write:!1}})],qn.prototype,"useMaxValue",void 0),qn=PE=u([E("esri.renderers.visualVariables.support.SizeStop")],qn);let Db=class extends zB{constructor(){super(...arguments),this.customValues=null}};u([h({type:[Number],json:{write:!0}})],Db.prototype,"customValues",void 0),Db=u([E("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],Db);const jB=Db;function cf(t){return t&&t.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function pd(t){return t!=null&&!isNaN(t)&&isFinite(t)}function VB(t){return t.valueExpression?"expression":t.field&&typeof t.field=="string"?"field":"unknown"}function mSe(t,e){const r=e||VB(t),i=t.valueUnit||"unknown";return r==="unknown"?"constant":t.stops?"stops":t.minSize!=null&&t.maxSize!=null&&t.minDataValue!=null&&t.maxDataValue!=null?"clamped-linear":i==="unknown"?t.minSize!=null&&t.minDataValue!=null?t.minSize&&t.minDataValue?"proportional":"additive":"identity":"real-world-size"}const UB=()=>U.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),Q2=t=>UB().warn(`The visualVariable should be an instance of esri.renderers.visualVariables.${t}`),ex=()=>UB().error("Use of arcade expressions requires an arcade context"),GN=new Rt,zb=Math.PI,GB=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function qB(t,e,r){const i="visualVariables"in t?t.visualVariables?.find(g=>g.type==="color"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void Q2("ColorVariable");const s=typeof e=="number",n=s?null:e,o=n?.attributes;let a=s?e:null;const l=i.field,{ipData:c,hasExpression:d}=i.cache;let p=i.cache.compiledFunc;if(!l&&!d){const g=i.stops;return g&&g[0]&&g[0].color}if(typeof a!="number")if(d){if(r?.arcade==null)return void ex();const g={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,w=v.getViewInfo(g),_=v.createExecContext(n,w,r.timeZone);if(!p){const x=v.createSyntaxTree(i.valueExpression);p=v.createFunction(x),i.cache.compiledFunc=p}a=v.executeFunction(p,_)}else o&&(a=o[l]);const m=i.normalizationField,y=o!=null&&m!=null?parseFloat(o[m]):void 0;if(a!=null&&(!m||s||!isNaN(y)&&y!==0)){pd(y)&&!s&&(a/=y);const g=tL(a,c);if(g){const v=g[0],w=g[1],_=v===w?i.stops[v].color:K.blendColors(i.stops[v].color,i.stops[w].color,g[2],r?.color);return new K(_)}}}function BB(t,e,r){const i="visualVariables"in t?t.visualVariables?.find(g=>g.type==="opacity"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void Q2("OpacityVariable");const s=typeof e=="number",n=s?null:e,o=n?.attributes;let a=s?e:null;const l=i.field,{ipData:c,hasExpression:d}=i.cache;let p=i.cache.compiledFunc;if(!l&&!d){const g=i.stops;return g&&g[0]&&g[0].opacity}if(typeof a!="number")if(d){if(r?.arcade==null)return void ex();const g={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,w=v.getViewInfo(g),_=v.createExecContext(n,w,r.timeZone);if(!p){const x=v.createSyntaxTree(i.valueExpression);p=v.createFunction(x),i.cache.compiledFunc=p}a=v.executeFunction(p,_)}else o&&(a=o[l]);const m=i.normalizationField,y=o!=null&&m!=null?parseFloat(o[m]):void 0;if(a!=null&&(!m||s||!isNaN(y)&&y!==0)){pd(y)&&!s&&(a/=y);const g=tL(a,c);if(g){const v=g[0],w=g[1];if(v===w)return i.stops[v].opacity;{const _=i.stops[v].opacity;return _+(i.stops[w].opacity-_)*g[2]}}}}function HB(t,e,r){const i="visualVariables"in t?t.visualVariables?.find(y=>y.type==="rotation"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void Q2("RotationVariable");const s=i.axis||"heading",n=s==="heading"&&i.rotationType==="arithmetic"?90:0,o=s==="heading"&&i.rotationType==="arithmetic"?-1:1,a=typeof e=="number"?null:e,l=a?.attributes,c=i.field,{hasExpression:d}=i.cache;let p=i.cache.compiledFunc,m=null;if(!c&&!d)return m;if(d){if(r?.arcade==null)return void ex();const y={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},g=r.arcade.arcadeUtils,v=g.getViewInfo(y),w=g.createExecContext(a,v,r.timeZone);if(!p){const _=g.createSyntaxTree(i.valueExpression);p=g.createFunction(_),i.cache.compiledFunc=p}m=g.executeFunction(p,w)}else l&&(m=l[c]);return m=typeof m!="number"||isNaN(m)?null:n+o*m,m}function ySe(t,e,r){const i=typeof e=="number",s=i?null:e,n=s?.attributes;let o=i?e:null;const{isScaleDriven:a}=t.cache;let l=t.cache.compiledFunc;if(a){const d=r?.scale,p=r?.view;o=d==null||p==="3d"?gSe(t):d}else if(!i)switch(t.inputValueType){case"expression":{if(r?.arcade==null)return void ex();const d={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},p=r.arcade.arcadeUtils,m=p.getViewInfo(d),y=p.createExecContext(s,m,r.timeZone);if(!l){const g=p.createSyntaxTree(t.valueExpression);l=p.createFunction(g),t.cache.compiledFunc=l}o=p.executeFunction(l,y);break}case"field":n&&(o=n[t.field]);break;case"unknown":o=null}if(!pd(o))return null;if(i||!t.normalizationField)return o;const c=n?parseFloat(n[t.normalizationField]):null;return pd(c)&&c!==0?o/c:null}function gSe(t){let e=null,r=null;const i=t.stops;return i?(e=i[0].value,r=i[i.length-1].value):(e=t.minDataValue||0,r=t.maxDataValue||0),(e+r)/2}function tx(t,e,r){const i="visualVariables"in t?t.visualVariables?.find(n=>n.type==="size"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void Q2("SizeVariable");const s=ZB(ySe(i,e,r),i,e,r,i.cache.ipData);return s==null||isNaN(s)?void 0:s}function ds(t,e,r){return t==null?null:cf(t)?tx(t,e,r):pd(t)?t:null}function WB(t,e,r){return pd(r)&&t>r?r:pd(e)&&t<e?e:t}function vSe(t,e,r,i){const s=ds(e.minSize,r,i)||e.minDataValue;return t==null&&s==null?null:(t??0)+(s??0)}function wSe(t,e,r){const i=t.stops;let s=i?.length&&i[0].size;return s==null&&(s=t.minSize),ds(s,e,r)}function _Se(t,e,r,i){const s=ds(e.minSize,r,i);if(t==null)return s;const{minDataValue:n,maxDataValue:o}=e;if(n==null||o==null)return null;const a=(t-n)/(o-n),l=ds(e.maxSize,r,i),c=i?.shape;if(t<=n)return s;if(t>=o)return l;if(s==null||l==null)return null;if(e.scaleBy==="area"&&c){const d=c==="circle",p=d?zb*(s/2)**2:s*s,m=p+a*((d?zb*(l/2)**2:l*l)-p);return d?2*Math.sqrt(m/zb):Math.sqrt(m)}return s+a*(l-s)}function bSe(t,e,r,i){const s=ds(e.minSize,r,i);if(t==null||s==null)return s;const n=i?.shape,{minDataValue:o}=e;if(o==null)return null;const a=t/o,l=ds(e.maxSize,r,i);let c=null;return c=n==="circle"?2*Math.sqrt(a*(s/2)**2):n==="square"||n==="diamond"||n==="image"?Math.sqrt(a*s**2):a*s,WB(c,s,l)}function SSe(t,e,r,i,s){if(t==null)return null;const[n,o,a]=tL(t,s);if(n===o)return ds(e.stops?.[n].size,r,i);{const l=ds(e.stops?.[n].size,r,i),c=ds(e.stops?.[o].size,r,i);return l==null||c==null?null:l+(c-l)*a}}function xSe(t,e,r,i){const s=(i?.resolution??1)*Y2[e.valueUnit],n=ds(e.minSize,r,i),o=ds(e.maxSize,r,i),{valueRepresentation:a}=e;if(t==null)return n;let l=null;return l=a==="area"?2*Math.sqrt(t/zb)/s:a==="radius"||a==="distance"?2*t/s:t/s,WB(l,n,o)}function ZB(t,e,r,i,s){switch(e.transformationType){case"additive":return vSe(t,e,r,i);case"constant":return wSe(e,r,i);case"clamped-linear":return _Se(t,e,r,i);case"proportional":return bSe(t,e,r,i);case"stops":return SSe(t,e,r,i,s);case"real-world-size":return xSe(t,e,r,i);case"identity":return t;case"unknown":return null}}function $Se(t,e,r){const{isScaleDriven:i}=t.cache;if(!(i&&r==="3d"||e))return null;const s={scale:e,view:r};let n=ds(t.minSize,GN,s),o=ds(t.maxSize,GN,s);if(n!=null||o!=null){if(n>o){const a=o;o=n,n=a}return{minSize:n,maxSize:o}}}function MSe(t,e,r){if(!t.visualVariables)return;const i=[],s=[],n=[],o=[],a=[];for(const l of t.visualVariables)switch(l.type){case"color":s.push(l);break;case"opacity":n.push(l);break;case"rotation":a.push(l);break;case"size":o.push(l)}return s.forEach(l=>{const c=qB(l,e,r);i.push({variable:l,value:c})}),n.forEach(l=>{const c=BB(l,e,r);i.push({variable:l,value:c})}),a.forEach(l=>{const c=HB(l,e,r);i.push({variable:l,value:c})}),o.forEach(l=>{const c=tx(l,e,r);i.push({variable:l,value:c})}),i}function tL(t,e){if(!e)return;let r=0,i=e.length-1;return e.some((s,n)=>t<s?(i=n,!0):(r=n,!1)),[r,i,(t-e[r])/(e[i]-e[r])]}function TSe(t,e,r){const i=["proportional","proportional","proportional"];for(const s of t){const n=s.useSymbolValue?"symbol-value":tx(s,e,r)??"proportional";switch(s.axis){case"width":i[0]=n;break;case"depth":i[1]=n;break;case"height":i[2]=n;break;case"width-and-depth":i[0]=n,i[1]=n;break;case"all":case void 0:case null:i[0]=n,i[1]=n,i[2]=n;break;default:s.axis}}return i}const $d=Object.freeze(Object.defineProperty({__proto__:null,getAllSizes:TSe,getColor:qB,getOpacity:BB,getRotationAngle:HB,getSize:tx,getSizeForValue:ZB,getSizeFromNumberOrVariable:ds,getSizeRangeAtScale:$Se,getVisualVariableValues:MSe,viewScaleRE:GB},Symbol.toStringTag,{value:"Module"}));var kE;const Kw=new Ne({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),LE=new Ne({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});function qN(t){if(t!=null)return typeof t=="string"||typeof t=="number"?fSe(t):t.type==="size"?cf(t)?t:(delete(t={...t}).type,new Ge(t)):void 0}function BN(t,e,r){if(typeof t!="object")return t;const i=new Ge;return i.read(t,r),i}let Ge=kE=class extends hi{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&GB.test(this.valueExpression)}}set index(t){cf(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),cf(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return VB(this)}set maxDataValue(t){t&&this.stops&&(U.getLogger(this).warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(U.getLogger(this).warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return qN(t)}readMaxSize(t,e,r){return BN(t,e,r)}set minDataValue(t){t&&this.stops&&(U.getLogger(this).warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(U.getLogger(this).warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return qN(t)}readMinSize(t,e,r){return BN(t,e,r)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(t){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,r)=>e.value-r.value):t&&(U.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return mSe(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,r,i){if(t==="$view.scale"){if(i?.messages){const s=this.index,n=typeof s=="string"?s:`visualVariables[${s}]`;i.messages.push(new R("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:n+".valueExpression",context:i}))}}else e[r]=t}readValueUnit(t){return t?LE.read(t):null}clone(){return new kE({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:cf(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:cf(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops?.map(t=>t.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions?.clone()})}flipSizes(){if(this.transformationType==="clamped-linear"){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if(this.transformationType==="stops"){const t=this.stops;if(!t)return this;const e=t.map(i=>i.size).reverse(),r=t.length;for(let i=0;i<r;i++)t[i].size=e[i];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops?.map(t=>t.value||0)}};u([h({readOnly:!0})],Ge.prototype,"cache",null),u([h({type:Kw.apiValues,json:{type:Kw.jsonValues,origins:{"web-map":{read:!1}},read:Kw.read,write:Kw.write}})],Ge.prototype,"axis",void 0),u([h()],Ge.prototype,"index",null),u([h({type:String,readOnly:!0})],Ge.prototype,"inputValueType",null),u([h({type:jB,json:{write:!0}})],Ge.prototype,"legendOptions",void 0),u([h({type:Number,value:null,json:{write:!0}})],Ge.prototype,"maxDataValue",null),u([h({type:Number,value:null,json:{write:!0}})],Ge.prototype,"maxSize",null),u([He("maxSize")],Ge.prototype,"castMaxSize",null),u([X("maxSize")],Ge.prototype,"readMaxSize",null),u([h({type:Number,value:null,json:{write:!0}})],Ge.prototype,"minDataValue",null),u([h({type:Number,value:null,json:{write:!0}})],Ge.prototype,"minSize",null),u([He("minSize")],Ge.prototype,"castMinSize",null),u([X("minSize")],Ge.prototype,"readMinSize",null),u([h({type:String,json:{write:!0}})],Ge.prototype,"normalizationField",void 0),u([h({readOnly:!0})],Ge.prototype,"arcadeRequired",null),u([h({type:String})],Ge.prototype,"scaleBy",void 0),u([h({type:[qn],value:null,json:{write:!0}})],Ge.prototype,"stops",null),u([h({type:["outline"],json:{write:!0}})],Ge.prototype,"target",void 0),u([h({type:String,readOnly:!0})],Ge.prototype,"transformationType",null),u([h({type:["size"],json:{type:["sizeInfo"]}})],Ge.prototype,"type",void 0),u([h({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],Ge.prototype,"useSymbolValue",void 0),u([h({type:String,json:{write:!0}})],Ge.prototype,"valueExpression",void 0),u([X("valueExpression",["valueExpression","expression"])],Ge.prototype,"readValueExpression",null),u([te("web-scene","valueExpression")],Ge.prototype,"writeValueExpressionWebScene",null),u([h({type:["radius","diameter","area","width","distance"],json:{write:!0}})],Ge.prototype,"valueRepresentation",void 0),u([h({type:LE.apiValues,json:{write:LE.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],Ge.prototype,"valueUnit",void 0),u([X("valueUnit")],Ge.prototype,"readValueUnit",null),Ge=kE=u([E("esri.renderers.visualVariables.SizeVariable")],Ge);const ISe={color:Iu,size:Ge,opacity:dl,rotation:Eu},ESe=new Ne({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),CSe=/^\[([^\]]+)\]$/i;let jb=class extends le{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),e=e?.filter(r=>!!r),e?.length){for(const r of e)switch(r.type){case"color":this.colorVariables.push(r);break;case"opacity":this.opacityVariables.push(r);break;case"rotation":this.rotationVariables.push(r);break;case"size":this.sizeVariables.push(r)}this.sizeVariables.length&&this.sizeVariables.some(r=>!!r.target)&&e.sort((r,i)=>{let s=null;return s=r.target===i.target?0:r.target?1:-1,s});for(let r=0;r<e.length;r++)e[r].index=r;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,r,i){const{rotationExpression:s,rotationType:n}=r,o=s?.match(CSe),a=o?.[1];if(a&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:n,field:a})),e)return e.map(l=>{const c=ESe.read(l.type),d=ISe[c];d||(U.getLogger(this).warn(`Unknown variable type: ${c}`),i?.messages&&i.messages.push(new zs("visual-variable:unsupported",`visualVariable of type '${c}' is not supported`,{definition:l,context:i})));const p=new d;return p.read(l,i),p})}writeVariables(e,r){const i=[];for(const s of e){const n=s.toJSON(r);n&&i.push(n)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};u([h()],jb.prototype,"visualVariables",null),jb=u([E("esri.renderers.visualVariables.VisualVariableFactory")],jb);const PSe={base:hi,key:"type",typeMap:{opacity:dl,color:Iu,rotation:Eu,size:Ge}},sy=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this._vvFactory=new jb}set visualVariables(i){this._vvFactory.visualVariables=i,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(i,s,n){return this._vvFactory.readVariables(i,s,n)}writeVisualVariables(i,s,n,o){s[n]=this._vvFactory.writeVariables(i,o)}get arcadeRequiredForVisualVariables(){return this.visualVariables?.some(({arcadeRequired:i})=>i)??!1}hasVisualVariables(i,s){return i?this.getVisualVariablesForType(i,s).length>0:this.getVisualVariablesForType("size",s).length>0||this.getVisualVariablesForType("color",s).length>0||this.getVisualVariablesForType("opacity",s).length>0||this.getVisualVariablesForType("rotation",s).length>0}getVisualVariablesForType(i,s){return this.visualVariables?.filter(n=>n.type===i&&(typeof s=="string"?n.target===s:s!==!1||!n.target))??[]}async collectVVRequiredFields(i,s){let n=[];this.visualVariables&&(n=n.concat(this.visualVariables));for(const o of n)o&&(o.field&&Mi(i,s,o.field),o.normalizationField&&Mi(i,s,o.normalizationField),o.valueExpression&&(kSe(o.valueExpression,i,s)||await ei(i,s,null,o.valueExpression)))}};return u([h({types:[PSe],value:null,json:{write:!0}})],r.prototype,"visualVariables",null),u([X("visualVariables",["visualVariables","rotationType","rotationExpression"])],r.prototype,"readVisualVariables",null),u([te("visualVariables")],r.prototype,"writeVisualVariables",null),r=u([E("esri.renderers.mixins.VisualVariablesMixin")],r),r};function kSe(t,e,r){const i=Lhe(t);return i!=null&&(Mi(e,r,i),!0)}const rL=[252,146,31,255],LSe=[153,153,153,255],ASe={type:"esriSMS",style:"esriSMSCircle",size:6,color:rL,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},RSe={type:"esriSLS",style:"esriSLSSolid",width:.75,color:rL},OSe={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},FSe={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},NSe={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},DSe={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},zSe={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null},yS=Pt.fromJSON(ASe),rx=Ot.fromJSON(RSe),JB=vi.fromJSON(OSe),jSe=rt.fromJSON(FSe);function kVe(t){if(t==null)return null;switch(t.type){case"mesh":return null;case"point":case"multipoint":return yS;case"polyline":return rx;case"polygon":case"extent":return JB}return null}const LVe=Pt.fromJSON(NSe),AVe=Ot.fromJSON(DSe),RVe=vi.fromJSON(zSe),VSe=ji.fromSimpleMarkerSymbol(yS),USe=Kn.fromSimpleLineSymbol(rx),GSe=dn.fromSimpleFillSymbol(JB),qSe=new yl({symbolLayers:new se([new Fi({material:{color:rL},edges:new p7({size:Ke(1),color:new K(LSe)})})])}),BSe=new Kn({symbolLayers:new se([new Oi({material:{color:new K([0,0,0])},size:Ke(1)})])}),HSe=new dn({symbolLayers:new se([new Fi({outline:{color:new K([0,0,0]),size:Ke(1)}})])});function OVe(t){if(t==null)return null;switch(t.type){case"mesh":return qSe;case"point":case"multipoint":return VSe;case"polyline":return USe;case"polygon":case"extent":return GSe}return null}const HN="#useCIMFallbackSymbology()",pl={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function Cm(t,e=pl){if(!t)return{symbol:null};const{retainId:r=pl.retainId,ignoreDrivers:i=pl.ignoreDrivers,hasLabelingContext:s=pl.hasLabelingContext,retainCIM:n=pl.retainCIM,cimFallbackEnabled:o=pl.cimFallbackEnabled}=e;let a=null;if(so(t))a=t.clone();else if(t.type==="web-style")a=t.clone();else if(t.type==="cim"){const l=t.data?.symbol?.type;switch(l){case"CIMPointSymbol":a=n?t.clone():ji.fromCIMSymbol(t);break;case"CIMLineSymbol":o&&(a=BSe.clone(),e?.logWarning?.(HN,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":o&&(a=HSe.clone(),e?.logWarning?.(HN,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!a)return{error:new R("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${l||"unknown"}' is unsupported in 3D`,{symbol:t})}}else if(t instanceof Ot)a=Kn.fromSimpleLineSymbol(t);else if(t instanceof Pt)a=ji.fromSimpleMarkerSymbol(t);else if(t instanceof ci)a=ji.fromPictureMarkerSymbol(t);else if(t instanceof vi)a=e.geometryType&&e.geometryType==="mesh"?yl.fromSimpleFillSymbol(t):dn.fromSimpleFillSymbol(t);else{if(!(t instanceof rt))return{error:new R("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};a=s?Vn.fromTextSymbol(t):ji.fromTextSymbol(t)}return r&&a&&a.type!=="cim"&&(a.id=t.id),!i||a.type==="cim"||a instanceof Jr||a.symbolLayers.forEach(l=>l.ignoreDrivers=!0),{symbol:a}}function gS(t,e,r,i){const s=YB(t,{},{context:i,isLabelSymbol:!1});s!=null&&Ir(r,s,e)}function WN(t,e,r,i){const s=YB(t,{},{context:i,isLabelSymbol:!0});s!=null&&(e[r]=s)}function ZN(t){return so(t)||t instanceof Jr}function WSe(t){return t?.type==="polygon-3d"||t?.type==="line-3d"}function YB(t,e,r){if(t==null)return null;const{context:i,isLabelSymbol:s}=r,n=i?.origin,o=i?.messages;if(n==="web-scene"&&!ZN(t)){const a=Cm(t,{retainCIM:!0,hasLabelingContext:s});return a.symbol!=null?a.symbol.write(e,i):(o?.push(new R("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:i,error:a.error})),null)}return gT(i?.layer)&&WSe(t)?(o?.push(new R("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported on layers of type '${i?.layer?.declaredClass}'.`,{symbol:t,context:i})),null):(n==="web-map"||n==="portal-item"&&!gT(i?.layer))&&ZN(t)?(o?.push(new R("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:t,context:i})),null):t.write(e,i)}function XB(t,e){return Ppe(t,null,e)}const ix={types:R7,json:{write:{writer:gS},origins:{"web-scene":{types:v5,write:{writer:gS},read:{reader:Gm({types:v5})}}}}},iL=DC({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},ix),sL={types:{base:er,key:"type",typeMap:{"simple-fill":ju.typeMap["simple-fill"],"picture-fill":ju.typeMap["picture-fill"],"polygon-3d":ju.typeMap["polygon-3d"],cim:ju.typeMap.cim}},json:{write:{writer:gS},origins:{"web-scene":{type:dn,write:{writer:gS}}}}},Vb={cast:t=>t==null||typeof t=="string"||typeof t=="number"?t:`${t}`,json:{type:String,write:{writer:(t,e)=>{e.value=t?.toString()}}}};var AE;let Vi=AE=class extends sy(Os){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.symbols.map(r=>r.collectRequiredFields(t,e)))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}get symbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){return this.symbols.reduce((t,e)=>t+JSON.stringify(e),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new AE({description:this.description,label:this.label,symbol:O(this.symbol),visualVariables:O(this.visualVariables),authoringInfo:O(this.authoringInfo)})}};u([h({type:String,json:{write:!0}})],Vi.prototype,"description",void 0),u([h({type:String,json:{write:!0}})],Vi.prototype,"label",void 0),u([h(iL)],Vi.prototype,"symbol",void 0),u([ye({simple:"simple"})],Vi.prototype,"type",void 0),Vi=AE=u([E("esri.renderers.SimpleRenderer")],Vi);const ZSe=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function RE(t){return t instanceof le}function JN(t){return t instanceof se?Object.keys(t.items):RE(t)?Hi(t).keys():t?Object.keys(t):[]}function Qw(t,e){return t instanceof se?t.items[e]:t[e]}function JSe(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function M0(t){return t?t.declaredClass:null}function KB(t,e){const r=t.diff;if(r&&typeof r=="function")return r(t,e);const i=JN(t),s=JN(e);if(i.length===0&&s.length===0)return;if(!i.length||!s.length||JSe(t,e))return{type:"complete",oldValue:t,newValue:e};const n=s.filter(p=>!i.includes(p)),o=i.filter(p=>!s.includes(p)),a=i.filter(p=>s.includes(p)&&Qw(t,p)!==Qw(e,p)).concat(n,o).sort(),l=M0(t);if(l&&ZSe.has(l)&&a.length)return{type:"complete",oldValue:t,newValue:e};let c;const d=RE(t)&&RE(e);for(const p of a){const m=Qw(t,p),y=Qw(e,p);let g;if((d||typeof m!="function"&&typeof y!="function")&&m!==y&&(m!=null||y!=null)){if(r&&r[p]&&typeof r[p]=="function")g=r[p]?.(m,y);else if(m instanceof Date&&y instanceof Date){if(m.getTime()===y.getTime())continue;g={type:"complete",oldValue:m,newValue:y}}else g=typeof m=="object"&&typeof y=="object"&&M0(m)===M0(y)?KB(m,y):{type:"complete",oldValue:m,newValue:y};g!=null&&(c!=null?c.diff[p]=g:c={type:"partial",diff:{[p]:g}})}}return c}function FVe(t,e){if(t==null)return!1;const r=e.split(".");let i=t;for(const s of r){if(i.type==="complete")return!0;if(i.type!=="partial")return!1;{const n=i.diff[s];if(!n)return!1;i=n}}return!0}function YSe(t,e){if(typeof t!="function"&&typeof e!="function"&&(t!=null||e!=null))return t==null||e==null||typeof t=="object"&&typeof e=="object"&&M0(t)!==M0(e)?{type:"complete",oldValue:t,newValue:e}:KB(t,e)}function e_(t){if(t==null)return!0;switch(t.type){case"complete":return!1;case"collection":{const e=t;for(const r of e.added)if(!e_(r))return!1;for(const r of e.removed)if(!e_(r))return!1;for(const r of e.changed)if(!e_(r))return!1;return!0}case"partial":for(const e in t.diff)if(!e_(t.diff[e]))return!1;return!0}}var OE;const XSe=yr()({ascendingValues:"ascending-values",descendingValues:"descending-values"});let Vg=OE=class extends Ie(W){static from(t){return Um(OE,t)}constructor(t){super(t),this.title=null,this.order=null}};u([h({type:String,json:{write:!0}})],Vg.prototype,"title",void 0),u([ye(XSe)],Vg.prototype,"order",void 0),Vg=OE=u([E("esri.renderers.support.RendererLegendOptions")],Vg);const nL=Vg;let Jn=class extends Ie(W){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};u([h(Vb)],Jn.prototype,"value",void 0),u([h(Vb)],Jn.prototype,"value2",void 0),u([h(Vb)],Jn.prototype,"value3",void 0),Jn=u([E("esri.renderers.support.UniqueValue")],Jn);let sl=class extends Ie(W){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(e==null)return null;const r=typeof(e=Array.isArray(e)?e:[e])[0];return r==="string"||r==="number"?e.map(i=>new Jn({value:i})):r==="object"?e[0]instanceof Jn?e:e.map(i=>new Jn(i)):null}};u([h({type:String,json:{write:!0}})],sl.prototype,"description",void 0),u([h({type:String,json:{write:!0}})],sl.prototype,"label",void 0),u([h(ix)],sl.prototype,"symbol",void 0),u([h({type:[Jn],json:{type:[[String]],read:{reader:t=>t?t.map(e=>new Jn({value:e[0],value2:e[1],value3:e[2]})):null},write:{writer:(t,e)=>{const r=[];for(const i of t){const s=[i.value,i.value2,i.value3].filter(fr).map(n=>n.toString());r.push(s)}e.values=r}}}})],sl.prototype,"values",void 0),u([He("values")],sl.prototype,"castValues",null),sl=u([E("esri.renderers.support.UniqueValueClass")],sl);let Nh=class extends Ie(W){constructor(e){super(e),this.heading=null,this.classes=null}};u([h({type:String,json:{write:!0}})],Nh.prototype,"heading",void 0),u([h({type:[sl],json:{write:{isRequired:!0}}})],Nh.prototype,"classes",void 0),Nh=u([E("esri.renderers.support.UniqueValueGroup")],Nh);var FE;let Wn=FE=class extends W{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new FE({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol?.toJSON());return`${this.value}.${t}`}};u([h({type:String,json:{write:!0}})],Wn.prototype,"description",void 0),u([h({type:String,json:{write:!0}})],Wn.prototype,"label",void 0),u([h(iL)],Wn.prototype,"symbol",void 0),u([h(Vb)],Wn.prototype,"value",void 0),Wn=FE=u([E("esri.renderers.support.UniqueValueInfo")],Wn);const YN=new Map;async function KSe(t,e){try{return{data:(await oL(t,e)).data,baseUrl:WC(t),styleUrl:t}}catch(r){return Po(r),null}}function QSe(t,e,r){const i=e.portal!=null?e.portal:J.getDefault();let s;const n=`${i.url} - ${i.user?.username} - ${t}`,o=YN.get(n);if(o)return o;const a=e2e(t,i,r).then(l=>(s=l,l.fetchData())).then(l=>({data:l,baseUrl:s.itemUrl??"",styleName:t}));return YN.set(n,a),a}function e2e(t,e,r){return e.load(r).then(()=>{const i=new Jt({disableExtraQuery:!0,query:`owner:${XN} AND type:${KN} AND typekeywords:"${t}"`});return e.queryItems(i,r)}).then(({results:i})=>{let s=null;const n=t.toLowerCase();if(i&&Array.isArray(i)){for(const o of i)if(o.typeKeywords?.some(l=>l.toLowerCase()===n)&&o.type===KN&&o.owner===XN){s=o;break}}if(!s)throw new R("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return s.load(r)})}function QB(t,e,r){return t?.styleUrl!=null?KSe(t.styleUrl,r):t?.styleName!=null?QSe(t.styleName,e,r):Promise.reject(new R("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function eH(t){return t===null||t.type==="CIMSymbolReference"?t:{type:"CIMSymbolReference",symbol:t}}function t2e(t,e){for(const r of e)switch(r){case"cim":if(t.cimRef)return{format:r,url:encodeURI(t.cimRef)};break;case"web-gltf-basisu":{const i=J$(t,"gltf_basisu");if(i)return{format:r,url:i};break}case"web-gltf":{const i=J$(t,"gltf");if(i)return{format:r,url:i};break}case"web":{const i=J$(t,"gltf");if(i)return{format:"web-gltf",url:i};if(t.webRef)return{format:r,url:encodeURI(t.webRef)};break}}}function J$(t,e){if(!z("enable-feature:force-wosr"))return t.formatInfos?.find(r=>r.type===e)?.href}function oL(t,e){const r={responseType:"json",query:{f:"json"},...e};return Be(Qn(t),r)}const XN="esri_en",KN="Style",r2e="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var Ug;const QN="uvInfos-watcher",eD="uvGroups-watcher",i2e=",",s2e=jt(Wn);function n2e(t){const{field1:e,field2:r,field3:i,fieldDelimiter:s,uniqueValueInfos:n,valueExpression:o}=t,a=!(!e||!r);return[{classes:(n??[]).map(l=>{const{symbol:c,label:d,value:p,description:m}=l,[y,g,v]=a?p?.toString()?.split(s||"")||[]:[p],w=[];return(e||o)&&w.push(y),r&&w.push(g),i&&w.push(v),{symbol:c,label:d,values:[w],description:m}})}]}function Hd(t){return t!=null&&t!==""&&(typeof t!="string"||t.trim()!==""&&t.toLowerCase()!=="<null>")||(t=null),t+""}let mt=Ug=class extends sy(Os){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,r){if(!e&&!r)return;if(!e||!r)return{type:"complete",oldValue:e,newValue:r};let i=!1;const s={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let n=0;n<r.length;n++){const o=e.find(a=>a.value===r[n].value);o?YSe(o,r[n])?(s.changed.push({type:"complete",oldValue:o,newValue:r[n]}),i=!0):s.unchanged.push({oldValue:o,newValue:r[n]}):(s.added.push(r[n]),i=!0)}for(let n=0;n<e.length;n++)r.find(o=>o.value===e[n].value)||(s.removed.push(e[n]),i=!0);return i?s:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(t){this._set("field",t),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(t){return t==null||typeof t=="function"?t:Iv(t)}writeField(t,e,r,i){typeof t=="string"?e[r]=t:i?.messages?i.messages.push(new R("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):U.getLogger(this).error(".field: cannot write field to JSON since it's not a string value")}set field2(t){this._set("field2",t),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(t){this._set("field3",t),this._updateUniqueValues()}set valueExpression(t){this._set("valueExpression",t),this._updateUniqueValues()}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}set fieldDelimiter(t){this._set("fieldDelimiter",t),this._updateUniqueValues()}readPortal(t,e,r){return r.portal||J.getDefault()}readStyleOrigin(t,e,r){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const i=Il(e.styleUrl,r);return Object.freeze({styleUrl:i})}}writeStyleOrigin(t,e,r,i){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=td(t.styleUrl,i))}set uniqueValueGroups(t){this.styleOrigin?U.getLogger(this).error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",t),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(t){this.styleOrigin?U.getLogger(this).error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(t,e){if(this.styleOrigin)return void U.getLogger(this).error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let r;r=typeof t=="object"?s2e(t):new Wn({value:t,symbol:O7(e)}),this.uniqueValueInfos?.push(r),this._valueInfoMap[Hd(r.value)]=r,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(t){if(this.styleOrigin)return void U.getLogger(this).error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const e=this.uniqueValueInfos;if(e)for(let r=0;r<e.length;r++){const i=e[r];if(String(i.value)===String(t)){delete this._valueInfoMap[Hd(t)],e.splice(r,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(t,e){let r=e;return this.valueExpression&&e?.arcade==null&&(r={...r,arcade:await kl()}),this._getUniqueValueInfo(t,r)}getSymbol(t,e){return this.valueExpression&&e?.arcade==null?void U.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used"):this._getUniqueValueInfo(t,e)?.symbol||this.defaultSymbol}async getSymbolAsync(t,e){let r=e;if(this.valueExpression&&r?.arcade==null){const s=await kl(),{arcadeUtils:n}=s;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),r={...r,arcade:s}}return this._getUniqueValueInfo(t,r)?.symbol||this.defaultSymbol}get symbols(){const t=[];if(this._isInfosSource)for(const e of this.uniqueValueInfos??[])e.symbol&&t.push(e.symbol);else for(const e of this.uniqueValueGroups??[])for(const r of e.classes??[])r.symbol&&t.push(r.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),r=this.uniqueValueInfos?.reduce((i,s)=>i+s.getMeshHash(),"");return`${t}.${e}.${r}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const t=new Ug({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:O(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:O(this.visualVariables),legendOptions:O(this.legendOptions),authoringInfo:O(this.authoringInfo),backgroundFillSymbol:O(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=O(this.uniqueValueInfos),r=O(this.uniqueValueGroups);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(O(this.styleOrigin))),Object.freeze(e),Object.freeze(r)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t._set("uniqueValueGroups",r),t._isInfosSource=this._isInfosSource,t._watchUniqueValueInfosAndGroups(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const r=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(r)}async collectSymbolFields(t,e){const r=[...this.symbols.map(i=>i.collectRequiredFields(t,e)),ei(t,e,null,this.valueExpression)];Mi(t,e,this.field),Mi(t,e,this.field2),Mi(t,e,this.field3),await Promise.all(r)}populateFromStyle(){return QB(this.styleOrigin,{portal:this.portal}).then(t=>{const e=[];return this._valueInfoMap={},t?.data&&Array.isArray(t.data.items)&&t.data.items.forEach(r=>{const i=new Jr({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:r.name});this.defaultSymbol||r.name!==t.data.defaultItem||(this.defaultSymbol=i,this._isDefaultSymbolDerived=!0);const s=new Wn({value:r.name,symbol:i});e.push(s),this._valueInfoMap[Hd(r.name)]=s}),this._set("uniqueValueInfos",Object.freeze(e)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&this.uniqueValueInfos?.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this})}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",i2e)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:t}=this;if(t)for(const e of t)this._valueInfoMap[Hd(e.value)]=e}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(QN);const{uniqueValueInfos:t}=this;if(t){const e=[];for(const r of t)e.push(ie(()=>({symbol:r.symbol,value:r.value,label:r.label,description:r.description}),(i,s)=>{i!==s&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)},{sync:!0}));this.addHandles(e,QN)}}_watchUniqueValueGroups(){this.removeHandles(eD);const{uniqueValueGroups:t}=this;if(t){const e=[];for(const r of t){e.push(ie(()=>({classes:r.classes}),(i,s)=>{i!==s&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}));for(const i of r.classes??[])e.push(ie(()=>({symbol:i.symbol,values:i.values,label:i.label,description:i.description}),(s,n)=>{s!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}))}this.addHandles(e,eD)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const t=[],{field:e,field2:r,field3:i,fieldDelimiter:s,uniqueValueGroups:n,valueExpression:o}=this;if(!e&&!o)return this._set("uniqueValueInfos",t),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!e||!r);for(const l of n)for(const c of l.classes??[]){const{symbol:d,label:p,values:m,description:y}=c;for(const g of m??[]){const{value:v,value2:w,value3:_}=g,x=[v];r&&x.push(w),i&&x.push(_);const $=a?x.join(s||""):x[0]??void 0;t.push(new Wn({symbol:d,label:p,value:$,description:y}))}}this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(t=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:e,field2:r,valueExpression:i,fieldDelimiter:s,uniqueValueInfos:n}=this;if(!e&&!i||!n.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!e||!r),a=n.map(c=>{const{symbol:d,label:p,value:m,description:y}=c,[g,v,w]=o?m?.toString()?.split(s||"")||[]:[m];return new sl({symbol:d,label:p,description:y,values:[new Jn({value:g,value2:v,value3:w})]})}),l=[new Nh({classes:a})];t&&Object.freeze(l),this._set("uniqueValueGroups",l),this._watchUniqueValueGroups()}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:r,scale:i,spatialReference:s,arcade:n,timeZone:o}=e??{};let a=this._cache.compiledFunc;const l=n.arcadeUtils;if(!a){const d=l.createSyntaxTree(this.valueExpression);a=l.createFunction(d),this._cache.compiledFunc=a}const c=l.executeFunction(a,l.createExecContext(t,l.getViewInfo({viewingMode:r,scale:i,spatialReference:s}),o));return this._valueInfoMap[Hd(c)]}_getUnqiueValueInfoForFields(t){const e=this.field,r=t.attributes;let i;if(this.field2){const s=this.field2,n=this.field3,o=[];e&&o.push(r[e]),s&&o.push(r[s]),n&&o.push(r[n]),i=o.join(this.fieldDelimiter||"")}else e&&(i=r[e]);return this._valueInfoMap[Hd(i)]}static fromPortalStyle(t,e){const r=new Ug(e?.properties);r._set("styleOrigin",Object.freeze({styleName:t})),r._set("portal",e?.portal||J.getDefault());const i=r.populateFromStyle();return i.catch(s=>{U.getLogger(this.prototype).error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",s)}),i}static fromStyleUrl(t,e){const r=new Ug(e?.properties);r._set("styleOrigin",Object.freeze({styleUrl:t}));const i=r.populateFromStyle();return i.catch(s=>{U.getLogger(this.prototype).error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",s)}),i}};u([h({readOnly:!0})],mt.prototype,"_cache",null),u([ye({uniqueValue:"unique-value"})],mt.prototype,"type",void 0),u([h(sL)],mt.prototype,"backgroundFillSymbol",void 0),u([h({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],mt.prototype,"field",null),u([He("field")],mt.prototype,"castField",null),u([te("field")],mt.prototype,"writeField",null),u([h({type:String,value:null,json:{write:!0}})],mt.prototype,"field2",null),u([h({type:String,value:null,json:{write:!0}})],mt.prototype,"field3",null),u([h({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],mt.prototype,"orderByClassesEnabled",void 0),u([h({type:String,value:null,json:{write:!0}})],mt.prototype,"valueExpression",null),u([h({type:String,json:{write:!0}})],mt.prototype,"valueExpressionTitle",void 0),u([h({type:nL,json:{write:!0}})],mt.prototype,"legendOptions",void 0),u([h({type:String,json:{write:!0}})],mt.prototype,"defaultLabel",void 0),u([h(DC({...ix},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],mt.prototype,"defaultSymbol",null),u([h({type:String,value:null,json:{write:!0}})],mt.prototype,"fieldDelimiter",null),u([h({type:J,readOnly:!0})],mt.prototype,"portal",void 0),u([X("portal",["styleName"])],mt.prototype,"readPortal",null),u([h({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],mt.prototype,"styleOrigin",void 0),u([X("styleOrigin",["styleName","styleUrl"])],mt.prototype,"readStyleOrigin",null),u([te("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],mt.prototype,"writeStyleOrigin",null),u([h({type:[Nh],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(t,e,r)=>(e.uniqueValueGroups||n2e(e)).map(i=>Nh.fromJSON(i,r))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],mt.prototype,"uniqueValueGroups",null),u([h({type:[Wn],json:{read:!1,write:{isRequired:!0,overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0,isRequired:!0}}}}})],mt.prototype,"uniqueValueInfos",null),mt=Ug=u([E("esri.renderers.UniqueValueRenderer")],mt);var NE,rm;let br=(rm=class extends W{constructor(e){super(e),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.orderByFields=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(e,r){r.resultOffset=this.start,r.resultRecordCount=this.num||10}clone(){return new NE(O({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}},NE=rm,rm);u([h({type:[String],json:{write:!0}})],br.prototype,"attachmentTypes",void 0),u([h({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],br.prototype,"attachmentsWhere",void 0),u([h({type:Boolean,json:{write:!0}})],br.prototype,"cacheHint",void 0),u([h({type:[String],json:{write:!0}})],br.prototype,"keywords",void 0),u([h({type:[String],json:{write:!0}})],br.prototype,"globalIds",void 0),u([h({json:{write:!0}})],br.prototype,"name",void 0),u([h({type:Number,json:{read:{source:"resultRecordCount"}}})],br.prototype,"num",void 0),u([h({type:[Number],json:{write:!0}})],br.prototype,"objectIds",void 0),u([h({type:[String],json:{write:!0}})],br.prototype,"orderByFields",void 0),u([h({type:Boolean,json:{default:!1,write:!0}})],br.prototype,"returnMetadata",void 0),u([h({type:[Number],json:{write:!0}})],br.prototype,"size",void 0),u([h({type:Number,json:{read:{source:"resultOffset"}}})],br.prototype,"start",void 0),u([te("start"),te("num")],br.prototype,"writeStart",null),u([h({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],br.prototype,"where",void 0),br=NE=u([E("esri.rest.support.AttachmentQuery")],br),br.from=jt(br);const tH=yr()({naturalLog:"natural-log",squareRoot:"square-root",percentOfTotal:"percent-of-total",log:"log",field:"field"}),tD="percent-of-total",rD="field",jVe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.normalizationField=null,this.normalizationMaxValue=null,this.normalizationMinValue=null,this.normalizationTotal=null}get normalizationType(){let i=this._get("normalizationType");const s=!!this.normalizationField,n=this.normalizationTotal!=null;return s||n?(i=s&&rD||n&&tD||null,s&&n&&U.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):i!==rD&&i!==tD||(i=null),i}set normalizationType(i){this._set("normalizationType",i)}};return u([h({type:String,json:{name:"parameters.normalizationField",write:!0}})],r.prototype,"normalizationField",void 0),u([h({type:Number,json:{name:"parameters.normalizationMaxValue",write:!0}})],r.prototype,"normalizationMaxValue",void 0),u([h({type:Number,json:{name:"parameters.normalizationMinValue",write:!0}})],r.prototype,"normalizationMinValue",void 0),u([h({type:Number,json:{name:"parameters.normalizationTotal",write:!0}})],r.prototype,"normalizationTotal",void 0),u([ye(tH,{name:"parameters.normalizationType"})],r.prototype,"normalizationType",null),r=u([E("esri.rest.support.NormalizationBinParametersMixin")],r),r};var DE,im;let _t=(im=class extends W{constructor(e){super(e),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(e,r){r.historicMoment=e&&e.getTime()}writeStart(e,r){r.resultOffset=this.start,r.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(r.definitionExpression="1=1")}clone(){return new DE(O({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}},DE=im,im);u([h({type:Boolean,json:{write:!0}})],_t.prototype,"cacheHint",void 0),u([h({type:Un,json:{write:!0}})],_t.prototype,"dynamicDataSource",void 0),u([h({type:String,json:{write:!0}})],_t.prototype,"gdbVersion",void 0),u([h({type:Number,json:{write:!0}})],_t.prototype,"geometryPrecision",void 0),u([h({type:Date})],_t.prototype,"historicMoment",void 0),u([te("historicMoment")],_t.prototype,"_writeHistoricMoment",null),u([h({type:Number,json:{write:!0}})],_t.prototype,"maxAllowableOffset",void 0),u([h({json:{write:!0}})],_t.prototype,"objectIds",void 0),u([h({type:[String],json:{write:!0}})],_t.prototype,"orderByFields",void 0),u([h({type:[String],json:{write:!0}})],_t.prototype,"outFields",void 0),u([h({type:ne,json:{read:{source:"outSR"},write:{target:"outSR"}}})],_t.prototype,"outSpatialReference",void 0),u([h({json:{write:!0}})],_t.prototype,"relationshipId",void 0),u([h({type:Number,json:{read:{source:"resultOffset"}}})],_t.prototype,"start",void 0),u([te("start"),te("num")],_t.prototype,"writeStart",null),u([h({type:Number,json:{read:{source:"resultRecordCount"}}})],_t.prototype,"num",void 0),u([h({json:{write:!0}})],_t.prototype,"returnGeometry",void 0),u([h({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],_t.prototype,"returnM",void 0),u([h({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],_t.prototype,"returnZ",void 0),u([h({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],_t.prototype,"where",void 0),_t=DE=u([E("esri.rest.support.RelationshipQuery")],_t),_t.from=jt(_t);const VVe=Object.freeze(Object.defineProperty({__proto__:null,get default(){return _t}},Symbol.toStringTag,{value:"Module"})),zE=new Ne({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function o2e(t,e,r,i){const s=await _c(t);if(await aL(t,e,i),!s.addAttachment)throw new R(i,"Layer source does not support addAttachment capability");return s.addAttachment(e,r)}function aL(t,e,r){const{attributes:i}=e,{objectIdField:s}=t;return t.capabilities?.data?.supportsAttachment?e?i?s&&i[s]?Promise.resolve():Promise.reject(new R(r,`feature is missing the identifying attribute ${s}`)):Promise.reject(new R(r,"'attributes' are required on a feature to query attachments")):Promise.reject(new R(r,"A feature is required to add/delete/update attachments")):Promise.reject(new R(r,"this layer doesn't support attachments"))}async function a2e(t,e,r,i,s){const n=await _c(t);if(await aL(t,e,s),!n.updateAttachment)throw new R(s,"Layer source does not support updateAttachment capability");return n.updateAttachment(e,r,i)}async function l2e(t,e,r){const{applyEdits:i}=await q(()=>import("./editingSupport-BH_vRt3P.js"),[]),s=await t.load();let n=r;return s.type==="feature"&&s.infoFor3D&&e.deleteFeatures!=null&&s.globalIdField!=null&&(n={...n,globalIdToObjectId:await P2e(s,e.deleteFeatures,s.globalIdField)}),i(s,s.source,e,r)}async function u2e(t,e,r){const{uploadAssets:i}=await q(()=>import("./editingSupport-BH_vRt3P.js"),[]),s=await t.load();return i(s,s.source,e,r)}async function c2e(t,e,r,i){const s=await _c(t);if(await aL(t,e,i),!s.deleteAttachments)throw new R(i,"Layer source does not support deleteAttachments capability");return s.deleteAttachments(e,r)}async function h2e(t,e,r){const i=(await t.load({signal:e?.signal})).source;if(!i.fetchRecomputedExtents)throw new R(r,"Layer source does not support fetchUpdates capability");return i.fetchRecomputedExtents(e)}async function d2e(t,e,r,i){e=br.from(e),await t.load();const s=t.source,n=t.capabilities;if(!n?.data?.supportsAttachment)throw new R(i,"this layer doesn't support attachments");const{attachmentTypes:o,objectIds:a,globalIds:l,num:c,size:d,start:p,where:m}=e;if(!n?.operations?.supportsQueryAttachments&&(o?.length>0||l?.length>0||d?.length>0||c||p||m))throw new R(i,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(a?.length||l?.length||m))throw new R(i,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!s.queryAttachments)throw new R(i,"Layer source does not support queryAttachments capability",e);return!n?.attachment?.supportsOrderByFields&&e.orderByFields?.length&&((e=e.clone()).orderByFields=null),s.queryAttachments(e)}async function p2e(t,e,r,i){const s=await _c(t);if(!s.queryObjectIds)throw new R(i,"Layer source does not support queryObjectIds capability");return s.queryObjectIds(fe.from(e)??t.createQuery(),r)}async function f2e(t,e,r,i){const s=await _c(t);if(!s.queryFeatureCount)throw new R(i,"Layer source does not support queryFeatureCount capability");return s.queryFeatureCount(fe.from(e)??t.createQuery(),r)}async function m2e(t,e,r,i){const s=await _c(t);if(!s.queryExtent)throw new R(i,"Layer source does not support queryExtent capability");return s.queryExtent(fe.from(e)??t.createQuery(),r)}async function y2e(t,e,r,i){const s=await _c(t);if(!s.queryRelatedFeatures)throw new R(i,"Layer source does not support queryRelatedFeatures capability");return s.queryRelatedFeatures(_t.from(e),r)}async function g2e(t,e,r,i){const s=await _c(t);if(!s.queryRelatedFeaturesCount)throw new R(i,"Layer source does not support queryRelatedFeaturesCount capability");return s.queryRelatedFeaturesCount(_t.from(e),r)}async function v2e(t){const e=t.source;if(e?.refresh)try{const{dataChanged:r,updates:i}=await e.refresh();if(i!=null&&(t.sourceJSON={...t.sourceJSON,...i},t.read(i,{origin:"service",url:t.parsedUrl})),r)return!0}catch{}if(t.definitionExpression)try{return(await uk(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function w2e(t){const e=new fe;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,e.outFields=["*"],e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null;const r=t.capabilities?.query;r&&(e.compactGeometryEnabled=r.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=r.supportsDefaultSpatialReference);const i=t.capabilities?.data;i?.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),i?.supportsM&&t.returnM!=null&&(e.returnM=t.returnM);const{timeOffset:s,timeExtent:n}=t;return e.timeExtent=s!=null&&n!=null?n.offset(-s.value,s.unit):n||null,e}function rH(t){const{globalIdField:e,fields:r}=t;if(e)return e;if(r){for(const i of r)if(i.type==="esriFieldTypeGlobalID")return i.name}}function iH(t){const{objectIdField:e,fields:r}=t;if(e)return e;if(r){for(const i of r)if(i.type==="esriFieldTypeOID")return i.name}}function _2e(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}function b2e(t,e,r,i){const s=r?.feature,n=!!t.subtypes?.length;if(n&&!r?.excludeImpliedDomains){const l=x2e(t,e);if(l)return l}const o=n&&S2e(t,s);if(o){const l=o?.domains?.[e];return l?.type==="inherited"?i:l}const a=oH(t.types,t.typeIdField,s);if(a){const l=a.domains&&a.domains[e];if(l&&l?.type!=="inherited")return l}if(i)return i;if(!r?.excludeImpliedDomains){const l=$2e(t,e);if(l)return l}return null}function S2e(t,e){const{subtypes:r,subtypeField:i}=t;if(!e?.attributes||!r?.length||!i)return null;const s=e.attributes[i];return s==null?null:r.find(n=>n.code===s)}function x2e(t,e){const{fieldsIndex:r,subtypeField:i}=t,{name:s,type:n}=r.get(e)??{};if(!s)return null;if((i&&r.get(i)?.name)===s&&t.subtypes?.length){const o=t.subtypes.map(a=>new Rh({code:sH(a.code,n),name:a.name}));if(o?.length)return new Uu({codedValues:o})}return null}function $2e(t,e){const{fieldsIndex:r}=t,{name:i,type:s}=r.get(e)??{};if(!i)return null;if(("typeIdField"in t?r.get(t.typeIdField)?.name:null)===i&&"types"in t&&t.types?.length){const n=t.types.map(o=>new Rh({code:sH(o.id,s),name:o.name}));return new Uu({codedValues:n})}return null}function sH(t,e){return e?DU({type:e})&&typeof t=="number"?`${t}`:ode({type:e})&&typeof t=="string"?Number.parseInt(t,10):t:t}async function _c(t){return(await t.load()).source}async function UVe(t,e){if(!Fe)return;const r=Fe.findCredential(t);if(r)return r.userId;let i;try{const s=await zP(t,e);s&&(i=await Fe.checkSignInStatus(`${s}/sharing`))}catch{}return i?i.userId:null}async function nH(t,e){if(!Fe||Fe.findCredential(t))return;let r;try{const i=await zP(t,e);i&&(r=await Fe.checkSignInStatus(`${i}/sharing`))}catch{}if(r)try{const i=e!=null?e.signal:null;await Fe.getCredential(t,{signal:i})}catch{}}async function M2e(t,e,r){const i=t.parsedUrl?.path;i&&t.authenticationTriggerEvent===e&&await nH(i,r)}async function GVe(t){const e=t.parsedUrl?.path;e&&T2e(t)&&await nH(e)}function T2e(t){return I2e(t)&&("serviceDefinitionExpression"in t&&vS(t.serviceDefinitionExpression)||"definitionExpression"in t&&vS(t.definitionExpression))}function I2e(t){return!(!BV(t)||!t.capabilities?.query.supportsCurrentUser)}function vS(t){return!!t?.toLowerCase().includes("current_user")}function E2e(t){return!Ub(t)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const Y$=Gm({types:R7});function lL(t,e){if(t.defaultSymbol)return t.types?.length?new mt({defaultSymbol:Y$(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map(r=>({id:r.id,symbol:Y$(r.symbol,r,e)}))}):new Vi({symbol:Y$(t.defaultSymbol,t,e)})}function C2e(t){let e=t.sourceJSON?.cacheMaxAge;if(!e)return!1;const r=t.editingInfo?.lastEditDate?.getTime();return r==null||(e*=1e3,Date.now()-r<e)}async function P2e(t,e,r){if(e==null)return null;const i=[],{objectIdField:s}=t;if(e.forEach(c=>{let d=null;if("attributes"in c){const{attributes:p}=c;d={globalId:p[r],objectId:p[s]!=null&&p[s]!==-1?p[s]:null}}else d={globalId:c.globalId,objectId:c.objectId!=null&&c.objectId!==-1?c.objectId:null};d.globalId!=null&&(d.objectId!=null&&d.objectId!==-1||i.push(d.globalId))}),i.length===0)return null;const n=t.createQuery();n.where=i.map(c=>`${r}='${c}'`).join(" OR "),n.returnGeometry=!1,n.outFields=[s,r],n.cacheHint=!1;const o=await See(eSe(t,n));if(!o.ok)return null;const a=new Map,l=o.value.features;for(const c of l){const d=c.attributes[r],p=c.attributes[s];d!=null&&p!=null&&p!==-1&&a.set(ine(d),p)}return a}function oH(t,e,r){if(!e||!r||!t)return null;const i=r.getAttribute(e);return i==null?null:t.find(s=>{const{id:n}=s;return n!=null&&n.toString()===i.toString()})??null}function Ub(t){return t.sourceJSON?.isMultiServicesView||k2e(t)}function k2e(t){return!!t.sourceJSON?.capabilities?.toLowerCase().split(",").map(e=>e.trim()).includes("map")}function L2e(t,e,r){const i=e?.queryAttributeBins;if(!e?.operations?.supportsQueryBins||!i)throw new R(r,"Layer source does not support binning");switch(t.binParameters.type){case"auto-interval":if(!i.supportsAutoInterval)throw new R(r,"Layer source does not support auto-interval binning");if(t.binParameters.normalizationType&&(!i.supportsNormalization||!iD(t.binParameters.normalizationType,i.supportedNormalizationTypes)))throw new R(r,"Layer source does not support normalization binning");break;case"date":if(!i.supportsDate)throw new R(r,"Layer source does not support date binning");if(t.binParameters.snapToData&&!i.supportsSnapToData)throw new R(r,"Layer source does not support snapToData binning");if(t.binParameters.returnFullIntervalBin&&!i.supportsReturnFullIntervalBin)throw new R(r,"Layer source does not support returnFullIntervalBin binning");break;case"fixed-boundaries":if(!i.supportsFixedBoundaries)throw new R(r,"Layer source does not support fixed-boundaries binning");break;case"fixed-interval":if(!i.supportsFixedInterval)throw new R(r,"Layer source does not support fixed-interval binning");if(t.binParameters.normalizationType&&(!i.supportsNormalization||!iD(t.binParameters.normalizationType,i.supportedNormalizationTypes)))throw new R(r,"Layer source does not support normalization binning")}if(t.binParameters.stackBy&&!i.supportsStackBy)throw new R(r,"Layer source does not support stackBy binning");if(t.binParameters.splitBy&&!i.supportsSplitBy)throw new R(r,"Layer source does not support splitBy binning");if(t.binParameters.firstDayOfWeek&&!i.supportsFirstDayOfWeek)throw new R(r,"Layer source does not support firstDayOfWeek binning");const s=i?.supportedStatistics;if(t.outStatistics&&s){const n=new Map([["count","count"],["sum","sum"],["min","min"],["max","max"],["avg","avg"],["stddev","stddev"],["var","var"],["percentile-continuous","percentileContinuous"],["percentile-discrete","percentileDiscrete"],["centroid-aggregate","centroid"],["convex-hull-aggregate","convexHull"],["envelope-aggregate","envelope"]]);for(const{statisticType:o}of t.outStatistics){const a=n.get(o);if(a&&!s[a])throw new R(r,`Layer source does not support ${o} statistic type`)}}}function iD(t,e){return t!=null&&!!e?.[tH.toJSON(t)]}let jp=class extends Ie(W){constructor(e){super(e),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};u([h({type:String,json:{read:{source:"shapeAreaFieldName"}}})],jp.prototype,"shapeAreaField",void 0),u([h({type:String,json:{read:{source:"shapeLengthFieldName"}}})],jp.prototype,"shapeLengthField",void 0),u([h({type:String,json:{read:t=>fte.read(t)||mte.read(t)}})],jp.prototype,"units",void 0),jp=u([E("esri.layers.support.GeometryFieldsInfo")],jp);var jE;let Vp=jE=class extends W{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new se}clone(){return new jE({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};u([h({type:String,json:{write:{isRequired:!0}}})],Vp.prototype,"floorField",void 0),u([h({json:{read:!1,write:!1}})],Vp.prototype,"viewAllMode",void 0),u([h({json:{read:!1,write:!1}})],Vp.prototype,"viewAllLevelIds",void 0),Vp=jE=u([E("esri.layers.support.LayerFloorInfo")],Vp);function A2e(t){const{nonStandardUrlAllowed:e=!1,separator:r}=t??{},i=O(H1e),s=i.json?.write;return typeof s=="object"&&s&&(s.writer=function(n,o,a,l){JX(this,n,r,o,l)}),{...i,set:function(n){if(n==null)return void this._set("url",n);const o=ZX({layer:this,url:n,nonStandardUrlAllowed:e,logger:U.getLogger(this)});this._set("url",o.url),o.layerId!=null&&this._set("layerId",o.layerId)}}}function R2e(t,e){const{separator:r}=e??{},i=Er(t.url);return i!=null&&(t.dynamicDataSource!=null?i.path=ed(i.path,"dynamicLayer"):t.layerId!=null&&(i.path=ed(i.path,r??"",t.layerId.toString()))),i}const sD=new Ne({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),nD=new Ne({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let $s=class extends Ie(W){constructor(e){super(e),this.cardinality=null,this.catalogId=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};u([h({json:{read:sD.read,write:sD.write}})],$s.prototype,"cardinality",void 0),u([h({json:{name:"catalogID"}})],$s.prototype,"catalogId",void 0),u([h({json:{read:!0,write:!0}})],$s.prototype,"composite",void 0),u([h({json:{read:!0,write:!0}})],$s.prototype,"id",void 0),u([h({json:{read:!0,write:!0}})],$s.prototype,"keyField",void 0),u([h({json:{read:!0,write:!0}})],$s.prototype,"keyFieldInRelationshipTable",void 0),u([h({json:{read:!0,write:!0}})],$s.prototype,"name",void 0),u([h({json:{read:!0,write:!0}})],$s.prototype,"relatedTableId",void 0),u([h({json:{read:!0,write:!0}})],$s.prototype,"relationshipTableId",void 0),u([h({json:{read:nD.read,write:nD.write}})],$s.prototype,"role",void 0),$s=u([E("esri.layers.support.Relationship")],$s);const O2e=[["binary","application/octet-stream","bin",""]];function HVe(t,e){return cH(e.name,t?.supportedFormats??[])!=null}function WVe(t,e){if(!t)return!1;const r=F2e(e,t.supportedFormats??[]);return r!=null&&t.editFormats.includes(r)}function aH(t,e){return cL(j2e(t,e))}function lH(t,e){return cL(cH(t,e))}function ZVe(t,e){return hH(z2e(t,e))}function F2e(t,e){return lH(t.name,e)??aH(t.type,e)}function sx(t,e,r){return aH(t,r)??lH(e,r)}function uH({supportedFormats:t}){return sx("model/gltf-binary","glb",t)}function JVe(t){const e=uH(t);return e!=null&&t.editFormats.includes(e)}function N2e({supportedFormats:t}){return sx("model/gltf+json","gltf",t)}function D2e(t){if(!t)return null;const e=uH(t),r=N2e(t);let i=null;for(const s of t.queryFormats){if(s===e)return s;s===r&&(i=s)}return i}function YVe({supportedFormats:t}){return sx("application/esri3do-SR_world","wld",t)}function XVe({supportedFormats:t}){return sx("application/esri3do-SR_prj","prj",t)}function uL(t){return[...O2e,...t]}function z2e(t,e){return uL(e).find(r=>cL(r)===t)}function j2e(t,e){const r=t.toLowerCase();return uL(e).find(i=>hH(i)===r)}function cH(t,e){const r=t.toLowerCase();return uL(e).find(i=>V2e(i).some(s=>r.endsWith(s)))}function cL(t){return t?.[0]}function hH(t){return t?.[1].toLowerCase()}function V2e(t){return t?.[2].split(",").map(e=>e.toLowerCase())??[]}function KVe(t){return t.tables?.find(e=>e.role==="assetMaps")}function oe(t,e,r){return!!dH(t,e,r)}function Up(t,e,r){return dH(t,e,r)}function dH(t,e,r){return t&&t.hasOwnProperty(e)?t[e]:r}const U2e={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function G2e(t){const e=t?.supportedSpatialAggregationStatistics?.map(r=>r.toLowerCase());return{envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function Qv(t,e){return!!t?.supportedOperationsWithCacheHint?.map(i=>i.toLowerCase())?.includes(e.toLowerCase())}function q2e(t){const e=t?.supportedStatisticTypes?.map(r=>r.toLowerCase());return{count:!!e?.includes("count"),sum:!!e?.includes("sum"),min:!!e?.includes("min"),max:!!e?.includes("max"),avg:!!e?.includes("avg"),var:!!e?.includes("var"),stddev:!!e?.includes("stddev"),percentileContinuous:!!e?.includes("percentile_cont"),percentileDiscrete:!!e?.includes("percentile_disc"),envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function B2e(t){const e=t?.supportedNormalizationTypes?.map(r=>r.toLowerCase());return{field:!!e?.includes("field"),log:!!e?.includes("log"),naturalLog:!!e?.includes("naturallog"),percentOfTotal:!!e?.includes("percentoftotal"),squareRoot:!!e?.includes("squareroot")}}function pH(t,e){return{analytics:H2e(t),attachment:W2e(t),data:Z2e(t),metadata:J2e(t),operations:Y2e(t.capabilities,t,e),query:X2e(t,e),queryAttributeBins:exe(t),queryRelated:K2e(t),queryTopFeatures:Q2e(t),editing:txe(t)}}function H2e(t){return{supportsCacheHint:Qv(t.advancedQueryCapabilities,"queryAnalytics")}}function W2e(t){const e=t.attachmentProperties,r={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:Qv(t.advancedQueryCapabilities,"queryAttachments"),supportsOrderByFields:oe(t.advancedQueryCapabilities,"supportsQueryAttachmentOrderByFields",!1),supportsResize:oe(t,"supportsAttachmentsResizing",!1),supportsTypeWildcard:oe(t.advancedQueryCapabilities,"supportsQueryAttachmentWithTypeWildcard",!1)};return e&&Array.isArray(e)&&e.forEach(i=>{const s=U2e[i.name];s&&(r[s]=!!i.isEnabled)}),r}function Z2e(t){return{isVersioned:oe(t,"isDataVersioned",!1),isBranchVersioned:oe(t,"isDataBranchVersioned",!1),supportsAttachment:oe(t,"hasAttachments",!1),supportsM:oe(t,"hasM",!1),supportsZ:oe(t,"hasZ",!1)}}function J2e(t){return{supportsAdvancedFieldProperties:oe(t,"supportsFieldDescriptionProperty",!1)}}function Y2e(t,e,r){const i=t?.toLowerCase().split(",").map(m=>m.trim())??[],s=r?pc(r):null,n=i.includes(s?.serverType==="MapServer"?"data":"query"),o=i.includes("editing")&&!e.datesInUnknownTimezone&&e.uniqueIdInfo?.OIDFieldContainsHashValue!==!0;let a=o&&i.includes("create"),l=o&&i.includes("delete"),c=o&&i.includes("update");const d=i.includes("changetracking"),p=e.advancedQueryCapabilities;return o&&!(a||l||c)&&(a=l=c=!0),{supportsCalculate:oe(e,"supportsCalculate",!1),supportsTruncate:oe(e,"supportsTruncate",!1),supportsValidateSql:oe(e,"supportsValidateSql",!1),supportsAdd:a,supportsDelete:l,supportsEditing:o,supportsChangeTracking:d,supportsQuery:n,supportsQueryAnalytics:oe(p,"supportsQueryAnalytic",!1),supportsQueryAttachments:oe(p,"supportsQueryAttachments",!1),supportsQueryBins:oe(p,"supportsQueryBins",!1)||!!e.queryBinsCapabilities,supportsQueryPivot:oe(p,"supportsQueryPivot",!1),supportsQueryTopFeatures:oe(p,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:oe(e,"supportsAttachmentsResizing",!1),supportsSync:i.includes("sync"),supportsUpdate:c,supportsExceedsLimitStatistics:oe(e,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:oe(e,"supportsAsyncConvert3D",!1)}}function X2e(t,e){const r=t.advancedQueryCapabilities,i=t.ownershipBasedAccessControlForFeatures,s=t.archivingInfo,n=t.currentVersion,o=e?.includes("MapServer"),a=!o||n>=z("mapserver-pbf-version-support"),l=c1(e),c=new Set((t.supportedQueryFormats??"").split(",").map(d=>d.toLowerCase().trim()));return{maxRecordCount:Up(t,"maxRecordCount",void 0),maxRecordCountFactor:Up(t,"maxRecordCountFactor",void 0),maxUniqueIDCount:Up(t,"maxUniqueIDCount",void 0),standardMaxRecordCount:Up(t,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:G2e(r),supportsCacheHint:oe(r,"supportsQueryWithCacheHint",!1)||Qv(r,"query"),supportsCentroid:oe(r,"supportsReturningGeometryCentroid",!1),supportsCentroidOnDegeneratedQuantizedGeometry:l||e==null,supportsCompactGeometry:l,supportsCurrentUser:oe(r,"supportsCurrentUserQueries",!1),supportsDefaultSpatialReference:oe(r,"supportsDefaultSR",!1),supportsDegeneratedQuantizedGeometry:oe(r,"supportsDegeneratedQuantizedGeometry",!1),supportsDisjointSpatialRelationship:oe(r,"supportsDisjointSpatialRel",!1),supportsDistance:oe(r,"supportsQueryWithDistance",!1),supportsDistinct:oe(r,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:oe(r,"supportsReturningQueryExtent",!1),supportsFormatPBF:a&&c.has("pbf"),supportsFullTextSearch:oe(r,"supportsFullTextSearch",!1),supportsGeometryProperties:oe(r,"supportsReturningGeometryProperties",!1),supportsHavingClause:oe(r,"supportsHavingClause",!1),supportsHistoricMoment:oe(s,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:oe(r,"supportsMaxRecordCountFactor",!1),supportsOrderBy:oe(r,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:oe(r,"supportsPagination",!1),supportsPaginationOnAggregatedQueries:oe(r,"supportsPaginationOnAggregatedQueries",!1),supportsPercentileStatistics:oe(r,"supportsPercentileStatistics",!1),supportsQuantization:oe(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:oe(t,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:oe(i,"allowAnonymousToQuery",!0),supportsQueryByOthers:oe(i,"allowOthersToQuery",!0),supportsQueryGeometry:oe(t,"supportsReturningQueryGeometry",!1),supportsResultType:oe(r,"supportsQueryWithResultType",!1),supportsReturnMesh:!!D2e(t.infoFor3D),supportsSpatialAggregationStatistics:oe(r,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:oe(r,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:oe(t,"useStandardizedQueries",!1),supportsStatistics:oe(r,"supportsStatistics",t.supportsStatistics),supportsTopFeaturesQuery:oe(r,"supportsTopFeaturesQuery",!1),supportsTrueCurve:oe(r,"supportsTrueCurve",!1),tileMaxRecordCount:Up(t,"tileMaxRecordCount",void 0)}}function K2e(t){const e=t.advancedQueryCapabilities,r=oe(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:oe(e,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r,supportsCacheHint:Qv(e,"queryRelated")}}function Q2e(t){return{supportsCacheHint:Qv(t.advancedQueryCapabilities,"queryTopFilter")}}function exe(t){const e=t?t.queryBinsCapabilities:void 0;return{supportsDate:oe(e,"supportsDateBin",!1),supportsFixedInterval:oe(e,"supportsFixedIntervalBin",!1),supportsAutoInterval:oe(e,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:oe(e,"supportsFixedBoundariesBin",!1),supportsStackBy:oe(e,"supportsStackBy",!1),supportsSplitBy:oe(e,"supportsSplitBy",!1),supportsSnapToData:oe(e,"supportsSnapToData",!1),supportsReturnFullIntervalBin:oe(e,"supportsReturnFullIntervalBin",!1),supportsFirstDayOfWeek:oe(e,"supportsFirstDayOfWeek",!1),supportsNormalization:oe(e,"supportsNormalization",!1),supportedStatistics:q2e(e),supportedNormalizationTypes:B2e(e)}}function txe(t){const e=t.ownershipBasedAccessControlForFeatures,r=t?t.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:oe(t,"allowGeometryUpdates",!0),supportsGlobalId:oe(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:oe(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:oe(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:oe(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:oe(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:oe(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:oe(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:oe(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:oe(e,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:oe(r,"supportsAsyncApplyEdits",!1),zDefault:Up(t,"zDefault",void 0)}}function QVe(t){return{operations:{supportsAppend:oe(t,"supportsAppend",!1),supportsCoverageQuery:t?.playbackInfo?.klv["0601"]??!1,supportsExportClip:oe(t,"supportsExportClip",!1),supportsExportFrameset:oe(t,"supportsExportFrameset",!1),supportsMensuration:oe(t,"supportsMensuration",!1),supportsPreviews:oe(t,"supportsPreviews",!1),supportsUpdate:oe(t,"supportsUpdate",!1)}}}let Ja=class extends Ie(W){constructor(e){super(e),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(e){if(!e)return null;const r={};for(const i of Object.keys(e))r[i]=O2(e[i]);return r}writeDomains(e,r){if(!e)return;const i={};for(const s of Object.keys(e))e[s]&&(i[s]=e[s]?.toJSON());r.domains=i}};u([h({type:Number,json:{write:!0}})],Ja.prototype,"code",void 0),u([h({type:Object,json:{write:!0}})],Ja.prototype,"defaultValues",void 0),u([h({json:{write:!0}})],Ja.prototype,"domains",void 0),u([X("domains")],Ja.prototype,"readDomains",null),u([te("domains")],Ja.prototype,"writeDomains",null),u([h({type:String,json:{write:!0}})],Ja.prototype,"name",void 0),Ja=u([E("esri.layers.support.Subtype")],Ja);async function rxe(t){const e=t.spatialReference;if(e.isWGS84)return t.clone();if(e.isWebMercator)return Kp(t);const r=ne.WGS84;return await ik(e,r),yc(t,r)}function ixe(t,e){if(!hL(t,e)){const r=t.typeKeywords;r?r.push(e):t.typeKeywords=[e]}}function hL(t,e){return!!t.typeKeywords?.includes(e)}function t8e(t){return hL(t,fH.HOSTED_SERVICE)}function sxe(t,e){const r=t.typeKeywords;if(r){const i=r.indexOf(e);i>-1&&r.splice(i,1)}}function r8e(t,e,r){r?ixe(t,e):sxe(t,e)}async function i8e(t){const e=t.clone().normalize();let r;if(e.length>1)for(const i of e)r?i.width>r.width&&(r=i):r=i;else r=e[0];return rxe(r)}const fH={CHARTS:"Charts",DYNAMIC:"Dynamic",GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function nxe(t){const{portal:e,isOrgItem:r,itemControl:i}=t,s=e.user?.privileges;let n=!s||s.includes("features:user:edit"),o=!!r&&!!s?.includes("features:user:fullEdit");const a=i==="update"||i==="admin";return a?o=n=!0:o&&(n=!0),{features:{edit:n,fullEdit:o},content:{updateItem:a}}}const oxe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.copyright=null,this.capabilities=null,this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.definitionExpression=null,this.displayField=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.fieldsIndex=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.globalIdField=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.indexes=new(se.ofType(xo)),this.isTable=!1,this.layerId=void 0,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.preferredTimeZone=null,this.relationships=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.sourceJSON=null,this.spatialReference=ne.WGS84,this.subtypeField=null,this.subtypes=null,this.trackIdField=null,this.uniqueIdFields=null,this.url=null,this.version=void 0,this._isUrlHostModified=!1,this._isUrlHostModificationEnabled=!1}getFieldDomain(i,s){throw new Error("Not implemented")}getField(i){return this.fieldsIndex.get(i)}get authenticationTriggerEvent(){if(!this.url)return null;const{capabilities:i}=this;if(i){const{query:n,operations:o,editing:a}=i;if(!n.supportsQueryByOthers||!n.supportsQueryByAnonymous||o.supportsEditing&&!(a.supportsUpdateByOthers&&a.supportsUpdateByAnonymous&&a.supportsDeleteByOthers&&a.supportsDeleteByAnonymous))return"load"}if(vS(this.serviceDefinitionExpression)||vS(this.definitionExpression))return"load";if(this.userHasUpdateItemPrivileges){if(C2e(this))return"load";if(this.hasUpdateItemRestrictions)return i.operations.supportsQuery?"editing":"load"}if(this.userHasFullEditingPrivileges&&this.hasFullEditingRestrictions)return"editing";const s=this.editFieldsInfo;return(s?.creatorField||s?.editorField)&&i?.operations.supportsEditing?"editing":null}readCapabilitiesFromService(i,s){return pH(s,this.url)}readEditingInfo(i,s){const{editingInfo:n}=s;return n?{lastEditDate:n.lastEditDate!=null?new Date(n.lastEditDate):null}:null}get effectiveCapabilities(){const i=this.capabilities;if(!i)return null;const s=O(i),{operations:n,editing:o}=s;return Ub(this)?(this.userHasUpdateItemPrivileges&&(n.supportsQuery=!0),s):this.userHasUpdateItemPrivileges?(n.supportsAdd=n.supportsDelete=n.supportsEditing=n.supportsQuery=n.supportsUpdate=o.supportsDeleteByOthers=o.supportsGeometryUpdate=o.supportsUpdateByOthers=!0,s):(this.userHasFullEditingPrivileges&&n.supportsEditing&&(n.supportsAdd=n.supportsDelete=n.supportsUpdate=o.supportsGeometryUpdate=!0),s)}get effectiveEditingEnabled(){return!1}readGlobalIdFieldFromService(i,s){return rH(s)}get hasFullEditingRestrictions(){const i=this.capabilities;if(!i||Ub(this))return!1;const{operations:s,editing:n}=i;return s.supportsEditing&&!(s.supportsAdd&&s.supportsDelete&&s.supportsUpdate&&n.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){const i=this.capabilities;if(!i)return!1;const{operations:s,editing:n}=i;return Ub(this)?!s.supportsQuery:!(s.supportsAdd&&s.supportsDelete&&s.supportsEditing&&s.supportsQuery&&s.supportsUpdate&&n.supportsDeleteByOthers&&n.supportsGeometryUpdate&&n.supportsUpdateByOthers)}readIsTableFromService(i,s){return s.type==="Table"}readMaxScale(i,s){return s.effectiveMaxScale||i||0}readMinScale(i,s){return s.effectiveMinScale||i||0}readObjectIdFieldFromService(i,s){return iH(s)}get parsedUrl(){return R2e(this)}readServiceDefinitionExpression(i,s){return s.definitionQuery||s.definitionExpression}readUniqueIdFields(i,s){return s.uniqueIdInfo?.OIDFieldContainsHashValue?s.uniqueIdInfo.fields:null}readVersion(i,s){return _2e(s)}get isUrlHostModified(){const{loaded:i,url:s,_isUrlHostModified:n}=this;if(n)return!0;if(!i||!s||this.originIdOf("url")<7)return!1;const o=this.sourceJSON?.preferredHost;if(!o||!aa(s,`https://${o}`,!0))return!1;for(let a=6;a>=3;a--){const l=this.getAtOrigin("url",R0(a));if(l)return!aa(s,l,!0)}return!1}applyPreferredHost(i){const{url:s,portalItem:n}=this;!s||vT(n)}applyHostFromPortalItem(){const{url:i,portalItem:s}=this;if(!i||this.originIdOf("url")===7||!s?.url||!vT(s)||!hL(s,fH.HOSTED_SERVICE)||aa(i,s.url,!0)||!this._isUrlHostModificationEnabled)return;const n=TX(s.url);this._set("url",Pz(i,n)),this._isUrlHostModified=!0}};return u([h({readOnly:!0})],r.prototype,"authenticationTriggerEvent",null),u([h({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],r.prototype,"copyright",void 0),u([h({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","isDataBranchVersioned","isDataVersioned","maxRecordCount","maxRecordCountFactor","maxUniqueIDCount","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],r.prototype,"capabilities",void 0),u([X("service","capabilities")],r.prototype,"readCapabilitiesFromService",null),u([h(z1("dateFieldsTimeReference"))],r.prototype,"dateFieldsTimeZone",void 0),u([h({type:Boolean})],r.prototype,"datesInUnknownTimezone",void 0),u([h({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],r.prototype,"definitionExpression",void 0),u([h({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],r.prototype,"displayField",void 0),u([h({readOnly:!0,type:Za})],r.prototype,"editFieldsInfo",void 0),u([h({readOnly:!0})],r.prototype,"editingInfo",void 0),u([X("editingInfo")],r.prototype,"readEditingInfo",null),u([h({readOnly:!0})],r.prototype,"effectiveCapabilities",null),u([h()],r.prototype,"effectiveEditingEnabled",null),u([h((()=>{const i=O(Z1e),s=i.json.origins;return s["web-map"]={read:!1,write:!1},s["portal-item"]={read:!1,write:!1},i})())],r.prototype,"elevationInfo",void 0),u([h()],r.prototype,"fieldsIndex",void 0),u([h({type:Vp,json:{name:"layerDefinition.floorInfo",write:{layerContainerTypes:pt}}})],r.prototype,"floorInfo",void 0),u([h({type:Te,json:{origins:{service:{read:{source:"extent"}}}}})],r.prototype,"fullExtent",void 0),u([h()],r.prototype,"gdbVersion",void 0),u([h({readOnly:!0,type:jp,json:{read:{source:"geometryProperties"}}})],r.prototype,"geometryFieldsInfo",void 0),u([h({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:zE.read}}}})],r.prototype,"geometryType",void 0),u([h({type:String})],r.prototype,"globalIdField",void 0),u([X("service","globalIdField",["globalIdField","fields"])],r.prototype,"readGlobalIdFieldFromService",null),u([h({readOnly:!0})],r.prototype,"hasFullEditingRestrictions",null),u([h({type:Boolean,json:{origins:{service:{read:!0}}}})],r.prototype,"hasM",void 0),u([h({readOnly:!0})],r.prototype,"hasUpdateItemRestrictions",null),u([h({type:Boolean,json:{origins:{service:{read:!0}}}})],r.prototype,"hasZ",void 0),u([h({readOnly:!0,type:Ri})],r.prototype,"heightModelInfo",void 0),u([h({type:Date})],r.prototype,"historicMoment",void 0),u([h({type:se.ofType(xo),readOnly:!0})],r.prototype,"indexes",void 0),u([h({readOnly:!0})],r.prototype,"isTable",void 0),u([X("service","isTable",["type"])],r.prototype,"readIsTableFromService",null),u([h({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],r.prototype,"layerId",void 0),u([h(K1e)],r.prototype,"maxScale",void 0),u([X("service","maxScale",["maxScale","effectiveMaxScale"])],r.prototype,"readMaxScale",null),u([h(X1e)],r.prototype,"minScale",void 0),u([X("service","minScale",["minScale","effectiveMinScale"])],r.prototype,"readMinScale",null),u([h({type:String})],r.prototype,"objectIdField",void 0),u([X("service","objectIdField",["objectIdField","fields"])],r.prototype,"readObjectIdFieldFromService",null),u([h({readOnly:!0})],r.prototype,"parsedUrl",null),u([h(z1("preferredTimeReference"))],r.prototype,"preferredTimeZone",void 0),u([h({type:[$s],readOnly:!0})],r.prototype,"relationships",void 0),u([h({type:Boolean})],r.prototype,"returnM",void 0),u([h({type:Boolean})],r.prototype,"returnZ",void 0),u([h({readOnly:!0,json:{write:!1}})],r.prototype,"serverGens",void 0),u([h({readOnly:!0})],r.prototype,"serviceDefinitionExpression",void 0),u([X("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],r.prototype,"readServiceDefinitionExpression",null),u([h({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],r.prototype,"serviceItemId",void 0),u([h()],r.prototype,"sourceJSON",void 0),u([h({type:ne,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],r.prototype,"spatialReference",void 0),u([h({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],r.prototype,"subtypeField",void 0),u([h({type:[Ja],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],r.prototype,"subtypes",void 0),u([h({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],r.prototype,"trackIdField",void 0),u([h({type:[String],readOnly:!0})],r.prototype,"uniqueIdFields",void 0),u([X("service","uniqueIdFields",["uniqueIdInfo.OIDFieldContainsHashValue","uniqueIdInfo.fields"])],r.prototype,"readUniqueIdFields",null),u([h(A2e({nonStandardUrlAllowed:!0}))],r.prototype,"url",void 0),u([h({json:{origins:{service:{read:!0}},read:!1}})],r.prototype,"version",void 0),u([X("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],r.prototype,"readVersion",null),u([h({readOnly:!0})],r.prototype,"isUrlHostModified",null),r=u([E("esri.layers.mixins.FeatureLayerBase")],r),r};let axe=class extends nv{constructor(e){super(),this.type="aggregate",this.featureReductionProvider=e}get id(){return this.featureReductionProvider.id}get[Uv](){const e=this.featureReductionProvider.featureReduction;return e&&"popupTemplate"in e?e:null}},Au=class extends Ie(W){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};u([h({type:String,json:{write:!0}})],Au.prototype,"expression",void 0),u([h({type:String,json:{write:!0}})],Au.prototype,"title",void 0),u([h({type:String,json:{write:!0}})],Au.prototype,"returnType",void 0),Au=u([E("esri.layers.support.ExpressionInfo")],Au);var VE,sm;let mi=(sm=class extends W{constructor(e){super(e),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new VE({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:O(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}},VE=sm,sm);u([h({type:Boolean,json:{write:!0}})],mi.prototype,"isAutoGenerated",void 0),u([h({type:String,json:{write:!0}})],mi.prototype,"name",void 0),u([h({type:String,json:{write:!0}})],mi.prototype,"alias",void 0),u([h({type:String,json:{write:!0}})],mi.prototype,"onStatisticField",void 0),u([h({type:Au,json:{write:!0}})],mi.prototype,"onStatisticExpression",void 0),u([h({type:String,json:{write:!0}})],mi.prototype,"statisticType",void 0),mi=VE=u([E("esri.layers.support.AggregateField")],mi);let Yu=class extends W{constructor(){super(...arguments),this.type=null}};u([h({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],Yu.prototype,"type",void 0),Yu=u([E("esri.layers.support.FeatureReduction")],Yu);const dL="__begin__",pL="__end__",lxe=new RegExp(dL,"ig"),uxe=new RegExp(pL,"ig"),oD=new RegExp("^"+dL,"i"),aD=new RegExp(pL+"$","i"),wS='"',cxe=wS+" + ",hxe=" + "+wS;function dxe(t){return t.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function pxe(t){return t.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function fL(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):t.labelExpression!=null&&(e.expression=dxe(t.labelExpression),e.type="conventional"),e}function fxe(t){const e=fL(t);if(!e)return null;switch(e.type){case"conventional":return UE(e.expression);case"arcade":return e.expression}return null}function mxe(t){const e=fL(t);if(!e)return null;switch(e.type){case"conventional":return gxe(e.expression);case"arcade":return mH(e.expression)}return null}function UE(t){let e;return t?(e=dc(t,r=>dL+'$feature["'+r+'"]'+pL),e=oD.test(e)?e.replace(oD,""):wS+e,e=aD.test(e)?e.replace(aD,""):e+wS,e=e.replaceAll(lxe,cxe).replaceAll(uxe,hxe)):e='""',e}const yxe=/^\s*\{([^}]+)\}\s*$/i;function gxe(t){return t?.match(yxe)?.[1].trim()||null}const vxe=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,wxe=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,_xe=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function mH(t){if(!t)return null;let e=vxe.exec(t)||wxe.exec(t);return e?e[1]||e[3]:(e=_xe.exec(t),e?e[2]:null)}var GE,nm;let nl=(nm=class extends W{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(e,r){return r.value?UE(r.value):e}writeExpression(e,r,i){this.value!=null&&(e=UE(this.value)),e!=null&&(r[i]=e)}clone(){return new GE({expression:this.expression,title:this.title,value:this.value})}},GE=nm,nm);u([h({type:String,json:{write:{writerEnsuresNonNull:!0}}})],nl.prototype,"expression",void 0),u([X("expression",["expression","value"])],nl.prototype,"readExpression",null),u([te("expression")],nl.prototype,"writeExpression",null),u([h({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],nl.prototype,"title",void 0),u([h({json:{read:!1,write:!1}})],nl.prototype,"value",void 0),nl=GE=u([E("esri.layers.support.LabelExpressionInfo")],nl);var qE;const t_=new Ne({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function r_(t,e,r){return{enabled:!gT(r?.layer)}}function yH(t){return!t||t.origin!=="service"&&t.layer?.type!=="map-image"}function bxe(t){return t?.type==="map-image"}function gH(t){return!!bxe(t)&&!!t.capabilities?.exportMap?.supportsArcadeExpressionForLabeling}function Sxe(t){return yH(t)||gH(t?.layer)}var om;let bt=(om=class extends W{static evaluateWhere(e,r){const i=(s,n,o)=>{switch(n){case"=":return s==o;case"<>":return s!=o;case">":return s>o;case">=":return s>=o;case"<":return s<o;case"<=":return s<=o}return!1};try{if(e==null)return!0;const s=e.split(" ");if(s.length===3)return i(r[s[0]],s[1],s[2]);if(s.length===7){const n=i(r[s[0]],s[1],s[2]),o=s[3],a=i(r[s[4]],s[5],s[6]);switch(o){case"AND":return n&&a;case"OR":return n||a}}return!1}catch{}}constructor(e){super(e),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=jSe,this.useCodedValues=void 0,this.where=null}readLabelExpression(e,r){const i=r.labelExpressionInfo;if(!i||!i.value&&!i.expression)return e}writeLabelExpression(e,r,i){if(this.labelExpressionInfo){if(this.labelExpressionInfo.value!=null)e=pxe(this.labelExpressionInfo.value);else if(this.labelExpressionInfo.expression!=null){const s=mH(this.labelExpressionInfo.expression);s&&(e="["+s+"]")}}e!=null&&(r[i]=e)}writeLabelExpressionInfo(e,r,i,s){if(e==null&&this.labelExpression!=null&&yH(s))e=new nl({expression:this.getLabelExpressionArcade()});else if(!e)return;const n=e.toJSON(s);n.expression&&(r[i]=n)}writeMaxScale(e,r){(e||this.minScale)&&(r.maxScale=e)}writeMinScale(e,r){(e||this.maxScale)&&(r.minScale=e)}getLabelExpression(){return fL(this)}getLabelExpressionArcade(){return fxe(this)}getLabelExpressionSingleField(){return mxe(this)}hash(){return JSON.stringify(this)}clone(){return new qE({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:O(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:O(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}},qE=om,om);u([h({type:String,json:{write:!0}})],bt.prototype,"name",void 0),u([h({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:r_}}}}})],bt.prototype,"allowOverrun",void 0),u([h({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:r_}}}}})],bt.prototype,"deconflictionStrategy",void 0),u([h({type:String,json:{write:{overridePolicy(t,e,r){return this.labelExpressionInfo&&r?.origin==="service"&&gH(r.layer)?{enabled:!1}:{allowNull:!0}}}}})],bt.prototype,"labelExpression",void 0),u([X("labelExpression")],bt.prototype,"readLabelExpression",null),u([te("labelExpression")],bt.prototype,"writeLabelExpression",null),u([h({type:nl,json:{write:{overridePolicy:(t,e,r)=>Sxe(r)?{allowNull:!0}:{enabled:!1}}}})],bt.prototype,"labelExpressionInfo",void 0),u([te("labelExpressionInfo")],bt.prototype,"writeLabelExpressionInfo",null),u([h({type:t_.apiValues,json:{type:t_.jsonValues,read:t_.read,write:t_.write}})],bt.prototype,"labelPlacement",void 0),u([h({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],bt.prototype,"labelPosition",void 0),u([h({type:Number})],bt.prototype,"maxScale",void 0),u([te("maxScale")],bt.prototype,"writeMaxScale",null),u([h({type:Number})],bt.prototype,"minScale",void 0),u([te("minScale")],bt.prototype,"writeMinScale",null),u([h({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:r_}}}}})],bt.prototype,"repeatLabel",void 0),u([h({type:Number,cast:ze,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:r_}}}}})],bt.prototype,"repeatLabelDistance",void 0),u([h({types:kpe,json:{origins:{"web-scene":{types:Lpe,write:WN,default:null}},write:WN,default:null}})],bt.prototype,"symbol",void 0),u([h({type:Boolean,json:{write:!0}})],bt.prototype,"useCodedValues",void 0),u([h({type:String,json:{write:!0}})],bt.prototype,"where",void 0),bt=qE=u([E("esri.layers.support.LabelClass")],bt);var BE;let Bn=BE=class extends W{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new BE({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?.clone()??null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};u([h({type:String,json:{write:!0}})],Bn.prototype,"description",void 0),u([h({type:String,json:{write:!0}})],Bn.prototype,"label",void 0),u([h({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],Bn.prototype,"minValue",void 0),u([h({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],Bn.prototype,"maxValue",void 0),u([h(iL)],Bn.prototype,"symbol",void 0),Bn=BE=u([E("esri.renderers.support.ClassBreakInfo")],Bn);var HE;const vH="log",Gb="percent-of-total",qb="field",i_=new Ne({esriNormalizeByLog:vH,esriNormalizeByPercentOfTotal:Gb,esriNormalizeByField:qb}),xxe=jt(Bn);let sr=HE=class extends sy(Os){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,r){if(!Array.isArray(t))return;let i=e.minValue;return t.map(s=>{const n=new Bn;return n.read(s,r),n.minValue==null&&(n.minValue=i),n.maxValue==null&&(n.maxValue=n.minValue),i=n.maxValue,n})}writeClassBreakInfos(t,e,r,i){const s=t.map(n=>n.write({},i));this._areClassBreaksConsecutive()&&s.forEach(n=>delete n.classMinValue),e[r]=s}castField(t){return t==null?t:typeof t=="function"?(U.getLogger(this).error(".field: field must be a string value"),null):Iv(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,r=this.normalizationTotal!=null;return e||r?(t=e&&qb||r&&Gb||null,e&&r&&U.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==qb&&t!==Gb||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,r){let i=null;i=typeof t=="number"?new Bn({minValue:t,maxValue:e,symbol:O7(r)}):xxe(O(t)),this.classBreakInfos.push(i),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const r=this.classBreakInfos.length;for(let i=0;i<r;i++){const s=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(s[0]===t&&s[1]===e){this.classBreakInfos.splice(i,1);break}}}getBreakIndex(t,e){return this.valueExpression&&e?.arcade==null&&U.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let r=e;this.valueExpression&&e?.arcade==null&&(r={...r,arcade:await kl()});const i=this.getBreakIndex(t,r);return i!==-1?this.classBreakInfos[i]:null}getSymbol(t,e){if(this.valueExpression&&e?.arcade==null)return void U.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const r=this.getBreakIndex(t,e);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let r=e;if(this.valueExpression&&e?.arcade==null){const s=await kl(),{arcadeUtils:n}=s;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),r={...r,arcade:s}}const i=this.getBreakIndex(t,r);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}get symbols(){const t=[];return this.classBreakInfos.forEach(e=>{e.symbol&&t.push(e.symbol)}),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),r=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce((i,s)=>i+s.getMeshHash(),"")}.${r}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new HE({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:O(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:O(this.visualVariables),legendOptions:O(this.legendOptions),authoringInfo:O(this.authoringInfo)})}async collectRequiredFields(t,e){const r=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(r)}async collectSymbolFields(t,e){const r=[...this.symbols.map(i=>i.collectRequiredFields(t,e)),ei(t,e,null,this.valueExpression)];Mi(t,e,this.field),Mi(t,e,this.normalizationField),await Promise.all(r)}_getBreakIndexForExpression(t,e){const{viewingMode:r,scale:i,spatialReference:s,arcade:n,timeZone:o}=e??{},{valueExpression:a}=this;let l=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const c=n.arcadeUtils;if(!l){const p=c.createSyntaxTree(a);l=c.createFunction(p),this._compiledValueExpression.compiledFunction=l}this._compiledValueExpression.valueExpression=a;const d=c.executeFunction(l,c.createExecContext(t,c.getViewInfo({viewingMode:r,scale:i,spatialReference:s}),o));return this._getBreakIndexfromInfos(d)}_getBreakIndexForField(t){const e=this.field,r=t.attributes,i=this.normalizationType;let s=parseFloat(r[e]);if(i){const n=this.normalizationTotal,o=parseFloat(this.normalizationField?r[this.normalizationField]:void 0);if(i===vH)s=Math.log(s)*Math.LOG10E;else if(i!==Gb||n==null||isNaN(n)){if(i===qb&&!isNaN(o)){if(isNaN(s)||isNaN(o))return-1;s/=o}}else s=s/n*100}return this._getBreakIndexfromInfos(s)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(t!=null&&typeof t=="number"&&!isNaN(t))for(let r=0;r<this.classBreakInfos.length;r++){const i=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(i[0]<=t&&(e?t<=i[1]:t<i[1]))return r}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let r=1;r<e;r++)if(t[r-1].maxValue!==t[r].minValue)return!1;return!0}};u([h(sL)],sr.prototype,"backgroundFillSymbol",void 0),u([h({type:[Bn],json:{write:{isRequired:!0}}})],sr.prototype,"classBreakInfos",void 0),u([X("classBreakInfos")],sr.prototype,"readClassBreakInfos",null),u([te("classBreakInfos")],sr.prototype,"writeClassBreakInfos",null),u([h({type:String,json:{write:!0}})],sr.prototype,"defaultLabel",void 0),u([h(ix)],sr.prototype,"defaultSymbol",void 0),u([h({type:String,json:{write:!0}})],sr.prototype,"field",void 0),u([He("field")],sr.prototype,"castField",null),u([h({type:Boolean})],sr.prototype,"isMaxInclusive",void 0),u([h({type:nL,json:{write:!0}})],sr.prototype,"legendOptions",void 0),u([h({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],sr.prototype,"minValue",null),u([h({type:String,json:{write:!0}})],sr.prototype,"normalizationField",void 0),u([h({type:Number,json:{write:!0}})],sr.prototype,"normalizationTotal",void 0),u([h({type:i_.apiValues,value:null,json:{type:i_.jsonValues,read:i_.read,write:i_.write}})],sr.prototype,"normalizationType",null),u([ye({classBreaks:"class-breaks"})],sr.prototype,"type",void 0),u([h({type:String,json:{write:!0}})],sr.prototype,"valueExpression",void 0),u([h({type:String,json:{write:!0}})],sr.prototype,"valueExpressionTitle",void 0),sr=HE=u([E("esri.renderers.ClassBreaksRenderer")],sr);const WE=-3,$xe=WE-1,Mxe=!!z("esri-tests-disable-gpu-memory-measurements");let Txe=class{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._users=new Map,this._sizeLimits=new Map}destroy(){this.clearAll(),this._sizeLimits.clear(),this._users.clear(),this._db=null}register(e){this._users.set(e.id.slice(0,-1),e)}deregister(e){this.clear(e),this._sizeLimits.delete(e),this._users.delete(e.id.slice(0,-1))}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,r){return this._db.get(e.id+r)?.size??0}put(e,r,i,s,n){r=e.id+r;const o=this._db.get(r);if(o&&(this._size-=o.size,e.size-=o.size,this._db.delete(r),o.entry!==i&&this._notifyRemove(r,o.entry,o.size,0)),s>this._maxSize)return void this._notifyRemove(r,i,s,0);if(i===void 0)return void console.warn("Refusing to cache undefined entry ");if(!s||s<0)return Mxe||console.warn(`Refusing to cache entry with size ${s} for key ${r}`),void this._notifyRemove(r,i,0,0);const a=1+Math.max(n,$xe)-WE;this._db.set(r,new Ixe(i,s,a)),this._size+=s,e.size+=s,this._checkSize()}updateSize(e,r){r=e.id+r;const i=this._db.get(r);if(!i)return;this._size-=i.size,e.size-=i.size;let s=i.entry.usedMemory;for(;s>this._maxSize;){const n=this._notifyRemove(r,i.entry,s,1);if(!(n!=null&&n>0))return void this._db.delete(r);s=n}i.size=s,this._size+=s,e.size+=s,this._checkSize()}pop(e,r){r=e.id+r;const i=this._db.get(r);if(i)return this._size-=i.size,e.size-=i.size,this._db.delete(r),++this._hit,i.entry;++this._miss}get(e,r){r=e.id+r;const i=this._db.get(r);if(i!==void 0)return this._db.delete(r),i.lives=i.lifetime,this._db.set(r,i),++this._hit,i.entry;++this._miss}peek(e,r){const i=this._db.get(e.id+r);return i?++this._hit:++this._miss,i?.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},r={},i=new Array;this._db.forEach((o,a)=>{const l=o.lifetime;i[l]=(i[l]||0)+o.size,this._users.forEach(c=>{const{id:d,name:p}=c;if(a.startsWith(d)){const m=r[p]||0;r[p]=m+o.size}})});const s={};this._users.forEach(o=>{const a=o.name;if("hitRate"in o&&typeof o.hitRate=="number"&&!isNaN(o.hitRate)&&o.hitRate>0){const l=r[a]||0;r[a]=l,s[a]=Math.round(100*o.hitRate)+"%"}else s[a]="0%"});const n=Object.keys(r);n.sort((o,a)=>r[a]-r[o]),n.forEach(o=>e[o]=Math.round(r[o]/2**20)+"MB / "+s[o]);for(let o=i.length-1;o>=0;--o){const a=i[o];a&&(e["Priority "+(o+WE-1)]=Math.round(a/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forEach(e=>e.resetHitRate())}clear(e){const r=e.id;this._db.forEach((i,s)=>{s.startsWith(r)&&(this._size-=i.size,this._db.delete(s),this._notifyRemove(s,i.entry,i.size,0))}),e.size=0}clearAll(){this._db.forEach((e,r)=>this._notifyRemove(r,e.entry,e.size,0)),this._users.forEach(e=>e.size=0),this._size=0,this._db.clear()}*values(e){for(const[r,i]of this._db)r.startsWith(e.id)&&(yield i.entry)}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,r,i,s){const n=this._users.get(e.split(X$)[0])?.removeFunc,o=n?.(r,s,i);return typeof o=="number"?o:null}_checkSize(){this._sizeLimits.forEach((e,r)=>this._checkSizeLimits(e,r)),this._checkSizeLimits(this.maxSize)}setMaxSize(e,r){r==null||r<=0?this._sizeLimits.delete(e):this._sizeLimits.set(e,r)}_checkSizeLimits(e,r){const i=r??this;if(i.size<=e)return;const s=r?.id;let n=!0;for(;n;){n=!1;for(const[o,a]of this._db)if(a.lifetime===0&&(!s||o.startsWith(s))){const l=r??this._users.get(o.split(X$)[0]);if(this._purgeItem(o,a,l),i.size<=.9*e)return;n||=this._db.has(o)}}for(const[o,a]of this._db)if(!s||o.startsWith(s)){const l=r??this._users.get(o.split(X$)[0]);if(this._purgeItem(o,a,l),i.size<=.9*e)return}}_purgeItem(e,r,i){if(this._db.delete(e),r.lives<=1){this._size-=r.size,i&&(i.size-=r.size);const s=this._notifyRemove(e,r.entry,r.size,1);s!=null&&s>0&&(this._size+=s,i&&(i.size+=s),r.lives=r.lifetime,r.size=s,this._db.set(e,r))}else--r.lives,this._db.set(e,r)}},Ixe=class{constructor(e,r,i){this.entry=e,this.size=r,this.lifetime=i,this.lives=i}};const X$=":";let wH=class{constructor(e,r){this.removeFunc=r,this._storage=new Txe,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this)}destroy(){this._storage.deregister(this),this._storage.destroy(),this._storage=null}put(e,r,i=1){this._storage.put(this,e,r,i,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}},lD=class _H{static parse(e,r,i){const s=[],n=[],o=e.split(";");for(let a=0;a<o.length;a++){const l=o[a];if(l){if(l.includes("po:")){const c=l.slice(3).split("|");if(c.length===3){const[d,p,m]=c,y=Cxe(d,p,m);y&&n.push(y)}continue}if(l.includes("|")){for(const c of l.split("|"))if(r.has(c)){s.push(c);break}}else if(r.has(l))s.push(l);else if(a===0){s.length=0,s.push(Pxe(i));break}}}return new _H(s,n)}constructor(e,r){this.partNames=e,this.overrides=r}};function Exe(t,e){if(t==="DashTemplate")return e.split(" ").map(r=>Number(r));if(t==="Color"){const r=new K(e).toRgba();return[r[0],r[1],r[2],255*r[3]]}return Number(e)}function Cxe(t,e,r){return{primitiveName:t,propertyName:e,value:Exe(e,r),defaultValue:null}}function Pxe(t){switch(t){case"esriGeometryPolyline":return"Invalid_L";case"esriGeometryPolygon":return"Invalid_A";default:return"Invalid_P"}}var am;let ko=(am=class{},am.instance=new fs("Etc/UTC"),am);function kxe(t){return t instanceof wd?t===ko.instance:t?.toString().toLowerCase()==="unknown"}function c8e(t){return kxe(t)?ko.instance:t}function Lxe(t){return"timeZone"in t}function Axe(t){return"timeZone"in t}function Rxe(t){return"dateFieldsTimeZone"in t}const Oxe=new Map;let uv=class Bb{static fromJSON(e){return new Bb(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new Bb(e.fields??[],cD(e))}static fromLayerJSON(e){return new Bb(e.fields??[],cD(e))}constructor(e=[],r){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=r?new Map(r):null;const i=[];for(const s of this.fields){const n=s?.name,o=uD(n);if(n&&o){const a=$h(n);this._fieldsMap.set(n,s),this._fieldsMap.set(a,s),this._normalizedFieldsMap.set(o,s),i.push(`${a}:${s.type}:${this._timeZoneByFieldName?.get(n)}`),C2(s)?(this.dateFields.push(s),this._dateFieldsSet.add(s)):hk(s)&&(this._numericFieldsSet.add(s),this.numericFields.push(s)),i5(s)||s5(s)||(s.editable=s.editable==null||!!s.editable,s.nullable=s.nullable==null||!!s.nullable)}}i.sort(),this.uid=i.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)i5(e)||s5(e)||e.nullable||Yhe(e)!==void 0||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return this.get(e)!=null}get(e){if(!e)return;let r=this._fieldsMap.get(e);return r||(r=this._fieldsMap.get($h(e))??this._normalizedFieldsMap.get(uD(e)),r&&this._fieldsMap.set(e,r),r)}getTimeZone(e){const r=this.get(e&&typeof e!="string"?e.name:e);return r?this._timeZoneByFieldName?this._timeZoneByFieldName.get(r.name):r.type==="date"||r.type==="esriFieldTypeDate"?(U.getLogger("esri.layers.support.FieldsIndex").errorOnce(new R("getTimeZone:no-timezone-information",`no time zone information for field '${r.name}'`)),ga):bH.has(r.type)?sc:null:null}getLuxonTimeZone(e){const r=this.getTimeZone(e);return r?r===sc?ko.instance:r===ga?mr.utcInstance:Fm(Oxe,r,()=>fs.create(r)):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return VU(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map(e=>L0(e)?e.toJSON():e),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}};function $h(t){return t.trim().toLowerCase()}function uD(t){return Fhe(t)?.toLowerCase()??""}const bH=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function cD(t){const e=new Map;if(!t.fields)return e;const r=t.datesInUnknownTimezone===!0,{timeInfo:i,editFieldsInfo:s}=t,n=(i?"startField"in i?i.startField:i.startTimeField:"")??"",o=(i?"endField"in i?i.endField:i.endTimeField:"")??"",a=Rxe(t)?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?U_(t.dateFieldsTimeReference):null,l=s?Lxe(s)?s.timeZone??a:s.dateFieldsTimeReference?U_(s.dateFieldsTimeReference):a??ga:null,c=i?Axe(i)?i.timeZone??a:i.timeReference?U_(i.timeReference):a:null,d=new Map([[$h(s?.creationDateField??""),l],[$h(s?.editDateField??""),l],[$h(n),c],[$h(o),c]]);for(const{name:p,type:m}of t.fields)if(bH.has(m))e.set(p,sc);else if(m!=="date"&&m!=="esriFieldTypeDate")e.set(p,null);else if(r)e.set(p,sc);else{const y=d.get($h(p??""))??a;e.set(p,y)}return e}const SH={TypeNotAllowedInFeature:"Feature attributes only support dates, numbers, strings, guids.",LogicError:"Logic error - {reason}",CannotCompareDateAndTime:"Cannot compare date or dateonly with timeonly types",NeverReach:"Encountered unreachable logic",AsyncNotEnabled:"Async Arcade must be enabled for this script",ModuleAccessorMustBeString:"Module accessor must be a string",ModuleExportNotFound:"Module has no export with provided identifier",ModulesNotSupported:"Current profile does not support modules",ArrayAccessMustBeNumber:"Array accessor must be a number",FunctionNotFound:"Function not found",FieldNotFound:"Key not found - {key}",CircularModules:"Circular module dependencies are not allowed",Cancelled:"Execution cancelled",UnsupportedHashType:"Type not supported in hash function",IllegalResult:"Value is not a supported return type",PortalRequired:"Portal is required",InvalidParameter:"Invalid parameter",WrongNumberOfParameters:"Call with wrong number of parameters",Unrecognized:"Unrecognized code structure",UnrecognizedType:"Unrecognized type",WrongSpatialReference:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",BooleanConditionRequired:"Conditions must use booleans",NoFunctionInDictionary:"Dictionaries cannot contain functions.",NoFunctionInArray:"Arrays cannot contain functions.",NoFunctionInTemplateLiteral:"Template Literals do not expect functions by value.",KeyAccessorMustBeString:"Accessor must be a string",KeyMustBeString:"Object keys must be a string",Immutable:"Object is immutable",UnexpectedToken:"Unexpected token",MemberOfNull:"Cannot access property of null object",MaximumCallDepth:"Exceeded maximum function depth",OutOfBounds:"Out of bounds",InvalidIdentifier:"Identifier not recognized",CallNonFunction:"Expression is not a function",InvalidMemberAccessKey:"Cannot access value using a key of this type",AssignModuleFunction:"Cannot assign function to module variable",UnsupportUnaryOperator:"Unsupported unary operator",UnsupportedOperator:"Unsupported operator",LogicalExpressionOnlyBoolean:"Logical expressions must be boolean",LogicExpressionOrAnd:"Logical expression can only be combined with || or &&",CannotChangeTimeZoneTime:"Cannot change the timezone of a Time",CannotChangeTimeZoneDateOnly:"Cannot change the timezone of a DateOnly",FeatureSetDoesNotHaveSubtypes:"FeatureSet does not have subtypes"};let Fxe=class extends Error{constructor(...e){super(...e)}},hD=class xH extends Fxe{constructor(e,r){super(mL(r)+e.message,{cause:e}),this.loc=null,Error.captureStackTrace&&Error.captureStackTrace(this,xH),r?.loc&&(this.loc=r.loc)}},Nxe=class $H extends Error{constructor(e,r,i,s){super("Execution error - "+mL(i)+dc(SH[r],s)),this.loc=null,this.declaredRootClass="esri.arcade.arcadeexecutionerror",Error.captureStackTrace&&Error.captureStackTrace(this,$H),i?.loc&&(this.loc=i.loc)}};function mL(t){return t&&t.loc?`Line : ${t.loc.start?.line}, ${t.loc.start?.column}: `:""}let d8e=class MH extends Error{constructor(e,r,i,s){super("Compilation error - "+mL(i)+dc(SH[r],s)),this.loc=null,this.declaredRootClass="esri.arcade.arcadecompilationerror",Error.captureStackTrace&&Error.captureStackTrace(this,MH),i?.loc&&(this.loc=i.loc)}},p8e=class TH extends Error{constructor(){super("Uncompilable code structures"),this.declaredRootClass="esri.arcade.arcadeuncompilableerror",Error.captureStackTrace&&Error.captureStackTrace(this,TH)}};function f8e(t,e,r){return r.declaredRootClass==="esri.arcade.arcadeexecutionerror"||r.declaredRootClass==="esri.arcade.arcadecompilationerror"?r.loc===null&&e?.loc?new hD(r,{cause:r}):r:(r.declaredRootClass==="esri.arcade.featureset.support.featureseterror"||r.declaredRootClass==="esri.arcade.featureset.support.sqlerror"||r.declaredRootClass,e?.loc?new hD(r,{cause:r}):r)}const Dxe={UnrecognizedUri:"Unrecognized uri - {uri}",UnsupportedUriProtocol:"Unrecognized uri protocol"};let m8e=class IH extends Error{constructor(e,r){super(dc(Dxe[e],r)),this.declaredRootClass="esri.arcade.arcademoduleerror",Error.captureStackTrace&&Error.captureStackTrace(this,IH)}};function Hb(t){return t.toLowerCase().replaceAll(/[\s-]+/g,"")}let y8e=class{constructor(e,r){const i=new Map;for(const s of e){const n=Hb(s);if(i.has(n))throw new Error(`${s} already added as ${i.get(n)}`);i.set(n,s)}if(r!=null)for(const[s,n]of r){const o=Hb(s);if(i.has(o))throw new Error(`${s} already associated with ${i.get(o)}`);i.set(o,n)}this._enumMap=i}lookup(e){return this._enumMap.get(Hb(e))}get(e){const r=this.lookup(e);if(r==null)throw new Nxe(null,"InvalidParameter",null);return r}};const zxe={TimeZoneNotRecognized:"Timezone identifier has not been recognized."};let jxe=class EH extends Error{constructor(e,r){super(dc(zxe[e],r)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,EH)}};function Wd(t,e,r){return t<e?t-e:t>r?t-r:0}function Zd(t,e,r){return t<e?e:t>r?r:t}let gl=class rr{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,r=1,i=1,s=0,n=0,o=0,a=0,l){if(isNaN(e)||isNaN(r)||isNaN(i)||isNaN(s)||isNaN(n)||isNaN(o)||isNaN(a))return null;const c=ue.local(e,r).daysInMonth;let d=ue.fromObject({day:Zd(i,1,c),year:e,month:Zd(r,1,12),hour:Zd(s,0,23),minute:Zd(n,0,59),second:Zd(o,0,59),millisecond:Zd(a,0,999)},{zone:To(l)});return d=d.plus({months:Wd(r,1,12),days:Wd(i,1,c),hours:Wd(s,0,23),minutes:Wd(n,0,59),seconds:Wd(o,0,59),milliseconds:Wd(a,0,999)}),new rr(d)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,r){const i=To(r);return e.isUnknownTimeZone||i===ko.instance?rr.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,i):new rr(e._date.setZone(i))}static dateJSToArcadeDate(e){return new rr(ue.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,r="system"){const i=To(r);return new rr(ue.fromJSDate(e,{zone:i}))}static unknownEpochToArcadeDate(e){return new rr(ue.fromMillis(e,{zone:ko.instance}))}static unknownDateJSToArcadeDate(e){return new rr(ue.fromMillis(e.getTime(),{zone:ko.instance}))}static epochToArcadeDate(e,r="system"){const i=To(r);return new rr(ue.fromMillis(e,{zone:i}))}static dateTimeToArcadeDate(e){return new rr(e)}clone(){return new rr(this._date)}changeTimeZone(e){const r=To(e);return rr.dateTimeToArcadeDate(this._date.setZone(r))}static dateTimeAndZoneToArcadeDate(e,r){const i=To(r);return e.zone===ko.instance||i===ko.instance?rr.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,i):new rr(e.setZone(i))}static nowToArcadeDate(e){const r=To(e);return new rr(ue.fromJSDate(new Date,{zone:r}))}static nowUTCToArcadeDate(){return new rr(ue.utc())}get isSystem(){return this.timeZone==="system"||this.timeZone===rr.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===ko.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if(this._date.zone.type==="system")return"system";const e=this.zone;return e.type==="fixed"?e.fixed===0?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new rr(this._date.plus(e))}diff(e,r){return this._date.diff(e._date,r)[r]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,r){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:r&&!this.isUnknownTimeZone})}toFormat(e,r){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,r)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new rr(this._date.toUTC())}toLocal(){return new rr(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const r=ue.fromISO(e,{setZone:!0});return new rr(r)}};function To(t,e=!0){if(t instanceof wd)return t;switch(Hb(t)){case"system":return"system";case"utc":return"UTC";case"unknown":return ko.instance}if(/^[+-]?[0-9]{1,2}(:[0-9]{2})?$/.test(t)){const i=mr.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(i)return i}const r=fs.create(t);if(!r.isValid){if(e)throw new jxe("TimeZoneNotRecognized");return null}return r}function dD(t){t=t.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$&]");let e="";const r=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const i of t.match(r)||[])switch(i){case"D":e+="d";break;case"DD":e+="dd";break;case"DDD":e+="o";break;case"d":e+="c";break;case"ddd":e+="ccc";break;case"dddd":e+="cccc";break;case"M":e+="L";break;case"MM":e+="LL";break;case"MMM":e+="LLL";break;case"MMMM":e+="LLLL";break;case"YY":e+="yy";break;case"Y":case"YYYY":e+="yyyy";break;case"Q":e+="q";break;case"X":case"x":e+=i;break;default:i.length>=2&&i.startsWith("[")&&i.endsWith("]")?e+=`'${i.slice(1,-1)}'`:e+=`'${i}'`}return e}const pD="esri.core.sql.dateonly";let Vxe=class Ms{constructor(e,r,i){this._year=e,this._month=r,this._day=i,this.declaredRootClass=pD}static isDateOnly(e){return typeof e=="object"&&e!=null&&"declaredRootClass"in e&&e.declaredRootClass===pD}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(e){return Ms.isDateOnly(e)&&e.day===this.day&&e.month===this.month&&e.year===this.year}clone(){return new Ms(this._year,this._month,this._day)}toDateTime(e){return ue.fromObject({day:this.day,month:this.month,year:this.year},{zone:To(e)})}toDateTimeLuxon(e){return ue.fromObject({day:this.day,month:this.month,year:this.year},{zone:To(e)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(e=null,r=!0){if(e===null||e==="")return this.toString();if(r&&(e=dD(e)),!e)return"";const i=this.toDateTime("unknown");return gl.dateTimeToArcadeDate(i).toFormat(e,{locale:hs(),numberingSystem:"latn"})}toArcadeDate(){const e=this.toDateTime("unknown");return gl.dateTimeToArcadeDate(e)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(e,r){return Ms.fromDateTime(this.toUTCDateTime().plus({[e]:r}))}toUTCDateTime(){return ue.utc(this.year,this.month,this.day,0,0,0,0)}difference(e,r){switch(r.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return r==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}static fromMilliseconds(e){const r=ue.fromMillis(e,{zone:mr.utcInstance});return r.isValid?Ms.fromParts(r.year,r.month,r.day):null}static fromSeconds(e){const r=ue.fromSeconds(e,{zone:mr.utcInstance});return r.isValid?Ms.fromParts(r.year,r.month,r.day):null}static fromReader(e){if(!e)return null;const r=e.split("-");return r.length!==3?null:new Ms(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10))}static fromParts(e,r,i){const s=new Ms(e,r,i);return s.isValid===!1?null:s}static fromDateJS(e){return Ms.fromParts(e.getFullYear(),e.getMonth()+1,e.getDay())}static fromDateTime(e){return Ms.fromParts(e.year,e.month,e.day)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,r=null){if(e===""||e===null)return null;const i=[];if(r)(r=dD(r))&&i.push(r);else if(r===null||r===""){const s=ue.fromISO(e,{setZone:!0});return s.isValid?Ms.fromParts(s.year,s.month,s.day):null}for(const s of i){const n=ue.fromFormat(e,r??s);if(n.isValid)return new Ms(n.year,n.month,n.day)}return null}static fromNow(e="system"){const r=ue.fromJSDate(new Date).setZone(To(e));return new Ms(r.year,r.month,r.day)}};function v8e(t){if(t==null)return null;switch(t.type){case"polygon":case"multipoint":case"polyline":return t.extent;case"point":return new Te({xmin:t.x,ymin:t.y,xmax:t.x,ymax:t.y,spatialReference:t.spatialReference});case"extent":return t}return null}function w8e(t){if(t==null)return null;const e=t.clone();return t.cache._geVersion!==void 0&&(e.cache._geVersion=t.cache._geVersion),e}function s_(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function fD(t){if(!t)return"";const e=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let r="";for(const i of t.match(e)||[])switch(i){case"SSS":case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":r+=i;break;case"A":case"a":r+="a";break;default:r+=`'${i}'`}return r}const mD="esri.core.sql.timeonly";let Uxe=class _o{constructor(e,r,i,s){this._hour=e,this._minute=r,this._second=i,this._millisecond=s,this.declaredRootClass=mD}static isTimeOnly(e){return typeof e=="object"&&e!=null&&"declaredRootClass"in e&&e.declaredRootClass===mD}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(e){return _o.isTimeOnly(e)&&e.hour===this.hour&&e.minute===this.minute&&e.second===this.second&&e.millisecond===this.millisecond}clone(){return new _o(this.hour,this.minute,this.second,this.millisecond)}isValid(){return s_(this.hour)&&s_(this.minute)&&s_(this.second)&&s_(this.millisecond)&&this.hour>=0&&this.hour<24&&this.minute>=0&&this.minute<60&&this.second>=0&&this.second<60&&this.millisecond>=0&&this.millisecond<1e3}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(e=null){return e===null||e===""?this.toString():(e=fD(e))?ue.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(e,{locale:hs(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1e3*this.second+1e3*this.minute*60+60*this.hour*60*1e3}static fromParts(e,r,i,s){const n=new _o(e,r,i,s);return n.isValid()?n:null}static fromReader(e){if(!e)return null;const r=e.split(":");return r.length!==3?null:new _o(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10),0)}static fromMilliseconds(e){if(e>864e5||e<0)return null;const r=Math.floor(e/1e3%60),i=Math.floor(e/6e4%60),s=Math.floor(e/36e5%24),n=Math.floor(e%1e3);return new _o(s,i,r,n)}static fromDateJS(e){return new _o(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}static fromDateTime(e){return new _o(e.hour,e.minute,e.second,e.millisecond)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,r=null){if(e===""||e===null)return null;const i=[];r?(r=fD(r))&&i.push(r):r!==null&&r!==""||(i.push("HH:mm:ss"),i.push("HH:mm:ss.SSS"),i.push("hh:mm:ss a"),i.push("hh:mm:ss.SSS a"),i.push("HH:mm"),i.push("hh:mm a"),i.push("H:mm"),i.push("h:mm a"),i.push("H:mm:ss"),i.push("h:mm:ss a"),i.push("H:mm:ss.SSS"),i.push("h:mm:ss.SSS a"));for(const s of i){const n=ue.fromFormat(e,s);if(n.isValid)return new _o(n.hour,n.minute,n.second,n.millisecond)}return null}plus(e,r){switch(e){case"days":case"years":case"months":return this.clone();case"hours":case"minutes":case"seconds":case"milliseconds":return _o.fromDateTime(this.toUTCDateTime().plus({[e]:r}))}return null}toUTCDateTime(){return ue.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(e,r){switch(r.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return r==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}};const Gxe=["geometry","scale","timeProperties"];function _8e(t,e){if(e!=null)for(const r of Gxe)e.hasArcadeDependency(r)&&t.add(r);return t}function qxe(t,e){return CH.create(t,e,null,["$feature","$view"])}function Bxe(t,e,r){return CH.create(t,e,r,["$feature","$view","$config"])}let CH=class PH{static async create(e,r,i,s){const{arcade:n,Dictionary:o}=await kl();let a;try{a=n.parseScript(e)}catch(y){throw new R("arcade-bad-expression","Failed to parse arcade script",{script:e,error:y})}const l=n.scriptUsesGeometryEngine(a);l&&await n.enableGeometrySupport(),await n.loadDependentModules(new Set,a,null,!1,l);const c={vars:s.reduce((y,g)=>({...y,[g]:null}),{}),spatialReference:r,useAsync:!1},d=n.compileScript(a,c);let p=null;i!=null&&(p=new o(i),p.immutable=!0);const m=new o;return m.immutable=!1,m.setField("scale",0),new PH(e,n,a,d,r,m,p,o)}constructor(e,r,i,s,n,o,a,l){this.script=e,this._arcade=r,this._syntaxTree=i,this._compiled=s,this._spatialReference=n,this._viewDict=o,this._configDict=a,this._dictionaryCtor=l,this._dependencies=new Map,this._featureReader=new kH,this._dependencies.set("geometry",r.scriptTouchesGeometry(this._syntaxTree)),this._dependencies.set("scale",this._arcade.referencesMember(this._syntaxTree,"scale")),this._dependencies.set("timeProperties",this._arcade.scriptUsesViewProperties(this._syntaxTree,["timeProperties"]))}evaluate(e,r){const i=r.$view?.timeZone;if(r.$view){let s;if(this._viewDict.setField("scale",r.$view.scale),r.$view.timeProperties!=null){const{currentStart:n,currentEnd:o}=r.$view.timeProperties;s=new this._dictionaryCtor({currentStart:n!=null?i!=null?gl.epochToArcadeDate(n,i):gl.unknownEpochToArcadeDate(n):void 0,currentEnd:o!=null?i!=null?gl.epochToArcadeDate(o,i):gl.unknownEpochToArcadeDate(o):void 0,startIncluded:!0,endIncluded:!0})}this._viewDict.setField("timeProperties",s)}return this._compiled({vars:{$view:this._viewDict,$config:this._configDict,$feature:e},spatialReference:this._spatialReference,timeZone:i})}repurposeFeature(e,r){return this._featureReader.bind(e,r,this._spatialReference),this._featureReader}references(e){return this._dependencies.get(e)??!1}},kH=class{constructor(){this._boundTarget=null,this._boundSchema={fields:null,fieldsIndex:null,spatialReference:null,get geometryType(){return null},get objectIdField(){return null}},this.arcadeDeclaredClass="esri.arcade.Feature",this._contextTimeZone=null}bind(e,r,i){const s=r??new uv(LH(e.attributes));this._boundTarget=e,this._boundSchema.fields=s.fields,this._boundSchema.fieldsIndex=s,this._boundSchema.spatialReference=i}_getField(e){return this._boundSchema.fieldsIndex.get(e)}get contextTimeZone(){return this._contextTimeZone}set contextTimeZone(e){this._contextTimeZone=e}readArcadeFeature(){return this}hasField(e){return this._boundSchema.fieldsIndex.has(e)}geometry(){if("fromJSON"in this._boundTarget)return this._boundTarget.geometry;const e=ac(this._boundTarget.geometry);if(e){if(!this._boundSchema.spatialReference)throw new Error("InternalError: Expected spatial reference to be defined");e.spatialReference=this._boundSchema.spatialReference}return e}_hasGeometry(){return this._boundTarget.geometry!=null}isUnknownDateTimeField(e){return this._boundSchema.fieldsIndex.getTimeZone(e)===sc}field(e,r=!0){const i=this._getField(e);if(i){const s=this._boundTarget.attributes[i.name];if(s==null)return null;switch(i.type){case"date-only":case"esriFieldTypeDateOnly":return Vxe.fromReader(s);case"time-only":case"esriFieldTypeTimeOnly":return Uxe.fromReader(s);case"esriFieldTypeTimestampOffset":case"timestamp-offset":return gl.fromReaderAsTimeStampOffset(s);case"date":case"esriFieldTypeDate":return this.isUnknownDateTimeField(e)?gl.unknownEpochToArcadeDate(s):gl.epochToArcadeDate(s,this.contextTimeZone??to);default:return s}}if(r)throw new Error(`Field ${e} does not exist`);return null}setField(e,r){throw new Error("Unable to update feature attribute values, feature is readonly")}keys(){return this._boundSchema.fieldsIndex.fields.map(e=>e.name)}isEmpty(){return this._boundSchema.fields.length<=0&&!this._hasGeometry()}castToText(e=!1){return JSON.stringify(this._boundTarget)}gdbVersion(){return null}fullSchema(){return this._boundSchema}castAsJson(e=null){return{attributes:this._boundTarget.attributes,geometry:e?.keepGeometryType===!0?this.geometry():this.geometry()?.toJSON()??null}}castAsJsonAsync(e=null,r=null){return Promise.resolve(this.castAsJson(r))}};function LH(t){const e=[];for(const r in t)e.push({name:r,alias:r,type:typeof t[r]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"});return e}let Hxe=class AH{static async from(e,r,i){const s=e.dictionary_version?aB.parse(e.dictionary_version):null,n=new Set(e.itemsNames),o={};if(r)for(const p in r)o[p]=r[p];if(e.authoringInfo.configuration)for(const p of e.authoringInfo.configuration)o.hasOwnProperty(p.name)||(o[p.name]=p.value);const a=new Set(e.authoringInfo.symbol);for(const p of Object.keys(i))a.delete(p);a.size&&U.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("missing-fields: fieldMap entries for the following symbol fields are missing",{symbolFields:a});const l=await Bxe(e.expression,null,o);if(!l)throw new R("dictionary-renderer:expression-error","Unable to create dictionary renderer expression");const c=!s||!s.greaterEqual(4,0);c&&U.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("Dictionary script does not support native field types. Applying fallback",{version:s});const d=new Wxe(i,c);return new AH(c,n,l,d)}constructor(e,r,i,s){this._requiresFieldCoercionToString=e,this._itemNames=r,this._compiled=i,this._reader=s}get itemNames(){return this._itemNames}evaluate(e,r,i,s){try{return this._reader.bind(e,i,s),this._compiled.evaluate(this._reader,{$view:{scale:r}})}catch(n){U.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("arcade: dictionary script evaluation failed",{error:n})}return null}createDictionaryFieldsIndex(e){if(!this._requiresFieldCoercionToString)return new uv(e);const r=e.map(i=>({...i,type:"esriFieldTypeString"}));return new uv(r)}},Wxe=class extends kH{constructor(e,r){super(),this._fieldMap=e,this._requiresFieldCoercionToString=r}_getField(e){const r=this._fieldMap[e]??e;return this._boundSchema.fieldsIndex.get(r)}field(e){if(!this._requiresFieldCoercionToString)return super.field(e,!1);const r=this._getField(e);return r==null||this._boundTarget.attributes[r.name]==null?"":""+this._boundTarget.attributes[r.name]}};const yD={Relative:0,Absolute:1},Zxe={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},tr={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1,gradientMethod:"AcrossLine",gradientSize:75,gradientSizeUnits:yD.Relative,gradientType:"Discrete",interval:5},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGradientFill:{enable:!0,angle:90,gradientMethod:"Linear",gradientSize:75,gradientSizeUnits:yD.Relative,gradientType:"Discrete",interval:5},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRadial:{angle:0,length:5},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:"Loop",repeatdelay:0,easing:"Linear"},CIMSymbolAnimationSize:{tosize:10},CIMSymbolAnimationScale:{scalefactor:1},CIMSymbolAnimationColor:{tocolor:[255,255,255,1]},CIMSymbolAnimationTransparency:{totransparency:0},CIMSymbolAnimationRotation:{torotation:0,rotateclockwise:!1},CIMSymbolAnimationOffset:{offsetx:0,offsety:0},CIMSymbolAnimationMoveAlongLine:{speed:30,distanceAlong:100}};function Jxe(t){return typeof t=="function"}function x8e(t,e,r,i){return Jxe(t)?t(e,r,i):t}function $8e(t){return[t.r,t.g,t.b,t.a]}const Yxe=` /-,
`;function gD(t){let e=t.length;for(;e--;)if(!Yxe.includes(t.charAt(e)))return!1;return!0}function Xxe(t,e){const r=[];let i=0,s=-1;do if(s=t.indexOf("[",i),s>=i){if(s>i){const n=t.slice(i,s);r.push([n,null,gD(n)])}if(i=s+1,s=t.indexOf("]",i),s>=i){if(s>i){const n=e[t.slice(i,s)];n&&r.push([null,n,!1])}i=s+1}}while(s!==-1);if(i<t.length){const n=t.slice(i);r.push([n,null,gD(n)])}return r}function M8e(t,e,r){let i="",s=null;for(const n of e){const[o,a,l]=n;if(o!=null&&o!=="")l?s=o:(s!=null&&(i+=s,s=null),i+=o);else{const c=t.readAttribute(a);c!=null&&c!==""&&(s!==null&&(i+=s,s=null),i+=c)}}return RH(i,r)}function Kxe(t,e,r,i){let s="",n=null;for(const o of e){const[a,l,c]=o;if(a!=null&&a!=="")c?n=a:(n!=null&&(s+=n,n=null),s+=a);else{let d=l;r!=null&&(d=h$e(l,r));const p=t.attributes[d];p!=null&&p!==""&&(n!=null&&(s+=n,n=null),s+=p)}}return RH(s,i)}function RH(t,e){switch(typeof t!="string"&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function T8e(t,e,r,i,s,n,o=!0){const a=e/s,l=r/n,c=Math.ceil(a/2),d=Math.ceil(l/2);for(let p=0;p<n;p++)for(let m=0;m<s;m++){const y=4*(m+(o?n-p-1:p)*s);let g=0,v=0,w=0,_=0,x=0,$=0,T=0;const C=(p+.5)*l;for(let P=Math.floor(p*l);P<(p+1)*l;P++){const A=Math.abs(C-(P+.5))/d,F=(m+.5)*a,j=A*A;for(let V=Math.floor(m*a);V<(m+1)*a;V++){let Z=Math.abs(F-(V+.5))/c;const Y=Math.sqrt(j+Z*Z);Y>=-1&&Y<=1&&(g=2*Y*Y*Y-3*Y*Y+1,g>0&&(Z=4*(V+P*e),T+=g*t[Z+3],w+=g,t[Z+3]<255&&(g=g*t[Z+3]/250),_+=g*t[Z],x+=g*t[Z+1],$+=g*t[Z+2],v+=g))}}i[y]=_/v,i[y+1]=x/v,i[y+2]=$/v,i[y+3]=T/w}}function OH(t){return t?[t[0],t[1],t[2],t[3]/255]:[0,0,0,0]}function yL(t){return t.data?.symbol??null}function gL(t){return t.type==="CIMVectorMarker"||t.type==="CIMPictureMarker"||t.type==="CIMBarChartMarker"||t.type==="CIMCharacterMarker"||t.type==="CIMPieChartMarker"||t.type==="CIMStackedBarChartMarker"}function FH(t){return t.type==="CIMGradientStroke"||t.type==="CIMPictureStroke"||t.type==="CIMSolidStroke"}function Qxe(t){return t!=null&&(t.type==="CIMGradientFill"||t.type==="CIMHatchFill"||t.type==="CIMPictureFill"||t.type==="CIMSolidFill"||t.type==="CIMWaterFill")}function nx(t){return t!=null&&(t.type==="CIMMarkerPlacementAlongLineRandomSize"||t.type==="CIMMarkerPlacementAlongLineSameSize"||t.type==="CIMMarkerPlacementAlongLineVariableSize"||t.type==="CIMMarkerPlacementAtExtremities"||t.type==="CIMMarkerPlacementAtMeasuredUnits"||t.type==="CIMMarkerPlacementAtRatioPositions"||t.type==="CIMMarkerPlacementOnLine"||t.type==="CIMMarkerPlacementOnVertices")}const xe=(t,e=0)=>t==null||isNaN(t)?e:t,I8e=(t,e)=>t??e,E8e=(t,e)=>t??e,C8e=t=>t.tintColor?OH(t.tintColor):[255,255,255,1];let e$e=class{constructor(e){this._import=e}getImportPromise(){return this._promise==null&&(this._promise=this._import().then(e=>this.module=e)),this._promise}};function Md(t){return new e$e(t)}function t$e(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function r$e(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function NH(t){let e="normal",r="normal";if(t){const i=t.toLowerCase();i.includes("italic")?e="italic":i.includes("oblique")&&(e="oblique"),i.includes("bold")?r="bold":i.includes("light")&&(r="lighter")}return{style:e,weight:r}}function DH(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function T0(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const r=T0(e);if(r!=null)return r}break;case"CIMTextSymbol":return T0(t.symbol);case"CIMSolidFill":return t.color}return null}function _S(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const r of e){const i=_S(r);if(i!=null)return i}break}case"CIMTextSymbol":return _S(t.symbol);case"CIMSolidStroke":return t.color}}function k8e(t){for(const e of t)if(e.enable)switch(e.type){case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return!0}return!1}function bS(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const r=bS(e);if(r!==void 0)return r}break;case"CIMTextSymbol":return bS(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function i$e(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function s$e(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function n$e(t){return(t?Object.keys(t):[]).map(e=>({name:e,alias:e,type:typeof t[e]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"}))}const Jd=t=>t.includes("data:image/svg+xml");function SS(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function ew(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function L8e(t,e,r,i,s,n,o=!0){const{infos:a}=n;let l=1,c=0,d=0,p=0,m=1;for(const{absoluteAnchorPoint:v,offsetX:w,offsetY:_,rotation:x,size:$,frameHeight:T,rotateClockWise:C,scaleSymbolsProportionally:P}of a)m=v?1:l,d=_D(w,_,c,m,d),p=wD(w,_,c,m,p),T&&(P||o)&&(l*=$/T),c=bD(x,C,c);const y=_D(i,s,c,m,d),g=wD(i,s,c,m,p);return{size:t*l,rotation:bD(e,r,c),offsetX:y,offsetY:g}}function o$e(t){if(t==null)return!1;if(Array.isArray(t))return t.every(e=>o$e(e));switch(typeof t){case"string":return!!t;case"number":return!isNaN(t)}}function a$e(t,e){if(e==="color"||e==="outlinecolor"||e==="backgroundcolor"||e==="borderlinecolor"||e==="tintcolor")return[...Zxe[e]];const r=tr[t];if(!r)throw new Error(`InternalError: default value for type ${t}.`);return r[e]}function l$e(t){return t.split(" ").map(e=>Number(e))}function u$e(t){return typeof t=="string"?l$e(t):t}function zH(t){return t?.dashTemplate&&(t.dashTemplate=u$e(t.dashTemplate)),t}function ZE(t){if(t==null)return"Normal";switch(t.type){case"CIMTextSymbol":return t.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const e=t.symbolLayers;if(!e)return"Normal";for(const r of e)if(r.type==="CIMVectorMarker")return ZE(r)}break;case"CIMVectorMarker":{const e=t.markerGraphics;if(!e)return"Normal";for(const r of e)if(r.symbol)return ZE(r.symbol)}}return"Normal"}function c$e(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":{let e=0;if(t.symbolLayers){for(const r of t.symbolLayers)if(r)switch(r.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const i=r.size??tr.CIMVectorMarker.size;i>e&&(e=i);break}}}return e}case"CIMLineSymbol":case"CIMPolygonSymbol":{let e=0;if(t.symbolLayers){for(const r of t.symbolLayers)if(r)switch(r.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const i=r.width;i!=null&&i>e&&(e=i);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(r.markerPlacement&&nx(r.markerPlacement)){const i=r.size??tr.CIMVectorMarker.size;i>e&&(e=i)}break;case"CIMPictureFill":{const i=r.height;i!=null&&i>e&&(e=i)}}}return e}}}function h$e(t,e){if(e!==null){const r=e.get(t);return r?r.name:t}return t}function d$e(t){return t.map(e=>({...e,propertyName:ew(e.propertyName)}))}function vD(t){const e={};for(const r in t){const i=t[r];e[ew(r)]=i}return e}function wD(t,e,r,i,s){const n=r*Math.PI/180;if(n){const o=Math.cos(n);return(Math.sin(n)*t+o*e)*i+s}return e*i+s}function _D(t,e,r,i,s){const n=r*Math.PI/180;return n?(Math.cos(n)*t-Math.sin(n)*e)*i+s:t*i+s}function bD(t,e,r){return e?r-t:r+t}function A8e(t,e,r){const i=r==="Color"||r==="TintColor"||r==="ToColor",s=r==="Rotation"||r==="Angle"||r==="ToRotation";let n=e[ew(r)];if(n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]/255]:s&&(n*=Math.PI/180)),n==null&&(n=a$e(e.type,r.toLowerCase()),n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]]:s&&(n*=Math.PI/180))),e.primitiveName!=null){const o=t[e.primitiveName];if(o!=null){const a=o[r];a==null||(typeof a=="string"||typeof a=="number"||Array.isArray(a)?(n=a,n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]/255]:s&&(n*=Math.PI/180))):(n={valueExpressionInfo:a,defaultValue:n},n!=null&&(i?n={type:"Process",op:"ArcadeColor",value:n}:s&&(n={type:"Process",op:"Divide",left:n,right:180/Math.PI}))))}}if(n==null)throw new Error(`Failed to derive a value or an expression for "${r}".`);return n}function R8e(t,e,r){if(e[ew(r)]!=null)return!0;if(e.primitiveName!=null){const i=t[e.primitiveName];if(i!=null&&i[r]!=null)return!0}return!1}function Vy(t,e){return Math.max(Math.min((t??e)/100,1),0)}const p$e={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let jH=class{constructor(e,r,i,s){this.url=e,this.fieldMap=i,this.dictionaryInfo=s,this._symbolPartCache=new wH(100);const n=async()=>Hxe.from(await s,r,i);this._evaluator=n()}async getSymbolAsync(e,r,i=!0){const s=await this._evaluator,n=r?.fields??LH(e.attributes),o=s.createDictionaryFieldsIndex(n),a=s.evaluate(e,r?.scale??0,o,r?.spatialReference);if(a==null)return null;const l=Qm(e.geometry),c=lD.parse(a,s.itemNames,l),d=l==="esriGeometryPoint"&&!e.geometry?.hasZ;return await this._cimPartsToCIMSymbol(e,c.partNames,c.overrides,d,r,i,o)}async getSymbolForControlString(e,r,i){const s=await this._evaluator,n=lD.parse(e,s.itemNames,r),o=r==="esriGeometryPoint"&&!i,a=SD(await Promise.all(n.partNames.map(l=>this._getSymbolPart(l))),n.overrides,o);return new yi({data:a})}async _cimPartsToCIMSymbol(e,r,i,s,n,o,a){const l=r.map(p=>this._getSymbolPart(p,n));let c=await Promise.all(l);if(o&&this.fieldMap&&c.length>0){const{OverrideHelper:p}=await q(()=>Promise.resolve().then(()=>xke),void 0);c=O(c);for(const m of c)p.applyDictionaryTextOverrides(m,e,this.fieldMap,a,ZE(m))}const d=SD(c,i,s);return new yi({data:d})}async _fetchSymbolPart(e,r){const i=await this.dictionaryInfo,s=(this.url+"/"+i.cimRefTemplateUrl).replaceAll(/\{itemName\}/gi,e),{data:n}=await Be(s,{responseType:"json",query:{f:"json"},...r});return n}async _getSymbolPart(e,r){let i=this._symbolPartCache.get(e);return i||(i=this._fetchSymbolPart(e,r),this._symbolPartCache.put(e,i)),i}};function SD(t,e,r){if(!t||t.length===0)return null;const i={...t[0]};if(t.length>1){i.effects=null,i.symbolLayers=[];for(const s of t){const n=s;if(n.effects!=null)for(const o of n.symbolLayers)o.effects==null?o.effects=n.effects:o.effects.unshift(...n.effects);i.symbolLayers.unshift(...n.symbolLayers)}}return r&&(i.callout=p$e),{type:"CIMSymbolReference",symbol:i,primitiveOverrides:e}}var JE;let On=JE=class extends sy(Os){constructor(t){super(t),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){const t=this.getDictionaryInfo();return new jH(this.url,this.config,this.fieldMap??{},t)}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,r,i){i?.origin||super.writeVisualVariables(t,e,r,i)}clone(){return new JE({config:O(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:O(this.fieldMap),url:O(this.url),visualVariables:O(this.visualVariables)})}async getSymbolAsync(t,e,r=!0){return this._loader.getSymbolAsync(t,e,r)}async getSymbolForControlString(t,e,r){return this._loader.getSymbolForControlString(t,e,r)}getDictionaryInfo(){return this._dictionaryInfoPromise||(this._dictionaryInfoPromise=this._fetchDictionaryInfo()),this._dictionaryInfoPromise}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await ei(t,e,null,this.scaleExpression);for(const r in this.fieldMap){const i=this.fieldMap[r];e.has(i)&&t.add(i)}}get arcadeRequired(){return!0}getSymbol(){return null}get symbols(){return[]}getAttributeHash(){return this.visualVariables?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}async _fetchDictionaryInfo(){const{data:t}=await Be(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"}});return t}};u([h({type:jH})],On.prototype,"_loader",null),u([h({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],On.prototype,"config",void 0),u([h({type:Object,json:{write:!0}})],On.prototype,"fieldMap",void 0),u([h({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],On.prototype,"scaleExpression",void 0),u([te("scaleExpression")],On.prototype,"writeData",null),u([h({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],On.prototype,"scaleExpressionTitle",void 0),u([h({type:String,json:{write:!0}})],On.prototype,"url",void 0),u([te("visualVariables")],On.prototype,"writeVisualVariables",null),On=JE=u([E("esri.renderers.DictionaryRenderer")],On);var YE;let Ya=YE=class extends W{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return t==null?t:typeof t=="function"?(U.getLogger(this).error(".field: field must be a string value"),null):Iv(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new YE({color:this.color?.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};u([h({type:K,json:{type:[Number],write:!0}})],Ya.prototype,"color",void 0),u([h({type:String,json:{write:!0}})],Ya.prototype,"field",void 0),u([He("field")],Ya.prototype,"castField",null),u([h({type:String,json:{write:!0}})],Ya.prototype,"label",void 0),u([h({type:String,json:{write:!0}})],Ya.prototype,"valueExpression",void 0),u([h({type:String,json:{write:!0}})],Ya.prototype,"valueExpressionTitle",void 0),Ya=YE=u([E("esri.renderers.support.AttributeColorInfo")],Ya);const VH=Ya;var XE;let Wb=XE=class extends W{constructor(){super(...arguments),this.unit=null}clone(){return new XE({unit:this.unit})}};u([h({type:String,json:{write:!0}})],Wb.prototype,"unit",void 0),Wb=XE=u([E("esri.renderers.support.DotDensityLegendOptions")],Wb);const f$e=Wb;var KE;let Ki=KE=class extends sy(Os){constructor(t){super(t),this.attributes=null,this.backgroundColor=new K([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new Ot,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}set visualVariables(t){super.visualVariables=t}calculateDotValue(t){if(this.referenceScale==null)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new vi({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce((t,e)=>t+e.getAttributeHash(),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new KE({attributes:O(this.attributes),backgroundColor:O(this.backgroundColor),dotBlendingEnabled:O(this.dotBlendingEnabled),dotShape:O(this.dotShape),dotSize:O(this.dotSize),dotValue:O(this.dotValue),legendOptions:O(this.legendOptions),outline:O(this.outline),referenceScale:O(this.referenceScale),seed:O(this.seed),visualVariables:O(this.visualVariables),authoringInfo:O(this.authoringInfo)})}getControllerHash(){return`${this.attributes?.map(e=>e.field||e.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const r of this.attributes??[])r.valueExpression&&await ei(t,e,null,r.valueExpression),r.field&&t.add(r.field)}};u([h({type:[VH],json:{write:!0}})],Ki.prototype,"attributes",void 0),u([h({type:K,json:{write:!0}})],Ki.prototype,"backgroundColor",void 0),u([h({type:Boolean,json:{write:!0}})],Ki.prototype,"dotBlendingEnabled",void 0),u([h({type:String,json:{write:!1}})],Ki.prototype,"dotShape",void 0),u([h({type:Number,json:{write:!0}})],Ki.prototype,"dotSize",void 0),u([h({type:f$e,json:{write:!0}})],Ki.prototype,"legendOptions",void 0),u([h({type:Ot,json:{default:null,write:!0}})],Ki.prototype,"outline",void 0),u([h({type:Number,json:{write:!0}})],Ki.prototype,"dotValue",void 0),u([h({type:Number,json:{write:!0}})],Ki.prototype,"referenceScale",void 0),u([h({type:Number,json:{write:!0}})],Ki.prototype,"seed",void 0),u([ye({dotDensity:"dot-density"})],Ki.prototype,"type",void 0),Ki=KE=u([E("esri.renderers.DotDensityRenderer")],Ki);var QE;let vl=QE=class extends W{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new QE({color:this.color&&this.color.clone(),ratio:this.ratio})}};u([h({type:K,json:{type:[Ue],default:null,write:{isRequired:!0}}})],vl.prototype,"color",void 0),u([h({type:Number,json:{write:{isRequired:!0}}})],vl.prototype,"ratio",void 0),vl=QE=u([E("esri.renderers.support.HeatmapColorStop")],vl);let Gp=class extends Ie(W){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};u([h({type:String,json:{write:!0}})],Gp.prototype,"minLabel",void 0),u([h({type:String,json:{write:!0}})],Gp.prototype,"maxLabel",void 0),u([h({type:String,json:{write:!0}})],Gp.prototype,"title",void 0),Gp=u([E("esri.renderers.support.HeatmapLegendOptions")],Gp);function m$e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function y$e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function g$e(t,e,r,i,s){return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t}function v$e(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function UH(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function GH(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function qH(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function w$e(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function _$e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function b$e(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function S$e(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function x$e(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function $$e(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function M$e(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t}function BH(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],n=e[3]-t[3];return Math.sqrt(r*r+i*i+s*s+n*n)}function HH(t,e){const r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],n=e[3]-t[3];return r*r+i*i+s*s+n*n}function WH(t){const e=t[0],r=t[1],i=t[2],s=t[3];return Math.sqrt(e*e+r*r+i*i+s*s)}function ZH(t){const e=t[0],r=t[1],i=t[2],s=t[3];return e*e+r*r+i*i+s*s}function T$e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function I$e(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function E$e(t,e){const r=e[0],i=e[1],s=e[2],n=e[3];let o=r*r+i*i+s*s+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=r*o,t[1]=i*o,t[2]=s*o,t[3]=n*o),t}function C$e(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function JH(t,e,r,i){const s=e[0],n=e[1],o=e[2],a=e[3];return t[0]=s+i*(r[0]-s),t[1]=n+i*(r[1]-n),t[2]=o+i*(r[2]-o),t[3]=a+i*(r[3]-a),t}function P$e(t,e=1){const r=w2;let i,s,n,o,a,l;do i=2*r()-1,s=2*r()-1,a=i*i+s*s;while(a>=1);do n=2*r()-1,o=2*r()-1,l=n*n+o*o;while(l>=1);const c=Math.sqrt((1-a)/l);return t[0]=e*i,t[1]=e*s,t[2]=e*n*c,t[3]=e*o*c,t}function k$e(t,e,r){const i=e[0],s=e[1],n=e[2],o=e[3];return t[0]=r[0]*i+r[4]*s+r[8]*n+r[12]*o,t[1]=r[1]*i+r[5]*s+r[9]*n+r[13]*o,t[2]=r[2]*i+r[6]*s+r[10]*n+r[14]*o,t[3]=r[3]*i+r[7]*s+r[11]*n+r[15]*o,t}function L$e(t,e,r){const i=e[0],s=e[1],n=e[2],o=r[0],a=r[1],l=r[2],c=r[3],d=c*i+a*n-l*s,p=c*s+l*i-o*n,m=c*n+o*s-a*i,y=-o*i-a*s-l*n;return t[0]=d*c+y*-o+p*-l-m*-a,t[1]=p*c+y*-a+m*-o-d*-l,t[2]=m*c+y*-l+d*-a-p*-o,t[3]=e[3],t}function A$e(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function R$e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function O$e(t,e){const r=t[0],i=t[1],s=t[2],n=t[3],o=e[0],a=e[1],l=e[2],c=e[3],d=Bi();return Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-a)<=d*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(s-l)<=d*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(n-c)<=d*Math.max(1,Math.abs(n),Math.abs(c))}const F$e=UH,N$e=GH,D$e=qH,z$e=BH,j$e=HH,V$e=WH,U$e=ZH;Object.freeze(Object.defineProperty({__proto__:null,add:v$e,ceil:w$e,copy:m$e,copyVec3:y$e,dist:z$e,distance:BH,div:D$e,divide:qH,dot:C$e,equals:O$e,exactEquals:R$e,floor:_$e,inverse:I$e,len:V$e,length:WH,lerp:JH,max:S$e,min:b$e,mul:N$e,multiply:GH,negate:T$e,normalize:E$e,random:P$e,round:x$e,scale:$$e,scaleAndAdd:M$e,set:g$e,sqrDist:j$e,sqrLen:U$e,squaredDistance:HH,squaredLength:ZH,str:A$e,sub:F$e,subtract:UH,transformMat4:k$e,transformQuat:L$e},Symbol.toStringTag,{value:"Module"}));function ox(){return[0,0,0,0]}function G$e(t){return[t[0],t[1],t[2],t[3]]}function Td(t,e,r,i){return[t,e,r,i]}function q$e(t,e,r,i){return[t,e,r,i]}function B$e(t,e=ox()){const r=Math.min(4,t.length);for(let i=0;i<r;++i)e[i]=t[i];return e}function YH(){return ox()}function XH(){return Td(1,1,1,1)}function KH(){return Td(1,0,0,0)}function QH(){return Td(0,1,0,0)}function eW(){return Td(0,0,1,0)}function tW(){return Td(0,0,0,1)}const H$e=YH(),W$e=XH(),Z$e=KH(),J$e=QH(),Y$e=eW(),X$e=tW();Object.freeze(Object.defineProperty({__proto__:null,ONES:W$e,UNIT_W:X$e,UNIT_X:Z$e,UNIT_Y:J$e,UNIT_Z:Y$e,ZEROS:H$e,clone:G$e,create:ox,freeze:q$e,fromArray:B$e,fromValues:Td,ones:XH,unitW:tW,unitX:KH,unitY:QH,unitZ:eW,zeros:YH},Symbol.toStringTag,{value:"Module"}));const vL=2.4;function K$e(t){return Ke(t*vL)}function Q$e(t){return Pe(t)/vL}function eMe(t,e,r,i){let{color:s,ratio:n}=e,{color:o,ratio:a}=r;a===n&&(a===1?n-=1e-6:a+=1e-6);const l=Qr((i-n)/(a-n),0,1);JH(t,s.toArray(),o.toArray(),l)}function N8e(t){const r=new Uint8ClampedArray(2048);if(t=t.filter(({ratio:a})=>a>=0&&a<=1).sort((a,l)=>a.ratio-l.ratio).map(({color:a,ratio:l})=>({color:a,ratio:Math.max(l,.001)})),t.length<1)return r;let i=t[0],s=t[0],n=1;const o=ox();for(let a=0;a<512;a++){const l=(a+.5)/512;for(;l>s.ratio&&n<t.length;)i=s,s=t[n++];eMe(o,i,s,l),r.set(o,4*a)}return r}function D8e(t,e,r){const i=Math.sqrt(t**2+e**2)/r;return i>1?0:3/(Math.PI*r**2)*(1-i**2)**2}function z8e(t){return typeof t=="function"?t:t?e=>+e[t]:()=>1}var eC;function xD(t){if(t!=null){const{maxDensity:e,minDensity:r,radius:i}=t;if(e!=null||r!=null||i!=null){const{blurRadius:s,maxPixelIntensity:n,minPixelIntensity:o,...a}=t;return a}}return t}let $r=eC=class extends Os{constructor(t){super(t),this.authoringInfo=null,this.colorStops=[new vl({ratio:0,color:new K("rgba(255, 140, 0, 0)")}),new vl({ratio:.75,color:new K("rgba(255, 140, 0, 1)")}),new vl({ratio:.9,color:new K("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(t){return xD(t)}get blurRadius(){return Q$e(this.radius)}set blurRadius(t){const e=this.maxPixelIntensity,r=this.minPixelIntensity;this._set("radius",K$e(t)),this._set("maxDensity",e*this._pixelIntensityToDensity),this._set("minDensity",r*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(t){this._set("maxDensity",t*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(t){this._set("minDensity",t*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(vL**2*this.blurRadius**4)}read(t,e){t=xD(t),super.read(t,e)}getSymbol(){return new Pt}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}async collectRequiredFields(t,e){const r=this.field,i=this.valueExpression;r&&typeof r=="string"&&Mi(t,e,r),i&&typeof i=="string"&&await ei(t,e,null,i)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new eC({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:O(this.colorStops),field:this.field,legendOptions:O(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};u([h({type:It,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],$r.prototype,"authoringInfo",void 0),u([h({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],$r.prototype,"blurRadius",null),u([h({type:[vl],json:{write:{isRequired:!0}}})],$r.prototype,"colorStops",void 0),u([h({type:String,json:{write:!0}})],$r.prototype,"field",void 0),u([h({type:Gp,json:{write:!0}})],$r.prototype,"legendOptions",void 0),u([h({type:Number,json:{write:!0}})],$r.prototype,"maxDensity",void 0),u([h({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],$r.prototype,"maxPixelIntensity",null),u([h({type:Number,json:{write:!0}})],$r.prototype,"minDensity",void 0),u([h({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],$r.prototype,"minPixelIntensity",null),u([h({type:Number,cast:ze,json:{write:!0}})],$r.prototype,"radius",void 0),u([h({type:Number,range:{min:0},json:{default:0,write:!0}})],$r.prototype,"referenceScale",void 0),u([ye({heatmap:"heatmap"})],$r.prototype,"type",void 0),u([h({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],$r.prototype,"valueExpression",void 0),u([h({type:String})],$r.prototype,"valueExpressionTitle",void 0),u([h({readOnly:!0})],$r.prototype,"_pixelIntensityToDensity",null),$r=eC=u([E("esri.renderers.HeatmapRenderer")],$r);let Mh=class extends Ie(W){constructor(){super(...arguments),this.color=new K([0,0,0,0]),this.label=null,this.threshold=0}};u([h({type:K,json:{write:!0}})],Mh.prototype,"color",void 0),u([h({type:String,json:{write:!0}})],Mh.prototype,"label",void 0),u([h({type:Number,range:{min:0,max:1},json:{write:!0}})],Mh.prototype,"threshold",void 0),Mh=u([E("esri.renderers.support.OthersCategory")],Mh);const tMe={base:hi,key:"type",typeMap:{size:Ge,opacity:dl}};let Qi=class extends sy(Ie(Os)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new K([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new Mh,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart",this.visualVariables=null}getSymbol(){return new Pt({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(fr)}getAttributeHash(){return this.visualVariables?.reduce((e,r)=>e+r.getAttributeHash(),"")??""}getMeshHash(){return this.symbols.reduce((e,r)=>e+JSON.stringify(r),"")}async collectRequiredFields(e,r){await this.collectVVRequiredFields(e,r);for(const i of this.attributes)i.valueExpression&&await ei(e,r,null,i.valueExpression),i.field&&e.add(i.field)}};u([h({type:[VH],json:{write:!0}})],Qi.prototype,"attributes",void 0),u([h(sL)],Qi.prototype,"backgroundFillSymbol",void 0),u([h({type:K,json:{write:!0}})],Qi.prototype,"defaultColor",void 0),u([h({type:String,json:{write:!0}})],Qi.prototype,"defaultLabel",void 0),u([h({type:Number,range:{min:0,max:1},json:{write:!0}})],Qi.prototype,"holePercentage",void 0),u([h({type:Mh,json:{write:!0}})],Qi.prototype,"othersCategory",void 0),u([h({type:nL,json:{write:!0}})],Qi.prototype,"legendOptions",void 0),u([h({type:Ot,json:{default:null,write:!0}})],Qi.prototype,"outline",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],Qi.prototype,"size",void 0),u([ye({pieChart:"pie-chart"})],Qi.prototype,"type",void 0),u([h({types:[tMe]})],Qi.prototype,"visualVariables",void 0),Qi=u([E("esri.renderers.PieChartRenderer")],Qi);const tw={key:"type",base:Os,typeMap:{heatmap:$r,simple:Vi,"unique-value":mt,"class-breaks":sr,"dot-density":Ki,dictionary:On,"pie-chart":Qi},errorContext:"renderer"},rMe={key:"type",base:Os,typeMap:{simple:Vi,"unique-value":mt,"class-breaks":sr,heatmap:$r},errorContext:"renderer",validate:iMe};function iMe(t){switch(t.type){case"simple":return sMe(t);case"unique-value":return nMe(t);case"class-breaks":return oMe(t);case"heatmap":return t}}function sMe(t){if(t.symbol)return t;U.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function nMe(t){const e=t.uniqueValueInfos,r=e?.filter(({symbol:i,label:s},n)=>(i||U.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${n}] ${s}) without a symbol from web scene.`),!!i));return r?.length!==e?.length&&(t.uniqueValueInfos=r),t}function oMe(t){const e=t.classBreakInfos,r=e?.filter(({symbol:i,label:s},n)=>(i||U.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${n}] ${s}) without a symbol from web scene.`),!!i));return r?.length!==e?.length&&(t.classBreakInfos=r),t}function aMe(t,e){return cv(t,null,e)}const lMe=Gm({types:tw});function cv(t,e,r){return t?t&&(t.styleName||t.styleUrl)&&t.type!=="uniqueValue"?(r?.messages&&r.messages.push(new zs("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:r})),null):lMe(t,e,r):null}var tC;let Wr=tC=class extends Yu{constructor(t){super(t),this.type="binning",this.binType="geohash",this.fixedBinLevel=null,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.size=ze("12px"),this.fields=[],this.renderer=null}writeFields(t,e,r){const i=t.filter(s=>s.statisticType!=="avg_angle").map(s=>s.toJSON());Ir(r,i,e)}readRenderer(t,e,r){const i=e.drawingInfo?.renderer;return i?cv(i,e,r)??void 0:lL(e,r)}clone(){return new tC({fields:O(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:O(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:O(this.popupTemplate),renderer:O(this.renderer),binType:O(this.binType),size:this.size})}};u([ye({binning:"binning"})],Wr.prototype,"type",void 0),u([ye({geohash:"geohash",square:"square"}),h({type:["geohash","square"]})],Wr.prototype,"binType",void 0),u([h({type:Number,json:{write:!0}})],Wr.prototype,"fixedBinLevel",void 0),u([h({type:[bt],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Wr.prototype,"labelingInfo",void 0),u([h(K2)],Wr.prototype,"labelsVisible",void 0),u([h({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Wr.prototype,"maxScale",void 0),u([h(X2)],Wr.prototype,"popupEnabled",void 0),u([h({type:_a,json:{name:"popupInfo",write:!0}})],Wr.prototype,"popupTemplate",void 0),u([h({cast:t=>t==="auto"?t:zi(ze(t))})],Wr.prototype,"size",void 0),u([h({type:[mi],json:{write:!0}})],Wr.prototype,"fields",void 0),u([te("fields")],Wr.prototype,"writeFields",null),u([h({types:tw,json:{write:{target:"drawingInfo.renderer"}}})],Wr.prototype,"renderer",void 0),u([X("renderer",["drawingInfo.renderer"])],Wr.prototype,"readRenderer",null),Wr=tC=u([E("esri.layers.support.FeatureReductionBinning")],Wr);var rC;function $D(t){return t.type==="simple"&&!t.visualVariables?.length}let nr=rC=class extends W{constructor(t){super(t),this.type="cluster",this.clusterRadius=ze("80px"),this.clusterMinSize=ze("12px"),this.clusterMaxSize=ze("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(t,e,r){const i=e.drawingInfo?.renderer;return i?.authoringInfo?.isAutoGenerated?null:i?$D(i)?null:cv(i,e,r)??void 0:lL(e,r)}readSymbol(t,e,r){const i=e.drawingInfo?.renderer;return i?.authoringInfo?.isAutoGenerated?null:i&&$D(i)?cv(i,e,r)?.symbol:null}writeSymbol(t,e,r,i){const s=this.renderer?.authoringInfo?.isAutoGenerated;if(!this.renderer||s){const n=new Vi({symbol:t});e.drawingInfo={renderer:n.write({},i)}}}writeFields(t,e,r){const i=t.filter(s=>s.statisticType!=="avg_angle").map(s=>s.toJSON());Ir(r,i,e)}readFields(t,e,r){return t.filter(i=>!i.isAutoGenerated).map(i=>mi.fromJSON(i))}clone(){return new rC({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:O(this.labelingInfo),labelsVisible:this.labelsVisible,fields:O(this.fields),maxScale:this.maxScale,renderer:O(this.renderer),symbol:O(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:O(this.popupTemplate)})}};u([h({type:["cluster"],readOnly:!0,json:{write:!0}})],nr.prototype,"type",void 0),u([h({cast:t=>t==="auto"?t:zi(ze(t)),json:{write:!0}})],nr.prototype,"clusterRadius",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],nr.prototype,"clusterMinSize",void 0),u([h({type:Number,cast:ze,json:{write:!0}})],nr.prototype,"clusterMaxSize",void 0),u([h({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],nr.prototype,"maxScale",void 0),u([h(X2)],nr.prototype,"popupEnabled",void 0),u([h({type:_a,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],nr.prototype,"popupTemplate",void 0),u([h({types:tw,json:{write:{target:"drawingInfo.renderer"}}})],nr.prototype,"renderer",void 0),u([X("renderer",["drawingInfo.renderer"])],nr.prototype,"readRenderer",null),u([h({types:Cpe})],nr.prototype,"symbol",void 0),u([X("symbol",["drawingInfo.renderer"])],nr.prototype,"readSymbol",null),u([te("symbol")],nr.prototype,"writeSymbol",null),u([h({type:[bt],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],nr.prototype,"labelingInfo",void 0),u([h(K2)],nr.prototype,"labelsVisible",void 0),u([h({type:[mi],json:{write:!0}})],nr.prototype,"fields",void 0),u([te("fields")],nr.prototype,"writeFields",null),u([X("fields")],nr.prototype,"readFields",null),nr=rC=u([E("esri.layers.support.FeatureReductionCluster")],nr);var iC;let I0=iC=class extends Yu{constructor(t){super(t),this.type="selection"}clone(){return new iC}};u([h({type:["selection"]})],I0.prototype,"type",void 0),I0=iC=u([E("esri.layers.support.FeatureReductionSelection")],I0);const MD={key:"type",base:Yu,typeMap:{cluster:nr,binning:Wr}},uMe={types:{key:"type",base:Yu,typeMap:{selection:I0,cluster:nr,binning:Wr}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:MD},"portal-item":{types:MD},"web-scene":{types:{key:"type",base:Yu,typeMap:{selection:I0}},name:"layerDefinition.featureReduction",write:{allowNull:!0,layerContainerTypes:pt}}}}},cMe=()=>U.getLogger("esri.views.2d.layers.support.clusterUtils");z.add("esri-cluster-arcade-enabled",!0);const hMe=z("esri-cluster-arcade-enabled"),dMe=new Set(["simple-line","simple-fill","picture-fill"]);function TD(t,e){let r=e.clone();if(!pMe(r))return r;if(e.symbols.some(i=>dMe.has(i.type))&&(r=new Vi({symbol:new Pt})),r.authoringInfo||(r.authoringInfo=new It),r.authoringInfo.isAutoGenerated=!0,"visualVariables"in r){const i=(r.visualVariables||[]).filter(s=>s.valueExpression!=="$view.scale");i.forEach(s=>{s.type==="rotation"?s.field?s.field=Rc(t,s.field,"avg_angle","number"):s.valueExpression&&(s.field=Uy(t,s.valueExpression,"avg_angle","number"),s.valueExpression=null):s.normalizationField?(s.field=Rc(t,s.field,"avg_norm","number",s.normalizationField),s.normalizationField=null):s.field?s.field=Rc(t,s.field,"avg","number"):s.valueExpression&&(s.field=Uy(t,s.valueExpression,"avg","number"),s.valueExpression=null)}),r.visualVariables=i}switch(r.type){case"simple":break;case"pie-chart":for(const i of r.attributes)i.field?i.field=Rc(t,i.field,"sum","number"):i.valueExpression&&(i.field=Uy(t,i.valueExpression,"sum","number"),i.valueExpression=null);break;case"unique-value":r.field?r.field=Rc(t,r.field,"mode","string"):r.valueExpression&&(r.field=Uy(t,r.valueExpression,"mode","string"),r.valueExpression=null);break;case"class-breaks":r.normalizationField?(r.field=Rc(t,r.field,"avg_norm","number",r.normalizationField),r.normalizationField=null):r.field?r.field=Rc(t,r.field,"avg","number"):r.valueExpression&&(r.field=Uy(t,r.valueExpression,"avg","number"),r.valueExpression=null)}return r}const pMe=t=>{const e=r=>cMe().error(new R("Unsupported-renderer",r,{renderer:t}));if(!t)return!1;switch(t.type){case"unique-value":if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(t.normalizationField){const r=t.normalizationType;if(r!=="field")return e(`FeatureReductionCluster does not support a normalizationType of ${r}`),!1}break;case"simple":case"pie-chart":break;default:return e(`FeatureReductionCluster does not support renderers of type ${t.type}`),!1}if(!hMe){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some(r=>!(!("valueExpression"in r)||!r.valueExpression)))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function fMe(t,e,r){switch(t){case"sum":return`cluster_sum_${e}`;case"avg":case"avg_angle":return`cluster_avg_${e}`;case"mode":return`cluster_type_${e}`;case"avg_norm":{const i=r,s="field",n=e.toLowerCase()+",norm:"+s+","+i.toLowerCase();return"cluster_avg_"+UP(n)}}}function Uy(t,e,r,i){const s=UP(e),n=r==="mode"?`cluster_type_${s}`:r==="sum"?`cluster_sum_${s}`:`cluster_avg_${s}`;return t.some(o=>o.name===n)||t.push(new mi({name:n,isAutoGenerated:!0,onStatisticExpression:new Au({expression:e,returnType:i}),statisticType:r})),n}function Rc(t,e,r,i,s){if(e==="cluster_count"||t.some(o=>o.name===e))return e;const n=fMe(r,e,s);return t.some(o=>o.name===n)||(r==="avg_norm"?t.push(new mi({name:n,isAutoGenerated:!0,onStatisticExpression:new Au({expression:`$feature.${e} / $feature.${s}`,returnType:i}),statisticType:"avg"})):t.push(new mi({name:n,isAutoGenerated:!0,onStatisticField:e,statisticType:r}))),n}const mMe=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.aggregateGraphicOrigin=new axe(this),this.addHandles(ie(()=>this.renderer,()=>{if(this.featureReduction){const s=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",s)}},wa))}set featureReduction(i){const s=this._normalizeFeatureReduction(i);this._set("featureReduction",s)}set renderer(i){}_withClusterVariable(i,s,n){const o=i.clone();return"visualVariables"in o&&(o.visualVariables||(o.visualVariables=[]),o.visualVariables.some(a=>a.type==="size")||o.visualVariables.push(new Ge({field:"cluster_count",stops:[new qn({value:1}),new qn({useMinValue:!0,size:s}),new qn({useMaxValue:!0,size:n})]}))),o}_normalizeFeatureReduction(i){if(i?.type!=="cluster")return i;const s=i.clone(),n=[new mi({name:"cluster_count",alias:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],o=(s.fields??[]).filter(m=>!m.isAutoGenerated),a=i.renderer&&!i.renderer.authoringInfo?.isAutoGenerated,{clusterMinSize:l,clusterMaxSize:c}=s;if(a){s.fields=[...n,...o];const m=this._withClusterVariable(s.renderer,l,c);return s.effectiveFeatureRenderer=m,s.effectiveClusterRenderer=m,s}if(i.symbol){if(s.fields=[...n,...o],s.renderer=null,!this.renderer)return s.effectiveFeatureRenderer=null,s.effectiveClusterRenderer=null,s;const m=TD(n,this.renderer),y=this._withClusterVariable(m,l,c),g="visualVariables"in y&&y.visualVariables?y.visualVariables:[],v=new Vi({symbol:i.symbol,visualVariables:g});return s.fields=[...n,...o],s.effectiveFeatureRenderer=y,s.effectiveClusterRenderer=v,s}if(!this.renderer)return i;const d=TD(n,this.renderer);s.fields=[...n,...o],s.renderer=d;const p=this._withClusterVariable(d,l,c);return s.effectiveFeatureRenderer=p,s.effectiveClusterRenderer=p,s}};return u([h({readOnly:!0,clonable:!1})],r.prototype,"aggregateGraphicOrigin",void 0),u([h(uMe)],r.prototype,"featureReduction",null),r=u([E("esri.layers.mixins.FeatureReductionLayer")],r),r},ID={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,ArcGISVideoLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,ParquetLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},ED={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},CD={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},yMe={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GaussianSplatLayer:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,Object3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,ViewshedLayer:!0,Voxel:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap-base-layers":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap-ground-layers":{IntegratedMesh3DTilesLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":ID,"web-map/basemap-base-layers":ED,"web-map/tables":CD,"link-chart/operational-layers":{...ID,LinkChartLayer:!0},"link-chart/basemap-base-layers":ED,"link-chart/tables":CD,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0,WCS:!0},"portal-item/tables":{ArcGISFeatureLayer:!0,SubtypeGroupTable:!0}},gMe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(i,s,n){return n?.portalItem?.type==="Group Layer"?void 0:i}writeListMode(i,s,n,o){(o&&o.layerContainerType==="ground"||i&&dee(this,n,{},o))&&(s[n]=i)}writeOperationalLayerType(i,s,n){i&&(s[n]=i)}writeTitle(i,s){s.title=i??"Layer"}readVisibilityTimeExtent(i){return i?ar.fromArray(i):null}writeVisibilityTimeExtent(i,s,n,o){i&&o.layerContainerType!=="tables"&&(i.isEmpty?o?.messages&&o.messages.push(new R("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):s[n]=i.toArray())}read(i,s){s&&(s.layer=this),uee(this,i,n=>super.read(i,n),s)}write(i,s){if(!this.persistenceEnabled&&!s?.ignorePersistenceEnabled)return null;if(s?.origin){const a=`${s.origin}/${s.layerContainerType||"operational-layers"}`;let c=!!yMe[a]?.[this.operationalLayerType];if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&a==="web-scene/operational-layers"&&(c=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&a==="web-map/operational-layers"&&(c=!1),!c)return s.messages?.push(new R("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${a}'`,{layer:this})),null}const n=super.write(i,{...s,layer:this}),o=!!s&&!!s.messages&&!!s.messages.filter(a=>a instanceof R&&a.name==="web-document-write:property-required").length;return Om(n?.url)?(s?.messages?.push(new R("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&o?null:n}beforeSave(){}};return u([h({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],r.prototype,"id",void 0),u([X("id",["id"])],r.prototype,"readId",null),u([h(NB)],r.prototype,"listMode",void 0),u([te("listMode")],r.prototype,"writeListMode",null),u([h({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:pt,isRequired:!0}}}}})],r.prototype,"operationalLayerType",void 0),u([te("operationalLayerType")],r.prototype,"writeOperationalLayerType",null),u([h(gE)],r.prototype,"opacity",void 0),u([h({type:Boolean,readOnly:!1})],r.prototype,"persistenceEnabled",void 0),u([h({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],r.prototype,"title",void 0),u([te("title"),te(["web-scene"],"title")],r.prototype,"writeTitle",null),u([h({type:ar,json:{origins:{"web-scene":{write:{layerContainerTypes:pt}}}}})],r.prototype,"visibilityTimeExtent",void 0),u([X("visibilityTimeExtent")],r.prototype,"readVisibilityTimeExtent",null),u([te(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[Ue,XS]]}})],r.prototype,"writeVisibilityTimeExtent",null),u([h({type:Boolean,json:{name:"visibility",write:{layerContainerTypes:pt}}})],r.prototype,"visible",void 0),r=u([E("esri.layers.mixins.OperationalLayer")],r),r};var sC;const n_=new Ne({asc:"ascending",desc:"descending"});var lm;let Th=(lm=class extends W{constructor(e){super(e),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new sC({field:this.field,valueExpression:this.valueExpression,order:this.order})}},sC=lm,lm);u([h({type:String,json:{write:!0}})],Th.prototype,"field",void 0),u([h({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],Th.prototype,"valueExpression",void 0),u([h({type:n_.apiValues,json:{type:n_.jsonValues,read:n_.read,write:n_.write}})],Th.prototype,"order",void 0),Th=sC=u([E("esri.layers.support.OrderByInfo")],Th);function vMe(t,e,r){if(!t)return null;const i=t.find(n=>!!n.field);if(!i)return null;const s=new Th;return s.read(i,r),[s]}function wMe(t,e,r,i){const s=t.find(n=>!!n.field);s&&Ir(r,[s.toJSON()],e)}const _Me={type:[Th],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:vMe},write:{writer:wMe}}},bMe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.orderBy=null}};return u([h(_Me)],r.prototype,"orderBy",void 0),r=u([E("esri.layers.mixins.OrderedLayer")],r),r},SMe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=xt(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(i){i!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",i))}readPortalItem(i,s,n){if(s.itemId)return new Me({id:s.itemId,portal:n?.portal})}writePortalItem(i,s){i?.id&&(s.itemId=i.id)}async loadFromPortal(i,s){if(this.portalItem?.id)try{const{load:n}=await q(()=>import("./layersLoader-CNXVnAMW.js"),__vite__mapDeps([292,7,8,6,293]));return gt(s),await n({instance:this,supportedTypes:i.supportedTypes,validateItem:i.validateItem,supportsData:i.supportsData,layerModuleTypeMap:i.layerModuleTypeMap,populateGroupLayer:i.populateGroupLayer},s)}catch(n){throw Ur(n)||U.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${n}`),n}}async finishLoadEditablePortalLayer(i){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(i).catch(s=>(Po(s),!0)))}async setUserPrivileges(i,s){if(!De.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(s);if(this.url)try{const{features:{edit:n,fullEdit:o},content:{updateItem:a}}=await this._fetchUserPrivileges(i,s);this._set("userHasEditingPrivileges",n),this._set("userHasFullEditingPrivileges",o),this._set("userHasUpdateItemPrivileges",a)}catch(n){Po(n)}}async _fetchUserPrivileges(i,s){let n=this.portalItem;if(!i||!n||!n.loaded||n.sourceUrl)return this._fetchFallbackUserPrivileges(s);const o=!Fe?.findCredential(this.url),a=i===n.id;if(a&&n.portal.user)return this._getUserPrivileges(n,o);let l,c;if(a)l=n.portal.url;else try{l=await zP(this.url,s)}catch(y){Po(y)}if(!l||!dX(l,n.portal.url))return this._fetchFallbackUserPrivileges(s);try{const y=s!=null?s.signal:null;c=await Fe?.getCredential(`${l}/sharing`,{prompt:!1,signal:y})}catch(y){Po(y)}const d=!0,p=!1,m=!1;if(!c)return{features:{edit:d,fullEdit:p},content:{updateItem:m}};try{if(a?await n.reload():(n=new Me({id:i,portal:{url:l}}),await n.load(s)),n.portal.user)return this._getUserPrivileges(n,o)}catch(y){Po(y)}return{features:{edit:d,fullEdit:p},content:{updateItem:m}}}_getUserPrivileges(i,s){const n=nxe(i);return s&&(n.features.edit=!0),n}async _fetchFallbackUserPrivileges(i){let s=!0;try{s=await this._fetchUserHasEditingPrivileges(i)}catch(n){Po(n)}return{features:{edit:s,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(i){const s=this.url?Fe?.findCredential(this.url):null;if(!s)return!0;const n=o_.credential===s?o_.user:await this._fetchEditingUser(i);return o_.credential=s,o_.user=n,n?.privileges==null||n.privileges.includes("features:user:edit")}async _fetchEditingUser(i){const s=this.portalItem?.portal?.user;if(s)return s;const n=Fe?.findServerInfo(this.url??"");if(!n?.owningSystemUrl)return null;const o=`${n.owningSystemUrl}/sharing/rest`,a=J.getDefault();if(a&&a.loaded&&Qn(a.restUrl)===Qn(o))return a.user;const l=`${o}/community/self`,c=i!=null?i.signal:null,d=await QS(Be(l,{authMode:"no-prompt",query:{f:"json"},signal:c}));return d.ok?ot.fromJSON(d.value.data):null}read(i,s){s&&(s.layer=this),super.read(i,s)}write(i,s){const n=s?.portal,o=this.portalItem?.id&&(this.portalItem.portal||J.getDefault());return n&&o&&!Iz(o.restUrl,n.restUrl)?(s.messages&&s.messages.push(new R("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(i,{...s,layer:this})}};return u([h({type:Me})],r.prototype,"portalItem",null),u([X("web-document","portalItem",["itemId"])],r.prototype,"readPortalItem",null),u([te("web-document","portalItem",{itemId:{type:String}})],r.prototype,"writePortalItem",null),u([h({clonable:!1})],r.prototype,"resourceReferences",void 0),u([h({type:Boolean,readOnly:!0})],r.prototype,"userHasEditingPrivileges",void 0),u([h({type:Boolean,readOnly:!0})],r.prototype,"userHasFullEditingPrivileges",void 0),u([h({type:Boolean,readOnly:!0})],r.prototype,"userHasUpdateItemPrivileges",void 0),r=u([E("esri.layers.mixins.PortalLayer")],r),r},o_={credential:null,user:null};let Gg=class extends le{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};u([h()],Gg.prototype,"updating",void 0),u([h()],Gg.prototype,"status",void 0),Gg=u([E("esri.layers.support.PublishingInfo")],Gg);const xMe=Symbol(),$Me=t=>{var s;var e;const r=t;let i=(s=class extends r{constructor(){super(...arguments),this[e]=!0}get publishingInfo(){if(this.destroyed)return null;const n=this._get("publishingInfo");if(n)return n;const o=new Gg;return this._checkPublishingStatus(o),o}_checkPublishingStatus(n){let l=0;const c=async p=>{let m;n.updating=!0;try{m=await this.fetchPublishingStatus()}catch{m="unavailable"}m!=="published"&&m!=="unavailable"||(n.status==="publishing"&&this.refresh(),d.remove()),n.status=m,n.updating=!1,d.removed||(l=setTimeout(c,p,p+125))},d={removed:!1,remove(){this.removed=!0,clearTimeout(l)}};this.when().catch(()=>d.remove()),c(250),this.addHandles(d)}},e=xMe,s);return u([h({readOnly:!0,clonable:!1})],i.prototype,"publishingInfo",null),i=u([E("esri.layers.mixins.PublishableLayer")],i),i},Gu=new se,E0=new WeakMap;function MMe(t){IMe(t)&&Gu.push(new WeakRef(t))}function TMe(t){const e=Gu.find(r=>r.deref()===t);e&&Gu.remove(e)}function IMe(t){return t!=null&&typeof t=="object"&&"refreshInterval"in t&&"refresh"in t}function rW(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:rW(e,t%e):0}let K$=0,a_=0;function EMe(){const t=Date.now();let e=!1;for(const r of Gu){const i=r.deref();i?i.refreshInterval&&t-(E0.get(i)??0)+5>=6e4*i.refreshInterval&&(E0.set(i,t),i.refresh(t)):e=!0}if(e)for(let r=Gu.length-1;r>=0;r--)Gu.at(r).deref()||Gu.removeAt(r)}_6(()=>{const t=Date.now();let e=0;for(const r of Gu){const i=r.deref();i&&(e=rW(Math.round(6e4*i.refreshInterval),e),i.refreshInterval?E0.get(i)||E0.set(i,t):E0.delete(i))}if(e!==a_){if(a_=e,clearInterval(K$),a_===0)return void(K$=0);K$=setInterval(EMe,a_)}},wa);const PD=.1,CMe=t=>{const e=t;let r=class extends e{constructor(...i){super(...i),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=qS(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||MMe(this)},()=>{})}destroy(){TMe(this)}castRefreshInterval(i){return i>=PD?i:i<=0?0:PD}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(i=Date.now()){hm(this._debounceHasDataChanged()).then(s=>{s&&this._set("refreshTimestamp",i),this.emit("refresh",{dataChanged:s})},s=>{U.getLogger(this).error(s),this.emit("refresh",{dataChanged:!1,error:s})})}async hasDataChanged(){return!0}get test(){}};return u([h({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:pt}}}}})],r.prototype,"refreshInterval",void 0),u([He("refreshInterval")],r.prototype,"castRefreshInterval",null),u([h({readOnly:!0})],r.prototype,"refreshTimestamp",void 0),u([h({readOnly:!0})],r.prototype,"refreshParameters",null),r=u([E("esri.layers.mixins.RefreshableLayer")],r),r},PMe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const i={minScale:this.minScale,maxScale:this.maxScale},s=this.parent;s?.effectiveScaleRange!==void 0&&kMe(i,s.effectiveScaleRange);const n=this._get("effectiveScaleRange");return n&&n.minScale===i.minScale&&n.maxScale===i.maxScale?n:i}};return u([h({type:Number,nonNullable:!0,json:{write:!0}})],r.prototype,"minScale",void 0),u([h({type:Number,nonNullable:!0,json:{write:!0}})],r.prototype,"maxScale",void 0),u([h({readOnly:!0})],r.prototype,"effectiveScaleRange",null),r=u([E("esri.layers.mixins.ScaleRangeLayer")],r),r};function kMe(t,e){return t.minScale=t.minScale>0?e.minScale>0?Math.min(t.minScale,e.minScale):t.minScale:e.minScale,t.maxScale=t.maxScale>0?e.maxScale>0?Math.max(t.maxScale,e.maxScale):t.maxScale:e.maxScale,t}const iW=yr()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let wl=class extends Ie(W){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return VV(this.value,this.unit,"milliseconds")}};u([ye(iW,{nonNullable:!0})],wl.prototype,"unit",void 0),u([h({type:Number,json:{write:!0},nonNullable:!0})],wl.prototype,"value",void 0),wl=u([E("esri.time.TimeInterval")],wl);function kD(t,e){return wl.fromJSON({value:t,unit:e})}let Fr=class extends Ie(W){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(e,r){return r.timeExtent&&Array.isArray(r.timeExtent)&&r.timeExtent.length===2?ar.fromArray(r.timeExtent):null}writeFullTimeExtent(e,r){e?.start!=null&&e.end!=null?r.timeExtent=e.toArray():r.timeExtent=null}readInterval(e,r){return r.timeInterval&&r.timeIntervalUnits?kD(r.timeInterval,r.timeIntervalUnits):r.defaultTimeInterval&&r.defaultTimeIntervalUnits?kD(r.defaultTimeInterval,r.defaultTimeIntervalUnits):null}writeInterval(e,r){r.timeInterval=e?.toJSON().value??null,r.timeIntervalUnits=e?.toJSON().unit??null}};u([h({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],Fr.prototype,"cumulative",void 0),u([h({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],Fr.prototype,"endField",void 0),u([h({type:ar,json:{write:{enabled:!0,allowNull:!0}}})],Fr.prototype,"fullTimeExtent",void 0),u([X("fullTimeExtent",["timeExtent"])],Fr.prototype,"readFullTimeExtent",null),u([te("fullTimeExtent")],Fr.prototype,"writeFullTimeExtent",null),u([h({type:Boolean,json:{write:!0}})],Fr.prototype,"hasLiveData",void 0),u([h({type:wl,json:{write:{enabled:!0,allowNull:!0}}})],Fr.prototype,"interval",void 0),u([X("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],Fr.prototype,"readInterval",null),u([te("interval")],Fr.prototype,"writeInterval",null),u([h({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],Fr.prototype,"startField",void 0),u([h(z1("timeReference",!0))],Fr.prototype,"timeZone",void 0),u([h({type:String,json:{write:{enabled:!0,allowNull:!0}}})],Fr.prototype,"trackIdField",void 0),u([h({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],Fr.prototype,"useTime",void 0),u([h({type:[Date],json:{read:!1}})],Fr.prototype,"stops",void 0),Fr=u([E("esri.layers.support.TimeInfo")],Fr);const LMe={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:pt}}},AMe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(i,s){const n=s.timeInfo.exportOptions;if(!n)return null;const o=n.timeOffset,a=iW.fromJSON(n.timeOffsetUnits);return o&&a?new wl({value:o,unit:a}):null}set timeInfo(i){CU(i,this.fieldsIndex),this._set("timeInfo",i)}};return u([h({type:ar,json:{write:!1}})],r.prototype,"timeExtent",void 0),u([h({type:wl})],r.prototype,"timeOffset",void 0),u([X("service","timeOffset",["timeInfo.exportOptions"])],r.prototype,"readOffset",null),u([h({value:null,type:Fr,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],r.prototype,"timeInfo",null),u([h(LMe)],r.prototype,"useViewTime",void 0),r=u([E("esri.layers.mixins.TemporalLayer")],r),r};let RMe=class extends nv{constructor(e){super(),this.type="track",this.trackInfoProvider=e}get id(){return this.trackInfoProvider.id}get[Uv](){return this.trackInfoProvider.trackInfo}},nn=class extends Ie(W){constructor(e){super(e),this.labelingInfo=null,this.labelsVisible=!0,this.renderer=null,this.visible=!0}};u([h({type:[bt],json:{write:!0}})],nn.prototype,"labelingInfo",void 0),u([h(K2)],nn.prototype,"labelsVisible",void 0),u([h({types:tw,json:{write:!0}})],nn.prototype,"renderer",void 0),u([h({type:Boolean,json:{write:!0}})],nn.prototype,"visible",void 0),nn=u([E("esri.layers.support.TrackPartInfo")],nn);let es=class extends Ie(W){constructor(e){super(e),this.enabled=!0,this.fields=[],this.latestObservations=new nn({renderer:new Vi({symbol:yS.clone()})}),this.maxDisplayDuration=null,this.maxDisplayObservationsPerTrack=0,this.popupEnabled=!0,this.popupTemplate=null,this.previousObservations=new nn({renderer:new Vi({symbol:yS.clone()})}),this.trackLines=new nn({renderer:new Vi({symbol:rx.clone()})}),this.timeField="startTimeField"}writeFields(e,r,i){const s=e.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());Ir(i,s,r)}};u([h({type:Boolean,json:{write:!0}})],es.prototype,"enabled",void 0),u([h({type:[mi],json:{write:!0}})],es.prototype,"fields",void 0),u([te("fields")],es.prototype,"writeFields",null),u([h({type:nn,json:{write:!0}})],es.prototype,"latestObservations",void 0),u([h({type:wl,json:{write:!0}})],es.prototype,"maxDisplayDuration",void 0),u([h({type:Number,json:{write:!0}})],es.prototype,"maxDisplayObservationsPerTrack",void 0),u([h(X2)],es.prototype,"popupEnabled",void 0),u([h({type:_a,json:{name:"popupInfo",write:!0}})],es.prototype,"popupTemplate",void 0),u([h({type:nn,json:{write:!0}})],es.prototype,"previousObservations",void 0),u([h({type:nn,json:{write:!0}})],es.prototype,"trackLines",void 0),u([h({type:["timeReceived","startTimeField","endTimeField"],json:{read:!0,write:!0}})],es.prototype,"timeField",void 0),es=u([E("esri.layers.support.TrackInfo")],es);const OMe=t=>{const e=t;let r=class extends e{constructor(){super(...arguments),this.trackGraphicOrigin=new RMe(this),this.trackInfo=null}};return u([h({readOnly:!0,clonable:!1})],r.prototype,"trackGraphicOrigin",void 0),u([h({type:es})],r.prototype,"trackInfo",void 0),r=u([E("esri.layers.mixins.TrackableLayer")],r),r},LD=new Ne({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let Io=class extends Ie(W){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};u([h({json:{write:!0}})],Io.prototype,"name",void 0),u([h({json:{write:!0}})],Io.prototype,"description",void 0),u([h({json:{read:LD.read,write:LD.write}})],Io.prototype,"drawingTool",void 0),u([h({json:{write:!0}})],Io.prototype,"prototype",void 0),u([h({json:{write:!0}})],Io.prototype,"thumbnail",void 0),Io=u([E("esri.layers.support.FeatureTemplate")],Io);let $o=class extends Ie(W){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const r={};for(const i of Object.keys(e))r[i]=O2(e[i]);return r}writeDomains(e,r){const i={};for(const s of Object.keys(e))e[s]&&(i[s]=e[s]?.toJSON());r.domains=i}};u([h({json:{write:!0}})],$o.prototype,"id",void 0),u([h({json:{write:!0}})],$o.prototype,"name",void 0),u([h({json:{write:!0}})],$o.prototype,"domains",void 0),u([X("domains")],$o.prototype,"readDomains",null),u([te("domains")],$o.prototype,"writeDomains",null),u([h({type:[Io],json:{write:!0}})],$o.prototype,"templates",void 0),$o=u([E("esri.layers.support.FeatureType")],$o);let Ru=class extends Ie(W){constructor(e){super(e),this.alias=null,this.name=void 0,this.fieldFormat=null}};u([h({type:String,json:{write:!0}})],Ru.prototype,"alias",void 0),u([h({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],Ru.prototype,"name",void 0),u([h({types:ZU,json:{write:!0}})],Ru.prototype,"fieldFormat",void 0),Ru=u([E("esri.layers.support.FieldConfiguration")],Ru);function FMe(t){const{popupTemplate:e,fieldsIndex:r}=t,i=e?.fieldInfos;if(!i?.length||!r)return;const s=[];for(const n of i){const{fieldName:o,label:a}=n,l=r.get(o);if(!l)continue;const c=a&&a!==l.alias?a:null,d=_de(n,l);(c||d)&&s.push(new Ru({name:l.name,alias:c,fieldFormat:d}))}return s.length?s:null}function NMe(t){const{fields:e}=t;if(!e?.length)return;const r=[];for(const i of e){const s=Sd(i)?h0(i):null;s&&r.push(new Ru({name:i.name,fieldFormat:s}))}return r.length?r:null}function DMe(t,e){const{popupTemplate:r,fieldsIndex:i}=t;if(!r||!i)return;const s=zMe(t,e,r.fieldInfos);if(!s)return;const n=r.clone();return n.fieldInfos=s,n}function zMe(t,e,r){e??=[],r=O(r)??[];let i=!1;const s=new Map;for(const n of e){const o=t.fieldsIndex.get(n.name);o&&s.set(o.name,n)}for(const n of r){const o=t.fieldsIndex.get(n.fieldName);if(!o)continue;const a=s.get(o.name);n.label=a?.alias||o.alias,n.format=Sd(o)&&a?.fieldFormat?fk(a.fieldFormat,o):null,i=!0,s.delete(o.name)}for(const n of s.values()){const o=jMe(t,n);o&&(r.push(o),i=!0)}return i?r:null}function jMe(t,e){const{name:r,alias:i,fieldFormat:s}=e,n=t.fieldsIndex.get(r);if(!n||!i&&!s)return;const o=i||n.alias,a=Sd(n)&&s?fk(s,n):null;return new k2({fieldName:n.name,label:o,format:a,visible:!1,isEditable:AU(n,t)})}function VMe(){return{fields:{type:[Dr],value:null,set:function(t){if(t&&z("big-integer-warning-enabled")){const e=t.filter(r=>r.type==="big-integer"||r.type==="oid"&&(r.length||0)>=8);if(e.length){const r=e.map(i=>`'${i.name}'`).join(", ");U.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${r}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",t)}},fieldsIndex:{readOnly:!0,get(){return uv.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){const t=this._userOutFields;if(!t?.length)return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const e of t)this.fieldsIndex?.has(e)||U.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${e} found in outFields`,{layer:this,outFields:t});return E2(this.fieldsIndex,t)}}}}const Q$=()=>U.getLogger("esri.layers.support.labelingInfo"),UMe=/\[([^[\]]+)\]/gi;function AD(t,e,r){return t?t.map(i=>{const s=new bt;if(s.read(i,r),s.labelExpression){const n=e.fields||e.layerDefinition?.fields||this.fields;s.labelExpression=s.labelExpression.replaceAll(UMe,(o,a)=>`[${GMe(a,n)}]`)}return s}):null}function GMe(t,e){if(!e)return t;const r=t.toLowerCase();for(let i=0;i<e.length;i++){const s=e[i].name;if(s.toLowerCase()===r)return s}return t}const RD=["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],qMe={esriGeometryPoint:RD,esriGeometryMultiPatch:["always-horizontal"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along","above-along","below-along"],esriGeometryMultipoint:RD,esriGeometryEnvelope:null};function X8e(t,e){const r=[];for(const i of t){const s=i.labelPlacement,n=qMe[e];if(!i.symbol)return Q$().warn("No ILabelClass symbol specified."),[];if(!n)return Q$().error(new R("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${e}' is not supported`)),[];if(n.includes(s))r.push(i);else{const o=n[0];s&&Q$().warn(`Found invalid label placement type ${s} for ${e}. Defaulting to ${o}`);const a=i.clone();a.labelPlacement=o,r.push(a)}}return r}const BMe="relationships/",HMe="expression/",WMe=/<br\s*\/*>/gi;let ki=class extends le{constructor(e){super(e),this._featureUtils=null,this.effectivePopupTemplate=null}get _arcadeTask(){return this.expressionsUsedInTitle.length>0?this._get("_arcadeTask")||Pv(()=>kl()):null}get featureUtilsPromise(){return this._get("featureUtilsPromise")??q(()=>import("./featureUtils-C2ddgZGL.js"),[]).then(e=>this._featureUtils=e)}get calculatedExpressions(){const e=new se;if(!this.expressionsUsedInTitle.length)return e;if(!this._arcadeTask?.value){for(const r of this.expressionsUsedInTitle??[])e.push({name:r.name,invalid:!0});return e}for(const r of this.expressionsUsedInTitle)try{const i=this._arcadeTask.value.arcade.parseScript(r.expression,["$layer","$map","$datastore"]);if(i.isAsync){e.push({name:r.name,invalid:!0});break}e.push({name:r.name,syntax:i,invalid:!1,func:this._arcadeTask.value.arcade.compileScript(i,{vars:{$feature:"any"}})})}catch{e.push({name:r.name,invalid:!0});break}return e}get expressionsUsedInTitle(){let e=this.effectivePopupTemplate?.title??"";return typeof e!="string"?[]:(e=e.toLowerCase(),this.effectivePopupTemplate?.expressionInfos?.filter(r=>e.includes(`{expression/${r.name.toLowerCase()}}`))??[])}get fieldInfoMap(){return this._featureUtils?this._createFieldInfoMap(this._featureUtils.getAllFieldInfos(this.effectivePopupTemplate)):null}get hasBadExpressions(){return this.calculatedExpressions.some(e=>e.invalid===!0)}get requiredFields(){const e=new Set;if(this._arcadeTask?.value&&!this.hasBadExpressions)for(const i of this.calculatedExpressions?.toArray()??[])try{const s=this._arcadeTask.value.arcade.extractFieldLiterals(i.syntax);for(const n of s){const o=n.split("."),a=this.fieldsIndex.get(o.at(-1)??"");a&&e.add(a.name)}}catch{}const r=this._extractFieldNames(this.workingTitle);for(const i of r){const s=this.fieldsIndex.get(i);s&&e.add(s.name)}return this.objectIdField!=null&&e.add(this.objectIdField),e}get titleFromDisplayField(){let e="";return this.displayField&&(e=this.fieldsIndex.get(this.displayField)?.name??""),e||(e=this.fieldsIndex.get(this.objectIdField)?.name??""),e?`{${e}}`:""}get workingTitle(){const e=this.effectivePopupTemplate?this.effectivePopupTemplate.title:"";return e===""||e==null||this.hasBadExpressions||typeof e!="string"?this.titleFromDisplayField:e}async getTitle(e,r,i){const s=r.getObjectId()??r.attributes[e.objectIdField];return(await this.getTitles(e,[r],i)).get(s)??""}async getTitles(e,r,i){const s=new Map,n=i?.timeZone??"system";try{const[{substituteFieldsInLinksAndAttributes:o}]=await Promise.all([this.featureUtilsPromise,this._arcadeTask?.promise]);i?.fetchMissingFields&&(r=await this._checkAndReQueryGraphics(e,r));const{fieldInfoMap:a,workingTitle:l}=this,c=l&&a;r.forEach(d=>{const p=d.getObjectId()??d.attributes[e.objectIdField];let m=c?o({attributes:d.attributes,expressionAttributes:null,fieldInfoMap:a,globalAttributes:this._createFormattedAttributes(e,d,n).global,layer:e,text:l}):"";i?.removeHTML&&(m=Nce.sanitize(m).replaceAll(WMe," ")),s.set(p,m)})}catch{}return s}async _checkAndReQueryGraphics(e,r){const i=r.map(s=>s.getObjectId()??s.attributes[e.objectIdField]).filter(fr);if(i.length!==r.length)return r;if(r.some(s=>!fde(s,this.requiredFields))){const s=e.createQuery();s.where="1=1",s.outFields=[...this.requiredFields],s.objectIds=i;const n=await e.queryFeatures(s);if(n?.features.length===r.length)return n.features}return r}_createFieldInfoMap(e){const r=new Map;if(!e)return r;for(const i of e){if(!i.fieldName)continue;const s=this.fieldsIndex.get(i.fieldName),n=s?.name??i.fieldName;i.fieldName=n,r.set(n.toLowerCase(),i)}return r}_createFormattedAttributes(e,r,i="system"){const s=this.effectivePopupTemplate?.fieldInfos??[],n={};if(!this._featureUtils)return{};if(!this.hasBadExpressions&&this.calculatedExpressions.length>0&&this._arcadeTask?.value){const a=this._arcadeTask.value.Feature.createFromGraphicLikeObject(r.geometry,r.attributes,e,null);for(const l of this.calculatedExpressions)try{n[`expression/${l.name}`]=l.func({vars:{$feature:a}})}catch{}}const o={...r.attributes,...n};return{global:this._featureUtils.formatAttributes({fieldInfos:s,attributes:o,graphic:r,timeZone:i,layer:e,fieldInfoMap:this.fieldInfoMap}),content:[]}}_extractFieldNames(e){return dk(e).filter(r=>!(r.startsWith(BMe)||r.startsWith(HMe)))}};u([h({readOnly:!0})],ki.prototype,"_arcadeTask",null),u([h()],ki.prototype,"_featureUtils",void 0),u([h({readOnly:!0})],ki.prototype,"featureUtilsPromise",null),u([h({readOnly:!0})],ki.prototype,"calculatedExpressions",null),u([h()],ki.prototype,"displayField",void 0),u([h()],ki.prototype,"effectivePopupTemplate",void 0),u([h()],ki.prototype,"expressionsUsedInTitle",null),u([h()],ki.prototype,"fieldsIndex",void 0),u([h()],ki.prototype,"fieldInfoMap",null),u([h()],ki.prototype,"fields",void 0),u([h()],ki.prototype,"objectIdField",void 0),u([h()],ki.prototype,"requiredFields",null),ki=u([E("esri.layers.support.TitleCreator")],ki);const qp=[];function ZMe(t,e){if(c1(t.url??""))return!0;const{wkid:r}=e;for(const i of qp){if((t.version??0)>=i[0])return!0;if(typeof i[1]=="function"&&(i[1]=i[1]()),i[1].has(r))return!1}return!0}qp.push([10.91,()=>{const t=new Set([9709,9716,9741,9761,9766]);for(let e=9712;e<=9713;e++)t.add(e);for(let e=9748;e<=9749;e++)t.add(e);for(let e=20904;e<=20932;e++)t.add(e);for(let e=21004;e<=21032;e++)t.add(e);for(let e=21207;e<=21264;e++)t.add(e);for(let e=21307;e<=21364;e++)t.add(e);for(let e=23301;e<=23333;e++)t.add(e);for(let e=102759;e<=102760;e++)t.add(e);for(let e=102934;e<=102955;e++)t.add(e);return t}]),qp.push([10.9,()=>{const t=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let e=9356;e<=9360;e++)t.add(e);for(let e=9404;e<=9407;e++)t.add(e);for(let e=9476;e<=9482;e++)t.add(e);for(let e=9487;e<=9494;e++)t.add(e);for(let e=9697;e<=9699;e++)t.add(e);return t}]),qp.push([10.81,()=>{const t=new Set([9265,9333,103598,103699]);for(let e=9248;e<=9254;e++)t.add(e);for(let e=9271;e<=9273;e++)t.add(e);for(let e=9284;e<=9285;e++)t.add(e);for(let e=21453;e<=21463;e++)t.add(e);return t}]),qp.push([10.8,()=>{const t=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let e=8035;e<=8036;e++)t.add(e);for(let e=8455;e<=8456;e++)t.add(e);for(let e=8518;e<=8529;e++)t.add(e);for(let e=8533;e<=8536;e++)t.add(e);for(let e=8538;e<=8540;e++)t.add(e);for(let e=8677;e<=8679;e++)t.add(e);for(let e=8902;e<=8903;e++)t.add(e);for(let e=8907;e<=8910;e++)t.add(e);for(let e=8949;e<=8951;e++)t.add(e);for(let e=8972;e<=8987;e++)t.add(e);for(let e=9039;e<=9040;e++)t.add(e);for(let e=9068;e<=9069;e++)t.add(e);for(let e=9140;e<=9141;e++)t.add(e);for(let e=9148;e<=9150;e++)t.add(e);for(let e=9153;e<=9159;e++)t.add(e);for(let e=9205;e<=9218;e++)t.add(e);for(let e=9221;e<=9222;e++)t.add(e);for(let e=54098;e<=54101;e++)t.add(e);return t}]),qp.push([10.71,()=>{const t=new Set([6316]);for(let e=8351;e<=8353;e++)t.add(e);for(let e=9294;e<=9297;e++)t.add(e);for(let e=22619;e<=22621;e++)t.add(e);for(let e=103586;e<=103594;e++)t.add(e);return t}]);async function JMe(t,e,r){const i=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(i&&i.type==="unique-value"&&i.styleOrigin){const s=await QS(i.populateFromStyle());if(gt(r),s.ok===!1){const n=s.error;e?.messages&&e.messages.push(new zs("renderer:style-reference",`Failed to create unique value renderer from style reference: ${n.message}`,{error:n,context:e})),t.clear("renderer",e?.origin)}}}function YMe({displayField:t,editFieldsInfo:e,fields:r,objectIdField:i,title:s},n){if(!r)return null;const o=eTe({editFieldsInfo:e,fields:r,objectIdField:i},n);if(!o.length)return null;const a=iTe({titleBase:s,fields:r,displayField:t}),l=rTe();return new _a({title:a,content:l,fieldInfos:o})}const XMe=(t,e)=>e.visibleFieldNames?e.visibleFieldNames.has(t.name):Jhe(t,e);function KMe({fields:t,ignoreFieldTypes:e,sortDisabled:r}){const i=t;return e&&(t=t.filter(s=>!e.includes(s.type))),t===i&&(t=t.slice()),r!==!0&&t.sort(QMe),t}function QMe(t,e){return t.type==="oid"?-1:e.type==="oid"?1:OD(t)?-1:OD(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function eTe(t,e){const r=e?.visibleFieldNames;return KMe({fields:t.fields??[],ignoreFieldTypes:e?.ignoreFieldTypes||sTe,sortDisabled:e?.sortDisabled}).map(i=>new k2({fieldName:i.name,isEditable:AU(i,t),label:i.alias,format:tTe(i),visible:XMe(i,{...t,visibleFieldNames:r})}))}function tTe(t){switch(t.type){case"small-integer":case"integer":return new ha({digitSeparator:!0,places:0});case"single":case"double":return new ha({digitSeparator:!0,places:2});case"string":return yde(t.name)?new ha({digitSeparator:!0,places:0}):void 0;default:return}}function rTe(){return[new Im,new Tm]}function iTe(t){const e=zhe(t),{titleBase:r}=t;return e?`${r}: {${e.trim()}}`:r??""}function OD(t){return(t.name&&t.name.toLowerCase())==="name"?!0:t.alias?.toLowerCase()==="name"}const sTe=["geometry","blob","raster","guid","xml"],Rr="FeatureLayer";function l_(t,e){return new R("layer:unsupported",`Layer (${t.title}, ${t.id}) of type '${t.declaredClass}' ${e}`,{layer:t})}function FD(t){return t&&t instanceof se}const eM=VMe();function tM(t,e,r){const i=!!r?.writeLayerSchema;return{enabled:i,ignoreOrigin:i}}let ce=class extends oxe(mMe(N1e($Me(R1e(I1e(f1e(bMe(AMe(OMe(PMe(CMe(Gbe(gMe(SMe(gB(m1e(Ube(Ie(Et))))))))))))))))))){constructor(...e){super(...e),this.attributeTableTemplate=null,this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.graphicOrigin=new Nbe(this),this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="ArcGISFeatureLayer",this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.resourceInfo=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=ne.WGS84,this.subtypeCode=null,this.supportedSourceTypes=new Set(["Feature Layer","Oriented Imagery Layer","Table","Catalog Layer"]),this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0,this._debouncedSaveOperations=qS(async(r,i,s)=>{const{save:n,saveAs:o}=await q(()=>import("./featureLayerUtils-D0nCDIZI.js"),__vite__mapDeps([294,295,296,293,297,7]));switch(r){case 0:return n(this,i);case 1:return o(this,s,i)}})}destroy(){this.source?.destroy()}normalizeCtorArgs(e,r){return typeof e=="string"?{url:e,...r}:e}load(e){const r=e!=null?e.signal:null;if(this.portalItem?.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(r).then(s=>this.initLayerProperties(s))),Promise.resolve(this);const i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},e).catch(Po).then(async()=>{if(this.url&&this.layerId==null&&/FeatureServer|MapServer\/*$/i.test(this.url)){const s=await this._fetchFirstValidLayerId(r);s!=null&&(this.layerId=s)}if(!this.url&&!this._hasMemorySource())throw new R("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(r))}).then(()=>M2e(this,"load",e));return this.addResolvingPromise(i),Promise.resolve(this)}get _titleCreator(){const e=this._get("_titleCreator");return xt(e),new ki({fieldsIndex:this.fieldsIndex,objectIdField:this.objectIdField,fields:this.fields,displayField:this.displayField,effectivePopupTemplate:this.popupTemplate??this.defaultPopupTemplate})}readCapabilities(e,r){return r=r.layerDefinition||r,pH(r,this.url)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){return!(this.loaded&&!this.capabilities?.operations.supportsEditing)&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(e){this._overrideIfSome("editingEnabled",e)}readEditingEnabled(e,r){return this._readEditingEnabled(r,!1)}readEditingEnabledFromWebMap(e,r,i){return this._readEditingEnabled(r,!0,i)}writeEditingEnabled(e,r){this._writeEditingEnabled(e,r,!1)}writeEditingEnabledToWebMap(e,r,i,s){this._writeEditingEnabled(e,r,!0,s)}get effectiveEditingEnabled(){return E2e(this)}get featureTitleFields(){return[...this._titleCreator.requiredFields]}set fieldConfigurations(e){if(this._hasMemorySource()||(this._override("fieldConfigurations",e),!this.loaded))return;const r=DMe(this,e);r&&this._set("popupTemplate",r)}get fieldConfigurations(){if(!this._hasMemorySource())return this._isOverridden("fieldConfigurations")?this._get("fieldConfigurations"):FMe(this)||null}readIsTable(e,r){return(r=r?.layerDefinition??r).type==="Table"||!r.geometryType}writeIsTable(e,r,i,s){s?.writeLayerSchema&&Ir(i,e?"Table":"Feature Layer",r)}readGlobalIdField(e,r){return rH(r.layerDefinition||r)}readObjectIdField(e,r){return iH(r.layerDefinition||r)}writePopupTemplate(e,r,i,s){e&&(r[i]=e.toJSON({...s,writeFieldFormat:!s?.writeLayerSchema}))}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){t5(e,this.fieldsIndex),this._set("renderer",e)}readRenderer(e,r,i){r=r.layerDefinition||r;const s=r.drawingInfo?.renderer;if(s){const n=cv(s,r,i)??void 0;return n||U.getLogger(this).error("Failed to create renderer",{rendererDefinition:r.drawingInfo.renderer,layer:this,context:i}),n}return lL(r,i)}set source(e){const r=this._get("source");r!==e&&(FD(r)&&this._resetMemorySource(r),FD(e)&&this._initMemorySource(e),this._set("source",e))}castSource(e){return e?Array.isArray(e)||e instanceof se?new tl({layer:this,items:e}):e:null}readSource(e,r){const i=xr.fromJSON(r.featureSet);return new tl({layer:this,items:i?.features??[]})}readTemplates(e,r){const i=r.editFieldsInfo,s=i?.creatorField,n=i?.editorField;return e=e?.map(o=>Io.fromJSON(o)),this._fixTemplates(e,s),this._fixTemplates(e,n),e}readTitle(e,r){const i=r.layerDefinition?.name??r.name,s=r.title||r.layerDefinition?.title;if(i){const n=this.portalItem?.title;if(this.sublayerTitleMode==="item-title")return this.url?HX(this.url,i):i;let o=i;if(!o&&this.url){const a=pc(this.url);a!=null&&(o=a.title)}return o?(this.sublayerTitleMode==="item-title-and-service-name"&&n&&n!==o&&(o=n+" - "+o),KC(o)):void 0}if(this.sublayerTitleMode==="item-title"&&s)return s}readTitleFromWebMap(e,r){return r.title||r.layerDefinition?.name}readTypeIdField(e,r){let i=(r=r.layerDefinition||r).typeIdField;if(i&&r.fields){i=i.toLowerCase();const s=r.fields.find(n=>n.name.toLowerCase()===i);s&&(i=s.name)}return i}readTypes(e,r){e=(r=r.layerDefinition||r).types;const i=r.editFieldsInfo,s=i?.creatorField,n=i?.editorField;return e?.map(o=>(o=$o.fromJSON(o),this._fixTemplates(o.templates,s),this._fixTemplates(o.templates,n),o))}readVisible(e,r){return r.layerDefinition?.defaultVisibility!=null?!!r.layerDefinition.defaultVisibility:r.visibility!=null?!!r.visibility:void 0}async addAttachment(e,r){const i=await o2e(this,e,r,Rr);return this.lastEditsEventDate=new Date,i}async updateAttachment(e,r,i){const s=await a2e(this,e,r,i,Rr);return this.lastEditsEventDate=new Date,s}async applyEdits(e,r){return l2e(this,e,r)}async uploadAssets(e,r){return u2e(this,e,r)}createFieldConfigurations(){return NMe(this)}createPopupTemplate(e){return YMe(this,e)}async createGraphicsSource(e){if(this._hasMemorySource()&&this.source)return this.source.load({signal:e});const{default:r}=await zz(q(()=>import("./FeatureLayerSource-CG5Fldy_.js"),__vite__mapDeps([298,58,63,299,300,101,102,301,302,45,40,303,304,70,68,69,28,31,162,30])),e);return new r({layer:this,supportedSourceTypes:this.supportedSourceTypes}).load({signal:e})}createQuery(){const e=w2e(this);e.dynamicDataSource=this.dynamicDataSource;const r=this.subtypeCode!=null?`${this.subtypeField} = ${this.subtypeCode}`:null,i=$U(this.definitionExpression,r);return e.where=i||"1=1",e}async deleteAttachments(e,r){const i=await c2e(this,e,r,Rr);return this.lastEditsEventDate=new Date,i}async fetchRecomputedExtents(e){return h2e(this,e,Rr)}async getFeatureTitle(e,r){return this._titleCreator.getTitle(this,e,r)}async getFeatureTitles(e,r){return this._titleCreator.getTitles(this,e,r)}getFeatureType(e){return oH(this.types,this.typeIdField,e)}getFieldAlias(e){const r=this.getField(e);if(r)return this.getFieldConfiguration(r.name)?.alias||r.alias}getFieldConfiguration(e){return e=e.toLowerCase(),this.fieldConfigurations?.find(r=>r.name.toLowerCase()===e)}getFieldDomain(e,r){return b2e(this,e,r,this.getField(e)?.domain??null)}async queryAttachments(e,r){return d2e(this,e,r,Rr)}async queryFeatures(e,r){const i=await this.load(),s=await i.source.queryFeatures(fe.from(e)??i.createQuery(),r),n=this.graphicOrigin;if(s?.features)for(const o of s.features)o.layer=o.sourceLayer=i,o.origin=n;return s}async queryObjectIds(e,r){return await p2e(this,e,r,Rr)}async queryFeatureCount(e,r){return f2e(this,e,r,Rr)}async queryExtent(e,r){return m2e(this,e,r,Rr)}async queryRelatedFeatures(e,r){return y2e(this,e,r,Rr)}async queryRelatedFeaturesCount(e,r){return g2e(this,e,r,Rr)}async queryPivot(e,r){const{source:i,capabilities:s}=await this.load();if(!i.queryPivot||!s?.operations?.supportsQueryPivot)throw new R(Rr,"Layer source does not support queryPivot capability");const n=await q(()=>import("./PivotQuery-Cb7xYaTl.js").then(a=>a.P),[]),o=await i.queryPivot(n.default.from(e),r);if(o?.features)for(const a of o.features)a.layer=a.sourceLayer=this;return o}async queryTopFeatures(e,r){const{source:i,capabilities:s}=await this.load();if(!i.queryTopFeatures||!s?.query?.supportsTopFeaturesQuery)throw new R(Rr,"Layer source does not support queryTopFeatures capability");const n=await q(()=>import("./TopFeaturesQuery-CRGt4fg3.js"),[]),o=await i.queryTopFeatures(n.default.from(e),r);if(o?.features)for(const a of o.features)a.layer=a.sourceLayer=this;return o}async queryAttributeBins(e,r){const{source:i,capabilities:s}=await this.load();if(!i.queryAttributeBins)throw new R(Rr,"Layer source does not support queryAttributeBins capability");L2e(e,s,Rr);const n=await q(()=>import("./AttributeBinsQuery-BlTyGnZi.js"),__vite__mapDeps([218,35,42])),o=await i.queryAttributeBins(n.default.from(e),r);if(o.features)for(const a of o.features)a.layer=a.sourceLayer=this;return o}async queryTopObjectIds(e,r){const{source:i,capabilities:s}=await this.load();if(!i.queryTopObjectIds||!s?.query.supportsTopFeaturesQuery)throw new R(Rr,"Layer source does not support queryTopObjectIds capability");const n=await q(()=>import("./TopFeaturesQuery-CRGt4fg3.js"),[]);return(await i.queryTopObjectIds(n.default.from(e),r)).filter(cd)}async queryTopFeaturesExtent(e,r){const{source:i,capabilities:s}=await this.load();if(!i.queryTopExtents||!s?.query?.supportsTopFeaturesQuery)throw new R(Rr,"Layer source does not support queryTopExtents capability");const n=await q(()=>import("./TopFeaturesQuery-CRGt4fg3.js"),[]);return i.queryTopExtents(n.default.from(e),r)}async queryTopFeatureCount(e,r){const{source:i,capabilities:s}=await this.load();if(!i.queryTopCount||!s?.query?.supportsTopFeaturesQuery)throw new R(Rr,"Layer source does not support queryFeatureCount capability");const n=await q(()=>import("./TopFeaturesQuery-CRGt4fg3.js"),[]);return i.queryTopCount(n.default.from(e),r)}read(e,r){const i=e.featureCollection;if((i||e.type==="Feature Collection")&&(this.resourceInfo=e),i){const{layers:s,showLegend:n}=i;s?.length===1&&(super.read(s[0],r),n!=null&&super.read({showLegend:n},r))}super.read(e,r),r&&r.origin==="service"&&(this.revert(["objectIdField","fields","timeInfo","dateFieldsTimeZone"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))}write(e,r){r={...r,origin:r?.origin??void 0,writeLayerSchema:r?.writeLayerSchema??this._hasMemorySource()};const{origin:i,layerContainerType:s,messages:n}=r;if(this.dynamicDataSource)return n?.push(l_(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if((i==="web-map"||i==="web-scene")&&s!=="tables")return n?.push(l_(this,`a table source can only be written to tables, not ${s}`)),null;if(this._hasMemorySource())return n?.push(l_(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&(i==="web-map"||i==="web-scene")&&s==="tables")return n?.push(l_(this,"using a non-table source cannot be written to tables in web maps or web scenes")),null;return super.write(e,r)}clone(){if(this._hasMemorySource())throw new R(Rr,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(e){return!!this.loaded&&(this.source?.type==="memory"||ZMe(this,e))}async save(e){return this._debouncedSaveOperations(0,e)}async saveAs(e,r){return this._debouncedSaveOperations(1,r,e)}_readEditingEnabled(e,r,i){let s=e.layerDefinition?.capabilities;return s?this._hasEditingCapability(s):(s=e.capabilities,r&&i?.origin==="web-map"&&!this._hasMemorySource()&&s?this._hasEditingCapability(s):void 0)}_hasEditingCapability(e){return e.toLowerCase().split(",").map(r=>r.trim()).includes("editing")}_writeEditingEnabled(e,r,i,s){if(!e){const n=this.capabilities?.operations?.supportsSync?"Query,Sync":"Query";Ir("layerDefinition.capabilities",n,r),i&&!s?.writeLayerSchema&&(r.capabilities=n)}}_fetchFirstValidLayerId(e){return Be(this.url??"",{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:e}).then(r=>{const i=r.data;if(i)return this.applyPreferredHost(i),this.findFirstValidLayerId(i)})}async initLayerProperties(e){return this._set("source",e),e.sourceJSON&&(this.sourceJSON=e.sourceJSON,this.read(e.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:this.portalItem?.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),t5(this.renderer,this.fieldsIndex),CU(this.timeInfo,this.fieldsIndex),this._hasMemorySource()&&this.geometryType==="mesh"&&(this.capabilities.query.supportsReturnMesh=!0),JMe(this,{origin:"service"})}async hasDataChanged(){return v2e(this)}async fetchPublishingStatus(){const e=this.source;return e?.fetchPublishingStatus?e.fetchPublishingStatus():"unavailable"}_verifyFields(){const e=this.parsedUrl?.path??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||e.search(/\/FeatureServer\//i)!==-1||this.fields?.some(r=>r.type==="geometry")||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")}_fixTemplates(e,r){e&&e.forEach(i=>{const s=i.prototype?.attributes;s&&r&&delete s[r]})}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new R("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new R("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(e){e.forEach(r=>{r.layer=this,r.sourceLayer=this}),this.addHandles([e.on("after-add",r=>{r.item.layer=this,r.item.sourceLayer=this}),e.on("after-remove",r=>{r.item.layer=null,r.item.sourceLayer=null})],"fl-source")}_resetMemorySource(e){e.forEach(r=>{r.layer=null,r.sourceLayer=null}),this.removeHandles("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}findFirstValidLayerId(e){return Array.isArray(e.layers)&&e.layers.length>0?e.layers[0].id:Array.isArray(e.tables)&&e.tables.length>0?e.tables[0].id:void 0}};u([h({clonable:!1,readOnly:!0})],ce.prototype,"_titleCreator",null),u([h(Q1e)],ce.prototype,"attributeTableTemplate",void 0),u([X("service","capabilities")],ce.prototype,"readCapabilities",null),u([h({json:{origins:{"web-scene":{write:!1}},write:!0}})],ce.prototype,"charts",void 0),u([h({readOnly:!0})],ce.prototype,"createQueryVersion",null),u([h({json:{read:{source:"layerDefinition.copyrightText"}}})],ce.prototype,"copyright",void 0),u([h({json:{read:{source:"layerDefinition.displayField"}}})],ce.prototype,"displayField",void 0),u([h({types:ju,readOnly:!0})],ce.prototype,"defaultSymbol",void 0),u([h({type:Un})],ce.prototype,"dynamicDataSource",void 0),u([h({type:Boolean})],ce.prototype,"editingEnabled",null),u([X(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],ce.prototype,"readEditingEnabled",null),u([X("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],ce.prototype,"readEditingEnabledFromWebMap",null),u([te(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],ce.prototype,"writeEditingEnabled",null),u([te("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],ce.prototype,"writeEditingEnabledToWebMap",null),u([h({readOnly:!0})],ce.prototype,"effectiveEditingEnabled",null),u([h({clonable:!1,readOnly:!0})],ce.prototype,"featureTitleFields",null),u([h({type:[Ru],json:{name:"layerDefinition.fieldConfigurations",write:{overridePolicy(t,e,r){return{enabled:!r?.writeLayerSchema,ignoreOrigin:this.originIdOf(e)===1}}}}})],ce.prototype,"fieldConfigurations",null),u([h({...eM.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:tM}}}}})],ce.prototype,"fields",void 0),u([h(eM.fieldsIndex)],ce.prototype,"fieldsIndex",void 0),u([h({type:Rn,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],ce.prototype,"formTemplate",void 0),u([h({json:{read:{source:"layerDefinition.extent"}}})],ce.prototype,"fullExtent",void 0),u([h({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:tM,writer(t,e,r){const i=t?zE.toJSON(t):null;i&&Ir(r,i,e)}}}},read:{source:"layerDefinition.geometryType",reader:zE.read}}})],ce.prototype,"geometryType",void 0),u([h({readOnly:!0,clonable:!1})],ce.prototype,"graphicOrigin",void 0),u([h({json:{read:{source:"layerDefinition.hasM"}}})],ce.prototype,"hasM",void 0),u([h({json:{read:{source:"layerDefinition.hasZ"}}})],ce.prototype,"hasZ",void 0),u([h(Y1e)],ce.prototype,"id",void 0),u([h({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],ce.prototype,"infoFor3D",void 0),u([h({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],ce.prototype,"isTable",void 0),u([X("service","isTable",["type","geometryType"]),X("isTable",["layerDefinition.type","layerDefinition.geometryType"])],ce.prototype,"readIsTable",null),u([te("web-map","isTable")],ce.prototype,"writeIsTable",null),u([h(K2)],ce.prototype,"labelsVisible",void 0),u([h({type:[bt],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:AD,write:!1}},name:"layerDefinition.drawingInfo.labelingInfo",read:AD,write:{layerContainerTypes:pt}}})],ce.prototype,"labelingInfo",void 0),u([h((()=>{const t=O(J1e);return t.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(e,r,i){Ir(i,p2(e),r)}}},t})())],ce.prototype,"opacity",void 0),u([h(W1e)],ce.prototype,"legendEnabled",void 0),u([h({type:["show","hide"],json:(()=>{const t=O(NB.json);return t.origins["portal-item"]={read:!1,write:!1},t})()})],ce.prototype,"listMode",void 0),u([X("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],ce.prototype,"readGlobalIdField",null),u([h({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:tM}}}}})],ce.prototype,"objectIdField",void 0),u([X("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],ce.prototype,"readObjectIdField",null),u([h({type:["ArcGISFeatureLayer"],json:{write:{target:"layerType",ignoreOrigin:!0,layerContainerTypes:pt}}})],ce.prototype,"operationalLayerType",void 0),u([h(eM.outFields)],ce.prototype,"outFields",void 0),u([h({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],ce.prototype,"path",void 0),u([h(X2)],ce.prototype,"popupEnabled",void 0),u([h({type:_a,json:{name:"popupInfo",write:!0}})],ce.prototype,"popupTemplate",void 0),u([te("popupTemplate")],ce.prototype,"writePopupTemplate",null),u([h({readOnly:!0})],ce.prototype,"defaultPopupTemplate",null),u([h({types:tw,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:rMe,name:"layerDefinition.drawingInfo.renderer",write:{layerContainerTypes:pt,overridePolicy:(t,e,r)=>({ignoreOrigin:r?.writeLayerSchema,layerContainerTypes:pt})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,r)=>({ignoreOrigin:r?.writeLayerSchema,layerContainerTypes:pt})}}})],ce.prototype,"renderer",null),u([X("service","renderer",["drawingInfo.renderer","defaultSymbol"]),X("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],ce.prototype,"readRenderer",null),u([h()],ce.prototype,"resourceInfo",void 0),u([h((()=>{const t=O(B1e);return t.json.origins["portal-item"]={read:!1,write:!1},t})())],ce.prototype,"screenSizePerspectiveEnabled",void 0),u([h({clonable:!1})],ce.prototype,"source",null),u([He("source")],ce.prototype,"castSource",null),u([X("portal-item","source",["featureSet"]),X("web-map","source",["featureSet"])],ce.prototype,"readSource",null),u([h({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],ce.prototype,"spatialReference",void 0),u([h({type:Number})],ce.prototype,"subtypeCode",void 0),u([h({type:[Io]})],ce.prototype,"templates",void 0),u([X("templates",["editFieldsInfo","creatorField","editorField","templates"])],ce.prototype,"readTemplates",null),u([h({type:Fr})],ce.prototype,"timeInfo",void 0),u([h()],ce.prototype,"title",void 0),u([X("service","title",["name"]),X("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],ce.prototype,"readTitle",null),u([X("web-map","title",["layerDefinition.name","title"])],ce.prototype,"readTitleFromWebMap",null),u([h({type:String})],ce.prototype,"sublayerTitleMode",void 0),u([h({json:{read:!1}})],ce.prototype,"type",void 0),u([h({type:String})],ce.prototype,"typeIdField",void 0),u([X("service","typeIdField"),X("typeIdField",["layerDefinition.typeIdField"])],ce.prototype,"readTypeIdField",null),u([h({type:[$o]})],ce.prototype,"types",void 0),u([X("service","types",["types"]),X("types",["layerDefinition.types"])],ce.prototype,"readTypes",null),u([h({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility",layerContainerTypes:pt}}}}})],ce.prototype,"visible",void 0),u([X("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],ce.prototype,"readVisible",null),ce=u([E("esri.layers.FeatureLayer")],ce);const e9e=Object.freeze(Object.defineProperty({__proto__:null,get default(){return ce}},Symbol.toStringTag,{value:"Module"}));function ND(t,e){const r=t.featureReduction;return r&&r.type!=="selection"&&(!("maxScale"in r)||!r.maxScale||r.maxScale<e.scale)?r:null}const hv=-1;let Fn=class extends le{constructor(e){super(e),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=z("mapview-transitions-duration"),this.effects=[]}set effect(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(DD(e))}catch(r){this._transitionTo([]),U.getLogger(this).warn("Invalid Effect",{effect:e,error:r})}}}get final(){return this._final}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(e){this._updateForScale(e)}get transitioning(){return this._to!==null}canTransitionTo(e){try{return this.scale>0&&zD(this._current,DD(e),this.scale)}catch{return!1}}transitionStep(e,r){this._applyTimeTransition(e),this._updateForScale(r)}endTransition(){this._applyTimeTransition(this.duration)}_transitionTo(e){this.scale>0&&zD(this._current,e,this.scale)?(this._final=e,this._to=O(e),nTe(this._current,this._to,this.scale),this._from=O(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?O(this._current[0].effects):[])}_applyTimeTransition(e){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=e;const r=Math.min(1,this._time/this.duration);for(let i=0;i<this._current.length;i++){const s=this._current[i],n=this._from[i],o=this._to[i];s.scale=oTe(n.scale,o.scale,r);for(let a=0;a<s.effects.length;a++){const l=s.effects[a],c=n.effects[a],d=o.effects[a];l.interpolate(c,d,r)}}r===1&&(this._current=this._final,this._set("effects",this._current[0]?O(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(e){if(this._set("scale",e),this._current.length===0)return;const r=this._current,i=this._current.length-1;let s,n,o=1;if(r.length===1||e>=r[0].scale)n=s=r[0].effects;else if(e<=r[i].scale)n=s=r[i].effects;else for(let a=0;a<i;a++){const l=r[a],c=r[a+1];if(l.scale>=e&&c.scale<=e){o=(e-l.scale)/(c.scale-l.scale),s=l.effects,n=c.effects;break}}for(let a=0;a<this.effects.length;a++)this.effects[a].interpolate(s[a],n[a],o)}};function DD(t){const e=Yk(t)||[];return aTe(e)?[{scale:hv,effects:e}]:e}function zD(t,e,r){return!t[0]?.effects||!e[0]?.effects?!0:!((t[0]?.scale===hv||e[0]?.scale===hv)&&(t.length>1||e.length>1)&&r<=0)&&V9(t[0].effects,e[0].effects)}function nTe(t,e,r){const i=t.length>e.length?t:e,s=t.length>e.length?e:t,n=s[s.length-1],o=n?.scale??r,a=n?.effects??[];for(let l=s.length;l<i.length;l++)s.push({scale:o,effects:[...a]});for(let l=0;l<i.length;l++)s[l].scale=s[l].scale===hv?r:s[l].scale,i[l].scale=i[l].scale===hv?r:i[l].scale,U9(s[l].effects,i[l].effects)}function oTe(t,e,r){return t+(e-t)*r}function aTe(t){const e=t[0];return!!e&&"type"in e}u([h()],Fn.prototype,"_to",void 0),u([h()],Fn.prototype,"duration",void 0),u([h({value:""})],Fn.prototype,"effect",null),u([h({readOnly:!0})],Fn.prototype,"effects",void 0),u([h({readOnly:!0})],Fn.prototype,"final",null),u([h({readOnly:!0})],Fn.prototype,"hasEffects",null),u([h({value:0})],Fn.prototype,"scale",null),u([h({readOnly:!0})],Fn.prototype,"transitioning",null),Fn=u([E("esri.layers.effects.EffectView")],Fn);function r9e(t){const e=t.layer;return"floorInfo"in e&&e.floorInfo?.floorField&&"floors"in t.view?sW(t.view.floors,e.floorInfo.floorField):null}function jD(t,e){return"floorInfo"in e&&e.floorInfo?.floorField?sW(t,e.floorInfo.floorField):null}function sW(t,e){if(!t?.length)return null;const r=t.filter(i=>i!=="").map(i=>`'${i}'`);return r.push("''"),`${e} IN (${r.join(",")}) OR ${e} IS NULL`}function i9e(t,e,r){return e.flatten(({sublayers:s})=>s).length!==t.length?!0:!!t.some(s=>s.originIdOf("minScale")>r||s.originIdOf("maxScale")>r||s.originIdOf("renderer")>r||s.originIdOf("labelingInfo")>r||s.originIdOf("opacity")>r||s.originIdOf("labelsVisible")>r||s.originIdOf("source")>r)||!nW(t,e)}function lTe(t,e,r){return!!t.some(i=>{const s=i.source,n=!s||s.type==="map-layer"&&s.mapLayerId===i.id&&(s.gdbVersion==null||s.gdbVersion===r);i.commitProperty("renderer"),i.commitProperty("labelingInfo"),i.commitProperty("opacity"),i.commitProperty("labelsVisible"),i.commitProperty("orderBy");const o=i.layer?.capabilities?.exportMap?.supportsSublayerOrderBy??!1;return!n||i.originIdOf("renderer")>2||i.originIdOf("labelingInfo")>2||i.originIdOf("opacity")>2||i.originIdOf("labelsVisible")>2||o&&i.originIdOf("orderBy")>2})||!nW(t,e)}function nW(t,e){if(!t?.length||e==null)return!0;const r=e.slice().reverse().flatten(({sublayers:n})=>n&&n.toArray().reverse()).map(n=>n.id).toArray();if(t.length>r.length)return!1;let i=0;const s=r.length;for(const{id:n}of t){for(;i<s&&r[i]!==n;)i++;if(i>=s)return!1}return!0}function s9e(t){return!!t&&t.some(e=>e.minScale!=null||e.layerDefinition?.minScale!=null)}const uTe={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let Xs=class extends le{constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map(r=>{const i=jD(this.floors,r);return r.toExportImageJSON(i)});return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&lTe(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.removeHandles("layer"),e&&this.addHandles([e.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),e.on("sublayer-update",r=>this.notifyChange(uTe[r.propertyName]))],"layer"))}get layers(){const e=this.visibleSublayers;return e?e.length?"show:"+e.map(r=>r.id).join(","):"show:-1":null}get layerDefs(){const e=!!this.floors?.length,r=this.visibleSublayers.filter(i=>i.definitionExpression!=null||e&&i.floorInfo!=null);return r.length?JSON.stringify(r.reduce((i,s)=>{const n=jD(this.floors,s),o=$U(n,s.definitionExpression);return o!=null&&(i[s.id]=o),i},{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers");const e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const r=this.layer.sublayers,i=this.scale,s=o=>{o.visible&&(i===0||v1e(i,o.minScale,o.maxScale))&&(o.sublayers?o.sublayers.forEach(s):e.unshift(o))};r?.forEach(s);const n=this._get("visibleSublayers");return!n||n.length!==e.length||n.some((o,a)=>e[a]!==o)?e:n}toJSON(){const e=this.layer;let r={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?r.dynamicLayers=this.dynamicLayers:r={...r,layers:this.layers,layerDefs:this.layerDefs},r}};u([h({readOnly:!0})],Xs.prototype,"dynamicLayers",null),u([h()],Xs.prototype,"floors",void 0),u([h({readOnly:!0})],Xs.prototype,"hasDynamicLayers",null),u([h()],Xs.prototype,"layer",null),u([h({readOnly:!0})],Xs.prototype,"layers",null),u([h({readOnly:!0})],Xs.prototype,"layerDefs",null),u([h({type:Number})],Xs.prototype,"scale",void 0),u([h({readOnly:!0})],Xs.prototype,"version",null),u([h({readOnly:!0})],Xs.prototype,"visibleSublayers",null),Xs=u([E("esri.layers.support.ExportImageParameters")],Xs);const cTe=9999999e31,hTe=2e-7,dTe={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function xS(t){return dTe[t]??[-34028234663852886e22,34028234663852886e22]}const pTe={u1:1,u2:1,u4:1,u8:1,s8:1,u16:2,s16:2,u32:4,s32:4,f32:4,f64:8,unknown:4,c64:16,c128:32};function fTe(t){return pTe[t]}function o9e(t){return fTe(t.pixelType)*t.bandCount}function a9e(t,e){return t==null||e==null?"s32":t<0?t>=-128&&e<128?"s8":t>=-32768&&e<32768?"s16":"s32":e<256?"u8":e<65536?"u16":"u32"}function mTe(t){return(t?.startsWith("s")||t?.startsWith("u"))??!1}function l9e(t,e,r,i){let[s,n]=xS(r);const o=mTe(r);return o&&(s-=1e-5,n+=1e-5),o?r.startsWith("u")?yTe(t,e,i,[s,n]):gTe(t,e,i,[s,n]):vTe(t,e,i,[s,n])}function u9e(t,e){for(let r=0;r<e.length;r++)e[r]&&isNaN(t[r])&&(e[r]=0,t[r]=0)}function yTe(t,e,r,i){const[s,n]=i;for(let o=0;o<e.length;o++)if(e[o]){const a=t[o];a<s||a>n?e[o]=0:r[o]=a+.5|0}}function gTe(t,e,r,i){const[s,n]=i;for(let o=0;o<e.length;o++)if(e[o]){const a=t[o];a<s||a>n?e[o]=0:r[o]=a+(a>0?.5:-.5)|0}}function vTe(t,e,r,i){const[s,n]=i;for(let o=0;o<e.length;o++)if(e[o]){const a=t[o];a<s||a>n?e[o]=0:r[o]=a}}function c9e(t,e,r){if(t.depthCount&&t.depthCount>1)return;const{pixels:i,statistics:s,pixelType:n}=t,o=i[0].length,a=t.bandMasks??[],l=t.mask??new Uint8Array(o).fill(255),c=n==="f32"||n==="f64",d=xS(n);let p=!1;for(let y=0;y<i.length;y++){const g=typeof e=="number"?e:e[y];if(g==null)continue;const v=s?.[y]?.minValue??d[0],w=s?.[y]?.maxValue??d[1];if(v>g+Number.EPSILON||w<g-Number.EPSILON)continue;const _=a[y]||l.slice(),x=i[y],$=r?.customFloatTolerance;if(c&&$!==0){let T=$;T||(T=Math.abs(g)>=cTe?hTe*Math.abs(g):n==="f32"?2**-23:Number.EPSILON);for(let C=0;C<x.length;C++)_[C]&&Math.abs(x[C]-g)<T&&(x[C]=0,_[C]=0,l[C]=0,p=!0)}else for(let T=0;T<x.length;T++)_[T]&&x[T]===g&&(x[T]=0,_[T]=0,l[T]=0,p=!0);a[y]=_}if(p){const y=t.bandMasks||t.pixels.length>1?a:null;r?.matchAllNoData?t.mask=y&&y.length>1?m(y):l:(t.bandMasks=y,t.mask=l)}function m(y){if(y.length<2)return y[0];const g=y[0].length,v=new Uint8Array(g).fill(0);for(let w=0;w<y.length;w++){const _=y[w];for(let x=0;x<g;x++)_[x]&&(v[x]=255)}return v}p&&"updateStatistics"in t&&t.updateStatistics()}function oW(t){return t==null||t.type==="simple"||t.type==="unique-value"||t.type==="class-breaks"||t.type==="dictionary"||t.type==="heatmap"}function h9e(t,e){if(t==null)return null;if(!oW(t))return new R("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${t.type}'`,{renderer:t});switch(t.type){case"simple":return wTe(t,e);case"unique-value":return _Te(t,e);case"class-breaks":return bTe(t,e);case"dictionary":case"heatmap":return null}return null}function wL(t,e){if(!e)return null;if(Array.isArray(e)||(e=[e]),e.length>0){const r=e.map(s=>s.details.symbol.type||s.details.symbol.declaredClass).filter(s=>!!s);r.sort();const i=new Array;return r.forEach((s,n)=>{n!==0&&s===r[n-1]||i.push(s)}),new R("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${i.join(", ")}) which are not supported in 3D`,{renderer:t,symbolErrors:e})}return null}function wTe(t,e){const r={...pl,...e,cimFallbackEnabled:!0};return wL(t,Cm(t.symbol,r).error)}function _Te(t,e){const r={...pl,...e,cimFallbackEnabled:!0},i=t.uniqueValueInfos?.map(n=>Cm(n.symbol,r).error).filter(fr),s=Cm(t.defaultSymbol,r);return s.error&&i?.unshift(s.error),wL(t,i)}function bTe(t,e){const r={...pl,...e,cimFallbackEnabled:!0},i=t.classBreakInfos.map(n=>Cm(n.symbol,r).error).filter(fr),s=Cm(t.defaultSymbol,r);return s.error&&i.unshift(s.error),wL(t,i)}function STe(t){switch(t){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function _L(t){return t?.type==="CIMVectorMarker"?t.markerGraphics?.[0]:void 0}function aW(t){return t?.symbol?.type==="CIMPolygonSymbol"?t.symbol.symbolLayers?.[0]:void 0}function xTe(t,e){t?.type==="CIMVectorMarker"&&e!=null&&(t.size=e)}function $Te(t,e){const r=_L(t);r&&e!=null&&(r.geometry=STe(e))}function MTe(t,e){const r=aW(_L(t));r&&e!=null&&(r.color=e.toArray())}function TTe(t,e,r){const i=aW(_L(t));i&&e!=null&&r&&(i.colorLocked=e)}function bL(t,e){const{outerRingSize:r,innerDotSize:i,type:s,color:n,colorLocked:o,primitiveOverrides:a}=e,l=t.data.symbol?.type==="CIMPolygonSymbol"?t.data.symbol.symbolLayers:null;if(l?.length===2)for(const c of l){const d=c.primitiveName==="reference-size-outer-ring";xTe(c,d?r:i),$Te(c,s),MTe(c,n),TTe(c,o,d)}return r!=null&&i!=null&&(t.data.primitiveOverrides=null),a!==void 0&&(t.data.primitiveOverrides=O(a)),t}function lW(t,e,r,i){if(t)if(t.type!=="CIMTextSymbol"){if(t.effects)for(const s of t.effects)VD(s,e);if(t.symbolLayers)for(const s of t.symbolLayers){switch(s.type){case"CIMPictureMarker":case"CIMVectorMarker":ITe(s,e,i);break;case"CIMPictureStroke":case"CIMSolidStroke":case"CIMGradientStroke":!i?.preserveOutlineWidth&&s.width&&(s.width*=e);break;case"CIMPictureFill":s.height&&(s.height*=e),s.offsetX&&(s.offsetX*=e),s.offsetY&&(s.offsetY*=e);break;case"CIMHatchFill":lW(s.lineSymbol,e,!0,{...i,preserveOutlineWidth:!1}),s.offsetX&&(s.offsetX*=e),s.offsetY&&(s.offsetY*=e),s.separation&&(s.separation*=e)}if(s.effects)for(const n of s.effects)VD(n,e)}}else t.height!=null&&(t.height*=e)}function ITe(t,e,r){if(t&&(t.markerPlacement&&ETe(t.markerPlacement,e),t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.anchorPoint&&t.anchorPointUnits==="Absolute"&&(t.anchorPoint={x:t.anchorPoint.x*e,y:t.anchorPoint.y*e}),t.size=t.size!=null?t.size*e:0,t.type==="CIMVectorMarker"&&t.markerGraphics))for(const i of t.markerGraphics)t.scaleSymbolsProportionally||lW(i.symbol,e,!0,r)}function ETe(t,e){switch(nx(t)&&t.offset&&(t.offset*=e),t.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.placementTemplate&&t.placementTemplate.length){const r=t.placementTemplate.map(i=>i*e);t.placementTemplate=r}break;case"CIMMarkerPlacementAlongLineVariableSize":if(t.maxRandomOffset&&(t.maxRandomOffset*=e),t.placementTemplate&&t.placementTemplate.length){const r=t.placementTemplate.map(i=>i*e);t.placementTemplate=r}break;case"CIMMarkerPlacementOnLine":t.startPointOffset&&(t.startPointOffset*=e);break;case"CIMMarkerPlacementAtExtremities":t.offsetAlongLine&&(t.offsetAlongLine*=e);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":t.beginPosition&&(t.beginPosition*=e),t.endPosition&&(t.endPosition*=e);break;case"CIMMarkerPlacementPolygonCenter":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMMarkerPlacementInsidePolygon":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.stepX&&(t.stepX*=e),t.stepY&&(t.stepY*=e)}}function VD(t,e){switch(t.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":t.width&&(t.width*=e);break;case"CIMGeometricEffectBuffer":t.size&&(t.size*=e);break;case"CIMGeometricEffectCut":t.beginCut&&(t.beginCut*=e),t.endCut&&(t.endCut*=e),t.middleCut&&(t.middleCut*=e);break;case"CIMGeometricEffectDashes":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.dashTemplate&&t.dashTemplate.length){const r=t.dashTemplate.map(i=>i*e);t.dashTemplate=r}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":t.length&&(t.length*=e);break;case"CIMGeometricEffectMove":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":t.offset&&(t.offset*=e);break;case"CIMGeometricEffectRegularPolygon":t.radius&&(t.radius*=e);break;case"CIMGeometricEffectTaperedPolygon":t.fromWidth&&(t.fromWidth*=e),t.length&&(t.length*=e),t.toWidth&&(t.toWidth*=e);break;case"CIMGeometricEffectWave":t.amplitude&&(t.amplitude*=e),t.period&&(t.period*=e)}}function uW(t){const e=[];return nC(yL(t),e),e.length?new K(OH(e[0])):null}function nC(t,e){if(!t)return;let r;r=t.type==="CIMTextSymbol"?t.symbol:t;const i=t.type==="CIMPolygonSymbol";if(r?.symbolLayers){for(const s of r.symbolLayers)if(!(s.colorLocked||i&&(FH(s)||gL(s)&&s.markerPlacement&&nx(s.markerPlacement))))switch(s.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":s.tintColor&&$S(e,s.tintColor);break;case"CIMVectorMarker":s.markerGraphics?.forEach(n=>{nC(n.symbol,e)});break;case"CIMSolidStroke":case"CIMSolidFill":$S(e,s.color);break;case"CIMGradientFill":CTe(e,s);break;case"CIMHatchFill":nC(s.lineSymbol,e)}}}function $S(t,e){for(const r of t)if(r.join(".")===e.join("."))return;t.push(e)}function CTe(t,e){switch(e.colorRamp?.type){case"CIMMultipartColorRamp":e.colorRamp.colorRamps?.forEach(i=>{i.type==="CIMLinearContinuousColorRamp"&&UD(t,i)});break;case"CIMLinearContinuousColorRamp":case"CIMPolarContinuousColorRamp":UD(t,e.colorRamp)}}function UD(t,e){e&&(e.fromColor&&$S(t,e.fromColor),e.toColor&&$S(t,e.toColor))}function cW(t,e,r){e instanceof K||(e=new K(e));const i=yL(t);i&&oC(i,e)}function oC(t,e,r){if(!t)return;let i;i=t.type==="CIMTextSymbol"?t.symbol:t;const s=i?.type==="CIMPolygonSymbol";if(i?.symbolLayers)for(const n of i.symbolLayers){if(n.colorLocked||s&&(FH(n)||gL(n)&&n.markerPlacement&&nx(n.markerPlacement)))continue;const o=e.toArray();switch(n.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":n.tintColor=o;break;case"CIMVectorMarker":n.markerGraphics?.forEach(a=>{oC(a.symbol,e)});break;case"CIMSolidStroke":case"CIMSolidFill":n.color=o;break;case"CIMGradientFill":PTe(n,e);break;case"CIMHatchFill":oC(n.lineSymbol,e)}}}function PTe(t,e){switch(t.colorRamp?.type){case"CIMMultipartColorRamp":t.colorRamp.colorRamps?.forEach(i=>{i.type==="CIMLinearContinuousColorRamp"&&GD(i,e)});break;case"CIMLinearContinuousColorRamp":case"CIMPolarContinuousColorRamp":GD(t.colorRamp,e)}}function GD(t,e){if(t&&(t.fromColor&&(t.fromColor=e.toArray()),t.toColor)){const r=e.clone();r.a=0,t.toColor=r.toArray()}}function kTe(t,e,r=!1){const i=yL(t);if(r&&(e=360-e),i?.type!=="CIMTextSymbol"){if(i?.type==="CIMPointSymbol"&&i.symbolLayers){const s=e-(i.angle||0);for(const n of i.symbolLayers)if(gL(n)){let o=n.rotation||0;n.rotateClockwise?o-=s:o+=s,n.rotation=o}i.angle=e}}else i.angle=e}function hW(t){return"r"in t&&"g"in t&&"b"in t}function dW(t){return"h"in t&&"s"in t&&"v"in t}function pW(t){return"l"in t&&"a"in t&&"b"in t}function fW(t){return"l"in t&&"c"in t&&"h"in t}function LTe(t){return"x"in t&&"y"in t&&"z"in t}const ATe=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],RTe=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function mW(t,e){const r=[];let i,s;if(t[0].length!==e.length)throw new Error("dimensions do not match");const n=t.length,o=t[0].length;let a=0;for(i=0;i<n;i++){for(a=0,s=0;s<o;s++)a+=t[i][s]*e[s];r.push(a)}return r}function yW(t){const e=[t.r/255,t.g/255,t.b/255].map(i=>i<=.04045?i/12.92:((i+.055)/1.055)**2.4),r=mW(ATe,e);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function SL(t){const e=mW(RTe,[t.x/100,t.y/100,t.z/100]).map(r=>{const i=r<=.0031308?12.92*r:1.055*r**.4166666666666667-.055;return Math.min(1,Math.max(i,0))});return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function gW(t){const e=[t.x/95.047,t.y/100,t.z/108.883].map(r=>r>.008856451679035631?r**.3333333333333333:7.787037037037035*r+.13793103448275862);return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function vW(t){const e=t.l,r=[(e+16)/116+t.a/500,(e+16)/116,(e+16)/116-t.b/200].map(i=>i>6/29?i**3:3*(6/29)**2*(i-4/29));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function OTe(t){const e=t.l,r=t.a,i=t.b,s=Math.sqrt(r*r+i*i);let n=Math.atan2(i,r);return n=n>0?n:n+2*Math.PI,{l:e,c:s,h:n}}function FTe(t){const e=t.l,r=t.c,i=t.h;return{l:e,a:r*Math.cos(i),b:r*Math.sin(i)}}function NTe(t){return gW(yW(t))}function DTe(t){return SL(vW(t))}function zTe(t){return OTe(gW(yW(t)))}function jTe(t){return SL(vW(FTe(t)))}function VTe(t){const e=t.r,r=t.g,i=t.b,s=Math.max(e,r,i),n=s-Math.min(e,r,i);let o=s,a=n===0?0:s===e?(r-i)/n%6:s===r?(i-e)/n+2:(e-r)/n+4,l=n===0?0:n/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}function UTe(t){const e=(t.h+360)%360/60,r=t.s/100,i=t.v/100*255,s=i*r,n=s*(1-Math.abs(e%2-1));let o;switch(Math.floor(e)){case 0:o={r:s,g:n,b:0};break;case 1:o={r:n,g:s,b:0};break;case 2:o={r:0,g:s,b:n};break;case 3:o={r:0,g:n,b:s};break;case 4:o={r:n,g:0,b:s};break;case 5:case 6:o={r:s,g:0,b:n};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+i-s),o.g=Math.round(o.g+i-s),o.b=Math.round(o.b+i-s),o}function Id(t){return hW(t)?t:fW(t)?jTe(t):pW(t)?DTe(t):LTe(t)?SL(t):dW(t)?UTe(t):t}function ax(t){return dW(t)?t:VTe(Id(t))}function GTe(t){return pW(t)?t:NTe(Id(t))}function d9e(t){return fW(t)?t:zTe(Id(t))}function qTe(t){let{r:e,g:r,b:i,a:s}=t;return s<1&&(e=Math.round(s*e+255*(1-s)),r=Math.round(s*r+255*(1-s)),i=Math.round(s*i+255*(1-s))),new K({r:e,g:r,b:i})}function wW(t,e){const{r,g:i,b:s}=e?.ignoreAlpha?t:qTe(t);return .2126*r+.7152*i+.0722*s}function p9e(t,e=225){return wW(t,{ignoreAlpha:!0})>e?new K([0,0,0,t.a]):new K([255,255,255,t.a])}function f9e(t,e){const r=GTe(t);r.l*=1-e;const i=Id(r),s=t.clone();return s.setColor(i),s.a=t.a,s}function m9e(t,e){const r=t.clone();return r.a*=e,r}function y9e(t,e){const r=ax(t);r.s*=e;const i=Id(r),s=t.clone();return s.setColor(i),s.a=t.a,s}function g9e(t){return K.toUnitRGBA(t)}function v9e(t){return Td(t[0],t[1],t[2],t.length>3?t[3]:1)}function w9e(t,e){const r=K.toUnitRGBA(t);return r[3]*=e,r}function _9e(t,e,r={}){if(t.length===0||e<=0)return[];if((t=t.map(i=>typeof i=="string"?new K(i):i)).length===1||e===1){const i=[],s=t[0];for(let n=0;n<e;n++)i.push(s.clone());return i}if(r.shuffle&&(t=iz(O(t),r.seed)),t.length>=e){const i=[],s=(t.length-1)/(e-1);for(let n=0;n<e;n++){const o=Math.round(n*s);i.push(t[o].clone())}return i}return BTe(t,e,r)}function BTe(t,e,r={}){const i=[],s=t.length-1,n=Math.ceil((e-t.length)/s);e:for(let o=0;o<s;o++){const a=t[o],l=t[o+1];for(let c=1;c<=n;c++){const d=c/(n+1);if(i.push(HTe(a,l,d,r)),i.length+t.length===e)break e}}return[...t.map(o=>o.clone()),...iz(i,r.seed??1)]}const rM=(t,e)=>{const r=Math.floor(10*e())-5;return Math.min(255,Math.max(0,t+r))};function HTe(t,e,r,i={}){const s=t.r,n=t.g,o=t.b,a=e.r,l=e.g,c=e.b,d=Math.round(s+(a-s)*r),p=Math.round(n+(l-n)*r),m=Math.round(o+(c-o)*r);if(!i.offset)return new K([d,p,m]);const y=LC(i.seed);return new K([rM(d,y),rM(p,y),rM(m,y)])}const _W="picture-fill",bW="simple-fill",WTe="simple-line",SW="simple-marker",ZTe="text",JTe="cim",qD=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),BD=new wH(1e3);function YTe(t){const e=t.style;let r=null;if(t)switch(t.type){case SW:e!=="cross"&&e!=="x"&&(r=t.color);break;case bW:e&&e!=="solid"?e!=="none"&&(r={type:"pattern",x:0,y:0,src:St(`esri/symbols/patterns/${e}.png`),width:5,height:5}):r=t.color;break;case _W:r={type:"pattern",src:t.url,width:Pe(t.width)*t.xscale,height:Pe(t.height)*t.yscale,x:Pe(t.xoffset),y:Pe(t.yoffset)};break;case ZTe:r=t.color;break;case JTe:r=uW(t)}return r}function XTe(t,e){const r=t+"-"+e,i=BD.get(r);return i!=null?Promise.resolve(i):Be(t,{responseType:"image"}).then(s=>{const n=s.data,o=n.naturalWidth,a=n.naturalHeight,l=document.createElement("canvas");l.width=o,l.height=a;const c=l.getContext("2d");c.fillStyle=e,c.fillRect(0,0,o,a),c.globalCompositeOperation="destination-in",c.drawImage(n,0,0);const d=l.toDataURL();return BD.put(r,d),d})}function dv(t){if(!t)return null;let e=null;switch(t.type){case bW:case _W:case SW:e=dv(t.outline);break;case WTe:{const r=Pe(t.width);t.style!=null&&t.style!=="none"&&r!==0&&(e={color:t.color,style:xL(t.style),width:r,cap:t.cap,join:t.join==="miter"?Pe(t.miterLimit):t.join},e.dashArray=xW(e).join(",")||"none");break}default:e=null}return e}function xW(t){if(!t?.style)return[];const{dashArray:e,style:r,width:i}=t;if(typeof e=="string"&&e!=="none")return e.split(",").map(o=>Number(o));const s=i??0,n=qD.has(r)?qD.get(r).map(o=>o*s):[];if(t.cap!=="butt")for(const[o,a]of n.entries())n[o]=o%2==1?a+s:Math.max(a-s,1);return n}const xL=(()=>{const t={};return e=>{if(t[e])return t[e];const r=e.replaceAll("-","");return t[e]=r,r}})(),KTe=new K([128,128,128]);let QTe=0;function eIe(){return QTe++}let tIe=0;function rIe(){return tIe++}let iIe=0;function sIe(){return iIe++}const nIe="http://www.w3.org/2000/svg",HD=z("android"),oIe=z("chrome")||HD&&HD>=4?"auto":"optimizeLegibility",aIe={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},lIe=/([A-DF-Za-df-z])|([-+]?\d*\.?\d+(?:[eE][-+]?\d+)?)/g;let At={},Xe={};const uIe=Math.PI;function qu(t,e){const r=t*(uIe/180);return Math.abs(e*Math.sin(r))+Math.abs(e*Math.cos(r))}function $W(t){return t.map(e=>`${e.command} ${e.values.join(" ")}`).join(" ").trim()}function $L(t,e,r,i,s){if(t){if(t.type==="circle")return L("circle",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",r:t.r,stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-dashoffset":r.dashOffset,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width});if(t.type==="ellipse")return L("ellipse",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",rx:t.rx,ry:t.ry,stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width});if(t.type==="rect")return L("rect",{fill:e,"fill-rule":"evenodd",height:t.height,stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width,width:t.width,x:t.x,y:t.y});if(t.type==="image")return L("image",{alt:s||"image",height:t.height,href:t.src,preserveAspectRatio:"none",width:t.width,x:t.x,y:t.y});if(t.type==="path"){const n=typeof t.path!="string"?$W(t.path):t.path;return L("path",{d:n,fill:e,"fill-rule":"evenodd",stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width})}if(t.type==="text")return xv(i),L("text",{"dominant-baseline":i.dominantBaseline,fill:e,"fill-rule":"evenodd","font-family":i.font.family,"font-size":i.font.size,"font-style":i.font.style,"font-variant":i.font.variant,"font-weight":i.font.weight,kerning:i.kerning,rotate:i.rotate,stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width,"text-anchor":i.align,"text-decoration":i.decoration,"text-rendering":oIe,x:t.x,y:t.y},t.text)}return null}function ML(t){if(!t)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in t))return{fill:new K(t).toString(),pattern:null,linearGradient:null};if(t.type==="pattern"){const r=`patternId-${eIe()}`;return{fill:`url(#${r})`,pattern:{id:r,x:t.x,y:t.y,width:t.width,height:t.height,image:{x:0,y:0,width:t.width,height:t.height,href:t.src}},linearGradient:null}}const e=`linearGradientId-${rIe()}`;return{fill:`url(#${e})`,pattern:null,linearGradient:{id:e,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stops:t.colors.map(r=>({offset:r.offset,color:r.color&&new K(r.color).toString()}))}}}function TL(t){const e={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};return t&&(t.width!=null&&(e.width=t.width),t.cap&&(e.cap=t.cap),t.join&&(e.join=t.join.toString()),t.color&&(e.color=new K(t.color).toString()),t.dashArray&&(e.dashArray=t.dashArray),t.dashoffset&&(e.dashOffset=t.dashoffset),t.style&&!t.dashArray&&(e.dashArray=xW(t).join(",")||"none")),e}function MW(t,e){const r={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(t){const i=t.alignBaseline,s=i==="baseline"?"auto":i==="top"?"text-top":i==="bottom"?"hanging":i;r.align=t.align,r.dominantBaseline=s,r.decoration=t.decoration,r.kerning=t.kerning?"auto":"0",r.rotate=t.rotated?"90":"0",xv(e),r.font.style=e.style||"normal",r.font.variant=e.variant||"normal",r.font.weight=e.weight||"normal",r.font.size=e.size&&e.size.toString()||"10pt",r.font.family=e.family||"serif"}return r}function TW(t){const{pattern:e,linearGradient:r}=t;if(e)return L("pattern",{height:e.height,id:e.id,patternUnits:"userSpaceOnUse",width:e.width,x:e.x,y:e.y},L("image",{height:e.image.height,href:e.image.href,width:e.image.width,x:e.image.x,y:e.image.y}));if(r){const i=r.stops.map((s,n)=>L("stop",{key:`${n}-stop`,offset:s.offset,"stop-color":s.color}));return L("linearGradient",{gradientUnits:"userSpaceOnUse",id:r.id,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2},i)}return null}function cIe(t,e){if(!t||t.length===0)return null;const r=[];for(const i of t){const{shape:s,fill:n,stroke:o,font:a}=i,l=ML(n),c=TL(o),d=s.type==="text"?MW(s,a):null,p=$L(s,l.fill,c,d);p&&r.push(p)}return L("mask",{id:e,maskUnits:"userSpaceOnUse"},L("g",null,r))}function WD(t,e,r){return da(t,Jv(t),[e,r])}function ZD(t,e,r,i,s){return Yv(t,Jv(t),[e,r]),t[4]=t[4]*e-i*e+i,t[5]=t[5]*r-s*r+s,t}function hIe(t,e,r,i){const s=e%360*Math.PI/180;uc(t,Jv(t),s);const n=Math.cos(s),o=Math.sin(s),a=t[4],l=t[5];return t[4]=a*n-l*o+i*o-r*n+r,t[5]=l*n+a*o-r*o-i*n+i,t}function Ii(t,e){At&&"left"in At?(At.left!=null&&At.left>t&&(At.left=t),(At.right==null||At.right<t)&&(At.right=t),(At.top==null||At.top>e)&&(At.top=e),(At.bottom==null||At.bottom<e)&&(At.bottom=e)):At={left:t,bottom:e,right:t,top:e}}function JD(t){const e=t.args,r=e.length;let i;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(i=0;i<r;i+=2)Ii(e[i],e[i+1]);Xe.x=e[r-2],Xe.y=e[r-1];break;case"H":for(i=0;i<r;++i)Ii(e[i],Xe.y);Xe.x=e[r-1];break;case"V":for(i=0;i<r;++i)Ii(Xe.x,e[i]);Xe.y=e[r-1];break;case"m":{let s=0;for(("x"in Xe)||(Ii(Xe.x=e[0],Xe.y=e[1]),s=2),i=s;i<r;i+=2)Ii(Xe.x+=e[i],Xe.y+=e[i+1]);break}case"l":case"t":for(i=0;i<r;i+=2)Ii(Xe.x+=e[i],Xe.y+=e[i+1]);break;case"h":for(i=0;i<r;++i)Ii(Xe.x+=e[i],Xe.y);break;case"v":for(i=0;i<r;++i)Ii(Xe.x,Xe.y+=e[i]);break;case"c":for(i=0;i<r;i+=6)Ii(Xe.x+e[i],Xe.y+e[i+1]),Ii(Xe.x+e[i+2],Xe.y+e[i+3]),Ii(Xe.x+=e[i+4],Xe.y+=e[i+5]);break;case"s":case"q":for(i=0;i<r;i+=4)Ii(Xe.x+e[i],Xe.y+e[i+1]),Ii(Xe.x+=e[i+2],Xe.y+=e[i+3]);break;case"A":for(i=0;i<r;i+=7)Ii(e[i+5],e[i+6]);Xe.x=e[r-2],Xe.y=e[r-1];break;case"a":for(i=0;i<r;i+=7)Ii(Xe.x+=e[i+5],Xe.y+=e[i+6])}}function YD(t,e,r){const i=aIe[t.toLowerCase()];let s;typeof i=="number"&&(i?e.length>=i&&(s={action:t,args:e.slice(0,e.length-e.length%i)},r.push(s),JD(s)):(s={action:t,args:[]},r.push(s),JD(s)))}function dIe(t){const e=(typeof t.path!="string"?$W(t.path):t.path).match(lIe),r=[];if(At={},Xe={},!e)return null;let i="",s=[];const n=e.length;for(let a=0;a<n;++a){const l=e[a],c=parseFloat(l);isNaN(c)?(i&&YD(i,s,r),s=[],i=l):s.push(c)}YD(i,s,r);const o={x:0,y:0,width:0,height:0};return At&&"left"in At&&(o.x=At.left,o.y=At.top,o.width=At.right-At.left,o.height=At.bottom-At.top),o}function IW(t){const e={x:0,y:0,width:0,height:0};if(t.type==="circle")e.x=t.cx-t.r,e.y=t.cy-t.r,e.width=2*t.r,e.height=2*t.r;else if(t.type==="ellipse")e.x=t.cx-t.rx,e.y=t.cy-t.ry,e.width=2*t.rx,e.height=2*t.ry;else if(t.type==="image"||t.type==="rect")e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height;else if(t.type==="path"){const r=dIe(t);e.x=r.x,e.y=r.y,e.width=r.width,e.height=r.height}return e}function EW(t){const e={x:0,y:0,width:0,height:0};let r=null,i=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(const n of t)r?(r.x=Math.min(r.x,n.x),r.y=Math.min(r.y,n.y),i=Math.max(i,n.x+n.width),s=Math.max(s,n.y+n.height)):(r=e,r.x=n.x,r.y=n.y,i=n.x+n.width,s=n.y+n.height);return r&&(r.width=i-r.x,r.height=s-r.y),r}function aC(t,e,r,i,s,n,o,a,l){let c=(o&&n?qu(n,e):e)/2,d=(o&&n?qu(n,r):r)/2;if(l){const x=l[0],$=l[1];c=(o&&n?qu(n,x):x)/2,d=(o&&n?qu(n,$):$)/2}const p=t.width+i,m=t.height+i,y=$l(),g=$l();let v=!1;if(s&&p!==0&&m!==0){const x=e!==r?e/r:p/m,$=e>r?e:r;let T=1,C=1;isNaN($)||(x>1?(T=$/p,C=$/x/m):(C=$/m,T=$*x/p)),Lo(g,g,ZD(y,T,C,c,d)),v=!0}const w=t.x+(p-i)/2,_=t.y+(m-i)/2;if(Lo(g,g,WD(y,c-w,d-_)),!v&&(p>e||m>r)){const x=p/e>m/r,$=(x?e:r)/(x?p:m);Lo(g,g,ZD(y,$,$,w,_))}return a&&Lo(g,g,WD(y,a[0],a[1])),n&&Lo(g,g,hIe(y,n,w,_)),`matrix(${g[0]},${g[1]},${g[2]},${g[3]},${g[4]},${g[5]})`}function CW(t){const e=t?.match(/bloom\(\s*([^\s]+)\s+([^\s]+)\s+([^\s]+)\s*\)/i);if(!e)return null;const[,r,i,s]=e;return{strength:Number(r),radius:Pe(ze(i)),threshold:Number(s)}}function pIe(t,e,r){const i=CW(t);if(!i)return null;const{strength:s,radius:n}=i,o=s>0?n:0,a=(s+o)*e,l=4*s+1;return L("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${r}`,width:"300%",x:"-100%",y:"-100%"},L("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(s+.5*o)*(5**(e/100)*(.4+e/100)),result:"dilate"}),L("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:a/25}),L("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:a/50}),L("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},L("feFuncR",{slope:l,type:"linear"}),L("feFuncG",{slope:l,type:"linear"}),L("feFuncB",{slope:l,type:"linear"})),L("feMerge",null,L("feMergeNode",{in:"intensityBlur"}),L("feMergeNode",{in:"intensityBrightness"}),L("feGaussianBlur",{stdDeviation:s/10})))}function PW(t,e,r,i={}){const s=[],n=[],o=sIe(),a=pIe(i.cssEffectFilter,e,o);let l=null;if(a){const m=CW(i.cssEffectFilter),y=i.clipBloomEffect||!m?.strength?0:(m.strength+m.radius/2)/3,g=e+e*y,v=r+r*y;l=[Math.max(g,10),Math.max(v,10)]}let c=e,d=r;if(i.useRotationSize)for(let m=0;m<t.length;m++){const y=i.rotations?.[m]??0;c=Math.max(qu(y,e),c),d=Math.max(qu(y,r),d)}for(let m=0;m<t.length;m++){const y=t[m],g=[],v=[];let w=0,_=0,x=0;for(const P of y){const{shape:A,fill:F,stroke:j,font:V,offset:Z}=P;i.ignoreStrokeWidth||A.type==="text"||(w+=j?.width||0);const Y=ML(F),re=TL(j),Q=A.type==="text"?MW(A,V):null;s.push(TW(Y)),g.push($L(A,Y.fill,re,Q,i.ariaLabel)),v.push(IW(A)),Z&&(_+=Z[0],x+=Z[1])}const $=i.rotations?.[m]??0;i.useRotationSize&&(_+=(c-qu($,e))/2,x+=(d-qu($,r))/2);const T=aC(EW(v),e,r,w,i.scale??!1,$,i.useRotationSize??!1,[_,x],l);let C=null;if(i.masking){const P=`mask-${m}`,A=i.masking[m];s.push(cIe(A,P)),C=`url(#${P})`}n.push(C?L("g",{mask:C},L("g",{transform:T},g)):L("g",{transform:T},g))}return a&&(xv(l),c=l[0],d=l[1]),L("svg",{"aria-label":i.ariaLabel,focusable:!1,height:d,role:"img",style:"display: block;",width:c,xmlns:nIe},a,L("defs",null,s),a?L("g",{filter:`url(#bloom${o})`},n):n)}const XD=J1();function fIe(t,e){XD.append(t,e),XD.detach(e)}function ny(t,e,r){const i=Math.ceil(e[0]),s=Math.ceil(e[1]);if(!t.some(o=>!!o.length))return null;const n=r?.node||document.createElement("div");return r.opacity!=null&&(n.style.opacity=r.opacity.toString()),r.cssEffectFilter!=null&&(n.style.filter=r.cssEffectFilter),fIe(n,()=>PW(t,i,s,r)),n}function mIe(t,e){t=Math.ceil(t),e=Math.ceil(e);const r=document.createElement("canvas");r.width=t,r.height=e,r.style.width=t+"px",r.style.height=e+"px";const i=r.getContext("2d");return i.clearRect(0,0,t,e),i}function yIe(t,e,r){return t?Be(t,{responseType:"image"}).then(i=>{const s=i.data,n=s.width,o=s.height,a=n/o;let l=e;if(r){const c=Math.max(n,o);l=Math.min(l,c)}return{image:s,width:a<=1?Math.ceil(l*a):l,height:a<=1?l:Math.ceil(l/a)}}):Promise.reject(new R("renderUtils: imageDataSize","href not provided."))}function gIe(t,e){return!(!t||e==="ignore")&&(e!=="multiply"||t.r!==255||t.g!==255||t.b!==255||t.a!==1)}function vIe(t,e,r,i,s){if(s==="multiply")t[e]*=r[0],t[e+1]*=r[1],t[e+2]*=r[2],t[e+3]*=r[3];else{const n=ax({r:t[e],g:t[e+1],b:t[e+2]});n.h=i.h,n.s=i.s,n.v=n.v/100*i.v;const o=Id(n);t[e]=o.r,t[e+1]=o.g,t[e+2]=o.b,t[e+3]*=r[3]}}function wIe(t,e,r,i,s){return yIe(t,e,s).then(n=>{const o=n.width??e,a=n.height??e;if(n.image&&gIe(r,i)){let l=n.image.width,c=n.image.height;z("edge")&&/\.svg$/i.test(t)&&(l-=1,c-=1);const d=mIe(o,a);d.drawImage(n.image,0,0,l,c,0,0,o,a);const p=d.getImageData(0,0,o,a),m=[r.r/255,r.g/255,r.b/255,r.a],y=ax(r);for(let g=0;g<p.data.length;g+=4)vIe(p.data,g,m,y,i);d.putImageData(p,0,0),t=d.canvas.toDataURL("image/png")}else{const l=Fe?.findCredential(t);if(l?.token){const c=t.includes("?")?"&":"?";t=`${t}${c}token=${l.token}`}}return{url:t,width:o,height:a}}).catch(()=>({url:t,width:e,height:e}))}function _Ie(t){const e=t.symbolLayers?.at(-1);if(e&&"outline"in e)return e?.outline?.size}function bIe(t){if(!t)return 0;if(so(t)){const e=_Ie(t);return e??0}return Ke(dv(t)?.width)}function lx(t){if(t==null||!("symbolLayers"in t)||t.symbolLayers==null)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some(e=>e.type==="object");case"line-3d":return t.symbolLayers.some(e=>e.type==="path");case"polygon-3d":return t.symbolLayers.some(e=>e.type==="object"||e.type==="extrude");default:return!1}}function SIe(t){return t.resource?.href??""}function b9e(t,e){if(!t)return null;let r=null;return so(t)?r=xIe(t):R2(t)&&(r=t.type==="cim"?uW(t):t.color?new K(t.color):null),r?Rf(r,e):null}function xIe(t){const e=t.symbolLayers;if(!e)return null;let r=null;return e.forEach(i=>{i.type==="object"&&i.resource?.href||(r=i.type==="water"?i.color:i.material?i.material.color:null)}),r?new K(r):null}function Rf(t,e){if(e==null||t==null)return t;const r=t.toRgba();return r[3]=r[3]*e,new K(r)}function $Ie(t,e,r){const i=t.symbolLayers;if(!i)return;const s=(n,o=!1)=>{let a=e??n??null;return r?.override!=null&&(!a&&o&&(a=new K([255,255,255])),a&&(a.a=r.override)),Rf(a,r?.add)};i.forEach(n=>{if(n.type==="water")return void(n.color=Rf(n.color,r?.add));const o=n.material!=null?n.material.color:null,a=s(o,n.type==="icon"&&n.resource?.href!=null);n.material==null?n.material=new us({color:a}):n.material.color=a,"outline"in n&&n.outline?.color&&r?.add!=null&&(n.outline.color=Rf(n.outline.color,r.add)),"marker"in n&&n.marker!=null&&(n.marker.color=s(n.marker.color))})}function MIe(t,e,r){e=e??t.color,r?.override!=null&&e&&(e.a=r.override),e&&(t.color=Rf(e,r?.add)),"outline"in t&&t.outline?.color&&(t.outline.color=Rf(t.outline.color,r?.add))}function iM(t,e,r){t&&(e||r!=null)&&(e&&(e=new K(e)),so(t)?$Ie(t,e,r):R2(t)&&MIe(t,e,r))}async function TIe(t,e){const r=t.symbolLayers;r&&await vee(r,async i=>IIe(i,e))}async function IIe(t,e){switch(t.type){case"extrude":CIe(t,e);break;case"icon":case"line":case"text":EIe(t,e);break;case"path":kIe(t,e);break;case"object":await PIe(t,e)}}function EIe(t,e){const r=kW(e);r!=null&&(t.size=r)}function kW(t){for(const e of t)if(typeof e=="number")return e;return null}function CIe(t,e){const r=e[2];typeof r=="number"&&(t.size=r)}async function PIe(t,e){const{resourceSize:r,symbolSize:i}=await LIe(t),s=LW(e,r,i);s!=null&&(t.width=C0(e[0],i[0],r[0],s),t.depth=C0(e[1],i[1],r[1],s),t.height=C0(e[2],i[2],r[2],s))}function kIe(t,e){const r=LW(e,a9,[t.width,void 0,t.height]);r!=null&&(t.width=C0(e[0],t.width,1,r),t.height=C0(e[2],t.height,1,r))}function LW(t,e,r){for(let i=0;i<3;i++){const s=t[i];switch(s){case"symbol-value":{const n=r[i];return n!=null?n/e[i]:1}case"proportional":break;default:if(s&&e[i])return s/e[i]}}return null}async function LIe(t){const{computeObjectLayerResourceSize:e}=await q(()=>import("./symbolLayerUtils-Df5Yo7Gy.js"),[]),r=await e(t,10),{width:i,height:s,depth:n}=t,o=[i,n,s];let a=1;for(let l=0;l<3;l++){const c=o[l];if(c!=null){a=c/r[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=r[l]*a);return{resourceSize:r,symbolSize:o}}function C0(t,e,r,i){switch(t){case"proportional":return r*i;case"symbol-value":return e??r;default:return t}}function AIe(t,e){const r=kW(e);if(r!=null)switch(t.type){case"simple-marker":t.size=r;break;case"picture-marker":{const i=t.width/t.height;i>1?(t.width=r,t.height=r*i):(t.width=r*i,t.height=r);break}case"simple-line":t.width=r;break;case"text":t.font.size=r}}async function RIe(t,e){if(t&&e)return so(t)?TIe(t,e):void(R2(t)&&AIe(t,e))}function OIe(t,e,r){if(t&&e!=null){if(so(t)){const i=t.symbolLayers;i&&i.forEach(s=>{if(s.type==="object")switch(r){case"tilt":s.tilt=(s.tilt??0)+e;break;case"roll":s.roll=(s.roll??0)+e;break;default:s.heading=(s.heading??0)+e}s.type==="icon"&&(s.angle+=e)})}else if(R2(t))switch(t.type){case"simple-marker":case"picture-marker":case"text":t.angle+=e;break;case"cim":kTe(t,e,!0)}}}function FIe(t,e){if(!t)return null;const r=t.effects.map(i=>i.toJSON());return dE(r)}function S9e(t){return t!=null&&t.type==="polygon-3d"&&t.symbolLayers.some(e=>e.type==="extrude")}const AW="esri-relationship-ramp",Yd=`${AW}--diamond`,eu=`${AW}--square`,NIe="http://www.w3.org/2000/svg",ht={diamondContainer:`${Yd}__container`,diamondLeftCol:`${Yd}__left-column`,diamondRightCol:`${Yd}__right-column`,diamondMidCol:`${Yd}__middle-column`,diamondMidColLabel:`${Yd}__middle-column--label`,diamondMidColRamp:`${Yd}__middle-column--ramp`,squareTable:`${eu}__table`,squareTableRow:`${eu}__table-row`,squareTableCell:`${eu}__table-cell`,squareTableLabel:`${eu}__table-label`,squareTableLabelLeftBottom:`${eu}__table-label--left-bottom`,squareTableLabelRightBottom:`${eu}__table-label--right-bottom`,squareTableLabelLeftTop:`${eu}__table-label--left-top`,squareTableLabelRightTop:`${eu}__table-label--right-top`};function RW(t,e,r={}){const{focus:i,labels:s}=t,n=!!i,o=DIe(t,e,r),a={justifyContent:"center"},l=U2(),c=r.key??e;return n?L("div",{class:ht.diamondContainer,key:`${c}-container`,styles:a},L("div",{class:ht.diamondLeftCol},l?s.right:s.left),L("div",{class:ht.diamondMidCol},L("div",{class:ht.diamondMidColLabel},s.top),o,L("div",{class:ht.diamondMidColLabel},s.bottom)),L("div",{class:ht.diamondRightCol},l?s.left:s.right)):L("div",{class:ht.squareTable,key:`${c}-container`},L("div",{class:ht.squareTableRow},L("div",{class:af(ht.squareTableCell,ht.squareTableLabel,ht.squareTableLabelRightBottom)},l?s.top:s.left),L("div",{class:ht.squareTableCell}),L("div",{class:af(ht.squareTableCell,ht.squareTableLabel,ht.squareTableLabelLeftBottom)},l?s.left:s.top)),L("div",{class:ht.squareTableRow},L("div",{class:ht.squareTableCell}),o,L("div",{class:ht.squareTableCell})),L("div",{class:ht.squareTableRow},L("div",{class:af(ht.squareTableCell,ht.squareTableLabel,ht.squareTableLabelRightTop)},l?s.right:s.bottom),L("div",{class:ht.squareTableCell}),L("div",{class:af(ht.squareTableCell,ht.squareTableLabel,ht.squareTableLabelLeftTop)},l?s.bottom:s.right)))}function KD(t,e,r){const i=`${r}_arrowStart`,s=`${r}_arrowEnd`,n=t==="left",o={markerStart:null,markerEnd:null};switch(e){case"HL":n?o.markerStart=`url(#${s})`:o.markerEnd=`url(#${i})`;break;case"LL":o.markerStart=`url(#${s})`;break;case"LH":n?o.markerEnd=`url(#${i})`:o.markerStart=`url(#${s})`;break;default:o.markerEnd=`url(#${i})`}return o}function DIe(t,e,r={}){const{focus:i,numClasses:s,colors:n,rotation:o}=t,{opacity:a,cssEffectFilter:l,ariaLabel:c}=r,d=r.size??60,p=!!i,m=Math.sqrt(d**2+d**2)+(p?0:5),y=[],g=[],v=[],w=(d||75)/s;for(let Z=0;Z<s;Z++){const Y=Z*w;for(let re=0;re<s;re++){const Q=re*w,Ee=ML(n[Z][re]),et=TL(null),lt={type:"rect",x:Q,y:Y,width:w,height:w},Ve=TW(Ee);Ve&&y.push(Ve);const vr=$L(lt,Ee.fill,et,null);vr&&g.push(vr),v.push(IW(lt))}}const _=15,x=15,$=10;let T=null;p||(T="margin: -15px -15px -18px -15px");const C=KD("left",i,e),P=KD("right",i,e),A=EW(v),F=aC(A,m,m,0,!1,o,!1),j=aC(A,m,m,0,!1,p?-45:null,!1),V={filter:l??void 0,opacity:a==null?"":`${a}`};return L("div",{class:p?ht.diamondMidColRamp:ht.squareTableCell,styles:V},L("svg",{"aria-label":c,focusable:!1,height:m,role:"image",style:T,width:m,xmlns:NIe},L("defs",null,L("marker",{id:`${e}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},L("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),L("marker",{id:`${e}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},L("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),y),L("g",{transform:F},g),L("g",{transform:j},L("line",{fill:"none","marker-end":C.markerEnd,"marker-start":C.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:d-_,y2:_}),L("line",{fill:"none","marker-end":P.markerEnd,"marker-start":P.markerStart,stroke:"#555555","stroke-width":"1",x1:x,x2:d-x,y1:d+$,y2:d+$}))))}const P0={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}]};function zIe(t,e,r){let s=22,n=22;t<1?s*=.75:t>1&&(n*=1.25);const o=0,a=0;let l=22,c=22;return e&&r&&(s=n=l=c=0),[{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[r?l:.875*l,o]},{command:"L",values:[r?s-.5*l:a,n-.5*c]},{command:"L",values:[s-.5*l,n-.5*c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[l,e?o:.125*c]},{command:"L",values:[s-.5*l,e?n-.5*c:c]},{command:"L",values:[s-.5*l,n-.5*c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s-.5*l,n-.5*c]},{command:"L",values:[r?s-.5*l:a,n-.5*c]},{command:"L",values:[r?s-.5*l:a,e?n-.5*c:c]},{command:"L",values:[s-.5*l,e?n-.5*c:c]},{command:"Z",values:[]}]}]}function jIe(t){const r=.5*t,i=0,s=0;return[{type:"path",path:[{command:"M",values:[s,.7*22*.5]},{command:"L",values:[.3*22,.7*22]},{command:"L",values:[.3*22,.7*22+r]},{command:"L",values:[s,.7*22+r-.7*22*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*22,.7*22]},{command:"L",values:[.3*22,.7*22+r]},{command:"L",values:[22,r]},{command:"L",values:[22,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*22,i]},{command:"L",values:[22,i]},{command:"L",values:[.3*22,.7*22]},{command:"L",values:[s,.7*22*.5]},{command:"Z",values:[]}]}]}function VIe(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function UIe(t,e){let r=e?20:t;const i=e?4:6;r-=r<=22?.5*i:i;const s=0,n=0,o=e?.35*r:.5*r;return[{type:"path",path:[{command:"M",values:[.5*r,s]},{command:"L",values:[r,.5*o]},{command:"L",values:[.5*r,o]},{command:"L",values:[n,.5*o]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,.5*o]},{command:"L",values:[.5*r,o]},{command:"L",values:[.5*r,t]},{command:"L",values:[n,t-.5*o]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*r,o]},{command:"L",values:[.5*r,t]},{command:"L",values:[r,t-.5*o]},{command:"L",values:[r,.5*o]},{command:"Z",values:[]}]}]}function GIe(t,e){let r=e?20:t;const i=e?4:6;r-=r<=22?.5*i:i;const s=.5*r,n=.15*r,o=0,a=t-n;return[{type:"ellipse",cx:.5*r,cy:a,rx:s,ry:n},{type:"path",path:[{command:"M",values:[o,n]},{command:"L",values:[o,a]},{command:"L",values:[r,a]},{command:"L",values:[r,n]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*r,cy:n,rx:s,ry:n}]}function qIe(t,e){let r=e?20:t;const i=e?4:6;r-=r<=22?.5*i:i;const s=.15*r,n=t-s;return[{type:"ellipse",cx:.5*r,cy:n,rx:.5*r,ry:s},{type:"path",path:[{command:"M",values:[.5*r,0]},{command:"L",values:[r,n]},{command:"L",values:[0,n]},{command:"Z",values:[]}]}]}function BIe(t){let e=t;const r=6;e-=e<22?.5*r:r;const i=.15*e,s=0;return[{type:"path",path:[{command:"M",values:[0,s]},{command:"L",values:[e,s]},{command:"L",values:[.5*e,t-i]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:s,rx:.5*e,ry:i}]}function HIe(t){let e=t;const r=t,i=4;e-=e<22?.5*i:i;const s=0,n=0,o=e,a=r,l=Math.floor(t/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*o,s]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,s]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[n,.5*a-l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[.45*o,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,r]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]}]}function WIe(t){let r=t;r-=r<22?.5*2:2;const i=0,s=0;return[{type:"path",path:[{command:"M",values:[.45*t,i]},{command:"L",values:[t,r]},{command:"L",values:[.45*t,.6*r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*t,i]},{command:"L",values:[.45*t,.6*r]},{command:"L",values:[s,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,r]},{command:"L",values:[.45*t,.6*r]},{command:"L",values:[t,r]},{command:"Z",values:[]}]}]}function Xu(t,e){return Math.round(Math.min(Math.max(t+255*e*.75,0),255))}function x9e(t,e){if(t==null)return new K;if("type"in t&&(t.type==="linear"||t.type==="pattern"))return t;const r=new K(t);return new K([Xu(r.r,e),Xu(r.g,e),Xu(r.b,e),r.a])}function ZIe(t){return t=t||globalThis.location.hostname,JIe.some(e=>t?.match(e)!=null)}function QD(t,e){return t?(e=e||globalThis.location.hostname)?e.match(OW)!=null||e.match(NW)!=null?t.replace("static.arcgis.com","staticdev.arcgis.com"):e.match(FW)!=null||e.match(DW)!=null?t.replace("static.arcgis.com","staticqa.arcgis.com"):t:t:null}const OW=/^devext\.arcgis\.com$/,FW=/^qaext\.arcgis\.com$/,NW=/^[\w-]*\.mapsdevext\.arcgis\.com$/,DW=/^[\w-]*\.mapsqa\.arcgis\.com$/,JIe=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,OW,FW,/^jsapps\.esri\.com$/,NW,DW],YIe=["web-gltf","web","cim"];function zW(t,e,r){const i=t.name;return i==null?Promise.reject(new R("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName==="Esri2DPointSymbolsStyle"?XIe(i,e,r):QB(t,e,r).then(s=>VW(s,i,e,t2e,r))}function jW(t,e){return e.items.find(r=>r.name===t)}async function VW(t,e,r,i,s){const n=r?.portal!=null?r.portal:J.getDefault(),o={portal:n,url:Er(t.baseUrl)},a=jW(e,t.data);if(!a)throw new R("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,{symbolName:e});const l=s?.acceptedFormats??YIe,c=i(a,l);if(!c)throw new R("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${e}' does not have an accepted format (one of ${l})`,{symbolName:e});const{url:d,format:p}=c;let m=Il(d,o),y=a.thumbnail?.href??null;const g=a.thumbnail?.imageData;ZIe()&&(m=QD(m)??"",y=QD(y));const v={portal:n,url:Er(WC(m)),origin:"portal-item"};return oL(m,s).then(w=>{const _=p==="cim"?eH(w.data):w.data,x=XB(_,v);if(x&&so(x)){if(y){const $=Il(y,o);x.thumbnail=new Hh({url:$})}else g&&(x.thumbnail=new Hh({url:`data:image/png;base64,${g}`}));t.styleUrl?x.styleOrigin=new Hn({portal:r.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(x.styleOrigin=new Hn({portal:r.portal,styleName:t.styleName,name:e}))}return x})}function XIe(t,e,r){const i=r2e.replaceAll(/\{SymbolName\}/gi,t),s=e.portal!=null?e.portal:J.getDefault();return oL(i,r).then(n=>{const o=eH(n.data);return XB(o,{portal:s,url:Er(WC(i)),origin:"portal-item"})})}const KIe=Object.freeze(Object.defineProperty({__proto__:null,fetchSymbolFromStyle:VW,getStyleItemFromStyle:jW,resolveWebStyleSymbol:zW},Symbol.toStringTag,{value:"Module"})),Ih=22,Zb=120,ux=80,e4=50,lC=20;function hf(t){const e=t.outline,r=t.material!=null?t.material.color:null,i=r!=null?r.toHex():null;if(e==null||"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"&&e.pattern.style==="none")return t.type==="fill"&&i==="#ffffff"?{color:"#bdc3c7",width:.75}:null;const s=Pe(e.size)||0;return{color:"rgba("+(e.color!=null?e.color.toRgba():"255,255,255,1")+")",width:Math.min(s,ux),style:"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"?xL(e.pattern.style):null,join:"butt",cap:"patternCap"in e?e.patternCap:"butt"}}async function QIe(t,e){if(t.thumbnail?.url)return t.thumbnail.url;if(e.type==="icon"&&e?.resource?.href)return SIe(e);const r=St("esri/images/Legend/legend3dsymboldefault.png");if(t.styleOrigin&&(t.styleOrigin.styleName||t.styleOrigin.styleUrl)){const i=await zW(t.styleOrigin,{portal:t.styleOrigin.portal}).catch(()=>null);if(i&&"thumbnail"in i&&i.thumbnail?.url)return i.thumbnail.url}return r}function sM(t,e=1){const r=t.a,i=ax(t),s=i.h,n=i.s/e,o=100-(100-i.v)/e,{r:a,g:l,b:c}=Id({h:s,s:n,v:o});return[a,l,c,r]}function MS(t){return t.type==="water"?t.color==null?null:t.color:t.material?.color==null?null:t.material.color}function Ze(t,e=0){const r=MS(t);if(!r){if(t.type==="fill")return null;const s=KTe.r,n=Xu(s,e);return[n,n,n,100]}const i=r.toRgba();for(let s=0;s<3;s++)i[s]=Xu(i[s],e);return i}async function UW(t,e){const r=t.style;return r==="none"?null:{type:"pattern",x:0,y:0,src:await XTe(St(`esri/symbols/patterns/${r}.png`),e.toCss(!0)),width:5,height:5}}function t4(t){return t.outline?hf(t):{color:"rgba(0, 0, 0, 1)",width:1.5}}function IL(t,e){const r=MS(t);if(!r)return null;let i="rgba(";return i+=Xu(r.r,e)+",",i+=Xu(r.g,e)+",",i+=Xu(r.b,e)+",",i+r.a+");"}function r4(t,e){const r=t.edges;return!r||!r.color||!r.size?null:{color:r.color.toCss(!0),width:Math.min(Pe(r.size),e,ux),join:"round"}}function uC(t,e){const r=IL(t,e);if(!r||"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"&&t.pattern.style==="none")return null;const i={color:r,width:Math.min(t.size?Pe(t.size):.75,ux)};return"pattern"in t&&t.pattern?.type==="style"&&(i.style=xL(t.pattern.style)),"cap"in t&&t.cap&&(i.cap=t.cap),"join"in t&&t.join&&(i.join=t.join==="miter"?Pe(2):t.join),i}function u_(t,e,r){const i=r!=null?.75*r:0;return{type:"linear",x1:i?.25*i:0,y1:i?.5*i:0,x2:i||4,y2:i?.5*i:4,colors:[{color:t,offset:0},{color:e,offset:1}]}}function e3e(t){const e=t.depth,r=t.height,i=t.width;return i!==0&&e!==0&&r!==0&&i===e&&i!=null&&r!=null&&i<r}function t3e(t,e,r){const i=[];if(!t)return i;switch(t.type){case"icon":{const o=e,a=e;switch(t.resource?.primitive??upe){case"circle":i.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:Ze(t,0),stroke:hf(t)});break;case"square":i.push({shape:{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[0,0]},{command:"L",values:[o,0]},{command:"L",values:[o,a]},{command:"Z",values:[]}]},fill:Ze(t,0),stroke:hf(t)});break;case"triangle":i.push({shape:{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[.5*o,0]},{command:"L",values:[o,a]},{command:"Z",values:[]}]},fill:Ze(t,0),stroke:hf(t)});break;case"cross":i.push({shape:{type:"path",path:[{command:"M",values:[.5*o,0]},{command:"L",values:[.5*o,a]},{command:"M",values:[0,.5*a]},{command:"L",values:[o,.5*a]}]},stroke:t4(t)});break;case"x":i.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[o,a]},{command:"M",values:[o,0]},{command:"L",values:[0,a]}]},stroke:t4(t)});break;case"kite":i.push({shape:{type:"path",path:[{command:"M",values:[0,.5*a]},{command:"L",values:[.5*o,0]},{command:"L",values:[o,.5*a]},{command:"L",values:[.5*o,a]},{command:"Z",values:[]}]},fill:Ze(t,0),stroke:hf(t)})}break}case"object":switch(t.resource?.primitive??fpe){case"cone":{const s=u_(Ze(t,0),Ze(t,-.6),r?lC:e),n=qIe(e,r);i.push({shape:n[0],fill:s},{shape:n[1],fill:s});break}case"inverted-cone":{const s=Ze(t,0),n=u_(s,Ze(t,-.6),e),o=BIe(e);i.push({shape:o[0],fill:n},{shape:o[1],fill:s});break}case"cube":{const s=UIe(e,r);i.push({shape:s[0],fill:Ze(t,0)},{shape:s[1],fill:Ze(t,-.3)},{shape:s[2],fill:Ze(t,-.5)});break}case"cylinder":{const s=u_(Ze(t,0),Ze(t,-.6),r?lC:e),n=GIe(e,r);i.push({shape:n[0],fill:s},{shape:n[1],fill:s},{shape:n[2],fill:Ze(t,0)});break}case"diamond":{const s=HIe(e);i.push({shape:s[0],fill:Ze(t,-.3)},{shape:s[1],fill:Ze(t,0)},{shape:s[2],fill:Ze(t,-.3)},{shape:s[3],fill:Ze(t,-.7)});break}case"sphere":{const s=u_(Ze(t,0),Ze(t,-.6));s.x1=0,s.y1=0,s.x2=.25*e,s.y2=.25*e,i.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:s});break}case"tetrahedron":{const s=WIe(e);i.push({shape:s[0],fill:Ze(t,-.3)},{shape:s[1],fill:Ze(t,0)},{shape:s[2],fill:Ze(t,-.6)});break}}break}return i}function cx(t){const e=typeof t?.size=="number"?t?.size:null;return e?Pe(e):null}function r3e(t){return t.type==="icon"?"multiply":"tint"}async function i3e(t,e){const r=cx(e),i=e?.maxSize?Pe(e.maxSize):null,s=e?.disableUpsampling??!1,n=t.symbolLayers,o=[],a=[];let l=!1,c=0,d=0,p=0;n.forEach(g=>{if(g.type!=="icon"&&g.type!=="object")return;g&&g.type==="icon"&&(p=Math.max(g.size&&Pe(g.size),p));const v=g.type==="icon"?g.size&&Pe(g.size):0,w=r||v?Math.ceil(Math.min(r||v,i||Zb)):Ih;let _=g.type==="icon"?g.angle:null;if(e?.rotation!=null&&(_=(_??0)+e.rotation),a.push(_),g?.resource?.href){const x=QIe(t,g).then($=>{const T=g?.material?.color,C=r3e(g);return wIe($,w,T,C,s)}).then($=>{const T=$.width,C=$.height;return c=Math.max(c,T),d=Math.max(d,C),_&&(l=!0),[{shape:{type:"image",x:0,y:0,width:T,height:C,src:$.url},fill:null,stroke:null}]});o.push(x)}else{let x=w;g.type==="icon"&&r&&(x=w*(v/p));const $=e?.symbolConfig==="tall"||e?.symbolConfig?.isTall||g.type==="object"&&e3e(g);c=Math.max(c,$?lC:x),d=Math.max(d,x),_&&g.resource?.primitive&&["square","triangle","x"].includes(g.resource?.primitive)&&(l=!0),o.push(Promise.resolve(t3e(g,x,$)))}});const m=await Promise.allSettled(o),y=[];return m.forEach(g=>{g.status==="fulfilled"?y.push(g.value):g.reason&&U.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",g.reason)}),ny(y,[c,d],{node:e?.node,scale:!1,opacity:e?.opacity,ariaLabel:e?.ariaLabel,rotations:a,useRotationSize:l})}function s3e(t,e){const r=t.symbolLayers,i=[],s=lx(t),n=cx(e),o=(e?.maxSize?Pe(e.maxSize):null)||ux;let a,l=0,c=0;return r.forEach((d,p)=>{if(!d||d.type!=="line"&&d.type!=="path")return;const m=[];switch(d.type){case"line":{const y=uC(d,0);if(y==null)break;const g=y?.width||0;p===0&&(a=g);const v=Math.min(n||g,o),w=p===0?v:n?v*(g/a):v,_=w>e4/2?2*w:e4;c=Math.max(c,w),l=Math.max(l,_),y.width=w,m.push({shape:{type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[l,.5*c]}]},stroke:y});break}case"path":{const y=Math.min(n||Ih,o),g=Ze(d,0),v=Ze(d,-.2),w=IL(d,-.4),_=w?{color:w,width:1}:{};if(d.profile==="quad"){const x=d.width,$=d.height,T=zIe(x&&$?x/$:1,$===0,x===0),C={..._,join:"bevel"};m.push({shape:T[0],fill:v,stroke:C},{shape:T[1],fill:v,stroke:C},{shape:T[2],fill:g,stroke:C})}else m.push({shape:P0.pathSymbol3DLayer[0],fill:v,stroke:_},{shape:P0.pathSymbol3DLayer[1],fill:g,stroke:_});c=Math.max(c,y),l=c}}i.push(m)}),Promise.resolve(ny(i,[l,c],{node:e?.node,scale:s,opacity:e?.opacity,ariaLabel:e?.ariaLabel}))}async function n3e(t,e){const r=t.type==="mesh-3d",i=t.symbolLayers,s=cx(e),n=e?.maxSize?Pe(e.maxSize):null,o=s||Ih,a=[];let l=0,c=0,d=!1;for(let p=0;p<i.length;p++){const m=i.at(p),y=[];if(!r||m.type==="fill"){switch(m.type){case"fill":{const g=Math.min(o,n||Zb);if(l=Math.max(l,g),c=Math.max(c,g),d=!0,r){const v=P0.meshSymbol3DFill,w=IL(m,-.4),_=r4(m,.05*g)??(w?{join:"round",color:w,width:1}:null);y.push({shape:v[0],fill:Ze(m,0),stroke:_},{shape:v[1],fill:Ze(m,-.2),stroke:_},{shape:v[2],fill:Ze(m,-.6),stroke:_})}else{let v=Ze(m,0);const w="pattern"in m?m.pattern:null,_=hf(m),x=MS(m);w!=null&&w.type==="style"&&w.style!=="solid"&&x&&(v=await UW(w,x)),y.push({shape:P0.fill[0],fill:v,stroke:_})}break}case"line":{const g=uC(m,0);if(g==null)break;const v={stroke:g,shape:P0.fill[0]};l=Math.max(l,Ih),c=Math.max(c,Ih),y.push(v);break}case"extrude":{const g=Ze(m,0),v=Ze(m,-.2),w=Math.min(o,n||Zb),_=jIe(w),x=Ih,$=.7*Ih+.5*w,T=r4(m,.1*Math.min(x,$))??{join:"round",...uC(m,-.4),width:1};y.push({shape:_[0],fill:v,stroke:T},{shape:_[1],fill:v,stroke:T},{shape:_[2],fill:g,stroke:T}),l=Math.max(l,x),c=Math.max(c,$);break}case"water":{const g=MS(m),v=sM(g),w=sM(g,2),_=sM(g,3),x=VIe();d=!0,y.push({shape:x[0],fill:v},{shape:x[1],fill:w},{shape:x[2],fill:_});const $=Math.min(o,n||Zb);l=Math.max(l,$),c=Math.max(c,$);break}}a.push(y)}}return ny(a,[l,c],{node:e?.node,scale:d,opacity:e?.opacity,ariaLabel:e?.ariaLabel})}function o3e(t,e){if(t.symbolLayers.length===0)return Promise.reject(new R("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(t.type){case"point-3d":return i3e(t,e);case"line-3d":return s3e(t,e);case"polygon-3d":case"mesh-3d":return n3e(t,e)}return Promise.reject(new R("symbolPreview: swatchInfo3D","symbol not supported."))}const a3e=Object.freeze(Object.defineProperty({__proto__:null,getPatternDescriptor:UW,getSizeFromOptions:cx,getSymbolLayerFill:Ze,previewSymbol3D:o3e},Symbol.toStringTag,{value:"Module"})),i4={HH:315,HL:45,LL:135,LH:225},l3e={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function u3e(t){if(!t)return;const{type:e}=t;if(e.includes("3d"))return Ze(t.symbolLayers.at(0));if(e==="simple-line"){const r=dv(t);return r&&r.color}if(t.type==="simple-marker"&&(t.style==="x"||t.style==="cross")){const r=dv(t);return r&&r.color}return YTe(t)}function c3e(t,e){const r=e.HH.label,i=e.LL.label,s=e.HL.label,n=e.LH.label;switch(t){case"HH":default:return{top:r,bottom:i,left:s,right:n};case"HL":return{top:s,bottom:n,left:i,right:r};case"LL":return{top:i,bottom:r,left:n,right:s};case"LH":return{top:n,bottom:s,left:r,right:i}}}function h3e(t){const{focus:e,infos:r,numClasses:i}=t,s=l3e[i],n={};r.forEach(a=>{n[a.value]={label:a.label,fill:u3e(a.symbol)}});const o=[];for(let a=0;a<i;a++){const l=[];for(let c=0;c<i;c++){const d=n[s[a][c]];l.push(d.fill)}o.push(l)}return{type:"relationship-ramp",numClasses:i,focus:e,colors:o,labels:c3e(e,n),rotation:GW(e)}}function GW(t){let e=i4[t];return t&&e==null&&(e=i4.HH),e||0}let Xd=null;const s4=[255,255,255];function n4(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function d3e(t,e,r){const{backgroundColor:i,outline:s,dotSize:n}=t,o=22,a=.8,l=Math.round(o*o/Math.max(n,.5)**2*a),c=window.devicePixelRatio,d=document.createElement("canvas"),p=o*c;d.width=p,d.height=p,d.style.width=d.width/c+"px",d.style.height=d.height/c+"px";const m=d.getContext("2d");if(i&&(m.fillStyle=i.toCss(!0),m.fillRect(0,0,p,p),m.fill()),m.fillStyle=e?.toCss(!0)??"",Xd&&Xd.length/2===l)for(let g=0;g<2*l;g+=2){const v=Xd[g],w=Xd[g+1];m.fillRect(v,w,n*c,n*c),m.fill()}else{Xd=[];for(let g=0;g<2*l;g+=2){const v=n4(0,p),w=n4(0,p);Xd.push(v,w),m.fillRect(v,w,n*c,n*c),m.fill()}}s&&(s.color&&(m.strokeStyle=s.color.toCss(!0)),m.lineWidth=s.width,m.strokeRect(0,0,p,p));const y=new Image(o,o);return y.src=d.toDataURL(),y.ariaLabel=null,y.alt="",y}function p3e(t,e={}){const r=e.radius||40,i=2*Math.PI*r,s=t.length,n=i/s,o=[],a=dv(e.outline);a?.width!=null&&(a.width*=2),(a||e.backgroundColor)&&o.push({shape:{type:"circle",cx:r,cy:r,r},fill:e.backgroundColor,stroke:a,offset:[0,0]});const l=e.values,c=l&&l.length===s&&l.reduce((g,v)=>g+v,0)===100,d=[0];for(let g=0;g<s;g++){let v=null;c&&(v=l[g]*i/100,d.push(v+d[g])),o.push({shape:{type:"circle",cx:r,cy:r,r:r/2},fill:[0,0,0,0],stroke:{width:r,dashArray:`${(v??n)/2} ${i}`,dashoffset:"-"+(c?d[g]/2:g*(n/2)),color:t[g]},offset:[0,0]})}let p=null;const m=2*r+(a?.width||0),y=e.holePercentage;if(y){a&&o.push({shape:{type:"circle",cx:r,cy:r,r:r*y},fill:null,stroke:a,offset:[0,0]});const g=m/2;p=[[{shape:{type:"circle",cx:g,cy:g,r:g},fill:s4,stroke:a?{...a,color:s4}:null,offset:[0,0]},{shape:{type:"circle",cx:g,cy:g,r:r*y},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return ny([o],[m,m],{cssEffectFilter:e.cssEffectFilter,ignoreStrokeWidth:!0,masking:p,rotations:[-90],ariaLabel:e.ariaLabel})}function uh(t,e={}){const s=e.align==="horizontal",n=s?75:24,o=s?24:75,a=e.width??n,l=e.height??o,c=e.gradient??!0,d=window.devicePixelRatio,p=a*d,m=l*d,y=document.createElement("canvas");y.width=p,y.height=m,y.ariaLabel=e.ariaLabel??null,y.style.width=`${a}px`,y.style.height=`${l}px`;const g=y.getContext("2d"),v=s?p:0,w=s?0:m;if(c){const x=g.createLinearGradient(0,0,v,w),$=t.length,T=$===1?0:1/($-1);t.forEach((C,P)=>x.addColorStop(P*T,C.toString())),g.fillStyle=x,g.fillRect(0,0,p,m)}else{const x=s?p/t.length:p,$=s?m:m/t.length;let T=0,C=0;for(const P of t)g.fillStyle=P.toString(),g.fillRect(T,C,x,$),T=s?T+x:0,C=s?0:C+$}const _=document.createElement("div");return _.style.width=`${a}px`,_.style.height=`${l}px`,m3e(_,e?.cssEffectFilter),_.appendChild(y),_}function f3e(t){const e=t.match(/drop-shadow\(\s*([^\s]+)\s+[^\s]+\s+[^\s]+\s+.+?\)/);return e?e[1]:null}function m3e(t,e){if(!e)return;t.style.filter=e;const r=f3e(e);if(r){const i=Pe(ze(r));i<0?t.style.marginLeft=`${Math.abs(i)}px`:t.style.marginRight=`${i}px`}}async function qW(t,e){switch(t.type){case"web-style":{const{previewWebStyleSymbol:r}=await q(()=>import("./previewWebStyleSymbol-Xj3aNRbk.js"),[]);return r(t,qW,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:r}=await q(()=>Promise.resolve().then(()=>a3e),void 0);return r(t,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:r}=await q(()=>import("./previewSymbol2D-zgbYXEFa.js"),__vite__mapDeps([305,196]));return r(t,e)}case"cim":{const{previewCIMSymbol:r}=await q(()=>Promise.resolve().then(()=>Cke),void 0);return r(t,e)}default:return}}function BW(t){return t&&t.opacity!==void 0?t.opacity*("parent"in t?BW(t.parent):1):1}async function $9e(t,e){if(!t)return;const r=t.sourceLayer,i=(e!=null&&e.useSourceLayer?r:t.layer)??r,s=e?.ignoreOpacity?1:BW(i);if(t.symbol!=null&&(e==null||e.ignoreGraphicSymbol!==!0)){const T=t.symbol.type==="web-style"?await t.symbol.fetchSymbol({...e,acceptedFormats:e?.webStyleAcceptedFormats,cache:e?.webStyleCache}):t.symbol.clone();return iM(T,null,{add:s}),T}const n=e?.renderer??g3e(i);let o=n&&"getSymbolAsync"in n?await n.getSymbolAsync(t,e):null;if(!o)return;if(o=o.type==="web-style"?await o.fetchSymbol({...e,acceptedFormats:e?.webStyleAcceptedFormats,cache:e?.webStyleCache}):o.clone(),!(n&&"visualVariables"in n&&n.visualVariables?.length&&y3e(o)))return iM(o,null,{add:s}),o;if("arcadeRequiredForVisualVariables"in n&&n.arcadeRequiredForVisualVariables&&e?.arcade==null){const T={...e};T.arcade=await kl(),e=T}const{getColor:a,getOpacity:l,getAllSizes:c,getRotationAngle:d}=await q(()=>Promise.resolve().then(()=>$d),void 0),p=[],m=[],y=[],g=[];for(const T of n.visualVariables)switch(T.type){case"color":p.push(T);break;case"opacity":m.push(T);break;case"rotation":g.push(T);break;case"size":T.target||y.push(T)}const v=!!p.length&&p[p.length-1],w=v?a(v,t,e):null,_=!!e?.ignoreOpacity,x=!!m.length&&m[m.length-1],$=x?l(x,t,e):null;if(iM(o,w,_?void 0:{override:$,add:s}),y.length&&e?.ignoreSizeVariables!==!0){const T=c(y,t,e);await RIe(o,T)}if(e?.ignoreRotationVariables!==!0)for(const T of g)OIe(o,d(T,t,e),T.axis);return o}function y3e(t){return!so(t)||t.symbolLayers.at(0)?.type!=="water"}function g3e(t){if(t)return"renderer"in t?t.renderer:void 0}function v3e(t,e,r){const i=t.effectiveClusterRenderer;if(!i||!("visualVariables"in i)||!i.visualVariables)return null;const s=i.visualVariables.find(d=>d.type==="size");if(!("stops"in s)||!s.stops)return null;const n=s.stops.find(d=>d.useMinValue),o=s.stops.find(d=>d.useMaxValue);if(n==null||o==null)return null;const a=r.featuresTilingScheme.getClosestInfoForScale(r.scale).level,l=s.field,c=e.getDisplayStatistics(a,l);return c?new Ge({field:s.field,minSize:t.clusterMinSize,minDataValue:c.minValue,maxSize:t.clusterMaxSize,maxDataValue:c.maxValue}):null}const w3e=/^-?(\d+)(\.(\d+))?$/i;function _3e(t,e){return t-e}function b3e(t,e){let r,i;return r=Number(t.toFixed(e)),r<t?i=r+1/10**e:(i=r,r-=1/10**e),r=Number(r.toFixed(e)),i=Number(i.toFixed(e)),[r,i]}function S3e(t,e,r,i,s){const n=Jb(t,e,r,i),o=n.previous==null||n.previous<=s,a=n.next==null||n.next<=s;return o&&a||n.previous+n.next<=2*s}function TS(t){const e=String(t),r=e.match(w3e);if(r?.[1])return{integer:r[1].split("").length,fractional:r[3]?r[3].split("").length:0};if(e.toLowerCase().includes("e")){const i=e.split("e"),s=i[0],n=i[1];if(s&&n){const o=Number(s);let a=Number(n);const l=a>0;l||(a=Math.abs(a));const c=TS(o);return l?(c.integer+=a,a>c.fractional?c.fractional=0:c.fractional-=a):(c.fractional+=a,a>c.integer?c.integer=1:c.integer-=a),c}}return{integer:0,fractional:0}}function Jb(t,e,r,i){const s={previous:null,next:null};if(r!=null){const n=t-r,o=e-r-n;s.previous=Math.floor(Math.abs(100*o/n))}if(i!=null){const n=i-t,o=i-e-n;s.next=Math.floor(Math.abs(100*o/n))}return s}function IS(t,e={}){const r=t.slice(),{tolerance:i=2,strictBounds:s=!1,indexes:n=r.map((o,a)=>a)}=e;n.sort(_3e);for(let o=0;o<n.length;o++){const a=n[o],l=r[a],c=a===0?null:r[a-1],d=a===r.length-1?null:r[a+1],p=TS(l).fractional;if(p){let m,y=0,g=!1;for(;y<=p&&!g;){const v=b3e(l,y);m=s&&o===0?v[1]:v[0],g=S3e(l,m,c,d,i),y++}g&&(r[a]=m)}}return r}const x3e={maximumFractionDigits:20};function $3e(t){return nc(t,x3e)}const M9e=",",M3e={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},T3e=new Set(["integer","small-integer"]);let nM=null;function T9e(t){return C2(t)||zU(t)||jU(t)}async function I9e(t){const{field:e,field2:r,field3:i,normalizationField:s,valueExpression:n,fields:o}=t;let a=[];if(n){if(!nM){const{arcadeUtils:l}=await kl();nM=l}a=nM.extractFieldNames(n)}return e&&a.push(e),r&&a.push(r),i&&a.push(i),s&&a.push(s),o&&a.push(...o),a}function Gy(t){return String(t).padStart(2,"0")}function o4(t,e,r){let i;return e==="date"||e==="number"?(e==="number"&&(t=new Date(t)),i=`TIMESTAMP'${r?t.getFullYear():t.getUTCFullYear()}-${Gy((r?t.getMonth():t.getUTCMonth())+1)}-${Gy(r?t.getDate():t.getUTCDate())} ${Gy(r?t.getHours():t.getUTCHours())}:${Gy(r?t.getMinutes():t.getUTCMinutes())}:${Gy(r?t.getSeconds():t.getUTCSeconds())}'`):i=t,i}function E9e(t,e,r,i){const{hasQueryEngine:s}=t,n=`(${o4(r,a4(t,r),s)} - ${o4(e,a4(t,e),s)})`;let o=M3e[i],a="/";return o<1&&(o=1/o,a="*"),{sqlExpression:o===1?n:`(${n} ${a} ${o})`,sqlWhere:null}}function a4(t,e){if(e instanceof Date)return"date";if(typeof e=="number")return"number";if(typeof e=="string"){const r=t.getField(e);if(e.toLowerCase()==="<now>")return;if(C2(r))return"field"}}function C9e(t,e){const r=e&&t.getField(e);return!!r&&T3e.has(r.type)}function P9e(t){return`cast(${t} as float)`}function I3e(t,e){const{format:r,fieldFormat:i,timeZoneOptions:s,fieldType:n}=e??{},o=i?cse(i):null;let a,l;if(s&&({timeZone:a,timeZoneName:l}=rse(s.layerTimeZone,s.datesInUnknownTimezone,s.viewTimeZone,o||$y(r||"short-date-short-time"),n)),typeof t=="string"&&isNaN(Date.parse(n==="time-only"?`1970-01-01T${t}Z`:t)))return t;switch(n){case"date-only":{const c=o||$y(r||"short-date");return typeof t=="string"?hse(t,{...c}):hn(t,{...c,timeZone:ga})}case"time-only":{const c=o||$y(r||"short-time");return typeof t=="string"?dse(t,c):hn(t,{...c,timeZone:ga})}case"timestamp-offset":{if(!a&&typeof t=="string"&&new Date(t).toISOString()!==t)return t;const c=r||o||s?o||$y(r||"short-date-short-time"):void 0,d=c?{...c,timeZone:a,timeZoneName:l}:void 0;return typeof t=="string"?pse(t,d):hn(t,d)}default:{const c=r||o||s?o||$y(r||"short-date-short-time"):void 0;return hn(typeof t=="string"?new Date(t):t,c?{...c,timeZone:a,timeZoneName:l}:void 0)}}}const HW="<",WW=">";function ZW(t,e,r,i){let s="";e===0?s=`${HW} `:e===r&&(s=`${WW} `);const n=Yb(t,i);return n==null?"":s+n}function E3e(t){const{format:e,fieldFormat:r}=t||{};return r?.type==="number"||!!e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)}function Yb(t,e){if(t==null)return t;const{fieldType:r,format:i,fieldFormat:s,timeZoneOptions:n}=e||{};if(EL(r))return I3e(t,{fieldType:r,format:i?.dateFormat,fieldFormat:s?.type==="date-time"?s:void 0,timeZoneOptions:n});if(typeof t=="string"&&E3e(e)){const a=Number(t);isNaN(a)||(t=a)}if(typeof t=="string")return t;const o=s?.type==="number"?yse(s):i?mse(i):void 0;return o?nc(t,o):$3e(t)}const C3e=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function cC(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const e=t.visualVariables.find(o=>o.type==="color");if(!e)return null;let r=null,i=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;r=e.stops[0].value,i=e.stops[e.stops.length-1].value}const s=r!=null&&i!=null?r+(i-r)/2:0,{getColor:n}=await q(async()=>{const{getColor:o}=await Promise.resolve().then(()=>$d);return{getColor:o}},void 0);return n(e,s)??null}async function JW(t,e){const r=t.trailCap,i=t.trailWidth||1,s=e||await cC(t)||t.color;return new Ot({cap:r,color:s,width:i})}function P3e(t,e){if(!e)return null;if("featureReduction"in t)switch(t.featureReduction?.type){case"cluster":case"binning":{const r=t.featureReduction.fields.find(({name:i})=>i.toLowerCase()===e.toLowerCase());return r&&"getField"in t?t.getField(r.onStatisticField):null}}return"getField"in t?t.getField?.(e):null}function k3e(t,e){const r="popupTemplate"in t?t.popupTemplate?.fieldInfos:null;if(r?.length&&e)return r.find(i=>i.fieldName?.toLowerCase()===e.toLowerCase())}function l4(t){let e=0,r=0;return t.stops?(e=t.stops?.at(0)?.value??e,r=t.stops?.at(-1)?.value??r):"minDataValue"in t&&"maxDataValue"in t&&(e=t.minDataValue??e,r=t.maxDataValue??r),r-e>2*yT.days?"short-date":"short-date-short-time"}function EL(t){return["date","date-only","time-only","timestamp-offset"].includes(t||"")}function YW(t){return DP(t)&&!("featureReduction"in t&&t.featureReduction)}function L3e(t,e,r){const i=Xb(t,e.field,r);return i?(EL(i.fieldType)&&(YW(t)?i.fieldFormat??=new Zu({dateStyle:"short",timeStyle:l4(e)==="short-date-short-time"?"short":null}):i.format??=new ha({dateFormat:l4(e)})),i):null}function Xb(t,e,r){const i=P3e(t,e),s=i?.name;if(!s)return null;const n=i?.type,o=YW(t);return{fieldType:n,format:o?null:k3e(t,s)?.format,fieldFormat:o?t.getFieldConfiguration(s)?.fieldFormat:null,timeZoneOptions:EL(n)?{layerTimeZone:"preferredTimeZone"in t?t.preferredTimeZone:null,viewTimeZone:r,datesInUnknownTimezone:"datesInUnknownTimezone"in t&&t.datesInUnknownTimezone}:null}}function oa(t,e){if("authoringInfo"in t)return t.authoringInfo?.visualVariables?.find(({theme:r})=>r===e)}function A3e(t,e){let r=t??"";return e!=null&&e&&(r=r?"("+r+") AND ("+e+")":e),r}const R3e=new K([64,64,64]);function XW(t,e){const r=[],i=t.length-1;return t.length===5?r.push(0,2,4):r.push(0,i),t.map((s,n)=>r.includes(n)?ZW(s,n,i,e):null)}async function u4(t,e,r){let i=!1,s=[],n=[];if(t.stops){const c=t.stops;s=c.map(d=>d.value),i=c.some(d=>!!d.label),i&&(n=c.map(d=>d.label))}const o=s[0],a=s[s.length-1];if(o==null&&a==null)return null;const l=i?null:XW(s,r);return(await Promise.all(s.map(async(c,d)=>{const p=t.type==="opacity"?await O3e(c,t,e):(await q(async()=>{const{getColor:y}=await Promise.resolve().then(()=>$d);return{getColor:y}},void 0)).getColor(t,c),m=i?n[d]:l?.[d]??"";return p==null?null:{value:c,color:p,label:m}}))).filter(fr).reverse()}async function O3e(t,e,r){const i=new K(r??R3e),s=(await q(async()=>{const{getOpacity:n}=await Promise.resolve().then(()=>$d);return{getOpacity:n}},void 0)).getOpacity(e,t);return s!=null&&(i.a=s),i}function F3e(t){let e=!1,r=[],i=[];r=t.map(a=>a.value),e=t.some(a=>!!a.label),e&&(i=t.map(a=>a.label??""));const s=r[0],n=r[r.length-1];if(s==null&&n==null)return null;const o=e?null:XW(r);return r.map((a,l)=>({value:a,color:KW(a,t),label:e?i[l]:o?.[l]??""})).reverse()}function KW(t,e){const{startIndex:r,endIndex:i,weight:s}=N3e(t,e);if(r===i)return e[r].color;const n=K.blendColors(e[r].color,e[i].color,s);return new K(n)}function N3e(t,e){let r=0,i=e.length-1;return e.some((s,n)=>t<s.value?(i=n,!0):(r=n,!1)),{startIndex:r,endIndex:i,weight:(t-e[r].value)/(e[i].value-e[r].value)}}function D3e(t,e){let r=[];if(t&&t.type==="multipart")t.colorRamps.reverse().forEach((i,s)=>{s===0?r.push({value:e.max,color:new K(i.toColor),label:"high"}):r.push({value:null,color:new K(i.toColor),label:""}),s===t.colorRamps.length-1?r.push({value:e.min,color:new K(i.fromColor),label:"low"}):r.push({value:null,color:new K(i.fromColor),label:""})});else{let i,s;t&&t.type==="algorithmic"?(i=t.fromColor,s=t.toColor):(i=[0,0,0,1],s=[255,255,255,1]),r=[{value:e.max,color:new K(s),label:"high"},{value:e.min,color:new K(i),label:"low"}]}return r}function z3e(t){if(!t.colorStops)return[];const e=[...t.colorStops].filter(i=>i.color?.a>0);let r=e.length-1;if(e&&e[0]){const i=e[r];i&&i.ratio!==1&&(e.push(new vl({ratio:1,color:i.color})),r++)}return e.map((i,s)=>{let n="";return s===0?n=t.legendOptions?.minLabel||"low":s===r&&(n=t.legendOptions?.maxLabel||"high"),{color:i.color,label:n,ratio:i.ratio}}).reverse()}const j3e="spike-height-override";function V3e(t){const{strokeColor:e,strokeWidth:r,symbolStyle:i}=t,s=i?.includes("solid-fill")||i?.includes("gradient-fill");let n=e?.toArray(),o=!1;return i?.includes("outline")&&s?o=!0:n=t.color?.toArray(),{type:"CIMSolidStroke",effects:U3e(i),enable:!0,colorLocked:o,capStyle:"Round",joinStyle:"Round",lineStyle3D:"Strip",miterLimit:4,width:r??Ke(1),color:n}}function U3e(t){if(!t?.includes("closed"))return[{type:"CIMGeometricEffectAddControlPoints",angleTolerance:90,primitiveName:"spike-control-points"},{type:"CIMGeometricEffectSuppress",suppress:!0,invert:!0,primitiveName:"spike-stroke-suppress"}]}function c4(t){const{color:e,symbolStyle:r}=t,i=r?.includes("solid-fill"),s=r?.includes("gradient-fill");if(!i&&!s||!e)return;if(i)return{type:"CIMSolidFill",enable:!0,colorLocked:!1,color:e?.toArray()};const n=e.clone();return n.a=0,{type:"CIMGradientFill",enable:!0,angle:90,colorRamp:{type:"CIMMultipartColorRamp",colorRamps:[{type:"CIMLinearContinuousColorRamp",fromColor:e.toArray(),toColor:n.toArray()}],weights:[1]},gradientMethod:"Linear",gradientSize:70,gradientSizeUnits:"Relative",gradientType:"Continuous"}}function QW(t,e){const{defaultHeight:r,baseWidth:i,color:s,strokeColor:n,primitiveOverrides:o,symbolStyle:a,strokeWidth:l}=e,c=t.data.symbol?.type==="CIMPointSymbol"?t.data.symbol:null,d=c?.symbolLayers;if(!d)return t;const p=c.effects,m=p?.find(x=>x.type==="CIMGeometricEffectTaperedPolygon"),y=p?.find(x=>x.type==="CIMGeometricEffectRadial"&&x.primitiveName===j3e);i!=null&&m&&(m.fromWidth=i),r!=null&&y&&(y.length=r);const g=d?.find(x=>x.type==="CIMSolidStroke"),v=d?.find(x=>x.type==="CIMSolidFill"),w=d?.find(x=>x.type==="CIMGradientFill"),_=w?.colorRamp?.type==="CIMMultipartColorRamp"&&w.colorRamp.colorRamps[0]?.type==="CIMLinearContinuousColorRamp"?w.colorRamp.colorRamps[0]:null;if(a){const x=v?.color??_?.fromColor??g?.color,$=s??(x?new K(x):void 0),T=g?.color??x,C=n??(T?new K(T):void 0),P=a.includes("solid-fill"),A=a.includes("gradient-fill");if(P||A||oM(d,v??w),$){if(P)oM(d,w),v?v.color=$?.toArray():d.push(c4({...e,color:$}));else if(A)if(oM(d,v),w){if(_&&s){const F=$.clone();F.a=0,_.fromColor=$.toArray(),_.toColor=F.toArray()}}else d.push(c4({...e,color:$}))}if(g){const F=V3e({...e,strokeColor:C,color:$});g.effects=F.effects,g.color=F.color,g.width=F.width,g.colorLocked=F.colorLocked}}else if(g&&(n&&(g.color=n.toArray()),l!=null&&(g.width=l)),v&&s&&(v.color=s.toArray()),_&&s){const x=s.clone();x.a=0,_.fromColor=s.toArray(),_.toColor=x.toArray()}return o!==void 0&&(t.data.primitiveOverrides=O(o)),t}function oM(t,e){if(!e)return;const r=t.indexOf(e);r!==-1&&t.splice(r,1)}const c_=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],Pm=["","","",""],G3e=["","","",""],q3e=["","","",""],ES=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],B3e=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],H3e=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],W3e=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Z3e=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],h4=["","","","","","","","","","","","",""],J3e=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],d4=["",""],Y3e=["",""],X3e=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],K3e=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],M=0,H=1,ve=2,Wt=3,b=4,Eo=5,Kb=6,S=7,li=8,Ei=9,En=10,Se=11,N=12,Q3e=13,eEe=14,tEe=15,rEe=16,iEe=17,he=18,sEe=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],Mo=100,nEe=[Mo+0,M,M,M,M,Mo+1,Mo+2,Mo+3,H,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,Mo+4,b,b,b,M,b,M,b,M,b,b,b,M,M,b,b,M,M,M,M,M,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,M,M,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,M,M,M,M,M,M,M,M,M,M,M,M,M,M,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,M,M,b,b,M,M,b,b,M,M,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,M,M,M,Mo+5,S,S,Mo+6,Mo+7],oEe=[[he,he,he,he,he,he,he,he,he,Kb,Eo,Kb,li,Eo,he,he,he,he,he,he,he,he,he,he,he,he,he,he,Eo,Eo,Eo,Kb,li,b,b,Se,Se,Se,b,b,b,b,b,En,Ei,En,Ei,Ei,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,Ei,b,b,b,b,b,b,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,b,b,b,b,b,b,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,b,b,b,b,he,he,he,he,he,he,Eo,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,he,Ei,b,Se,Se,Se,Se,b,b,b,b,M,b,b,he,b,b,Se,Se,ve,ve,b,M,b,b,b,ve,M,b,b,b,b,b,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,b,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,b,M,M,M,M,M,M,M,M],[M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,b,b,b,b,b,b,b,b,b,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,b,b,M,M,M,M,M,M,M,b,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,b,M,b,b,b,b,b,b,b,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,H,N,H,N,N,H,N,N,H,N,b,b,b,b,b,b,b,b,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,b,b,b,b,b,H,H,H,H,H,b,b,b,b,b,b,b,b,b,b,b],[Wt,Wt,Wt,Wt,b,b,b,b,S,Se,Se,S,Ei,S,b,b,N,N,N,N,N,N,N,N,N,N,N,S,b,b,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Wt,Wt,Wt,Wt,Wt,Wt,Wt,Wt,Wt,Wt,Se,Wt,Wt,S,S,S,N,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,N,N,N,N,N,N,N,Wt,b,N,N,N,N,N,N,S,S,N,N,b,N,N,N,N,S,S,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,b,S,S,N,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,b,b,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,N,N,N,N,N,N,N,N,N,N,N,S,b,b,b,b,b,b,b,b,b,b,b,b,b,b,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,N,N,N,N,N,N,N,N,N,H,H,b,b,b,b,H,b,b,b,b,b],[li,li,li,li,li,li,li,li,li,li,li,he,he,he,M,H,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,li,Eo,Q3e,eEe,tEe,rEe,iEe,Ei,Se,Se,Se,Se,Se,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,Ei,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,li,he,he,he,he,he,b,b,b,b,b,he,he,he,he,he,he,ve,M,b,b,ve,ve,ve,ve,ve,ve,En,En,b,b,b,M,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,En,En,b,b,b,b,M,M,M,M,M,M,M,M,M,M,M,M,M,b,b,b,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[M,M,M,M,M,M,M,b,b,b,b,b,b,b,b,b,b,b,b,M,M,M,M,M,b,b,b,b,b,H,N,H,H,H,H,H,H,H,H,H,H,En,H,H,H,H,H,H,H,H,H,H,H,H,H,b,H,H,H,H,H,b,H,b,H,H,b,H,H,b,H,H,H,H,H,H,H,H,H,H,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,N,N,N,N,N,N,N,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,Ei,b,Ei,b,b,Ei,b,b,b,b,b,b,b,b,b,Se,b,b,En,En,b,b,b,b,b,Se,Se,b,b,b,b,b,S,S,S,S,S,b,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,b,b,he],[b,b,b,Se,Se,Se,b,b,b,b,b,En,Ei,En,Ei,Ei,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,Ei,b,b,b,b,b,b,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,b,b,b,b,b,b,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,b,b,b,b,b,b,b,b,b,b,b,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,b,b,b,M,M,M,M,M,M,b,b,M,M,M,M,M,M,b,b,M,M,M,M,M,M,b,b,M,M,M,b,b,b,Se,Se,b,b,b,Se,Se,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b]];let aEe=class{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(e,r,i){if(this.sourceToTarget=[],this.targetToSource=[],!e)return"";if($Ee(this.sourceToTarget,this.targetToSource,e.length),!this.checkParameters(r,i))return e;r=this.inputFormat,i=this.outputFormat;let s=e;const n=TEe,o=m4(r.charAt(1)),a=m4(i.charAt(1)),l=(r.startsWith("I")?"L":r.charAt(0))+o,c=(i.startsWith("I")?"L":i.charAt(0))+a,d=r.charAt(2)+i.charAt(2);n.defInFormat=l,n.defOutFormat=c,n.defSwap=d;const p=qg(e,l,c,d,n);let m=!1;return i.charAt(1)==="R"?m=!0:i.charAt(1)!=="C"&&i.charAt(1)!=="D"||(m=this.checkContextual(p)==="rtl"),this.sourceToTarget=As,this.targetToSource=MEe(this.sourceToTarget),PS=this.targetToSource,s=r.charAt(3)===i.charAt(3)?p:i.charAt(3)==="S"?uEe(m,p):dEe(p,m,!0),this.sourceToTarget=As,this.targetToSource=PS,this.levels=hx,s}_inputFormatSetter(e){if(!y4.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=e}_outputFormatSetter(e){if(!y4.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=e}checkParameters(e,r){return e?this._inputFormatSetter(e):e=this.inputFormat,r?this._outputFormatSetter(r):r=this.outputFormat,e!==r}checkContextual(e){let r=CS(e);if(r!=="ltr"&&r!=="rtl"){try{r=document.dir.toLowerCase()}catch{}r!=="ltr"&&r!=="rtl"&&(r="ltr")}return r}hasBidiChar(e){return CEe.test(e)}};function qg(t,e,r,i,s){const n=lEe(t,{inFormat:e,outFormat:r,swap:i},s);if(n.inFormat===n.outFormat)return t;e=n.inFormat,r=n.outFormat,i=n.swap;const o=e.slice(0,1),a=e.slice(1,4),l=r.slice(0,1),c=r.slice(1,4);if(s.inFormat=e,s.outFormat=r,s.swap=i,o==="L"&&r==="VLTR"){if(a==="LTR")return s.dir=Kd,tu(t,s);if(a==="RTL")return s.dir=Bg,tu(t,s)}if(o==="V"&&l==="V")return s.dir=a==="RTL"?Bg:Kd,aM(t,s);if(o==="L"&&r==="VRTL")return a==="LTR"?(s.dir=Kd,t=tu(t,s)):(s.dir=Bg,t=tu(t,s)),aM(t);if(e==="VLTR"&&r==="LLTR")return s.dir=Kd,tu(t,s);if(o==="V"&&l==="L"&&a!==c)return t=aM(t),a==="RTL"?qg(t,"LLTR","VLTR",i,s):qg(t,"LRTL","VRTL",i,s);if(e==="VRTL"&&r==="LRTL")return qg(t,"LRTL","VRTL",i,s);if(o==="L"&&l==="L"){const d=s.swap;return s.swap=d.slice(0,1)+"N",a==="RTL"?(s.dir=Bg,t=tu(t,s),s.swap="N"+d.slice(1,3),s.dir=Kd,t=tu(t,s)):(s.dir=Kd,t=tu(t,s),s.swap="N"+d.slice(1,3),t=qg(t,"VLTR","LRTL",s.swap,s)),t}return t}function lEe(t,e,r){if(e.inFormat===void 0&&(e.inFormat=r.defInFormat),e.outFormat===void 0&&(e.outFormat=r.defOutFormat),e.swap===void 0&&(e.swap=r.defSwap),e.inFormat===e.outFormat)return e;const i=e.inFormat.slice(0,1),s=e.outFormat.slice(0,1);let n,o=e.inFormat.slice(1,4),a=e.outFormat.slice(1,4);return o.startsWith("C")&&(n=CS(t),o=n==="ltr"||n==="rtl"?n.toUpperCase():e.inFormat.charAt(2)==="L"?"LTR":"RTL",e.inFormat=i+o),a.startsWith("C")&&(n=CS(t),n==="rtl"?a="RTL":n==="ltr"?(n=hEe(t),a=n.toUpperCase()):a=e.outFormat.charAt(2)==="L"?"LTR":"RTL",e.outFormat=s+a),e}function uEe(t,e,r){if(e.length===0)return"";t===void 0&&(t=!0);const i=(e=String(e)).split("");let s=0,n=1,o=i.length;t||(s=i.length-1,n=-1,o=1);const a=cEe(i,s,n,o);let l="";for(let c=0;c<i.length;c++)yEe(a,a.length,c)>-1?(rZ(PS,c,!t,-1),As.splice(c,1)):l+=i[c];return l}function cEe(t,e,r,i,s){let n=0;const o=[];let a=0;for(let l=e;l*r<i;l+=r)if(tZ(t[l])||pv(t[l])){if(t[l]===""&&gEe(t,l+r,r,i)){t[l]=xEe(t[l+r],n===0?G3e:q3e),l+=r,SEe(t,l,r,i),o[a]=l,a++,n=0;continue}const c=t[l];n===1?t[l]=p4(t,l+r,r,i)?bEe(t[l]):lM(t[l],H3e):p4(t,l+r,r,i)===!0?t[l]=lM(t[l],Z3e):t[l]=lM(t[l],B3e),pv(c)||(n=1),_Ee(c)===!0&&(n=0)}else n=0;return o}function CS(t){const e=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(t);return e?e[0]<="z"?"ltr":"rtl":""}function hEe(t){const e=t.split("");return e.reverse(),CS(e.join(""))}function dEe(t,e,r){if(t.length===0)return"";e===void 0&&(e=!0);let i="";const s=(t=String(t)).split("");for(let n=0;n<t.length;n++){let o=!1;if(s[n]>=""&&s[n]<"\uFEFF"){const a=t.charCodeAt(n);s[n]>=""&&s[n]<=""?(e?(n>0&&r&&s[n-1]===" "?i=i.slice(0,-1)+"":(i+="",o=!0),i+=Pm[(a-65269)/2]):(i+=Pm[(a-65269)/2],i+="",n+1<t.length&&r&&s[n+1]===" "?n++:o=!0),o&&(rZ(PS,n,!0,1),As.splice(n,0,As[n]))):i+=J3e[a-65136]}else i+=s[n]}return i}function tu(t,e){const r=t.split(""),i=[];return eZ(r,i,e),fEe(r,i,e),f4(2,r,i,e),f4(1,r,i,e),hx=i,r.join("")}function eZ(t,e,r){const i=t.length,s=r.dir?K3e:X3e;let n=0,o=-1;const a=[],l=[];r.hiLevel=r.dir,r.lastArabic=!1,r.hasUbatAl=!1,r.hasUbatB=!1,r.hasUbatS=!1;for(let c=0;c<i;c++)a[c]=mEe(t[c]);for(let c=0;c<i;c++){const d=n,p=vEe(t,a,l,c,r);l[c]=p,n=s[d][p];const m=240&n;n&=15;const y=s[n][IEe];if(e[c]=y,m>0)if(m===16){for(let g=o;g<c;g++)e[g]=1;o=-1}else o=-1;if(s[n][EEe])o===-1&&(o=c);else if(o>-1){for(let g=o;g<c;g++)e[g]=y;o=-1}a[c]===Eo&&(e[c]=0),r.hiLevel|=y}r.hasUbatS&&pEe(a,e,i,r)}function pEe(t,e,r,i){for(let s=0;s<r;s++)if(t[s]===Kb){e[s]=i.dir;for(let n=s-1;n>=0&&t[n]===li;n--)e[n]=i.dir}}function fEe(t,e,r){if(r.hiLevel!==0&&r.swap[0]!==r.swap[1])for(let i=0;i<t.length;i++)e[i]===1&&(t[i]=wEe(t[i]))}function mEe(t){const e=t.charCodeAt(0),r=nEe[e>>8];return r<Mo?r:oEe[r-Mo][255&e]}function aM(t,e){const r=t.split("");if(e){const i=[];eZ(r,i,e),hx=i}return r.reverse(),As.reverse(),r.join("")}function yEe(t,e,r){for(let i=0;i<e;i++)if(t[i]===r)return i;return-1}function tZ(t){for(let e=0;e<d4.length;e++)if(t>=d4[e]&&t<=Y3e[e])return!0;return!1}function p4(t,e,r,i){for(;e*r<i&&pv(t[e]);)e+=r;return!!(e*r<i&&tZ(t[e]))}function gEe(t,e,r,i){for(;e*r<i&&pv(t[e]);)e+=r;let s=" ";if(!(e*r<i))return!1;s=t[e];for(let n=0;n<Pm.length;n++)if(Pm[n]===s)return!0;return!1}function f4(t,e,r,i){if(i.hiLevel<t)return;if(t===1&&i.dir===Bg&&!i.hasUbatB)return e.reverse(),void As.reverse();const s=e.length;let n,o,a,l,c,d=0;for(;d<s;){if(r[d]>=t){for(n=d+1;n<s&&r[n]>=t;)n++;for(o=d,a=n-1;o<a;o++,a--)l=e[o],e[o]=e[a],e[a]=l,c=As[o],As[o]=As[a],As[a]=c;d=n}d++}}function vEe(t,e,r,i,s){const n=e[i];return{UBAT_L:()=>(s.lastArabic=!1,M),UBAT_R:()=>(s.lastArabic=!1,H),UBAT_ON:()=>b,UBAT_AN:()=>Wt,UBAT_EN:()=>s.lastArabic?Wt:ve,UBAT_AL:()=>(s.lastArabic=!0,s.hasUbatAl=!0,H),UBAT_WS:()=>b,UBAT_CS:()=>{let o,a;return i<1||i+1>=e.length||(o=r[i-1])!==ve&&o!==Wt||(a=e[i+1])!==ve&&a!==Wt?b:(s.lastArabic&&(a=Wt),a===o?a:b)},UBAT_ES:()=>(i>0?r[i-1]:Eo)===ve&&i+1<e.length&&e[i+1]===ve?ve:b,UBAT_ET:()=>{if(i>0&&r[i-1]===ve)return ve;if(s.lastArabic)return b;let o=i+1;const a=e.length;for(;o<a&&e[o]===Se;)o++;return o<a&&e[o]===ve?ve:b},UBAT_NSM:()=>{if(s.inFormat==="VLTR"){const o=e.length;let a=i+1;for(;a<o&&e[a]===N;)a++;if(a<o){const l=t[i].charCodeAt(0),c=l>=1425&&l<=2303||l===64286,d=e[a];if(c&&(d===H||d===S))return H}}return i<1||e[i-1]===Eo?b:r[i-1]},UBAT_B:()=>(s.lastArabic=!0,s.hasUbatB=!0,s.dir),UBAT_S:()=>(s.hasUbatS=!0,b),UBAT_LRE:()=>(s.lastArabic=!1,b),UBAT_RLE:()=>(s.lastArabic=!1,b),UBAT_LRO:()=>(s.lastArabic=!1,b),UBAT_RLO:()=>(s.lastArabic=!1,b),UBAT_PDF:()=>(s.lastArabic=!1,b),UBAT_BN:()=>b}[sEe[n]]()}function wEe(t){let e,r=0,i=c_.length-1;for(;r<=i;)if(e=Math.floor((r+i)/2),t<c_[e][0])i=e-1;else{if(!(t>c_[e][0]))return c_[e][1];r=e+1}return t}function _Ee(t){for(let e=0;e<h4.length;e++)if(h4[e]===t)return!0;return!1}function bEe(t){for(let e=0;e<ES.length;e++)if(t===ES[e])return W3e[e];return t}function lM(t,e){for(let r=0;r<ES.length;r++)if(t===ES[r])return e[r];return t}function pv(t){return t>=""&&t<=""}function m4(t){return t==="L"?"LTR":t==="R"?"RTL":t==="C"?"CLR":t==="D"?"CRL":""}function SEe(t,e,r,i){for(;e*r<i&&pv(t[e]);)e+=r;return e*r<i&&(t[e]=" ",!0)}function xEe(t,e){for(let r=0;r<Pm.length;r++)if(t===Pm[r])return e[r];return t}function $Ee(t,e,r){As=[],hx=[];for(let i=0;i<r;i++)t[i]=i,e[i]=i,As[i]=i}function MEe(t){const e=new Array(t.length);for(let r=0;r<t.length;r++)e[t[r]]=r;return e}function rZ(t,e,r,i){for(let s=0;s<t.length;s++)(t[s]>e||!r&&t[s]===e)&&(t[s]+=i)}let As=[],PS=[],hx=[];const TEe={dir:0,defInFormat:"LLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,defOutFormat:""},IEe=5,EEe=6,Kd=0,Bg=1,y4=/^[(I|V)][(L|RCD)][(Y|N)][(S|N)]N$/,CEe=/[\u0591-\u06ff\ufb1d-\ufefc]/,uM=new aEe;function PEe(t){if(t==null)return["",!1];if(!uM.hasBidiChar(t))return[t,!1];let e;return e=uM.checkContextual(t)==="rtl"?"IDNNN":"ICNNN",[uM.bidiTransform(t,e,"VLYSN"),!0]}function kEe(t){return 32+t.length}const iZ=16;function L9e(t){if(!t)return 0;let e=PL;for(const r in t)t.hasOwnProperty(r)&&(e+=CL(t[r],!1));return e}function LEe(t){if(!t)return 0;if(typeof t[0]=="number")return sZ(t);if(Array.isArray(t))return AEe(t);let e=PL;for(const r in t)t.hasOwnProperty(r)&&(e+=CL(t[r]));return e}function AEe(t){const e=t.length;if(e===0||typeof t[0]=="number")return nZ(t,8);let r=oZ;for(let i=0;i<e;i++)r+=CL(t[i]);return r}function CL(t,e=!0){switch(typeof t){case"object":return e?LEe(t):PL;case"string":return kEe(t);case"number":return iZ;case"boolean":return 4;default:return 8}}function sZ(...t){return t.reduce((e,r)=>e+(r?lz(r)?r.byteLength+REe:Array.isArray(r)?nZ(r,iZ):0:0),0)}function nZ(t,e){return oZ+t.length*e}const PL=32,oZ=16,REe=145,Oc=2;let kS=class Bp{constructor(e=[],r=[]){this.lengths=e??[],this.coords=r??[]}static fromJSON(e){return new Bp(e.lengths,e.coords)}static fromRect(e){const[r,i,s,n]=e,o=s-r,a=n-i;return new Bp([5],[r,i,o,0,0,a,-o,0,0,-a])}get isPoint(){return this.lengths.length===0&&this.coords.length>=2}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((e,r)=>e+r)}get usedMemory(){return 64+sZ(this.lengths,this.coords)}area(){let e=0,r=0;if(!this.lengths.length)return 0;for(let i=0;i<this.lengths.length;i++){const s=this.lengths[i];if(s<3)continue;let n=this.coords[Oc*r],o=this.coords[Oc*r+1];for(let a=1;a<s;a+=1){const l=this.coords[Oc*(a+r)],c=this.coords[Oc*(a+r)+1];e+=-.5*(l-n)*(c+o),n=l,o=c}r+=s}return e}forEachVertex(e){let r=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let i=0;i<this.lengths.length;i++){const s=this.lengths[i];for(let n=0;n<s;n++)e(this.coords[Oc*(n+r)],this.coords[Oc*(n+r)+1]);r+=s}}deltaDecode(){const e=this.clone(),{coords:r,lengths:i}=e;let s=0;for(const n of i){for(let o=1;o<n;o++)r[2*(s+o)]+=r[2*(s+o)-2],r[2*(s+o)+1]+=r[2*(s+o)-1];s+=n}return e}clone(e){if(this.lengths.length===0)return new Bp([],[this.coords[0],this.coords[1]]);const r=(this.lengths.length===0?1:this.lengths.reduce((s,n)=>s+n))*Oc,i=this.coords.slice(0,r);return e?(e.set(i),new Bp(this.lengths,e)):new Bp(Array.from(this.lengths),Array.from(i))}},Qe=class{static fromOptimized(e,r,i=!1,s=!1,n=1){return new hC().initialize(e,r,i,s,n)}static fromJSON(e,r=!1,i=!1){const[s,n]=g4(e);return new pC().initialize(s,n,r,i,1)}static fromOptimizedCIM(e,r,i=!1,s=!1,n=1){return new v4().initialize(e,r,i,s,n)}static fromJSONCIM(e,r=!1,i=!1,s=1){const[n,o]=g4(e);return new w4().initialize(n,o,r,i,s)}static fromFeatureSetReader(e){const r=e.readGeometryForDisplay(),i=e.geometryType;return r&&i?this.fromOptimized(r,i):null}static fromFeatureSetReaderCIM(e){const r=e.readGeometryForDisplay(),i=e.geometryType;return r&&i?this.fromOptimizedCIM(r,i):null}static createEmptyOptimized(e,r=!1,i=!1,s=1){return new hC().initialize(new kS,e,r,i,s)}static createEmptyJSON(e,r=!1,i=!1){return new pC().initialize([],e,r,i,1)}static createEmptyOptimizedCIM(e,r=!1,i=!1,s=1){return new v4().initialize(new kS,e,r,i,s)}static createEmptyJSONCIM(e,r=!1,i=!1,s=1){return new w4().initialize([],e,r,i,s)}asJSON(){const e=m2(this);return this.geometryType==="esriGeometryEnvelope"?{xmin:e[0][0][0],ymin:e[0][0][1],xmax:e[0][2][0],ymax:e[0][2][1]}:this.geometryType==="esriGeometryMultipoint"?{points:e.flat()}:this.geometryType==="esriGeometryPoint"?{x:e[0][0][0],y:e[0][0][1]}:this.geometryType==="esriGeometryPolygon"?{rings:e}:{paths:e}}getCurrentRingArea(){if(this.pathSize<3)return 0;let e,r,i=0;if(this.seekPathStart(),!this.nextPoint())return 0;e=this.x,r=this.y;const s=e,n=r;for(;this.nextPoint();)i+=(e-this.x)*(r+this.y),e=this.x,r=this.y;return i+=(e-s)*(r+n),-.5*i}invertY(){this.yFactor*=-1}},hC=class dC extends Qe{constructor(){super(...arguments),this._end=-1}initialize(e,r,i,s,n){return this.hasZ=i,this.hasM=s,this.geometryType=r,this._stride=2+Number(i)+Number(s),this._geometry=e,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=n,this}reset(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)}seekPath(e){if(e>=0&&e<this.totalSize){if(this._pathIndex<e)for(;this._pathIndex<e&&this.nextPath(););else if(this._pathIndex>e)for(;this._pathIndex>e&&this.prevPath(););return!0}return!1}seekPathStart(){this._pointOffset=this._pathOffset-this._stride}seekPathEnd(){this._pointOffset=this._end}seekInPath(e){const r=this._pathOffset+e*this._stride;return r>=0&&r<this._end&&(this._pointOffset=r,!0)}nextPoint(){return(this._pointOffset+=this._stride)<this._end}prevPoint(){return(this._pointOffset-=this._stride)>=this._pathOffset}nextPath(){return!(this.pathIndex>=this.totalSize-1)&&(this._pathIndex>=0&&(this._pathOffset+=this._stride*this.pathSize),this._pathIndex++,this._pointOffset=this._pathOffset-this._stride,this._end=this._pointOffset+this._stride+this._stride*this.pathSize,!0)}prevPath(){return!(this.pathIndex<=0)&&(this._pathIndex--,this._end=this._pathOffset,this._pathOffset-=this._stride*this.pathSize,this._pointOffset=this._pathOffset-this._stride,!0)}getCurrentPath(){const e=this._end,r=this._geometry.coords,i=this._pathOffset;return new dC().initialize(new kS([this.pathSize],r.slice(i,e)),this.geometryType,this.hasZ,this.hasM,this.yFactor)}pathLength(){const e=this._end,r=this._stride,i=this._geometry.coords;let s=0;for(let n=this._pathOffset+r;n<e;n+=r){const o=i[n-r],a=i[n-r+1],l=i[n]-o,c=i[n+1]-a;s+=Math.sqrt(l*l+c*c)}return s}startPath(){this._geometry.lengths.push(0)}pushPath(e){this.startPath(),this.pushPoints(e)}pushPoint(e){for(let r=0;r<this._stride;++r)this._geometry.coords.push(e[r]);this._geometry.lengths[this.totalSize-1]++}pushXY(e,r){this._geometry.coords.push(e,r),this._geometry.lengths[this.totalSize-1]++}pushPoints(e){for(const r of e)for(let i=0;i<this._stride;++i)this._geometry.coords.push(r[i]);this._geometry.lengths[this.totalSize-1]+=e.length}pushCursor(e){const r=e.asOptimized();this._geometry.coords.push(...r.coords),this._geometry.lengths.push(...r.lengths)}asOptimized(){const e=this._geometry.clone();if(this.yFactor!==1)for(let r=1;r<e.coords.length;r+=this._stride)e.coords[r]*=this.yFactor;return this.geometryType==="esriGeometryPoint"&&(e.lengths.length=0),e}isClosed(){const e=this._geometry.coords,r=this._pathOffset,i=this._end-this._stride;for(let s=0;s<this._stride;s++)if(e[r+s]!==e[i+s])return!1;return!0}clone(){return new dC().initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._geometry.isPoint?1:this._geometry.lengths.reduce((e,r)=>e+r)}get pathSize(){const{lengths:e}=this._geometry;return this._geometry.isPoint?1:this._pathIndex<0||this._pathIndex>e.length-1?0:e[this._pathIndex]}get totalSize(){return this._geometry.isPoint?1:this._geometry.lengths.length}get x(){return this._geometry.coords[this._pointOffset]}set x(e){this._geometry.coords[this._pointOffset]=e}get y(){return this.yFactor*this._geometry.coords[this._pointOffset+1]}set y(e){this._geometry.coords[this._pointOffset+1]=this.yFactor*e}get z(){return this._geometry.coords[this._pointOffset+2]}set z(e){this._geometry.coords[this._pointOffset+2]=e}get m(){const e=this.hasZ?3:2;return this._geometry.coords[this._pointOffset+e]}set m(e){this._geometry.coords[this._pointOffset+3]=e}get pathIndex(){return this._pathIndex}get _coordIndex(){return this._pointOffset/this._stride}};function OEe(t){const e=[t.x,t.y];return t.z&&e.push(t.z),t.m&&e.push(t.m),e}function g4(t){return Kt(t)?[t.rings,"esriGeometryPolygon"]:Xr(t)?[t.paths,"esriGeometryPolyline"]:Pf(t)?[[t.points],"esriGeometryMultipoint"]:Ni(t)?[[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]],"esriGeometryEnvelope"]:Z0(t)?[[[OEe(t)]],"esriGeometryPoint"]:[[],"esriGeometryPolyline"]}let pC=class fC extends Qe{initialize(e,r,i,s,n){return this._paths=e,this.geometryType=r,this.hasZ=i,this.hasM=s,this._pathIndex=this._pointIndex=-1,this.yFactor=n,this._mIndex=this.hasZ?3:2,this}reset(){this._pathIndex=this._pointIndex=-1}seekPath(e){return this._pathIndex=e,this._pointIndex=-1,e>=0&&e<this.totalSize&&(this._currentPath=this._paths[e],!0)}seekPathStart(){this._pointIndex=-1}seekPathEnd(){this._pointIndex=this._currentPath.length}seekInPath(e){return e>=0&&e<this._currentPath.length&&(this._pointIndex=e,this._currentPoint=this._currentPath[this._pointIndex],!0)}nextPoint(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}prevPoint(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}nextPath(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.totalSize}prevPath(){return this.pathIndex>0&&(this._pointIndex=-1,this._pathIndex--,this._currentPath=this._paths[this._pathIndex],!0)}pathLength(){const e=this._currentPath.length,r=this._currentPath;let i=0;for(let s=1;s<e;s++){const n=r[s-1],o=r[s],a=n[0],l=n[1],c=o[0]-a,d=o[1]-l;i+=Math.sqrt(c*c+d*d)}return i}startPath(){this._paths.push([])}getCurrentPath(){return new fC().initialize([this._currentPath],this.geometryType,this.hasZ,this.hasM,this.yFactor)}pushPath(e){this._paths.push(e)}pushPoint(e){this._paths[this.totalSize-1].push(e)}pushXY(e,r){this._paths[this.totalSize-1].push([e,r])}pushPoints(e){this._paths[this.totalSize-1].push(...e)}pushCursor(e){const r=m2(e);for(const i of r)this.pushPath(i)}asOptimized(){const e=new kS;if(this.geometryType==="esriGeometryPoint")e.coords.push(...this._paths[0][0]),e.lengths.length=0;else for(const r of this._paths){for(const i of r)e.coords.push(i[0]),e.coords.push(i[1]*this.yFactor),this.hasZ&&e.coords.push(i[2]),this.hasM&&e.coords.push(i[this._mIndex]);e.lengths.push(r.length)}return e}isClosed(){const e=this._currentPath[0],r=this._currentPath[this._currentPath.length-1];for(let i=0;i<e.length;i++)if(e[i]!==r[i])return!1;return!0}clone(){return new fC().initialize(O(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._paths.map(e=>e.length).reduce((e,r)=>e+r)}get pathSize(){return this._pathIndex<0||this._pathIndex>this.totalSize-1?-1:this._paths[this._pathIndex].length}get totalSize(){return this._paths.length}get x(){return this._currentPoint[0]}set x(e){this._currentPoint[0]=e}get y(){return this.yFactor*this._currentPoint[1]}set y(e){this._currentPoint[1]=this.yFactor*e}get z(){return this._currentPoint[2]}set z(e){this._currentPoint[2]=e}get m(){return this._currentPoint[this._mIndex]}set m(e){this._currentPoint[this._mIndex]=e}get pathIndex(){return this._pathIndex}};const h_=4,d_=1;let v4=class aZ extends hC{initialize(e,r,i,s,n){return super.initialize(e,r,i,s,n),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.totalSize).fill(void 0).map(o=>new Set)),this}startPath(){super.startPath(),this._controlPoints.push(new Set)}clone(){const e=new aZ().initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return e._controlPoints=this._controlPoints,e}setControlPoint(){this._controlPoints[this.pathIndex].add(this._coordIndex)}getControlPoint(){return this._controlPoints[this.pathIndex].has(this._coordIndex)}setControlPointAt(e){this._controlPoints[this.pathIndex].add(e)}getControlPointAt(e){return this._controlPoints[this.pathIndex].has(e)}},w4=class lZ extends pC{initialize(e,r,i,s,n){return super.initialize(e,r,i,s,n)}clone(){return new lZ().initialize(O(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}setControlPoint(){this._paths[this.pathIndex][this._pointIndex][h_]=d_}getControlPoint(){return this._paths[this.pathIndex][this._pointIndex][h_]===d_}setControlPointAt(e){this._paths[this.pathIndex][e][h_]=d_}getControlPointAt(e){return this._paths[this.pathIndex][e][h_]===d_}};const FEe=512;let qe=class Hg{constructor(e,r){this.x=e,this.y=r}static fromArray(e){return new Hg(e[0],e[1])}clone(){return new Hg(this.x,this.y)}equals(e,r){return e===this.x&&r===this.y}isEqual(e){return e.x===this.x&&e.y===this.y}setCoords(e,r){return this.x=e,this.y=r,this}normalize(){const e=this.x,r=this.y,i=Math.sqrt(e*e+r*r);return this.x/=i,this.y/=i,this}rightPerpendicular(){const e=this.x;return this.x=this.y,this.y=-e,this}leftPerpendicular(){const e=this.x;return this.x=-this.y,this.y=e,this}move(e,r){return this.x+=e,this.y+=r,this}assign(e){return this.x=e.x,this.y=e.y,this}assignAdd(e,r){return this.x=e.x+r.x,this.y=e.y+r.y,this}assignSub(e,r){return this.x=e.x-r.x,this.y=e.y-r.y,this}rotate(e,r){const i=this.x,s=this.y;return this.x=i*e-s*r,this.y=i*r+s*e,this}rotateReverse(e,r){const i=this.x,s=this.y;return this.x=i*e+s*r,this.y=-i*r+s*e,this}scale(e){return this.x*=e,this.y*=e,this}length(){const e=this.x,r=this.y;return Math.sqrt(e*e+r*r)}sub(e){return this.x-=e.x,this.y-=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}static distance(e,r){const i=r.x-e.x,s=r.y-e.y;return Math.sqrt(i*i+s*s)}static add(e,r){return new Hg(e.x+r.x,e.y+r.y)}static sub(e,r){return new Hg(e.x-r.x,e.y-r.y)}},p_=class{constructor(e,r,i){this.ratio=e,this.x=r,this.y=i}},NEe=class{constructor(e,r,i,s=8,n=8){this._lines=[],this._starts=[],this.validateTessellation=!0,this._pixelRatio=s,this._pixelMargin=n,this._tileSize=FEe*s,this._dz=e,this._yPos=r,this._xPos=i}setPixelMargin(e){e!==this._pixelMargin&&(this._pixelMargin=e,this.setExtent(this._extent))}setExtent(e){this._extent=e,this._finalRatio=this._tileSize/e*(1<<this._dz);let r=this._pixelRatio*this._pixelMargin;r/=this._finalRatio;const i=e>>this._dz;r>i&&(r=i),this._margin=r,this._xmin=i*this._xPos-r,this._ymin=i*this._yPos-r,this._xmax=this._xmin+i+2*r,this._ymax=this._ymin+i+2*r}reset(e){this._type=e,this._lines=[],this._starts=[],this._line=null,this._start=0}moveTo(e,r){this._pushLine(),this._prevIsIn=this._isIn(e,r),this._moveTo(e,r,this._prevIsIn),this._prevPt=new qe(e,r),this._firstPt=new qe(e,r),this._dist=0}lineTo(e,r){const i=this._isIn(e,r),s=new qe(e,r),n=qe.distance(this._prevPt,s);let o,a,l,c,d,p,m,y;if(i)this._prevIsIn?this._lineTo(e,r,!0):(o=this._prevPt,a=s,l=this._intersect(a,o),this._start=this._dist+n*(1-this._r),this._lineTo(l.x,l.y,!0),this._lineTo(a.x,a.y,!0));else if(this._prevIsIn)a=this._prevPt,o=s,l=this._intersect(a,o),this._lineTo(l.x,l.y,!0),this._lineTo(o.x,o.y,!1);else{const g=this._prevPt,v=s;if(g.x<=this._xmin&&v.x<=this._xmin||g.x>=this._xmax&&v.x>=this._xmax||g.y<=this._ymin&&v.y<=this._ymin||g.y>=this._ymax&&v.y>=this._ymax)this._lineTo(v.x,v.y,!1);else{const w=[];if((g.x<this._xmin&&v.x>this._xmin||g.x>this._xmin&&v.x<this._xmin)&&(c=(this._xmin-g.x)/(v.x-g.x),y=g.y+c*(v.y-g.y),y<=this._ymin?p=!1:y>=this._ymax?p=!0:w.push(new p_(c,this._xmin,y))),(g.x<this._xmax&&v.x>this._xmax||g.x>this._xmax&&v.x<this._xmax)&&(c=(this._xmax-g.x)/(v.x-g.x),y=g.y+c*(v.y-g.y),y<=this._ymin?p=!1:y>=this._ymax?p=!0:w.push(new p_(c,this._xmax,y))),(g.y<this._ymin&&v.y>this._ymin||g.y>this._ymin&&v.y<this._ymin)&&(c=(this._ymin-g.y)/(v.y-g.y),m=g.x+c*(v.x-g.x),m<=this._xmin?d=!1:m>=this._xmax?d=!0:w.push(new p_(c,m,this._ymin))),(g.y<this._ymax&&v.y>this._ymax||g.y>this._ymax&&v.y<this._ymax)&&(c=(this._ymax-g.y)/(v.y-g.y),m=g.x+c*(v.x-g.x),m<=this._xmin?d=!1:m>=this._xmax?d=!0:w.push(new p_(c,m,this._ymax))),w.length===0)d?p?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):p?this._lineTo(this._xmin,this._ymax,!0):this._lineTo(this._xmin,this._ymin,!0);else if(w.length>1&&w[0].ratio>w[1].ratio)this._start=this._dist+n*w[1].ratio,this._lineTo(w[1].x,w[1].y,!0),this._lineTo(w[0].x,w[0].y,!0);else{this._start=this._dist+n*w[0].ratio;for(let _=0;_<w.length;_++)this._lineTo(w[_].x,w[_].y,!0)}this._lineTo(v.x,v.y,!1)}}this._dist+=n,this._prevIsIn=i,this._prevPt=s}close(){if(this._line.length>2){const e=this._firstPt,r=this._prevPt;e.x===r.x&&e.y===r.y||this.lineTo(e.x,e.y);const i=this._line;let s=i.length;for(;s>=4&&(i[0].x===i[1].x&&i[0].x===i[s-2].x||i[0].y===i[1].y&&i[0].y===i[s-2].y);)i.pop(),i[0].x=i[s-2].x,i[0].y=i[s-2].y,--s}}result(e=!0){return this._pushLine(),this._lines.length===0?null:(this._type===3&&e&&DEe.simplify(this._tileSize,this._margin*this._finalRatio,this._lines),this._lines)}resultWithStarts(){if(this._type!==2)throw new Error("Only valid for lines");this._pushLine();const e=this._lines,r=e.length;if(r===0)return null;const i=[];for(let s=0;s<r;s++)i.push({line:e[s],start:this._starts[s]||0});return i}_isIn(e,r){return e>=this._xmin&&e<=this._xmax&&r>=this._ymin&&r<=this._ymax}_intersect(e,r){let i,s,n;if(r.x>=this._xmin&&r.x<=this._xmax)s=r.y<=this._ymin?this._ymin:this._ymax,n=(s-e.y)/(r.y-e.y),i=e.x+n*(r.x-e.x);else if(r.y>=this._ymin&&r.y<=this._ymax)i=r.x<=this._xmin?this._xmin:this._xmax,n=(i-e.x)/(r.x-e.x),s=e.y+n*(r.y-e.y);else{s=r.y<=this._ymin?this._ymin:this._ymax,i=r.x<=this._xmin?this._xmin:this._xmax;const o=(i-e.x)/(r.x-e.x),a=(s-e.y)/(r.y-e.y);o<a?(n=o,s=e.y+o*(r.y-e.y)):(n=a,i=e.x+a*(r.x-e.x))}return this._r=n,new qe(i,s)}_pushLine(){this._line&&(this._type===1?this._line.length>0&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===2?this._line.length>1&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===3&&this._line.length>3&&(this._lines.push(this._line),this._starts.push(this._start))),this._line=[],this._start=0}_moveTo(e,r,i){this._type!==3?i&&(e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line.push(new qe(e,r))):(i||(e<this._xmin&&(e=this._xmin),e>this._xmax&&(e=this._xmax),r<this._ymin&&(r=this._ymin),r>this._ymax&&(r=this._ymax)),e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line.push(new qe(e,r)),this._isH=!1,this._isV=!1)}_lineTo(e,r,i){let s,n;if(this._type!==3)if(i){if(e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line.length>0&&(s=this._line[this._line.length-1],s.equals(e,r)))return;this._line.push(new qe(e,r))}else this._line&&this._line.length>0&&this._pushLine();else if(i||(e<this._xmin&&(e=this._xmin),e>this._xmax&&(e=this._xmax),r<this._ymin&&(r=this._ymin),r>this._ymax&&(r=this._ymax)),e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line&&this._line.length>0){s=this._line[this._line.length-1];const o=s.x===e,a=s.y===r;if(o&&a)return;this._isH&&o||this._isV&&a?(s.x=e,s.y=r,n=this._line[this._line.length-2],n.x===e&&n.y===r?(this._line.pop(),this._line.length<=1?(this._isH=!1,this._isV=!1):(n=this._line[this._line.length-2],this._isH=n.x===e,this._isV=n.y===r)):(this._isH=n.x===e,this._isV=n.y===r)):(this._line.push(new qe(e,r)),this._isH=o,this._isV=a)}else this._line.push(new qe(e,r))}},F9e=class{setExtent(e){this._ratio=e===4096?1:4096/e}get validateTessellation(){return this._ratio<1}reset(e){this._lines=[],this._line=null}moveTo(e,r){this._line&&this._lines.push(this._line),this._line=[];const i=this._ratio;this._line.push(new qe(e*i,r*i))}lineTo(e,r){const i=this._ratio;this._line.push(new qe(e*i,r*i))}close(){const e=this._line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])}result(){return this._line&&this._lines.push(this._line),this._lines.length===0?null:this._lines}},DEe=class gu{static simplify(e,r,i){if(!i)return;const s=-r,n=e+r,o=-r,a=e+r,l=[],c=[],d=i.length;for(let m=0;m<d;++m){const y=i[m];if(!y||y.length<2)continue;let g,v=y[0];const w=y.length;for(let _=1;_<w;++_)g=y[_],v.x===g.x&&(v.x<=s&&(v.y>g.y?(l.push(m),l.push(_),l.push(0),l.push(-1)):(c.push(m),c.push(_),c.push(0),c.push(-1))),v.x>=n&&(v.y<g.y?(l.push(m),l.push(_),l.push(1),l.push(-1)):(c.push(m),c.push(_),c.push(1),c.push(-1)))),v.y===g.y&&(v.y<=o&&(v.x<g.x?(l.push(m),l.push(_),l.push(2),l.push(-1)):(c.push(m),c.push(_),c.push(2),c.push(-1))),v.y>=a&&(v.x>g.x?(l.push(m),l.push(_),l.push(3),l.push(-1)):(c.push(m),c.push(_),c.push(3),c.push(-1)))),v=g}if(l.length===0||c.length===0)return;gu.fillParent(i,c,l),gu.fillParent(i,l,c);const p=[];gu.calcDeltas(p,c,l),gu.calcDeltas(p,l,c),gu.addDeltas(p,i)}static fillParent(e,r,i){const s=i.length,n=r.length;for(let o=0;o<n;o+=4){const a=r[o],l=r[o+1],c=r[o+2],d=e[a][l-1],p=e[a][l];let m=8092,y=-1;for(let g=0;g<s;g+=4){if(i[g+2]!==c)continue;const v=i[g],w=i[g+1],_=e[v][w-1],x=e[v][w];switch(c){case 0:case 1:if(f_(d.y,_.y,x.y)&&f_(p.y,_.y,x.y)){const $=Math.abs(x.y-_.y);$<m&&(m=$,y=g)}break;case 2:case 3:if(f_(d.x,_.x,x.x)&&f_(p.x,_.x,x.x)){const $=Math.abs(x.x-_.x);$<m&&(m=$,y=g)}}}r[o+3]=y}}static calcDeltas(e,r,i){const s=r.length;for(let n=0;n<s;n+=4){const o=[],a=gu.calcDelta(n,r,i,o);e.push(r[n]),e.push(r[n+1]),e.push(r[n+2]),e.push(a)}}static calcDelta(e,r,i,s){const n=r[e+3];if(n===-1)return 0;const o=s.length;return o>1&&s[o-2]===n?0:(s.push(n),gu.calcDelta(n,i,r,s)+1)}static addDeltas(e,r){const i=e.length;let s=0;for(let n=0;n<i;n+=4){const o=e[n+3];o>s&&(s=o)}for(let n=0;n<i;n+=4){const o=r[e[n]],a=e[n+1],l=s-e[n+3];switch(e[n+2]){case 0:o[a-1].x-=l,o[a].x-=l,a===1&&(o[o.length-1].x-=l),a===o.length-1&&(o[0].x-=l);break;case 1:o[a-1].x+=l,o[a].x+=l,a===1&&(o[o.length-1].x+=l),a===o.length-1&&(o[0].x+=l);break;case 2:o[a-1].y-=l,o[a].y-=l,a===1&&(o[o.length-1].y-=l),a===o.length-1&&(o[0].y-=l);break;case 3:o[a-1].y+=l,o[a].y+=l,a===1&&(o[o.length-1].y+=l),a===o.length-1&&(o[0].y+=l)}}}};const f_=(t,e,r)=>t>=e&&t<=r||t>=r&&t<=e,kL=Md(()=>q(()=>import("./bufferOperator-n-Wjtv1g.js"),__vite__mapDeps([306,307,16,260,262,263,264,265,308,309,310,311,267]))),uZ=Md(()=>q(()=>import("./convexHullOperator-BY0hFZn-.js"),__vite__mapDeps([312,313,16,260,262,263,264,265,267]))),cZ=Md(()=>q(()=>import("./lengthOperator-DSCZAWEp.js"),__vite__mapDeps([314,267,260,262,263,264,16,265]))),hZ=Md(()=>q(()=>import("./generalizeOperator-DJ-GPQra.js"),__vite__mapDeps([315,316,16,311,260,262,263,264,265,267]))),dZ=Md(()=>q(()=>import("./graphicBufferOperator-VOZ-nDCF.js"),__vite__mapDeps([317,16,260,262,263,264,265,308,309,310,311,267]))),pZ=Md(()=>q(()=>import("./offsetOperator-CGjLy633.js"),__vite__mapDeps([318,319,16,262,260,263,264,265,267]))),fZ=Md(()=>q(()=>import("./simplifyOperator-DXSlJQjq.js"),__vite__mapDeps([320,269,16,260,262,263,264,265,267]))),zEe=512;let Pa;function _4(t){switch(t.type){case"CIMGeometricEffectDonut":case"CIMGeometricEffectBuffer":return kL.getImportPromise();case"CIMGeometricEffectEnclosingPolygon":return uZ.getImportPromise();case"CIMGeometricEffectOffset":return Promise.all([pZ.getImportPromise(),dZ.getImportPromise()]);case"CIMGeometricEffectTaperedPolygon":return Promise.all([fZ.getImportPromise(),cZ.getImportPromise(),hZ.getImportPromise()]);default:return Promise.resolve()}}let jEe=class{constructor(e){this._geometry=e}next(){const e=this._geometry;return this._geometry=null,e}};function LL(t,e,r){if(!t)return null;Pa||(Pa=new NEe(0,0,0,1));const i=r?-1:1,s=t.geometryType==="esriGeometryPolygon",n=s?3:2,o=s?3:2;let a,l;for(Pa.reset(n),Pa.setPixelMargin(e+1),Pa.setExtent(zEe);t.nextPath();)if(!(t.pathSize<o)){for(t.nextPoint(),a=t.x,l=i*t.y,Pa.moveTo(a,l);t.nextPoint();)a=t.x,l=i*t.y,Pa.lineTo(a,l);s&&Pa.close()}const c=Pa.result(!1);if(c){const d=Qe.createEmptyOptimizedCIM(t.geometryType);for(const p of c){d.startPath();for(const m of p)d.pushXY(m.x,i*m.y)}return d.reset(),d}return null}let oy=class{constructor(){this.setIdentity()}getAngle(){return(this.rz==null||this.rz===0&&this.rzCos!==1&&this.rzSin!==0)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0}setTranslate(e,r){this.tx=e,this.ty=r}setTranslateZ(e){this.tz=e}setRotateCS(e,r){this.rz=void 0,this.rzCos=e,this.rzSin=r}setRotate(e){this.rz=e,this.rzCos=void 0,this.rzSin=void 0}setRotateY(e){this.ry=e}setScale(e){this.s=e}setMeasure(e){this.m=e}};const AL="arial-unicode-ms",b4="woff2",S4=new Map,mZ=new Set;let VEe=class{constructor(e,r){this.fontFace=e,this.promise=r}};async function UEe(t){const e=BEe(t),r=qEe(t),i=S4.get(e);if(i)return i.promise;const s=new FontFace(t.family,`url('${De.fontsUrl}/woff2/${r}.${b4}') format('${b4}')`,{style:t.style,weight:t.weight}),n=document.fonts;if(n.has(s)&&s.status==="loading")return s.loaded;const o=s.load().then(()=>(n.add(s),s));return S4.set(e,new VEe(s,o)),mZ.add(s),o}function V9e(t){return mZ.has(t)}function GEe(t){if(!t)return AL;const e=t.toLowerCase().split(" ").join("-");switch(e){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return e}}function qEe(t){const e=yZ(t)+gZ(t);return GEe(t.family)+(e.length>0?e:"-regular")}function BEe(t){const e=yZ(t)+gZ(t);return(t.family||AL)+(e.length>0?e:"-regular")}function yZ(t){if(!t.weight)return"";switch(t.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}function gZ(t){if(!t.style)return"";switch(t.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}let HEe=class{applyColorSubstitution(e,r){if(!r)return e;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:i,height:s}=e,n=this._rasterizationCanvas,o=n.getContext("2d",{willReadFrequently:!0});e!==n&&(n.width=i,n.height=s,o.drawImage(e,0,0,i,s));const a=o.getImageData(0,0,i,s).data;if(r){for(const c of r)if(c&&c.oldColor&&c.oldColor.length===4&&c.newColor&&c.newColor.length===4){const[d,p,m,y]=c.oldColor,[g,v,w,_]=c.newColor;if(d===g&&p===v&&m===w&&y===_)continue;for(let x=0;x<a.length;x+=4)d===a[x]&&p===a[x+1]&&m===a[x+2]&&y===a[x+3]&&(a[x]=g,a[x+1]=v,a[x+2]=w,a[x+3]=_)}}const l=new ImageData(a,i,s);return o.putImageData(l,0,0),n}tintImageData(e,r){if(!r||r.length<4)return e;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:i,height:s}=e,n=this._rasterizationCanvas,o=n.getContext("2d",{willReadFrequently:!0});e!==n&&(n.width=i,n.height=s,o.drawImage(e,0,0,i,s));const a=o.getImageData(0,0,i,s),l=new Uint8Array(a.data),c=[r[0]/255,r[1]/255,r[2]/255,r[3]/255];for(let p=0;p<l.length;p+=4)l[p]*=c[0],l[p+1]*=c[1],l[p+2]*=c[2],l[p+3]*=c[3];const d=new ImageData(new Uint8ClampedArray(l.buffer),i,s);return o.putImageData(d,0,0),n}};var Oo;let WEe=(Oo=class{static local(){return Oo.instance===null&&(Oo.instance=new Oo),Oo.instance}execute(e,r){return new ZEe(e,r)}},Oo.instance=null,Oo),ZEe=class{constructor(e,r){this._inputGeometries=e,this._angleTolerance=r.angleTolerance!==void 0?r.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let e=this._inputGeometries.next();if(!e)return null;for(;e;){if(e.geometryType==="esriGeometryPolygon")this._isClosed=!0;else if(e.geometryType==="esriGeometryPolyline")this._isClosed=!1;else{if(e.geometryType!=="esriGeometryEnvelope"){e=this._inputGeometries.next();continue}if(this._maxCosAngle)return e;this._isClosed=!0}for(;e.nextPath();)this._processPath(e);return e.reset(),e}return null}_processPath(e){if(e.nextPoint()){const r=e.x,i=e.y;let s=r,n=i,o=e.pathSize,a=0,l=0,c=0,d=0,p=0,m=0;this._isClosed&&++o;for(let y=1;e.nextPoint()||y<o;++y){let g,v;this._isClosed&&y===o-1?(g=r,v=i):(g=e.x,v=e.y);const w=g-s,_=v-n,x=Math.sqrt(w*w+_*_);y>1&&x>0&&c>0&&(a*w+l*_)/x/c<=this._maxCosAngle&&e.setControlPointAt(y-1),y===1&&(d=w,p=_,m=x),x>0&&(s=g,n=v,a=w,l=_,c=x)}this._isClosed&&c>0&&m>0&&(a*d+l*p)/m/c<=this._maxCosAngle&&e.setControlPointAt(0)}}};function qy(t,e){t[4]=e}let rw=class{constructor(e,r=!0,i=!0,s=0){this.isClosed=!1,this.geometryCursor=null,this.geometryCursor=!r&&e.geometryType==="esriGeometryPolygon"||!i&&e.geometryType==="esriGeometryPolyline"?null:e,this.geomUnitsPerPoint=s,this.iterateMultiPath=!1,this.iteratePath=!1,this.internalPlacement=new oy}next(){if(!this.geometryCursor)return null;const e=this.processMultiPath(this.geometryCursor);return this.iterateMultiPath&&e||(this.geometryCursor=null),e}processMultiPath(e){for(;this.iteratePath||e.pathIndex<e.totalSize-1;){this.iteratePath||e.nextPath(),this.iterateMultiPath=!0;const r=this.processPath(e);if(r)return r}return this.iterateMultiPath=!1,null}},ay=class{constructor(e,r,i,s=0){this.isClosed=!1,this.inputGeometries=e,this.acceptPolygon=r,this.acceptPolyline=i,this.geomUnitsPerPoint=s,this.iteratePath=!1,this.multiPathCursor=null}next(){for(;;){if(!this.multiPathCursor){let e=this.inputGeometries.next();for(;e&&(this.isClosed=this.acceptPolygon&&e.geometryType==="esriGeometryPolygon"||e.geometryType==="esriGeometryEnvelope",this.multiPathCursor=e,!this.multiPathCursor);)e=this.inputGeometries.next();if(!this.multiPathCursor)return null}for(;this.iteratePath||this.multiPathCursor.nextPath();){this.multiPathCursor.seekPathStart();const e=this.processPath(this.multiPathCursor);if(e)return e}this.multiPathCursor=null}}};const fv=.03;let Nl=class{constructor(e=0,r=!1){}isEmpty(e){if(!e.nextPoint())return!0;let r,i,s,n;for(r=e.x,i=e.y;e.nextPoint();r=i,i=n)if(s=e.x,n=e.y,s!==r||n!==i)return e.seekPathStart(),!1;return e.seekPathStart(),!0}normalize(e){const r=Math.sqrt(e[0]*e[0]+e[1]*e[1]);r!==0&&(e[0]/=r,e[1]/=r)}getLength(e,r,i,s){const n=i-e,o=s-r;return Math.sqrt(n*n+o*o)}getSegLength(e){const[[r,i],[s,n]]=e;return this.getLength(r,i,s,n)}getCoord2D(e,r,i,s,n){return[e+(i-e)*n,r+(s-r)*n]}getSegCoord2D(e,r){const[[i,s],[n,o]]=e;return this.getCoord2D(i,s,n,o,r)}getAngle(e,r,i,s,n){const o=i-e,a=s-r;return Math.atan2(a,o)}getAngleCS(e,r,i,s,n,o){e==null&&(e=[0,0]);const a=s-r,l=n-i,c=Math.sqrt(a*a+l*l);return c!==0?(e[0]=a/c,e[1]=l/c,e):(e[0]=1,e[1]=0,e)}getSegAngleCS(e,r,i){const[[s,n],[o,a]]=r;return this.getAngleCS(e,s,n,o,a,i)}cut(e,r,i,s,n,o){return[n<=0?[e,r]:this.getCoord2D(e,r,i,s,n),o>=1?[i,s]:this.getCoord2D(e,r,i,s,o)]}getSubCurve(e,r,i){const s=Qe.createEmptyOptimizedCIM("esriGeometryPolyline");return this.appendSubCurve(s,e,r,i)?s:null}appendSubCurve(e,r,i,s){e.startPath(),r.seekPathStart();let n=0,o=!0;if(!r.nextPoint())return!1;let a=r.x,l=r.y;for(;r.nextPoint();){const c=this.getLength(a,l,r.x,r.y);if(c!==0){if(o){if(n+c>i){const d=(i-n)/c;let p=1,m=!1;n+c>=s&&(p=(s-n)/c,m=!0);const y=this.cut(a,l,r.x,r.y,d,p);if(y&&e.pushPoints(y),m)break;o=!1}}else{if(n+c>s){const d=this.cut(a,l,r.x,r.y,0,(s-n)/c);d&&e.pushPoint(d[1]);break}e.pushXY(r.x,r.y)}n+=c,a=r.x,l=r.y}else a=r.x,l=r.y}return!0}getCIMPointAlong(e,r){if(!e.nextPoint())return null;let i,s,n,o,a=0;for(i=e.x,s=e.y;e.nextPoint();i=n,s=o){n=e.x,o=e.y;const l=this.getLength(i,s,n,o);if(l!==0){if(a+l>r){const c=(r-a)/l;return this.getCoord2D(i,s,n,o,c)}a+=l}}return null}offset(e,r,i,s,n){if(!e||e.length<2)return null;let o=0,a=e[o++],l=o;for(;o<e.length;){const m=e[o];m[0]===a[0]&&m[1]===a[1]||(o!==l&&(e[l]=e[o]),a=e[l++]),o++}const c=e[0][0]===e[l-1][0]&&e[0][1]===e[l-1][1];if(c&&--l,l<(c?3:2))return null;const d=[];a=c?e[l-1]:null;let p=e[0];for(let m=0;m<l;m++){const y=m===l-1?c?e[0]:null:e[m+1];if(a)if(y){const g=[y[0]-p[0],y[1]-p[1]];this.normalize(g);const v=[p[0]-a[0],p[1]-a[1]];this.normalize(v);const w=v[0]*g[1]-v[1]*g[0],_=v[0]*g[0]+v[1]*g[1];if(w===0&&_===1){p=y;continue}if(w>=0==r<=0){if(_<1){const x=[g[0]-v[0],g[1]-v[1]];this.normalize(x);const $=Math.sqrt((1+_)/2);if($>1/s){const T=-Math.abs(r)/$;d.push([p[0]-x[0]*T,p[1]-x[1]*T])}}}else switch(i){case"Mitered":{const x=Math.sqrt((1+_)/2);if(x>0&&1/x<s){const $=[g[0]-v[0],g[1]-v[1]];this.normalize($);const T=Math.abs(r)/x;d.push([p[0]-$[0]*T,p[1]-$[1]*T]);break}}case"Bevelled":d.push([p[0]+v[1]*r,p[1]-v[0]*r]),d.push([p[0]+g[1]*r,p[1]-g[0]*r]);break;case"Rounded":if(_<1){d.push([p[0]+v[1]*r,p[1]-v[0]*r]);const x=Math.floor(2.5*(1-_));if(x>0){const $=1/x;let T=$;for(let C=1;C<x;C++,T+=$){const P=[v[1]*(1-T)+g[1]*T,-v[0]*(1-T)-g[0]*T];this.normalize(P),d.push([p[0]+P[0]*r,p[1]+P[1]*r])}}d.push([p[0]+g[1]*r,p[1]-g[0]*r])}break;default:if(w<0)d.push([p[0]+(v[1]+v[0])*r,p[1]+(v[1]-v[0])*r]),d.push([p[0]+(g[1]-g[0])*r,p[1]-(g[0]+g[1])*r]);else{const x=Math.sqrt((1+Math.abs(_))/2),$=[g[0]-v[0],g[1]-v[1]];this.normalize($);const T=r/x;d.push([p[0]-$[0]*T,p[1]-$[1]*T])}}}else{const g=[p[0]-a[0],p[1]-a[1]];this.normalize(g),d.push([p[0]+g[1]*r,p[1]-g[0]*r])}else{const g=[y[0]-p[0],y[1]-p[1]];this.normalize(g),d.push([p[0]+g[1]*r,p[1]-g[0]*r])}a=p,p=y}return d.length<(c?3:2)?null:(c&&d.push([d[0][0],d[0][1]]),d)}};const cM=1.7320508075688772,JEe=5,YEe="OpenEnded";var Fo;let XEe=(Fo=class{static local(){return Fo.instance===null&&(Fo.instance=new Fo),Fo.instance}execute(e,r,i){return new KEe(e,r,i)}},Fo.instance=null,Fo),KEe=class extends ay{constructor(e,r,i){super(e,!1,!0),this._curveHelper=new Nl,this._width=(r.width!==void 0?r.width:JEe)*i,this._arrowType=r.geometricEffectArrowType!==void 0?r.geometricEffectArrowType:r.arrowType!==void 0?r.arrowType:YEe,this._offsetFlattenError=fv*i}processPath(e){const r=Qe.createEmptyOptimizedCIM(e.geometryType);switch(this._arrowType){case"OpenEnded":default:this._constructSimpleArrow(r,e,!0);break;case"Block":this._constructSimpleArrow(r,e,!1);break;case"Crossed":this._constructCrossedArrow(r,e)}return r}_constructSimpleArrow(e,r,i){const s=r.pathLength();let n=this._width;s<2*n&&(n=s/2);const o=this._curveHelper.getSubCurve(r,0,s-n);if(!o||!o.nextPath())return;o.seekPathStart();const a=n/2;if(this._curveHelper.isEmpty(o))return;const l=Wu(o),c=this._constructOffset(l,-a);if(!c)return;const d=this._constructOffset(l,a);if(!d)return;const p=this._constructArrowBasePoint(c,-a/2);if(!p)return;const m=this._constructArrowBasePoint(d,a/2);if(!m)return;r.seekInPath(r.pathSize-1);const y=[r.x,r.y];e.pushPath(d),e.nextPath(),e.nextPoint(),e.setControlPoint(),e.pushPoint(m),e.nextPoint(),e.setControlPoint(),e.pushPoint(y),e.nextPoint(),e.setControlPoint(),e.pushPoint(p),e.nextPoint(),e.setControlPoint(),e.pushPoints(c.reverse()),e.setControlPoint(),i||(e.setControlPointAt(0),e.setControlPointAt(e.pathSize-1),e.pushPoint(d[0])),e.reset()}_constructCrossedArrow(e,r){const i=r.pathLength();let s=this._width;i<s*(1+cM+1)&&(s=i/(1+cM+1)),r.seekPathStart();const n=this._curveHelper.getSubCurve(r,0,i-s*(1+cM));if(!n)return;n.nextPath();const o=s/2;if(this._curveHelper.isEmpty(n))return;const a=Wu(n),l=this._constructOffset(a,o);if(!l)return;const c=this._constructOffset(a,-o);if(!c)return;const d=this._curveHelper.getSubCurve(r,0,i-s);if(!d||(d.nextPath(),this._curveHelper.isEmpty(d)))return;const p=Wu(d),m=this._constructOffset(p,o);if(!m)return;const y=this._constructOffset(p,-o);if(!y)return;const g=m[m.length-1],v=this._constructArrowBasePoint(m,o/2);if(!v)return;const w=y[y.length-1],_=this._constructArrowBasePoint(y,-o/2);if(!_)return;r.seekInPath(r.pathSize-1);const x=[r.x,r.y];e.pushPath(l),e.nextPath(),e.nextPoint(),e.setControlPoint(),e.pushPoint(w),e.nextPoint(),e.setControlPoint(),e.pushPoint(_),e.nextPoint(),e.setControlPoint(),e.pushPoint(x),e.nextPoint(),e.setControlPoint(),e.pushPoint(v),e.nextPoint(),e.setControlPoint(),e.pushPoint(g),e.nextPoint(),e.setControlPoint(),e.pushPoints(c.reverse()),e.nextPoint(),e.setControlPoint(),e.reset()}_constructOffset(e,r){return this._curveHelper.offset(e,r,"Rounded",4,this._offsetFlattenError)}_constructArrowBasePoint(e,r){if(!e||e.length<2)return null;const i=e[e.length-2],s=e[e.length-1],n=[s[0]-i[0],s[1]-i[1]];return this._curveHelper.normalize(n),[s[0]+n[1]*r,s[1]-n[0]*r]}};var No;let QEe=(No=class{static local(){return No.instance===null&&(No.instance=new No),No.instance}execute(e,r,i,s,n,o){return new eCe(e,r,i,s,n,o)}},No.instance=null,No),eCe=class{constructor(e,r,i,s,n,o){this._preventClipping=o,this._inputGeometries=e,this._tileKey=s,this._curveHelper=new Nl,this._size=(r.size!==void 0?r.size:1)*i,this._maxInflateSize=n*i,this._offsetFlattenError=fv*i}next(){let e;for(;e=this._inputGeometries.next();){if(this._size===0)return e;if(e.geometryType==="esriGeometryEnvelope"){if(this._size>0){const o=Qe.createEmptyOptimizedCIM(e.geometryType),a=m2(e)[0],l=this._curveHelper.offset(a,this._size,"Rounded",4,this._offsetFlattenError);if(l)return o.pushPath(l),o}else if(this._size<0){const o=e.asJSON();if(Math.min(o.xmax-o.xmin,o.ymax-o.ymin)+2*this._size>0)return Qe.fromJSONCIM({xmin:o.xmin-this._size,xmax:o.xmax+this._size,ymin:o.ymin-this._size,ymax:o.ymax+this._size})}}const r=!this._preventClipping&&this._tileKey?LL(e,this._maxInflateSize,!0):e;if(!r)continue;const i=kL.module,s={...r.asJSON(),spatialReference:{wkid:ne.WebMercator.wkid}},n=i.execute(s,this._size);return n?Qe.fromJSONCIM(n):null}return null}};var Do;let tCe=(Do=class{static local(){return Do.instance===null&&(Do.instance=new Do),Do.instance}execute(e,r,i){return new rCe(e,r,i)}},Do.instance=null,Do),rCe=class{constructor(e,r,i){this._defaultPointSize=20,this._inputGeometries=e,this._geomUnitsPerPoint=i,this._rule=r.rule??"FullGeometry",this._defaultSize=this._defaultPointSize*i}next(){let e;for(;e=this._inputGeometries.next();){const r=this._processGeom(m2(e));if(r?.length)return Qe.fromJSONCIM({paths:r})}return null}_clone(e){return[e[0],e[1]]}_mid(e,r){return[(e[0]+r[0])/2,(e[1]+r[1])/2]}_mix(e,r,i,s){return[e[0]*r+i[0]*s,e[1]*r+i[1]*s]}_add(e,r){return[e[0]+r[0],e[1]+r[1]]}_add2(e,r,i){return[e[0]+r,e[1]+i]}_sub(e,r){return[e[0]-r[0],e[1]-r[1]]}_dist(e,r){return Math.sqrt((e[0]-r[0])*(e[0]-r[0])+(e[1]-r[1])*(e[1]-r[1]))}_norm(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}_normalize(e,r=1){const i=r/this._norm(e);e[0]*=i,e[1]*=i}_leftPerpendicular(e){const r=-e[1],i=e[0];e[0]=r,e[1]=i}_leftPerp(e){return[-e[1],e[0]]}_rightPerpendicular(e){const r=e[1],i=-e[0];e[0]=r,e[1]=i}_rightPerp(e){return[e[1],-e[0]]}_dotProduct(e,r){return e[0]*r[0]+e[1]*r[1]}_crossProduct(e,r){return e[0]*r[1]-e[1]*r[0]}_rotateDirect(e,r,i){const s=e[0]*r-e[1]*i,n=e[0]*i+e[1]*r;e[0]=s,e[1]=n}_makeCtrlPt(e){const r=[e[0],e[1]];return qy(r,1),r}_addAngledTicks(e,r,i,s){const n=this._sub(i,r);this._normalize(n);const o=this._crossProduct(n,this._sub(s,r));let a;a=o>0?this._rightPerp(n):this._leftPerp(n);const l=Math.abs(o)/2,c=[];c.push([r[0]+(a[0]-n[0])*l,r[1]+(a[1]-n[1])*l]),c.push(r),c.push(i),c.push([i[0]+(a[0]+n[0])*l,i[1]+(a[1]+n[1])*l]),e.push(c)}_addBezier2(e,r,i,s,n){if(n--===0)return void e.push(s);const o=this._mid(r,i),a=this._mid(i,s),l=this._mid(o,a);this._addBezier2(e,r,o,l,n),this._addBezier2(e,l,a,s,n)}_addBezier3(e,r,i,s,n,o){if(o--===0)return void e.push(n);const a=this._mid(r,i),l=this._mid(i,s),c=this._mid(s,n),d=this._mid(a,l),p=this._mid(l,c),m=this._mid(d,p);this._addBezier3(e,r,a,d,m,o),this._addBezier3(e,m,p,c,n,o)}_add90DegArc(e,r,i,s,n){const o=n??this._crossProduct(this._sub(i,r),this._sub(s,r))>0,a=this._mid(r,i),l=this._sub(a,r);o?this._leftPerpendicular(l):this._rightPerpendicular(l),a[0]+=l[0],a[1]+=l[1],this._addBezier3(e,r,this._mix(r,.33333,a,.66667),this._mix(i,.33333,a,.66667),i,4)}_addArrow(e,r,i){const s=r[0],n=r[1],o=r[r.length-1],a=this._sub(s,n),l=this._norm(a);this._normalize(a);const c=Math.abs(this._crossProduct(a,this._sub(o,n)));let d=this._dotProduct(a,this._sub(o,n));d<.05*l?d=.05*l:d>.95*l&&(d=.95*l);const p=.5*c,m=this._leftPerp(a),y=[n[0]+a[0]*d,n[1]+a[1]*d],g=r.length-1,v=[];v.push(i?[-m[0],-m[1]]:m);let w=[-a[0],-a[1]];for(let _=1;_<g-1;_++){const x=this._sub(r[_+1],r[_]);this._normalize(x);const $=this._dotProduct(x,w),T=this._crossProduct(x,w),C=Math.sqrt((1+$)/2),P=this._sub(x,w);this._normalize(P),P[0]/=C,P[1]/=C,v.push(T<0?[-P[0],-P[1]]:P),w=x}v.push(this._rightPerp(w));for(let _=v.length-1;_>0;_--)e.push([r[_][0]+v[_][0]*p,r[_][1]+v[_][1]*p]);e.push([y[0]+v[0][0]*p,y[1]+v[0][1]*p]),e.push([y[0]+v[0][0]*c,y[1]+v[0][1]*c]),e.push(s),e.push([y[0]-v[0][0]*c,y[1]-v[0][1]*c]),e.push([y[0]-v[0][0]*p,y[1]-v[0][1]*p]);for(let _=1;_<v.length;_++)e.push([r[_][0]-v[_][0]*p,r[_][1]-v[_][1]*p])}_addDash(e,r,i){const s=this._norm(i)/7;this._normalize(i);let n=[];for(let o=0;o<=7;o++)n.push([r[0]+i[0]*o*s,r[1]+i[1]*o*s]),1&o&&(e.push(n),n=[])}_cp2(e,r,i){return e.length>=2?e[1]:this._add2(e[0],r*this._defaultSize,i*this._defaultSize)}_cp3(e,r,i,s){if(e.length>=3)return e[2];const n=this._mix(e[0],1-i,r,i),o=this._sub(r,e[0]);return this._normalize(o),this._rightPerpendicular(o),[n[0]+o[0]*s*this._defaultSize,n[1]+o[1]*s*this._defaultSize]}_arrowPath(e){if(e.length>2)return e;const r=e[0],i=this._cp2(e,-4,0),s=this._sub(r,i);this._normalize(s);const n=this._rightPerp(s);return[r,i,[r[0]+(n[0]-s[0])*this._defaultSize,r[1]+(n[1]-s[1])*this._defaultSize]]}_arrowLastSeg(e){const r=e[0],i=this._cp2(e,-4,0);let s;if(e.length>=3)s=e[e.length-1];else{const n=this._sub(r,i);this._normalize(n);const o=this._rightPerp(n);s=[r[0]+(o[0]-n[0])*this._defaultSize,r[1]+(o[1]-n[1])*this._defaultSize]}return[i,s]}_processGeom(e){if(!e)return null;const r=[];for(const i of e){const s=i.length>1&&$ne(i)<this._defaultSize;if(!i||i.length===0||s)continue;const n=i.length;let o=i[0];switch(this._rule){case"PerpendicularFromFirstSegment":{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,4),c=[];c.push(l),c.push(this._mid(o,a)),r.push(c);break}case"ReversedFirstSegment":{const a=this._cp2(i,0,-1);r.push([a,o]);break}case"PerpendicularToSecondSegment":{if(i.length<3)return[];const a=this._cp2(i,-4,1),l=this._cp3(i,a,.882353,-1.94),c=[];c.push(this._mid(a,l)),c.push(o),r.push(c);break}case"SecondSegmentWithTicks":{if(i.length<3)return[];const a=this._cp2(i,-4,1),l=this._cp3(i,a,.882353,-1.94),c=this._sub(l,a);let d;d=this._crossProduct(c,this._sub(o,a))>0?this._rightPerp(c):this._leftPerp(c);const p=[];p.push([a[0]+(d[0]-c[0])/3,a[1]+(d[1]-c[1])/3]),p.push(a),p.push(l),p.push([l[0]+(d[0]+c[0])/3,l[1]+(d[1]+c[1])/3]),r.push(p);break}case"DoublePerpendicular":{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,3),c=this._mid(o,a),d=this._sub(c,l);this._normalize(d);const p=this._crossProduct(d,this._sub(o,l));this._leftPerpendicular(d);const m=[];m.push(o),m.push([l[0]+d[0]*p,l[1]+d[1]*p]),r.push(m);const y=[];y.push([l[0]-d[0]*p,l[1]-d[1]*p]),y.push(a),r.push(y);break}case"OppositeToFirstSegment":{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,3),c=this._mid(o,a),d=this._sub(c,l);this._normalize(d);const p=this._crossProduct(d,this._sub(o,l));this._leftPerpendicular(d);const m=[];m.push([l[0]+d[0]*p,l[1]+d[1]*p]),m.push([l[0]-d[0]*p,l[1]-d[1]*p]),r.push(m);break}case"TriplePerpendicular":{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,4),c=this._mid(o,a),d=this._sub(c,l);this._normalize(d);const p=this._crossProduct(d,this._sub(o,l));this._leftPerpendicular(d);const m=[];m.push([l[0]+d[0]*p*.8,l[1]+d[1]*p*.8]),m.push([c[0]+.8*(o[0]-c[0]),c[1]+.8*(o[1]-c[1])]),r.push(m),r.push([l,c]);const y=[];y.push([l[0]-d[0]*p*.8,l[1]-d[1]*p*.8]),y.push([c[0]+.8*(a[0]-c[0]),c[1]+.8*(a[1]-c[1])]),r.push(y);break}case"HalfCircleFirstSegment":{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,4),c=this._mid(o,a);let d=this._sub(a,o);const p=Math.cos(Math.PI/18),m=Math.sin(Math.PI/18),y=Math.sqrt((1+p)/2),g=Math.sqrt((1-p)/2),v=[];let w;this._crossProduct(d,this._sub(l,o))>0?(v.push(o),d=this._sub(o,c),w=a):(v.push(a),d=this._sub(a,c),w=o),this._rotateDirect(d,y,g),d[0]/=y,d[1]/=y;for(let _=1;_<=18;_++)v.push(this._add(c,d)),this._rotateDirect(d,p,m);v.push(w),r.push(v);break}case"HalfCircleSecondSegment":{const a=this._cp2(i,0,-1),l=this._cp3(i,a,1,-1);let c=this._sub(o,a);this._normalize(c);const d=this._crossProduct(c,this._sub(l,a))/2;this._leftPerpendicular(c);const p=[a[0]+c[0]*d,a[1]+c[1]*d];c=this._sub(a,p);const m=Math.cos(Math.PI/18);let y=Math.sin(Math.PI/18);d>0&&(y=-y);const g=[a];for(let v=1;v<=18;v++)this._rotateDirect(c,m,y),g.push(this._add(p,c));r.push(g);break}case"HalfCircleExtended":{const a=this._cp2(i,0,-2),l=this._cp3(i,a,1,-1);let c;if(n>=4)c=i[3];else{const v=this._sub(o,a);c=this._add(l,v)}const d=this._dist(a,l)/2/.75,p=this._sub(a,o);this._normalize(p,d);const m=this._sub(l,c);this._normalize(m,d);const y=[c,l];r.push(y);const g=[this._clone(l)];this._addBezier3(g,l,this._add(l,m),this._add(a,p),a,4),g.push(o),r.push(g);break}case"OpenCircle":{const a=this._cp2(i,-2,0),l=this._sub(a,o),c=Math.cos(Math.PI/18),d=-Math.sin(Math.PI/18),p=[a];for(let m=1;m<=33;m++)this._rotateDirect(l,c,d),p.push(this._add(o,l));r.push(p);break}case"CoverageEdgesWithTicks":{const a=this._cp2(i,0,-1);let l,c;if(n>=3)l=i[2];else{const y=this._sub(a,o),g=this._leftPerp(y);l=[o[0]+g[0]-.25*y[0],o[1]+g[1]-.25*y[1]]}if(n>=4)c=i[3];else{const y=this._mid(o,a),g=this._sub(o,a);this._normalize(g),this._leftPerpendicular(g);const v=this._crossProduct(g,this._sub(l,y));this._rightPerpendicular(g),c=[l[0]+g[0]*v*2,l[1]+g[1]*v*2]}const d=this._sub(a,o);let p,m;p=this._crossProduct(d,this._sub(l,o))>0?this._rightPerp(d):this._leftPerp(d),m=[],m.push(l),m.push(o),m.push([o[0]+(p[0]-d[0])/3,o[1]+(p[1]-d[1])/3]),r.push(m),p=this._crossProduct(d,this._sub(c,a))>0?this._rightPerp(d):this._leftPerp(d),m=[],m.push([a[0]+(p[0]+d[0])/3,a[1]+(p[1]+d[1])/3]),m.push(a),m.push(c),r.push(m);break}case"GapExtentWithDoubleTicks":{const a=this._cp2(i,0,2),l=this._cp3(i,a,0,1);let c;if(n>=4)c=i[3];else{const d=this._sub(a,o);c=this._add(l,d)}this._addAngledTicks(r,o,a,this._mid(l,c)),this._addAngledTicks(r,l,c,this._mid(o,a));break}case"GapExtentMidline":{const a=this._cp2(i,2,0),l=this._cp3(i,a,0,1);let c;if(n>=4)c=i[3];else{const p=this._sub(a,o);c=this._add(l,p)}const d=[];d.push(this._mid(o,l)),d.push(this._mid(a,c)),r.push(d);break}case"Chevron":{const a=this._cp2(i,-1,-1);let l;if(n>=3)l=i[2];else{const c=this._sub(a,o);this._leftPerpendicular(c),l=this._add(o,c)}r.push([a,this._makeCtrlPt(o),l]);break}case"PerpendicularWithArc":{const a=this._cp2(i,0,-2),l=this._cp3(i,a,.5,-1),c=this._sub(a,o),d=this._norm(c);c[0]/=d,c[1]/=d;const p=this._crossProduct(c,this._sub(l,o));let m=this._dotProduct(c,this._sub(l,o));m<.05*d?m=.05*d:m>.95*d&&(m=.95*d);const y=[o[0]+c[0]*m,o[1]+c[1]*m];let g=this._leftPerp(c),v=[];if(v.push([y[0]-g[0]*p,y[1]-g[1]*p]),v.push([y[0]+g[0]*p,y[1]+g[1]*p]),r.push(v),n>=4){const $=i[3];let T=this._dotProduct(c,this._sub($,o));T<.1*d?T=.1*d:T>.9*d&&(T=.9*d);const C=[o[0]+c[0]*T,o[1]+c[1]*T],P=this._crossProduct(c,this._sub($,o)),A=[];A.push([C[0]-g[0]*P,C[1]-g[1]*P]),A.push([C[0]+g[0]*P,C[1]+g[1]*P]),r.push(A)}const w=[a[0]+g[0]*p,a[1]+g[1]*p];g=this._sub(a,w);const _=Math.cos(Math.PI/18);let x=Math.sin(Math.PI/18);p<0&&(x=-x),v=[o,a];for(let $=1;$<=9;$++)this._rotateDirect(g,_,x),v.push(this._add(w,g));r.push(v);break}case"ClosedHalfCircle":{const a=this._cp2(i,2,0),l=this._mid(o,a),c=this._sub(a,l),d=Math.cos(Math.PI/18),p=Math.sin(Math.PI/18),m=[o,a];for(let y=1;y<=18;y++)this._rotateDirect(c,d,p),m.push(this._add(l,c));r.push(m);break}case"TripleParallelExtended":{const a=this._cp2(i,0,-2),l=this._cp3(i,a,1,-2),c=this._mid(o,a),d=this._sub(l,a);this._normalize(d);const p=Math.abs(this._crossProduct(d,this._sub(c,a)))/2,m=this._dist(a,l),y=[a,o];y.push([o[0]+d[0]*m*.5,o[1]+d[1]*m*.5]),r.push(y);const g=[];g.push([c[0]-d[0]*p,c[1]-d[1]*p]),g.push([c[0]+d[0]*m*.375,c[1]+d[1]*m*.375]),qy(g[g.length-1],1),g.push([c[0]+d[0]*m*.75,c[1]+d[1]*m*.75]),r.push(g);const v=[a,l];r.push(v);break}case"ParallelWithTicks":{const a=this._cp2(i,3,0),l=this._cp3(i,a,.5,-1),c=this._sub(l,a);this._normalize(c);const d=this._crossProduct(c,this._sub(l,o));this._leftPerpendicular(c),this._addAngledTicks(r,o,a,l),this._addAngledTicks(r,this._mix(o,1,c,d),this._mix(a,1,c,d),this._mid(o,a));break}case"Parallel":{const a=this._cp2(i,3,0),l=this._cp3(i,a,.5,-1),c=this._sub(a,o);this._normalize(c);const d=this._leftPerp(c),p=this._crossProduct(c,this._sub(l,o));let m=[o,a];r.push(m),m=[],m.push([o[0]+d[0]*p,o[1]+d[1]*p]),m.push([a[0]+d[0]*p,a[1]+d[1]*p]),r.push(m);break}case"PerpendicularToFirstSegment":{const a=this._cp2(i,3,0),l=this._cp3(i,a,.5,-1),c=this._mid(o,a),d=this._sub(a,o);this._normalize(d);const p=this._crossProduct(d,this._sub(l,o));this._leftPerpendicular(d);const m=[];m.push([c[0]-d[0]*p*.25,c[1]-d[1]*p*.25]),m.push([c[0]+d[0]*p*1.25,c[1]+d[1]*p*1.25]),r.push(m);break}case"ParallelOffset":{const a=this._cp2(i,3,0),l=this._cp3(i,a,.5,-1),c=this._sub(a,o);this._normalize(c);const d=this._crossProduct(c,this._sub(l,o));this._leftPerpendicular(c);const p=[];p.push([o[0]-c[0]*d,o[1]-c[1]*d]),p.push([a[0]-c[0]*d,a[1]-c[1]*d]),r.push(p);const m=[];m.push([o[0]+c[0]*d,o[1]+c[1]*d]),m.push([a[0]+c[0]*d,a[1]+c[1]*d]),r.push(m);break}case"OffsetOpposite":{const a=this._cp2(i,3,0),l=this._cp3(i,a,.5,-1),c=this._sub(a,o);this._normalize(c);const d=this._crossProduct(c,this._sub(l,o));this._leftPerpendicular(c);const p=[];p.push([o[0]-c[0]*d,o[1]-c[1]*d]),p.push([a[0]-c[0]*d,a[1]-c[1]*d]),r.push(p);break}case"OffsetSame":{const a=this._cp2(i,3,0),l=this._cp3(i,a,.5,-1),c=this._sub(a,o);this._normalize(c);const d=this._crossProduct(c,this._sub(l,o));this._leftPerpendicular(c);const p=[];p.push([o[0]+c[0]*d,o[1]+c[1]*d]),p.push([a[0]+c[0]*d,a[1]+c[1]*d]),r.push(p);break}case"CircleWithArc":{let a=this._cp2(i,3,0);const l=this._cp3(i,a,.5,-1);let c,d;if(n>=4)c=i[3],d=this._crossProduct(this._sub(c,a),this._sub(l,a))>0;else{c=a,d=this._crossProduct(this._sub(c,o),this._sub(l,o))>0;const v=24*this._geomUnitsPerPoint,w=this._sub(c,o);this._normalize(w,v);const _=Math.sqrt(2)/2;this._rotateDirect(w,_,d?_:-_),a=this._add(o,w)}const p=this._sub(a,o),m=Math.cos(Math.PI/18),y=Math.sin(Math.PI/18),g=[a];for(let v=1;v<=36;v++)this._rotateDirect(p,m,y),g.push(this._add(o,p));this._add90DegArc(g,a,c,l,d),qy(g[g.length-8],1),r.push(g);break}case"DoubleJog":{let a,l=this._cp2(i,-3,1),c=this._cp3(i,l,-1,-.5);if(n>=4)a=i[3];else{const x=o;o=l,a=c;const $=this._dist(o,x),T=this._dist(a,x);let C=30*this._geomUnitsPerPoint;.5*$<C&&(C=.5*$),.5*T<C&&(C=.5*T),l=this._mix(o,C/$,x,($-C)/$),c=this._mix(a,C/T,x,(T-C)/T)}const d=this._mid(o,l),p=this._mid(a,c),m=this._dist(o,l),y=this._dist(c,a);let g=Math.min(m,y)/8;g=Math.min(g,24*this._geomUnitsPerPoint);const v=Math.cos(Math.PI/4);let w=this._sub(o,l);this._normalize(w,g),this._crossProduct(w,this._sub(a,l))>0?this._rotateDirect(w,v,-v):this._rotateDirect(w,v,v);let _=[];_.push(l),_.push(this._add(d,w)),_.push(this._sub(d,w)),_.push(o),r.push(_),w=this._sub(a,c),this._normalize(w,g),this._crossProduct(w,this._sub(o,c))<0?this._rotateDirect(w,v,v):this._rotateDirect(w,v,-v),_=[],_.push(c),_.push(this._add(p,w)),_.push(this._sub(p,w)),_.push(a),r.push(_);break}case"PerpendicularOffset":{const a=this._cp2(i,-4,1),l=this._cp3(i,a,.882353,-1.94),c=this._sub(l,a);this._crossProduct(c,this._sub(o,a))>0?this._rightPerpendicular(c):this._leftPerpendicular(c);const d=[c[0]/8,c[1]/8],p=this._sub(this._mid(a,l),d);r.push([p,o]);break}case"LineExcludingLastSegment":{const a=this._arrowPath(i),l=[];let c=a.length-2;for(;c--;)l.push(a[c]);r.push(l);break}case"MultivertexArrow":{const a=this._arrowPath(i),l=[];this._addArrow(l,a,!1),r.push(l);break}case"CrossedArrow":{const a=this._arrowPath(i),l=[];this._addArrow(l,a,!0),r.push(l);break}case"ChevronArrow":{const[a,l]=this._arrowLastSeg(i),c=10*this._geomUnitsPerPoint,d=this._sub(o,a),p=this._norm(d);this._normalize(d);const m=this._crossProduct(d,this._sub(l,a));let y=this._dotProduct(d,this._sub(l,a));y<.05*p?y=.05*p:y>.95*p-c&&(y=.95*p-c);const g=[a[0]+d[0]*y,a[1]+d[1]*y],v=this._leftPerp(d),w=[];w.push([g[0]+v[0]*m+d[0]*c,g[1]+v[1]*m+d[1]*c]),w.push(o),w.push([g[0]-v[0]*m+d[0]*c,g[1]-v[1]*m+d[1]*c]),r.push(w);break}case"ChevronArrowOffset":{const[a,l]=this._arrowLastSeg(i),c=this._sub(o,a),d=this._norm(c);this._normalize(c);const p=this._crossProduct(c,this._sub(l,a));let m=this._dotProduct(c,this._sub(l,a));m<.05*d?m=.05*d:m>.95*d&&(m=.95*d);const y=[a[0]+c[0]*m,a[1]+c[1]*m];this._leftPerpendicular(c);const g=[];g.push([y[0]+c[0]*p*.5,y[1]+c[1]*p*.5]),g.push(this._mid(y,o)),g.push([y[0]-c[0]*p*.5,y[1]-c[1]*p*.5]),r.push(g);break}case"PartialFirstSegment":{const[a,l]=this._arrowLastSeg(i),c=this._sub(o,a),d=this._norm(c);this._normalize(c);let p=this._dotProduct(c,this._sub(l,a));p<.05*d?p=.05*d:p>.95*d&&(p=.95*d);const m=[a[0]+c[0]*p,a[1]+c[1]*p];r.push([a,m]);break}case"Arch":{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,1),c=this._sub(o,a),d=this._mix(l,1,c,.55),p=this._mix(l,1,c,-.55),m=[o];this._addBezier2(m,o,d,l,4),this._addBezier2(m,l,p,a,4),r.push(m);break}case"CurvedParallelTicks":{const a=this._cp2(i,-4,1),l=this._cp3(i,a,.882353,-1.94),c=this._sub(l,a);this._crossProduct(c,this._sub(o,a))>0?this._rightPerpendicular(c):this._leftPerpendicular(c);const d=[c[0]/8,c[1]/8],p=this._sub(this._mid(a,l),d),m=this._sub(this._mix(a,.75,l,.25),d),y=this._sub(this._mix(a,.25,l,.75),d),g=[a];this._addBezier2(g,a,m,p,3),this._addBezier2(g,p,y,l,3),r.push(g);for(let v=0;v<8;v++){const w=g[2*v+1],_=[this._clone(w)];_.push(this._add(w,[c[0]/4,c[1]/4])),r.push(_)}break}case"Arc90Degrees":{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,1),c=[a];this._add90DegArc(c,a,o,l),r.push(c);break}case"TipWithPerpendicularAndTicks":{const[a,l]=this._arrowLastSeg(i),c=10*this._geomUnitsPerPoint,d=this._sub(o,a),p=this._norm(d);this._normalize(d);let m=this._crossProduct(d,this._sub(l,a)),y=this._dotProduct(d,this._sub(l,a));y<.05*p?y=.05*p:y>.95*p-c&&(y=.95*p-c);const g=this._leftPerp(d),v=[o[0]-d[0]*c,o[1]-d[1]*c],w=.5*Math.max(p-y-c,c);m=Math.abs(m);const _=[];_.push([v[0]+g[0]*(m+w)-d[0]*w,v[1]+g[1]*(m+w)-d[1]*w]),_.push([v[0]+g[0]*m,v[1]+g[1]*m]),_.push([v[0]-g[0]*m,v[1]-g[1]*m]),_.push([v[0]-g[0]*(m+w)-d[0]*w,v[1]-g[1]*(m+w)-d[1]*w]),r.push(_),r.push([v,o]);break}case"ConcentricCircles":{const a=this._cp2(i,1,0),l=this._cp3(i,a,2,0),c=Math.cos(Math.PI/18),d=Math.sin(Math.PI/18);let p=this._dist(a,o),m=[p,0],y=[];for(let g=0;g<=36;g++)y.push(this._add(o,m)),this._rotateDirect(m,c,d);if(r.push(y),n>=4){y=[];const g=i[3];p=this._dist(g,o),m=[p,0];for(let v=0;v<=36;v++)y.push(this._add(o,m)),v===0&&(y.push(this._add(o,m)),qy(y[1],1)),this._rotateDirect(m,c,d);r.push(y)}y=[],p=this._dist(l,o),m=[p,0];for(let g=0;g<=36;g++)y.push(this._add(o,m)),this._rotateDirect(m,c,d);r.push(y);break}case"DoubleJogArrow":{o=this._arrowPath(i)[0];const[a,l]=this._arrowLastSeg(i),c=this._sub(o,a),d=this._norm(c);this._normalize(c);const p=Math.abs(this._crossProduct(c,this._sub(l,o)));let m=Math.abs(this._dotProduct(c,this._sub(l,o)));m<.05*d?m=.05*d:m>.95*d&&(m=.95*d);const y=Math.max(p,m),g=this._leftPerp(c);let v=[];const w=[o[0]-c[0]*m*.5+g[0]*p*.5,o[1]-c[1]*m*.5+g[1]*p*.5];v.push([w[0],w[1]]),w[0]+=c[0]*y*.5+g[0]*y*.4,w[1]+=c[1]*y*.5+g[1]*y*.4,v.push([w[0],w[1]]),w[0]-=g[0]*y*.25,w[1]-=g[1]*y*.25,v.push([w[0],w[1]]),w[0]+=c[0]*y*.5+g[0]*y*.4,w[1]+=c[1]*y*.5+g[1]*y*.4,v.push([w[0],w[1]]),r.push(v),v=[],w[0]=o[0]-c[0]*m*.5-g[0]*p*.5,w[1]=o[1]-c[1]*m*.5-g[1]*p*.5,v.push([w[0],w[1]]),w[0]+=c[0]*y*.5-g[0]*y*.4,w[1]+=c[1]*y*.5-g[1]*y*.4,v.push([w[0],w[1]]),w[0]+=g[0]*y*.25,w[1]+=g[1]*y*.25,v.push([w[0],w[1]]),w[0]+=c[0]*y*.5-g[0]*y*.4,w[1]+=c[1]*y*.5-g[1]*y*.4,v.push([w[0],w[1]]),r.push(v);break}case"LinkedChevrons":{const a=this._cp2(i,-5,0),l=this._cp3(i,a,-.2,1),c=this._sub(o,a);this._normalize(c);const d=this._leftPerp(c),p=Math.abs(this._crossProduct(c,this._sub(l,a)));r.push([a,o]);const m=[];m.push([o[0]-c[0]*p+d[0]*p,o[1]-c[1]*p+d[1]*p]),m.push(o),m.push([o[0]-c[0]*p-d[0]*p,o[1]-c[1]*p-d[1]*p]),r.push(m),this._addDash(r,a,[-c[0]*p+d[0]*p,-c[1]*p+d[1]*p]),this._addDash(r,a,[-c[0]*p-d[0]*p,-c[1]*p-d[1]*p]);break}case"SegmentThenHalfCircle":{const a=this._cp2(i,2,0),l=this._cp3(i,a,1.5,0);let c;c=n>=4?i[3]:this._cp3(i,a,1.25,-.5);const d=this._sub(a,o);this._normalize(d);const p=.5*this._dist(a,l),m=this._crossProduct(d,this._sub(c,o))>0,y=Math.cos(Math.PI/18);let g=Math.sin(Math.PI/18);m&&(g=-g);const v=[o,a];d[0]*=p,d[1]*=p;const w=this._add(a,d);d[0]=-d[0],d[1]=-d[1];for(let _=1;_<=18;_++)this._rotateDirect(d,y,g),v.push(this._add(w,d));r.push(v);break}case"LineWithStraightTicks":{const a=this._cp2(i,-2,1),l=this._cp3(i,a,-1,-.5),c=this._sub(l,a);this._normalize(c);const d=this._dotProduct(c,this._sub(a,o)),p=this._dotProduct(c,this._sub(l,o));let m=[o];m.push([o[0]+c[0]*d,o[1]+c[1]*d]),m.push(a),r.push(m),m=[o],m.push([o[0]+c[0]*p,o[1]+c[1]*p]),m.push(l),r.push(m);break}case"DoubleCurve":{const a=this._cp2(i,-5,-1),l=this._cp3(i,a,2,0),c=Math.atan2(1,5),d=Math.cos(c),p=Math.sin(c),m=this._sub(a,o),y=this._dist(o,a);this._normalize(m),this._rotateDirect(m,d,-p);const g=[o];g.push([o[0]+m[0]*y*.5,o[1]+m[1]*y*.5]),qy(g[1],1),g.push([o[0]+m[0]*y*.8,o[1]+m[1]*y*.8]),this._addBezier2(g,g[2],[o[0]+m[0]*y,o[1]+m[1]*y],a,3);const v=this._sub(l,a),w=this._dist(a,l);this._normalize(v),this._rotateDirect(v,d,-p),this._addBezier2(g,a,[l[0]-v[0]*w,l[1]-v[1]*w],[l[0]-v[0]*w*.8,l[1]-v[1]*w*.8],3),g.push(l),r.push(g);break}case"ParallelWithTicksByWidth":{const a=this._cp2(i,0,-1),l=this._cp3(i,a,.5,3),c=this._sub(a,o);this._normalize(c);const d=this._crossProduct(c,this._sub(l,o));this._leftPerpendicular(c),d>0?(this._addAngledTicks(r,o,[o[0]+c[0]*d,o[1]+c[1]*d],a),this._addAngledTicks(r,a,[a[0]+c[0]*d,a[1]+c[1]*d],o)):(this._addAngledTicks(r,[o[0]+c[0]*d,o[1]+c[1]*d],o,a),this._addAngledTicks(r,[a[0]+c[0]*d,a[1]+c[1]*d],o,a));break}case"EnclosingRoundedRectangle":{const a=this._cp2(i,3,-2),l=[Math.min(o[0],a[0]),Math.max(o[1],a[1])],c=[Math.max(o[0],a[0]),Math.min(o[1],a[1])],d=c[0]-l[0],p=l[1]-c[1],m=Math.min(d,p)/10,y=[];y.push([l[0]+m+.75*(d-2*m),l[1]]),y.push([c[0]-m,l[1]]),this._add90DegArc(y,[c[0]-m,l[1]],[c[0],l[1]-m],[c[0],l[1]]),y.push([c[0],c[1]+m]),this._add90DegArc(y,[c[0],c[1]+m],[c[0]-m,c[1]],c),y.push([l[0]+m,c[1]]),this._add90DegArc(y,[l[0]+m,c[1]],[l[0],c[1]+m],[l[0],c[1]]),y.push([l[0],l[1]-m]),this._add90DegArc(y,[l[0],l[1]-m],[l[0]+m,l[1]],l),y.push([l[0]+m+.75*(d-2*m),l[1]]);break}default:r.push(i)}}return r}};var zo;let iCe=(zo=class{static local(){return zo.instance===null&&(zo.instance=new zo),zo.instance}execute(e,r,i){return new sCe(e,r,i)}},zo.instance=null,zo),sCe=class extends ay{constructor(e,r,i){super(e,!0,!0),this._curveHelper=new Nl,this._beginCut=(r.beginCut!==void 0?r.beginCut:1)*i,this._endCut=(r.endCut!==void 0?r.endCut:1)*i,this._middleCut=(r.middleCut!==void 0?r.middleCut:0)*i,this._invert=r.invert!==void 0&&r.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0)}processPath(e){const{_beginCut:r,_endCut:i,_middleCut:s}=this,n=e.pathLength(),o=Qe.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._invert){if(r!==0||i!==0||s!==0)if(r+i+s>=n)for(o.startPath();e.nextPoint();)o.pushXY(e.x,e.y);else this._curveHelper.appendSubCurve(o,e,0,r),this._curveHelper.appendSubCurve(o,e,.5*(n-s),.5*(n+s)),this._curveHelper.appendSubCurve(o,e,n-i,i)}else if(r===0&&i===0&&s===0)for(o.startPath();e.nextPoint();)o.pushXY(e.x,e.y);else r+i+s<n&&(s===0?this._curveHelper.appendSubCurve(o,e,r,n-i):(this._curveHelper.appendSubCurve(o,e,r,.5*(n-s)),this._curveHelper.appendSubCurve(o,e,.5*(n+s),n-i)));return o.totalSize===0?null:o}};const x4=1e-7;let dx=class{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}isEmpty(){return this._values.length===0}size(){return this._values.length}init(e,r,i=!0){if(this._setEmpty(),!e||e.length===0)return!1;for(let s=0;s<e.length;s++){let n=Math.abs(e[s]);i&&n<x4&&(n=x4),this._values.push(n),this._length+=n}return r&&1&e.length&&(this._length*=2),this._length!==0&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(e){const r=this._values?this._values.length:0;for(let i=0;i<r;++i)this._values[i]*=e;this._length*=e,this.extPtGap*=e,this.ctrlPtGap*=e}addValue(e){this._length+=e,this._values.push(e)}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}},ol=class{constructor(){this.pt=null,this.ca=0,this.sa=0}},m_=class{constructor(){this.reset()}reset(){this.segment=null,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}isValid(){return this.segment!==null}copyTo(e){e.segment=this.segment,e.segmentLength=this.segmentLength,e.abscissa=this.abscissa,e.isPathEnd=this.isPathEnd,e.isPartEnd=this.isPartEnd}},px=class extends Nl{constructor(e=0,r=!1){super(e,r),this._tempPos=new m_,this._tempPt=[0,0],this._tolerance=fv,this._currentPosition=new m_}updateTolerance(e){this._tolerance=fv*e}init(e,r,i=!0){return i?(this._patternLength=r.length(),this._partExtPtGap=r.extPtGap,this._partCtrlPtGap=r.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._pathCursor=e,this._seg=-1,this._setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(e,r=0){const i=new m_;return!!this._nextPosition(e,i,null,r)&&(i.copyTo(this._currentPosition),!0)}curPointAndAngle(e){e.pt=this._getPoint(this._currentPosition);const[r,i]=this._getAngleCS(this._tempPt,this._currentPosition);e.ca=r,e.sa=i}nextPointAndAngle(e,r,i=0){const s=this._tempPos;if(!this._nextPosition(e,s,null,i))return!1;s.copyTo(this._currentPosition),r.pt=this._getPoint(s);const[n,o]=this._getAngleCS(this._tempPt,s);return r.ca=n,r.sa=o,!0}nextCurve(e){if(e===0)return null;const r=Qe.createEmptyOptimizedCIM("esriGeometryPolyline");r.startPath(),r.nextPath();const i=new m_;return this._nextPosition(e,i,r,1)?(i.copyTo(this._currentPosition),r):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){return this._currentPosition.segment[1]}getPt(e){return this._pathCursor.seekInPath(e),[this._pathCursor.x,this._pathCursor.y]}getSeg(e){return[this.getPt(e),this.getPt(e+1)]}_nextPosition(e,r,i,s){if(this._currentPosition.isPathEnd)return!1;let n=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(n/=this._currentPosition.segmentLength),this._currentPosition.copyTo(r);r.abscissa+e*this._partLengthRatio>r.segmentLength+this._tolerance;){if(i){if(i.pathSize===0)if(n===0){const a=r.segment[0];i.pushXY(a[0],a[1])}else i.pushPoint(this.getSegCoord2D(r.segment,n));const o=r.segment[1];i.pushXY(o[0],o[1])}if(n=0,e-=(r.segmentLength-r.abscissa)/this._partLengthRatio,this._partSegCount)r.segment=this._nextSegment(),r.segmentLength=this.getSegLength(r.segment),r.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart())return s!==0&&(r.segmentLength=this.getSegLength(r.segment),r.isPartEnd=!0,s===1?(r.abscissa=r.segmentLength,r.isPathEnd=!0):r.abscissa=r.segmentLength+e,!0);this._currentPosition.copyTo(r)}}if(r.abscissa+=e*this._partLengthRatio,i){i.pathSize===0&&(n===0?i.pushPoint(r.segment[0]):i.pushPoint(this.getSegCoord2D(r.segment,n)));const o=r.abscissa/r.segmentLength;o===1?i.pushPoint(r.segment[1]):i.pushPoint(this.getSegCoord2D(r.segment,o))}return this._partSegCount||Math.abs(r.abscissa-r.segmentLength)<this._tolerance&&(r.isPathEnd=this._partIsLast,r.isPartEnd=!0),!0}_getPoint(e){const r=e.segmentLength<=0?0:e.abscissa/e.segmentLength;return this.getSegCoord2D(this._currentPosition.segment,r)}_getAngleCS(e,r){const i=r.segmentLength<=0?0:r.abscissa/r.segmentLength;return this.getSegAngleCS(e,this._currentPosition.segment,i)}_setPosAtNextPart(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.getSegLength(this._nextSegment()),this._partSegCount++,this._pathCursor.getControlPointAt(this._getEndPointIndex())){this._partIsLast=!this._hasNextSegment();break}let e=this._partSegCount;for(;e;)this._previousSegment(),--e;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.getSegLength(this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const r=this._getStartPointIndex();this._ctrlPtBegin=this._pathCursor.getControlPointAt(r);let i=r+this._partSegCount+1;if(i>=this._pathCursor.pathSize&&(i=0),this._ctrlPtEnd=this._pathCursor.getControlPointAt(i),this._patternLength>0){const s=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,n=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let o=Math.round((this._partLength-(s+n))/this._patternLength);o<=0&&(o=s+n>0?0:1),this._partLengthRatio=this._partLength/(s+n+o*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}_hasNextSegment(){return this._seg<this._pathCursor.pathSize-2}_previousSegment(){return this.getSeg(--this._seg)}_nextSegment(){return this.getSeg(++this._seg)}_getStartPointIndex(){return this._seg}_getEndPointIndex(){return this._seg+1}};var jo;let nCe=(jo=class{static local(){return jo.instance===null&&(jo.instance=new jo),jo.instance}execute(e,r,i){return new oCe(e,r,i)}},jo.instance=null,jo),oCe=class extends ay{constructor(e,r,i){super(e,!0,!0),this._firstCurve=null,this._walker=new px,this._walker.updateTolerance(i),this._endings=r.lineDashEnding,this._customDashPos=-(r.offsetAlongLine??0)*i,this._offsetAtEnd=(r.customEndingOffset??0)*i;let s=zH(r).dashTemplate;s==null&&(s=[]),s.length%2&&(s=[...s,...s]),this._pattern=new dx,this._pattern.init(s,!0),this._pattern.scale(i)}processPath(e){if(this._pattern.length()===0){this.iteratePath=!1;const s=Wu(e);return Qe.fromJSONCIM({paths:[s]})}if(!this.iteratePath){let s=!0;switch(this._endings){case"HalfPattern":case"HalfGap":default:this._pattern.extPtGap=0;break;case"FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case"FullGap":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case"NoConstraint":this.isClosed||(s=!1);break;case"Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}const n=e.pathLength();if(this._pattern.isEmpty()||n<.1*this._pattern.length()){const o=Wu(e);return Qe.fromJSONCIM({paths:[o]})}if(!this._walker.init(e,this._pattern,s)){const o=Wu(e);return Qe.fromJSONCIM({paths:[o]})}}let r;if(this.iteratePath)r=this._pattern.nextValue();else{let s;switch(this._endings){case"HalfPattern":default:s=.5*this._pattern.firstValue();break;case"HalfGap":s=.5*-this._pattern.lastValue();break;case"FullGap":s=-this._pattern.lastValue();break;case"FullPattern":s=0;break;case"NoConstraint":case"Custom":s=-this._customDashPos}let n=s/this._pattern.length();n-=Math.floor(n),s=n*this._pattern.length(),this._pattern.reset(),r=this._pattern.nextValue();let o=!1;for(;s>=r;)s-=r,r=this._pattern.nextValue(),o=!o;r-=s,o?(this._walker.nextPosition(r),r=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(r),r=this._pattern.nextValue(),this._walker.nextPosition(r),r=this._pattern.nextValue())}let i=this._walker.nextCurve(r);if(i)if(this._walker.isPathEnd()){if(this.iteratePath=!1,this._firstCurve){for(this._firstCurve.nextPath();this._firstCurve.nextPoint();)i.pushXY(this._firstCurve.x,this._firstCurve.y);this._firstCurve=null}}else r=this._pattern.nextValue(),!this._walker.nextPosition(r)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(i.pushCursor(this._firstCurve),this._firstCurve=null)):this.iteratePath=!0;else this.iteratePath=!1,i=this._firstCurve,this._firstCurve=null;return i?.reset(),i}};var Vo;let aCe=(Vo=class{static local(){return Vo.instance===null&&(Vo.instance=new Vo),Vo.instance}execute(e,r,i,s,n,o){return new lCe(e,r,i,s,n,o)}},Vo.instance=null,Vo),lCe=class{constructor(e,r,i,s,n,o){this._preventClipping=o,this._inputGeometries=e,this._tileKey=s,this._maxInflateSize=n*i,this._width=(r.width!==void 0?r.width:2)*i,r.method,this._option=r.option}next(){let e;for(;e=this._inputGeometries.next();){if(e.geometryType==="esriGeometryEnvelope"&&this._width>0){const r=e.asJSON();return Math.min(r.xmax-r.xmin,r.ymax-r.ymin)-2*this._width<0?e:Qe.fromJSONCIM({paths:[[[r.xmin+this._width,r.ymin+this._width],[r.xmax-this._width,r.ymin+this._width],[r.xmax-this._width,r.ymax-this._width],[r.xmin+this._width,r.ymax-this._width],[r.xmin+this._width,r.ymin+this._width]],[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]]]})}if(e.geometryType==="esriGeometryPolygon"){if(this._width===0)return e.clone();const r=kL.module,i=!this._preventClipping&&this._tileKey?LL(e,this._maxInflateSize,!0):e.clone();if(!i)continue;const s={...i.asJSON(),spatialReference:{wkid:ne.WebMercator.wkid}},n=r.execute(s,-this._width);if(n){for(const o of n.rings)if(o){i.startPath();for(const a of o.reverse())i.pushXY(a[0],i.yFactor*a[1])}}return i}}return null}};var Uo;let uCe=(Uo=class{static local(){return Uo.instance===null&&(Uo.instance=new Uo),Uo.instance}execute(e,r){return new cCe(e,r)}},Uo.instance=null,Uo),cCe=class{constructor(e,r){this._inputGeometries=e,this._medhod=r.method}next(){let e=this._inputGeometries.next();const r=this._medhod;for(;e!=null;){if(e.totalSize>0)switch(r){case"RectangularBox":return hCe(e);case"ConvexHull":return this._constructConvexHull(e);default:return dCe(e)}e=this._inputGeometries.next()}return null}_constructConvexHull(e){switch(e.geometryType){case"esriGeometryPolyline":case"esriGeometryPolygon":{const r=uZ.module,i={...e.asJSON(),spatialReference:{wkid:ne.WebMercator.wkid}},s=r.execute(i);return s?Qe.fromJSONCIM(s):null}case"esriGeometryEnvelope":return e;default:return null}}};function hCe(t){const e=Dv(t),r={xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3]};return Qe.fromJSONCIM(r)}function dCe(t){switch(t.geometryType){case"esriGeometryPolyline":{const e=[];for(;t.nextPath();)pCe(t,e);return Qe.fromJSONCIM({rings:e})}case"esriGeometryPolygon":case"esriGeometryEnvelope":return t;default:return null}}function pCe(t,e){if(t.seekPathStart(),!t.nextPoint())return;const r=t.x,i=t.y,s=[[r,i]];for(e.push(s);t.nextPoint();)s.push([t.x,t.y]);s.push([r,i])}var Go;let fCe=(Go=class{static local(){return Go.instance===null&&(Go.instance=new Go),Go.instance}execute(e,r,i){return new mCe(e,r,i)}},Go.instance=null,Go),mCe=class extends ay{constructor(e,r,i){super(e,!1,!0),this._curveHelper=new Nl,this._length=(r.length!==void 0?r.length:20)*i,this._angle=r.angle!==void 0?r.angle:225,this._position=r.position!==void 0?r.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1}processPath(e){const r=Qe.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._curveHelper.isEmpty(e))return null;e.seekInPath(0);const i=e.x,s=e.y;e.seekInPath(e.pathSize-1);const n=e.x,o=e.y,a=[n-i,o-s];this._curveHelper.normalize(a);const l=i+(n-i)*this._position/100,c=s+(o-s)*this._position/100,d=Math.cos((90-this._angle)/180*Math.PI);let p=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(p=-p),this._mirror=!this._mirror;const m=[l-this._length/2*d,c-this._length/2*p],y=[l+this._length/2*d,c+this._length/2*p];return r.pushPath([[i,s],m,y,[n,o]]),r}};var qo;let yCe=(qo=class{static local(){return qo.instance===null&&(qo.instance=new qo),qo.instance}execute(e,r,i){return new gCe(e,r,i)}},qo.instance=null,qo),gCe=class{constructor(e,r,i){this._inputGeometries=e,this._offsetX=r.offsetX!==void 0?r.offsetX*i:0,this._offsetY=r.offsetY!==void 0?r.offsetY*i:0}next(){let e=this._inputGeometries.next();for(;e;){if(e.totalSize>0)return this._move(e.clone(),this._offsetX,this._offsetY);e=this._inputGeometries.next()}return null}_move(e,r,i){for(;e.nextPath();)for(;e.nextPoint();)e.x=e.x+r,e.y=e.y+i;return e.reset(),e}};const vCe=10;var Bo;let wCe=(Bo=class{static local(){return Bo.instance===null&&(Bo.instance=new Bo),Bo.instance}execute(e,r,i,s,n,o){return new _Ce(e,r,i,s,n,o)}},Bo.instance=null,Bo),_Ce=class{constructor(e,r,i,s,n,o){this._preventClipping=o,this._inputGeometries=e,this._tileKey=s,this._curveHelper=new Nl,this._offset=(r.offset??1)*i,this._method=r.method,this._maxInflateSize=Math.max(Math.abs(n*i),vCe),this._option=r.option,this._offsetFlattenError=fv*i}next(){let e;for(;e=this._inputGeometries.next();){if(this._offset===0)return e.clone();if(e.geometryType==="esriGeometryEnvelope"){if(this._method==="Rounded"&&this._offset>0){const c=Wu(e),d=this._curveHelper.offset(c,-this._offset,this._method,4,this._offsetFlattenError);if(d){const p=Qe.createEmptyOptimizedCIM(e.geometryType);return p.pushPath(d),p}return null}const l=e.asJSON();if(Ni(l)&&Math.min(l.xmax-l.xmin,l.ymax-l.ymin)+2*this._offset>0)return Qe.fromJSONCIM({xmin:l.xmin-this._offset,xmax:l.xmax+this._offset,ymin:l.ymin-this._offset,ymax:l.ymax+this._offset})}const r=!this._preventClipping&&this._tileKey?LL(e,this._maxInflateSize,!0):e.clone();if(!r)continue;const i=pZ.module,s=dZ.module,n={...r.asJSON(),spatialReference:{wkid:ne.WebMercator.wkid}};let o,a=bCe(this._method);return e.geometryType==="esriGeometryPolygon"&&this._offset>0?(a==="square"&&(a="bevel"),o=s.executeMany([n],[this._offset],a,"round")[0]):o=i.execute(n,-this._offset,{joins:a,flattenError:this._offsetFlattenError,miterLimit:4}),o?Qe.fromJSONCIM(o):null}return null}};function bCe(t){switch(t){case"Rounded":return"round";case"Bevelled":return"bevel";case"Mitered":return"miter";case"Square":return"square"}}var Ho;let SCe=(Ho=class{static local(){return Ho.instance===null&&(Ho.instance=new Ho),Ho.instance}execute(e,r,i){return new xCe(e,r,i)}},Ho.instance=null,Ho),xCe=class{constructor(e,r,i){this._inputGeometries=e,this._length=(r.length!==void 0?r.length:tr.CIMGeometricEffectRadial.length)*i,this._angle=r.angle!==void 0?r.angle*Math.PI/180:tr.CIMGeometricEffectRadial.angle,this._lx=Math.cos(this._angle)*this._length,this._ly=Math.sin(this._angle)*this._length}next(){let e=this._inputGeometries.next();for(;e;){if(e.geometryType==="esriGeometryPoint"||e.geometryType==="esriGeometryMultipoint"){const r=Qe.createEmptyOptimizedCIM("esriGeometryPolyline");return e.nextPath()&&e.nextPoint()&&r.pushPath([[e.x,e.y],[e.x+this._lx,e.y+this._ly]]),r}if(e.geometryType==="esriGeometryPolygon"){const r=w8(e);if(!r)return null;const i=Qe.createEmptyOptimizedCIM("esriGeometryPolyline");return i.pushPath([[r[0],r[1]],[r[0]+this._lx,r[1]+this._ly]]),i}e=this._inputGeometries.next()}return null}};var Wo;let $Ce=(Wo=class{static local(){return Wo.instance===null&&(Wo.instance=new Wo),Wo.instance}execute(e,r,i){return new MCe(e,r,i)}},Wo.instance=null,Wo),MCe=class{constructor(e,r,i){this._inputGeometries=e,this._reverse=r.reverse===void 0||r.reverse}next(){let e=this._inputGeometries.next();for(;e;){if(!this._reverse)return e;if(e.geometryType==="esriGeometryPolyline")return TCe(e.clone());e=this._inputGeometries.next()}return null}};function TCe(t){for(;t.nextPath();)for(let e=0;e<t.pathSize/2;e++){t.seekInPath(e);const r=t.x,i=t.y;t.seekInPath(t.pathSize-e-1);const s=t.x,n=t.y;t.x=r,t.y=i,t.seekInPath(e),t.x=s,t.y=n}return t.reset(),t}var Zo;let ICe=(Zo=class{static local(){return Zo.instance===null&&(Zo.instance=new Zo),Zo.instance}execute(e,r,i){return new ECe(e,r,i)}},Zo.instance=null,Zo),ECe=class{constructor(e,r,i){this._inputGeometries=e,this._rotateAngle=r.angle!==void 0?r.angle*Math.PI/180:0}next(){let e=this._inputGeometries.next();for(;e;){if(this._rotateAngle===0||e.geometryType==="esriGeometryPoint")return e;if(e.totalSize>0){const r=Dv(e),i=(r[2]+r[0])/2,s=(r[3]+r[1])/2;return e.reset(),this._rotate(e.clone(),i,s)}e=this._inputGeometries.next()}return null}_rotate(e,r,i){const s=Math.cos(this._rotateAngle),n=Math.sin(this._rotateAngle);for(;e.nextPath();)for(;e.nextPoint();){const o=e.x-r,a=e.y-i;e.x=r+o*s-a*n,e.y=i+o*n+a*s}return e.reset(),e}};var Jo;let CCe=(Jo=class{static local(){return Jo.instance===null&&(Jo.instance=new Jo),Jo.instance}execute(e,r,i){return new PCe(e,r,i)}},Jo.instance=null,Jo),PCe=class{constructor(e,r,i){this._inputGeometries=e,this._xFactor=r.xScaleFactor!==void 0?r.xScaleFactor:1.15,this._yFactor=r.yScaleFactor!==void 0?r.yScaleFactor:1.15}next(){const e=this._inputGeometries.next();if(e){if(this._xFactor===1&&this._yFactor===1||e.geometryType==="esriGeometryPoint")return e;if(e.totalSize>0){const r=Dv(e),i=(r[2]+r[0])/2,s=(r[3]+r[1])/2;return e.reset(),this._scaleCursor(e.clone(),i,s)}}return null}_scaleCursor(e,r,i){for(;e.nextPath();)for(;e.nextPoint();)e.x=r+(e.x-r)*this._xFactor,e.y=i+(e.y-i)*this._yFactor;return e.reset(),e}},mC=class{constructor(){this._polyline=[]}beginPath(e){this._polyline.push([e])}lineTo(e){if(this._polyline.length===0)throw new Error("No path started. Call beginPath first.");this._polyline[this._polyline.length-1].push(e)}getPointCount(){return this._polyline.reduce((e,r)=>e+r.length,0)}addSegment(e,r,i){i&&this.beginPath(e),this.lineTo(r)}getXY(e){let r=0;for(const i of this._polyline){if(e<r+i.length)return i[e-r];r+=i.length}return null}getGeometry(){return this._polyline}};var Yo;let kCe=(Yo=class{static local(){return Yo.instance===null&&(Yo.instance=new Yo),Yo.instance}execute(e,r,i){return new LCe(e,r,i)}},Yo.instance=null,Yo),LCe=class extends ay{constructor(e,r,i){super(e,!1,!0),this._suppress=r.suppress!==void 0&&r.suppress,this._invert=r.invert!==void 0&&r.invert}processPath(e){if(e.totalSize<=0)return null;if(!this._suppress){const y=Qe.createEmptyOptimizedCIM("esriGeometryPolygon",!1,!1,e.yFactor);for(e.seekPathEnd();e.nextPoint();)y.pushXY(e.x,e.y);return y}const r=[],i=new Array(e.pathSize);let s=0;for(e.seekPathStart();e.nextPoint();)i[s++]=e.getControlPoint(),r.push([e.x,e.y]);let n=!0,o=!0,a=!1,l=!this._invert;s=0;const c=new mC;let d=r[0];for(;s<r.length;){const y=r[s+1],g=i[s],v=i[s+1];s++,o&&(l=g||v?this._invert:!this._invert,o=!1),l?(c.addSegment(d,y,n),n=!1):a=!0,d=y,v&&(l?(l=!1,n=!0):l=!0)}const p=c.getGeometry();if(p.length===0)return null;if(!a&&r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]){const y=p[p.length-1];return y[0][0]===y[y.length-1][0]&&y[0][1]===y[y.length-1][1]||y.push([y[0][0],y[0][1]]),Qe.fromJSONCIM({paths:p})}const m=p[p.length-1];return c.getPointCount()>1&&e.geometryType==="esriGeometryPolygon"&&m[0][0]===m[m.length-1][0]&&m[0][1]===m[m.length-1][1]&&p.length>1&&(p[p.length-1].push(...p[0]),p.splice(0,1)),Qe.fromJSONCIM({paths:p})}};const By=()=>U.getLogger("esri.symbols.cim.effects.EffectTaperedPolygon");var Xo;let ACe=(Xo=class{static local(){return Xo.instance===null&&(Xo.instance=new Xo),Xo.instance}execute(e,r,i){return new RCe(e,r,i)}},Xo.instance=null,Xo),RCe=class extends ay{constructor(e,r,i){super(e,!1,!0),this._slopeS=0,this._slopeC=1,this._lastTangent1=new qe(NaN,NaN),this._lastWidth=0,this._geomUnitsPerPoint=i,this._halfFromWidth=Math.abs(r.fromWidth!==void 0?r.fromWidth:0)*i*.5,this._halfToWidth=Math.abs(r.toWidth!==void 0?r.toWidth:1)*i*.5,this._originalLength=(r.length!==void 0?r.length:0)*i,this._length=0}processPath(e){if(e.totalSize<=0)return null;if(this._halfFromWidth<=0&&this._halfToWidth<=0){const c=Qe.createEmptyOptimizedCIM("esriGeometryPolygon",!1,!1,e.yFactor);for(e.seekPathEnd();e.prevPoint();)c.pushXY(e.x,e.y);for(e.seekPathStart();e.nextPoint();)c.pushXY(e.x,e.y);return c}const r=e.getCurrentPath().asJSON(),i=hZ.module.execute(r,.25*this._geomUnitsPerPoint,{removeDegenerateParts:!0}),s=i==null?null:Kt(i)?i.rings:Xr(i)?i.paths:null;if(!s)return By().error(new R("mapview-bad-resource","Unable to process geometry")),null;const n=cZ.module.execute(i);if((this._originalLength===0||this._originalLength>n)&&n>0){this._length=n;const c=(this._halfToWidth-this._halfFromWidth)/this._length;if(Math.abs(c)<1){const d=c*c;this._slopeC=Math.sqrt(1/(1+d)),this._slopeS=Math.sqrt(d/(1+d)),c<0&&(this._slopeS=-this._slopeS)}else this._slopeC=this._slopeS=.7071}else this._length=this._originalLength,this._slopeC=1,this._slopeS=0;const o=[];for(const c of s){const d=new mC,p=new mC;let m=0;this._setFromOffset(c.slice(0,2),d,p);for(let v=0,w=3;w<=c.length;++v,++w)m=this._setOffset(c.slice(v,w),m,d,p);this._setToOffset(c.slice(-2),m,d,p);const[y]=d.getGeometry(),[g]=p.getGeometry();o.push([...y,...g.reverse()])}const a={rings:o,spatialReference:{wkid:ne.WebMercator.wkid}},l=fZ.module.execute(a);return Qe.fromJSONCIM(l)}_setFromOffset([[e,r],[i,s]],n,o){const a=this._halfFromWidth,l=new qe(i-e,s-r).normalize().scale(a);n.beginPath([e-l.y,r+l.x]),o.beginPath([e+l.y,r-l.x])}_setToOffset([[e,r],[i,s]],n,o,a){let l;l=(n+=Math.sqrt((i-e)**2+(s-r)**2))>=this._length?this._halfToWidth:this._halfFromWidth+(this._halfToWidth-this._halfFromWidth)*n/this._length;const c=new qe(i-e,s-r).normalize().scale(l);o.lineTo([i-c.y,s+c.x]),a.lineTo([i+c.y,s-c.x])}_setOffset([[e,r],[i,s],[n,o]],a,l,c){const d=Math.sqrt((i-e)**2+(s-r)**2);let p;p=a+d>=this._length?this._halfToWidth:this._halfFromWidth+(this._halfToWidth-this._halfFromWidth)*(a+d)/this._length,a+=d;const m=new qe(i,s),y=new qe(i-e,s-r).normalize(),g=new qe(n-i,o-s).normalize(),v=qe.sub(g,y),w=l.getPointCount(),_=c.getPointCount();y.leftPerpendicular(),g.leftPerpendicular();const x=y.x*g.x+y.y*g.y;if(x>.99){const $=qe.add(y,g).scale(p/2),T=$.clone().rotate(this._slopeC,this._slopeS);l.lineTo([m.x+T.x,m.y+T.y]);const C=$.rotateReverse(this._slopeC,this._slopeS);c.lineTo([m.x-C.x,m.y-C.y])}else{const $=y.x*g.y-y.y*g.x;if(v.scale(1/$),$<0){v.scale(-p).rotateReverse(this._slopeC,this._slopeS);const j=c.getXY(_-1);j||By().error(new R("mapview-bad-resource","Unable to process geometry, index out of scope"));const V=qe.add(m,v).sub(qe.fromArray(j));if(y.x*V.y-y.y*V.x>0){const Z=y.clone().scale(-p).rotateReverse(this._slopeC,this._slopeS),Y=g.clone().scale(-p).rotateReverse(this._slopeC,this._slopeS);c.lineTo([m.x+Z.x,m.y+Z.y]),c.lineTo([m.x,m.y]),c.lineTo([m.x+Y.x,m.y+Y.y])}else c.lineTo([m.x+v.x,m.y+v.y])}else{v.scale(p).rotate(this._slopeC,this._slopeS);const j=l.getXY(w-1);j||By().error(new R("mapview-bad-resource","Unable to process geometry, index out of scope"));const V=qe.add(m,v).sub(qe.fromArray(j));if(y.x*V.y-y.y*V.x>0){const Z=y.clone().scale(p).rotate(this._slopeC,this._slopeS),Y=g.clone().scale(p).rotate(this._slopeC,this._slopeS);l.lineTo([m.x+Z.x,m.y+Z.y]),l.lineTo([m.x,m.y]),l.lineTo([m.x+Y.x,m.y+Y.y])}else l.lineTo([m.x+v.x,m.y+v.y])}const T=Math.acos(x);let C=1;if(p>.25){const j=2*Math.acos(1-.25/p);j<T&&(C=Math.round(T/j))}const P=Math.cos(T/C),A=Math.sin(T/C),F=y.clone();if($<0){F.rotate(this._slopeC,this._slopeS);const j=l.getXY(w-1);j||By().error(new R("mapview-bad-resource","Unable to process geometry, index out of scope"));const V=qe.add(m,F.clone().scale(this._lastWidth)),Z=qe.sub(V,qe.fromArray(j)),Y=y.x*Z.y-y.y*Z.x;if(!isNaN(this._lastTangent1.x)&&!isNaN(this._lastTangent1.y)&&Y>0){const re=new qe(e,r),Q=this._lastTangent1.clone().scale(this._lastWidth);Q.rotate(this._slopeC,this._slopeS);const Ee=y.clone().scale(this._lastWidth);Ee.rotate(this._slopeC,this._slopeS),l.lineTo([re.x+Q.x,re.y+Q.y]),l.lineTo([re.x,re.y]),l.lineTo([re.x+Ee.x,re.y+Ee.y])}}else{F.scale(-1).rotateReverse(this._slopeC,this._slopeS);const j=c.getXY(_-1);j||By().error(new R("mapview-bad-resource","Unable to process geometry, index out of scope"));const V=qe.add(m,F.clone().scale(this._lastWidth)),Z=qe.sub(V,qe.fromArray(j)),Y=y.x*Z.y-y.y*Z.x;if(!isNaN(this._lastTangent1.x)&&!isNaN(this._lastTangent1.y)&&Y>0){const re=new qe(e,r),Q=this._lastTangent1.clone().scale(-this._lastWidth);Q.rotateReverse(this._slopeC,this._slopeS);const Ee=y.clone().scale(-this._lastWidth);Ee.rotateReverse(this._slopeC,this._slopeS),c.lineTo([re.x+Q.x,re.y+Q.y]),c.lineTo([re.x,re.y]),c.lineTo([re.x+Ee.x,re.y+Ee.y])}}F.scale(p);for(let j=0;j<=C;j++)$<0?(l.lineTo([m.x+F.x,m.y+F.y]),F.rotateReverse(P,A)):(c.lineTo([m.x+F.x,m.y+F.y]),F.rotate(P,A))}return this._lastTangent1.setCoords(y.x,y.y),this._lastWidth=p,a}};var Ko;let OCe=(Ko=class{static local(){return Ko.instance===null&&(Ko.instance=new Ko),Ko.instance}execute(e,r,i){return new FCe(e,r,i)}},Ko.instance=null,Ko),FCe=class{constructor(e,r,i){this._inputGeometries=e,this._height=(r.amplitude!==void 0?r.amplitude:2)*i,this._period=(r.period!==void 0?r.period:3)*i,this._style=r.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new dx,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new px,this._walker.updateTolerance(i)}next(){let e=this._inputGeometries.next();for(;e;){if(this._height===0||this._period===0)return e;const r=this._processGeom(e);if(r)return r;e=this._inputGeometries.next()}return null}_processGeom(e){const r=Qe.createEmptyOptimizedCIM(e.geometryType);for(;e.nextPath();){r.startPath();const i=e.pathLength();if(this._walker.init(e,this._pattern))switch(this._style){case"Sinus":default:this._constructCurve(r,i,!1);break;case"Square":this._constructSquare(r,i);break;case"Triangle":this._constructTriangle(r,i);break;case"Random":this._constructCurve(r,i,!0)}else for(;e.nextPoint();)r.pushXY(e.x,e.y)}return r}_constructCurve(e,r,i){let s=Math.round(r/this._period);s===0&&(s=1);const n=s*16+1,o=r/s,a=this._period/16,l=1/n,c=2*Math.PI*r/o,d=2*Math.PI*Math.random(),p=2*Math.PI*Math.random(),m=2*Math.PI*Math.random(),y=.75-Math.random()/2,g=.75-Math.random()/2,v=new ol;this._walker.curPointAndAngle(v),e.pushPoint(v.pt);let w=0;for(;;){if(!this._walker.nextPointAndAngle(a,v)){e.pushPoint(this._walker.getPathEnd());break}{const _=w;let x;if(w+=l,i){const $=this._height/2*(1+.3*Math.sin(y*c*_+d));x=$*Math.sin(c*_+p),x+=$*Math.sin(g*c*_+m),x/=2}else x=.5*this._height*Math.sin(.5*c*_);e.pushXY(v.pt[0]-x*v.sa,v.pt[1]+x*v.ca)}}}_constructSquare(e,r){Math.round(r/this._period);let i=!0;for(;;){let s=!1;if(this._walker.curPositionIsValid()){const n=new ol;this._walker.curPointAndAngle(n);const o=new ol;if(this._walker.nextPointAndAngle(this._period,o)){const a=new ol;this._walker.nextPointAndAngle(this._period,a)&&(i?(e.pushPoint(n.pt),i=!1):e.pushPoint(n.pt),e.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),e.pushXY(o.pt[0]-this._height/2*o.sa,o.pt[1]+this._height/2*o.ca),e.pushXY(o.pt[0]+this._height/2*o.sa,o.pt[1]-this._height/2*o.ca),e.pushXY(a.pt[0]+this._height/2*a.sa,a.pt[1]-this._height/2*a.ca),s=!0)}}if(!s){e.pushPoint(this._walker.getPathEnd());break}}}_constructTriangle(e,r){Math.round(r/this._period);let i=!0;for(;;){let s=!1;if(this._walker.curPositionIsValid()){const n=new ol;this._walker.curPointAndAngle(n);const o=new ol;if(this._walker.nextPointAndAngle(this._period/2,o)){const a=new ol;this._walker.nextPointAndAngle(this._period,a)&&(this._walker.nextPosition(this._period/2)&&(i?(e.pushPoint(n.pt),i=!1):e.pushPoint(n.pt),e.pushXY(o.pt[0]-this._height/2*o.sa,o.pt[1]+this._height/2*o.ca),e.pushXY(a.pt[0]+this._height/2*a.sa,a.pt[1]-this._height/2*a.ca)),s=!0)}}if(!s){e.pushPoint(this._walker.getPathEnd());break}}}};var Qo;let NCe=(Qo=class{static local(){return Qo.instance===null&&(Qo.instance=new Qo),Qo.instance}execute(e,r,i){return new DCe(e,r,i)}},Qo.instance=null,Qo),DCe=class extends rw{constructor(e,r,i){super(e),this._geometryWalker=new px,this._geometryWalker.updateTolerance(i),this._angleToLine=r.angleToLine??!0,this._offset=(r.offset?r.offset:0)*i,this._originalEndings=r.endings,this._offsetAtEnd=(r.customEndingOffset?r.customEndingOffset:0)*i,this._position=-(r.offsetAlongLine?r.offsetAlongLine:0)*i,this._pattern=new dx,this._pattern.init(r.placementTemplate,!1),this._pattern.scale(i),this._endings=this._originalEndings}processPath(e){if(this._pattern.isEmpty())return null;let r;if(this.iteratePath)r=this._pattern.nextValue();else{this._originalEndings==="WithFullGap"&&this.isClosed?this._endings="WithMarkers":this._endings=this._originalEndings,this._pattern.extPtGap=0;let s,n=!0;switch(this._endings){case"NoConstraint":s=-this._position,s=this._adjustPosition(s),n=!1;break;case"WithHalfGap":default:s=-this._pattern.lastValue()/2;break;case"WithFullGap":s=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case"WithMarkers":s=0;break;case"Custom":s=-this._position,s=this._adjustPosition(s),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(e,this._pattern,n))return null;this._pattern.reset();let o=0;for(;s>o;)s-=o,o=this._pattern.nextValue();o-=s,r=o,this.iteratePath=!0}const i=new ol;return this._geometryWalker.nextPointAndAngle(r,i)?this._endings==="WithFullGap"&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings==="WithMarkers"&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(i.pt[0]-this._offset*i.sa,i.pt[1]+this._offset*i.ca),this._angleToLine&&this.internalPlacement.setRotateCS(i.ca,i.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(e){let r=e/this._pattern.length();return r-=Math.floor(r),r*this._pattern.length()}};var ea;let zCe=(ea=class{static local(){return ea.instance===null&&(ea.instance=new ea),ea.instance}execute(e,r,i){return new jCe(e,r,i)}},ea.instance=null,ea),jCe=class extends rw{constructor(e,r,i){super(e,!1,!0),this._curveHelper=new Nl,this._placePerPart=r.placePerPart??!1,this._angleToLine=r.angleToLine===void 0||r.angleToLine,this._offset=r.offset!==void 0?r.offset*i:0,this._type=r.extremityPlacement,this._position=r.offsetAlongLine!==void 0?r.offsetAlongLine*i:0,this._beginProcessed=!1}processMultiPath(e){return this._placePerPart?super.processMultiPath(e):this.processPath(e)}processPath(e){let r;switch(this._type){case"Both":default:this._beginProcessed?(r=this._atExtremities(e,this._position,!1),this._beginProcessed=!1,this.iterateMultiPath=!1,this.iteratePath=!1):(r=this._atExtremities(e,this._position,!0),this._beginProcessed=!0,this.iterateMultiPath=!0,this.iteratePath=!0);break;case"JustBegin":r=this._atExtremities(e,this._position,!0);break;case"JustEnd":r=this._atExtremities(e,this._position,!1);case"None":}return r}_atExtremities(e,r,i){if(this._placePerPart||(i?e.seekPath(0):e.seekPath(e.totalSize-1)),i||e.seekPathEnd(),i?e.nextPoint():e.prevPoint()){let s=0,[n,o]=[0,0],[a,l]=[e.x,e.y];const c=[0,0];for(;i?e.nextPoint():e.prevPoint();){n=a,o=l,a=e.x,l=e.y;const d=this._curveHelper.getLength(n,o,a,l);if(s+d>r){const p=(r-s)/d,[m,y]=this._curveHelper.getAngleCS(c,n,o,a,l,p),g=this._curveHelper.getCoord2D(n,o,a,l,p);return this.internalPlacement.setTranslate(g[0]-this._offset*y,g[1]+this._offset*m),this._angleToLine&&this.internalPlacement.setRotateCS(-m,-y),this.internalPlacement}s+=d}}return null}};var ta;let VCe=(ta=class{static local(){return ta.instance===null&&(ta.instance=new ta),ta.instance}execute(e,r,i){return new UCe(e,r,i)}},ta.instance=null,ta),UCe=class extends rw{constructor(e,r,i){super(e),this._walker=new px,this._walker.updateTolerance(i),this._angleToLine=r.angleToLine===void 0||r.angleToLine,this._offset=r.offset!==void 0?r.offset*i:0,this._beginGap=r.beginPosition!==void 0?r.beginPosition*i:0,this._endGap=r.endPosition!==void 0?r.endPosition*i:0,this._flipFirst=r.flipFirst===void 0||r.flipFirst,this._pattern=new dx,this._pattern.init(r.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0}processPath(e){if(this._pattern.isEmpty())return null;let r;if(this.iteratePath){const a=this._pattern.nextValue()*this._subPathLen,l=this._beginGap+a;r=l-this._prevPos,this._prevPos=l}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=e.pathLength()-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(e,this._pattern,!1))return null;this._pattern.reset();const a=this._pattern.nextValue()*this._subPathLen,l=this._beginGap+a;r=l-this._prevPos,this._prevPos=l,this.iteratePath=!0}const i=new ol;if(!this._walker.nextPointAndAngle(r,i,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(i.pt[0]-this._offset*i.sa,i.pt[1]+this._offset*i.ca);const s=this._isFirst&&this._flipFirst;let n,o;return this._angleToLine?(n=i.ca,o=i.sa):(n=1,o=0),s&&(n=-n,o=-o),this.internalPlacement.setRotateCS(n,o),this._isFirst=!1,this._posCount--,this._posCount===0&&(this.iteratePath=!1),this.internalPlacement}};const ru=512,GCe=10,ao=24,LS=1e-6;var ra;let qCe=(ra=class{static local(){return ra.instance===null&&(ra.instance=new ra),ra.instance}execute(e,r,i,s){return new BCe(e,r,i,s)}},ra.instance=null,ra),BCe=class ch{constructor(e,r,i,s){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._accelerationMap=null,this._testInsidePolygon=!1,this._verticalSubdivision=!0,this._stepX=Math.abs(r.stepX??16)*i,this._stepY=Math.abs(r.stepY??16)*i,this._stepX=Math.round(128*this._stepX)/128,this._stepY=Math.round(128*this._stepY)/128,this._stepX!==0&&this._stepY!==0){if(this._gridType=r.gridType??"Fixed",this._gridType==="Random"){const n=r.seed??13,o=1;this._randomLCG=new kC(n*o),this._randomness=(r.randomness??100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0,this._buildRandomValues()}else{if(this._randomness=0,this._gridAngle=r.gridAngle??0,this._shiftOddRows=r.shiftOddRows??!1,this._offsetX=(r.offsetX??0)*i,this._offsetY=(r.offsetY??0)*i,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}if(this._graphicOriginX=0,this._graphicOriginY=0,s!=null){const[n,o,a,l]=s.split("/"),c=parseFloat(n),d=parseFloat(o),p=parseFloat(a),m=parseFloat(l);this._graphicOriginX=-(m*2**c+p)*ru,this._graphicOriginY=d*ru,this._testInsidePolygon=!0}this._internalPlacement=new oy,this._calculateMinMax(e),this._geometryCursor=e}}next(){return this._geometryCursor?this._nextInside():null}_buildRandomValues(){if(!ch._randValues){ch._randValues=[];for(let e=0;e<ao;e++)for(let r=0;r<ao;r++)ch._randValues.push(this._randomLCG.getFloat()),ch._randValues.push(this._randomLCG.getFloat())}}_calculateMinMax(e){let r,i,s,n,o,a,l,c,d,p,m,y,g,v;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,l=c=g=m=Number.MAX_VALUE,d=p=v=y=-Number.MAX_VALUE;const w=this._cosAngle!==1;for(e.reset();e.nextPath();)for(;e.nextPoint();)a=e.x,o=e.y,r=a-this._graphicOriginX-this._offsetX,i=o-this._graphicOriginY-this._offsetY,w?(s=this._cosAngle*r-this._sinAngle*i,n=this._sinAngle*r+this._cosAngle*i):(s=r,n=i),l=Math.min(l,s),d=Math.max(d,s),c=Math.min(c,n),p=Math.max(p,n),m=Math.min(m,o),y=Math.max(y,o),g=Math.min(g,a),v=Math.max(v,a);m=m!==Number.MAX_VALUE?m:-ru-this._stepY,y=y!==-Number.MAX_VALUE?y:this._stepY,g=g!==Number.MAX_VALUE?g:-this._stepX,v=v!==-Number.MAX_VALUE?v:ru+this._stepX;const _=y-m,x=v-g;if(this._verticalSubdivision=_>=x,this._polygonMin=this._verticalSubdivision?m:g,this._testInsidePolygon){let $=0-this._graphicOriginX-this._offsetX-this._stepX,T=ru-this._graphicOriginX-this._offsetX+this._stepX,C=-ru-this._graphicOriginY-this._offsetY-this._stepY,P=0-this._graphicOriginY-this._offsetY+this._stepY;if(w){const A=[[$,C],[$,P],[T,C],[T,P]];$=C=Number.MAX_VALUE,T=P=-Number.MAX_VALUE;for(const F of A){const j=this._cosAngle*F[0]-this._sinAngle*F[1],V=this._sinAngle*F[0]+this._cosAngle*F[1];$=Math.min($,j),T=Math.max(T,j),C=Math.min(C,V),P=Math.max(P,V)}}l=l!==Number.MAX_VALUE?Math.max(l,$):$,c=c!==Number.MAX_VALUE?Math.max(c,C):C,d=d!==-Number.MAX_VALUE?Math.min(d,T):T,p=p!==-Number.MAX_VALUE?Math.min(p,P):P}this._xMin=Math.round(l/this._stepX),this._xMax=Math.round(d/this._stepX),this._yMin=Math.round(c/this._stepY),this._yMax=Math.round(p/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1,this._buildAccelerationMap(e,g,v,m,y)}_buildAccelerationMap(e,r,i,s,n){e.reset();const o=new Map,a=this._verticalSubdivision,l=a?n-s:i-r;let c=Math.ceil(l/GCe);if(c<=1)return;const d=Math.floor(l/c);let p,m,y,g,v,w,_,x,$,T,C;for(c++,this._delta=d,a?($=-ru-2*this._stepY,T=2*this._stepY,C=s):($=-2*this._stepX,T=ru+2*this._stepX,C=r);e.nextPath();)if(!(e.pathSize<2)&&e.nextPoint())for(p=e.x,m=e.y;e.nextPoint();p=y,m=g){if(y=e.x,g=e.y,a){if(m===g||m<$&&g<$||m>T&&g>T)continue;v=Math.min(m,g),w=Math.max(m,g)}else{if(p===y||p<$&&y<$||p>T&&y>T)continue;v=Math.min(p,y),w=Math.max(p,y)}for(;v<w;)_=Math.floor((v-C)/d),$4(_,p,m,y,g,o),v+=d;x=Math.floor((w-C)/d),x>_&&$4(x,p,m,y,g,o)}this._accelerationMap=o}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}let e=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(e+=.5*this._stepX);const r=this._currentY*this._stepY+this._offsetY;let i,s;if(this._currentX++,this._gridType==="Random"){const n=(this._currentX%ao+ao)%ao,o=(this._currentY%ao+ao)%ao;i=this._graphicOriginX+e+this._stepX*this._randomness*(.5-ch._randValues[o*ao+n])*2/3,s=this._graphicOriginY+r+this._stepY*this._randomness*(.5-ch._randValues[o*ao+n+1])*2/3}else i=this._graphicOriginX+this._cosAngle*e+this._sinAngle*r,s=this._graphicOriginY-this._sinAngle*e+this._cosAngle*r;if(!this._testInsidePolygon||this._isInsidePolygon(i,s,this._geometryCursor))return this._internalPlacement.setTranslate(i,s),this._internalPlacement}}_isInsidePolygon(e,r,i){if(this._accelerationMap==null)return HCe(e,r,i);e+=LS,r+=LS;const s=this._verticalSubdivision,n=s?r:e,o=Math.floor((n-this._polygonMin)/this._delta),a=this._accelerationMap.get(o);if(!a)return!1;let l,c,d,p=0;for(const m of a){if(l=m[0],c=m[1],s){if(l[1]>r==c[1]>r)continue;d=(c[0]-l[0])*(r-l[1])-(c[1]-l[1])*(e-l[0])}else{if(l[0]>e==c[0]>e)continue;d=(c[1]-l[1])*(e-l[0])-(c[0]-l[0])*(r-l[1])}d>0?p++:p--}return p!==0}};function HCe(t,e,r){let i,s,n,o,a=0;for(t+=LS,e+=LS,r.reset();r.nextPath();)if(r.nextPoint())for(i=r.x,s=r.y;r.nextPoint();i=n,s=o)n=r.x,o=r.y,s>e!=o>e&&((n-i)*(e-s)-(o-s)*(t-i)>0?a++:a--);return a!==0}function $4(t,e,r,i,s,n){let o=n.get(t);o||(o=[],n.set(t,o)),o.push([[e,r],[i,s]])}const WCe=.001;var ia;let ZCe=(ia=class{static local(){return ia.instance===null&&(ia.instance=new ia),ia.instance}execute(e,r,i){return new JCe(e,r,i)}},ia.instance=null,ia),JCe=class extends rw{constructor(e,r,i){super(e),this._curveHelper=new Nl,this._angleToLine=r.angleToLine===void 0||r.angleToLine,this._offset=r.offset!==void 0?r.offset*i:0,this._relativeTo=r.relativeTo,this._position=r.startPointOffset!==void 0?r.startPointOffset*i:0,this._epsilon=WCe*i}processPath(e){const r=this._position;if(this._relativeTo==="SegmentMidpoint"){if(this.iteratePath||(this.iteratePath=!0),e.nextPoint()){let[s,n]=[e.x,e.y],[o,a]=[0,0];const l=[0,0];for(;e.nextPoint();){o=e.x,a=e.y;const c=this._curveHelper.getLength(s,n,o,a);if(c<this._epsilon){s=o,n=a;continue}const d=.5+this._position/c,[p,m]=this._curveHelper.getAngleCS(l,s,n,o,a,d),y=this._curveHelper.getCoord2D(s,n,o,a,d);return this.internalPlacement.setTranslate(y[0]-this._offset*m,y[1]+this._offset*p),this._angleToLine&&this.internalPlacement.setRotateCS(p,m),this.internalPlacement}}return this.iteratePath=!1,null}const i=this._relativeTo==="LineEnd";return this.onLine(e,r,i)}onLine(e,r,i){let s,n=!1;switch(this._relativeTo){case"LineMiddle":default:e.seekPathStart(),s=e.pathLength()/2+r;break;case"LineBeginning":s=r;break;case"LineEnd":s=r,n=!0}i?e.seekPathEnd():e.seekPathStart();let o=0;if(i?e.prevPoint():e.nextPoint()){let[a,l]=[e.x,e.y],[c,d]=[0,0];const p=[0,0];for(;i?e.prevPoint():e.nextPoint();){c=e.x,d=e.y;const m=this._curveHelper.getLength(a,l,c,d);if(o+m>s){const y=(s-o)/m,[g,v]=this._curveHelper.getAngleCS(p,a,l,c,d,y),w=this._curveHelper.getCoord2D(a,l,c,d,y),_=n?-this._offset:this._offset;return this.internalPlacement.setTranslate(w[0]-_*v,w[1]+_*g),this._angleToLine&&(n?this.internalPlacement.setRotateCS(-g,-v):this.internalPlacement.setRotateCS(g,v)),this.internalPlacement}a=c,l=d,o+=m}}return null}};const YCe=1e-15;var sa;let XCe=(sa=class{static local(){return sa.instance===null&&(sa.instance=new sa),sa.instance}execute(e,r,i){return new KCe(e,r,i)}},sa.instance=null,sa),KCe=class extends rw{constructor(e,r,i){super(e),this._curveHelper=new Nl,this._angleToLine=r.angleToLine===void 0||r.angleToLine,this._offset=r.offset!==void 0?r.offset*i:0,this._endPoints=r.placeOnEndPoints===void 0||r.placeOnEndPoints,this._controlPoints=r.placeOnControlPoints===void 0||r.placeOnControlPoints,this._regularVertices=r.placeOnRegularVertices===void 0||r.placeOnRegularVertices,this._tags=[],this._tagIterator=0}processPath(e){if(this.iteratePath||(this._preparePath(e),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const r=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(r[2]);let i=r[0],s=r[1];if(this._offset!==0){const n=Math.cos(r[2]),o=Math.sin(r[2]);i-=this._offset*o,s+=this._offset*n}return this.internalPlacement.setTranslate(i,s),this._tagIterator++,this.internalPlacement}_preparePath(e){this._tags.length=0,this._tagIterator=0,e.seekPathStart();const r=e.isClosed();let i=0,s=!1,n=0,o=0;if(e.seekPathStart(),e.nextPoint()){let a=e.x,l=e.y,c=e.getControlPoint(),d=!0,p=e.nextPoint();for(;p;){const m=e.x,y=e.y,g=e.getControlPoint();(this._angleToLine||this._offset!==0)&&(n=this._curveHelper.getAngle(a,l,m,y,0)),d?(d=!1,r?(i=n,s=c):(this._endPoints||this._controlPoints&&c)&&this._tags.push([a,l,n])):c?this._controlPoints&&this._tags.push([a,l,y_(o,n)]):this._regularVertices&&this._tags.push([a,l,y_(o,n)]),(this._angleToLine||this._offset!==0)&&(o=this._curveHelper.getAngle(a,l,m,y,1)),p=e.nextPoint(),p||(r?g||s?this._controlPoints&&this._tags.push([m,y,y_(o,i)]):this._regularVertices&&this._tags.push([m,y,y_(o,i)]):(this._endPoints||this._controlPoints&&g)&&this._tags.push([m,y,o])),a=m,l=y,c=g}}this._tagIterator=0}};function y_(t,e){const r=Math.PI;for(;Math.abs(e-t)>r+2*YCe;)e-t>r?e-=2*r:e+=2*r;return(t+e)/2}const QCe=100*222045e-21;function ePe(t){if(t.totalSize===0)return null;const e=Dv(t);if(!e)return null;const r=4*(Math.abs(e[0])+Math.abs(e[2])+Math.abs(e[1])+Math.abs(e[3])+1)*QCe;let i=0,s=0;t.reset();for(let j=0;t.nextPath();j++){const V=t.getCurrentRingArea();V>s&&(s=V,i=j)}if(t.seekPath(i),t.pathSize===0)return null;t.seekPathStart();const n=W8(t);if(Math.abs(s)<=2*r*r)return[(n[0]+n[2])/2,(n[1]+n[3])/2];t.seekPathStart();const o=Pne(t,lr());if(o===null)return null;if(t.totalPoints<4)return o;const a=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],l=[NaN,NaN,NaN,NaN],c=[NaN,NaN,NaN,NaN];let d=!1,p=Hy(o,t,!0);p.distance===0&&(d=!0,a[0][0]=o[0],a[0][1]=o[1],p=Hy(o,t,!1)),l[0]=p.distance,c[0]=0;const m=[NaN,NaN];let y=!1,g=.25,v=-1,w=NaN;do if(w=NaN,a[1]=hM(t,dM(n[0],n[2],g),r,e),isNaN(a[1][0])||isNaN(a[1][1])||(p=Hy(a[1],t,!1),w=p.distance),!isNaN(w)&&w>r&&Qb(a[1],t))y=!0,l[1]=w,c[1]=hh(a[1],o);else if(!isNaN(w)&&w>v&&(v=w,m[0]=a[1][0],m[1]=a[1][1]),g-=.01,g<.1){if(!(v>=0))break;y=!0,l[1]=v,a[1][0]=m[0],a[1][1]=m[1],c[1]=hh(a[1],o)}while(!y);y=!1,g=.5,v=-1;let _=.01,x=1;do if(w=NaN,a[2]=hM(t,dM(n[0],n[2],g),r,e),isNaN(a[2][0])||isNaN(a[2][1])||(p=Hy(a[2],t,!1),w=p.distance),!isNaN(w)&&w>r&&Qb(a[2],t))y=!0,l[2]=w,c[2]=hh(a[2],o);else if(!isNaN(w)&&w>v)v=w,m[0]=a[2][0],m[1]=a[2][1];else if(w>v&&(v=w,m[0]=a[2][0],m[1]=a[2][1]),g=.5+_*x,_+=.01,x*=-1,g<.3||g>.7){if(!(v>=0))break;y=!0,l[2]=v,a[2][0]=m[0],a[2][1]=m[1],c[2]=hh(a[2],o)}while(!y);y=!1,g=.75,v=-1;do if(w=NaN,a[3]=hM(t,dM(n[0],n[2],g),r,e),isNaN(a[3][0])||isNaN(a[3][1])||(p=Hy(a[3],t,!1),w=p.distance),!isNaN(w)&&w>r&&Qb(a[3],t))y=!0,l[3]=w,c[3]=hh(a[3],o);else if(w>v&&(v=w,m[0]=a[3][0],m[1]=a[3][1]),g+=.01,g>.9){if(!(v>=0))break;y=!0,l[3]=v,a[3][0]=m[0],a[3][1]=m[1],c[3]=hh(a[3],o)}while(!y);const $=[0,1,2,3],T=d?0:1;let C;for(let j=T;j<4;j++)for(let V=T;V<3;V++){const Z=c[V],Y=c[V+1];iPe(Z,Y)>0&&(C=$[V],$[V]=$[V+1],$[V+1]=C,c[V]=Y,c[V+1]=Z)}let P=T,A=0,F=0;for(let j=T;j<4;j++){switch(j){case 0:F=2*l[$[j]];break;case 1:F=1.66666666*l[$[j]];break;case 2:F=1.33333333*l[$[j]];break;case 3:F=l[$[j]]}F>A&&(A=F,P=$[j])}return a[P]}function Qb(t,e){let r,i,s,n,o=0;for(e.reset();e.nextPath()&&e.nextPoint();)for(r=e.x,i=e.y;e.nextPoint();r=s,i=n)s=e.x,n=e.y,i>t[1]!=n>t[1]&&((s-r)*(t[1]-i)-(n-i)*(t[0]-r)>0?o++:o--);return o!==0}function Hy(t,e,r){if(r&&Qb(t,e))return{coord:t,distance:0};let i=1/0,s=0,n=0,o=[0,0],a=[0,0];const l=[0,0];for(e.reset();e.nextPath()&&e.nextPoint();)if(!(e.pathSize<2))for(o[0]=e.x,o[1]=e.y;e.nextPoint();o=a){a=[e.x,e.y],d8(l,t,o,a);const c=hh(t,l);c<i&&(i=c,s=l[0],n=l[1])}return{coord:[s,n],distance:Math.sqrt(i)}}function hM(t,e,r,i){const s=[e,0];let n=1/0,o=1/0,a=!1,l=!1;const c=[[e,i[1]-1],[e,i[3]+1]],d=[0,0],p=[0,0],m=[0,0],y=[[0,0],[0,0]],g=lr();for(t.reset();t.nextPath()&&t.nextPoint();)if(!(t.pathSize<2))for(y[0][0]=t.x,y[0][1]=t.y;t.nextPoint();y[0][0]=y[1][0],y[0][1]=y[1][1]){if(y[1][0]=t.x,y[1][1]=t.y,tPe(g,y)===null||(p[0]=c[0][0],p[1]=c[0][1],m[0]=c[1][0],m[1]=c[1][1],rPe(g,p,m)===0)||!R1(c[0],c[1],y[0],y[1],d))continue;const v=d[1];n>o?v<n&&(n=v,a=!0):v<o&&(o=v,l=!0)}return a&&l?s[1]=(n+o)/2:s[0]=s[1]=NaN,s}function tPe(t,e){if(e.length<2)return null;t||(t=lr());const[r,i]=e[0],[s,n]=e[1];return t[0]=Math.min(r,s),t[1]=Math.min(i,n),t[2]=Math.max(r,s),t[3]=Math.max(i,n),t}const g_=1,v_=4,M4=3,T4=12;function rPe(t,e,r){let i=lo(e,t),s=lo(r,t);const n=t[0],o=t[1],a=t[2],l=t[3];if(i&s)return 0;if(!(i|s))return 4;const c=(i?1:0)|(s?2:0);do{const d=r[0]-e[0],p=r[1]-e[1];if(d>p)i&M4?(i&g_?(e[1]+=p*(n-e[0])/d,e[0]=n):(e[1]+=p*(a-e[0])/d,e[0]=a),i=lo(e,t)):s&M4?(s&g_?(r[1]+=p*(n-r[0])/d,r[0]=n):(r[1]+=p*(a-r[0])/d,r[0]=a),s=lo(r,t)):i?(i&v_?(e[0]+=d*(o-e[1])/p,e[1]=o):(e[0]+=d*(l-e[1])/p,e[1]=l),i=lo(e,t)):(s&v_?(r[0]+=d*(o-r[1])/p,r[1]=o):(r[0]+=d*(l-r[1])/p,r[1]=l),s=lo(r,t));else if(i&T4?(i&v_?(e[0]+=d*(o-e[1])/p,e[1]=o):(e[0]+=d*(l-e[1])/p,e[1]=l),i=lo(e,t)):s&T4?(s&v_?(r[0]+=d*(o-r[1])/p,r[1]=o):(r[0]+=d*(l-r[1])/p,r[1]=l),s=lo(r,t)):i?(i&g_?(e[1]+=p*(n-e[0])/d,e[0]=n):(e[1]+=p*(a-e[0])/d,e[0]=a),i=lo(e,t)):(s&g_?(r[1]+=p*(n-r[0])/d,r[0]=n):(r[1]+=p*(a-r[0])/d,r[0]=a),s=lo(r,t)),i&s)return 0}while(i|s);return c}function lo(t,e){return(t[0]<e[0]?1:0)|(t[0]>e[2]?1:0)<<1|(t[1]<e[1]?1:0)<<2|(t[1]>e[3]?1:0)<<3}function dM(t,e,r){return t+(e-t)*r}function hh(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function iPe(t,e){if(t<e)return-1;if(t>e)return 1;if(t===e)return 0;const r=isNaN(t),i=isNaN(e);return r<i?-1:r>i?1:0}var na;let sPe=(na=class{static local(){return na.instance===null&&(na.instance=new na),na.instance}execute(e,r,i){return new nPe(e,r,i)}},na.instance=null,na),nPe=class{constructor(e,r,i){this._geometryCursor=e,this._offsetX=r.offsetX!==void 0?r.offsetX*i:0,this._offsetY=r.offsetY!==void 0?r.offsetY*i:0,this._method=r.method!==void 0?r.method:"OnPolygon",this._placementPerPart=r.placePerPart!==void 0&&r.placePerPart,this._internalPlacement=new oy}next(){const e=this._geometryCursor;if(!e)return null;if(!this._placementPerPart)return this._geometryCursor=null,this._polygonCenter(e);for(;e.nextPath();)if(!(e.getCurrentRingArea()<0))return this._polygonCenter(e.getCurrentPath());return this._geometryCursor=null,null}_polygonCenter(e){let r=!1;switch(this._method){case"CenterOfMass":{const i=Rne(e);i&&(this._internalPlacement.setTranslate(i[0]+this._offsetX,i[1]+this._offsetY),r=!0)}break;case"BoundingBoxCenter":{const i=Dv(e);i&&(this._internalPlacement.setTranslate((i[2]+i[0])/2+this._offsetX,(i[3]+i[1])/2+this._offsetY),r=!0)}break;default:{const i=ePe(e);i!==null&&(this._internalPlacement.setTranslate(i[0]+this._offsetX,i[1]+this._offsetY),r=!0)}}return r?this._internalPlacement:null}};function oPe(t){if(!t)return null;switch(t.type){case"CIMGeometricEffectAddControlPoints":return WEe.local();case"CIMGeometricEffectArrow":return XEe.local();case"CIMGeometricEffectBuffer":return QEe.local();case"CIMGeometricEffectControlMeasureLine":return tCe.local();case"CIMGeometricEffectCut":return iCe.local();case"CIMGeometricEffectDashes":return nCe.local();case"CIMGeometricEffectDonut":return aCe.local();case"CIMGeometricEffectJog":return fCe.local();case"CIMGeometricEffectMove":return yCe.local();case"CIMGeometricEffectOffset":return wCe.local();case"CIMGeometricEffectRadial":return SCe.local();case"CIMGeometricEffectReverse":return $Ce.local();case"CIMGeometricEffectRotate":return ICe.local();case"CIMGeometricEffectScale":return CCe.local();case"CIMGeometricEffectSuppress":return kCe.local();case"CIMGeometricEffectTaperedPolygon":return ACe.local();case"CIMGeometricEffectWave":return OCe.local();case"CIMGeometricEffectEnclosingPolygon":return uCe.local()}return null}function aPe(t){if(!t)return null;switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":return NCe.local();case"CIMMarkerPlacementAtExtremities":return zCe.local();case"CIMMarkerPlacementAtRatioPositions":return VCe.local();case"CIMMarkerPlacementInsidePolygon":return qCe.local();case"CIMMarkerPlacementOnLine":return ZCe.local();case"CIMMarkerPlacementOnVertices":return XCe.local();case"CIMMarkerPlacementPolygonCenter":return sPe.local()}return null}function pM(t){const e=t.getFrame(0);if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement)return e;const r=document.createElement("canvas");r.width=t.width,r.height=t.height;const i=r.getContext("2d");return e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0),r}function ka(t,e=0){if(e===0)return t;const r=Math.cos(e),i=Math.sin(e),[s,n]=t;return[s*r+n*-i,s*i+n*r]}function vZ(t,e,r=0){const i=Qr(t,0,cPe);for(let s=0;s<4;s++)e[r+s]=Math.floor(256*hPe(i*lPe[s]))}function wZ(t,e=0){let r=0;for(let i=0;i<4;i++)r+=t[e+i]*uPe[i];return r}const lPe=[1,256,65536,16777216],uPe=[1/256,1/65536,1/16777216,1/4294967296],cPe=wZ(new Uint8ClampedArray([255,255,255,255]));wZ(new Uint8ClampedArray([255,255,255,0]));function hPe(t){return t-Math.floor(t)}const dPe=15.5,fM=4,pPe=64,bUe=1024,SUe={outlineWidth:.75,referenceWidth:.75,cap:tr.CIMSolidStroke.capstyle,join:tr.CIMSolidStroke.joinstyle,miterLimit:tr.CIMSolidStroke.miterlimit},I4=()=>U.getLogger("esri.symbols.cim.rasterizingUtils"),fPe=32,mPe=t=>t==="vertical"||t==="horizontal"||t==="cross"||t==="esriSFSCross"||t==="esriSFSVertical"||t==="esriSFSHorizontal";function xUe(t,e,r){const i=e.style,s=Jse(Math.ceil(r)),n=mPe(i)?8*s:16*s,o=2*s;t.width=n,t.height=n;const a=t.getContext("2d");a.strokeStyle="#ffffff",a.lineWidth=s,a.beginPath(),i!=="vertical"&&i!=="cross"&&i!=="esriSFSCross"&&i!=="esriSFSVertical"||(a.moveTo(n/2,-o),a.lineTo(n/2,n+o)),i!=="horizontal"&&i!=="cross"&&i!=="esriSFSCross"&&i!=="esriSFSHorizontal"||(a.moveTo(-o,n/2),a.lineTo(n+o,n/2)),i!=="backward-diagonal"&&i!=="diagonal-cross"&&i!=="esriSFSDiagonalCross"&&i!=="esriSFSBackwardDiagonal"||(a.moveTo(-o,-o),a.lineTo(n+o,n+o),a.moveTo(n-o,-o),a.lineTo(n+o,o),a.moveTo(-o,n-o),a.lineTo(o,n+o)),i!=="forward-diagonal"&&i!=="diagonal-cross"&&i!=="esriSFSForwardDiagonal"&&i!=="esriSFSDiagonalCross"||(a.moveTo(n+o,-o),a.lineTo(-o,n+o),a.moveTo(o,-o),a.lineTo(-o,o),a.moveTo(n+o,n-o),a.lineTo(n-o,n+o)),a.stroke();const l=a.getImageData(0,0,t.width,t.height),c=new Uint8Array(l.data);let d;for(let p=0;p<c.length;p+=4)d=c[p+3]/255,c[p]=c[p]*d,c[p+1]=c[p+1]*d,c[p+2]=c[p+2]*d;return[c,t.width,t.height,s]}function $Ue(t){t.length%2==1&&(t=[...t,...t]);const e=t.reduce((p,m)=>p+m,0),r=Math.round(e*fM),i=1,s=new Float32Array(r*i);let n=0,o=0,a=.5,l=!0;for(const p of t){for(n=o,o+=p*fM;a<=o;){const m=a-.5,y=Math.min(Math.abs(a-n),Math.abs(a-o));s[m]=l?-y:y,a++}l=!l}const c=s.length,d=new Uint8Array(4*c);for(let p=0;p<c;++p){const m=s[p]/fM;vZ(m/pPe*.5+.5,d,4*p)}return[d,r,i]}function MUe(t,e){t==null&&(t=[]);const r=e==="Butt",i=e==="Square",s=!r&&!i;t.length%2==1&&(t=[...t,...t]);const n=dPe,o=2*n;let a=0;for(const _ of t)a+=_;const l=Math.round(a*n),c=new Float32Array(l*o),d=.5*n;let p=0,m=0,y=.5,g=!0;for(const _ of t){for(p=m,m+=_*n;y<=m;){let x=.5;for(;x<o;){const $=(x-.5)*l+y-.5,T=s?(x-n)*(x-n):Math.abs(x-n);c[$]=g?r?Math.max(Math.max(p+d-y,T),Math.max(y-m+d,T)):T:s?Math.min((y-p)*(y-p)+T,(y-m)*(y-m)+T):i?Math.min(Math.max(y-p,T),Math.max(m-y,T)):Math.min(Math.max(y-p+d,T),Math.max(m+d-y,T)),x++}y++}g=!g}const v=c.length,w=new Uint8Array(4*v);for(let _=0;_<v;++_){const x=(s?Math.sqrt(c[_]):c[_])/n;vZ(x,w,4*_)}return[w,l,o]}function TUe(t,e){const{colorRamp:r,gradientType:i}=e,s=r.type==="CIMFixedColorRamp",n=e.interval||tr.CIMGradientFill.interval;let o=RL(r);return s&&(o=_Z(o,n)),i==="Discrete"||s?gPe(t,o,n):yPe(t,o)}let mM;function w_(t,e){const{colorRamp:r,gradientType:i}=e,s=RL(r),n=r.type==="CIMFixedColorRamp";if(i==="Continuous"&&!n)return e1(t,s);const o=e.interval??tr.CIMGradientFill.interval;if(n)return e1(t,_Z(s,o));const a=[];mM??=document.createElement("canvas"),OL(mM,s,o,1,0);const l=mM.getContext("2d").getImageData(0,0,o,1).data;for(let c=0,d=0;c<o;c++,d=4*c){const p=[l[d+0],l[d+1],l[d+2],l[d+3]];a.push({offset:c/o,color:p}),a.push({offset:(c+1)/o,color:p})}return e1(t,a)}function RL(t){const e=[];switch(t.type){case"CIMPolarContinuousColorRamp":case"CIMLinearContinuousColorRamp":{t.type==="CIMPolarContinuousColorRamp"&&I4().warnOnce("CIMPolarContinuousColorRamp is currently unsupported. Falling back to CIMLinearContinuousColorRamp.");const r=t;e.push({offset:0,color:[r.fromColor[0],r.fromColor[1],r.fromColor[2],r.fromColor[3]/255]}),e.push({offset:1,color:[r.toColor[0],r.toColor[1],r.toColor[2],r.toColor[3]/255]});break}case"CIMFixedColorRamp":{const r=t,i=1/(r.colors.length-1);let s=0;for(const n of r.colors)e.push({offset:s,color:[n[0],n[1],n[2],n[3]/255]}),s+=i;break}case"CIMMultipartColorRamp":{const r=t,i=r.weights.reduce((n,o)=>n+o,0);let s=0;for(let n=0;n<r.colorRamps.length;n++){const o=r.colorRamps[n],a=r.weights[n],l=RL(o);for(const c of l)e.push({offset:(s+c.offset*a)/i,color:c.color});s+=a}break}default:I4().error(`Color ramp "${t.type}" currently unsupported.`)}return e}function _Z(t,e){const r=[],i=(t.length-1)/(e-1);for(let s=0;s<e;s++){const n=t[Math.round(s*i)].color;r.push({offset:s/e,color:n}),r.push({offset:(s+1)/e,color:n})}return r}function yPe(t,e){return OL(t,e,fPe,1,QG),bZ(t)}function gPe(t,e,r){return OL(t,e,r,1,QG),bZ(t)}function e1(t,e,r=0){for(const{offset:i,color:s}of e)t.addColorStop(Math.min(Math.max(i,r),1-r),`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${s[3]})`)}function OL(t,e,r,i,s){const n=r+2*s;t.width=n,t.height=i;const o=(s+1)/n,a=t.getContext("2d",{willReadFrequently:!0});if(e.length>0){const l=a.createLinearGradient(0,0,n,i);e1(l,e,o),a.fillStyle=l}else a.fillStyle="rgba(128, 128, 128, 1)";a.fillRect(0,0,n,i)}function bZ(t){const{width:e,height:r}=t,i=t.getContext("2d").getImageData(0,0,e,r),s=new Uint8Array(i.data);for(let n=0;n<s.length;n+=4){const o=s[n+3]/255;s[n]*=o,s[n+1]*=o,s[n+2]*=o}return[s,e,r]}function vPe(t){const e=t[0]?.[0]?.[0]??0,r=t[0]?.[0]?.[1]??0,i={ymin:r,xmin:e,ymax:r,xmax:e,width:0,height:0};for(let s=0;s<t.length;s++){const n=t[s];for(let o=0;o<n.length;o++){const a=n[o][0],l=n[o][1];a<i.xmin&&(i.xmin=a),a>i.xmax&&(i.xmax=a),l<i.ymin&&(i.ymin=l),l>i.ymax&&(i.ymax=l)}}return i.width=Math.abs(i.xmax-i.xmin),i.height=Math.abs(i.ymax-i.ymin),i}function AS(t,e){const r=vPe(t),i=r.width===0?1:r.width,s=r.height===0?1:r.height,n=[];for(let o=0;o<t.length;o++){const a=t[o],l=[];for(let c=0;c<a.length;c++){let d=Math.round(a[c][0]-r.xmin),p=Math.round(a[c][1]-r.ymin);if(d=e.xmin+d*e.width/i,p=e.ymin+p*e.height/s,isNaN(d)||isNaN(p))throw new Error("Scaled shape has NaN values");l.push([d,p])}n.push(l)}return n}function E4(t,e,r){const i=[];for(let s=0;s<t.length;s++){const n=t[s],o=[];for(let a=0;a<n.length;a++){const l=n[a][0]+e,c=n[a][1]+r;if(isNaN(l)||isNaN(c))throw new Error("Scaled shape has NaN values");o.push([l,c])}i.push(o)}return i}let wPe=class SZ{constructor(e=0,r=0,i=0,s=0){this.x=e,this.y=r,this.width=i,this.height=s}static fromExtent(e){return new SZ(e.xmin,-e.ymax,e.xmax-e.xmin,e.ymax-e.ymin)}get isEmpty(){return this.width<=0||this.height<=0}union(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)}};function _Pe(t){return`rgb(${t.slice(0,3).toString()})`}function __(t){return`rgba(${t.slice(0,3).toString()},${t[3]})`}let xZ=class{constructor(e){e&&(this._textRasterizationCanvas=e)}rasterizeText(e,r){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const i=this._textRasterizationCanvas,s=i.getContext("2d",{willReadFrequently:!0});Wy(s,r),this._parameters=r,this._textLines=e.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const{decoration:n,weight:o}=r.font;this._lineThroughWidthOffset=n&&n==="line-through"?.1*this._lineHeight:0;const a=r.backgroundColor!=null||r.borderLine!=null,l=a?_pe:0,c=this._computeTextWidth(s,r)+2*l,d=this._lineHeight*this._textLines.length+2*l;if(i.width=c+2*this._lineThroughWidthOffset,i.height=d,i.width===0||i.height===0)return i.width=i.height=1,{size:[0,0],image:new Uint32Array(0),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0,canvas:i};this._renderedLineHeight=Math.round(this._lineHeight),this._renderedOutlineSize=(r.outline.size||0)*r.pixelRatio,this._renderedHaloSize=(r.halo.size||0)*r.pixelRatio,this._renderedWidth=c,this._renderedHeight=d,this._lineThroughWidthOffset*=r.pixelRatio;const p=(r.outline&&r.outline.color)??[0,0,0,0],m=r.color??[0,0,0,0],y=r.halo&&r.halo.color?r.halo.color:[0,0,0,0];this._fillStyle=__(m),this._outlineStyle=__(p),this._haloStyle=_Pe(y);const g=this._renderedLineHeight,v=this._renderedOutlineSize,w=this._renderedHaloSize;s.save(),s.clearRect(0,0,i.width,i.height),Wy(s,r);const _=l*r.pixelRatio,x=bPe(s.textAlign,this._renderedWidth-2*_,this._renderedHaloSize+this._renderedOutlineSize)+_,$=w+v+_,T=w>0;let C=this._lineThroughWidthOffset,P=0;if(a){s.save();const re=r.backgroundColor??[0,0,0,0],Q=r.borderLine?.color??[0,0,0,0],Ee=2*(r.borderLine?.size??0);s.fillStyle=__(re),s.strokeStyle=__(Q),s.lineWidth=Ee,s.fillRect(0,0,i.width,i.height),s.strokeRect(0,0,i.width,i.height),s.restore()}T&&this._renderHalo(s,x,$,C,P,r),v>0&&this._renderOutline(s,x,$,C,P,r),P+=$,C+=x;for(const re of this._textLines)T?(s.globalCompositeOperation="destination-out",s.fillStyle="rgb(0, 0, 0)",s.fillText(re,C,P),s.globalCompositeOperation="source-over",s.fillStyle=this._fillStyle,s.fillText(re,C,P)):(s.fillStyle=this._fillStyle,s.fillText(re,C,P)),n&&n!=="none"&&this._renderDecoration(s,C,P,n,o),P+=g;s.restore();const A=this._renderedWidth+2*this._lineThroughWidthOffset,F=this._renderedHeight,j=s.getImageData(0,0,A,F),V=new Uint8Array(j.data);if(r.premultiplyColors){let re;for(let Q=0;Q<V.length;Q+=4)re=V[Q+3]/255,V[Q]=V[Q]*re,V[Q+1]=V[Q+1]*re,V[Q+2]=V[Q+2]*re}let Z,Y;switch(r.horizontalAlignment){case"left":Z=-.5;break;case"right":Z=.5;break;default:Z=0}switch(r.verticalAlignment){case"bottom":Y=-.5;break;case"top":Y=.5;break;case"baseline":Y=-1/6;break;default:Y=0}return{size:[A,F],image:new Uint32Array(V.buffer),sdf:!1,simplePattern:!1,anchorX:Z,anchorY:Y,canvas:i}}_renderHalo(e,r,i,s,n,o){const a=this._renderedWidth,l=this._renderedHeight;this._outlineRasterizationCanvas||(this._outlineRasterizationCanvas=document.createElement("canvas")),this._outlineRasterizationCanvas.width=a,this._outlineRasterizationCanvas.height=l;const c=this._outlineRasterizationCanvas,d=c.getContext("2d");d.clearRect(0,0,a,l),Wy(d,o);const{decoration:p,weight:m}=o.font;d.fillStyle=this._haloStyle,d.strokeStyle=this._haloStyle,d.lineJoin="round",this._renderOutlineNative(d,r,i,p,m,this._renderedHaloSize+this._renderedOutlineSize),e.globalAlpha=this._parameters.halo.color[3],e.drawImage(c,0,0,a,l,s,n,a,l),e.globalAlpha=1}_renderOutline(e,r,i,s,n,o){const a=this._renderedWidth,l=this._renderedHeight;this._outlineRasterizationCanvas||(this._outlineRasterizationCanvas=document.createElement("canvas")),this._outlineRasterizationCanvas.width=a,this._outlineRasterizationCanvas.height=l;const c=this._outlineRasterizationCanvas,d=c.getContext("2d");d.clearRect(0,0,a,l),Wy(d,o);const{decoration:p,weight:m}=o.font;d.fillStyle=this._outlineStyle,d.strokeStyle=this._outlineStyle,d.lineJoin="round",this._renderOutlineNative(d,r,i,p,m,this._renderedOutlineSize),e.globalAlpha=this._parameters.outline.color[3],e.drawImage(c,0,0,a,l,s,n,a,l),e.globalAlpha=1}_renderOutlineNative(e,r,i,s,n,o){const a=this._renderedLineHeight;for(const l of this._textLines){const c=2*o,d=5,p=.1;for(let m=0;m<d;m++){const y=(1-(d-1)*p+m*p)*c;e.lineWidth=y,e.strokeText(l,r,i),s&&s!=="none"&&this._renderDecoration(e,r,i,s,n,y)}i+=a}}computeTextSize(e,r){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const i=this._textRasterizationCanvas,s=i.getContext("2d");Wy(s,r),this._parameters=r,this._textLines=e.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const n=this._computeTextWidth(s,r),o=this._lineHeight*this._textLines.length;return i.width=n,i.height=o,[n*r.pixelRatio,o*r.pixelRatio]}_computeTextWidth(e,r){let i=0;for(const n of this._textLines)i=Math.max(i,e.measureText(n).width);const s=r.font;return(s.style==="italic"||s.style==="oblique"||typeof s.weight=="string"&&(s.weight==="bold"||s.weight==="bolder")||typeof s.weight=="number"&&s.weight>600)&&(i+=.3*e.measureText("w").width),i+=2*Pe(this._parameters.halo.size),Math.round(i)}_computeLineHeightBase(){return 1.275*this._parameters.size}_computeLineHeight(){let e=this._computeLineHeightBase();const r=this._parameters.font.decoration;return r&&r==="underline"&&(e*=1.3),Math.round(e+2*Pe(this._parameters.halo.size))}_renderDecoration(e,r,i,s,n,o){let a=.9*this._lineHeight;const l=n==="bold"?.06:n==="bolder"?.09:.04;switch(e.textAlign){case"center":r-=this._renderedWidth/2;break;case"right":r-=this._renderedWidth}const c=e.textBaseline;if(s==="underline")switch(a=.9*this._computeLineHeightBase(),c){case"top":i+=a;break;case"middle":i+=a/2}else if(s==="line-through")switch(c){case"top":i+=a/1.5;break;case"middle":i+=a/3}const d=o?1.5*o:Math.ceil(a*l);e.save(),e.beginPath(),e.strokeStyle=e.fillStyle,e.lineWidth=d,e.moveTo(r-this._lineThroughWidthOffset,i),e.lineTo(r+this._renderedWidth+2*this._lineThroughWidthOffset,i),e.stroke(),e.restore()}};function Wy(t,e){const r=Math.max(e.size,.5),i=e.font,s=`${i.style} ${i.weight} ${Pe(r).toFixed(1)}px ${i.family}, sans-serif`;let n;switch(t.font=s,t.textBaseline="top",e.horizontalAlignment){case"left":default:n="left";break;case"right":n="right";break;case"center":n="center"}t.textAlign=n}function bPe(t,e,r){return t==="center"?.5*e:t==="right"?e-r:r}function $Z(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function SPe(){const t=$Z("svg");return t.setAttribute("style","position: absolute;"),t.setAttribute("width","0"),t.setAttribute("height","0"),t.setAttribute("aria-hidden","true"),t.setAttribute("role","presentation"),document.body.appendChild(t),t}function xPe(t){return t!=null&&document.body.removeChild(t),null}const $Pe=()=>U.getLogger("esri.views.2d.engine.webgl.alignmentUtils");function MPe(t){if(!t)return 0;switch(t){case"Left":case"left":return-1;case"Right":case"right":return 1;case"Justify":return $Pe().warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),0;case"Center":case"center":return 0}}function TPe(t){if(!t)return 0;switch(t){case"Top":case"top":return 1;case"Center":case"middle":return 0;case"Baseline":case"baseline":return 2;case"Bottom":case"bottom":return-1}}function EUe(t){switch(t){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return["right","bottom"];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return["center","bottom"];case"above-right":case"esriServerPointLabelPlacementAboveRight":return["left","bottom"];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return["right","middle"];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return["center","middle"];case"center-right":case"esriServerPointLabelPlacementCenterRight":return["left","middle"];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return["right","top"];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return["center","top"];case"below-right":case"esriServerPointLabelPlacementBelowRight":return["left","top"];default:return console.debug(`Found invalid placement type ${t}`),["center","middle"]}}function CUe(t){switch(t){case 1:case"right":return-1;case 0:case"center":return 0;case-1:case"left":return 1;default:return console.debug(`Found invalid horizontal alignment ${t}`),0}}function PUe(t){switch(t){case 1:case"top":return 1;case 0:case"middle":return 0;case-1:case 2:case"baseline":case"bottom":return-1;default:return console.debug(`Found invalid vertical alignment ${t}`),0}}let IPe=class{constructor(e=0,r=0,i=0,s=0){this.x=e,this.y=r,this.width=i,this.height=s}get isEmpty(){return this.width<=0||this.height<=0}union(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)}},Wg=class yC{constructor(e,r,i,s){this.transformedX=0,this.transformedY=0,this.center=hd(e,r),this.centerT=ev(),this.halfWidth=i/2,this.halfHeight=s/2,this.width=i,this.height=s}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(e){this.center[0]=e}set y(e){this.center[1]=e}clone(){return new yC(this.x,this.y,this.width,this.height)}serialize(e){return e.writeF32(this.center[0]),e.writeF32(this.center[1]),e.push(this.width),e.push(this.height),e}findCollisionDelta(e,r=4){const i=Math.abs(e.centerT[0]-this.centerT[0]),s=Math.abs(e.centerT[1]-this.centerT[1]),n=(e.halfWidth+this.halfWidth+r)/i,o=(e.halfHeight+this.halfHeight+r)/s,a=Math.min(n,o);return Math.log2(a)}extend(e){const r=Math.min(this.xmin,e.xmin),i=Math.min(this.ymin,e.ymin),s=Math.max(this.xmax,e.xmax)-r,n=Math.max(this.ymax,e.ymax)-i,o=r+s/2,a=i+n/2;this.width=s,this.height=n,this.halfWidth=s/2,this.halfHeight=n/2,this.x=o,this.y=a}static deserialize(e){const r=e.readF32(),i=e.readF32(),s=e.readInt32(),n=e.readInt32();return new yC(r,i,s,n)}};const FL=22,MZ=4,EPe=FL+MZ,CPe=FL-6,C4=3,PPe=Math.PI/180,iu=8,kPe=1.5;let TZ=class{constructor(e,r,i,s){this._rotationT=$l(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const n=i.rect,o=new Float32Array(8);e*=s,r*=s;const a=i.code?n.width*s:i.metrics.width,l=i.code?n.height*s:i.metrics.height;this.width=a,this.height=l,o[0]=e,o[1]=r,o[2]=e+a,o[3]=r,o[4]=e,o[5]=r+l,o[6]=e+a,o[7]=r+l,this._data=o,this._setTextureCoords(n),this._scale=s,this._mosaic=i,this.x=e,this.y=r,this.maxOffset=Math.max(e+a,r+l)}get mosaic(){return this._mosaic}set angle(e){this._angle=e,N2(this._rotationT,-e),this._setOffsets()}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:e,width:r}=this._mosaic.metrics,i=r*this._scale,s=Math.abs(e)*this._scale,n=new Float32Array(8);n[0]=this.x,n[1]=this.y,n[2]=this.x+i,n[3]=this.y,n[4]=this.x,n[5]=this.y+s,n[6]=this.x+i,n[7]=this.y+s;const o=Lo($l(),this._rotationT,this._transform);bG(n,n,o);let a=1/0,l=1/0,c=-1/0,d=-1/0;for(let v=0;v<4;v++){const w=n[2*v],_=n[2*v+1];a=Math.min(a,w),l=Math.min(l,_),c=Math.max(c,w),d=Math.max(d,_)}const p=c-a,m=d-l,y=a+p/2,g=l+m/2;this._bounds=new Wg(y,g,p,m)}return this._bounds}setTransform(e){this._transform=e,this._offsets=null}_setOffsets(){this._offsets||(this._offsets={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0]});const e=Lo($l(),this._rotationT,this._transform);this._offsets.topLeft[0]=this._data[0],this._offsets.topLeft[1]=this._data[1],this._offsets.topRight[0]=this._data[2],this._offsets.topRight[1]=this._data[3],this._offsets.bottomLeft[0]=this._data[4],this._offsets.bottomLeft[1]=this._data[5],this._offsets.bottomRight[0]=this._data[6],this._offsets.bottomRight[1]=this._data[7],gi(this._offsets.topLeft,this._offsets.topLeft,e),gi(this._offsets.topRight,this._offsets.topRight,e),gi(this._offsets.bottomLeft,this._offsets.bottomLeft,e),gi(this._offsets.bottomRight,this._offsets.bottomRight,e)}_setTextureCoords({x:e,y:r,width:i,height:s}){this._texcoords={topLeft:[e,r],topRight:[e+i,r],bottomLeft:[e,r+s],bottomRight:[e+i,r+s]}}};const LPe=(t,e)=>({code:0,page:0,sdf:!0,rect:new IPe(0,0,11,8),textureBinding:e,metrics:{advance:0,height:4,width:t,left:0,top:0}});function Zy(t,e){return t.forEach(r=>gi(r,r,e)),{topLeft:t[0],topRight:t[1],bottomLeft:t[2],bottomRight:t[3]}}let APe=class{constructor(e,r,i){this._rotation=0,this._decorate(e,r,i),this.glyphs=e,this.bounds=this._createBounds(e),this.isMultiline=r.length>1,this._hasRotation=i.angle!==0,this._transform=this._createGlyphTransform(this.bounds,i),this._borderLineSizePx=i.borderLineSizePx,(i.borderLineSizePx||i.hasBackground)&&([this.bounds,this.textBox]=this.shapeBackground(this._transform));for(const s of e)s.setTransform(this._transform)}setRotation(e){if(e===0&&this._rotation===0)return;this._rotation=e;const r=this._transform,i=N2($l(),e);Lo(r,i,r);for(const s of this.glyphs)s.setTransform(this._transform)}_decorate(e,r,i){if(!i.decoration||i.decoration==="none"||!e.length)return;const s=i.scale,n=i.decoration==="underline"?EPe:CPe,o=e[0].textureBinding;for(const a of r){const l=a.startX*s,c=a.startY*s,d=(a.width+a.glyphWidthEnd)*s;e.push(new TZ(l,c+n*s,LPe(d,o),1))}}shapeBackground(e){const r=this._borderLineSizePx||0,i=(kPe+r)/2,s=this._borderLineSizePx?i:0,{xmin:n,ymin:o,xmax:a,ymax:l,x:c,y:d,width:p,height:m}=this.bounds,y=[n-iu,o-iu],g=[a+iu,o-iu],v=[n-iu,l+iu],w=[a+iu,l+iu],_=Zy([[y[0]-i,y[1]-i],[g[0]+i,g[1]-i],[y[0]+s,y[1]+s],[g[0]-s,g[1]+s]],e),x=Zy([[v[0]+s,v[1]-s],[w[0]-s,w[1]-s],[v[0]-i,v[1]+i],[w[0]+i,w[1]+i]],e),$=Zy([[y[0]-i,y[1]-i],[y[0]+s,y[1]+s],[v[0]-i,v[1]+i],[v[0]+s,v[1]-s]],e),T=Zy([[g[0]-s,g[1]+s],[g[0]+i,g[1]-i],[w[0]-s,w[1]-s],[w[0]+i,w[1]+i]],e),C={main:Zy([y,g,v,w],e),top:_,bot:x,left:$,right:T};return[new Wg(c,d,p+2*i,m+2*i),C]}get boundsT(){const e=this.bounds,r=Xt(ev(),e.x,e.y);if(gi(r,r,this._transform),this._hasRotation){const i=Math.max(e.width,e.height);return new Wg(r[0],r[1],i,i)}return new Wg(r[0],r[1],e.width,e.height)}_createBounds(e){let r=1/0,i=1/0,s=0,n=0;for(const l of e)r=Math.min(r,l.xTopLeft),i=Math.min(i,l.yTopLeft),s=Math.max(s,l.xBottomRight),n=Math.max(n,l.yBottomRight);const o=s-r,a=n-i;return new Wg(r+o/2,i+a/2,o,a)}_createGlyphTransform(e,r){const i=PPe*r.angle,s=$l(),n=ev();return da(s,s,Xt(n,r.xOffset,-r.yOffset)),r.useCIMAngleBehavior?uc(s,s,i):(da(s,s,Xt(n,e.x,e.y)),uc(s,s,i),da(s,s,Xt(n,-e.x,-e.y))),s}},b_=class{constructor(e,r,i,s,n,o){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(r,i)),this.end=Math.max(0,Math.max(r,i)),this.end<e.length&&(this.glyphWidthEnd=e[this.end].metrics.width),this.width=s,this.yMin=n,this.yMax=o}};const gC=t=>t===10,P4=t=>t===32;function RPe(t,e,r){const i=new Array,s=1/r.scale,n=r.maxLineWidth*s,o=e?t.length-1:0,a=e?-1:t.length,l=e?-1:1;let c=o,d=0,p=0,m=c,y=m,g=0,v=1/0,w=0;for(;c!==a;){const{code:x,metrics:$}=t[c],T=Math.abs($.top);if(gC(x)||P4(x)||(v=Math.min(v,T),w=Math.max(w,T+$.height)),gC(x))c!==o&&(i.push(new b_(t,m,c-l,d,v===1/0?0:v,w)),v=1/0,w=0),d=0,m=c+l,y=c+l,p=0;else if(P4(x))y=c+l,p=0,g=$.advance,d+=$.advance;else if(d>n){if(y!==m){const C=y-2*l;d-=g,i.push(new b_(t,m,C,d-p,v,w)),v=1/0,w=0,m=y,d=p}else i.push(new b_(t,m,c-l,d,v,w)),v=1/0,w=0,m=c,y=c,d=0;d+=$.advance,p+=$.advance}else d+=$.advance,p+=$.advance;c+=l}const _=new b_(t,m,c-l,d,v,w);return _.start>=0&&_.end<t.length&&i.push(_),i}function OPe(t,e){let r=0;for(let n=0;n<t.length;n++){const{width:o}=t[n];r=Math.max(o,r)}const i=e.decoration==="underline"?MZ:0,s=t[0].yMin;return{x:0,y:s,height:t[t.length-1].yMax+e.lineHeight*(t.length-1)+i-s,width:r}}function IZ(t,e){const r=e.scale,i=new Array,{glyphs:s,isRightToLeft:n}=t,o=RPe(s,n,e),a=o.length?OPe(o,e):{y:0,height:0},l=MPe(e.horizontalAlignment),c=TPe(e.verticalAlignment),d=c===2?1:0,p=d?0:c-1,m=(1-d)*-a.y+p*(a.height/2)+(d?1:0)*-FL;for(let y=0;y<o.length;y++){const{start:g,end:v,width:w}=o[y];let _=-1*(l+1)*(w/2)-C4;const x=(t.isRightToLeft?o.length-1-y:y)*e.lineHeight+m-C4;o[y].startX=_,o[y].startY=x;for(let $=g;$<=v;$++){const T=s[$];if(gC(T.code))continue;const C=new TZ(_+T.metrics.left,x-T.metrics.top,T,r);_+=T.metrics.advance,i.push(C)}}return new APe(i,o,e)}const OUe=50;function FUe(t){if(!t)return null;const{xmin:e,ymin:r,xmax:i,ymax:s,spatialReference:n}=t;return new dt({rings:[[[e,r],[e,s],[i,s],[i,r],[e,r]]],spatialReference:n})}function EZ(t){return Ke(Math.round(Pe(t)))}function CZ(t){const e=Ke(U0e),r=Ke(G0e);return Math.max(e,Math.min(t||r,r))}const Eh=Math.PI/180,PZ=.5,Zg=()=>U.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");class jr{constructor(e){this._t=e}static createIdentity(){return new jr([1,0,0,0,1,0])}clone(){const e=this._t;return new jr(e.slice())}transform(e){const r=this._t;return[r[0]*e[0]+r[1]*e[1]+r[2],r[3]*e[0]+r[4]*e[1]+r[5]]}static createScale(e,r){return new jr([e,0,0,0,r,0])}scale(e,r){const i=this._t;return i[0]*=e,i[1]*=e,i[2]*=e,i[3]*=r,i[4]*=r,i[5]*=r,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(e,r){return new jr([0,0,e,0,0,r])}translate(e,r){const i=this._t;return i[2]+=e,i[5]+=r,this}static createRotate(e){const r=Math.cos(e),i=Math.sin(e);return new jr([r,-i,0,i,r,0])}rotate(e){return jr.multiply(this,jr.createRotate(e),this)}angle(){const e=this._t[0],r=this._t[3],i=Math.sqrt(e*e+r*r);return[e/i,r/i]}static multiply(e,r,i){const s=e._t,n=r._t,o=s[0]*n[0]+s[3]*n[1],a=s[1]*n[0]+s[4]*n[1],l=s[2]*n[0]+s[5]*n[1]+n[2],c=s[0]*n[3]+s[3]*n[4],d=s[1]*n[3]+s[4]*n[4],p=s[2]*n[3]+s[5]*n[4]+n[5],m=i._t;return m[0]=o,m[1]=a,m[2]=l,m[3]=c,m[4]=d,m[5]=p,i}invert(){const e=this._t;let r=e[0]*e[4]-e[1]*e[3];if(r===0)return new jr([0,0,0,0,0,0]);r=1/r;const i=(e[1]*e[5]-e[2]*e[4])*r,s=(e[2]*e[3]-e[0]*e[5])*r,n=e[4]*r,o=-e[1]*r,a=-e[3]*r,l=e[0]*r;return new jr([n,o,i,a,l,s])}}class NL{constructor(e,r){this._resourceManager=e,this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new yd(()=>new oy,void 0,void 0,100),this._earlyReturn=!1,this._mapRotation=0,this._transfos.push(r||jr.createIdentity()),this._sizeTransfos.push(r?r.scaleRatio():1)}setTransform(e,r){this._transfos=[e||jr.createIdentity()],this._sizeTransfos=[r||(e?e.scaleRatio():1)]}setGeomUnitsPerPoint(e){this._geomUnitsPerPoint=e}transformPt(e){return this._transfos[this._transfos.length-1].transform(e)}transformSize(e){return e*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(e){return this._transfos[this._transfos.length-1].invert().transform(e)}reverseTransformSize(e){return e/this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformScalar(e){return e/this._transfos[this._transfos.length-1].scaleRatio()}getTransformAngle(){return this._transfos[this._transfos.length-1].angle()}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}prevGeomUnitsPerPoint(){return this._transfos.length>2?1:this._geomUnitsPerPoint}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(e,r){const i=r?e.scaleRatio():1;jr.multiply(e,this.back(),e),this._transfos.push(e),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*i)}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}drawSymbol(e,r,i){if(e)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(e,r);break;case"CIMTextSymbol":this.drawTextSymbol(e,r,i)}}drawMultiLayerSymbol(e,r){if(!e||!r)return;const i=e.symbolLayers;if(!i)return;const s=e.effects;if(s&&s.length>0){const n=this.executeEffects(s,r);if(n){let o=n.next();for(;o;)this.drawSymbolLayers(i,o.asJSON()),o=n.next()}}else this.drawSymbolLayers(i,r)}executeEffects(e,r){let i=new jEe(Qe.fromJSONCIM(r));for(const s of e){const n=oPe(s);n&&(i=n.execute(i,s,this.geomUnitsPerPoint(),null))}return i}drawSymbolLayers(e,r){let i=e.length;for(;i--;){const s=e[i];if(!s||s.enable===!1)continue;const n=s.effects;if(n&&n.length>0){const o=this.executeEffects(n,r);if(o){let a=null;for(;(a=o.next())&&(this.drawSymbolLayer(s,a.asJSON()),!this._earlyReturn););}}else this.drawSymbolLayer(s,r);if(this._earlyReturn)return}}drawSymbolLayer(e,r){switch(e.type){case"CIMSolidFill":this.drawSolidFill(r,e.color,e.path);break;case"CIMHatchFill":this.drawHatchFill(r,e);break;case"CIMPictureFill":this.drawPictureFill(r,e);break;case"CIMGradientFill":this.drawGradientFill(r,e);break;case"CIMSolidStroke":this.drawSolidStroke(r,e.color,e.width,e.capStyle,e.joinStyle,e.miterLimit,e.path);break;case"CIMPictureStroke":this.drawPictureStroke(r,e);break;case"CIMGradientStroke":this.drawGradientStroke(r,e);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(e,r)}}drawHatchFill(e,r){const i=NPe(r,e,this.geomUnitsPerPoint());i&&(this.pushClipPath(e),this.drawMultiLayerSymbol(r.lineSymbol,i),this.popClipPath())}drawPictureFill(e,r){}drawGradientFill(e,r){}drawPictureStroke(e,r){}drawGradientStroke(e,r){}drawMarkerLayer(e,r){const i=e.markerPlacement;if(i){const s=aPe(i);if(s){const n=i.type==="CIMMarkerPlacementInsidePolygon"||i.type==="CIMMarkerPlacementPolygonCenter"&&i.clipAtBoundary;n&&this.pushClipPath(r);const o=s.execute(Qe.fromJSONCIM(r),i,this.geomUnitsPerPoint(),null);if(o){let a=null;for(;(a=o.next())&&(this.drawMarker(e,a),!this._earlyReturn););}n&&this.popClipPath()}}else{const s=this._placementPool.acquire();if(Z0(r))s.tx=r.x,s.ty=r.y,this.drawMarker(e,s);else if(Kt(r)){const n=y8(r);n&&([s.tx,s.ty]=n,this.drawMarker(e,s))}else if(Xr(r)){for(const n of r.paths)for(const o of n)if(s.tx=o[0],s.ty=o[1],this.drawMarker(e,s),this._earlyReturn)break}else for(const n of r.points)if(s.tx=n[0],s.ty=n[1],this.drawMarker(e,s),this._earlyReturn)break;this._placementPool.release(s)}}drawMarker(e,r){switch(e.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(e,r);break;case"CIMVectorMarker":this.drawVectorMarker(e,r)}}drawPictureMarker(e,r){if(!e)return;const i=this._resourceManager.getResource(e.url),s=xe(e.size,tr.CIMPictureMarker.size);if(i==null||s<=0)return;const n=i.width,o=i.height;if(!n||!o)return;const a=n/o,l=xe(e.scaleX,1),c=jr.createIdentity(),d=e.anchorPoint;if(d){let w=d.x,_=d.y;e.anchorPointUnits!=="Absolute"&&(w*=s*a*l,_*=s),c.translate(-w,-_)}let p=xe(e.rotation);e.rotateClockwise&&(p=-p),this._mapRotation&&(p+=this._mapRotation),p&&c.rotate(p*Eh);let m=xe(e.offsetX),y=xe(e.offsetY);if(m||y){if(this._mapRotation){const w=Eh*this._mapRotation,_=Math.cos(w),x=Math.sin(w),$=m*x+y*_;m=m*_-y*x,y=$}c.translate(m,y)}const g=this.geomUnitsPerPoint();g!==1&&c.scale(g,g);const v=r.getAngle();v&&c.rotate(v),c.translate(r.tx,r.ty),this.push(c,!1),this.drawImage(e,s),this.pop()}drawVectorMarker(e,r){if(!e)return;const i=e.markerGraphics;if(!i)return;const s=xe(e.size,tr.CIMVectorMarker.size),n=e.frame,o=n?n.ymax-n.ymin:0,a=s&&o?s/o:1,l=jr.createIdentity();n&&l.translate(.5*-(n.xmax+n.xmin),.5*-(n.ymax+n.ymin));const c=e.anchorPoint;if(c){let v=c.x,w=c.y;e.anchorPointUnits!=="Absolute"?n&&(v*=n.xmax-n.xmin,w*=n.ymax-n.ymin):(v/=a,w/=a),l.translate(-v,-w)}a!==1&&l.scale(a,a);let d=xe(e.rotation);e.rotateClockwise&&(d=-d),this._mapRotation&&(d+=this._mapRotation),d&&l.rotate(d*Eh);let p=xe(e.offsetX),m=xe(e.offsetY);if(p||m){if(this._mapRotation){const v=Eh*this._mapRotation,w=Math.cos(v),_=Math.sin(v),x=p*_+m*w;p=p*w-m*_,m=x}l.translate(p,m)}const y=this.geomUnitsPerPoint();y!==1&&l.scale(y,y);const g=r.getAngle();g&&l.rotate(g),l.translate(r.tx,r.ty),this.push(l,e.scaleSymbolsProportionally);for(const v of i){v?.symbol&&v.geometry||Zg().error("Invalid marker graphic",v);let w=v.textString;if(typeof w=="number"&&(w=w.toString()),this.drawSymbol(v.symbol,v.geometry,w),this._earlyReturn)break}this.pop()}drawTextSymbol(e,r,i){if(!e||!Z0(r)||xe(e.height,tr.CIMTextSymbol.height)<=0)return;const s=jr.createIdentity();let n=xe(e.angle);n=-n,n&&s.rotate(n*Eh);const o=xe(e.offsetX),a=xe(e.offsetY);(o||a)&&s.translate(o,a);const l=this.geomUnitsPerPoint();l!==1&&s.scale(l,l),s.translate(r.x,r.y),this.push(s,!1),this.drawText(e,i),this.pop()}}class FPe extends NL{constructor(e,r){super(e,r),this.reset()}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}envelope(){return new wPe(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return b8(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(e){if(e&&!(this._clipCount>0))if(Kt(e))this._processPath(e.rings,0);else if(Xr(e))this._processPath(e.paths,0);else if(Ni(e)){const r=al(e);r&&this._processPath(r.rings,0)}else console.error("drawSolidFill Unexpected geometry type!")}drawSolidStroke(e,r,i){if(!e||this._clipCount>0||i==null||i<=0)return;const s=Math.max(.5*this.transformSize(xe(i,tr.CIMSolidStroke.width)),.5*PZ);if(Kt(e))this._processPath(e.rings,s);else if(Xr(e))this._processPath(e.paths,s);else if(Ni(e)){const n=al(e);n&&this._processPath(n.rings,s)}else console.error("drawSolidStroke unexpected geometry type!")}drawMarkerLayer(e,r){Kt(r)&&e.markerPlacement&&(e.markerPlacement.type==="CIMMarkerPlacementInsidePolygon"||e.markerPlacement.type==="CIMMarkerPlacementPolygonCenter"&&e.markerPlacement.clipAtBoundary)?this._processPath(r.rings,0):super.drawMarkerLayer(e,r)}drawHatchFill(e,r){this.drawSolidFill(e)}drawPictureFill(e,r){this.drawSolidFill(e)}drawGradientFill(e,r){this.drawSolidFill(e)}drawPictureStroke(e,r){this.drawSolidStroke(e,null,r.width)}drawGradientStroke(e,r){this.drawSolidStroke(e,null,r.width)}pushClipPath(e){this.drawSolidFill(e),this._clipCount++}popClipPath(){this._clipCount--}drawImage(e,r){const{url:i}=e,s=xe(e.scaleX,1);let n=s*r,o=r;const a=this._resourceManager.getResource(i);if(a!=null){const l=a.height/a.width;n=s*(r?l>1?r:r/l:a.width),o=r?l>1?r*l:r:a.height}this._merge(this.transformPt([-n/2,-o/2]),0),this._merge(this.transformPt([-n/2,o/2]),0),this._merge(this.transformPt([n/2,-o/2]),0),this._merge(this.transformPt([n/2,o/2]),0)}drawText(e,r){if(!r||r.length===0)return;this._textRasterizer||(this._textRasterizer=new xZ);const i=AZ(e);let[s,n]=this._textRasterizer.computeTextSize(r,i);s=Ke(s),n=Ke(n);const o=this.transformSize(1)*this.reverseTransformScalar(1);s*=o,n*=o;let a=0;switch(e.horizontalAlignment){case"Left":a=s/2;break;case"Right":a=-s/2}let l=0;switch(e.verticalAlignment){case"Bottom":l=n/2;break;case"Top":l=-n/2;break;case"Baseline":l=n/6}this._merge(this.transformPt([-s/2+a,-n/2+l]),0),this._merge(this.transformPt([-s/2+a,n/2+l]),0),this._merge(this.transformPt([s/2+a,-n/2+l]),0),this._merge(this.transformPt([s/2+a,n/2+l]),0)}_processPath(e,r){if(e)for(const i of e){const s=i?i.length:0;if(s>1){this._merge(this.transformPt(i[0]),r);for(let n=1;n<s;n++)this._merge(this.transformPt(i[n]),r)}}}_merge(e,r){e[0]-r<this._xmin&&(this._xmin=e[0]-r),e[0]+r>this._xmax&&(this._xmax=e[0]+r),e[1]-r<this._ymin&&(this._ymin=e[1]-r),e[1]+r>this._ymax&&(this._ymax=e[1]+r)}}class NUe extends NL{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0,this._textInfo=null,this._svg=null,this._path=null,this._canvas=null}destroy(){this._svg=xPe(this._svg),this._path=null,this._canvas=null}hitTest(e,r,i,s,n,o){const a=o*Pe(1);this.setTransform(),this.setGeomUnitsPerPoint(a),this._searchPoint=[(e[0]+e[2])/2,(e[1]+e[3])/2],this._searchDistPoint=(e[2]-e[0])/2/a,this._textInfo=s;const l=r&&(r.type==="CIMPointSymbol"&&r.angleAlignment!=="Map"||r.type==="CIMTextSymbol");if(this._mapRotation=l?n:0,!z("esri-mobile")){const c=Ke(N0e*window.devicePixelRatio),d=Ke(D0e);!((r?.type==="CIMLineSymbol"||r?.type==="CIMPolygonSymbol")&&r.symbolLayers?.some(Qxe))&&r?.type!=="CIMMeshSymbol"&&(c$e(r)??0)<d&&(this._searchDistPoint=c)}return this._earlyReturn=!1,this.drawSymbol(r,i),this._earlyReturn}executeEffects(e,r){return e.at(-1)?.type==="CIMGeometricEffectDashes"&&(e=e.slice(0,-1)),super.executeEffects(e,r)}drawSolidFill(e,r,i){i!=null?this._hittestSvgPath(e,i,!0):this._hitTestFill(e)}drawHatchFill(e,r){this._hitTestFill(e)}drawPictureFill(e,r){this._hitTestFill(e)}drawGradientFill(e,r){this._hitTestFill(e)}drawSolidStroke(e,r,i,s,n,o,a){a!=null?this._hittestSvgPath(e,a,!1,i):this._hitTestStroke(e,i)}drawPictureStroke(e,r){this._hitTestStroke(e,r.width)}drawGradientStroke(e,r){this._hitTestStroke(e,r.width)}drawMarkerLayer(e,r){e.markerPlacement&&(e.markerPlacement.type==="CIMMarkerPlacementInsidePolygon"||e.markerPlacement.type==="CIMMarkerPlacementPolygonCenter"&&e.markerPlacement.clipAtBoundary)?this._hitTestFill(r):super.drawMarkerLayer(e,r)}pushClipPath(e){}popClipPath(){}drawImage(e,r){const{url:i}=e,s=xe(e.scaleX,1),n=this._resourceManager.getResource(i);if(n==null||n.height===0||r===0)return;const o=r*this.geomUnitsPerPoint(),a=o*s*(n.width/n.height),l=this.reverseTransformPt(this._searchPoint),c=this._searchDistPoint;Math.abs(l[0])<a/2+c&&Math.abs(l[1])<o/2+c&&(this._earlyReturn=!0)}drawText(e,r){const i=this._textInfo;if(!i)return;const s=i.get(e);if(!s||!s.glyphMosaicItems.glyphs.length)return;const n=EZ(xe(e.height,tr.CIMTextSymbol.height)),{lineGapType:o,lineGap:a}=e,l=o?LZ(o,xe(a),n):0,c=e.callout?.type==="CIMBackgroundCallout",d=IZ(s.glyphMosaicItems,{scale:n/XG,angle:0,xOffset:0,yOffset:0,horizontalAlignment:e.horizontalAlignment,verticalAlignment:e.verticalAlignment,maxLineWidth:CZ(e.lineWidth),lineHeight:YG*Math.max(.25,Math.min(l||1,4)),decoration:e.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:c}),p=this.reverseTransformPt(this._searchPoint),m=p[0],y=p[1];for(const g of d.glyphs)if(m>g.xTopLeft&&m<g.xBottomRight&&y>-g.yBottomRight&&y<-g.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(e){let r=null;if(Ni(e)){const s=e;r=[[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]]}else if(Kt(e))r=e.rings;else{if(!Xr(e))return;r=e.paths}const i=this.reverseTransformPt(this._searchPoint);DPe(i,r)&&(this._earlyReturn=!0),!this._earlyReturn&&k4(i,r,this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}_getSvgPath(){return this._svg!=null&&this._path!=null||(this._svg??=SPe(),this._path??=$Z("path"),this._svg.appendChild(this._path)),this._path}_getCanvasContext(e,r){return this._canvas??=document.createElement("canvas"),this._canvas.width=e,this._canvas.height=r,this._canvas.getContext("2d",{willReadFrequently:!0})}_hittestSvgPath(e,r,i,s=0){const n=this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint(),o=this.reverseTransformPt(this._searchPoint),a=lr();YP(a,e);const l={x:a[0],y:a[1],width:a[2]-a[0],height:a[3]-a[1]},c=this._getSvgPath();c.setAttribute("d",r);const d=c.getBBox();let p=Math.max(d.width/l.width,d.height/l.height),m=1;const y=2*n*p;y<1&&(m=2/y,p*=m,d.x*=m,d.y*=m,d.width*=m,d.height*=m);const g=1+s*p/2,v=this._getCanvasContext(d.width+2*g,d.height+2*g);v.setTransform(m,0,0,m,-d.x+g,-d.y+g);const w=new Path2D(r);i?v.fill(w):(v.lineWidth=s*(p/m),v.stroke(w));const _=(l.width*p-d.width)/2,x=(l.height*p-d.height)/2,$=Math.floor((o[0]-l.x-n)*p-_+g),T=Math.floor((l.height-(o[1]-l.y)-n)*p+x+g),C=Math.ceil(2*n*p),P=Math.ceil(2*n*p),A=v.getImageData($,T,C,P).data;for(let F=3;F<A.length;F+=4)if(A[F]>127.5)return void(this._earlyReturn=!0)}_hitTestStroke(e,r){let i=null;if(Ni(e)){const s=e;i=[[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]]}else if(Kt(e))i=e.rings;else{if(!Xr(e))return;i=e.paths}k4(this.reverseTransformPt(this._searchPoint),i,xe(r,tr.CIMSolidStroke.width)*this.geomUnitsPerPoint()/2+this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}}class kZ extends NL{constructor(e,r,i,s){super(r,i),this._applyAdditionalRenderProps=s,this._colorSubstitutionHelper=new HEe,this._ctx=e}drawSolidFill(e,r){if(!e)return;if(Kt(e))this._buildPath(e.rings,!0);else if(Xr(e))this._buildPath(e.paths,!0);else if(Ni(e))this._buildPath(al(e).rings,!0);else{if(!Pf(e))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!")}const i=this._ctx;i.fillStyle=typeof r=="string"?r:"rgba("+Math.round(r[0])+","+Math.round(r[1])+","+Math.round(r[2])+","+(r[3]??255)/255+")",i.fill("evenodd")}drawSolidStroke(e,r,i,s,n,o){if(!e||!r||i===0)return;if(Kt(e))this._buildPath(e.rings,!0);else if(Xr(e))this._buildPath(e.paths,!1);else{if(!Ni(e))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(al(e).rings,!0)}const a=this._ctx;a.strokeStyle=typeof r=="string"?r:"rgba("+Math.round(r[0])+","+Math.round(r[1])+","+Math.round(r[2])+","+(r[3]??255)/255+")",a.lineWidth=Math.max(this.transformSize(i),PZ),this._setCapStyle(s),this._setJoinStyle(n),a.miterLimit=o,a.stroke()}pushClipPath(e){if(this._ctx.save(),Kt(e))this._buildPath(e.rings,!0);else if(Xr(e))this._buildPath(e.paths,!0);else{if(!Ni(e))return;this._buildPath(al(e).rings,!0)}this._ctx.clip("evenodd")}popClipPath(){this._ctx.restore()}drawImage(e,r){const{colorSubstitutions:i,url:s,tintColor:n}=e,o=xe(e.scaleX,1),a=this._resourceManager.getResource(s);if(a==null)return;let l=r*(a.width/a.height),c=r;r||(l=a.width,c=a.height);const d=Jd(s)||"src"in a&&Jd(a.src);let p="getFrame"in a?pM(a):a;i&&(p=this._colorSubstitutionHelper.applyColorSubstitution(p,i)),this._applyAdditionalRenderProps&&!d&&n&&(p=this._colorSubstitutionHelper.tintImageData(p,n));const m=this.transformPt([0,0]),[y,g]=this.getTransformAngle(),v=this.transformSize(1),w=this._ctx;w.save(),w.setTransform({m11:o*v*y,m12:o*v*g,m21:-v*g,m22:v*y,m41:m[0],m42:m[1]}),w.drawImage(p,-l/2,-c/2,l,c),w.restore()}drawText(e,r){if(!r||r.length===0)return;this._textRasterizer||(this._textRasterizer=new xZ);const i=AZ(e,this.transformSize(Ke(1))),s=this._textRasterizer.rasterizeText(r,i);if(!s)return;const{size:n,anchorX:o,anchorY:a,canvas:l}=s,c=n[0]*(o+.5),d=n[1]*(a-.5),p=this._ctx,m=this.transformPt([0,0]),[y,g]=this.getTransformAngle(),v=1;p.save(),p.setTransform({m11:v*y,m12:v*g,m21:-v*g,m22:v*y,m41:m[0]-v*c,m42:m[1]+v*d}),p.drawImage(l,0,0),p.restore()}drawPictureFill(e,r){if(!e)return;let{colorSubstitutions:i,height:s,offsetX:n,offsetY:o,rotation:a,scaleX:l,tintColor:c,url:d}=r;const p=this._resourceManager.getResource(d);if(p==null)return;if(Kt(e))this._buildPath(e.rings,!0);else if(Xr(e))this._buildPath(e.paths,!0);else if(Ni(e))this._buildPath(al(e).rings,!0);else{if(!Pf(e))return;console.log("CanvasDrawHelper.drawPictureFill - No implementation!")}const m=this._ctx,y=Jd(d)||"src"in p&&Jd(p.src);let g,v="getFrame"in p?pM(p):p;if(i&&(v=this._colorSubstitutionHelper.applyColorSubstitution(v,i)),this._applyAdditionalRenderProps){y||c&&(v=this._colorSubstitutionHelper.tintImageData(v,c)),g=m.createPattern(v,"repeat");const w=this.transformSize(1);a||(a=0),n?n*=w:n=0,o?o*=w:o=0,s&&(s*=w);const _=s?s/p.height:1,x=l&&s?l*s/p.width:1;if(a!==0||_!==1||x!==1||n!==0||o!==0){const $=new DOMMatrix;$.rotateSelf(0,0,-a).translateSelf(n,o).scaleSelf(x,_,1),g.setTransform($)}}else g=m.createPattern(v,"repeat");m.save(),m.fillStyle=g,m.fill("evenodd"),m.restore()}drawPictureStroke(e,r){if(!e)return;let{colorSubstitutions:i,capStyle:s,joinStyle:n,miterLimit:o,tintColor:a,url:l,width:c}=r;const d=this._resourceManager.getResource(l);if(d==null)return;let p;if(Kt(e))p=e.rings;else if(Xr(e))p=e.paths;else{if(!Ni(e))return Pf(e)?void console.log("CanvasDrawHelper.drawPictureStroke - No implementation!"):void 0;p=al(e).rings}c||(c=d.width);const m=Jd(l)||"src"in d&&Jd(d.src);let y="getFrame"in d?pM(d):d;i&&(y=this._colorSubstitutionHelper.applyColorSubstitution(y,i)),this._applyAdditionalRenderProps&&(m||a&&(y=this._colorSubstitutionHelper.tintImageData(y,a)));const g=Math.max(this.transformSize(Pe(c)),.5),v=g/y.width,w=this._ctx,_=w.createPattern(y,"repeat-y");let x,$;w.save(),this._setCapStyle(s),this._setJoinStyle(n),o!==void 0&&(w.miterLimit=o),w.lineWidth=g;for(let T of p)if(T=O(T),L4(T),T&&!(T.length<=1)){x=this.transformPt(T[0]);for(let C=1;C<T.length;C++){$=this.transformPt(T[C]);const P=zPe(x,$),A=new DOMMatrix;A.translateSelf(0,x[1]-g/2).scaleSelf(v,v,1).rotateSelf(0,0,90-P),_.setTransform(A),w.strokeStyle=_,w.beginPath(),w.moveTo(x[0],x[1]),w.lineTo($[0],$[1]),w.stroke(),x=$}}w.restore()}drawGradientFill(e,r){if(!e)return;let i;if(Kt(e))i=e.rings;else if(Xr(e))i=e.paths;else{if(!Ni(e))return void Zg().error("Unable to draw gradient fill");i=al(e).rings}this._buildPath(i,!0);const{angle:s,gradientMethod:n,gradientSize:o,gradientSizeUnits:a}=r,l=tr.CIMGradientFill,c=r.gradientType??l.gradientType,d=-Ym(s??0),p=Une();for(const _ of i){const x=_?_.length:0;if(x>1)for(let $=0;$<x;$++){let T=this.transformPt(_[$]);n!=="Linear"&&n!=="Rectangular"||(T=ka(T,-d)),Kr(p,T)}}const[m,y,g,v]=p,w=this._ctx;switch(w.save(),n){case"Buffered":Zg().error(`Gradient method "${n}" currently unsupported.`);break;case"Linear":{const _=(y+v)/2,x=a==="Absolute"?this.transformSize(Pe(o)):Vy(o,l.gradientSize)*(g-m),[$,T]=c==="Discrete"?[g,g-x]:[m+x,m],C=ka([$,_],d),P=ka([T,_],d),A=w.createLinearGradient(C[0],C[1],P[0],P[1]);w_(A,r),w.fillStyle=A,w.fill("evenodd");break}case"Circular":{const _=lO(p),x=jne(p)/2,$=a==="Absolute"?this.transformSize(Pe(o)):Vy(o,l.gradientSize)*x,[T,C]=c==="Discrete"?[x,x-$]:[$,0],P=w.createRadialGradient(_[0],_[1],T,_[0],_[1],C);w_(P,r),w.fillStyle=P,w.fill("evenodd");break}case"Rectangular":{const _=lO(p),x=_[0],$=_[1],T=ka(_,d),C=(Z,Y,re,Q,Ee,et,lt,Ve)=>{w.save(),this.pushClipPath(e);const vr=ka([Ee,et],d),Dl=ka([lt,Ve],d);w.beginPath(),w.moveTo(T[0],T[1]),w.lineTo(vr[0],vr[1]),w.lineTo(Dl[0],Dl[1]),w.lineTo(T[0],T[1]),w.clip();const zl=ka([Z,Y],d),bc=ka([re,Q],d),jl=w.createLinearGradient(zl[0],zl[1],bc[0],bc[1]);w_(jl,r),w.fillStyle=jl,w.fill("evenodd"),w.restore()};let P=a==="Absolute"?this.transformSize(Pe(o)):Vy(o,l.gradientSize)*(g2(p)/2),[A,F]=c==="Discrete"?[g,g-P]:[x+P,x];C(A,$,F,$,g,y,g,v),[A,F]=c==="Discrete"?[m,m+P]:[x-P,x],C(A,$,F,$,m,v,m,y),P=a==="Absolute"?this.transformSize(Pe(o)):Vy(o,l.gradientSize)*(v2(p)/2);let[j,V]=c==="Discrete"?[v,v-P]:[$+P,$];C(x,j,x,V,g,v,m,v),[j,V]=c==="Discrete"?[y,y+P]:[$-P,$],C(x,j,x,V,m,y,g,y);break}}w.restore()}drawGradientStroke(e,r){const{capStyle:i,gradientMethod:s,gradientSize:n,gradientSizeUnits:o,joinStyle:a,miterLimit:l,width:c}=r;if(!e||c===0)return;let d;if(Kt(e))d=e.rings;else if(Xr(e))d=e.paths;else{if(!Ni(e))return void Zg().error("Unable to draw gradient stroke");d=al(e).rings}const p=r.gradientType??tr.CIMGradientStroke.gradientType,m=Math.max(this.transformSize(Pe(c)),.5),y=this._ctx;let g,v;y.save(),this._setCapStyle(i),this._setJoinStyle(a),l!==void 0&&(y.miterLimit=l),y.lineWidth=m;for(let w of d){if(w=O(w),L4(w),!w||w.length<=1)continue;let _=0;g=this.transformPt(w[0]);for(let T=1;T<w.length;T++){v=this.transformPt(w[T]);const C=v[0]-g[0],P=v[1]-g[1];_+=Math.sqrt(C*C+P*P),g=v}const x=o==="Absolute"?this.transformSize(Pe(n)):Vy(n,tr.CIMGradientStroke.gradientSize)*(s==="AcrossLine"?m:_);let $=0;g=this.transformPt(w[0]);for(let T=1;T<w.length;T++){v=this.transformPt(w[T]);const C=v[0]-g[0],P=v[1]-g[1],A=Math.sqrt(C*C+P*P);let F,j,V,Z;switch(s){case"AcrossLine":{const[re,Q]=ka([C/A,P/A],-Math.PI/2),Ee=m/2,et=p==="Discrete"?Ee:x-Ee;F=(g[0]+v[0])/2+re*et,j=(g[1]+v[1])/2+Q*et,V=F-re*x,Z=j-Q*x;break}case"AlongLine":{const re=C/A,Q=P/A;p==="Discrete"?(F=g[0]-re*$,j=g[1]-Q*$,V=F+re*x,Z=j+Q*x):(V=g[0]+re*(_-$),Z=g[1]+Q*(_-$),F=V-re*x,j=Z-Q*x);break}default:return Zg().error("Unrecognized gradient method:",s),void y.restore()}const Y=y.createLinearGradient(F,j,V,Z);w_(Y,r),y.strokeStyle=Y,y.beginPath(),y.moveTo(g[0],g[1]),y.lineTo(v[0],v[1]),y.stroke(),$+=A,g=v}}y.restore()}_buildPath(e,r){const i=this._ctx;if(i.beginPath(),e)for(const s of e){const n=s?s.length:0;if(n>1){let o=this.transformPt(s[0]);i.moveTo(o[0],o[1]);for(let a=1;a<n;a++)o=this.transformPt(s[a]),i.lineTo(o[0],o[1]);r&&i.closePath()}}}_setCapStyle(e){switch(e){case"Butt":this._ctx.lineCap="butt";break;case"Round":this._ctx.lineCap="round";break;case"Square":this._ctx.lineCap="square"}}_setJoinStyle(e){switch(e){case"Bevel":this._ctx.lineJoin="bevel";break;case"Round":this._ctx.lineJoin="round";break;case"Miter":this._ctx.lineJoin="miter"}}}function NPe(t,e,r){let i=xe(t.separation,tr.CIMHatchFill.separation)*r,s=xe(t.rotation);if(i===0)return null;i<0&&(i=-i);let n=0;const o=.5*i;for(;n>o;)n-=i;for(;n<-o;)n+=i;const a=lr();YP(a,e),a[0]-=o,a[1]-=o,a[2]+=o,a[3]+=o;const l=[[a[0],a[1]],[a[0],a[3]],[a[2],a[3]],[a[2],a[1]]];for(;s>180;)s-=180;for(;s<0;)s+=180;const c=Math.cos(s*Eh),d=Math.sin(s*Eh),p=-i*d,m=i*c;let y,g,v,w;n=xe(t.offsetX)*r*d-xe(t.offsetY)*r*c,y=v=Number.MAX_VALUE,g=w=-Number.MAX_VALUE;for(const A of l){const F=A[0],j=A[1],V=c*F+d*j,Z=-d*F+c*j;y=Math.min(y,V),v=Math.min(v,Z),g=Math.max(g,V),w=Math.max(w,Z)}v=Math.floor(v/i)*i;let _=c*y-d*v-p*n/i,x=d*y+c*v-m*n/i,$=c*g-d*v-p*n/i,T=d*g+c*v-m*n/i;const C=1+Math.round((w-v)/i),P=[];for(let A=0;A<C;A++)_+=p,x+=m,$+=p,T+=m,P.push([[_,x],[$,T]]);return{paths:P}}function DPe(t,e){let r=0;for(const i of e){const s=i.length;for(let n=1;n<s;n++){const o=i[n-1],a=i[n];o[1]>t[1]!=a[1]>t[1]&&((a[0]-o[0])*(t[1]-o[1])-(a[1]-o[1])*(t[0]-o[0])>0?r++:r--)}}return r!==0}function k4(t,e,r){for(const i of e){const s=i.length;for(let n=1;n<s;n++){const o=i[n-1],a=i[n];let l=(a[0]-o[0])*(a[0]-o[0])+(a[1]-o[1])*(a[1]-o[1]);if(l===0)continue;l=Math.sqrt(l);const c=((a[0]-o[0])*(t[1]-o[1])-(a[1]-o[1])*(t[0]-o[0]))/l;if(Math.abs(c)<r){const d=((a[0]-o[0])*(t[0]-o[0])+(a[1]-o[1])*(t[1]-o[1]))/l;if(d>-r&&d<l+r)return!0}}}return!1}function zPe(t,e){const r=e[0]-t[0],i=e[1]-t[1];return 180/Math.PI*Math.atan2(i,r)}const al=t=>t?{spatialReference:t.spatialReference,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:null,LZ=(t,e,r)=>{switch(t){case"ExtraLeading":return 1+e/r;case"Multiple":return e;case"Exact":return e/r}};function AZ(t,e=1){const r=DH(t),i=NH(t.fontStyleName),s=t.fontFamilyName??AL,{weight:n,style:o}=i,a=e*(t.height||5),l=i$e(t.horizontalAlignment),c=s$e(t.verticalAlignment),d=T0(t),p=T0(t.haloSymbol),m=p!=null?e*(t.haloSize??0):0,y=_S(t.symbol),g=e*(bS(t.symbol)||0),v=t.callout?.type==="CIMBackgroundCallout"?t.callout.backgroundSymbol:null,w=T0(v),_=bS(v),x=_S(v);return{color:d,size:a,horizontalAlignment:l,verticalAlignment:c,font:{family:s,style:t$e(o),weight:r$e(n),decoration:r},outline:{size:g||0,color:y},halo:{size:m||0,color:p,style:o},backgroundColor:w,borderLine:_!=null&&x!=null?{size:_,color:x}:null,pixelRatio:1,premultiplyColors:!0}}const jPe=1e-4;function L4(t){let e,r,i,s,n,o=t[0],a=1;for(;a<t.length;)e=t[a][0]-o[0],r=t[a][1]-o[1],s=e!==0?r/e:Math.PI/2,i!==void 0&&Math.abs(s-i)<=jPe?(t.splice(a-1,1),o=n):(n=o,o=t[a],a++),i=s}const S_=Number.POSITIVE_INFINITY,DL=Math.PI,DUe=2*DL,VPe=128/DL,UPe=256/360,zUe=DL/180,GPe=1/Math.LN2;function RZ(t,e){return(t%=e)>=0?t:t+e}function jUe(t){return RZ(t*VPe,256)}function VUe(t){return RZ(t*UPe,256)}function UUe(t){return Math.log(t)*GPe}function GUe(t,e,r){return t*(1-r)+e*r}const qPe=8,BPe=14,HPe=16;function qUe(t){return qPe+Math.max((t-BPe)*HPe,0)}function BUe(t,e,r){let i,s,n,o=0;for(const a of r){i=a.length;for(let l=1;l<i;++l)s=a[l-1],n=a[l],s.y>e!=n.y>e&&((n.x-s.x)*(e-s.y)-(n.y-s.y)*(t-s.x)>0?o++:o--)}return o!==0}function HUe(t,e,r,i){let s,n,o,a;const l=i*i;for(const c of r){const d=c.length;if(!(d<2)){s=c[0].x,n=c[0].y;for(let p=1;p<d;++p){if(o=c[p].x,a=c[p].y,xne(t,e,s,n,o,a)<l)return!0;s=o,n=a}}}return!1}function WUe(t,e,r,i,s,n,o){const a=Math.max(i,Math.min(e,n))-e,l=Math.max(s,Math.min(r,o))-r;return a*a+l*l<=t*t}function ZUe(t,e){if(e===0||Number.isNaN(e))return t;const r=[],i=new qe(0,0),s=new qe(0,0),n=new qe(0,0);for(let o=0;o<t.length;o++){const a=t[o],l=[];for(let c=0;c<a.length;c++){const d=a[c-1],p=a[c],m=a[c+1];c===0?i.setCoords(0,0):i.assignSub(p,d).normalize().rightPerpendicular(),c===a.length-1?s.setCoords(0,0):s.assignSub(m,p).normalize().rightPerpendicular(),n.assignAdd(i,s).normalize();const y=n.x*s.x+n.y*s.y;y!==0&&n.scale(1/y),l.push(qe.add(p,n.scale(e)))}r.push(l)}return r}function JUe(t,e,r,i){const s=new qe(t[0],t[1]);if(s.scale(i),e==="viewport"){const n=-r*(Math.PI/180),o=Math.cos(n),a=Math.sin(n);s.rotate(o,a)}return s}const OZ=Math.PI,WPe=OZ/2,A4=Math.PI/180,yM=96/72,ZPe=1.4142135623730951,R4=2,O4=4,RS=()=>U.getLogger("esri.symbols.cim.CIMSymbolHelper");function YUe(t){let e;switch(t.type){case"cim":return t.data;case"web-style":return t;case"simple-marker":{const r=wi.fromSimpleMarker(t);if(!r)throw new Error("InternalError: Cannot convert symbol to CIM");e=r;break}case"picture-marker":e=wi.fromPictureMarker(t);break;case"simple-line":e=wi.fromSimpleLineSymbol(t);break;case"simple-fill":e=wi.fromSimpleFillSymbol(t);break;case"picture-fill":e=wi.fromPictureFillSymbol(t);break;case"text":e=wi.fromTextSymbol(t)}return{type:"CIMSymbolReference",symbol:e}}function t1(t,e,r){switch(e.type){case"CIMSymbolReference":return t1(t,e.symbol,r);case"CIMPointSymbol":r==null&&(r={x:0,y:0}),t.drawSymbol(e,r);break;case"CIMLineSymbol":r==null&&(r={paths:[[[0,0],[10,0]]]}),t.drawSymbol(e,r);break;case"CIMPolygonSymbol":r==null&&(r={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]}),t.drawSymbol(e,r);break;case"CIMTextSymbol":{const i={x:0,y:0};t.drawSymbol(e,i);break}case"CIMVectorMarker":{const i=new oy;t.drawMarker(e,i);break}}return t.envelope()}function JPe(t){if(!t)return 0;switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(t.offset);default:return 0}}function YPe(t){if(!t)return 0;switch(t.type){case"CIMGeometricEffectArrow":return Math.abs(.5*t.width);case"CIMGeometricEffectBuffer":return Math.abs(t.size);case"CIMGeometricEffectControlMeasureLine":return 500;case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(t.length);case"CIMGeometricEffectJog":return Math.abs(.5*t.length);case"CIMGeometricEffectMove":return Math.max(Math.abs(xe(t.offsetX)),Math.abs(xe(t.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(t.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(t.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return .5*Math.max(Math.abs(t.fromWidth),Math.abs(t.toWidth));case"CIMGeometricEffectWave":return Math.abs(t.amplitude);case"CIMGeometricEffectDonut":return Math.abs(t.width)}}function F4(t){if(!t)return 0;let e=0;for(const r of t)e+=YPe(r);return e}let XUe=class{static getSymbolInflateSize(e,r,i,s,n){return e||(e=[0,0,0,0]),r?this._getInflateSize(e,r,i,s,n):e}static safeSize(e){const r=Math.max(Math.abs(e[0]),Math.abs(e[2])),i=Math.max(Math.abs(e[1]),Math.abs(e[3]));return Math.sqrt(r*r+i*i)}static _vectorMarkerBounds(e,r,i,s){let n=!0;const o=lr();if(r?.markerGraphics)for(const a of r.markerGraphics){const l=[0,0,0,0];a.geometry&&(YP(o,a.geometry),l[0]=0,l[1]=0,l[2]=0,l[3]=0,this.getSymbolInflateSize(l,a.symbol,i,0,s),o[0]+=l[0],o[1]+=l[1],o[2]+=l[2],o[3]+=l[3],n?(e[0]=o[0],e[1]=o[1],e[2]=o[2],e[3]=o[3],n=!1):(e[0]=Math.min(e[0],o[0]),e[1]=Math.min(e[1],o[1]),e[2]=Math.max(e[2],o[2]),e[3]=Math.max(e[3],o[3])))}return e}static _getInflateSize(e,r,i,s,n){if(rke(r)){const o=this._getLayersInflateSize(e,r.symbolLayers,i,s,n),a=F4(r.effects);return a>0&&(o[0]-=a,o[1]-=a,o[2]+=a,o[3]+=a),o}return this._getTextInflatedSize(e,r,n)}static _getLayersInflateSize(e,r,i,s,n){let o=!0;if(!r)return e;for(const a of r){if(!a)continue;let l=[0,0,0,0];switch(a.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const d=a;let p=d.width;p!=null&&(d.capStyle==="Square"||d.joinStyle==="Miter"?p/=ZPe:p/=2,l[0]=-p,l[1]=-p,l[2]=p,l[3]=p);break}case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":{const d=a;if(a.type==="CIMVectorMarker"){const v=a;if(l=this._vectorMarkerBounds(l,v,i,n),v.frame){const w=(v.frame.xmin+v.frame.xmax)/2,_=(v.frame.ymin+v.frame.ymax)/2;if(l[0]-=w,l[1]-=_,l[2]-=w,l[3]-=_,v.size!=null){const x=v.size/(v.frame.ymax-v.frame.ymin);l[0]*=x,l[1]*=x,l[2]*=x,l[3]*=x}}}else if(a.type==="CIMPictureMarker"){const v=a,w=i.getResource(v.url);let _=1;if(w!=null&&w.height&&(_=w.width/w.height),d.size!=null){const x=d.size/2,$=d.size*_*v.scaleX/2;l=[-$,-x,$,x]}}else if(d.size!=null){const v=d.size/2;l=[-v,-v,v,v]}if(d.anchorPoint){let v,w;d.anchorPointUnits==="Absolute"?(v=d.anchorPoint.x,w=d.anchorPoint.y):(v=d.anchorPoint.x*(l[2]-l[0]),w=d.anchorPoint.y*(l[3]-l[1]));const _=1.25*Math.sqrt(v*v+w*w);l[0]-=_,l[1]-=_,l[2]+=_,l[3]+=_}let p=xe(d.rotation);if(d.rotateClockwise&&(p=-p),s&&(p-=s),p){const v=A4*p,w=Math.cos(v),_=Math.sin(v),x=lr([S_,S_,-S_,-S_]);Kr(x,[l[0]*w-l[1]*_,l[0]*_+l[1]*w]),Kr(x,[l[0]*w-l[3]*_,l[0]*_+l[3]*w]),Kr(x,[l[2]*w-l[1]*_,l[2]*_+l[1]*w]),Kr(x,[l[2]*w-l[3]*_,l[2]*_+l[3]*w]),l=x}let m=xe(d.offsetX),y=xe(d.offsetY);if(s){const v=A4*s,w=Math.cos(v),_=Math.sin(v),x=m*_+y*w;m=m*w-y*_,y=x}l[0]+=m,l[1]+=y,l[2]+=m,l[3]+=y;const g=JPe(d.markerPlacement);g>0&&(l[0]-=g,l[1]-=g,l[2]+=g,l[3]+=g);break}}const c=F4(a.effects);c>0&&(l[0]-=c,l[1]-=c,l[2]+=c,l[3]+=c),o?(e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],o=!1):(e[0]=Math.min(e[0],l[0]),e[1]=Math.min(e[1],l[1]),e[2]=Math.max(e[2],l[2]),e[3]=Math.max(e[3],l[3]))}return e}static _getTextInflatedSize(e,r,i){const s=EZ(r.height??tr.CIMTextSymbol.height);if(e[0]=-s/2,e[1]=-s/2,e[2]=s/2,e[3]=s/2,!i)return e;const n=i.get(r);if(!n||!n.glyphMosaicItems.glyphs.length)return e;const{lineGapType:o,lineGap:a}=r,l=o?LZ(o,a??0,s):0,c=r.callout?.type==="CIMBackgroundCallout",d=IZ(n.glyphMosaicItems,{scale:s/XG,angle:xe(r.angle),xOffset:xe(r.offsetX),yOffset:xe(r.offsetY),horizontalAlignment:r.horizontalAlignment,verticalAlignment:r.verticalAlignment,maxLineWidth:CZ(r.lineWidth),lineHeight:YG*Math.max(.25,Math.min(l||1,4)),decoration:r.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:c}).boundsT,p=Math.sqrt(d.width*d.width+d.height*d.height);return e[0]-=d.x+p,e[1]-=d.y-p,e[2]+=d.x+p,e[3]+=-d.y+p,e}};class wi{static getEnvelope(e,r,i){if(!e)return null;const s=new FPe(i);if(Array.isArray(e)){let n;for(const o of e)n?n.union(t1(s,o,r)):n=t1(s,o,r);return n}return t1(s,e,r)}static getTextureInfo(e,r,i,s,n){const o=s??this.getEnvelope(e,null,r);if(!o)return[0,0,0,0,1];const a=Math.max(o.width,o.height)*yM;let l=n!=null?Math.max(n/a,1):1;l*=yM,o.x*=l,o.y*=l,o.width*=l,o.height*=l,o.width=Math.max(Math.ceil(o.x+o.width)-Math.floor(o.x),1)-1,o.height=Math.max(Math.ceil(o.y+o.height)-Math.floor(o.y),1)-1;let c=o.x+.5*o.width,d=o.y+.5*o.height;return c+=o.x-Math.floor(o.x),d+=o.y-Math.floor(o.y),s||(o.width+=i,o.height+=i,c+=i/2,d+=i/2),[o.width,o.height,c,d,l]}static getTextureAnchor(e,r,i){const[s,n,o,a,l]=this.getTextureInfo(e,r,R4,null,i);return[-o/s,-a/n,n/l*yM]}static rasterize(e,r,i,s,n=!0,o){const[a,l,c,d,p]=this.getTextureInfo(r,s,R4,i,o);e.width=a,e.height=l;const m=e.getContext("2d",{willReadFrequently:!0}),y=jr.createScale(p,-p);y.translate(.5*a-c,.5*l+d);const g=new kZ(m,s,y);switch(r.type){case"CIMPointSymbol":{const _={type:"point",x:0,y:0};g.drawSymbol(r,_);break}case"CIMVectorMarker":{const _=new oy;g.drawMarker(r,_);break}}const v=m.getImageData(0,0,e.width,e.height),w=new Uint8Array(v.data);if(n){let _;for(let x=0;x<w.length;x+=4)_=w[x+3]/255,w[x]=w[x]*_,w[x+1]=w[x+1]*_,w[x+2]=w[x+2]*_}return[w,e.width,e.height,-c/a,-d/l]}static fromTextSymbol(e){const{text:r}=e;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:wi.createCIMTextSymbolfromTextSymbol(e),textString:r}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}static fromPictureFillSymbol(e){const{height:r,outline:i,width:s,xoffset:n,xscale:o,yoffset:a,yscale:l}=e,c=[],d={type:"CIMPolygonSymbol",symbolLayers:c};if(i){const v=N4(i);v&&c.push(v)}let p=e.url;e.type==="esriPFS"&&e.imageData&&(p=e.imageData);const m="angle"in e?e.angle??0:0,y=(s??0)*(o||1),g=(r??0)*(l||1);return c.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:"Picture",tintColor:null,url:p,height:g,width:y,offsetX:xe(n),offsetY:xe(a),rotation:xe(-m),colorSubstitutions:null}),d}static fromSimpleFillSymbol(e){const{color:r,style:i,outline:s}=e,n=[],o={type:"CIMPolygonSymbol",symbolLayers:n};if(s){const a=N4(s);a&&n.push(a)}if(i&&i!=="solid"&&i!=="none"&&i!=="esriSFSSolid"&&i!=="esriSFSNull"){const a={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:Ts(r),capStyle:"Butt",joinStyle:"Miter",width:.75}]};let l=0;const c=Ke(ike(i)?8:10);switch(i){case"vertical":case"esriSFSVertical":l=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":l=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":l=45;break;case"cross":case"esriSFSCross":l=0}n.push({type:"CIMHatchFill",lineSymbol:a,offsetX:0,offsetY:0,rotation:l,separation:c}),i==="cross"||i==="esriSFSCross"?n.push({type:"CIMHatchFill",lineSymbol:O(a),offsetX:0,offsetY:0,rotation:90,separation:c}):i!=="diagonal-cross"&&i!=="esriSFSDiagonalCross"||n.push({type:"CIMHatchFill",lineSymbol:O(a),offsetX:0,offsetY:0,rotation:45,separation:c})}else!i||i!=="solid"&&i!=="esriSFSSolid"||n.push({type:"CIMSolidFill",enable:!0,color:Ts(r)});return o}static fromSimpleLineSymbol(e){const{cap:r,color:i,join:s,marker:n,miterLimit:o,style:a,width:l}=e;let c=null;a!=="solid"&&a!=="none"&&a!=="esriSLSSolid"&&a!=="esriSLSNull"&&(c=[{type:"CIMGeometricEffectDashes",dashTemplate:vC(a,r),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const d=[];if(n){let p;switch(n.placement){case"begin-end":p="Both";break;case"begin":p="JustBegin";break;case"end":p="JustEnd";break;default:p="None"}const m=wi.fromSimpleMarker(n,l,i).symbolLayers[0];m.markerPlacement={type:"CIMMarkerPlacementAtExtremities",placePerPart:!1,angleToLine:!0,offset:0,extremityPlacement:p,offsetAlongLine:0},d.push(m)}return d.push({type:"CIMSolidStroke",color:a!=="none"&&a!=="esriSLSNull"?Ts(i):[0,0,0,0],capStyle:NZ(r),joinStyle:DZ(s),miterLimit:o,width:l,effects:c}),{type:"CIMLineSymbol",symbolLayers:d}}static fromPictureMarker(e){const{angle:r,height:i,width:s,xoffset:n,yoffset:o}=e;let a=e.url;return e.type==="esriPMS"&&e.imageData&&(a=e.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:"Picture",tintColor:null,url:a,size:i,width:s,offsetX:xe(n),offsetY:xe(o),rotation:xe(-r)}]}}static createCIMTextSymbolfromTextSymbol(e){const{angle:r,color:i,font:s,haloColor:n,haloSize:o,horizontalAlignment:a,kerning:l,lineWidth:c,text:d,verticalAlignment:p,xoffset:m,yoffset:y,backgroundColor:g,borderLineColor:v,borderLineSize:w}=e;let _,x,$,T,C,P;s&&(_=s.family,x=s.style,$=s.weight,T=s.size,C=s.decoration);let A=!1;return d&&(A=PEe(d)[1]),(g||w)&&(P={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:Ts(g)},{type:"CIMSolidStroke",color:Ts(v),width:w}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null}),{type:"CIMTextSymbol",angle:r,blockProgression:2,depth3D:1,extrapolateBaselines:!0,fontEffects:0,fontEncoding:1,fontFamilyName:_||"Arial",fontStyleName:QPe(x,$),fontType:0,haloSize:o,height:T,hinting:1,horizontalAlignment:XPe(a??"center"),kerning:l,letterWidth:100,ligatures:!0,lineGapType:"Multiple",lineWidth:c,offsetX:xe(m),offsetY:xe(y),strikethrough:C==="line-through",underline:C==="underline",symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:Ts(i)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:Ts(n)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:A?1:0,verticalAlignment:KPe(p??"baseline"),verticalGlyphOrientation:0,wordSpacing:100,billboardMode3D:2,callout:P}}static createPictureMarkerRasterizationParam(e){const{angle:r,height:i,width:s,xoffset:n,yoffset:o}=e,a=e.url??e.source?.url??e.source?.imageData;return a?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:"Picture",tintColor:null,url:a,size:i,width:s,offsetX:xe(n),offsetY:xe(o),rotation:xe(-r)}}:null}static createPictureFillRasterizationParam(e){const{width:r,height:i,xoffset:s,yoffset:n,url:o}=e;return o?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureFill",scaleX:1,textureFilter:"Picture",tintColor:null,url:o,width:r,height:i,offsetX:xe(s),offsetY:xe(n),rotation:0}}:null}static fromSimpleMarker(e,r,i){const{style:s}=e,n=e.color??i;if(s==="path"||s==="esriSMSPath"){const p=[];if("outline"in e&&e.outline){const g=e.outline;p.push({type:"CIMSolidStroke",enable:!0,width:g.width,color:Ts(g.color),path:e.path})}p.push({type:"CIMSolidFill",enable:!0,color:Ts(n),path:e.path});const[m,y]=Jy("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:-xe(e.angle),size:xe(e.size||6),offsetX:xe(e.xoffset),offsetY:xe(e.yoffset),scaleSymbolsProportionally:!1,frame:m,markerGraphics:[{type:"CIMMarkerGraphic",geometry:y,symbol:{type:"CIMPolygonSymbol",symbolLayers:p}}]}]}}const o=[];let a,l,c=e.size;if("outline"in e&&e.outline&&e.outline.style!=="none"&&e.outline.style!=="esriSLSNull"){const p=e.outline,m=p.style!=="solid"&&p.style!=="esriSLSSolid";[a,l]=m?Jy(s,e.size):Jy(s);const y=p.width??rx.width;if(m){const w=y/e.size,_=(a.xmax-a.xmin)*w/2,x=(a.ymax-a.ymin)*w/2;a.xmin-=_,a.xmax+=_,a.ymin-=x,a.ymax+=x,c&&(c+=y)}const g=e.style!=="cross"&&e.style!=="x"||e?.outline.style==="dot"||e?.outline.style==="short-dot"?"HalfGap":"FullPattern",v=m?[{type:"CIMGeometricEffectAddControlPoints"},{type:"CIMGeometricEffectDashes",dashTemplate:vC(p.style,null).map(w=>p.width&&p.width>0?w*p.width:w),lineDashEnding:g,controlPointEnding:"FullPattern"}]:void 0;o.push({type:"CIMSolidStroke",capStyle:m?"Round":"Butt",enable:!0,width:y,color:Ts(p.color),effects:v})}else!r||e.type!=="line-marker"||e.style!=="cross"&&e.style!=="x"?[a,l]=Jy(s):([a,l]=Jy(s),o.push({type:"CIMSolidStroke",enable:!0,width:r,color:Ts(n)}));o.push({type:"CIMSolidFill",enable:!0,color:Ts(n)});const d={type:"CIMPolygonSymbol",symbolLayers:o};return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:xe(-e.angle),size:xe(c||6*r),offsetX:xe(e.xoffset),offsetY:xe(e.yoffset),scaleSymbolsProportionally:!1,frame:a,markerGraphics:[{type:"CIMMarkerGraphic",geometry:l,symbol:d}]}]}}static fromCIMHatchFill(e,r){const i=r*(e.separation??tr.CIMHatchFill.separation),s=i/2,n=O(e.lineSymbol);n.symbolLayers?.forEach(l=>{switch(l.type){case"CIMSolidStroke":l.width!=null&&(l.width*=r),l.effects?.forEach(c=>{if(c.type==="CIMGeometricEffectDashes"){const d=c.dashTemplate;c.dashTemplate=d?.map(p=>p*r)}});break;case"CIMVectorMarker":{l.size!=null&&(l.size*=r);const c=l.markerPlacement;c!=null&&"placementTemplate"in c&&(c.placementTemplate=c.placementTemplate.map(d=>d*r));break}}});let o=this._getLineSymbolPeriod(n)||O4;for(;o<O4;)o*=2;const a=o/2;return{type:"CIMVectorMarker",frame:{xmin:-a,xmax:a,ymin:-s,ymax:s},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-a,0],[a,0]]]},symbol:n}],size:i}}static fetchResources(e,r,i,s=null){if(!e||!r)return i;switch(e.type){case"CIMMeshSymbol":case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":for(const n of e.effects||[])i.push(_4(n))}return FZ(e,n=>{for(const o of n.effects||[])i.push(_4(o));"url"in n&&n.url&&i.push(r.fetchResource(n.url,{signal:s}))}),i}static fetchFonts(e,r,i){if(e&&r){if("symbolLayers"in e&&e.symbolLayers){for(const s of e.symbolLayers)if(s.type==="CIMVectorMarker"&&s.markerGraphics)for(const n of s.markerGraphics)n?.symbol&&wi.fetchFonts(n.symbol,r,i)}else if(e.type==="CIMTextSymbol"){const{fontFamilyName:s,fontStyleName:n}=e;if(!s||s.toLowerCase()==="calcitewebcoreicons")return;const{style:o,weight:a}=NH(n),l=DH(e),c=new Cs({family:s,style:o,weight:a,decoration:l});i.push(r.loadFont(c).catch(()=>{RS().error(`Unsupported font ${s} in CIM symbol`)}))}}}static _getLineSymbolPeriod(e){if(e){const r=this._getEffectsRepeat(e.effects);if(r)return r;if(e.symbolLayers){for(const i of e.symbolLayers)if(i){const s=this._getEffectsRepeat(i.effects);if(s)return s;switch(i.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const n=this._getPlacementRepeat(i.markerPlacement);if(n)return n}}}}}return 0}static _getEffectsRepeat(e){if(e){for(const r of e)if(r)switch(r.type){case"CIMGeometricEffectDashes":{const i=r.dashTemplate;if(i&&i.length){let s=0;for(const n of i)s+=n;return 1&i.length&&(s*=2),s}break}case"CIMGeometricEffectWave":return r.period;default:RS().error(`unsupported geometric effect type ${r.type}`)}}return 0}static _getPlacementRepeat(e){if(e)switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":{const r=e.placementTemplate;if(r&&r.length){let i=0;for(const s of r)i+=+s;return 1&r.length&&(i*=2),i}break}}return 0}static fromCIMInsidePolygon(e){const r=e.markerPlacement,i={...e};i.markerPlacement=null,i.anchorPoint=null;const s=Math.abs(r.stepX),n=Math.abs(r.stepY),o=(r.randomness??100)/100;let a,l,c,d;if(r.gridType==="Random"){const p=Ke(V0e),m=Math.max(Math.floor(p/s),1),y=Math.max(Math.floor(p/n),1);a=m*s/2,l=y*n/2,c=2*l;const g=new kC(r.seed),v=o*s/1.5,w=o*n/1.5;d=[];for(let _=0;_<m;_++)for(let x=0;x<y;x++){const $=_*s-a+v*(.5-g.getFloat()),T=x*n-l+w*(.5-g.getFloat());d.push({x:$,y:T}),_===0&&d.push({x:$+2*a,y:T}),x===0&&d.push({x:$,y:T+2*l})}}else r.shiftOddRows===!0?(a=s/2,l=n,c=2*n,d=[{x:-a,y:0},{x:a,y:0},{x:0,y:l},{x:0,y:-l}]):(a=s/2,l=n/2,c=n,d=[{x:-s,y:0},{x:0,y:-n},{x:-s,y:-n},{x:0,y:0},{x:s,y:0},{x:0,y:n},{x:s,y:n},{x:-s,y:n},{x:s,y:-n}]);return{type:"CIMVectorMarker",frame:{xmin:-a,xmax:a,ymin:-l,ymax:l},markerGraphics:d.map(p=>({type:"CIMMarkerGraphic",geometry:p,symbol:{type:"CIMPointSymbol",symbolLayers:[i]}})),size:c}}}function FZ(t,e){if(t)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const r=t.symbolLayers;if(!r)return;for(const i of r)if(e(i),i.type==="CIMVectorMarker"){const s=i.markerGraphics;if(!s)continue;for(const n of s)if(n){const o=n.symbol;o&&FZ(o,e)}}break}}}const NZ=t=>{if(!t)return"Butt";switch(t){case"butt":return"Butt";case"square":return"Square";case"round":return"Round"}},DZ=t=>{if(!t)return"Miter";switch(t){case"miter":return"Miter";case"round":return"Round";case"bevel":return"Bevel"}},XPe=t=>{if(t==null)return"Center";switch(t){case"left":return"Left";case"right":return"Right";case"center":return"Center"}},KPe=t=>{if(t==null)return"Center";switch(t){case"baseline":return"Baseline";case"top":return"Top";case"middle":return"Center";case"bottom":return"Bottom"}},Ts=t=>{if(!t)return[0,0,0,0];const{r:e,g:r,b:i,a:s}=t;return[e,r,i,255*s]},QPe=(t,e)=>{const r=eke(e),i=tke(t);return r&&i?`${r}-${i}`:`${r}${i}`},eke=t=>{if(!t)return"";switch(t.toLowerCase()){case"bold":case"bolder":return"bold"}return""},tke=t=>{if(!t)return"";switch(t.toLowerCase()){case"italic":case"oblique":return"italic"}return""},vC=(t,e)=>{const r=z("safari")?.001:0,i=e==="butt";switch(t){case"dash":case"esriSLSDash":return i?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return i?[4,3,1,3]:[3,4,r,4];case"dot":case"esriSLSDot":return i?[1,3]:[r,4];case"long-dash":case"esriSLSLongDash":return i?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return i?[8,3,1,3]:[7,4,r,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return i?[8,3,1,3,1,3]:[7,4,r,4,r,4];case"short-dash":case"esriSLSShortDash":return i?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return i?[4,1,1,1]:[3,2,r,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return i?[4,1,1,1,1,1]:[3,2,r,2,r,2];case"short-dot":case"esriSLSShortDot":return i?[1,1]:[r,2];case"solid":case"esriSLSSolid":case"none":return RS().error("Unexpected: style does not require rasterization"),[0,0];default:return RS().error(`Tried to rasterize SLS, but found an unexpected style: ${t}!`),[0,0]}};function rke(t){return t.symbolLayers!==void 0}const Jy=(t,e=100)=>{const r=e/2;let i,s;const n=t;if(n==="circle"||n==="esriSMSCircle"){let a=Math.acos(1-.25/r),l=Math.ceil(OZ/a/4);l===0&&(l=1),a=WPe/l,l*=4;const c=[];c.push([r,0]);for(let d=1;d<l;d++)c.push([r*Math.cos(d*a),-r*Math.sin(d*a)]);c.push([r,0]),i={rings:[c]},s={xmin:-r,ymin:-r,xmax:r,ymax:r}}else if(n==="cross"||n==="esriSMSCross")i={paths:[[[0,r],[0,-r]],[[r,0],[-r,0]]]},s={xmin:-r,ymin:-r,xmax:r,ymax:r};else if(n==="diamond"||n==="esriSMSDiamond")i={rings:[[[-r,0],[0,r],[r,0],[0,-r],[-r,0]]]},s={xmin:-r,ymin:-r,xmax:r,ymax:r};else if(n==="square"||n==="esriSMSSquare")i={rings:[[[-r,-r],[-r,r],[r,r],[r,-r],[-r,-r]]]},s={xmin:-r,ymin:-r,xmax:r,ymax:r};else if(n==="x"||n==="esriSMSX")i={paths:[[[r,r],[-r,-r]],[[r,-r],[-r,r]]]},s={xmin:-r,ymin:-r,xmax:r,ymax:r};else if(n==="triangle"||n==="esriSMSTriangle"){const o=e*.5773502691896257,a=-o,l=2/3*e,c=l-e;i={rings:[[[a,c],[0,l],[o,c],[a,c]]]},s={xmin:a,ymin:c,xmax:o,ymax:l}}else n==="arrow"&&(i={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},s={xmin:-r,ymin:-r,xmax:r,ymax:r});return[s,i]},ike=t=>t==="vertical"||t==="horizontal"||t==="cross"||t==="esriSFSCross"||t==="esriSFSVertical"||t==="esriSFSHorizontal";function N4(t){if(!t)return null;let e=null;const{cap:r,color:i,join:s,miterLimit:n,style:o,width:a}=t;return o!=="solid"&&o!=="none"&&o!=="esriSLSSolid"&&o!=="esriSLSNull"&&(e=[{type:"CIMGeometricEffectDashes",dashTemplate:vC(o,r),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]),{type:"CIMSolidStroke",color:o!=="esriSLSNull"&&o!=="none"?Ts(i):[0,0,0,0],capStyle:NZ(r),joinStyle:DZ(s),miterLimit:n,width:a,effects:e}}let ske=class{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,r){const i=this._resourceMap.get(e);if(i)return{width:i.width,height:i.height};let s=this._inFlightResourceMap.get(e);return s?s.then(n=>({width:n.width,height:n.height})):(s=bve(e,r),this._inFlightResourceMap.set(e,s),s.then(n=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,n),{width:n.width,height:n.height}),()=>({width:0,height:0})))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(e){return UEe(e)}};function e7e(t){return t?{originPosition:t.originPosition==="upper-left"?"upperLeft":t.originPosition==="lower-left"?"lowerLeft":t.originPosition,scale:t.tolerance?[t.tolerance,t.tolerance,1,1]:[1,1,1,1],translate:t.extent!=null?[t.extent.xmin,t.extent.ymax,t.extent.zmin??0,t.extent.mmin??0]:[0,0,0,0]}:null}function nke(t){return t.originPosition==="lowerLeft"&&t.scale.length===4&&t.translate.length===4}function Ed(t){if(nke(t))return t;const{originPosition:e,scale:r,translate:i}=t,s=r[0]??1,n=r[1]??1;return{originPosition:"lowerLeft",scale:[s,e==="lowerLeft"?n:-n,r[2]??1,r[3]??1],translate:[i[0]??0,i[1]??0,i[2]??0,i[3]??0]}}function Ll({scale:t,translate:e},r){return Math.round((r-e[0])/t[0])}function Al({scale:t,translate:e},r){return Math.round((r-e[1])/t[1])}function mv({scale:t,translate:e},r){return Math.round(((r??0)-e[2])/t[2])}function yv({scale:t,translate:e},r){return r?Math.round((r-e[3])/t[3]):0}function zZ(t,e){return t&&e?uke:t&&!e?ake:!t&&e?lke:oke}const oke=(t,e)=>{const r=[];if(!e.length)return null;const i=e[0];let s=Ll(t,i[0]),n=Al(t,i[1]);r.push([s,n]);for(let o=1;o<e.length;o++){const[a,l]=e[o],c=Ll(t,a),d=Al(t,l);c===s&&d===n||r.push([c-s,d-n]),s=c,n=d}return r},ake=(t,e)=>{const r=[];if(!e.length)return null;const i=e[0];let s=Ll(t,i[0]),n=Al(t,i[1]),o=mv(t,i[2]);r.push([s,n,o]);for(let a=1;a<e.length;a++){const[l,c,d]=e[a],p=Ll(t,l),m=Al(t,c),y=mv(t,d);p===s&&m===n&&y===o||r.push([p-s,m-n,y]),s=p,n=m,o=y}return r},lke=(t,e)=>{const r=[];if(!e.length)return null;const i=e[0];let s=Ll(t,i[0]),n=Al(t,i[1]),o=yv(t,i[2]);r.push([s,n,o]);for(let a=1;a<e.length;a++){const[l,c,d]=e[a],p=Ll(t,l),m=Al(t,c),y=yv(t,d);p===s&&m===n&&y===o||r.push([p-s,m-n,y]),s=p,n=m,o=y}return r},uke=(t,e)=>{const r=[];if(!e.length)return null;const i=e[0];let s=Ll(t,i[0]),n=Al(t,i[1]),o=mv(t,i[2]),a=yv(t,i[3]);r.push([s,n,o,a]);for(let l=1;l<e.length;l++){const[c,d,p,m]=e[l],y=Ll(t,c),g=Al(t,d),v=mv(t,p),w=yv(t,m);y===s&&g===n&&v===o&&w===a||r.push([y-s,g-n,v,w]),s=y,n=g,o=v,a=w}return r};function cke(t,e,r,i){const s=[],n=zZ(r,i);for(let o=0;o<e.length;o++){const a=n(t,e[o]);a&&a.length>=3&&s.push(a)}return s.length?s:null}function hke(t,e,r,i){const s=[],n=zZ(r,i);for(let o=0;o<e.length;o++){const a=n(t,e[o]);a&&a.length>=2&&s.push(a)}return s.length?s:null}function iw({scale:t,translate:e},r){return r*t[0]+e[0]}function sw({scale:t,translate:e},r){return r*t[1]+e[1]}function gv({scale:t,translate:e},r){return(r??0)*t[2]+e[2]}function vv({scale:t,translate:e},r){return r?r*t[3]+e[3]:0}function zL(t,e){return t&&e?mke:t&&!e?pke:!t&&e?fke:dke}const dke=(t,e)=>{const r=new Array(e.length);if(!e.length)return r;const i=e[0];let s=iw(t,i[0]),n=sw(t,i[1]);r[0]=[s,n];const{scale:o,originPosition:a}=t,l=o[0],c=a==="lowerLeft"?o[1]:-o[1];for(let d=1;d<e.length;d++){const[p,m]=e[d];s+=l*p,n+=c*m,r[d]=[s,n]}return r},pke=(t,e)=>{const r=new Array(e.length);if(!e.length)return r;const i=e[0];let s=iw(t,i[0]),n=sw(t,i[1]);r[0]=[s,n,gv(t,i[2])];const{scale:o,originPosition:a}=t,l=o[0],c=a==="lowerLeft"?o[1]:-o[1];for(let d=1;d<e.length;d++){const[p,m,y]=e[d];s+=l*p,n+=c*m,r[d]=[s,n,gv(t,y)]}return r},fke=(t,e)=>{const r=new Array(e.length);if(!e.length)return r;const i=e[0];let s=iw(t,i[0]),n=sw(t,i[1]);r[0]=[s,n,vv(t,i[2])];const{scale:o,originPosition:a}=t,l=o[0],c=a==="lowerLeft"?o[1]:-o[1];for(let d=1;d<e.length;d++){const[p,m,y]=e[d];s+=l*p,n+=c*m,r[d]=[s,n,vv(t,y)]}return r},mke=(t,e)=>{const r=new Array(e.length);if(!e.length)return r;const i=e[0];let s=iw(t,i[0]),n=sw(t,i[1]);r[0]=[s,n,gv(t,i[2]),vv(t,i[3])];const{scale:o,originPosition:a}=t,l=o[0],c=a==="lowerLeft"?o[1]:-o[1];for(let d=1;d<e.length;d++){const[p,m,y,g]=e[d];s+=l*p,n+=c*m,r[d]=[s,n,gv(t,y),vv(t,g)]}return r};function jZ(t,e,r){const i=new Array(r.length);for(let s=0;s<r.length;s++)i[s]=e(t,r[s]);return i}function t7e(t,e,r){const i=Ed(t);return e.x=Ll(i,r.x),e.y=Al(i,r.y),r.z!=null&&(e.z=mv(i,r.z)),r.m!=null&&(e.m=yv(i,r.m)),e}function r7e(t,e,r){const i=cke(Ed(t),r.rings,r.hasZ,r.hasM);return i?(e.rings=i,e.hasZ=r.hasZ??!1,e.hasM=r.hasM??!1,e):null}function i7e(t,e,r){const i=hke(Ed(t),r.paths,r.hasZ,r.hasM);return i?(e.paths=i,e.hasZ=r.hasZ??!1,e.hasM=r.hasM??!1,e):null}function yke(t,e,r,i=r?.hasZ??!1,s=r?.hasM??!1){if(r!=null){const n=Ed(t);e.points=zL(i,s)(n,r.points),e.hasZ=i,e.hasM=s}return e}function gke(t,e,r,i=r?.z!=null,s=r?.m!=null){if(r==null)return e;const n=Ed(t);return e.x=iw(n,r.x),e.y=sw(n,r.y),i&&(e.z=gv(n,r.z)),s&&(e.m=vv(n,r.m)),e}function vke(t,e,r,i=r?.hasZ??!1,s=r?.hasM??!1){if(r!=null){const n=Ed(t);e.rings=jZ(n,zL(i,s),r.rings),e.hasZ=i,e.hasM=s}return e}function wke(t,e,r,i=r?.hasZ??!1,s=r?.hasM??!1){if(r!=null){const n=Ed(t);e.paths=jZ(n,zL(i,s),r.paths),e.hasZ=i,e.hasM=s}return e}function VZ(t,e,r,i,s,n){if(t==null)return null;const o=t.references("geometry")&&n?_ke(e,i,n):e,a=t.repurposeFeature(o,s);try{return t.evaluate(a,r)}catch(l){return U.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",l),null}}const gM=new Map;function _ke(t,e,r){const{transform:i,hasZ:s,hasM:n}=r;gM.has(e)||gM.set(e,bke(e));const o=gM.get(e)(t.geometry,i,s,n);return{...t,geometry:o}}function bke(t){const e={};switch(t){case"esriGeometryPoint":return(r,i,s,n)=>gke(i,e,r,s,n);case"esriGeometryPolygon":return(r,i,s,n)=>vke(i,e,r,s,n);case"esriGeometryPolyline":return(r,i,s,n)=>wke(i,e,r,s,n);case"esriGeometryMultipoint":return(r,i,s,n)=>yke(i,e,r,s,n);default:return U.getLogger("esri.views.2d.support.arcadeOnDemand").error(new R("mapview-arcade",`Unable to handle geometryType: ${t}`)),r=>r}}const s7e=Object.freeze(Object.defineProperty({__proto__:null,default:VZ},Symbol.toStringTag,{value:"Module"})),Ske=t=>{if(!t)return[0,0,0,0];const{r:e,g:r,b:i,a:s}=t;return[e,r,i,255*s]};var ut;let jL=(ut=class{static findApplicableOverrides(e,r,i){if(e&&r){if(e.primitiveName){let s=!1;for(const n of i)if(n.primitiveName===e.primitiveName){s=!0;break}if(!s)for(const n of r)n.primitiveName===e.primitiveName&&i.push(n)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const s of e.effects)ut.findApplicableOverrides(s,r,i);if(e.symbolLayers)for(const s of e.symbolLayers)ut.findApplicableOverrides(s,r,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const s of e.effects)ut.findApplicableOverrides(s,r,i);if(e.markerPlacement&&ut.findApplicableOverrides(e.markerPlacement,r,i),e.type==="CIMVectorMarker"){if(e.markerGraphics)for(const s of e.markerGraphics)ut.findApplicableOverrides(s,r,i),ut.findApplicableOverrides(s.symbol,r,i)}else e.type==="CIMCharacterMarker"?ut.findApplicableOverrides(e.symbol,r,i):e.type==="CIMHatchFill"?ut.findApplicableOverrides(e.lineSymbol,r,i):e.type==="CIMPictureMarker"&&ut.findApplicableOverrides(e.animatedSymbolProperties,r,i)}}}static findEffectOverrides(e,r){if(!e)return null;if(e.type==="CIMGeometricEffectDashes"&&zH(e),!r||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const i=vD(e),s=e.primitiveName,n=[];for(const o of r)o.primitiveName===s&&n.push(vD(o));return{type:"cim-effect-param",effect:i,overrides:d$e(n)}}static async resolveSymbolOverrides(e,r,i,s,n,o,a){if(!e?.symbol)return null;let{symbol:l,primitiveOverrides:c}=e;const d=!!c;if(!d&&!s)return l;l=O(l),c=O(c);let p=!0;if(r||(r={attributes:{}},p=!1),d){if(p||(c=c.filter(m=>!m.valueExpressionInfo?.expression.includes("$feature"))),a||(c=c.filter(m=>!m.valueExpressionInfo?.expression.includes("$view"))),c.length>0){const m=n$e(r.attributes),y={spatialReference:i,fields:m,geometryType:n};await ut.createRenderExpressions(c,y),ut.evaluateOverrides(c,r,n??"esriGeometryPoint",o,a,new uv(m))}ut.applyOverrides(l,c)}return s&&ut.applyDictionaryTextOverrides(l,r,s,null),l}static async createRenderExpressions(e,r){const i=[];for(const s of e){const n=s.valueExpressionInfo;if(!n||ut._expressionToRenderExpression.has(n.expression))continue;const o=qxe(n.expression,r.spatialReference);i.push(o),o.then(a=>ut._expressionToRenderExpression.set(n.expression,a))}i.length>0&&await Promise.all(i)}static evaluateOverrides(e,r,i,s,n,o){const a={$view:{scale:n?.scale}};for(const l of e){l.value&&typeof l.value=="object"&&hW(l.value)&&(l.propertyName==="Color"||l.propertyName==="StrokeColor")&&(l.value=Ske(l.value));const c=l.valueExpressionInfo;if(!c)continue;const d=ut._expressionToRenderExpression.get(c.expression);d&&(l.value=VZ(d,r,a,i,o,s))}}static applyDictionaryTextOverrides(e,r,i,s,n="Normal"){if(e?.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const o=e.symbolLayers;if(!o)return;for(const a of o)a&&a.type==="CIMVectorMarker"&&ut.applyDictionaryTextOverrides(a,r,i,s,e.type==="CIMTextSymbol"?e.textCase:n)}break;case"CIMVectorMarker":{const o=e.markerGraphics;if(!o)return;for(const a of o)a&&ut.applyDictionaryTextOverrides(a,r,i,s)}break;case"CIMMarkerGraphic":{const o=e.textString;if(o&&o.includes("[")){const a=Xxe(o,i);e.textString=Kxe(r,a,s,n)}}}}static applyOverrides(e,r,i,s){if(e.primitiveName){for(const n of r)if(n.primitiveName===e.primitiveName){const o=ew(n.propertyName);if(s&&s.push({cim:e,nocapPropertyName:o,value:e[o]}),i){let a=!1;for(const l of i)l.primitiveName===e.primitiveName&&(a=!0);a||i.push(n)}n.value!=null&&(e[o]=n.value)}}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const n of e.effects)ut.applyOverrides(n,r,i,s);if(e.symbolLayers)for(const n of e.symbolLayers)ut.applyOverrides(n,r,i,s);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const n of e.effects)ut.applyOverrides(n,r,i,s);if(e.type==="CIMVectorMarker"&&e.markerGraphics)for(const n of e.markerGraphics)ut.applyOverrides(n,r,i,s),ut.applyOverrides(n.symbol,r,i,s)}}static restoreOverrides(e){for(const r of e)r.cim[r.nocapPropertyName]=r.value}static buildOverrideKey(e){let r="";for(const i of e)i.value!==void 0&&(r+=`${i.primitiveName}${i.propertyName}${JSON.stringify(i.value)}`);return r}static toValue(e,r){if(e==="DashTemplate")return r.split(" ").map(i=>Number(i));if(e==="Color"){const i=new K(r).toRgba();return i[3]*=255,i}return r}},ut._expressionToRenderExpression=new Map,ut);const xke=Object.freeze(Object.defineProperty({__proto__:null,OverrideHelper:jL},Symbol.toStringTag,{value:"Module"})),$ke=96/72;let UZ=class{constructor(e){this._spatialReference=e,this._imageDataCanvas=null,this._cimResourceManager=new ske}get _canvas(){return this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas")),this._imageDataCanvas}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,r,i,s,n,o,a,l,c,d){if(!e)return null;const{data:p}=e;if(!p||p.type!=="CIMSymbolReference"||!p.symbol)return null;const{symbol:m}=p;o||(o=SS(m));const y=await jL.resolveSymbolOverrides(p,r,this._spatialReference,n,o,a,l),g=this._cimResourceManager,v=[];wi.fetchResources(y,g,v),wi.fetchFonts(y,g,v),v.length>0&&await Promise.all(v);const{width:w,height:_}=i;let x=D4(o,w,_,s,d);const $=wi.getEnvelope(y,x,g);if(!$)return null;$.x===1/0&&($.x=w+2),$.y===1/0&&($.y=-_/2),$.width===-1/0&&($.width=w),$.height===-1/0&&($.height=_);let T=1,C=0,P=0;switch(m.type){case"CIMPointSymbol":case"CIMTextSymbol":{let F=1;$.width>w&&(F=w/$.width);let j=1;$.height>_&&(j=_/$.height),s==="preview"&&($.width<w&&(F=w/$.width),$.height<_&&(j=_/$.height)),T=Math.min(F,j),C=$.x+$.width/2,P=$.y+$.height/2}break;case"CIMLineSymbol":if(d){P=$.y+$.height/2,C=$.x+$.width/2;const F=$.width-w,j=$.height-_;x={paths:AS(x.paths,{xmin:-1*$.width/2+F,xmax:$.width/2-F,ymin:-1*$.height/2+j,ymax:$.height/2-j,width:$.width-2*F,height:$.height-2*j})}}else{(c||$.height>_)&&(T=_/$.height),P=$.y+$.height/2;const F=$.x*T+w/2,j=($.x+$.width)*T+w/2,V=Xr(x)?x.paths:Kt(x)?x.rings:null;if(V===null)throw new Error("Bad geometry, can't rasterise symbol!");V[0][0][0]-=F/T,V[0][2][0]-=(j-w)/T}break;case"CIMPolygonSymbol":if(d){P=$.y+$.height/2,C=$.x+$.width/2;const F=$.width-w,j=$.height-_;x={paths:AS(x.rings,{xmin:-1*$.width/2+F,xmax:$.width/2-F,ymin:-1*$.height/2+j,ymax:$.height/2-j,width:$.width-2*F,height:$.height-2*j})}}else{C=$.x+$.width/2,P=$.y+$.height/2;const F=$.x*T+w/2,j=($.x+$.width)*T+w/2,V=$.y*T+_/2,Z=($.y+$.height)*T+_/2,{rings:Y}=x;F<0&&(Y[0][0][0]-=F,Y[0][3][0]-=F,Y[0][4][0]-=F),V<0&&(Y[0][0][1]+=V,Y[0][1][1]+=V,Y[0][4][1]+=V),j>w&&(Y[0][1][0]-=j-w,Y[0][2][0]-=j-w),Z>_&&(Y[0][2][1]+=Z-_,Y[0][3][1]+=Z-_)}}const A={type:"cim",data:{type:"CIMSymbolReference",symbol:y}};return this.rasterize(A,w,_,C,P,T,o,1,x)}rasterize(e,r,i,s,n,o,a,l=0,c=null,d=window.devicePixelRatio||1){const{data:p}=e;if(!p||p.type!=="CIMSymbolReference"||!p.symbol)return null;const{symbol:m}=p,y=this._canvas,g=d*$ke;y.width=r*g,y.height=i*g,a||(a=SS(m)),c||(c=D4(a,r,i,"legend")),y.width+=2*l,y.height+=2*l;const v=y.getContext("2d",{willReadFrequently:!0}),w=jr.createIdentity();return w.translate(-s,-n),w.scale(o*g,-o*g),w.translate(r*g/2+l,i*g/2+l),v.clearRect(0,0,y.width,y.height),new kZ(v,this._cimResourceManager,w,!0).drawSymbol(m,c),v.getImageData(0,0,y.width,y.height)}};function Mke(t,e,r,i){return e==="esriGeometryPolygon"?{rings:E4(AS(t.rings,{xmin:0,ymin:0,width:r,height:i}),-1*r/2,-1*i/2)}:e==="esriGeometryPolyline"?{paths:E4(AS(t.paths,{xmin:0,ymin:0,width:r,height:i}),-1*r/2,-1*i/2)}:null}function D4(t,e,r,i,s){const o=-e/2+1,a=e/2-1,l=r/2-1,c=-r/2+1;if(s&&(t==="esriGeometryPolygon"||t==="esriGeometryPolyline")){const d=Mke(s,t,e,r);if(d)return d}switch(t){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[o,0],[0,0],[a,0]]]};default:return i==="legend"?{rings:[[[o,l],[a,0],[a,c],[o,c],[o,l]]]}:{rings:[[[o,l],[a,l],[a,c],[o,c],[o,l]]]}}}const o7e=Object.freeze(Object.defineProperty({__proto__:null,CIMSymbolRasterizer:UZ},Symbol.toStringTag,{value:"Module"})),r1=new UZ(null),x_=Ke(22),z4=Ke(120),vM=Ke(50),Tke=1;async function Ike(t,e,r){const i=e?.size;let s=i!=null&&typeof i=="object"&&"width"in i?i.width:i,n=i!=null&&typeof i=="object"&&"height"in i?i.height:i;if(!s||!n)if(r==="esriGeometryPolygon")s=n=e.maxSize?Math.min(e.maxSize,x_):x_;else{const o=await VL(t,e,r);o&&(s=o.width,n=o.height),r==="esriGeometryPolyline"&&(s=e.maxSize?Math.min(e.maxSize,vM):vM),s=s!=null&&isFinite(s)?Math.min(s,z4):x_,n=n!=null&&isFinite(n)?Math.max(Math.min(n,z4),Tke):x_}return e.style==="legend"&&r==="esriGeometryPolyline"&&(s=vM),{width:s,height:n}}async function VL(t,e={},r){const i=e.cimOptions||e;r??=i.geometryType||SS(t?.data?.symbol);const{feature:s,fieldMap:n,viewParams:o}=i,a=await jL.resolveSymbolOverrides(t.data,s,null,n,r,null,o);if(!a)return null;(t=t.clone()).data={type:"CIMSymbolReference",symbol:a},t.data.primitiveOverrides=void 0;const l=[];return wi.fetchResources(a,r1.resourceManager,l),wi.fetchFonts(a,r1.resourceManager,l),l.length>0&&await Promise.all(l),wi.getEnvelope(a,null,r1.resourceManager)}async function Eke(t,e={}){const{node:r,opacity:i,symbolConfig:s}=e,n=s!=null&&typeof s=="object"&&"isSquareFill"in s&&s.isSquareFill,o=e.cimOptions||e,a=o.geometryType||SS(t?.data?.symbol),l=await Ike(t,e,a),{feature:c,fieldMap:d}=o,p=e?.geometry||n||a!=="esriGeometryPolygon"?"preview":"legend";let m=l;const y=l;if(e?.geometry&&(a==="esriGeometryPolygon"||a==="esriGeometryPolyline")&&(Pe(l.width)<200||Pe(l.height)<200)){const A=l.width>l.height?Ke(200)*l.height/l.width:Ke(200);m={width:l.width>l.height?Ke(200):Ke(200)*l.width/l.height,height:A}}const g=await r1.rasterizeCIMSymbolAsync(t,c,m,p,d,a,null,o.viewParams,o.allowScalingUp,e?.geometry?.toJSON());if(!g)return null;const{width:v,height:w}=g,_=document.createElement("canvas");_.width=v,_.height=w,_.getContext("2d").putImageData(g,0,0);const x=Pe(y.width),$=Pe(y.height),T=new Image(x,$);T.src=_.toDataURL(),T.ariaLabel=e.ariaLabel??null,T.alt=e.ariaLabel??"",i!=null&&(T.style.opacity=`${i}`);let C=T;if(e.cssEffectFilter){const P={shape:{type:"image",x:0,y:0,width:x,height:$,src:T.src},fill:null,stroke:null,offset:[0,0]};C=ny([[P]],[x,$],e)}return r&&C&&r.appendChild(C),C}const Cke=Object.freeze(Object.defineProperty({__proto__:null,getCIMSymbolPreviewSize:VL,previewCIMSymbol:Eke},Symbol.toStringTag,{value:"Module"})),wC=30,_C=12,bC=24,GZ=[255,255,255],OS=[200,200,200],Dh=[128,128,128],Pke=20,kke=5;function Lke(t){return t.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function Ake(t){return t.declaredClass==="esri.symbols.PictureMarkerSymbol"}function Rke(t){return t.declaredClass==="esri.symbols.SimpleLineSymbol"}function Oke(t){return t.declaredClass==="esri.symbols.TextSymbol"}function Fke(t,e){const r=t.length-1;return t.map((i,s)=>ZW(i,s,r,e))}async function Nke(t,e,r,i,s,n,o){const a=e.legendOptions,l=a?.customValues,c=o||await jke(t,r),d=e.stops,p=!!c,m=!!l,y=e.minSize!=null&&e.maxSize!=null,g=d&&d.length>1,v=!!e.target;if(!p||!m&&!(y||g&&!v))return;const w=lx(c);let _=!1,x=null,$=null;x=w&&!g?IS([e.minDataValue,e.maxDataValue]):l??await Uke(e,c,i,s?.type);const T=t?.authoringInfo,C=T?.type==="univariate-color-size",P=C&&T?.univariateTheme==="above-and-below",A=!!oa(t,"reference-size"),F=!!oa(t,"spike");if(!x&&g&&(x=d.map(re=>re.value),_=d.some(re=>!!re.label),t.type==="flow"&&(x=IS(x)),_&&($=d.map(re=>re.label))),w&&x!=null&&x?.length>2&&!P&&(x=[x[0],x[x.length-1]]),!x)return null;C&&x?.length!==5&&(x=HZ({minSize:x[0],maxSize:x[x.length-1]}));const j=w?Dke(t,x):null,V=bIe(c),Z=_?null:Fke(x,n);return(await Promise.all(x.map(async(re,Q)=>{let Ee=w?j[Q]:await Hp(e,c,re,i,s?.type),et=Ee;A&&(Ee*=bC/e.maxSize||1,et=bC);const lt=Bke(c,Ee,t,Q);return F&&lt.type==="cim"&&(et=await VL(lt)),{value:re,symbol:lt,label:_?$[Q]:Z[Q],size:et,outlineSize:V}}))).reverse()}function Dke(t,e){const r=t?.authoringInfo,i=r?.type==="univariate-color-size";let s=[_C,wC];if(i){const n=e[0],o=e[e.length-1],a=_C,l=wC;s=e.map(c=>a+(c-n)/(o-n)*(l-a))}return i&&r?.univariateTheme==="below"&&s.reverse(),s}function zke(t,e){const r=t.classBreakInfos,i=r.length,s=i<2||!(e>=2)?r[0].symbol.clone():r[i-1].symbol.clone();return t.visualVariables?.some(o=>o.type==="color")&&(s.type.includes("3d")?qZ(s):BZ(s)),s}async function jke(t,e){if(t.type==="flow")return JW(t,e);if(t.type==="pie-chart")return new Pt({color:null,outline:t.outline?.width?t.outline:new Ot});let r=null,i=null;if(t.type==="simple")r=t.symbol;else if(t.type==="class-breaks"){const s=t.classBreakInfos;r=s&&s[0]&&s[0].symbol,i=s.length>1}else if(t.type==="unique-value"){const s=t.uniqueValueInfos;r=s?.[0]?.symbol,i=s!=null&&s.length>1}if(!r||Vke(r))return null;if(r=r.clone(),e||i)if(r.type.includes("3d"))qZ(r);else if(oa(t,"reference-size")&&r.type==="cim")bL(r,{color:e??(t.type!=="class-breaks"?new K(OS):null)});else if(oa(t,"spike")&&r.type==="cim"){const s=new K(OS),n=new K(Dh),o=r.data.symbol?.type==="CIMPointSymbol"?r.data.symbol:null,a=!!o?.symbolLayers?.find(({type:d})=>d==="CIMSolidStroke")?.colorLocked;let l,c=e??void 0;if(c){const d=wW(c),p=Tq();(!p&&d>225||p&&d<25)&&(c=s,l=a?n:s)}else c=s,l=a?n:s;QW(r,{color:c,strokeColor:l})}else BZ(r);return r}function Vke(t){return so(t)?t.symbolLayers?.some(e=>e?.type==="fill")??!1:t?.type.includes("fill")??!1}function qZ(t){t.type==="line-3d"?t.symbolLayers.forEach(e=>{e.material={color:Dh}}):t.symbolLayers.forEach(e=>{e.type!=="icon"||e.resource?.href?e.material={color:OS}:(e.material={color:GZ},e.outline={color:Dh,size:1.5})})}function BZ(t){const e=Tq();t.type==="cim"?cW(t,new K(OS)):t.type.includes("line")?t.color=Dh:(t.color=e?Dh:GZ,t.type==="simple-marker"&&(t.outline?t.outline?.color?.toHex()==="#ffffff"&&(t.outline.color=Dh):t.outline={color:Dh,width:1.5}))}async function Uke(t,e,r,i){const s=(await q(async()=>{const{getSizeRangeAtScale:a}=await Promise.resolve().then(()=>$d);return{getSizeRangeAtScale:a}},void 0)).getSizeRangeAtScale(t,r,i),n=s&&HZ(s);if(!s||!n)return;let o=n.map(a=>Gke(a,t,s));o=IS(o);for(let a=1;a<o.length-1;a++){const l=await qke(t,e,o[a],o[a-1],r,i);l&&(o[a]=l[0],n[a]=l[1])}return o}function HZ(t){const e=t.minSize,r=t.maxSize,i=kke,s=(r-e)/(i-1),n=[];for(let o=0;o<i;o++)n.push(e+s*o);return n}function Gke(t,e,r){const i=r.minSize,s=r.maxSize,n=e.minDataValue,o=e.maxDataValue;let a;return t<=i?a=n:t>=s?a=o:a=(t-i)/(s-i)*(o-n)+n,a}async function qke(t,e,r,i,s,n){const o=await Hp(t,e,r,s,n),a=await Hp(t,e,i,s,n),l=TS(r),c=l.fractional,d=Pke;let p=l.integer,m=null,y=null;r>0&&r<1&&(m=10**c,p=TS(r*=m).integer);for(let g=p-1;g>=0;g--){const v=10**g;let w=Math.floor(r/v)*v,_=Math.ceil(r/v)*v;m!=null&&(w/=m,_/=m);let x=(w+_)/2;[,x]=IS([w,x,_],{indexes:[1]});const $=await Hp(t,e,w,s,n),T=await Hp(t,e,_,s,n),C=await Hp(t,e,x,s,n),P=Jb(o,$,a,null),A=Jb(o,T,a,null),F=Jb(o,C,a,null);let j=P.previous<=d,V=A.previous<=d;if(j&&V&&(P.previous<=A.previous?(j=!0,V=!1):(V=!0,j=!1)),j?y=[w,$]:V?y=[_,T]:F.previous<=d&&(y=[x,C]),y)break}return y}async function Hp(t,e,r,i,s){const{getSize:n}=await q(()=>Promise.resolve().then(()=>$d),void 0);return n(t,r,{scale:i,view:s,shape:e.type==="simple-marker"?e.style:null})}function Bke(t,e,r,i){r?.authoringInfo?.type==="univariate-color-size"&&r?.authoringInfo?.univariateTheme==="above-and-below"&&r.type==="class-breaks"&&(t=zke(r,i));const s=t.clone();if(so(s))lx(s)||s.symbolLayers.forEach(n=>{n.type!=="fill"&&(n.size=e)});else if(Lke(s))s.size=e;else if(Ake(s)){const n=s.width,o=s.height;s.height=e,s.width=e*(n/o)}else Rke(s)?s.width=e:Oke(s)?s.font&&(s.font.size=e):s.type==="cim"&&oa(r,"reference-size")?bL(s,{innerDotSize:e,outerRingSize:bC}):s.type==="cim"&&oa(r,"spike")&&QW(s,{defaultHeight:e,primitiveOverrides:null});return s}function Hke(t){const r=Math.floor(Math.log10(Math.abs(t)))+1,i=r<4||r>6?4:r,s=1e6,n=Math.abs(t)>=s?"compact":"standard";return nc(t,{notation:n,minimumSignificantDigits:2,maximumSignificantDigits:i})}const j4=16,Wke="https://utility.arcgis.com/sharing/tools/legend",Zke="esri.layers.ImageryLayer",Jke="esri.layers.ImageryTileLayer",Yke="esri.layers.WCSLayer",$_=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,Xke=new Ne({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),M_=new Pt({size:6,outline:{color:[128,128,128,.5],width:.5}}),Kke=new vi({style:"solid"});function SC(t){return t.type==="flow"}function WZ(t){return t.type==="vector-field"}function ZZ(t){return t.type==="raster-colormap"}function JZ(t){return t.type==="raster-stretch"}function YZ(t){return t.type==="raster-shaded-relief"}function Wp(t){return t.declaredClass==="esri.renderers.SimpleRenderer"}function dh(t){return t.declaredClass==="esri.renderers.ClassBreaksRenderer"}function ph(t){return t.declaredClass==="esri.renderers.UniqueValueRenderer"}function XZ(t){return t.declaredClass==="esri.renderers.HeatmapRenderer"}function Qke(t){return UL(t)||GL(t)||qL(t)||eLe(t)}function eLe(t){return t.declaredClass==="esri.renderers.PointCloudRGBRenderer"}function UL(t){return t.declaredClass==="esri.renderers.PointCloudClassBreaksRenderer"}function GL(t){return t.declaredClass==="esri.renderers.PointCloudStretchRenderer"}function qL(t){return t.declaredClass==="esri.renderers.PointCloudUniqueValueRenderer"}function KZ(t){return t.declaredClass==="esri.renderers.DotDensityRenderer"}function QZ(t){return t.declaredClass==="esri.renderers.PieChartRenderer"}function tLe(t,e){return Wp(t)||dh(t)||ph(t)||XZ(t)||KZ(t)||QZ(t)?e.type==="2d"||oW(t):JZ(t)||ZZ(t)||YZ(t)||UL(t)||GL(t)||qL(t)||WZ(t)||SC(t)}function rLe(t){return t.declaredClass==="esri.layers.BuildingSceneLayer"}function wM(t){return t.declaredClass==="esri.layers.SubtypeGroupLayer"}function iLe(t){return t.declaredClass==="esri.layers.VoxelLayer"}function sLe(t){return t.declaredClass==="esri.layers.WMSLayer"}function nLe(t){return t.declaredClass==="esri.layers.WMTSLayer"}function _M(t){return t.declaredClass==="esri.layers.MapImageLayer"}function V4(t){return t.declaredClass==="esri.layers.TileLayer"}function Qd(t){return t.declaredClass===Zke}function T_(t){return t.declaredClass===Jke}function oLe(t){return t.declaredClass===Yke}function aLe(t){return t.type==="stretch-ramp"}function lLe(t){return("authoringInfo"in t?t?.authoringInfo:null)?.type==="univariate-color-size"}function uLe(t){const e="authoringInfo"in t?t?.authoringInfo:null;return e?.type==="univariate-color-size"&&e?.univariateTheme==="above-and-below"}function U4(t){return"sublayers"in t}function G4(t){return t&&"symbol"in t}function cLe(t,e){const{field:r,field2:i,field3:s,fieldDelimiter:n,valueExpression:o}=t;if(!r)return null;const a=!r&&!o||!i&&!s?[e]:e?.toString().split(n||""),l=r?{[r]:a?.[0]}:null;return l&&(i&&(l[i]=a?.[1]),s&&(l[s]=a?.[2])),l}const hLe=new Pt({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let ep={};const bM=new WeakMap;let Lt=class extends le{constructor(t){super(t),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._loading=!1,this._webStyleSymbolCache=new Map,this._dotDensityUrlCache=new Map,this._scaleDrivenSizeVariable=null,this._clusterSizeVariable=null,this._layerDefinitionExpression=null,this._layerDefinitionExpressionClause=null,this._layerDisplayFilter=null,this._layerDisplayFilterClause=null,this.children=new se,this.layerView=null,this.layer=null,this.legendElements=[],this.parent=null,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.sublayerIds=[],this.title=null,this.view=null}initialize(){const t=()=>this.notifyChange("ready");this.addHandles([pn(()=>this.children,"change",e=>{const{added:r,removed:i}=e;r.forEach(s=>{const n=`activeLayerInfo-ready-watcher-${s.layer.uid}`;this.addHandles(ie(()=>s.ready,t,ft),n)}),i.forEach(s=>this.removeHandles(s.layer.uid)),t()})]),this.keepCacheOnDestroy||(ep={})}destroy(){this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(ep=null),this._layerDefinitionExpressionClause=null}get cssEffectFilter(){const{layer:t,scale:e}=this,r="effect"in t?t.effect:null;if(!r)return null;const i=new Fn({effect:r});return i.endTransition(),i.scale=e,FIe(i)}get loading(){return this.children.length>0?this.children.some(t=>t.loading):this._loading}get opacity(){const t=this.layer.opacity,e=this.parent?.opacity,r=this.layer.parent,i=r&&"uid"in r?this._getParentLayerOpacity(r):null;return e!=null?e*t:i!=null?i*t:t}get ready(){return this.layer===null||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}get scale(){return this.view?.scale??0}get isScaleDriven(){const t=this.layer;if(t===null)return!1;if("effect"in t&&t.effect&&Array.isArray(t.effect))return!0;if("featureReduction"in t&&t.featureReduction){if(t.featureReduction.type==="cluster")return!0;if(t.featureReduction.type==="binning"&&"renderer"in t.featureReduction&&t.featureReduction.renderer)return this._isRendererScaleDriven(t.featureReduction.renderer)}return"renderer"in t&&t.renderer?!!("displayFilterInfo"in t&&t.displayFilterInfo&&ph(t.renderer))||this._isRendererScaleDriven(t.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(t){if(this._loading=!0,!(!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView()))return this.legendElements=[],this._loading=!1,void this.notifyChange("ready");const e=Array.from(t,r=>{if(qV(r))return this._getRendererLegendElements(r.renderer,{title:r.title});if(r.featureSet?.features.length){const i=r.layerDefinition,s=i?.drawingInfo,n=s&&aMe(s.renderer),o=Xke.read(i.geometryType);return n?this._getRendererLegendElements(n,{title:r.name,geometryType:o}):(U.getLogger(this).warn("drawingInfo not available!"),null)}return null});try{const r=[],i=await Promise.allSettled(e);for(const s of i)if(s.status==="fulfilled")for(const n of s.value??[])r.push(n);this.legendElements=r}catch(r){U.getLogger(this).warn("error while building legend for layer!",r)}finally{this._loading=!1,this.notifyChange("ready")}}async buildLegendElementsForRenderer(t){try{this._loading=!0;const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getRendererLegendElements(t):[]}catch(e){U.getLogger(this).warn("error while building legend for layer!",e)}finally{this._loading=!1,this.notifyChange("ready")}}async buildLegendElementsForFeatureReduction(t){try{this._loading=!0,await this._waitForLayerViewUpdate(this.layerView);const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getLegendElementsForFeatureReduction(t):[]}catch(e){U.getLogger(this).warn("error while building legend for layer!",e)}finally{this._loading=!1,this.notifyChange("ready")}}async buildLegendElementsForTools(){this._loading=!0;const t=this.layer;if(iLe(t))await this._constructLegendElementsForVoxelLayer();else if(nLe(t))this._constructLegendElementsForWMTSlayer();else if(sLe(t))await this._constructLegendElementsForWMSSublayers();else if(rLe(t))await this._constructLegendElementsForBuildingSceneLayer();else if(_M(t)||V4(t)||wM(t))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");let e="default";if(Qd(t)&&(e=(t?.rasterFunction?.functionName||"default")+"_"+(t.bandIds?.length?t.bandIds.join(""):"###")),T_(t)||t.type==="link-chart")return;await this._getLegendLayers(`${t.uid}-${e}`).then(async r=>{this.legendElements=[];const i=r.map(async s=>{if(Qd(t)){const o=ie(()=>[t.rasterFunction,t.bandIds],()=>qS(async()=>{ep.default=null,t.renderer?await this.buildLegendElementsForRenderer(t.renderer):await this.buildLegendElementsForTools()})());this.addHandles(o,"imageryLayers-watcher")}const n=this._generateSymbolTableElementForLegendLayer(s);n?.infos.length&&(Qd(t)&&(n.title=t.title),this.legendElements.push(n))});await Promise.allSettled(i)}).catch(r=>{U.getLogger(this).warn("Request to server for legend has failed!",r)})}this._loading=!1,this.notifyChange("ready")}async _isLayerInCurrentView(t){return this._checkFeatureCountForExpression(t,this.view.extent)}_getParentLayerOpacity(t){let e=1;const r=t.parent;return r&&"uid"in r&&(e=this._getParentLayerOpacity(r)),t.opacity*e}_isGroupActive(){return this.children.some(t=>t.ready)}_isRendererScaleDriven(t){if(t.type==="dot-density")return!0;const e="valueExpression"in t?t.valueExpression:null;return $_.test(e)?!0:!!("visualVariables"in t?t.visualVariables:null)?.some(i=>this._isScaleDrivenSizeVariable(i))||this._hasScaleDrivenSymbols(t)}_hasScaleDrivenSymbols(t){switch(t.type){case"simple":return this._isScaleDrivenSymbol(t.symbol);case"class-breaks":return this._isScaleDrivenSymbol(t.defaultSymbol)||t.classBreakInfos.some(e=>this._isScaleDrivenSymbol(e.symbol));case"unique-value":return this._isScaleDrivenSymbol(t.defaultSymbol)||!!t.uniqueValueInfos?.some(e=>this._isScaleDrivenSymbol(e.symbol))}return!1}_isScaleDrivenSymbol(t){if(t?.type==="cim"){const{primitiveOverrides:e,minScale:r,maxScale:i}=t.data,s=e?.some(n=>(n.valueExpressionInfo?.expression||"").includes("$view.scale"))??!1;return r!=null||i!=null||s}return!1}_isScaleDrivenSizeVariable(t){if(t&&t.type!=="size")return!1;const e=t,r=e.minSize,i=e.maxSize;return!(typeof r!="object"||!r||!this._isScaleDrivenSizeVariable(r))||!(typeof i!="object"||!i||!this._isScaleDrivenSizeVariable(i))||$_.test(e.valueExpression)}_isLayerScaleDriven(t){if("minScale"in t&&t.minScale>0||"maxScale"in t&&t.maxScale>0)return!0;if("sublayers"in t&&t.sublayers)return t.sublayers.some(r=>this._isLayerScaleDriven(r));const e=t.parent;if(t.loaded===!1&&e&&_M(e)&&"source"in t&&t.source&&t.source.type==="map-layer"){for(const r of e.sourceJSON.layers??[])if(r.id===t.source.mapLayerId&&(r.minScale>0||r.maxScale>0))return!0}return!1}async _constructLegendElementsForVoxelLayer(){this._loading=!0,this.legendElements=[],this.removeHandles("voxel-style-watcher"),this.removeHandles("voxel-current-variable");const t=this.layer;this.addHandles(ie(()=>t.currentVariableId,()=>this._constructLegendElementsForVoxelLayer()),"voxel-current-variable"),this.addHandles(ie(()=>t.getVariableStyles(),()=>this._constructLegendElementsForVoxelLayer()),"voxel-style-watcher");const e=t.getVariableStyle(null),r=[];if(e){if(e.uniqueValues?.length){const i=[];e.uniqueValues.forEach(s=>{s.enabled&&i.push({label:s.label||`${s.value}`,value:s.value,symbol:new vi({color:s.color,outline:null})})}),i.length&&r.push({type:"symbol-table",title:e.label,infos:i})}else if(e.transferFunction){const{colorStops:i,stretchRange:s}=e.transferFunction,n=i.toArray().reverse(),o=s.map((l,c)=>`${c===0?HW:WW} ${Hke(l)}`).reverse(),a=n.map(l=>({color:l.color,value:null,label:null}));a[0].label=o[0],a[a.length-1].label=o[1],r.push({type:"color-ramp",title:e.label,infos:a,preview:uh(n.map(l=>l.color))})}}await this._generatePreviewsForLegendElements(r,{opacity:t.opacity}),this.legendElements=r,this._loading=!1,this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this._loading=!0,this.legendElements=[],this.removeHandles("wmts-activeLayer-watcher");const t=this.layer.activeLayer;this.addHandles(ie(()=>{const{layer:r}=this;return r&&"activeLayer"in r&&r.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");const e=t.styleId?t.styles?.find(({id:r})=>r===t.styleId)?.legendUrl:void 0;e&&(this.legendElements=[{type:"symbol-table",title:t.title,infos:[{src:e,opacity:this.opacity}]}]),this._loading=!1,this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this._loading=!0,this.legendElements=[],this.removeHandles("wms-sublayers-watcher");const t=this.layer;let e=null;(t.customParameters||t.customLayerParameters)&&(e={...t.customParameters,...t.customLayerParameters}),this.addHandles(ie(()=>{const{layer:r}=this;return r&&"sublayers"in r&&r.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher"),this.legendElements=await this._generateLegendElementsForWMSSublayers(t.sublayers,e),this._loading=!1,this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(t,e){const r=this.layer,i=[];this.addHandles(t.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");const s=this.sublayerIds?.map(o=>r.findSublayerById(o))?.filter(fr)??[],n=s.length?s:t.toArray();for(const o of n){const a=ie(()=>[o.title,o.visible,o.legendEnabled],()=>this._constructLegendElementsForWMSSublayers());if(this.addHandles(a,"wms-sublayers-watcher"),!this.respectLayerVisibility||o.visible&&o.legendEnabled){const l=await this._generateSymbolTableElementForWMSSublayer(o,e);l?.infos.length&&i.unshift(l)}}return i}async _generateSymbolTableElementForWMSSublayer(t,e){if(!t.legendUrl&&t.sublayers){const r=(await this._generateLegendElementsForWMSSublayers(t.sublayers,e)).filter(i=>i);return{type:"symbol-table",title:t.title,infos:r}}return this._generateSymbolTableElementForLegendUrl(t,e)}async _generateSymbolTableElementForLegendUrl(t,e){let r=t.legendUrl;if(!r)return;const i={type:"symbol-table",title:t.title||t.name||String(t.id??""),infos:[]};e&&(r=I_(r,e));let s=null;const n=t.layer?.opacity;try{s=(await Be(r,{responseType:"image"})).data,s&&(s.style.opacity=n)}catch{}return i.infos.push({src:r,preview:s,opacity:n}),i}_getLegendLayers(t,e){const r=ep&&ep[t];return r?Promise.resolve(r):this._legendRequest(e).then(i=>{const s=i.layers;return ep[t]=s,s})}_legendRequest(t){const e=this.layer;let r={f:"json",dynamicLayers:t};if(Qd(e)){const s=e.exportImageServiceParameters.rasterFunction;if(s&&(r.renderingRule=JSON.stringify(s.functionDefinition?.toJSON()||s.toJSON())),e.bandIds&&(r.bandIds=e.bandIds.join()),e.raster||e.viewId||e.customParameters){const{raster:n,viewId:o,customParameters:a}=e;r={raster:n,viewId:o,...r,...a}}}let i=e.url.replace(/(\/)+$/,"");if("version"in e&&+e.version>=10.01){const s=i.indexOf("?");s>-1?i=i.slice(0,s)+"/legend"+i.slice(s):i+="/legend"}else{const s=i.toLowerCase().indexOf("/rest/"),n=s===-1?i:i.slice(0,s)+i.slice(s+5);i=Wke+"?soapUrl="+encodeURI(n)+"&returnbytes=true"}return Be(i,{query:r}).then(s=>s.data)}async _constructLegendElementsForBuildingSceneLayer(){this._loading=!0,this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;this.addHandles(ie(()=>t.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(t.sublayers,this.opacity)}catch(e){U.getLogger(this).warn("Request to server for legend has failed!",e)}finally{this._loading=!1,this.notifyChange("ready")}}async _generateLegendElementsForBuildingSublayers(t,e){let r=[];this.addHandles(t.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");const i=t.toArray();for(const s of i){const n=ie(()=>["renderer"in s&&s.renderer,s.opacity,s.title,s.visible],()=>this._constructLegendElementsForBuildingSceneLayer());if(this.addHandles(n,"sublayers-watcher"),!this.respectLayerVisibility||s.visible){const o=s?.opacity!=null?s.opacity:null,a=o!=null?o*e:e;if(s.type==="building-group"){const l={type:"symbol-table",title:s.title,infos:[]},c=await this._generateLegendElementsForBuildingSublayers(s.sublayers,a);l.infos.push(...c),r=[l,...r]}else s.renderer&&(r=[...await this._getRendererLegendElements(s.renderer,{title:s.title,opacity:a,sublayer:s}),...r])}}return r.filter(s=>!!s&&(!("infos"in s)||!s.infos||s.infos.length>0))}async _constructLegendElementsForSublayers(){this._loading=!0,this.removeHandles("sublayers-watcher");const t=this.layer;if(!(_M(t)||V4(t)||wM(t))||this.hideLayersNotInCurrentView&&!await this._isLayerInCurrentView())return this.legendElements=[],this._loading=!1,void this.notifyChange("ready");this.addHandles(ie(()=>t.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(t.sublayers,this.opacity)}catch(e){U.getLogger(this).warn("Request to server for legend has failed!",e)}finally{this._loading=!1,this.notifyChange("ready")}}async _generateLegendElementsForSublayers(t,e,r){const i=this.layer;let s=[];this.addHandles(t.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");let n=t.toArray();!r&&this.sublayerIds&&this.sublayerIds.length&&(n=wM(i)?this.sublayerIds.map(o=>i.findSublayerForSubtypeCode(o)).filter(fr):this.sublayerIds.map(o=>i.findSublayerById(o)).filter(fr));for(const o of n){const a=ie(()=>[o.renderer,o.opacity,o.title,o.visible,o.legendEnabled],()=>this._constructLegendElementsForSublayers());this.addHandles(a,"sublayers-watcher");const l=o.createQuery().where,c=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView(l),d=!this.respectLayerVisibility||o.visible&&o.legendEnabled&&this._isSublayerInScale(o);if(c&&d){const p=o?.opacity!=null?o.opacity:null,m=p!=null?p*e:e,y=!U4(o)||o.originIdOf("renderer")>2&&!o.sublayers;if(o.renderer&&y)await o.load(),s=[...await this._getRendererLegendElements(o.renderer,{title:o.title,opacity:m,sublayer:o}),...s];else if(U4(o)){const g=await this._generateSymbolTableElementForSublayer(o,m,r);g&&s.unshift(g)}}}return s.filter(o=>!!o&&(!("infos"in o)||!o.infos||o.infos.length>0))}async _generateSymbolTableElementForSublayer(t,e,r){if(!r){r=new Map;const s=this.layer,n=t.source;let o=null;if(!(!n||n.type==="map-layer"&&n.mapLayerId===t.id&&(!n.gdbVersion||n.gdbVersion===("gdbVersion"in s&&s.gdbVersion)))||t.originIdOf("renderer")>2||t.originIdOf("labelingInfo")>2||t.originIdOf("labelsVisible")>2){const l=new Xs({layer:this.layer});o=l.hasDynamicLayers?l.dynamicLayers:null,l.destroy()}const a=o||`${s.uid}-default`;(await this._getLegendLayers(a,o)).forEach(l=>r.set(l.layerId,l))}const i=r.get(t.id);if((!i||i?.subLayerIds&&i.defaultVisibility)&&t.sublayers){const s=await this._generateLegendElementsForSublayers(t.sublayers,e,r);return{type:"symbol-table",title:t.title,infos:s}}return this._generateSymbolTableElementForLegendLayer(i,t,e)}_generateSymbolTableElementForLegendLayer(t,e,r){if(!t?.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(t,e))return null;const i=e?.renderer;let s=e?.title||t.layerName;if(i&&(!e||e?.originIdOf("renderer")>2)){const a=e?.title||this._getRendererTitle(i,e);a&&(s&&typeof a!="string"&&"title"in a&&(a.title=s),s=a)}const n={type:"symbol-table",title:s,legendType:t.legendType||null,infos:[]},o=e?this._sanitizeLegendForSublayer(t.legend.slice(),e):t.legend;return t.legendGroups&&t.legendGroups.length>0?t.legendGroups.forEach(a=>{const l={type:"symbol-table",title:a.heading,legendType:t.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(o.filter(c=>c.groupId===a.id),t.layerId,a.heading||n.title||e?.title,r)};l.infos?.length>0&&n.infos.push(l)}):n.infos=this._generateSymbolTableElementInfosForLegendLayer(o,t.layerId,n.title||e?.title,r),n.infos.length>0?n:null}_generateSymbolTableElementInfosForLegendLayer(t,e,r,i){return t.map(s=>{let n=s.url;if(s.imageData&&s.imageData.length>0)n=`data:image/png;base64,${s.imageData}`;else{if(n.startsWith("http"))return null;n=PX(`${this.layer.url}/${e}/images/${n}`)}let o=s.label;return o==="<all other values>"&&(o="others"),{previewAriaLabel:o||r,label:o,src:n,opacity:i??this.opacity,width:s.width,height:s.height}}).filter(fr)}_isSublayerInScale(t){const e=t.minScale||0,r=t.maxScale||0;return!(e>0&&e<this.scale||r>this.scale)}_isLegendLayerInScale(t,e){const r=e||this.layer;let i=null,s=null,n=!0;return!r.minScale&&r.minScale!==0||!r.maxScale&&r.maxScale!==0?(t.minScale===0&&r.tileInfo&&(i=r.tileInfo.lods[0].scale),t.maxScale===0&&r.tileInfo&&(s=r.tileInfo.lods[r.tileInfo.lods.length-1].scale)):(i=Math.min(r.minScale,t.minScale)||r.minScale||t.minScale,s=Math.max(r.maxScale,t.maxScale)),(i>0&&i<this.scale||s>this.scale)&&(n=!1),n}_sanitizeLegendForSublayer(t,e){if("version"in this.layer&&+this.layer.version<10.1||t.length===0)return t;const r=e.renderer,i=t.some(o=>o.values);let s=0,n=null;return i&&t.some((o,a)=>(o.values||(s=a,n=o,n.label||(n.label="others")),n!=null)),r?r.type==="unique-value"?n&&(t.splice(s,1),t.push(n)):r.type==="class-breaks"&&(n&&t.splice(s,1),r.legendOptions?.order||t.reverse(),n&&t.push(n)):n&&(t.splice(s,1),t.push(n)),t}async _getRendererLegendElements(t,e={}){if(!tLe(t,this.view))return U.getLogger(this).warn(`Renderer of type '${t.type}' not supported!`),[];if(Qke(t))return this._constructPointCloudRendererLegendElements(t,e);if(KZ(t))return this._constructDotDensityRendererLegendElements(t);const r=await this._loadRenderer(t);return QZ(r)?this._constructPieChartRendererLegendElements(r):this._constructRendererLegendElements(r,e)}async _getLegendElementsForFeatureReduction(t){let e=null;return t.type==="binning"?e=t.renderer:t.type==="cluster"&&(e=this._getClusterRenderer(t)),e?this._getRendererLegendElements(e,{isFeatureReductionRenderer:!0}):[]}_getPointCloudRendererTitle(t){return(t.legendOptions?.title||t.field)??""}async _constructPointCloudRendererLegendElements(t,e={}){const r=e.title,i=[];let s=null,n=null;if(UL(t))s={type:"symbol-table",title:r||this._getPointCloudRendererTitle(t),infos:[]},t.colorClassBreakInfos.forEach(o=>{s.infos.unshift({label:o.label||o.minValue+" - "+o.maxValue,value:[o.minValue,o.maxValue],symbol:this._getAppliedCloneSymbol(M_,o.color)})});else if(GL(t)){const o=t.stops;let a=null;if(o?.length&&(o.length===1&&(a=o[0].color),!a)){const c=o[0].value,d=o[o.length-1].value;c!=null&&d!=null&&(a=KW(c+(d-c)/2,o))}s={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(M_,a||M_.color)}]};const l=F3e(t.stops??[])??[];n={type:"color-ramp",title:r||this._getPointCloudRendererTitle(t),infos:l,preview:uh(l.map(c=>c.color))}}else qL(t)&&(s={type:"symbol-table",title:r||this._getPointCloudRendererTitle(t),infos:[]},t.colorUniqueValueInfos?.forEach(o=>{s.infos.push({label:o.label||o.values.join(", "),value:o.values.join(", "),symbol:this._getAppliedCloneSymbol(M_,o.color)})}));return s?.infos.length&&i.push(s),n?.infos.length&&i.push(n),await this._generatePreviewsForLegendElements(i,{opacity:this.opacity,symbolConfig:{applyColorModulation:!!t.colorModulation}}),i}async _getElementInfoForDotDensity(t,e){const{color:r,label:i,valueExpressionTitle:s}=e,{backgroundColor:n,outline:o,dotSize:a}=t,l=this.cssEffectFilter,c=a+"-"+r+"-"+n+"-"+(o&&JSON.stringify(o.toJSON()))+"-"+l,d=this._dotDensityUrlCache,p=d.has(c)?d.get(c):d3e(t,r);d.set(c,p);const m={shape:{type:"image",x:0,y:0,width:p.width,height:p.height,src:p.src},fill:null,stroke:null,offset:[0,0]},y=ny([[m]],[p.width,p.height],{cssEffectFilter:this.cssEffectFilter});return{opacity:1,src:p.src,preview:y,width:p.width,height:p.height,previewAriaLabel:i||s}}async _constructDotDensityRendererLegendElements(t){const e=t.calculateDotValue(this.view.scale),r=t.legendOptions?.unit,i={type:"symbol-table",title:{value:e&&Math.round(e),unit:r||""},infos:[]};for(const s of t.attributes){const n=await this._getElementInfoForDotDensity(t,s);n.label=s.label||s.valueExpressionTitle||s.field,i.infos.push(n)}return[i]}async _constructPieChartRendererLegendElements(t){const e=[];let r=null;const i=t.outline;t.attributes.forEach(o=>{const a=new Pt({color:o.color,outline:i}),l=o.label||o.valueExpressionTitle||o.field;e.push({label:l,symbol:a})});const s=e.length?[...e]:[];if(t.othersCategory?.color&&t.othersCategory?.threshold!==0){const o=new Pt({color:t.othersCategory.color,outline:i});r=t.othersCategory.label||"Other",e.push({label:r,symbol:o})}if(t.defaultColor?.a){const o=new Pt({color:t.defaultColor,outline:i});e.push({label:t.defaultLabel,symbol:o})}const n=await this._getVisualVariableLegendElements(t,this.layer)||[];if(e.length){n.unshift({type:"symbol-table",title:null,infos:e});const o=s.filter(l=>l.label!==r).map(l=>l.symbol.color).filter(Boolean),a=p3e(o,{holePercentage:t.holePercentage,backgroundColor:t.backgroundFillSymbol?.color,cssEffectFilter:this.cssEffectFilter,outline:i});n.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(t,this.layer),infos:e,preview:a})}return await this._generatePreviewsForLegendElements(n,{opacity:this.layer.opacity,cssEffectFilter:this.cssEffectFilter}),n}async _getWhereClause(t,e,r){const i=await uk(t,r),s=new Set,{field:n,field2:o,field3:a}=e;lc(s,r,[n,o,a]),await ei(s,r,null,e.valueExpression);const l=new Set(Array.from(s,d=>d.toLowerCase()));return i?.fieldNames.map(d=>d.toLowerCase())?.some(d=>!l.has(d))?null:i}async _processDefinitionExpression(t,e){if(!("definitionExpression"in t))return;const r=t.definitionExpression;r&&this.respectLayerDefinitionExpression?this._layerDefinitionExpression!==r&&(this._layerDefinitionExpressionClause=await this._getWhereClause(r,e,t.fieldsIndex)):this._layerDefinitionExpressionClause=null,this._layerDefinitionExpression=r}async _processDisplayFilter(t,e){if(!("displayFilterInfo"in t))return;const r=t.displayFilterInfo?x1e(t.displayFilterInfo,this.view):null;return r?.where?this._layerDisplayFilter?.id!==r?.id&&(this._layerDisplayFilterClause=await this._getWhereClause(r.where,e,t.fieldsIndex)):this._layerDisplayFilterClause=null,this._layerDisplayFilter=r,r}async _constructRendererLegendElements(t,e={}){const{title:r,sublayer:i,isFeatureReductionRenderer:s}=e,n=i||this.layer,o=oa(t,"reference-size"),a=oa(t,"spike"),l=s&&"renderer"in n&&n.renderer?n.renderer:t;let c=null;ph(l)&&(await this._processDefinitionExpression(n,l),c=await this._processDisplayFilter(n,l)),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null;const d=await this._getVisualVariableLegendElements(t,n)||[],p={type:"symbol-table",title:r||this._getRendererTitle(t,n),infos:[]};let m=null,y=!1;const g=new Set;if(SC(t)&&!this._hasSizeRamp){const $=await JW(t);p.infos.push({label:null,symbol:$})}else if(lLe(t)){let $=r;const T=uLe(t)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",C=d.findIndex(V=>V.type==="color-ramp"),P=C!==-1?d.splice(C,1)[0]:null,A=d.findIndex(V=>V.type==="size-ramp"),F=A!==-1?d.splice(A,1)[0]:null,j=[];P&&($=P.title,j.push(P)),F&&($=F.title,j.push(F)),j.length>0&&d.push({type:T,title:$,infos:j})}else if(XZ(t)){const $=z3e(t);d.push({type:"heatmap-ramp",title:r||this._getRendererTitle(t,n),infos:$,preview:uh($.map(T=>T.color),{cssEffectFilter:this.cssEffectFilter})})}else if(ph(t)){const $=t.authoringInfo;if($&&$.type==="relationship"){const{numClasses:T,field1:C,field2:P}=$,A=$.focus;if(T&&C&&P){const F=[C,P];let j=GW(A)||0;for(const Z of F){const{field:Y,normalizationField:re,label:Q}=Z,Ee=Q||{field:this._getFieldAlias(Y,n),normField:re&&this._getFieldAlias(re,n)},et=hLe.clone();et.angle=j,p.infos.push({label:Ee,symbol:et}),g.add(et),j+=90}const V=h3e({focus:A,numClasses:T,infos:t.uniqueValueInfos??[]});d.unshift(V)}}else if(Qd(this.layer)||T_(this.layer)){const{uniqueValueInfos:T}=t;if(T)for(const C of T)C.symbol&&await this._checkClausesForUVR(l,C.value)&&p.infos.push({label:C.label||C.value,value:C.value,symbol:C.symbol})}else{const{field:T,field2:C,field3:P,fieldDelimiter:A,valueExpression:F,defaultSymbol:j}=t,V=!(!T&&!F||!C&&!P),Z=c?c.title:null,Y=[],{uniqueValueGroups:re}=t;if(re)for(const Q of re){const Ee={type:"symbol-table",title:Z||Q.heading,infos:[]},{classes:et}=Q;if(et)for(const lt of et){const{symbol:Ve,values:vr}=lt;if(Ve){const Dl=[],zl=[];for(const Vl of vr??[]){const{value:uy,value2:cy,value3:hy}=Vl,xc=[],Cd=[];(T||F)&&(xc.push(uy),Cd.push(this._getDomainName(T,uy,n)??Yb(uy,Xb(n,T,this.view.timeZone)))),C&&(xc.push(cy),Cd.push(this._getDomainName(C,cy,n)??Yb(cy,Xb(n,C,this.view.timeZone)))),P&&(xc.push(hy),Cd.push(this._getDomainName(P,hy,n)??Yb(hy,Xb(n,P,this.view.timeZone)))),Dl.push(V?xc.join(A||""):xc[0]),zl.push(Cd.join(" - "))}const bc=Dl.join(", ");let jl=lt.label;if(!jl){const Vl=zl.filter(Boolean);jl=Vl.length?Vl.join(", "):bc}let Sc=Ve;Sc.type==="cim"&&o&&(Sc=Sc.clone(),bL(Sc,{innerDotSize:.5*j4,outerRingSize:j4}));let ly=!1;for(const Vl of Dl)if(ly=await this._checkClausesForUVR(l,Vl),ly)break;ly&&Ee.infos.push({label:jl,value:bc,symbol:Sc})}}Ee.infos.length&&Y.push(Ee)}if(Y.length){const Q=Y[0];if(Y.length===1&&"title"in Q&&!Q.title){const Ee=Q.infos?.filter(G4)??[];p.infos.push(...Ee)}else j&&(Y.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:j}]}),y=!0),p.infos.push(...Y);r||t.legendOptions?.title||t.valueExpressionTitle||(p.title=null)}}t.defaultSymbol&&!y&&(p.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),y=!0)}else if(dh(t)){if(!o&&!a){if(m=this._isUnclassedRenderer(t),!m||!this._hasSizeRamp){const $=t.classBreakInfos.filter(({symbol:C})=>C),T=t.legendOptions?.order==="ascending-values";for(const{label:C,minValue:P,maxValue:A,symbol:F}of $){const j=C||(m?null:`${P} - ${A}`),V={previewAriaLabel:j||p.title||n.title,label:j,value:[P,A],symbol:F};T?p.infos.push(V):p.infos.unshift(V)}m&&(p.title=null),this._updateInfosForClassedSizeRenderer(t,p.infos)}t.defaultSymbol&&!m&&(p.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),y=!0)}}else if(JZ(t))if(T_(this.layer)||oLe(this.layer)){const $=await this._constructTileImageryStretchRendererElements(t);aLe($)?d.push($):p.infos=$}else{const $=this.layer;let T,C;t.customStatistics?.length&&({min:T,max:C}=t.customStatistics[0]);let P=[],A=$.serviceRasterInfo;if($.rasterFunction)try{A=await $.generateRasterInfo($.rasterFunction)}catch{}const F=xS(A.pixelType);if(A.bandCount===1){const j=$.bandIds?.[0]||0;T=T??(A.statistics?A.statistics[j].min:F[0]),C=C??(A.statistics?A.statistics[j].max:F[1]),T||C?d.push(await this._getStretchLegendElements(t,{min:T,max:C})):this._getServerSideLegend()}else if($.bandIds&&$.bandIds.length===1)T=T??(A.statistics?A.statistics[$.bandIds[0]].min:F[0]),C=C??(A.statistics?A.statistics[$.bandIds[0]].max:F[1]),T||C?d.push(await this._getStretchLegendElements(t,{min:T,max:C})):this._getServerSideLegend();else if(A.bandCount>=3){const{bandInfos:j}=A,{bandIds:V}=$;j.length>=A.bandCount?V?.length===3?(P=V.map(Z=>j[Z].name),p.infos=this._createSymbolTableElementMultiBand(P)):$.format==="lerc"?(P=[0,1,2].map(Z=>j[Z].name),p.infos=this._createSymbolTableElementMultiBand(P)):this._getServerSideLegend():$.format==="lerc"?(P=["band1","band2","band3"],p.infos=this._createSymbolTableElementMultiBand(P)):this._getServerSideLegend()}else this._getServerSideLegend()}else if(ZZ(t))t.colormapInfos.forEach($=>{p.infos.push({label:$.label,value:$.value,symbol:this._getAppliedCloneSymbol(Kke,$.color)})});else if(Wp(t)){let $=t.symbol;switch(e.geometryType){case"point":$="pointSymbol"in n?n.pointSymbol:null;break;case"polyline":$="lineSymbol"in n?n.lineSymbol:null;break;case"polygon":$="polygonSymbol"in n?n.polygonSymbol:null}const T=this._clusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;t.symbol&&T&&p.infos.push({previewAriaLabel:t.label||p.title||n.title,label:t.label,symbol:$})}else if(WZ(t)){t.outputUnit&&(this.title="("+t.toJSON().outputUnit+")"),p.title=t.attributeField;const $=t.getClassBreakInfos();$?.length?$.forEach(T=>{p.infos.push({label:T.minValue+" - "+T.maxValue,symbol:T.symbol})}):p.infos.push({label:t.attributeField,symbol:t.getDefaultSymbol()})}else YZ(t)&&d.push(await this._getStretchLegendElements(t,{min:0,max:255}));const v=t.defaultSymbol;!v||y||Wp(t)||m&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||d.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:v}]}),p.infos.length&&d.unshift(p);const w=e.opacity==null?this.opacity:e.opacity,_=this._isTallSymbol("visualVariables"in t?t.visualVariables:null),x=Qd(this.layer)||T_(this.layer);return await this._generatePreviewsForLegendElements(d,{opacity:w,symbolConfig:{isTall:_,isSquareFill:x},cssEffectFilter:this.cssEffectFilter},{arrowMarkerSymbols:g}),t=null,d}async _waitForLayerViewUpdate(t){await Ov(()=>!t.updating)}async _checkFeatureCountForExpression(t,e){const r=this.layerView;if(!(r&&"createQuery"in r&&"queryFeatureCount"in r))return!0;try{await this._waitForLayerViewUpdate(r);const i=r.createQuery();return t&&(i.where=A3e(i.where,t)),e&&(i.geometry=e),await r.queryFeatureCount(i)>0}catch{return!0}}async _checkClausesForUVR(t,e){const r=cLe(t,e);return r?(!(!this._layerDefinitionExpressionClause&&this._layerDefinitionExpression&&this.respectLayerDefinitionExpression||!this._layerDisplayFilterClause&&this._layerDisplayFilter?.where)||await this._checkFeatureCountForExpression(`${t.field} = ${e}`))&&(!this._layerDefinitionExpressionClause||this._layerDefinitionExpressionClause.testFeature(r))&&(!this._layerDisplayFilterClause||this._layerDisplayFilterClause.testFeature(r)):!0}_getServerSideLegend(){setTimeout(()=>this.buildLegendElementsForTools(),0)}_getAllInfos(t){const e=t?.infos;return e?e.reduce((r,i)=>r.concat(this._getAllInfos(i)),[]):[t]}async _constructTileImageryStretchRendererElements(t){const e=this.layer,r=e.symbolizer.rasterInfo??e.raster.rasterInfo;let i,s;const n=t?.customStatistics?.length?t.customStatistics:r?.statistics;if(n)({min:i,max:s}=n[0]);else{const a=xS(r.pixelType);i=a[0],s=a[1]}if(e.hasStandardTime()&&(i=e.getStandardTimeValue(i),s=e.getStandardTimeValue(s)),r.bandCount===1||e.bandIds?.length===1)return this._getStretchLegendElements(t,{min:i,max:s});const o=(e?.bandIds?.length?e.bandIds:Array.from(Array(Math.min(r.bandCount,3)).keys())).map(a=>r.bandInfos[a].name);return o.length<3?o.push(o[1]):o.length>3&&o.splice(3),this._createSymbolTableElementMultiBand(o)}async _getStretchLegendElements(t,e){const r=t.colorRamp?.toJSON(),i=D3e(r,e);return{type:"stretch-ramp",title:"",infos:i,preview:uh(i.map(s=>s.color))}}_getClusterSymbol(){const t=this.layer,e="featureReduction"in t&&t.featureReduction,r=e&&"symbol"in e&&e.renderer;return r&&r?.authoringInfo?.isAutoGenerated!==!0?null:e&&"symbol"in e?e.symbol:null}async _getSizeLegendElement(t,e,r,i){return{type:"size-ramp",title:this._clusterSizeVariable?this._getClusterTitle(e):t,infos:await Nke(r,e,await cC(r),this.scale,this.view,i,this._clusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(t){const e=[],r=["red","green","blue"];return t.forEach((i,s)=>{e.push({label:{colorName:r[s],bandName:i},src:C3e[s],opacity:this.opacity??1})}),e}_updateInfosForClassedSizeRenderer(t,e){const r=t.authoringInfo&&t.authoringInfo.type==="class-breaks-size",i=t.classBreakInfos.some(s=>lx(s.symbol));if(r&&i){const s=wC,n=_C,o=t.classBreakInfos.length,a=(s-n)/(o>1?o-1:o);e.forEach((l,c)=>{l.size=s-a*c})}}_isTallSymbol(t){let e=!1,r=!1;if(t)for(let i=0;i<t.length&&(!e||!r);i++){const s=t[i];s.type==="size"&&(s.axis==="height"&&(e=!0),s.axis==="width-and-depth"&&(r=!0))}return e&&r}async _generatePreviewsForLegendElements(t,e,r){const i=[];for(const s of t)for(const n of s.infos??[])if("infos"in n&&n.infos&&i.push(this._generatePreviewsForLegendElements([n],e,r)),G4(n)&&n.symbol&&!n.preview){let o=!0;if(n.symbol.type==="cim"){const{minScale:a,maxScale:l}=n.symbol.data;(a&&a<this.scale||l&&l>this.scale)&&(o=!1)}o&&i.push(this._generateSymbolPreviewForInfo(n,{...e,clipBloomEffect:"theme"in s&&s.theme==="spike",cssEffectFilter:r?.arrowMarkerSymbols?.has(n.symbol)?null:e.cssEffectFilter},r?{applyScaleDrivenSize:!r.arrowMarkerSymbols?.has(n.symbol)}:void 0))}await Promise.all(i)}async _getSize(t,e){let r=t.size==null&&this._hasSizeRamp?Ke(22):t.size;if(this._scaleDrivenSizeVariable&&e?.applyScaleDrivenSize){const{getSize:i}=await q(()=>Promise.resolve().then(()=>$d),void 0);r=i(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:t.symbol.type==="simple-marker"?t.symbol.style:null})}return r}_getPreviewCIMOptions(t){return{style:"legend",cimOptions:{allowScalingUp:this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!t?.applyScaleDrivenSize),viewParams:this.isScaleDriven?{viewingMode:this.view?.type==="2d"?"map":this.view?.viewingMode,scale:this.view?.scale}:null}}}async _generateSymbolPreviewForInfo(t,e={},r){const{symbol:i}=t;try{if(e.size=await this._getSize(t,r),e.scale=!1,i.type==="cim"){const s=this._getPreviewCIMOptions(r);e={...e,...s}}t.preview=await qW(i,e)}catch{t.preview=null,U.getLogger(this).warn(`Generating symbol preview failed for symbol type: ${i?.type}`)}}_getClusterRenderer(t){this._clusterSizeVariable=null;const e="renderer"in this.layer?this.layer.renderer:null,r=t.renderer?.clone()||e?.clone(),i=v3e(t,this.layerView,this.view);if(i&&r!=null&&"visualVariables"in r&&!r.visualVariables?.some(n=>n.type==="size"&&n.target!=="outline"&&!$_.test(n.valueExpression))){if("clusterMinSize"in t&&"clusterMaxSize"in t){const{clusterMinSize:o,clusterMaxSize:a}=t;i.legendOptions=new jB({showLegend:o!==a})}const n=r.visualVariables||[];r.visualVariables=n.concat([i]),this._clusterSizeVariable=i}return r}async _loadRenderer(t){if(bM.has(t))return bM.get(t);const e=[],r=t.clone(),i=await cC(r);if(dh(r)||ph(r)){const s=(r.classBreakInfos||r.uniqueValueInfos).map(n=>this._fetchSymbol(n.symbol,i).then(o=>{n.symbol=o}).catch(()=>{n.symbol=null}));Array.prototype.push.apply(e,s)}return e.push(this._fetchSymbol(r.symbol||r.defaultSymbol,r.defaultSymbol?null:i).then(s=>{this._applySymbolToRenderer(r,s,Wp(r))}).catch(()=>{this._applySymbolToRenderer(r,null,Wp(r))})),await Promise.allSettled(e),bM.set(t,r),r}_applySymbolToRenderer(t,e,r){r?t.symbol=e:t.defaultSymbol=e}async _fetchSymbol(t,e){if(!t)throw new Error;if(t.type==="web-style"){const r=this._webStyleSymbolCache;try{const i=await t.fetchSymbol({cache:r});return this._getAppliedCloneSymbol(i,e)}catch{throw U.getLogger(this).warn("Fetching web-style failed!"),new Error}}return this._getAppliedCloneSymbol(t,e)}_getAppliedCloneSymbol(t,e){if(!t||!e)return t;const r=t.clone(),i=e&&e.toRgba();return r.type.includes("3d")?this._applyColorTo3dSymbol(r,i):r.type==="cim"?cW(r,e):r.color&&(r.color=new K(i||r.color)),r}_applyColorTo3dSymbol(t,e){e&&t.symbolLayers.forEach(r=>{r&&(r.material||(r.material={}),r.material.color=new K(e))})}async _getVisualVariableLegendElements(t,e){if(!("visualVariables"in t)||t.type==="vector-field")return null;const r=t.visualVariables??[],i=[],s=[],n=[],o=oa(t,"reference-size")??oa(t,"spike");let a;const l=this._clusterSizeVariable;if(o?.sizeStops?.length===2&&(dh(t)||ph(t))){const[y,g]=o.sizeStops,v=l?l.minDataValue:y.value,w=l?l.maxDataValue:g.value;a=new Ge({field:o.field??void 0,normalizationField:o.normalizationField,minSize:Qr(y.size,10,100),maxSize:Qr(g.size,50,150),minDataValue:v,maxDataValue:w}),s.push(a)}for(const y of r)if(y.type==="color")i.push(y);else if(y.type==="size"){if(y.field==="cluster_count"&&a)continue;s.push(y)}else y.type==="opacity"&&n.push(y);const c=[...i,...s,...n];let d,p;if(i.length===0&&dh(t)&&t.classBreakInfos&&t.classBreakInfos.length===1){const y=t.classBreakInfos[0];d=y&&y.symbol}if(i.length===0&&Wp(t)&&(d=t.symbol),d)if(d.type.includes("3d")){const y=d.symbolLayers.at(0);y.type==="water"?y.color!=null&&(p=y.color):y.material?.color!=null&&(p=y.material.color)}else d.url||(p=d.color);const m=this.cssEffectFilter;return(await Promise.all(c.map(async y=>{if(!y.legendOptions||y.legendOptions.showLegend!==!1){const g=SC(t)?y.field:this._getRampTitle(y,e);let v=null;const w=L3e(e,y,this.view.timeZone);if(y.type==="color"){const _=await u4(y,null,w)??[];v={type:"color-ramp",title:g,infos:_,preview:uh(_.map(x=>x.color),{cssEffectFilter:m})},this._hasColorRamp||(this._hasColorRamp=_.length>0)}else if(y.type==="size"&&y.target!=="outline")$_.test(y.valueExpression)?this._clusterSizeVariable||(this._scaleDrivenSizeVariable=y):(v=await this._getSizeLegendElement(g,y,t,w),a===y&&o?.theme==="spike"&&(v.theme=o.theme),this._hasSizeRamp||(this._hasSizeRamp=!(v.infos==null||!v.infos.length)));else if(y.type==="opacity"){const _=await u4(y,p,w)??[];v={type:"opacity-ramp",title:g,infos:_,preview:uh(_.map(x=>x.color),{cssEffectFilter:m})},this._hasOpacityRamp||(this._hasOpacityRamp=_.length>0)}return v?.infos?v:null}}))).filter(fr)}_getDomainName(t,e,r){if(t&&typeof t!="function"){const i="getField"in r&&r.getField?.(t),s=i&&"getFieldDomain"in r&&r.getFieldDomain?r.getFieldDomain(i.name,{excludeImpliedDomains:z("esri-widget-legacy-field-domain-calculation")}):null;return s?.type==="coded-value"?s.getName(e):null}return null}_getClusterTitle(t){const e=this.layer,r=t.field;if("featureReduction"in e&&e.featureReduction&&e.featureReduction.type==="cluster"){const i=e.featureReduction,s="popupTemplate"in i&&i.popupTemplate,n=s&&s.fieldInfos;if(n){for(const o of n)if(o.fieldName===r)return r==="cluster_count"?o.label||{showCount:!0}:o.label}}return{showCount:!0}}_getRampTitle(t,e){let r=t.field,i=t.normalizationField,s=!1,n=!1,o=!1,a=null;r=typeof r=="function"?null:r,i=typeof i=="function"?null:i;const l=t.legendOptions?.title;if(l!=null)a=l;else if(t.valueExpressionTitle)a=t.valueExpressionTitle;else{if("renderer"in e&&e.renderer&&"authoringInfo"in e.renderer&&e.renderer.authoringInfo?.visualVariables){const c=e.renderer.authoringInfo.visualVariables;for(let d=0;d<c.length;d++){const p=c[d];if(p.type==="color"){if(p.style==="ratio"){s=!0;break}if(p.style==="percent"){n=!0;break}if(p.style==="percent-of-total"){o=!0;break}}}}a={field:r&&this._getFieldAlias(r,e),normField:i&&this._getFieldAlias(i,e),ratio:s,ratioPercent:n,ratioPercentTotal:o}}return a}_getRendererTitle(t,e){const r=t;if(r.legendOptions?.title)return r.legendOptions.title;if(r.valueExpressionTitle)return r.valueExpressionTitle;let i=r.field,s=null,n=null;if(dh(r)&&(s=r.normalizationField,n=r.normalizationType==="percent-of-total"),i=typeof i=="function"?null:i,s=typeof s=="function"?null:s,ph(r)){const{field2:a,field3:l,fieldDelimiter:c}=r;let d=i&&this._getFieldAlias(i,e);return a&&(d=`<${d}>${c}<${this._getFieldAlias(a,e)}>`,l&&(d=`${d}${c}<${this._getFieldAlias(l,e)}>`)),d}let o=null;return(i||s)&&(o={field:i&&this._getFieldAlias(i,e),normField:s&&this._getFieldAlias(s,e),normByPct:n}),o}_getFieldAlias(t,e){const r="featureReduction"in e&&e.featureReduction;if(DP(e)&&!r)return e.getFieldAlias(t)||t;let n=("popupTemplate"in e?e.popupTemplate:null)?.fieldInfos?.find(d=>t===d.fieldName),o=null;"getField"in e&&e.getField?o=e.getField(t):"fieldsIndex"in e&&e.fieldsIndex&&(o=e.fieldsIndex.get(t));let a=null;r&&(n??="popupTemplate"in r?r.popupTemplate?.fieldInfos?.find(d=>t?.toLowerCase()===d.fieldName?.toLowerCase()):void 0,"fields"in r&&r.fields&&(a=r.fields.find(d=>d.name?.toLowerCase()===t?.toLowerCase())));const l=n||o||a;let c=null;return l&&(c=n?.label||o?.alias||a?.alias||"name"in l&&l.name||"fieldName"in l&&l.fieldName||null),c}_isUnclassedRenderer(t){const e=t.visualVariables;let r=!1;return dh(t)&&t.classBreakInfos&&t.classBreakInfos.length===1&&e&&(r=t.field?e.some(i=>!(!i||t.field!==i.field||(t.normalizationField||i.normalizationField)&&t.normalizationField!==i.normalizationField)):!!e.length),r}};u([h()],Lt.prototype,"_loading",void 0),u([h()],Lt.prototype,"children",void 0),u([h({readOnly:!0})],Lt.prototype,"cssEffectFilter",null),u([h()],Lt.prototype,"layerView",void 0),u([h()],Lt.prototype,"layer",void 0),u([h()],Lt.prototype,"legendElements",void 0),u([h({readOnly:!0})],Lt.prototype,"loading",null),u([h({readOnly:!0})],Lt.prototype,"opacity",null),u([h()],Lt.prototype,"parent",void 0),u([h({readOnly:!0,dependsOn:[]})],Lt.prototype,"ready",null),u([h()],Lt.prototype,"hideLayersNotInCurrentView",void 0),u([h()],Lt.prototype,"keepCacheOnDestroy",void 0),u([h()],Lt.prototype,"respectLayerDefinitionExpression",void 0),u([h()],Lt.prototype,"respectLayerVisibility",void 0),u([h({readOnly:!0})],Lt.prototype,"scale",null),u([h()],Lt.prototype,"sublayerIds",void 0),u([h({readOnly:!0})],Lt.prototype,"isScaleDriven",null),u([h()],Lt.prototype,"title",void 0),u([h({readOnly:!0,dependsOn:["ready"],value:0})],Lt.prototype,"version",null),u([h()],Lt.prototype,"view",void 0),Lt=u([E("esri.widgets.Legend.support.ActiveLayerInfo")],Lt);const Fc={state:"state",view:"view",allLayerViews:"all-layer-views",legendProperties:"legend-properties"},eJ=se.ofType(Lt),dLe=new Set(["esri.layers.BuildingSceneLayer","esri.layers.CatalogLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.OrientedImageryLayer","esri.layers.ParquetLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer","esri.layers.LinkChartLayer","esri.layers.catalog.CatalogFootprintLayer","esri.layers.catalog.CatalogDynamicGroupLayer","esri.layers.knowledgeGraph.KnowledgeGraphSublayer","esri.layers.KnowledgeGraphLayer"]),tJ="view.basemapView.baseLayerViews",rJ="view.groundView.layerViews",iJ="view.basemapView.referenceLayerViews",pLe=[tJ,rJ,"view.layerViews",iJ];let ts=class extends le{constructor(e){super(e),this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new se,this._activeLayerInfosPromises=new WeakMap,this.activeLayerInfos=new eJ,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this.addHandles(ie(()=>this.view,()=>this._viewHandles(),ft),Fc.view),this.addHandles($P(()=>this._refresh()))}destroy(){this._destroyViewActiveLayerInfos(),this.view=null}get loading(){return this.activeLayerInfos.some(e=>e.loading)}get state(){return this.view?.ready?"ready":"disabled"}_viewHandles(){this.removeHandles(Fc.state),this.view&&this.addHandles(ie(()=>this.state,()=>this._stateHandles(),ft),Fc.state)}_stateHandles(){this._resetAll(),this.state==="ready"&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles([Fc.allLayerViews,Fc.legendProperties]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(e){this.removeHandles(e);const r=this._activeLayerInfosByLayerViewId[e];r&&this._activeLayerInfosPromises.delete(r),delete this._activeLayerInfosByLayerViewId[e],r?.parent?.children.remove(r)}_watchPropertiesAndAllLayerViews(){const{view:e}=this;if(!e)return;const{allLayerViews:r}=e;r.length&&this._refresh(),this.addHandles(r.on("change",i=>this._allLayerViewsChangeHandle(i)),Fc.allLayerViews),this.addHandles(ie(()=>[this.basemapLegendVisible,this.groundLegendVisible,this.hideLayersNotInCurrentView,this.keepCacheOnDestroy,this.layerInfos,this.respectLayerDefinitionExpression,this.respectLayerVisibility],()=>this._refresh()),Fc.legendProperties)}_allLayerViewsChangeHandle(e){if(e.added.length&&this._generateActiveLayerInfosForLayerViews(e.added),e.moved.length)return this._destroyViewActiveLayerInfos(),void this._refresh();if(e.removed.length){for(const{uid:r}of e.removed)this._destroyViewActiveLayerInfo(r);this._refresh()}}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.drain(e=>this._activeLayerInfosPromises.delete(e)),this._generateActiveLayerInfosForLayerViews(this._generateLayerViews())}_generateActiveLayerInfosForLayerViews(e){e.filter(this._filterBasemapLayerViews,this).filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this)}_filterBasemapLayerViews(e){if(!this.view?.basemapView)return!0;const{baseLayerViews:r,groundLayerViews:i,referenceLayerViews:s}=this.view.basemapView,n=!this.basemapLegendVisible&&(r?.includes(e)||s?.includes(e)),o=!this.groundLegendVisible&&i?.includes(e);return!n&&!o}_sortActiveLayerInfos(e){const r=this.view;if(e.length<2||!r)return;const i=[];e.forEach(n=>{if(!n.parent){const o=n.layer.parent,a=o&&"uid"in o&&this._layerViewByLayerId[o.uid],l=a&&this._activeLayerInfosByLayerViewId[a.uid];l&&e.includes(l)&&(i.push(n),n.parent=l,l.children.add(n),this._sortActiveLayerInfos(l.children))}}),e.removeMany(i);const s={};r.allLayerViews.forEach((n,o)=>s[n.layer.uid]=o),e.sort((n,o)=>{const a=s[n.layer.uid]||0;return(s[o.layer.uid]||0)-a})}_generateLayerViews(){const e=[];return pLe.filter(this._filterLayerViews,this).map(r=>ln(this,r)).filter(r=>r!=null).forEach(this._collectLayerViews("layerViews",e)),e}_filterLayerViews(e){const r=!this.basemapLegendVisible&&(e===tJ||e===iJ),i=!this.groundLegendVisible&&e===rJ;return!r&&!i}_collectLayerViews(e,r){const i=s=>(s&&s.forEach(n=>{r.push(n),i(n[e])}),r);return i}_filterLayerViewsByLayerInfos(e){const r=this.layerInfos;return!r||!r.length||r.some(i=>this._hasLayerInfo(i,e))}_hasLayerInfo(e,r){const i=this._isLayerUIDMatching(e.layer,r.layer.uid);return i&&(this._layerInfosByLayerViewId[r.uid]=e),i}_isLayerUIDMatching(e,r){return e&&(e.uid===r||this._hasLayerUID(e.layers,r))}_hasLayerUID(e,r){return e&&e.some(i=>this._isLayerUIDMatching(i,r))}_isLayerViewSupported(e){return!!dLe.has(e.layer.declaredClass)&&(this._layerViewByLayerId[e.layer.uid]=e,!0)}_generateActiveLayerInfo(e){this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this.removeHandles(e.uid),this.addHandles(ie(()=>[e.legendEnabled,e.layer?.legendEnabled],()=>this._layerActiveHandle(e)),e.uid))}_layerActiveHandle(e){this._isLayerActive(e)&&(this.removeHandles(e.uid),this._buildActiveLayerInfo(e))}_isLayerActive(e){return!this.respectLayerVisibility||e.legendEnabled&&e.layer?.legendEnabled}async _buildActiveLayerInfo(e){const r=e.layer,i=e.uid,s=this._layerInfosByLayerViewId[i];let n=this._activeLayerInfosByLayerViewId[i];n||(n=new Lt({layer:r,layerView:e,view:this.view??void 0}),this._activeLayerInfosByLayerViewId[i]=n);const o=s?.title!==void 0&&s.layer.uid===r.uid;n.title=o?s.title:r.title,n.respectLayerDefinitionExpression=this.respectLayerDefinitionExpression,n.respectLayerVisibility=this.respectLayerVisibility,n.hideLayersNotInCurrentView=this.hideLayersNotInCurrentView,n.keepCacheOnDestroy=this.keepCacheOnDestroy,n.sublayerIds=s?.sublayerIds||[];const a=r.parent&&"uid"in r.parent?this._layerViewByLayerId[r.parent?.uid]:null;n.parent=this._activeLayerInfosByLayerViewId[a?.uid],this._addActiveLayerInfo(n),this._constructLegendElements(n),this._attachHandlesToActiveLayerInfo(n)}_attachHandlesToActiveLayerInfo(e){const{layer:r,layerView:i}=e,s=i.uid;this.removeHandles(s),this.addHandles([ie(()=>r.title,n=>this._titleHandle(n,e)),ie(()=>[r.opacity,"renderer"in r&&r.renderer,"pointSymbol"in r&&r.pointSymbol,"lineSymbol"in r&&r.lineSymbol,"polygonSymbol"in r&&r.polygonSymbol,"effect"in r&&r.effect,"featureReduction"in r&&ND(r,i.view),this.view?.timeZone],()=>this._constructLegendElements(e)),ie(()=>"filter"in i&&i.filter,()=>{ND(i.layer,i.view)!=null&&this._constructLegendElements(e)}),Ti(()=>!!this.view?.stationary,()=>this._scaleHandle(e)),ie(()=>e.loading,()=>this.notifyChange("loading"),ft)],s),this.respectLayerVisibility&&this.addHandles([ie(()=>r.legendEnabled,n=>this._legendEnabledHandle(n,e)),ie(()=>i.legendEnabled,n=>{this.view?.suspended||this._legendEnabledHandle(n,e)})],s),this.respectLayerDefinitionExpression&&"definitionExpression"in r&&this.addHandles(ie(()=>r.definitionExpression,()=>this._constructLegendElements(e)),s)}_titleHandle(e,r){r.title=e,this._constructLegendElements(r)}_legendEnabledHandle(e,r){e?this._addActiveLayerInfo(r):this._removeActiveLayerInfo(r)}_scaleHandle(e){(e.isScaleDriven||e.hideLayersNotInCurrentView)&&this._constructLegendElements(e)}_addActiveLayerInfo(e){const{layerView:r,layer:i}=e;if(this._isLayerActive(r)&&!this.activeLayerInfos.includes(e)){const s=e.parent;if(s)s.children.includes(e)||s.children.push(e),this._sortActiveLayerInfos(s.children);else{const n=this.layerInfos?.some(a=>a.layer.uid===i.uid),o=i.parent;o&&"uid"in o&&this._layerViewByLayerId[o.uid]&&!n?this._activeLayerInfosWithNoParent.add(e):(this.activeLayerInfos.add(e),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const n=[];this._activeLayerInfosWithNoParent.forEach(o=>{const a=o.layer.parent,l=a&&"uid"in a?this._layerViewByLayerId[a?.uid]:null,c=this._activeLayerInfosByLayerViewId[l?.uid];c&&(n.push(o),o.parent=c)}),n.length&&(this._activeLayerInfosWithNoParent.removeMany(n),n.forEach(o=>this._addActiveLayerInfo(o)))}}}_removeActiveLayerInfo(e){const r=e.parent;r?r.children.remove(e):this.activeLayerInfos.remove(e)}async _getBuildLegendPromise(e){const{layer:r}=e;if("featureCollections"in r&&r.featureCollections)return e.buildLegendElementsForFeatureCollections(r.featureCollections);if("featureReduction"in r&&r.featureReduction&&"renderer"in r.featureReduction&&(r.featureReduction.type==="binning"||r.featureReduction.type==="cluster")&&(!this.view||r.featureReduction.maxScale<=this.view.scale))return e.buildLegendElementsForFeatureReduction(r.featureReduction);if("renderer"in r&&r.renderer&&!("sublayers"in r))return e.buildLegendElementsForRenderer(r.renderer);if("url"in r&&r.url&&r.type!=="catalog"&&r.type!=="knowledge-graph")return e.buildLegendElementsForTools();const i=e.children.map(s=>this._constructLegendElements(s));return Promise.all(i).then(()=>{})}async _constructLegendElements(e){const r=this._activeLayerInfosPromises.get(e);r&&await r.catch(()=>{});const i=this._getBuildLegendPromise(e);this._activeLayerInfosPromises.set(e,i),i.finally(()=>{this._activeLayerInfosPromises.delete(e)})}};u([h({type:eJ})],ts.prototype,"activeLayerInfos",void 0),u([h()],ts.prototype,"basemapLegendVisible",void 0),u([h()],ts.prototype,"groundLegendVisible",void 0),u([h()],ts.prototype,"hideLayersNotInCurrentView",void 0),u([h()],ts.prototype,"keepCacheOnDestroy",void 0),u([h({readOnly:!0})],ts.prototype,"loading",null),u([h()],ts.prototype,"respectLayerDefinitionExpression",void 0),u([h()],ts.prototype,"respectLayerVisibility",void 0),u([h()],ts.prototype,"layerInfos",void 0),u([h({readOnly:!0})],ts.prototype,"state",null),u([h()],ts.prototype,"view",void 0),ts=u([E("esri.widgets.Legend.LegendViewModel")],ts);const Ye="esri-legend--card",Yy="esri-legend",we={base:Ye,stacked:`${Yy}--stacked`,carouselTitle:`${Ye}__carousel-title`,intervalSeparator:`${Ye}__interval-separator`,imageryLayerStretchedImage:`${Ye}__imagery-layer-image--stretched`,imageLabel:`${Ye}__image-label`,layerCaption:`${Ye}__layer-caption`,labelElement:`${Ye}__label-element`,layerRow:`${Ye}__layer-row`,labelCell:`${Ye}__label-cell`,message:`${Ye}__message`,rampLabel:`${Ye}__ramp-label`,section:`${Ye}__section`,serviceCaptionText:`${Ye}__service-caption-text`,serviceContent:`${Ye}__service-content`,service:`${Ye}__service`,groupLayer:`${Ye}__group-layer`,groupLayerChild:`${Ye}__group-layer-child`,symbol:`${Ye}__symbol`,sizeRampRow:`${Ye}__size-ramp-row`,symbolRow:`${Ye}__symbol-row`,symbolCell:`${Ye}__symbol-cell`,carousel:`${Ye}__carousel`,carouselItem:`${Ye}__carousel-item`,intervalSeparatorsContainer:`${Ye}__interval-separators-container`,relationshipLabelContainer:`${Ye}__relationship-label-container`,labelContainer:`${Ye}__label-container`,serviceCaptionContainer:`${Ye}__service-caption-container`,symbolContainer:`${Ye}__symbol-container`,colorRampContainer:`${Ye}__color-ramp-container`,sizeRampContainer:`${Ye}__size-ramp-container`,sizeRampPreview:`${Ye}__size-ramp-preview`,pieChartRampPreview:`${Ye}__pie-chart-ramp-preview`,sizeRampHorizontal:`${Yy}__size-ramp--horizontal`,rampLabelsContainer:`${Yy}__ramp-labels`,layerInfo:`${Yy}__layer-cell ${Yy}__layer-cell--info`,univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"};function fLe(t,e){return e}function Ft(t){const e=this;t.appendChild(e)}function Ml(t,e,r){if(!e)return;if(typeof e=="number")return e;if(typeof e=="string")return JY(e);if("value"in e||"unit"in e)return va(t.dotValue,e);if("colorName"in e&&"bandName"in e)return t[e.colorName]+": "+(t[e.bandName]||e.bandName);if("showCount"in e)return e.showCount?t.clusterCountTitle:void 0;let i=null;return fLe(e,r)?i=e.ratioPercentTotal?"showRatioPercentTotal":e.ratioPercent?"showRatioPercent":e.ratio?"showRatio":e.normField?"showNormField":e.field?"showField":null:sJ(e,r)&&(i=e.normField?"showNormField":e.normByPct?"showNormPct":e.field?"showField":null),i?va(i==="showField"?"{field}":t[i],{field:e.field,normField:e.normField}):void 0}function sJ(t,e){return!e}function nJ(t,e){return!!(e&&e==="Stretched"&&"version"in t&&typeof t.version=="number"&&t.version>=10.3&&t.declaredClass==="esri.layers.ImageryLayer")}function mLe(t,e){return t.label?e[t.label]+": "+(typeof t.value=="string"?t.value:nc(t.value??0,{style:"decimal",notation:t.value?.toString().toLowerCase().includes("e")?"scientific":"standard"})):""}function oJ(t,e,r){switch(e){case"heatmap-ramp":return r[t.label]||t.label;case"stretch-ramp":return mLe(t,r);default:return t.label}}function aJ(t,e){if(!t.title||typeof t.title=="string")return t.title;const r=t.type==="color-ramp"||t.type==="opacity-ramp",i=t.title,s=Ml(e,i,r);return sJ(i,r)&&i.title?`${i.title} (${s})`:s}function lJ(t){return!(!t||typeof t!="object")}function FS(t,e){const r=Ml(t,e,!1),i=r?t.previewTemplateAriaLabel:t.previewAriaLabel;return va(i,{label:r})}const yLe=25,gLe=25,vLe=100;let fh=class extends gr{constructor(e,r){super(e,r),this.cssEffectFilter=null,this.legendElement=null,this.opacity=1}render(){const e=this.legendElement.infos.slice().reverse();return L("div",{class:this.classes(we.layerRow,we.colorRampContainer)},this._renderRampLabel(e[0]),L("div",{class:we.symbolContainer},this._renderPreview(e),this._renderMiddleStopRampLabel(e)),this._renderRampLabel(e.at(-1)))}_renderPreview(e){const{opacity:r}=this,i=this.legendElement.type==="heatmap-ramp",s=e.length-1,n=gLe,o=s>2&&!i?yLe*s:vLe,a=o+20,l=10,c=[[{shape:{type:"path",path:`M0 ${n/2} L${l} 0 L${l} ${n} Z`},fill:e[0].color,stroke:{width:0}},{shape:{type:"rect",x:l,y:0,width:o,height:n},fill:{type:"linear",x1:l,y1:0,x2:o+l,y2:0,colors:e.map((m,y)=>({color:m.color,offset:i&&"ratio"in m?m.ratio:y/s}))},stroke:{width:0}},{shape:{type:"path",path:`M${o+l} 0 L${a} ${n/2} L${o+l} ${n} Z`},fill:e[e.length-1].color,stroke:{width:0}}]],d=PW(c,a,n),p={filter:this.cssEffectFilter??void 0,opacity:r==null?void 0:`${r}`};return L("div",{styles:p},d)}_renderMiddleStopRampLabel(e){const r=e.length%2!=0?e[e.length/2|0]:null;return r?L("div",{class:we.intervalSeparatorsContainer},L("div",{class:we.intervalSeparator},"|"),this._renderRampLabel(r)):null}_renderRampLabel(e){return L("div",{class:we.rampLabel},oJ(e,this.legendElement.type,this.messages))}};u([h()],fh.prototype,"cssEffectFilter",void 0),u([h()],fh.prototype,"legendElement",void 0),u([h()],fh.prototype,"messages",void 0),u([h()],fh.prototype,"opacity",void 0),fh=u([E("esri.widgets.Legend.styles.card.ColorRamp")],fh);const wLe="#ddd",Gr=window.devicePixelRatio,Nc="esri-spike-ramp",_l={spikeRampContainer:`${Nc}__container`,spikeRampPreviewContainer:`${Nc}__preview-container`,spikeRampPreview:`${Nc}__preview`,spikeRampSymbolPreview:`${Nc}__symbol-preview`,spikeRampLines:`${Nc}__lines`,spikeRampLabelsContainer:`${Nc}__labels-container`,spikeRampLabel:`${Nc}__label`};function uJ(t){return t.infos.length!==5?null:L("div",{class:_l.spikeRampContainer},L("div",{class:_l.spikeRampPreviewContainer},_Le(t),bLe(t)),SLe(t))}function _Le(t){const[e,r,i]=BL(t).map(({preview:s})=>{if(!s)return null;const n=s.cloneNode(!0);return n.classList.add(_l.spikeRampSymbolPreview),n});return e&&r&&i?L("div",{class:_l.spikeRampPreview},L("div",{afterCreate:Ft,bind:i}),L("div",{afterCreate:Ft,bind:r}),L("div",{afterCreate:Ft,bind:e})):null}function bLe(t){const[{width:e,height:r},{width:i},{width:s,height:n}]=BL(t).map(({size:F})=>lJ(F)?{width:Pe(F.width),height:Pe(F.height)}:{width:0,height:0}),o=10,a=8,l=e+i+s+3*o,c=r,d=document.createElement("canvas");d.width=(l+o)*Gr,d.height=c*Gr,d.style.width=d.width/Gr+"px",d.style.height=d.height/Gr+"px";const p=d.getContext("2d");p.beginPath();const m=l-(e/2+o),y=0,g=l+a;p.moveTo(m*Gr,y*Gr),p.lineTo(g*Gr,0*Gr);const w=(l-a)/2,_=(r-n)/2,x=l+a,$=(r-n)/2;p.moveTo(w*Gr,_*Gr),p.lineTo(x*Gr,$*Gr);const T=s/2,C=c-n,P=l+a,A=c-n;return p.moveTo(T*Gr,C*Gr),p.lineTo(P*Gr,A*Gr),p.strokeStyle=wLe,p.lineWidth=.5*Gr,p.stroke(),L("div",{afterCreate:Ft,bind:d,class:_l.spikeRampLines})}function SLe(t){const[{label:e,height:r},{label:i},{label:s,height:n}]=BL(t).map(({label:d,size:p})=>({label:d,height:lJ(p)?Pe(p.height):0})),o=r-n,a={position:"absolute",top:"0"},l={position:"absolute",top:o/2+"px"},c={position:"absolute",top:`${o}px`};return L("div",{class:_l.spikeRampLabelsContainer},L("div",{class:_l.spikeRampLabel,styles:a},e),L("div",{class:_l.spikeRampLabel,styles:l},i),L("div",{class:_l.spikeRampLabel,styles:c},s))}function BL(t){return t.infos.filter((e,r)=>r%2==0)}const xLe="#ddd",tp=window.devicePixelRatio;function $Le(t){if(!t)return;if(t.type.includes("3d")){if(!t.symbolLayers?.length)return;const r=t.symbolLayers.at(-1),i=r.resource?.primitive;return i==="circle"||i==="cross"||i==="kite"||i==="sphere"||i==="cube"||i==="diamond"}const e=t.style;return e==="circle"||e==="diamond"||e==="cross"}function MLe(t){if(t){if(t.type.includes("3d")){if(!t.symbolLayers?.length)return;const e=t.symbolLayers.at(-1),r=e?.resource?.primitive;return r==="triangle"||r==="cone"||r==="tetrahedron"}return t.style==="triangle"}}let mh=class extends gr{constructor(e,r){super(e,r),this.hasIndicators=!1,this.legendElement=null,this.opacity=1}render(){if(this.legendElement.theme==="spike")return L("div",{styles:{display:"flex",flex:"1",justifyContent:"center"}},uJ(this.legendElement));const{legendElement:e,hasIndicators:r,opacity:i}=this,s=e.infos,n=s.at(0),o=s.at(-1);if(!n||!o)return null;const{label:a,...l}=n,{label:c,...d}=o;let p=l.preview,m=d.preview;const y={"flex-direction":r?"column":"row-reverse"};if(!p||!m)return null;p=p.cloneNode(!0),p.style.display="flex",m=m.cloneNode(!0),m.style.display="flex";const g={opacity:`${i??""}`};return L("div",{class:this.classes(we.layerRow,{[we.sizeRampRow]:r})},L("div",{class:we.rampLabel},r?a:c),L("div",{class:we.sizeRampContainer,styles:y},L("div",{afterCreate:Ft,bind:p,class:we.sizeRampPreview,styles:g}),this._renderSizeRampLines(e),L("div",{afterCreate:Ft,bind:m,class:we.sizeRampPreview,styles:g})),L("div",{class:we.rampLabel},r?c:a))}_renderSizeRampLines(e){const r=e.infos,i=r.at(0),s=r.at(-1);if(!i||!s)return null;const n=i.symbol,o=this.hasIndicators,a=i.size&&typeof i.size=="number"?i.size:0,l=s.size&&typeof s.size=="number"?s.size:0,c=i.outlineSize||0,d=s.outlineSize||0,p=Pe(a+c)*tp,m=Pe(l+d)*tp,y=o?p:p+50*tp,g=o?p/2+50*tp:p,v=MLe(n),w=$Le(n),_=document.createElement("canvas");_.width=y,_.height=g,_.style.width=_.width/tp+"px",_.style.height=_.height/tp+"px";const x=_.getContext("2d");if(o){x.beginPath();const $=0,T=0,C=y/2-m/2,P=g;x.moveTo($,T),x.lineTo(C,P);const A=y,F=0,j=y/2+m/2,V=g;x.moveTo(A,F),x.lineTo(j,V)}else{x.beginPath();const $=0,T=g/2-m/2,C=y;x.moveTo($,T),x.lineTo(C,0);const A=0,F=g/2+m/2,j=y,V=g;x.moveTo(A,F),x.lineTo(j,V)}return x.strokeStyle=xLe,x.stroke(),L("div",{afterCreate:Ft,bind:_,styles:o?{display:"flex",marginTop:`-${v?0:w?p/2:0}px`,marginBottom:`-${v?m:w?m/2:0}px`}:{display:"flex",marginRight:`-${v?0:w?p/2:0}px`,marginLeft:`-${v?0:w?m/2:0}px`}})}};u([h()],mh.prototype,"hasIndicators",void 0),u([h()],mh.prototype,"legendElement",void 0),u([h()],mh.prototype,"messages",void 0),u([h()],mh.prototype,"opacity",void 0),mh=u([E("esri.widgets.Legend.styles.card.SizeRamp")],mh);const TLe=J1(),cJ=10,HL=20,fx=10,WL=20,ZL={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};function ILe(t="vertical"){const e="stroke:rgb(200, 200, 200);stroke-width:1";return t==="vertical"?L("svg",{height:"4",width:"10"},L("line",{style:e,x1:"0",x2:"10",y1:"2",y2:"2"})):L("svg",{height:"10",width:"10"},L("line",{style:e,x1:"5",x2:"5",y1:"0",y2:"10"}))}function ELe(t,e="vertical"){const r=document.createElement("div");return r.style.height=`${HL}px`,r.className=ZL.univariateAboveAndBelowSymbol,t!=null&&(r.style.opacity=t.toString()),TLe.append(r,ILe.bind(null,e)),r}function hJ(t,e,r="vertical",i){t.infos.forEach((s,n)=>{if(i&&n===2)s.preview=ELe(e,r);else{const o=(cd(s.size)?Pe(s.size):0)+(r==="horizontal"?WL:fx),a=s.preview,l=a?.tagName.toLowerCase()==="div",c=l?a:document.createElement("div");c.className=ZL.univariateAboveAndBelowSymbol,r==="horizontal"?c.style.width=`${o}px`:c.style.height=`${o}px`,!l&&a&&c.appendChild(a),s.preview=c}})}function mx(t,e="classic"){const r=t.infos,i=r.at(0),s=r.at(-1),n=cd(i.size)?Pe(i.size):0,o=cd(s.size)?Pe(s.size):0;return e==="classic"?(n+fx)/2:(n-o)/2}function km(t,e){if(!t)return null;const r=t.infos.map(s=>s.color),i=uh(e.type==="full"?r:e.type==="above"?r.slice(0,3):r.slice(2,5),{width:e.width,height:e.height,align:e.rampAlignment,cssEffectFilter:e.cssEffectFilter,ariaLabel:e.ariaLabel});return i.className=ZL.colorRamp,e.opacity!=null&&(i.style.opacity=e.opacity.toString()),i}function JL(t,e,r,i="vertical"){let s=0;const n=t.infos,o=Math.floor(n.length/2),a=e==="full"||e==="above"?0:o,l=e==="full"||e==="below"?n.length-1:o;for(let c=a;c<=l;c++)if(r&&c===o)s+=i==="horizontal"?cJ:HL;else{const d=n[c].size;s+=(cd(d)?Pe(d):0)+(i==="horizontal"?WL:fx)}return Math.round(s)}function Lm(t,e,r,i="vertical"){const s=JL(t,e,r,i),n=t.infos,o=Math.floor(n.length/2),a=e==="full"||e==="above"?0:o,l=e==="full"||e==="below"?n.length-1:o,c=cd(n[a].size)?n[a].size:0,d=cd(n[l].size)?n[l].size:0,p=e==="full"?c+d:e==="above"?c:d,m=r?i==="vertical"?HL:cJ:0,y=i==="vertical"?fx*(e==="full"?2:1):WL*(e==="full"?2:1);return Math.round(s-(Pe(p)/2+m/2+y/2))}function dJ(t,e,r="vertical"){const i=t.infos;let s=i.find(({type:o})=>o==="size-ramp"),n=i.find(({type:o})=>o==="color-ramp");return s&&(s={...s},s.infos=[...s.infos],hJ(s,e,r,!0)),n&&(n={...n},n.infos=[...n.infos]),r==="horizontal"&&(s?.infos.reverse(),n?.infos.reverse()),{sizeRampElement:s,colorRampElement:n}}function pJ(t,e="vertical"){const r=t.infos;let i=r.find(({type:n})=>n==="size-ramp"),s=r.find(({type:n})=>n==="color-ramp");return i&&(i={...i},i.infos=[...i.infos],hJ(i,null,e,!1)),s&&(s={...s},s.infos=[...s.infos]),e==="horizontal"&&(i?.infos.reverse(),s?.infos.reverse()),{sizeRampElement:i,colorRampElement:s}}const xC={marginLeft:"3px"},df={display:"table-cell",verticalAlign:"middle"},fJ={display:"flex",alignItems:"flex-start"};let yh=class extends gr{constructor(e,r){super(e,r),this.cssEffectFilter=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:r,cssEffectFilter:i,key:s}=this,{sizeRampElement:n,colorRampElement:o}=dJ(e,r,"horizontal");if(!n)return null;const a=JL(n,"full",!0,"horizontal"),l=Lm(n,"above",!0,"horizontal"),c=Lm(n,"below",!0,"horizontal"),d=12,p=this.messages?.previewColorRampAriaLabel,m=km(o,{width:l,height:d,rampAlignment:"horizontal",opacity:r,type:"above",cssEffectFilter:i,ariaLabel:p}),y=km(o,{width:c,height:d,rampAlignment:"horizontal",opacity:r,type:"below",cssEffectFilter:i,ariaLabel:p}),g=mx(n,"card"),v=n.infos.map(P=>P.label),w=v.length-1,_=v.map((P,A)=>A===0||A===w?L("div",{key:A},P):null),x={display:"flex",flexDirection:"column"},$={display:"flex",flexDirection:"row"},T={marginTop:"3px",display:"flex"};U2(this.container)?T.marginRight=`${g}px`:T.marginLeft=`${g}px`;const C={width:`${a}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return L("div",{class:we.layerRow,key:`${s}-container`,styles:x},L("div",{class:this.classes(we.symbolContainer,we.sizeRampHorizontal),styles:$},n.infos.map((P,A)=>L("div",{afterCreate:Ft,bind:P.preview,class:we.symbol,key:A}))),m?L("div",{class:we.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:T},L("div",{afterCreate:Ft,bind:m}),L("div",{afterCreate:Ft,bind:y})):null,L("div",{class:we.layerInfo},L("div",{class:we.rampLabelsContainer,styles:C},_)))}};u([h()],yh.prototype,"cssEffectFilter",void 0),u([h()],yh.prototype,"legendElement",void 0),u([h()],yh.prototype,"messages",void 0),u([h()],yh.prototype,"opacity",void 0),yh=u([E("esri.widgets.Legend.styles.card.UnivariateAboveAndBelowRamp")],yh);let gh=class extends gr{constructor(e,r){super(e,r),this.cssEffectFilter=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:r,cssEffectFilter:i,key:s}=this,{sizeRampElement:n,colorRampElement:o}=pJ(e,"horizontal");if(!n)return null;const a=JL(n,"full",!1,"horizontal"),l=Lm(n,"full",!1,"horizontal"),c=km(o,{width:l,height:12,rampAlignment:"horizontal",opacity:r,type:"full",cssEffectFilter:i,ariaLabel:this.messages?.previewColorRampAriaLabel}),d=mx(n,"card"),p=n.infos.length-1,m=n.infos.map((_,x)=>x===0||x===p?L("div",{key:x},_.label):null),y={display:"flex",flexDirection:"column"},g={display:"flex",flexDirection:"row"},v={marginTop:"3px",display:"flex"};U2(this.container)?v.marginRight=`${d}px`:v.marginLeft=`${d}px`;const w={width:`${a}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return L("div",{class:we.layerRow,key:`${s}-container`,styles:y},L("div",{class:this.classes(we.symbolContainer,we.sizeRampHorizontal),styles:g},n.infos.map((_,x)=>L("div",{afterCreate:Ft,bind:_.preview,class:we.symbol,key:x}))),L("div",{class:we.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:v},L("div",{afterCreate:Ft,bind:c})),L("div",{class:we.layerInfo},L("div",{class:we.rampLabelsContainer,styles:w},m)))}};u([h()],gh.prototype,"cssEffectFilter",void 0),u([h()],gh.prototype,"legendElement",void 0),u([h()],gh.prototype,"messages",void 0),u([h()],gh.prototype,"opacity",void 0),gh=u([E("esri.widgets.Legend.styles.card.UnivariateColorSizeRamp")],gh);function i1({level:t,class:e,...r},i){const s=mJ(t);return L(`h${s}`,{...r,"aria-level":String(s),class:af(Vr.heading,e),role:"heading"},i)}function mJ(t){return Qr(Math.ceil(t),1,6)}function CLe(t,e=1){return mJ(t+e)}var $C;let Ks=$C=class extends gr{constructor(t,e){super(t,e),this.cssEffectFilter=null,this.hasIndicators=!1,this.headingLevel=3,this.isChild=!1,this.legendElement=null}render(){const t=this._renderLegendElement(),e=aJ(this.legendElement,this.messages),r=this.hasIndicators&&!this.isChild?L("div",null,L(i1,{class:we.carouselTitle,level:this.headingLevel},this.activeLayerInfo.title),L(i1,{class:we.layerCaption,level:CLe(this.headingLevel)},e)):e?L(i1,{class:we.layerCaption,level:this.headingLevel},e):null;return L("section",{"aria-labelledby":this.key,class:we.section,id:`${this.key}-panel`,key:this.key,role:"tabpanel",tabIndex:0},r,t)}_renderLegendElement(){switch(this.legendElement.type){case"symbol-table":return this._renderSymbolTable(this.legendElement);case"size-ramp":return L(mh,{hasIndicators:this.hasIndicators,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":return L(fh,{cssEffectFilter:this.cssEffectFilter,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"relationship-ramp":return RW(this.legendElement,this.id,{opacity:this.layer.opacity,cssEffectFilter:this.cssEffectFilter,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:this.key});case"pie-chart-ramp":{const{preview:t}=this.legendElement;if(!t)return null;const e=va(this.messages.previewPieChartAriaLabel,{label:null});return e&&t.querySelector("svg")?.setAttribute("aria-label",e),L("div",{afterCreate:Ft,bind:t,class:we.pieChartRampPreview,key:`${this.key}-preview`})}case"univariate-above-and-below-ramp":return L(yh,{cssEffectFilter:this.cssEffectFilter,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"univariate-color-size-ramp":return L(gh,{cssEffectFilter:this.cssEffectFilter,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});default:return null}}_renderSymbolTable(t){const e=t.infos.map(n=>this._renderElementInfo(n,t.legendType)).filter(Boolean);if(!e.length)return null;const r=this.activeLayerInfo.legendElements.some(({type:n})=>n==="relationship-ramp"),i=e[0]?.properties?.classes?.[we.symbolRow],s={[we.labelContainer]:!i&&!r,[we.relationshipLabelContainer]:r};return L("div",{class:this.classes(s)},e)}_renderElementInfo(t,e){const{layer:r}=this,i="label"in t?t.label:null,s=`${this.key}-${i}`;if("type"in t&&t.type)return L($C,{activeLayerInfo:this.activeLayerInfo,cssEffectFilter:this.cssEffectFilter,hasIndicators:this.hasIndicators,headingLevel:this.headingLevel,isChild:!0,key:s,layer:r,legendElement:t,messages:this.messages});if(!("preview"in t&&t.preview||"src"in t&&t.src))return null;const n=nJ(r,e),o=Ml(this.messages,i,!1)||"";if("src"in t&&t.src)return L("div",{class:we.layerRow,key:`${s}-row`},this._renderImage(t,r,n),L("div",{class:we.imageLabel},o));if("symbol"in t&&t.preview){if(!t.symbol?.type.includes("simple-fill")){if(!t.label)return L("div",{afterCreate:Ft,bind:t.preview,key:`${s}-row`});const a={[we.symbolCell]:this.hasIndicators},{preview:l}=t,c="previewAriaLabel"in t?t.previewAriaLabel:null,d="label"in t?Ml(this.messages,t.label,!1):null,p=l.querySelector("svg"),m=FS(this.messages,c||d);return m&&p&&p.setAttribute("aria-label",m),L("div",{class:this.classes(we.layerRow,{[we.symbolRow]:this.hasIndicators}),key:`${s}-row`},L("div",{afterCreate:Ft,bind:l,class:this.classes(a)}),L("div",{class:this.classes(we.imageLabel,{[we.labelCell]:this.hasIndicators})},o))}return L("div",{class:we.layerRow,key:`${s}-row`},L("div",{class:we.labelElement,styles:this._getBackgroundStyles(t)},o))}return null}_getBackgroundStyles(t){const e=t.symbol,r=e.color,i=!!r?.a,s="outline"in e?e.outline:null,n=!!s?.color?.a,o=new K(i&&r?[r.r,r.g,r.b,r.a*this.layer.opacity]:[255,255,255,0]),a=n&&s.color?new K([s.color.r,s.color.g,s.color.b,s.color.a*this.layer.opacity]):new K([255,255,255,0]),l=t.symbol.color?.isBright??!0,c=l?"black":"white",d=l?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return{background:i?o.toCss(!0):"none",color:c,textShadow:`-1px -1px 0 ${d},
                  1px -1px 0 ${d},
                  -1px 1px 0 ${d},
                  1px 1px 0 ${d}`,border:n?`1px solid ${a.toCss(!0)}`:"none",filter:this.cssEffectFilter??void 0}}_renderImage(t,e,r){const{previewAriaLabel:i,src:s,opacity:n}=t,o=Ml(this.messages,t.label,!1),a={[we.imageryLayerStretchedImage]:r,[we.symbol]:!r},l={opacity:`${n??e.opacity}`},c=FS(this.messages,i||o);return L("img",{alt:c,"aria-label":c,border:0,class:this.classes(a),height:t.height,src:s,styles:l,width:t.width})}};u([h()],Ks.prototype,"activeLayerInfo",void 0),u([h()],Ks.prototype,"cssEffectFilter",void 0),u([h()],Ks.prototype,"hasIndicators",void 0),u([h()],Ks.prototype,"headingLevel",void 0),u([h()],Ks.prototype,"isChild",void 0),u([h()],Ks.prototype,"layer",void 0),u([h()],Ks.prototype,"legendElement",void 0),u([h()],Ks.prototype,"messages",void 0),Ks=$C=u([E("esri.widgets.Legend.styles.card.LegendElement")],Ks);const PLe=768;let en=class extends gr{constructor(e,r){super(e,r),this._hasIndicators=!1,this.activeLayerInfos=null,this.headingLevel=3,this.layout="stack",this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}loadDependencies(){return xd({carousel:()=>q(()=>import("./index-BnoFR9kl.js"),__vite__mapDeps([321,282,283,279,284,322,323,285,288,324,280,281,291,290])),"carousel-item":()=>q(()=>import("./index-CT2beQaK.js"),__vite__mapDeps([325,279]))})}render(){this._hasIndicators=this.layout==="auto"&&this.view&&this.view.container.clientWidth<=PLe||this.layout==="stack";const e=this._hasIndicators?this._renderCarousel():this._renderLayers(),r={[we.stacked]:this._hasIndicators};return L("div",{class:this.classes(we.base,r)},e||L("div",{class:we.message},this.messages.noLegend))}_renderCarousel(){const e=[],r=this.activeLayerInfos;if(r)for(const i of r)this._renderSections(i,e);return e?.length?L("calcite-carousel",{class:we.carousel,label:this.messages.carousel},e.map((i,s)=>L("calcite-carousel-item",{class:we.carouselItem,key:s,label:va(this.messagesCommon.pagination.pageText,{index:s+1,total:e.length})},i))):null}_renderLayers(){const e=this.activeLayerInfos,r=e?.toArray()?.map(i=>this._renderLegendForLayer(i)).filter(Boolean);return r?.length?r:null}_renderLegendForLayer(e){if(!e.ready)return null;if(e.children.length){const r=e.children.toArray().map(this._renderLegendForLayer,this);return L("section",{class:this.classes(we.service,we.groupLayer),key:e.layer.uid},L("div",{class:we.serviceCaptionContainer},e.title),r)}return this._renderLegendElementsForLayer(e)}_renderLegendElementsForLayer(e){const r=e.legendElements?.filter(Boolean);if(!r?.length)return null;const i=r.map(n=>L(Ks,{activeLayerInfo:e,cssEffectFilter:e.cssEffectFilter,hasIndicators:this._hasIndicators,headingLevel:this.headingLevel,isChild:!1,key:`${e.layer.uid}-${n.type}`,layer:e.layer,legendElement:n,messages:this.messages})),s={[we.groupLayerChild]:!!e.parent};return L("section",{class:this.classes(we.service,s),key:e.layer.uid},L("div",{class:we.serviceCaptionContainer},L("div",{class:we.serviceCaptionText},e.title)),L("div",{class:we.serviceContent},i))}_renderSections(e,r){if(!e.ready)return;if(e.children.length)for(const s of e.children)this._renderSections(s,r);const i=e.legendElements;if(i?.length)for(const s of i){const n=L(Ks,{activeLayerInfo:e,cssEffectFilter:e.cssEffectFilter,hasIndicators:this._hasIndicators,headingLevel:this.headingLevel,isChild:!1,key:`${e.layer.uid}-${s.type}`,layer:e.layer,legendElement:s,messages:this.messages});n&&r.push(n)}}};u([h()],en.prototype,"activeLayerInfos",void 0),u([h()],en.prototype,"headingLevel",void 0),u([h()],en.prototype,"layout",void 0),u([h(),js("esri/widgets/Legend/t9n/Legend")],en.prototype,"messages",void 0),u([h(),js("esri/t9n/common")],en.prototype,"messagesCommon",void 0),u([h({readOnly:!0})],en.prototype,"type",void 0),u([h()],en.prototype,"view",void 0),en=u([E("esri.widgets.Legend.styles.card.CardView")],en);const vt="esri-legend",be={service:`${vt}__service`,label:`${vt}__service-label`,layer:`${vt}__layer`,groupLayer:`${vt}__group-layer`,groupLayerChild:`${vt}__group-layer-child`,layerTable:`${vt}__layer-table`,layerTableSizeRamp:`${vt}__layer-table--size-ramp`,layerChildTable:`${vt}__layer-child-table`,layerCaption:`${vt}__layer-caption`,layerBody:`${vt}__layer-body`,layerRow:`${vt}__layer-row`,layerInfo:`${vt}__layer-cell ${vt}__layer-cell--info`,imageryLayerStretchedImage:`${vt}__imagery-layer-image--stretched`,imageryLayerInfoStretched:`${vt}__imagery-layer-info--stretched`,symbolContainer:`${vt}__layer-cell ${vt}__layer-cell--symbols`,symbol:`${vt}__symbol`,rampContainer:`${vt}__ramps`,sizeRamp:`${vt}__size-ramp`,colorRamp:`${vt}__color-ramp`,opacityRamp:`${vt}__opacity-ramp`,rampLabelsContainer:`${vt}__ramp-labels`,rampLabel:`${vt}__ramp-label`,message:`${vt}__message`,univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"},kLe=24;let vh=class extends gr{constructor(e,r){super(e,r),this.legendElement=null,this.opacity=1}get _preview(){const e=this.legendElement.preview;if(!e)return null;const r=this.legendElement.type==="opacity-ramp"?be.opacityRamp:"";return e.className=`${be.colorRamp} ${r}`,this.opacity!=null&&(e.style.opacity=this.opacity.toString()),e}render(){const{legendElement:e,_preview:r}=this;if(!r)return null;const i={width:`${kLe}px`},s={height:r.style.height},n=va(this.messages.previewColorRampAriaLabel,{label:null});return n&&r.querySelector("svg")?.setAttribute("aria-label",n),L("div",{class:be.layerRow,key:`${this.key}-row`},L("div",{class:be.symbolContainer,styles:i},L("div",{afterCreate:Ft,bind:r,class:be.rampContainer})),L("div",{class:be.layerInfo},L("div",{class:be.rampLabelsContainer,styles:s},e.infos.map((o,a)=>this._renderRampLabel(o,a,e.type)))))}_renderRampLabel(e,r,i){return L("div",{class:e.label?be.rampLabel:void 0,key:`${this.key}-stop-${e.label??r}-label`},oJ(e,i,this.messages))}};u([h()],vh.prototype,"_preview",null),u([h()],vh.prototype,"legendElement",void 0),u([h()],vh.prototype,"messages",void 0),u([h()],vh.prototype,"opacity",void 0),vh=u([E("esri.widgets.Legend.styles.classic.ColorRamp")],vh);let Jg=class extends gr{constructor(e,r){super(e,r),this.legendElement=null}render(){const e=this.legendElement.infos.map(r=>this._renderRow(r)).filter(Boolean);return e.length?this.legendElement.theme==="spike"?uJ(this.legendElement):L("div",{class:be.layerBody},e):null}_renderRow(e){return e.preview?L("div",{class:be.layerRow,key:`${this.key}-${e.label}-row`},L("div",{class:this.classes(be.symbolContainer,be.sizeRamp)},L("div",{afterCreate:Ft,bind:e.preview,class:be.symbol})),L("div",{class:be.layerInfo},Ml(this.messages,e.label,!1)||"")):null}};u([h()],Jg.prototype,"legendElement",void 0),u([h()],Jg.prototype,"messages",void 0),Jg=u([E("esri.widgets.Legend.styles.classic.SizeRamp")],Jg);let wh=class extends gr{constructor(e,r){super(e,r),this.cssEffectFilter=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:r,cssEffectFilter:i,key:s}=this,{sizeRampElement:n,colorRampElement:o}=dJ(e,r);if(!n)return null;const a=this.messages.previewColorRampAriaLabel,l=Lm(n,"above",!0),c=Lm(n,"below",!0),d=12,p=km(o,{width:d,height:l,rampAlignment:"vertical",opacity:r,type:"above",cssEffectFilter:i,ariaLabel:a}),m=km(o,{width:d,height:c,rampAlignment:"vertical",opacity:r,type:"below",cssEffectFilter:i,ariaLabel:a}),y=mx(n),g=n.infos.map(A=>A.label),v=g.map((A,F)=>F===0?L("div",{class:A?p?be.univariateAboveAndBelowLabel:be.rampLabel:void 0,key:`${s}-color-ramp-above-label-${A??F}`},A):F===2?L("div",null):null),w=g.length-1,_=Math.floor(g.length/2),x=g.map((A,F)=>F===_||F===w?L("div",{class:A?p?be.univariateAboveAndBelowLabel:be.rampLabel:void 0,key:`${s}-color-ramp-below-label-${A??F}`},A):null),$={display:"table-cell",verticalAlign:"middle"},T={marginTop:`${y}px`},C={height:`${l}px`},P={height:`${c}px`};return L("div",{key:`${s}-container`,styles:fJ},L("div",{class:be.layerBody},n.infos.map((A,F)=>L("div",{class:this.classes(be.layerRow,be.sizeRamp),key:`${s}-row-${F}`},L("div",{afterCreate:Ft,bind:A.preview,class:be.symbol,styles:$}),p||F%2!=0?null:L("div",{class:be.layerInfo},g[F])))),p?L("div",{styles:T},L("div",{styles:xC},L("div",{styles:df},L("div",{afterCreate:Ft,bind:p,class:be.rampContainer})),L("div",{styles:df},L("div",{class:be.rampLabelsContainer,styles:C},v))),L("div",{styles:xC},L("div",{styles:df},L("div",{afterCreate:Ft,bind:m,class:be.rampContainer})),L("div",{styles:df},L("div",{class:be.rampLabelsContainer,styles:P},x)))):null)}};u([h()],wh.prototype,"cssEffectFilter",void 0),u([h()],wh.prototype,"legendElement",void 0),u([h()],wh.prototype,"messages",void 0),u([h()],wh.prototype,"opacity",void 0),wh=u([E("esri.widgets.Legend.styles.classic.UnivariateAboveAndBelowRamp")],wh);let _h=class extends gr{constructor(e,r){super(e,r),this.cssEffectFilter=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:r,cssEffectFilter:i,key:s}=this,{sizeRampElement:n,colorRampElement:o}=pJ(e);if(!n)return null;const a=mx(n),l=12,c=Lm(n,"full",!1),d=km(o,{width:l,height:c,rampAlignment:"vertical",opacity:r,type:"full",cssEffectFilter:i,ariaLabel:this.messages?.previewColorRampAriaLabel}),p=n.infos.length-1,m=n.infos.map((w,_)=>_===0||_===p?L("div",{class:w.label?o?be.univariateAboveAndBelowLabel:be.rampLabel:void 0,key:`${s}-color-ramp-label-${w.label??_}`},w.label):null),y={display:"table-cell",verticalAlign:"middle"},g={marginTop:`${a}px`},v={height:`${c}px`};return L("div",{key:`${s}-container`,styles:fJ},L("div",{class:be.layerBody},n.infos.map((w,_)=>L("div",{class:this.classes(be.layerRow,be.sizeRamp),key:`${s}-row-${_}`},L("div",{afterCreate:Ft,bind:w.preview,class:be.symbol,styles:y})))),L("div",{styles:g},L("div",{styles:xC},L("div",{styles:df},L("div",{afterCreate:Ft,bind:d,class:be.rampContainer})),L("div",{styles:df},L("div",{class:be.rampLabelsContainer,styles:v},m)))))}};u([h()],_h.prototype,"cssEffectFilter",void 0),u([h()],_h.prototype,"legendElement",void 0),u([h()],_h.prototype,"messages",void 0),u([h()],_h.prototype,"opacity",void 0),_h=u([E("esri.widgets.Legend.styles.classic.UnivariateColorSizeRamp")],_h);var MC;let vu=MC=class extends gr{constructor(t,e){super(t,e),this.cssEffectFilter=null,this.isChild=!1,this.legendElement=null}render(){const t=this._renderLegendElement(),e=aJ(this.legendElement,this.messages),r=this.isChild?be.layerChildTable:be.layerTable,i=e?L("div",{class:be.layerCaption},e):null,s={[be.layerTableSizeRamp]:this.legendElement.type==="size-ramp"||!this.isChild};return L("section",{class:this.classes(r,s),key:`${this.key}-table`},i,t)}_renderLegendElement(){switch(this.legendElement.type){case"symbol-table":return this._renderSymbolTable(this.legendElement);case"size-ramp":return L(Jg,{key:this.key,legendElement:this.legendElement,messages:this.messages});case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":return L(vh,{key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"relationship-ramp":return RW(this.legendElement,this.id,{opacity:this.layer.opacity,cssEffectFilter:this.cssEffectFilter,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:this.key});case"pie-chart-ramp":{const{preview:t}=this.legendElement;if(!t)return null;const e=va(this.messages.previewPieChartAriaLabel,{label:null});return e&&t.querySelector("svg")?.setAttribute("aria-label",e),L("div",{afterCreate:Ft,bind:t,key:`${this.key}-preview`})}case"univariate-above-and-below-ramp":return L(wh,{cssEffectFilter:this.cssEffectFilter,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"univariate-color-size-ramp":return L(_h,{cssEffectFilter:this.cssEffectFilter,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});default:return null}}_renderSymbolTable(t){const e=t.infos.map(r=>this._renderElementInfo(r,t.legendType)).filter(Boolean);return e.length?L("div",{class:be.layerBody},e):null}_renderElementInfo(t,e){const{layer:r}=this,i="label"in t?t.label:null,s=`${this.key}-${i}`;if("type"in t&&t.type)return L(MC,{cssEffectFilter:this.cssEffectFilter,isChild:!0,key:s,layer:r,legendElement:t,messages:this.messages});if(!("preview"in t&&t.preview||"src"in t&&t.src))return null;const n=nJ(r,e),o={[be.imageryLayerInfoStretched]:n},a={[be.imageryLayerInfoStretched]:n};return L("div",{class:be.layerRow,key:`${s}-row`},L("div",{class:this.classes(be.symbolContainer,a)},this._renderPreview(t,n)),L("div",{class:this.classes(be.layerInfo,o)},Ml(this.messages,i,!1)||""))}_renderPreview(t,e){const{layer:r}=this;if("preview"in t&&t.preview){const{preview:i}=t,s="previewAriaLabel"in t?t.previewAriaLabel:null,n="label"in t?Ml(this.messages,t.label,!1):null,o=i.querySelector("svg"),a=FS(this.messages,s||n);return a&&o&&o.setAttribute("aria-label",a),L("div",{afterCreate:Ft,bind:i,class:be.symbol})}return"src"in t&&t.src?this._renderImage(t,r,e):null}_renderImage(t,e,r){const{previewAriaLabel:i,src:s,opacity:n}=t,o=Ml(this.messages,t.label,!1),a={[be.imageryLayerStretchedImage]:r,[be.symbol]:!r},l={opacity:`${n??e.opacity}`},c=FS(this.messages,i||o);return L("img",{alt:c,"aria-label":c,border:0,class:this.classes(a),height:t.height,src:s,styles:l,width:t.width})}};u([h()],vu.prototype,"cssEffectFilter",void 0),u([h()],vu.prototype,"isChild",void 0),u([h()],vu.prototype,"layer",void 0),u([h()],vu.prototype,"legendElement",void 0),u([h()],vu.prototype,"messages",void 0),vu=MC=u([E("esri.widgets.Legend.styles.classic.LegendElement")],vu);const LLe=`${vt}__`;let on=class extends gr{constructor(e,r){super(e,r),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const e=this.activeLayerInfos,r=e?.toArray().map(i=>this._renderLegendForLayer(i)).filter(Boolean);return r?.length?L("section",null,r):L("div",{class:be.message,key:"no-legend"},this.messages.noLegend)}_renderLegendForLayer(e,r){if(!e.ready)return null;const i=`${e.layer.uid}-version-${e.version}`,s=`${LLe}${r?`${r}-`:""}${i}`,n=e.title?i1({level:this.headingLevel,class:this.classes(Vr.heading,be.label)},e.title):null;if(e.children.length){const o=e.children.toArray().map(a=>this._renderLegendForLayer(a,i));return L("section",{class:this.classes(be.service,be.groupLayer),key:s},n,o)}return this._renderLegendElementsForLayer(e,n,s)}_renderLegendElementsForLayer(e,r,i){const s=e.legendElements?.filter(Boolean);if(!s?.length)return null;const n=s.map(a=>L(vu,{cssEffectFilter:e.cssEffectFilter,isChild:!1,key:`${i}-${a.type}`,layer:e.layer,legendElement:a,messages:this.messages})),o={[be.groupLayerChild]:!!e.parent};return L("section",{class:this.classes(be.service,o),key:i},r,L("div",{class:be.layer},n))}};u([h()],on.prototype,"activeLayerInfos",void 0),u([h()],on.prototype,"headingLevel",void 0),u([h(),js("esri/widgets/Legend/t9n/Legend")],on.prototype,"messages",void 0),u([h({readOnly:!0})],on.prototype,"type",void 0),on=u([E("esri.widgets.Legend.styles.classic.ClassicView")],on);const ALe={base:"esri-legend"};let Sr=class extends gr{constructor(e,r){super(e,r),this.headingLevel=3,this.messages=null,this.viewModel=new ts,this.style=new on,WS(U.getLogger(this),"Legend","arcgis-legend",{version:"4.34"})}initialize(){this.addHandles([pn(()=>this.view,"resize",()=>this.scheduleRender()),pn(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),ie(()=>this.headingLevel,e=>{const{style:r}=this;r&&(r.headingLevel=e)}),ie(()=>this.style,(e,r)=>{r&&e!==r&&r.destroy(),e&&(e.activeLayerInfos=this.activeLayerInfos,e.type==="card"&&(e.view=this.view),e.headingLevel=this.headingLevel)},ft)])}destroy(){this.style?.destroy()}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(e){this.viewModel.activeLayerInfos=e}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(e){this.viewModel.basemapLegendVisible=e}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(e){this.viewModel.groundLegendVisible=e}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(e){this.viewModel.hideLayersNotInCurrentView=e}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(e){this.viewModel.keepCacheOnDestroy=e}get respectLayerDefinitionExpression(){return this.viewModel.respectLayerDefinitionExpression}set respectLayerDefinitionExpression(e){this.viewModel.respectLayerDefinitionExpression=e}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(e){this.viewModel.respectLayerVisibility=e}get icon(){return"legend"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}set style(e){const r=this._get("style");e!==r&&r?.destroy(),this._set("style",e)}castStyle(e){if(e instanceof en||e instanceof on)return e;if(typeof e=="string")return e==="card"?new en:new on;if(e&&typeof e.type=="string"){const r={...e};return delete r.type,e.type==="card"?new en(r):new on(r)}return new on}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return L("div",{class:this.classes(ALe.base,Vr.widget,this.style instanceof on?Vr.panel:null)},this.style.render())}_refreshActiveLayerInfos(e){e.forEach(r=>{this.removeHandles(`version_${r.layer.uid}`),this._renderOnActiveLayerInfoChange(r)}),this.scheduleRender()}_renderOnActiveLayerInfoChange(e){const r=ie(()=>e.version,()=>this.scheduleRender());this.addHandles(r,`version_${e.layer.uid}`);const i=pn(()=>e.children,"change",()=>e.children.forEach(s=>this._renderOnActiveLayerInfoChange(s)),ft);this.addHandles(i,`version_${e.layer.uid}`),e.children.forEach(s=>this._renderOnActiveLayerInfoChange(s))}};u([h()],Sr.prototype,"activeLayerInfos",null),u([h()],Sr.prototype,"basemapLegendVisible",null),u([h()],Sr.prototype,"groundLegendVisible",null),u([h()],Sr.prototype,"headingLevel",void 0),u([h()],Sr.prototype,"hideLayersNotInCurrentView",null),u([h()],Sr.prototype,"keepCacheOnDestroy",null),u([h()],Sr.prototype,"respectLayerDefinitionExpression",null),u([h()],Sr.prototype,"respectLayerVisibility",null),u([h()],Sr.prototype,"icon",null),u([h()],Sr.prototype,"label",null),u([h()],Sr.prototype,"layerInfos",null),u([h(),js("esri/widgets/Legend/t9n/Legend")],Sr.prototype,"messages",void 0),u([h()],Sr.prototype,"style",null),u([He("style")],Sr.prototype,"castStyle",null),u([h()],Sr.prototype,"view",null),u([h()],Sr.prototype,"viewModel",void 0),Sr=u([E("esri.widgets.Legend")],Sr);const RLe=Sr;let wu=class extends le{constructor(e){super(e),this._viewpointHandle=null,this.group=null}initialize(){this.addHandles(pn(()=>this.view?.ui,"expand",e=>{const{target:r}=e;r&&r!==this&&r.expanded&&r.group&&r.group===this.group&&this._collapse()}))}destroy(){this._viewpointHandle=null,this.view=null}set autoCollapse(e){this._set("autoCollapse",e),this._watchViewpoint()}set expanded(e){const r=!!e;this._set("expanded",r);const i=this.view?.ui;i&&i.emit("expand",{target:this}),this._viewpointHandleChange(r)}get state(){return this.view?.ready?"ready":"disabled"}set view(e){this._get("view")!==e&&(this._set("view",e),e&&Ti(()=>e.ready,()=>{this.view===e&&this._watchViewpoint()},{once:!0,initial:!0}))}_viewpointHandleChange(e){this._viewpointHandle&&(e?Ti(()=>this.view?.stationary,()=>this._viewpointHandle?.resume(),{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const e="viewpoint";this.removeHandles(e),this._viewpointHandle=null;const{autoCollapse:r,view:i}=this;if(!i||!r)return;const s=Mse(()=>i.type==="3d"?i.camera:i.viewpoint,()=>this._collapse());this.addHandles(s,e),this._viewpointHandle=s}_collapse(){this.expanded=!1}};u([h({value:!1})],wu.prototype,"autoCollapse",null),u([h({value:!1})],wu.prototype,"expanded",null),u([h()],wu.prototype,"group",void 0),u([h({readOnly:!0})],wu.prototype,"state",null),u([h({value:null})],wu.prototype,"view",null),wu=u([E("esri.widgets.Expand.ExpandViewModel")],wu);const yJ=wu;function OLe(t){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const r=e._delegatedEventNames;t=Array.isArray(t)?t:FLe(t),r.push(...t)}}function FLe(t){return t.split(",").map(e=>e.trim())}function NLe(t){return t&&typeof t.render=="function"}function DLe(t){return t&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}const su="esri-expand",ys={base:su,toggle:`${su}__toggle`,popoverContent:`${su}__popover-content`,panel:`${su}__panel`,panelContent:`${su}__panel-content`,sheet:`${su}__sheet`,contentContainer:`${su}__content-container`,icon:"esri-collapse__icon",iconFlip:"esri-collapse__icon-flip",iconNumber:`${su}__icon-number`},q4="chevrons-left",B4="chevrons-right",SM=Symbol("scheduleRender-override-handle");let Mt=class extends gr{constructor(e,r){super(e,r),this._boundScheduledRender=this.scheduleRender.bind(this),this.closeOnEsc=!0,this.collapseTooltip="",this.content="",this.expandTooltip="",this.focusTrapDisabled=!1,this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.placement=null,this.viewModel=new yJ,this.toggle=()=>{this.viewModel.expanded=!this.viewModel.expanded},this._handlePopoverClose=i=>{i.target===this._popoverEl&&(this.viewModel.expanded=i.currentTarget.open)},this._handleSheetClose=i=>{this.viewModel.expanded=i.currentTarget.open},this._handlePanelClose=i=>{this.viewModel.expanded=!i.currentTarget.closed},this._handleKeyDown=i=>{this.viewModel.expanded&&i.key==="Escape"&&!this._willCloseOnEsc(i)&&i.preventDefault()},this._storeToggleActionEl=i=>{this._toggleActionEl=i},this._storePopoverEl=i=>{this._popoverEl=i},WS(U.getLogger(this),"Expand","arcgis-expand",{version:"4.34"})}initialize(){this.addHandles(ie(()=>this.viewModel?.view?.size,()=>this._popoverEl?.reposition(),ft))}loadDependencies(){return xd({action:()=>q(()=>import("./index-BdQQ8ic0.js"),__vite__mapDeps([326,278,279,280,281,282,283,284,327,285,288,290,291,287])),icon:()=>q(()=>import("./index-CROBEgSo.js").then(e=>e.i),__vite__mapDeps([282,283,279,284])),panel:()=>q(()=>import("./index-CIC5MAaM.js").then(e=>e.i),__vite__mapDeps([328,282,283,279,284,278,280,281,326,327,285,288,290,291,287,329,330,331,332,286,333,334,335,336,324,337])),popover:()=>q(()=>import("./index-BcXLn2Hw.js").then(e=>e.i),__vite__mapDeps([329,278,279,280,281,282,283,284,326,327,285,288,290,291,287,330,331,332,286,333,334,335])),sheet:()=>q(()=>import("./index-CL2ntcgm.js"),__vite__mapDeps([338,278,279,280,281,337,285,284,283,282,327,339,332,340,334,291,290]))})}get expandTitle(){const{expanded:e,messagesCommon:r,collapseTooltip:i,expandTooltip:s}=this;return(e?i||r?.collapse:s||r?.expand)??""}get _displaySheet(){switch(this.mode){case"drawer":return!0;case"auto":return this.viewModel.view?.widthBreakpoint==="xsmall";default:return!1}}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(e){this.viewModel.autoCollapse=e}get collapseIcon(){return B4}set collapseIcon(e){this._overrideIfSome("collapseIcon",e)}get expanded(){return this.viewModel.expanded}set expanded(e){this.viewModel.expanded=e}get expandIcon(){return typeof this.content=="object"&&"icon"in this.content&&this.content.icon?this.content.icon:q4}set expandIcon(e){this._overrideIfSome("expandIcon",e)}get group(){return this.viewModel.group}set group(e){this.viewModel.group=e}get icon(){return null}get label(){return typeof this.content=="object"&&"label"in this.content&&this.content.label?this.content.label:this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}render(){const{_displaySheet:e,_toggleActionEl:r,viewModel:{expanded:i},label:s,placement:n}=this;return L("div",{class:this.classes(ys.base,Vr.widget)},this._renderToggle(),e?L("calcite-sheet",{class:ys.sheet,heightScale:"l",label:s,onkeydown:this._handleKeyDown,open:i,position:"block-end",onCalciteSheetClose:this._handleSheetClose},L("calcite-panel",{class:ys.panel,closable:!0,closed:!i,heading:s,onkeydown:this._handleKeyDown,onCalcitePanelClose:this._handlePanelClose},L("div",{class:ys.panelContent},this._renderContent()))):r?L("calcite-popover",{afterCreate:this._storePopoverEl,afterUpdate:this._storePopoverEl,focusTrapDisabled:this.focusTrapDisabled,label:s,onkeydown:this._handleKeyDown,open:i,overlayPositioning:"fixed",placement:n??this._getPlacement(),referenceElement:r,onCalcitePopoverClose:this._handlePopoverClose},L("div",{class:ys.popoverContent},this._renderContent())):null)}_getPlacement(){const{container:e,view:r}=this,i=e&&r?r.ui.getPosition(e):null;if(!i||i==="manual")return"auto";const[s,n]=i.split("-");return`${n==="right"?"left":"right"}-${s==="bottom"?"end":"start"}`}_willCloseOnEsc(e){const{closeOnEsc:r}=this;return typeof r=="function"?r(e):r}_renderBadgeNumber(){const{expanded:e,iconNumber:r}=this;return r&&!e?L("span",{class:ys.iconNumber,key:"expand__icon-number"},r):null}_renderToggleButton(){const{expanded:e,expandTitle:r,expandIcon:i,collapseIcon:s}=this,n=e?s:i,o=n===q4||n===B4;return L("calcite-action",{afterCreate:this._storeToggleActionEl,afterUpdate:this._storeToggleActionEl,class:Vr.widgetButton,onclick:this.toggle,scale:"s",text:r,title:r},n?L("calcite-icon",{class:this.classes(ys.icon,o&&ys.iconFlip),icon:n,scale:"s"}):null)}_renderToggle(){return L("div",{class:ys.toggle},this._renderToggleButton(),this._renderBadgeNumber())}_renderContent(){const{content:e}=this;return typeof e=="string"?L("div",{class:ys.contentContainer,innerHTML:e,key:"content__string"}):NLe(e)?L("div",{afterCreate:()=>{this._overwriteChildScheduleRender(e)},afterRemoved:()=>this.removeHandles(SM),afterUpdate:()=>{e.scheduleRender!==this._boundScheduledRender&&(this.removeHandles(SM),this._overwriteChildScheduleRender(e))},class:ys.contentContainer,key:"content__widget"},e.render()):e instanceof HTMLElement?L("div",{afterCreate:this._attachToNode,bind:e,class:ys.contentContainer,key:"content__html-element"}):DLe(e)?L("div",{afterCreate:this._attachToNode,bind:e.domNode,class:ys.contentContainer,key:"content__node"}):null}_overwriteChildScheduleRender(e){const r=e.scheduleRender;e.scheduleRender=this._boundScheduledRender,this.addHandles(je(()=>e.scheduleRender=r),SM)}_attachToNode(e){const r=this;e.appendChild(r)}};u([h({readOnly:!0})],Mt.prototype,"expandTitle",null),u([h()],Mt.prototype,"_toggleActionEl",void 0),u([h()],Mt.prototype,"_displaySheet",null),u([h()],Mt.prototype,"autoCollapse",null),u([h()],Mt.prototype,"closeOnEsc",void 0),u([h()],Mt.prototype,"collapseIcon",null),u([h()],Mt.prototype,"collapseTooltip",void 0),u([h()],Mt.prototype,"content",void 0),u([h()],Mt.prototype,"expanded",null),u([h()],Mt.prototype,"expandIcon",null),u([h()],Mt.prototype,"expandTooltip",void 0),u([h()],Mt.prototype,"focusTrapDisabled",void 0),u([h()],Mt.prototype,"group",null),u([h()],Mt.prototype,"icon",null),u([h()],Mt.prototype,"iconNumber",void 0),u([h()],Mt.prototype,"label",null),u([h(),js("esri/widgets/Expand/t9n/Expand")],Mt.prototype,"messages",void 0),u([h(),js("esri/t9n/common")],Mt.prototype,"messagesCommon",void 0),u([h()],Mt.prototype,"mode",void 0),u([h()],Mt.prototype,"placement",void 0),u([h()],Mt.prototype,"view",null),u([h({type:yJ})],Mt.prototype,"viewModel",void 0),Mt=u([E("esri.widgets.Expand")],Mt);const zLe=Mt,rp="esri-search",Dc={base:rp,autocomplete:`${rp}__autocomplete`,dropdown:`${rp}__dropdown`,container:`${rp}__container`,form:`${rp}__form`,submitButton:`${rp}__submit-button`},H4="esri-search-result-renderer",W4={base:H4,moreResults:`${H4}--more-results`};function Z4(t){switch(t?.type){case"point":return t;case"extent":return t.center;case"polygon":{const e=g8(t);return e?de.fromJSON(e):null}case"multipoint":case"polyline":return t.extent?.center;default:return null}}async function jLe(t,e){if(t.hasZ||e.type==="2d")return t;const r=e.map?.ground;return r?.layers.length?(await r.queryElevation(t,{cache:e.basemapTerrain?.elevationQueryCache})).geometry:t}function TC(t,e,r){return gJ(t.center,e,r)}function YL(t,e,r){switch(t?.type){case"extent":return t;case"multipoint":case"polygon":case"polyline":return t.extent;case"point":return gJ(t,e,r);default:return null}}function gJ(t,e,r){const i=t.hasZ?t.z:void 0;if(e?.map)return(r!=null?g1e(e,r):e.extent).clone().centerAt(t).set({zmax:i,zmin:i});const{x:s,y:n,spatialReference:o}=t;return new Te({xmin:s-.25,ymin:n-.25,xmax:s+.25,ymax:n+.25,spatialReference:o,zmin:i,zmax:i})}function VLe(t){return t&&typeof t.highlight=="function"}function ULe(t,e,r){return t==null||t>=r&&(e===0||t<=e)}function b7e(t,e){if(e&&t){const{minScale:r,maxScale:i}=t;if(GLe(r,i))return ULe(e,r,i)}return!0}function GLe(t,e){return t!=null&&t>0||e!=null&&e>0}function S7e(t){return!t?.minScale||!t.maxScale||t.minScale>=t.maxScale}const x7e=()=>!z("disable-feature:layer-based-scale-visibility");let ir=class extends h2(W){constructor(t){super(t),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suffix="",this.suggestionsEnabled=null,this.withinViewEnabled=!1,this.zoomScale=null}};u([h()],ir.prototype,"autoNavigate",void 0),u([h()],ir.prototype,"filter",void 0),u([h()],ir.prototype,"getResults",void 0),u([h()],ir.prototype,"getSuggestions",void 0),u([h()],ir.prototype,"maxResults",void 0),u([h()],ir.prototype,"maxSuggestions",void 0),u([h()],ir.prototype,"minSuggestCharacters",void 0),u([h()],ir.prototype,"outFields",void 0),u([h()],ir.prototype,"placeholder",void 0),u([h()],ir.prototype,"popupEnabled",void 0),u([h({type:_a})],ir.prototype,"popupTemplate",void 0),u([h()],ir.prototype,"prefix",void 0),u([h()],ir.prototype,"resultGraphicEnabled",void 0),u([h()],ir.prototype,"resultSymbol",void 0),u([h()],ir.prototype,"suffix",void 0),u([h()],ir.prototype,"suggestionsEnabled",void 0),u([h()],ir.prototype,"withinViewEnabled",void 0),u([h()],ir.prototype,"zoomScale",void 0),ir=u([E("esri.widgets.Search.SearchSource")],ir);const XL=ir,qLe=/https?:\/\/services.*\.arcgis\.com/i,BLe=/(?:\{([^}]+)\})/g,Of=()=>U.getLogger("esri.widgets.Search.support.layerSearchUtils");function HLe(t,e){const{exactMatch:r=!1,location:i,maxResults:s,spatialReference:n,source:o,sourceIndex:a,suggestResult:l,view:c}=t,{layer:d,filter:p,zoomScale:m}=o,y=c?.scale,g=vJ(o,c),v=e?.signal;return _J(d).then(()=>{const w=d.popupTemplate;return w?w.getRequiredFields(d.fieldsIndex):null}).then(w=>{const{objectIdField:_,returnZ:x}=d,$=TJ(o);if(!KL(d,$))throw Of().error("invalid-field: displayField is invalid."),new R("getResults():invalid-field","displayField is invalid.");const T=w?.length?w:[$],C=o.outFields||T,P=wJ(C);if(C.includes(_)||P||C.push(_),d.floorInfo?.floorField&&C.push(d.floorInfo.floorField),!(P||NS(d,C)))throw Of().error("invalid-field: outField is invalid."),new R("getResults():invalid-field","outField is invalid.");const A=d.createQuery(),{orderByFields:F}=o;if(F&&(A.orderByFields=F),n){A.outSpatialReference=n;const Z=1/Vs(n);Z&&(A.maxAllowableOffset=Z)}const j=d.geometryType==="mesh"||d.geometryType==="multipatch",V=d.capabilities?.data?.supportsZ&&!j;if(A.returnZ=V&&x!==!1,A.returnGeometry=!0,A.multipatchOption=j?"xyFootprint":null,C&&(A.outFields=C),i)A.geometry=i;else if(l.key)A.objectIds=[l.key];else{const Z=o.searchFields||[$];if(!NS(d,Z))throw Of().error("invalid-field: search field is invalid."),new R("getResults():invalid-field","search field is invalid.");if(MJ(d)&&(A.num=s),g&&(A.geometry=g),!l.text?.trim())return[];const re=l.text,{prefix:Q="",suffix:Ee=""}=o,et=IJ(`${Q}${re}${Ee}`);$J(d)&&SJ(d,Z)&&!r&&re&&(A.fullText=xJ({text:re,searchFields:Z}));const lt=EJ({searchTerm:et,layer:d,searchFields:Z,filter:p,exactMatch:r,query:A,type:"search"});if(A.where=lt,!bJ(A))return[]}return d.queryFeatures(A,{signal:v}).then(Z=>nAe(Z,c,o,a,$,y,m))})}function WLe(t,e){const{source:r,spatialReference:i,view:s,suggestTerm:n,maxSuggestions:o,sourceIndex:a,exactMatch:l}=t,{layer:c,filter:d}=r,p=e?.signal,m=vJ(r,s);return _J(c).then(()=>{if(!MJ(c))return[];const y=TJ(r),g=r.searchFields||[y],v=[];r.suggestionTemplate?r.suggestionTemplate.replaceAll(BLe,(V,Z)=>(v.push(Z),V)):v.push(y);const w=wJ(v);v.includes(c.objectIdField)||w||v.push(c.objectIdField);const _=KL(c,y),x=w||NS(c,v),$=NS(c,g);if(!_)throw Of().error("invalid-field: displayField is invalid."),new R("getSuggestions():invalid-field","displayField is invalid.");if(!x)throw Of().error("invalid-field: outField is invalid."),new R("getSuggestions():invalid-field","outField is invalid.");if(!$)throw Of().error("invalid-field: search field is invalid."),new R("getSuggestions():invalid-field","search field is invalid.");const T=c.createQuery(),{orderByFields:C}=r;if(C&&(T.orderByFields=C),T.outSpatialReference=i,T.returnGeometry=!1,T.num=o,T.outFields=v,m&&(T.geometry=m),!n.trim())return[];const{prefix:P="",suffix:A=""}=r,F=IJ(`${P}${n}${A}`);$J(c)&&SJ(c,g)&&!l&&n&&(T.fullText=xJ({text:n,searchFields:g}));const j=EJ({searchTerm:F,layer:c,searchFields:g,filter:d,exactMatch:l,query:T,type:"suggest"});return T.where=j,bJ(T)?c.queryFeatures(T,{signal:p}).then(V=>rAe(V,r,a,y)):[]})}function vJ(t,e){const{filter:r,withinViewEnabled:i}=t,s=e?.extent;return r?.geometry??(i&&s?s:void 0)}function wJ(t){return t&&t.includes("*")}async function _J(t){t&&await t.load()}function bJ(t){return!(!t.fullText&&!t.where)}function SJ(t,e){const r=t?.indexes;return!r||!e?.length?!1:r.filter(i=>i.indexType==="FullText").some(i=>{const s=i.fields?.split(",").map(n=>n.trim().toLowerCase())||[];return e.every(n=>s.includes(n.toLowerCase()))})}function xJ({text:t,searchFields:e}){return t.trim().split(" ").filter(r=>!!r.trim()).map(r=>new D7({onFields:e,searchTerm:r,searchType:"prefix"}))}function $J(t){return t?.capabilities?.query?.supportsFullTextSearch??!1}function MJ(t){return t?.capabilities?.query?.supportsPagination??!1}function ZLe(t){return t?.fieldsIndex?.fields?.find(e=>e.type==="string")?.name??""}function TJ(t){return t.displayField||t.layer.displayField||ZLe(t.layer)}function NS(t,e){return!(!t||!e?.length)&&e.every(r=>KL(t,r))}function KL(t,e){return!!t.getField(e)}function JLe(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!0;return!1}function YLe({codedValues:t},e,r){return u1(t??[],i=>{const s=i.name,n=r?s:s.toLowerCase();return(r?e:e.toLowerCase())===n?i.code.toString():null})??null}function IJ(t){return t.replaceAll("'","''")}function Xy(t,e){const r=e?.where;return r?`(${t}) AND (${r})`:t}function XLe({currentTerm:t,field:e,filter:r,exactMatch:i,url:s,type:n}){const o=e?.type,a=e?.name;if(o==="string"||o==="date"||o==="global-id"){const l=qLe.test(s??""),c=l&&JLe(t)?"N":"";return Xy(i&&n==="search"?`${a} = ${c}'${t}'`:l?`${a} LIKE ${c}${`'${t}%'`}`:`${`LOWER(${a})`} LIKE ${c}${`'${t.toLowerCase()}%'`}`,r)}if(o==="oid"||o==="small-integer"||o==="integer"||o==="single"||o==="double"){const l=Number(t);return isNaN(l)?null:Xy(`${a} = ${l}`,r)}return Xy(`${a} = ${t}`,r)}function KLe(t,e){return t?` OR (${e})`:`(${e})`}function EJ({searchTerm:t,layer:e,searchFields:r,filter:i,exactMatch:s,query:n,type:o}){const{definitionExpression:a,url:l}=e;let c="";return!n.fullText&&t&&r&&r.forEach(d=>{const p=e.getField(d),m=e.getFieldDomain?.(d,{excludeImpliedDomains:z("esri-widget-legacy-field-domain-calculation")}),y=(m&&m.type==="coded-value"?YLe(m,t,s):null)||t||null;if(y!==null){const g=XLe({currentTerm:y,field:p,filter:i,exactMatch:s,url:l,type:o});g&&(c+=KLe(c,g))}}),a&&c?`(${a}) AND (${c})`:a||c}function QLe(t,e){let r=null;const{codedValues:i}=t;return i&&i.length&&i.some(s=>s.code===e&&(r=s.name,!0)),r}function eAe(t,e){return t[e]??t[Object.keys(t).find(r=>r.toLowerCase()===e.toLowerCase())]}function CJ(t,e,r){const i=t.sourceLayer,{attributes:s}=t,n=i.getFieldDomain?.(r,{feature:t,excludeImpliedDomains:z("esri-widget-legacy-field-domain-calculation")});if(e)return va(e,s);if(r&&s){const o=i.getField(r),a=eAe(s,r);return a==null?"":n&&n.type==="coded-value"?QLe(n,a)??"":o?.type==="date"?hn(new Date(a)):typeof a=="number"?a.toString():typeof a!="string"?"":a.trim()}return""}function tAe(t,e,r,i){const s=t.sourceLayer,{attributes:n}=t,{objectIdField:o}=s,a=o?n[o]:null;return{text:CJ(t,e.suggestionTemplate,i),key:a,sourceIndex:r}}function rAe(t,e,r,i){return t.features.map(s=>tAe(s,e,r,i))}function iAe(t){return t!=null&&t.minScale!=null&&t.maxScale!=null}function sAe(t,e,r,i,s,n,o){const a=t.clone();a.layer=t.layer;const l=t.sourceLayer,c=l?.objectIdField,d=c?t.attributes[c]:null,p=CJ(t,r.searchTemplate,s);n!=null&&iAe(l)&&(l.minScale&&l.minScale<n?n=l.minScale:l.maxScale&&l.maxScale>n&&(n=l.maxScale));const m=a.geometry?YL(a.geometry,e??void 0,n??void 0):void 0,y=typeof o=="number"&&m?TC(O(m),e??void 0,o):m,g=t.clone();return g.layer=t.layer,y!=null&&(g.geometry=dt.fromExtent(y)),{extent:y,target:g,feature:a,key:d,name:p,sourceIndex:i}}function nAe(t,e,r,i,s,n,o){return t.features.map(a=>sAe(a,e,r,i,s,n,o))}var IC;let Nn=IC=class extends XL{constructor(t){super(t),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,r)=>HLe({source:this,...e},r),this.getSuggestions=(e,r)=>WLe({source:this,...e},r)}set layer(t){this._set("layer",t),t&&t.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(t){this._overrideIfSome("name",t)}clone(){return new IC({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?O(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?O(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){return this.layer.fieldsIndex?.fields.find(t=>t.type==="string")?.name??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:t,searchFields:e}=this;if(!t.loaded)return"";const r=e||[this._getDisplayField()],i=DP(t);return`: ${r.map(s=>{const n=t.getField(s);return(i?t.getFieldAlias(s):n?.alias)||s}).join(", ")}`}_getLayerTitle(){const{layer:t}=this;if(!t)return;const{title:e}=t;return e?`${e}${this._getSearchFieldsString()}`:void 0}};u([h({json:{read:{source:"field.name"},write:{target:"field.name"}}})],Nn.prototype,"displayField",void 0),u([h({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],Nn.prototype,"exactMatch",void 0),u([h({value:null})],Nn.prototype,"layer",null),u([h()],Nn.prototype,"name",null),u([h({type:[String],json:{write:!0}})],Nn.prototype,"orderByFields",void 0),u([h()],Nn.prototype,"searchFields",void 0),u([h()],Nn.prototype,"searchTemplate",void 0),u([h()],Nn.prototype,"suggestionTemplate",void 0),Nn=IC=u([E("esri.widgets.Search.LayerSearchSource")],Nn);const Zp=Nn;function oAe(t){return!!t&&typeof t.x=="number"&&typeof t.y=="number"}function aAe(t){return t&&typeof t.xmin=="number"&&typeof t.ymin=="number"&&typeof t.xmax=="number"&&typeof t.ymax=="number"}let _u=class extends W{constructor(e){super(e),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};u([h({type:String,json:{write:!0}})],_u.prototype,"address",void 0),u([h({type:Object,json:{write:!0}})],_u.prototype,"attributes",void 0),u([h({type:Te,json:{write:!0}})],_u.prototype,"extent",void 0),u([h({type:de,json:{write:!0}})],_u.prototype,"location",void 0),u([h({type:Number,json:{write:!0}})],_u.prototype,"score",void 0),_u=u([E("esri.rest.support.AddressCandidate")],_u);const PJ=_u,QL={type:String,json:{read:{source:"token"},write:{target:"token"}}};let Br=class extends W{constructor(e){super(e),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};u([h({type:Object,json:{write:!0}})],Br.prototype,"address",void 0),u([h(QL)],Br.prototype,"apiKey",void 0),u([h({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Br.prototype,"categories",void 0),u([h({type:String,json:{write:!0}})],Br.prototype,"countryCode",void 0),u([h({type:Boolean,json:{write:!0}})],Br.prototype,"forStorage",void 0),u([h({type:de,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Br.prototype,"location",void 0),u([h({type:["rooftop","street"],json:{write:!0}})],Br.prototype,"locationType",void 0),u([h({type:String,json:{write:!0}})],Br.prototype,"magicKey",void 0),u([h({type:Number,json:{write:!0}})],Br.prototype,"maxLocations",void 0),u([h({type:[String],json:{write:{writer:(t,e)=>{e.outFields=t?t.join(","):null}}}})],Br.prototype,"outFields",void 0),u([h({type:ne,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Br.prototype,"outSpatialReference",void 0),u([h({type:Te,json:{write:{writer:(t,e)=>{const r=t?t.shiftCentralMeridian():null;e.searchExtent=r}}}})],Br.prototype,"searchExtent",void 0),Br=u([E("esri.rest.support.AddressToLocationsParameters")],Br),Br.from=jt(Br);const kJ=Br;async function lAe(t,e,r){e=kJ.from(e);const i=Xv(t),{address:s,...n}=e.toJSON(),o={...s,...n,f:"json"},a=Pk({...i.query,...o}),l=Ck(a,r),c=`${i.path}/findAddressCandidates`;return Be(c,l).then(uAe)}function uAe({data:t}){if(!t)return[];const{candidates:e,spatialReference:r}=t;return e?e.map(i=>{if(!i)return;const{extent:s,location:n}=i,o=!s||aAe(s);return oAe(n)&&o?(s&&(s.spatialReference=r),n&&(n.spatialReference=r),PJ.fromJSON(i)):void 0}):[]}const cAe=yr()({DistanceMarker:"distance-marker",Locality:"locality",POI:"poi",PointAddress:"point-address",Postal:"postal",StreetAddress:"street-address",StreetInt:"street-intersection",StreetName:"street-name",Subaddress:"sub-address"}),hAe=yr()({localCity:"local-city",postalCity:"postal-city"});var EC;let Li=EC=class extends W{constructor(t){super(t),this.apiKey=null,this.featureTypes=null,this.forStorage=null,this.language=null,this.location=null,this.locationType=null,this.outFields=null,this.outSpatialReference=null,this.preferredLabelValues=null,this.returnInputLocation=null}writeFeatureTypes(t,e){t?.length&&(e.featureTypes=t.map(r=>cAe.toJSON(r)))}writeLocation(t,e){e.location=t?.clone().normalize().toJSON()}static from(t){return Um(EC,t)}};u([h(QL)],Li.prototype,"apiKey",void 0),u([h({type:[["distance-marker","locality","poi","point-address","postal","street-address","street-intersection","street-name","sub-address"]],json:{write:!0}})],Li.prototype,"featureTypes",void 0),u([te("featureTypes")],Li.prototype,"writeFeatureTypes",null),u([h({type:Boolean,json:{write:!0}})],Li.prototype,"forStorage",void 0),u([h({type:String,json:{name:"langCode",write:!0}})],Li.prototype,"language",void 0),u([h({type:de,json:{write:!0}})],Li.prototype,"location",void 0),u([te("location")],Li.prototype,"writeLocation",null),u([h({type:["street","rooftop"],json:{write:!0}})],Li.prototype,"locationType",void 0),u([h({type:[String],json:{write:!0}})],Li.prototype,"outFields",void 0),u([h({type:ne,json:{name:"outSR",write:!0}})],Li.prototype,"outSpatialReference",void 0),u([ye(hAe)],Li.prototype,"preferredLabelValues",void 0),u([h({type:Boolean,json:{write:!0}})],Li.prototype,"returnInputLocation",void 0),Li=EC=u([E("esri.rest.support.LocationToAddressParameters")],Li);const LJ=Li;async function dAe(t,e,r){const i=Xv(t),{path:s,query:n}=i,o=LJ.from(e);if(!o.location)throw new R("location-to-address:location-required","The location parameter is required");const a={...r,query:{...n,...pAe(o),f:"json"}},l=`${s}/reverseGeocode`,{data:c}=await Be(l,a),{address:d,location:p}=c;return PJ.fromJSON({address:d?.Match_addr??"",attributes:d,location:p,score:100})}function pAe(t){const e=t.toJSON(),{featureTypes:r,forStorage:i,langCode:s,location:n,locationType:o,outFields:a,outSR:l,preferredLabelValues:c,returnInputLocation:d,token:p}=e;return{featureTypes:r?.join(","),forStorage:i,langCode:s,location:JSON.stringify(n),locationType:o,outFields:a?.join(","),outSR:l?.wkid??void 0,preferredLabelValues:c,returnInputLocation:d,token:p}}let Jp=class extends W{constructor(t){super(t),this.isCollection=null,this.magicKey=null,this.text=null}};u([h({type:Boolean,json:{write:!0}})],Jp.prototype,"isCollection",void 0),u([h({type:String,json:{write:!0}})],Jp.prototype,"magicKey",void 0),u([h({type:String,json:{write:!0}})],Jp.prototype,"text",void 0),Jp=u([E("esri.rest.support.SuggestionCandidate")],Jp);const fAe=Jp;let Is=class extends W{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};u([h(QL)],Is.prototype,"apiKey",void 0),u([h({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Is.prototype,"categories",void 0),u([h({type:String,json:{write:!0}})],Is.prototype,"countryCode",void 0),u([h({type:de,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Is.prototype,"location",void 0),u([h({type:Number,json:{write:!0}})],Is.prototype,"maxSuggestions",void 0),u([h({type:ne,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Is.prototype,"outSpatialReference",void 0),u([h({type:Te,json:{write:{writer:(t,e)=>{const r=t?t.shiftCentralMeridian():null;e.searchExtent=JSON.stringify(r)}}}})],Is.prototype,"searchExtent",void 0),u([h({type:String,json:{write:!0}})],Is.prototype,"text",void 0),Is=u([E("esri.rest.support.SuggestLocationsParameters")],Is),Is.from=jt(Is);const AJ=Is;async function mAe(t,e,r){const i=Xv(t),s={...(e=AJ.from(e)).toJSON(),f:"json"},n=Pk({...i.query,...s}),o=Ck(n,r),a=`${i.path}/suggest`;return Be(a,o).then(yAe)}function yAe(t){const{data:e}=t;if(!e)return[];const{suggestions:r}=e;return r?r.map(i=>new fAe(i)):[]}const gAe="Single Line Input",vAe=3e5;function wAe(t,e){return t.location?$Ae(t,e):MAe(t,e)}function RJ(t,e){if(e.localSearchDisabled)return null;const r=t?.scale;return typeof r=="number"&&r<=vAe?t?.extent?.center:null}async function _Ae(t,e){const{source:r,spatialReference:i,view:s,suggestTerm:n,maxSuggestions:o,sourceIndex:a}=t,l=new AJ,{apiKey:c,url:d}=r,p=OJ(r,s),m=e?.signal;if(!d)return null;c&&(l.apiKey=c),r.categories&&(l.categories=r.categories),i&&(l.outSpatialReference=i);const y=RJ(s,r);if(y&&(l.location=y),!n.trim())return null;const{prefix:g="",suffix:v=""}=r,w=`${g}${n}${v}`;return l.text=w,p&&(l.searchExtent=p),l.maxSuggestions=o,r.countryCode&&(l.countryCode=r.countryCode),mAe(d,l,{signal:m}).then(_=>IAe(_,a))}function bAe(t){return!!t&&/(?:geocode-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}function SAe(t){return!!t&&/(?:\/servers\/[\da-z.-]+\/rest\/services\/world\/geocodeserver).*/i.test(t)}function J4(t){return!!t&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}const xAe="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";async function $Ae(t,e){const{location:r,source:i,sourceIndex:s,spatialReference:n,view:o}=t,{apiKey:a,defaultZoomScale:l,language:c,url:d,zoomScale:p}=i;if(d==null)return[];const m=o?.scale,y=e?.signal,g=new LJ({language:c,location:r,apiKey:a,outSpatialReference:n});try{return FJ([await dAe(d,g,{signal:y})],{defaultZoomScale:l,scale:m,sourceIndex:s,view:o,zoomScale:p})}catch{return[]}}function OJ(t,e){const{filter:r,withinViewEnabled:i}=t,s=e?.scale,n=e?.extent,o=r?.geometry;return(o?YL(o,e??void 0,s):void 0)||(i&&n?n:void 0)}async function MAe(t,e){const{source:r,suggestResult:i,spatialReference:s,view:n,maxResults:o,sourceIndex:a}=t,l=r?.zoomScale,c=r?.defaultZoomScale;if(!i.text?.trim())return null;const p=!i.key&&r.prefix?r.prefix:"",m=!i.key&&r.suffix?r.suffix:"",y=`${p}${i.text}${m}`,g=new kJ,{apiKey:v,url:w}=r,_=n?.scale,x=OJ(r,n),$=e?.signal;if(v&&(g.apiKey=v),!w)return null;r.categories&&(g.categories=r.categories),r.locationType&&(g.locationType=r.locationType),s&&(g.outSpatialReference=s);const T=RJ(n,r);T&&(g.location=T),g.maxLocations=o,x&&(g.searchExtent=x),r.countryCode&&(g.countryCode=r.countryCode);const{key:C}=i,P=`${C}`;return C&&(g.magicKey=P),g.address={},g.address[r.singleLineFieldName||gAe]=y,r.outFields&&(g.outFields=r.outFields),lAe(w,g,{signal:$}).then(A=>FJ(A,{key:P,scale:_,sourceIndex:a,view:n,zoomScale:l,defaultZoomScale:c}))}function TAe(t,e){return{text:t.text,key:t.magicKey,sourceIndex:e}}function IAe(t,e){return t.map(r=>TAe(r,e))}function EAe(t,e){const{key:r,scale:i,sourceIndex:s,view:n,zoomScale:o,defaultZoomScale:a}=e,{attributes:l,extent:c,location:d,address:p}=t,m=new Rt({geometry:d,attributes:l}),y=c||d,g=y?YL(y,n??void 0,i??void 0):void 0,v=g?typeof o=="number"?TC(g,n??void 0,o):typeof a=="number"&&y?.type==="point"?TC(g,n??void 0,a):g:null,w=d?`${d.x},${d.y}`:"",_=p||w,x=m.clone();return v!=null&&(x.geometry=dt.fromExtent(v)),{extent:v,feature:m,target:x,key:r,name:_,sourceIndex:s}}function FJ(t,e){return t.filter(Boolean).map(r=>EAe(r,e))}var CC;let Hr=CC=class extends XL{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.language=null,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(e,r)=>wAe({source:this,...e},r),this.getSuggestions=(e,r)=>_Ae({source:this,...e},r)}clone(){return new CC({apiKey:this.apiKey,autoNavigate:this.autoNavigate,categories:this.categories?O(this.categories):null,countryCode:this.countryCode,filter:this.filter,language:this.language,locationType:this.locationType,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?O(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?.clone()??null,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,suffix:this.suffix,suggestionsEnabled:this.suggestionsEnabled,url:this.url,withinViewEnabled:this.withinViewEnabled,zoomScale:this.zoomScale})}};u([h()],Hr.prototype,"apiKey",void 0),u([h()],Hr.prototype,"categories",void 0),u([h()],Hr.prototype,"countryCode",void 0),u([h({json:{write:!0}})],Hr.prototype,"defaultZoomScale",void 0),u([h()],Hr.prototype,"localSearchDisabled",void 0),u([h()],Hr.prototype,"language",void 0),u([h()],Hr.prototype,"locationType",void 0),u([h({json:{write:!0}})],Hr.prototype,"name",void 0),u([h({json:{write:!0}})],Hr.prototype,"placeholder",void 0),u([h()],Hr.prototype,"searchTemplate",void 0),u([h({json:{write:!0}})],Hr.prototype,"singleLineFieldName",void 0),u([h({json:{read:{source:"suggest"},write:{target:"suggest"}}})],Hr.prototype,"suggestionsEnabled",void 0),u([h({json:{write:!0}})],Hr.prototype,"url",void 0),u([h({json:{write:!0}})],Hr.prototype,"zoomScale",void 0),Hr=CC=u([E("esri.widgets.Search.LocatorSearchSource")],Hr);const NJ=Hr;let Cu=class extends W{constructor(e){super(e),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(s=>s.toJSON()),r=this.geometries[0],i={};return i.outSR=P1(this.outSpatialReference),i.inSR=P1(r.spatialReference),i.geometries=JSON.stringify({geometryType:Qm(r),geometries:e}),this.transformation&&(i.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(i.transformForward=this.transformForward),i}};u([h()],Cu.prototype,"geometries",void 0),u([h({type:ne,json:{read:{source:"outSR"}}})],Cu.prototype,"outSpatialReference",void 0),u([h()],Cu.prototype,"transformation",void 0),u([h()],Cu.prototype,"transformForward",void 0),Cu=u([E("esri.rest.support.ProjectParameters")],Cu);const CAe=jt(Cu);async function PAe(t,e,r){e=CAe(e);const i=Xv(t),s={...i.query,f:"json",...e.toJSON()},n=e.outSpatialReference,o=Qm(e.geometries[0]),a=Ck(s,r);return Be(i.path+"/project",a).then(({data:{geometries:l}})=>lG(l,o,n))}const DJ=()=>U.getLogger("esri.widgets.support.geolocationUtils"),kAe={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function LAe(){const t=!!z("esri-geolocation");return t||DJ().warn("geolocation-unsupported","Geolocation unsupported."),t}function AAe(){const t=window.isSecureContext;return t||DJ().warnOnce("insecure-context","Geolocation requires a secure origin."),t}function Y4(){return LAe()&&AAe()}function RAe(t){return t??=kAe,new Promise((r,i)=>{setTimeout(()=>i(new R("geolocation:timeout","getting the current geolocation position timed out")),15e3),navigator.geolocation.getCurrentPosition(r,i,t??void 0)})}function OAe(t,e){const{position:r,view:i}=t,s=FAe(r),n=s?.coords;if(!n)throw new R("geometry-service:no-coords","Geolocation has no coordinates");return DAe(NAe(n),i,e)}function FAe(t){const e=t&&t.coords||{},r={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed,toJSON:()=>({})};return t&&{coords:r,timestamp:t.timestamp,toJSON:()=>({})}}function NAe({longitude:t,latitude:e,altitude:r}){return new de({longitude:t,latitude:e,z:r||void 0,spatialReference:{wkid:4326}})}function DAe(t,e,r){if(!e)return Promise.resolve(t);const i=e.spatialReference;return i.isWGS84?Promise.resolve(t):i.isWebMercator?Promise.resolve(Bu(t)):zAe(r).then(s=>{if(!s)throw new R("geometry-service:missing-url","Geometry service URL is missing");const n=new Cu({geometries:[t],outSpatialReference:i});return PAe(s,n,r).then(o=>o[0])})}function zAe(t){if(De.geometryServiceUrl)return Promise.resolve(De.geometryServiceUrl);const e=J.getDefault();return e.load(t).catch(()=>{}).then(()=>e.helperServices?.geometry?.url)}function oi(t,e){return t.hasOwnProperty(e)&&t[e]!=null&&t[e]!==""}const X4="highlight",s1=se.ofType({key:t=>t.layer?"layer":"locator",base:XL,typeMap:{layer:Zp,locator:NJ}}),K4=ne.WGS84,jAe="esri/images/search/search-symbol-32.png",VAe=/<[\s\S]*?>/g,ip=-1;var um;let Ae=(um=class extends tB(qm){constructor(e){super(e),this._defaultPopupTemplate=new _a({content:"{Match_addr}"}),this._gotoController=null,this._searching=null,this._updatingPromise=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultSources=new s1,this.defaultSymbols={point:new ci({url:St(jAe),size:24,width:24,height:24}),polyline:new Ot({color:[130,130,130,1],width:2}),polygon:new vi({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=J.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new s1,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){this.addHandles([ie(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),ft),ie(()=>this.messages,()=>{this._defaultPopupTemplate.title=this.messages?.searchResult??"",this._update()},ft)])}destroy(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return this.allSources.length===1||!this.searchAllEnabled?0:ip}set activeSourceIndex(e){this._overrideIfSome("activeSourceIndex",e)}get allPlaceholder(){return this.messages?.allPlaceholder}set allPlaceholder(e){this._overrideIfSome("allPlaceholder",e)}get allSources(){const{sources:e,defaultSources:r,includeDefaultSources:i}=this,s=typeof i=="function"?i.call(null,{sources:e,defaultSources:r}):i?r.concat(e):e,n=this._get("allSources")||new s1;return n.removeAll(),n.addMany(s.filter(Boolean)),n}get defaultPopupTemplate(){return this._defaultPopupTemplate}set defaultPopupTemplate(e){this._overrideIfSome("defaultPopupTemplate",e)}get locationEnabled(){return this._get("locationEnabled")||Y4()}set locationEnabled(e){if(e===void 0)return void this._clearOverride("locationEnabled");const r=Y4();if(e&&!r){const i=new R("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});U.getLogger(this).error(i)}this._override("locationEnabled",!!e&&r)}get placeholder(){const{allSources:e,activeSourceIndex:r,allPlaceholder:i}=this;return r===ip?i??"":e.at(r)?.placeholder??""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),e===""&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":this.allSources.length===0?"disabled":"ready"}get updating(){return this._updatingPromise!=null}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup();const{view:e,resultGraphic:r}=this;e&&r&&e.graphics.remove(r),this._set("resultGraphic",null)}search(e,r){this.emit("search-start"),this.clearGraphics();const i=this._createSuggestionForSearch(e),s=(async()=>{try{await this.when();const n=await this._getResultsFromSources(i,r);if(r?.signal?.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:i.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(o,n,i);const a=this._getFirstResult(o.results),l=i.location&&a?a.name:i.text,c=l?.replaceAll(VAe,"");return this._set("searchTerm",c),(i.key&&typeof i.sourceIndex=="number"||i.location)&&this._set("selectedSuggestion",i),this._set("results",o.results),this._set("resultCount",o.results.reduce((d,p)=>d+(p.results?.length??0),0)),this.emit("search-complete",o),await this._selectFirstResult(a),o}finally{this._clearSearching()}})();return this._searching=s,s}async searchNearby(e){if(!this.locationEnabled){const i=new R("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});throw U.getLogger(this).error(i),i}const r=(async()=>{try{const i=await RAe(),s=await OAe({position:i,view:this.view},e);return await this.search(s,e)}finally{this._clearSearching()}})();return this._searching=r,r}async select(e){if(this.clearGraphics(),!e){const V=new R("select:missing-parameter","Cannot select without a searchResult.",{value:e});throw U.getLogger(this).error(V),V}const{view:r}=this,i=oi(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),s=i!=null?this.allSources.at(i):null;if(!s){const V=new R("select:missing-source","Cannot select without a source.",{source:s});throw U.getLogger(this).error(V),V}const n=s instanceof Zp?this._getLayerSourcePopupTemplate(s):s.popupTemplate,o=s.resultSymbol||this._getDefaultSymbol(e),a=oi(s,"resultGraphicEnabled")?s.resultGraphicEnabled:this.resultGraphicEnabled,l=oi(s,"autoNavigate")?s.autoNavigate:this.autoNavigate,c=oi(s,"popupEnabled")?s.popupEnabled:this.popupEnabled,d=c?n||this.popupTemplate||this.defaultPopupTemplate:null,{feature:p}=e;if(!p){const V=new R("select:missing-feature","Cannot select without a feature.",{feature:p});throw U.getLogger(this).error(V),V}const{attributes:m,geometry:y,layer:g,sourceLayer:v}=p,w=y?Z4(y):null,_={layerViewQuery:this._getLayerView(p),elevationQuery:r&&w!=null?jLe(w,r):Promise.resolve(w)},x=await Ch(_),$=x.layerViewQuery.value,T=x.elevationQuery.value;o instanceof rt&&(o.text=e.name);const C=r&&l?e.target||e.extent:null;await(C!=null?this._goToSearchResult(C):Promise.resolve());const A=$?p:new Rt({geometry:y,symbol:o,attributes:m,layer:g,sourceLayer:v,popupTemplate:d}),F=QT(r),j=F&&c&&A.getEffectivePopupTemplate(F.defaultPopupTemplateEnabled);return j&&await r?.openPopup({features:[A],location:T}),$&&VLe($)&&!j&&this._highlightFeature({graphic:A,layerView:$}),!$&&a&&r&&r.graphics.push(A),this._setResultFloor(e),this._set("selectedResult",e),this._set("resultGraphic",A),this.emit("select-result",{result:e,source:s,sourceIndex:i}),e}async suggest(e,r,i){const s=e||this.searchTerm;this.emit("suggest-start",{searchTerm:s}),await this._suggestTimer(r,i);const n=await this._suggestImmediate(s,i);return this._set("suggestions",n?.results),this._set("suggestionCount",n?.results.reduce((o,a)=>o+(a.results?.length??0),0)??null),this.emit("suggest-complete",n),n}async when(e,r){await Ov(()=>!this.updating)}async _update(){const{portal:e,view:r}=this;if(this.includeDefaultSources){const i=this._updatingPromise=Ch([e?.load(),r?.when()]);if(this.destroyed||(await i,i!==this._updatingPromise))return}this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){const e=this.portal?.helperServices?.geocode;return e?e.map(r=>{if(r.placefinding===!1)return;const i=J4(r.url)&&Wz(r.url)?{url:xAe}:null,s=NJ.fromJSON({...r,...i}),n=s.url;if(J4(n)||SAe(n)||bAe(n)){const o=s.outFields??["Addr_type","Match_addr","StAddr","City"],a=(s.placeholder||this.messages?.placeholder)??"",l=typeof s.defaultZoomScale=="number"?s.defaultZoomScale:2500;s.singleLineFieldName="SingleLine",s.outFields=o,s.placeholder=a,s.defaultZoomScale=l}return s.singleLineFieldName?s:void 0}).filter(fr):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(e=>e?.destroy()),this._createdFeatureLayers=[]}_getLayerSources(e,r){const i=this.view?.map;return e.map(s=>{const n=i.findLayerById(s.id);if(!n)return;const o=this._getLayerJSON(s),a=Zp.fromJSON(o);return a.placeholder=r,this._getLayer(n,o).then(l=>{a.layer=l}),a}).filter(fr).toArray()}_getTableSources(e,r){const i=this.view?.map;return e.map(s=>{if(!s.id)return;const n=i.findTableById(s.id);if(!n)return;const o=this._getLayerJSON(s),a=Zp.fromJSON(o);return a.placeholder=r,this._getLayer(n,o).then(l=>{a.layer=l}),a}).filter(fr).toArray()}_convertApplicationProperties(){const e=this.view?.map,r=e?.applicationProperties?.viewing?.search;if(!r)return[];const{enabled:i,hintText:s,layers:n,tables:o}=r;return i?[...this._getLayerSources(n,s),...this._getTableSources(o,s)]:[]}async _getSubLayer(e,r){if(await e.load(),!e.allSublayers)throw new Error;const i=e.allSublayers.find(n=>n.id===r.subLayer);if(!i)throw new Error;const s=await i.createFeatureLayer?.();if(!s)throw new Error;return this._createdFeatureLayers.push(s),s}async _getBuildingSubLayer(e,r){await e.load();const i=e.allSublayers.find(s=>s.id===r.subLayer);if(i?.type!=="building-component")throw new Error;if(await i.load(),i.associatedLayer==null)throw new Error;return await i.associatedLayer.load(),i}async _getLayer(e,r){if(e.type==="feature"||e.type==="scene"||e.type==="csv"||e.type==="geojson"||e.type==="ogc-feature")return e;if(e.type==="map-image")try{return await this._getSubLayer(e,r)}catch{const s=new R("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return U.getLogger(this).error(s),null}return e.type==="building-scene"?this._getBuildingSubLayer(e,r):null}_getLayerJSON(e){return typeof e.toJSON=="function"?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:r}=this;this._destroyFeatureLayers(),e.removeAll(),r&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){const e=QT(this.view),{resultGraphic:r}=this;if(!e||!r)return;const i="selectedFeature"in e,s=i?e.selectedFeature:null;i&&s&&s===r&&bU(this.view?.popup,this.view?.popupElement)}_suggestTimer(e,r){const i=e??this.suggestionDelay;return YC(i,null,r?.signal)}_createLocationForSearch(e){return e instanceof Rt&&e.geometry?Z4(e.geometry):e instanceof de?e:Array.isArray(e)&&e.length===2?new de({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&oi(e,"key")&&oi(e,"text")&&oi(e,"sourceIndex"))return e;const r=this._createLocationForSearch(e),i=typeof e=="string"?e:this.searchTerm,{selectedSuggestion:s,selectedResult:n}=this,o=!e&&s&&n,a=o&&s.key===n.key&&s.sourceIndex===n.sourceIndex,l=o&&s.location;return a||l?s:{location:r,text:r?"":i,sourceIndex:null,key:null}}_getFirstResult(e){return u1(e,({results:r})=>r?.[0])??null}async _selectFirstResult(e){return this.autoSelect&&e?this.select(e):null}async _suggestImmediate(e,r){await this.when();const i=await this._getSuggestionsFromSources(e,r);if(r?.signal?.aborted)return null;const s={activeSourceIndex:this.activeSourceIndex,searchTerm:e??"",numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(s,i),s}_formatSourceResponse(e,r,i){const s=r?.value||[],n=r?.error,o=this.allSources.at(i);if(n){const a={sourceIndex:i,source:o,error:n};e.errors.push(a),U.getLogger(this).error(n),e.numErrors++}else{const a={sourceIndex:i,source:o,results:s};e.results.push(a),e.numResults+=s.length}}_formatResponse(e,r,i){if(r)if(e.activeSourceIndex===ip){const s=i&&oi(i,"sourceIndex")&&i.sourceIndex!==-1?i.sourceIndex:void 0;r.forEach((n,o)=>{const a=s!==void 0?s:o;this._formatSourceResponse(e,n,a)})}else this._formatSourceResponse(e,r[0],e.activeSourceIndex)}async _getResultsFromSources(e,r){const{allSources:i}=this,s=!e.location&&oi(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,n=[];if(!i.length){const o=new R("search:no-sources-defined","At least one source is required.",{allSources:i});throw U.getLogger(this).error(o),o}return s===ip?i.forEach((o,a)=>{n.push(this._getResultsFromSource(e,a,r))}):n.push(this._getResultsFromSource(e,s,r)),Ch(n)}async _getSuggestionsFromSources(e,r){const{allSources:i,activeSourceIndex:s}=this,n=[];if(!i.length){const o=new R("suggest:no-sources-defined","At least one source is required.",{allSources:i});throw U.getLogger(this).error(o),o}return s===ip?i.forEach((o,a)=>{n.push(this._getSuggestionsFromSource(e,a,r))}):n.push(this._getSuggestionsFromSource(e,s,r)),Ch(n)}async _getResultsFromSource(e,r,i){const s=r!=null?this.allSources.at(r):null;if(!s)return null;const{location:n=null}=e,o=this.view?.spatialReference??K4,a=oi(s,"maxResults")?s.maxResults:this.maxResults,l=!!(s instanceof Zp&&oi(s,"exactMatch"))&&s.exactMatch,{view:c}=this;return s.getResults?.({exactMatch:l,location:n,maxResults:a,sourceIndex:r,spatialReference:o,suggestResult:e,view:c},i)}async _getSuggestionsFromSource(e,r,i){const s=this.allSources.at(r);if(!s)return null;e??="";const n=oi(s,"suggestionsEnabled")?s.suggestionsEnabled:this.suggestionsEnabled,o=e?.length,a=oi(s,"minSuggestCharacters")?s.minSuggestCharacters:this.minSuggestCharacters;if(n&&e.trim()&&o>=a){const l=this.view?.spatialReference||K4,c=oi(s,"maxSuggestions")?s.maxSuggestions:this.maxSuggestions,{view:d}=this,p=!!(s instanceof Zp&&oi(s,"exactMatch"))&&s.exactMatch;return s.getSuggestions?.({view:d,sourceIndex:r,suggestTerm:e,spatialReference:l,maxSuggestions:c,exactMatch:p},i)}return null}_getLayerSourcePopupTemplate(e){const{layer:r}=e;if(r)return oi(e,"popupTemplate")?e.popupTemplate:r.popupTemplate}_getSourceIndexOfResult(e){return u1(this.results??[],({results:r,sourceIndex:i})=>r?.includes(e)?i:null)??null}async _goToSearchResult(e){this._abortGoTo();const r=new AbortController;this._gotoController=r;const i={target:{target:e},options:{signal:r.signal}};e||(i.options.animate=!1),await this.callGoTo(i),this._gotoController=null}_getDefaultSymbol(e){const{defaultSymbols:r}=this,i=e.feature?.geometry;if(i==null)return null;switch(i.type){case"point":case"multipoint":return r.point;case"polyline":return r.polyline;case"extent":case"polygon":return r.polygon;default:return null}}_removeHighlight(){this.removeHandles(X4)}async _getLayerView(e){const{view:r}=this;if(!e||!r)return null;const{layer:i,sourceLayer:s}=e,n=i??s;return n&&n.type!=="building-component"&&n.type!=="subtype-sublayer"?(await r.when(),r.whenLayerView(n)):null}_highlightFeature(e){const{graphic:r,layerView:i}=e,{attributes:s,layer:n,sourceLayer:o}=r,a=n??o,{objectIdField:l}=a,c=(l&&s?.[l])??null,d=i.highlight(c??r);this.addHandles(d,X4)}_setResultFloor(e){const{view:r}=this,i=e.feature?.attributes,s=e.feature?.sourceLayer;if(s&&"floorInfo"in s&&s?.floorInfo?.floorField&&i){const n=i[s.floorInfo.floorField];r?.emit("select-result-floor",n)}}},um.ALL_INDEX=ip,um);u([h()],Ae.prototype,"_searching",void 0),u([h()],Ae.prototype,"_updatingPromise",void 0),u([h({readOnly:!0,value:null})],Ae.prototype,"activeSource",null),u([h()],Ae.prototype,"activeSourceIndex",null),u([h()],Ae.prototype,"allPlaceholder",null),u([h({readOnly:!0})],Ae.prototype,"allSources",null),u([h()],Ae.prototype,"autoNavigate",void 0),u([h()],Ae.prototype,"autoSelect",void 0),u([h({type:_a})],Ae.prototype,"defaultPopupTemplate",null),u([h({readOnly:!0})],Ae.prototype,"defaultSources",void 0),u([h()],Ae.prototype,"defaultSymbols",void 0),u([h()],Ae.prototype,"includeDefaultSources",void 0),u([h()],Ae.prototype,"locationEnabled",null),u([h()],Ae.prototype,"maxInputLength",void 0),u([h()],Ae.prototype,"maxResults",void 0),u([h()],Ae.prototype,"maxSuggestions",void 0),u([h()],Ae.prototype,"messages",void 0),u([h()],Ae.prototype,"minSuggestCharacters",void 0),u([h({readOnly:!0})],Ae.prototype,"placeholder",null),u([h()],Ae.prototype,"popupEnabled",void 0),u([h({type:_a})],Ae.prototype,"popupTemplate",void 0),u([h({type:J})],Ae.prototype,"portal",void 0),u([h()],Ae.prototype,"resultCount",void 0),u([h()],Ae.prototype,"resultGraphicEnabled",void 0),u([h({readOnly:!0})],Ae.prototype,"resultGraphic",void 0),u([h({readOnly:!0})],Ae.prototype,"results",void 0),u([h({readOnly:!0})],Ae.prototype,"selectedSuggestion",void 0),u([h()],Ae.prototype,"searchAllEnabled",void 0),u([h({readOnly:!0})],Ae.prototype,"selectedResult",void 0),u([h()],Ae.prototype,"searchTerm",null),u([h({type:s1})],Ae.prototype,"sources",void 0),u([h({readOnly:!0})],Ae.prototype,"state",null),u([h()],Ae.prototype,"suggestionDelay",void 0),u([h()],Ae.prototype,"suggestionCount",void 0),u([h({readOnly:!0})],Ae.prototype,"suggestions",void 0),u([h()],Ae.prototype,"suggestionsEnabled",void 0),u([h({readOnly:!0})],Ae.prototype,"updating",null),u([h()],Ae.prototype,"view",void 0),u([h()],Ae.prototype,"clear",null),Ae=u([E("esri.widgets.Search.SearchViewModel")],Ae);const pf=Ae;let Yp=class extends gr{constructor(t,e){super(t,e),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}loadDependencies(){return xd({block:()=>q(()=>import("./index-6NnuGRWV.js"),__vite__mapDeps([341,278,279,280,281,337,285,284,283,282,342,330,331,288,335,332,340,291,290,326,327,287,343,344,345,346,329,286,333,334,336,324])),list:()=>q(()=>import("./index-DXIv5ycB.js"),__vite__mapDeps([347,278,279,280,281,337,285,284,283,327,282,348,322,349,286,287,288,335,289,290,291,350,351,331,352])),"list-item":()=>q(()=>import("./index-C0x0PH20.js"),__vite__mapDeps([353,282,283,279,284,342,285,330,331,288,335,332,340,291,281,290,278,280,326,327,287,343,344,345,346,352,354])),"list-item-group":()=>q(()=>import("./index-q34aSAzT.js"),__vite__mapDeps([355,288,354]))})}destroy(){this.viewModel=null}render(){return L("div",{class:this.classes(W4.base,Vr.widget)},this.viewModel?.selectedResult?.name??"",this._renderMoreResults())}_renderMoreResults(){if(!this.viewModel)return null;const{resultCount:t,results:e}=this.viewModel;return!t||t<2||!e?null:L("calcite-block",{class:W4.moreResults,collapsible:!0,expanded:this.showMoreResultsOpen,heading:va(this.messages.showMoreResults,{count:t-1}),onCalciteBlockClose:()=>this._toggleShowMoreResults(!1),onCalciteBlockOpen:()=>this._toggleShowMoreResults(!0)},e.map(r=>this._renderMoreResultsList(r,e?.length>1)))}_renderListItem(t){return L("calcite-list-item",{key:`result-${t.sourceIndex}-${t.key}`,label:t.name,onCalciteListItemSelect:()=>this._selectResult(t)})}_renderMoreResultsList(t,e){const{results:r}=t;if(!(r?.length??0)||!r)return null;const i=this.viewModel?.selectedResult,s=this._getSourceName(t.source,t.sourceIndex),n=r.filter(o=>o!==i).map(o=>this._renderListItem(o));return L("calcite-list",{label:s},e?L("calcite-list-item-group",{heading:s,key:`group-${t.sourceIndex}`},n):n)}_selectResult(t){this.showMoreResultsOpen=!1,this.viewModel?.select(t)}_toggleShowMoreResults(t){this.showMoreResultsOpen=t;const e=QT(this.viewModel?.view);e&&"reposition"in e&&typeof e.reposition=="function"&&e.reposition()}_getSourceName(t,e){return e===pf.ALL_INDEX?this.messages.all:t.name}};u([h(),js("esri/widgets/Search/t9n/Search")],Yp.prototype,"messages",void 0),u([h()],Yp.prototype,"showMoreResultsOpen",void 0),u([h()],Yp.prototype,"viewModel",void 0),Yp=u([E("esri.widgets.Search.SearchResultRenderer")],Yp);const UAe=Yp;let Re=class extends gr{constructor(t,e){super(t,e),this._currentLocationValue=`${this.id}-search-use-current-location`,this._autocompleteNode=null,this._focusAbortController=null,this._searchResultRenderer=new UAe,this._suggestController=null,this._searchController=null,this._lastSearchTerm="",this._locateFailed=!1,this._showNoResults=!1,this.disabled=!1,this.messages=null,this.messagesCommon=null,this.viewModel=new pf,this._renderSearchResultsContent=()=>this._searchResultRenderer,WS(U.getLogger(this),"Search","arcgis-search",{version:"4.33"}),this.addHandles([ie(()=>this.viewModel,r=>this._searchResultRenderer.viewModel=r,ft),ie(()=>this.viewModel.results,()=>this._searchResultRenderer.showMoreResultsOpen=!1),ie(()=>this.messages,r=>this.viewModel.messages=r),ie(()=>this.viewModel?.defaultPopupTemplate,r=>{r&&(r.content=this._renderSearchResultsContent)},ft),ie(()=>this.viewModel?.view?.popupElement&&this.viewModel?.defaultPopupTemplate,()=>{if(this.viewModel?.defaultPopupTemplate&&this.viewModel?.view?.popupElement){const r=document.createElement("arcgis-search-result-renderer");r.viewModel=this.viewModel,r.messages=this.messages,this.viewModel.defaultPopupTemplate.content=r}},ft)])}loadDependencies(){return xd({autocomplete:()=>q(()=>import("./index-k9jXQ34J.js"),__vite__mapDeps([356,282,283,279,284,348,322,349,285,327,286,281,287,288,335,289,290,280,291,323,330,331,332,351,350])),"autocomplete-item-group":()=>q(()=>import("./index-DW_2oknA.js"),[]),"autocomplete-item":()=>q(()=>import("./index-CejbJuga.js"),__vite__mapDeps([357,282,283,279,284,290,288])),button:()=>q(()=>import("./index-QMIhu610.js"),__vite__mapDeps([277,278,279,280,281,282,283,284,285,286,287,288,289,290,291])),dropdown:()=>q(()=>import("./index-CEFSOEwK.js"),__vite__mapDeps([342,285,283,279,330,331,288,335,284,332,340,291,281,290])),"dropdown-group":()=>q(()=>import("./index-xL-40f0N.js"),__vite__mapDeps([345,284,344])),"dropdown-item":()=>q(()=>import("./index-iSFRQJ-i.js"),__vite__mapDeps([343,282,283,279,284,285,290,288,291,281,344])),notice:()=>q(()=>import("./index-K1ZD-NXY.js"),__vite__mapDeps([358,282,283,279,284,285,332,290,280,281,291]))})}destroy(){this._cancelQueries(),this._searchResultRenderer=xt(this._searchResultRenderer),this._focusAbortController?.abort()}get _isDisabled(){const{state:t}=this.viewModel;return t==="disabled"||t==="loading"||this.disabled}get _showCurrentLocation(){return this.locationEnabled&&!this.searchTerm?.trim()}get _effectiveActiveMenu(){const{activeMenu:t}=this;return this._isDisabled?"none":t==="warning"?"suggestion":t}get activeMenu(){return"none"}set activeMenu(t){t==="warning"&&_K(U.getLogger(this),"activeMenu","warning",{replacement:"Use the value 'suggestion' instead",version:"4.32",warnOnce:!0}),this._overrideIfSome("activeMenu",t)}get activeSource(){return this.viewModel?.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(t){this.viewModel.activeSourceIndex=t}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(t){this.viewModel.allPlaceholder=t}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(t){this.viewModel.autoNavigate=t}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(t){this.viewModel.autoSelect=t}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return"search"}set icon(t){this._overrideIfSome("icon",t)}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(t){this.viewModel.includeDefaultSources=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(t){this.viewModel.locationEnabled=t}get maxResults(){return this.viewModel.maxResults}set maxResults(t){this.viewModel.maxResults=t}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(t){this.viewModel.maxSuggestions=t}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(t){this.viewModel.minSuggestCharacters=t}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(t){this.viewModel.popupEnabled=t}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(t){this.viewModel.popupTemplate=t}get portal(){return this.viewModel?.portal}set portal(t){this.viewModel&&(this.viewModel.portal=t)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(t){this.viewModel.resultGraphic=t}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(t){this.viewModel.resultGraphicEnabled=t}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(t){this.viewModel.searchAllEnabled=t}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(t){this.viewModel.searchTerm=t}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(t){this.viewModel.sources=t}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(t){this.viewModel.suggestionsEnabled=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}clear(){this._locateFailed=!1,this.viewModel.clear()}focus(){this._handleFocus(),this._emitFocus()}blur(){this._autocompleteNode?.blur(),this._emitBlur()}async search(t){this._cancelQueries();const e=new AbortController,{signal:r}=e;this._searchController=e;try{const i=await this.viewModel.search(t,{signal:r});return this._searchController!==e?void 0:(i?.numResults||(this._showNoResults=!0,this.activeMenu="suggestion"),this._searchController=null,i)}catch{return this._searchController!==e?void 0:void(this._searchController=null)}}async suggest(t){this._cancelSuggest();const e=new AbortController,{signal:r}=e;this._suggestController=e;try{const i=await this.viewModel.suggest(t,null,{signal:r});return this._suggestController!==e?void 0:(this._suggestController=null,i?.numResults&&(this.activeMenu="suggestion",this._scrollToTopSuggestion()),i)}catch{return this._suggestController!==e||(this._suggestController=null),null}}render(){return L("div",{class:this.classes(Dc.base,Vr.widget)},L("div",{class:Dc.container},this._renderSourcesMenu(),this._renderForm()))}_handleInputKeydown(t){t.key==="Tab"&&this._cancelSuggest()}_emitFocus(){this.emit("search-focus")}_emitBlur(){this.emit("search-blur")}async _handleFocus(){this._focusAbortController?.abort(),this._focusAbortController=new AbortController;const t=this._focusAbortController.signal;await hm(y6(t)),this._autocompleteNode?.setFocus()}_renderSourcesMenu(){const{messages:t,_isDisabled:e,_effectiveActiveMenu:r}=this,{allSources:i,searchAllEnabled:s}=this.viewModel;return i.length>1?L("calcite-dropdown",{bind:this,class:Dc.dropdown,disabled:e,open:r==="source",overlayPositioning:"fixed",onCalciteDropdownClose:this._handleSourceClose,onCalciteDropdownOpen:this._handleSourceOpen,onCalciteDropdownSelect:this._handleSourceSelect},L("calcite-button",{appearance:"outline-fill",iconStart:"caret-down",kind:"neutral",label:t.searchIn,slot:"trigger"}),L("calcite-dropdown-group",{groupTitle:t.searchIn},s?this._renderSource(pf.ALL_INDEX):null,i.map((n,o)=>this._renderSource(o)).toArray())):null}_renderUseCurrentLocation(){const{_currentLocationValue:t}=this;return L("calcite-autocomplete-item",{heading:this.messages.useCurrentLocation,iconStart:"gps-on",key:t,value:t})}_handleAutocompleteCreate(t){this._autocompleteNode=t}_handleCalciteAutocompleteTextInput(t){const e=t.target.inputValue;e!==this.viewModel.searchTerm&&(this.viewModel.searchTerm=e,e||this.clear(),this.suggest())}_handleAutocompleteOpen(){this.activeMenu="suggestion"}_handleAutocompleteClose(){this.activeMenu==="suggestion"&&(this.activeMenu="none")}_handleCalciteAutocompleteChange(t){const e=t.target.value;if(e===this._currentLocationValue)return void this._useCurrentLocation();const r=JSON.parse(e),i=this.viewModel.suggestions?.find(({sourceIndex:s})=>s===r.sourceIndex)?.results?.find(({key:s})=>`${s}`==`${r.key}`);i&&this.search(i)}_renderAutocomplete(){const{_effectiveActiveMenu:t,messages:e,_isDisabled:r}=this,{maxInputLength:i,placeholder:s,searchTerm:n,state:o}=this.viewModel,a=this.label??e.searchButtonTitle??"";return L("calcite-autocomplete",{afterCreate:this._handleAutocompleteCreate,autocomplete:"off",bind:this,class:Dc.autocomplete,disabled:r,icon:this.icon||!1,inputValue:n,label:a,loading:o==="searching",maxLength:i,name:this.id,onblur:this._emitBlur,onfocus:this._emitFocus,onkeydown:this._handleInputKeydown,open:t==="suggestion",overlayPositioning:"fixed",placeholder:s,title:n?"":s,onCalciteAutocompleteChange:this._handleCalciteAutocompleteChange,onCalciteAutocompleteClose:this._handleAutocompleteClose,onCalciteAutocompleteOpen:this._handleAutocompleteOpen,onCalciteAutocompleteTextChange:this._handleCalciteAutocompleteTextInput,onCalciteAutocompleteTextInput:this._handleCalciteAutocompleteTextInput},this._renderSuggestions(),this._renderNotices())}_renderForm(){return L("form",{bind:this,class:Dc.form,disabled:this._isDisabled,key:Dc.form,onsubmit:this._formSubmit,role:"search"},this._renderAutocomplete(),L("button",{class:Dc.submitButton,type:"submit"},this.label??this.messages.searchButtonTitle??""))}_renderSuggestGroup(t){return t.results?.map(e=>this._renderSuggestion(e))}_renderSuggestions(){const{suggestions:t}=this.viewModel;return this._showNoResults?null:this._showCurrentLocation?this._renderUseCurrentLocation():t?.map(e=>this._renderSuggestResults(e))}_renderSuggestResults(t){const{allSources:e,activeSourceIndex:r}=this.viewModel,{sourceIndex:i}=t,s=t.results?.length,n=e.length>1&&r===pf.ALL_INDEX,o=this._getSourceName(i);return s&&n?L("calcite-autocomplete-item-group",{heading:o,key:`suggestion-group-${o}-${i}`},this._renderSuggestGroup(t)):this._renderSuggestGroup(t)}_renderSuggestion({key:t,sourceIndex:e,text:r}){const i={key:t,sourceIndex:e};return L("calcite-autocomplete-item",{heading:r??this.messages.untitledResult,key:`suggestion_${t}`,value:JSON.stringify(i)})}_renderSource(t){const e=this._getSourceName(t);return L("calcite-dropdown-item",{"data-source-index":`${t}`,key:`source-${e}-${t}`,selected:t===this.viewModel.activeSourceIndex},e)}_renderNoResultsWarning(t){const{messages:e}=this,r=t?va(e.noResultsFoundForValue,{value:`"${t}"`}):e.noResultsFound;return L("calcite-notice",{icon:"exclamation-mark-triangle",key:"no-results-warning",kind:"warning",open:!0,slot:"content-bottom"},L("div",{slot:"title"},e.noResults),L("div",{slot:"message"},r))}_renderLocateError(){return L("calcite-notice",{icon:"exclamation-mark-circle",key:"locate-warning",kind:"danger",open:!0,slot:"content-bottom"},L("div",{slot:"message"},this.messages.locateError))}_renderNotices(){return this._locateFailed?this._renderLocateError():this._showNoResults?this._renderNoResultsWarning(this._lastSearchTerm??this.viewModel.searchTerm):null}async _useCurrentLocation(){this._cancelQueries();const t=new AbortController,{signal:e}=t;this._searchController=t;try{await this.viewModel.searchNearby({signal:e})}catch(r){Ur(r)||(this._locateFailed=!0,this.activeMenu="suggestion")}finally{this._searchController=null}}_handleSourceOpen(){this.activeMenu="source"}_handleSourceClose(){this.activeMenu==="source"&&(this.activeMenu="none")}_handleSourceSelect(t){const e=t.target.selectedItems[0].getAttribute("data-source-index");e&&(this.viewModel.activeSourceIndex=parseInt(e,10))}_cancelSuggest(){this.activeMenu="none",this._locateFailed=!1,this._showNoResults=!1,this._suggestController=Tl(this._suggestController)}_cancelQueries(){this._cancelSuggest(),this._searchController=Tl(this._searchController)}_scrollToTopSuggestion(){this._autocompleteNode?.scrollContentTo({top:0})}_formSubmit(t){t.preventDefault(),this.activeMenu="none",this._lastSearchTerm=this.searchTerm,this.searchTerm&&this.search()}_getSourceName(t){const{messages:e}=this,{allSources:r}=this.viewModel,i=r.at(t);return t===pf.ALL_INDEX?e.all:i?.name||e.untitledSource}};u([h()],Re.prototype,"_locateFailed",void 0),u([h()],Re.prototype,"_showNoResults",void 0),u([h()],Re.prototype,"_isDisabled",null),u([h()],Re.prototype,"_showCurrentLocation",null),u([h()],Re.prototype,"_effectiveActiveMenu",null),u([h()],Re.prototype,"activeMenu",null),u([h({readOnly:!0})],Re.prototype,"activeSource",null),u([h()],Re.prototype,"activeSourceIndex",null),u([h()],Re.prototype,"allPlaceholder",null),u([h({readOnly:!0})],Re.prototype,"allSources",null),u([h()],Re.prototype,"autoNavigate",null),u([h()],Re.prototype,"autoSelect",null),u([h({readOnly:!0})],Re.prototype,"defaultSources",null),u([h()],Re.prototype,"disabled",void 0),u([h()],Re.prototype,"goToOverride",null),u([h()],Re.prototype,"icon",null),u([h()],Re.prototype,"includeDefaultSources",null),u([h()],Re.prototype,"label",null),u([h()],Re.prototype,"locationEnabled",null),u([h()],Re.prototype,"maxResults",null),u([h()],Re.prototype,"maxSuggestions",null),u([h(),js("esri/widgets/Search/t9n/Search")],Re.prototype,"messages",void 0),u([h(),js("esri/t9n/common")],Re.prototype,"messagesCommon",void 0),u([h()],Re.prototype,"minSuggestCharacters",null),u([h()],Re.prototype,"popupEnabled",null),u([h()],Re.prototype,"popupTemplate",null),u([h()],Re.prototype,"portal",null),u([h()],Re.prototype,"resultGraphic",null),u([h()],Re.prototype,"resultGraphicEnabled",null),u([h({readOnly:!0})],Re.prototype,"results",null),u([h()],Re.prototype,"searchAllEnabled",null),u([h()],Re.prototype,"searchTerm",null),u([h({readOnly:!0})],Re.prototype,"selectedResult",null),u([h()],Re.prototype,"sources",null),u([h({readOnly:!0})],Re.prototype,"suggestions",null),u([h()],Re.prototype,"suggestionsEnabled",null),u([h()],Re.prototype,"view",null),u([OLe(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),h({type:pf})],Re.prototype,"viewModel",void 0),Re=u([E("esri.widgets.Search")],Re);const GAe=Re,qAe="https://services8.arcgis.com/jzdN07B7ZhRTxuzU/arcgis/rest/services/Streetlights_Inspections/FeatureServer/0",n1=[-96.7,40.81],o1=13;document.querySelector("#app").innerHTML=`
  <div id="app-container">
    <div id="sidebar">
      <h2>Streetlight Web Map</h2>
      <p class="subtitle">Internal-style GIS operations viewer</p>

      <div class="section">
        <label>
          <input type="checkbox" id="layerToggle" checked />
          Show Streetlights Layer
        </label>
        <div id="loadedInfo" class="info">Loading layer</div>
      </div>

      <div class="section">
        <label for="filterSelect">Filter</label>
        <select id="filterSelect">
          <option value="ALL">All</option>
          <option value="BROKEN">Broken</option>
          <option value="HIGH">High Priority</option>
          <option value="NEEDSREVIEW">Needs Review</option>
        </select>

        <button id="clearBtn">Clear filter</button>
        <button id="resetViewBtn">Reset view</button>
      </div>

      <div class="section">
        <label>
          <input type="checkbox" id="clusterToggle" checked />
          Cluster points
        </label>
      </div>

      <p class="hint">Tip: Use Search (top-left) to jump to an address.</p>
    </div>

    <div id="viewDiv"></div>
  </div>
`;const zJ=new G9({basemap:"streets-navigation-vector"}),ks=new ebe({container:"viewDiv",map:zJ,center:n1,zoom:o1}),BAe=new GAe({view:ks});ks.ui.add(BAe,"top-left");const Sa=new ce({url:qAe,outFields:["*"],popupTemplate:{title:"Light {LightID}",content:[{type:"text",text:"<b>Status:</b> {Status}<br/><b>Priority:</b> {Priority}<br/><b>Needs Review:</b> {NeedsReview}"},{type:"fields",fieldInfos:[{fieldName:"Condition",label:"Condition"},{fieldName:"InspectionDate",label:"Inspection Date"},{fieldName:"Inspector",label:"Inspector"},{fieldName:"Notes",label:"Notes"}]}]}});Sa.featureReduction={type:"cluster",clusterRadius:"60px"};zJ.add(Sa);const HAe=new RLe({view:ks}),WAe=new zLe({view:ks,content:HAe,expanded:!1});ks.ui.add(WAe,"top-right");const ZAe=document.getElementById("layerToggle"),jJ=document.getElementById("filterSelect"),JAe=document.getElementById("clearBtn"),YAe=document.getElementById("resetViewBtn"),XAe=document.getElementById("clusterToggle"),PC=document.getElementById("loadedInfo");let ff=null;Sa.when(async()=>{try{const t=await Sa.queryExtent({where:"1=1"});if(t?.extent){const e=t.extent.expand(1.6),r=e.xmax-e.xmin,i=e.ymax-e.ymin;r>10||i>10?(await ks.goTo({center:n1,zoom:o1}),ff=ks.extent):(await ks.goTo(e),ff=e)}else await ks.goTo({center:n1,zoom:o1}),ff=ks.extent;await eA()}catch(t){console.error(t),await ks.goTo({center:n1,zoom:o1}),ff=ks.extent,PC.textContent="Layer loaded (fallback view)"}});function KAe(t){return t==="BROKEN"?"Status = 'Broken'":t==="HIGH"?"Priority = 'High'":t==="NEEDSREVIEW"?"NeedsReview = 1 OR NeedsReview = 'Yes' OR NeedsReview = true":"1=1"}ZAe.addEventListener("change",t=>{Sa.visible=t.target.checked});jJ.addEventListener("change",async t=>{Sa.definitionExpression=KAe(t.target.value),await eA()});JAe.addEventListener("click",async()=>{Sa.definitionExpression="1=1",jJ.value="ALL",await eA()});YAe.addEventListener("click",async()=>{ff&&await ks.goTo(ff)});XAe.addEventListener("change",t=>{Sa.featureReduction=t.target.checked?{type:"cluster",clusterRadius:"60px"}:null});async function eA(){try{const t=await Sa.queryFeatureCount({where:Sa.definitionExpression||"1=1"});PC.textContent=`Loaded: ${t} features`}catch{PC.textContent="Loaded: count unavailable"}}export{W as $,Qt as A,de as B,Be as C,gt as D,fH as E,F2e as F,sx as G,Bye as H,Er as I,ASe as J,Ose as K,QF as L,J as M,fr as N,y5e as O,RSe as P,g5e as Q,vT as R,OSe as S,z as T,O as U,xr as V,v5e as W,Xv as X,fe as Y,Ie as Z,q as _,hL as a,xv as a$,mc as a0,pae as a1,Km as a2,hae as a3,Ele as a4,T9 as a5,bk as a6,Ule as a7,u as a8,h as a9,ZH as aA,$$e as aB,JH as aC,WH as aD,O$e as aE,C$e as aF,m$e as aG,v$e as aH,_d as aI,w2 as aJ,gye as aK,Ym as aL,mae as aM,yae as aN,gae as aO,t8 as aP,Ile as aQ,Gye as aR,Z0 as aS,kS as aT,Kt as aU,Xr as aV,Pf as aW,WNe as aX,m5 as aY,MDe as aZ,b8 as a_,E as aa,hVe as ab,cVe as ac,ps as ad,se as ae,wme as af,Rt as ag,Rse as ah,Lse as ai,U as aj,R5e as ak,cm as al,JVe as am,CNe as an,Bm as ao,Cr as ap,nd as aq,ya as ar,g$e as as,Bi as at,R$e as au,jG as av,kye as aw,Qye as ax,k3 as ay,E$e as az,hje as b,YP as b$,sZ as b0,yd as b1,Vpe as b2,ise as b3,Ne as b4,ye as b5,ne as b6,ac as b7,jv as b8,Ln as b9,Ni as bA,Yze as bB,z0e as bC,wPe as bD,vZ as bE,kf as bF,Mm as bG,J0 as bH,yt as bI,mn as bJ,JC as bK,it as bL,Vm as bM,$i as bN,Zt as bO,_Fe as bP,vFe as bQ,wFe as bR,Um as bS,dt as bT,yz as bU,Iee as bV,OOe as bW,J6 as bX,qi as bY,L0 as bZ,Nw as b_,Upe as ba,ar as bb,jt as bc,Mje as bd,rje as be,vje as bf,fje as bg,Po as bh,Fe as bi,ik as bj,jn as bk,yc as bl,pr as bm,IF as bn,Pc as bo,kc as bp,sz as bq,oz as br,az as bs,dRe as bt,oRe as bu,REe as bv,HRe as bw,M6e as bx,F6e as by,uv as bz,sxe as c,Qr as c$,aG as c0,lr as c1,Oh as c2,Mne as c3,aFe as c4,lFe as c5,Zx as c6,S2 as c7,WP as c8,ZP as c9,kl as cA,yje as cB,X as cC,Ci as cD,xA as cE,Ur as cF,zue as cG,je as cH,AC as cI,ed as cJ,Lz as cK,r0 as cL,up as cM,Ev as cN,_e as cO,Dr as cP,ue as cQ,Uxe as cR,gl as cS,Vxe as cT,hue as cU,ite as cV,nte as cW,ste as cX,ote as cY,qOe as cZ,BOe as c_,j8 as ca,z8 as cb,Qoe as cc,ll as cd,CT as ce,K5e as cf,Gi as cg,JP as ch,lp as ci,pOe as cj,KG as ck,wH as cl,rse as cm,hn as cn,DP as co,yde as cp,I3e as cq,yse as cr,mse as cs,nc as ct,_de as cu,fde as cv,dc as cw,T9e as cx,VU as cy,$y as cz,dA as d,xi as d$,YM as d0,g0 as d1,w0e as d2,_ze as d3,Le as d4,Sze as d5,ty as d6,h2 as d7,hP as d8,qm as d9,I_ as dA,De as dB,Gv as dC,kI as dD,yFe as dE,aDe as dF,IDe as dG,la as dH,j6 as dI,ie as dJ,ft as dK,Zn as dL,pi as dM,yr as dN,d6 as dO,xM as dP,T0e as dQ,tz as dR,f1e as dS,PMe as dT,Et as dU,Wa as dV,BT as dW,VP as dX,le as dY,qRe as dZ,Pv as d_,Bh as da,xt as db,S7e as dc,pn as dd,W7 as de,MNe as df,E2 as dg,Fhe as dh,Ti as di,kC as dj,P5e as dk,Te as dl,sp as dm,Dt as dn,Vs as dp,ej as dq,X_ as dr,A_ as ds,Cee as dt,me as du,iq as dv,N3 as dw,tve as dx,aMe as dy,_a as dz,gje as e,ade as e$,hm as e0,GRe as e1,YOe as e2,AG as e3,LG as e4,iRe as e5,sRe as e6,io as e7,zv as e8,W0 as e9,ny as eA,r7e as eB,i7e as eC,XTe as eD,UEe as eE,_pe as eF,fDe as eG,CDe as eH,jee as eI,t7e as eJ,yT as eK,z8e as eL,D8e as eM,D6 as eN,$De as eO,Une as eP,S5e as eQ,uz as eR,lz as eS,e8 as eT,oj as eU,Npe as eV,Yhe as eW,ENe as eX,ga as eY,Qm as eZ,hk as e_,zG as ea,FG as eb,wye as ec,DG as ed,vP as ee,wP as ef,Uee as eg,Gee as eh,t2 as ei,r2 as ej,Ck as ek,Pk as el,Nxe as em,hs as en,MRe as eo,YRe as ep,Fm as eq,YIe as er,Pe as es,YTe as et,dv as eu,K as ev,wW as ew,P0 as ex,xW as ey,x9e as ez,pje as f,wa as f$,kNe as f0,Rs as f1,DU as f2,C2 as f3,PNe as f4,E5e as f5,an as f6,i2 as f7,Aye as f8,cd as f9,PX as fA,IN as fB,P1 as fC,Xm as fD,ZRe as fE,Ch as fF,Gbe as fG,gMe as fH,SMe as fI,gB as fJ,m1e as fK,Ube as fL,H1e as fM,Z1e as fN,$ye as fO,Mye as fP,Zye as fQ,Ri as fR,CMe as fS,Y1e as fT,W1e as fU,Ot as fV,er as fW,Pt as fX,ci as fY,vi as fZ,Il as f_,zs as fa,XRe as fb,SK as fc,rOe as fd,gX as fe,aa as ff,HC as fg,mue as fh,q$e as fi,vc as fj,Nye as fk,wle as fl,vye as fm,NG as fn,Wye as fo,T5e as fp,zS as fq,jS as fr,Dz as fs,Cu as ft,PAe as fu,zOe as fv,DOe as fw,He as fx,ZVe as fy,kRe as fz,tje as g,Cv as g$,l5e as g0,fne as g1,R0 as g2,ml as g3,td as g4,cs as g5,te as g6,AMe as g7,Xs as g8,qS as g9,aoe as gA,Zfe as gB,d9 as gC,kk as gD,y1e as gE,Uye as gF,mNe as gG,f8e as gH,pNe as gI,Vv as gJ,Mr as gK,fNe as gL,v8e as gM,Kp as gN,Rl as gO,oc as gP,yNe as gQ,Bu as gR,$U as gS,zz as gT,zX as gU,S9e as gV,$M as gW,_je as gX,Jae as gY,HOe as gZ,FRe as g_,i9e as ga,sVe as gb,lj as gc,Z6 as gd,ZMe as ge,z1 as gf,Ue as gg,Yr as gh,A0 as gi,c1 as gj,bje as gk,El as gl,ce as gm,xl as gn,AX as go,V0 as gp,E8 as gq,zt as gr,yi as gs,Ke as gt,F5e as gu,vm as gv,lO as gw,oFe as gx,mFe as gy,M2 as gz,DS as h,c9 as h$,M2e as h0,Dbe as h1,uVe as h2,k1e as h3,lVe as h4,P1e as h5,YC as h6,Ir as h7,KVe as h8,L9e as h9,ju as hA,pVe as hB,ZOe as hC,Zee as hD,lte as hE,mj as hF,zi as hG,Ooe as hH,C5e as hI,$oe as hJ,Dye as hK,QOe as hL,nR as hM,sj as hN,nj as hO,Vt as hP,I5e as hQ,dle as hR,M9 as hS,Kde as hT,Cye as hU,I9 as hV,Dee as hW,$ae as hX,gle as hY,xae as hZ,$2 as h_,O_ as ha,FT as hb,Xp as hc,s2 as hd,gFe as he,gd as hf,gme as hg,St as hh,qze as hi,PL as hj,LEe as hk,SDe as hl,cDe as hm,q5e as hn,Bx as ho,oVe as hp,Nne as hq,md as hr,xS as hs,nO as ht,O1e as hu,qe as hv,zm as hw,Dm as hx,Tr as hy,kTe as hz,Q6e as i,cS as i$,nRe as i0,k_ as i1,gRe as i2,zye as i3,Eye as i4,k$e as i5,Td as i6,y7 as i7,lDe as i8,ck as i9,Qn as iA,wje as iB,ooe as iC,eO as iD,ULe as iE,r9e as iF,qV as iG,U0 as iH,mm as iI,w8e as iJ,Mu as iK,uje as iL,mwe as iM,Y6e as iN,Bwe as iO,ywe as iP,X6e as iQ,B6e as iR,q6e as iS,Wwe as iT,Cg as iU,J6e as iV,Sje as iW,W0e as iX,v6e as iY,rq as iZ,$6e as i_,L1 as ia,tDe as ib,eDe as ic,Qde as id,f8 as ie,_t as ig,jue as ih,tOe as ii,A2e as ij,HX as ik,KC as il,R2e as im,B$e as io,fc as ip,cue as iq,lue as ir,oue as is,Hx as it,Hi as iu,w9 as iv,g8 as iw,mf as ix,SX as iy,fa as iz,$je as j,X5e as j$,S6e as j0,b0 as j1,x6e as j2,N6 as j3,Fn as j4,xb as j5,f6e as j6,S4e as j7,R8 as j8,G0 as j9,Hee as jA,pa as jB,ame as jC,Ik as jD,Ine as jE,z5e as jF,v1 as jG,ox as jH,Hb as jI,Zoe as jJ,fae as jK,Sye as jL,Kye as jM,ege as jN,Aoe as jO,zee as jP,l9 as jQ,dae as jR,xye as jS,RG as jT,iDe as jU,rDe as jV,ui as jW,v2 as jX,g2 as jY,TT as jZ,G5e as j_,PT as ja,hd as jb,Ioe as jc,N8 as jd,WRe as je,KK as jf,Om as jg,nv as jh,Obe as ji,Vi as jj,MOe as jk,J_e as jl,Tl as jm,VC as jn,CX as jo,U5e as jp,Hae as jq,Toe as jr,xf as js,O8 as jt,Xt as ju,tRe as jv,yG as jw,BP as jx,I as jy,ate as jz,BX as k,t5 as k$,rt as k0,uO as k1,DX as k2,p9 as k3,Uje as k4,mr as k5,KRe as k6,fU as k7,dee as k8,Boe as k9,cW as kA,iM as kB,Yse as kC,OC as kD,bRe as kE,FC as kF,SRe as kG,Zv as kH,Sf as kI,Bfe as kJ,XX as kK,T6e as kL,BK as kM,fOe as kN,XVe as kO,YVe as kP,uH as kQ,aH as kR,Uv as kS,wk as kT,rd as kU,BS as kV,bMe as kW,I1e as kX,mMe as kY,N1e as kZ,OMe as k_,kVe as ka,LFe as kb,IFe as kc,VLe as kd,mo as ke,wRe as kf,_Re as kg,vRe as kh,fd as ki,fX as kj,QS as kk,Un as kl,D2e as km,Nze as kn,Fze as ko,Oze as kp,Rze as kq,zze as kr,Dze as ks,Aze as kt,Lze as ku,Eoe as kv,SA as kw,kze as kx,SP as ky,Ate as kz,i8e as l,Gm as l$,CU as l0,YMe as l1,L2e as l2,Q1e as l3,K2 as l4,AD as l5,bt as l6,gE as l7,X2 as l8,rMe as l9,p6e as lA,Pte as lB,Nte as lC,kv as lD,e5e as lE,See as lF,iP as lG,_Oe as lH,wOe as lI,ine as lJ,iQ as lK,rQ as lL,Z5e as lM,H5e as lN,cRe as lO,Th as lP,kX as lQ,Rn as lR,oxe as lS,R1e as lT,l2e as lU,oH as lV,v2e as lW,_z as lX,Iz as lY,N6e as lZ,ze as l_,tw as la,B1e as lb,Io as lc,VMe as ld,WX as le,c9e as lf,KS as lg,Ov as lh,JY as li,Sk as lj,uDe as lk,oDe as ll,IO as lm,$o as ln,cv as lo,lL as lp,K1e as lq,X1e as lr,J1e as ls,Gme as lt,qme as lu,aB as lv,QD as lw,OG as lx,b5e as ly,Hfe as lz,Vq as m,NRe as m$,sr as m0,mt as m1,Os as m2,b9e as m3,_9e as m4,ki as m5,w2e as m6,x2e as m7,JB as m8,rx as m9,$9e as mA,op as mB,p5e as mC,Z_ as mD,p8 as mE,Q5e as mF,jFe as mG,VFe as mH,UFe as mI,dFe as mJ,cFe as mK,nFe as mL,boe as mM,uFe as mN,Xoe as mO,Mse as mP,D5e as mQ,zFe as mR,QDe as mS,Gh as mT,Vne as mU,Kve as mV,swe as mW,qY as mX,LRe as mY,wz as mZ,US as m_,yS as ma,q1e as mb,pt as mc,E2e as md,o2e as me,a2e as mf,c2e as mg,h2e as mh,S2e as mi,d2e as mj,p2e as mk,f2e as ml,m2e as mm,y2e as mn,g2e as mo,Fr as mp,NOe as mq,Sv as mr,gr as ms,xd as mt,L as mu,va as mv,js as mw,Ije as mx,Vr as my,zA as mz,mje as n,X8e as n$,TF as n0,Cne as n1,y8 as n2,FUe as n3,NUe as n4,uS as n5,OUe as n6,_8 as n7,XUe as n8,N0e as n9,$v as nA,QRe as nB,QVe as nC,FM as nD,p1e as nE,gS as nF,_2 as nG,NFe as nH,FFe as nI,I8 as nJ,M8 as nK,eoe as nL,roe as nM,Ju as nN,pve as nO,b7e as nP,mve as nQ,yve as nR,Kz as nS,dNe as nT,To as nU,t8e as nV,pH as nW,nP as nX,so as nY,mp as nZ,br as n_,Bze as na,Hze as nb,F0e as nc,YUe as nd,wi as ne,AVe as nf,RVe as ng,LVe as nh,jL as ni,iZ as nj,Ll as nk,Al as nl,to as nm,sc as nn,Qe as no,ePe as np,lTe as nq,jD as nr,lc as ns,ffe as nt,zU as nu,jU as nv,e7e as nw,e9 as nx,V5e as ny,g$ as nz,Uq as o,ARe as o$,Vp as o0,vMe as o1,$s as o2,s9e as o3,y8e as o4,jVe as o5,WUe as o6,jme as o7,Gze as o8,$Re as o9,WC as oA,PRe as oB,Cz as oC,aj as oD,wA as oE,Uz as oF,jve as oG,c8e as oH,wd as oI,ko as oJ,kxe as oK,k5e as oL,nDe as oM,sDe as oN,qC as oO,Cle as oP,Tle as oQ,Pye as oR,Mle as oS,a9 as oT,W6 as oU,ipe as oV,F8 as oW,$5e as oX,NP as oY,bve as oZ,jz as o_,Yde as oa,hle as ob,ple as oc,_le as od,ji as oe,Qa as of,ku as og,hr as oh,xpe as oi,ig as oj,Jme as ok,Eze as ol,Wg as om,wl as on,o0 as oo,b2e as op,vNe as oq,P2e as or,WVe as os,m9 as ot,HVe as ou,I0 as ov,Yu as ow,j0 as ox,LMe as oy,nz as oz,pc as p,jEe as p$,xT as p0,Pde as p1,rRe as p2,SU as p3,ET as p4,p9e as p5,i4e as p6,r4e as p7,Wfe as p8,nL as p9,aEe as pA,UUe as pB,GUe as pC,NEe as pD,F9e as pE,Coe as pF,d9e as pG,Id as pH,GTe as pI,ky as pJ,w5e as pK,JUe as pL,ZUe as pM,HUe as pN,BUe as pO,k0e as pP,Ed as pQ,uk as pR,qxe as pS,gNe as pT,dxe as pU,Xxe as pV,M8e as pW,l6e as pX,_8e as pY,F4 as pZ,oPe as p_,dSe as pa,a9e as pb,xP as pc,FOe as pd,UP as pe,Od as pf,jY as pg,ZM as ph,y6e as pi,zve as pj,g6e as pk,m6e as pl,eq as pm,IPe as pn,MUe as po,jk as pp,qUe as pq,YSe as pr,FVe as ps,zUe as pt,DL as pu,S_ as pv,RZ as pw,jUe as px,DUe as py,Di as pz,RRe as q,TSe as q$,m2 as q0,_4 as q1,e6e as q2,VUe as q3,yD as q4,QG as q5,bVe as q6,xee as q7,f7 as q8,SVe as q9,bUe as qA,L8e as qB,G0e as qC,U0e as qD,YG as qE,IZ as qF,CUe as qG,PUe as qH,XG as qI,N2 as qJ,$l as qK,da as qL,gi as qM,HP as qN,S8 as qO,Fv as qP,jRe as qQ,LL as qR,Jv as qS,uc as qT,sy as qU,It as qV,lSe as qW,aSe as qX,Ge as qY,Eu as qZ,RIe as q_,Es as qa,nl as qb,xm as qc,d1e as qd,E1e as qe,C1e as qf,F1e as qg,uMe as qh,_Me as qi,jDe as qj,VDe as qk,UDe as ql,ln as qm,QL as qn,C9e as qo,P9e as qp,Rh as qq,Uu as qr,E9e as qs,RP as qt,JRe as qu,I9e as qv,M9e as qw,mRe as qx,mG as qy,aPe as qz,jq as r,UOe as r$,OIe as r0,HB as r1,Bn as r2,Wn as r3,il as r4,e4e as r5,O$ as r6,c5e as r7,G1 as r8,Ds as r9,_6 as rA,Xne as rB,Kne as rC,j_e as rD,fn as rE,z2 as rF,pye as rG,mOe as rH,fG as rI,gG as rJ,$me as rK,$4e as rL,Ame as rM,M4e as rN,rle as rO,d5e as rP,JOe as rQ,yl as rR,Fi as rS,m5e as rT,VRe as rU,b0e as rV,Ene as rW,pRe as rX,uRe as rY,pz as rZ,GOe as r_,Hye as ra,uoe as rb,k1 as rc,WOe as rd,ax as re,Wne as rf,u5e as rg,zr as rh,us as ri,Nr as rj,H$e as rk,upe as rl,fpe as rm,EDe as rn,W$e as ro,kEe as rp,QK as rq,BRe as rr,oZ as rs,gc as rt,gj as ru,qfe as rv,coe as rw,hoe as rx,W_ as ry,j5e as rz,R as s,OH as s$,A5e as s0,Fz as s1,hfe as s2,Yfe as s3,Lo as s4,cq as s5,xRe as s6,s6e as s7,n6e as s8,o6e as s9,vhe as sA,hNe as sB,UVe as sC,zde as sD,INe as sE,_Ne as sF,xNe as sG,bNe as sH,$Ne as sI,SNe as sJ,TNe as sK,Mi as sL,R6e as sM,GVe as sN,mA as sO,wNe as sP,mte as sQ,fte as sR,XOe as sS,SQ as sT,A8e as sU,R8e as sV,I8e as sW,c$e as sX,tr as sY,hW as sZ,$8e as s_,a6e as sa,Wze as sb,Jze as sc,Jse as sd,ev as se,Zze as sf,fve as sg,Lee as sh,n5e as si,t4e as sj,af as sk,y6 as sl,VOe as sm,jOe as sn,rte as so,U2 as sp,Qve as sq,TFe as sr,Y2 as ss,ND as st,N8e as su,Ize as sv,vC as sw,EUe as sx,oh as sy,x1e as sz,JMe as t,Tq as t$,nx as t0,k8e as t1,SUe as t2,C8e as t3,xe as t4,d$e as t5,a$e as t6,E8e as t7,FZ as t8,bS as t9,qEe as tA,PEe as tB,t6e as tC,r6e as tD,u6e as tE,c6e as tF,jze as tG,h6e as tH,d6e as tI,O0e as tJ,q0e as tK,D0e as tL,Sq as tM,pm as tN,i6e as tO,M0e as tP,ORe as tQ,Poe as tR,u4 as tS,z3e as tT,gde as tU,H6e as tV,W6e as tW,i1 as tX,NLe as tY,k2 as tZ,Mde as t_,T0 as ta,_S as tb,DH as tc,NH as td,GEe as te,s$e as tf,i$e as tg,ZE as th,Qze as ti,o$e as tj,ew as tk,V0e as tl,xUe as tm,u$e as tn,$Ue as to,Kze as tp,TUe as tq,T8e as tr,xPe as ts,SPe as tt,$Z as tu,Q0e as tv,ske as tw,Xze as tx,Cze as ty,Pze as tz,r8e as u,fle as u$,X0 as u0,Q0 as u1,Im as u2,wde as u3,TRe as u4,eSe as u5,DLe as u6,Lde as u7,Ade as u8,vk as u9,w6e as uA,o9e as uB,O6e as uC,L6e as uD,A6e as uE,k6e as uF,P6e as uG,hve as uH,uq as uI,Uze as uJ,Vze as uK,lve as uL,fM as uM,pPe as uN,Tze as uO,GY as uP,Xye as uQ,hRe as uR,_De as uS,bDe as uT,Roe as uU,Ble as uV,qle as uW,r9 as uX,XH as uY,bhe as uZ,yle as u_,tB as ua,Z4 as ub,OLe as uc,Iae as ud,moe as ue,Y5e as uf,a4e as ug,Ole as uh,T8 as ui,i9 as uj,g6 as uk,_0 as ul,DRe as um,Rle as un,qFe as uo,Hxe as up,J5e as uq,Kr as ur,Mue as us,MF as ut,u9e as uu,l9e as uv,mTe as uw,_6e as ux,b6e as uy,x5e as uz,cc as v,aRe as v$,mle as v0,kle as v1,Gle as v2,HH as v3,EFe as v4,Ufe as v5,Sle as v6,x4e as v7,xje as v8,b4e as v9,mDe as vA,IRe as vB,FDe as vC,ODe as vD,yRe as vE,vee as vF,hDe as vG,B5e as vH,xDe as vI,Cm as vJ,che as vK,Yme as vL,TG as vM,zRe as vN,e_ as vO,$O as vP,HNe as vQ,Vn as vR,OVe as vS,Jr as vT,oW as vU,h9e as vV,WE as vW,x7e as vX,m4e as vY,DY as vZ,lRe as v_,d8e as va,xoe as vb,eFe as vc,iFe as vd,pFe as ve,tFe as vf,sFe as vg,fFe as vh,Koe as vi,b1 as vj,p8e as vk,m8e as vl,G$e as vm,Yae as vn,N5e as vo,$ne as vp,qv as vq,Bv as vr,Hv as vs,dVe as vt,Cfe as vu,f4e as vv,MSe as vw,TDe as vx,pDe as vy,gDe as vz,f5e as w,Joe as w0,yDe as w1,lle as w2,SIe as w3,x8e as w4,lW as w5,rf as w6,tpe as w7,_5e as w8,YNe as w9,lx as wA,w9e as wB,Ple as wC,bFe as wD,xFe as wE,D6e as wF,$d as wG,VVe as wH,e9e as wI,s7e as wJ,xke as wK,o7e as wL,QB as wa,jW as wb,VW as wc,t2e as wd,dDe as we,M5e as wf,soe as wg,epe as wh,V9e as wi,$P as wj,m9e as wk,Tj as wl,kFe as wm,y9e as wn,g9e as wo,vDe as wp,PFe as wq,CFe as wr,W5e as ws,tk as wt,URe as wu,wDe as wv,vle as ww,v9e as wx,f9e as wy,Xde as wz,cne as x,ixe as y,Me as z};
