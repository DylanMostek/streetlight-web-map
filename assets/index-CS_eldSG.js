import"./index-eZ7plO2N.js";import"./index-CtERAtCl.js";import{I as P,V as U}from"./index-D-_kipaA.js";import{b8 as q,b9 as R,gL as G,gM as W,L as j,k as g,g as z,A as d,b as v,e as C,i as K,f as N}from"./index-DE310Q7V.js";import{M as J,u as b,v as x,h as A,p as Q,n as w}from"./ref-DiNYH2fk.js";import{u as X}from"./index-B4ivsQHK.js";import{e as D,r as Y,c as I,b as Z,F as B}from"./floating-ui-rZ1T4ph8.js";import{u as _,I as tt}from"./interactive-D0UXWvWJ.js";import{t as et}from"./openCloseComponent-Bc4Rr28V.js";import{c as it,d as at,g as nt}from"./label-DPVFTtZI.js";import{c as lt,a as st,d as ot,s as ct,H as rt}from"./form-C9WjqB8z.js";import{s as F}from"./dom-Dbu7u2il.js";import{g as ut}from"./guid-LcV_DAvu.js";import{u as pt}from"./useT9n-batAzzaF.js";import{u as ht}from"./useCancelable-KAn6mN7I.js";import{c as L,u as dt}from"./observers-CI5UoSiI.js";import{u as mt}from"./useSetFocus-s9LPTrqX.js";import{d as ft}from"./debounce-D0Dr7phT.js";import{e as gt}from"./escapeRegExp-CkRNPaSc.js";import"./keyed-CDwFcUPt.js";import"./static-C0vYvor8.js";import"./key-Cyh_1epf.js";import"./component-CFIS4ihw.js";const V=(l,t,i)=>{const c=new Map;for(let e=t;e<=i;e++)c.set(l[e],e);return c},bt=q(class extends R{constructor(l){if(super(l),l.type!==G.CHILD)throw Error("repeat() can only be used in text expressions")}dt(l,t,i){let c;i===void 0?i=t:t!==void 0&&(c=t);const e=[],n=[];let a=0;for(const r of l)e[a]=c?c(r,a):a,n[a]=i(r,a),a++;return{values:n,keys:e}}render(l,t,i){return this.dt(l,t,i).values}update(l,[t,i,c]){const e=J(l),{values:n,keys:a}=this.dt(t,i,c);if(!Array.isArray(e))return this.ut=a,n;const r=this.ut??=[],h=[];let y,O,s=0,u=e.length-1,o=0,p=n.length-1;for(;s<=u&&o<=p;)if(e[s]===null)s++;else if(e[u]===null)u--;else if(r[s]===a[o])h[o]=b(e[s],n[o]),s++,o++;else if(r[u]===a[p])h[p]=b(e[u],n[p]),u--,p--;else if(r[s]===a[p])h[p]=b(e[s],n[p]),x(l,h[p+1],e[s]),s++,p--;else if(r[u]===a[o])h[o]=b(e[u],n[o]),x(l,e[s],e[u]),u--,o++;else if(y===void 0&&(y=V(a,o,p),O=V(r,s,u)),y.has(r[s]))if(y.has(r[u])){const m=O.get(a[o]),k=m!==void 0?e[m]:null;if(k===null){const S=x(l,e[s]);b(S,n[o]),h[o]=S}else h[o]=b(k,n[o]),x(l,e[s],k),e[m]=null;o++}else A(e[u]),u--;else A(e[s]),s++;for(;o<=p;){const m=x(l,h[p+1]);b(m,n[o]),h[o++]=m}for(;s<=u;){const m=e[s++];m!==null&&A(m)}return this.ut=a,Q(l,h),W}});const vt=K`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{position:relative;display:block}.input-container{position:relative;display:flex;flex:1 1 auto;flex-wrap:nowrap}.input{width:100%;--calcite-input-prefix-size: var(--calcite-autocomplete-input-prefix-size);--calcite-input-suffix-size: var(--calcite-autocomplete-input-suffix-size);--calcite-input-background-color: var(--calcite-autocomplete-input-background-color);--calcite-input-border-color: var(--calcite-autocomplete-input-border-color);--calcite-input-corner-radius: var(--calcite-autocomplete-input-corner-radius);--calcite-input-shadow: var(--calcite-autocomplete-input-shadow);--calcite-input-icon-color: var(--calcite-autocomplete-input-icon-color);--calcite-input-text-color: var(--calcite-autocomplete-input-text-color);--calcite-input-placeholder-text-color: var(--calcite-autocomplete-input-placeholder-text-color);--calcite-input-actions-background-color: var(--calcite-autocomplete-input-actions-background-color);--calcite-input-actions-background-color-hover: var(--calcite-autocomplete-input-actions-background-color-hover);--calcite-input-actions-background-color-press: var(--calcite-autocomplete-input-actions-background-color-press);--calcite-input-actions-icon-color: var(--calcite-autocomplete-input-actions-icon-color);--calcite-input-actions-icon-color-hover: var(--calcite-autocomplete-input-actions-icon-color-hover);--calcite-input-actions-icon-color-press: var(--calcite-autocomplete-input-actions-icon-color-press);--calcite-input-loading-background-color: var(--calcite-autocomplete-input-loading-background-color);--calcite-input-loading-fill-color: var(--calcite-autocomplete-input-loading-fill-color);--calcite-input-prefix-background-color: var(--calcite-autocomplete-input-prefix-background-color);--calcite-input-prefix-text-color: var(--calcite-autocomplete-input-prefix-text-color);--calcite-input-suffix-background-color: var(--calcite-autocomplete-input-suffix-background-color);--calcite-input-suffix-text-color: var(--calcite-autocomplete-input-suffix-text-color)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.content-container{box-sizing:border-box;width:100%}.floating-ui-container{--calcite-floating-ui-z-index: var(--calcite-z-index-dropdown);inline-size:max-content;display:none;max-inline-size:100vw;max-block-size:100vh;inset-block-start:0;left:0;z-index:var(--calcite-floating-ui-z-index)}@starting-style{.floating-ui-container{opacity:0;inset-block-start:0;left:0}}.floating-ui-container .calcite-floating-ui-anim{position:relative;transition-duration:var(--calcite-floating-ui-transition);transition-property:inset-block-start,left,opacity,display;transition-behavior:allow-discrete;opacity:0;box-shadow:0 0 16px #00000029;z-index:var(--calcite-z-index);border-radius:.25rem}.floating-ui-container[data-placement^=bottom] .calcite-floating-ui-anim{inset-block-start:-5px}.floating-ui-container[data-placement^=top] .calcite-floating-ui-anim{inset-block-start:5px}.floating-ui-container[data-placement^=left] .calcite-floating-ui-anim{left:5px}.floating-ui-container[data-placement^=right] .calcite-floating-ui-anim{left:-5px}.floating-ui-container[data-placement] .calcite-floating-ui-anim--active{opacity:1;inset-block-start:0;left:0}@starting-style{.floating-ui-container[data-placement] .calcite-floating-ui-anim--active{opacity:0}}.content-container .calcite-floating-ui-anim{max-height:45vh;width:100%;overflow-y:auto;color:var(--calcite-autocomplete-text-color, var(--calcite-color-text-1));background-color:var(--calcite-autocomplete-background-color, var(--calcite-color-foreground-1));border-radius:var(--calcite-autocomplete-corner-radius, var(--calcite-corner-radius-round))}.content--hidden{display:none}@media (forced-colors: active){.floating-ui-container--active{border:1px solid canvasText}}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.internal-label-alignment--center{align-items:center}.internal-label-alignment--end{align-items:end}.internal-label--container{display:flex;justify-content:space-between;color:var(--calcite-color-text-1)}.internal-label-required--indicator{font-weight:var(--calcite-font-weight-medium);color:var(--calcite-color-status-danger);padding-inline:var(--calcite-spacing-base)}.internal-label-required--indicator:hover{cursor:help}.internal-label--text{line-height:1}:host([scale=s]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-xxs)}:host([scale=s]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-sm)}:host([scale=s]) .internal-label--text{font-size:var(--calcite-font-size--2)}:host([scale=m]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label--text{font-size:var(--calcite-font-size--1)}:host([scale=l]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-sm)}:host([scale=l]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-md)}:host([scale=l]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-md)}:host([scale=l]) .internal-label--text{font-size:var(--calcite-font-size-0)}.validation-container{display:flex;flex-direction:column;align-items:flex-start;align-self:stretch}:host([scale=m]) .validation-container,:host([scale=l]) .validation-container{padding-block-start:.5rem}:host([scale=s]) .validation-container{padding-block-start:.25rem}::slotted(input[slot=hidden-form-input]){margin:0!important;opacity:0!important;outline:none!important;padding:0!important;position:absolute!important;inset:0!important;transform:none!important;-webkit-appearance:none!important;z-index:-1!important}:host([hidden]){display:none}[hidden]{display:none}`,H={contentBottom:"content-bottom",contentTop:"content-top"},f={inputContainer:"input-container",input:"input",contentContainer:"content-container",contentAnimation:"content-animation",content:"content",contentHidden:"content--hidden",floatingUIContainer:"floating-ui-container",floatingUIContainerActive:"floating-ui-container--active",screenReadersOnly:"screen-readers-only"},M="autocomplete",T={validationMessage:"autocompleteValidationMessage",input:l=>`${M}-input-${l}`,list:l=>`${M}-list-${l}`},xt="calcite-autocomplete-item-group",yt="calcite-autocomplete-item",$=class $ extends j{constructor(){super(),this.guid=ut(),this.attributeWatch=X(["autofocus","enterkeyhint","inputmode"],this.handleGlobalAttributesChanged),this.inputId=T.input(this.guid),this.listId=T.list(this.guid),this.messages=pt(),this.transitionProp="opacity",this.mutationObserver=L("mutation",()=>this.getAllItemsDebounced()),this.focusSetter=mt()(this),this.resizeObserver=L("resize",()=>{this.setFloatingElSize()}),this.cancelable=ht()(this),this.getAllItemsDebounced=ft(this.getAllItems,0),this.activeDescendant="",this.activeIndex=-1,this.hasContentBottom=!1,this.hasContentTop=!1,this.items=[],this.groups=[],this.alignment="start",this.disabled=!1,this.iconFlipRtl=!1,this.loading=!1,this.open=!1,this.overlayPositioning="absolute",this.placement=D,this.readOnly=!1,this.required=!1,this.scale="m",this.status="idle",this.validity={valid:!1,badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1},this.value="",this.calciteAutocompleteBeforeClose=g({cancelable:!1}),this.calciteAutocompleteBeforeOpen=g({cancelable:!1}),this.calciteAutocompleteChange=g({cancelable:!1}),this.calciteAutocompleteClose=g({cancelable:!1}),this.calciteAutocompleteOpen=g({cancelable:!1}),this.calciteAutocompleteTextChange=g({cancelable:!1}),this.calciteAutocompleteTextInput=g({cancelable:!1}),this.listenOn(document,"click",this.documentClickHandler),this.listen("calciteAutocompleteItemSelect",this.handleAutocompleteItemSelect)}get isOpen(){return this.open&&(this.hasContentTop||this.hasContentBottom||this.items.length>0)}get enabledItems(){return this.items.filter(t=>!t.disabled)}async reposition(t=!1){const{floatingEl:i,referenceEl:c,placement:e,overlayPositioning:n,flipPlacements:a}=this;return Y(this,{floatingEl:i,referenceEl:c,overlayPositioning:n,placement:e,flipPlacements:a,type:"menu"},t)}async scrollContentTo(t){this.transitionEl?.scrollTo(t)}async selectText(){return this.referenceEl.selectText()}async setFocus(t){return this.focusSetter(()=>this.referenceEl,t)}connectedCallback(){super.connectedCallback(),this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0}),it(this),lt(this),this.defaultInputValue=this.inputValue||"",this.getAllItemsDebounced(),I(this),this.cancelable.add(this.getAllItemsDebounced)}async load(){this.getAllItemsDebounced()}willUpdate(t){t.has("disabled")&&(this.hasUpdated||this.disabled!==!1)&&this.handleDisabledChange(this.disabled),t.has("open")&&(this.hasUpdated||this.open!==!1)&&this.openHandler(),(t.has("flipPlacements")||t.has("overlayPositioning")&&(this.hasUpdated||this.overlayPositioning!=="absolute")||t.has("placement")&&(this.hasUpdated||this.placement!==D))&&this.reposition(!0);let i=!1;t.has("inputValue")&&(this.hasUpdated||this.inputValue)&&(this.inputValueMatchPattern=this.inputValue&&new RegExp(`(${gt(this.inputValue)})`,"i"),this.updateItems(),this.updateGroups(),i=!0),!i&&t.has("scale")&&(this.hasUpdated||this.scale!=="m")&&(this.updateItems(),this.updateGroups(),i=!0),!i&&t.has("activeIndex")&&(this.hasUpdated||this.activeIndex!==-1)&&this.updateItems()}updated(){_(this)}loaded(){st(this,this.value||""),this.defaultInputValue=this.inputValue||"",I(this)}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),this.resizeObserver?.disconnect(),at(this),ot(this),Z(this)}setFloatingElSize(){const{referenceEl:t,floatingEl:i}=this;!t||!i||(i.style.inlineSize=`${t.clientWidth}px`)}handleGlobalAttributesChanged(){this.requestUpdate()}handleDisabledChange(t){t||(this.open=!1)}openHandler(){if(et(this),this.open||(this.activeIndex=-1),this.disabled){this.open=!1;return}this.setFloatingElSize(),this.reposition(!0)}async documentClickHandler(t){this.disabled||t.composedPath().includes(this.el)||(this.open=!1)}async handleAutocompleteItemSelect(t){this.value=t.target.value,this.emitChange(),await this.setFocus(),this.open=!1}onLabelClick(){this.setFocus()}onFormReset(){this.inputValue=this.defaultInputValue}onBeforeOpen(){this.calciteAutocompleteBeforeOpen.emit()}onOpen(){this.calciteAutocompleteOpen.emit()}onBeforeClose(){this.calciteAutocompleteBeforeClose.emit()}onClose(){this.calciteAutocompleteClose.emit()}emitChange(){this.calciteAutocompleteChange.emit()}updateGroups(){this.groups.forEach((t,i,c)=>{t.scale=this.scale,i===0&&(t.disableSpacing=!0);const e=c[i+1];e&&(e.disableSpacing=t.children.length===0)})}updateItems(){let t=null;this.items.forEach(i=>{i.scale=this.scale,i.inputValueMatchPattern=this.inputValueMatchPattern}),this.enabledItems.forEach((i,c)=>{const e=c===this.activeIndex;e&&(t=i.guid),i.active=e}),this.activeDescendant=t}handleInputFocus(){this.open=!0}handleContentTopSlotChange(t){this.hasContentTop=F(t)}handleContentBottomSlotChange(t){this.hasContentBottom=F(t)}getAllItems(){const{el:t}=this;this.groups=Array.from(t.querySelectorAll(xt)),this.items=Array.from(t.querySelectorAll(yt)),this.updateItems(),this.updateGroups()}setReferenceEl(t){dt(this.resizeObserver,this.referenceEl,t),this.referenceEl=t,I(this)}keyDownHandler(t){const{defaultPrevented:i,key:c}=t;if(i)return;const{open:e,activeIndex:n,enabledItems:a}=this,r=a.length&&n>-1?a[n]:null;switch(c){case"Escape":e&&(this.open=!1,t.preventDefault());break;case"Tab":this.open=!1;break;case"Enter":e&&r?(this.value=r.value,r.emitSelectEvent(),this.open=!1,t.preventDefault()):t.defaultPrevented||ct(this)&&t.preventDefault();break;case"ArrowDown":a.length&&(this.open=!0,this.activeIndex=n!==-1?Math.min(n+1,a.length-1):0,this.scrollToActiveItem(),t.preventDefault());break;case"ArrowUp":a.length&&(this.open=!0,this.activeIndex=n!==-1?Math.max(n-1,0):a.length-1,this.scrollToActiveItem(),t.preventDefault());break;case"Home":a.length&&(this.open=!0,this.activeIndex=0,this.scrollToActiveItem(),t.preventDefault());break;case"End":a.length&&(this.open=!0,this.activeIndex=a.length-1,this.scrollToActiveItem(),t.preventDefault());break}}scrollToActiveItem(){this.enabledItems[this.activeIndex]?.scrollIntoView({block:"nearest"})}changeHandler(t){t.stopPropagation(),this.inputValue=t.target.value,this.calciteAutocompleteTextChange.emit()}inputClickHandler(t){t.defaultPrevented||(this.open=!0)}inputHandler(t){t.stopPropagation(),this.inputValue=t.target.value,this.open=this.inputValue?.length>0,this.calciteAutocompleteTextInput.emit()}setFloatingEl(t){this.floatingEl=t,I(this)}setTransitionEl(t){t&&(this.transitionEl=t)}render(){const{disabled:t,listId:i,inputId:c,isOpen:e}=this,n=this.el.autofocus,a=this.el.enterKeyHint,r=this.el.inputMode;return tt({disabled:t,children:C`${this.labelText&&P({labelText:this.labelText,onClick:this.onLabelClick,required:this.required,tooltipText:this.messages.required})||""}<div class=${v(f.inputContainer)}><calcite-input .alignment=${this.alignment} aria-activedescendant=${this.activeDescendant??d} aria-controls=${i??d} aria-label=${nt(this)??d} aria-owns=${i??d} aria-autocomplete=list .ariaExpanded=${e} aria-haspopup=listbox .autocomplete=${this.autocomplete} .autofocus=${n} class=${v(f.input)} clearable .disabled=${t} enterkeyhint=${a??d} .form=${this.form} .icon=${this.icon??!0} .iconFlipRtl=${this.iconFlipRtl} id=${c??d} inputmode=${r??d} .label=${this.label} .loading=${this.loading} .maxLength=${this.maxLength} .messageOverrides=${this.messages} .minLength=${this.minLength} .name=${this.name} @click=${this.inputClickHandler} @keydown=${this.keyDownHandler} @calciteInputChange=${this.changeHandler} @calciteInputInput=${this.inputHandler} @calciteInternalInputFocus=${this.handleInputFocus} .pattern=${this.pattern} .placeholder=${this.placeholder} .prefixText=${this.prefixText} .readOnly=${this.readOnly} .required=${this.required} role=combobox .scale=${this.scale} .status=${this.status} .suffixText=${this.suffixText} type=search .value=${this.inputValue} ${w(this.setReferenceEl)}></calcite-input>${this.renderListBox()}<div class=${v({[f.contentContainer]:!0,[f.floatingUIContainer]:!0,[f.floatingUIContainerActive]:e})} ${w(this.setFloatingEl)}><div class=${v({[f.contentAnimation]:!0,[B.animation]:!0,[B.animationActive]:e})} ${w(this.setTransitionEl)}><div class=${v({[f.content]:!0,[f.contentHidden]:!e})}><slot name=${H.contentTop} @slotchange=${this.handleContentTopSlotChange}></slot><slot aria-hidden=true></slot><slot name=${H.contentBottom} @slotchange=${this.handleContentBottomSlotChange}></slot></div></div></div></div>${rt({component:this})}${this.validationMessage&&this.status==="invalid"?U({icon:this.validationIcon,id:T.validationMessage,message:this.validationMessage,scale:this.scale,status:this.status}):null}`})}renderListBox(){return C`<ul aria-labelledby=${this.inputId??d} aria-live=polite class=${v(f.screenReadersOnly)} id=${this.listId??d} role=listbox tabindex=-1>${this.renderListBoxOptions()}</ul>`}renderListBoxOptions(){return bt(this.items.filter(t=>!!(t.label||t.heading)),t=>t.guid,t=>C`<li .ariaDisabled=${t.disabled} .ariaLabel=${t.label} id=${t.guid??d} role=option tabindex=-1>${t.heading}${t.description}</li>`)}};$.properties={activeDescendant:[16,{},{state:!0}],activeIndex:[16,{},{state:!0}],hasContentBottom:[16,{},{state:!0}],hasContentTop:[16,{},{state:!0}],items:[16,{},{state:!0}],groups:[16,{},{state:!0}],alignment:[3,{},{reflect:!0}],autocomplete:[0,{},{attribute:!1}],disabled:[7,{},{reflect:!0,type:Boolean}],flipPlacements:[0,{},{attribute:!1}],form:[3,{},{reflect:!0}],icon:[3,{converter:z},{reflect:!0}],iconFlipRtl:[7,{},{reflect:!0,type:Boolean}],inputValue:1,label:1,labelText:1,loading:[7,{},{reflect:!0,type:Boolean}],maxLength:[11,{},{reflect:!0,type:Number}],messageOverrides:[0,{},{attribute:!1}],minLength:[11,{},{reflect:!0,type:Number}],name:[3,{},{reflect:!0}],open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],pattern:1,placeholder:1,placement:[3,{},{reflect:!0}],prefixText:1,readOnly:[7,{},{reflect:!0,type:Boolean}],required:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],status:[3,{},{reflect:!0}],suffixText:1,validationIcon:[3,{converter:z},{reflect:!0}],validationMessage:1,validity:[0,{},{attribute:!1}],value:1},$.styles=vt;let E=$;N("calcite-autocomplete",E);export{E as Autocomplete};
